     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Display journal entry batch posting')         *
     H/TITLE Midas GL Display J. Entry Batch posting
     Z* CRTRPGPGM
     Z* IGNDECERR(*YES)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by  : SYNON/2  Version:  1080
     H* Function type : Display file
      *
     H*  Company :
     H* System        : General Ledger Synon Model
     H* User name     : LEMMONP
     H* Date          : 29/07/93  Time  : 17:26:27
      *  (c) Finastra International Limited 2001                      *
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     F*****************************************************************
     F*                                                               *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD027587           Date 19Jun14               *
      *                 AR659451           Date 29Nov12               *
      *                 AR740098           Date 02Apr11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23742           Date 09May09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246418             Date 16Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CRE019             Date 12Jan04               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL013             Date 29Mar02               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU013             Date 23Feb98               *
     F*                 S01408             DATE 07AUG96               *
     F*                 089856           DATE 25OCT95                 *
     F*                 084861           DATE 11APR95                 *
     F*        AMEND NO 063607           DATE 01DEC93                 *
     F*        AMEND NO S01413           DATE 20JUL93                 *
     F*        AMEND NO S10736           DATE 08SEP92                 *
     F*        AMEND NO E38270           DATE 12JUN92                 *
     F*        Amend No S01314           Date 09May91                 *
     F*                E17939            DATE : ../05/89              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD027587 - Unable to used the C for Copy and T for Template  *
      *             (Recompile)                                       *
      *  AR659451 - Search mechanism with scan limit is misleading to *
      *             users. Remove the scanning limitation and scan    *
      *             the database once from the first to last record   *
      *             before displaying the search result. Applied      *
      *             fix 258820. (Child: AR659452)                     *
      *  AR740098 - Journal Entry Postings Maintenance unlabeled      *
      *             fields (Child: AR740099) (Recompile)              *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23742 - Improper handling of Ext Narr from Batch          *
      *             Interface Input                                   *
      *  246418 - CGL013 changes for Midas Plus                       *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CRE019 - Cheque Processing and Maintenance (Recompile)       *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL013 - MT94x Messages Generation                           *
     F*  CEU013 - EMU Account Postings Narrative                      *
     F*   S01408 - CORE HOOK GL0121DCP1 ADDED                         *
     F*   089856 - Change to allow posting amount as 13N as specified *
     F*            in Ins Manual.                                     *
     F*   084861 - WRONG LANG.MESAGE ID. USED FOR 'NO. OF ITEMS'.     *
     F*   063607 - 'NO. OF ITEMS' TEXT DISPLAYS 'RETAIL'.             *
     F*   S01413 - RETAIL 3 INCORPORATIO:- NUMBER OF ITEMS AVAILABLE. *
     F*            REDESIGN SCREEN TO MATCH JOURNAL ENTRY POST. MAINT.*
     F*   S10736 - MANAGEMENT ACCOUNTS                                *
     F*   E38270 - DO NOT DISPLAY BRANCH IF MBIN IS 'N'.              *
     F*   S01314 - Multi-Language Subfile Coding                      *
     F*                                                               *
     F*   E17939 - RETAIL ACCOUNT NUMBER REVERTS BACK TO THE CUSTOMER *
     F*            NUMBER IN THE ACCOUNT NUMBER FIELD. THIS DID NOT   *
     F*            HAPPEN ON S38. FILE CHANGE WAS REQUIRED TO DETER-  *
     F*            MINE WHETHER A RETAIL AC NO WAS ENTERED. FIELD WAS *
     F*            'RETAIL A/C NUMBER ENTERED'.                       *
     F*****************************************************************
     F/COPY WNCPYSRC,GL0121DFPG
     FGL0121D#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Midas GL Display J. Entry Batch posting
      *
     FGLJENPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Midas GL Journal Entry Posting Rtv
      *
     FGLJENHL1IF  E           K        DISK
      * RTV : Midas GL Journal Entry Header LF Rtv
      *
     FGLJENXL2IF  E           K        DISK         KINFSR *PSSR                              CGL013
      ** RTV: Midas GL Journal Entry File - Additional Information                            CGL013
      *                                                                                       CGL013
     FGLMNARL3IF  E           K        DISK         KINFSR *PSSR                            BUG23742
      ** RTV: Midas GL MultiCash Narratives File                                            BUG23742
      *                                                                                     BUG23742
     F/COPY WNCPYSRC,GLH00532
     E                    @IE     1   2 76               Item Err.Msgs.
     E                    @IH         8  9               Item Err.slots
      *
     E                    CPY@    1   1 80               Copyright     array
     E/COPY WNCPYSRC,GL0121DEPG
      *                                                                                       246418
      * Parameters for pass to GL000185                                                       246418
     E                    FLDNMA     75 10                                                    246418
     E                    MSGIDA     75  7                                                    246418
     E                    MSGDTA     75 45                                                    246418
      *                                                                                       246418
     I*
     I*
     I*   Define MIDAS Rundate from data-area RUNDAT
     I*
     I*
     I*
     I/COPY WNCPYSRC,GL0121DIPG
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I            DS
      * Item error status data structure
     I                                        1 152 @IE
     I                                        1  76 URERMG
     I                                       77 152 URDASH
     I                                        5  76 @IH
     I                                        5  76 URIESL
     I                                        5   5 URHL01
     I                                       14  14 URHL02
     I                                       23  23 URHL03
     I                                       32  32 URHL04
     I                                       41  41 URHL05
     I                                       50  50 URHL06
     I                                       59  59 URHL07
     I                                       68  68 URHL08
     IWURARC      DS
     I                                        1   1 WURSRD
     I                                        2   2 WURSRC
     I                                        3   3 WURSBD
     I                                        4   4 WURSBC
     I                                        5   5 WURSIN
     I                                        6   6 WURTSS
     I                                        7   7 WURSBR
     I                                        8   8 WURTSB
     I                                        9   9 WURSSC
     I                                       10  10 WURSS2
     I            DS
     I                                        1   60UUDNMA
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
     IUUSDY     E DSDSSDY
     I*
     I* 800 Byte Data Structure for Incoming Data from Access Program
     I*
     ID@CURR    E DSSDCURRPD
     I*
     I*  Currency Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNO
     I                                       11  11 SUCP
     I                                       12  12 DTFF
     I                                       13  13 MBIN
     I*
     IUUFDY     E DSDSFDY
     I*
     I* 200 Byte Data Structure for Incoming Data from Access Program
     I*
     ID@MMOD    E DSSDMMODPD
     I*
     I*  Midas Modules DS for assigning data from Access
     I*  Programs to work fields
     I*
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : RST Batch number
     I                                        1   3 P1BTNB
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Referrals not overridden'
      * Message data for 'Lots of Dots'
     ILDA       E DSLDA                         256                                           CGL013
      ** Local Data Area for Database Error Details                                           CGL013
      *                                                                                       CGL013
     ISCSARD    E DSSCSARDPD                                                                  CGL013
      ** Switchable Features Data Structure                                                   CGL013
      *                                                                                       CGL013
     I/COPY WNCPYSRC,GL0121DI01
      *                                                                                       CGL013
      ** Parameter Passed to GL000185                                                         CGL013
      *                                                                                       CGL013
     I**********                              1 108 PDETLS                             CGL013 CGL029
     I                                        1 118 PDETLS                                    CGL029
     I                                        1   3 #1BTNB                                    CGL013
     I                                        4   6 PABINB                                    CGL013
     I                                        7   9 #1BCBH                                    CGL013
     I                                       10  15 #1CUST                                    CGL013
     I                                       16  18 #1CYCD                                    CGL013
     I**********                             19  22 #1ACCD                             CGL013 CGL029
     I                                       19  22 #1ACC1                                    CGL029
     I                                       23  24 #1ACSN                                    CGL013
     I                                       25  34 PARACN                                    CGL013
     I                                       35  48 #RFMPA                                    CGL013
     I                                       49  49 #1DCIN                                    CGL013
     I                                       50  79 #RNRTV                                    CGL013
     I                                       80  85 #RVDDS                                    CGL013
     I                                       86  90 #1TRTY                                    CGL013
     I                                       91 100 #1TSTY                                    CGL013
     I                                      101 108 #1CQNB                                    CGL013
     I                                      109 118 #1ACCD                                    CGL029
      *                                                                                       246418
      **  Valid JE Item (DS) for passing to GL000185                                          246418
     IPVBIPX    E DSGLVBIPXPD                                                                 246418
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BTNB    PARM           WP0001  3        Batch number
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
     C/COPY WNCPYSRC,GL0121DC09
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   05                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialise subfile control
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DISC - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DISC
     C*00/Copy Member GL0121D   Initialise Subf Control
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BTBTNB           Batch number
     C                     KFLD           BTBINB           Batch item no.
      *                                                                                     BUG23742
      ** Klist for the file GLMNARL3                                                        BUG23742
      *                                                                                     BUG23742
     C           KPOSL3    KLIST                                                            BUG23742
     C                     KFLD           BTPTDT                                            BUG23742
     C                     KFLD           BTBTNB                                            BUG23742
     C                     KFLD           BTBINB                                            BUG23742
      * Setup key
     C                     MOVEL#2BTNB    BTBTNB           Batch number
     C                     Z-ADD#2BINB    BTBINB           Batch item no.
     C           KPOS      SETLL@BTREAL
     C/COPY WNCPYSRC,GL0121DC10
     C           KRST      KLIST
     C                     KFLD           BTBTNB           Batch number
      * Setup key
     C                     MOVEL#2BTNB    BTBTNB           Batch number
     C           KRST      READE@BTREAL                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2BINB    WZBINB
     C                     MOVEL#2BINB    WZBINB           Batch item no.
     C           *LIKE     DEFN #2RRNM    WZRRNM
     C                     MOVEL#2RRNM    WZRRNM           Relative rec no
     C/COPY WNCPYSRC,GL0121DC11
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BTREAL                  90*
     C/COPY WNCPYSRC,GL0121DC12
     C  N82                READ @BTREAL                  90*
     C/COPY WNCPYSRC,GL0121DC13
     C                     END
     C/COPY WNCPYSRC,GL0121DC14
      *
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      **Reset*count*of*DBF*records*read********************************                     AR659451
     C**********           Z-ADD0         ##RRRD  50                                        AR659451
      *................................................................
      **Load*next*SFL*page*until*SFL*page*full,*or*********************                     AR659451
      **Scan*limit*reached*********************************************                     AR659451
      ** Load next SFL page until SFL page full                                             AR659451
      *                                                                                     AR659451
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFPG
     C********** ##RRRD    ANDLTW0SLM                                                       AR659451
      * Check selection fields - if fail, read next record
     C           #2RRNM    IFNE *ZERO                      Relative rec no
     C           BTRRNM    CABNE#2RRNM    BB020            Relative rec no
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     EXSR MC#1FN
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialise subfile record from DBF record
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
     C                     MOVELBTRARC    WURARC           Retail Ac Refer
      * DS for Item Err Msg - Standard functions  *
      * Setup Override Err Msg - Standard functions  *
      *
     C                     EXSR CHKOVR                     Check Retail
      *
     C                     MOVELURERTX    #RIEMG           Error message
      *
      *==================================================================
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUIEMG    #RIEMG           Item error mess
     C                     END                             *FI
      * CASE: DB1.Retail ind.: Error is Error requiring Override
     C           BTRINE    IFEQ 'Y'                        *IF
      * CASE: DB1.Retail ind.: Override is Error(s) not Overridden
     C           BTRINO    IFEQ 'N'                        *IF
     C                     MOVEL'E'       #RIEST           Item error stat
      * Setup message data for message
      * Retrieve message Referrals not overridden
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'GLX0074' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #RIEMG    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.Narrative code is Narrative code
     C/COPY WNCPYSRC,GL0121DC15
     C           BTNVCD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    #RNRTV           Narrative
     C                     MOVELBTNVCD    #RNRTV           Narrative
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBTNRDC    #RNRTV           Narrative
     C                     END                             *FI
     C/COPY WNCPYSRC,GL0121DC16
      * Start of Fix E17939
      * CASE: RCD.Retail Number Entered is Retail Account
     C           #1RNBE    IFEQ 'Y'                        *IF
     C                     MOVELBTRACN    #RACID           Account Identif
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RACID           Account Identif
     C                     MOVELBTCUST    #RACID           Account Identif
     C                     END                             *FI
      * End of Fix E17939
      * Access Currency. - Currency Codes  *
     C*
     C*  Access Currency codes file for the following fields
     C*  Currency Name, Number of decimal places, Nostro Shortname
     C*
     C                     MOVEL#1CYCD    UUCYCD
     C                     CALL 'AOCURRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        I:Option
     C                     PARM           UUCYCD  3        I:Currency Code
     C           D@CURR    PARM *BLANK    UUSDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELA6CYCD    #1CYCD           Currency Code
     C                     MOVELA6CYNM    WUCYNM           Currency Name
     C                     MOVELA6NBDP    WUNBDP           No. Decimal Places
     C                     MOVELA6NOSN    WUNOSN           Nostro Shortname
     C*
      * Format amount (short) - Standard functions  *
     C                     Z-ADD#1PTAM    ULVALU           Value
      *
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALU 150       I:Value
     C                     PARM WUNBDP    ULDECP  10       I:Decimal place
     C***********          PARM 'L'       ULEDIT  1        I:IBM Edit code089856
     C                     PARM '3'       ULEDIT  1        I:IBM Edit code089856
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLF 23        O:Formatted
      *
     C                     MOVE ULRSLF    #RFMPA           Formatted data
      *
      * CASE: DB1.Value date is Not zero
     C           BTVLDT    IFNE *ZERO                      *IF
      * Midas Conv. Day to Date - Standard functions  *
     C                     CALL 'ZDATE2'               90  Midas Conv. Day
     C                     PARM BTVLDT    WQ0001  50       Runday Number
     C                     PARM WUDTFF    WQ0002  1        Date Format fla
     C           WUDTNF    PARM *ZERO     WQ0003  60       Date (numeric f
     C           WUDDCD    PARM *BLANK    WQ0004  7        Midas Run Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Copy Num to VDate Display - Standard functions  *
     C*
     C                     Z-ADDWUDTNF    UUDNMA
     C                     MOVE UUDNMA    #RVDDS
     C                     END                             *FI
     C/COPY WNCPYSRC,GLH00533
     C*                                                                   CEU013
      * Access Currency. - Original Currency Code if Switchable           CEU013
     C*  function CEU013 is installed and Original currency is non -      CEU013
     C*  blank.                                                           CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           #1OCCY    ANDNE*BLANKS                                   CEU013
     C*  Access Currency codes file for Number of Decimal places          CEU013
     C*                                                                   CEU013
     C                     MOVEL#1OCCY    UUCYCD                          CEU013
     C                     CALL 'AOCURRR0'                                CEU013
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    CEU013
     C                     PARM '*KEY'    UUAPOP  7        I:Option       CEU013
     C                     PARM           UUCYCD  3        I:Currency CodeCEU013
     C           D@CURR    PARM *BLANK    UUSDY            O:Format       CEU013
     C*                                                                   CEU013
     C* Assign work field to file field values.                           CEU013
     C*                                                                   CEU013
     C                     MOVELA6CYCD    #1OCCY           Original Ccy   CEU013
     C                     MOVELA6NBDP    WUNBDP           No. Decimal PlcCEU013
     C*                                                                   CEU013
      * Format amount (short) - Standard functions  *                     CEU013
     C                     Z-ADD#1OAMT    ULVALU           Value          CEU013
      *                                                                   CEU013
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>CEU013
     C                     PARM           ULVALU 150       I:Value        CEU013
     C                     PARM WUNBDP    ULDECP  10       I:Decimal placeCEU013
     C                     PARM '3'       ULEDIT  1        I:IBM Edit codeCEU013
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.CEU013
     C                     PARM           ULRSLF 23        O:Formatted    CEU013
      *                                                                   CEU013
     C                     MOVE ULRSLF    #RFMOA           Formatted O/AmtCEU013
     C*                                                                   CEU013
     C                     ENDIF                                          CEU013
     C/COPY WNCPYSRC,GL0121DC02
      *                                                                   CEU013
      ** If CGL013 is installed                                                               CGL013
      *                                                                                       CGL013
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C                     MOVEL'N'       #1ADIN                                              CGL013
      *                                                                                       CGL013
     C           KPOS      CHAINGLJENXL2             63                                       CGL013
     C           *IN63     IFEQ *OFF                                                          CGL013
     C           BAADI1    ANDNE*BLANKS                                                       CGL013
     C                     MOVE *ON       *IN64                                               CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE *OFF      *IN64                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                     BUG23742
     C           CER030    IFEQ 'Y'                                                         BUG23742
      *                                                                                     BUG23742
     C           KPOSL3    CHAINGLMNARL3             63                                     BUG23742
     C           *IN63     IFEQ *OFF                                                        BUG23742
     C           BAEX1     ANDNE*BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN60                                             BUG23742
     C                     ELSE                                                             BUG23742
     C                     MOVE *OFF      *IN60                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                       CGL013
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DISR - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DISR
     C*00/Copy Member GL0121D   Initialise Subfile Rcd
     C                     END                             *FI
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Output to subfile
     C                     ADD  1         ##RR       81    *
     C                     ADD  1         ##RROK
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      **Increment*scan*check*count*************************************                     AR659451
     C**********           ADD  1         ##RRRD                                            AR659451
     C           KRST      READE@BTREAL                  82*82=EOF
     C/COPY WNCPYSRC,GL0121DC17
     C                     END                             OD 1 - ##SFPG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
     C           ##RRMX    ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      **If*scan*limit*reached,*display*error*message*******************                     AR659451
     C********** ##RRRD    IFGE W0SLM                                                       AR659451
      **Send*message*'*Scan*limit*reached'*****************************                     AR659451
     C**********           MOVEL'Y2U0017' ZAMSID                                            AR659451
     C**********           MOVEL'Y2USRMSG'ZAMSGF                                            AR659451
     C**********           EXSR ZASNMS                                                      AR659451
     C**********           ELSE                                                             AR659451
     C                     Z-ADD0         ##RROK
     C**********           END                                                              AR659451
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN81     IFNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN81     CAIN81  1
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
      *================================================================
     CSR         CAEXIT    ENDSR
     CSR         CHKOVR    BEGSR
      *====================================================
      * Check OVERRIDE MESSAGES
      *----------------------------------------------------
      *
     C                     MOVE *IN90     URSI90  1        Save indicator
     C                     MOVE *IN91     URSI91  1        Save indicator
     C                     MOVE *BLANK    URIESL           Blank msg.text
     C                     MOVE *BLANK    URERST  1        Error status
     C                     Z-ADD1         U1      30       Set pointer
     C                     SETOF                     91    Set ind.
      *
      * Check Refer Debits :
      *
      *
     C           WURSRD    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Refer Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Refer Credits :
      *
      *
     C           WURSRC    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Refer Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI             E17600
      *
      * Check Block Debits :
      *
      *
     C           WURSBD    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Block Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI             E17600
      *
      * Check Block Credits :
      *
     C           WURSBC    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Block Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI             E17600
      *
      * Check Inactive A/C :
      *
     C           WURSIN    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Inactive'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Not in Use :   ***REMOVE COMMENTS IF FLAG TO BE USED LATER***
      *
     C*****      WUBDST    IFEQ 'Y'                        IF BIT SET
     C*****                MOVELURRIHS    @IH,U1             Highlight
     C*****                MOVE 'Not used'@IH,U1             Message text
     C*****                ADD  1         U1                 Incr.pointer
     C*****                END                             FI
      *
      * Check Bankrupt :
      *
     C           WURSBR    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Bankrupt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Bad Debt :
      *
     C           WURTSB    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Bad Debt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Stopped cheque :
      *
     C           WURSSC    IFEQ 'Y'                        IF NO O'RIDE
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Chq.Stop'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Non-Overrideable error status :
      *
     C           U1        IFGT 1                          IF ERRORS
     C           U1        IFLT 9                          IF NOT MAXIMUM
     C                     MOVELURNORM    @IH,U1             End Highlight
     C                     END                             FI
     C                     MOVE URERMG    URERTX             Error line
     C                     ELSE                            EL NO ERRORS
     C                     MOVE *BLANK    URERST             Error Status
     C                     MOVE URDASH    URERTX 76          Dashes
     C                     END                             FI
      *
     C                     MOVE URSI90    *IN90            Restore ind.
     C                     MOVE URSI91    *IN91            Restore ind.
      *
      *----------------------------------------------------
      *
      *====================================================
     CSR         XXEND     ENDSR
      *
      * Set highlights for error message line :
      *
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * USER: Process subfile control (Pre-confirm)
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DPSC - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DPSC
     C*00/Copy Member GL0121D   Process Subfile Control
     C                     END                             *FI
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
      * USER: Final processing (Pre-confirm)
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DFPR - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DFPR
     C*00/Copy Member GL0121D   Final Processing
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: Process command keys
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DPCK - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DPCK
     C*00/Copy Member GL0121D   Process Command Keys
     C                     END                             *FI
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      *                                                                                       CGL013
      ** Process Additional Information                                                       CGL013
      *                                                                                       CGL013
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C                     EXSR SRADIN                                                        CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
      * Process subfile record
     C                     EXSR DCPRSR
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C                     MOVE *ON       *IN84                                               CGL013
     C                     ENDIF                                                              CGL013
     C                     UPDAT#SFLRCD
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C                     MOVE *OFF      *IN84                                               CGL013
     C                     ENDIF                                                              CGL013
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     SETOF                     98    *
     C                     EXSR MC#1FN
      * USER: Process subfile record (Pre-confirm)
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DPSR - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DPSR
     C*00/Copy Member GL0121D   Process Subfile Record
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN78
     C           WUMBIN    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #1TRTY    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #1TSTY    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #1VLDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #1CQNB    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           #1SWCR    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           #1PRCN    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           #1ACNB    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           #1BKCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           #1RVDI    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           WUDNIT    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL'0'       *IN67
     C           #1RINE    IFEQ *BLANK                     *IF
     C           #1RINE    OREQ 'N'
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C/COPY WNCPYSRC,GL0121DC01
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           WUMBIN    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BTREAL fields to subfile
      *================================================================
     C                     MOVELBTBTNB    #1BTNB           Batch number
     C                     Z-ADDBTBINB    #1BINB           Batch item no.
     C                     MOVELBTCUST    #1CUST           Customer number
     C                     MOVELBTNNBI    #1NNBI           Nostro number (
     C                     Z-ADDBTRACN    #1RACN           Retail account
     C                     Z-ADDBTPTAM    #1PTAM           Posting amount
     C                     MOVELBTRINE    #1RINE           Retail ind.: Er
     C                     Z-ADDBTPTDT    #1PTDT           Posting date
     C                     MOVELBTNVCD    #1NVCD           Narrative code
     C                     MOVELBTNRDC    #1NRDC           Narrative descr
     C                     MOVELBTACTY    #1ACTY           Account type
     C                     Z-ADDBTVLDT    #1VLDT           Value date
     C                     MOVELBTCOIN    #1COIN           Customer origin
     C                     Z-ADDBTSPFC    #1SPFC           Spread Factor
     C                     MOVELBTBCBH    #1BCBH           Branch Code (Ba
     C                     MOVELBTRADP    #1RADP           Retail advice p
     C                     MOVELBTSHPI    #1SHPI           Shadow post ind
     C                     Z-ADDBTRRNM    #1RRNM           Relative rec no
     C                     MOVELBTRNBE    #1RNBE           Retail Number E
     C                     MOVELBTRARC    #1RARC           Retail Ac Refer
     C                     MOVELBTCYCD    #1CYCD           Currency code
     C                     MOVELBTACCD    #1ACCD           Account code
     C                     MOVELBTACSN    #1ACSN           Account sequenc
     C                     MOVELBTIBCA    #1IBCA           Input Branch Co
     C                     MOVELBTDCIN    #1DCIN           Debit/credit in
     C                     MOVELBTTRTY    #1TRTY           Transaction typ
     C/COPY WNCPYSRC,GL0121DC08
     C                     MOVELBTTSTY    #1TSTY           Transaction (Su
     C                     MOVELBTCQNB    #1CQNB           Cheque number
     C                     MOVELBTSWCR    #1SWCR           Swift common re
     C                     MOVELBTPRCN    #1PRCN           Profit centre
     C                     MOVELBTACNB    #1ACNB           Assoc. Customer
     C                     MOVELBTBKCD    #1BKCD           Book Code
     C                     MOVELBTRVDI    #1RVDI           Reverse/Void In
     C                     Z-ADDBTNITM    #1NITM           Number of Items
     C                     MOVELBTRINO    #1RINO           Retail ind.: Ov
     C                     MOVEL*BLANK    #RIEST           Item error stat
     C                     MOVEL*BLANK    #RACID           Account Identif
     C                     MOVEL*BLANK    #RFMPA           Formatted Posti
     C                     MOVEL*BLANK    #RNRTV           Narrative
     C                     MOVEL*BLANK    #RVDDS           Value date (dis
     C                     MOVEL*BLANK    #RIEMG           Item error mess
     C/COPY WNCPYSRC,GLH00534
     C                     MOVELBTOCCY    #1OCCY           Original Ccy   CEU013
     C                     Z-ADDBTOAMT    #1OAMT           Original AmountCEU013
     C                     MOVEL*BLANK    #RFMOA           Formatted O/AmtCEU013
     C/COPY WNCPYSRC,GL0121DC03
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MC#1FN    BEGSR
      *================================================================
      * CALC: Subfile record function fields
      *================================================================
      * CALC: Subfile record function fields
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DRFF - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DRFF
     C*00/Copy Member GL0121D   Calculate Record Funcs
     C                     END                             *FI
      *================================================================
     CSR         MCEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP1BTNB    #2BTNB           Batch number
     C                     Z-ADD*ZERO     #2BINB           Batch item no.
     C                     Z-ADD*ZERO     #2RRNM           Relative rec no
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVEL#2BTNB    WK1X01  1
     C           WK1X01    IFEQ '?'                        Batch number
     C                     CALL 'GL0140S'              90  *
     C                     PARM           W0RTN   7
     C           #2BTNB    PARM #2BTNB    WQ0005  3        Batch number
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     CABNE*BLANK    VA999
     C                     END
      *................................................................
      *
     C           KLVABR    KLIST
     C                     KFLD           BRBTNB           Batch number
      * Setup key
     C                     MOVEL#2BTNB    BRBTNB           Batch number
     C           KLVABR    CHAIN@BRREAH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Journal Entry Header   NF'
     C                     MOVEL'GLX0172' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'GLX0172' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DEPP - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DEPP
     C*00/Copy Member GL0121D   Exit Program Processing
     C                     END                             *FI
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     C/COPY WNCPYSRC,GLH00535
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     C/COPY WNCPYSRC,GL0121DC04
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0121DCP1                                           S01408
     C*                                                                   S01408
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field S01212
     C                     MOVEL*BLANK    WUFKST  1
      * Define work field Retail Ac Referral Cond.
     C                     MOVEL*BLANK    WURARC 10
      * Define work field Item error message
     C                     MOVEL*BLANK    WUIEMG 76
      * Obtain default message file
     C           *NAMVAR   DEFN MIMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Currency Name
     C                     MOVEL*BLANK    WUCYNM 14
      * Define work field Number of Decimal Places
     C                     Z-ADD*ZERO     WUNBDP  10
      * Define work field Nostro Shortname
     C                     MOVEL*BLANK    WUNOSN 10
      * Define work field Date Format flag
     C                     MOVEL*BLANK    WUDTFF  1
      * Define work field Date (numeric format)
     C                     Z-ADD*ZERO     WUDTNF  60
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUDDCD  7
      * Define work field Multibranching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Display no of items
     C                     MOVEL*BLANK    WUDNIT  1
      * Define work field Midas Rundate
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Runday Number
     C                     Z-ADD*ZERO     WURDNO  50
      * Define work field Setup Complete
     C                     MOVEL*BLANK    WUSUCP  1
      * Define work field Midas/Telex Module Ind.
     C                     MOVEL*BLANK    WUMTMI  1
      * Define work field SWIFT Funds Transfer
     C                     MOVEL*BLANK    WUSWFT  1
      * Define work field SWIFT Securities Trading
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field SWIFT Customer Lending
     C                     MOVEL*BLANK    WUSWCL  1
      * Define work field SWIFT Syndicated Loans
     C                     MOVEL*BLANK    WUSWSL  1
      * Define work field SWIFT Statements
     C                     MOVEL*BLANK    WUSWSM  1
      * Define work field SWIFT Dealing
     C                     MOVEL*BLANK    WUSWDL  1
      * Define work field Standing data/Gen.Ledger
     C                     MOVEL*BLANK    WUSDGL  1
      * Define work field Dealing: FX
     C                     MOVEL*BLANK    WUDLFX  1
      * Define work field Syndicated Loans
     C                     MOVEL*BLANK    WUSYLN  1
      * Define work field Exposure Management
     C                     MOVEL*BLANK    WUEXMG  1
      * Define work field Financial Modeller
     C                     MOVEL*BLANK    WUFNMO  1
      * Define work field Statutary Returns
     C                     MOVEL*BLANK    WUSTRT  1
      * Define work field Customer Lending
     C                     MOVEL*BLANK    WUCSLN  1
      * Define work field Retail Banking
     C                     MOVEL*BLANK    WURTBN  1
      * Define work field Midas/Swift direct link
     C                     MOVEL*BLANK    WUMSDL  1
      * Define work field Securities
     C                     MOVEL*BLANK    WUSECS  1
      * Define work field Auto-reconciliations
     C                     MOVEL*BLANK    WUAURC  1
      * Define work field Bond Dealers Interface
     C                     MOVEL*BLANK    WUBDLI  1
      * Define work field DRS Standing Data
     C                     MOVEL*BLANK    WUDRSD  1
      * Define work field DRS Control module
     C                     MOVEL*BLANK    WUDRCM  1
      * Define work field DRS Foreign Exchange
     C                     MOVEL*BLANK    WUDRFE  1
      * Define work field DRS Money Market
     C                     MOVEL*BLANK    WUDRMM  1
      * Define work field DRS Arbitrage
     C                     MOVEL*BLANK    WUDRAR  1
      * Define work field Funds Transfer
     C                     MOVEL*BLANK    WUFDTR  1
      * Define work field DRS Common Applications
     C                     MOVEL*BLANK    WUDRCA  1
      * Define work field Futures & Options
     C                     MOVEL*BLANK    WUFUOP  1
      * Define work field Midas/Telex Synd. Loans
     C                     MOVEL*BLANK    WUMTSL  1
      * Define work field Midas/Telex Dealing
     C                     MOVEL*BLANK    WUMTDL  1
      * Define work field Midas/Telex Gen. Ledger
     C                     MOVEL*BLANK    WUMTGL  1
      * Define work field Midas/Telex Cust. Lending
     C                     MOVEL*BLANK    WUMTCL  1
      * Define work field Network Midas
     C                     MOVEL*BLANK    WUNWMI  1
      * Define work field FRA/IRS Indicator
     C                     MOVEL*BLANK    WUFIIN  1
      * Define work field Dealing: MM
     C                     MOVEL*BLANK    WUDLMM  1
      * Define work field Internal Contracts
     C                     MOVEL*BLANK    WUINCN  1
      * Define work field Treasury Management
     C                     MOVEL*BLANK    WUTRMG  1
      * Define work field Risk Management
     C                     MOVEL*BLANK    WURKMG  1
      * Define work field Testkey
     C                     MOVEL*BLANK    WUTSKY  1
      * Define work field Midas/Q
     C                     MOVEL*BLANK    WUMIDQ  1
      * Define work field Microfiche
     C                     MOVEL*BLANK    WUMFIC  1
      * Define work field Interest on accounts
     C                     MOVEL*BLANK    WUIOAC  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field SAR's processing required
     C                     MOVEL*BLANK    WUSARP  1
      * Define work field French  return indicator
     C                     MOVEL*BLANK    WUFRIN  1
      * Define work field Lux     return indicator
     C                     MOVEL*BLANK    WULRIN  1
      * Define work field Dutch   return indicator
     C                     MOVEL*BLANK    WUDRIN  1
      * Define work field German  return indicator
     C                     MOVEL*BLANK    WUGRIN  1
      * Define work field Belgian return indicator
     C                     MOVEL*BLANK    WUBRIN  1
      * Define work field Italian return indicator
     C                     MOVEL*BLANK    WUIRIN  1
      * Define work field Swift External Interface
     C                     MOVEL*BLANK    WUSWEI  1
      * Define work field Portfolio Management
     C                     MOVEL*BLANK    WUPFMG  1
      * Define work field Credit Management.
     C                     MOVEL*BLANK    WUCRMG  1
      * Define work field Head Office Reporting
     C                     MOVEL*BLANK    WUHORP  1
      * Define work field Average Balances
     C                     MOVEL*BLANK    WUAVBL  1
      * Define work field Margins
     C                     MOVEL*BLANK    WUMARG  1
      * Define work field Taxes
     C                     MOVEL*BLANK    WUNTST  1
      * Define work field Retail 3
     C                     MOVEL*BLANK    WUNXST  1
      * Define work field Interest on Accounts 3
     C                     MOVEL*BLANK    WUNYST  1
      * Define work field Charge for Mult Transacts
     C                     MOVEL*BLANK    WUCHMT  1
     C                     MOVE *LOVAL    URNORM  1         Highlight 0
     C                     BITON'2'       URNORM            NORMAL
      *
     C                     MOVE *LOVAL    URRIHS  1         Highlight 1
     C                     BITON'27'      URRIHS            RI/STEADY
      *
     C                     MOVE *LOVAL    URRIHF  1         Highlight 2
     C                     BITON'2467'    URRIHF            RI/HI/BLINK
     C/COPY WNCPYSRC,GL0121DC05
     C                     Z-ADD03        ##SFPG  30       SFLPAG
     C/COPY WNCPYSRC,GL0121DC06
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      **Scan*limit*****************************************************                     AR659451
     C**********           Z-ADD500       W0SLM   50                                        AR659451
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialise program
      * Standard RPG Creation Par - Standard functions  *
      * Last Amend Box - GL0121D - Journal Entry Posting  *
      * Start of S01314
      * Multi-Language - GL0121D - Journal Entry Posting  *
      *
      * Call SDRTVTXT pgm to access appropriate text
      *  for a field used in a SFL
      *
      * Type
     C                     MOVEL'ZZGBMSGF'MSGNM
     C                     MOVEL'ZZM3773' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C***********          MOVELMSGTXT    ZZM002                          S01413
     C                     MOVELMSGTXT    ZZM002  5                       S01413
      * Sub Type                                                          S01413
     C                     MOVEL'ZZM8533' MSGDNB                          S01413
     C                     CALL 'SDRTVTXT'                                S01413
     C                     PARM           MSGDNB  7                       S01413
     C                     PARM           MSGNM  10                       S01413
     C                     PARM           MSGTXT 80                       S01413
     C***********          MOVELMSGTXT    ZZM003                          S01413
     C                     MOVELMSGTXT    ZZM003  9                       S01413
      * Value Date:
     C                     MOVEL'ZZM0078' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C***********          MOVELMSGTXT    ZZM003                          S01413
     C                     MOVELMSGTXT    ZZM004 11                       S01413
      * Cheque:
     C                     MOVEL'ZZM3774' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C***********          MOVELMSGTXT    ZZM004                          S01413
     C                     MOVELMSGTXT    ZZM005  7                       S01413
      * Associated customer:
     C                     MOVEL'ZZM3775' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C***********          MOVELMSGTXT    ZZM005                          S01413
     C                     MOVELMSGTXT    ZZM008 20                       S01413
      * Swift:
     C                     MOVEL'ZZM3776' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C***********          MOVELMSGTXT    ZZM006                          S01413
     C                     MOVELMSGTXT    ZZM006  6                       S01413
      * Profit centre:
     C                     MOVEL'ZZM0086' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C***********          MOVELMSGTXT    ZZM007                          S01413
     C                     MOVELMSGTXT    ZZM007 14                       S01413
      * Book Code:
     C                     MOVEL'ZZM1604' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C***********          MOVELMSGTXT    ZZM008                          S01413
     C                     MOVELMSGTXT    ZZM009 10                       S01413
      * Void:                                                             S10736
     C                     MOVEL'ZZM8178' MSGDNB                          S10736
     C                     CALL 'SDRTVTXT'                                S10736
     C                     PARM           MSGDNB  7                       S10736
     C                     PARM           MSGNM  10                       S10736
     C                     PARM           MSGTXT 80                       S10736
     C***********          MOVELMSGTXT    ZZM009                    S10736S01413
     C                     MOVELMSGTXT    ZZM010  5                       S01413
      *                                                                   S10736
      * No. Items:                                                        S01413
     C***********          MOVEL'ZZM8535' MSGDNB                    S01413063607
     C***********          MOVEL'ZZM8720' MSGDNB                    063607084861
     C                     MOVEL'ZZM9271' MSGDNB                          084861
     C                     CALL 'SDRTVTXT'                                S01413
     C                     PARM           MSGDNB  7                       S01413
     C                     PARM           MSGNM  10                       S01413
     C                     PARM           MSGTXT 80                       S01413
     C                     MOVELMSGTXT    ZZM011 10                       S01413
      **Override*******                                                   S10736
     C*****************    MOVEL'ZZM3777' MSGDNB                          S10736
      * O'ride:                                                           S10736
     C                     MOVEL'ZZM8179' MSGDNB
     C                     CALL 'SDRTVTXT'
     C                     PARM           MSGDNB  7
     C                     PARM           MSGNM  10
     C                     PARM           MSGTXT 80
     C*****************    MOVELMSGTXT    ZZM009                          S10736
     C***********          MOVELMSGTXT    ZZM010                    S10736S01413
     C                     MOVELMSGTXT    ZZM012  7                       S01413
      * Original Ccy/Amount                                               CEU013
     C                     MOVEL'ZZN5914' MSGDNB                          CEU013
     C                     CALL 'SDRTVTXT'                                CEU013
     C                     PARM           MSGDNB  7                       CEU013
     C                     PARM           MSGNM  10                       CEU013
     C                     PARM           MSGTXT 80                       CEU013
     C                     MOVELMSGTXT    ZZM013 20                       CEU013
     C/COPY WNCPYSRC,GL0121DC07
      *
      * End of S01314
      * Setup message data for message
      * Retrieve message Lots of Dots
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'GLX0083' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           WUIEMG    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Copyright notice - Standard functions  *
      * Define 800 Byte Dummy DS - Standard functions  *
      * Currency Codes DS - Currency Codes  *
      * Access Midas rundate - Standard functions  *
     C*   Access MIDAS Rundate from data-area RUNDAT
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT
     C                     MOVE RDNO      WURDNO
     C                     MOVE SUCP      WUSUCP
     C                     MOVE DTFF      WUDTFF
     C                     MOVE MBIN      WUMBIN
      * start S01413
      * Define 200 Byte Dummy DS - Standard functions  *
      * MIDAS Modules DS - MIDAS Modules  *
      * Access MIDAS Modules. - MIDAS Modules  *
     C*
     C*  Access Midas Modules file for the file fields
     C*
     C                     CALL 'AOMMODR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*FIRST'  UUAPOP  7        I:Option
     C           D@MMOD    PARM *BLANK    UUFDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELBGMTMI    WUMTMI           Midas/Telex Module in
     C                     MOVELBGSWFT    WUSWFT           SWIFT Funds Transfer
     C                     MOVELBGSWST    WUSWST           SWIFT Securities Trad
     C                     MOVELBGSWCL    WUSWCL           SWIFT Customer Lend
     C                     MOVELBGSWSL    WUSWSL           SWIFT Syndicated Loan
     C                     MOVELBGSWSM    WUSWSM           SWIFT Statements
     C                     MOVELBGSWDL    WUSWDL           SWIFT Dealing
     C                     MOVELBGSDGL    WUSDGL           Standing Data/Gen Leg
     C                     MOVELBGDLFX    WUDLFX           Dealing : FX
     C                     MOVELBGSYLN    WUSYLN           Syndicated Loans
     C                     MOVELBGEXMG    WUEXMG           Exposure Management
     C                     MOVELBGFNMO    WUFNMO           Financial Modeller
     C                     MOVELBGSTRT    WUSTRT           Statuatory Returns
     C                     MOVELBGCSLN    WUCSLN           Customer Lending
     C                     MOVELBGRTBN    WURTBN           Retail Banking
     C                     MOVELBGMSDL    WUMSDL           Midas/SWIFT Direct lk
     C                     MOVELBGSECS    WUSECS           Securities
     C                     MOVELBGAURC    WUAURC           Auto-Reconcilliations
     C                     MOVELBGBDLI    WUBDLI           Bond Dealers Interfce
     C                     MOVELBGDRSD    WUDRSD           DRS Standing Data
     C                     MOVELBGDRCM    WUDRCM           DRS Control Module
     C                     MOVELBGDRFE    WUDRFE           DRS Foreign Exchange
     C                     MOVELBGDRMM    WUDRMM           DRS Money Markets
     C                     MOVELBGDRAR    WUDRAR           DRS Arbitrage
     C                     MOVELBGFDTR    WUFDTR           Funds Transfer
     C                     MOVELBGDRCA    WUDRCA           DRS Common Applic's
     C                     MOVELBGFUOP    WUFUOP           Futures & Options
     C                     MOVELBGMTSL    WUMTSL           Midas/Telex Syn Loans
     C                     MOVELBGMTDL    WUMTDL           Midas/Telex Dealing
     C                     MOVELBGMTGL    WUMTGL           Midas/Telex Gen Ledg
     C                     MOVELBGMTCL    WUMTCL           Midas/Telex Cust Len
     C                     MOVELBGNWMI    WUNWMI           Network Midas
     C                     MOVELBGFIIN    WUFIIN           FRA/IRS Indicator
     C                     MOVELBGDLMM    WUDLMM           Dealing:Money Markets
     C                     MOVELBGINCN    WUINCN           Internal Contracts
     C                     MOVELBGTRMG    WUTRMG           Treasury Management
     C                     MOVELBGRKMG    WURKMG           Risk Management
     C                     MOVELBGTSKY    WUTSKY           TestKey
     C                     MOVELBGMIDQ    WUMIDQ           Midas Q
     C                     MOVELBGMFIC    WUMFIC           Microfiche
     C                     MOVELBGIOAC    WUIOAC           Interest on Accounts
     C                     MOVELBGWDPR    WUWDPR           Window Processing Req
     C                     MOVELBGSARP    WUSARP           SAR's Processing Req
     C                     MOVELBGFRIN    WUFRIN           French Return Ind
     C                     MOVELBGLRIN    WULRIN           Lux Return Ind
     C                     MOVELBGDRIN    WUDRIN           Dutch Return Ind
     C                     MOVELBGGRIN    WUGRIN           German Return Ind
     C                     MOVELBGBRIN    WUBRIN           Belgian Return Ind
     C                     MOVELBGIRIN    WUIRIN           Italian Return Ind
     C                     MOVELBGSWEI    WUSWEI           SWIFT External Intfce
     C                     MOVELBGPFMG    WUPFMG           Portfolio Management
     C                     MOVELBGCRMG    WUCRMG           Credit Management
     C                     MOVELBGHORP    WUHORP           H.O. Reporting
     C                     MOVELBGAVBL    WUAVBL           Average Balances
     C                     MOVELBGMARG    WUMARG           Margins
     C                     MOVELBGNTST    WUNTST           Taxes          S01413
     C                     MOVELBGNXST    WUNXST           Retail 3       S01413
     C                     MOVELBGNYST    WUNYST           Int on A/C 3   S01413
     C*
     C                     MOVEL'N'       WUDNIT           Display no of i
      * CASE: WRK.Retail 3 is Yes
     C           WUNXST    IFEQ 'Y'                        *IF
      * Get Chrg for mult trans - Standard functions  *
     C                     CALL 'SD9343'               90  Get Chrg for mu
     C           W0RTN     PARM W0RTN     WQ0006  7        *Return code
     C           WUCHMT    PARM *BLANK    WQ0007  1        Charge for Mult
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Charge for Mult Transacts is Yes
     C           WUCHMT    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDNIT           Display no of i
     C                     END                             *FI
     C                     END                             *FI
      * end S01413
     C                     MOVEL'Y'       WUFKST           S01212
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0121DIPG - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121DCPG
     C                     END                             *FI
     C*                                                                   CEU013
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  WSARD   6                       CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     MOVE *OFF      *IN66            Display controlCEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     MOVE *ON       *IN66                           CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
      *                                                                                       CGL013
      ** Access SAR details file to see if CGL013 is installed.                               CGL013
      *                                                                                       CGL013
     C           *NAMVAR   DEFN           LDA                                                 CGL013
     C                     CALL 'AOSARDR0'                                                    CGL013
     C                     PARM *BLANKS   PRTCD   7                                           CGL013
     C                     PARM '*VERIFY' POPTN   7                                           CGL013
     C                     PARM 'CGL013'  PSARD   6                                           CGL013
     C           SCSARD    PARM SCSARD    UUFDY                                               CGL013
      *                                                                                       CGL013
     C           PRTCD     IFNE *BLANKS                                                       CGL013
     C           PRTCD     ANDNE'*NRF    '                                                    CGL013
     C           *LOCK     IN   LDA                                                           CGL013
     C                     MOVE 'SCSARDPD'DBFILE                                              CGL013
     C                     MOVEL'001'     DBASE                                               CGL013
     C                     MOVEL'CGL013'  DBKEY                                               CGL013
     C                     OUT  LDA                                                           CGL013
     C                     EXSR *PSSR                                                         CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           PRTCD     IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       CGL013  1                                           CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE 'N'       CGL013                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
      ** Access SAR details file to see if CER030 is installed.                             BUG23742
      *                                                                                     BUG23742
     C                     CALL 'AOSARDR0'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD   7                                         BUG23742
     C                     PARM '*VERIFY' POPTN   7                                         BUG23742
     C                     PARM 'CER030'  PSARD   6                                         BUG23742
     C           SCSARD    PARM SCSARD    UUFDY                                             BUG23742
      *                                                                                     BUG23742
     C           PRTCD     IFNE *BLANKS                                                     BUG23742
     C           PRTCD     ANDNE'*NRF    '                                                  BUG23742
     C           *LOCK     IN   LDA                                                         BUG23742
     C                     MOVE 'SCSARDPD'DBFILE                                            BUG23742
     C                     MOVEL'002'     DBASE                                             BUG23742
     C                     MOVEL'CER030'  DBKEY                                             BUG23742
     C                     OUT  LDA                                                         BUG23742
     C                     EXSR *PSSR                                                       BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           PRTCD     IFEQ *BLANK                                                      BUG23742
     C                     MOVE 'Y'       CER030  1                                         BUG23742
     C                     ELSE                                                             BUG23742
     C                     MOVE 'N'       CER030                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * SRADIN - Subroutine to Process Additional Information Field   *                       CGL013
      *                                                               *                       CGL013
      * Called by:                                                    *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           SRADIN    BEGSR                                                              CGL013
      *                                                                                       CGL013
     C           #1ADIN    IFEQ *BLANK                                                        CGL013
     C                     MOVE 'N'       #1ADIN                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           #1ADIN    IFNE 'Y'                                                           CGL013
     C           #1ADIN    ANDNE'N'                                                           CGL013
     C                     MOVE *ON       *IN64                                               CGL013
     C                     MOVE *ON       *IN65                                               CGL013
     C                     MOVEL'USR0912' ZAMSID                                              CGL013
     C                     EXSR ZASNMS                                                        CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE *OFF      *IN65                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           #1ADIN    IFEQ 'Y'                                                           CGL013
      *                                                                                     BUG23742
     C           PREV      TAG                                                              BUG23742
      *                                                                                     BUG23742
     C                     MOVEL#1BINB    PABINB  3                                           CGL013
     C                     MOVEL#1RACN    PARACN 10                                           CGL013
     C                     CALL 'GL000185'                                                    CGL013
     C                     PARM *BLANKS   PRTCD                                               CGL013
     C                     PARM           PDETLS                                              CGL013
     C                     PARM *BLANK    PADD    1                                           CGL013
     C                     PARM 'E'       PMODE   1                                           CGL013
     C                     PARM '0'       PEXIT1  1                                         BUG23742
     C                     PARM '0'       PCANC1  1                                         BUG23742
     C                     PARM           PVBIPX                                              246418
     C                     PARM 'N'       APIMOD  1                                           246418
     C                     PARM           FLDNMA                                              246418
     C                     PARM           MSGIDA                                              246418
     C                     PARM           MSGDTA                                              246418
      *                                                                                       CGL013
     C                     MOVE 'N'       #1ADIN                                              CGL013
     C                     MOVE *ON       *IN64                                               CGL013
      *                                                                                     BUG23742
     C           PCANC1    IFEQ '1'                                                         BUG23742
     C                     GOTO ENDDIN                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           PEXIT1    IFEQ '1'                                                         BUG23742
     C                     EXSR ZYEXPG                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           CER030    IFEQ 'Y'                                                         BUG23742
     C                     MOVELBTPTDT    PDATE                                             BUG23742
     C                     CALL 'GL000186'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD                                             BUG23742
     C                     PARM           PDETLS                                            BUG23742
     C                     PARM           PDATE   50                                        BUG23742
     C                     PARM *BLANK    PADD    1                                         BUG23742
     C                     PARM 'E'       PMODE   1                                         BUG23742
     C                     PARM '0'       PEXIT   1                                         BUG23742
     C                     PARM '0'       PCANC   1                                         BUG23742
     C                     PARM           FLDNMA                                            BUG23742
     C                     PARM           MSGIDA                                            BUG23742
     C                     PARM           MSGDTA                                            BUG23742
      *                                                                                     BUG23742
     C                     MOVE *ON       *IN60                                             BUG23742
      *                                                                                     BUG23742
     C           PCANC     IFEQ '1'                                                         BUG23742
      *                                                                                     BUG23742
     C           CGL013    IFEQ 'Y'                                                         BUG23742
     C                     GOTO PREV                                                        BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           PEXIT     IFEQ '1'                                                         BUG23742
     C                     EXSR ZYEXPG                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           ENDDIN    TAG                                                              BUG23742
      *                                                                                     BUG23742
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * *PSSR  - Program exception error routine                      *                       CGL013
      *          Called automatically if a program error occurs,      *                       CGL013
      *          or directly by the program code using EXSR.          *                       CGL013
      *          This subroutine DUMPs the program just once.         *                       CGL013
      *                                                               *                       CGL013
      * Called by: ZZINIT                                             *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           *PSSR     BEGSR                                                              CGL013
      *                                                                                       CGL013
     C           @RUN      IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       @RUN    1                                           CGL013
     C                     DUMP                                                               CGL013
     C                     CALL 'DBERRCTL'                                                    CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     MOVE *ON       *INU7                                               CGL013
     C                     MOVE *ON       *INU8                                               CGL013
     C                     MOVE *ON       *INLR                                               CGL013
     C                     RETRN                                                              CGL013
      *                                                                                       CGL013
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
     O/COPY WNCPYSRC,GL0121DOPG
** Item Error Message
Err:
----------------------------------------------------------------------------
** CPY@
(c) Finastra International Limited 2001
