     H**********  Y                                                                           CER001
     H        1   Y                                                                           CER001
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL JEs report batch items - all batches')        *
     H/TITLE Midas GL All Batch Report
     Z* CRTRPGPGM
     Z* IGNDECERR(*YES)
      *
     H* SYNOPSIS :
     H* - Print report of file contents.
     H* Generated by  : Synon/2  Version:  8646
     H* Function type : Print file  Version:   0.1
      *
     H*  Company :
     H* System     : General Ledger Synon Model
     H* User name  : F7387SY
     H* Date       : 15/10/90 time: 16:32:46
      *  (c) Finastra International Limited 2001                      *
     H*
      *================================================================
     M* Maintenance   :
      *================================================================
     F*                                                               *
     F*     DATE   - 28.09.89                                         *
     F*                                                               *
     F*     S01212 - WINDOW PROCESSING INSTALLED - /COPY              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  Last Amend No. LUC110             Date 22Jan19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CGL182             Date 11May17               *
      *                 MD037579           Date 23Nov16               *
      *                 MD033571           Date 27Mar15               *
      *                 AR1065437          Date 23Jan13               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23742           Date 09May09               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 239576             Date 16Apr07               *
      *                 GOC001             Date 31Aug06               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 240354             Date 05Jul06               *
      *                 CER001             Date 25Apr05               *
      *                 BUG6955            Date 15Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL013             Date 29Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CGL008             Date 08Mar99               *
      *                 148771             DATE 04Dec98               *
      *                 CEU013             DATE 02Apr98               *
     F*                 097910             DATE 19FEB98               *
     F*                 105427             DATE 07APR97               *
     F*                 096517             DATE 04MAR97               *
     F*                 098827             DATE 12FEB97               *
     F*                 110546             Date 28OCT96               *
     F*                 S01408             Date 05SEP95               *
     F*                 S01408             DATE 04AUG95               *
     F*                 S01413                  13APR93               *
     F*                 S10736                  09SEP92               *
     F*                 E38270                  06JUL92               *
     F*                 E36338                  25FEB92               *
     F*                 E28128                  14FEB92               *
     F*                 S01340                  23SEP91               *
     F*                 S01333                  04APR91               *
     F*                 LN0958                  03JAN91               *
     F*                 LN0955                  03JAN91               *
     F*                 LN0882                  19OCT90               *
     F*                 LN0837                  04OCT90               *
     F*                 LN0714                  07SEP90               *
     F*                 LN0315                  06JUN90               *
     F*                 E19846                  23OCT89               *
     F*                 E18852                  28SEP89               *
     F*                 S01212                  11SEP89               *
     F*****************************************************************
     F*                                                               *
      *  LUC110 - Extended Narratives (Upgrade NUC002 to FBM 2.1)     *
      *           Use of core hook GL0121PC04                         *
      *           Use of core hook GL0121PC08                         *
      *           Use of core hook GL0121PC13                         *
      *           Use of core hook GL0121PC15                         *
      *           Use of core hook GL0121PC25                         *
      *           Use of core hook GL0121PC26                         *
      *           Use of core hook GL0121PC27                         *
      *           Use of core hook GL0121PC28                         *
      *           Use of core hook GL0121PC29                         *
      *           Use of core hook GL0121PFPG                         *
      *           Addition of hook LUC110_051                         *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL182 - Journal Entry via the Interface File - Java Version *
      *           (Recompile)                                         *
      *  MD037579 - Truncated decimal places for the total amount     *
      *             input and calculated                              *
      *  MD033571 - Additional Information not correctly output.      *
      *             Recompile program. Caused by CGL135A in GL0121PM. *
      *  AR1065437 - Extra fields on PEA Audit Report                 *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23742 - Improper handling of Ext Narr from Batch          *
      *             Interface Input                                   *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CSC042 - COB performance fixes                               *
      *           Cache CCY data rather than keep calling AOCURRR*    *
      *  239576 - Journal Entries (batch items) split by branch       *
      *           include all batches in one report. Apply fix 235449.*
      *  GOC001 - Account Posting (Journal Entry) Input Amendments    *
      *           Added core hooks: GL0121PC32                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  240354 - Pass currency code BTCYCD from file GLJENPL3        *
      *           into the parameter @CYCD when calling the           *
      *           program AOCURRR0 in subroutine BAPRHDR              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *         - Modified to display only 2 decimal places instead   *
      *            of 3 in the amount fields.                         *
      *  BUG6955 - Change Value date format from dd/mm/yy to ddMMMyy  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL013 - MT94x Messages Generation                           *
      *  CGL008 - Security on Journal Entry                           *
     F*  148771 - If acc not found blank acc name .                   *
     F*  CEU013 - EMU Account Postings Narrative                      *
     F*  097910 - CHECK RETAIL INDICATORS CORRECTLY.                  *
     F*  105427 - Report GL0121P had no records when entity is 001    *
     F*  096517 - Missing Branch Code for Multi-Br Batches            *
     F*  098827 - Access the Batch Header file for the branch code    *
     F*           everytime the header format is written.             *
     F*  110546 - Override details are not printed properly as retail *
     F*           indicator is incorrectly setup.                     *
     F*  S01408 - Addition of Core Hooks GL0121PCP3.                  *
     F*  S01408 - Addition of core hooks GL0121PCP1.                  *
     F*           Addition of core hooks DL0121PCP2.                  *
     F*  S01413 - Retail 3 Incorporation.                             *
     F*  S10736 - ADD REVERSAL/VOID INDICATOR                         *
     F*  E38270 - NO BRANCH SHOULD BE SHOWN WHEN SINGLE BRANCHING     *
     F*  E36338 - Add AU report                                       *
     F*  E28128 - Take out Error Fix LN0955                           *
     F*  S01340 - MIS Release 10 Changes.                             *
     F*  S01333 - MIS Release 10 - Spread Journal Changes             *
     F*  LN0958 - ENSURE THAT THE BRANCH CODE PASSED TO ZSFILE AS     *
     F*           ENTITY                                              *
     F*  LN0955 - PREVENT REPORT FROM BEING PRODUCED WHEN THERE ARE   *
     F*           NO DETAILS                                          *
     F*  LN0882 - STANDARDISE REPORT TITLES                           *
     F*  LN0837 - CHANGE FROM SYSTEM LEVEL REPORT TO BRANCH           *
     F*           SPECIFIC                                            *
     F*                                                               *
     F*  LN0714 - Replace the call to the Batch Report Functions      *
     F*           which were called interactively with a call to      *
     F*           FCC0201 and FCC0202 for RCF in order for the        *
     F*           reports to be run in batch.                         *
     F*                                                               *
     F*  LN0315 - ADD RETAIL INDICATOR ON CALL TO AOACCTR0            *
     F*                                                               *
     F*  E19846 - TO MONITOR FOR BATCHES THAT ARE NOT ACCEPTED        *
     F*                                                               *
     F*  E18852 - TO STOP JOURNAL ENTRIES BEING POSTED ACROSS         *
     F*           DIFFERENT BRANCHES                                  *
     F*                                                               *
     F*  S01212 - WINDOW PROCESSING BEING ALLOWED. /COPY STATEMENTS   *
     F*           HAVE BEEN ADDED TO EACH USER POINT                  *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,GL0121PFPG
     FGLJENPL3IF  E           K        DISK
      * RSQ: Midas GL JE Post  Hdr Branch/Batch/Item No
      *
     FGLJENHL1IF  E           K        DISK
      * RTV: Midas GL Journal Entry Header LF Rtv
      *
     FTABTBRE IF  E                    DISK                               S01413
      * RTV: Midas Retail 3 ICD                                   S01413
      *                                                                   S01413
     FGLJENXL2IF  E           K        DISK         KINFSR *PSSR                              CGL013
      ** RTV: Midas GL Journal Entry File - Additional Information                            CGL013
      *                                                                                       CGL013
     FGLMNARL3IF  E           K        DISK         KINFSR *PSSR                            BUG23742
      ** RTV: Midas GL MultiCash Narratives File                                            BUG23742
      *                                                                                     BUG23742
     FGLJEPQL0IF  E           K        DISK         KINFSR *PSSR                           AR1065437
     FGLJENQL0IF  E           K        DISK         KINFSR *PSSR                           AR1065437
      ** RTV: Journal Entry Detail Extension File                                          AR1065437
      *                                                                                    AR1065437
     F*GL0121PMO   E             97     PRINTER                           LN0955
     F*GL0121PMO***E*****        97     PRINTER                       UC  LN0955
     F*GL0121PMO   E             97     PRINTER                    E28128 E36338
     FGL0121PMO   E             97     PRINTER                        UC  E36338
     F                                              KINFDS INFDS$
     FGL0121AUO   E                    PRINTER                        UC  E36338
     F                                              KINFDS INFDSA         E36338
      * PRT: Midas GL All Batch Report
      *
     F/COPY WNCPYSRC,GL0121PF01
     E                    @IH         8 10               Item Err.slots
     E                    CPY@    1   1 80               Copyright     array
     E                    UHDR    1   2 53
     E/COPY WNCPYSRC,GL0121PEPG
     E                    IUL         3132                                                    CER001
      *                                                                                       CER001
      ** IBLC Extended informations array                                                     CER001
      *                                                                                       CER001
     E                    @CN     1  22 25               Long constants.
     E                    CURR      150  3               Currency                             CSC042
     E                    #CDP      150  1 0             Decimal Places                       CSC042
     E                    #CNM      150 14               CCY Names                            CSC042
     E                    #CNO      150 10               Nostro Names                         CSC042
      *
     I*   Define MIDAS Rundate from data-area RUNDAT
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I/COPY WNCPYSRC,GL0121PIPG
     IILLINE      DS                            396                                           CER001
      *                                                                                       CER001
      ** Extended informations from IBLC 2002                                                 CER001
      *                                                                                       CER001
     I                                        1 132 ILLIN1                                    CER001
     I                                      133 264 ILLIN2                                    CER001
     I                                      265 396 ILLIN3                                    CER001
      *                                                                                       CER001
      /EJECT
      * Data structures:-
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     IJBDTTM      DS
      * Job date/time.
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure.
      *
     IINFDSA      DS                                                      E36338
     I                                       83  92 SFILEU                E36338
     I                                    B 123 1240SFNUMU                E36338
     I** AU printer file information data structure                       E36338
     I*                                                                   E36338
     I            DS
     I                                        1   30ULVAL2
     I                                        1   99ULVALD
      * Set up parameters :
     IUUDTNF      DS
     I                                        1   2 UUSLT1
     I                                        3   4 UUSLT2
     I                                        5   6 UUSLT3
      *
     IUUVDTP      DS
     I                                        1   2 UUALT1
     I                                        3   3 UUSLT4
     I                                        4   5 UUALT2
     I                                        6   6 UUSLT5
     I                                        7   8 UUALT3
      *
     IGLREOV      DS
      * Retail Override data area data structure
     I                                        1   1 URRE01
     I                                        2   2 URRE02
     I                                        3   3 URRE03
     I                                        4   4 URRE04
     I                                        5   5 URRE05
     I                                        6   6 URRE06
     I                                        7   7 URRE07
     I                                        8   8 URRE08
     I                                        9   9 URRE09
     I                                       10  10 URRE10
      *
     IURERTX      DS
      * Item error status data structure
     I                                        1  80 @IH
      *
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNO
     I                                       11  11 SUCP
     I                                       12  12 DTFF
     I                                       13  13 MBIN
     I*
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
     IUUFDY     E DSDSFDY
     I*
     I* 200 Byte Data Structure for Incoming Data from Access Program
     I*
     IUUSDY     E DSDSSDY
     I*
     I* 800 Byte Data Structure for Incoming Data from Access Program
     I*
     ID@CURR    E DSSDCURRPD
     I*
     I*  Currency Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@NARR    E DSSDNARRPD
     I*
     I*  Narrative Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@ACCT    E DSACCNTAB
     I*
     I*  Account Details DS for assigning data from Access
     I*  Programs to work fields
     I*
     IP@BJRF    E DSSDBANKPD
     I* @BTREE4 - BANK RECORD FORMAT DATA STRUCTURE
     I*
     ID@BRCH    E DSSDBRCHPD
     I*
     I*  Branch Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@GELR    E DSSDGELRPD
     I*
     I*  General Ledger Details DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@DEPT    E DSSDDEPTPD
     I*
     I*  Department Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@CUST    E DSSDCUSTPD
     I              QQDFAC                          DFACQQ                                    CGL029
     I*
     I*  Client Details DS for assigning data from Access
     I*  Programs to work fields
     I/COPY WNCPYSRC,GL0121PI02
     I*
     ID@MMOD    E DSSDMMODPD                                              S01413
     I*                                                                   S01413
     I*  Module Details DS for assigning data from Access                 S01413
     I*  Programs to work fields                                          S01413
     I*                                                                   S01413
     I/COPY WNCPYSRC,GL0121PI01
      /EJECT
      * Parameter declarations.
     IP1PARM      DS
      * I:MAP RCF Sequence Number
     I                                        1   5 P1RSQN
     IP2PARM      DS
      * I:MAP Level
     I                                        1   1 P2LEVL
     IP3PARM      DS
      * I:MAP Entity
     I                                        1   3 P3ENTY
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Batch in use message 1'
      * Message data for 'Batch in use message 2'
      * Message data for 'Batch in use message 3'
      * Message data for 'Batch in use message 4'
      * Message data for 'Batch in use message 5'
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
     C                     PARM           P0RTN   7        Return code
     C           P1RSQN    PARM           WP0001  5        RCF Sequence Nu
     C           P2LEVL    PARM           WP0002  1        Level
     C           P3ENTY    PARM           WP0003  3        Entity
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
     C/COPY WNCPYSRC,GL0121PC08
      *
      * Clear overflow indicator.
     C                     SETOF                     97
      * Establish starting position.
     C           *LOVAL    SETLL@JENPCL                    *
     C/COPY WNCPYSRC,GL0121PC24
      * Read first record with user selection.
     C                     EXSR GARDRC
      * Print null report headings.
     C           W0EOF     IFEQ '1'
     C***********                                                  LN0955 E28128
     C***IF*THERE*ARE*NO*DETAILS*THEN*EXIT*THE*PROGRAM             LN0955 E28128
     C***********                                                  LN0955 E28128
     C***********          EXSR ZXEXPG                                    LN0955
     C*********************WRITEZZPAGHDR                                  LN0955
      **USER:*Null*report*processing**************************************LN0955
      *CASE:*****WRK.S01212*is*Fix*Installed******************************LN0955
     C***********WUFKST****IFEQ @CN,01                     *IF            LN0955
      **00/Copy*Member*GL0121PNRP*-*Journal*Entry*Posting*****************LN0955
     C*/COPY WNCPYSRC,GL0121PNRP                                          LN0955
     C*00/Copy*Member*GL0121P***Null*Report*Processing********************LN0955
     C*********************END                             *FI            LN0955
     C*********************WRITEZZENDRPT                                  LN0955
     C***********          ELSE                                           E28128
     C***********                                                   LN0955E28128
     C***OPEN*THE*PRINTER*FILE                                      LN0955E28128
     C***********                                                   LN0955E28128
     C***********          OPEN GL0121PM                            LN0955E28128
      **ZSFile*-*Log*Spool*File*-*Standard*functions***             LN0955E28128
     C***********                                                   LN0955E28128
     C**Set*up*spool*file*number*-*Standard*Functions               LN0955E28128
     C***********          Z-ADD@$FNB     WUSFNB                    LN0955E28128
     C***********          MOVE *BLANKS   UUSRSQ  5                 LN0955E28128
     C***********                                                   LN0955E28128
     C**ZSFILE*-*write*report*rqs*-*Standard*Functions  *           LN0955E28128
     C***********          CALL 'ZSFILE'               90  ZSFIrite LN0955E28128
     C***********UUSRSQ    PARM P1RSQN    UURSQN  5        RCF ce nuLN0955E28128
     C***********          PARM BTIBCA    UUENTY  3        Enti     LN0958E28128
     C***********          PARM @$FVN     UUSFNM 10        Spoo nameLN0955E28128
     C***********          PARM WUSFNB    UUSFNB  60       Spoo numbLN0955E28128
     C***********WUZSER    PARM *BLANK    UUZSER  1        ZSFIor   LN0955E28128
     C***********                                                   LN0955E28128
     C************IN90     IFEQ '1'                                 LN0955E28128
     C**Call*to*program*ended*in*error.                             LN0955E28128
     C***********          MOVEL'Y2U0021' W0RTN   7                 LN0955E28128
     C***********          END                                      LN0955E28128
     C***********                                                   LN0955E28128
     C**CASE:*WRK.ZSFILE*is*error*occurred                          LN0955E28128
     C***********                                                   LN0955E28128
     C***********WUZSER    IFEQ 'Y'                                 LN0955E28128
     C***********          MOVEL'Y2U0004' P0RTN                     LN0955E28128
     C***********          EXSR ZYEXPG                              LN0955E28128
     C***********          END                                      LN0955E28128
     C***********          WRITEZZPAGHDR                            E28128E36338
     C** OPEN THE PRINTER FILE                                            E36338
     C*                                                                   E36338
     C                     OPEN GL0121AU                                  E36338
      * ZSFILE - Log Spool File                                           E36338
     C*                                                                   E36338
     C* Set up spool file number                                          E36338
     C                     Z-ADDSFNUMU    WUSFNB                          E36338
     C                     MOVE *BLANKS   UUSRSQ  5                       E36338
     C*                                                                   E36338
     C* ZSFILE - write report rqs                                         E36338
     C                     CALL 'ZSFILE'               90                 E36338
     C           UUSRSQ    PARM P1RSQN    UURSQN  5                       E36338
     C                     PARM *BLANKS   UUENTY  3                       E36338
     C                     PARM SFILEU    UUSFNM 10                       E36338
     C                     PARM WUSFNB    UUSFNB  60                      E36338
     C           WUZSER    PARM *BLANK    UUZSER  1                       E36338
     C*                                                                   E36338
     C           *IN90     IFEQ '1'                                       E36338
     C* Call to program ended in error.                                   E36338
     C                     MOVEL'Y2U0021' W0RTN   7                       E36338
     C                     END                                            E36338
     C*                                                                   E36338
     C* CASE: WRK.ZSFILE is error occurred                                E36338
     C*                                                                   E36338
     C           WUZSER    IFEQ 'Y'                                       E36338
     C                     MOVEL'Y2U0004' P0RTN                           E36338
     C                     EXSR ZYEXPG                                    E36338
     C                     END                                            E36338
     C                     WRITEZZPAGHDA                                  E36338
      *USER: Null report processing                                       E28128
      *CASE:     WRK.S01212 is Fix Installed                              E28128
     C           WUFKST    IFEQ @CN,01                     *IF            E28128
      **00/Copy Member GL0121PNRP - Journal Entry Posting                 E28128
     C/COPY WNCPYSRC,GL0121PNRP                                           E28128
      *00/Copy Member GL0121P   Null Report Processing                    E28128
     C                     END                             *FI            E28128
     C                     SETON                     78                   E28128
     C                     WRITEZZENDRPT                                  E28128
     C                     ELSE                                           E28128
     C*                                                                   E28128
     C** OPEN THE PRINTER FILE                                            E36338
     C*                                                                   E36338
     C                     OPEN GL0121PM                                  E36338
     C**Set up spool file number                                          E36338
     C                     Z-ADD@$FNB     WUSFNB                          E36338
     C                     MOVE *BLANKS   UUSRSQ  5                       E36338
     C**                                                                  E36338
      **ZSFILE - write report rqs                                         E36338
     C                     CALL 'ZSFILE'               90                 E36338
     C           UUSRSQ    PARM P1RSQN    UURSQN  5                       E36338
     C**********           PARM BTIBCA    UUENTY  3                                    E36338 239576
     C                     PARM BTBCBH    UUENTY  3                                           239576
     C                     PARM @$FVN     UUSFNM 10                       E36338
     C                     PARM WUSFNB    UUSFNB  60                      E36338
     C           WUZSER    PARM *BLANK    UUZSER  1                       E36338
     C**                                                                  E36338
     C           *IN90     IFEQ '1'                                       E36338
     C**Call to program ended in error.                                   E36338
     C                     MOVEL'Y2U0021' W0RTN   7                       E36338
     C                     END                                            E36338
     C**                                                                  E36338
     C**CASE: WRK.ZSFILE is error occurred                                E36338
     C**                                                                  E36338
     C           WUZSER    IFEQ 'Y'                                       E36338
     C                     MOVEL'Y2U0004' P0RTN                           E36338
     C                     EXSR ZYEXPG                                    E36338
     C                     END                                            E36338
      * Request all headings.
     C                     MOVEL'Y'       L0      1        Page headings
     C                     MOVEL'Y'       L1      1        Branch Code (Ba
     C                     MOVEL'Y'       L2      1        Batch number
      * Initialise final totals.
     C                     MOVEL*BLANK    ZTCON            *CON (Screen co
      * Print report body.
     C           W0EOF     DOWEQ'0'
      * Print headings.
     C                     EXSR BAPRHD
      * Print report detail line.
     C                     EXSR CAPRDT
      * Hold current values.
     C           *LIKE     DEFN BTBCBH    WZBCBH           Branch Code (Ba
     C                     MOVELBTBCBH    WZBCBH
     C           *LIKE     DEFN BTBTNB    WZBTNB           Batch number
     C                     MOVELBTBTNB    WZBTNB
      * Read next record with user selection.
     C                     EXSR GARDRC
      * Determine level changes.
     C                     EXSR DALVCH
      * Print totals.
     C                     EXSR EAPRTT
      * Process necessary heading requests
     C                     EXSR FASGHD
     C                     END
     C**********           WRITEZZENDRPT                                  E36338
     C                     END
      * Exit program.
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *****************************************************************
      /EJECT
     CSR         BAPRHD    BEGSR
      *================================================================
      * Print report Headers.
      *================================================================
     C           L0        IFEQ 'Y'
     C                     WRITEZZPAGHDR
     C                     END
      *
     C                     MOVEL'0'       *IN80                           E38270
     C           WUMBIN    IFEQ @CN,04                     *IF            E38270
     C                     MOVEL'1'       *IN80                           E38270
     C                     END                             *FI            E38270
      *                                                                   E38270
     C***********L1        IFEQ 'Y'                                       098827
      * Load format.
      * Retrieve Header fields - Journal Entry Header  *                  096517
     C                     EXSR SARVGN                                    096517
     C***********          MOVELBTBCBH    Z1BCBH           Branch Code (Ba096517
     C                     MOVELWUBCDA    Z1BCBH                          096517
     C                     MOVEL*BLANK    Z1BNMD           Branch name (di
      * Load related total format.
     C***********          MOVELBTBCBH    Z4BCBH           Branch Code (Ba096517
     C                     MOVELWUBCDA    Z4BCBH           Branch Code (Ba096517
     C***********          END                                            098827
      *
     C           L1        IFNE *BLANK
     C                     MOVEL'Y'       W0PFM
      * User: Process Branch Code (Batch Headr) headings.
      * Access Branch Codes. - Branch Codes  *
     C*
     C*  Access Branch codes file for the file fields
     C*
     C                     MOVELZ1BCBH    UUBRCD
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM @CN,02    UUAPOP  7        I:Option
     C                     PARM           UUBRCD  3        I:Branch Code
     C********** D@BRCH    PARM *BLANK    UUFDY            O:Format                           CGL029
     C           D@BRCH    PARM *BLANK    UUSDY                                               CGL029
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELA8BRCD    WUBRCD           O:Branc Code
     C                     MOVELA8CMCD    WUCMCD           O:Company Code
     C                     MOVELA8LCCD    WULCCD           O:Location Code
     C                     MOVELA8DFAC    WUDFAC           O:Due From a/c Code
     C                     MOVELA8DTAC    WUDTAC           O:Due To a/c Code
     C                     MOVELA8BICN    WUBICN           O:Branch Internal Cus
     C                     MOVELA8BRNM    Z1BNMD           O:Branch Name
     C                     MOVELA8GBCD    WUGBCD           O:Global Branch Code
     C                     MOVELA8BRSN    WUBRSN           O:Branch Shortname
     C*
     C           W0PFM     IFEQ 'Y'
      * Print format.
     C**********           WRITEZ1KEYHDR                                  E38270
     C  N80                WRITEZ1KEYHDR                                  E38270
     C                     END
     C                     END
      *
     C           L2        IFEQ 'Y'
      * Load format.
     C                     MOVELBTBCBH    Z2BCBH           Branch Code (Ba
     C                     MOVEL*BLANK    Z2BCDP           Branch Code (Pr
     C                     MOVELBTBTNB    Z2BTNB           Batch number
     C                     MOVEL*BLANK    Z2BSTS           Batch status
     C                     MOVEL*BLANK    Z2BUM1           Batch in use ms
     C                     MOVEL*BLANK    Z2FMA2           Formatted amoun
     C                     MOVEL*BLANK    Z2DCDP           Department Code
     C                     MOVEL*BLANK    Z2DNDS           Department name
     C                     MOVEL*BLANK    Z2BUM2           Batch in use ms
     C                     MOVEL*BLANK    Z2FMAM           Formatted amoun
     C                     MOVEL*BLANK    Z2MBIP           Multiple Branch
     C                     MOVEL*BLANK    Z2BUM3           Batch in use ms
     C                     Z-ADD*ZERO     Z2IINP           Items Input (Pr
     C*********************MOVEL*BLANK    Z2REVI           Reversal/void  S01340
     C                     MOVEL*BLANK    Z2BDSC           batch descripti
     C                     MOVEL*BLANK    Z2TIDP           Terminal I.D. (
     C                     MOVEL*BLANK    Z2BUM4           Batch in use ms
     C                     Z-ADD*ZERO     Z2ICLP           Items Calculate
     C                     MOVEL*BLANK    Z2BUM5           Batch in use ms
     C                     MOVEL*BLANK    Z2BSTD           Batch Status (DS01333
      * Load related total format.
     C                     MOVELBTBTNB    Z3BTNB           Batch number
     C                     MOVELBTBCBH    Z3BCBH           Branch Code (Ba
     C/COPY WNCPYSRC,GL0121PC22
     C                     END
      *
     C           L2        IFNE *BLANK
     C                     MOVEL'Y'       W0PFM
      * User: Process Batch number headings.
      * Retrieve Header fields - Journal Entry Header  *
     C                     EXSR SARVGN
      *                                                                                       CER001
      ** Retrieve decimal places to pass to GL0138U                                           CER001
      *                                                                                       CER001
     C                     CALL 'AOCURRR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD                                               CER001
     C                     PARM '*KEY   ' @OPTN                                               CER001
     C**********           PARM           @CYCD   3                                    CER001 240354
     C                     PARM BTCYCD    @CYCD   3                                           240354
     C           D@CURR    PARM *BLANK    UUSDY                                               CER001
      *                                                                                       CER001
     C                     MOVELWUBUM1    Z2BUM1           Batch in use ms
     C                     MOVELWUBUM2    Z2BUM2           Batch in use ms
     C                     MOVELWUBUM3    Z2BUM3           Batch in use ms
     C                     MOVELWUBUM4    Z2BUM4           Batch in use ms
     C                     MOVELWUBUM5    Z2BUM5           Batch in use ms
      * Hash numeric to character - Standard functions  *
     C                     Z-ADDWUHIIN    ULVALI           Integer portion
     C                     Z-ADD*ZERO     ULVALD           Set Decimal
     C                     Z-ADDWUHDIN    ULVAL2           Decimal portion
      *
      ** Use 2 decimal places for the total input and calculated amount                     MD037579
      *                                                                                     MD037579
     C                     Z-ADD2         WNBDP   10                                        MD037579
     C                     CALL 'GL0138U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALI 150       I:Integer
     C                     PARM ULVALD    ULVAL3  99       I:Decimal
     C**********           PARM 3         ULDECP  10       I:Decimal place                    CER001
     C**********           PARM A6NBDP    ULDECP  10       I:Decimal place           CER001 MD037579
     C                     PARM WNBDP     ULDECP  10                                        MD037579
     C                     PARM @CN,03    ULEDIT  1        I:IBM Edit code
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLT 32        O:Formatted
      *
     C                     MOVE ULRSLT    Z2FMA2           Formatted data
      *
      * Hash numeric to character - Standard functions  *
     C                     Z-ADDWUHICC    ULVALI           Integer portion
     C                     Z-ADD*ZERO     ULVALD           Set Decimal
     C                     Z-ADDWUHDCC    ULVAL2           Decimal portion
     C                     CALL 'GL0138U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALI 150       I:Integer
     C                     PARM ULVALD    ULVAL3  99       I:Decimal
     C**********           PARM 3         ULDECP  10       I:Decimal place                    CER001
     C**********           PARM A6NBDP    ULDECP           I:Decimal place           CER001 MD037579
     C                     PARM WNBDP     ULDECP           I:Decimal place                  MD037579
     C                     PARM @CN,03    ULEDIT  1        I:IBM Edit code
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLT 32        O:Formatted
     C                     MOVE ULRSLT    Z2FMAM           Formatted data
      * Access Department. - Department Codes  *
     C*
     C*  Access Department codes file for the following field:
     C*  Department Name
     C*
     C                     MOVELWUDPCD    UUDPCD
     C                     CALL 'AODEPTR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM @CN,02    UUAPOP  7        I:Option
     C                     PARM           UUDPCD  3        I:Department Code
     C           D@DEPT    PARM *BLANK    UUFDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELAEDPCD    Z2DCDP           Department Code
     C                     MOVELAEDPNM    Z2DNDS           Department Name
     C*
      * CUR.Batch status (Display) = Condition name of WRK.Batch statusflag
     C                     CALL 'MIRVCNR'              90  *
     C                     PARM           W0RTN   7        Return code
     C                     PARM 1100442   Y2LSNO  70       List number
     C                     PARM WUBTSF    W0INVL 20        Batch status fl
     C                     PARM 'N'       W0VLMP  1        Value mapped?
     C           Z2BSTD    PARM           W0CNNM 25        Batch status
      *
     C                     MOVELWUBDES    Z2BDSC           batch descripti
     C*********************MOVELWURVVD    Z2REVI           Reversal/void  S01340
     C                     MOVELWUBTNB    Z2BTNB           Batch number
     C                     MOVELWUWSID    Z2TIDP           Terminal I.D. (
     C                     Z-ADDWUHINI    Z2IINP           Items Input (Pr
     C                     Z-ADDWUHINC    Z2ICLP           Items Calculate
     C                     MOVELWUMBRB    Z2MBIP           Multiple Branch
      *                                                                   CGL008
      ** If feature CGL008 is ON, retrieve the Last Insert & Amend User   CGL008
      *                                                                   CGL008
     C           CGL008    IFEQ 'Y'                                       CGL008
     C/COPY WNCPYSRC,GL0121PC32
     C                     MOVELWUUSRI    Z2USRI                          CGL008
     C                     MOVELWUUSRA    Z2USRA                          CGL008
     C                     ENDIF                                          CGL008
      *                                                                   CGL008
     C/COPY WNCPYSRC,GL0121PC03
      *CASE:     WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ @CN,01                     *IF
      * 00/Copy Member GL0121PPLH - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121PPLH
     C*00/Copy Member GL0121P   Print Level Headings
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print format.
      * Convert fields to external form.
     C                     MOVEL'0'       *IN79
     C           WUBIUF    IFEQ *BLANK                     *IF
     C           WUBIUF    OREQ @CN,04
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C***********          MOVEL'0'       *IN78                           E38270
     C***********WUMBIN    IFEQ @CN,04                     *IF            E38270
     C***********          MOVEL'1'       *IN78                           E38270
     C***********          END                             *FI            E38270
     C/COPY WNCPYSRC,GL0121PC10
     C                     WRITEZ2KEYHDR
     C/COPY WNCPYSRC,GL0121PC11
     C                     END
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         CAPRDT    BEGSR
      *================================================================
      * Print report detail line.
      *================================================================
     C/COPY WNCPYSRC,GL0121PC25
      * Load detail line.
     C                     MOVELBTBTNB    XRBTNB           Batch number
     C                     MOVELBTNNBI    XRNNBI           Nostro number (
     C                     MOVELBTRINE    XRRINE           Retail ind.: Er
     C                     Z-ADDBTPTAM    XRPTAM           Posting amount
     C                     Z-ADDBTPTDT    XRPTDT           Posting date
     C                     Z-ADDBTVLDT    XRVLDT           Value date
     C/COPY WNCPYSRC,GL0121PC26
     C                     MOVELBTNVCD    XRNVCD           Narrative code
     C                     MOVELBTNRDC    XRNRDC           Narrative descr
     C/COPY WNCPYSRC,GL0121PC27
     C                     MOVELBTACTY    XRACTY           Account type
     C                     MOVELBTCOIN    XRCOIN           Customer origin
     C                     Z-ADDBTSPFC    XRSPFC           Spread Factor  S01333
     C                     MOVELBTRVDI    XRRVDI           Reverse/Void InS01333
     C                     MOVELBTBCBH    XRBCBH           Branch Code (Ba
     C                     MOVELBTRADP    XRRADP           Retail advice p
     C                     MOVELBTSHPI    XRSHPI           Shadow post ind
     C                     Z-ADDBTRRNM    XRRRNM           Relative rec no
     C                     MOVELBTRNBE    XRRNBE           Retail Number E
     C                     MOVELBTRARC    XRRARC           Retail Ac Refer
     C                     Z-ADDBTBINB    XRBINB           Batch item no.
     C                     MOVELBTCUST    XRCUST           Customer number
     C                     MOVELBTCYCD    XRCYCD           Currency code
     C                     MOVELBTACCD    XRACCD           Account code
     C                     MOVELBTACSN    XRACSN           Account sequenc
     C                     MOVELBTIBCA    XRIBCA           Input Branch Co
     C                     MOVEL*BLANK    XRPAMP           Posting Amount
     C                     MOVELBTDCIN    XRDCIN           Debit/credit in
     C/COPY WNCPYSRC,GL0121PC28
     C                     MOVEL*BLANK    XRNRTV           Narrative
     C/COPY WNCPYSRC,GL0121PC29
     C                     MOVELBTTRTY    XRTRTY           Transaction typ
     C                     Z-ADDBTRACN    XRRACN           Retail account
     C                     MOVEL*BLANK    XRNOCD           Nostro Code
     C                     MOVELBTCQNB    XRCQNB           Cheque number
     C                     MOVELBTACNB    XRACNB           Assoc. Customer
     C                     MOVEL*BLANK    XRVDTP           Value Date (Pri
     C                     MOVELBTPRCN    XRPRCN           Profit centre
     C                     MOVELBTSWCR    XRSWCR           Swift common re
     C                     MOVELBTBKCD    XRBKCD           Book Code
     C                     MOVEL*BLANK    XRDCNM           Display Custome
     C                     MOVEL*BLANK    XRDACN           Display Account
     C                     MOVELBTRINO    XRRINO           Retail ind.: Ov
     C                     MOVEL*BLANK    XRIEMP           Item error mess
     C                     MOVEL*BLANK    XRWNFF           Window Function
     C                     MOVEL*BLANK    XRWNF1           Window Function
     C                     MOVEL*BLANK    XRWNF2           Window Function
     C/COPY WNCPYSRC,GL0121PC01
     C                     MOVEL'Y'       W0PFM
     C           *IN51     IFEQ '1'                                       S01413
     C                     MOVELBTNITM    XRNITM           No. of items   S01413
     C                     END                                            S01413
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     MOVELBTOCCY    XROCCY           Orig. Ccy      CEU013
     C                     MOVEL*BLANK    XROAMT           Orig. Amount   CEU013
     C                     END                                            CEU013
      * USER: Process detail record
      * Set flag for non-printing of 2nd detail line
     C                     EXSR UASUBR                     Set flag for no
      * Setup Formatted Posting Amount
     C                     EXSR UBSUBR                     Setup Formatted
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0121PCP1                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** If IBLC Returns module is on, call PGM IL0455 to access                              CER001
      ** Extension file GLJPX1L0 and seton indicator 81                                       CER001
      ** Use nbr of decimal returned in ubsubr routine                                        CER001
      *                                                                                       CER001
     C           BGNWST    IFEQ 'Y'                                                           CER001
     C           ULX043    ANDEQ'Y'                                                           CER001
      *                                                                                       CER001
     C                     CALL 'IL0455'                                                      CER001
     C                     PARM BTBTNB    PBTNB   3                                           CER001
     C                     PARM BTBINB    PBINB   30                                          CER001
     C                     PARM *BLANKS   ILLINE                                              CER001
     C                     PARM *BLANK    PFAIL   1                                           CER001
     C                     PARM WUNBDP    NBDEC   10                                          CER001
      *                                                                                       CER001
     C                     MOVE '0'       WLX043  1                                           CER001
     C                     MOVE *OFF      *IN52                                               CER001
     C           PFAIL     IFNE '1'                                                           CER001
     C           ILLINE    IFNE *BLANKS                                                       CER001
     C                     MOVE '1'       WLX043                                              CER001
     C                     MOVE *ON       *IN52                                               CER001
      *                                                                                       CER001
      ** Set up IBLC lines array                                                              CER001
      *                                                                                       CER001
     C                     MOVEAILLINE    IUL                                                 CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C/COPY WNCPYSRC,LUC110_051                                                               LUC110
      * Setup Narrative
      *CASE:     DB1.Narrative code is Narrative code
     C           BTNVCD    IFNE *BLANK                     *IF
      *                                            START  E17608 21/04/89
      *  This fix should be the same as SAR  S05767
      *  Narrative is not translated to its description
      * from its Narrative code during print.
      * Access Narrative. - Narrative Codes  *
     C*
     C*  Access Narrative codes file for the following fields
     C*  Narrative Code, Narrative Description
     C*
     C                     MOVELBTNVCD    UUNVCD
     C                     CALL 'AONARRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM @CN,02    UUAPOP  7        I:Option
     C                     PARM           UUNVCD  2        I:Narrative Code
     C           D@NARR    PARM *BLANK    UUFDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELALNVCD    XRNVCD           Narrative Code
     C                     MOVELALDON     XRNRTV           Description
     C*
      *CASE:     WRK.Access Pgm Return Code is Access Error
     C           WUAPRC    IFEQ @CN,07                     *IF
     C           WUAPRC    OREQ @CN,08
     C           WUAPRC    OREQ @CN,09
     C           WUAPRC    OREQ @CN,02
     C           WUAPRC    OREQ @CN,10
     C           WUAPRC    OREQ @CN,11
     C           WUAPRC    OREQ @CN,12
     C           WUAPRC    OREQ @CN,13
     C           WUAPRC    OREQ @CN,14
     C           WUAPRC    OREQ @CN,15
     C           WUAPRC    OREQ @CN,16
     C           WUAPRC    OREQ @CN,17
     C                     MOVEL*BLANK    XRNRTV           Narrative
     C                     MOVELBTNVCD    XRNRTV           Narrative
     C                     END                             *FI
      * CUR.Narrative = DB1.Narrative code                (Deleted code)
      *                                            END    E17608 21/04/89
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVELBTNRDC    XRNRTV           Narrative
     C                     END                             *FI
     C/COPY WNCPYSRC,GL0121PC15
      * Setup Nostro Code
      *CASE:     DB1.Nostro number (Item) is *Entered
     C           BTNNBI    IFNE *BLANK                     *IF
      * Setup Nostro code - Standard functions  *
     C                     MOVELXRCYCD    XRNOCD           Currency
     C                     MOVE BTNNBI    XRNOCD           Nostro no.
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    XRNOCD           Nostro Code
     C                     END                             *FI
      * Setup Value Date
      *CASE:     DB1.Value date is Not zero
     C           BTVLDT    IFNE *ZERO                      *IF
      * Midas Conv. Day to Date - Standard functions  *
     C                     CALL 'ZDATE2'               90  Midas Conv. Day
     C                     PARM BTVLDT    WQ0001  50       Runday Number
     C                     PARM WUDTFF    WQ0002  1        Date Format fla
     C           WUDTNF    PARM *ZERO     WQ0003  60       Date (numeric f
     C           WUDDCD    PARM *BLANK    WQ0004  7        Midas Run Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Output Value Date (print) - Standard functions  *
     C**********           MOVE WUDTNF    UUDTNF                                             BUG6955
     C**********           MOVE UUSLT1    UUALT1                                             BUG6955
     C**********           MOVE UUSLT2    UUALT2                                             BUG6955
     C**********           MOVE UUSLT3    UUALT3                                             BUG6955
     C**********           MOVE '/'       UUSLT4                                             BUG6955
     C**********           MOVE '/'       UUSLT5                                             BUG6955
     C**********           MOVE UUVDTP    XRVDTP                                             BUG6955
     C                     MOVE *BLANKS   XRVDTP                                             BUG6955
     C                     MOVELWUDDCD    XRVDTP                                             BUG6955
     C                     END                             *FI
      * Check for Retail errors
      *CASE:     DB1.Retail ind.: Error is Error requiring Override
     C           BTRINE    IFEQ @CN,01                     *IF
      *    E18852 - Branch Code Of Trade Added to Parm List  28.09.89
      * Start of Fix LN0315
      * Check Account Number. - Standard functions  *
     C*
     C* Set up Parameters for call to AOACCTR0
     C*
     C                     MOVEL*BLANK    UUACID
     C                     MOVELXRCUST    UUCUST
     C                     MOVELXRCYCD    UUCYCD
     C                     MOVELXRACCD    UUACNO
     C                     MOVELXRACSN    UUACSN
     C                     MOVELXRIBCA    UUBRCD
     C*
     C*  Call to Access Program - AOACCTR0 Check Account Number
     C*  Access Account Details file for the file fields
     C/COPY WNCPYSRC,GL0121PC16
     C*
     C                     CALL 'AOACCTR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM @CN,02    UUAPOP  7        B:Option
     C                     PARM           UUACID 10        I:Account Identifier
     C                     PARM           UUCUST  6        I:Customer Number
     C                     PARM           UUCYCD  3        I:Currency Code
     C**********           PARM           UUACNO  4        I:Account Code Num                 CGL029
     C                     PARM           UUACNO 10                                           CGL029
     C                     PARM           UUACSN  2        I:Account Sequence
     C                     PARM           UUBRCD  3        I:Branch code
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format
     C/COPY WNCPYSRC,GL0121PC17
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELCNUM      WUCUST           Customer Number
     C                     MOVELCCY       WUCYCD           Currency Code
     C                     MOVELACOD      WUACCD           Account Code
     C                     MOVELACSQ      WUACSN           Account Sequence No.
     C                     MOVELBRCA      WUBRCD           Branch Code
     C                     MOVELATYP      WUACTY           Account Type
     C                     MOVELSTYP      WUBPST           Account Sub-Type
     C                     MOVELACST      WUACCS           Account Status
     C                     MOVELDACO      WUDACO           Date Account Opened
     C                     MOVELANAM      WUACNM           Account Name
     C                     MOVELACNO      WURACN           Retails Account Num
     C                     MOVELRRNM      XRRRNM           Relative rec No Memos
     C                     MOVELRETB      WURETB           Retail Indic'trLN0315
     C                     MOVELRETB      WURTIN           Retail Indic'tr097910
     C*
      * end of Fix LN0315
     C/COPY WNCPYSRC,GL0121PC06
      * Verify Stopped Cheque. - Standard functions  *
     C*
     C*  Call to Access Program - AOSTOPV0 Verify Stoppped Cheque
     C*  Access Account Details file for the file fields
     C*
     C                     CALL 'AOSTOPV0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM XRPTAM    UUCQAM 130       I:Cheque Amount
     C                     PARM XRCQNB    UUCQNB  8        I:Cheque Number
     C                     PARM XRRACN    UURACN 100       I:Retail Account No
     C                     PARM XRCUST    UUCUST  6        I:Customer Number
     C                     PARM XRCYCD    UUCYCD  3        I:Currency Code
     C**********           PARM XRACCD    UUACCD  4        I:Account Code                     CGL029
     C                     PARM XRACCD    UUACCD 10                                           CGL029
     C                     PARM XRACSN    UUACSN  2        I:Acount Sequence
     C                     PARM XRIBCA    UUBRCD  3        I:Branch Code
     C*
      * Check Retail Ind (print) - Standard functions  *
     C***********          MOVELWURTIN    URRETI           Retail ind.    110546
     C                     MOVELWURETB    URRETI           Retail ind.    110546
     C*********************MOVEL#IAORC    URSTOP  7        A/O Rtn.Code   S01117
     C                     MOVELWUAPRC    URSTOP  7        A/P Rtn.Code   S01117
     C                     MOVELXRDCIN    URIND   1                       E17600
      *
     C                     EXSR URRETK                     Check Retail
      *
     C                     MOVELURERST    WUIEST           Error status
     C                     MOVELURERTX    XRIEMP           Error message
      *
     C                     END                             *FI
      * Set flag to print 2nd dtl line if entries present
     C                     EXSR UCSUBR                     Set flag to pri
      * Check Customer & Account Names
     C                     EXSR UDSUBR                     Check Customer
     C/COPY WNCPYSRC,GL0121PC20
      * Was Batch Held?
     C                     EXSR UESUBR                     Was Batch Held?
      * Setup Formatted Original Amount                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     EXSR UFSUBR                     Setup FormattedCEU013
     C                     ENDIF                                          CEU013
      *CASE:     WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ @CN,01                     *IF
      * 00/Copy Member GL0121PPDR - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121PPDR
     C*00/Copy Member GL0121P   Process Detail Record
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form.
     C                     MOVEL'0'       *IN77
     C           XRRACN    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUSDLE    IFEQ @CN,05                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           XRCQNB    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           XRACNB    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           XRVLDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           XRPRCN    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           XRSWCR    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           WUDCUS    IFEQ @CN,04                     *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           WUDSAC    IFEQ @CN,04                     *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           XRBKCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL'0'       *IN67
     C           XRRINE    IFEQ *BLANK                     *IF
     C           XRRINE    OREQ @CN,04
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     MOVEL'0'       *IN66
     C           XRWNFF    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN66
     C                     END                             *FI
     C                     MOVEL'0'       *IN65
     C           XRWNF1    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN65
     C                     END                             *FI
     C                     MOVEL'0'       *IN64
     C           XRWNF2    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN64
     C                     END                             *FI
     C* Add Void indicator                                                S10736
     C                     MOVEL'0'       *IN63                           S10736
     C           XRRVDI    IFEQ *BLANK                     *IF            S10736
     C                     MOVEL'1'       *IN63                           S10736
     C                     END                             *FI            S10736
     C* If EMU Account Posting Narrative present, check original          CEU013
     C/COPY WNCPYSRC,GL0121PC09
     C* amount and currency.                                              CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     MOVEL'0'       *IN45                           CEU013
     C           XROCCY    IFEQ *BLANK                     *IF            CEU013
     C           XROAMT    OREQ *BLANK                                    CEU013
     C                     MOVEL'1'       *IN45                           CEU013
     C                     END                             *FI            CEU013
     C                     ELSE                                           CEU013
     C                     MOVEL'1'       *IN45                           CEU013
     C                     END                                            CEU013
     C/COPY WNCPYSRC,GL0121PC13
      * Print detail line.
     C                     WRITEZZDTLRCD
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0121PCP2                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** If IBLC module is on print IBLC informations.                                        CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           WLX043    ANDEQ'1'                                                           CER001
     C                     WRITEZZEXBLNK                                                      CER001
     C                     DO   3         UL      10                                          CER001
     C           IUL,UL    IFNE *BLANKS                                                       CER001
     C                     MOVELIUL,UL    RRLINE                                              CER001
      *                                                                                       CER001
      ** If there is not enough space on the                                                  CER001
      ** physical page for this format:-                                                      CER001
      *                                                                                       CER001
     C           @$OFL     SUB  @$CLN     @$WRK                                               CER001
     C           @$WRK     IFLE 1                                                             CER001
      *                                                                                       CER001
      ** Print page headers.                                                                  CER001
      *                                                                                       CER001
     C                     WRITEZZPAGHDR                                                      CER001
     C  N80                WRITEZ1KEYHDR                                                      CER001
     C                     WRITEZ2KEYHDR                                                      CER001
     C   97                SETOF                     97                                       CER001
     C                     WRITEZZEXBLNK                                                      CER001
     C                     ENDIF                                                              CER001
     C                     WRITEZZEXIBLC                                                      CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DALVCH    BEGSR
      *================================================================
      * Detect level changes.
      *================================================================
      * Clear all level breaks.
     C                     MOVEL*BLANK    L0               Page headings
     C                     MOVEL*BLANK    L1               Branch Code (Ba
     C                     MOVEL*BLANK    L2               Batch number
      * Clear heading length to print.
     C                     Z-ADD*ZERO     @$HDL
      *
      * End of file - Signal all level breaks.
     C           W0EOF     IFEQ '1'
     C                     MOVEL'Y'       L1
     C                     MOVEL'Y'       L2
     C                     ELSE
     C           BTBCBH    IFNE WZBCBH                     Branch Code (Ba
      * Set on level break indicator.
     C                     MOVEL'Y'       L1
     C                     ADD  2         @$HDL
     C                     END
     C           BTBTNB    IFNE WZBTNB                     Batch number
     C           L1        OREQ 'Y'
      * Set on level break indicator.
     C                     MOVEL'Y'       L2
     C                     ADD  10        @$HDL
     C                     END
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         EAPRTT    BEGSR
      *================================================================
      * Print report Totals.
      *================================================================
      * Print level break totals as required
     C           L2        IFEQ 'Y'
      * User: Process Batch number totals.
      *CASE:     WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ @CN,01                     *IF
      * 00/Copy Member GL0121PPLT - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121PPLT
     C*00/Copy Member GL0121P   Print Level Totals
     C                     END                             *FI
      * Mention format.
     C   99N99             WRITEZ3KEYTTL
     C/COPY WNCPYSRC,GL0121PC23
     C                     END
      *
     C           L1        IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * User: Process Branch Code (Batch Headr) totals.
      * ZSFILE Close/Open GL0121P - Journal Entry Posting  *
     C*
     C**  PRINT OUT THE HEADER AND THE BRANCH TOTAL AS REQUIRED
     C*
      * If there is not enough space on the
      * physical page for this format:-
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal artificial overflow.
     C                     SETON                     97
      * Print page headers.
     C                     WRITEZZPAGHDR
     C                     END
      * Print format.
     C**********           WRITEZ4KEYTTL                                  E38270
     C  N80                WRITEZ4KEYTTL                                  E38270
     C   80                WRITEZ5KEYTTL                                  E38270
     C*
     C** BLANK OUT THE PRINT FORMAT INDICATOR SO THAT THE NORMAL
     C** SYNON CODE WILL NOT DUPLICATE THE ABOVE WRITES
     C*
     C                     MOVE *BLANK    W0PFM
     C**  IF IT IS NOT THE END OF FILE OPEN/CLOSE
     C           W0EOF     IFEQ '0'
     C*
     C**  Save Indicator 66
     C*
     C                     MOVE *IN66     UUIN66  1
     C                     CLOSEGL0121PM               66
     C                     OPEN GL0121PM
     C*
     C           *IN66     IFEQ '1'
     C                     MOVE '**ERR**' W0RTN
     C                     ELSE                                           LN0837
     C*                                                                   LN0837
     C* Set up spool file number - Standard Functions  *                  LN0837
     C                     Z-ADD@$FNB     WUSFNB                          LN0837
     C*                                                                   LN0837
     C* ZSFILE - write report rqs - Standard Functions  *                 LN0837
     C                     CALL 'ZSFILE'               90  ZSFILE - write LN0837
     C                     PARM UUSRSQ    UURSQN  5        RCF sequence nuLN0837
     C*********************PARM P3ENTY    UUENTY  3        Entity         LN0958
     C**********           PARM BTIBCA    UUENTY  3        Entity                      LN0958 239576
     C                     PARM BTBCBH    UUENTY  3                                           239576
     C                     PARM @$FVN     UUSFNM 10        Spool file nameLN0837
     C                     PARM WUSFNB    UUSFNB  60       Spool file numbLN0837
     C           UUZSER    PARM *BLANK    UUZSER  1        ZSFILE error   LN0837
     C*                                                                   LN0837
     C           *IN90     IFEQ '1'                                       LN0837
     C* Call to program ended in error.                                   LN0837
     C                     MOVEL'Y2U0021' W0RTN   7                       LN0837
     C                     END                                            LN0837
     C*                                                                   LN0837
     C* CASE: WRK.ZSFILE is error occurred                                LN0837
     C*                                                                   LN0837
     C*          UUZSER    IFEQ 'Y'                                       LN0837
     C*                    MOVEL'Y2U0004' P0RTN                           LN0837
     C*                    EXSR ZYEXPG                                    LN0837
     C*                    END                                            LN0837
     C                     END
     C*********************WRITEZZPAGHDR                                  LN0837
     C                     SETON                       97                 LN0837
     C* Restore Indicator 66
     C                     MOVE UUIN66    *IN66
     C                     END
      *CASE:     PGM.*Return code is Open/Close Printer Error
     C           W0RTN     IFEQ @CN,19                     *IF
      * Database Error U7 U8 - Standard functions  *
     C** Set On U7 and U8 Database Error                               l A
     C                     SETON                     U7U8
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:-
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal artificial overflow.
     C                     SETON                     97
      * Print page headers.
     C                     WRITEZZPAGHDR
     C                     END
      * Print format.
     C                     WRITEZ4KEYTTL
     C                     END
     C                     END
      *
      * End of file - Print final totals.
     C           W0EOF     IFEQ '1'
      * USER: Process End of Report
      *CASE:     WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ @CN,01                     *IF
      * 00/Copy Member GL0121PPER - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121PPER
     C*00/Copy Member GL0121P   Process End Of Report
     C                     END                             *FI
      * Mention format.
     C   99N99             WRITEZZFINTTL
     C                     END
      *
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         FASGHD    BEGSR
      *================================================================
      * Signal required header formats.
      *================================================================
      * Cascade skip to new page requests upwards.
     C           L2        IFNE *BLANK
      * Request page headings.
     C                     MOVEL'Y'       L0
      * Request all headings higher than this one.
     C           L1        IFEQ *BLANK
     C                     MOVEL'P'       L1
     C                     END
     C                     END
      *
      * Add one by line to print to counter of line.                                          CGL013
      *                                                                                       CGL013
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C           BAADI1    IFNE *BLANKS                                                       CGL013
     C           BAAERI    ORNE *BLANKS                                                       CGL013
     C                     ADD  1         @$HDL                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI2    IFNE *BLANKS                                                       CGL013
     C                     ADD  1         @$HDL                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI3    IFNE *BLANKS                                                       CGL013
     C                     ADD  1         @$HDL                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI4    IFNE *BLANKS                                                       CGL013
     C                     ADD  1         @$HDL                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI5    IFNE *BLANKS                                                       CGL013
     C                     ADD  1         @$HDL                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI6    IFNE *BLANKS                                                       CGL013
     C                     ADD  1         @$HDL                                               CGL013
     C                     ENDIF                                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           CER030    IFEQ 'Y'                                                         BUG23742
      *                                                                                     BUG23742
     C           BAEX1     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX2     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX3     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX4     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX5     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX6     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX7     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX8     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX9     IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX10    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX11    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX12    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX13    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX14    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX15    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX16    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX17    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX18    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX19    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX20    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX21    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX22    IFNE *BLANKS                                                     BUG23742
     C                     ADD  1         @$HDL                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           CGL125    IFEQ 'Y'                                                        AR1065437
     C           HQJETP    ANDEQ'C'                                                        AR1065437
      *                                                                                    AR1065437
     C           HQBDTE    IFNE 0                                                          AR1065437
     C           HQPTRS    ORNE *BLANKS                                                    AR1065437
     C                     ADD  1         @$HDL                                            AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C           IQBCRT    IFNE 0                                                          AR1065437
     C           IQBCIN    ORNE *BLANKS                                                    AR1065437
     C                     ADD  1         @$HDL                                            AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C           *IN97     IFNE '1'
     C           L0        ANDNE'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line.
     C           W0OFL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     ELSE
      * Signal overflow if requested headings would cause
      * detail format to be printed past end of page
     C                     ADD  8         @$HDL
     C           W0PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     END
     C                     END
     C                     END
      * Overflow detected.
     C           *IN97     IFEQ '1'
      * Request page headings.
     C                     MOVEL'Y'       L0
      * Request all formats which print on overflow.
     C           L2        IFEQ *BLANK
     C                     MOVEL'P'       L2
     C                     END
     C                     SETOF                     97
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GARDRC    BEGSR
      *================================================================
      * Read next record with user selection.
      *================================================================
     C           W0RSL     DOUEQ'Y'
     C                     READ @JENPCL                  90*
     C                     MOVEL*IN90     W0EOF   1
      *                                                                                       CGL013
      ** If MT94x Messages Generation is installed, retrieve                                  CGL013
      ** Additional Information Details                                                       CGL013
      *                                                                                       CGL013
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C           *IN90     ANDEQ*OFF                                                          CGL013
     C                     EXSR SRADIN                                                        CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           CER030    IFEQ 'Y'                                                         BUG23742
     C           *IN90     ANDEQ*OFF                                                        BUG23742
     C                     EXSR SRADI1                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                    AR1065437
      ** Retrieve and format CGL125/CSC054 introduced fields                               AR1065437
      *                                                                                    AR1065437
     C           CGL125    IFEQ 'Y'                                                        AR1065437
     C           *IN90     ANDEQ*OFF                                                       AR1065437
     C                     EXSR SRCBIF                                                     AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
      * Quit if no record read.
     C           W0EOF     CABEQ'1'       GAEXIT
      * Select record unless user action states otherwise.
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Start of Fix LN0837
      * Only print the record if the entity is ALL
      *CASE:     PAR.Level is Branch
     C           P2LEVL    IFEQ @CN,20                     *IF
      *CASE:     PAR.Entity is Not All
     C           P3ENTY    IFNE @CN,21                     *IF
      *CASE:     PAR.Entity NE DB1.Branch Code (Batch Headr)
     C***********P3ENTY    IFNE BTBCBH                     *IF            105427
     C           P3ENTY    IFNE BTIBCA                     *IF            105427
     C                     MOVEL@CN,04    W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of Fix LN0837
      *CASE:     WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ @CN,01                     *IF
      * 00/Copy Member GL0121PRSP - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121PRSP
     C*00/Copy Member GL0121P   Record Selection Proc.
     C                     END                             *FI
     C                     END
      *                                                                                       239576
      ** If branch code (batch header) field in GLJENPPD is blank,                            239576
      ** retrive it from GLJENPPD (Journal Entry Header PF)                                   239576
      *                                                                                       239576
     C           BTBCBH    IFEQ *BLANKS                                                       239576
     C                     MOVELBTBTNB    BRBTNB                                              239576
     C           KRSSA     CHAIN@BRREAH              90                                       239576
      *                                                                                       239576
     C           *IN90     IFEQ '0'                                                           239576
     C                     MOVELBRBCDA    BTBCBH                                              239576
     C                     ENDIF                                                              239576
      *                                                                                       239576
     C                     ENDIF                                                              239576
      *                                                                                       239576
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Retrieve Header fields - Journal Entry Header  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSA     KLIST
     C                     KFLD           BRBTNB           Batch number
      * Move fields to key list.
     C                     MOVELBTBTNB    BRBTNB           Batch number
     C           KRSSA     CHAIN@BRREAH              90    *
      * DBF Record not found.
     C   90                MOVEL'GLX0172' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     MOVELBRBTNB    WUBTNB           Batch number
     C                     MOVELBRBCDA    WUBCDA           Branch Code - A
     C                     MOVELBRDPCD    WUDPCD           Dept Code
     C                     MOVELBRWSID    WUWSID           Workstation id.
     C                     Z-ADDBRHICC    WUHICC           Hash integer ca
     C                     Z-ADDBRHDCC    WUHDCC           Hash decimal ca
     C                     Z-ADDBRHINC    WUHINC           Hash item no.ca
     C                     Z-ADDBRHIIN    WUHIIN           Hash integer in
     C                     Z-ADDBRHDIN    WUHDIN           Hash decimal in
     C                     Z-ADDBRHINI    WUHINI           Hash item no.in
     C                     MOVELBRBTSF    WUBTSF           Batch status fl
     C                     MOVELBRBIUF    WUBIUF           Batch in use fl
     C                     MOVELBRSHPI    WUSHPI           Shadow post ind
     C                     MOVELBRRAPI    WURAPI           Retail advice p
     C                     MOVELBRMBRB    WUMBRB           Multiple Branch
     C                     MOVELBRRVVD    WURVVD           Reversal / Void
     C                     MOVELBRBDES    WUBDES           Batch Descripti
     C                     Z-ADDBRSPTT    WUSPTT           Spread Total   S01333
     C                     Z-ADDBRNIST    WUNIST           No.Items to SprS01340
     C                     MOVELBRSPRF    WUSPRF           Spread Profile S01333
     C                     MOVELBRDCIN    WUDCIN           Debit/credit inS01333
     C                     MOVELBRIBCF    WUIBCF           Input Branch CdS01333
     C                     MOVELBRCUSF    WUCUSF           Customer NumberS01333
     C                     MOVELBRCYCF    WUCYCF           Currency Code  S01333
     C                     MOVELBRACCF    WUACCF           Account Code   S01333
     C                     MOVELBRACSF    WUACSF           Account Seq No.S01333
     C                     MOVELBRNNBF    WUNNBF           Nostro No. (IteS01333
     C                     Z-ADDBRRACF    WURACF           Retail A/c No. S01333
     C                     MOVELBRPRCF    WUPRCF           Profit Centre  S01333
     C                     Z-ADDBRAMTF    WUAMTF           Amount Alloc FmS01340
     C                     MOVELBRIBCT    WUIBCT           Input Branch CdS01333
     C                     MOVELBRCNAT    WUCNAT           Customer NumberS01333
     C                     MOVELBRCYCT    WUCYCT           Currency Code  S01333
     C                     MOVELBRACCT    WUACCT           Account Code   S01333
     C                     MOVELBRASNT    WUASNT           Account Seq No.S01333
     C                     MOVELBRNNBT    WUNNBT           Nostro No. (IteS01333
     C                     Z-ADDBRRACT    WURACT           Retail A/c No. S01333
     C                     MOVELBRTOJE    WUTOJE           Type of JournalS01340
     C                     MOVELBRUSRI    WUUSRI                          CGL008
     C                     MOVELBRUSRA    WUUSRA                          CGL008
     C                     GOTO SAEXIT                     *QUIT
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Set flag for non-printing of 2nd detail line
      *================================================================
     C                     MOVEL@CN,05    WUSDLE           2nd Detail line
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Setup Formatted Posting Amount
      *================================================================
      *CASE:     DB1.Currency code is Blank
     C           BTCYCD    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     WUNBDP           Number of Decim
     C                     ELSE
      *CASE:     *OTHERWISE
      * Access Currency. - Currency Codes  *
     C*
     C*  Access Currency codes file for the following fields
     C*  Currency Name, Number of decimal places, Nostro Shortname
     C*
     C                     MOVELXRCYCD    UUCYCD
      * Are the details for this CCY already stored in the arrays                             CSC042
     C                     MOVELUUCYCD    ##KC                                                CSC042
     C                     EXSR ##CHKC                                                        CSC042
     C           ##FIC     IFEQ 'Y'                                                           CSC042
      * Found in the arrays so use the details from there                                     CSC042
     C                     EXSR ##SETC                                                        CSC042
     C                     ELSE                                                               CSC042
     C                     CALL 'AOCURRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM @CN,02    UUAPOP  7        I:Option
     C                     PARM           UUCYCD  3        I:Currency Code
     C           D@CURR    PARM *BLANK    UUSDY            O:Format
     C           @RTCD     IFEQ *BLANKS                                                       CSC042
      * Found on the DB and not in the array so add to the array                              CSC042
     C                     EXSR ##ADDC                                                        CSC042
     C                     END                                                                CSC042
     C                     END                                                                CSC042
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELA6CYCD    XRCYCD           Currency Code
     C                     MOVELA6CYNM    WUCYNM           Currency Name
     C                     MOVELA6NBDP    WUNBDP           No. Decimal Places
     C                     MOVELA6NOSN    WUNOSN           Nostro Shortname
     C*
     C                     END                             *FI
      * Format amount (short) - Standard functions  *
     C                     Z-ADDBTPTAM    ULVALU           Value
      *
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALU 150       I:Value
     C                     PARM WUNBDP    ULDECP  10       I:Decimal place
     C                     PARM @CN,06    ULEDIT  1        I:IBM Edit code
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLF 23        O:Formatted
      *
     C                     MOVE ULRSLF    XRPAMP           Formatted data
      *
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Set flag to print 2nd dtl line if entries present
      *================================================================
      *CASE:     DB1.Cheque number is Entered
     C           BTCQNB    IFNE *BLANK                     *IF
     C                     MOVEL@CN,18    WUSDLE           2nd Detail line
     C                     END                             *FI
      *CASE:     DB1.Assoc. Customer number is Entered
     C           BTACNB    IFNE *BLANK                     *IF
     C                     MOVEL@CN,18    WUSDLE           2nd Detail line
     C                     END                             *FI
      *CASE:     DB1.Value date is Not zero
     C           BTVLDT    IFNE *ZERO                      *IF
     C                     MOVEL@CN,18    WUSDLE           2nd Detail line
     C                     END                             *FI
      *CASE:     DB1.Swift common reference is Entered
     C           BTSWCR    IFNE *BLANK                     *IF
     C                     MOVEL@CN,18    WUSDLE           2nd Detail line
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Check Customer & Account Names
      *================================================================
      * Start of Fix SAR017
      *CASE:     WRK.GL Description Ind. is Yes
     C           WUGLDI    IFEQ @CN,01                     *IF
      *    E18852 - Branch Code Of Trade Added to Parm List  28.09.89
      * Start of Fix LN0315
      * Check Account Number. - Standard functions  *
     C*
     C* Set up Parameters for call to AOACCTR0
     C*
     C                     MOVEL*BLANK    UUACID
     C                     MOVELXRCUST    UUCUST
     C                     MOVELXRCYCD    UUCYCD
     C                     MOVELXRACCD    UUACNO
     C                     MOVELXRACSN    UUACSN
     C                     MOVELXRIBCA    UUBRCD
     C*
     C*  Call to Access Program - AOACCTR0 Check Account Number
     C*  Access Account Details file for the file fields
     C/COPY WNCPYSRC,GL0121PC18
     C*
     C                     CALL 'AOACCTR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM @CN,02    UUAPOP  7        B:Option
     C                     PARM           UUACID 10        I:Account Identifier
     C                     PARM           UUCUST  6        I:Customer Number
     C                     PARM           UUCYCD  3        I:Currency Code
     C**********           PARM           UUACNO  4        I:Account Code Num                 CGL029
     C                     PARM           UUACNO                                              CGL029
     C                     PARM           UUACSN  2        I:Account Sequence
     C                     PARM           UUBRCD  3        I:Branch code
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format
     C/COPY WNCPYSRC,GL0121PC19
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELCNUM      WUCUST           Customer Number
     C                     MOVELCCY       WUCYCD           Currency Code
     C                     MOVELACOD      WUACCD           Account Code
     C                     MOVELACSQ      WUACSN           Account Sequence No.
     C                     MOVELBRCA      WUBRCD           Branch Code
     C                     MOVELATYP      WUACTY           Account Type
     C                     MOVELSTYP      WUBPST           Account Sub-Type
     C                     MOVELACST      WUACCS           Account Status
     C                     MOVELDACO      WUDACO           Date Account Opened
     C                     MOVELANAM      WUACNM           Account Name
     C                     MOVELACNO      WURACN           Retails Account Num
     C                     MOVELRRNM      WURRNM           Relative rec No Memos
     C                     MOVELRETB      WURETB           Retail Indic'trLN0315
     C*
      * End of Fix LN0315
     C/COPY WNCPYSRC,GL0121PC07
     C                     MOVEL@CN,01    WUDSAC           Display Account
     C*                                                                   148771
     C           WUAPRC    IFEQ *BLANKS                                   148771
     C                     MOVELWUACNM    XRDACN           Display Account
     C                     ELSE                                           148771
     C/COPY WNCPYSRC,GL0121PC14
     C                     MOVEL*BLANKS   XRDACN                          148771
     C                     END                                            148771
     C*                                                                   148771
      * Access Cust Report Name - Standard functions  *
      *********P@AORF    E DSSDCUSTPD                                     S01117
     C*
     C* Access Customer Report Name Off Client File
     C*
     C                     MOVE *BLANK    WUCRST  7
     C**
     C                     CALL 'AOCUSTR0'
     C***********#BAORC****PARM #BAORC    P@RTN   7        B:Return code  S01117
     C           WUAPRC    PARM WUAPRC    P@RTN   7        B:Access Pgm ReS01117
     C*********************PARM #IAOPN    P@OPTN  7        I:Option       S01117
     C                     PARM @CN,02    P@OPTN  7        I:Access Pgm OpS01117
     C                     PARM XRCUST    P@CKEY 10        I:Key field
     C           WUCRST    PARM *BLANK    P@FLD1  7        O:Client Key Id.
     C*********************PARM           P@AORF           O:Format       S01117
     C           D@CUST    PARM *BLANK    UUSDY            O:Format       S01117
     C*
     C                     MOVELBBCRNM    WUCRNM           O:Cust Report Nme
     C                     MOVELWUCRNM    XRDCNM           Display Custome
     C/COPY WNCPYSRC,GL0121PC05
     C                     MOVEL@CN,01    WUDCUS           Display Custome
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,04    WUDCUS           Display Custome
     C                     MOVEL@CN,04    WUDSAC           Display Account
     C                     END                             *FI
      * End of Fix SAR017
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     C/COPY WNCPYSRC,GL0121PC21
     CSR         UESUBR    BEGSR
      *================================================================
      * Was Batch Held?
      *================================================================
      * Start of Fix E19846
      * Was Batch Held? - Journal Entry Posting  *
     C   U1      Z2BSTS    IFNE 'Accepted'
     C                     SETON                         U8
     C                     END
      * End of Fix E19846
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT                                                              CEU013
     CSR         UFSUBR    BEGSR                                          CEU013
      *================================================================   CEU013
      * Set up Formatted Original Amount                                  CEU013
      *================================================================   CEU013
      * CASE: DB1.Currency code is Blank                                  CEU013
     C           BTOCCY    IFEQ *BLANK                     *IF            CEU013
     C                     Z-ADD*ZERO     #WNBDP           Number of DecimCEU013
     C                     ELSE                                           CEU013
      * CASE: *OTHERWISE                                                  CEU013
      * Access Currency. - Currency Codes  *                              CEU013
     C*                                                                   CEU013
     C*  Access Currency codes file for the following fields              CEU013
     C*  Currency Name, Number of decimal places, Nostro Shortname        CEU013
     C*                                                                   CEU013
     C                     MOVELXROCCY    UUCYCD                          CEU013
      * Are the details for this CCY already stored in the arrays                             CSC042
     C                     MOVELUUCYCD    ##KC                                                CSC042
     C                     EXSR ##CHKC                                                        CSC042
     C           ##FIC     IFEQ 'Y'                                                           CSC042
      * Found in the arrays so use the details from there                                     CSC042
     C                     EXSR ##SETC                                                        CSC042
     C                     ELSE                                                               CSC042
     C                     CALL 'AOCURRR0'                                CEU013
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    CEU013
     C                     PARM '*KEY'    UUAPOP  7        I:Option       CEU013
     C                     PARM           UUCYCD  3        I:Currency CodeCEU013
     C           D@CURR    PARM *BLANK    UUSDY            O:Format       CEU013
     C           @RTCD     IFEQ *BLANKS                                                       CSC042
      * Found on the DB and not in the array so add to the array                              CSC042
     C                     EXSR ##ADDC                                                        CSC042
     C                     END                                                                CSC042
     C                     END                                                                CSC042
     C*                                                                   CEU013
     C* Assign work field to file field values.                           CEU013
     C*                                                                   CEU013
     C                     MOVELA6NBDP    #WNBDP  10       No. Decimal PlaCEU013
     C*                                                                   CEU013
     C                     END                             *FI            CEU013
      * Format amount (short) - Standard functions  *                     CEU013
     C                     Z-ADDBTOAMT    ULVALU           Value          CEU013
      *                                                                   CEU013
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>CEU013
     C                     PARM           ULVALU 150       I:Value        CEU013
     C                     PARM #WNBDP    ULDECP  10       I:Decimal placeCEU013
     C                     PARM 'J'       ULEDIT  1        I:IBM Edit codeCEU013
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.CEU013
     C                     PARM           ULRSLF 23        O:Formatted    CEU013
      *                                                                   CEU013
     C                     MOVE ULRSLF    XROAMT           Formatted data CEU013
      *                                                                   CEU013
      *================================================================   CEU013
     CSR         UFEXIT    ENDSR                                          CEU013
      /EJECT                                                              CEU013
     C*****************************************************************                       CSC042
     C*                                                                                       CSC042
     C*  ##CHKC  - Check the currency details                                                 CSC042
     C*                                                                                       CSC042
     C********************************************************************                    CSC042
     C           ##CHKC    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN BJCYCD    ##KC                                                CSC042
     C           *LIKE     DEFN Q         ##QSV                                               CSC042
      *                                                                                       CSC042
      * Set off the currency found indicator                                                  CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 87 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN87     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN87   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN87                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     SETOF                         87                                   CSC042
      *                                                                                       CSC042
      * Restore Q from ##QSV in case Q is used elsewhere in the code                          CSC042
     C                     Z-ADD##QSV     Q       40                                          CSC042
      *                                                                                       CSC042
      * Are we looking for the same details as the last time this                             CSC042
      * subroutine was called i.e. is Q already set correctly?                                CSC042
      * If so then use the data rather than do another LOKUP                                  CSC042
      * First make sure that we don't reference the 0th array element                         CSC042
     C           Q         IFEQ 0                                                             CSC042
     C                     Z-ADD1         Q                                                   CSC042
     C                     END                                                                CSC042
      * Now see if this search is same as last one performed                                  CSC042
      * If we have a match then seton 87 so the code after this                               CSC042
      * subroutine knows it can use Q directly                                                CSC042
     C           ##KC      IFEQ CURR,Q                                                        CSC042
     C                     SETON                         87                                   CSC042
     C                     ELSE                                                               CSC042
      * Otherwise hunt in the array and seton 87 if found                                     CSC042
     C                     Z-ADD1         Q                                                   CSC042
     C           ##KC      LOKUPCURR,Q                   87                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save Q for next time                                                                  CSC042
     C           *IN87     IFEQ *ON                                                           CSC042
     C                     Z-ADDQ         ##QSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 87.                                                      CSC042
     C           #IN87     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN87                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN87                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
     C********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
     C*                                                                                       CSC042
     C*  ##SETB  - Set up the SDCURRPD fields as expected by this program                     CSC042
     C*            from the array fields                                                      CSC042
     C*                                                                                       CSC042
     C********************************************************************                    CSC042
     C           ##SETC    BEGSR                                                              CSC042
     C*                                                                                       CSC042
     C                     MOVELCURR,Q    A6CYCD                                              CSC042
     C                     Z-ADD#CDP,Q    A6NBDP                                              CSC042
     C                     MOVEL#CNM,Q    A6CYNM                                              CSC042
     C                     MOVEL#CNO,Q    A6NOSN                                              CSC042
     C*                                                                                       CSC042
     C                     ENDSR                                                              CSC042
     C********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDC - Adds the SDCURRPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDC    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN Q         ##QNDX                                              CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##QNDX    IFLT 150                                                           CSC042
     C                     ADD  1         ##QNDX                                              CSC042
     C                     Z-ADD##QNDX    Q                                                   CSC042
     C                     MOVELA6CYCD    CURR,Q                                              CSC042
     C                     Z-ADDA6NBDP    #CDP,Q                                              CSC042
     C                     MOVELA6CYNM    #CNM,Q                                              CSC042
     C                     MOVELA6NOSN    #CNO,Q                                              CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Update ##QSV so next call to ##CHKC checks this latest adddition                      CSC042
      * to the array first                                                                    CSC042
     C                     Z-ADDQ         ##QSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
     CSR         URRETK    BEGSR
      *====================================================
      * Check Retail Account status
      *----------------------------------------------------
      *
     C                     MOVE *IN90     URSI90  1        Save indicator
     C                     MOVE *IN91     URSI91  1        Save indicator
     C                     MOVE *BLANK    URERTX           Blank msg.text
     C                     MOVE *BLANK    URERST  1        Error status
     C                     Z-ADD1         U1      30       Set pointer
     C                     SETOF                     91    Set ind.
      *
      * Check Refer Debits :
      *
     C           URIND     IFEQ 'D'                        ONLY IF DEBIT  E17600
      *
     C                     TESTB'0'       URRETI  1      90=Refer debits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE01    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Refer Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Refer Credits :
      *
     C           URIND     IFEQ 'C'                        ONLY IF CREDIT E17600
      *
     C                     TESTB'1'       URRETI         90 Refer credits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE02    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Refer Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Block Debits :
      *
     C           URIND     IFEQ 'D'                        ONLY IF DEBIT  E17600
      *
     C                     TESTB'2'       URRETI         90 Block debits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE03    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Block Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Block Credits :
      *
     C           URIND     IFEQ 'C'                        ONLY IF CREDIT E17600
      *
     C                     TESTB'3'       URRETI         90 Block credits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE04    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Block Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Inactive A/C :
      *
     C                     TESTB'4'       URRETI         90 Inactive a/c
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE05    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Inactive'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Not in Use :   ***REMOVE COMMENTS IF FLAG TO BE USED LATER***
      *
     C*****                TESTB'5'       URRETI         90 -Not in Use-
      *
     C*****      *IN90     IFEQ '1'                        IF BIT SET
     C*****      URRE06    IFEQ 'N'                        IF NO O'RIDE
     C*****                SETON                     91      No O'ride
     C*****                END                             FI
     C*****                MOVEL'Not used'@IH,U1             Message text
     C*****                ADD  1         U1                 Incr.pointer
     C*****                END                             FI
      *
      * Check Bankrupt :
      *
     C                     TESTB'6'       URRETI         90 B'rupt/L'dated
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE07    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Bankrupt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Bad Debt :
      *
     C                     TESTB'7'       URRETI         90 Bad debt
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE08    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Bad Debt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Stopped cheque :
      *
     C           URSTOP    IFEQ '*STOP  '                  IF STOPPED
     C           URRE09    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Chq.Stop'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Non-Overrideable error status :
      *
     C           U1        IFGT 1                          IF ERRORS
     C           *IN91     IFEQ '1'                        IF NOT O'RIDE
     C                     MOVE 'E'       URERST             Error Status
     C                     ELSE                            EL O'RIDEABLE
     C                     MOVE 'O'       URERST             Error Status
     C                     END                             FI
     C                     END                             FI
      *
     C                     MOVE URSI90    *IN90            Restore ind.
     C                     MOVE URSI91    *IN91            Restore ind.
      *
      *----------------------------------------------------
      *
      *====================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
     C/COPY WNCPYSRC,GL0121PC02
      *================================================================
      * Exit program: Direct.
      *================================================================
      * Terminate program.
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
      *****************************************************************                     BUG23742
      *                                                               *                     BUG23742
      * SRADI1 - Subroutine to process Additional Information Details *                     BUG23742
      *          1 if CER030 is installed                             *                     BUG23742
      *                                                               *                     BUG23742
      * Called by: GARDRC                                             *                     BUG23742
      *                                                               *                     BUG23742
      * Calls: None                                                   *                     BUG23742
      *                                                               *                     BUG23742
      *****************************************************************                     BUG23742
      *                                                                                     BUG23742
     C           SRADI1    BEGSR                                                            BUG23742
      *                                                                                     BUG23742
     C                     MOVE *OFF      *IN38                                             BUG23742
     C                     MOVE *OFF      *IN39                                             BUG23742
     C                     MOVE *OFF      *IN40                                             BUG23742
     C                     MOVE *OFF      *IN41                                             BUG23742
     C                     MOVE *OFF      *IN42                                             BUG23742
     C                     MOVE *OFF      *IN43                                             BUG23742
     C                     MOVE *OFF      *IN44                                             BUG23742
     C                     MOVE *OFF      *IN46                                             BUG23742
     C                     MOVE *OFF      *IN47                                             BUG23742
     C                     MOVE *OFF      *IN48                                             BUG23742
     C                     MOVE *OFF      *IN49                                             BUG23742
     C                     MOVE *OFF      *IN50                                             BUG23742
     C                     MOVE *OFF      *IN53                                             BUG23742
     C                     MOVE *OFF      *IN54                                             BUG23742
     C                     MOVE *OFF      *IN55                                             BUG23742
     C                     MOVE *OFF      *IN56                                             BUG23742
     C                     MOVE *OFF      *IN57                                             BUG23742
     C                     MOVE *OFF      *IN58                                             BUG23742
     C                     MOVE *OFF      *IN59                                             BUG23742
     C                     MOVE *OFF      *IN60                                             BUG23742
     C                     MOVE *OFF      *IN61                                             BUG23742
     C                     MOVE *OFF      *IN62                                             BUG23742
      *                                                                                     BUG23742
     C           KJENL3    CHAINGLMNARL3             21                                     BUG23742
     C           *IN21     IFEQ *OFF                                                        BUG23742
      *                                                                                     BUG23742
     C           BAEX1     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN38                                             BUG23742
     C                     MOVELBAEX1     XRAD1                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX2     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN39                                             BUG23742
     C                     MOVELBAEX2     XRAD2                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX3     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN40                                             BUG23742
     C                     MOVELBAEX3     XRAD3                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX4     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN41                                             BUG23742
     C                     MOVELBAEX4     XRAD4                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX5     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN42                                             BUG23742
     C                     MOVELBAEX5     XRAD5                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX6     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN43                                             BUG23742
     C                     MOVELBAEX6     XRAD6                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX7     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN44                                             BUG23742
     C                     MOVELBAEX7     XRAD7                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX8     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN46                                             BUG23742
     C                     MOVELBAEX8     XRAD8                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX9     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN47                                             BUG23742
     C                     MOVELBAEX9     XRAD9                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX10    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN48                                             BUG23742
     C                     MOVELBAEX10    XRAD10                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX11    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN49                                             BUG23742
     C                     MOVELBAEX11    XRAD11                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX12    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN53                                             BUG23742
     C                     MOVELBAEX12    XRAD12                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX13    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN54                                             BUG23742
     C                     MOVELBAEX13    XRAD13                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX14    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN55                                             BUG23742
     C                     MOVELBAEX14    XRAD14                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX15    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN56                                             BUG23742
     C                     MOVELBAEX15    XRAD15                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX16    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN57                                             BUG23742
     C                     MOVELBAEX16    XRAD16                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX17    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN58                                             BUG23742
     C                     MOVELBAEX17    XRAD17                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX18    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN59                                             BUG23742
     C                     MOVELBAEX18    XRAD18                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX19    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN60                                             BUG23742
     C                     MOVELBAEX19    XRAD19                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX20    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN61                                             BUG23742
     C                     MOVELBAEX20    XRAD20                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX21    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN62                                             BUG23742
     C                     MOVELBAEX21    XRAD21                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX22    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN63                                             BUG23742
     C                     MOVELBAEX22    XRAD22                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDSR                                                            BUG23742
      *                                                                                     BUG23742
      *****************************************************************                     BUG23742
      /EJECT                                                                                BUG23742
      *****************************************************************                    AR1065437
      *                                                               *                    AR1065437
      * SRCBIF - Subroutine to process additional fields introduced   *                    AR1065437
      *          by CGL125 and CSC054 if CGL125 is ON.                *                    AR1065437
      *                                                               *                    AR1065437
      * Called by: GARDRC                                             *                    AR1065437
      *                                                               *                    AR1065437
      * Calls: None                                                   *                    AR1065437
      *                                                               *                    AR1065437
      *****************************************************************                    AR1065437
      *                                                                                    AR1065437
     C           SRCBIF    BEGSR                                                           AR1065437
      *                                                                                    AR1065437
     C                     MOVE *ON       *IN98                                            AR1065437
      *                                                                                    AR1065437
     C           BTBTNB    CHAINGLJEHQD0             96                                    AR1065437
      *                                                                                    AR1065437
     C           *IN96     IFEQ *OFF                                                       AR1065437
     C           HQJETP    ANDEQ'C'                                                        AR1065437
     C                     MOVE 'Y'       WCBIM   1                                        AR1065437
      *                                                                                    AR1065437
     C           HQBDTE    IFNE *ZERO                                                      AR1065437
     C                     CALL 'ZDATE2'               90                                  AR1065437
     C                     PARM HQBDTE    WQ0001  50                                       AR1065437
     C                     PARM WUDTFF    WQ0002  1                                        AR1065437
     C           WUDTNF    PARM *ZERO     WQ0003  60                                       AR1065437
     C           WUDDCD    PARM *BLANK    WQ0004  7                                        AR1065437
     C           *IN90     IFEQ '1'                                                        AR1065437
     C                     MOVEL'Y2U0021' W0RTN   7                                        AR1065437
     C                     ELSE                                                            AR1065437
     C                     MOVE WUDDCD    ZQBDTE                                           AR1065437
     C                     ENDIF                                                           AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C                     MOVE HQPTRS    ZQPTRS                                           AR1065437
     C                     MOVE HQJETP    ZQJETP                                           AR1065437
     C                     ELSE                                                            AR1065437
     C                     MOVE 'N'       WCBIM                                            AR1065437
     C                     MOVE *OFF      *IN98                                            AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
      *                                                                                    AR1065437
     C           HQJETP    IFEQ 'C'                                                        AR1065437
     C           KJENX     CHAINGLJEPQD0             96                                    AR1065437
      *                                                                                    AR1065437
     C           *IN96     IFEQ *OFF                                                       AR1065437
     C           IQBCRT    IFNE 0                                                          AR1065437
     C                     MOVE IQBCRT    W#NUMB 150                                       AR1065437
     C                     CALL 'ZSEDIT'                                                   AR1065437
     C                     PARM           W#NUMB                                           AR1065437
     C                     PARM 8         W#DECS  10                                       AR1065437
     C                     PARM *BLANK    W#EDTC  1                                        AR1065437
     C                     PARM           W#CHAR 21                                        AR1065437
     C                     MOVE W#CHAR    ZQBCRT                                           AR1065437
     C                     ENDIF                                                           AR1065437
     C                     MOVE IQBCIN    ZQBCIN                                           AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C                     ENDSR                                                           AR1065437
      *                                                                                    AR1065437
      *****************************************************************                    AR1065437
      /EJECT                                                                               AR1065437
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
      *                                                                                       CSC042
      * Set up index used by ccy arrays                                                       CSC042
     C                     Z-ADD0         ##QNDX                                              CSC042
      *                                                                                       CSC042
      * Setup job date/time.
     C                     Z-ADDUDATE     ##JDT            Job date.
     C                     TIME           ##JTM            Job time.
     C                     TIME           ##TME   60       Screen time.
      * Define work field S01212
     C                     MOVEL*BLANK    WUFKST  1
      * Define work field Reversal / Void Indicator
     C                     MOVEL*BLANK    WURVVD  1
      * Define work field Batch Description
     C                     MOVEL*BLANK    WUBDES 30
      * Define work field Spread Total                                    S01333
     C                     Z-ADD*ZERO     WUSPTT 100                      S01333
      * Define work field No. of Items to Spread to                       S01340
     C                     Z-ADD*ZERO     WUNIST  30                      S01340
      * Define work field Spread Profile Code                             S01333
     C                     MOVEL*BLANK    WUSPRF  4                       S01333
      * Define work field Debit/credit indicator                          S01333
     C                     MOVEL*BLANK    WUDCIN  1                       S01333
      * Define work field Input Branch Cd  Alloc Fm                       S01333
     C                     MOVEL*BLANK    WUIBCF  3                       S01333
      * Define work field Customer Number  Alloc Fm                       S01333
     C                     MOVEL*BLANK    WUCUSF  6                       S01333
      * Define work field Currency Code    Alloc Fm                       S01333
     C                     MOVEL*BLANK    WUCYCF  3                       S01333
      * Define work field Account Code     Alloc Fm                       S01333
     C**********           MOVEL*BLANK    WUACCF  4                                    S01333 CGL029
     C                     MOVEL*BLANK    WUACCF 10                                           CGL029
      * Define work field Account Seq No.  Alloc Fm                       S01333
     C                     MOVEL*BLANK    WUACSF  2                       S01333
      * Define work field Nostro No. (Item)Alloc Fm                       S01333
     C                     MOVEL*BLANK    WUNNBF  2                       S01333
      * Define work field Retail A/c No.   Alloc Fm                       S01333
     C                     Z-ADD*ZERO     WURACF 100                      S01333
      * Define work field Profit Centre    Alloc Fm                       S01333
     C                     MOVEL*BLANK    WUPRCF  4                       S01333
      * Define work field Amount           Alloc Fm                       S01340
     C                     Z-ADD*ZERO     WUAMTF 130                      S01340
      * Define work field Input Branch Cd  Alloc To                       S01333
     C                     MOVEL*BLANK    WUIBCT  3                       S01333
      * Define work field Customer Number  Alloc To                       S01333
     C                     MOVEL*BLANK    WUCNAT  6                       S01333
      * Define work field Currency Code    Alloc To                       S01333
     C                     MOVEL*BLANK    WUCYCT  3                       S01333
      * Define work field Account Code     Alloc To                       S01333
     C**********           MOVEL*BLANK    WUACCT  4                                    S01333 CGL029
     C                     MOVEL*BLANK    WUACCT 10                                           CGL029
      * Define work field Account Seq No.  Alloc To                       S01333
     C                     MOVEL*BLANK    WUASNT  2                       S01333
      * Define work field Nostro No. (Item)Alloc To                       S01333
     C                     MOVEL*BLANK    WUNNBT  2                       S01333
      * Define work field Retail A/c No.   Alloc To                       S01333
     C                     Z-ADD*ZERO     WURACT 100                      S01333
      * Define work field Type of Journal Entry                           S01340
     C                     MOVEL*BLANK    WUTOJE  1                       S01340
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Branch code
     C                     MOVEL*BLANK    WUBRCD  3
      * Define work field Company Code
     C                     MOVEL*BLANK    WUCMCD  3
      * Define work field Location Code
     C                     MOVEL*BLANK    WULCCD  3
      * Define work field Due From Account Code
     C**********           MOVEL*BLANK    WUDFAC  4                                           CGL029
     C                     MOVEL*BLANK    WUDFAC 10                                           CGL029
      * Define work field Due To Account Code
     C**********           MOVEL*BLANK    WUDTAC  4                                           CGL029
     C                     MOVEL*BLANK    WUDTAC 10                                           CGL029
      * Define work field Branch Internal Customer
     C                     MOVEL*BLANK    WUBICN  6
      * Define work field Global Branch Code
     C                     MOVEL*BLANK    WUGBCD  3
      * Define work field Branch Shortname
     C                     MOVEL*BLANK    WUBRSN  3
      * Define work field Batch number
     C                     MOVEL*BLANK    WUBTNB  3
      * Define work field Branch Code - Alpha
     C                     MOVEL*BLANK    WUBCDA  3
      * Define work field Dept Code
     C                     MOVEL*BLANK    WUDPCD  3
      * Define work field Workstation id.
     C                     MOVEL*BLANK    WUWSID 10
      * Define work field Hash integer calculated
     C                     Z-ADD*ZERO     WUHICC 150
      * Define work field Hash decimal calculated
     C                     Z-ADD*ZERO     WUHDCC  30
      * Define work field Hash item no.calculated
     C                     Z-ADD*ZERO     WUHINC  30
      * Define work field Hash integer input
     C                     Z-ADD*ZERO     WUHIIN 150
      * Define work field Hash decimal input
     C                     Z-ADD*ZERO     WUHDIN  30
      * Define work field Hash item no.input
     C                     Z-ADD*ZERO     WUHINI  30
      * Define work field Batch status flag
     C                     MOVEL*BLANK    WUBTSF  1
      * Define work field Batch in use flag
     C                     MOVEL*BLANK    WUBIUF  1
      * Define work field Shadow post indicator
     C                     MOVEL*BLANK    WUSHPI  1
      * Define work field Retail advice print ind.
     C                     MOVEL*BLANK    WURAPI  1
      * Define work field Multiple Branch Batch
     C                     MOVEL*BLANK    WUMBRB  1
      * Define work field Batch in use msg. 1
     C                     MOVEL*BLANK    WUBUM1 25
      * Define work field Batch in use msg. 2
     C                     MOVEL*BLANK    WUBUM2 25
      * Define work field Batch in use msg. 3
     C                     MOVEL*BLANK    WUBUM3 25
      * Define work field Batch in use msg. 4
     C                     MOVEL*BLANK    WUBUM4 25
      * Define work field Batch in use msg. 5
     C                     MOVEL*BLANK    WUBUM5 25
      * Define work field Multibranching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field 2nd Detail line entered?
     C                     MOVEL*BLANK    WUSDLE  7
      * Define work field Number of Decimal Places
     C                     Z-ADD*ZERO     WUNBDP  10
      * Define work field Currency Name
     C                     MOVEL*BLANK    WUCYNM 14
      * Define work field Nostro Shortname
     C                     MOVEL*BLANK    WUNOSN 10
      * Define work field Date Format flag
     C                     MOVEL*BLANK    WUDTFF  1
      * Define work field Date (numeric format)
     C                     Z-ADD*ZERO     WUDTNF  60
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUDDCD  7
      * Define work field Customer number
     C                     MOVEL*BLANK    WUCUST  6
      * Define work field Currency code
     C                     MOVEL*BLANK    WUCYCD  3
      * Define work field Account code
     C**********           MOVEL*BLANK    WUACCD  4                                           CGL029
     C                     MOVEL*BLANK    WUACCD 10                                           CGL029
      * Define work field Account sequence number
     C                     MOVEL*BLANK    WUACSN  2
      * Define work field Account type
     C                     MOVEL*BLANK    WUACTY  1
      * Define work field Account subtype
     C                     MOVEL*BLANK    WUBPST  1
      * Define work field Account status
     C                     MOVEL*BLANK    WUACCS  1
      * Define work field Date account opened
     C                     Z-ADD*ZERO     WUDACO  50
      * Define work field Account name
     C                     MOVEL*BLANK    WUACNM 20
      * Define work field Retail account number
     C                     Z-ADD*ZERO     WURACN 100
      * Define work field Retail Indicators   MIDAS
     C                     MOVEL*BLANK    WURETB  1
      * Define work field Retail indicators
     C                     MOVEL*BLANK    WURTIN  1
      * Define work field Item error state
     C                     MOVEL*BLANK    WUIEST  1
      * Define work field GL Description Ind.
     C                     MOVEL*BLANK    WUGLDI  1
      * Define work field Relative rec no of memos
     C                     Z-ADD*ZERO     WURRNM  50
      * Define work field Display Account
     C                     MOVEL*BLANK    WUDSAC  1
      * Define work field Customer Report Name
     C                     MOVEL*BLANK    WUCRNM 20
      * Define work field Display Customer
     C                     MOVEL*BLANK    WUDCUS  1
      * Define work field Spool File Name
     C                     MOVEL*BLANK    WUSFNM 10
      * Define work field Spool File Number
     C                     Z-ADD*ZERO     WUSFNB  60
      * Define work field Midas Rundate
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Runday Number
     C                     Z-ADD*ZERO     WURDNO  50
      * Define work field Setup Complete
     C                     MOVEL*BLANK    WUSUCP  1
      *                                                                   CGL008
      ** Define work fields for Last Insert User and Last Amend User      CGL008
      *                                                                   CGL008
     C                     MOVE *BLANKS   WUUSRI 10                       CGL008
     C                     MOVE *BLANKS   WUUSRA 10                       CGL008
      * Obtain default message file.
     C           *NAMVAR   DEFN MIMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field General Ledger
     C                     MOVEL*BLANK    WUGNLG 10
      * Define work field Profit & Loss Accnt Code
     C**********           MOVEL*BLANK    WUPLAC  4                                           CGL029
     C                     MOVEL*BLANK    WUPLAC 10                                           CGL029
      * Define work field Base Currency Transfer Fq
     C                     MOVEL*BLANK    WUBCTF  1
      * Define work field Accrual Key Summary Ind.
     C                     MOVEL*BLANK    WUAKSI  1
      * Define work field Accruals/Profit Date
     C                     Z-ADD*ZERO     WUAPDT  50
      * Define work field Accruals/Profit Frequency
     C                     MOVEL*BLANK    WUAPFQ  1
      * Define work field Accruals/Profit Fq. Day
     C                     Z-ADD*ZERO     WUAPFD  20
      * Define work field Accrue on Last Day Ind.
     C                     MOVEL*BLANK    WUALDI  1
      * Define work field A/c Posting Retention Pd
     C                     Z-ADD*ZERO     WUAPRP  20
      * Define work field Accrual Non-Wk Day Ind
     C                     MOVEL*BLANK    WUANWD  1
      * Define work field Spot Rates Retention Pd
     C                     Z-ADD*ZERO     WUSRRP  20
      * Define work field Base Rates Retention Pd
     C                     Z-ADD*ZERO     WUBRRP  20
      * Define work field Profit Centres Used
     C                     MOVEL*BLANK    WUPRCU  1
      * Define work field Profit Centres Amendable
     C                     MOVEL*BLANK    WUPRCA  1
      * Define work field Profit Centre Def'ts Used
     C                     MOVEL*BLANK    WUPCDU  1
      * Define work field Prof C Def Matrix-Book
     C                     MOVEL*BLANK    WUPMBK  1
      * Define work field Prof C Def Matrix-T Type
     C                     MOVEL*BLANK    WUPMTT  1
      * Define work field Prof C Def Matrix-S Type
     C                     MOVEL*BLANK    WUPMST  1
      * Define work field Prof C Def Matrix-Branch
     C                     MOVEL*BLANK    WUPMBH  1
      * Define work field Prof C Def Matrix-Dept
     C                     MOVEL*BLANK    WUPMDT  1
      * Define work field Prof C Def Matrix-User
     C                     MOVEL*BLANK    WUPMUR  1
      * Define work field Prof C Def Matrix-A/c Off
     C                     MOVEL*BLANK    WUPMAO  1
      * Define work field Prof C Def Matrix-Cust
     C                     MOVEL*BLANK    WUPMCU  1
      * Define work field Originating Branch Used
     C                     MOVEL*BLANK    WUOBRU  1
      * Define work field Orig Branch User/Vald Req
     C                     MOVEL*BLANK    WUOBUV  1
      * Define work field JE Special Character
     C                     MOVEL*BLANK    WUJESP  1
      * Define work field JE Int-Bch Ents @ Bch/Itm
     C                     MOVEL*BLANK    WUIEBI  1
      * Define work field Main Branch
     C                     MOVEL*BLANK    WUMABR  3
      * Define work field Int-Bch Ent Via Main Brch
     C                     MOVEL*BLANK    WUIEMB  1
      * Define work field End of Last Activity Per.
     C                     Z-ADD*ZERO     WUELAP  50
      * Define work field End of Current Act Period
     C                     Z-ADD*ZERO     WUECAP  50
      * Define work field ZSFile Error
     C                     MOVEL*BLANK    WUZSER  1
     C           *NAMVAR   DEFN           GLREOV           Override DTAARA
     C                     IN   GLREOV                     Obtain   DTAARA
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary.
     C                     OPEN GL0121PM                                                      CGL013
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
     C                     CLOSEGL0121PM                                                      CGL013
      * USER: Initialise program
      * Standard RPG Creation Par - Standard functions  *
      * Window Processing Hdr Box - Standard functions  *
      * Last Amend Hdr Box  CRPF - Journal Entry Posting  *
      * Access Midas rundate - Standard functions  *
     C*   Access MIDAS Rundate from data-area RUNDAT
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT
     C                     MOVE RDNO      WURDNO
     C                     MOVE SUCP      WUSUCP
     C                     MOVE DTFF      WUDTFF
     C                     MOVE MBIN      WUMBIN
      * access bank title - Standard functions  *
      *                                                                   S01117
      *****P@BJRF    E DSSDBANKPD                                         S01117
      * @BTREE4 - BANK RECORD FORMAT DATA STRUCTURE                       S01117
      *                                                                   S01117
     C                     CALL 'AOBANKR0'
     C                     PARM           P@RTCD  7        B:Return code
     C*********************PARM '*KEY'    P@OPTN  7        I:Option       S01117
     C                     PARM '*FIRST'  P@OPTN  7        I:Option       S01117
     C*********************PARM 'BANK'    P@BYCD 10        I:Key field    S01117
     C           P@BJRF    PARM *BLANK    UUFDY            O:Format
     C                     MOVELBJURPT    ##URPT
      *                                                                   CGL008
      **  Access SAR details file to see if CGL008 SAR is installed       CGL008
      *                                                                   CGL008
     C                     CALL 'AOSARDR0'                                CGL008
     C                     PARM *BLANKS   @RTCD   7                       CGL008
     C                     PARM '*VERIFY' @OPTN   7                       CGL008
     C                     PARM 'CGL008'  @SARD   6                       CGL008
      *                                                                   CGL008
     C           @RTCD     IFEQ *BLANK                                    CGL008
     C                     MOVE 'Y'       CGL008  1                       CGL008
     C                     ELSE                                           CGL008
     C                     MOVE 'N'       CGL008                          CGL008
     C                     MOVE *ON       *IN22                           CGL008
     C                     ENDIF                                          CGL008
      *                                                                   CGL008
      **  Access SAR details file to see if ULX043 SAR is installed                           CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  @SARD                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE *BLANK                                                        CER001
     C           @RTCD     ANDNE'*NRF'                                                        CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX043                                              CER001
     C                     ENDIF                                                              CER001
     C/COPY WNCPYSRC,GL0121PC04
      * Copyright notice - Standard functions  *
      * Define 200 Byte Dummy DS - Standard functions  *
      * Define 800 Byte Dummy DS - Standard functions  *
      * Currency Codes DS - Currency Codes  *
      * Narrative Codes DS - Narrative Codes  *
      * Account Details DS - Standard functions  *
      * Declare Bank File DS - Standard functions  *
      * Branch Codes DS - Branch Codes  *
      * General Ledger Details DS - General Ledger Details  *
      * Department Codes DS - Department Codes  *
      * Client Details DS - Client Details  *
      * Setup message data for message.
      * Retrieve message 'Batch in use message 1'
     C                     MOVELZADFMF    ZAMSGF           Default message
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code.
     C                     PARM 'GLX0093' ZAMSID  7        Message id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C           WUBUM1    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message.
      * Retrieve message 'Batch in use message 2'
     C                     MOVELZADFMF    ZAMSGF           Default message
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code.
     C                     PARM 'GLX0094' ZAMSID  7        Message id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C           WUBUM2    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message.
      * Retrieve message 'Batch in use message 3'
     C                     MOVELZADFMF    ZAMSGF           Default message
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code.
     C                     PARM 'GLX0095' ZAMSID  7        Message id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C           WUBUM3    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message.
      * Retrieve message 'Batch in use message 4'
     C                     MOVELZADFMF    ZAMSGF           Default message
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code.
     C                     PARM 'GLX0096' ZAMSID  7        Message id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C           WUBUM4    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message.
      * Retrieve message 'Batch in use message 5'
     C                     MOVELZADFMF    ZAMSGF           Default message
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code.
     C                     PARM 'GLX0097' ZAMSID  7        Message id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C           WUBUM5    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Start of Fix SAR017
      * Access General Ledger. - General Ledger Details  *
     C*
     C*  Access General Ledger Details file for it' file fields
     C*
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM @CN,22    UUAPOP  7        I:Option
     C********** D@GELR    PARM *BLANK    UUFDY            O:Format                           CGL029
     C           D@GELR    PARM *BLANK    UUSDY                                               CGL029
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELBKGNLG    WUGNLG           General Ledger
     C                     MOVELBKACCD    WUACCD           Account Code
     C                     MOVELBKPLAC    WUPLAC           Profit & Loss Account
     C                     MOVELBKCUST    WUCUST           Cutomer Number
     C                     MOVELBKBCTF    WUBCTF           Base Currency Tran
     C                     MOVELBKAKSI    WUAKSI           Accrual Key summary
     C                     MOVELBKAPDT    WUAPDT           Accruals Profit Date
     C                     MOVELBKAPFQ    WUAPFQ           Accruals Profit Freq
     C                     MOVELBKAPFD    WUAPFD           Accruals Profit Fr Dy
     C                     MOVELBKALDI    WUALDI           Accrue on Last Day
     C                     MOVELBKAPRP    WUAPRP           A/c Posting Ret Pd.
     C                     MOVELBKANWD    WUANWD           Accrual non-wk Day
     C                     MOVELBKSRRP    WUSRRP           Spot Rates Retention
     C                     MOVELBKBRRP    WUBRRP           Base Rates Retention
     C                     MOVELBKGLDI    WUGLDI           GL Description Ind
     C                     MOVELBKPRCU    WUPRCU           Profit Centres Used
     C                     MOVELBKPRCA    WUPRCA           Profit Centres Amend
     C                     MOVELBKPCDU    WUPCDU           Profit Centre Default
     C                     MOVELBKPMBK    WUPMBK           Prof C Matrix Book
     C                     MOVELBKPMTT    WUPMTT           Prof C Matrix Trans
     C                     MOVELBKPMST    WUPMST           Prof C Matrix SubType
     C                     MOVELBKPMBH    WUPMBH           Prof C Matrix Branch
     C                     MOVELBKPMDT    WUPMDT           Prof C Matrix Dept
     C                     MOVELBKPMUR    WUPMUR           Prof C Matrix User
     C                     MOVELBKPMAO    WUPMAO           Prof C Matrix Acc Off
     C                     MOVELBKPMCU    WUPMCU           Prof C Matrix Cust
     C                     MOVELBKOBRU    WUOBRU           Originating Branch Ud
     C                     MOVELBKOBUV    WUOBUV           Orig Branch/User Vald
     C                     MOVELBKJESP    WUJESP           Copy Special Char
     C                     MOVELBKELAP    WUELAP           End of Last Activity
     C                     MOVELBKECAP    WUECAP           End of Curnt Activity
      * End of Fix SAR017
      * Start of Fix LN0714
      **ZSFile*-*Log*Spool*File*-*Standard*functions*******************   LN0955
     C*****************************************************************   LN0955
     C**Set*up*spool*file*number*-*Standard*Functions******************   LN0955
     C*********************Z-ADD@$FNB     WUSFNB                          LN0955
     C*********************MOVE *BLANKS   UUSRSQ  5                       LN0955
     C*****************************************************************   LN0955
     C**ZSFILE*-*write*report*rqs*-*Standard*Functions*****************   LN0955
     C*********************CALL 'ZSFILE'               90  ZSFILE - write LN0955
     C*********************PARM #IRSQN    UURSQN  5        RCF sequence nuLN0837
     C***********UUSRSQ****PARM P1RSQN    UURSQN  5        RCF sequence nuLN0955
     C*********************PARM P3ENTY    UUENTY  3        Entity         LN0955
     C*********************PARM @$FVN     UUSFNM 10        Spool file nameLN0955
     C*********************PARM WUSFNB    UUSFNB  60       Spool file numbLN0955
     C***********WUZSER****PARM *BLANK    UUZSER  1        ZSFILE error   LN0955
     C*****************************************************************   LN0955
     C************IN90*****IFEQ '1'                                       LN0955
     C**Call*to*program*ended*in*error.********************************   LN0955
     C*********************MOVEL'Y2U0021' W0RTN   7                       LN0955
     C*********************END                                            LN0955
     C*****************************************************************   LN0955
     C**CASE:*WRK.ZSFILE*is*error*occurred*****************************   LN0955
     C*****************************************************************   LN0955
     C***********#OZSER****IFEQ 'Y'                                       LN0955
     C*********************MOVEL'Y2U0004' P0RTN                           LN0955
     C*********************EXSR ZYEXPG                                    LN0955
     C*********************END                                            LN0955
      **** Setup spool file name and number, then call ZSFILE       E28128E36338
      **ZSFile*-*Log Spool File - Standard functions                E28128E36338
     C*****                                                         E28128E36338
     C**Set*up*spool file number - Standard Functions               E28128E36338
     C*****                Z-ADD@$FNB     WUSFNB                    E28128E36338
     C*****                MOVE *BLANKS   UUSRSQ  5                 E28128E36338
     C*****                                                         E28128E36338
      **ZSFILE*-*write report rqs - Standard Functions              E28128E36338
     C*****                CALL 'ZSFILE'               90  ZSFILE - E28128E36338
     C*****      UUSRSQ    PARM P1RSQN    UURSQN  5        RCF sequeE28128E36338
     C*****                PARM BTIBCA    UUENTY  3        Entity   E28128E36338
     C*****                PARM @$FVN     UUSFNM 10        Spool filE28128E36338
     C*****                PARM WUSFNB    UUSFNB  60       Spool filE28128E36338
     C*****      WUZSER    PARM *BLANK    UUZSER  1        ZSFILE erE28128E36338
     C*****                                                         E28128E36338
     C*****      *IN90     IFEQ '1'                                 E28128E36338
     C**Call*to*program ended in error.                             E28128E36338
     C*****                MOVEL'Y2U0021' W0RTN   7                 E28128E36338
     C*****                END                                      E28128E36338
     C*****                                                         E28128E36338
     C**CASE:*WRK.ZSFILE is error occurred                          E28128E36338
     C*****                                                         E28128E36338
     C*****      WUZSER    IFEQ 'Y'                                 E28128E36338
     C*****                MOVEL'Y2U0004' P0RTN                     E28128E36338
     C*****                EXSR ZYEXPG                              E28128E36338
     C*****                END                                      E28128E36338
     C*                                                                   S01413
     C** Access Module Details & RE3 ICD                                  S01413
     C*                                                                   S01413
     C                     CALL 'AOMMODR0'                                S01413
     C                     PARM           P@RTCD  7        B:Return code  S01413
     C                     PARM '*FIRST'  P@OPTN  7        I:Option       S01413
     C           D@MMOD    PARM D@MMOD    UUFDY            O:Format       S01413
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0121PCP3                                           S01408
     C*                                                                   S01408
     C           P@RTCD    IFNE *BLANKS                                                       CER001
     C           ULX043    ANDEQ'Y'                                                           CER001
     C                     MOVE 'N'       BGNWST                                              CER001
     C                     ENDIF                                                              CER001
     C*                                                                   S01413
     C           1         SETLLTABTBRE                                   S01413
     C                     READ TABTBRE                  50               S01413
     C*                                                                   S01413
     C** Set up indicator 51 if RE3 and Charges for Multiple              S01413
     C**  Transactions Optional Feature are installed                     S01413
     C*                                                                   S01413
     C           BGNXST    IFEQ 'Y'                                       S01413
     C           CMTR      ANDEQ'Y'                                       S01413
     C                     MOVE '1'       *IN51                           S01413
     C                     END                                            S01413
     C*                                                                   S01413
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  WSARD   6                       CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     ENDIF                                          CEU013
      *                                                                                       CGL013
      ** Access SAR details file to see if CGL013 is installed.                               CGL013
      *                                                                                       CGL013
     C           KJENX     KLIST                                                              CGL013
     C                     KFLD           BTBTNB                                              CGL013
     C                     KFLD           BTBINB                                              CGL013
      *                                                                                     BUG23742
      ** Klist for the file GLMNARL3                                                        BUG23742
      *                                                                                     BUG23742
     C           KJENL3    KLIST                                                            BUG23742
     C                     KFLD           BTPTDT                                            BUG23742
     C                     KFLD           BTBTNB                                            BUG23742
     C                     KFLD           BTBINB                                            BUG23742
      *                                                                                       CGL013
     C                     CALL 'AOSARDR0'                                                    CGL013
     C                     PARM *BLANKS   PRTCD   7                                           CGL013
     C                     PARM '*VERIFY' POPTN   7                                           CGL013
     C                     PARM 'CGL013'  PSARD   6                                           CGL013
      *                                                                                       CGL013
     C           PRTCD     IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       CGL013  1                                           CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE 'N'       CGL013                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                     BUG23742
      ** Access SAR details file to see if CER030 is installed.                             BUG23742
      *                                                                                     BUG23742
     C                     MOVE *OFF      *IN37                                             BUG23742
      *                                                                                     BUG23742
     C                     CALL 'AOSARDR0'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD   7                                         BUG23742
     C                     PARM '*VERIFY' POPTN   7                                         BUG23742
     C                     PARM 'CER030'  PSARD   6                                         BUG23742
      *                                                                                     BUG23742
     C           PRTCD     IFEQ *BLANK                                                      BUG23742
     C                     MOVE 'Y'       CER030  1                                         BUG23742
     C                     MOVE *ON       *IN37                                             BUG23742
     C                     ELSE                                                             BUG23742
     C                     MOVE 'N'       CER030                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
      ** Access SAR details file to see if CGL125 is installed.                            AR1065437
      *                                                                                    AR1065437
     C                     MOVE *OFF      *IN98                                            AR1065437
      *                                                                                    AR1065437
     C                     CALL 'AOSARDR0'                                                 AR1065437
     C                     PARM *BLANKS   PRTCD                                            AR1065437
     C                     PARM '*VERIFY' POPTN                                            AR1065437
     C                     PARM 'CGL125'  PSARD                                            AR1065437
      *                                                                                    AR1065437
     C           PRTCD     IFEQ *BLANK                                                     AR1065437
     C                     MOVE 'Y'       CGL125  1                                        AR1065437
     C                     MOVE *ON       *IN98                                            AR1065437
     C                     ELSE                                                            AR1065437
     C                     MOVE 'N'       CGL125                                           AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C*                                                                   CEU013
      * Report Title GL0121P - Journal Entry Posting  *
     C                     MOVEAUHDR,1    ##REPT
     C                     MOVEAUHDR,2    ##UNDL
      * End of Fix LN0714
     C                     MOVEL@CN,01    WUFKST           S01212
      *CASE:     WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ @CN,01                     *IF
      * 00/Copy Member GL0121PIPG - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0121PCPG
     C                     END                             *FI
     C/COPY WNCPYSRC,GL0121PC12
      *================================================================
     CSR         ZZEXIT    ENDSR
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * SRADIN - Subroutine to process Additional Information         *                       CGL013
      *          Details if CGL013 is installed.                      *                       CGL013
      *                                                               *                       CGL013
      * Called by: GARDRC                                             *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           SRADIN    BEGSR                                                              CGL013
      *                                                                                       CGL013
     C                     MOVEA'000000'  *IN,31                                              CGL013
     C           KJENX     CHAINGLJENXL2             30                                       CGL013
     C           *IN30     IFEQ *OFF                                                          CGL013
      *                                                                                       CGL013
     C           BAADI1    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN31                                               CGL013
     C                     MOVELBAADI1    XRADI1                                              CGL013
     C                     MOVE BAAERI    XRAERI                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI2    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN32                                               CGL013
     C                     MOVELBAADI2    XRADI2                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI3    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN33                                               CGL013
     C                     MOVELBAADI3    XRADI3                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI4    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN34                                               CGL013
     C                     MOVELBAADI4    XRADI4                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI5    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN35                                               CGL013
     C                     MOVELBAADI5    XRADI5                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI6    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN36                                               CGL013
     C                     MOVELBAADI6    XRADI6                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * *PSSR  - Program exception error routine                      *                       CGL013
      *          Called automatically if a program error occurs,      *                       CGL013
      *          or directly by the program code using EXSR.          *                       CGL013
      *          This subroutine DUMPs the program just once.         *                       CGL013
      *                                                               *                       CGL013
      * Called by: ZZINIT                                             *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           *PSSR     BEGSR                                                              CGL013
      *                                                                                       CGL013
     C           @RUN      IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       @RUN    1                                           CGL013
     C                     DUMP                                                               CGL013
     C                     CALL 'DBERRCTL'                                                    CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     MOVE *ON       *INU7                                               CGL013
     C                     MOVE *ON       *INU8                                               CGL013
     C                     MOVE *ON       *INLR                                               CGL013
     C                     RETRN                                                              CGL013
      *                                                                                       CGL013
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
     O/COPY WNCPYSRC,GL0121POPG
** CPY@
(c) Finastra International Limited 2001
** UHDR REPORT TITLE AND UNDERLINE
     JOURNAL ENTRIES:- BATCH ITEMS - ALL BATCHES
     -------------------------------------------
** @CN Long constants used in program.
Y
*KEY
1
N
*NONE
J
*CLOSE
*ERROR
*OPEN
*NRF
*EMPTY
*EOF
*OPTION
*CALL
*SELECT
*NOSEL
*ID
*ENTER
**ERR**
B
ALL
*FIRST
