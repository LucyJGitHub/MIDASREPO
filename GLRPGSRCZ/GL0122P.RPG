     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL JEs report batch items - one batch')          *
     H/TITLE Midas GL Batch Details Report
     Z* CRTRPGPGM
     Z* IGNDECERR(*YES)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : SYNON/2  Version:  9054
     H* Function type : Print file
      *
     H*  Company :
     H* System        : General Ledger Synon Model
     H* User name     : F7867PC
     H* Date          : 15/02/92  Time  : 01:05:04
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*****************************************************************
     F*
     F*     DATE   - 28.09.89
     F*
     F*     S01212 - WINDOW PROCESSING INSTALLED - /COPY
     F*
     F*****************************************************************
     F*****************************************************************
     F*                                                               *
      *  Last Amend No. CGL182             Date 11May17               *
      *  Prev Amend No. MD027587           Date 19Jun14               *
      *                 AR1065437          Date 23Jan13               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23742           Date 09May09               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL013             Date 29Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CGL008             Date 08Mar99               *
      *                 CEU013             DATE 02Apr98               *
      *                 097910             DATE 19Feb98               *
     F*                 110546             Date 28OCT96               *
     F*                 S01408             Date 05SEP95               *
     F*                 S01408             DATE 04AUG95               *
     F*                 S01413                  13APR93               *
     F*                 S10736                  09SEP92               *
     F*                 E38270                  06JUL92               *
     F*                 S01340                  28FEB92               *
     F*                 LN0882                  10OCT90               *
     F*                 BHF672                  20SEP90               *
     F*                 BHF665                  20SEP90               *
     F*                 LN0714                  07SEP90               *
     F*                 LN0315                  06JUN90               *
     F*                 E18852                  28SEP89               *
     F*                 SAR017                  13SEP89               *
     F*****************************************************************
     F*                                                               *
      *  CGL182 - Journal Entry via the Interface File - Java Version *
      *           (Recompile)                                         *
      *  MD027587 - Unable to used the C for Copy and T for Template  *
      *             (Recompile)                                       *
      *  AR1065437 - Extra fields on PEA Audit Report                 *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23742 - Improper handling of Ext Narr from Batch          *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature (Recompile)                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL013 - MT94x Messages Generation                           *
      *  CGL008 - Security on Journal Entry                           *
     F*  CEU013 - EMU Account Postings Narrative                      *
     F*  097910 - CHECK RETAIL INDICATORS CORRECTLY.                  *
     F*  110546 - Override details are not printed properly as retail *
     F*           indicator is incorrectly setup.                     *
     F*  S01408 - Addition of core hooks GL0122PCP3.                  *
     F*  S01408 - Addition of core hooks GL0122PCP1.                  *
     F*           Addition of core hooks DL0122PCP2.                  *
     F*  S01413 - Retail 3 Incorporation.                             *
     F*  S10736 - ADD REVERSAL/VOID INDICATOR                         *
     F*  E38270 - RECOMPILE FOR CHANGES TO PRINTER FILE               *
     F*  S01340 - REMOVED FROM SYNON MODEL + AMEND RCF PROCESSING     *
     F*  LN0882 - STANDARDISE REPORT TITLES                           *
     F*  BHF672 - RETRIEVE DEPT CODE AND BRANCH CODE                  *
     F*                                                               *
     F*  BHF665 - CHANGE EDIT CODE ON RETAIL A/C NUMBER SO THAT       *
     F*           LEADING ZEROS ARE NOT SUPPRESSED                    *
     F*                                                               *
     F*  LN0714 - Replace the call to the Batch Report Functions      *
     F*           which were called interactively with a call to      *
     F*           FCC0201 and FCC0202 for RCF in order for the        *
     F*           reports to be run in batch.                         *
     F*                                                               *
     F*  LN0315 - ADDITION OF RETAIL INDICATORS ON CALL TO AOACCTR0   *
     F*                                                               *
     F*  E18852 - TO STOP JOURNAL ENTRIES BEING POSTED ACROSS         *
     F*            DIFFERENT BRANCHES                                 *
     F*                                                               *
     F*  SAR017 - TO DISPLAY THE CUSTOMER REPORT NAME AND THE         *
     F*            ACCOUNT NAME ON BATCH ITEM INPUT SCREEN.           *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,GL0122PFPG
     FGLJENHL1IF  E           K        DISK
      * RTV : Midas GL Journal Entry Header LF Rtv
      *
     FGLJENPL1IF  E           K        DISK
      * RTV : Midas GL Journal Entry Posting Rtv
      *
     FGLJENXL2IF  E           K        DISK         KINFSR *PSSR                              CGL013
      ** RTV: Midas GL Journal Entry File - Additional Information                            CGL013
      *                                                                                       CGL013
     FTABTBRE IF  E                    DISK                               S01413
      * RTV: Midas Retail 3 ICD                                   S01413
      *                                                                   S01413
     FGLMNARL3IF  E           K        DISK         KINFSR *PSSR                            BUG23742
      *                                                                                     BUG23742
      ** Midas GL MultiCash Narratives File - Rtv Indx                                      BUG23742
      *                                                                                     BUG23742
     FGLJEPQL0IF  E           K        DISK         KINFSR *PSSR                           AR1065437
     FGLJENQL0IF  E           K        DISK         KINFSR *PSSR                           AR1065437
      ** RTV: Journal Entry Detail Extension File                                          AR1065437
      *                                                                                    AR1065437
     FGL0122PMO   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Midas GL Batch Details Report
      *
     E                    CPY@    1   1 80               Copyright     array
     E                    UHDR    1   2 53
     E/COPY WNCPYSRC,GL0122PEPG
     E                    IUL         3132                                                    CER001
      * IBLC Extended informations array                                                      CER001
     E                    @IH         8 10               Item Err.slots
     I*   Define MIDAS Rundate from data-area RUNDAT
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I/COPY WNCPYSRC,GL0122PIPG
     IILLINE      DS                            396                                           CER001
      * Extended informations from IBLC 2002                                                  CER001
     I                                        1 132 ILLIN1                                    CER001
     I                                      133 264 ILLIN2                                    CER001
     I                                      265 396 ILLIN3                                    CER001
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNO
     I                                       11  11 SUCP
     I                                       12  12 DTFF
     I                                       13  13 MBIN
     I*
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
     IUUSDY     E DSDSSDY
     I*
     I* 800 Byte Data Structure for Incoming Data from Access Program
     I*
     IUUFDY     E DSDSFDY
     I*
     I* 200 Byte Data Structure for Incoming Data from Access Program
      *                                                                                       CER001
     ISCSARD    E DSSCSARDPD                                                                  CER001
     I              LCD                             @@LCD                                     CER001
      ** Dummy record format for access to Switchable Features Details                        CER001
     I*
     ID@CURR    E DSSDCURRPD
     I*
     I*  Currency Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@NARR    E DSSDNARRPD
     I*
     I*  Narrative Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@ACCT    E DSACCNTAB
     I*
     I*  Account Details DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@BRCH    E DSSDBRCHPD
     I*
     I*  Branch Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@DEPT    E DSSDDEPTPD
     I*
     I*  Department Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@GELR    E DSSDGELRPD
     I*
     I*  General Ledger Details DS for assigning data from Access
     I*  Programs to work fields
     I*
     IP@BJRF    E DSSDBANKPD
     I* @BTREE4 - BANK RECORD FORMAT DATA STRUCTURE
     I*
     ID@CUST    E DSSDCUSTPD
     I              QQDFAC                          DFACQQ                                    CGL029
     I*
     I*  Client Details DS for assigning data from Access
     I*  Programs to work fields
     I/COPY WNCPYSRC,GL0122PI02
     I*
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
     I            DS
     I                                        1   30ULVAL2
     I                                        1   99ULVALD
      * Set up parameters :
     IUUDTNF      DS
     I                                        1   2 UUSLT1
     I                                        3   4 UUSLT2
     I                                        5   6 UUSLT3
      *
     IUUVDTP      DS
     I                                        1   2 UUALT1
     I                                        3   3 UUSLT4
     I                                        4   5 UUALT2
     I                                        6   6 UUSLT5
     I                                        7   8 UUALT3
      *
     IGLREOV      DS
      * Retail Override data area data structure
     I                                        1   1 URRE01
     I                                        2   2 URRE02
     I                                        3   3 URRE03
     I                                        4   4 URRE04
     I                                        5   5 URRE05
     I                                        6   6 URRE06
     I                                        7   7 URRE07
     I                                        8   8 URRE08
     I                                        9   9 URRE09
     I                                       10  10 URRE10
      *
     IURERTX      DS
      * Item error status data structure
     I                                        1  80 @IH
      *
     ID@MMOD    E DSSDMMODPD                                              S01413
     I*                                                                   S01413
     I*  Module Details DS for assigning data from Access                 S01413
     I*  Programs to work fields                                          S01413
     I*                                                                   S01413
     I/COPY WNCPYSRC,GL0122PI01
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              5
      * KEY: Midas GL Journal Entry Posting Rtv
      * I : RST Batch number
     I                                        1   3 P1BTNB
     IP2PARM      DS
      * I : MAP RCF Sequence Number
     I                                        1   5 P2RSQN
     IP3PARM      DS
      * I : MAP Level
     I                                        1   1 P3LEVL
     IP4PARM      DS
      * I : MAP Entity
     I                                        1   3 P4ENTY
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Journal En
     C           P2RSQN    PARM           WP0001  5        RCF Sequence Nu
     C           P3LEVL    PARM           WP0002  1        Level
     C           P4ENTY    PARM           WP0003  3        Entity
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
     C/COPY WNCPYSRC,GL0122PC12
      *
      * Batch Details Report: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$HENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Batch Details Report: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BTBTNB    WQKA01           Batch number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Batch number
      * Move fields to key list
     C                     MOVELP1BTNB    WQKA01           Batch number
      * Establish starting position
     C           KRSA      SETLL@BTREAL                    *
     C/COPY WNCPYSRC,GL0122PC19
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0122PNRP - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0122PNRP
     C*00/Copy Member GL0122P   Null Report Processing
     C                     END                             *FI
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Batch number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     MOVELBTBTNB    $DBTNB           Batch number
     C                     MOVEL*BLANK    $DBSTS           Batch status
     C                     MOVEL*BLANK    $DBSTD           Batch Status (D
     C                     MOVEL*BLANK    $DBDSC           batch descripti
     C                     MOVEL*BLANK    $DBCDP           Branch Code (Pr
     C                     MOVEL*BLANK    $DBNMD           Branch name (di
     C                     MOVEL*BLANK    $DFMA2           Formatted amoun
     C                     MOVEL*BLANK    $DDCDP           Department Code
     C                     MOVEL*BLANK    $DDNDS           Department name
     C                     MOVEL*BLANK    $DFMAM           Formatted amoun
     C                     MOVEL*BLANK    $DMBIP           Multiple Branch
     C                     Z-ADD*ZERO     $DIINP           Items Input (Pr
     C                     MOVEL*BLANK    $DREVI           Reversal/void i
     C                     MOVEL*BLANK    $DTIDP           Terminal I.D. (
     C                     Z-ADD*ZERO     $DICLP           Items Calculate
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELBTBTNB    $EBTNB           Batch number
     C                     Z-ADDBTBINB    $EBINB           Batch item no.
     C                     MOVELBTCUST    $ECUST           Customer number
     C                     MOVELBTCYCD    $ECYCD           Currency code
     C                     MOVELBTACCD    $EACCD           Account code
     C                     MOVELBTACSN    $EACSN           Account sequenc
     C                     MOVELBTIBCA    $EIBCA           Input Branch Co
     C                     MOVEL*BLANK    $EPAMP           Posting Amount
     C                     MOVELBTDCIN    $EDCIN           Debit/credit in
     C/COPY WNCPYSRC,GL0122PC20
     C                     MOVEL*BLANK    $ENRTV           Narrative
     C/COPY WNCPYSRC,GL0122PC21
     C                     MOVELBTTRTY    $ETRTY           Transaction typ
     C                     Z-ADDBTRACN    $ERACN           Retail account
     C                     MOVEL*BLANK    $ENOCD           Nostro Code
     C                     MOVELBTNNBI    $ENNBI           Nostro number (
     C                     MOVELBTCQNB    $ECQNB           Cheque number
     C                     MOVELBTACNB    $EACNB           Assoc. Customer
     C                     MOVEL*BLANK    $EVDTP           Value Date (Pri
     C                     MOVELBTPRCN    $EPRCN           Profit centre
     C                     MOVELBTRINE    $ERINE           Retail ind.: Er
     C                     Z-ADDBTPTAM    $EPTAM           Posting amount
     C                     Z-ADDBTPTDT    $EPTDT           Posting date
     C                     Z-ADDBTVLDT    $EVLDT           Value date
     C/COPY WNCPYSRC,GL0122PC22
     C                     MOVELBTNVCD    $ENVCD           Narrative code
     C                     MOVELBTNRDC    $ENRDC           Narrative descr
     C/COPY WNCPYSRC,GL0122PC23
     C                     MOVELBTACTY    $EACTY           Account type
     C                     MOVELBTCOIN    $ECOIN           Customer origin
     C                     MOVELBTSWCR    $ESWCR           Swift common re
     C                     MOVEL*BLANK    $EDCNM           Display Custome
     C                     MOVEL*BLANK    $EDACN           Display Account
     C                     MOVELBTBKCD    $EBKCD           Book Code
     C                     Z-ADDBTSPFC    $ESPFC           Spread Factor
     C                     MOVELBTRVDI    $ERVDI           Reverse/Void In
     C                     MOVELBTRINO    $ERINO           Retail ind.: Ov
     C                     MOVEL*BLANK    $EIEMP           Item error mess
     C                     MOVEL*BLANK    $EWNFF           Window Function
     C                     MOVEL*BLANK    $EWNF1           Window Function
     C                     MOVEL*BLANK    $EWNF2           Window Function
     C                     MOVELBTBCBH    $EBCBH           Branch Code (Ba
     C                     MOVELBTRADP    $ERADP           Retail advice p
     C                     MOVELBTSHPI    $ESHPI           Shadow post ind
     C                     Z-ADDBTRRNM    $ERRNM           Relative rec no
     C                     MOVELBTRNBE    $ERNBE           Retail Number E
     C                     MOVELBTRARC    $ERARC           Retail Ac Refer
     C                     MOVELBTTSTY    $ETSTY           Transaction (Su
     C/COPY WNCPYSRC,GL0122PC01
     C           *IN51     IFEQ '1'                                       S01413
     C                     MOVELBTNITM    $ENITM           No. of items   S01413
     C                     END                                            S01413
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     MOVELBTOCCY    $EOCCY           Orig. Ccy      CEU013
     C                     MOVEL*BLANK    $EOAMT           Orig. Amount   CEU013
     C                     END                                            CEU013
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BTBTNB    WZA001           Batch number
     C                     MOVELBTBTNB    WZA001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@BTREAL                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
     C/COPY WNCPYSRC,GL0122PC24
      *                                                                                       CGL013
      ** If MT94x Messages Generation is installed, retrieve                                  CGL013
      ** Additional Information Details                                                       CGL013
      *                                                                                       CGL013
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C           *IN90     ANDEQ*OFF                                                          CGL013
     C                     EXSR SRADIN                                                        CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           CER030    IFEQ 'Y'                                                         BUG23742
     C           *IN90     ANDEQ*OFF                                                        BUG23742
     C                     EXSR SRADI1                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                    AR1065437
      ** Retrieve and format CGL125/CSC054 introduced fields                               AR1065437
      *                                                                                    AR1065437
     C           CGL125    IFEQ 'Y'                                                        AR1065437
     C           *IN90     ANDEQ*OFF                                                       AR1065437
     C                     EXSR SRCBIF                                                     AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0122PRSP - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0122PRSP
     C*00/Copy Member GL0122P   Record Selection Proc.
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Batch number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Batch number
     C                     ELSE
      * Next record - Detect level breaks
     C           BTBTNB    IFNE WZA001                     Batch number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL00    IFEQ 'Y'
      * USER: On print of Batch number format
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0122PPLT - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0122PPLT
     C*00/Copy Member GL0122P   Print Level Totals
     C                     END                             *FI
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * USER: On print of final totals format
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0122PPER - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0122PPER
     C*00/Copy Member GL0122P   Process End Of Report
     C                     END                             *FI
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Set new page flag if external overflow occured
     C           *IN97     IFEQ '1'
     C                     MOVE 'Y'       W0NEWP
     C                     END
      * Print Standard report header of Batch Details Report
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Batch Details Report
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Batch number of Batch Details Report
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Batch number format
      * Hash numeric to character - Standard functions  *
     C                     Z-ADDWUHIIN    ULVALI           Integer portion
     C                     Z-ADD*ZERO     ULVALD           Set Decimal
     C                     Z-ADDWUHDIN    ULVAL2           Decimal portion
      *
     C                     CALL 'GL0138U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALI 150       I:Integer
     C                     PARM ULVALD    ULVAL3  99       I:Decimal
     C                     PARM 3         ULDECP  10       I:Decimal place
     C                     PARM '1'       ULEDIT  1        I:IBM Edit code
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLT 32        O:Formatted
      *
     C                     MOVE ULRSLT    $DFMA2           Formatted data
      *
      * Hash numeric to character - Standard functions  *
     C                     Z-ADDWUHICC    ULVALI           Integer portion
     C                     Z-ADD*ZERO     ULVALD           Set Decimal
     C                     Z-ADDWUHDCC    ULVAL2           Decimal portion
     C                     CALL 'GL0138U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALI 150       I:Integer
     C                     PARM ULVALD    ULVAL3  99       I:Decimal
     C                     PARM 3         ULDECP  10       I:Decimal place
     C                     PARM '1'       ULEDIT  1        I:IBM Edit code
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLT 32        O:Formatted
     C                     MOVE ULRSLT    $DFMAM           Formatted data
      * Start of Fix BHF672
      * Retrieve correct dept. code and branch code
      * Access Branch Codes. - Branch Codes  *
     C*
     C*  Access Branch codes file for the file fields
     C*
     C                     MOVELWUBCDA    UUBRCD
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        I:Option
     C                     PARM           UUBRCD  3        I:Branch Code
     C********** D@BRCH    PARM *BLANK    UUFDY            O:Format                           CGL029
     C           D@BRCH    PARM *BLANK    UUSDY                                               CGL029
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELA8BRCD    $DBCDP           O:Branc Code
     C                     MOVELA8CMCD    WUCMCD           O:Company Code
     C                     MOVELA8LCCD    WULCCD           O:Location Code
     C                     MOVELA8DFAC    WUDFAC           O:Due From a/c Code
     C                     MOVELA8DTAC    WUDTAC           O:Due To a/c Code
     C                     MOVELA8BICN    WUBICN           O:Branch Internal Cus
     C                     MOVELA8BRNM    $DBNMD           O:Branch Name
     C                     MOVELA8GBCD    WUGBCD           O:Global Branch Code
     C                     MOVELA8BRSN    WUBRSN           O:Branch Shortname
     C*
      * Access Department. - Department Codes  *
     C*
     C*  Access Department codes file for the following field:
     C*  Department Name
     C*
     C                     MOVELWUDPCD    UUDPCD
     C                     CALL 'AODEPTR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        I:Option
     C                     PARM           UUDPCD  3        I:Department Code
     C           D@DEPT    PARM *BLANK    UUFDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELAEDPCD    $DDCDP           Department Code
     C                     MOVELAEDPNM    $DDNDS           Department Name
     C*
      * End of Fix BHF672
      * CUR.Batch Status (Display) = Condition name of WRK.Batch status flag
     C                     CALL 'MIRVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100442   Y2LSNO  70       List number
     C                     PARM WUBTSF    W0INVL 20        Batch status fl
     C                     PARM 'N'       W0VLMP  1        Value mapped
     C           $DBSTD    PARM           W0CNNM 25        Batch Status (D
      *
     C                     MOVELWUBDES    $DBDSC           batch descripti
     C                     MOVELWUBTNB    $DBTNB           Batch number
     C                     MOVELWUWSID    $DTIDP           Terminal I.D. (
     C                     Z-ADDWUHINI    $DIINP           Items Input (Pr
     C                     Z-ADDWUHINC    $DICLP           Items Calculate
     C                     MOVELWUMBRB    $DMBIP           Multiple Branch
      *                                                                   CGL008
      ** If feature CGL008 is ON, retrieve the Last Insert & Amend User   CGL008
      *                                                                   CGL008
     C           CGL008    IFEQ 'Y'                                       CGL008
     C                     MOVELWUUSRI    $DUSRI                          CGL008
     C                     MOVELWUUSRA    $DUSRA                          CGL008
     C                     ENDIF                                          CGL008
      *                                                                   CGL008
     C/COPY WNCPYSRC,GL0122PC03
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0122PPLH - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0122PPLH
     C*00/Copy Member GL0122P   Print Level Headings
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C**********           MOVEL'0'       *IN79                           E38270
     C                     MOVEL'0'       *IN80                           E38270
     C           WUMBIN    IFEQ 'N'                        *IF
     C**********           MOVEL'1'       *IN79                           E38270
     C                     MOVEL'1'       *IN80                           E38270
     C                     END                             *FI
     C/COPY WNCPYSRC,GL0122PC05
      * Print format
     C                     WRITE$DKEYHDR
     C/COPY WNCPYSRC,GL0122PC06
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print Detail line. of Batch Details Report
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Set flag for non-printing of 2nd detail line
     C                     EXSR UASUBR                     Set flag for no
      * Setup Formatted Posting Amount
     C                     EXSR UBSUBR                     Setup Formatted
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0122PCP1                                           S01408
      * If IBLC Returns module is on, call PGM IL0455 to access Extension                     CER001
      * file GLJPX1L0 and seton indicator 81                                                  CER001
      * USE NBR OF DECIMAL RETURNED IN UBSUBR ROUTINE                                         CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           BGNWST    IFEQ 'Y'                        - B1                               CER001
      *                                                                                       CER001
     C                     CALL 'IL0455'                                                      CER001
     C                     PARM BTBTNB    PBTNB   3                                           CER001
     C                     PARM BTBINB    PBINB   30                                          CER001
     C                     PARM *BLANKS   ILLINE                                              CER001
     C                     PARM *BLANK    PFAIL   1                                           CER001
     C                     PARM WUNBDP    NBDEC   10                                          CER001
      *                                                                                       CER001
     C                     MOVE '0'       ULX043  1        Nothing                            CER001
     C                     MOVE *ON       *IN52                                               CER001
     C           PFAIL     IFNE '1'                                                           CER001
     C           ILLINE    IFNE *BLANKS                    S.t. to report                     CER001
     C                     MOVE '1'       ULX043                                              CER001
     C                     MOVE *OFF      *IN52                                               CER001
      *                                                                                       CER001
      * Set up IBLC lines array                                                               CER001
     C                     MOVEAILLINE    IUL                                                 CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                           - E1                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*                                                                   S01408
      * Setup Narrative
      * CASE: DB1.Narrative code is Narrative code
     C           BTNVCD    IFNE *BLANK                     *IF
      *                                            START  E17611 24/04/89
      *  This fix should be the same as SAR  S05767
      *  Narrative is not translated to its description from
      * its Narrative code during printing.
      * Access Narrative. - Narrative Codes  *
     C*
     C*  Access Narrative codes file for the following fields
     C*  Narrative Code, Narrative Description
     C*
     C                     MOVEL$ENVCD    UUNVCD
     C                     CALL 'AONARRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        I:Option
     C                     PARM           UUNVCD  2        I:Narrative Code
     C           D@NARR    PARM *BLANK    UUFDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELALNVCD    $ENVCD           Narrative Code
     C                     MOVELALDON     $ENRTV           Description
     C*
      * CASE: WRK.Access Pgm Return Code is Access Error
     C           WUAPRC    IFEQ '*CLOSE'                   *IF
     C           WUAPRC    OREQ '*ERROR'
     C           WUAPRC    OREQ '*OPEN'
     C           WUAPRC    OREQ '*KEY'
     C           WUAPRC    OREQ '*NRF'
     C           WUAPRC    OREQ '*EMPTY'
     C           WUAPRC    OREQ '*EOF'
     C           WUAPRC    OREQ '*OPTION'
     C           WUAPRC    OREQ '*CALL'
     C           WUAPRC    OREQ '*SELECT'
     C           WUAPRC    OREQ '*NOSEL'
     C           WUAPRC    OREQ '*ID'
     C                     MOVEL*BLANK    $ENRTV           Narrative
     C                     MOVELBTNVCD    $ENRTV           Narrative
     C                     END                             *FI
      * CUR.Narrative = DB1.Narrative code                (Deleted code)
      *                                            END    E17611 24/04/89
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBTNRDC    $ENRTV           Narrative
     C                     END                             *FI
     C/COPY WNCPYSRC,GL0122PC15
      * Setup Nostro Code
      * CASE: DB1.Nostro number (Item) is *Entered
     C           BTNNBI    IFNE *BLANK                     *IF
      * Setup Nostro code - Standard functions  *
     C                     MOVEL$ECYCD    $ENOCD           Currency
     C                     MOVE BTNNBI    $ENOCD           Nostro no.
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $ENOCD           Nostro Code
     C                     END                             *FI
      * Setup Value Date
      * CASE: DB1.Value date is Not zero
     C           BTVLDT    IFNE *ZERO                      *IF
      * Midas Conv. Day to Date - Standard functions  *
     C                     CALL 'ZDATE2'               90  Midas Conv. Day
     C                     PARM BTVLDT    WQ0001  50       Runday Number
     C                     PARM WUDTFF    WQ0002  1        Date Format fla
     C           WUDTNF    PARM *ZERO     WQ0003  60       Date (numeric f
     C           WUDDCD    PARM *BLANK    WQ0004  7        Midas Run Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Output Value Date (print) - Standard functions  *
     C                     MOVE WUDTNF    UUDTNF
     C                     MOVE UUSLT1    UUALT1
     C                     MOVE UUSLT2    UUALT2
     C                     MOVE UUSLT3    UUALT3
     C                     MOVE '/'       UUSLT4
     C                     MOVE '/'       UUSLT5
     C                     MOVE UUVDTP    $EVDTP
     C                     END                             *FI
      * Check for Retail errors
      * CASE: DB1.Retail ind.: Error is Error requiring Override
     C           BTRINE    IFEQ 'Y'                        *IF
      *     E18852  - Branch Code Of trade Parm Added 28.09.89
      * Start of Fix LN0315
      * Check Account Number. - Standard functions  *
     C*
     C* Set up Parameters for call to AOACCTR0
     C*
     C                     MOVEL*BLANK    UUACID
     C                     MOVEL$ECUST    UUCUST
     C                     MOVEL$ECYCD    UUCYCD
     C                     MOVEL$EACCD    UUACNO
     C                     MOVEL$EACSN    UUACSN
     C                     MOVEL$EIBCA    UUBRCD
     C*
     C*  Call to Access Program - AOACCTR0 Check Account Number
     C*  Access Account Details file for the file fields
     C*
     C                     CALL 'AOACCTR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        B:Option
     C                     PARM           UUACID 10        I:Account Identifier
     C                     PARM           UUCUST  6        I:Customer Number
     C                     PARM           UUCYCD  3        I:Currency Code
     C**********           PARM           UUACNO  4        I:Account Code Num                 CGL029
     C                     PARM           UUACNO 10                                           CGL029
     C                     PARM           UUACSN  2        I:Account Sequence
     C                     PARM           UUBRCD  3        I:Branch code
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELCNUM      WUCUST           Customer Number
     C                     MOVELCCY       WUCYCD           Currency Code
     C                     MOVELACOD      WUACCD           Account Code
     C                     MOVELACSQ      WUACSN           Account Sequence No.
     C                     MOVELBRCA      WUBRCD           Branch Code
     C                     MOVELATYP      WUACTY           Account Type
     C                     MOVELSTYP      WUBPST           Account Sub-Type
     C                     MOVELACST      WUACCS           Account Status
     C                     MOVELDACO      WUDACO           Date Account Opened
     C                     MOVELANAM      WUACNM           Account Name
     C                     MOVELACNO      WURACN           Retails Account Num
     C                     MOVELRRNM      WURRNM           Relative rec No Memos
     C                     MOVELRETB      WURETB           Retail Indic'trLN0315
     C                     MOVELRETB      WURTIN           Retail Indic'tr097910
     C*
      * End of Fix LN0315
     C/COPY WNCPYSRC,GL0122PC10
      * Verify Stopped Cheque. - Standard functions  *
     C*
     C*  Call to Access Program - AOSTOPV0 Verify Stoppped Cheque
     C*  Access Account Details file for the file fields
     C*
     C                     CALL 'AOSTOPV0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM $EPTAM    UUCQAM 130       I:Cheque Amount
     C                     PARM $ECQNB    UUCQNB  8        I:Cheque Number
     C                     PARM $ERACN    UURACN 100       I:Retail Account No
     C                     PARM $ECUST    UUCUST  6        I:Customer Number
     C                     PARM $ECYCD    UUCYCD  3        I:Currency Code
     C**********           PARM $EACCD    UUACCD  4        I:Account Code                     CGL029
     C                     PARM $EACCD    UUACCD 10                                           CGL029
     C                     PARM $EACSN    UUACSN  2        I:Acount Sequence
     C                     PARM $EIBCA    UUBRCD  3        I:Branch Code
     C*
      * Check Retail Ind (print) - Standard functions  *
     C***********          MOVELWURTIN    URRETI           Retail ind.    110546
     C                     MOVELWURETB    URRETI           Retail ind.    110546
     C*********************MOVEL#IAORC    URSTOP  7        A/O Rtn.Code   S01117
     C                     MOVELWUAPRC    URSTOP  7        A/P Rtn.Code   S01117
     C                     MOVEL$EDCIN    URIND   1                       E17600
      *
     C                     EXSR URRETK                     Check Retail
      *
     C                     MOVELURERST    WUIEST           Error status
     C                     MOVELURERTX    $EIEMP           Error message
      *
     C                     END                             *FI
      * Check if second detail line is to be printed
     C                     EXSR UCSUBR                     Check if second
      * Check Customer & Account Name
     C                     EXSR UDSUBR                     Check Customer
     C/COPY WNCPYSRC,GL0122PC16
      * Setup Formatted Original Amount                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     EXSR UESUBR                     Setup FormattedCEU013
     C                     ENDIF                                          CEU013
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0122PPDR - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0122PPDR
     C*00/Copy Member GL0122P   Process Detail Record
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           $ERACN    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUSDLE    IFEQ '*NONE'                    *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           $ECQNB    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           $EACNB    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           $EVLDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           $EPRCN    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           $ESWCR    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WUDCUS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WUDSAC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           $EBKCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           $ERINE    IFEQ *BLANK                     *IF
     C           $ERINE    OREQ 'N'
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           $EWNFF    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL'0'       *IN67
     C           $EWNF1    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     MOVEL'0'       *IN66
     C           $EWNF2    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN66
     C                     END                             *FI
     C* Add Void indicator                                                S10736
     C                     MOVEL'0'       *IN63                           S10736
     C           $ERVDI    IFEQ *BLANK                     *IF            S10736
     C                     MOVEL'1'       *IN63                           S10736
     C                     END                             *FI            S10736
     C* If EMU Account Posting Narrative present, check original          CEU013
     C/COPY WNCPYSRC,GL0122PC13
     C* amount and currency.                                              CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     MOVEL'0'       *IN45                           CEU013
     C           $EOCCY    IFEQ *BLANK                     *IF            CEU013
     C           $EOAMT    OREQ *BLANK                                    CEU013
     C                     MOVEL'1'       *IN45                           CEU013
     C                     END                             *FI            CEU013
     C                     ELSE                                           CEU013
     C                     MOVEL'1'       *IN45                           CEU013
     C                     END                                            CEU013
     C/COPY WNCPYSRC,GL0122PC25
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
     C/COPY WNCPYSRC,GL0122PC07
      * Print format
     C                     WRITE$EDTLRCD
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0122PCP2                                           S01408
      *                                                                                       CER001
      * If IBLC module is on print IBLC informations.                                         CER001
      *                                                                                       CER001
     C           ULX043    IFEQ '1'                                                           CER001
     C                     WRITEZZEXBLNK                                                      CER001
     C                     DO   3         UL      10                                          CER001
     C           IUL,UL    IFNE *BLANKS                                                       CER001
     C                     MOVELIUL,UL    RRLINE                                              CER001
      *                                                                                       CER001
      ***  Overflow if *IN97 is *ON                                                           CER001
      *                                                                                       CER001
     C           *IN97     IFEQ *ON                                                           CER001
     C                     EXSR Q3PTNP                                                        CER001
     C                     WRITE$DKEYHDR                                                      CER001
     C                     WRITEZZEXBLNK                                                      CER001
     C                     ENDIF                                                              CER001
     C                     WRITEZZEXIBLC                                                      CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*                                                                   S01408
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C                     Z-ADD@$CLN     W0FSUM  30
     C                     Z-ADD*ZERO     W0DTLN  30
     C                     Z-ADD*ZERO     W0COLN  30
      * * First Page Format of Batch Details Report
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Batch number of Batch Details Report
     C           W0AP00    IFEQ 'Y'
     C                     ADD  10        W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Batch Details Report
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD8         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Retrieve Header fields - Journal Entry Header  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BRBTNB           Batch number
      * Move fields to key list
     C                     MOVELP1BTNB    BRBTNB           Batch number
     C           KRSSA     CHAIN@BRREAH              90    *
      * DBF record not found
     C   90                MOVEL'GLX0172' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     MOVELBRBTNB    WUBTNB           Batch number
     C                     MOVELBRBCDA    WUBCDA           Branch Code - A
     C                     MOVELBRDPCD    WUDPCD           Dept Code
     C                     MOVELBRWSID    WUWSID           Workstation id.
     C                     Z-ADDBRHICC    WUHICC           Hash integer ca
     C                     Z-ADDBRHDCC    WUHDCC           Hash decimal ca
     C                     Z-ADDBRHINC    WUHINC           Hash item no.ca
     C                     Z-ADDBRHIIN    WUHIIN           Hash integer in
     C                     Z-ADDBRHDIN    WUHDIN           Hash decimal in
     C                     Z-ADDBRHINI    WUHINI           Hash item no.in
     C                     MOVELBRBTSF    WUBTSF           Batch status fl
     C                     MOVELBRBIUF    WUBIUF           Batch in use fl
     C                     MOVELBRSHPI    WUSHPI           Shadow post ind
     C                     MOVELBRRAPI    WURAPI           Retail advice p
     C                     MOVELBRMBRB    WUMBRB           Multiple Branch
     C                     MOVELBRRVVD    WURVVD           Reversal / Void
     C                     MOVELBRBDES    WUBDES           Batch Descripti
     C                     Z-ADDBRSPTT    WUSPTT           Spread Total
     C                     Z-ADDBRNIST    WUNIST           No. of Items to
     C                     MOVELBRSPRF    WUSPRF           Spread Profile
     C                     MOVELBRDCIN    WUDCIN           Debit/credit in
     C                     MOVELBRIBCF    WUIBCF           Input Branch Cd
     C                     MOVELBRCUSF    WUCUSF           Customer Number
     C                     MOVELBRCYCF    WUCYCF           Currency Code
     C                     MOVELBRACCF    WUACCF           Account Code
     C                     MOVELBRACSF    WUACSF           Account Seq No.
     C                     MOVELBRNNBF    WUNNBF           Nostro No. (Ite
     C                     Z-ADDBRRACF    WURACF           Retail A/c No.
     C                     MOVELBRPRCF    WUPRCF           Profit Centre
     C                     Z-ADDBRAMTF    WUAMTF           Amount
     C                     MOVELBRIBCT    WUIBCT           Input Branch Cd
     C                     MOVELBRCYCT    WUCYCT           Currency Code
     C                     MOVELBRCNAT    WUCNAT           Customer Number
     C                     MOVELBRACCT    WUACCT           Account Code
     C                     MOVELBRASNT    WUASNT           Account Seq No.
     C                     MOVELBRNNBT    WUNNBT           Nostro No. (Ite
     C                     Z-ADDBRRACT    WURACT           Retail A/c No.
     C                     MOVELBRTOJE    WUTOJE           Type of Journal
     C                     MOVELBRUSRI    WUUSRI                          CGL008
     C                     MOVELBRUSRA    WUUSRA                          CGL008
     C                     GOTO SAEXIT                     *QUIT
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Set flag for non-printing of 2nd detail line
      *================================================================
     C                     MOVEL*BLANK    WUSDLE           2nd Detail line
     C                     MOVEL'*NONE'   WUSDLE           2nd Detail line
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Setup Formatted Posting Amount
      *================================================================
      * CASE: DB1.Currency code is Blank
     C           BTCYCD    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     WUNBDP           Number of Decim
     C                     ELSE
      * CASE: *OTHERWISE
      * Access Currency. - Currency Codes  *
     C*
     C*  Access Currency codes file for the following fields
     C*  Currency Name, Number of decimal places, Nostro Shortname
     C*
     C                     MOVEL$ECYCD    UUCYCD
     C                     CALL 'AOCURRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        I:Option
     C                     PARM           UUCYCD  3        I:Currency Code
     C           D@CURR    PARM *BLANK    UUSDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELA6CYCD    $ECYCD           Currency Code
     C                     MOVELA6CYNM    WUCYNM           Currency Name
     C                     MOVELA6NBDP    WUNBDP           No. Decimal Places
     C                     MOVELA6NOSN    WUNOSN           Nostro Shortname
     C*
     C                     END                             *FI
      * Format amount (short) - Standard functions  *
     C                     Z-ADDBTPTAM    ULVALU           Value
      *
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALU 150       I:Value
     C                     PARM WUNBDP    ULDECP  10       I:Decimal place
     C                     PARM 'J'       ULEDIT  1        I:IBM Edit code
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLF 23        O:Formatted
      *
     C                     MOVE ULRSLF    $EPAMP           Formatted data
      *
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Check if second detail line is to be printed
      *================================================================
      * CASE: DB1.Cheque number is Entered
     C           BTCQNB    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUSDLE           2nd Detail line
     C                     MOVEL'*ENTER'  WUSDLE           2nd Detail line
     C                     END                             *FI
      * CASE: DB1.Assoc. Customer number is Entered
     C           BTACNB    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUSDLE           2nd Detail line
     C                     MOVEL'*ENTER'  WUSDLE           2nd Detail line
     C                     END                             *FI
      * CASE: DB1.Value date is Not zero
     C           BTVLDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUSDLE           2nd Detail line
     C                     MOVEL'*ENTER'  WUSDLE           2nd Detail line
     C                     END                             *FI
      * CASE: DB1.Swift common reference is Entered
     C           BTSWCR    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUSDLE           2nd Detail line
     C                     MOVEL'*ENTER'  WUSDLE           2nd Detail line
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Check Customer & Account Name
      *================================================================
      * Start of Fix SAR017
      * CASE: WRK.GL Description Ind. is Yes
     C           WUGLDI    IFEQ 'Y'                        *IF
      *     E18852  - Branch Code Of trade Parm Added 28.09.89
      * Start of Fix LN0315
      * Check Account Number. - Standard functions  *
     C*
     C* Set up Parameters for call to AOACCTR0
     C*
     C                     MOVEL*BLANK    UUACID
     C                     MOVEL$ECUST    UUCUST
     C                     MOVEL$ECYCD    UUCYCD
     C                     MOVEL$EACCD    UUACNO
     C                     MOVEL$EACSN    UUACSN
     C                     MOVEL$EIBCA    UUBRCD
     C*
     C*  Call to Access Program - AOACCTR0 Check Account Number
     C*  Access Account Details file for the file fields
     C*
     C                     CALL 'AOACCTR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        B:Option
     C                     PARM           UUACID 10        I:Account Identifier
     C                     PARM           UUCUST  6        I:Customer Number
     C                     PARM           UUCYCD  3        I:Currency Code
     C**********           PARM           UUACNO  4        I:Account Code Num                 CGL029
     C                     PARM           UUACNO                                              CGL029
     C                     PARM           UUACSN  2        I:Account Sequence
     C                     PARM           UUBRCD  3        I:Branch code
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELCNUM      WUCUST           Customer Number
     C                     MOVELCCY       WUCYCD           Currency Code
     C                     MOVELACOD      WUACCD           Account Code
     C                     MOVELACSQ      WUACSN           Account Sequence No.
     C                     MOVELBRCA      WUBRCD           Branch Code
     C                     MOVELATYP      WUACTY           Account Type
     C                     MOVELSTYP      WUBPST           Account Sub-Type
     C                     MOVELACST      WUACCS           Account Status
     C                     MOVELDACO      WUDACO           Date Account Opened
     C                     MOVELANAM      WUACNM           Account Name
     C                     MOVELACNO      WURACN           Retails Account Num
     C                     MOVELRRNM      WURRNM           Relative rec No Memos
     C                     MOVELRETB      WURETB           Retail Indic'trLN0315
     C*
      * End of Fix LN0315
     C/COPY WNCPYSRC,GL0122PC11
     C                     MOVELWUACNM    $EDACN           Display Account
     C                     MOVEL'Y'       WUDSAC           Display Account
     C/COPY WNCPYSRC,GL0122PC14
      * Access Cust Report Name - Standard functions  *
      *********P@AORF    E DSSDCUSTPD                                     S01117
     C*
     C* Access Customer Report Name Off Client File
     C*
     C                     MOVE *BLANK    WUCRST  7
     C**
     C                     CALL 'AOCUSTR0'
     C***********#BAORC****PARM #BAORC    P@RTN   7        B:Return code  S01117
     C           WUAPRC    PARM WUAPRC    P@RTN   7        B:Access Pgm ReS01117
     C*********************PARM #IAOPN    P@OPTN  7        I:Option       S01117
     C                     PARM '*KEY'    P@OPTN  7        I:Access Pgm OpS01117
     C                     PARM $ECUST    P@CKEY 10        I:Key field
     C           WUCRST    PARM *BLANK    P@FLD1  7        O:Client Key Id.
     C*********************PARM           P@AORF           O:Format       S01117
     C           D@CUST    PARM *BLANK    UUSDY            O:Format       S01117
     C*
     C                     MOVELBBCRNM    WUCRNM           O:Cust Report Nme
     C                     MOVELWUCRNM    $EDCNM           Display Custome
     C/COPY WNCPYSRC,GL0122PC18
     C                     MOVEL'Y'       WUDCUS           Display Custome
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDSAC           Display Account
     C                     MOVEL'N'       WUDCUS           Display Custome
     C                     END                             *FI
      * End of Fix SAR017
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT                                                              CEU013
     C/COPY WNCPYSRC,GL0122PC17
     CSR         UESUBR    BEGSR                                          CEU013
      *================================================================   CEU013
      * Set up Formatted Original Amount                                  CEU013
      *================================================================   CEU013
      * CASE: DB1.Currency code is Blank                                  CEU013
     C           BTOCCY    IFEQ *BLANK                     *IF            CEU013
     C                     Z-ADD*ZERO     #WNBDP           Number of DecimCEU013
     C                     ELSE                                           CEU013
      * CASE: *OTHERWISE                                                  CEU013
      * Access Currency. - Currency Codes  *                              CEU013
     C*                                                                   CEU013
     C*  Access Currency codes file for the following fields              CEU013
     C*  Currency Name, Number of decimal places, Nostro Shortname        CEU013
     C*                                                                   CEU013
     C                     MOVEL$EOCCY    UUCYCD                          CEU013
     C                     CALL 'AOCURRR0'                                CEU013
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    CEU013
     C                     PARM '*KEY'    UUAPOP  7        I:Option       CEU013
     C                     PARM           UUCYCD  3        I:Currency CodeCEU013
     C           D@CURR    PARM *BLANK    UUSDY            O:Format       CEU013
     C*                                                                   CEU013
     C* Assign work field to file field values.                           CEU013
     C*                                                                   CEU013
     C                     MOVELA6NBDP    #WNBDP  10       No. Decimal PlaCEU013
     C*                                                                   CEU013
     C                     END                             *FI            CEU013
      * Format amount (short) - Standard functions  *                     CEU013
     C                     Z-ADDBTOAMT    ULVALU           Value          CEU013
      *                                                                   CEU013
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>CEU013
     C                     PARM           ULVALU 150       I:Value        CEU013
     C                     PARM #WNBDP    ULDECP  10       I:Decimal placeCEU013
     C                     PARM 'J'       ULEDIT  1        I:IBM Edit codeCEU013
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.CEU013
     C                     PARM           ULRSLF 23        O:Formatted    CEU013
      *                                                                   CEU013
     C                     MOVE ULRSLF    $EOAMT           Formatted data CEU013
      *                                                                   CEU013
      *================================================================   CEU013
     CSR         UEEXIT    ENDSR                                          CEU013
      /EJECT                                                              CEU013
     CSR         URRETK    BEGSR
      *====================================================
      * Check Retail Account status
      *----------------------------------------------------
      *
     C                     MOVE *IN90     URSI90  1        Save indicator
     C                     MOVE *IN91     URSI91  1        Save indicator
     C                     MOVE *BLANK    URERTX           Blank msg.text
     C                     MOVE *BLANK    URERST  1        Error status
     C                     Z-ADD1         U1      30       Set pointer
     C                     SETOF                     91    Set ind.
      *
      * Check Refer Debits :
      *
     C           URIND     IFEQ 'D'                        ONLY IF DEBIT  E17600
      *
     C                     TESTB'0'       URRETI  1      90=Refer debits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE01    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Refer Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Refer Credits :
      *
     C           URIND     IFEQ 'C'                        ONLY IF CREDIT E17600
      *
     C                     TESTB'1'       URRETI         90 Refer credits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE02    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Refer Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Block Debits :
      *
     C           URIND     IFEQ 'D'                        ONLY IF DEBIT  E17600
      *
     C                     TESTB'2'       URRETI         90 Block debits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE03    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Block Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Block Credits :
      *
     C           URIND     IFEQ 'C'                        ONLY IF CREDIT E17600
      *
     C                     TESTB'3'       URRETI         90 Block credits
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE04    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Block Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
     C                     END                             FI             E17600
      *
      * Check Inactive A/C :
      *
     C                     TESTB'4'       URRETI         90 Inactive a/c
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE05    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Inactive'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Not in Use :   ***REMOVE COMMENTS IF FLAG TO BE USED LATER***
      *
     C*****                TESTB'5'       URRETI         90 -Not in Use-
      *
     C*****      *IN90     IFEQ '1'                        IF BIT SET
     C*****      URRE06    IFEQ 'N'                        IF NO O'RIDE
     C*****                SETON                     91      No O'ride
     C*****                END                             FI
     C*****                MOVEL'Not used'@IH,U1             Message text
     C*****                ADD  1         U1                 Incr.pointer
     C*****                END                             FI
      *
      * Check Bankrupt :
      *
     C                     TESTB'6'       URRETI         90 B'rupt/L'dated
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE07    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Bankrupt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Bad Debt :
      *
     C                     TESTB'7'       URRETI         90 Bad debt
      *
     C           *IN90     IFEQ '1'                        IF BIT SET
     C           URRE08    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Bad Debt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Stopped cheque :
      *
     C           URSTOP    IFEQ '*STOP  '                  IF STOPPED
     C           URRE09    IFEQ 'N'                        IF NO O'RIDE
     C                     SETON                     91      No O'ride
     C                     END                             FI
     C                     MOVEL'Chq.Stop'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Non-Overrideable error status :
      *
     C           U1        IFGT 1                          IF ERRORS
     C           *IN91     IFEQ '1'                        IF NOT O'RIDE
     C                     MOVE 'E'       URERST             Error Status
     C                     ELSE                            EL O'RIDEABLE
     C                     MOVE 'O'       URERST             Error Status
     C                     END                             FI
     C                     END                             FI
      *
     C                     MOVE URSI90    *IN90            Restore ind.
     C                     MOVE URSI91    *IN91            Restore ind.
      *
      *----------------------------------------------------
      *
      *====================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
     C/COPY WNCPYSRC,GL0122PC02
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Midas Rundate
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Runday Number
     C                     Z-ADD*ZERO     WURDNO  50
      * Define work field Setup Complete
     C                     MOVEL*BLANK    WUSUCP  1
      * Define work field Date Format flag
     C                     MOVEL*BLANK    WUDTFF  1
      *                                                                   CGL008
      ** Define work fields for Last Insert User and Last Amend User      CGL008
      *                                                                   CGL008
     C                     MOVE *BLANKS   WUUSRI 10                       CGL008
     C                     MOVE *BLANKS   WUUSRA 10                       CGL008
      * Define work field Multibranching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field General Ledger
     C                     MOVEL*BLANK    WUGNLG 10
      * Define work field Account code
     C**********           MOVEL*BLANK    WUACCD  4                                           CGL029
     C                     MOVEL*BLANK    WUACCD 10                                           CGL029
      * Define work field Profit & Loss Accnt Code
     C**********           MOVEL*BLANK    WUPLAC  4                                           CGL029
     C                     MOVEL*BLANK    WUPLAC 10                                           CGL029
      * Define work field Customer number
     C                     MOVEL*BLANK    WUCUST  6
      * Define work field Base Currency Transfer Fq
     C                     MOVEL*BLANK    WUBCTF  1
      * Define work field Accrual Key Summary Ind.
     C                     MOVEL*BLANK    WUAKSI  1
      * Define work field Accruals/Profit Date
     C                     Z-ADD*ZERO     WUAPDT  50
      * Define work field Accruals/Profit Frequency
     C                     MOVEL*BLANK    WUAPFQ  1
      * Define work field Accruals/Profit Fq. Day
     C                     Z-ADD*ZERO     WUAPFD  20
      * Define work field Accrue on Last Day Ind.
     C                     MOVEL*BLANK    WUALDI  1
      * Define work field A/c Posting Retention Pd
     C                     Z-ADD*ZERO     WUAPRP  20
      * Define work field Accrual Non-Wk Day Ind
     C                     MOVEL*BLANK    WUANWD  1
      * Define work field Spot Rates Retention Pd
     C                     Z-ADD*ZERO     WUSRRP  20
      * Define work field Base Rates Retention Pd
     C                     Z-ADD*ZERO     WUBRRP  20
      * Define work field GL Description Ind.
     C                     MOVEL*BLANK    WUGLDI  1
      * Define work field Profit Centres Used
     C                     MOVEL*BLANK    WUPRCU  1
      * Define work field Profit Centres Amendable
     C                     MOVEL*BLANK    WUPRCA  1
      * Define work field Profit Centre Def'ts Used
     C                     MOVEL*BLANK    WUPCDU  1
      * Define work field Prof C Def Matrix-Book
     C                     MOVEL*BLANK    WUPMBK  1
      * Define work field Prof C Def Matrix-T Type
     C                     MOVEL*BLANK    WUPMTT  1
      * Define work field Prof C Def Matrix-S Type
     C                     MOVEL*BLANK    WUPMST  1
      * Define work field Prof C Def Matrix-Branch
     C                     MOVEL*BLANK    WUPMBH  1
      * Define work field Prof C Def Matrix-Dept
     C                     MOVEL*BLANK    WUPMDT  1
      * Define work field Prof C Def Matrix-User
     C                     MOVEL*BLANK    WUPMUR  1
      * Define work field Prof C Def Matrix-A/c Off
     C                     MOVEL*BLANK    WUPMAO  1
      * Define work field Prof C Def Matrix-Cust
     C                     MOVEL*BLANK    WUPMCU  1
      * Define work field Originating Branch Used
     C                     MOVEL*BLANK    WUOBRU  1
      * Define work field Orig Branch User/Vald Req
     C                     MOVEL*BLANK    WUOBUV  1
      * Define work field JE Special Character
     C                     MOVEL*BLANK    WUJESP  1
      * Define work field JE Int-Bch Ents @ Bch/Itm
     C                     MOVEL*BLANK    WUIEBI  1
      * Define work field Main Branch
     C                     MOVEL*BLANK    WUMABR  3
      * Define work field Int-Bch Ent Via Main Brch
     C                     MOVEL*BLANK    WUIEMB  1
      * Define work field End of Last Activity Per.
     C                     Z-ADD*ZERO     WUELAP  50
      * Define work field End of Current Act Period
     C                     Z-ADD*ZERO     WUECAP  50
      * Define work field Spool File Name
     C                     MOVEL*BLANK    WUSFNM 10
      * Define work field Spool File Number
     C                     Z-ADD*ZERO     WUSFNB  60
      * Define work field ZSFile Error
     C                     MOVEL*BLANK    WUZSER  1
      * Define work field Batch number
     C                     MOVEL*BLANK    WUBTNB  3
      * Define work field Branch Code - Alpha
     C                     MOVEL*BLANK    WUBCDA  3
      * Define work field Dept Code
     C                     MOVEL*BLANK    WUDPCD  3
      * Define work field Workstation id.
     C                     MOVEL*BLANK    WUWSID 10
      * Define work field Hash integer calculated
     C                     Z-ADD*ZERO     WUHICC 150
      * Define work field Hash decimal calculated
     C                     Z-ADD*ZERO     WUHDCC  30
      * Define work field Hash item no.calculated
     C                     Z-ADD*ZERO     WUHINC  30
      * Define work field Hash integer input
     C                     Z-ADD*ZERO     WUHIIN 150
      * Define work field Hash decimal input
     C                     Z-ADD*ZERO     WUHDIN  30
      * Define work field Hash item no.input
     C                     Z-ADD*ZERO     WUHINI  30
      * Define work field Batch status flag
     C                     MOVEL*BLANK    WUBTSF  1
      * Define work field Batch in use flag
     C                     MOVEL*BLANK    WUBIUF  1
      * Define work field Shadow post indicator
     C                     MOVEL*BLANK    WUSHPI  1
      * Define work field Retail advice print ind.
     C                     MOVEL*BLANK    WURAPI  1
      * Define work field Multiple Branch Batch
     C                     MOVEL*BLANK    WUMBRB  1
      * Define work field Reversal / Void Indicator
     C                     MOVEL*BLANK    WURVVD  1
      * Define work field Batch Description
     C                     MOVEL*BLANK    WUBDES 30
      * Define work field Spread Total
     C                     Z-ADD*ZERO     WUSPTT 100
      * Define work field No. of Items to Spread to
     C                     Z-ADD*ZERO     WUNIST  30
      * Define work field Spread Profile Code
     C                     MOVEL*BLANK    WUSPRF  4
      * Define work field Debit/credit indicator
     C                     MOVEL*BLANK    WUDCIN  1
      * Define work field Input Branch Cd  Alloc Fm
     C                     MOVEL*BLANK    WUIBCF  3
      * Define work field Customer Number  Alloc Fm
     C                     MOVEL*BLANK    WUCUSF  6
      * Define work field Currency Code    Alloc Fm
     C                     MOVEL*BLANK    WUCYCF  3
      * Define work field Account Code     Alloc Fm
     C**********           MOVEL*BLANK    WUACCF  4                                           CGL029
     C                     MOVEL*BLANK    WUACCF 10                                           CGL029
      * Define work field Account Seq No.  Alloc Fm
     C                     MOVEL*BLANK    WUACSF  2
      * Define work field Nostro No. (Item)Alloc Fm
     C                     MOVEL*BLANK    WUNNBF  2
      * Define work field Retail A/c No.   Alloc Fm
     C                     Z-ADD*ZERO     WURACF 100
      * Define work field Profit Centre    Alloc Fm
     C                     MOVEL*BLANK    WUPRCF  4
      * Define work field Amount           Alloc Fm
     C                     Z-ADD*ZERO     WUAMTF 130
      * Define work field Input Branch Cd  Alloc To
     C                     MOVEL*BLANK    WUIBCT  3
      * Define work field Currency Code    Alloc To
     C                     MOVEL*BLANK    WUCYCT  3
      * Define work field Customer Number  Alloc To
     C                     MOVEL*BLANK    WUCNAT  6
      * Define work field Account Code     Alloc To
     C**********           MOVEL*BLANK    WUACCT  4                                           CGL029
     C                     MOVEL*BLANK    WUACCT 10                                           CGL029
      * Define work field Account Seq No.  Alloc To
     C                     MOVEL*BLANK    WUASNT  2
      * Define work field Nostro No. (Item)Alloc To
     C                     MOVEL*BLANK    WUNNBT  2
      * Define work field Retail A/c No.   Alloc To
     C                     Z-ADD*ZERO     WURACT 100
      * Define work field Type of Journal Entry
     C                     MOVEL*BLANK    WUTOJE  1
      * Define work field S01212
     C                     MOVEL*BLANK    WUFKST  1
      * Define work field Company Code
     C                     MOVEL*BLANK    WUCMCD  3
      * Define work field Location Code
     C                     MOVEL*BLANK    WULCCD  3
      * Define work field Due From Account Code
     C**********           MOVEL*BLANK    WUDFAC  4                                           CGL029
     C                     MOVEL*BLANK    WUDFAC 10                                           CGL029
      * Define work field Due To Account Code
     C**********           MOVEL*BLANK    WUDTAC  4                                           CGL029
     C                     MOVEL*BLANK    WUDTAC 10                                           CGL029
      * Define work field Branch Internal Customer
     C                     MOVEL*BLANK    WUBICN  6
      * Define work field Global Branch Code
     C                     MOVEL*BLANK    WUGBCD  3
      * Define work field Branch Shortname
     C                     MOVEL*BLANK    WUBRSN  3
      * Define work field 2nd Detail line entered?
     C                     MOVEL*BLANK    WUSDLE  7
      * Define work field Number of Decimal Places
     C                     Z-ADD*ZERO     WUNBDP  10
      * Define work field Currency Name
     C                     MOVEL*BLANK    WUCYNM 14
      * Define work field Nostro Shortname
     C                     MOVEL*BLANK    WUNOSN 10
      * Define work field Date (numeric format)
     C                     Z-ADD*ZERO     WUDTNF  60
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUDDCD  7
      * Define work field Currency code
     C                     MOVEL*BLANK    WUCYCD  3
      * Define work field Account sequence number
     C                     MOVEL*BLANK    WUACSN  2
      * Define work field Branch code
     C                     MOVEL*BLANK    WUBRCD  3
      * Define work field Account type
     C                     MOVEL*BLANK    WUACTY  1
      * Define work field Account subtype
     C                     MOVEL*BLANK    WUBPST  1
      * Define work field Account status
     C                     MOVEL*BLANK    WUACCS  1
      * Define work field Date account opened
     C                     Z-ADD*ZERO     WUDACO  50
      * Define work field Account name
     C                     MOVEL*BLANK    WUACNM 20
      * Define work field Retail account number
     C                     Z-ADD*ZERO     WURACN 100
      * Define work field Retail Indicators   MIDAS
     C                     MOVEL*BLANK    WURETB  1
      * Define work field Relative rec no of memos
     C                     Z-ADD*ZERO     WURRNM  50
      * Define work field Retail indicators
     C                     MOVEL*BLANK    WURTIN  1
      * Define work field Item error state
     C                     MOVEL*BLANK    WUIEST  1
      * Define work field Display Account
     C                     MOVEL*BLANK    WUDSAC  1
      * Define work field Customer Report Name
     C                     MOVEL*BLANK    WUCRNM 20
      * Define work field Display Customer
     C                     MOVEL*BLANK    WUDCUS  1
     C                     MOVEL##PGM     $APGM
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialise program
      * Standard RPG Creation Par - Standard functions  *
      * Window Processing Hdr Box - Standard functions  *
      * Last Amend Box CPPF - Journal Entry Posting  *
      * Access Midas Rundate PRTF - Standard functions  *
     C*   Access MIDAS Rundate from data-area RUNDAT
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      $AMRDT
     C                     MOVE RDNO      WURDNO
     C                     MOVE SUCP      WUSUCP
     C                     MOVE DTFF      WUDTFF
     C                     MOVE MBIN      WUMBIN
      * Access Bank Title  PRTFIL - Standard functions  *
      *                                                                   S01117
     C                     CALL 'AOBANKR0'
     C                     PARM           P@RTCD  7        B:Return code
     C                     PARM '*FIRST'  P@OPTN  7        I:Option       S01117
     C           P@BJRF    PARM *BLANK    UUFDY            O:Format
     C                     MOVELBJURPT    $AURPT
      *                                                                   CGL008
      **  Access SAR details file to see if CGL008 SAR is installed       CGL008
      *                                                                   CGL008
     C                     CALL 'AOSARDR0'                                CGL008
     C                     PARM *BLANKS   @RTCD   7                       CGL008
     C                     PARM '*VERIFY' @OPTN   7                       CGL008
     C                     PARM 'CGL008'  @SARD   6                       CGL008
      *                                                                   CGL008
     C           @RTCD     IFEQ *BLANK                                    CGL008
     C                     MOVE 'Y'       CGL008  1                       CGL008
     C                     ELSE                                           CGL008
     C                     MOVE 'N'       CGL008                          CGL008
     C                     MOVE *ON       *IN22                           CGL008
     C                     ENDIF                                          CGL008
      *                                                                   CGL008
     C/COPY WNCPYSRC,GL0122PC04
      * Copyright notice - Standard functions  *
      * Define 800 Byte Dummy DS - Standard functions  *
      * Define 200 Byte Dummy DS - Standard functions  *
      * Currency Codes DS - Currency Codes  *
      * Narrative Codes DS - Narrative Codes  *
      * Account Details DS - Standard functions  *
      * Branch Codes DS - Branch Codes  *
      * Department Codes DS - Department Codes  *
      * General Ledger Details DS - General Ledger Details  *
      * Declare Bank File DS - Standard functions  *
      * Client Details DS - Client Details  *
      * Start of Fix SAR017
      * Access General Ledger. - General Ledger Details  *
     C*
     C*  Access General Ledger Details file for it' file fields
     C*
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*FIRST'  UUAPOP  7        I:Option
     C********** D@GELR    PARM *BLANK    UUFDY            O:Format                           CGL029
     C           D@GELR    PARM *BLANK    UUSDY                                               CGL029
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELBKGNLG    WUGNLG           General Ledger
     C                     MOVELBKACCD    WUACCD           Account Code
     C                     MOVELBKPLAC    WUPLAC           Profit & Loss Account
     C                     MOVELBKCUST    WUCUST           Cutomer Number
     C                     MOVELBKBCTF    WUBCTF           Base Currency Tran
     C                     MOVELBKAKSI    WUAKSI           Accrual Key summary
     C                     MOVELBKAPDT    WUAPDT           Accruals Profit Date
     C                     MOVELBKAPFQ    WUAPFQ           Accruals Profit Freq
     C                     MOVELBKAPFD    WUAPFD           Accruals Profit Fr Dy
     C                     MOVELBKALDI    WUALDI           Accrue on Last Day
     C                     MOVELBKAPRP    WUAPRP           A/c Posting Ret Pd.
     C                     MOVELBKANWD    WUANWD           Accrual non-wk Day
     C                     MOVELBKSRRP    WUSRRP           Spot Rates Retention
     C                     MOVELBKBRRP    WUBRRP           Base Rates Retention
     C                     MOVELBKGLDI    WUGLDI           GL Description Ind
     C                     MOVELBKPRCU    WUPRCU           Profit Centres Used
     C                     MOVELBKPRCA    WUPRCA           Profit Centres Amend
     C                     MOVELBKPCDU    WUPCDU           Profit Centre Default
     C                     MOVELBKPMBK    WUPMBK           Prof C Matrix Book
     C                     MOVELBKPMTT    WUPMTT           Prof C Matrix Trans
     C                     MOVELBKPMST    WUPMST           Prof C Matrix SubType
     C                     MOVELBKPMBH    WUPMBH           Prof C Matrix Branch
     C                     MOVELBKPMDT    WUPMDT           Prof C Matrix Dept
     C                     MOVELBKPMUR    WUPMUR           Prof C Matrix User
     C                     MOVELBKPMAO    WUPMAO           Prof C Matrix Acc Off
     C                     MOVELBKPMCU    WUPMCU           Prof C Matrix Cust
     C                     MOVELBKOBRU    WUOBRU           Originating Branch Ud
     C                     MOVELBKOBUV    WUOBUV           Orig Branch/User Vald
     C                     MOVELBKJESP    WUJESP           Copy Special Char
     C                     MOVELBKELAP    WUELAP           End of Last Activity
     C                     MOVELBKECAP    WUECAP           End of Curnt Activity
      * End of Fix SAR017
      * Retrieve Header fields - Journal Entry Header  *                  S01340
     C                     EXSR SARVGN                                    S01340
      * Start of Fix LN0714
      * ZSFile - Log Spool File - Standard functions  *
     C*
     C* Set up spool file number - Standard Functions  *
     C                     Z-ADD@$FNB     WUSFNB
     C                     MOVE *BLANKS   UUSRSQ  5
     C*
     C* ZSFILE - write report rqs - Standard Functions  *
     C                     CALL 'ZSFILE'               90  ZSFILE - write
     C*********************PARM #IRSQN    UURSQN  5        RCF sequence nuLN0837
     C           UUSRSQ    PARM P2RSQN    UURSQN  5        RCF sequence nuLN0837
     C**********           PARM P4ENTY    UUENTY  3        Entity         S01340
     C                     PARM WUBCDA    UUENTY  3        Entity         S01340
     C                     PARM @$FVN     UUSFNM 10        Spool file name
     C                     PARM WUSFNB    UUSFNB  60       Spool file numb
     C           WUZSER    PARM *BLANK    UUZSER  1        ZSFILE error
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C*
     C* CASE: WRK.ZSFILE is error occurred
     C*
     C*          #OZSER    IFEQ 'Y'
     C*                    MOVEL'Y2U0004' P0RTN
     C*                    EXSR ZYEXPG
     C*                    END
      **Retrieve*Header*fields*- Journal Entry Header  *                  S01340
     C**********           EXSR SARVGN                                    S01340
     C*                                                                   S01413
     C** Access Module Details & RE3 ICD                                  S01413
     C*                                                                   S01413
     C                     CALL 'AOMMODR0'                                S01413
     C                     PARM           P@RTCD  7        B:Return code  S01413
     C                     PARM '*FIRST'  P@OPTN  7        I:Option       S01413
     C           D@MMOD    PARM D@MMOD    UUFDY            O:Format       S01413
     C*                                                                   S01408
      *                                                                                       CER001
      ** Check if ULX043 is installed                                                         CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD                                               CER001
     C                     PARM '*VERIFY' POPTN                                               CER001
     C                     PARM 'ULX043'  PSARD                                               CER001
     C           SCSARD    PARM SCSARD    UUFDY                                               CER001
      *                                                                                       CER001
     C           PRTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX043                                              CER001
     C                     ENDIF                                                              CER001
     C/COPY WNCPYSRC,GL0122PCP3                                           S01408
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           P@RTCD    IFNE *BLANKS                                                       CER001
     C                     MOVE 'N'       BGNWST                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C*                                                                   S01408
     C*                                                                   S01413
     C           1         SETLLTABTBRE                                   S01413
     C                     READ TABTBRE                  50               S01413
     C*                                                                   S01413
     C** Set up indicator 51 if RE3 and Charges for Multiple              S01413
     C**  Transactions Optional Feature are installed                     S01413
     C*                                                                   S01413
     C           BGNXST    IFEQ 'Y'                                       S01413
     C           CMTR      ANDEQ'Y'                                       S01413
     C                     MOVE '1'       *IN51                           S01413
     C                     END                                            S01413
     C*                                                                   S01413
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  WSARD   6                       CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
      *                                                                                       CGL013
      ** Access SAR details file to see if CGL013 is installed.                               CGL013
      *                                                                                       CGL013
     C           KJENX     KLIST                                                              CGL013
     C                     KFLD           BTBTNB                                              CGL013
     C                     KFLD           BTBINB                                              CGL013
      *                                                                                       CGL013
     C                     CALL 'AOSARDR0'                                                    CGL013
     C                     PARM *BLANKS   PRTCD   7                                           CGL013
     C                     PARM '*VERIFY' POPTN   7                                           CGL013
     C                     PARM 'CGL013'  PSARD   6                                           CGL013
      *                                                                                       CGL013
     C           PRTCD     IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       CGL013  1                                           CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE 'N'       CGL013                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                     BUG23742
      ** Access SAR details file to see if CER030 is installed.                             BUG23742
      *                                                                                     BUG23742
     C           KJENX1    KLIST                                                            BUG23742
     C                     KFLD           BTPTDT                                            BUG23742
     C                     KFLD           BTBTNB                                            BUG23742
     C                     KFLD           BTBINB                                            BUG23742
      *                                                                                     BUG23742
     C                     MOVE *OFF      *IN37                                             BUG23742
      *                                                                                     BUG23742
     C                     CALL 'AOSARDR0'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD   7                                         BUG23742
     C                     PARM '*VERIFY' POPTN   7                                         BUG23742
     C                     PARM 'CER030'  PSARD   6                                         BUG23742
      *                                                                                     BUG23742
     C           PRTCD     IFEQ *BLANK                                                      BUG23742
     C                     MOVE 'Y'       CER030  1                                         BUG23742
     C                     MOVE *ON       *IN37                                             BUG23742
     C                     ELSE                                                             BUG23742
     C                     MOVE 'N'       CER030                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
      ** Access SAR details file to see if CGL125 is installed.                            AR1065437
      *                                                                                    AR1065437
     C                     MOVE *OFF      *IN98                                            AR1065437
      *                                                                                    AR1065437
     C                     CALL 'AOSARDR0'                                                 AR1065437
     C                     PARM *BLANKS   PRTCD                                            AR1065437
     C                     PARM '*VERIFY' POPTN                                            AR1065437
     C                     PARM 'CGL125'  PSARD                                            AR1065437
      *                                                                                    AR1065437
     C           PRTCD     IFEQ *BLANK                                                     AR1065437
     C                     MOVE 'Y'       CGL125  1                                        AR1065437
     C                     MOVE *ON       *IN98                                            AR1065437
     C                     ELSE                                                            AR1065437
     C                     MOVE 'N'       CGL125                                           AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
      * Report Title for GL0122P - Journal Entry Posting  *
     C                     MOVEAUHDR,1    $AREPT
     C                     MOVEAUHDR,2    $AUNDL
      * End of Fix LN0714
     C                     MOVEL'Y'       WUFKST           S01212
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0122PIPG - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0122PCPG
     C                     END                             *FI
     C           *NAMVAR   DEFN           GLREOV           Override DTAARA
     C                     IN   GLREOV                     Obtain   DTAARA
     C/COPY WNCPYSRC,GL0122PC08
      *================================================================
     C/COPY WNCPYSRC,GL0122PC09
     CSR         ZZEXIT    ENDSR
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * SRADIN - Subroutine to process Additional Information         *                       CGL013
      *          Details if CGL013 is installed.                      *                       CGL013
      *                                                               *                       CGL013
      * Called by: A3READ                                             *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           SRADIN    BEGSR                                                              CGL013
      *                                                                                       CGL013
     C                     MOVEA'000000'  *IN,31                                              CGL013
     C           KJENX     CHAINGLJENXL2             30                                       CGL013
     C           *IN30     IFEQ *OFF                                                          CGL013
      *                                                                                       CGL013
     C           BAADI1    IFNE *BLANKS                                                       CGL013
     C           BAAERI    ORNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN31                                               CGL013
     C                     MOVELBAADI1    $EADI1                                              CGL013
     C                     MOVE BAAERI    $EAERI                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI2    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN32                                               CGL013
     C                     MOVELBAADI2    $EADI2                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI3    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN33                                               CGL013
     C                     MOVELBAADI3    $EADI3                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI4    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN34                                               CGL013
     C                     MOVELBAADI4    $EADI4                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI5    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN35                                               CGL013
     C                     MOVELBAADI5    $EADI5                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           BAADI6    IFNE *BLANKS                                                       CGL013
     C                     MOVE *ON       *IN36                                               CGL013
     C                     MOVELBAADI6    $EADI6                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                     BUG23742
      /EJECT                                                                                BUG23742
      *****************************************************************                     BUG23742
      *                                                               *                     BUG23742
      * SRADI1 - Subroutine to process Additional Information         *                     BUG23742
      *          Details - 1 if CER030 is installed.                  *                     BUG23742
      *                                                               *                     BUG23742
      * Called by: A3READ                                             *                     BUG23742
      *                                                               *                     BUG23742
      * Calls: None                                                   *                     BUG23742
      *                                                               *                     BUG23742
      *****************************************************************                     BUG23742
      *                                                                                     BUG23742
     C           SRADI1    BEGSR                                                            BUG23742
      *                                                                                     BUG23742
     C                     MOVE *OFF      *IN38                                             BUG23742
     C                     MOVE *OFF      *IN39                                             BUG23742
     C                     MOVE *OFF      *IN40                                             BUG23742
     C                     MOVE *OFF      *IN41                                             BUG23742
     C                     MOVE *OFF      *IN42                                             BUG23742
     C                     MOVE *OFF      *IN43                                             BUG23742
     C                     MOVE *OFF      *IN44                                             BUG23742
     C                     MOVE *OFF      *IN46                                             BUG23742
     C                     MOVE *OFF      *IN47                                             BUG23742
     C                     MOVE *OFF      *IN48                                             BUG23742
     C                     MOVE *OFF      *IN49                                             BUG23742
     C                     MOVE *OFF      *IN53                                             BUG23742
     C                     MOVE *OFF      *IN54                                             BUG23742
     C                     MOVE *OFF      *IN55                                             BUG23742
     C                     MOVE *OFF      *IN56                                             BUG23742
     C                     MOVE *OFF      *IN57                                             BUG23742
     C                     MOVE *OFF      *IN58                                             BUG23742
     C                     MOVE *OFF      *IN59                                             BUG23742
     C                     MOVE *OFF      *IN60                                             BUG23742
     C                     MOVE *OFF      *IN61                                             BUG23742
     C                     MOVE *OFF      *IN62                                             BUG23742
     C                     MOVE *OFF      *IN63                                             BUG23742
      *                                                                                     BUG23742
     C           KJENX1    CHAINGLMNARL3             21                                     BUG23742
     C           *IN21     IFEQ *OFF                                                        BUG23742
      *                                                                                     BUG23742
     C           BAEX1     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN38                                             BUG23742
     C                     MOVELBAEX1     $EEX1                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX2     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN39                                             BUG23742
     C                     MOVELBAEX2     $EEX2                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX3     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN40                                             BUG23742
     C                     MOVELBAEX3     $EEX3                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX4     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN41                                             BUG23742
     C                     MOVELBAEX4     $EEX4                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX5     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN42                                             BUG23742
     C                     MOVELBAEX5     $EEX5                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX6     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN43                                             BUG23742
     C                     MOVELBAEX6     $EEX6                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX7     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN44                                             BUG23742
     C                     MOVELBAEX7     $EEX7                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX8     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN46                                             BUG23742
     C                     MOVELBAEX8     $EEX8                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX9     IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN47                                             BUG23742
     C                     MOVELBAEX9     $EEX9                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX10    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN48                                             BUG23742
     C                     MOVELBAEX10    $EEX10                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX11    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN49                                             BUG23742
     C                     MOVELBAEX11    $EEX11                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX12    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN53                                             BUG23742
     C                     MOVELBAEX12    $EEX12                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX13    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN54                                             BUG23742
     C                     MOVELBAEX13    $EEX13                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX14    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN55                                             BUG23742
     C                     MOVELBAEX14    $EEX14                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX15    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN56                                             BUG23742
     C                     MOVELBAEX15    $EEX15                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX16    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN57                                             BUG23742
     C                     MOVELBAEX16    $EEX16                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX17    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN58                                             BUG23742
     C                     MOVELBAEX17    $EEX17                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX18    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN59                                             BUG23742
     C                     MOVELBAEX18    $EEX18                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX19    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN60                                             BUG23742
     C                     MOVELBAEX19    $EEX19                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX20    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN61                                             BUG23742
     C                     MOVELBAEX20    $EEX20                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX21    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN62                                             BUG23742
     C                     MOVELBAEX21    $EEX21                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           BAEX22    IFNE *BLANKS                                                     BUG23742
     C                     MOVE *ON       *IN63                                             BUG23742
     C                     MOVELBAEX22    $EEX22                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDSR                                                            BUG23742
      *****************************************************************                    AR1065437
      *                                                               *                    AR1065437
      * SRCBIF - Subroutine to process additional fields introduced   *                    AR1065437
      *          by CGL125 and CSC054 if CGL125 is ON.                *                    AR1065437
      *                                                               *                    AR1065437
      * Called by: GARDRC                                             *                    AR1065437
      *                                                               *                    AR1065437
      * Calls: None                                                   *                    AR1065437
      *                                                               *                    AR1065437
      *****************************************************************                    AR1065437
      *                                                                                    AR1065437
     C           SRCBIF    BEGSR                                                           AR1065437
      *                                                                                    AR1065437
     C                     MOVE *ON       *IN98                                            AR1065437
      *                                                                                    AR1065437
     C           BTBTNB    CHAINGLJEHQD0             96                                    AR1065437
      *                                                                                    AR1065437
     C           *IN96     IFEQ *OFF                                                       AR1065437
     C           HQJETP    ANDEQ'C'                                                        AR1065437
     C                     MOVE 'Y'       WCBIM   1                                        AR1065437
      *                                                                                    AR1065437
     C           HQBDTE    IFNE *ZERO                                                      AR1065437
     C                     CALL 'ZDATE2'               90                                  AR1065437
     C                     PARM HQBDTE    WQ0001  50                                       AR1065437
     C                     PARM WUDTFF    WQ0002  1                                        AR1065437
     C           WUDTNF    PARM *ZERO     WQ0003  60                                       AR1065437
     C           WUDDCD    PARM *BLANK    WQ0004  7                                        AR1065437
     C           *IN90     IFEQ '1'                                                        AR1065437
     C                     MOVEL'Y2U0021' W0RTN   7                                        AR1065437
     C                     ELSE                                                            AR1065437
     C                     MOVE WUDDCD    ZQBDTE                                           AR1065437
     C                     ENDIF                                                           AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C                     MOVE HQPTRS    ZQPTRS                                           AR1065437
     C                     MOVE HQJETP    ZQJETP                                           AR1065437
     C                     ELSE                                                            AR1065437
     C                     MOVE 'N'       WCBIM                                            AR1065437
     C                     MOVE *OFF      *IN98                                            AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
      *                                                                                    AR1065437
     C           HQJETP    IFEQ 'C'                                                        AR1065437
     C           KJENX     CHAINGLJEPQD0             96                                    AR1065437
      *                                                                                    AR1065437
     C           *IN96     IFEQ *OFF                                                       AR1065437
     C           IQBCRT    IFNE 0                                                          AR1065437
     C                     MOVE IQBCRT    W#NUMB 150                                       AR1065437
     C                     CALL 'ZSEDIT'                                                   AR1065437
     C                     PARM           W#NUMB                                           AR1065437
     C                     PARM 8         W#DECS  10                                       AR1065437
     C                     PARM *BLANK    W#EDTC  1                                        AR1065437
     C                     PARM           W#CHAR 21                                        AR1065437
     C                     MOVE W#CHAR    ZQBCRT                                           AR1065437
     C                     ENDIF                                                           AR1065437
     C                     MOVE IQBCIN    ZQBCIN                                           AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C                     ENDIF                                                           AR1065437
      *                                                                                    AR1065437
     C                     ENDSR                                                           AR1065437
      *                                                                                    AR1065437
      *****************************************************************                    AR1065437
      /EJECT                                                                               AR1065437
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * *PSSR  - Program exception error routine                      *                       CGL013
      *          Called automatically if a program error occurs,      *                       CGL013
      *          or directly by the program code using EXSR.          *                       CGL013
      *          This subroutine DUMPs the program just once.         *                       CGL013
      *                                                               *                       CGL013
      * Called by: ZZINIT                                             *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           *PSSR     BEGSR                                                              CGL013
      *                                                                                       CGL013
     C           @RUN      IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       @RUN    1                                           CGL013
     C                     DUMP                                                               CGL013
     C                     CALL 'DBERRCTL'                                                    CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     MOVE *ON       *INU7                                               CGL013
     C                     MOVE *ON       *INU8                                               CGL013
     C                     MOVE *ON       *INLR                                               CGL013
     C                     RETRN                                                              CGL013
      *                                                                                       CGL013
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
     O/COPY WNCPYSRC,GL0122POPG
** CPY@
(c) Misys International Banking Systems Ltd. 2001
** UHDR REPORT TITLE AND UNDERLINE
       JOURNAL ENTRIES:- BATCH ITEMS - ONE BATCH
       -----------------------------------------
