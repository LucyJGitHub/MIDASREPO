     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Display JE Batch Posting Local')              *
     H/TITLE Midas GL Display JE Batch Posting Local
     Z* CRTRPGPGM
     Z* IGNDECERR(*YES)
      *
     H* SYNOPSIS :
     H* - Display DBF file records, one at a time
      *
     H* Generated by  : SYNON/2  Version:  1080
     H* Function type : Display record(1 screen)
      *
     H*  Company :
     H* System        : General Ledger Synon Model
     H* User name     : LEMMONP
     H* Date          : 30/07/93  Time  : 12:50:49
      *  (c) Finastra International Limited 2001                      *
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*****************************************************************
     F*                                                               *
      *                                                               *
      *  Last Amend No. MD058618           Date 28Sep21               *
      *  Prev Amend No. EML102             Date 28Nov19               *
      *                 MD055203           Date 19Feb20               *
      *                 MD046248           Date 27Oct17               *
      *                 MD027587           Date 19Jun14               *
      *                 AR877000           Date 08Dec11               *
      *                 AR873470           Date 30Nov11               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26687           Date 06Nov09               *
      *                 BUG24339A          Date 21Jul09               *
      *                 BUG24339           Date 17Jun09               *
      *                 BUG23742           Date 09May09               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246418             Date 16Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL013             Date 29Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU013             Date 06Mar98               *
      *                 S01408             Date 29Apr96               *
     F*                089856            DATE : 25OCT95               *
     F*        AMEND : S01408            DATE : 12JAN95               *
     F*        AMEND : S01413            DATE : 20JUL93               *
     F*        AMEND : S10736            DATE : 09SEP92               *
     F*        AMEND : E38270            DATE : 12JUN92               *
     F*        AMEND : LN0315            DATE : 06JUN90               *
     F*        AMEND : E18852            DATE : 28/09/89              *
     F*        AMEND : SAR017            DATE : 13/09/89              *
     F*              : S01212            DATE : 11/09/89              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD058618 - Multicash extended narrative not displaying on    *
      *             account movements. Recompile due to change in     *
      *             CPYSRC EML102_029.                                *
      *  EML102 - Upgrade of UNL007 to FB2.1 SP21                     *
      *           UNL007 - Extended Narratives                        *
      *                Used GL0123ECP1, GL0123ECP2, GL0123ECP3        *
      *                     GL0123ECP4, GL0123ECP5, GL0120GDTA        *
      *                Added EML102_029                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
     F*  MD055203 - Return code processing if no extension details    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD027587 - Unable to used the C for Copy and T for Template  *
      *             (Recompile)                                       *
      *  AR877000 - Extended narratives enquired are not the          *
      *             expected values (Child:AR877001)                  *
      *  AR873470 - Apply fix 263647 (Child:AR873471)                 *
      *  263647 - Wrong batches displayed in GL0123E when called      *
      *           from GL4442.Enforce chain to Journal Posting        *
      *           History in this case, i.e. ALWAYS use posting date  *
      *           in key, not just batch number.                      *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26687 - Enhancement of enquiries                          *
      *  BUG24339A - Extended Narrative fields are unavailable        *
      *  BUG24339 - Extended Narrative fields are unavailable         *
      *  BUG23742 - Improper handling of Ext Narr from Batch Interface*
      *             Input                                             *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  246418 - CGL013 changes for Midas Plus                       *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL013 - MT94x Messages Generation                           *
     F*  CEU013 - EMU Account Postings Narrative                      *
     F*   S01408 - ADDITION OF CORE HOOK GL0123ECP6                   *
     F*            ADDITION OF CORE HOOK GL0123ECP7                   *
     F*   089856 - Change to allow posting amount as 13N as specified *
     F*            in Ins Manual.                                     *
     F*   S01408 - ADDITION OF CORE HOOK GL0123ECP1                   *
     F*            ADDITION OF CORE HOOK GL0123ECP2                   *
     F*            ADDITION OF CORE HOOK GL0123ECP3                   *
     F*            ADDITION OF CORE HOOK GL0123ECP4                   *
     F*            ADDITION OF CORE HOOK GL0123ECP5                   *
     F*   S01413 - RETAIL 3 INCORPORATION:- NUMBER OF ITEMS AVAILABLE.*
     F*   S10736 - MANAGEMENT ACCOUNTING                              *
     F*   E38270 - DO NOT DISPLAY BRANCH IF MBIN IS 'N'.              *
     F*   LN0315 - ADDITION OF RETAIL INDICATORS ON CALL TO AOACCTR0  *
     F*                                                               *
     F*   E18852 - TO STOP JOURNAL ENTRIES BEING POSTED ACROSS        *
     F*            DIFFERENT BRANCHES                                 *
     F*                                                               *
     F*   S01212 - WINDOW PROCESSING BEING ALLOWED. /COPY STATEMENTS  *
     F*            HAVE BEEN ADDED TO EACH USER POINT                 *
     F*                                                               *
     F*   SAR017 - TO DISPLAY THE CUSTOMER REPORT NAME AND THE        *
     F*            ACCOUNT NAME ON BATCH ITEM INPUT SCREEN.           *
     F*                                                               *
     F*****************************************************************
     F**************************************************************
     F*
     F*     DATE   - 28.09.89
     F*
     F*     S01212 - WINDOW PROCESSING INSTALLED - /COPY
     F*
     F**************************************************************
     F/COPY WNCPYSRC,GL0123EFPG
     FGL0123E#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Midas GL Display JE Batch Posting Local
      *
     FGLJENPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Midas GL Journal Entry Posting Rtv
      *
     FGLJENHL1IF  E           K        DISK
      * RTV : Midas GL Journal Entry Header LF Rtv
      *
     F***GLJENXL2IF  E           K        DISK         KINFSR *PSSR                  CGL013 AR877000
     FGLJENXL1IF  E           K        DISK         KINFSR *PSSR                            AR877000
      ** RTV: Midas GL Journal Entry File - Additional Information                            CGL013
      *                                                                                       CGL013
      ** Midas GL MultiCash Narratives File - Rtv Indx                                      BUG23742
      *                                                                                     BUG23742
     FGLMNARL3IF  E           K        DISK         KINFSR *PSSR                            BUG23742
      *                                                                                     BUG23742
      ** DSP: Midas GL Display JE Batch history posting                                     BUG24339
     FGLJEHHL1IF  E           K        DISK                                                 BUG24339
      *                                                                                     BUG24339
      *  DSP: Midas GL Display JE Batch item history posting                                BUG24339
     FGLJEHPL1IF  E           K        DISK                                                 BUG24339
      *                                                                                    BUG24339A
     FGLJEHXL2IF  E           K        DISK         KINFSR *PSSR                           BUG24339A
      ** RTV: Midas GL Journal History File - Additional Information                       BUG24339A
      *                                                                                     BUG24339
     E                    @IE     1   2 76               Item Err.Msgs.
     E                    @IH         8  9               Item Err.slots
      *
     E                    LNE     1   1 76               Dashes
     E                    CPY@    1   1 80               Copyright     array
     E/COPY WNCPYSRC,GL0123EEPG
      *                                                                                       246418
      * Parameters for pass to GL000185                                                       246418
     E                    FLDNMA     75 10                                                    246418
     E                    MSGIDA     75  7                                                    246418
     E                    MSGDTA     75 45                                                    246418
      *                                                                                       246418
     I*   Define MIDAS Rundate from data-area RUNDAT
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I*
     I/COPY QWINDSRC,GL0120GDTA
     I/COPY WNCPYSRC,GL0123EIPG
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I            DS
      * Item error status data structure
     I                                        1 152 @IE
     I                                        1  76 URERMG
     I                                       77 152 URDASH
     I                                        5  76 @IH
     I                                        5  76 URIESL
     I                                        5   5 URHL01
     I                                       14  14 URHL02
     I                                       23  23 URHL03
     I                                       32  32 URHL04
     I                                       41  41 URHL05
     I                                       50  50 URHL06
     I                                       59  59 URHL07
     I                                       68  68 URHL08
     IWURARC      DS
     I                                        1   1 WURSRD
     I                                        2   2 WURSRC
     I                                        3   3 WURSBD
     I                                        4   4 WURSBC
     I                                        5   5 WURSIN
     I                                        6   6 WURTSS
     I                                        7   7 WURSBR
     I                                        8   8 WURTSB
     I                                        9   9 WURSSC
     I                                       10  10 WURSS2
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNO
     I                                       11  11 SUCP
     I                                       12  12 DTFF
     I                                       13  13 MBIN
     I*
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
     IUUFDY     E DSDSFDY
     I*
     I* 200 Byte Data Structure for Incoming Data from Access Program
     I*
     IUUSDY     E DSDSSDY
     I*
     I* 800 Byte Data Structure for Incoming Data from Access Program
     I*
     ID@CURR    E DSSDCURRPD
     I*
     I*  Currency Codes DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@GELR    E DSSDGELRPD
     I*
     I*  General Ledger Details DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@MMOD    E DSSDMMODPD
     I*
     I*  Midas Modules DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@ACCT    E DSACCNTAB
     I*
     I*  Account Details DS for assigning data from Access
     I*  Programs to work fields
     I*
     ID@CUST    E DSSDCUSTPD
     I*
     I*  Client Details DS for assigning data from Access
     I*  Programs to work fields
     I/COPY WNCPYSRC,GL0123EI01
     I*
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : RST Batch number
     I                                        1   3 P1BTNB
     IP2PARM      DS
      * I : RST Batch item no.
     I                                    P   1   20P2BINB
     ILDA       E DSLDA                         256                                           CGL013
     I              SPARE                           WSPARE                                    CGL013
      ** Local Data Area for Database Error Details                                           CGL013
      *                                                                                       CGL013
     ISCSARD    E DSSCSARDPD                                                                  CGL013
     I              LCD                             WLCD                                      CGL013
      ** Switchable Features Data Structure                                                   CGL013
      *                                                                                       CGL013
      ** Parameter Passed to GL000185                                                         CGL013
      *                                                                                       CGL013
     I**********                              1 108 PDETLS                           CGL013 BUG23742
     I                                        1 119 PDETLS                                  BUG23742
     I                                        1   3 PABTNB                                    CGL013
     I                                        4   6 PABINB                                    CGL013
     I                                        7   9 #1BCBH                                    CGL013
     I                                       10  15 #1CUST                                    CGL013
     I                                       16  18 #1CYCD                                    CGL013
     I**********                             19  22 #1ACCD                             CGL013 CGL029
     I                                       19  22 #1ACQQ                                    CGL029
     I                                       23  24 #1ACSN                                    CGL013
     I                                       25  34 PARACN                                    CGL013
     I                                       35  48 #DFMPA                                    CGL013
     I                                       49  49 #1DCIN                                    CGL013
     I                                       50  79 #DNRTV                                    CGL013
     I                                       80  85 PAVLDT                                    CGL013
     I                                       86  90 #1TRTY                                    CGL013
     I                                       91 100 #1TSTY                                    CGL013
     I                                      101 108 #1CQNB                                    CGL013
     I                                      109 118 #1ACCD                                    CGL029
     I                                      119 119 PEDIT                                   BUG23742
      *                                                                                       246418
      **  Valid JE Item (DS) for passing to GL000185                                          246418
     IPVBIPX    E DSGLVBIPXPD                                                                 246418
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BTNB    PARM           WP0001  3        Batch number
     C           P2BINB    PARM           WP0002  30       Batch item no.
     C           BTBEDT    PARM           WP0003  50                                        BUG24339
     C                     PARM           WOPTN   1                                         BUG26687
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
      *
      * Display and process key screen
     C                     EXSR BADSKY
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialise key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
      *
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1BTNB    IFEQ *BLANK                     Batch number
     C           #1BINB    OREQ *ZERO                      Batch item no.
      * One or more key fields is blank
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   05                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BTBTNB           Batch number
     C                     KFLD           BTBINB           Batch item no.
      *                                                                                     BUG23742
     C           KRTV2     KLIST                                                            BUG23742
     C                     KFLD           BTPTDT                                            BUG23742
     C                     KFLD           BTBTNB                                            BUG23742
     C                     KFLD           BTBINB                                            BUG23742
      *                                                                                     BUG23742
     C           KRTV3     KLIST                                                            BUG24339
     C                     KFLD           BTBEDT  50                                        BUG24339
     C                     KFLD           BRBTNB                                            BUG24339
      *                                                                                     BUG24339
     C           KRTV4     KLIST                                                            BUG24339
     C                     KFLD           BTBEDT                                            BUG24339
     C                     KFLD           BTBTNB                                            BUG24339
     C                     KFLD           BTBINB                                            BUG24339
      *                                                                                     BUG24339
      * Setup key
     C                     MOVEL#1BTNB    BTBTNB           Batch number
     C                     Z-ADD#1BINB    BTBINB           Batch item no.
     C           KRTV      CHAIN@BTREAL              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     99    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *                                                                                     BUG24339
     C           *IN90     IFEQ '1'                                                         BUG24339
     C           BTBEDT    ANDNE*ZEROS                                                      BUG24339
     C           *IN90     OREQ '0'                                                           263647
     C           HFLAG     ANDEQ'H'                                                           263647
      *                                                                                     BUG24339
     C           KRTV4     CHAIN@BFREDE              9091                                   BUG24339
     C           *IN90     IFEQ '0'                                                         BUG24339
      *                                                                                     BUG24339
     C                     MOVE HPBTNB    BTBTNB                                            BUG24339
     C                     MOVE HPBINB    BTBINB                                            BUG24339
     C                     MOVE HPIBCA    BTIBCA                                            BUG24339
     C                     MOVE HPCUST    BTCUST                                            BUG24339
     C                     MOVE HPCYCD    BTCYCD                                            BUG24339
     C                     MOVE HPACCD    BTACCD                                            BUG24339
     C                     MOVE HPACSN    BTACSN                                            BUG24339
     C                     MOVE HPNNBI    BTNNBI                                            BUG24339
     C                     MOVE HPRACN    BTRACN                                            BUG24339
     C                     MOVE HPRINO    BTRINO                                            BUG24339
     C                     MOVE HPRINE    BTRINE                                            BUG24339
     C                     MOVE HPTRTY    BTTRTY                                            BUG24339
     C                     MOVE HPPTAM    BTPTAM                                            BUG24339
     C                     MOVE HPDCIN    BTDCIN                                            BUG24339
     C                     MOVE HPPTDT    BTPTDT                                            BUG24339
     C                     MOVE HPVLDT    BTVLDT                                            BUG24339
     C                     MOVE HPNVCD    BTNVCD                                            BUG24339
     C                     MOVE HPNRDC    BTNRDC                                            BUG24339
     C                     MOVE HPACTY    BTACTY                                            BUG24339
     C                     MOVE HPACNB    BTACNB                                            BUG24339
     C                     MOVE HPCQNB    BTCQNB                                            BUG24339
     C                     MOVE HPCOIN    BTCOIN                                            BUG24339
     C                     MOVE HPSWCR    BTSWCR                                            BUG24339
     C                     MOVE HPPRCN    BTPRCN                                            BUG24339
     C                     MOVE HPBCBH    BTBCBH                                            BUG24339
     C                     MOVE HPRADP    BTRADP                                            BUG24339
     C                     MOVE HPSHPI    BTSHPI                                            BUG24339
     C                     MOVE HPRRNM    BTRRNM                                            BUG24339
     C                     MOVE HPRNBE    BTRNBE                                            BUG24339
     C                     MOVE HPRARC    BTRARC                                            BUG24339
     C                     MOVE HPTSTY    BTTSTY                                            BUG24339
     C                     MOVE HPBKCD    BTBKCD                                            BUG24339
     C                     MOVE HPSPFC    BTSPFC                                            BUG24339
     C                     MOVE HPRVDI    BTRVDI                                            BUG24339
     C                     MOVE HPNITM    BTNITM                                            BUG24339
     C                     MOVE HPOCCY    BTOCCY                                            BUG24339
     C                     MOVE HPOAMT    BTOAMT                                            BUG24339
     C                     MOVE HPFRNT    BTFRNT                                            BUG24339
     C                     MOVE HPAFRT    BTAFRT                                            BUG24339
     C                     MOVE HPTMST    BTTMST                                            BUG24339
     C                     ENDIF                                                            BUG24339
      *                                                                                     BUG24339
     C           *IN91     IFEQ '1'                                                         BUG24339
      * Record locked                                                                       BUG24339
     C                     SETON                     99                                     BUG24339
     C                     GOTO BEEXIT                                                      BUG24339
     C                     END                                                              BUG24339
     C                     ENDIF                                                            BUG24339
      *
      * If record does not exist, then signal error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    *
      * Send message 'Journal Entry Posting  NF'
     C                     MOVEL'GLX0176' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123ESFF - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123ESFF
     C*00/Copy Member GL0123E   Calculate Detail Func Fld
     C                     END                             *FI
      * USER: Load detail screen from DBF record
      * Set up Account Identifier
      * CASE: DB1.Retail Number Entered is Retail Account
     C           BTRNBE    IFEQ 'Y'                        *IF
     C                     MOVELBTRACN    #DACID           Account Identif
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DACID           Account Identif
     C                     MOVELBTCUST    #DACID           Account Identif
     C                     END                             *FI
      * Set up Narrative code
      * CASE: DB1.Narrative code is Narrative code
     C           BTNVCD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    #DNRTV           Narrative
     C                     MOVELBTNVCD    #DNRTV           Narrative
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBTNRDC    #DNRTV           Narrative
     C                     END                             *FI
      * Midas Conv. Day to Date - Standard functions  *
     C                     CALL 'ZDATE2'               90  Midas Conv. Day
     C                     PARM BTVLDT    WQ0001  50       Runday Number
     C                     PARM WUDTFF    WQ0002  1        Date Format fla
     C           WUDTNF    PARM *ZERO     WQ0003  60       Date (numeric f
     C           WUDDCD    PARM *BLANK    WQ0004  7        Midas Run Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     MOVELWUDDCD    #DVDDE           Value Date (Dis
      * Access Currency. - Currency Codes  *
     C*
     C*  Access Currency codes file for the following fields
     C*  Currency Name, Number of decimal places, Nostro Shortname
     C*
     C                     MOVELBTCYCD    UUCYCD
     C                     CALL 'AOCURRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        I:Option
     C                     PARM           UUCYCD  3        I:Currency Code
     C           D@CURR    PARM *BLANK    UUSDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELA6CYCD    #1CYCD           Currency Code
     C                     MOVELA6CYNM    WUCYNM           Currency Name
     C                     MOVELA6NBDP    WUNBDP           No. Decimal Places
     C                     MOVELA6NOSN    WUNOSN           Nostro Shortname
     C*
      * Format amount (short) - Standard functions  *
     C                     Z-ADDBTPTAM    ULVALU           Value
      *
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>
     C                     PARM           ULVALU 150       I:Value
     C                     PARM WUNBDP    ULDECP  10       I:Decimal place
     C***********          PARM 'L'       ULEDIT  1        I:IBM Edit code089856
     C                     PARM '3'       ULEDIT  1        I:IBM Edit code089856
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.
     C                     PARM           ULRSLF 23        O:Formatted
      *
     C                     MOVE ULRSLF    #DFMPA           Formatted data
     C*                                                                   CEU013
      * Access Currency. - Original Currency Code if Switchable           CEU013
     C*  function CEU013 is installed and Original currency is non -      CEU013
     C*  blank.                                                           CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           #1OCCY    ANDNE*BLANKS                                   CEU013
     C*  Access Currency codes file for Number of Decimal places          CEU013
     C*                                                                   CEU013
     C                     MOVEL#1OCCY    UUCYCD                          CEU013
     C                     CALL 'AOCURRR0'                                CEU013
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    CEU013
     C                     PARM '*KEY'    UUAPOP  7        I:Option       CEU013
     C                     PARM           UUCYCD  3        I:Currency CodeCEU013
     C           D@CURR    PARM *BLANK    UUSDY            O:Format       CEU013
     C*                                                                   CEU013
     C* Assign work field to file field values.                           CEU013
     C*                                                                   CEU013
     C                     MOVELA6CYCD    #1OCCY           Original Ccy   CEU013
     C                     MOVELA6NBDP    WUNBDP           No. Decimal PlcCEU013
     C*                                                                   CEU013
      * Format amount (short) - Standard functions  *                     CEU013
     C                     Z-ADD#1OAMT    ULVALU           Value          CEU013
      *                                                                   CEU013
     C                     CALL 'GL0135U'              90  <FORMAT AMOUNT>CEU013
     C                     PARM           ULVALU 150       I:Value        CEU013
     C                     PARM WUNBDP    ULDECP  10       I:Decimal placeCEU013
     C                     PARM '3'       ULEDIT  1        I:IBM Edit codeCEU013
     C                     PARM *BLANK    ULCHQP  1        I:Cheque prtct.CEU013
     C                     PARM           ULRSLF 23        O:Formatted    CEU013
      *                                                                   CEU013
     C                     MOVE ULRSLF    #DFMOA           Formatted O/AmtCEU013
     C*                                                                   CEU013
     C                     ENDIF                                          CEU013
      *                                                                   CEU013
      *
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
     C                     MOVELBTRARC    WURARC           Retail Ac Refer
      * DS for Item Err Msg - Standard functions  *
      * Setup Override Err Msg - Standard functions  *
      *
     C                     EXSR CHKOVR                     Check Retail
      *
     C                     MOVELURERTX    #DIEMG           Error message
      *
      *==================================================================
      *
      * Clear Item Err Msg - Standard functions  *
     C*
      *
      * Check To See If Item Error Message Equals a Line Of Dashes
      * Since they are not required in the Edit Record a blank line
      * must be displayed.
      *
     C           URERTX    IFEQ LNE,1
     C                     MOVE *BLANK    URERTX 76          Dashes
     C                     END
      *
     C                     MOVELURERTX    #DIEMG           Error message
     C                     END                             *FI
      * Start Of SAR SAR017
      * CASE: WRK.GL Description Ind. is Yes
     C           WUGLDI    IFEQ 'Y'                        *IF
      *     E18852  - Branch Code Of trade Parm Added 28.09.89
      * Start of Fix LN0315
      * Check Account Number. - Standard functions  *
     C*
     C* Set up Parameters for call to AOACCTR0
     C*
     C                     MOVEL*BLANK    UUACID
     C                     MOVELBTCUST    UUCUST
     C                     MOVELBTCYCD    UUCYCD
     C                     MOVELBTACCD    UUACNO
     C                     MOVELBTACSN    UUACSN
     C                     MOVELBTIBCA    UUBRCD
     C*
     C*  Call to Access Program - AOACCTR0 Check Account Number
     C*  Access Account Details file for the file fields
     C*
     C                     CALL 'AOACCTR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*KEY'    UUAPOP  7        B:Option
     C                     PARM           UUACID 10        I:Account Identifier
     C                     PARM           UUCUST  6        I:Customer Number
     C                     PARM           UUCYCD  3        I:Currency Code
     C**********           PARM           UUACNO  4        I:Account Code Num                 CGL029
     C                     PARM           UUACNO 10                                           CGL029
     C                     PARM           UUACSN  2        I:Account Sequence
     C                     PARM           UUBRCD  3        I:Branch code
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELCNUM      WUCNUM           Customer Number
     C                     MOVELCCY       WUCCY            Currency Code
     C                     MOVELACOD      WUACOD           Account Code
     C                     MOVELACSQ      WUACSQ           Account Sequence No.
     C                     MOVELBRCA      WUBRCD           Branch Code
     C                     MOVELATYP      WUATYP           Account Type
     C                     MOVELSTYP      WUSTYP           Account Sub-Type
     C                     MOVELACST      WUASTT           Account Status
     C                     MOVELDACO      WUDACO           Date Account Opened
     C                     MOVELANAM      WUACNM           Account Name
     C                     MOVELACNO      WURTAC           Retails Account Num
     C                     MOVELRRNM      WURRNM           Relative rec No Memos
     C                     MOVELRETB      WURETB           Retail Indic'trLN0315
     C*
      * End of Fix LN0315
     C                     MOVEL'Y'       WUDSAC           Display Account
     C                     MOVELWUACNM    #DDACN           Display Account
     C/COPY WNCPYSRC,GL0123EC03
      * Access Cust Report Name - Standard functions  *
      *********P@AORF    E DSSDCUSTPD                                     S01117
     C*
     C* Access Customer Report Name Off Client File
     C*
     C                     MOVE *BLANK    WUCRST  7
     C**
     C                     CALL 'AOCUSTR0'
     C***********#BAORC****PARM #BAORC    P@RTN   7        B:Return code  S01117
     C           WUAPRC    PARM WUAPRC    P@RTN   7        B:Access Pgm ReS01117
     C*********************PARM #IAOPN    P@OPTN  7        I:Option       S01117
     C                     PARM '*KEY'    P@OPTN  7        I:Access Pgm OpS01117
     C                     PARM BTCUST    P@CKEY 10        I:Key field
     C           WUCRST    PARM *BLANK    P@FLD1  7        O:Client Key Id.
     C*********************PARM           P@AORF           O:Format       S01117
     C           D@CUST    PARM *BLANK    UUSDY            O:Format       S01117
     C*
     C                     MOVELBBCRNM    WUCRNM           O:Cust Report Nme
     C                     MOVELWUCRNM    #DDCNM           Display Custome
     C                     MOVEL'Y'       WUDCUS           Display Custome
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDSAC           Display Account
     C                     MOVEL'N'       WUDCUS           Display Custome
     C                     END                             *FI
      * End Of SAR SAR017
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123ELDS - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123ELDS
     C*00/Copy Member GL0123E   Load Detail Screen
     C                     END                             *FI
     C                     END
      *
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * USER: Validate key screen
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123EVKS - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123EVKS
     C*00/Copy Member GL0123E   Validate Key Screen
     C                     END                             *FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen
     C/COPY WNCPYSRC,GL0123EC01
     C                     EXSR CBEXFM
      * Process response to detail screen
     C/COPY WNCPYSRC,GL0123EC02
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
      * Process detail screen input
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   05                CAS            CCDSPV
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0123ECP1                                           S01408
     C*                                                                   S01408
     C                     CAS            CFPRSC
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0123ECP2                                           S01408
     C*                                                                   S01408
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
     C                     WRITE#MSGCTL
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0123ECP4                                           S01408
     C*                                                                   S01408
     C                     WRITE#CMDTXT2
     C           WOPTN     IFNE *BLANKS                                                     BUG26687
     C           WOPTN     ANDEQ'1'                                                         BUG26687
     C                     EXFMT#RCDDTL1
     C                     ENDIF                                                            BUG26687
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0123ECP5                                           S01408
     C*                                                                   S01408
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123EPKR - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123EPKR
     C*00/Copy Member GL0123E   Process Key Screen Rqst
     C                     END                             *FI
      * Send message 'Function Key Not Allowed'
     C                     MOVEL'GLX0131' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO CCEXIT                     *QUIT
     C   05                MOVEL'Y'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C                     MOVEL'Y'       W0TRN
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Process record:
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
     CSR         CHKOVR    BEGSR
      *====================================================
      * Check OVERRIDE MESSAGES
      *----------------------------------------------------
      *
     C                     MOVE *IN90     URSI90  1        Save indicator
     C                     MOVE *IN91     URSI91  1        Save indicator
     C                     MOVE *BLANK    URIESL           Blank msg.text
     C                     MOVE *BLANK    URERST  1        Error status
     C                     Z-ADD1         U1      30       Set pointer
     C                     SETOF                     91    Set ind.
      *
      * Check Refer Debits :
      *
      *
     C           WURSRD    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Refer Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Refer Credits :
      *
      *
     C           WURSRC    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Refer Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI             E17600
      *
      * Check Block Debits :
      *
      *
     C           WURSBD    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Block Dr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI             E17600
      *
      * Check Block Credits :
      *
     C           WURSBC    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Block Cr'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI             E17600
      *
      * Check Inactive A/C :
      *
     C           WURSIN    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Inactive'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Not in Use :   ***REMOVE COMMENTS IF FLAG TO BE USED LATER***
      *
     C*****      WUBDST    IFEQ 'Y'                        IF BIT SET
     C*****                MOVELURRIHS    @IH,U1             Highlight
     C*****                MOVE 'Not used'@IH,U1             Message text
     C*****                ADD  1         U1                 Incr.pointer
     C*****                END                             FI
      *
      * Check Bankrupt :
      *
     C           WURSBR    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Bankrupt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Bad Debt :
      *
     C           WURTSB    IFEQ 'Y'                        IF BIT SET
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Bad Debt'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Stopped cheque :
      *
     C           WURSSC    IFEQ 'Y'                        IF NO O'RIDE
     C                     MOVELURRIHS    @IH,U1             Highlight
     C                     MOVE 'Chq.Stop'@IH,U1             Message text
     C                     ADD  1         U1                 Incr.pointer
     C                     END                             FI
      *
      * Check Non-Overrideable error status :
      *
     C           U1        IFGT 1                          IF ERRORS
     C           U1        IFLT 9                          IF NOT MAXIMUM
     C                     MOVELURNORM    @IH,U1             End Highlight
     C                     END                             FI
     C                     MOVE URERMG    URERTX             Error line
     C                     ELSE                            EL NO ERRORS
     C                     MOVE *BLANK    URERST             Error Status
     C                     MOVE URDASH    URERTX 76          Dashes
     C                     END                             FI
      *
     C                     MOVE URSI90    *IN90            Restore ind.
     C                     MOVE URSI91    *IN91            Restore ind.
      *
      *----------------------------------------------------
      *
      *====================================================
     CSR         XXEND     ENDSR
      *
      * Set highlights for error message line :
      *
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * CALC: Detail screen function fields
      *                                                                                       CGL013
      ** Process Additional Information                                                       CGL013
      *                                                                                       CGL013
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C                     EXSR SRADIN                                                        CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123ESFF - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123ESFF
     C*00/Copy Member GL0123E   Calculate Detail Func Fld
     C                     END                             *FI
      * USER: Validate detail screen
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * Call Window Manager - Standard functions  *
     C*  Call Window Manager Program
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0123ECP6                                           S01408
     C*                                                                   S01408
     C                     CALL 'WN0010'
     C                     PARM ##PGM     UPGM   10        Calling PGM    LN0355
     C                     PARM *BLANK    UFKEY   2        Function Key   LN0355
     C                     PARM 'E'       UACODE  1        Action Code    LN0355
     C                     PARM           DATA             Trans Key      LN0355
     C                     PARM *BLANKS   W0RTN            Return code    LN0355
     C                     PARM           SPARE 256        Spare          LN0355
      * Check WM Return Code
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'GLX0138' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is previous screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member GL0123EVSW - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123EVSW
     C*00/Copy Member GL0123E   Validate Detail Scrn Wdw
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0123ECP7                                           S01408
     C*                                                                   S01408
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123EVDS - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123EVDS
     C*00/Copy Member GL0123E   Validate Detail Screen
     C                     END                             *FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * USER: Perform confirmed action
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123EPCA - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123EPCA
     C*00/Copy Member GL0123E   Perform Confrimed Action
     C                     END                             *FI
      * Quit if error signalled
     C   99                GOTO EBEXIT
      * USER: Process command keys
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123EPCK - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123EPCK
     C*00/Copy Member GL0123E   Process Command Keys
     C                     END                             *FI
      * Quit if error signalled
     C   99                GOTO EBEXIT
      * Restart program for next record
     C           PCANC     IFNE '1'                                                         BUG23742
     C           PCANC1    ANDNE'1'                                                         BUG23742
     C                     MOVEL'N'       W0TRN
     C                     ENDIF                                                            BUG23742
     C           XMTCAS    IFNE ' '                                                         MD055203
     C                     MOVE *BLANKS   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055303
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUMBIN    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #1RVDI    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUDNIT    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #1RINO    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WUDCUS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           WUDSAC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields
      *================================================================
     C                     MOVEL*BLANK    #DIEST           Item error stat
     C                     MOVEL*BLANK    #1CUST           Customer number
     C                     MOVEL*BLANK    #1NNBI           Nostro number (
     C                     Z-ADD*ZERO     #1RACN           Retail account
     C                     MOVEL*BLANK    #1RINE           Retail ind.: Er
     C                     Z-ADD*ZERO     #1PTAM           Posting amount
     C                     Z-ADD*ZERO     #1PTDT           Posting date
     C                     MOVEL*BLANK    #1NVCD           Narrative code
     C                     MOVEL*BLANK    #1NRDC           Narrative descr
     C                     MOVEL*BLANK    #1ACTY           Account type
     C                     Z-ADD*ZERO     #1VLDT           Value date
     C                     MOVEL*BLANK    #1COIN           Customer origin
     C                     Z-ADD*ZERO     #1SPFC           Spread Factor
     C                     MOVEL*BLANK    #1BCBH           Branch Code (Ba
     C                     MOVEL*BLANK    #1RADP           Retail advice p
     C                     MOVEL*BLANK    #1SHPI           Shadow post ind
     C                     Z-ADD*ZERO     #1RRNM           Relative rec no
     C                     MOVEL*BLANK    #1RNBE           Retail Number E
     C                     MOVEL*BLANK    #1RARC           Retail Ac Refer
     C                     MOVEL*BLANK    #DACID           Account Identif
     C                     MOVEL*BLANK    #1CYCD           Currency code
     C                     MOVEL*BLANK    #1ACCD           Account code
     C                     MOVEL*BLANK    #1ACSN           Account sequenc
     C                     MOVEL*BLANK    #1IBCA           Input Branch Co
     C                     MOVEL*BLANK    #DFMPA           Formatted Posti
     C                     MOVEL*BLANK    #1DCIN           Debit/credit in
     C                     MOVEL*BLANK    #1RVDI           Reverse/Void In
     C                     MOVEL*BLANK    #DNRTV           Narrative
     C                     Z-ADD*ZERO     #1NITM           Number of Items
     C                     MOVEL*BLANK    #1TRTY           Transaction typ
     C                     MOVEL*BLANK    #1TSTY           Transaction (Su
     C                     MOVEL*BLANK    #DVDDE           Value Date (Dis
     C                     MOVEL*BLANK    #1CQNB           Cheque number
     C                     MOVEL*BLANK    #1ACNB           Assoc. Customer
     C                     MOVEL*BLANK    #1SWCR           Swift common re
     C                     MOVEL*BLANK    #1PRCN           Profit centre
     C                     MOVEL*BLANK    #1BKCD           Book Code
     C                     MOVEL*BLANK    #1RINO           Retail ind.: Ov
     C                     MOVEL*BLANK    #DDCNM           Display Custome
     C                     MOVEL*BLANK    #DDACN           Display Account
     C                     MOVEL*BLANK    #DIEMG           Item error mess
     C                     MOVEL*BLANKS   #1OCCY           Original Ccy   CEU013
     C                     Z-ADD*ZEROS    #1OAMT           Original AmountCEU013
     C                     MOVEL*BLANKS   #DFMOA           Formatted O/AmtCEU013
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BTREAL fields to screen
      *================================================================
     C                     MOVELBTBTNB    #1BTNB           Batch number
     C                     Z-ADDBTBINB    #1BINB           Batch item no.
     C                     MOVELBTCUST    #1CUST           Customer number
     C                     MOVELBTNNBI    #1NNBI           Nostro number (
     C                     Z-ADDBTRACN    #1RACN           Retail account
     C                     MOVELBTRINE    #1RINE           Retail ind.: Er
     C                     Z-ADDBTPTAM    #1PTAM           Posting amount
     C                     Z-ADDBTPTDT    #1PTDT           Posting date
     C                     MOVELBTNVCD    #1NVCD           Narrative code
     C                     MOVELBTNRDC    #1NRDC           Narrative descr
     C                     MOVELBTACTY    #1ACTY           Account type
     C                     Z-ADDBTVLDT    #1VLDT           Value date
     C                     MOVELBTCOIN    #1COIN           Customer origin
     C                     Z-ADDBTSPFC    #1SPFC           Spread Factor
     C                     MOVELBTBCBH    #1BCBH           Branch Code (Ba
     C                     MOVELBTRADP    #1RADP           Retail advice p
     C                     MOVELBTSHPI    #1SHPI           Shadow post ind
     C                     Z-ADDBTRRNM    #1RRNM           Relative rec no
     C                     MOVELBTRNBE    #1RNBE           Retail Number E
     C                     MOVELBTRARC    #1RARC           Retail Ac Refer
     C                     MOVELBTCYCD    #1CYCD           Currency code
     C                     MOVELBTACCD    #1ACCD           Account code
     C                     MOVELBTACSN    #1ACSN           Account sequenc
     C                     MOVELBTIBCA    #1IBCA           Input Branch Co
     C                     MOVELBTDCIN    #1DCIN           Debit/credit in
     C                     MOVELBTRVDI    #1RVDI           Reverse/Void In
     C                     Z-ADDBTNITM    #1NITM           Number of Items
     C                     MOVELBTTRTY    #1TRTY           Transaction typ
     C                     MOVELBTTSTY    #1TSTY           Transaction (Su
     C                     MOVELBTCQNB    #1CQNB           Cheque number
     C                     MOVELBTACNB    #1ACNB           Assoc. Customer
     C                     MOVELBTSWCR    #1SWCR           Swift common re
     C                     MOVELBTPRCN    #1PRCN           Profit centre
     C                     MOVELBTBKCD    #1BKCD           Book Code
     C                     MOVELBTRINO    #1RINO           Retail ind.: Ov
     C                     MOVELBTOCCY    #1OCCY           Original Ccy   CEU013
     C                     Z-ADDBTOAMT    #1OAMT           Original AmountCEU013
     C                     MOVEL*BLANK    #DFMOA           Formatted O/AmtCEU013
      *                                                                                       CGL013
      ** If CGL013 is installed                                                               CGL013
      *                                                                                       CGL013
     C                     MOVE *BLANKS   XMTCAS  1                                         BUG26687
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C                     MOVEL'N'       #1ADIN                                              CGL013
      *                                                                                       CGL013
     C********** KRTV      CHAINGLJENXL2             33                              CGL013 AR877000
     C           KRTV4     CHAINGLJENXL1             33                                     AR877000
     C           *IN33     IFEQ *OFF                                                          CGL013
     C           BAADI1    ANDNE*BLANKS                                                       CGL013
     C                     MOVE BAADI1    B3ADI1                                           BUG24339A
     C                     MOVE BAADI2    B3ADI2                                           BUG24339A
     C                     MOVE BAADI3    B3ADI3                                           BUG24339A
     C                     MOVE BAADI4    B3ADI4                                           BUG24339A
     C                     MOVE BAADI5    B3ADI5                                           BUG24339A
     C                     MOVE BAADI6    B3ADI6                                           BUG24339A
     C                     MOVE BAAERI    B3AERI                                           BUG24339A
     C                     MOVE *ON       *IN31                                               CGL013
     C                     MOVE 'N'       XMTCAS                                            BUG26687
     C                     MOVEL*BLANKS   P0RTN                                             MD055203
     C                     ELSE                                                               CGL013
     C           KRTV4     CHAINGLJEHXL2             33                                    BUG24339A
     C           *IN33     IFEQ *OFF                                                       BUG24339A
     C           HAADI1    ANDNE*BLANKS                                                    BUG24339A
     C                     MOVE HAADI1    B3ADI1                                           BUG24339A
     C                     MOVE HAADI2    B3ADI2                                           BUG24339A
     C                     MOVE HAADI3    B3ADI3                                           BUG24339A
     C                     MOVE HAADI4    B3ADI4                                           BUG24339A
     C                     MOVE HAADI5    B3ADI5                                           BUG24339A
     C                     MOVE HAADI6    B3ADI6                                           BUG24339A
     C                     MOVE HAAERI    B3AERI                                           BUG24339A
     C                     MOVE *ON       *IN31                                            BUG24339A
     C                     MOVE 'N'       XMTCAS                                            BUG26687
     C                     MOVEL*BLANKS   P0RTN                                             MD055203
     C                     ELSE                                                            BUG24339A
     C                     MOVE *BLANKS   B3ADI1                                           BUG24339A
     C                     MOVE *BLANKS   B3ADI2                                           BUG24339A
     C                     MOVE *BLANKS   B3ADI3                                           BUG24339A
     C                     MOVE *BLANKS   B3ADI4                                           BUG24339A
     C                     MOVE *BLANKS   B3ADI5                                           BUG24339A
     C                     MOVE *BLANKS   B3ADI6                                           BUG24339A
     C                     MOVE *BLANKS   B3AERI                                           BUG24339A
     C                     MOVE *OFF      *IN31                                               CGL013
     C                     ENDIF                                                           BUG24339A
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           CER030    IFEQ 'Y'                                                         BUG23742
      *                                                                                     BUG23742
     C           KRTV2     CHAINGLMNARL3             43                                     BUG23742
      *                                                                                     BUG23742
     C           *IN43     IFEQ *OFF                                                        BUG23742
     C           BAEX1     ANDNE*BLANKS                                                     BUG23742
     C                     SETON                     41                                     BUG23742
     C                     MOVE 'Y'       XMTCAS                                            BUG26687
     C                     MOVEL*BLANKS   P0RTN                                             MD055203
     C                     ELSE                                                             BUG23742
     C                     SETOF                     41                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialise key screen
      *================================================================
     C                     MOVELP1BTNB    #1BTNB           Batch number
     C                     Z-ADDP2BINB    #1BINB           Batch item no.
      * Check restriction within
     C                     EXSR VACKRL
      * USER: Load key screen
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123ELKS - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123ELKS
     C*00/Copy Member GL0123E   Load Key Screen
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVEL#1BTNB    WK1X01  1
     C           WK1X01    IFEQ '?'                        Batch number
     C                     CALL 'GL0140S'              90  *
     C                     PARM           W0RTN   7
     C           #1BTNB    PARM #1BTNB    WQ0005  3        Batch number
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     CABNE*BLANK    VA999
     C                     END
      *................................................................
      *
     C           KLVABR    KLIST
     C                     KFLD           BRBTNB           Batch number
      * Setup key
     C                     MOVEL#1BTNB    BRBTNB           Batch number
     C           KLVABR    CHAIN@BRREAH              9091  *
     C           *IN90     IFEQ '0'
     C           HFLAG     ANDNE'H'                                                           263647
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
      *                                                                                     BUG24339
     C           KRTV3     CHAIN@BEREDB              9091                                   BUG24339
     C           *IN90     IFEQ '0'                                                         BUG24339
     C           BTBEDT    ANDNE*ZEROS                                                      BUG24339
      *                                                                                     BUG24339
     C                     MOVE HHBTNB    BRBTNB                                            BUG24339
     C                     MOVE HHBCDA    BRBCDA                                            BUG24339
     C                     MOVE HHDPCD    BRDPCD                                            BUG24339
     C                     MOVE HHWSID    BRWSID                                            BUG24339
     C                     MOVE HHHIIN    BRHIIN                                            BUG24339
     C                     MOVE HHHDIN    BRHDIN                                            BUG24339
     C                     MOVE HHHINI    BRHINI                                            BUG24339
     C                     MOVE HHSHPI    BRSHPI                                            BUG24339
     C                     MOVE HHRAPI    BRRAPI                                            BUG24339
     C                     MOVE HHMBRB    BRMBRB                                            BUG24339
     C                     MOVE HHRVVD    BRRVVD                                            BUG24339
     C                     MOVE HHBDES    BRBDES                                            BUG24339
     C                     MOVE HHFRNT    BRFRNT                                            BUG24339
     C                     MOVE HHAFRT    BRAFRT                                            BUG24339
     C                     MOVE HHTMST    BRTMST                                            BUG24339
      * Record found - move back any virtuals                                               BUG24339
     C                     GOTO VAEXIT                                                      BUG24339
     C                     END                                                              BUG24339
      *                                                                                     BUG24339
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Journal Entry Header   NF'
     C                     MOVEL'GLX0172' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'GLX0172' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123EEPP - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123EEPP
     C*00/Copy Member GL0123E   Exit Program Processing
     C                     END                             *FI
     C**********           MOVEL*BLANK    P0RTN                                             MD055203
     C           XMTCAS    IFEQ ' '                                                         MD055203
     C           WOPTN     ANDEQ'2'                                                         MD055203
     C                     MOVE 'NODET'   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055303
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0123ECP3                                           S01408
     C*                                                                   S01408
     C                     MOVELP0RTN     HFLAG   1                                           263647
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN MIMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUFKST  1
      * Define work field Date Format flag
     C                     MOVEL*BLANK    WUDTFF  1
      * Define work field Date (numeric format)
     C                     Z-ADD*ZERO     WUDTNF  60
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUDDCD  7
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Currency Name
     C                     MOVEL*BLANK    WUCYNM 14
      * Define work field Number of Decimal Places
     C                     Z-ADD*ZERO     WUNBDP  10
      * Define work field Nostro Shortname
     C                     MOVEL*BLANK    WUNOSN 10
      * Define work field Retail Ac Referral Cond.
     C                     MOVEL*BLANK    WURARC 10
      * Define work field GL Description Ind.
     C                     MOVEL*BLANK    WUGLDI  1
      * Define work field Customer Number     MIDAS
     C                     MOVEL*BLANK    WUCNUM  6
      * Define work field Currency code       MIDAS
     C                     MOVEL*BLANK    WUCCY   3
      * Define work field Account code        MIDAS
     C**********           MOVEL*BLANK    WUACOD  4                                           CGL029
     C                     MOVEL*BLANK    WUACOD 10                                           CGL029
      * Define work field Account sequence numMIDAS
     C                     MOVEL*BLANK    WUACSQ  2
      * Define work field Branch code
     C                     MOVEL*BLANK    WUBRCD  3
      * Define work field Account type        MIDAS
     C                     MOVEL*BLANK    WUATYP  1
      * Define work field Account subtype     MIDAS
     C                     MOVEL*BLANK    WUSTYP  1
      * Define work field Account Status      MIDAS
     C                     MOVEL*BLANK    WUASTT  1
      * Define work field Date account opened
     C                     Z-ADD*ZERO     WUDACO  50
      * Define work field Account name
     C                     MOVEL*BLANK    WUACNM 20
      * Define work field Retail account numbeMIDAS
     C                     Z-ADD*ZERO     WURTAC 100
      * Define work field Retail Indicators   MIDAS
     C                     MOVEL*BLANK    WURETB  1
      * Define work field Relative rec no of memos
     C                     Z-ADD*ZERO     WURRNM  50
      * Define work field Display Account
     C                     MOVEL*BLANK    WUDSAC  1
      * Define work field Customer Report Name
     C                     MOVEL*BLANK    WUCRNM 20
      * Define work field Display Customer
     C                     MOVEL*BLANK    WUDCUS  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field Multibranching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Display no of items
     C                     MOVEL*BLANK    WUDNIT  1
      * Define work field Midas Rundate
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Runday Number
     C                     Z-ADD*ZERO     WURDNO  50
      * Define work field Setup Complete
     C                     MOVEL*BLANK    WUSUCP  1
      * Define work field General Ledger
     C                     MOVEL*BLANK    WUGNLG 10
      * Define work field Account code
     C**********           MOVEL*BLANK    WUACCD  4                                           CGL029
     C                     MOVEL*BLANK    WUACCD 10                                           CGL029
      * Define work field Profit & Loss Accnt Code
     C**********           MOVEL*BLANK    WUPLAC  4                                           CGL029
     C                     MOVEL*BLANK    WUPLAC 10                                           CGL029
      * Define work field Customer number
     C                     MOVEL*BLANK    WUCUST  6
      * Define work field Base Currency Transfer Fq
     C                     MOVEL*BLANK    WUBCTF  1
      * Define work field Accrual Key Summary Ind.
     C                     MOVEL*BLANK    WUAKSI  1
      * Define work field Accruals/Profit Date
     C                     Z-ADD*ZERO     WUAPDT  50
      * Define work field Accruals/Profit Frequency
     C                     MOVEL*BLANK    WUAPFQ  1
      * Define work field Accruals/Profit Fq. Day
     C                     Z-ADD*ZERO     WUAPFD  20
      * Define work field Accrue on Last Day Ind.
     C                     MOVEL*BLANK    WUALDI  1
      * Define work field A/c Posting Retention Pd
     C                     Z-ADD*ZERO     WUAPRP  20
      * Define work field Accrual Non-Wk Day Ind
     C                     MOVEL*BLANK    WUANWD  1
      * Define work field Spot Rates Retention Pd
     C                     Z-ADD*ZERO     WUSRRP  20
      * Define work field Base Rates Retention Pd
     C                     Z-ADD*ZERO     WUBRRP  20
      * Define work field Profit Centres Used
     C                     MOVEL*BLANK    WUPRCU  1
      * Define work field Profit Centres Amendable
     C                     MOVEL*BLANK    WUPRCA  1
      * Define work field Profit Centre Def'ts Used
     C                     MOVEL*BLANK    WUPCDU  1
      * Define work field Prof C Def Matrix-Book
     C                     MOVEL*BLANK    WUPMBK  1
      * Define work field Prof C Def Matrix-T Type
     C                     MOVEL*BLANK    WUPMTT  1
      * Define work field Prof C Def Matrix-S Type
     C                     MOVEL*BLANK    WUPMST  1
      * Define work field Prof C Def Matrix-Branch
     C                     MOVEL*BLANK    WUPMBH  1
      * Define work field Prof C Def Matrix-Dept
     C                     MOVEL*BLANK    WUPMDT  1
      * Define work field Prof C Def Matrix-User
     C                     MOVEL*BLANK    WUPMUR  1
      * Define work field Prof C Def Matrix-A/c Off
     C                     MOVEL*BLANK    WUPMAO  1
      * Define work field Prof C Def Matrix-Cust
     C                     MOVEL*BLANK    WUPMCU  1
      * Define work field Originating Branch Used
     C                     MOVEL*BLANK    WUOBRU  1
      * Define work field Orig Branch User/Vald Req
     C                     MOVEL*BLANK    WUOBUV  1
      * Define work field JE Special Character
     C                     MOVEL*BLANK    WUJESP  1
      * Define work field JE Int-Bch Ents @ Bch/Itm
     C                     MOVEL*BLANK    WUIEBI  1
      * Define work field Main Branch
     C                     MOVEL*BLANK    WUMABR  3
      * Define work field Int-Bch Ent Via Main Brch
     C                     MOVEL*BLANK    WUIEMB  1
      * Define work field End of Last Activity Per.
     C                     Z-ADD*ZERO     WUELAP  50
      * Define work field End of Current Act Period
     C                     Z-ADD*ZERO     WUECAP  50
      * Define work field Midas/Telex Module Ind.
     C                     MOVEL*BLANK    WUMTMI  1
      * Define work field SWIFT Funds Transfer
     C                     MOVEL*BLANK    WUSWFT  1
      * Define work field SWIFT Securities Trading
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field SWIFT Customer Lending
     C                     MOVEL*BLANK    WUSWCL  1
      * Define work field SWIFT Syndicated Loans
     C                     MOVEL*BLANK    WUSWSL  1
      * Define work field SWIFT Statements
     C                     MOVEL*BLANK    WUSWSM  1
      * Define work field SWIFT Dealing
     C                     MOVEL*BLANK    WUSWDL  1
      * Define work field Standing data/Gen.Ledger
     C                     MOVEL*BLANK    WUSDGL  1
      * Define work field Dealing: FX
     C                     MOVEL*BLANK    WUDLFX  1
      * Define work field Syndicated Loans
     C                     MOVEL*BLANK    WUSYLN  1
      * Define work field Exposure Management
     C                     MOVEL*BLANK    WUEXMG  1
      * Define work field Financial Modeller
     C                     MOVEL*BLANK    WUFNMO  1
      * Define work field Statutary Returns
     C                     MOVEL*BLANK    WUSTRT  1
      * Define work field Customer Lending
     C                     MOVEL*BLANK    WUCSLN  1
      * Define work field Retail Banking
     C                     MOVEL*BLANK    WURTBN  1
      * Define work field Midas/Swift direct link
     C                     MOVEL*BLANK    WUMSDL  1
      * Define work field Securities
     C                     MOVEL*BLANK    WUSECS  1
      * Define work field Auto-reconciliations
     C                     MOVEL*BLANK    WUAURC  1
      * Define work field Bond Dealers Interface
     C                     MOVEL*BLANK    WUBDLI  1
      * Define work field DRS Standing Data
     C                     MOVEL*BLANK    WUDRSD  1
      * Define work field DRS Control module
     C                     MOVEL*BLANK    WUDRCM  1
      * Define work field DRS Foreign Exchange
     C                     MOVEL*BLANK    WUDRFE  1
      * Define work field DRS Money Market
     C                     MOVEL*BLANK    WUDRMM  1
      * Define work field DRS Arbitrage
     C                     MOVEL*BLANK    WUDRAR  1
      * Define work field Funds Transfer
     C                     MOVEL*BLANK    WUFDTR  1
      * Define work field DRS Common Applications
     C                     MOVEL*BLANK    WUDRCA  1
      * Define work field Futures & Options
     C                     MOVEL*BLANK    WUFUOP  1
      * Define work field Midas/Telex Synd. Loans
     C                     MOVEL*BLANK    WUMTSL  1
      * Define work field Midas/Telex Dealing
     C                     MOVEL*BLANK    WUMTDL  1
      * Define work field Midas/Telex Gen. Ledger
     C                     MOVEL*BLANK    WUMTGL  1
      * Define work field Midas/Telex Cust. Lending
     C                     MOVEL*BLANK    WUMTCL  1
      * Define work field Network Midas
     C                     MOVEL*BLANK    WUNWMI  1
      * Define work field FRA/IRS Indicator
     C                     MOVEL*BLANK    WUFIIN  1
      * Define work field Dealing: MM
     C                     MOVEL*BLANK    WUDLMM  1
      * Define work field Internal Contracts
     C                     MOVEL*BLANK    WUINCN  1
      * Define work field Treasury Management
     C                     MOVEL*BLANK    WUTRMG  1
      * Define work field Risk Management
     C                     MOVEL*BLANK    WURKMG  1
      * Define work field Testkey
     C                     MOVEL*BLANK    WUTSKY  1
      * Define work field Midas/Q
     C                     MOVEL*BLANK    WUMIDQ  1
      * Define work field Microfiche
     C                     MOVEL*BLANK    WUMFIC  1
      * Define work field Interest on accounts
     C                     MOVEL*BLANK    WUIOAC  1
      * Define work field SAR's processing required
     C                     MOVEL*BLANK    WUSARP  1
      * Define work field French  return indicator
     C                     MOVEL*BLANK    WUFRIN  1
      * Define work field Lux     return indicator
     C                     MOVEL*BLANK    WULRIN  1
      * Define work field Dutch   return indicator
     C                     MOVEL*BLANK    WUDRIN  1
      * Define work field German  return indicator
     C                     MOVEL*BLANK    WUGRIN  1
      * Define work field Belgian return indicator
     C                     MOVEL*BLANK    WUBRIN  1
      * Define work field Italian return indicator
     C                     MOVEL*BLANK    WUIRIN  1
      * Define work field Swift External Interface
     C                     MOVEL*BLANK    WUSWEI  1
      * Define work field Portfolio Management
     C                     MOVEL*BLANK    WUPFMG  1
      * Define work field Credit Management.
     C                     MOVEL*BLANK    WUCRMG  1
      * Define work field Head Office Reporting
     C                     MOVEL*BLANK    WUHORP  1
      * Define work field Average Balances
     C                     MOVEL*BLANK    WUAVBL  1
      * Define work field Margins
     C                     MOVEL*BLANK    WUMARG  1
      * Define work field Taxes
     C                     MOVEL*BLANK    WUNTST  1
      * Define work field Retail 3
     C                     MOVEL*BLANK    WUNXST  1
      * Define work field Interest on Accounts 3
     C                     MOVEL*BLANK    WUNYST  1
      * Define work field Charge for Mult Transacts
     C                     MOVEL*BLANK    WUCHMT  1
     C                     MOVE *LOVAL    URNORM  1        ¦ Highlight 0
     C                     BITON'2'       URNORM           ¦ NORMAL
      *
     C                     MOVE *LOVAL    URRIHS  1        ¦ Highlight 1
     C                     BITON'27'      URRIHS           ¦ RI/STEADY
      *
     C                     MOVE *LOVAL    URRIHF  1        ¦ Highlight 2
     C                     BITON'2467'    URRIHF           ¦ RI/HI/BLINK
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialise program
      * Standard RPG Creation Par - Standard functions  *
      * Last Amend Box - GL0123E - Journal Entry Posting  *
      * Window Processing Hdr Box - Standard functions  *
      * Access Midas rundate - Standard functions  *
     C*   Access MIDAS Rundate from data-area RUNDAT
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT
     C                     MOVE RDNO      WURDNO
     C                     MOVE SUCP      WUSUCP
     C                     MOVE DTFF      WUDTFF
     C                     MOVE MBIN      WUMBIN
      * Copyright notice - Standard functions  *
      * Define 200 Byte Dummy DS - Standard functions  *
      * Define 800 Byte Dummy DS - Standard functions  *
      * Currency Codes DS - Currency Codes  *
      * General Ledger Details DS - General Ledger Details  *
      * MIDAS Modules DS - MIDAS Modules  *
      * Account Details DS - Standard functions  *
      * Client Details DS - Client Details  *
      * Start of Fix SAR017
      * Access General Ledger. - General Ledger Details  *
     C*
     C*  Access General Ledger Details file for it' file fields
     C*
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*FIRST'  UUAPOP  7        I:Option
     C********** D@GELR    PARM *BLANK    UUFDY            O:Format                           CGL029
     C           D@GELR    PARM *BLANK    UUSDY                                               CGL029
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELBKGNLG    WUGNLG           General Ledger
     C                     MOVELBKACCD    WUACCD           Account Code
     C                     MOVELBKPLAC    WUPLAC           Profit & Loss Account
     C                     MOVELBKCUST    WUCUST           Cutomer Number
     C                     MOVELBKBCTF    WUBCTF           Base Currency Tran
     C                     MOVELBKAKSI    WUAKSI           Accrual Key summary
     C                     MOVELBKAPDT    WUAPDT           Accruals Profit Date
     C                     MOVELBKAPFQ    WUAPFQ           Accruals Profit Freq
     C                     MOVELBKAPFD    WUAPFD           Accruals Profit Fr Dy
     C                     MOVELBKALDI    WUALDI           Accrue on Last Day
     C                     MOVELBKAPRP    WUAPRP           A/c Posting Ret Pd.
     C                     MOVELBKANWD    WUANWD           Accrual non-wk Day
     C                     MOVELBKSRRP    WUSRRP           Spot Rates Retention
     C                     MOVELBKBRRP    WUBRRP           Base Rates Retention
     C                     MOVELBKGLDI    WUGLDI           GL Description Ind
     C                     MOVELBKPRCU    WUPRCU           Profit Centres Used
     C                     MOVELBKPRCA    WUPRCA           Profit Centres Amend
     C                     MOVELBKPCDU    WUPCDU           Profit Centre Default
     C                     MOVELBKPMBK    WUPMBK           Prof C Matrix Book
     C                     MOVELBKPMTT    WUPMTT           Prof C Matrix Trans
     C                     MOVELBKPMST    WUPMST           Prof C Matrix SubType
     C                     MOVELBKPMBH    WUPMBH           Prof C Matrix Branch
     C                     MOVELBKPMDT    WUPMDT           Prof C Matrix Dept
     C                     MOVELBKPMUR    WUPMUR           Prof C Matrix User
     C                     MOVELBKPMAO    WUPMAO           Prof C Matrix Acc Off
     C                     MOVELBKPMCU    WUPMCU           Prof C Matrix Cust
     C                     MOVELBKOBRU    WUOBRU           Originating Branch Ud
     C                     MOVELBKOBUV    WUOBUV           Orig Branch/User Vald
     C                     MOVELBKJESP    WUJESP           Copy Special Char
     C                     MOVELBKELAP    WUELAP           End of Last Activity
     C                     MOVELBKECAP    WUECAP           End of Curnt Activity
      * End of Fix SAR017
     C                     MOVEL'Y'       WUFKST           S01212
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * Access MIDAS Modules. - MIDAS Modules  *
     C*
     C*  Access Midas Modules file for the file fields
     C*
     C                     CALL 'AOMMODR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd
     C                     PARM '*FIRST'  UUAPOP  7        I:Option
     C           D@MMOD    PARM *BLANK    UUFDY            O:Format
     C*
     C* Assign work field to file field values.
     C*
     C                     MOVELBGMTMI    WUMTMI           Midas/Telex Module in
     C                     MOVELBGSWFT    WUSWFT           SWIFT Funds Transfer
     C                     MOVELBGSWST    WUSWST           SWIFT Securities Trad
     C                     MOVELBGSWCL    WUSWCL           SWIFT Customer Lend
     C                     MOVELBGSWSL    WUSWSL           SWIFT Syndicated Loan
     C                     MOVELBGSWSM    WUSWSM           SWIFT Statements
     C                     MOVELBGSWDL    WUSWDL           SWIFT Dealing
     C                     MOVELBGSDGL    WUSDGL           Standing Data/Gen Leg
     C                     MOVELBGDLFX    WUDLFX           Dealing : FX
     C                     MOVELBGSYLN    WUSYLN           Syndicated Loans
     C                     MOVELBGEXMG    WUEXMG           Exposure Management
     C                     MOVELBGFNMO    WUFNMO           Financial Modeller
     C                     MOVELBGSTRT    WUSTRT           Statuatory Returns
     C                     MOVELBGCSLN    WUCSLN           Customer Lending
     C                     MOVELBGRTBN    WURTBN           Retail Banking
     C                     MOVELBGMSDL    WUMSDL           Midas/SWIFT Direct lk
     C                     MOVELBGSECS    WUSECS           Securities
     C                     MOVELBGAURC    WUAURC           Auto-Reconcilliations
     C                     MOVELBGBDLI    WUBDLI           Bond Dealers Interfce
     C                     MOVELBGDRSD    WUDRSD           DRS Standing Data
     C                     MOVELBGDRCM    WUDRCM           DRS Control Module
     C                     MOVELBGDRFE    WUDRFE           DRS Foreign Exchange
     C                     MOVELBGDRMM    WUDRMM           DRS Money Markets
     C                     MOVELBGDRAR    WUDRAR           DRS Arbitrage
     C                     MOVELBGFDTR    WUFDTR           Funds Transfer
     C                     MOVELBGDRCA    WUDRCA           DRS Common Applic's
     C                     MOVELBGFUOP    WUFUOP           Futures & Options
     C                     MOVELBGMTSL    WUMTSL           Midas/Telex Syn Loans
     C                     MOVELBGMTDL    WUMTDL           Midas/Telex Dealing
     C                     MOVELBGMTGL    WUMTGL           Midas/Telex Gen Ledg
     C                     MOVELBGMTCL    WUMTCL           Midas/Telex Cust Len
     C                     MOVELBGNWMI    WUNWMI           Network Midas
     C                     MOVELBGFIIN    WUFIIN           FRA/IRS Indicator
     C                     MOVELBGDLMM    WUDLMM           Dealing:Money Markets
     C                     MOVELBGINCN    WUINCN           Internal Contracts
     C                     MOVELBGTRMG    WUTRMG           Treasury Management
     C                     MOVELBGRKMG    WURKMG           Risk Management
     C                     MOVELBGTSKY    WUTSKY           TestKey
     C                     MOVELBGMIDQ    WUMIDQ           Midas Q
     C                     MOVELBGMFIC    WUMFIC           Microfiche
     C                     MOVELBGIOAC    WUIOAC           Interest on Accounts
     C                     MOVELBGWDPR    WUWDPR           Window Processing Req
     C                     MOVELBGSARP    WUSARP           SAR's Processing Req
     C                     MOVELBGFRIN    WUFRIN           French Return Ind
     C                     MOVELBGLRIN    WULRIN           Lux Return Ind
     C                     MOVELBGDRIN    WUDRIN           Dutch Return Ind
     C                     MOVELBGGRIN    WUGRIN           German Return Ind
     C                     MOVELBGBRIN    WUBRIN           Belgian Return Ind
     C                     MOVELBGIRIN    WUIRIN           Italian Return Ind
     C                     MOVELBGSWEI    WUSWEI           SWIFT External Intfce
     C                     MOVELBGPFMG    WUPFMG           Portfolio Management
     C                     MOVELBGCRMG    WUCRMG           Credit Management
     C                     MOVELBGHORP    WUHORP           H.O. Reporting
     C                     MOVELBGAVBL    WUAVBL           Average Balances
     C                     MOVELBGMARG    WUMARG           Margins
     C                     MOVELBGNTST    WUNTST           Taxes          S01413
     C                     MOVELBGNXST    WUNXST           Retail 3       S01413
     C                     MOVELBGNYST    WUNYST           Int on A/C 3   S01413
     C*
      * DS for GL0123E - Journal Entry Posting  *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * start S01413
     C                     MOVEL'N'       WUDNIT           Display no of i
      * CASE: WRK.Retail 3 is Yes
     C           WUNXST    IFEQ 'Y'                        *IF
      * Get Chrg for mult trans - Standard functions  *
     C                     CALL 'SD9343'               90  Get Chrg for mu
     C           W0RTN     PARM W0RTN     WQ0006  7        *Return code
     C           WUCHMT    PARM *BLANK    WQ0007  1        Charge for Mult
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Charge for Mult Transacts is Yes
     C           WUCHMT    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDNIT           Display no of i
     C                     END                             *FI
     C                     END                             *FI
      * end S01413
      * CASE: WRK.S01212 is Fix Installed
     C           WUFKST    IFEQ 'Y'                        *IF
      * 00/Copy Member GL0123EIPG - Journal Entry Posting  *
     C/COPY WNCPYSRC,GL0123ECPG
     C                     END                             *FI
     C*                                                                   CEU013
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  WSARD   6                       CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     MOVE *OFF      *IN66            Display controlCEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     MOVE *ON       *IN66                           CEU013
     C                     ENDIF                                          CEU013
      *                                                                                       CGL013
      ** Access SAR details file to see if CGL013 is installed.                               CGL013
      *                                                                                       CGL013
     C           *NAMVAR   DEFN           LDA                                                 CGL013
     C                     CALL 'AOSARDR0'                                                    CGL013
     C                     PARM *BLANKS   PRTCD   7                                           CGL013
     C                     PARM '*VERIFY' POPTN   7                                           CGL013
     C                     PARM 'CGL013'  PSARD   6                                           CGL013
     C           SCSARD    PARM SCSARD    UUFDY                                               CGL013
      *                                                                                       CGL013
     C           PRTCD     IFNE *BLANKS                                                       CGL013
     C           PRTCD     ANDNE'*NRF    '                                                    CGL013
     C           *LOCK     IN   LDA                                                           CGL013
     C                     MOVE 'SCSARDPD'DBFILE                                              CGL013
     C                     MOVEL'001'     DBASE                                               CGL013
     C                     MOVEL'CGL013'  DBKEY                                               CGL013
     C                     OUT  LDA                                                           CGL013
     C                     EXSR *PSSR                                                         CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           PRTCD     IFEQ *BLANK                                                        CGL013
     C/COPY WNCPYSRC,EML102_029                                                               EML102
     C                     MOVE 'Y'       CGL013  1                                           CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE 'N'       CGL013                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     CALL 'AOSARDR0'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD   7                                         BUG23742
     C                     PARM '*VERIFY' POPTN   7                                         BUG23742
     C                     PARM 'CER030'  PSARD   6                                         BUG23742
     C           SCSARD    PARM SCSARD    UUFDY                                             BUG23742
      *                                                                                     BUG23742
     C           PRTCD     IFNE *BLANKS                                                     BUG23742
     C           PRTCD     ANDNE'*NRF    '                                                  BUG23742
     C           *LOCK     IN   LDA                                                         BUG23742
     C                     MOVE 'SCSARDPD'DBFILE                                            BUG23742
     C                     MOVEL'002'     DBASE                                             BUG23742
     C                     MOVEL'CER030'  DBKEY                                             BUG23742
     C                     OUT  LDA                                                         BUG23742
     C                     EXSR *PSSR                                                       BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           PRTCD     IFEQ *BLANK                                                      BUG23742
     C                     MOVE 'Y'       CER030  1                                         BUG23742
     C                     ELSE                                                             BUG23742
     C                     MOVE 'N'       CER030                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C/COPY WNCPYSRC,GL0123EC04
     C*                                                                   CEU013
      *================================================================
     CSR         ZZEXIT    ENDSR
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * SRADIN - Subroutine to Process Additional Information Field   *                       CGL013
      *                                                               *                       CGL013
      * Called by:                                                    *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           SRADIN    BEGSR                                                              CGL013
      *                                                                                       CGL013
     C                     MOVE 'Y'       WERROR                                              CGL013
     C           WERROR    DOUEQ'N'                                                           CGL013
     C           *INKC     OREQ *ON                                                           CGL013
      *                                                                                       CGL013
     C           #1ADIN    IFEQ *BLANK                                                        CGL013
     C                     MOVE 'N'       #1ADIN                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           #1ADIN    IFNE 'Y'                                                           CGL013
     C           #1ADIN    ANDNE'N'                                                           CGL013
     C                     MOVE 'Y'       WERROR  1                                           CGL013
     C                     MOVE *ON       *IN31                                               CGL013
     C                     MOVE *ON       *IN32                                               CGL013
     C                     MOVEL'USR0912' ZAMSID                                              CGL013
     C                     EXSR ZASNMS                                                        CGL013
     C                     EXSR CBEXFM                                                        CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE 'N'       WERROR                                              CGL013
     C                     MOVE *OFF      *IN32                                               CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           PREV      TAG                                                              BUG23742
      *                                                                                     BUG23742
     C           #1ADIN    IFEQ 'Y'                                                           CGL013
     C           WOPTN     OREQ '2'                                                         BUG26687
     C                     MOVEL#1BTNB    PABTNB                                              CGL013
     C                     MOVEL#1BINB    PABINB                                              CGL013
     C                     MOVEL#1RACN    PARACN                                              CGL013
     C                     MOVELWUDTNF    PAVLDT                                              CGL013
     C           XMTCAS    IFEQ 'N'                                                         BUG26687
     C                     CALL 'GL000185'                                                    CGL013
     C                     PARM *BLANKS   PRTCD                                               CGL013
     C                     PARM           PDETLS                                              CGL013
     C                     PARM *BLANK    PADD    1                                           CGL013
     C                     PARM 'E'       PMODE   1                                           CGL013
     C                     PARM '0'       PEXIT1  1                                         BUG23742
     C                     PARM '0'       PCANC1  1                                         BUG23742
     C                     PARM           PVBIPX                                              246418
     C                     PARM 'N'       APIMOD  1                                           246418
     C                     PARM           FLDNMA                                              246418
     C                     PARM           MSGIDA                                              246418
     C                     PARM           MSGDTA                                              246418
      *                                                                                       CGL013
     C           PCANC1    IFEQ '1'                                                         BUG26687
     C           WOPTN     ANDEQ'2'                                                         BUG26687
     C           XMTCAS    IFNE ' '                                                         MD055203
     C                     MOVE *BLANKS   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055303
     C                     EXSR ZYEXPG                                                      BUG26687
     C                     ENDIF                                                            BUG26687
      *                                                                                     BUG26687
     C           PCANC1    IFEQ '1'                                                         BUG23742
     C                     MOVE 'N'       #1ADIN                                            BUG23742
     C           XMTCAS    IFNE ' '                                                         MD055203
     C                     MOVE *BLANKS   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055303
     C                     GOTO SREXIT                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           PEXIT1    IFEQ '1'                                                         BUG23742
     C           XMTCAS    IFNE ' '                                                         MD055203
     C                     MOVE *BLANKS   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055303
     C                     EXSR ZYEXPG                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG26687
     C**********           MOVE 'N'       #1ADIN                                     CGL013 BUG23742
     C                     MOVE *ON       *IN31                                               CGL013
      *                                                                                     BUG23742
     C           CER030    IFEQ 'Y'                                                         BUG23742
     C           XMTCAS    ANDEQ'Y'                                                         BUG26687
      *                                                                                     BUG23742
     C                     MOVELBTPTDT    PDATE                                             BUG23742
      *                                                                                     BUG23742
     C                     CALL 'GL000186'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD                                             BUG23742
     C                     PARM           PDETLS                                            BUG23742
     C                     PARM           PDATE   50                                        BUG23742
     C                     PARM *BLANKS   PADD    1                                         BUG23742
     C                     PARM 'E'       PMODE   1                                         BUG23742
     C                     PARM '0'       PEXIT   1                                         BUG23742
     C                     PARM '0'       PCANC   1                                         BUG23742
     C                     PARM           FLDNMA                                            BUG23742
     C                     PARM           MSGIDA                                            BUG23742
     C                     PARM           MSGDTA                                            BUG23742
      *                                                                                     BUG23742
     C                     SETON                     41                                     BUG23742
      *                                                                                     BUG23742
     C           PCANC     IFEQ '1'                                                         BUG26687
     C           WOPTN     ANDEQ'2'                                                         BUG26687
     C           XMTCAS    IFNE ' '                                                         MD055203
     C                     MOVE *BLANKS   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055203
     C                     EXSR ZYEXPG                                                      BUG26687
     C                     ENDIF                                                            BUG26687
      *                                                                                     BUG26687
     C           PCANC     IFEQ '1'                                                         BUG23742
      *                                                                                     BUG23742
     C           CGL013    IFEQ 'Y'                                                         BUG23742
     C**********           GOTO PREV                                               BUG23742 BUG26687
     C                     MOVE 'N'       #1ADIN                                            BUG26687
     C           XMTCAS    IFNE ' '                                                         MD055203
     C                     MOVE *BLANKS   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055303
     C                     GOTO SREXIT                                                      BUG26687
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C           PEXIT     IFEQ '1'                                                         BUG23742
     C           XMTCAS    IFNE ' '                                                         MD055203
     C                     MOVE *BLANKS   P0RTN                                             MD055203
     C                     ENDIF                                                            MD055303
     C                     EXSR ZYEXPG                                                      BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     ENDDO                                                              CGL013
      *                                                                                       CGL013
     C**********           ENDSR                                                     CGL013 BUG23742
     C           SREXIT    ENDSR                                                            BUG23742
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * *PSSR  - Program exception error routine                      *                       CGL013
      *          Called automatically if a program error occurs,      *                       CGL013
      *          or directly by the program code using EXSR.          *                       CGL013
      *          This subroutine DUMPs the program just once.         *                       CGL013
      *                                                               *                       CGL013
      * Called by: ZZINIT                                             *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           *PSSR     BEGSR                                                              CGL013
      *                                                                                       CGL013
     C           @RUN      IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       @RUN    1                                           CGL013
     C                     DUMP                                                               CGL013
     C                     CALL 'DBERRCTL'                                                    CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     MOVE *ON       *INU7                                               CGL013
     C                     MOVE *ON       *INU8                                               CGL013
     C                     MOVE *ON       *INLR                                               CGL013
     C                     RETRN                                                              CGL013
      *                                                                                       CGL013
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
     O/COPY WNCPYSRC,GL0123EOPG
** Item Error Message
Err:
----------------------------------------------------------------------------
**  Item Error Line
----------------------------------------------------------------------------
** CPY@
(c) Finastra International Limited 2001
