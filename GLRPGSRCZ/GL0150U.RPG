     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Load I/face Postings to JE')                  *
      *****************************************************************
      *                                                               *
      *  Midas - General Ledger Module                                *
      *                                                               *
      *   GL0150U - Create Journal Postings From Interface File       *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD044271           Date 20Mar17               *
      *  Prev Amend No. CGL154             Date 13Oct14               *
      *                 MD040755           Date 23Aug16               *
      *                 MD040602           Date 19Aug16               *
      *                 MD040884           Date 09Sep16               *
      *                 MD032207           Date 10Jun15               *
      *                 MD025865A          Date 27Mar14               *
      *                 MD025865           Date 20Mar14               *
      *                 AR1093096          Date 30Sep13               *
      *                 AR792734A          Date 20Sep11               *
      *                 AR862752           Date 10Nov11               *
      *                 AR833906           Date 26Sep11               *
      *                 AR787620           Date 10Jun11               *
      *                 CAP207             Date 10Feb11               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26840           Date 11Dec09               *
      *                 BUG26643           Date 03Nov09               *
      *                 BUG26405A          Date 20Oct09               *
      *                 BUG26405           Date 13Oct09               *
      *                 BUG25438           Date 17Aug09               *
      *                 BUG25476           Date 13Aug09               *
      *                 BUG25186E          Date 10Aug09               *
      *                 BUG25186D          Date 08Aug09               *
      *                 BUG25186C          Date 06Aug09               *
      *                 BUG25186B          Date 31Jul09               *
      *                 BUG25186A          Date 28Jul09               *
      *                 BUG25186           Date 28Jul09               *
      *                 BUG25185           Date 27Jul09               *
      *                 BUG24716           Date 17Jul09               *
      *                 BUG23742           Date 09May09               *
      *                 BUG23669           Date 27Mar09               *
      *                 BUG23526           Date 23Mar09               *
      *                 BUG23477           Date 19Mar09               *
      *                 BUG23404           Date 16Mar09               *
      *                 BUG23217           Date 06Mar09               *
      *                 CER046             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2453            Date 20May04               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL013             Date 29Mar02               *
      *                 CGL016             Date 01Aug02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CPK015             Date 28Jun02               *
      *                 191368             Date 06Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU013             Date 09Mar98               *
      *                 200652             Date 23Feb98               *
      *                 S01408             Date 18OCT95               *
      *                 S01408             Date 12JAN95               *
      *                 S01340             Date 21FEB92               *
      *                 S01199             Date 02MAY90               *
      *                 S01251             Date 03FEB90               *
      *                 S01234   *CREATE   Date 20NOV89               *
      *                                                               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  CGL154 - FATCA Reporting (Recompile)                         *
      *  MD040755 - Set error flag before returning if one of the     *
      *             batch detail encountered errors.                  *
      *  MD040602 - Set error flag if a full account is not found in  *
      *             ACCNTAB. Only use retail number if full account   *
      *             is not complete.                                  *
      *  MD040884 - SWITI Batch Interface with refer all debits or    *
      *             credits postings become HELD Status - expected    *
      *             is ACCEPT status like in R4                       *
      *           - Adapt fix 121230 from GLF0140.                    *
      *  MD032207 - Valid status of a Journal Interface Batch will    *
      *             show as invalid when a previous record is also    *
      *             invalid. Initialized the value of the Error flag. *
      *  MD025865A - Transactions generated are on 'HELD' status and  *
      *              encounter errors.                                *
      *            - Incorrect validation for a multibranch transac-  *
      *              tion.                                            *
      *  MD025865 - Transactions generated are on 'HELD' status and   *
      *             encounter errors.                                 *
      *           - Records for extension file GLJENHQD and GLJENPQD  *
      *             are not created.                                  *
      *  AR1093096 - ABC - Reservations not removed for JRNE.         *
      *              (Child: AR1093097) (Recompile)                   *
      *  AR792734A - Projected Account movement show incorrect        *
      *              Available Balance when posting Cash Deposit.     *
      *              Used CGL016 codes to insert shadow postings      *
      *              when CRE023 is turned on (Child: AR792735A)      *
      *  AR862752 - If Retail or Nostro, retrieve the values before   *
      *             the validation (Child: AR862753)                  *
      *  AR833906 - Batch Interface GLC001601: Extended narratives    *
      *             are not sent to BFM (Child: AR833907)             *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,GLH00191                                 *
      *             WNCPYSRC,GLH00192                                 *
      *             WNCPYSRC,GLH00193                                 *
      *             WNCPYSRC,GLH00194                                 *
      *             WNCPYSRC,GLH00195                                 *
      *             WNCPYSRC,GLH00196                                 *
      *             WNCPYSRC,GLH00197                                 *
      *             WNCPYSRC,GLH00198                                 *
      *             WNCPYSRC,GLH00199                                 *
      *             WNCPYSRC,GLH00200                                 *
      *             WNCPYSRC,GLH00201                                 *
      *  CAP207 - Account Balance Check extended to other APIs        *
      *           (Recompile)                                         *
      *  CRE075 - Effective Date for Retail Accounts                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26840 - 22x35 EN is not in the advice                     *
      *  BUG26643 - A batch sent from SWITI interface failed          *
      *             validation for no apparent reason                 *
      *  BUG26405A - SWITI batch generation error                     *
      *  BUG26405 - SWITI batch generation in M+ batch header total   *
      *             incorrect.                                        *
      *  BUG25438 - Batch was accepted when 2 EN tabs are filled out  *
      *  BUG25476 - MT940 rejected by MMM                             *
      *  BUG25186E - MEJI error when input data is correct            *
      *  BUG25186D - Account error                                    *
      *  BUG25186C - Account error : DDACID not cleared               *
      *  BUG25186B - Validation of Transaction Type for non-Retail    *
      *  BUG25186A - Update of source incomplete                      *
      *  BUG25186 - Journal Batches interface report shows that       *
      *             Batch is in error but there seems no              *
      *             reason for this and batch is brought into Midas   *
      *  BUG25185 - Incorrect calculation of no. of items             *
      *  BUG24716 - Insert Errors                                     *
      *  BUG23742 - Improper handling of Ext Narr from Batch          *
      *             Interface Input                                   *
      *  BUG23669 - Various errors in batch processing                *
      *  BUG23526 - Batch failed even if data is correct              *
      *  BUG23477 - Batch failed due to 'Error in Overrides'          *
      *  BUG23404 - Incorrect validation in Batch details             *
      *  BUG23217 - Detail Reports were not processed                 *
      *  CER046 - German Features LF033-00 Payments & Clearing        *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2453 - Initialise NITM to 1 if 0 from interface file.     *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL013 - MT94x Message Generation                            *
      *  CGL016 - Projected Movements Update Prior to Authorisation   *
      *  CPK015 - Release 4.01 Packaging:                             *
      *           - A default timestamp string is required for WRITE. *
      *  191368 - Do not change value date if the account is not a    *
      *            retail account.                                    *
      *  CEU013 - EMU Account Postings Narrative - Recompile only.    *
      *   120652 - Assign appropriate values to batch items fields    *
      *            upon loading to GLJENPPD.  Used fix 111382         *
      *   S01408 - ADDITION OF CORE HOOK GL0150UIP1                   *
      *   S01408 - ADDITION OF CORE HOOK GL0150UFPG                   *
      *            ADDITION OF CORE HOOK GL0150UCAU                   *
      *            ADDITION OF CORE HOOK GL0150UCPG                   *
      *   S01340 - RECOMPILED FOR MIS RELEASE 10                      *
      *   S01199 - RECOMPILED FOR CURSOR SENSITIVE HELP               *
      *   S01234 - BATCH NUMBER & TEMPLATE BATCH NUMBER USED AS       *
      *            CHARACTER                                          *
      *   S01251 - SYNON FIELD/PROGRAM CHANGES                        *
      *   S01234 - GL TEMPLATE ENHANCEMENTS                           *
      *                                                               *
      *****************************************************************
     F************GLBPIFL1IF  E           K        DISK
     F/COPY WNCPYSRC,GL0150UF02
     FGLJEIPL1IF  E           K        DISK
     F/COPY WNCPYSRC,GL0150UF03
      * RTV: GL Batch Posting Interface File  Retrieval index
      *
     F************GLBTREL0O   E           K        DISK               A
     FACCNT   IF  E           K        DISK                               120652
     F            ACCNTAAF                          KIGNORE               120652
     F            ACCNTACF                          KIGNORE               120652
      * RTV: GL Accounts master File  Retrieval index                     120652
      *                                                                   120652
     FACNUM   IF  E           K        DISK                               120652
     F            ACCNTABF                          KRENAMEACNUMABF       120652
      * RTV: GL Accounts master File  Retrieval index                     120652
      *                                                                   120652
     F/COPY WNCPYSRC,GL0150UF01
     F*GLJENPL0O***E           K        DISK                      A       CGL016
     FGLJENPL0UF  E           K        DISK                      A        CGL016
      * UPD: GL Batch Posting          Update index
     FGLJEPQL0O   E           K        DISK         KINFSR *PSSR A                          MD025865
     F*                                                                   S01408
     FGLJEIXL2IF  E           K        DISK         KINFSR *PSSR                              CGL013
      ** RTV: Midas GL Journal Entry Interface - Additional Information                       CGL013
      *                                                                                       CGL013
     FGLJENXL3O   E           K        DISK         KINFSR *PSSR A                            CGL013
      ** UPD: Midas GL Journal Entry File - Additional Information                            CGL013
      *                                                                                       CGL013
     F/COPY WNCPYSRC,GL0150UFPG                                           S01408
     FGLJIX1PDIF  E           K        DISK                           UC                      CER001
      *                                                                                       CER001
      ** RTV: GL Batch Posting Interface File  Retrieval index                                CER001
      *                                                                                       CER001
     FGLJPX1PDO   E           K        DISK                      A    UC                      CER001
      *                                                                                       CER001
      ** UPD: GL Batch Posting          Update index                                          CER001
      *                                                                                       CER001
     F***GLJENHL1IF  E           K        DISK         KINFSR *PSSR                  CER046 BUG23404
     FGLJEIHL1IF  E           K        DISK         KINFSR *PSSR                            BUG23404
      *                                                                                       CER046
      ** JE Headers file by Batch number                                                      CER046
      *                                                                                       CER046
     FGLAMADL0IF  E           K        DISK         KINFSR *PSSR                              CER046
     F            ACCNTABF                          KRENAMEGLAMAABF                           CER046
      *                                                                                       CER046
      ** Accounts file by Front Office Id                                                     CER046
      *                                                                                       CER046
     FGLJENSL0UF  E           K        DISK                      A                          BUG23669
      *                                                                                     BUG23669
      ** JE Currency Summary Fike                                                           BUG23669
      *                                                                                     BUG23669
     F**GL0150P1O   E                    PRINTER      KINFDS SPOOL                   CER046 BUG23526
     FGL0150P1O   E                    PRINTER      KINFDS SPOOL      UC                    BUG23526
      *                                                                                       CER046
      ** GL External Batch Details Report                                                     CER046
      *                                                                                       CER046
     F*                                                                   S01408
      *
      ** Midas GL MultiCash Narratives File                                                 BUG23742
      *                                                                                     BUG23742
     FGLMNARL2UF  E           K        DISK                      A                          BUG23742
     F/COPY WNCPYSRC,GLH00191
     E                    STAMP   1   1 26                                                    CPK015
      ** Array containing dummy timestamp                                                     CPK015
     E                    CPY@    1   1 80               Copyright     array
      *                                                                                       CER046
      ** Ok Flag runtime array                                                                CER046
      *                                                                                       CER046
     E**********          OKF        15  1                                           CER046 BUG25438
     E                    OKF        16  1                                                  BUG25438
      *                                                                                       CER046
      ** Array for separating Integer and Decimal                                             CER046
      *                                                                                       CER046
     E                    INF        13  1                                                    CER046
     E                    ALLF       13  1                                                    CER046
     E                    DEF         3  1                                                    CER046
      *                                                                                       CER046
      ** Ok Flag runtime array                                                                CER046
      *                                                                                       CER046
     E**********          ERMSG   1  15 25                                           CER046 BUG25438
     E                    ERMSG   1  16 25                                                  BUG25438
     E                    WAR        20  1                                                    CER046
     E                    WCQAR       8  1                                                    CER046
     E                    PEX        22 35                                                  BUG25476
     E/COPY ZSRSRC,ZDATE9Z1                                                                   CER046
      /EJECT
      * Data structures:-
     I*                                                                   120652
     IRUNDAT      DS                                                      120652
     I                                        1   7 MRDT                  120652
     I                                    P   8  100RDNO                  120652
     I                                       11  11 SUCP                  120652
     I                                       12  12 DTFF                  120652
     I                                       13  13 MBIN                  120652
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
     I*                                                                   CGL016
     ID@ACCT    E DSACCNTAB                                               CGL016
     I*                                                                   CGL016
     I*  Account Details DS for assigning data from Access                CGL016
     I*  Programs to work fields                                          CGL016
     I*                                                                   CGL016
     IUUFDY     E DSDSFDY                                                 CGL016
     I*                                                                   CGL016
     I* 200 Byte Data Structure for Incoming Data from Access Program     CGL016
     I*                                                                   CGL016
     IUUSDY     E DSDSSDY                                                 CGL016
     I*                                                                   CGL016
     I* 800 Byte Data Structure for Incoming Data from Access Program     CGL016
     I@1DBRC    E DSGLJENPL0                                              CGL016
      * UPD : Midas GL Journal Entry Posting Update                       CGL016
      * Current/previous master file format fields for change control     CGL016
      *                                                                   CGL016
     ID@SARD    E DSSCSARDPD                                              CGL002
     I*                                                                   CGL002
     I*  Switchable Features DS                                           CGL002
     I              LCD                             LCDX                  CGL002
      *                                                                   S01408
     ILDA       E DSLDA                         256                                           CGL013
      ** Local Data Area for Database Error Details                                           CGL013
      *                                                                                       CGL013
     I/COPY WNCPYSRC,GL0150UIP1                                           S01408
      *                                                                   S01408
     IFNADS       DS                                                                          CER030
     I                                        1  35 BAFN2                                     CER030
     I                                       36  70 BAFN3                                     CER030
     I                                       71 105 BAFN4                                     CER030
     I                                      106 140 BAFN5                                     CER030
     I                                      141 175 BAFN6                                     CER030
     I                                      176 210 BAFN7                                     CER030
     I                                      211 245 BAFN8                                     CER030
     I                                      246 280 BAFN9                                     CER030
     I                                      281 315 BAFN10                                    CER030
     I                                      316 350 BAFN11                                    CER030
     I                                      351 385 BAFN12                                    CER030
     I                                      386 420 BAFN13                                    CER030
     I                                      421 455 BAFN14                                    CER030
     I                                      456 490 BAFN15                                    CER030
     I                                      491 525 BAFN16                                    CER030
     I                                      526 560 BAFN17                                    CER030
     I                                      561 595 BAFN18                                  BUG23742
     I                                      596 630 BAFN19                                  BUG23742
     I                                      631 665 BAFN20                                  BUG23742
     I                                      666 700 BAFN21                                  BUG23742
     I                                      701 735 BAFN22                                  BUG23742
     I                                      736 770 BAFN23                                  BUG23742
      *                                                                                       CER030
     IEXNRDS      DS                                                                          CER030
     I                                        1  65 BAADI1                                    CER030
     I                                       66 130 BAADI2                                    CER030
     I                                      131 195 BAADI3                                    CER030
     I                                      196 260 BAADI4                                    CER030
     I                                      261 325 BAADI5                                    CER030
     I                                      326 390 BAADI6                                    CER030
      *                                                                                       CER030
     IACCDS       DS                                                                          CER030
     I                                        1  100PACCD                                     CER030
     I                                       11  120PACSQ                                     CER030
      *                                                                                       CER030
     IP@BCDT      DS                            200                                           CER046
     I                                        1   1 PMODE                                     CER046
     I                                        2   4 PBCNO                                     CER046
     I                                        5   5 PERRF                                     CER046
     I                                        6  20 PTOTI                                     CER046
     I                                       21  23 PTOTD                                     CER046
     I                                       24  26 PTOTM                                     CER046
     I                                       27  29 PBRBT                                     CER046
      *                                                                                       CER046
     IPSDS       SDS                                                                          CER046
      *                                                                                       CER046
     I                                      254 263 WUSER                                     CER046
      *                                                                                       CER046
     ISPOOL       DS                                                                          CER046
     I                                       83  92 SFILE                                     CER046
     I                                    B 123 1240SFNUM                                     CER046
     I                                    B 188 1890OFLLN                                     CER046
     I                                    B 367 3680PRTLN                                     CER046
      *                                                                                       CER046
     IGLREOV      DS                                                                          CER046
     I                                        1   1 WRRE01                                    CER046
     I                                        2   2 WRRE02                                    CER046
     I                                        3   3 WRRE03                                    CER046
     I                                        4   4 WRRE04                                    CER046
     I                                        5   5 WRRE05                                    CER046
     I                                        6   6 WRRE06                                    CER046
     I                                        7   7 WRRE07                                    CER046
     I                                        8   8 WRRE08                                    CER046
     I                                        9   9 WRRE09                                    CER046
     I                                       10  10 WRRE10                                    CER046
      *                                                                                       CER046
     IWDACID      DS                                                                          CER046
     I                                        1   6 WACF6                                     CER046
     I                                        1   3 WACF3                                     CER046
     I                                        1   1 WACF1                                     CER046
     I                                        1   1 WACA1                                     CER046
     I                                        2   2 WACA2                                     CER046
     I                                        3   3 WACA3                                     CER046
     I                                        4   5 WACM2                                     CER046
     I                                        6  10 WACL5                                     CER046
     I                                        7  10 WACL4                                     CER046
      *                                                                                       CER046
     IZMITEM      DS                                                                          CER046
     I                                        1  10 INDX                                      CER046
      *                                                                                       CER046
     IZMUSER      DS                                                                          CER046
     I                                        1  10 USRID                                     CER046
     I                                       11  13 DBRN                                      CER046
     I                                       14  16 DPPT                                      CER046
     I                                       17  17 BANK                                      CER046
      *                                                                                       CER046
     IWDATF       DS                                                                          CER046
     I                                        1   4 WYR                                       CER046
     I                                        5   5 WSP1                                      CER046
     I                                        6   7 WMN                                       CER046
     I                                        8   8 WSP2                                      CER046
     I                                        9  10 WDY                                       CER046
     I/COPY ZSRSRC,ZDATE9Z2                                                                   CER046
     ISDCURR    E DSSDCURRPD                                                                  CER046
      *                                                                                       CER046
      ** External DS for Customer Details                                                     CER046
      *                                                                                       CER046
     ISDCUST    E DSSDCUSTPD                                                                  CER046
      *                                                                                       CER046
      ** External DS for Customer Details                                                     CER046
      *                                                                                       CER046
     ISDGELR    E DSSDGELRPD                                                                  CER046
     I              QQACCD                          QQACC1                                    CER046
      *                                                                                       CER046
      ** External DS for Narrative Codes                                                      CER046
      *                                                                                       CER046
     ISDNARR    E DSSDNARRPD                                                                  CER046
      *                                                                                       CER046
      ** Externally described DS for Retail Transaction Types Details                         CER046
      *                                                                                       CER046
     ISDRETR    E DSSDRETRPD                                                                  CER046
      *                                                                                       CER046
      ** External DS for Bank details                                                         CER046
      *                                                                                       CER046
     ISDBANK    E DSSDBANKPD                                                                  CER046
      *                                                                                       CER046
      ** External DS for Book details                                                         CER046
      *                                                                                       CER046
     ISDBOOK    E DSSDBOOKPD                                                                  CER046
      *                                                                                       CER046
      ** Externally described DS for Retail Details                                           CER046
      *                                                                                       CER046
     ISDRETL    E DSSDRETLPD                                                                  CER046
      *                                                                                       CER046
      ** Externally described DS for Module Details                                           CER046
      *                                                                                       CER046
     ISDMMOD    E DSSDMMODPD                                                                  CER046
      *                                                                                       CER046
      ** Externally described DS for Profit Centre Details                                    CER046
      *                                                                                       CER046
     ISDPRFC    E DSSDPRFCPD                                                                  CER046
      *                                                                                       CER046
      ** External DS for Account Code details                                                 CER046
      *                                                                                       CER046
     ISDACOD    E DSSDACODPD                                                                  CER046
     I              QQACCD                          QQACC2                                    CER046
      *                                                                                       CER046
      ** External DS for Branch details                                                       CER046
      *                                                                                       CER046
     ISDBRCH    E DSSDBRCHPD                                                                  CER046
     I              QQDFAC                          QQDFA1                                    CER046
      *                                                                                       CER046
      ** External DS for Nostro details                                                       CER046
      *                                                                                       CER046
     ISDNOST    E DSSDNOSTPD                                                                  CER046
     I              QQACCD                          QQACC3                                    CER046
      *                                                                                       CER046
      ** External DS for Account details                                                      CER046
      *                                                                                       CER046
     IF1ACCT    E DSACCNTAB                                                                   CER046
     I              RECI                            F1RECI                                    CER046
     I              CNUM                            F1CNUM                                    CER046
     I              CCY                             F1CCY                                     CER046
     I              ACODQQ                          F1ACDQ                                    CER046
     I              ACSQ                            F1ACSQ                                    CER046
     I              ZZ006                           F1ZZ06                                    CER046
     I              BRCA                            F1BRCA                                    CER046
     I              ATYP                            F1ATYP                                    CER046
     I              STYP                            F1STYP                                    CER046
     I              MFFQ                            F1MFFQ                                    CER046
     I              ACST                            F1ACST                                    CER046
     I              DACO                            F1DACO                                    CER046
     I              DACC                            F1DACC                                    CER046
     I              ANAM                            F1ANAM                                    CER046
     I              LDBL                            F1LDBL                                    CER046
     I              CLBL                            F1CLBL                                    CER046
     I              STFQ                            F1STFQ                                    CER046
     I              STDY                            F1STDY                                    CER046
     I              LSTD                            F1LSTD                                    CER046
     I              NSTD                            F1NSTD                                    CER046
     I              LSTP                            F1LSTP                                    CER046
     I              CFSB                            F1CFSB                                    CER046
     I              LMVD                            F1LMVD                                    CER046
     I              EPLB                            F1EPLB                                    CER046
     I              EPCB                            F1EPCB                                    CER046
     I              YTDB                            F1YTDB                                    CER046
     I              GLBT                            F1GLBT                                    CER046
     I              ADREF1                          F1ADR1                                    CER046
     I              PRFC                            F1PRFC                                    CER046
     I              ZZ004                           F1ZZ04                                    CER046
     I              ORED                            F1ORED                                    CER046
     I              DLIM                            F1DLIM                                    CER046
     I              LRCR                            F1LRCR                                    CER046
     I              RTCB                            F1RTCB                                    CER046
     I              RTLB                            F1RTLB                                    CER046
     I              DITM                            F1DITM                                    CER046
     I              CITM                            F1CITM                                    CER046
     I              ADREF2                          F1ADR2                                    CER046
     I              ZZ002                           F1ZZ02                                    CER046
     I              CDIR                            F1CDIR                                    CER046
     I              CCIR                            F1CCIR                                    CER046
     I              ACNO                            F1ACNO                                    CER046
     I              RETB                            F1RETB                                    CER046
     I              ODSC                            F1ODSC                                    CER046
     I              ODLN                            F1ODLN                                    CER046
     I              ODED                            F1ODED                                    CER046
     I              DIOD                            F1DIOD                                    CER046
     I              FACT                            F1FACT                                    CER046
     I              FCNO                            F1FCNO                                    CER046
     I              EFAC                            F1EFAC                                    CER046
     I              HELD                            F1HELD                                    CER046
     I              MINB                            F1MINB                                    CER046
     I              LACD                            F1LACD                                    CER046
     I              LISP                            F1LISP                                    CER046
     I              RRNM                            F1RRNM                                    CER046
     I              DRIB                            F1DRIB                                    CER046
     I              DRIS                            F1DRIS                                    CER046
     I              DRCD                            F1DRCD                                    CER046
     I              DRIC                            F1DRIC                                    CER046
     I              DRIF                            F1DRIF                                    CER046
     I              DRDY                            F1DRDY                                    CER046
     I              NDID                            F1NDID                                    CER046
     I              LDID                            F1LDID                                    CER046
     I              LDIA                            F1LDIA                                    CER046
     I              SDAP                            F1SDAP                                    CER046
     I              LPAR                            F1LPAR                                    CER046
     I              DIIE                            F1DIIE                                    CER046
     I              DAIC                            F1DAIC                                    CER046
     I              MADI                            F1MADI                                    CER046
     I              GADI                            F1GADI                                    CER046
     I              DDIS                            F1DDIS                                    CER046
     I              DDIA                            F1DDIA                                    CER046
     I              OLDR                            F1OLDR                                    CER046
     I              OLDB                            F1OLDB                                    CER046
     I              OLDS                            F1OLDS                                    CER046
     I              CRIB                            F1CRIB                                    CER046
     I              CRIS                            F1CRIS                                    CER046
     I              CRCD                            F1CRCD                                    CER046
     I              CRIC                            F1CRIC                                    CER046
     I              CRIF                            F1CRIF                                    CER046
     I              CRDY                            F1CRDY                                    CER046
     I              NCID                            F1NCID                                    CER046
     I              LCID                            F1LCID                                    CER046
     I              LCIA                            F1LCIA                                    CER046
     I              SCAP                            F1SCAP                                    CER046
     I              LPAP                            F1LPAP                                    CER046
     I              CIIE                            F1CIIE                                    CER046
     I              CAIC                            F1CAIC                                    CER046
     I              MACI                            F1MACI                                    CER046
     I              GACI                            F1GACI                                    CER046
     I              CDIS                            F1CDIS                                    CER046
     I              DCIA                            F1DCIA                                    CER046
     I              OLCR                            F1OLCR                                    CER046
     I              OLCB                            F1OLCB                                    CER046
     I              OLCS                            F1OLCS                                    CER046
     I              LCD                             F1LCD                                     CER046
     I              CHTP                            F1CHTP                                    CER046
     I              TNLU                            F1TNLU                                    CER046
     I              BRTCA                           F1BRTC                                    CER046
     I              NACSG                           F1NACS                                    CER046
     I              R4ACNT                          F1R4AC                                    CER046
     I              ENOC                            F1ENOC                                    CER046
     I              EPNO                            F1EPNO                                    CER046
     I              ECFB                            F1ECFB                                    CER046
     I              LTAB                            F1LTAB                                    CER046
     I              LTACQQ                          F1LTAQ                                    CER046
     I              LTAS                            F1LTAS                                    CER046
     I              HCFB                            F1HCFB                                    CER046
     I              PTFR                            F1PTFR                                    CER046
     I              HLEX                            F1HLEX                                    CER046
     I              A5TIAC                          F1A5TC                                    CER046
     I              A5TIAN                          F1A5TN                                    CER046
     I              A5TIAS                          F1A5TS                                    CER046
     I              EUSB                            F1EUSB                                    CER046
     I              IBAN                            F1IBAN                                    CER046
     I              IBSEQN                          F1IBSN                                    CER046
     I              FRNT                            F1FRNT                                    CER046
     I              AFRT                            F1AFRT                                    CER046
     I              REPA                            F1REPA                                    CER046
     I              TMST                            F1TMST                                    CER046
     I              REPI                            F1REPI                                    CER046
     I              ACOD                            F1ACOD                                    CER046
     I              LTAC                            F1LTAC                                    CER046
     I              FCCU                            F1FCCU                                    CER046
     I              COLF                            F1COLF                                    CER046
     I              BCOA                            F1BCOA                                    CER046
     I              COLA                            F1COLA                                    CER046
     I              PFCU                            F1PFCU                                    CER046
     I              PFTP                            F1PFTP                                    CER046
     I              PFSQ                            F1PFSQ                                    CER046
     I              A5ACKY                          F1ACKY                                    CER046
     I              A5INTL                          F1INTL                                    CER046
     I              A5TIAB                          F1TIAB                                    CER046
     I              AUTH                            F1AUTH                                    CER046
     I              K24C                            F1K24C                                    CER046
     I              ACEFDT                          F1EFDT                                    CRE075
     I              DCSP                            F1DCSP                                  AR833906
     I              DCSG                            F1DCSG                                  AR833906
     I              DRMT                            F1DRMT                                  AR833906
     I              DRFD                            F1DRFD                                  AR833906
     I              CCSP                            F1CCSP                                  AR833906
     I              CCSG                            F1CCSG                                  AR833906
     I              CRMT                            F1CRMT                                  AR833906
     I              CRFD                            F1CRFD                                  AR833906
      *                                                                                       CER046
     I              '0000002745'          C         CONT                                      CER046
      *                                                                                       CER046
      ** DS for AOSVALR0                                                                   BUG26405A
      *                                                                                    BUG26405A
     ISVAL1       DS                            200                                        BUG26405A
     I                                        1   1 SVAL11                                 BUG26405A
     I              'GLJRNECmpAssCust'    C         SVALKK                                 BUG26405A
      /EJECT
      *****************************************************************   S01234
     C********** *ENTRY    PLIST                           Entry parameter 01234
     C******************** PARM           P@IFBN  30       I/Face Batch No 01234
     C******************** PARM           P@BHNO  30       ADD Batch No   S01234
      *****************************************************************   S01234
     C           *ENTRY    PLIST                           Entry parameter 01234
     C                     PARM           P@IFBN  3        I/Face Batch No 01234
     C                     PARM           P@BHNO  3        ADD Batch No   S01234
     C                     PARM           P@BCDT                                              CER046
     C/COPY WNCPYSRC,GLH00192
      *****************************************************************   S01234
     C*                                                                   120652
     C           ACCKEY    KLIST                                          120652
     C**********           KFLD           @@CUST  60                                   120652 CSD027
     C                     KFLD           @@CUST  6                                           CSD027
     C                     KFLD           @@CYCD  3                       120652
     C**********           KFLD           @@ACCD  40                                   120652 CGL029
     C                     KFLD           @@ACCD 100                                          CGL029
     C                     KFLD           @@ACSN  20                      120652
     C                     KFLD           @@IBCA  3                       120652
     C*                                                                   120652
     C*   Access MIDAS Rundate from data-area RUNDAT                      120652
     C*                                                                   120652
     C           *NAMVAR   DEFN           RUNDAT                          120652
     C                     IN   RUNDAT                                    120652
      *                                                                   CGL016
      ** Access account info                                              CGL016
     C           KACCT     KLIST                                          CGL016
     C                     KFLD           W0CNUM  6                       CGL016
     C                     KFLD           W0CCY   3                       CGL016
     C                     KFLD           W0ACOD  40                      CGL016
     C                     KFLD           W0ACSQ  20                      CGL016
     C                     KFLD           W0BRCA  3                       CGL016
      *                                                                   CGL016
      ** Access Journal entry record                                      CGL016
     C           KLCRSA    KLIST                                          CGL016
     C                     KFLD           BTBTNB           Batch number   CGL016
     C                     KFLD           BTBINB           Batch item no. CGL016
      *                                                                                     BUG23669
      ** Access Journal entry summary record                                                BUG23669
     C           KJENS     KLIST                                                            BUG23669
     C                     KFLD           BTBTNB                                            BUG23669
     C                     KFLD           BTCYCD                                            BUG23669
     C                     KFLD           BTIBCA                                            BUG23669
      *                                                                   CGL016
      ** Access SAR details for Projected Movements Update Prior to Auth. CGL016
      *                                                                   CGL016
     C                     MOVEL'N'       CGL016  1                       CGL016
     C                     CALL 'AOSARDR0'                                CGL016
     C                     PARM *BLANKS   UUAPRC                          CGL016
     C                     PARM '*VERIFY' UUAPOP                          CGL016
     C                     PARM 'CGL016'  UUACID                          CGL016
     C           D@SARD    PARM D@SARD    UUFDY                           CGL016
      *                                                                   CGL016
     C           UUAPRC    IFEQ *BLANK                                    CGL016
     C                     MOVEL'Y'       CGL016                          CGL016
     C                     ENDIF                                          CGL016
      *                                                                   CGL016
      ** Access SAR details for Two O'Clock Feature                                        AR792734A
      *                                                                                    AR792734A
     C                     MOVEL'N'       CRE023  1                                        AR792734A
     C                     CALL 'AOSARDR0'                                                 AR792734A
     C                     PARM *BLANKS   UUAPRC                                           AR792734A
     C                     PARM '*VERIFY' UUAPOP                                           AR792734A
     C                     PARM 'CRE023'  UUACID                                           AR792734A
     C           D@SARD    PARM D@SARD    UUFDY                                            AR792734A
      *                                                                                    AR792734A
     C           UUAPRC    IFEQ *BLANK                                                     AR792734A
     C                     MOVEL'Y'       CRE023                                           AR792734A
     C                     ENDIF                                                           AR792734A
      *                                                                                    AR792734A
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0150UCPG                                           S01408
      *                                                                                       CER001
      ** Check Feature ULX043 is Present, if so open File                                     CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX043  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD                                               CER001
     C                     PARM '*VERIFY' POPTN                                               CER001
     C                     PARM 'ULX043'  PSARD                                               CER001
      *                                                                                       CER001
     C           PRTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     OPEN GLJIX1PD                                                      CER001
     C                     OPEN GLJPX1PD                                                      CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           KEXT7     KLIST                                                              CER001
     C                     KFLD           P@IFBN  3                                           CER001
     C                     KFLD           BTBINB  30                                          CER001
     C*                                                                   S01408
     C           CER046    IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
     C                     MOVE *BLANKS   PTOTI                                               CER046
     C                     MOVE *BLANKS   PTOTD                                               CER046
     C                     MOVE *BLANKS   PTOTM                                               CER046
     C                     MOVE *ZEROS    PTOTIN                                              CER046
     C                     MOVE *ZEROS    PTOTDN                                              CER046
     C                     MOVE *ZEROS    PTOTMN                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C                     MOVE *BLANKS   ERRFLG  1                                         MD040755
     C*
     C* Locate Interface Posting Records using I/Face Batch Number
     C*
     C           P@IFBN    SETLL@POST2
     C                     READ @POST2                   86
     C*
     C* Check Record Read is from the same batch and not EOF
     C*
     C           *IN86     DOWEQ'0'                        .DOW =/= E  OF
     C***********BTJDNB    ANDEQP@IFBN                     ¦              S01251
     C           BTBTNB    ANDEQP@IFBN                     ¦              S01251
     C*                                                    ¦
     C* Once Interface Posting Record found Write it to GL Batch Posting
     C* File with ADD Batch Number as key to the record.
     C*                                                    ¦
     C******************** Z-ADDP@BHNO    BTJDNB           ¦              S01234
     C******************** MOVE P@BHNO    BTJDNB           ¦              S01251
     C/COPY WNCPYSRC,GL0150UC05
      *                                                                                       CER046
     C           CER046    IFEQ 'Y'                                                           CER046
     C           PBCNO     ANDNE*BLANKS                                                       CER046
     C                     MOVE PBCNO     BTBTNB                                              CER046
     C                     ELSE                                                               CER046
     C                     MOVE P@BHNO    BTBTNB           ¦              S01251
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           CER046    IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
     C                     Z-ADD0         ID                                                  CER046
      *                                                                                     MD032207
      **  Initialize the Error Flag to prevent the previous status from being used          MD032207
      *                                                                                     MD032207
     C           PERRF     IFEQ 'Y'                                                         MD040755
     C                     MOVE 'Y'       ERRFLG                                            MD040755
     C                     ENDIF                                                            MD040755
     C                     MOVE *BLANKS   PERRF                                             MD032207
     C                     MOVE *BLANKS   WRTCD                                             MD032207
      *                                                                                       CER046
     C                     EXSR FLDVAL                                                      AR862752
      *                                                                                     AR862752
     C                     EXSR SRVALD                                                        CER046
      *                                                                                       CER046
      ** Calculate Totals                                                                     CER046
      *                                                                                       CER046
     C                     EXSR SRTOTP                                                        CER046
      *                                                                                       CER046
     C                     Z-ADD1         ID                                                  CER046
      *                                                                                       CER046
     C           PERRF     IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
     C**********           MOVE *BLANKS   BTVALI                                     CER046 BUG26643
     C                     MOVE 'Y'       BTVALI                                            BUG26643
      *                                                                                       CER046
      ** Generate report on error                                                             CER046
      *                                                                                       CER046
     C                     SETON                     87                                       CER046
      *                                                                                       CER046
     C********** ID        DOWLE15                                                   CER046 BUG25438
     C           ID        DOWLE16                                                          BUG25438
      *                                                                                       CER046
     C           OKF,ID    IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
     C                     EXSR SRWRIT                                                        CER046
     C                     MOVE *BLANKS   BTVALI                                            BUG26643
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ADD  1         ID      20                                          CER046
     C                     ENDDO                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                             BUG23669
     C                     MOVE 'Y'       BTVALI                                            BUG23669
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C/COPY WNCPYSRC,GLH00193
     C*                                                                   120652
     C                     EXSR FLDVAL                                    120652
     C/COPY WNCPYSRC,GL0150UC02
     C*                                                                   120652
     C                     MOVEASTAMP,1   BTTMST           Default Timestamp                  CPK015
     C*********************WRITE@BTREAK                    ¦              CGL016
     C/COPY WNCPYSRC,GLH00194
     C           CER046    IFNE 'Y'                                                           CER046
     C           CER046    OREQ 'Y'                                                           CER046
     C           WBRCHE    ANDEQ' '                                                           CER046
     C                     Z-ADD0         BTPDID                                            MD044271
     C                     WRITE@BTREAK                91  ¦              CGL016
     C                     WRITEGLJEPQD0               91                                   MD025865
      *                                                                                     BUG23669
      ** Update currency totals                                                             BUG23669
      *                                                                                     BUG23669
     C                     EXSR UPJENS                                                      BUG23669
     C                     ENDIF                                                              CER046
     C/COPY WNCPYSRC,GLH00195
      *                                                                   CGL016
B1   C           CGL016    IFEQ 'Y'                                       CGL016
     C           *IN91     ANDEQ*OFF                                      CGL016
     C           CRE023    OREQ 'Y'                                                        AR792734A
     C           *IN91     ANDEQ*OFF                                                       AR792734A
      *                                                                   CGL016
     C           KLCRSA    CHAIN@BTREAK              9394                 CGL016
      *                                                                   CGL016
      * Accessing accounts to see whether Retail or not                   CGL016
      *                                                                   CGL016
     C                     CALL 'AOACCTR0'                                CGL016
     C                     PARM *BLANKS   UUAPRC  7        B:Return Cd    CGL016
     C                     PARM '*KEY'    UUAPOP  7        B:Option       CGL016
     C                     PARM *BLANKS   UUACID 10        I:Account IdentCGL016
     C                     PARM           BTCUST  6        I:Customer NumbCGL016
     C                     PARM           BTCYCD  3        I:Currency CodeCGL016
     C**********           PARM           BTACCD  4        I:Account Code              CGL016 CGL029
     C                     PARM           BTACCD 10                                           CGL029
     C                     PARM           BTACSN  2        I:Account SequeCGL016
     C                     PARM           BTIBCA  3        I:Branch code  CGL016
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format       CGL016
      *                                                                   CGL016
      * Accessing end date                                                CGL016
      *                                                                   CGL016
B2   C           ATYP      IFEQ 'R'                                       CGL016
      *                                                                   CGL016
     C                     CALL 'GL004446'                                CGL016
     C                     PARM *BLANKS   UUAPRC                          CGL016
     C                     PARM           @1DBRC                          CGL016
      *                                                                   CGL016
     C                     MOVE 'Y'       BTSHPI                          CGL016
      *                                                                   CGL016
E2   C                     ENDIF                                          CGL016
      *                                                                   CGL016
B2   C           *IN93     IFEQ *OFF                                      CGL016
     C           *IN94     ANDEQ*OFF                                      CGL016
     C                     UPDAT@BTREAK                                   CGL016
E2   C                     ENDIF                                          CGL016
      *                                                                   CGL016
E1   C                     ENDIF                                          CGL016
      *                                                                   CGL016
      *                                                                                       CGL013
      ** If MT94x Messages Generation (CGL013) is installed, if                               CGL013
      ** additional information exists in GLJEIXPD for the same                               CGL013
      ** batch and item number, output to GLJENXPD.                                           CGL013
      *                                                                                       CGL013
     C           CGL013    IFEQ 'Y'                                                           CGL013
     C           KJESX     CHAINGLJEIXL2             30                                       CGL013
     C           *IN30     IFEQ *OFF                                                          CGL013
     C           BAPTDT    IFEQ *ZEROS                                                        CGL013
     C                     MOVE RDNO      BAPTDT                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CER046
     C           CER046    IFEQ 'Y'                                                           CER046
     C           PBCNO     ANDNE*BLANKS                                                       CER046
     C                     MOVE PBCNO     BABTNB                                              CER046
     C                     ELSE                                                               CER046
     C/COPY WNCPYSRC,GLH00196
     C                     MOVE P@BHNO    BABTNB                                              CGL013
     C                     ENDIF                                                              CER046
      **********                                                                     CER030 BUG23742
      ***Format*and*Populate*Extended*Narrative                                      CER030 BUG23742
      **********                                                                     CER030 BUG23742
     C********** CER030    IFEQ 'Y'                                                  CER030 BUG23742
      **********                                                                     CER030 BUG23742
     C********** EXNRDS    IFEQ *BLANKS                                              CER030 BUG23742
     C********** FNADS     ANDNE*BLANKS                                              CER030 BUG23742
      **********                                                                     CER030 BUG23742
     C**********           MOVE *BLANKS   PNWRK                                      CER030 BUG23742
     C**********           MOVE BTIBCA    PBRCA                                      CER030 BUG23742
     C**********           MOVE BTCUST    PCUSNO                                     CER030 BUG23742
     C**********           MOVE BTCYCD    PCCY                                       CER030 BUG23742
     C**********           MOVE BTACCD    PACCD                                      CER030 BUG23742
     C**********           MOVE BTACSN    PACSQ                                      CER030 BUG23742
     C**********           MOVE BAFN2     PFOR1                                      CER030 BUG23742
     C**********           MOVE BAFN3     PFOR2                                      CER030 BUG23742
     C**********           MOVE BAFN4     PFOR3                                      CER030 BUG23742
     C**********           MOVE BAFN5     PFOR4                                      CER030 BUG23742
     C**********           MOVE BAFN6     PFOR5                                      CER030 BUG23742
     C**********           MOVE BAFN7     PFOR6                                      CER030 BUG23742
     C**********           MOVE BAFN8     PFOR7                                      CER030 BUG23742
     C**********           MOVE BAFN9     PFOR8                                      CER030 BUG23742
     C**********           MOVE BAFN10    PFOR9                                      CER030 BUG23742
     C**********           MOVE BAFN11    PFOR10                                     CER030 BUG23742
     C**********           MOVE BAFN12    PFOR11                                     CER030 BUG23742
     C**********           MOVE BAFN13    PFOR12                                     CER030 BUG23742
     C**********           MOVE BAFN14    PFOR13                                     CER030 BUG23742
     C**********           MOVE BAFN15    PFOR14                                     CER030 BUG23742
     C**********           MOVE BAFN16    PFOR15                                     CER030 BUG23742
     C**********           MOVE BAFN17    PFOR16                                     CER030 BUG23742
      **********                                                                     CER030 BUG23742
     C**********           CALL 'MG001900'                                           CER030 BUG23742
     C**********           PARM           PRTCD1 10                                  CER030 BUG23742
     C**********           PARM '*MERGE ' POPTN1  7                                  CER030 BUG23742
     C**********           PARM           PNWRK   6                                  CER030 BUG23742
     C**********           PARM           PMSGTP  3                                  CER030 BUG23742
     C**********           PARM           PBRCA   3                                  CER030 BUG23742
     C**********           PARM           PCUSNO  60                                 CER030 BUG23742
     C**********           PARM           PCCY    3                                  CER030 BUG23742
     C**********           PARM           PACCD                                      CER030 BUG23742
     C**********           PARM           PACSQ                                      CER030 BUG23742
     C**********           PARM           PDCIN   1                                  CER030 BUG23742
     C**********           PARM           PTRTP   5                                  CER030 BUG23742
     C**********           PARM           PNAR1  65                                  CER030 BUG23742
     C**********           PARM           PNAR2  65                                  CER030 BUG23742
     C**********           PARM           PNAR3  65                                  CER030 BUG23742
     C**********           PARM           PNAR4  65                                  CER030 BUG23742
     C**********           PARM           PNAR5  65                                  CER030 BUG23742
     C**********           PARM           PNAR6  65                                  CER030 BUG23742
     C**********           PARM           PFOR1  70                                  CER030 BUG23742
     C**********           PARM           PFOR2  70                                  CER030 BUG23742
     C**********           PARM           PFOR3  70                                  CER030 BUG23742
     C**********           PARM           PFOR4  70                                  CER030 BUG23742
     C**********           PARM           PFOR5  70                                  CER030 BUG23742
     C**********           PARM           PFOR6  70                                  CER030 BUG23742
     C**********           PARM           PFOR7  70                                  CER030 BUG23742
     C**********           PARM           PFOR8  70                                  CER030 BUG23742
     C**********           PARM           PFOR9  70                                  CER030 BUG23742
     C**********           PARM           PFOR10 70                                  CER030 BUG23742
     C**********           PARM           PFOR11 70                                  CER030 BUG23742
     C**********           PARM           PFOR12 70                                  CER030 BUG23742
     C**********           PARM           PFOR13 70                                  CER030 BUG23742
     C**********           PARM           PFOR14 70                                  CER030 BUG23742
     C**********           PARM           PFOR15 70                                  CER030 BUG23742
     C**********           PARM           PFOR16 70                                  CER030 BUG23742
     C**********           PARM           PFOR17 70                                  CER030 BUG23742
     C**********           PARM           PFOR18 70                                  CER030 BUG23742
     C**********           PARM           PFOR19 70                                  CER030 BUG23742
     C**********           PARM           PFOR20 70                                  CER030 BUG23742
     C**********           PARM           IDX     30                                 CER030 BUG23742
     C**********           PARM           FNMARR 10                                  CER030 BUG23742
     C**********           PARM           MIDARR  7                                  CER030 BUG23742
     C**********           PARM           MDTARR 45                                  CER030 BUG23742
     C**********           PARM           WFLDAR 10                                  CER030 BUG23742
     C**********           PARM           WMIDAR  7                                  CER030 BUG23742
     C**********           PARM           WMDTAR 45                                  CER030 BUG23742
      **********                                                                     CER030 BUG23742
     C**********           MOVE PNAR1     BAADI1                                     CER030 BUG23742
     C**********           MOVE PNAR2     BAADI2                                     CER030 BUG23742
     C**********           MOVE PNAR3     BAADI3                                     CER030 BUG23742
     C**********           MOVE PNAR4     BAADI4                                     CER030 BUG23742
     C**********           MOVE PNAR5     BAADI5                                     CER030 BUG23742
     C**********           MOVE PNAR6     BAADI6                                     CER030 BUG23742
      **********                                                                     CER030 BUG23742
     C**********           ENDIF                                                     CER030 BUG23742
      **********                                                                     CER030 BUG23742
     C**********           ENDIF                                                     CER030 BUG23742
     C********** CER030    IFEQ 'Y'                                                BUG25476 AR833906
     C           CER031    IFEQ 'Y'                                                         AR833906
     C           EXNRDS    ANDNE*BLANKS                                                     BUG25476
     C                     EXSR SRVADI                                                      BUG25476
     C******               ENDIF                                                   BUG25476 BUG26840
      *                                                                                     BUG25476
     C/COPY WNCPYSRC,GLH00197
     C                     WRITEGLJENXD0                                                      CGL013
     C                     ENDIF                                                            BUG26840
     C                     ENDIF                                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                     BUG23742
      ** Format and Populate Multicash Narratives                                           BUG23742
      *                                                                                     BUG23742
     C           CER030    IFEQ 'Y'                                                         BUG23742
     C           KJESX     CHAINGLJEIXL2             30                                     BUG23742
      *                                                                                     BUG23742
     C           *IN30     IFEQ *OFF                                                        BUG23742
     C           FNADS     ANDNE*BLANKS                                                     BUG23742
      *                                                                                     BUG23742
      ** Validate extended narratives                                                       BUG25476
      *                                                                                     BUG25476
     C                     EXSR SRVLNR                                                      BUG25476
     C           KJENA     CHAINGLMNARL2             31                                     BUG23742
      *                                                                                     BUG23742
     C           *IN31     IFEQ *ON                                                         BUG23742
      *                                                                                     BUG23742
     C                     MOVE BTPTDT    BAPODT                                            BUG23742
     C                     MOVE BTBTNB    BABANB                                            BUG23742
     C                     MOVE BTBINB    BAITNB                                            BUG23742
     C                     MOVE BAFN2     BAEX1                                             BUG23742
     C                     MOVE BAFN3     BAEX2                                             BUG23742
     C                     MOVE BAFN4     BAEX3                                             BUG23742
     C                     MOVE BAFN5     BAEX4                                             BUG23742
     C                     MOVE BAFN6     BAEX5                                             BUG23742
     C                     MOVE BAFN7     BAEX6                                             BUG23742
     C                     MOVE BAFN8     BAEX7                                             BUG23742
     C                     MOVE BAFN9     BAEX8                                             BUG23742
     C                     MOVE BAFN10    BAEX9                                             BUG23742
     C                     MOVE BAFN11    BAEX10                                            BUG23742
     C                     MOVE BAFN12    BAEX11                                            BUG23742
     C                     MOVE BAFN13    BAEX12                                            BUG23742
     C                     MOVE BAFN14    BAEX13                                            BUG23742
     C                     MOVE BAFN15    BAEX14                                            BUG23742
     C                     MOVE BAFN16    BAEX15                                            BUG23742
     C                     MOVE BAFN17    BAEX16                                            BUG23742
     C                     MOVE BAFN18    BAEX17                                            BUG23742
     C                     MOVE BAFN19    BAEX18                                            BUG23742
     C                     MOVE BAFN20    BAEX19                                            BUG23742
     C                     MOVE BAFN21    BAEX20                                            BUG23742
     C                     MOVE BAFN22    BAEX21                                            BUG23742
     C                     MOVE BAFN23    BAEX22                                            BUG23742
      *                                                                                     BUG23742
     C                     WRITEGLMNARD0                                                    BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0150UCAU                                           S01408
      *                                                                                       CER001
      ** Create records when feature is installed                                             CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           KEXT7     CHAINGLJIX1PD             99                                       CER001
     C/COPY WNCPYSRC,GLH00198
      *                                                                                       CER046
     C           CER046    IFEQ 'Y'                                                           CER046
     C           PBCNO     ANDNE*BLANKS                                                       CER046
      *                                                                                       CER046
     C                     MOVE PBCNO     JEBTNB                                              CER046
     C                     ELSE                                                               CER046
     C                     MOVE P@BHNO    JEBTNB                                              CER001
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C/COPY WNCPYSRC,GLH00199
     C                     Z-ADDBTBINB    JEBINB                                              CER001
     C           *IN99     IFEQ *ON                        Not found                          CER001
     C                     Z-ADD0         JEOPC1                                              CER001
     C                     Z-ADD0         JEOPC2                                              CER001
     C                     Z-ADD0         JEOPC3                                              CER001
     C                     MOVE *BLANKS   JECOC1                                              CER001
     C                     MOVE *BLANKS   JECOC2                                              CER001
     C                     MOVE *BLANKS   JECOC2                                              CER001
     C                     MOVE *BLANKS   JEIDC1                                              CER001
     C                     MOVE *BLANKS   JEIDC2                                              CER001
     C                     MOVE *BLANKS   JEIDC3                                              CER001
     C                     MOVE *BLANKS   JEIDE1                                              CER001
     C                     MOVE *BLANKS   JEIDE2                                              CER001
     C                     MOVE *BLANKS   JEIDE3                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Check operation code to know if amount has to be verified                            CER001
      *                                                                                       CER001
     C           JEOPC1    IFNE *ZERO                                                         CER001
     C           JEPTA1    IFEQ *ZERO                                                         CER001
     C                     MOVE BTPTAM    JEPTA1                                              CER001
     C                     ENDIF                                                              CER001
     C           JEDCI1    IFNE 'C'                                                           CER001
     C           JEDCI1    ANDNE'D'                                                           CER001
     C                     MOVE BTDCIN    JEDCI1                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           JEOPC2    IFNE *ZERO                                                         CER001
     C           JEPTA2    IFEQ *ZERO                                                         CER001
     C                     MOVE BTPTAM    JEPTA2                                              CER001
     C                     ENDIF                                                              CER001
     C           JEDCI2    IFNE 'C'                                                           CER001
     C           JEDCI2    ANDNE'D'                                                           CER001
     C                     MOVE BTDCIN    JEDCI2                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           JEOPC3    IFNE *ZERO                                                         CER001
     C           JEPTA3    IFEQ *ZERO                                                         CER001
     C                     MOVE BTPTAM    JEPTA3                                              CER001
     C                     ENDIF                                                              CER001
     C           JEDCI3    IFNE 'C'                                                           CER001
     C           JEDCI3    ANDNE'D'                                                           CER001
     C                     MOVE BTDCIN    JEDCI3                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     WRITEGLJENPDL                                                      CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*                                                                   S01408
     C*                                                    ¦
     C* Locate Next Interface Posting Record using I/Face Batch Number
     C*                                                    ¦
     C           P@IFBN    READE@POST2                   86¦
     C*                                                    ¦
     C                     END                             'DOW 1
      *                                                                                       CER046
     C           CER046    IFEQ 'Y'                                                           CER046
     C           PTOTDN    IFGE 1000                                                        BUG25186
     C********** PTOTDN    DIV  1000      WTOTD   20                               BUG25186 BUG26405
     C           PTOTDN    DIV  1000      WTOTD   30                                        BUG26405
     C                     MVR            PTOTDN                                            BUG25186
     C                     ADD  WTOTD     PTOTIN                                            BUG25186
     C                     ENDIF                                                            BUG25186
     C                     MOVE PTOTIN    PTOTI                                               CER046
     C                     MOVE PTOTDN    PTOTD                                               CER046
     C                     MOVE PTOTMN    PTOTM                                               CER046
     C                     ENDIF                                                              CER046
     C*
     C           ERRFLG    IFEQ 'Y'                                                         MD040755
     C                     MOVE 'Y'       PERRF                                             MD040755
     C                     ENDIF                                                            MD040755
     C/COPY WNCPYSRC,GL0150UC01
     C                     SETON                         LR
     C/COPY WNCPYSRC,GL0150UC03
     C*
     C*****************************************************************   120652
     C*                                                                   120652
     C*  FLDVAL - Assigns retail a/c no., account type, RRN of MEMOS      120652
     C*           rcd, posting date and value date to batch items         120652
     C*           when necessary.                                         120652
     C*                                                                   120652
     C*  CALLED  from MAIN processing                                     120652
     C*                                                                   120652
     C*  CALLS nothing                                                    120652
     C*                                                                   120652
     C*****************************************************************   120652
     C*                                                                   120652
     C           FLDVAL    BEGSR                                          120652
     C*                                                                   120652
     C                     MOVE BTCUST    @@CUST                          120652
     C                     MOVELBTCYCD    @@CYCD                          120652
     C                     MOVE BTACCD    @@ACCD                          120652
     C                     MOVE BTACSN    @@ACSN                          120652
     C                     MOVELBTIBCA    @@IBCA                          120652
     C*                                                                   120652
     C           ACCKEY    CHAINACCNT                35                   120652
     C*                                                                   120652
     C           *IN35     IFEQ '0'                                       120652
     C                     MOVE ACNO      BTRACN                          120652
     C                     MOVE ATYP      BTACTY                          120652
     C                     Z-ADDRRNM      BTRRNM                          120652
     C                     ELSE                                           120652
     C*                                                                   120652
     C           BTCUST    IFEQ *BLANKS                                                     MD040602
     C           BTCYCD    OREQ *BLANKS                                                     MD040602
     C           BTACCD    OREQ *BLANKS                                                     MD040602
     C           BTACSN    OREQ *BLANKS                                                     MD040602
     C           BTIBCA    OREQ *BLANKS                                                     MD040602
     C           BTRACN    IFGT 0                                         120652
     C           BTRACN    CHAINACNUM                35                   120652
     C           *IN35     IFEQ '0'                                       120652
     C                     MOVE CNUM      BTCUST                          120652
     C                     MOVELCCY       BTCYCD                          120652
     C                     MOVE ACOD      BTACCD                          120652
     C                     MOVE ACSQ      BTACSN                          120652
     C                     MOVELBRCA      BTIBCA                          120652
     C                     MOVE ATYP      BTACTY                          120652
     C                     Z-ADDRRNM      BTRRNM                          120652
     C                     END                                            120652
     C                     END                                            120652
     C                     ENDIF                                                            MD040602
     C*                                                                   120652
     C                     END                                            120652
     C*                                                                   120652
     C/COPY WNCPYSRC,GL0150UC07
      * Default Retail error indicator                                    120652
     C           BTRINE    IFEQ ' '                                       120652
     C                     MOVE 'N'       BTRINE                          120652
     C                     END                                            120652
      * Default Retail a.c no. entered                                    120652
     C           BTRNBE    IFEQ ' '                                       120652
     C                     MOVE 'N'       BTRNBE                          120652
     C                     END                                            120652
      * Default Retail override indicator                                 120652
     C           BTRINO    IFEQ ' '                                       120652
     C                     MOVE 'N'       BTRINO                          120652
     C                     END                                            120652
      *                                                                   120652
      * Default posting date to rundate                                   120652
     C                     Z-ADDRDNO      BTPTDT                          120652
     C*                                                                   120652
      **If*non-retail*account or if retail account and value date=0120652 191368
      **default*value date to rundate.                             120652 191368
     C********** BTACTY    IFNE 'R'                                120652 191368
     C/COPY WNCPYSRC,GL0150UC06
     C********** BTACTY    OREQ 'R'                                120652 191368
      * If retail account and value date = 0                              191368
      * default value date to rundate.                                    191368
     C           BTACTY    IFEQ 'R'                                       191368
     C           BTVLDT    ANDEQ*ZERO                                     120652
     C                     Z-ADDRDNO      BTVLDT                          120652
     C                     END                                            120652
     C/COPY WNCPYSRC,GL0150UC08
     C*                                                                   120652
     C* If retail default 1 to number of items if equal to zero.          120652
     C*                                                                   120652
     C********** BTACTY    IFEQ 'R'                                                   120652 BUG2453
     C********** BTNITM    ANDEQ0                                                     120652 BUG2453
     C           BTNITM    IFEQ 0                                                            BUG2453
     C                     Z-ADD1         BTNITM                          120652
     C                     END                                            120652
     C*                                                                   120652
     C/COPY WNCPYSRC,GL0150UC04
     C* If general ledger and Transaction type entered default to         120652
     C* *BLAMKS.                                                          120652
     C*                                                                   120652
     C           BTACTY    IFEQ 'G'                                       120652
     C           BTTRTY    ANDNE*BLANKS                                   120652
     C                     MOVE *BLANKS   BTTRTY                          120652
     C                     END                                            120652
     C*                                                                   120652
     C* Set shadow posting and retail advice printed to NO.               120652
     C*                                                                   120652
     C                     MOVE 'N'       BTSHPI                          120652
     C*                                                                   120652
     C           BTACTY    IFEQ 'R'                                       120652
     C                     MOVE 'N'       BTRADP                          120652
     C                     END                                            120652
      *                                                                                     AR862752
     C           BTACTY    IFEQ 'N'                                                         AR862752
     C                     MOVE BTCUST    PKCUST                                            AR862752
     C                     MOVE BTCYCD    PKCYCD                                            AR862752
     C                     MOVE BTACCD    PKACCD                                            AR862752
     C                     MOVE BTACSN    PKACSN                                            AR862752
     C                     MOVE BTIBCA    PKBRCD                                            AR862752
      *                                                                                     AR862752
      ** Retrieve Nostro Code                                                               AR862752
      *                                                                                     AR862752
     C                     CALL 'AONOSTR0'                                                  AR862752
     C                     PARM *BLANKS   PRTCD            Return Code                      AR862752
     C                     PARM '*KEY'    POPTN            Option                           AR862752
     C                     PARM           PKCUST           Customer                         AR862752
     C                     PARM           PKCYCD           Currency                         AR862752
     C                     PARM           PKACCD           Account code                     AR862752
     C                     PARM           PKACSN           Account Sequence                 AR862752
     C                     PARM *BLANKS   PKNONB           Nostro No                        AR862752
     C                     PARM           PKBRCD           Branch Code                      AR862752
     C                     PARM *BLANKS   PKUCSN           Cust ShortName                   AR862752
     C                     PARM *BLANKS   PKPNOI           Prime Nost Ind                   AR862752
     C           SDNOST    PARM SDNOST    UUFDY                                             AR862752
      *                                                                                     AR862752
     C           PRTCD     IFEQ *BLANKS                                                     AR862752
     C                     MOVELUUFDY     WORK5   5                                         AR862752
     C                     MOVE WORK5     BTNNBI                                            AR862752
     C                     ENDIF                                                            AR862752
     C                     ENDIF                                                            AR862752
      *                                                                                     MD025865
      ** Populate GLJENPQD fields.                                                          MD025865
      *                                                                                     MD025865
     C                     MOVE BTBTNB    IQBTCH                                            MD025865
     C                     MOVE BTIBCA    IQBRCD                                            MD025865
     C                     Z-ADDBTBINB    IQBITM                                            MD025865
     C                     MOVE *BLANKS   IQFRID                                            MD040602
     C                     Z-ADD0         IQBCRT                                            MD040602
     C                     MOVE *BLANKS   IQBCIN                                            MD040602
      *                                                                                     AR862752
     C/COPY WNCPYSRC,GL0150UC09
     C*                                                                   120652
     C                     ENDSR                                          120652
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVALD - Validate fields                                     *                       CER046
      *                                                               *                       CER046
      *  Called by: Main processing                                   *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVALD    BEGSR                                                              CER046
      *                                                                                       CER046
     C           *NAMVAR   DEFN           ZMUSER                                              CER046
     C                     IN   ZMUSER                                                        CER046
      *                                                                                       CER046
     C                     CLEAROKF                                                           CER046
      *                                                                                       CER046
      ** Validate Branch Code                                                                 CER046
      *                                                                                       CER046
     C                     EXSR SRBRCH                                                        CER046
      *                                                                                       CER046
     C           PBRBT     IFNE DBRN                                                          CER046
     C********** MBIN      ANDNE'N'                                                 CER046 MD025865A
     C           MBIN      ANDEQ'N'                                                        MD025865A
     C********** ID        ANDGT0                                                    CER046 BUG23217
     C           ID        ANDLT1                                                           BUG23217
     C                     Z-ADD1         ID                                                  CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Validate Account                                                                     CER046
      *                                                                                       CER046
     C                     EXSR SRPRC2                                                        CER046
      *                                                                                       CER046
      ** Validate Posting Amount                                                              CER046
      *                                                                                       CER046
     C                     EXSR SRPTAM                                                        CER046
      *                                                                                       CER046
      ** Validate Debit/Credit Indicator                                                      CER046
      *                                                                                       CER046
     C                     EXSR SRVDCI                                                        CER046
      *                                                                                       CER046
      ** Validate Narrative                                                                   CER046
      *                                                                                       CER046
     C                     EXSR SRVNAR                                                        CER046
      *                                                                                       CER046
      ** Validate Type/sub-type                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRTRTY                                                        CER046
      *                                                                                       CER046
      ** Validate Value Date                                                                  CER046
      *                                                                                       CER046
     C                     EXSR SRVDAT                                                        CER046
      *                                                                                       CER046
      ** Validate Cheque Number                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRPROC                                                        CER046
      *                                                                                       CER046
      ** Validate Profit Centre                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRPRC1                                                        CER046
      *                                                                                       CER046
      ** Validate Error Overrides                                                             CER046
      *                                                                                       CER046
     C                     EXSR SREROV                                                        CER046
      *                                                                                       CER046
      ** Validate Associated Customer                                                         CER046
      *                                                                                       CER046
     C                     EXSR SRACUS                                                        CER046
      *                                                                                       CER046
      ** Validate Book Code                                                                   CER046
      *                                                                                       CER046
     C                     EXSR SRBKCD                                                        CER046
      *                                                                                       CER046
      ** Validate Reverse/Void Indicator                                                      CER046
      *                                                                                       CER046
     C                     EXSR SRRVIN                                                        CER046
      *                                                                                       CER046
      ** Number of Items                                                                      CER046
      *                                                                                       CER046
     C           PCMTR     IFEQ 'Y'                                                           CER046
     C                     EXSR SRNITM                                                        CER046
     C                     ELSE                                                               CER046
     C                     MOVEL*ZEROS    BTNITM                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Validate Original Currency/Amount                                                    CER046
      *                                                                                       CER046
     C           CEU013    IFEQ 'Y'                                                           CER046
     C                     EXSR SRORCA                                                        CER046
     C                     ELSE                                                               CER046
     C                     MOVEL*BLANKS   BTOCCY                                              CER046
     C                     MOVEL*ZEROS    BTOAMT                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                     BUG25438
      ** Validate Additional Info and Multicash Narratives                                  BUG25438
      *                                                                                     BUG25438
     C                     EXSR SRAIMN                                                      BUG25438
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRZS - Process Report Lines                                  *                       CER046
      *                                                               *                       CER046
      *  Called by: Main processing                                   *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRZS      BEGSR                                                              CER046
      *                                                                                       CER046
     C                     CALL 'ZSFILE'                                                      CER046
     C                     PARM           PSEQ    5                                           CER046
     C                     PARM           PSENTY  3                                           CER046
     C                     PARM           SFILE                                               CER046
     C                     PARM           SFNUM                                               CER046
     C                     PARM *BLANKS   PZSERR  1                                           CER046
      *                                                                                       CER046
      ** If Error occurs during ZSFILE processing, then return to the                         CER046
      ** Calling Program.                                                                     CER046
      *                                                                                       CER046
     C           PZSERR    IFEQ 'Y'                                                           CER046
     C                     SETON                     U7U8LR                                   CER046
     C                     RETRN                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRWRIT - Process Report Lines                                *                       CER046
      *                                                               *                       CER046
      *  Called by: Main processing                                   *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRWRIT    BEGSR                                                              CER046
      *                                                                                       CER046
      ** RCF Processing                                                                       CER046
      *                                                                                       CER046
     C           WP1RCF    IFEQ 'N'                                                           CER046
     C                     OPEN GL0150P1                                                    BUG23526
     C                     EXSR SRZS                                                          CER046
     C                     MOVEL'Y'       WP1RCF                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     MOVELBTBTNB    RBBTNB                                              CER046
     C                     MOVELBTBINB    RBBINB                                              CER046
     C                     MOVELBTIBCA    RBIBCA                                              CER046
     C                     MOVELBTCUST    RBCUST                                              CER046
      *                                                                                       CER046
      ** Formatting the amount field                                                          CER046
      *                                                                                       CER046
     C                     MOVE BTPTAM    ZFLD15                                              CER046
      *                                                                                       CER046
     C                     CALL 'AOCURRR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM '*KEY   ' POPTN   7                                           CER046
     C                     PARM           BTCYCD                                              CER046
     C           SDCURR    PARM SDCURR    UUSDY                                               CER046
      *                                                                                       CER046
     C                     CALL 'ZSEDIT'                                                      CER046
     C                     PARM           ZFLD15 150                                          CER046
     C                     PARM A6NBDP    ZDECS   10                                          CER046
     C                     PARM 'J'       ZECODE  1                                           CER046
     C                     PARM *BLANKS   ZOUT21 21                                           CER046
      *                                                                                       CER046
     C                     MOVE ZOUT21    RBPTAM                                              CER046
      *                                                                                       CER046
     C                     MOVELBTACCD    RBACCD                                              CER046
     C                     MOVELBTDCIN    RBDCIN                                              CER046
      *                                                                                       CER046
      ** Formatting the date field                                                            CER046
      *                                                                                       CER046
     C                     MOVELBTVLDT    @@DAYN  50                                          CER046
     C                     EXSR ZDATE9                                                        CER046
      *                                                                                       CER046
     C                     MOVEL@@VDT     WDAT    8                                           CER046
      *                                                                                       CER046
     C           4         SUBSTWDAT:1    WYR                                                 CER046
     C           2         SUBSTWDAT:5    WMN                                                 CER046
     C           2         SUBSTWDAT:7    WDY                                                 CER046
      *                                                                                       CER046
     C                     MOVEL'/'       WSP1                                                CER046
     C                     MOVEL'/'       WSP2                                                CER046
      *                                                                                       CER046
     C                     MOVELWDATF     RBVLDT                                              CER046
      *                                                                                       CER046
     C                     MOVELBTNVCD    RBNVCD                                              CER046
     C                     MOVELERMSG,ID  RBSTAT                                              CER046
      *                                                                                       CER046
      ** Check that sufficient lines remain for the Format. If not,                           CER046
      ** write out the Main Headings on a new page.                                           CER046
      *                                                                                       CER046
     C                     Z-ADD1         WRQDLN  10                                          CER046
     C           OFLLN     SUB  PRTLN     WDIFL   20                                          CER046
      *                                                                                       CER046
     C           WDIFL     IFLE WRQDLN                                                        CER046
     C                     WRITEHEADER01                                                      CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Write out Detail Record.                                                             CER046
      *                                                                                       CER046
     C                     WRITEDETAIL01                                                      CER046
      *                                                                                       CER046
     C                     SETOF                     87                                       CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
     C/COPY ZSRSRC,ZDATE9Z3                                                                   CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRBRCH - Validate Branch Code                                *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRBRCH    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Validate The Branch Code                                                             CER046
      *                                                                                       CER046
     C                     CALL 'AOBRCHR1'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM BTIBCA    PKIBCA  3                                           CER046
     C           SDBRCH    PARM SDBRCH    UUSDY                                               CER046
      *                                                                                       CER046
     C                     MOVE ' '       WBRCHE  1                                           CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     Z-ADD1         ID                                                BUG23217
     C                     MOVE 'Y'       WBRCHE                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVNAR - Validate Narrative Codes                            *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVNAR    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Increment Validation Counter                                                         CER046
      *                                                                                       CER046
     C                     Z-ADD5         ID                                                  CER046
      *                                                                                       CER046
      ** Check if Narratives is BLANKS                                                        CER046
      ** Only 1 narrative field is allowed                                                  BUG23669
      *                                                                                       CER046
     C           BTNVCD    IFEQ *BLANKS                                                       CER046
     C           BTNRDC    ANDEQ*BLANKS                                                     BUG23669
     C           BTNVCD    ORNE *BLANKS                                                     BUG23669
     C           BTNRDC    ANDNE*BLANKS                                                     BUG23669
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Check if Narratives exist in File                                                    CER046
      *                                                                                       CER046
     C           BTNVCD    IFNE *BLANKS                                                     BUG23669
     C                     CALL 'AONARRR0'                                                    CER046
     C           PRTCD     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY'    POPTN                                               CER046
     C                     PARM           BTNVCD                                              CER046
     C           SDNARR    PARM SDNARR    UUFDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Narrative desc. must be more than 2 characters                                     BUG23669
      *                                                                                     BUG23669
     C           BTNRDC    IFNE *BLANKS                                                     BUG23669
     C                     MOVE BTNRDC    WNARR  28                                         BUG23669
     C           WNARR     IFEQ *BLANKS                                                     BUG23669
     C                     MOVE 'Y'       PERRF                                             BUG23669
     C                     MOVE 'Y'       OKF,ID                                            BUG23669
     C                     ENDIF                                                            BUG23669
      *                                                                                     BUG23669
     C                     ENDIF                                                            BUG23669
      *                                                                                     BUG23669
     C                     ENDIF                                                            BUG23669
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRTRTY - Validate Transaction Type/Sub Type                  *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRTRTY    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Increment Validation Counter                                                         CER046
      *                                                                                       CER046
     C                     Z-ADD6         ID                                                  CER046
      *                                                                                       CER046
      ** Check if Account Type is 'RETAIL'                                                    CER046
      *                                                                                       CER046
     C           BTACTY    IFNE 'R'                                                           CER046
      *                                                                                       CER046
     C********** BTTRTY    IFEQ *BLANKS                                             CER046 BUG25186B
     C********** BGNVST    ANDEQ'Y'                                                 CER046 BUG25186B
     C           BTTRTY    IFNE *BLANKS                                                    BUG25186B
     C           BGNVST    ANDNE'Y'                                                        BUG25186B
     C           BTTRTY    ORNE *BLANKS                                                       CER046
     C           CEU013    ANDEQ'Y'                                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** When Account Type is 'RETAIL', Transaction Type cannot                               CER046
      ** be BLANKS                                                                            CER046
      *                                                                                       CER046
     C           BTTRTY    IFEQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check if Transaction Type exists in File                                             CER046
      *                                                                                       CER046
     C                     MOVELBTTRTY    KFTRTY  5                                           CER046
      *                                                                                       CER046
     C                     CALL 'AORETRR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY'    POPTN                                               CER046
     C                     PARM           KFTRTY                                              CER046
     C           SDRETR    PARM SDRETR    UUFDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
      ** If not found, check for Management Accounts module                                   CER046
      *                                                                                       CER046
     C           BGNVST    IFNE 'Y'                                                           CER046
     C           CEU013    OREQ 'Y'                                                           CER046
     C           BGNVST    OREQ 'Y'                                                           CER046
     C           CEU013    ANDNE'Y'                                                           CER046
     C           PRTCD     ANDNE*BLANKS                                                       CER046
     C           BTTRTY    OREQ *BLANKS                                                       CER046
     C           BTBKCD    ANDEQ*BLANKS                                                       CER046
     C           BTPRCN    ANDEQ*BLANKS                                                       CER046
     C           BTRVDI    ANDNE'N'                                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Validate if Debit/Credit Indicator of Transaction Type                               CER046
      ** is the same as the Debit/Credit Indicator of the batch                               CER046
      ** item                                                                                 CER046
      *                                                                                       CER046
     C           A1DCIN    IFNE *BLANKS                                                       CER046
     C           A1DCIN    ANDNEBTDCIN                                                        CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRACUS - Validate Associated Customer                        *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRACUS    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Increment Validation Counter                                                         CER046
      *                                                                                       CER046
     C                     Z-ADD11        ID                                                  CER046
      *                                                                                       CER046
      ** If Associated Customer is not BLANKS                                                 CER046
      *                                                                                       CER046
     C           BTACNB    IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Check if it is a Valid Customer                                                      CER046
      *                                                                                       CER046
     C                     CALL 'AOCUSTR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY'    POPTN                                               CER046
     C                     PARM BTACNB    PCUST  10                                           CER046
     C                     PARM *BLANKS   PSTKEY  7                                           CER046
     C           SDCUST    PARM SDCUST    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Compare Associated Customer with A/c Customer only                                   CER046
      ** if Account is acceptable and there are no non-                                       CER046
      ** overrideable RE/GL errors, or A/c Customer is                                        CER046
      ** acceptable and A/c details entered are                                               CER046
      ** incomplete (i.e. one of the following fields                                         CER046
      ** is blank: Ccy, A/c Code, A/c Seq and Input Branch                                    CER046
      ** Code                                                                                 CER046
      *                                                                                       CER046
     C           PACCO     IFEQ *BLANKS                                                       CER046
     C           POVRD     ANDEQ*BLANKS                                                       CER046
     C           PACCO     OREQ '*INCP'                                                       CER046
      *                                                                                       CER046
      ** Do not allow the Associated Customer equal to A/c Customer                        BUG26405A
      ** when system value 'GLJRNECmpAssCust' not equal to 'N'                             BUG26405A
      *                                                                                    BUG26405A
     C                     EXSR SRSVAL                                                     BUG26405A
     C           BTCUST    IFEQ BBCUST                                                        CER046
     C           WNOEQL    ANDNE'N'                                                        BUG26405A
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                               BUG26405A
      *****************************************************************                    BUG26405A
      *                                                               *                    BUG26405A
      *  SRSVAL - Checking System Values File                         *                    BUG26405A
      *                                                               *                    BUG26405A
      *  Called by: SRACUS                                            *                    BUG26405A
      *                                                               *                    BUG26405A
      *  Calls: None                                                  *                    BUG26405A
      *                                                               *                    BUG26405A
      *****************************************************************                    BUG26405A
      *                                                                                    BUG26405A
     C           SRSVAL    BEGSR                                                           BUG26405A
      *                                                                                    BUG26405A
     C                     CALL 'AOSVALR0'                                                 BUG26405A
     C                     PARM           RTNCDE  7                                        BUG26405A
     C                     PARM SVALKK    SVALK1 20                                        BUG26405A
     C                     PARM           SVAL1 200                                        BUG26405A
     C                     PARM *BLANK    SVALK2 20                                        BUG26405A
     C                     PARM           SVAL2 200                                        BUG26405A
     C                     PARM *BLANK    SVALK3 20                                        BUG26405A
     C                     PARM           SVAL3 200                                        BUG26405A
     C                     PARM *BLANK    SVALK4 20                                        BUG26405A
     C                     PARM           SVAL4 200                                        BUG26405A
     C                     PARM *BLANK    SVALK5 20                                        BUG26405A
     C                     PARM           SVAL5 200                                        BUG26405A
     C                     PARM *BLANK    SVALK6 20                                        BUG26405A
     C                     PARM           SVAL6 200                                        BUG26405A
     C                     PARM *BLANK    SVALK7 20                                        BUG26405A
     C                     PARM           SVAL7 200                                        BUG26405A
     C                     PARM *BLANK    SVALK8 20                                        BUG26405A
     C                     PARM           SVAL8 200                                        BUG26405A
     C                     PARM *BLANK    SVALK9 20                                        BUG26405A
     C                     PARM           SVAL9 200                                        BUG26405A
     C                     PARM *BLANK    SVALK0 20                                        BUG26405A
     C                     PARM           SVAL10200                                        BUG26405A
      *                                                                                    BUG26405A
     C           RTNCDE    IFNE *BLANKS                                                    BUG26405A
     C           RTNCDE    ANDNE'*NRF    '                                                 BUG26405A
     C           *LOCK     IN   LDA                                                        BUG26405A
     C                     MOVE 'SCSVALPD'DBFILE                                           BUG26405A
     C                     MOVEL'012'     DBASE                                            BUG26405A
     C                     MOVEL'SVALKK'  DBKEY                                            BUG26405A
     C                     OUT  LDA                                                        BUG26405A
     C                     EXSR *PSSR                                                      BUG26405A
     C                     ENDIF                                                           BUG26405A
      *                                                                                    BUG26405A
     C           SVAL11    IFEQ 'Y'                                                        BUG26405A
     C                     MOVE 'Y'       WNOEQL  1                                        BUG26405A
     C                     ELSE                                                            BUG26405A
     C                     MOVE 'N'       WNOEQL                                           BUG26405A
     C                     ENDIF                                                           BUG26405A
      *                                                                                    BUG26405A
     C                     ENDSR                                                           BUG26405A
      *****************************************************************                    BUG26405A
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVDAT - Validate Value Date                                 *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVDAT    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Increment Validation Counter                                                         CER046
      *                                                                                       CER046
     C                     Z-ADD7         ID                                                  CER046
      *                                                                                       CER046
     C                     MOVE *BLANKS   WERVD                                               CER046
      *                                                                                     BUG25186
      ** Retrieve account details                                                           BUG25186
     C                     CALL 'AOACCTR0'                                                  BUG25186
     C                     PARM *BLANKS   UUAPRC           B:Return Cd                      BUG25186
     C                     PARM '*KEY'    UUAPOP           B:Option                         BUG25186
     C                     PARM *BLANKS   UUACID           I:Account Ident                  BUG25186
     C                     PARM           BTCUST           I:Customer Numb                  BUG25186
     C                     PARM           BTCYCD           I:Currency Code                  BUG25186
     C                     PARM           BTACCD                                            BUG25186
     C                     PARM           BTACSN           I:Account Seque                  BUG25186
     C                     PARM           BTIBCA           I:Branch code                    BUG25186
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format                         BUG25186
      *                                                                                     BUG25186
      *                                                                                       CER046
      ** Account Type is 'RETAIL'                                                             CER046
      *                                                                                       CER046
     C           BTACTY    IFEQ 'R'                                                           CER046
      *                                                                                       CER046
      ** If blanks, default Value Date to rundate                                             CER046
      *                                                                                       CER046
     C           BTVLDT    IFEQ *ZEROS                                                        CER046
     C                     Z-ADDBJRDNB    BTVLDT                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check no. of forward days                                                            CER046
      *                                                                                       CER046
     C           BTVLDT    IFGE BJRDNB                                                        CER046
      *                                                                                       CER046
     C           BJRDNB    ADD  BMNDFV    WNDFV   50                                          CER046
      *                                                                                       CER046
     C           BTVLDT    IFGT WNDFV                                                         CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WERVD   1                                           CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           WERVD     IFNE 'Y'                                                           CER046
      *                                                                                       CER046
      ** Extract back-valuing period                                                          CER046
      *                                                                                       CER046
     C           BJRDNB    SUB  BJBVPD    WBRUN   50                                          CER046
      *                                                                                       CER046
     C           PACCO     IFEQ '*ACID'                                                       CER046
     C           PACCO     ANDEQ'*NRFD'                                                       CER046
     C           PACCO     ANDEQ'*INVD'                                                       CER046
     C           PACCO     ANDEQ'*INCP'                                                       CER046
     C                     MOVE 'Y'       WNRFD   1                                           CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     SELEC                                                              CER046
      *                                                                                       CER046
      ** If CEU013 is installed, Currency is an In Ccy,                                       CER046
      ** Account Code type is 'Retail' and Account not                                        CER046
      ** found, the tests on Account Dates are skipped                                        CER046
      *                                                                                       CER046
     C           CEU013    WHEQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           BTACTY    ANDEQ'R'                                                           CER046
     C           WNRFD     ANDEQ'Y'                                                           CER046
      *                                                                                       CER046
     C           DRIF      WHEQ *BLANKS                                                       CER046
     C           CRIF      ANDEQ*BLANKS                                                       CER046
     C                     EXSR SRDRCR                                                        CER046
      *                                                                                       CER046
     C           DRIF      WHEQ *BLANKS                                                       CER046
     C                     EXSR SRCRIN                                                        CER046
      *                                                                                       CER046
     C           CRIF      WHEQ *BLANKS                                                       CER046
     C                     EXSR SRDRIN                                                        CER046
      *                                                                                       CER046
      ** Check if Value Date is back valued (before rundate)                                  CER046
      *                                                                                       CER046
     C           BTVLDT    WHLT WBRUN                                                         CER046
     C                     MOVE '*BVLDER' WRTCD   7                                           CER046
      *                                                                                       CER046
     C                     ENDSL                                                              CER046
      *                                                                                       CER046
      ** Value Date is before the account was opened                                          CER046
      *                                                                                       CER046
     C           DACO      IFGT BTVLDT                                                        CER046
     C                     MOVE '*DTOPER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           WRTCD     IFEQ '*DTOPER'                                                     CER046
     C           WRTCD     OREQ '*BVLDER'                                                     CER046
     C           WRTCD     OREQ '*DTCRER'                                                     CER046
     C           WRTCD     OREQ '*DTDRER'                                                     CER046
     C           WRTCD     OREQ '*DRCRER'                                                     CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Account Type is not 'RETAIL'                                                         CER046
      *                                                                                       CER046
     C                     MOVE *BLANKS   WALFU   1                                           CER046
      *                                                                                       CER046
      ** If CGL010 is installed, set WALFU to 'Y' when either of the                          CER046
      ** conditions is satisfied                                                              CER046
      *                                                                                       CER046
     C           CGL010    IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
     C           BTACTY    IFEQ 'N'                                                           CER046
     C           BKAFVN    ANDEQ'Y'                                                           CER046
     C           BTACTY    OREQ 'D'                                                           CER046
     C           BKAFVD    ANDEQ'Y'                                                           CER046
     C           BTACTY    OREQ 'C'                                                           CER046
     C           BKAFVC    ANDEQ'Y'                                                           CER046
     C           BTACTY    OREQ 'G'                                                           CER046
     C           BKAFVG    ANDEQ'Y'                                                           CER046
     C                     MOVE 'Y'       WALFU                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Value Date is greater than rundate                                                   CER046
      *                                                                                       CER046
     C           BTVLDT    IFGT BJRDNB                                                        CER046
     C           CGL010    ANDEQ'N'                                                           CER046
     C           CGL010    OREQ 'Y'                                                           CER046
     C           BTVLDT    ANDGTBJRDNB                                                        CER046
     C           WALFU     ANDEQ*BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Value Date is greater than the maximum forward day number for                        CER046
      ** the non-retail account when CGL010 is installed, (Maximum for                        CER046
      ** ward day number is Rundate plus Number of days to Forward                            CER046
      ** value in GL ICD)                                                                     CER046
      *                                                                                       CER046
     C           BTVLDT    IFGT BJRDNB                                                        CER046
     C           WALFU     ANDEQ'Y'                                                           CER046
      *                                                                                       CER046
     C           BJRDNB    ADD  BKNDFV    WFRDN   50                                          CER046
      *                                                                                       CER046
     C           BTVLDT    IFGT WFRDN                                                         CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       WERVD                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           WERVD     IFNE 'Y'                                                           CER046
      *                                                                                       CER046
      ** Extract back-valuing period                                                          CER046
      *                                                                                       CER046
     C           BJRDNB    SUB  BJBVPD    WBRUN   50                                          CER046
      *                                                                                       CER046
     C           PACCO     IFEQ '*ACID'                                                       CER046
     C           PACCO     ANDEQ'*NRFD'                                                       CER046
     C           PACCO     ANDEQ'*INVD'                                                       CER046
     C           PACCO     ANDEQ'*INCP'                                                       CER046
     C                     MOVE 'Y'       WNRFD   1                                           CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     SELEC                                                              CER046
      *                                                                                       CER046
      ** If CEU013 is installed, Currency is an In Ccy,                                       CER046
      ** Account Code type is 'Retail' and Account not                                        CER046
      ** found, the tests on Account Dates are skipped                                        CER046
      *                                                                                       CER046
     C           CEU013    WHEQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           BTACTY    ANDEQ'N'                                                           CER046
     C           WNRFD     ANDEQ'Y'                                                           CER046
      *                                                                                       CER046
      ** Value Date is before the account was opened                                          CER046
      *                                                                                       CER046
     C           DACO      WHGT BTVLDT                                                        CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
      ** Check if Value Date is back valued (before rundate)                                  CER046
      *                                                                                       CER046
     C           BTVLDT    WHLT WBRUN                                                         CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDSL                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRDRCR - Debit and Credit Interest Bearing                   *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVDAT                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRDRCR    BEGSR                                                              CER046
      *                                                                                       CER046
     C           LDID      IFGT LCID                                                          CER046
      *                                                                                       CER046
     C           WBRUN     IFLT LDID                                                          CER046
      *                                                                                       CER046
     C           BTVLDT    IFLT WBRUN                                                         CER046
     C                     MOVE '*DRCRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
     C           BTVLDT    IFLT LDID                                                          CER046
     C                     MOVE '*DRCRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C           WBRUN     IFLT LCID                                                          CER046
      *                                                                                       CER046
     C           BTVLDT    IFLT WBRUN                                                         CER046
     C                     MOVE '*DRCRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
     C           BTVLDT    IFLT LCID                                                          CER046
     C                     MOVE '*DRCRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRCRIN - Credit Interest Bearing                             *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVDAT                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRCRIN    BEGSR                                                              CER046
      *                                                                                       CER046
     C           LCID      IFGT WBRUN                                                         CER046
      *                                                                                       CER046
     C           BTVLDT    IFLT WBRUN                                                         CER046
     C                     MOVE '*DTCRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
     C           BTVLDT    IFLT LCID                                                          CER046
     C                     MOVE '*DTCRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRDRIN - Debit Interest Bearing                              *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVDAT                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRDRIN    BEGSR                                                              CER046
      *                                                                                       CER046
     C           LDID      IFGT WBRUN                                                         CER046
      *                                                                                       CER046
     C           BTVLDT    IFLT WBRUN                                                         CER046
     C                     MOVE '*DTDRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
     C           BTVLDT    IFLT LDID                                                          CER046
     C                     MOVE '*DTDRER' WRTCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRBKCD - Validate Book Code                                  *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRBKCD    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Validate Book Code                                                                   CER046
      *                                                                                       CER046
     C                     Z-ADD12        ID                                                  CER046
      *                                                                                       CER046
     C           BTBKCD    IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Access Book Codes file through the Access Object                                     CER046
      *                                                                                       CER046
     C                     CALL 'AOBOOKR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM BTBKCD    PBKCD   2                                           CER046
     C           SDBOOK    PARM SDBOOK    UUFDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRRVIN - Validate Reverse/Void Indicator                     *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRRVIN    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD13        ID                                                  CER046
      *                                                                                       CER046
      ** Validate Reverse/Void Indicator                                                      CER046
      *                                                                                       CER046
     C           BTRVDI    IFNE *BLANKS                                                       CER046
     C           BTRVDI    ANDNE'Y'                                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRNITM - Validate No. of Items                               *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRNITM    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Validate No. of Items                                                                CER046
      *                                                                                       CER046
     C                     Z-ADD14        ID                                                  CER046
      *                                                                                       CER046
     C           BTNITM    IFLT *ZERO                                                         CER046
     C           BTNITM    ORGT 99999                                                         CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRORCA - Validate Original Currency and Amount               *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: SRGTOC, SRVOCY                                        *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRORCA    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD15        ID                                                  CER046
      *                                                                                       CER046
     C                     MOVE ' '       WEROA   1                                           CER046
      *                                                                                       CER046
      ** Get Currency details                                                                 CER046
      *                                                                                       CER046
     C                     EXSR SRGTOC                                                        CER046
     C                     MOVE BTOAMT    WORAMT 150                                          CER046
      *                                                                                       CER046
      ** Input is allowed only if Currency is 'Euro'                                          CER046
      ** or 'In' Currency.                                                                    CER046
      *                                                                                       CER046
     C           PINCY     IFEQ 'Y'                                                           CER046
     C           BTCYCD    OREQ BKEURO                                                        CER046
      *                                                                                       CER046
      ** Generate error if Original Currency is not existing.                                 CER046
      *                                                                                       CER046
     C           WCCYNR    IFNE *BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
     C                     GOTO ENDVAL                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Validate Original Currency and then, validate Original                               CER046
      ** Currency and Amount combination.                                                     CER046
      *                                                                                       CER046
     C                     EXSR SRVOCY                                                        CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Otherwise, generate error message if Original Currency                               CER046
      ** or Amount is not blank.                                                              CER046
      *                                                                                       CER046
     C           BTOCCY    IFNE *BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
     C                     GOTO ENDVAL                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           BTOAMT    IFNE *ZEROS                                                        CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
     C                     GOTO ENDVAL                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           ENDVAL    ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRGTOC - Validate Original Currency                          *                       CER046
      *                                                               *                       CER046
      *  Called by: SRORCA                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRGTOC    BEGSR                                                              CER046
      *                                                                                       CER046
     C           BTOCCY    IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Access Currency file for details                                                     CER046
      *                                                                                       CER046
     C                     CALL 'AOCURRR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM '*KEY   ' POPTN   7                                           CER046
     C                     PARM BTOCCY    PCYCD   3                                           CER046
     C           SDCURR    PARM SDCURR    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVELA6NBDP    WNBDP   10                                          CER046
     C                     MOVELA6INCY    WINCY   1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE 'Y'       WCCYNR  1                                           CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVOCY - Validate Original Currency                          *                       CER046
      *                                                               *                       CER046
      *  Called by: SRORCA                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: SRCYAM                                                *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVOCY    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Error if Original Currency is blanks but Amount is entered.                          CER046
      *                                                                                       CER046
     C           BTOCCY    IFEQ *BLANKS                                                       CER046
     C           BTOAMT    ANDNE*ZEROS                                                        CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
     C                     GOTO ENDVL1                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Validate Original Currency if not blanks.                                            CER046
      *                                                                                       CER046
     C           BTOCCY    IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     SELEC                                                              CER046
      *                                                                                       CER046
      ** Original Currency must not be same as Account Currency.                              CER046
      *                                                                                       CER046
     C           BTOCCY    WHEQ BTCYCD                                                        CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
      *                                                                                       CER046
      ** Original Currency must be either 'EURO' or 'In' Currency.                            CER046
      *                                                                                       CER046
     C           BTOCCY    WHNE BKEURO                                                        CER046
     C           WINCY     ANDNE'Y'                                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
      *                                                                                       CER046
      ** Error if Original Amount is blanks but Currency is entered                           CER046
      *                                                                                       CER046
     C           BTOAMT    WHEQ *ZEROS                                                        CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
      *                                                                                       CER046
      ** Validate Original Currency and Amount combination.                                   CER046
      *                                                                                       CER046
     C                     OTHER                                                              CER046
     C                     EXSR SRCYAM                                                        CER046
      *                                                                                       CER046
     C                     ENDSL                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           ENDVL1    ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRCYAM - Validate Original Currency and Amount combination   *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVOCY                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: SRECVT                                                *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRCYAM    BEGSR                                                              CER046
      *                                                                                       CER046
      ** If Euro or In Currency and Amount entered, generate                                  CER046
      ** error if Amount not valid.                                                           CER046
      *                                                                                       CER046
     C           BTOAMT    IFLE *ZEROS                                                        CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'Y'       WEROA                                               CER046
     C                     GOTO ENDVL2                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** If no errors found, perform Currency Amount conversion.                              CER046
      *                                                                                       CER046
     C           WEROA     IFEQ *BLANKS                                                       CER046
      *                                                                                       CER046
      ** If Posting Currency or Original Currency is Euro, call                               CER046
      ** conversion program once.                                                             CER046
      *                                                                                       CER046
     C           BTCYCD    IFEQ BKEURO                                                        CER046
     C           BTOCCY    OREQ BKEURO                                                        CER046
     C                     Z-ADDBTPTAM    WFRAM  183                                          CER046
     C                     MOVELBTCYCD    WFRCY   3                                           CER046
     C                     MOVELBTOCCY    WTOCY   3                                           CER046
     C                     EXSR SRECVT                                                        CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** If Posting Currency and Original Currency are 'In' Currencies,                       CER046
      ** then conversion program is called twice.                                             CER046
      ** The first call converts the Posting Amount to Euro Currency.                         CER046
      ** The second call converts the Euro Currency amount to 'In'                            CER046
      ** Currency Original Amount.                                                            CER046
      *                                                                                       CER046
     C                     Z-ADDBTPTAM    WFRAM                                               CER046
     C                     MOVELBTCYCD    WFRCY                                               CER046
     C                     MOVELBKEURO    WTOCY                                               CER046
     C                     EXSR SRECVT                                                        CER046
     C                     Z-ADDWOUTA     WFRAM                                               CER046
     C                     MOVELBKEURO    WFRCY                                               CER046
     C                     MOVELBTOCCY    WTOCY                                               CER046
     C                     EXSR SRECVT                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check if there is difference between the converted                                   CER046
      ** Amount and the entered Original Amount.                                              CER046
      *                                                                                       CER046
     C                     Z-ADDWOUTA     WOAMT  150                                          CER046
     C           WORAMT    SUB  WOAMT     WDIFF  150                                          CER046
      *                                                                                       CER046
     C           WDIFF     IFGT 1                                                             CER046
     C           WDIFF     ORLT -1                                                            CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     GOTO ENDVL2                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           ENDVL2    ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRECVT - Convert Euro to 'In' Currency and vice versa        *                       CER046
      *                                                               *                       CER046
      *  Called by: SRCYAM                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRECVT    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD0         WOUTA  150                                          CER046
     C                     Z-ADD0         WINTA  183                                          CER046
      *                                                                                       CER046
     C                     CALL 'EU0200'                                                      CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM WFRAM     PFRAM  183                                          CER046
     C                     PARM WFRCY     PFRCY   3                                           CER046
     C                     PARM WTOCY     PTOCY   3                                           CER046
     C           WOUTA     PARM WOUTA     POUTA  150                                          CER046
     C           WINTA     PARM WINTA     PINTA  183                                          CER046
     C                     PARM           PEXRT  159                                          CER046
     C                     PARM           PMDIN   1                                           CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ '*ERROR*'                                                     CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     GOTO ENDVL3                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           ENDVL3    ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SREROV - Validate Error Overrides                            *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: SRACST, SRACOT                                        *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SREROV    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD10        ID                                                  CER046
      *                                                                                       CER046
     C                     MOVE 'O'       WRERST  1                                           CER046
     C                     MOVE *BLANKS   WERROR  8                                           CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WRINE   1                                           CER046
     C                     MOVE *BLANKS   POVRD                                               CER046
      *                                                                                       CER046
      ** Check Retail Account status if Account is acceptable.                                CER046
      *                                                                                       CER046
     C           BTACTY    IFEQ 'R'                                                           CER046
      *                                                                                       CER046
     C           PACCO     IFEQ *BLANKS                                                       CER046
     C                     EXSR SRACST                                                        CER046
     C                     EXSR SRACOT                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C           CGL002    IFEQ 'Y'                                                           CER046
     C           BTACTY    ANDEQ'G'                                                           CER046
     C                     EXSR SRACST                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           WRINE     IFEQ 'N'                                                           CER046
     C                     MOVEL*BLANKS   BTRINO                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRACST - Check Account Error Status                          *                       CER046
      *                                                               *                       CER046
      *  Called by: SREROV                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: SROVRD                                                *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRACST    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Check Refer Debits.                                                                  CER046
      *                                                                                       CER046
     C           BTDCIN    IFEQ 'D'                                                           CER046
     C**********           TESTB'0'       RETB    1  01                              CER046 BUG23477
     C                     TESTB'0'       RETB    1      01                          CER046 BUG23477
     C           *IN01     IFEQ *ON                                                           CER046
     C                     MOVE 'Refer Dr'WERROR                                              CER046
     C           WRRE01    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ELSE                                                             MD040884
     C                     MOVE '0'       WRERST                                            MD040884
     C                     MOVE 'Y'       BTRINO                                            MD040884
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check Refer Credits.                                                                 CER046
      *                                                                                       CER046
     C           BTDCIN    IFEQ 'C'                                                           CER046
     C**********           TESTB'1'       RETB       01                              CER046 BUG23477
     C                     TESTB'1'       RETB           01                          CER046 BUG23477
     C           *IN01     IFEQ *ON                                                           CER046
     C                     MOVE 'Refer Cr'WERROR                                              CER046
     C           WRRE02    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ELSE                                                             MD040884
     C                     MOVE '0'       WRERST                                            MD040884
     C                     MOVE 'Y'       BTRINO                                            MD040884
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check Block Debits.                                                                  CER046
      *                                                                                       CER046
     C           BTDCIN    IFEQ 'D'                                                           CER046
     C**********           TESTB'2'       RETB       01                              CER046 BUG23477
     C                     TESTB'2'       RETB           01                          CER046 BUG23477
     C           *IN01     IFEQ *ON                                                           CER046
     C                     MOVE 'Block Dr'WERROR                                              CER046
     C           WRRE03    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check Block Credits.                                                                 CER046
      *                                                                                       CER046
     C           BTDCIN    IFEQ 'C'                                                           CER046
     C**********           TESTB'3'       RETB       01                              CER046 BUG23477
     C                     TESTB'3'       RETB           01                          CER046 BUG23477
     C           *IN01     IFEQ *ON                                                           CER046
     C                     MOVE 'Block Cr'WERROR                                              CER046
     C           WRRE04    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRACOT - Check Account's Other Error Status                  *                       CER046
      *                                                               *                       CER046
      *  Called by: SREROV                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: SROVRD                                                *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRACOT    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Check Inactive A/c.                                                                  CER046
      *                                                                                       CER046
     C**********           TESTB'4'       RETB       01                              CER046 BUG23477
     C                     TESTB'4'       RETB           01                          CER046 BUG23477
     C           *IN01     IFEQ *ON                                                           CER046
     C                     MOVE 'Inactive'WERROR                                              CER046
     C           WRRE05    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check if Bankrupt.                                                                   CER046
      *                                                                                       CER046
     C**********           TESTB'6'       RETB       01                              CER046 BUG23477
     C                     TESTB'6'       RETB           01                          CER046 BUG23477
     C           *IN01     IFEQ *ON                                                           CER046
     C                     MOVE 'Bankrupt'WERROR                                              CER046
     C           WRRE07    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check Bad Debt.                                                                      CER046
      *                                                                                       CER046
     C**********           TESTB'7'       RETB       01                              CER046 BUG23477
     C                     TESTB'7'       RETB           01                          CER046 BUG23477
     C           *IN01     IFEQ *ON                                                           CER046
     C                     MOVE 'Bad Debt'WERROR                                              CER046
     C           WRRE08    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check Stopped Cheque.                                                                CER046
      *                                                                                       CER046
     C           PSTOP     IFEQ '*STOP  '                                                     CER046
     C                     MOVE 'Chq.Stop'WERROR                                              CER046
     C           WRRE09    IFNE 'Y'                                                           CER046
     C                     MOVEL'E'       WRERST                                              CER046
     C                     ENDIF                                                              CER046
     C                     EXSR SROVRD                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SROVRD - Issue appropriate Override error message            *                       CER046
      *                                                               *                       CER046
      *  Called by: SRACOT, SRACOT                                    *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SROVRD    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     SELEC                                                              CER046
      *                                                                                       CER046
      ** Error is non-overrideable.  Set Retail Override Indicator                            CER046
      ** to 'N'.  Set Non-overrideable flag to 'Y'.                                           CER046
      *                                                                                       CER046
     C           WRERST    WHEQ 'E'                                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     MOVE 'N'       BTRINO                                              CER046
     C                     MOVE 'Y'       POVRD   1                                           CER046
      *                                                                                       CER046
      ** Error is overrideable.                                                               CER046
      *                                                                                       CER046
     C           WRERST    WHEQ 'O'                                                           CER046
     C           BTRINO    IFEQ 'N'                                                           CER046
     C           BTRINO    OREQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           BTRINO    IFNE 'Y'                                                           CER046
     C           BTRINO    ANDNE'N'                                                           CER046
     C           BTRINO    ANDNE*BLANKS                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSL                                                              CER046
      *                                                                                       CER046
      ** Reset Overrideable Error status.                                                     CER046
      *                                                                                       CER046
     C                     MOVE 'O'       WRERST                                              CER046
      *                                                                                       CER046
      ** Set Retail Indicator in Error to 'Y'.                                                CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       WRINE                                               CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVDCI - Validate Debit/Credit Indicator                     *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
     C           SRVDCI    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD4         ID                                                  CER046
      *                                                                                       CER046
     C           BTDCIN    IFNE 'C'                                                           CER046
     C           BTDCIN    ANDNE'D'                                                           CER046
      *                                                                                       CER046
     C                     MOVEL'Y'       OKF,ID                                              CER046
     C                     MOVEL'Y'       PERRF                                               CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRPTAM - Validate Posting Amount                             *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
     C           SRPTAM    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD3         ID                                                  CER046
      *                                                                                       CER046
      ** If Amount is Zeros, then error.                                                      CER046
      *                                                                                       CER046
     C           BTPTAM    IFEQ *ZEROS                                                        CER046
     C                     MOVEL'Y'       OKF,ID                                              CER046
     C                     MOVEL'Y'       PERRF                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRPROC - Process Cheque Number input                         *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRPROC    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD8         ID                                                  CER046
      *                                                                                       CER046
     C           BTCQNB    IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
      ** If account type is not Retail, then error.                                           CER046
      *                                                                                       CER046
     C           BTACTY    IFNE 'R'                                                           CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRVLCQ                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVLCQ - Validate Cheque Number                              *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVLCQ    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Determine if Cheque Number is numeric with no blank                                  CER046
      ** character.                                                                           CER046
      *                                                                                       CER046
     C                     MOVEABTCQNB    WCQAR                                               CER046
      *                                                                                       CER046
     C           WERCD     DOWEQ'N'                                                           CER046
     C           WIDX      ANDLT8                                                             CER046
      *                                                                                       CER046
     C                     ADD  1         WIDX    10                                          CER046
     C           WCQAR,WIDXIFEQ *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       WERCD   1                                           CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDDO                                                              CER046
      *                                                                                       CER046
     C           WERCD     IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Determine if Cheque No. is numeric.                                                  CER046
      *                                                                                       CER046
     C                     TESTN          BTCQNB     01                                       CER046
     C           *IN01     IFEQ *OFF                                                          CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRSTOP                                                        CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRSTOP - Determine if Stopped Cheque                         *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRSTOP    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Determine if Stopped Cheque.                                                         CER046
      *                                                                                       CER046
     C           BTDCIN    IFEQ 'D'                                                           CER046
      *                                                                                       CER046
     C                     CALL 'AOSTOPV0'                                                    CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM BTPTAM    PCQAM  130                                          CER046
     C                     PARM BTCQNB    PCQNB   8                                           CER046
     C                     PARM BTRACN    PRACN  100                                          CER046
     C                     PARM BTCUST    WPCUST  6                                           CER046
     C                     PARM BTCYCD    PCYCD   3                                           CER046
     C                     PARM BTACCD    WPACCD  4                                           CER046
     C                     PARM BTACSN    PACSN   2                                           CER046
     C                     PARM BTIBCA    PBRCD   3                                           CER046
      *                                                                                       CER046
      ** Pass return code for override validation.                                            CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ '*STOP  '                                                     CER046
     C                     MOVE PRTCD     PSTOP   7                                           CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRPRC1 - Process Profit Centre input                         *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRPRC1    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD9         ID                                                  CER046
      *                                                                                       CER046
     C           PACCO     IFEQ *BLANKS                                                       CER046
     C           PACCO     OREQ '*DIFF'                                                       CER046
     C           PACCO     OREQ '*CLSD'                                                       CER046
     C                     MOVE 'Y'       PACFD   1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE ' '       PACFD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** If Profit Centre is not blank, validate value entered.                               CER046
      ** Otherwise, check if defaulting is possible.                                          CER046
      *                                                                                       CER046
     C           BTPRCN    IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     EXSR SRVPCN                                                        CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRCKDT                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** If Analytical Accounting is on and Profit Centre is                                  CER046
      ** still blank at this point, then issue an error.                                      CER046
      *                                                                                       CER046
     C           BGN0ST    IFEQ 'Y'                                                           CER046
     C           BTPRCN    ANDEQ*BLANKS                                                       CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVPCN - Validate Profit Centre entered                      *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVPCN    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Access Profit Centre file for details.                                               CER046
      *                                                                                       CER046
     C                     CALL 'AOPRFCR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM '*KEY'    POPTN   7                                           CER046
     C                     PARM BTPRCN    PPRCN   4                                           CER046
     C           SDPRFC    PARM SDPRFC    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRACPC                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRACPC - Verify Profit Centre if equal to Account Profit     *                       CER046
      *           Centre                                              *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRACPC    BEGSR                                                              CER046
      *                                                                                       CER046
      ** If Analytical Accounting is on, Account is found and is                              CER046
      ** Retail or Nostro, issue a warning if Profit Centre                                   CER046
      ** entered is not equal to the Account Profit Centre.                                   CER046
      *                                                                                       CER046
     C           BGN0ST    IFEQ 'Y'                                                           CER046
     C           PACFD     ANDEQ'Y'                                                           CER046
     C           BTACTY    ANDEQ'R'                                                           CER046
      *                                                                                       CER046
     C           BGN0ST    OREQ 'Y'                                                           CER046
     C           PACFD     ANDEQ'Y'                                                           CER046
     C           BTACTY    ANDEQ'N'                                                           CER046
      *                                                                                       CER046
     C           BTPRCN    IFNE PRFC                                                          CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRCKDT - Check if Profit Centre Defaulting is possible       *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRCKDT    BEGSR                                                              CER046
      *                                                                                       CER046
      ** If Default Profit Centre is used                                                     CER046
      *                                                                                       CER046
     C           BKPCDU    IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
      ** If Analytical Accounting is on, Account is found and is                              CER046
      ** Retail or Nostro, default Profit Centre to Account                                   CER046
      ** Profit Centre.                                                                       CER046
      *                                                                                       CER046
     C           BGN0ST    IFEQ 'Y'                                                           CER046
     C           PACFD     ANDEQ'Y'                                                           CER046
     C           BTACTY    ANDEQ'R'                                                           CER046
      *                                                                                       CER046
     C           BGN0ST    OREQ 'Y'                                                           CER046
     C           PACFD     ANDEQ'Y'                                                           CER046
     C           BTACTY    ANDEQ'N'                                                           CER046
      *                                                                                       CER046
     C                     MOVELPRFC      BTPRCN                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Retrieve Default Profit Centre.                                                      CER046
      *                                                                                       CER046
     C                     EXSR SRGDPC                                                        CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRGDPC - Get Default Profit Centre                           *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRGDPC    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Set up Customer and Account Officer.                                                 CER046
      *                                                                                       CER046
     C                     MOVELPCUST     W2CUST                                              CER046
     C                     EXSR SRACOF                                                        CER046
      *                                                                                       CER046
     C                     CALL 'AOPRFMR0'                                                    CER046
     C                     PARM           PRETC   1                                           CER046
     C                     PARM BTBKCD    PBKCD   2                                           CER046
     C                     PARM BTTRTY    PPCTT   5                                           CER046
     C                     PARM BTTSTY    PSBTY   2                                           CER046
     C                     PARM BTIBCA    PBRCD   3                                           CER046
     C                     PARM *BLANKS   PDPCD   3                                           CER046
     C                     PARM WUSER     PUSID  10                                           CER046
     C                     PARM           PACOC   2                                           CER046
     C                     PARM           W2CUST  6                                           CER046
     C                     PARM *BLANKS   PPCCD   4                                           CER046
      *                                                                                       CER046
     C                     SELEC                                                              CER046
      *                                                                                       CER046
     C           PRETC     WHEQ '0'                                                           CER046
     C                     MOVELPPCCD     BTPRCN                                              CER046
      *                                                                                       CER046
     C           PRETC     WHEQ '1'                                                           CER046
     C                     MOVEL*BLANKS   BTPRCN                                              CER046
      *                                                                                       CER046
     C           PRETC     WHEQ '2'                                                           CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDSL                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRACOF - Get Account Officer                                 *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRACOF    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Use Associated Customer and its A/c Officer if Associated                            CER046
      ** Customer is set up.  Otherwise, use batch Customer and                               CER046
      ** its A/c Officer.                                                                     CER046
      *                                                                                       CER046
     C           PCUST     IFNE *BLANKS                                                       CER046
     C                     MOVELBBCUST    PCUST                                               CER046
     C                     MOVELBBACOC    PACOC                                               CER046
      *                                                                                       CER046
     C           PACOC     IFEQ *BLANKS                                                       CER046
     C                     MOVELPCUST     PACNB                                               CER046
     C                     CALL 'AOCUSTR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM '*KEY   ' POPTN   7                                           CER046
     C                     PARM           PACNB  10                                           CER046
     C                     PARM *BLANKS   PCRST   7                                           CER046
     C           SDCUST    PARM SDCUST    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVELBBACOC    PACOC                                               CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRPRC2 - Process Account input                               *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRPRC2    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WHEAD   1                                           CER046
     C                     MOVE 'N'       W2RNBE                                              CER046
     C                     MOVE 'Y'       WRPLCE                                              CER046
     C                     MOVE *BLANKS   PACCO                                               CER046
     C                     MOVE *BLANKS   PINCY                                               CER046
     C                     MOVE *BLANKS   PINVAC                                              CER046
      *                                                                                    BUG25186E
     C           CER046    IFEQ 'Y'                                                        BUG25186E
     C                     EXSR SRRACT                                                     BUG25186E
     C                     ENDIF                                                           BUG25186E
      *                                                                                       CER046
      ** Fill Acct identifier field with value from Ret acct no,                              CER046
      ** Nostro no or Cust no, whichever has a value.                                         CER046
      *                                                                                       CER046
     C           BTRACN    IFNE *ZEROS                                                        CER046
     C           BTACTY    ANDEQ'R'                                                        BUG25186D
     C                     MOVELBTRACN    DDACID 10                                           CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C           BTNNBI    IFNE *BLANKS                                                       CER046
     C                     MOVE *BLANKS   DDACID                                           BUG25186C
     C**********           MOVELBTNNBI    DDACID                                     CER046 AR862752
     C                     MOVELBTCYCD    DDACID                                            AR862752
     C                     MOVE BTNNBI    WACM2                                             AR862752
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** If the two fields were blank, assume that the third one has                          CER046
      ** a value                                                                              CER046
      *                                                                                       CER046
     C                     MOVE *BLANKS   DDACID                                           BUG25186C
     C                     MOVELBTCUST    DDACID                                              CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Get the batch header details                                                         CER046
      *                                                                                       CER046
     C           BTBTNB    IFNE *BLANKS                                                       CER046
     C********** BTBTNB    CHAINGLJENHL1             22                              CER046 BUG23404
     C           BTBTNB    CHAINGLJEIHL1             22                                     BUG23404
     C           *IN22     IFEQ '0'                                                           CER046
     C                     MOVE 'Y'       WHEAD                                               CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD2         ID                                                  CER046
      *                                                                                       CER046
      ** If Account Id is blank, use Associated Front Office Id to                            CER046
      ** access Accounts file.                                                                CER046
      *                                                                                       CER046
     C           DDACID    IFEQ *BLANKS                                                       CER046
     C                     MOVE '*AFOID*' WTYPE   7                                           CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Determine the type of the entry for Account Id.                                      CER046
      *                                                                                       CER046
     C                     EXSR SRGTTP                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Validate Currency.                                                                   CER046
      *                                                                                       CER046
     C                     EXSR SRVCCY                                                        CER046
      *                                                                                       CER046
      ** Validate Account Code.                                                               CER046
      *                                                                                       CER046
     C                     EXSR SRVACC                                                        CER046
      *                                                                                       CER046
      ** Validate Account Sequence.                                                           CER046
      *                                                                                       CER046
     C                     EXSR SRVACS                                                        CER046
      *                                                                                       CER046
      ** Validate Input Branch Code.                                                          CER046
      *                                                                                       CER046
     C                     EXSR SRVBRC                                                        CER046
      *                                                                                       CER046
      ** Further validation of the Account.                                                   CER046
      *                                                                                       CER046
     C                     SELEC                                                              CER046
      *                                                                                       CER046
     C           WTYPE     WHEQ '*RETAIL'                                                     CER046
     C                     EXSR SRVRTL                                                        CER046
      *                                                                                       CER046
     C           WTYPE     WHEQ '*NOSTRO'                                                     CER046
     C                     EXSR SRVNST                                                        CER046
      *                                                                                       CER046
     C           WTYPE     WHEQ '*CUST**'                                                     CER046
     C                     EXSR SRVFAC                                                        CER046
      *                                                                                       CER046
     C           WTYPE     WHEQ '*AFOID*'                                                     CER046
     C                     EXSR SRVAFO                                                        CER046
      *                                                                                       CER046
     C                     OTHER                                                              CER046
      *                                                                                       CER046
      ** If A/c Id in error, set Account flag to '*ACID'.                                     CER046
      *                                                                                       CER046
     C                     MOVEL'*ACID'   PACCO                                               CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDSL                                                              CER046
      *                                                                                       CER046
      ** Check if Journal Entry Non-Retail is selected                                        CER046
      *                                                                                       CER046
     C           CGL037    IFEQ 'Y'                                                           CER046
     C           DDACID    ANDNE*BLANKS                                                       CER046
      *                                                                                       CER046
     C           *NAMVAR   DEFN           ZMITEM                                              CER046
     C                     IN   ZMITEM                                                        CER046
      *                                                                                       CER046
     C           INDX      IFEQ CONT                                                          CER046
      *                                                                                       CER046
      ** Retrieve and validate Account details.                                               CER046
      *                                                                                       CER046
     C                     EXSR SRRKEY                                                        CER046
     C                     MOVELDDACID    PKCUST                                              CER046
     C                     MOVELBTCYCD    PKCYCD                                              CER046
     C                     MOVELBTACCD    PKACCD 10                                           CER046
     C                     MOVELBTACSN    PKACSN                                              CER046
     C                     MOVELBTIBCA    PKBRCD                                              CER046
      *                                                                                       CER046
     C                     EXSR SRAACC                                                        CER046
      *                                                                                       CER046
      ** If it is a retail account then error.                                                CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C           ATYP      ANDEQ'R'                                                           CER046
      *                                                                                       CER046
     C           STYP      IFNE 'V'                                                           CER046
     C           STYP      ANDNE'I'                                                           CER046
      *                                                                                       CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRGTTP - Determine the type of the entry for Account Id      *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRGTTP    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     MOVE DDACID    WDACID                                              CER046
      *                                                                                       CER046
      ** Check for retail account                                                             CER046
      *                                                                                       CER046
     C           BTACTY    IFEQ 'R'                                                           CER046
     C                     MOVEL'*RETAIL' WTYPE                                               CER046
     C                     GOTO ESRGT                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check for nostro.                                                                    CER046
      *                                                                                       CER046
     C           BTACTY    IFEQ 'N'                                                           CER046
     C                     MOVE '*NOSTRO' WTYPE                                               CER046
     C                     GOTO ESRGT                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Set as Customer number                                                               CER046
      *                                                                                       CER046
     C           WACF6     IFNE *BLANKS                                                       CER046
     C                     MOVE '*CUST**' WTYPE                                               CER046
     C                     GOTO ESRGT                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Error if entry is other than the                                                     CER046
      ** above.  Tag the Account Id as error and save first                                   CER046
      ** 6 characters of the Account Id.                                                      CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     MOVEL'*ERROR*' WTYPE                                               CER046
     C                     MOVELDDACID    W2CUST                                              CER046
      *                                                                                       CER046
     C           ESRGT     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVCCY - Validate Currency                                   *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVCCY    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD*ZEROS    PNBDP   10                                          CER046
     C                     MOVE *BLANKS   PINCY   1                                           CER046
      *                                                                                       CER046
     C           BTCYCD    IFEQ *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Field is mandatory if account identifier is a customer.                              CER046
      *                                                                                       CER046
     C           WTYPE     IFEQ '*CUST**'                                                     CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WCYCOK  1                                           CER046
     C                     MOVE 'Y'       PERRF   1                                           CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** If not question mark, verify if Currency exists in file.                             CER046
      *                                                                                       CER046
     C                     CALL 'AOCURRR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM '*KEY   ' POPTN   7                                           CER046
     C                     PARM BTCYCD    PKCCY   3                                           CER046
     C           SDCURR    PARM SDCURR    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WCYCOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
     C                     MOVE A6NBDP    PNBDP                                               CER046
     C                     MOVE A6INCY    PINCY                                               CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVACC - Validate Account Code                               *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVACC    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     MOVE *BLANK    W2ACTY                                              CER046
      *                                                                                       CER046
     C           BTACCD    IFEQ *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Field is mandatory if account identifier is a customer.                              CER046
      *                                                                                       CER046
     C           WTYPE     IFEQ '*CUST**'                                                     CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WACDOK  1                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C                     TESTN          BTACCD     01                                       CER046
      *                                                                                       CER046
      ** Entry is not a 4-digit input                                                         CER046
      ** has been entered.                                                                    CER046
      *                                                                                       CER046
     C           *IN01     IFEQ *OFF                                                          CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WACDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Verify if Account Code exists.                                                       CER046
      *                                                                                       CER046
     C                     CALL 'AOACODR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM BTACCD    PKACOD 10                                           CER046
     C           SDACOD    PARM SDACOD    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WACDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
     C                     MOVE A5ACTY    W2ACTY                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVACS - Validate Account Sequence                           *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVACS    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Field is mandatory if account identifier is a customer.                              CER046
      *                                                                                       CER046
     C           BTACSN    IFEQ *BLANKS                                                       CER046
     C           WTYPE     ANDEQ'*CUST**'                                                     CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WASNOK  1                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVBRC - Validate Branch                                     *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVBRC    BEGSR                                                              CER046
      *                                                                                       CER046
      ** If system is single-branching, default Input Branch Code                             CER046
      ** and Header Branch to Bank's Single Branch Code.                                      CER046
      *                                                                                       CER046
     C           BJSBRC    IFNE *BLANKS                                                       CER046
     C                     MOVELBJSBRC    BTIBCA                                              CER046
     C                     MOVELBJSBRC    W2BCBH  3                                           CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     MOVE *BLANKS   PLCCD   3                                           CER046
      *                                                                                       CER046
     C           BTIBCA    IFEQ *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Field is mandatory if account identifier is a customer.                              CER046
      *                                                                                       CER046
     C           WTYPE     IFEQ '*CUST**'                                                     CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WIBCOK  1                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** If not question mark, access Branch Codes file.                                      CER046
      *                                                                                       CER046
     C                     CALL 'AOBRCHR1'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM BTIBCA    PKIBCA  3                                           CER046
     C           SDBRCH    PARM SDBRCH    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WIBCOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
     C                     MOVE A8LCCD    PLCCD                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Batch header must be multi-branch                                                    CER046
      ** OR no batch header found                                                             CER046
      *                                                                                       CER046
     C           WHEAD     IFEQ 'Y'                                                           CER046
     C           BTIBCA    ANDNE*BLANKS                                                       CER046
     C           BTIBCA    ANDNEBRBCDA                                                        CER046
     C           BRMBRB    ANDNE'Y'                                                           CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WIBCOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVRTL - Validate Retail Account                             *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVRTL    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Save Retail details.                                                                 CER046
      *                                                                                       CER046
     C                     MOVELDDACID    W2RACN 100                                          CER046
     C                     MOVE 'Y'       W2RNBE  1                                           CER046
      *                                                                                       CER046
      ** Retrieve and validate Account details.                                               CER046
      *                                                                                       CER046
     C                     EXSR SRRKEY                                                        CER046
     C                     MOVE DDACID    PKACID                                              CER046
     C                     EXSR SRADTL                                                        CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVNST - Validate Nostro Code                                *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVNST    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Save Nostro Number.                                                                  CER046
      *                                                                                       CER046
     C**********           MOVE WACM2     W2NNBI  2                                  CER046 AR862752
     C                     MOVE BTNNBI    W2NNBI  2                                         AR862752
      *                                                                                       CER046
      ** Retrieve Nostro details.                                                             CER046
      *                                                                                       CER046
     C                     EXSR SRRKEY                                                        CER046
     C                     MOVE BTCYCD    PKCYCD                                              CER046
     C**********           MOVE WACM2     PKNONB                                     CER046 AR862752
     C                     MOVE BTNNBI    PKNONB                                            AR862752
     C                     EXSR SRANST                                                        CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Nostro code not existing, set Account flag to no record found.                       CER046
      *                                                                                       CER046
     C                     MOVEL'*NRFD'   PACCO                                               CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Process further the Nostro if it is existing.                                        CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Retrieve and validate Account details.                                               CER046
      *                                                                                       CER046
     C                     EXSR SRRKEY                                                        CER046
     C                     MOVELA7CUST    PKCUST                                              CER046
     C                     MOVELA7CYCD    PKCYCD                                              CER046
     C                     MOVELA7ACCD    PKACCD                                              CER046
     C                     MOVELA7ACSN    PKACSN                                              CER046
     C                     MOVELA7BRCD    PKBRCD                                              CER046
     C                     EXSR SRADTL                                                        CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVFAC - Validate full Account                               *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVFAC    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Save Customer.                                                                       CER046
      *                                                                                       CER046
     C                     MOVELDDACID    W2CUST                                              CER046
      *                                                                                       CER046
      ** Check if valid Customer.                                                             CER046
      *                                                                                       CER046
     C                     CALL 'AOCUSTR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM DDACID    PCUST                                               CER046
     C                     PARM *BLANKS   PKYST   7                                           CER046
     C           SDCUST    PARM SDCUST    UUSDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PKYST     OREQ '*ERROR '                                                     CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
     C                     MOVEL*BLANKS   DDACID                                              CER046
     C                     MOVELBBCUST    DDACID                                              CER046
     C                     MOVELBBCUST    W2CUST                                              CER046
     C                     MOVELBBCUST    PCUST1  6                                           CER046
     C                     MOVELBBACOC    PACOF1  2                                           CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           WAIDOK    IFEQ 'Y'                                                           CER046
     C           WCYCOK    ANDEQ'Y'                                                           CER046
     C           WACDOK    ANDEQ'Y'                                                           CER046
     C           WASNOK    ANDEQ'Y'                                                           CER046
     C           WIBCOK    ANDEQ'Y'                                                           CER046
      *                                                                                       CER046
      ** Retrieve and validate Account details.                                               CER046
      *                                                                                       CER046
     C                     EXSR SRRKEY                                                        CER046
     C                     MOVELDDACID    PKCUST                                              CER046
     C                     MOVELBTCYCD    PKCYCD                                              CER046
     C                     MOVELBTACCD    PKACCD                                              CER046
     C                     MOVELBTACSN    PKACSN                                              CER046
     C                     MOVELBTIBCA    PKBRCD                                              CER046
     C                     EXSR SRADTL                                                        CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Set Account flag to invalid.                                                         CER046
      *                                                                                       CER046
     C                     MOVEL'*INVD'   PACCO                                               CER046
      *                                                                                       CER046
      ** However, if A/c Id is not in error and one of the ffg.                               CER046
      ** field is blank: Currency, A/c Code, A/c Seq and Input                                CER046
      ** Branch Code, set Account flag to incomplete.                                         CER046
      ** (This will be used in the validation of Associated                                   CER046
      ** Customer.)                                                                           CER046
      *                                                                                       CER046
     C           WAIDOK    IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
     C           BTCYCD    IFEQ *BLANKS                                                       CER046
     C           BTACCD    OREQ *BLANKS                                                       CER046
     C           BTACSN    OREQ *BLANKS                                                       CER046
     C           BTIBCA    OREQ *BLANKS                                                       CER046
     C                     MOVEL'*INCP'   PACCO   5                                           CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Set account identifier to 'N'                                                        CER046
      *                                                                                       CER046
     C                     MOVEL'N'       ACIDOK  1                                           CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRVAFO - Validate Account using Associated Front Office      *                       CER046
      *           Id                                                  *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRVAFO    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Retrieve Account details.                                                            CER046
      *                                                                                       CER046
     C           BTFRNT    IFNE *BLANKS                                                       CER046
     C           BTFRNT    CHAINGLAMADL0             01                                       CER046
     C                     ELSE                                                               CER046
     C                     MOVE *ON       *IN01                                               CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           *IN01     IFEQ *ON                                                           CER046
      *                                                                                       CER046
      ** Account not existing, set account flag to no record found.                           CER046
      *                                                                                       CER046
     C                     MOVEL'*NRFD'   PACCO                                               CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK  1                                           CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Process further the Account if it is existing.                                       CER046
      *                                                                                       CER046
     C           *IN01     IFEQ *OFF                                                          CER046
      *                                                                                       CER046
      ** Save Account details.                                                                CER046
      *                                                                                       CER046
     C                     MOVELD@ACCT    F1ACCT                                              CER046
      *                                                                                       CER046
      ** Set up update fields.                                                                CER046
      *                                                                                       CER046
     C                     MOVE CNUM      W2CUST                                              CER046
     C                     MOVELACNO      W2RACN                                              CER046
     C                     MOVE RRNM      W2RRNM  50                                          CER046
     C                     MOVELATYP      W2ACTY                                              CER046
      *                                                                                       CER046
      ** Move account code and account sequence to character variables                        CER046
      *                                                                                       CER046
     C                     MOVELACOD      W2ACCD 10                                           CER046
     C                     MOVELACSQ      W2ACSQ  2                                           CER046
      *                                                                                       CER046
      ** Get Nostro details.                                                                  CER046
      *                                                                                       CER046
     C                     EXSR SRRKEY                                                        CER046
     C                     MOVE CNUM      PKCUST                                              CER046
     C                     MOVE CCY       PKCYCD                                              CER046
     C                     MOVE ACOD      PKACCD                                              CER046
     C                     MOVE ACSQ      PKACSN                                              CER046
     C                     MOVE BRCA      PKBRCD                                              CER046
     C                     EXSR SRANST                                                        CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVELA7NONB    W2NNBI                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check if there are differences between file and input                                CER046
      ** fields.                                                                              CER046
      *                                                                                       CER046
     C                     EXSR SRFDIF                                                        CER046
      *                                                                                       CER046
     C           ACST      IFEQ 'C'                                                           CER046
     C           DACC      ANDLTBJRDNB                                                        CER046
      *                                                                                       CER046
      ** Account closed, set Account flag as closed.                                          CER046
      *                                                                                       CER046
     C                     MOVEL'*CLSD'   PACCO                                               CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Account flagged for closure today, issue a warning message                           CER046
      *                                                                                       CER046
     C           ACST      IFEQ 'C'                                                           CER046
     C           DACC      ANDEQBJRDNB                                                        CER046
     C                     MOVE 'W'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRRKEY - Reset access object fields                          *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRRKEY    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     MOVE *BLANKS   PKACID 10                                           CER046
     C                     MOVE *BLANKS   PKCUST  6                                           CER046
     C                     MOVE *BLANKS   PKCYCD  3                                           CER046
     C                     MOVE *BLANKS   PKACCD                                              CER046
     C                     MOVE *BLANKS   PKACSN  2                                           CER046
     C                     MOVE *BLANKS   PKBRCD  3                                           CER046
     C                     MOVE *BLANKS   PKNONB  2                                           CER046
     C                     MOVE *BLANKS   PKUCSN 10                                           CER046
     C                     MOVE *BLANKS   PKPNOI  1                                           CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRAACC - Call access object for Account details              *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRAACC    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     CALL 'AOACCTR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM           PKACID                                              CER046
     C                     PARM           PKCUST                                              CER046
     C                     PARM           PKCYCD                                              CER046
     C                     PARM           PKACCD                                              CER046
     C                     PARM           PKACSN                                              CER046
     C                     PARM           PKBRCD                                              CER046
     C           D@ACCT    PARM D@ACCT    UUSDY                                               CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRADTL - Validate Account details                            *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRADTL    BEGSR                                                              CER046
      *                                                                                       CER046
      ** Retrieve Account details.                                                            CER046
      *                                                                                       CER046
     C                     EXSR SRAACC                                                        CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Account not existing, set account flag to no record found.                           CER046
      *                                                                                       CER046
     C                     MOVEL'*NRFD'   PACCO                                               CER046
      *                                                                                       CER046
      ** Account is not existing.  If CEU013 is on, In Currency, and                          CER046
      ** Account is a Retail or a Nostro, then only a warning.                                CER046
      ** Warning is considered as a real error.                                               CER046
      *                                                                                       CER046
     C           CEU013    IFEQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           W2ACTY    ANDEQ'R'                                                           CER046
      *                                                                                       CER046
     C           CEU013    OREQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           W2RNBE    ANDEQ'Y'                                                           CER046
      *                                                                                       CER046
     C           CEU013    OREQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           W2ACTY    ANDEQ'N'                                                           CER046
      *                                                                                       CER046
     C           CEU013    OREQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           W2NNBI    ANDNE*BLANKS                                                       CER046
      *                                                                                       CER046
      ** Issue warning message for the non-existing Account.                                  CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
      ** If A/c Id entry is a Retail A/c No. and is not existing,                             CER046
      ** set Invalid Account flag to '*RETAIL'.                                               CER046
      *                                                                                       CER046
     C           WTYPE     IFEQ '*RETAIL'                                                     CER046
     C                     MOVE '*RETAIL' PINVAC                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** If A/c Id entry is a Nostro and is not existing,                                     CER046
      ** set Invalid Account flag to '*NOSTRO'.                                               CER046
      *                                                                                       CER046
     C           WTYPE     IFEQ '*NOSTRO'                                                     CER046
     C                     MOVE '*NOSTRO' PINVAC  7                                           CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Account is not existing.  If CEU013 is not on or not                                 CER046
      ** In Currency, or Account is not a Retail and not a                                    CER046
      ** Nostro, then issue an error.                                                         CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Issue error message for the non-existing Account.                                    CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Process further the Account if it is existing.                                       CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
      *                                                                                       CER046
      ** Save Account details.                                                                CER046
      *                                                                                       CER046
     C                     MOVELD@ACCT    F1ACCT                                              CER046
      *                                                                                       CER046
      ** Set up update fields.                                                                CER046
      *                                                                                       CER046
     C                     MOVE CNUM      W2CUST                                              CER046
     C                     MOVELACNO      W2RACN                                              CER046
     C                     MOVE RRNM      W2RRNM                                              CER046
     C                     MOVELATYP      W2ACTY  1                                           CER046
      *                                                                                       CER046
      ** Move account code and account sequence to character variables                        CER046
      *                                                                                       CER046
     C                     MOVELACOD      W2ACCD                                              CER046
     C                     MOVELACSQ      W2ACSQ                                              CER046
      *                                                                                       CER046
      ** Get Nostro details if A/c Id entry is other than                                     CER046
      ** a Nostro.                                                                            CER046
      *                                                                                       CER046
     C           WTYPE     IFNE '*NOSTRO'                                                     CER046
     C                     EXSR SRRKEY                                                        CER046
     C                     MOVE CNUM      PKCUST                                              CER046
     C                     MOVE CCY       PKCYCD                                              CER046
     C                     MOVE ACOD      PKACCD                                              CER046
     C                     MOVE ACSQ      PKACSN                                              CER046
     C                     MOVE BRCA      PKBRCD                                              CER046
     C                     EXSR SRANST                                                        CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVELA7NONB    W2NNBI                                              CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Check if there are differences between file and input                                CER046
      ** fields if A/c Id entry is a Retail A/c No. or a                                      CER046
      ** Nostro code.                                                                         CER046
      *                                                                                       CER046
     C           WTYPE     IFEQ '*RETAIL'                                                     CER046
     C           WTYPE     OREQ '*NOSTRO'                                                     CER046
     C                     EXSR SRFDIF                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           ACST      IFEQ 'C'                                                           CER046
     C           DACC      ANDLTBJRDNB                                                        CER046
      *                                                                                       CER046
      ** Account closed, set Account flag as closed.                                          CER046
      *                                                                                       CER046
     C                     MOVEL'*CLSD'   PACCO                                               CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRFDIF - Check if there are differences between file         *                       CER046
      *           and input fields                                    *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
     C           SRFDIF    BEGSR                                                              CER046
      *                                                                                       CER046
     C           BTCYCD    IFNE *BLANKS                                                       CER046
     C           BTCYCD    ANDNECCY                                                           CER046
     C           BTACCD    ORNE *BLANKS                                                       CER046
     C           BTACCD    ANDNEW2ACCD                                                        CER046
     C           BTACSN    ORNE *BLANKS                                                       CER046
     C           BTACSN    ANDNEW2ACSQ                                                        CER046
     C           BTIBCA    ORNE *BLANKS                                                       CER046
     C           BTIBCA    ANDNEBRCA                                                          CER046
      *                                                                                       CER046
      ** CEU013 if on and In currency, and Account is a Retail                                CER046
      ** or a Nostro, then only a warning.  Warning is                                        CER046
      ** considered as a real error.                                                          CER046
      *                                                                                       CER046
     C           CEU013    IFEQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           W2ACTY    ANDEQ'R'                                                           CER046
      *                                                                                       CER046
     C           CEU013    OREQ 'Y'                                                           CER046
     C           PINCY     ANDEQ'Y'                                                           CER046
     C           W2ACTY    ANDEQ'N'                                                           CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
      *                                                                                       CER046
     C                     ELSE                                                               CER046
      *                                                                                       CER046
      ** Issue error message.                                                                 CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WAIDOK                                              CER046
     C                     MOVE 'Y'       PERRF                                               CER046
     C                     MOVE 'Y'       OKF,ID                                              CER046
     C                     MOVE 'N'       WRPLCE  1                                           CER046
      *                                                                                       CER046
      ** Account details are different from input details,                                    CER046
      ** set Account flag to *DIFF'.                                                          CER046
      *                                                                                       CER046
     C                     MOVEL'*DIFF'   PACCO                                               CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Override input fields with file fields.                                              CER046
      *                                                                                       CER046
     C           WRPLCE    IFEQ 'Y'                                                           CER046
      *                                                                                       CER046
      ** Save A/c Customer for Profit Centre validation.                                      CER046
      *                                                                                       CER046
     C                     MOVELCNUM      PCUST1                                              CER046
      *                                                                                       CER046
     C           BTACSN    IFNE W2ACSQ                                                        CER046
     C                     MOVE ACSQ      BTACSN                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           BTCYCD    IFNE CCY                                                           CER046
     C                     MOVE CCY       BTCYCD                                              CER046
     C                     EXSR SRVCCY                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           BTACCD    IFNE W2ACCD                                                        CER046
     C                     MOVE ACOD      BTACCD                                              CER046
     C                     EXSR SRVACC                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           BTIBCA    IFNE BRCA                                                          CER046
     C                     MOVE BRCA      BTIBCA                                              CER046
     C                     EXSR SRVBRC                                                        CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *                                                                                       CER046
      *****************************************************************                     BUG25438
      /EJECT                                                                                BUG25438
      *****************************************************************                     BUG25438
      *                                                               *                     BUG25438
      *  SRAIMN - Validate Additional Informations and Multicash      *                     BUG25438
      *           Narratives                                          *                     BUG25438
      *                                                               *                     BUG25438
      *  Called by: SRVALD                                            *                     BUG25438
      *                                                               *                     BUG25438
      *  Calls: None                                                  *                     BUG25438
      *                                                               *                     BUG25438
      *****************************************************************                     BUG25438
      *                                                                                     BUG25438
     C           SRAIMN    BEGSR                                                            BUG25438
      *                                                                                     BUG25438
      ** Validate if Additional Informations and Multicash Narratives                       BUG25438
      ** both have values.                                                                  BUG25438
      *                                                                                     BUG25438
     C           CER030    IFEQ 'Y'                                                         BUG25438
      *                                                                                     BUG25438
     C           KJESX     CHAINGLJEIXL2             30                                     BUG25438
      *                                                                                     BUG25438
     C           *IN30     IFEQ *OFF                                                        BUG25438
     C           FNADS     ANDNE*BLANKS                                                     BUG25438
     C           EXNRDS    ANDNE*BLANKS                                                     BUG25438
     C                     Z-ADD16        ID                                                BUG25438
     C                     MOVE 'Y'       PERRF                                             BUG25438
     C                     MOVE 'Y'       OKF,ID                                            BUG25438
     C                     ENDIF                                                            BUG25438
     C                     ENDIF                                                            BUG25438
      *                                                                                     BUG25438
     C                     ENDSR                                                            BUG25438
      *                                                                                     BUG25438
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRANST - Process Cheque Number input                         *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRANST    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     CALL 'AONOSTR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM           PKCUST                                              CER046
     C                     PARM           PKCYCD                                              CER046
     C                     PARM           PKACCD                                              CER046
     C                     PARM           PKACSN                                              CER046
     C                     PARM           PKNONB                                              CER046
     C                     PARM           PKBRCD                                              CER046
     C                     PARM           PKUCSN                                              CER046
     C                     PARM           PKPNOI                                              CER046
     C           SDNOST    PARM SDNOST    UUFDY                                               CER046
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *****************************************************************                       CER046
      *                                                               *                       CER046
      *  SRTOTP - Calculate Total for Posting Amount and No. of Items *                       CER046
      *                                                               *                       CER046
      *  Called by: SRVALD                                            *                       CER046
      *                                                               *                       CER046
      *  Calls: None                                                  *                       CER046
      *                                                               *                       CER046
      *****************************************************************                       CER046
      *                                                                                       CER046
     C           SRTOTP    BEGSR                                                              CER046
      *                                                                                       CER046
     C                     Z-ADD13        X1      20                                          CER046
     C                     Z-ADD13        X2      20                                          CER046
     C                     Z-ADD3         X3      20                                          CER046
     C                     Z-ADD0         NITAM                                               CER046
     C                     Z-ADD0         NDTAM                                               CER046
     C                     MOVE *BLANKS   WITAM  13                                           CER046
     C                     MOVE *BLANKS   WDTAM   3                                           CER046
     C                     MOVE *BLANKS   WPATM                                               CER046
      *                                                                                       CER046
     C                     CALL 'AOCURRR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*KEY   ' POPTN                                               CER046
     C                     PARM           BTCYCD                                              CER046
     C           SDCURR    PARM SDCURR    UUSDY                                               CER046
      *                                                                                       CER046
     C                     MOVE BTPTAM    WPATM  13                                           CER046
     C                     MOVE A6NBDP    NNBDP   10                                          CER046
      *                                                                                       CER046
     C                     CLEARINF                                                           CER046
     C                     CLEARDEF                                                           CER046
      *                                                                                       CER046
     C                     MOVEAWPATM     ALLF                                                CER046
     C                     MOVE NNBDP     X3                                                BUG23669
      *                                                                                       CER046
      ** Get Integer And Decimal Separate                                                     CER046
      *                                                                                       CER046
     C           X1        DOWGE1                                                             CER046
      *                                                                                       CER046
     C           NNBDP     DOWGE1                                                             CER046
     C                     MOVEAALLF,X1   DEF,X3                                              CER046
     C                     SUB  1         X3                                                  CER046
     C                     SUB  1         X1                                                  CER046
     C                     SUB  1         NNBDP                                               CER046
     C                     ENDDO                                                              CER046
      *                                                                                       CER046
     C                     MOVEAALLF,X1   INF,X2                                              CER046
     C                     SUB  1         X1                                                  CER046
     C                     SUB  1         X2                                                  CER046
     C                     ENDDO                                                              CER046
      *                                                                                       CER046
     C                     MOVEAINF       WITAM                                               CER046
     C                     MOVEADEF       WDTAM                                               CER046
      *                                                                                       CER046
     C                     MOVE WITAM     NITAM  130                                          CER046
     C**********           MOVE WDTAM     NDTAM   30                                 CER046 BUG25186
     C                     MOVE WDTAM     NDTAM   40                                        BUG25186
      *                                                                                       CER046
     C                     ADD  NITAM     PTOTIN 150                                          CER046
     C**********           ADD  NDTAM     PTOTDN  30                                CER046 BUG25186A
     C**********           ADD  NDTAM     PTOTDN  40                              BUG25186A BUG26405
     C                     ADD  NDTAM     PTOTDN  60                                        BUG26405
     C********** BTNITM    IFNE *ZERO                                              BUG23669 BUG25185
     C**********           ADD  BTNITM    PTOTMN  30                                 CER046 BUG25185
     C**********           ELSE                                                    BUG23669 BUG25185
     C**********           ADD  1         PTOTMN                                   BUG23669 BUG25185
     C**********           ENDIF                                                   BUG23669 BUG25185
     C                     ADD  1         PTOTMN  30                                        BUG25185
      *                                                                                       CER046
     C                     ENDSR                                                              CER046
      *****************************************************************                       CER046
      /EJECT                                                                                  CER046
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * *INZSR - Program Initialisation routine                       *                       CGL013
      *                                                               *                       CGL013
      * Called by: Implicitly on program activation                   *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           *INZSR    BEGSR                                                              CGL013
      *                                                                                       CGL013
      ** Access SAR details file to see if CGL013 is installed.                               CGL013
      *                                                                                       CGL013
     C           *NAMVAR   DEFN           LDA                                                 CGL013
     C                     CALL 'AOSARDR0'                                                    CGL013
     C                     PARM *BLANKS   PRTCD   7                                           CGL013
     C                     PARM '*VERIFY' POPTN   7                                           CGL013
     C                     PARM 'CGL013'  PSARD   6                                           CGL013
     C           D@SARD    PARM D@SARD    UUFDY                                               CGL013
      *                                                                                       CGL013
     C           PRTCD     IFNE *BLANKS                                                       CGL013
     C           PRTCD     ANDNE'*NRF    '                                                    CGL013
     C           *LOCK     IN   LDA                                                           CGL013
     C                     MOVE 'SCSARDPD'DBFILE                                              CGL013
     C                     MOVEL'001'     DBASE                                               CGL013
     C                     MOVEL'CGL013'  DBKEY                                               CGL013
     C                     OUT  LDA                                                           CGL013
     C                     EXSR *PSSR                                                         CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C           PRTCD     IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       CGL013  1                                           CGL013
     C                     ELSE                                                               CGL013
     C                     MOVE 'N'       CGL013                                              CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
      ** Check if 'CER030' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE *BLANK    CER030  1                                           CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           D@SARD    PARM D@SARD    UUFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C           PRTCD     ANDNE'*NRF   '                                                     CER030
      *                                                                                       CER030
     C           *LOCK     IN   LDA                                                           CGL013
     C                     MOVE 'SCSARDPD'DBFILE                                              CGL013
     C                     MOVEL'002'     DBASE                                               CGL013
     C                     MOVEL'CER030'  DBKEY                                               CGL013
     C                     OUT  LDA                                                           CGL013
      *                    EXSR *PSSR                                                         CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
      *                                                                                       CER030
     C                     MOVE 'Y'       CER030                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER030                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                     AR833906
      ** Check if 'CER031' is switched 'ON'                                                 AR833906
      *                                                                                     AR833906
     C                     MOVE *BLANK    CER031  1                                         AR833906
     C                     CALL 'AOSARDR0'                                                  AR833906
     C                     PARM *BLANKS   PRTCD                                             AR833906
     C                     PARM '*VERIFY' POPTN                                             AR833906
     C                     PARM 'CER031'  PSARD                                             AR833906
     C           D@SARD    PARM D@SARD    UUFDY                                             AR833906
      *                                                                                     AR833906
     C           PRTCD     IFNE *BLANKS                                                     AR833906
     C           PRTCD     ANDNE'*NRF   '                                                   AR833906
      *                                                                                     AR833906
     C           *LOCK     IN   LDA                                                         AR833906
     C                     MOVE 'SCSARDPD'DBFILE                                            AR833906
     C                     MOVEL'013'     DBASE                                             AR833906
     C                     MOVEL'CER031'  DBKEY                                             AR833906
     C                     OUT  LDA                                                         AR833906
      *                    EXSR *PSSR                                                       AR833906
     C                     ELSE                                                             AR833906
      *                                                                                     AR833906
     C           PRTCD     IFEQ *BLANKS                                                     AR833906
      *                                                                                     AR833906
     C                     MOVE 'Y'       CER031                                            AR833906
     C                     ELSE                                                             AR833906
      *                                                                                     AR833906
     C                     MOVE 'N'       CER031                                            AR833906
      *                                                                                     AR833906
     C                     ENDIF                                                            AR833906
      *                                                                                     AR833906
     C                     ENDIF                                                            AR833906
      *                                                                                       CER030
      ** Access SAR details file to see if CER046 is installed.                               CER046
      *                                                                                       CER046
     C                     CALL 'AOSARDR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD   7                                           CER046
     C                     PARM '*VERIFY' POPTN   7                                           CER046
     C                     PARM 'CER046'  PSARD   6                                           CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PRTCD     ANDNE'*NRF    '                                                    CER046
     C           *LOCK     IN   LDA                                                           CER046
     C                     MOVE 'SCSARDPD'DBFILE                                              CER046
     C                     MOVEL'003'     DBASE                                               CER046
     C                     MOVEL'CER046'  DBKEY                                               CER046
     C                     OUT  LDA                                                           CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       CER046  1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE 'N'       CER046                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     MOVE 'N'       WP1RCF  1                                           CER046
      *                                                                                       CER046
     C                     CALL 'AOBANKR0'                                                    CER046
     C                     PARM '*DBERR ' PRTCD                                               CER046
     C                     PARM '*FIRST ' POPTN                                               CER046
     C           SDBANK    PARM SDBANK    UUFDY                                               CER046
      *                                                                                       CER046
      ** Retrieve EURO Currency                                                               CER046
      *                                                                                       CER046
     C                     CALL 'AOGELRR1'                                                    CER046
     C                     PARM '*DBERR ' PRTCD                                               CER046
     C                     PARM '*FIRST ' POPTN                                               CER046
     C           SDGELR    PARM SDGELR    UUSDY                                               CER046
      *                                                                                       CER046
      ** Access SAR details file to see if CEU013 is installed.                               CER046
      *                                                                                       CER046
     C                     CALL 'AOSARDR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*VERIFY' POPTN                                               CER046
     C                     PARM 'CEU013'  PSARD                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PRTCD     ANDNE'*NRF    '                                                    CER046
     C           *LOCK     IN   LDA                                                           CER046
     C                     MOVE 'SCSARDPD'DBFILE                                              CER046
     C                     MOVEL'004'     DBASE                                               CER046
     C                     MOVEL'CEU013'  DBKEY                                               CER046
     C                     OUT  LDA                                                           CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       CEU013  1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE 'N'       CEU013                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Access SAR details file to see if CGL010 is installed.                               CER046
      *                                                                                       CER046
     C                     CALL 'AOSARDR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*VERIFY' POPTN                                               CER046
     C                     PARM 'CGL010'  PSARD                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PRTCD     ANDNE'*NRF    '                                                    CER046
     C           *LOCK     IN   LDA                                                           CER046
     C                     MOVE 'SCSARDPD'DBFILE                                              CER046
     C                     MOVEL'005'     DBASE                                               CER046
     C                     MOVEL'CGL010'  DBKEY                                               CER046
     C                     OUT  LDA                                                           CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       CGL010  1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE 'N'       CGL010                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Access SAR details file to see if CGL002 is installed.                               CER046
      *                                                                                       CER046
     C                     CALL 'AOSARDR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*VERIFY' POPTN                                               CER046
     C                     PARM 'CGL002'  PSARD                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PRTCD     ANDNE'*NRF    '                                                    CER046
     C           *LOCK     IN   LDA                                                           CER046
     C                     MOVE 'SCSARDPD'DBFILE                                              CER046
     C                     MOVEL'006'     DBASE                                               CER046
     C                     MOVEL'CGL002'  DBKEY                                               CER046
     C                     OUT  LDA                                                           CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       CGL002  1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE 'N'       CGL002                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Access SAR details file to see if CRE019 is installed.                               CER046
      *                                                                                       CER046
     C                     CALL 'AOSARDR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*VERIFY' POPTN                                               CER046
     C                     PARM 'CRE019'  PSARD                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PRTCD     ANDNE'*NRF    '                                                    CER046
     C           *LOCK     IN   LDA                                                           CER046
     C                     MOVE 'SCSARDPD'DBFILE                                              CER046
     C                     MOVEL'007'     DBASE                                               CER046
     C                     MOVEL'CRE019'  DBKEY                                               CER046
     C                     OUT  LDA                                                           CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       CRE019  1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE 'N'       CRE019                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Access SAR details file to see if CGL037 is installed.                               CER046
      *                                                                                       CER046
     C                     CALL 'AOSARDR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*VERIFY' POPTN                                               CER046
     C                     PARM 'CGL037'  PSARD                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PRTCD     ANDNE'*NRF    '                                                    CER046
     C           *LOCK     IN   LDA                                                           CER046
     C                     MOVE 'SCSARDPD'DBFILE                                              CER046
     C                     MOVEL'011'     DBASE                                               CER046
     C                     MOVEL'CGL037'  DBKEY                                               CER046
     C                     OUT  LDA                                                           CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           PRTCD     IFEQ *BLANKS                                                       CER046
     C                     MOVE 'Y'       CGL037  1                                           CER046
     C                     ELSE                                                               CER046
     C                     MOVE 'N'       CGL037                                              CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Access Overrides data area.                                                          CER046
      *                                                                                       CER046
     C           *NAMVAR   DEFN           GLREOV                                              CER046
     C                     IN   GLREOV                                                        CER046
      *                                                                                       CER046
      ** Access Retail details                                                                CER046
      *                                                                                       CER046
     C                     CALL 'AORETLR0'                                                    CER046
     C                     PARM '*MSG   ' PRTCD                                               CER046
     C                     PARM '*FIRST ' POPTN                                               CER046
     C           SDRETL    PARM SDRETL    UUFDY                                               CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C           PRTCD     ANDNE'*NRF'                                                        CER046
     C           *LOCK     IN   LDA                                                           CER046
     C                     MOVE 'SDRETLPD'DBFILE                                              CER046
     C                     MOVEL'007'     DBASE                                               CER046
     C                     MOVEL'CER046'  DBKEY                                               CER046
     C                     OUT  LDA                                                           CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Access Midas Modules details.                                                        CER046
      *                                                                                       CER046
     C                     CALL 'AOMMODR0'                                                    CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM '*FIRST ' POPTN                                               CER046
     C           SDMMOD    PARM SDMMOD    UUFDY                                               CER046
      *                                                                                       CER046
      ** Database Error                                                                       CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C                     MOVELPOPTN     DBKEY                                               CER046
     C                     MOVEL'SDMMODPD'DBFILE                                              CER046
     C                     Z-ADD008       DBASE                                               CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
      ** Access Retail III ICD details to check if Charge for                                 CER046
      ** Multiple Transactions is 'Y'.                                                        CER046
      *                                                                                       CER046
     C           BGNXST    IFEQ 'Y'                                                           CER046
     C                     CALL 'SD9343'                                                      CER046
     C                     PARM *BLANKS   PRTCD                                               CER046
     C                     PARM *BLANK    PCMTR   1                                           CER046
      *                                                                                       CER046
     C           PRTCD     IFNE *BLANKS                                                       CER046
     C                     MOVEL'*FIRST'  DBKEY                                               CER046
     C                     MOVEL'TABTBRE' DBFILE                                              CER046
     C                     Z-ADD009       DBASE                                               CER046
     C                     EXSR *PSSR                                                         CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C                     ENDIF                                                              CER046
      *                                                                                       CER046
     C           KJESX     KLIST                                                              CGL013
     C                     KFLD           P@IFBN                                              CGL013
     C                     KFLD           BTBINB                                              CGL013
      *                                                                                     BUG23742
     C           KJENA     KLIST                                                            BUG23742
     C                     KFLD           RDNO                                              BUG23742
     C**********           KFLD           P@IFBN                                   BUG23742 BUG24716
     C                     KFLD           P@BHNO                                            BUG24716
     C                     KFLD           BTBINB                                            BUG23742
      *                                                                                       CGL013
     C/COPY WNCPYSRC,GLH00200
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                     BUG23669
      /EJECT                                                                                BUG23669
      *****************************************************************                     BUG23669
      *                                                               *                     BUG23669
      *  UPJENS - Update Currency Totals                              *                     BUG23669
      *                                                               *                     BUG23669
      *****************************************************************                     BUG23669
      *                                                                                     BUG23669
     C           UPJENS    BEGSR                                                            BUG23669
      *                                                                                     BUG23669
      ** Get Currency Summary details of batch.                                             BUG23669
      *                                                                                     BUG23669
     C           KJENS     CHAIN@BSREAI              95                                     BUG23669
      *                                                                                     BUG23669
      ** If record found, update Debit/Credit Summary Total.                                BUG23669
      *                                                                                     BUG23669
     C           *IN95     IFEQ *OFF                                                        BUG23669
     C           BTDCIN    IFEQ 'D'                                                         BUG23669
     C                     ADD  BTPTAM    BSDBTT                                            BUG23669
     C                     ELSE                                                             BUG23669
     C                     ADD  BTPTAM    BSCRTT                                            BUG23669
     C                     ENDIF                                                            BUG23669
      *                                                                                     BUG23669
      *                                                                                     BUG23669
      * Delete summary record for this currency if both ccy totals are zero                 BUG23669
      * else update the record                                                              BUG23669
     C           BSCRTT    IFEQ *ZERO                                                       BUG23669
     C           BSDBTT    ANDEQ*ZERO                                                       BUG23669
     C                     DELET@BSREAI                                                     BUG23669
     C                     ELSE                                                             BUG23669
     C                     UPDAT@BSREAI                                                     BUG23669
     C                     ENDIF                                                            BUG23669
      *                                                                                     BUG23669
      ** If record is not found, create a new record                                        BUG23669
      *                                                                                     BUG23669
     C                     ELSE                                                             BUG23669
     C                     MOVELBTBTNB    BSBTNB                                            BUG23669
     C                     MOVELBTCYCD    BSCYCD                                            BUG23669
     C                     MOVELBTIBCA    BSBRCD                                            BUG23669
      *                                                                                     BUG23669
     C                     Z-ADD*ZERO     BSDBTT                                            BUG23669
     C                     Z-ADD*ZERO     BSCRTT                                            BUG23669
      *                                                                                     BUG23669
     C           BTDCIN    IFEQ 'D'                                                         BUG23669
     C                     Z-ADDBTPTAM    BSDBTT                                            BUG23669
     C                     ELSE                                                             BUG23669
     C                     Z-ADDBTPTAM    BSCRTT                                            BUG23669
     C                     ENDIF                                                            BUG23669
      *                                                                                     BUG23669
     C                     WRITE@BSREAI                                                     BUG23669
     C                     ENDIF                                                            BUG23669
      *                                                                                     BUG23669
     C                     ENDSR                                                            BUG23669
      *****************************************************************                    BUG25186E
      /EJECT                                                                               BUG25186E
      *****************************************************************                    BUG25186E
      *                                                                                    BUG25186E
      *****************************************************************                    BUG25186E
      *                                                               *                    BUG25186E
      * SRRACT - Retrieve account information based on                *                    BUG25186E
      *          given BTCUST, BTCYCD, BTACCD, BTACSN and BTIBCA      *                    BUG25186E
      *                                                               *                    BUG25186E
      * Called by: SRPRC2                                             *                    BUG25186E
      *                                                               *                    BUG25186E
      * Calls: None                                                   *                    BUG25186E
      *                                                               *                    BUG25186E
      *****************************************************************                    BUG25186E
      *                                                                                    BUG25186E
     C           SRRACT    BEGSR                                                           BUG25186E
      *                                                                                    BUG25186E
     C           BTCUST    IFNE *BLANKS                                                    BUG25186E
     C           BTCYCD    ANDNE*BLANKS                                                    BUG25186E
     C           BTACCD    ANDNE*BLANKS                                                    BUG25186E
     C           BTACSN    ANDNE*BLANKS                                                    BUG25186E
     C           BTIBCA    ANDNE*BLANKS                                                    BUG25186E
      *                                                                                    BUG25186E
      ** Retrieve account details                                                          BUG25186E
     C                     CALL 'AOACCTR0'                                                 BUG25186E
     C                     PARM *BLANKS   UUAPRC           B:Return Cd                     BUG25186E
     C                     PARM '*KEY'    UUAPOP           B:Option                        BUG25186E
     C                     PARM *BLANKS   UUACID           I:Account Ident                 BUG25186E
     C                     PARM           BTCUST           I:Customer Numb                 BUG25186E
     C                     PARM           BTCYCD           I:Currency Code                 BUG25186E
     C                     PARM           BTACCD           I:Account Code                  BUG25186E
     C                     PARM           BTACSN           I:Account Seque                 BUG25186E
     C                     PARM           BTIBCA           I:Branch code                   BUG25186E
     C           D@ACCT    PARM *BLANK    UUSDY            O:Format                        BUG25186E
      *                                                                                    BUG25186E
     C           ATYP      IFEQ 'R'                                                        BUG25186E
     C                     MOVE 'R'       BTACTY                                           BUG25186E
     C                     ENDIF                                                           BUG25186E
     C                     ENDIF                                                           BUG25186E
      *                                                                                    BUG25186E
     C                     ENDSR                                                           BUG25186E
      *****************************************************************                     BUG25476
      /EJECT                                                                                BUG25476
      *****************************************************************                     BUG25476
      *                                                               *                     BUG25476
      * SRVADI - Validate additional information                      *                     BUG25476
      *                                                               *                     BUG25476
      *****************************************************************                     BUG25476
     C           SRVADI    BEGSR                                                            BUG25476
     C                     MOVE *BLANKS   PNWRK                                             BUG25476
     C                     MOVE BTIBCA    PBRCA                                             BUG25476
     C                     MOVE BTCUST    PCUSNO                                            BUG25476
     C                     MOVE BTCYCD    PCCY                                              BUG25476
     C                     MOVE BTACCD    PACCD                                             BUG25476
     C                     MOVE BTACSN    PACSQ                                             BUG25476
     C                     MOVE BAADI1    PNAR1                                             BUG25476
     C                     MOVE BAADI2    PNAR2                                             BUG25476
     C                     MOVE BAADI3    PNAR3                                             BUG25476
     C                     MOVE BAADI4    PNAR4                                             BUG25476
     C                     MOVE BAADI5    PNAR5                                             BUG25476
      *                                                                                     BUG25476
     C                     CALL 'MG001900'                                                  BUG25476
     C                     PARM           PRTCD1 10                                         BUG25476
     C                     PARM '*VALID ' POPTN1  7                                         BUG25476
     C                     PARM           PNWRK   6                                         BUG25476
     C                     PARM           PMSGTP  3                                         BUG25476
     C                     PARM           PBRCA   3                                         BUG25476
     C**********           PARM           PCUSNO  60                               BUG25476 MD044271
     C                     PARM           PCUSNO  6                                         MD044271
     C                     PARM           PCCY    3                                         BUG25476
     C                     PARM           PACCD                                             BUG25476
     C                     PARM           PACSQ                                             BUG25476
     C                     PARM           PDCIN   1                                         BUG25476
     C                     PARM           PTRTP   5                                         BUG25476
     C                     PARM           PNAR1  65                                         BUG25476
     C                     PARM           PNAR2  65                                         BUG25476
     C                     PARM           PNAR3  65                                         BUG25476
     C                     PARM           PNAR4  65                                         BUG25476
     C                     PARM           PNAR5  65                                         BUG25476
     C                     PARM           PNAR6  65                                         BUG25476
     C                     PARM           PFOR1  70                                         BUG25476
     C                     PARM           PFOR2  70                                         BUG25476
     C                     PARM           PFOR3  70                                         BUG25476
     C                     PARM           PFOR4  70                                         BUG25476
     C                     PARM           PFOR5  70                                         BUG25476
     C                     PARM           PFOR6  70                                         BUG25476
     C                     PARM           PFOR7  70                                         BUG25476
     C                     PARM           PFOR8  70                                         BUG25476
     C                     PARM           PFOR9  70                                         BUG25476
     C                     PARM           PFOR10 70                                         BUG25476
     C                     PARM           PFOR11 70                                         BUG25476
     C                     PARM           PFOR12 70                                         BUG25476
     C                     PARM           PFOR13 70                                         BUG25476
     C                     PARM           PFOR14 70                                         BUG25476
     C                     PARM           PFOR15 70                                         BUG25476
     C                     PARM           PFOR16 70                                         BUG25476
     C                     PARM           PFOR17 70                                         BUG25476
     C                     PARM           PFOR18 70                                         BUG25476
     C                     PARM           PFOR19 70                                         BUG25476
     C                     PARM           PFOR20 70                                         BUG25476
     C                     PARM           IDX     30                                        BUG25476
     C                     PARM           FNMARR 10                                         BUG25476
     C                     PARM           MIDARR  7                                         BUG25476
     C                     PARM           MDTARR 45                                         BUG25476
     C                     PARM           WFLDAR 10                                         BUG25476
     C                     PARM           WMIDAR  7                                         BUG25476
     C                     PARM           WMDTAR 45                                         BUG25476
      *                                                                                     BUG25476
     C           PRTCD1    IFEQ '*ERROR'                                                    BUG25476
     C                     MOVE 'Y'       PERRF                                             BUG25476
     C                     Z-ADD16        ID                                                BUG25476
      *                                                                                     BUG26643
      ** If there were no errors for batch before this,                                     BUG26643
      ** print batch item details                                                           BUG26643
      *                                                                                     BUG26643
     C           BTVALI    IFEQ 'Y'                                                         BUG26643
     C                     SETON                     87                                     BUG26643
     C                     ENDIF                                                            BUG26643
      *                                                                                     BUG26643
     C                     EXSR SRWRIT                                                      BUG25476
      *                                                                                     BUG26643
      ** Update valid indicator to blanks if error occurred                                 BUG26643
      *                                                                                     BUG26643
     C           KLCRSA    CHAIN@BTREAK              93                                     BUG26643
     C           *IN93     IFEQ *OFF                                                        BUG26643
     C                     MOVE *BLANKS   BTVALI                                            BUG26643
     C                     UPDAT@BTREAK                                                     BUG26643
     C                     ENDIF                                                            BUG26643
      *                                                                                     BUG26643
     C                     ENDIF                                                            BUG25476
      *                                                                                     BUG25476
     C                     ENDSR                                                            BUG25476
      *****************************************************************                     BUG25476
      /EJECT                                                                                BUG25476
      *****************************************************************                     BUG25476
      *                                                               *                     BUG25476
      * SRVLNR - Validate Multicash Extended narrative                *                     BUG25476
      *                                                               *                     BUG25476
      *****************************************************************                     BUG25476
     C           SRVLNR    BEGSR                                                            BUG25476
      *                                                                                     BUG25476
     C                     MOVE *BLANKS   PNWRK                                             BUG25476
     C                     MOVE BTIBCA    PBRCA                                             BUG25476
     C                     MOVE BTCUST    PCUSNO                                            BUG25476
     C                     MOVE BTCYCD    PCCY                                              BUG25476
     C                     MOVE BTACCD    PACCD                                             BUG25476
     C                     MOVE BTACSN    PACSQ                                             BUG25476
      *                                                                                     BUG25476
     C                     MOVE BAFN2     PEX,1                                             BUG25476
     C                     MOVE BAFN3     PEX,2                                             BUG25476
     C                     MOVE BAFN4     PEX,3                                             BUG25476
     C                     MOVE BAFN5     PEX,4                                             BUG25476
     C                     MOVE BAFN6     PEX,5                                             BUG25476
     C                     MOVE BAFN7     PEX,6                                             BUG25476
     C                     MOVE BAFN8     PEX,7                                             BUG25476
     C                     MOVE BAFN9     PEX,8                                             BUG25476
     C                     MOVE BAFN10    PEX,9                                             BUG25476
     C                     MOVE BAFN11    PEX,10                                            BUG25476
     C                     MOVE BAFN12    PEX,11                                            BUG25476
     C                     MOVE BAFN13    PEX,12                                            BUG25476
     C                     MOVE BAFN14    PEX,13                                            BUG25476
     C                     MOVE BAFN15    PEX,14                                            BUG25476
     C                     MOVE BAFN16    PEX,15                                            BUG25476
     C                     MOVE BAFN17    PEX,16                                            BUG25476
     C                     MOVE BAFN18    PEX,17                                            BUG25476
     C                     MOVE BAFN19    PEX,18                                            BUG25476
     C                     MOVE BAFN20    PEX,19                                            BUG25476
     C                     MOVE BAFN21    PEX,20                                            BUG25476
     C                     MOVE BAFN22    PEX,21                                            BUG25476
     C                     MOVE BAFN23    PEX,22                                            BUG25476
      *                                                                                     BUG25476
     C                     CALL 'MG001901'                                                  BUG25476
     C                     PARM           PRTCD1                                            BUG25476
     C                     PARM '*VALID ' POPTN1                                            BUG25476
     C                     PARM           PNWRK                                             BUG25476
     C                     PARM           PMSGTP                                            BUG25476
     C                     PARM           PBRCA                                             BUG25476
     C                     PARM           PCUSNO                                            BUG25476
     C                     PARM           PCCY                                              BUG25476
     C                     PARM           PACCD                                             BUG25476
     C                     PARM           PACSQ                                             BUG25476
     C                     PARM           PDCIN                                             BUG25476
     C                     PARM           PTRTP                                             BUG25476
     C                     PARM           PEX                                               BUG25476
     C                     PARM           PFOR1                                             BUG25476
     C                     PARM           PFOR2                                             BUG25476
     C                     PARM           PFOR3                                             BUG25476
     C                     PARM           PFOR4                                             BUG25476
     C                     PARM           PFOR5                                             BUG25476
     C                     PARM           PFOR6                                             BUG25476
     C                     PARM           PFOR7                                             BUG25476
     C                     PARM           PFOR8                                             BUG25476
     C                     PARM           PFOR9                                             BUG25476
     C                     PARM           PFOR10                                            BUG25476
     C                     PARM           PFOR11                                            BUG25476
     C                     PARM           PFOR12                                            BUG25476
     C                     PARM           PFOR13                                            BUG25476
     C                     PARM           PFOR14                                            BUG25476
     C                     PARM           PFOR15                                            BUG25476
     C                     PARM           PFOR16                                            BUG25476
     C                     PARM           PFOR17                                            BUG25476
     C                     PARM           PFOR18                                            BUG25476
     C                     PARM           PFOR19                                            BUG25476
     C                     PARM           PFOR20                                            BUG25476
     C                     PARM           PFOR21 70                                         BUG25476
     C                     PARM           PFOR22 70                                         BUG25476
     C                     PARM           IDX                                               BUG25476
     C                     PARM           FNMARR                                            BUG25476
     C                     PARM           MIDARR                                            BUG25476
     C                     PARM           MDTARR                                            BUG25476
     C                     PARM           WFLDAR                                            BUG25476
     C                     PARM           WMIDAR                                            BUG25476
     C                     PARM           WMDTAR                                            BUG25476
      *                                                                                     BUG25476
     C           PRTCD1    IFEQ '*ERROR'                                                    BUG25476
     C                     MOVE 'Y'       PERRF                                             BUG25476
     C                     Z-ADD16        ID                                                BUG25476
      *                                                                                     BUG26643
      ** If there were no errors for batch before this,                                     BUG26643
      ** print batch item details                                                           BUG26643
      *                                                                                     BUG26643
     C           BTVALI    IFEQ 'Y'                                                         BUG26643
     C                     SETON                     87                                     BUG26643
     C                     ENDIF                                                            BUG26643
      *                                                                                     BUG26643
     C                     EXSR SRWRIT                                                      BUG25476
      *                                                                                     BUG26643
      ** Update valid indicator to blanks if error occurred                                 BUG26643
      *                                                                                     BUG26643
     C           KLCRSA    CHAIN@BTREAK              93                                     BUG26643
     C           *IN93     IFEQ *OFF                                                        BUG26643
     C                     MOVE *BLANKS   BTVALI                                            BUG26643
     C                     UPDAT@BTREAK                                                     BUG26643
     C                     ENDIF                                                            BUG26643
      *                                                                                     BUG26643
     C                     ENDIF                                                            BUG25476
      *                                                                                     BUG25476
     C                     ENDSR                                                            BUG25476
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      *                                                               *                       CGL013
      * *PSSR  - Program exception error routine                      *                       CGL013
      *          Called automatically if a program error occurs,      *                       CGL013
      *          or directly by the program code using EXSR.          *                       CGL013
      *          This subroutine DUMPs the program just once.         *                       CGL013
      *                                                               *                       CGL013
      * Called by: ZZINIT                                             *                       CGL013
      *                                                               *                       CGL013
      * Calls: None                                                   *                       CGL013
      *                                                               *                       CGL013
      *****************************************************************                       CGL013
      *                                                                                       CGL013
     C           *PSSR     BEGSR                                                              CGL013
      *                                                                                       CGL013
     C           @RUN      IFEQ *BLANK                                                        CGL013
     C                     MOVE 'Y'       @RUN    1                                           CGL013
     C                     DUMP                                                               CGL013
     C                     CALL 'DBERRCTL'                                                    CGL013
     C                     ENDIF                                                              CGL013
      *                                                                                       CGL013
     C                     MOVE *ON       *INU7                                               CGL013
     C                     MOVE *ON       *INU8                                               CGL013
     C                     MOVE *ON       *INLR                                               CGL013
     C                     RETRN                                                              CGL013
      *                                                                                       CGL013
     C                     ENDSR                                                              CGL013
      *                                                                                       CGL013
      *****************************************************************                       CGL013
      /EJECT                                                                                  CGL013
      *****************************************************************                       CGL013
     C/COPY WNCPYSRC,GLH00201
** STAMP - Dummy timestamp                                                                    CPK015
0001-01-01-00.00.00.000000                                                                    CPK015
** CPY@
(c) Misys International Banking Systems Ltd. 2001
** ERMSG                                                                                      CER046
Error in Branch                                                                               CER046
Error in Account                                                                              CER046
Error in Amount                                                                               CER046
Error in D/C Indicator                                                                        CER046
Error in Narrative                                                                            CER046
Error in Type                                                                                 CER046
Error in Value Date                                                                           CER046
Error in Cheque Number                                                                        CER046
Error in Profit Centre                                                                        CER046
Error in Overrides                                                                            CER046
Error in Assoc Cust                                                                           CER046
Error in Book Code                                                                            CER046
Error in Rev/Void Ind                                                                         CER046
Error in Number of Items                                                                      CER046
Error in Orig Curr Amt                                                                        CER046
Error in Extended Narr                                                                      BUG25438
**   @YD  - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN                                         CER046
00366007310109601461                                                                          CER046
**   @MD  - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                                            CER046
00000000310005900090001200015100181002120024300273003040033400365                             CER046
