0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Batch transactions file split')               *
0002  *****************************************************************
0003  *                                                               *
      *  Midas - General Ledger Module                                *
0005  *                                                               *
0006  *  GL0260 - Batch Transactions File Split                       *
0007  *                                                               *
      *  (c) Finastra International Limited 2001                      *
0011  *                                                               *
      *  Last Amend No. MD023916           Date 06Nov19               *
      *  Prev Amend No. MD045515           Date 20Jun17               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL182             Date 11May17               *
      *                 MD045372           Date 23May17               *
      *                 CGL154             Date 13Oct14               *
      *                 MD036165           Date 25May16               *
      *                 MD037046           Date 12Feb16               *
      *                 MD036415           Date 17Dec15               *
      *                 145956             Date 28Oct14               *
      *                 CGL135B            Date 04Nov13               *
      *                 MD019891           Date 10Apr13               *
      *                 AR1089863          Date 19Feb13               *
      *                 AR1075051          Date 10Feb13               *
      *                 CLE134             Date 01Aug12               *
      *                 CGL127AM           Date 06Aug12               *
      *                 CSC054             Date 23Feb12               *
      *                 CAP208             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG25260           Date 31Jul09               *
      *                 BUG22979A          Date 12Mar09               *
      *                 BUG22939           Date 16Feb09               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 238728             Date 22Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 BUG4970            Date 23Nov04               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL020             Date 12Dec02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 188470             Date 11Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01Mar99               *
      *                 CTI002             Date 23Sep98               *
      *                 CEU013             DATE 02APR98               *
      *                 CCB003             DATE 15Oct96               *
      *                 S01408             DATE 02OCT96               *
      *                 CFF004             DATE 02OCT96               *
      *                 S01408             DATE 07AUG96               *
      *                 CMC001             DATE 18MAR96               *
      *                 CAC001             DATE 01FEB96               *
      *                 090139             DATE 28JUN96               *
      *                 088498             DATE 21JUN96               *
      *                 S01408             DATE 03JUN96               *
      *                 S01408             DATE 18OCT95               *
      *                 087773             DATE 05OCT95               *
      *                 S01408             DATE 10APR95               *
      *                 S01413             DATE 13APR93               *
      *                 067360             DATE 22FEB94               *
      *                 058067             DATE 04NOV93               *
      *                 047771             DATE 01DEC92               *
      *                 S10736             DATE 03SEP92               *
      *                 S01340             DATE 11NOV91               *
      *                 E29464             DATE 23OCT91               *
      *                 E28709             DATE 23OCT91               *
      *                 E30172             DATE 23OCT91               *
      *                 E25952             DATE 06SEP91               *
      *                 BHF794             DATE 25APR91               *
      *                 LN0905             DATE  1NOV90               *
      *                 LN0116             DATE 05MAY90               *
      *                 LN0092             DATE 02MAY90               *
      *                 S01229             DATE 04APR90               *
      *                 E19312             DATE 13FEB90               *
      *                 E19908             DATE 13FEB90               *
0010  *                 S01212             DATE 13FEB90               *
0010  *                 E18574             DATE 09AUG89               *
      *                 S01117             DATE 10/03/89              *
      *                 S01194             DATE 10/03/89              *
0010  *                 S01154             DATE 04/08/88              *
0010  *                 S05452             DATE 20/08/87              *
0011  *                                                               *
0012  *****************************************************************
      *                                                               *
      *  MD023916 - Profit Centre on batch entries are overwritten.   *
      *             Removed 238728 since warning msg is being shown   *
      *             during insert of batch if retail/nostro and profit*
      *             centre does not match value in ACCNTAB.           *
      *  MD045515 - Real-time postings resulted in duplicate movements* 
      *             in Midas. Remove fix MD037046.                    *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL182 - Journal Entry via the Interface File - Java Version *
      *           (Recompile)                                         *
      *  MD045372 - Reverse MD036165 as it is causing error in COB    *
      *             (MSGW) and duplicate postings. CGL010 process     *
      *             is now done is a separate component (GLC0533).    *
      *  CGL154 - FATCA Reporting (Recompile)                         *
      *  MD036165 - Forward journal entries did not reverse.          *
      *             GLC26 ignored the process because batch is empty. *
      *  MD037046 - MEMOS missing balances from CLEARPD of future     *
      *             dated posting. Modified validation of MD028392    *
      *             Only Turn on BIT 6 if Real Time Posted Entry is   *
      *             NOT forward dated.                                *
      *  MD036415 - Dbase 12 - issued update or delete in without     *
      *            priot READ or CHAIN.                               *
      *  145956 - Change the narrative description for interbranch    *
      *           entries to reflect similar to 10.4.                 *
      *           Reversed out fix 087773.                            *
      *  CGL135B - Accounting Rules Process                           *
      *            Added hooks: CGL135_082, CGL135_083, CGL135_084,   *
      *                         CGL135_085                            *
      *  MD019891 - Record count and account values incorrect in      *
      *             GLC4114 resulting in FOOB                         *
      *  AR1089863 - Merging Issues of 2.0 and 2.1 releases           *
      *  AR1075051 - Missing MANPOPD records caused by jumbled keys.  *
      *              This resulted to difference in APOSTPD.          *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CGL127AM - COB Restructure - GL Module Optimisation Phase 2  *
      *  CSC054 - Period End Adjustments                              *
      *  CAP208 - F&O Market Instrument API (Recompile)               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG25260 - Movements of retail account are not reflected     *
      *  BUG22979A - Wrong extended narratives output in MT940        *
      *  BUG22939 - Check the value of Original Currency and Original *
      *             amount before writing to Manual Postings file     *
      *  CER047 - German Features LF037-00 Reporting §24c             *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  238728 - If posting to a retail or nostro account set        *
      *           profit centre to that of the account.               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      * BUG4970 - Allow printing of report even if no discrepancy.    *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL020 - Midas Compliance Watch - Additional A/C Postings    *
      *           Information (Recompile)                             *
      *  188470 - DB error for SDPCACPD should be 006 not 009.        *
      *         - Open/Close printer file badly coded.               *
      *  CGL007 - Account Postings Enquiry                            *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
      *  CEU013 - EMU Account Postings Narrative                      *
      *  CCB003 - COB Performance Enhancements - Task Split           *
      *           Replace GLJENHL2 with GLBATHPD.                     *
      *           Replace MANPOZZ with GLBATHPA.                      *
      *           Remove processing for GL0260P1 report.              *
      *           Add commitment control to MANPOPD.                  *
      *  S01408 - Addition of Core Hook GL0260X001                    *
      *           Addition of Core Hook GL0260OOP1                    *
      *           Addition of Core Hook GL0260CP14                    *
      *           Addition of Core Hook GL0260CP13                    *
      *           Addition of Core Hook GL0260CP12                    *
      *           Addition of Core Hook GL0260CP11                    *
      *           Addition of Core Hook GL0260CP10                    *
      *           Addition of Core Hook GL0260CCP9                    *
      *           Addition of Core Hook GL0260CCP8                    *
      *           Addition of Core Hook GL0260CCP7                    *
      *  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
      *  S01408 - Core hook GL0260CCP6 added                          *
      *         - Core hook GL0260CCP5 added                          *
      *  CMC001 - Management Accounts Enhancement for PCA:            *
      *           Do not output to PF/MANPOPD if CMC001 feature is    *
      *           installed.                                          *
      *  CAC001 - Profit Centre Accounting Development:               *
      *           Output the 'Primary Funding Profit Centre' from     *
      *           PCA ICD file for interbranch Journal Entry postings *
      *  090139 - If posting is for a closed or non-existant retail   *
      *           account, post to the suspense account instead.      *
      *         - DB error 005 in SDACODPD because account code on    *
      *           posting from interface file had leading 0 removed.  *
      *           Move account code to numeric field before chain.    *
      *         - Produce dump if database error.                     *
      *  088498 - Report GL0260P1 doesn't show correct inter-branch   *
      *           postings in some cases where batch branch changes.  *
      *           Move BTICBA (account branch) to BRCA (report field) *
      *           immediately before writing to GL0260P1.             *
      *  S01408 - Core hook GL0260CCP4 added                          *
      *  S01408 - Core hook GL0260FFP1 added                          *
      *           Core hook GL0260CCP2 added                          *
      *           Core hook GL0260CCP3 added                          *
      *  087773 - Inappropriate narrative for interbranch accounting  *
      *           entries generated at Item Level (as defined in GL   *
      *           ICD).                                               *
      *           Existing it carries that entries narrative for all  *
      *           the interbranch entries via entries branch/batch    *
      *           branches, now changed to use NARR,1 & NARR,2        *
      *           respectively.                                       *
      *           for main branch/item branch, now changed to use     *
      *           NARR,3 and NARR,4 respectively.                     *
      *  S01408 - Core hook GL0260CCP1 added                          *
      *           Core hook GL0260IIPG added                          *
      *           Core hook GL0260CCPG added                          *
      *  S01413 - Retail 3 Incorporation                              *
      *  067360 - For End of Branch Totals P1 report, pass a blank    *
      *           entity to the RCF program, else RCf will update     *
      *           the Spool File Numbers record for the P1 report     *
      *           for the last branch processed with the spool file   *
      *           details of Interbranch Totals P1 report.            *
      *  058067 - LDA not defined for output                          *
      *  047771 - Output PSTD as run date to stop openning            *
      *           balance errors on statements                        *
      *  S10736 - Management accounting                               *
      *  S01340 - MIS GL Real Time Posting                            *
      *  E29464 - Rename the account type field obtained from the     *
      *           access program                                      *
      *  E28709 - Don't overwrite ccy you may need it for posting     *
      *           Interbranch entries correctly                       *
      *  E30172 - Should check account type of Interbranch account    *
      *  E25952 - Correct RCF processing for GL0260AU                 *
      *  BHF794 - Include audit report of entries generated           *
      *  LN0905 - Audit report should not have end of report          *
      *  LN0116 - ACOD'S and Interbranch entries incorrect            *
      *  LN0092 - Cond. stat on field 'BKIEBI' incorrect              *
      *  S01229 - SYNON file name changes                             *
      *  E19312 - Chain from narrative code to narrative              *
      *           description to update MANPOPD                       *
      *  E19908 - When no batches present no headings are             *
      *           output due to end of file on first read             *
      *           on primary file.Fix by chaining to header           *
      *           record when LR on and output headings               *
      *           as a header record when no batches present          *
      *  S01212 - Addition of retail override ind field to            *
      *           GLBTREP thus pgm required recompiling.              *
      *  E18574 - Batch transaction file split has a line of          *
      *           details printing before the headings.               *
      *  S01117 - Multibranching                                      *
      *  S01194 - New Standing Data                                   *
      *  S01154 - Removal of BTRAN.                                   *
0011  *  S05452 - Inclusion of Auto Reconciliations.                  *
0011  *                                                               *
0012  *****************************************************************
      *                                                               *                       CER030
      *  Indicator usage                                              *                       CER030
      *  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯                                              *                       CER030
      *  U7/U8 Error Ocurred                                          *                       CER030
      *  LR    End program                                            *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  S U B R O U T I N E   I N D E X                              *                       CER030
      *                                                               *                       CER030
      *   *PSSR    - Error handling                                   *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
0014 F*TRAN   IP  F     128            DISK                               S01154
0014 F*GLBRREL0IP  E           K        DISK                       S01154 S01229
0014 F*LJENHL0IP  E           K        DISK                        S01229 BHF794
      *                                                                   CCB003
0014 F*GLJENHL2IP  E           K        DISK                       BHF794 CCB003
     FGLJENHL2IF  E           K        DISK                                                 CGL127AM
     F***GLBATHPDIP**E           K        DISK                                       CCB003 CGL127AM
     FGLBATHPDUF  E           K        DISK         KCOMIT            UC                    CGL127AM
     F            GLBATHD0                          KRENAMEDRIVEF                           CGL127AM
      *                                                                   CCB003
0015 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0016 F*TRANCH IF  F     128            DISK                               S01154
0016 F*GLBTREL0IF  E           K        DISK                       S01154 S01229
0016 FGLJENPL0IF  E           K        DISK                               S01229
     F/COPY OFCPYSRCZ,CGL135_082                                                             CGL135B
     FSDNARRL1IF  E           K        DISK                               E19312
     FACCNT   IF  E           K        DISK                               090139
     F            ACCNTAAF                          KIGNORE               090139
     F            ACCNTACF                          KIGNORE               090139
      *                                                                   S01408
     F/COPY WNCPYSRC,GL0260FFP1                                           S01408
      *                                                                   S01408
     F*MANPOHH*O***F     160            DISK                              CCB003
0017 F*ANPOPD O   F     160            DISK                               S05452
0017 F*ANPOPD*O** F     200            DISK                         S05452S00117
0017 FMANPOPD O   E           K        DISK                               S01117
     F                                              KCOMIT                CCB003
     F/COPY WNCPYSRC,GL0260F001
      *                                                                   CCB003
     F*MANPOZZ*O***F     160            DISK                              CCB003
     F***GLBATHPAUF  E                    DISK                      A                CCB003 BUG25260
     FGLBATHPAUF  E                    DISK         KCOMIT       A                          BUG25260
      *                                                                   CCB003
0018 F*L0260P1O** F     132     OF     PRINTER                      S01124S01117
0018 F*L0260AUO   F     132     OF     PRINTER                      S01117E25952
0018 F***GL0260AUO***F     132     OF     PRINTER      KINFDS SPOOLU                 E25952 CGL127AM
     FGL0260AUO   F     132     OF     PRINTER      KINFDS SPOOLU     UC                    CGL127AM
     F*GL0260P1O   E             10     PRINTER      KINFDSSPOOLUC BHF794 CCB003
0019 F*
     FGLAPNAPDUF  E           K        DISK         KCOMIT       A        CEU013
     F*  Account Postings Next Available Number file                      CEU013
     F*                                                                   CEU013
     FMANPOAPDO   E           K        DISK         KCOMIT                CEU013
     F*  Manual Posting Extension file                                    CEU013
     F*                                                                   CEU013
      *                                                                                       CER030
      ** Midas GL Journal entry - additional information file                                 CER030
      *                                                                                       CER030
     FGLJENXL2IF  E           K        DISK         KINFSR *PSSR                              CER030
      *                                                                                       CER030
      ** Midas GL Journal Entry Header Extension File                                         CSC054
     FGLJEHQL0IF  E           K        DISK                                                   CSC054
      *                                                                                       CSC054
      ** Midas GL COrrective Batch Register File                                              CSC054
     FGLCORBPDO   E           K        DISK         KCOMIT                                    CSC054
      *****************************************************************   CCB003
      *                                                                   CCB003
0020 F**01************BATCH TRANSACTIONS HEADER RECORD 1                  S01154
     F**01*******     OUTPUT BATCH NO. INFORMATION                 S01117 CCB003
0021 F**02************CATCH-ALL FOR BATCH TRANSACTIONS FILE               S01154
     F* 02            NO RECORD FOUND ON CHAIN TO ACCNT                   090139
0022 F**03*******     TABLE,TB RECORD ID                                  S01194
0023 F**04************BATCH TRANSACTION HEADER                            S01154
     F**08*******     CONDITIONS OUTPUT OF DETAILS.                E18574 CCB003
     F* 08            CONDITIONS OUTPUT OF DETAILS.                                          BUG4970
     F********10      OVRFLOW INDICATOR                            BHF794 CCB003
0024 F********35      POSTING TO CREDIT                                   S01154
     F********40      POSTING CURRENCY HAS ZERO DECIMAL POINTS     BHF794 CCB003
     F********41      POSTING CURRENCY HAS ONE DECIMAL POINTS      BHF794 CCB003
0025 F********42******CHAIN FAIL                                          S01194
     F*       42      ERROR IN ACCESSING BANK DETAILS                     S01194
     F********43      POSTING CURRENCY HAS THREE DECIMAL POINTS    BHF794 CCB003
     F********44      POSTING CURRENCY HAS TWO DECIMAL POINTS      BHF794 CCB003
0026 F********45      ALL ITEMS FOR BATCH READ.                           S01154
0027 F*       46      DISCREPANCY BETWEEN NO. OF ITEMS READ AND CALCULATED
0028 F********47      NEGATIVE HASH TOTAL.                                CCB003
     F********48      ARRAY WORK IND IN SR/TOTREP                  BHF794 CCB003
0029 F*       50      FIRST CYCLE CALCULATIONS COMPLETED
0030 F********51      PRINT HEADING AND OUTPUT MANPO HEADER.              CCB003
0030 F*       51      PRINT HEADING AND OUTPUT MANPO HEADER.                                 BUG4970
     F********60      OUTPUT HEADER RECORD                         S01154 CCB003
     F*       64      END OF GLJENPL0 FILE                         S01154 S01229
     F*       65      UNSUCCESSFUL CHAIN TO NARRATIVE CODES FILE          E19312
     F*       70      MULTIBRANCHED ENVIRONMENT                           S01117
     F*       71      ERROR ON ACCESSING GENERAL LEDGER DETAILS           S01117
     F*       72      GENERATE JOURNAL INTER-BRANCH ENTERIES AT ITEM LEVELS01117
     F*       73      BATCH PROCESSED IS MULTIBRANCHED                    S01117
     F*       74      GENERATE INTERBRANCH ENTERIES VIA MAIN BRANCH       S01117
     F*       75      BATCH BRANCH *NE MAIN BRANCH                        S01117
     F*       76      POSTING BRANCH *NE MAIN BRANCH                      S01117
     F*       77      GENERATED ENTRY IS DEBIT                            BHF794
     F*       80      EOF indicator for GLBATHPA                      *   CCB003
     F*       83      Database Error GLAPNAPD                             CEU013
     F*       90      No record found GLAPNAPD                            CEU013
     F*          U7U8 DATABASE ERROR                                      S01194
0031 F*          U8   ONE OR MORE BATCHES HAVE DISCREPANCY.
      *                                                                   CCB003
      *****************************************************************   CCB003
      *                                                                   CCB003
     E** ARRAY TO PICK UP NARRATIVE DELETED MESSAGE**                     E19312
     E                    DELT    1   1 17                                E19312
     E** ARRAY TO PICK UP NARRATIVE FOR INTERBRANCH                       087773
     E********************NARR    1   4 30                          087773090139
     E                    NARR    1   5 30                                090139
      *                                                                   CCB003
     E***ARRAYS*TO*PROCESS*BRANCH*CCY*TOTALS                       BHF794 CCB003
     E***********         BRCY      500  6                         BHF794 CCB003
     E***********         BCDR      500 15 0                       BHF794 CCB003
     E***********         BCCR      500 15 0                       BHF794 CCB003
     E***ARRAYS*TO*PROCESS*BRANCH*CCY*TOTALS                       BHF794 CCB003
     E***********         CCCY      100  3                         BHF794 CCB003
     E***********         CCDR      100 15 0                       BHF794 CCB003
     E***********         CCCR      100 15 0                       BHF794 CCB003
     E**                                                                  E19312
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,GL0260E001
      *                                                                   CCB003
      *****************************************************************   CCB003
      *                                                                   CCB003
0032 I*TRAN   NS  01   1 CF   2 C1  15NCD                                 S01154
0033 I*                                       3   50BNUM                  S01154
0034 I*                                      15  15 STAT                  S01154
0035 I*                                   P  16  180TNFI                  S01154
0036 I*                                   P  19  210TNLI                  S01154
0037 I*                                   P  46  470NII                   S01154
0038 I* START OF POSTINGS                                                 S01154
     I*       NS  05   1 CP                                               S01154
0040 I*                                                                   S01154
0041 I*       NS  02                                                      S01154
     I*BRREAG                                                       S01154BHF794
      *                                                                   CCB003
     I*@BRTHCJ                                                     BHF794 CCB003
     I***@BRREMA                                                                     CCB003 CGL127AM
     I@BRTHCJ                                                                               CGL127AM
     I***********   BRJDNB                          BNUMH           S01154S01194
     I              BRBTNB                          BNUMH                 S01194
     I***********   BRJGNB                          NII             S01154S01194
     I              BRHINC                          NII                   S01194
     I***********   BRAXCD                          DPMT            S01154S01194
     I              BRDPCD                          DPMT                  S01194
     I***********   BRAGCD                          BRCB            S01154S01194
     I**************BRBCDA                          BRCB            S01194LN0116
     I***********   BRCJST                          STAT            S01154S01194
     I              BRBTSF                          STAT                  S01194
      *                                                                   CCB003
     I@BTREAK                                                             S01154
     I***********   BTJDNB                          BNUM            S01154S01194
     I              BTBTNB                          BNUM                  S01194
     I***********   BTJNNB                          ITEM            S01154S01194
     I              BTBINB                          ITEM                  S01194
     I***********   BTCUCD                          BRCA            S01154S01194
     I**************BTIBCA                          BRCA            S01194LN0116
     I***********   BTB6NB                          CNUM            S01154S01117
     I              BTCUST                          CNUMA                 S01117
     I***********   BTAJCD                          CCY             S01154S01194
     I              BTCYCD                          CCY                   S01194
     I***********   BTB7NB                          ACOD            S01154S01117
     I***********   BTB8NB                          ACSQ            S01154S01117
     I***********   BTB9NB                          ACNO            S01154S01117
     I              BTACCD                          ACODA                 S01117
     I              BTACSN                          ACSQA                 S01117
     I***********   BTRANB                          ACNOA           S01117S01229
     I***********   BTE9NB                          PSTD            S01154S01194
     I***********   BTPTDT                          PSTD            S01194047771
     I***********   BTFANB                          VALD            S01154S01194
     I              BTVLDT                          VALD                  S01194
     I***********   BTECNB                          TRAT            S01154S01117
     I***********   BTDTNB                          NARC            E19312S01194
     I              BTNVCD                          NARC                  S01194
     I              BTTRTY                          TRATA                 S01117
     I***********   BTATTX                          PNAR            S01154S01194
     I              BTNRDC                          PNAR                  S01194
     I***********   BTFBNB                          PSTA            S01154S01194
     I              BTPTAM                          PSTA                  S01194
     I***********   BTJONB                          ASOC            S01154S01117
     I***********   BTFENB                          CHQN            S01154S01117
     I              BTACNB                          ASOCA                 S01117
     I              BTCQNB                          CHQNA                 S01117
     I***********   BTABST                          ATYP            S01154S01194
     I              BTACTY                          ATYP                  S01194
     I***********   BTAKCD                          PRFC            S01154S01194
     I***********   BTPRCD                          PRFC            S01194S01229
     I***********   BTB7TX                          SWCR            S01154S01194
     I              BTSWCR                          SWCR                  S01194
     I              BTTSTY                          OTST                  S10736
     I              BTPRCN                          PRFCA                 S10736
     I              BTBKCD                          BOKCA                 S10736
     I              BTNITM                          NITMS                 S01413
      *                                                                   CCB003
     I@ALREC0                                                             E19312
     I*********     ALANTX                          PNAR1           E19312S01194
     I              ALDON                           PNAR1                 S01194
      *                                                                   CCB003
0042 I*****TABLE*FILE*-*INSTALLATION*CONTROL RECORD 1                     S01194
0043 I***********                                                         S01194
0044 I*ABLE***NS* 03   1 CD   2 C0   3 C1                                 S01194
0045 I*******AND*     12 C1  13 C0                                        S01194
0046 I***********                             1   1 RECI                  S01194
0047 I***********                             2   30RECT                  S01194
0048 I***********                            12  13 RCDE                  S01194
0049 I***********                            14  66 TITL                  S01194
0050 I***********                            67  67 DATF                  S01194
0051 I***********                            68  730DFBR                  S01194
0052 I***********                            74  74 MODI1                 S01194
0053 I***********                            75  75 MODI2                 S01194
0054 I***********                            76  76 MODI3                 S01194
0055 I***********                         P  77  790RUND                  S01194
0056 I***********                            80  86 RUNA                  S01194
0057 I***********                            87  870SFLG                  S01194
0058 I***********                         P  90  920LCD                   S01194
0059 I***********                            93  93 CHTP                  S01194
0060 I***********                         P  94  960TNLU                  S01194
0061 I***********                             1  96 LOT                   S01194
0062 I***********                                                         S01194
0063 I*****CATCHALL*FOR*DELETED RECORDS                                   S01194
0064 I********NS*                                                   S01154S01194
0065 I**                                                                  S01194
0066 I*TRANCH NS  04   1 CP                                               S01154
0067 I*                                   P  74  800PSTA                  S01154
0068 I*                                       1 128 DATA                  S01154
0069 I*                                     124 124 ATYP                  S01154
0067 I*                                      17  22 ISWCR1          S05452S01154
0068 I*                                      96  96 ISWCR2          S05452S01154
0069 I*                                     115 123 ISWCR3          S05452S01154
0070 I*       NS                                                          S01154
0065 I**                                                            S05452S01154
0065 I**    SWIFT COMMON REFERENCE                                  S05452S01154
0065 I**                                                            S05452S01154
     I*           DS                             16                 S05452S01154
0067 I*                                       1   6 ISWCR1          S05452S01154
0068 I*                                       7   7 ISWCR2          S05452S01154
0069 I*                                       8  16 ISWCR3          S05452S01154
0069 I*                                       1  16 OSWCR           S05452S01154
     I*********** DS                            128                 S01154S01117
0067 I***********                             1 128 DATA            S01154S01117
0068 I***********                             2   7 CNUM            S01154S01117
0069 I***********                             8  10 CCY             S01154S01117
0069 I***********                            11  14 ACOD            S01154S01117
0068 I***********                            15  16 ACSQ            S01154S01117
0069 I***********                            23  32 ACNO            S01154S01117
0069 I***********                         P  33  350PSTD            S01154S01117
0068 I***********                         P  36  380VALD            S01154S01117
0069 I***********                            39  43 TRAT            S01154S01117
0069 I***********                            44  73 PNAR            S01154S01117
0068 I***********                         P  74  800PSTA            S01154S01117
0069 I***********                            81  81 DRCR            S01154S01117
0069 I***********                            82  87 ASOC            S01154S01117
0069 I***********                            88  95 CHQN            S01154S01117
0069 I***********                           106 106 RIND            S01154S01117
0069 I***********                           109 111 DPMT            S01154S01117
0068 I***********                           124 124 ATYP            S01154S01117
      *                                                                   CCB003
     IACCNTABF                                                            090139
     I              RECI                            CRECI                 090139
     I              CNUM                            CCNUM                 090139
     I              CCY                             CCYC                  090139
     I              ACOD                            CACOD                 090139
     I              ACSQ                            CACSQ                 090139
     I              BRCA                            CBRCA                 090139
     I              ATYP                            CATYP                 090139
     I              ACST                            CACST                 090139
     I              PRFC                            CPRFC                 090139
     I              RRNM                            CRRNM                 090139
     I*                                                                   090139
     I*SPOOL*****  DS                                              BHF794 CCB003
     I***********                            83  90 SFILE          BHF794 CCB003
     I***********                         B 123 1240SFNUM          BHF794 CCB003
     I*                                                                   BHF794
     ISPOOLU      DS                                                      E25952
     I                                       83  90 SFILEU                E25952
     I                                    B 123 1240SFNUMU                E25952
     I*                                                                   E25952
     I****DATA*STRUCTURE*USED*TO*STORE*CURRENCY*DETAILS            BHF794 CCB003
     I***********                                                  BHF794 CCB003
     I*CURLOD**** DS                        100                    BHF794 CCB003
     I***********                             1   3 CURC           BHF794 CCB003
     I***********                             4   4 NODEC          BHF794 CCB003
      *                                                                   CCB003
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *                                                                   CCB003
     I*     LOCAL DATA AREA                                               S01117
     I***LDA********UDS***********************     256             S01117 058067
     I*LDA*******  DS                            256                      058067
     I***********                           134 141 DBFILE         S01117 CCB003
     I***********                           142 170 DBKEY          S01117 CCB003
     I***********                           171 180 DBPGM          S01117 CCB003
     I***********                           181 1830DBASE          S01117 CCB003
      *                                                                   CCB003
     ILDA       EUDSLDA                         256                       CCB003
      *                                                                   CCB003
     I*   DATA STRUCTURE FOR SOURCE OF POSTING                            S01117
     ISPOSDS      DS                              7                       S01117
     I****************************************1   30BNUMSP                S01229
     I                                        1   3 BNUMSP                S01229
     I                                        4   60ITEMSP                S01117
     I                                        7   7 TYPE                  S01117
     I***********                             1   6 W0BITM                             087773 145956
     I**  DATA STRUCTURE TO ALLOW NEW MANPOPD TO BE INITIALISED           S01117
     I**           CORRECTLY                                              S01117
     I**                                                                  S01117
     IDSX         DS                                                      S01117
     I                                        1  26 ZZ026                 S01117
     I                                    P  13  180ZEROA                 S01117
     I                                       19  20 ZEROB                 S01117
     I                                    P  21  260ZEROC                 S01117
     I**                                                                  S10736
     I**  DATA STRUCTURE TO SPLIT OTST FOR INPUT LENGTH                   S10736
     ID@OTST      DS                                                      S10736
     I                                        1  10 OTST                  S10736
     I                                        3   6 TRCLAS                CLE042
     I                                        7  10 OTST2                 CLE042
     I****************************************3  10 OTST2          S10736 CLE042
     I**  DATA STRUCTURE TO SPLIT TRAT FOR INPUT LENGTH                   S10736
     ID@TRAT      DS                                                      S10736
     I                                        1   5 TRATA                 S10736
     I                                        3   5 TRAT2                 S10736
      *                                                                                     CGL127AM
      ** Data Structure for the end record key                                              CGL127AM
      *                                                                                     CGL127AM
     I            DS                                                                        CGL127AM
     I                                        1   6 ENDKEY                                  CGL127AM
     I**********                              1   3 EBTNB                         CGL127AM AR1075051
     I**********                              4   6 EBCDA                         CGL127AM AR1075051
     I                                        1   3 EBCDA                                  AR1075051
     I                                        4   6 EBTNB                                  AR1075051
      *                                                                                     CGL127AM
      ** Data Structure for the next record key                                             CGL127AM
      *                                                                                     CGL127AM
     I            DS                                                                        CGL127AM
     I                                        1   6 NXTKEY                                  CGL127AM
     I**********                              1   3 NBTNB                         CGL127AM AR1075051
     I**********                              4   6 NBCDA                         CGL127AM AR1075051
     I                                        1   3 NBCDA                                  AR1075051
     I                                        4   6 NBTNB                                  AR1075051
      *                                                                                     CGL127AM
      ** Data Structure for the last record key                                             CGL127AM
      *                                                                                     CGL127AM
     I            DS                                                                        CGL127AM
     I                                        1   6 LSTKEY                                  CGL127AM
     I**********                              1   3 LBTNB                         CGL127AM AR1075051
     I**********                              4   6 LBCDA                         CGL127AM AR1075051
     I                                        1   3 LBCDA                                  AR1075051
     I                                        4   6 LBTNB                                  AR1075051
      *                                                                                     CGL127AM
     ID@RETR    E DSSDRETRPD                                              S10736
     I*                                                                   S10736
     I*  Retail Transaction Types DS for validation of Transaction        S10736
     I*  Type                                                             S10736
     I*                                                                   S10736
     I**                                                                  S10736
     ID@LOAN    E DSSDLOANPD                                              S10736
     I*                                                                   S10736
     I*  Loan Types/Sub-Types DS for validation of Transaction Type       S10736
     I*                                                                   S10736
     I**                                                                  S10736
     ID@INTY    E DSINTYPD                                                S10736
     I*                                                                   S10736
     I*  Instrument Type  DS for validation of Transaction Type           S10736
     I*                                                                   S10736
     I**                                                                  S10736
     ISDBANK    E DSSDBANKPD                                              S01194
     I**   BANK DETAILS                                                   S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I**   MODULE DETAILS                                                 S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**   BRANCH CODE                                                    S01117
     I*                                                                   S01117
     ISDGELR    E DSSDGELRPD                                              S01117
     I**   GENERAL LEDGER DETAILS                                         S01117
     I*                                                                   S01117
     ISDACOD    E DSSDACODPD                                              S01117
     I              A5ACTY                          ATYP                  E29464
     I              A5ACSC                          ACSC                  S10736
     I              QQACCD                          QQACCX                                    CGL029
     I**   ACCOUNT CODE                                                   S01117
     I*                                                                   S01117
     ISDPCAC    E DSSDPCACPD                                              CAC001
     I**   Profit Centre Details                                          CAC001
     I              QQFNAA                          QQFNAX                                    CGL029
     I              QQFNIC                          QQFNIX                                    CGL029
     I*                                                                   CMC001
     ISCSARD    E DSSCSARDPD                                              CMC001
     I**   Switchable Features Details                                    CMC001
     I              LCD                             LCDX                  CMC001
     I*                                                                   BHF794
     ISDCURR    E DSSDCURRPD                                              BHF794
     I*                                                                   BHF794
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     I*                                                                   BHF794
     IDSSDY     E DSDSSDY                                                 BHF794
     I*SECOND DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                BHF794
     I*                                                                   BHF794
     I*                                                                   S01408
      ** Commitment control size                                                            CGL127AM
      *                                                                                     CGL127AM
     ICBTASK    E DSCBTASKSP                                                                CGL127AM
     I/COPY WNCPYSRC,GL0260IIPG                                           S01408
     I*                                                                   S01408
      *                                                                   CCB003
      *****************************************************************   CCB003
      *                                                                   CCB003
     C           *ENTRY    PLIST                                          CEU013
     C                     PARM           PXRFI   3                       CEU013
     C*                                                                   CEU013
     C                     MOVEACPY@      BIS@   80
0071 C*
0072 C***********          SETOF                     51                   CCB003
     C                     MOVE '0'       *IN51                                              BUG4970
      *                                                                                       CER030
      ** Defining the key list for the file GLJENXL2                                          CER030
      *                                                                                       CER030
     C           KBATCH    KLIST                                                              CER030
     C                     KFLD           BNUM                                                CER030
     C                     KFLD           ITEM                                                CER030
      *                                                                                       CER030
     C/COPY OFCPYSRCZ,CGL135_083                                                             CGL135B
      ** Key field chain to GLJENHL2 files                                                  CGL127AM
      *                                                                                     CGL127AM
     C           GLJKEY    KLIST                                                            CGL127AM
     C                     KFLD           BRBCDA                                            CGL127AM
     C                     KFLD           BRBTNB                                            CGL127AM
      *                                                                                     CGL127AM
      ** Reset all indicators                                                               CGL127AM
      *                                                                                     CGL127AM
     C                     Z-ADD*ZEROS    COUNT                                             CGL127AM
     C                     Z-ADD1         #COMIT  60                                        CGL127AM
     C                     Z-ADD0         ACTOT                                             MD019891
     C                     Z-ADD0         ZZTOTI                                            MD019891
     C                     Z-ADD0         ZZTOTD                                            MD019891
     C                     MOVE *OFF      *IN02                                             CGL127AM
     C                     MOVE *OFF      *IN08                                             CGL127AM
     C                     MOVE *OFF      *IN42                                             CGL127AM
     C                     MOVE *OFF      *IN46                                             CGL127AM
     C                     MOVE *ON       *IN51                                             CGL127AM
     C                     MOVEA'00'      *IN,64                                            CGL127AM
     C                     MOVEA'00000000'*IN,70                                            CGL127AM
     C                     MOVE *OFF      *IN80                                             CGL127AM
     C                     MOVE *OFF      *IN83                                             CGL127AM
     C                     MOVE *OFF      *IN90                                             CGL127AM
0073 C*
0074 C*    SKIP FIRST CYCLE CALCULATIONS IF ALREADY DONE.
0075 C   50                GOTO FIRST
     C*    DEFINE LDA                                                     BHF794
     C           *NAMVAR   DEFN           LDA                             BHF794
     C           *LOCK     IN   LDA                                       BHF794
      *                                                                                     CGL127AM
      ** Access data area CBTASKSP for commit block size                                    CGL127AM
      *                                                                                     CGL127AM
     C           *NAMVAR   DEFN CBTASKSP  CBTASK                                            CGL127AM
     C                     IN   CBTASK                                                      CGL127AM
     C                     MOVE CMTBLK    #OPTIM 100                                        CGL127AM
     C/COPY WNCPYSRC,GL0260C005
0076 C*
0077 C*    FIRST CYCLE CALCULATIONS.
0078 C***********          SETON                     5051                 CCB003
     C                     MOVE '1'       *IN51                                              BUG4970
     C                     SETON                     50                   CCB003
     C                     Z-ADD*ZEROS    SDLB   150                      S01413
     C                     Z-ADD*ZEROS    SDCB   150                      S01413
     C**********           MOVE *BLANKS   OTRF   15                                    S01413 CGL029
     C                     MOVE *BLANKS   OTRF   21                                           CGL029
     C                     MOVE *BLANKS   OTTP   10                       S01413
     C                     MOVE *BLANKS   OTST   10                       S01413
     C                     MOVE *BLANKS   BOKC    2                       S01413
0079 C**
0080 C**
     C*  SET UP FIELDS FOR DB ERROR                                       S01117
3021 C                     MOVE ' '       BLANKS 29        SET UP FIELDS  S01117
3022 C                     MOVE BLANKS    DBKEY            FOR DATABASE   S01117
     C**********           MOVE 'GL0260'  DBPGM  10        ERRORS         S01117
3023 C***********          MOVE 'GL0260'  DBPGM            ERRORS  S01117 CCB003
     C                     MOVEL'GL0260'  DBPGM                           CCB003
     C                     OUT  LDA                                       058067
0071 C*
0081 C                     Z-ADD0         ZERO5   50
0082 C*
0081 C                     Z-ADD0         ACTOT   50                      S01117
0081 C                     Z-ADD0         RRNM    50                      S01117
0081 C**********           Z-ADD0         DBCNUM  60                                   S01117 CSD027
0081 C                     MOVE *BLANKS   DBCNUM  6                                           CSD027
0081 C                     Z-ADD0         ZEROA                           S01117
0081 C                     Z-ADD0         ZEROC                           S01117
0081 C                     MOVE '00'      ZEROB                           S01117
0081 C                     Z-ADD235959    PTIM                            S10736
     C*                                                                   S01117
     C/COPY WNCPYSRC,GL0260C003
0083 C*****RECOVER*I.C.D.*FROM TABLE FILE.                                S01194
0084 C***********          MOVEL'01      'TABKEY 12                       S01194
0085 C***********          MOVE '  10'    TABKEY                          S01194
0086 C***********          SETOF                     03                   S01194
0087 C***********TABKEY    CHAINTABLE                42                   S01194
0088 C*
     C                     EXSR BANKD                                     S01194
     C                     EXSR MMODD                                     S01194
      *                                                                   CGL007
      ** Determine if feature CGL007 is installed.                        CGL007
      *                                                                   CGL007
     C                     MOVE 'N'       CGL007  1                       CGL007
     C                     CALL 'AOSARDR0'                                CGL007
     C                     PARM '       ' @RTCD                           CGL007
     C                     PARM '*KEY   ' @OPTN                           CGL007
     C                     PARM 'CGL007'  @SARN                           CGL007
     C           SCSARD    PARM SCSARD    DSFDY                           CGL007
      *                                                                   CGL007
     C           @RTCD     IFEQ *BLANKS                                   CGL007
     C                     MOVE 'Y'       CGL007                          CGL007
      *                                                                   CGL007
      ** Else if return code in not equal to NRF, database error          CGL007
      *                                                                   CGL007
     C                     ELSE                                           CGL007
     C           @RTCD     IFNE '*NRF'                                    CGL007
      *                                                                   CGL007
     C                     MOVE *ON       *IN42                           CGL007
     C           *LOCK     IN   LDA                                       CGL007
     C                     MOVE 'SCSARDPD'DBFILE           ************   CGL007
     C                     MOVEL@SARN     DBKEY            * DBERR 13 *   CGL007
     C                     MOVEL'013'     DBASE            ************   CGL007
     C                     OUT  LDA                                       CGL007
     C                     EXSR ENDRT                                     CGL007
     C                     ENDIF                                          CGL007
      *                                                                   CGL007
     C                     ENDIF                                          CGL007
     C/COPY WNCPYSRC,GL0260C001
      *                                                                   CAC001
      **  If Analytical Accounting module is switched on, get the         CAC001
      **  'Primary Funding Profit Centre' from PCA ICD                    CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     CALL 'AOPCACR0'                                CAC001
     C                     PARM '*MSG   ' @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDPCAC    PARM SDPCAC    DSFDY                           CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     MOVE *ON       *IN42                           CAC001
     C           *LOCK     IN   LDA                                       CAC001
     C                     MOVE 'SDPCACPD'DBFILE           ***************CAC001
     C**********           MOVEL@OPTN     DBKEY            * DB ERROR 009 CAC001              188470
     C**********           MOVEL'009'     DBASE            ***************CAC001              188470
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 006 *                   188470
     C                     MOVEL'006'     DBASE            ****************                   188470
     C                     OUT  LDA                                       CAC001
     C                     EXSR ENDRT                                     CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  Check if Management Accounts Enhancement is installed           CMC001
      *                                                                   CMC001
     C                     MOVE 'N'       CMC001  1                       CMC001
     C                     CALL 'AOSARDR0'                                CMC001
     C                     PARM '*MSG   ' @RTCD                           CMC001
     C                     PARM '*VERIFY' @OPTN                           CMC001
     C                     PARM 'CMC001'  @SARN   6                       CMC001
     C           SCSARD    PARM SCSARD    DSFDY                           CMC001
      *                                                                   CMC001
     C           @RTCD     IFNE *BLANKS                                   CMC001
     C           @RTCD     IFNE '*NRF'                                    CMC001
     C                     MOVE *ON       *IN42                           CMC001
     C           *LOCK     IN   LDA                                       CMC001
     C                     MOVE 'SCSARDPD'DBFILE           ***************CMC001
     C                     MOVEL@SARN     DBKEY            * DB ERROR 010 CMC001
     C                     MOVEL'010'     DBASE            ***************CMC001
     C                     OUT  LDA                                       CMC001
     C                     EXSR ENDRT                                     CMC001
     C                     ENDIF                                          CMC001
     C                     ELSE                                           CMC001
     C                     MOVE 'Y'       CMC001  1                       CMC001
     C                     ENDIF                                          CMC001
      *                                                                   CMC001
     C           *IN42     IFEQ '1'                                       S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   CEU013
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD                           CEU013
     C                     PARM '*VERIFY' @OPTN                           CEU013
     C                     PARM 'CEU013'  @SARN                           CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     ENDIF                                          CEU013
      *                                                                                       CER030
      ** Check the switchable feature CER031                                                  CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031                                              CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   @RTCD                                               CER030
     C                     PARM '*VERIFY' @OPTN                                               CER030
     C                     PARM 'CER031'  @SARN                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           @RTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031  1                                           CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           @RTCD     IFNE *BLANKS                                                       CER030
     C           @RTCD     ANDNE'*NRF'                                                        CER030
      *                                                                                       CER030
     C           *LOCK     IN   LDA                                                           CER030
     C                     MOVE 'SCSARDPD'DBFILE                                              CER030
     C                     MOVE 'CER031'  DBKEY                                               CER030
     C                     Z-ADD13        DBASE                                               CER030
     C                     OUT  LDA                                                           CER030
      *                                                                                       CER030
     C                     EXSR *PSSR                                                         CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if PEA switchable feature is enabled                                           CSC054
      *                                                                                       CSC054
     C                     MOVE 'N'       CSC054  1                                           CSC054
     C                     CALL 'AOSARDR0'                                                    CSC054
     C                     PARM *BLANKS   @RTCD                                               CSC054
     C                     PARM '*VERIFY' @OPTN                                               CSC054
     C                     PARM 'CSC054'  @SARN                                               CSC054
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC054
      *                                                                                       CSC054
     C           @RTCD     IFEQ *BLANKS                                                       CSC054
     C                     MOVE 'Y'       CSC054                                              CSC054
     C                     ELSE                                                               CSC054
     C           @RTCD     IFNE *BLANKS                                                       CSC054
     C           @RTCD     ANDNE'*NRF'                                                        CSC054
     C           *LOCK     IN   LDA                                                           CSC054
     C                     MOVE 'SCSARDPD'DBFILE                                              CSC054
     C                     MOVE 'CSC054'  DBKEY                                               CSC054
     C                     Z-ADD14        DBASE                                               CSC054
     C                     OUT  LDA                                                           CSC054
     C                     EXSR *PSSR                                                         CSC054
     C                     ENDIF                                                              CSC054
     C                     ENDIF                                                              CSC054
     C/COPY OFCPYSRCZ,CGL135_084                                                             CGL135B
      *                                                                                       CSC054
     C/COPY WNCPYSRC,GLH00674
     C*                                                                   CEU013
     C* Retrieve the Next available number for Account postings           CEU013
     C*                                                                   CEU013
     C           *LIKE     DEFN GLNARN    WKNARN                          CEU013
     C                     MOVE *ZEROS    WKNARN                          CEU013
     C                     MOVE *BLANKS   WKUPDT  1                       CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C********** PXRFI     CHAINGLAPNAPD             9083                            CEU013 MD036415
     C           PXRFI     CHAINGLAPNAPD            N9083                                   MD036415
     C           *IN83     IFEQ *ON                                       CEU013
     C           *LOCK     IN   LDA                                       CEU013
     C                     MOVE 'GLAPNAPD'DBFILE           ***************CEU013
     C                     MOVE PXRFI     DBKEY            * DB ERROR 11 *CEU013
     C                     Z-ADD11        DBASE            ***************CEU013
     C                     OUT  LDA                                       CEU013
     C                     EXSR ENDRT                                     CEU013
     C                     ELSE                                           CEU013
     C           *IN90     IFEQ *ON                                       CEU013
     C                     Z-ADD1         WKNARN                          CEU013
     C                     MOVE 'N'       WKUPDT                          CEU013
     C                     ELSE                                           CEU013
     C                     Z-ADDGLNARN    WKNARN                          CEU013
     C                     MOVE 'Y'       WKUPDT                          CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   S01117
     C* MULTIBRANCHED ENVIRONMENT?                                        S01117
     C*                                                                   S01117
     C           BGMBIN    COMP 'Y'                      70               S01117
     C*                                                                   S01117
     C                     EXSR GELRD                                     S01117
     C/COPY WNCPYSRC,GL0260C018
      *                                                                   CCB003
     C************IN71     IFEQ '1'                                SS01117CCB003
     C***********          GOTO END                                SS01117CCB003
     C***********          END                                     SS01117CCB003
     C*                                                                   S01117
     C* GENERATE INTERBRANCH ENTERIES?                                    S01117
     C*                                                                   S01117
     C***********BKIEBI    COMP 'Y'                      72         S01117LN0092
     C           BKIEBI    COMP 'I'                      72               LN0092
     C           BKIEMB    COMP 'Y'                      74               S01117
     C                     MOVE BKMABR    MAINB   3                       S01117
     C*                                                                   S01117
     C***********          SETON                     60                   CCB003
     C***********          EXCPT                                          CCB003
     C***********          SETOF                     60                   CCB003
0089 C*
0090 C*    SET UP ZERO FIELD.
0091 C                     Z-ADD0         ZERO   110
     C                     MOVE *BLANKS   SEQ     5                       BHF794
0092 C*
0093 C*    DETAIL CALCULATIONS.
0094 C           FIRST     TAG                             ** FIRST TAG **
     C/COPY WNCPYSRC,GL0260C006
0095 C*
0096 C*    IGNORE DELETED AND NON-BD TYPE RECORDS
0097 C*  05                SETON                     LR                   S01154
0098 C*  05                                                               S01154
0099 C*R 02                GOTO END                                       S01154
0100 C*
     C                     OPEN GLBATHPD                                                    CGL127AM
     C                     OPEN GL0260AU                                                    CGL127AM
     C                     EXCPTHEADER                                                      CGL127AM
      *                                                                                     CGL127AM
      ** Read end key from GLBATHPD                                                         CGL127AM
      *                                                                                     CGL127AM
     C                     MOVE 'Z'       IXCKEY  1                                         CGL127AM
     C           IXCKEY    CHAINDRIVEF               38                                     CGL127AM
     C           *IN38     IFEQ '0'                                                         CGL127AM
     C                     MOVE BRBTNB    EBTNB                                             CGL127AM
     C                     MOVE BRBCDA    EBCDA                                             CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
      ** Read start key from GLBATHPD                                                       CGL127AM
      *                                                                                     CGL127AM
     C           *IN38     IFEQ '0'                                                         CGL127AM
     C                     MOVE 'A'       IXCKEY                                            CGL127AM
     C           IXCKEY    CHAINDRIVEF               38                                     CGL127AM
     C                     ENDIF                                                            CGL127AM
     C           *IN38     IFEQ '0'                                                         CGL127AM
     C                     MOVE BRBTNB    NBTNB                                             CGL127AM
     C                     MOVE BRBCDA    NBCDA                                             CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
     C********** *IN38     IFEQ '1'                                                CGL127AM MD036165
     C********** *LOCK     IN   LDA                                                CGL127AM MD036165
     C**********           MOVEL'READ/'   DBOPER 11                                CGL127AM MD036165
     C**********           MOVE 'DELETE'  DBOPER                                   CGL127AM MD036165
     C**********           MOVEL'GLBATHPD'DBFILE                                   CGL127AM MD036165
     C**********           MOVELDBOPER    DBKEY                                    CGL127AM MD036165
     C**********           Z-ADD23        DBASE                                    CGL127AM MD036165
     C**********           OUT  LDA                                                CGL127AM MD036165
     C**********           EXSR ENDRT                                              CGL127AM MD036165
     C**********           ENDIF                                                   CGL127AM MD036165
     C           *IN38     IFEQ '1'                                                         MD045372
     C           *LOCK     IN   LDA                                                         MD045372
     C                     MOVEL'READ/'   DBOPER 11                                         MD045372
     C                     MOVE 'DELETE'  DBOPER                                            MD045372
     C                     MOVEL'GLBATHPD'DBFILE                                            MD045372
     C                     MOVELDBOPER    DBKEY                                             MD045372
     C                     Z-ADD23        DBASE                                             MD045372
     C                     OUT  LDA                                                         MD045372
     C                     EXSR ENDRT                                                       MD045372
     C                     ENDIF                                                            MD045372
      *                                                                                     CGL127AM
      ** Set pointer for first record for process                                           CGL127AM
      *                                                                                     CGL127AM
     C                     MOVE '0'       *IN19                                             CGL127AM
     C           NXTKEY    IFGT ENDKEY                                                      CGL127AM
     C           NXTKEY    OREQ ENDKEY                                                      CGL127AM
     C           PROT      ANDEQ'C'                                                         CGL127AM
     C                     MOVE '1'       *IN19                                             CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
     C           *IN19     IFEQ '0'                                                         CGL127AM
      *                                                                                     CGL127AM
     C           PROT      IFEQ ' '                                                         CGL127AM
     C           GLJKEY    SETLLGLJENHL2                                                    CGL127AM
     C                     ELSE                                                             CGL127AM
     C           GLJKEY    SETGTGLJENHL2                                                    CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
     C                     READ GLJENHL2                 19                                 CGL127AM
     C           *IN19     IFEQ '0'                                                         CGL127AM
     C                     MOVE BNUMH     NBTNB                                             CGL127AM
     C                     MOVE BRBCDA    NBCDA                                             CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
     C           *IN19     DOWEQ'0'                                                         CGL127AM
     C                     MOVE NXTKEY    LSTKEY                                            CGL127AM
      *                                                                                     CGL127AM
     C                     ADD  1         #COMIT                                            CGL127AM
      *                                                                                     CGL127AM
     C           STAT      IFEQ 'A'                                       S01117
     C           STAT      OREQ 'S'                                       S01340
      *                                                                   CGL007
      ** If CGL007 is ON, set up OTRF with journal entry batch number.    CGL007
      *                                                                   CGL007
     C           CGL007    IFEQ 'Y'                                       CGL007
     C                     MOVELBNUMH     OTRF                            CGL007
     C                     ENDIF                                          CGL007
     C/COPY WNCPYSRC,GL0260C002
     C*                                                                   S01117
     C**   OBTAIN THE HEADER BRANCH DETAILS                               S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C************         PARM BRCB      @DSNB   3                 S01117LN0116
     C                     PARM BRBCDA    @DSNB   3                       LN0116
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C           *LOCK     IN   LDA                                       058067
     C                     MOVE 'SDBRCHPD'DBFILE           ***************S01117
     C                     MOVEL@DSNB     DBKEY            * DB ERROR 2   S01117
     C                     MOVEL'002'     DBASE            ***************S01117
     C                     OUT  LDA                                       058067
     C                     EXSR ENDRT                                     S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*  SAVE INTERNAL CUSTOMER NO.,DUE TO & DUE FROM ACCOUNT CODE        S01117
     C*           FOR HEADER BRANCH                                       S01117
     C***********          MOVE A8BICN    BICNHD  60                                   S01117 CSD027
     C                     MOVE A8BICN    BICNHD  6                                    S01117 CSD027
     C**********           MOVE A8DTAC    ADTOH   40                                   S01117 CGL029
     C**********           MOVE A8DFAC    ADFRH   40                                   S01117 CGL029
     C                     MOVE A8DTAC    ADTOH  100                                          CGL029
     C                     MOVE A8DFAC    ADFRH  100                                          CGL029
     C/COPY WNCPYSRC,GL0260C019
      *                                                                   CCB003
0101 C*****INCREMENT*BATCHES*COUNT.                                       CCB003
0102 C***********COUNT     ADD  1         COUNT   40                      CCB003
     C*                                                                   S01117
     C** Increment batches count.                                                            BUG4970
     C           COUNT     ADD  1         COUNT   40                                         BUG4970
     C*                                                                                      BUG4970
     C* CHECK IF BATCH IS MULTIBRANCHED                                   S01117
     C*                                                                   S01117
     C***********BRMBIN    COMP 'Y'                      73        S01117 S01229
     C           BGMBIN    COMP 'Y'                      73        S01117 S01229
0103 C*
     C* RESET THE NUMBER OF POSTINGS READ AND PROCESSED TO 0              S01117
     C*                                                                   S01117
0104 C                     Z-ADD0         BTCH    50
     C*                                                                   E18574
     C*****CHECK*IF*BATCH*IN*FILE*AND*SET*IND08*ACCORDINGLY        E18574 CCB003
     C***********DPMT      COMP '   '                0808          E18574 CCB003
     C*                                                                   E18574
     C** Check if batch in file and set IND08 accordingly                                    BUG4970
     C           DPMT      COMP '   '                0808                                    BUG4970
     C*                                                                                      BUG4970
     C           CSC054    IFEQ 'Y'                                                           CSC054
     C           BNUMH     CHAINGLJEHQL0             66                                       CSC054
     C                     ENDIF                                                              CSC054
      *                                                                                       CSC054
0109 C***********BNUMH*****SETLLGLBTREL0                           S01154 S01229
0109 C           BNUMH     SETLLGLJENPL0                           S01154 S01229
0105 C*
0106 C*    LOOP TO EXTRACT ITEMS FROM BATCH TRANSACTION FILE.
0107 C           AGAIN     TAG                             ** AGAIN TAG **
0108 C                     SETOF                     04
0109 C*          TNFI      CHAINBTRANCH              42                   S01154
0109 C***********BNUMH*****READEGLBTREL0                 64        S01154 S01229
0109 C           BNUMH     READEGLJENPL0                 64        S01154 S01229
0109 C**N64******          SETON                     04             S01154S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP4                                           S01408
     C*                                                                   S01408
     C           NARC      IFNE '  '                                      E19312
     C           NARC      CHAINSDNARRL1             65                   E19312
     C           *IN65     IFEQ '1'                                       E19312
     C                     MOVELDELT,1    PNAR                            E19312
     C                     ELSE                                           E19312
     C                     MOVELPNAR1     PNAR                            E19312
     C                     END                                            E19312
     C                     END                                            E19312
     C/COPY WNCPYSRC,GL0260C026
     C*                                                                   090139
     C** Store the value of PNAR                                          090139
     C*                                                                   090139
     C                     MOVE *BLANK    NARA   30                       090139
     C                     MOVE PNAR      NARA                            090139
     C*                                                                   090139
     C           *IN64     IFEQ '0'                                       S01117
     C/COPY OFCPYSRCZ,CGL135_085                                                             CGL135B
     C*                                                                   S10736
     C* If BTRVDI = Y then VOIN = 1, otherwise, VOIN = 0.                 S10736
     C           BTRVDI    IFEQ 'Y'                                       S10736
     C                     Z-ADD1         VOIN                            S10736
     C                     ELSE                                           S10736
     C                     Z-ADD0         VOIN                            S10736
     C                     END                                            S10736
0110 C*
     C* Set Retail Indicator.                                             S01154
     C*                                                                   S01154
     C           ATYP      IFEQ 'R'                                       S01154
     C                     MOVE '1'       RIND                            S01154
     C                     ELSE                                           S01154
     C                     MOVE '0'       RIND                            S01154
     C                     END                                            S01154
     C/COPY WNCPYSRC,GL0260C009
     C*                                                                   S10736
     C** Format Original Transaction Type                                 S10736
     C*                                                                   S10736
     C                     MOVE *BLANK    OTTP                            S10736
     C/COPY WNCPYSRC,GL0260C010
     C                     MOVE *BLANK    WUAPRC  7                       S10736
     C*                                                                   090139
     C** If account is Retail, chain to ACCNT to check that account       090139
     C** exists and is not closed.                                        090139
     C*                                                                   090139
     C** Key fields to be used for CHAIN                                  090139
     C*                                                                   090139
     C           KEYFLD    KLIST                                          090139
     C**********           KFLD           NUM     60                                   090139 CSD027
     C                     KFLD           NUM     6                                           CSD027
     C                     KFLD           CY      3                       090139
     C**********           KFLD           COD     40                                   090139 CGL029
     C                     KFLD           COD    100                                          CGL029
     C                     KFLD           ASQ     20                      090139
     C                     KFLD           BRC     3                       090139
     C*                                                                   090139
     C                     MOVE CNUMA     NUM                             090139
     C                     MOVE CCY       CY                              090139
     C                     MOVE ACODA     COD                             090139
     C                     MOVE ACSQA     ASQ                             090139
     C                     MOVE BTIBCA    BRC                             090139
     C*                                                                   090139
     C           KEYFLD    CHAINACCNTABF             02                   090139
     C/COPY WNCPYSRC,GL0260C016
     C* Include Non-Retail Nostro accounts with Retail accounts in        CEU013
     C*  re-routing to computer suspense account.                         CEU013
     C*                                                                   CEU013
     C           *IN02     IFEQ '0'                                       090139
     C           CATYP     ANDEQ'R'                                       090139
     C           CRECI     ANDNE'D'                                       090139
     C           *IN02     OREQ '1'                                       090139
     C           ATYP      ANDEQ'R'                                       090139
     C/COPY WNCPYSRC,GL0260C007
     C*                                                                   CEU013
     C           CEU013    OREQ 'Y'                                       CEU013
     C           *IN02     ANDEQ'0'                                       CEU013
     C           CATYP     ANDEQ'N'                                       CEU013
     C           CRECI     ANDNE'D'                                       CEU013
     C*                                                                   CEU013
     C           CEU013    OREQ 'Y'                                       CEU013
     C           *IN02     ANDEQ'1'                                       CEU013
     C           ATYP      ANDEQ'N'                                       CEU013
     C/COPY WNCPYSRC,GL0260C008
     C*                                                                   090139
     C*   Read posting branch information for batch item.                 090139
     C*                                                                   090139
     C**********           CALL 'AOBRCHR0'                                090139              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       090139
     C                     PARM '*KEY   ' @OPTN   7                       090139
     C                     PARM BTIBCA    @DSNB   3                       090139
     C********** SDBRCH    PARM SDBRCH    DSFDY                           090139              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    090139
     C           *LOCK     IN   LDA                                       090139
     C                     MOVE 'SDBRCHPD'DBFILE           ***************090139
     C                     MOVEL@DSNB     DBKEY            * DB ERROR 009 090139
     C                     MOVEL'009'     DBASE            ***************090139
     C                     OUT  LDA                                       090139
     C                     EXSR ENDRT                                     090139
     C                     GOTO END                                       090139
     C                     END                                            090139
     C*                                                                   090139
     C*  Change account of posting to suspense account, and change        090139
     C*  narrative to show the original account number.                   090139
     C*  Note - this assumes that the suspense account is type 'G'        090139
     C*                                                                   090139
     C                     MOVELCNUMA     STOR1   9                       090139
     C                     MOVE CCY       STOR1                           090139
     C**********           MOVELACODA     STOR2   6                                    090139 CGL029
     C                     MOVELACODA     STOR2  12                                           CGL029
     C                     MOVE ACSQA     STOR2                           090139
     C**********           MOVELSTOR1     STOR   15                                    090139 CGL029
     C                     MOVELSTOR1     STOR   21                                           CGL029
     C                     MOVE STOR2     STOR                            090139
     C                     MOVE *BLANK    PNAR                            090139
     C                     MOVELNARR,1    PNAR                            090139
     C                     MOVE STOR      PNAR                            090139
     C/COPY WNCPYSRC,GL0260C017
     C                     MOVE CNUMA     ASOCA                           090139
     C                     MOVE A8BICN    CNUMA                           090139
     C                     MOVE BKACCD    ACODA                           090139
     C                     MOVE '01'      ACSQA                           090139
     C                     MOVE *ZERO     TRATA                           090139
     C                     MOVE *ZERO     CHQNA                           090139
     C                     MOVE *BLANK    RINO                            090139
     C                     MOVE *ZERO     RRNM                            090139
     C                     MOVE 'G'       ATYP                            090139
     C                     MOVE '0'       RIND                            090139
     C                     MOVE *ZERO     BTRACN                          090139
     C                     MOVE *BLANK    BTCOIN                          090139
     C*                                                                   090139
     C                     END                                            090139
     C*                                                                   S10736
     C** FOR RETAIL ACCOUNTS:                                             S10736
     C** Output transaction type to Original Transaction type             S10736
     C** except for FT and FF transactions                                S10736
     C*                                                                   S10736
     C           ATYP      IFEQ 'R'                                       S10736
     C*                                                                   S10736
     C           TRATA     IFNE *BLANK                                    S10736
     C*                                                                   S10736
     C           TRATA     IFNE '93000'                                   S10736
     C           TRATA     ANDNE'92060'                                   S10736
     C/COPY WNCPYSRC,GL0260C011
     C                     MOVELTRATA     OTTP                            S10736
     C/COPY WNCPYSRC,GL0260C012
     C                     END                                            S10736
     C*                                                                   S10736
     C** FOR RETAIL ACCOUNTS:                                             S10736
     C*  Determine TRAT (Retail Transaction Type) from the input          S10736
     C*  Transaction type. TRAT is either:                                S10736
     C*      1) Input   - Number exists on SDRETRPD                       S10736
     C*      2) Derived - Deal type/Sub-type relates to a transaction     S10736
     C*                   Module, which have predefined TRAT Numbers.     S10736
     C*                                                                   S10736
     C*  Access Retail Transaction types file                             S10736
     C*                                                                   S10736
     C                     CALL 'AORETRR0'                                S10736
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    S10736
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S10736
     C                     PARM TRATA     UURTTY  5        I:Ret.Tran TypeS10736
     C           D@RETR    PARM *BLANK    DSFDY            O:Format       S10736
     C*                                                                   S10736
     C* No Retail Transaction Type found derive one                       S10736
     C*                                                                   S10736
     C           WUAPRC    IFNE *BLANK                                    S10736
     C*                                                                   S10736
     C           TRAT2     IFEQ *BLANK                                    S10736
     C** Positions 3 - 5 of Type are blank.                               S10736
     C           OTST      IFNE *BLANK                                    S10736
     C           OTST2     ANDEQ*BLANK                                    S10736
     C** Positions 1 & 2  of sub-type present.                            S10736
     C*                                                                   S10736
     C** Check for Customer Lending Loan types (92020)                    S10736
     C*                                                                   S10736
     C                     MOVELTRATA     UULNTY  2                       S10736
     C                     MOVELOTST      UULNST  2                       S10736
     C                     MOVELTRCLAS    UULNCL  4                       CLE042
     C                     CALL 'AOLOANR0'                                S10736
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    S10736
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S10736
     C                     PARM           UULNTY           I:Loan Type    S10736
     C                     PARM           UULNST           I:Loan Sub TypeS10736
     C                     PARM           UULNCL           I:Loan Class   CLE042
     C           D@LOAN    PARM *BLANK    DSFDY            O:Format       S10736
     C*                                                                   S10736
     C           WUAPRC    IFEQ *BLANK                                    S10736
     C** Customer Lending Loan found                                      S10736
     C                     MOVE '92020'   TRATA                           S10736
     C                     ELSE                                           S10736
     C** Default Dealing transaction type                                 S10736
     C                     MOVE '92000'   TRATA                           S10736
     C                     END                                            S10736
     C** Sub type is 1 or 2 characters - END                              S10736
     C                     END                                            S10736
     C** Trans Type is 1 or 2 characters - END                            S10736
     C                     END                                            S10736
     C*                                                                   S10736
     C           OTST      IFEQ *BLANK                                    S10736
     C** Sub Type is Blank                                                S10736
     C*                                                                   S10736
     C** Check for Futures and Options Mkt/Instrument type (92060)        S10736
     C*                                                                   S10736
     C                     MOVELTRATA     UUISTT  5                       S10736
     C                     CALL 'AOFFITR0'                                S10736
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    S10736
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S10736
     C                     PARM           UUISTT           I:Instr. Type  S10736
     C           D@INTY    PARM *BLANK    DSFDY            O:Format       S10736
     C*                                                                   S10736
     C           WUAPRC    IFEQ *BLANK                                    S10736
     C** Futures Mkt/Instrument Found                                     S10736
     C                     MOVE '92060'   TRATA                           S10736
     C*                                                                   S10736
     C                     ELSE                                           S10736
     C*                                                                   S10736
     C** Check for Customer Lending Facility (92020)                      S10736
     C*                                                                   S10736
     C                     MOVELTRATA     UUFCTY  3                       S10736
     C                     CALL 'AOFACTR0'                                S10736
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        B:Return Cd    S10736
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S10736
     C                     PARM           UUFCTY           I:Facility     S10736
     C           D@INTY    PARM *BLANK    DSFDY            O:Format       S10736
     C*                                                                   S10736
     C           WUAPRC    IFEQ *BLANK                                    S10736
     C** Customer Lending Facility Found                                  S10736
     C                     MOVE '92020'   TRATA                           S10736
     C                     ELSE                                           S10736
     C** Default Dealing transaction type                                 S10736
     C                     MOVE '92000'   TRATA                           S10736
     C                     END                                            S10736
     C** Futures Mkt/Instrument Found - END                               S10736
     C                     END                                            S10736
     C*                                                                   S10736
     C                     ELSE                                           S10736
     C** Sub type is Not Blank                                            S10736
     C** Default Securities transaction type                              S10736
     C                     MOVE '92050'   TRATA                           S10736
     C                     END                                            S10736
     C** Retail Trans Type not found - END                                S10736
     C                     END                                            S10736
     C** Trans Type Blank - END                                           S10736
     C                     END                                            S10736
     C*                                                                   S10736
     C                     ELSE                                           S10736
     C** Account type is NON - RETAIL                                     S10736
     C/COPY WNCPYSRC,GL0260C013
     C                     MOVELTRATA     OTTP                            S10736
     C/COPY WNCPYSRC,GL0260C014
     C                     MOVE *BLANK    TRATA                           S10736
     C                     END                                            S10736
     C/COPY WNCPYSRC,GL0260C015
     C*                                                                   S10736
     C*   FORMAT SOURCE OF POSTING DATA STRUCTURE                         S01117
     C*                                                                   S01117
     C*********************Z-ADDBNUM      BNUMSP                   S01117 S01229
     C                     MOVE BNUM      BNUMSP                   S01117 S01229
     C                     Z-ADDITEM      ITEMSP                          S01117
     C                     MOVE *BLANKS   TYPE                            S01117
0110 C*
     C* Set Debit/Credit Indicator.                                       S01154
     C*                                                                   S01154
     C***********BTAVST    IFEQ 'C'                                 S01154S01194
     C           BTDCIN    IFEQ 'C'                                       S01194
     C                     MOVE '1'       DRCR                            S01154
     C                     ELSE                                           S01154
     C                     MOVE '0'       DRCR                            S01154
     C                     END                                            S01154
     C*                                                                   S01117
     C*       IF CUSTOMER ORIGINATED IND.='Y'                             S01117
     C                     BITOF'01234567'PRIN    1                       S01117
     C           BTCOIN    IFEQ 'Y'                                       S01117
     C                     BITON'0'       PRIN    1                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  IF BATCH STATUS IS 'S', SET ON BIT 6 PRIN FIELD                 S01340
     C*                                                                   S01340
     C           STAT      IFEQ 'S'                                       S01340
     C********** VALD      ANDLEBKAPDT                                             MD037046 MD045515
     C                     BITON'6'       PRIN    1                       S01340
     C                     END                                            S01340
     C*                                                                   S01340
     C**  WRITE RECORD AFTER ALTERING RECORD ID TO P FOR POSTING          S01117
     C**               AND SETTING UP SOURCE OF POSTING                   S01117
     C                     EXSR CHGTYP                                    S01117
     C                     MOVE 'P'       RECI                            S01117
     C                     MOVE SPOSDS    SPOS                            S01117
     C                     MOVE BTIBCA    BRCA                            LN0116
     C                     ADD  1         ACTOT                           S01117
     C************         MOVE ACODA     ACALFA  4                S10736 090139
     C                     EXSR ACTYPE                                    S10736
      *                                                                                       CSC054
     C           CSC054    IFEQ 'Y'                                                           CSC054
     C           *IN66     ANDEQ'0'                                                           CSC054
     C           HQBDTE    ANDNE*ZERO                                                         CSC054
     C                     Z-ADDHQBDTE    VALD                                                CSC054
     C                     ENDIF                                                              CSC054
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCPG                                           S01408
     C*                                                                   S01408
     C           CMC001    IFNE 'Y'                                       CMC001
     C           CMC001    OREQ 'Y'                                       CMC001
     C           STAT      ANDNE'S'                                       CMC001
      **********                                                                     238728 MD023916
      ***Set*the*profit*centre*to*that*of*the*account*if*nostro*or*retail*           238728 MD023916
      **********                                                                     238728 MD023916
     C********** BGN0ST    IFEQ 'Y'                                                  238728 MD023916
     C********** CATYP     ANDEQ'R'                                                  238728 MD023916
     C********** BGN0ST    OREQ 'Y'                                                  238728 MD023916
     C********** CATYP     ANDEQ'N'                                                  238728 MD023916
     C**********           MOVE CPRFC     PRFC                                       238728 MD023916
     C**********           ENDIF                                                     238728 MD023916
     C*                                                                   CEU013
     C* Generate extension record to file MANPOAPD if the Original        CEU013
     C*  currency and amount fields are non blank.                        CEU013
     C                     EXSR GENOX1                                    CEU013
     C*                                                                   CEU013
     C                     WRITEAPOSTPDF                                  S01117
     C*                                                                   090139
     C** Restore values of PNAR                                           090139
     C*                                                                   090139
     C                     MOVE *BLANK    PNAR                            090139
     C                     MOVE NARA      PNAR                            090139
     C                     ENDIF                                          CMC001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01117
     C** IF ENVIRONMENT IS MULTIBRANCHED AND IF WE ARE GENERATING         S01117
     C** INTER-BRANCH ENTERIES AT ITEM LEVEL AND IF MULTIBRANCHED         S01117
     C** BATCHES ARE USED, GENERATE INTER-BRANCH ENTERIES                 S01117
     C*                                                                   S01117
     C           *IN70     IFEQ '1'                                       S01117
     C           *IN72     ANDEQ'1'                                       S01117
     C           *IN73     ANDEQ'1'                                       S01117
     C*                                                                   S01117
     C** CHECK THAT HEADER BRANCH IS NOT EQUAL TO POSTING BRANCH          S01117
     C*                                                                   S01117
     C***********BRCB      ANDNEBRCA                                S01117LN0116
     C           BRBCDA    ANDNEBTIBCA                                    LN0116
     C*                                                                   S01117
     C/COPY WNCPYSRC,GL0260C020
     C                     EXSR HDPSBR                                    S01117
     C*                                                                   S01117
     C** IF GENERATING INTER-BRANCH ENTERIES VIA MAIN BRANCH AND IF       S01117
     C** BATCH BRANCH NOT THE SAME AS MAIN BRANCH AND IF POSTING BRANCH   S01117
     C** DIFFERENT TO MAIN BRANCH, GENERATE ADDITIONAL ENTRIES            S01117
     C*                                                                   S01117
     C           *IN74     IFEQ '1'                                       S01117
     C***********BRCB      ANDNEMAINB                               S01117LN0116
     C           BRBCDA    ANDNEMAINB                                     LN0116
     C***********BRCA      ANDNEMAINB                               S01117LN0116
     C           BTIBCA    ANDNEMAINB                                     LN0116
     C/COPY WNCPYSRC,GL0260C025
     C*                                                                   S01117
     C                     EXSR GENR                                      S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,GL0260C021
     C*                                                                   S01117
     C           *INU7     IFEQ '1'                                       S01117
     C           *INU8     ANDEQ'1'                                       S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01154
0111 C*    OUTPUT RECORD.
0112 C***04******          EXCPT                                          S01117
0113 C***04******PSTA      DIV  1000      ZZAMT                           S01117
0114 C***04******          EXSR GLZADD                                    S01117
0115 C***04******BTCH      ADD  1         BTCH                            S01117
0113 C           PSTA      DIV  1000      ZZAMT                           S01117
0114 C                     EXSR GLZADD                                    S01117
0115 C           BTCH      ADD  1         BTCH                            S01117
     C                     END                                            S01117
0116 C*
0117 C*    INCREMENT ITEM COUNTER.
0118 C*          TNFI      ADD  1         TNFI                            S01154
0119 C*
0120 C*    TEST FOR LAST ITEM.
0121 C*          TNFI      COMP TNLI                 45                   S01154
0122 C* N45                GOTO AGAIN                                     S01154
0122 C  N64                GOTO AGAIN                                     S01154
      *                                                                                       CSC054
     C           CSC054    IFEQ 'Y'                                                           CSC054
     C           *IN66     IFEQ '0'                                                           CSC054
     C           HQBDTE    ANDNE*ZERO                                                         CSC054
     C                     Z-ADDPSTD      CRMDTE                                              CSC054
     C                     MOVE BNUMH     CRBTNB                                              CSC054
     C                     WRITEGLCORBD0                                                      CSC054
     C                     ENDIF                                                              CSC054
     C                     ENDIF                                                              CSC054
0123 C*
0124 C*    TEST FOR DISCREPANCY.
     C                     SETOF                     46                   S01117
     C           BTCH      IFNE NII                                       S01117
     C           NII       ANDNE0                                         S01117
     C                     SETON                     46U8                 S01117
     C***********CEU013    IFNE 'Y'                                                   CEU013 BUG4970
     C***********          CLOSEGL0260AU                                              188470 BUG4970
     C***********          OPEN GL0260AU                                              CCB003 BUG4970
     C***********          ENDIF                                                      CEU013 BUG4970
     C***********          EXCPT                                                      CCB003 BUG4970
     C***********CEU013    IFNE 'Y'                                                   CEU013 BUG4970
     C***********          CLOSEGL0260AU                                              CCB003 BUG4970
     C***********          ENDIF                                                      CEU013 BUG4970
     C                     END                                            S01117
0125 C***********BTCH      COMP NII                  4646                 S01117
0126 C***46******          SETON                     U8                   S01117
0127 C*
0128 C*    INCREMENT A/C POSTINGS TOTAL.
0129 C***********ACTOT     ADD  BTCH      ACTOT   50                      S01117
     C                     END                                            S01117
      *                                                                                     CGL127AM
      ** Comit if number of records processed is at least optimum                           CGL127AM
      ** defined in CBTASKSP.                                                               CGL127AM
      *                                                                                     CGL127AM
     C           #COMIT    IFGE #OPTIM                                                      CGL127AM
     C                     EXSR UPDPTR                                                      CGL127AM
      *                                                                                     CGL127AM
     C                     COMIT                                                            CGL127AM
     C                     Z-ADD0         #COMIT                                            CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
      ** Check if end record is read                                                        CGL127AM
      *                                                                                     CGL127AM
     C           COUNT     IFEQ 27                                                          CGL127AM
     C                     EXCPTHEADER                                                      CGL127AM
     C                     Z-ADD0         COUNT                                            AR1089863
     C                     ENDIF                                                            CGL127AM
     C                     EXCPTDETAIL                                                      CGL127AM
     C                     READ GLJENHL2                 19                                 CGL127AM
      *                                                                                     CGL127AM
     C           *IN19     IFEQ '0'                                                         CGL127AM
     C                     MOVE BNUMH     NBTNB                                             CGL127AM
     C                     MOVE BRBCDA    NBCDA                                             CGL127AM
      *                                                                                     CGL127AM
     C           NXTKEY    IFGT ENDKEY                                                      CGL127AM
     C                     MOVE '1'       *IN19                                             CGL127AM
     C                     ENDIF                                                            CGL127AM
     C                     ENDIF                                                            CGL127AM
0130 C*
0131 C           END       TAG                             ** END TAG **
      *                                                                                     CGL127AM
     C                     ENDDO                                                            CGL127AM
0132 C*
0133 C*    TOTAL TIME CALCULATIONS.
     C***LR                   EXSR LRSR                                              S01117 CGL127AM
     C                     EXSR LRSR                                                        CGL127AM
0134 C*R*********ACTOT     ADD  2         RECS    50                      S01117
0135 C*R*********ZZTOTD    MULT 10        TOTD    40   47                 S01117
0136 C*RN47******ZZTOTI    COMP 0                      47                 S01117
     C*********                                                     E19908S01194
     C*****RECOVER I.C.D. FROM TABLE FILE.                          E19908S01194
     C*R*******            MOVEL'01      'TABKEY 12                 E19908S01194
     C*R*******            MOVE '  10'    TABKEY                    E19908S01194
     C*R*******            SETOF                     03             E19908S01194
     C*R*******  TABKEY    CHAINTABLE                42             E19908S01194
     C*                                                             E19908S01194
     C*****************************************************************   S01117
     C*                                                                   S01117
     C** IF HEADER BRANCH NOT EQUAL TO POSTING BRANCH                     S01117
     C** PRODUCE ONE POSTINGS FOR EACH BRANCH                             S01117
     C*                                                                   S01117
      *****************************************************************   CCB003
     C           HDPSBR    BEGSR                                          S01117
     C*                                                                   S01117
     C************                                                        S10736
     C************         MOVE *BLANKS   TRATA                    S01117 S10736
     C************         MOVE *BLANKS   CHQNA                    S01117 S10736
     C************         MOVE *BLANKS   ASOCA                    S01117 S10736
     C*                                                            S01117
     C****MOVE*POSTING DATE TO VALUE DATE                          S01117 S10736
     C************                                                 S01117 S10736
     C************         Z-ADDPSTD      VALD                     S01117 S10736
     C*                                                                   S01117
     C                     MOVE 'Y'       WFRSR   1                       CAC001
     C                     BITOF'0'       PRIN                            S01117
     C*                                                                   S01117
     C*   READ POSTING BRANCH INFORMATION                                 S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C************         PARM BRCA      @DSNB   3                 S01117LN0116
     C                     PARM BTIBCA    @DSNB   3                       LN0116
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       058067
     C                     MOVE 'SDBRCHPD'DBFILE           ***************S01117
     C                     MOVEL@DSNB     DBKEY            * DB ERROR 3   S01117
     C                     MOVEL'003'     DBASE            ***************S01117
     C                     OUT  LDA                                       058067
     C                     EXSR ENDRT                                     S01117
     C                     GOTO ENDHD                                     S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C*  SAVE INTERNAL CUSTOMER NO.,DUE TO & DUE FROM ACCOUNT CODE        S01117
     C*           FOR POSTING BRANCH                                      S01117
     C*                                                                   S01117
     C***********          MOVE A8BICN    BICNPD  60                                   S01117 CSD027
     C                     MOVE A8BICN    BICNPD  6                                    S01117 CSD027
     C**********           MOVE A8DTAC    ADTOP   40                                   S01117 CGL029
     C**********           MOVE A8DFAC    ADFRP   40                                   S01117 CGL029
     C                     MOVE A8DTAC    ADTOP  100                                          CGL029
     C                     MOVE A8DFAC    ADFRP  100                                          CGL029
     C                     END                                            S01117
     C*                                                                   S01117
     C*   READ MAIN BRANCH INFORMATION                                    S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM MAINB     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       058067
     C                     MOVE 'SDBRCHPD'DBFILE           ***************S01117
     C                     MOVEL@DSNB     DBKEY            * DB ERROR 4   S01117
     C                     MOVEL'004'     DBASE            ***************S01117
     C                     OUT  LDA                                       058067
     C                     EXSR ENDRT                                     S01117
     C                     GOTO ENDHD                                     S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C*  SAVE INTERNAL CUSTOMER NO.,DUE TO & DUE FROM ACCOUNT CODE        S01117
     C*           FOR MAIN BRANCH                                         S01117
     C*                                                                   S01117
     C***********          MOVE A8BICN    BICNMD  60                                   S01117 CSD027
     C                     MOVE A8BICN    BICNMD  6                                    S01117 CSD027
     C**********           MOVE A8DTAC    ADTOM   40                                   S01117 CGL029
     C**********           MOVE A8DFAC    ADFRM   40                                   S01117 CGL029
     C                     MOVE A8DTAC    ADTOM  100                                          CGL029
     C                     MOVE A8DFAC    ADFRM  100                                          CGL029
     C                     END                                            S01117
     C/COPY WNCPYSRC,GL0260C022
     C*                                                                   S01117
     C           *IN74     IFEQ '0'                                       S01117
     C***********BRCB      OREQ MAINB                               S01117LN0116
     C           BRBCDA    OREQ MAINB                                     LN0116
     C***********BRCA      OREQ MAINB                               S01117LN0116
     C           BTIBCA    OREQ MAINB                                     LN0116
     C/COPY WNCPYSRC,GL0260C023
     C                     MOVE BICNHD    CNUMA                           S01117
     C                     ELSE                                           S01117
     C                     MOVE BICNMD    CNUMA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVE '01'      ACSQA                           S01117
     C*                                                                   S01117
     C           BTDCIN    IFEQ 'C'                                       S01117
     C****************     MOVE ADTOP     ACODA                     S01117LN0116
     C                     MOVE ADFRP     ACODA                           LN0116
     C                     MOVE '0'       DRCR                            S01117
     C                     MOVE '1'       *IN77                           BHF794
     C                     ELSE                                           S01117
     C****************     MOVE ADFRP     ACODA                     S01117LN0116
     C                     MOVE ADTOP     ACODA                           LN0116
     C                     MOVE '1'       DRCR                            S01117
     C                     MOVE '0'       *IN77                           BHF794
     C                     END                                            S01117
     C*                                                                   S01117
     C**  WRITE RECORD AFTER ALTERING RECORD ID TO P FOR POSTING          S01117
     C**               AND SETTING UP SOURCE OF POSTING                   S01117
     C*                                                                   S01117
     C                     EXSR CHGTYP                                    S01117
     C                     MOVE 'P'       RECI                            S01117
     C                     MOVE 'A'       TYPE                            S01117
     C                     MOVE SPOSDS    SPOS                            S01117
     C                     ADD  1         ACTOT                           S01117
     C************         MOVE ACODA     ACALFA  4                E30172 090139
     C                     EXSR ACTYPE                                    E30172
      *                                                                                       CSC054
     C           CSC054    IFEQ 'Y'                                                           CSC054
     C           *IN66     ANDEQ'0'                                                           CSC054
     C           HQBDTE    ANDNE*ZERO                                                         CSC054
     C                     Z-ADDHQBDTE    VALD                                                CSC054
     C                     ENDIF                                                              CSC054
      *                                                                   087773
      *****Setup*the*posting*narrative*for*interbranch*entries*for                     087773 145956
      *****entries*branch*level*with*NARR,1***********************                     087773 145956
      *                                                                   087773
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CP12                                           S01408
     C*                                                                   S01408
     C***********          MOVELNARR,1    PNAR                                         087773 145956
     C***********          MOVE W0BITM    PNAR                                         087773 145956
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CP13                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCPG                                           S01408
     C*                                                                   S01408
     C           CMC001    IFNE 'Y'                                       CMC001
     C           CMC001    OREQ 'Y'                                       CMC001
     C           STAT      ANDNE'S'                                       CMC001
     C*                                                                   CEU013
     C* Generate extension record to file MANPOAPD if the Original        CEU013
     C*  currency and amount fields are non blank.                        CEU013
     C                     EXSR GENOX1                                    CEU013
     C*                                                                   CEU013
     C                     WRITEAPOSTPDF                                  S01117
     C*                                                                   BHF794
     C*****FOR*EACH NEW BRANCH PRODUCE A SEPARATE REPORT           BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********BRBCDA    IFNE BRCBX                              BHF794 CCB003
     C***WRITE*CCY*TOTALS*IF*APPLICABLE*TO*GL0260P1                BHF794 CCB003
     C***********          SETON                     10            BHF794 CCB003
     C***********          MOVE CCY       @CCY    3                E28709 CCB003
     C***********          EXSR TOTREP                             BHF794 CCB003
     C***********          MOVE @CCY      CCY                      E28709 CCB003
     C***********          CLOSEGL0260P1                           BHF794 CCB003
     C***********          SETON                     10            BHF794 CCB003
     C***********                                                         CCB003
     C***********          MOVE BRBCDA    BRCBX   3                BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          OPEN GL0260P1                           BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****ENSURE*REPORT*SPOOL*FILE*RECORDED*BY*RCF                 BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          OUT  LDA                                BHF794 058067
     C***********          Z-ADDSFNUM     SFNUM1  60               BHF794 CCB003
     C***********          CALL 'ZSFILE'                           BHF794 CCB003
     C***********          PARM           SEQ                      BHF794 CCB003
     C***********          PARM BRBCDA    SENTY   3                BHF794 CCB003
     C***********          PARM           SFILE                    BHF794 CCB003
     C***********          PARM           SFNUM1                   BHF794 CCB003
     C***********          PARM           ZSERR   1                BHF794 CCB003
     C************LOCK     IN   LDA                                BHF794 058067
     C***********                                                  BHF794 CCB003
     C***********ZSERR     IFEQ 'Y'                                BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C**ERROR*DURING*ZSFILE*PROCESSING,*RETURN*TO*CALLING*PROGRAMMEBHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          SETON                     U7U8LR        BHF794 CCB003
     C***********          RETRN                                   BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          Z-ADD0         PAGE1                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***CHECK*CORRECT NO. OF DECIMALS FOR POSTING AMOUNT BY CHECKINGF794 CCB003
     C***TO*SEE*IF CURRENCY INPUT HAS BEEN ENTERED PREVIOUSLY      BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          Z-ADD1         V       30               BHF794 CCB003
     C***********V         DOWLEW                                  BHF794 CCB003
     C************IN96     ANDNE'1'                                BHF794 CCB003
     C***********V         OCUR CURLOD                             BHF794 CCB003
     C***********CCY       IFEQ CURC                               BHF794 CCB003
     C***********          MOVE NODEC     A6NBDP                   BHF794 CCB003
     C***********          SETON                     96            BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          ADD  1         V                        BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C**IF*A*NEW*CCY CODE, THEN OBTAIN AND LOAD IN DATA STRUCTURE  BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN96     IFEQ '0'                                BHF794 CCB003
     C***********          CALL 'AOCURRR0'                         BHF794 CCB003
     C***********          PARM *BLANK    @RTCD                    BHF794 CCB003
     C***********          PARM '*KEY    '@OPTN                    BHF794 CCB003
     C***********          PARM           CCY                      BHF794 CCB003
     C***********SDCURR    PARM SDCURR    DSSDY                    BHF794 CCB003
     C***********@RTCD     IFNE *BLANKS                            BHF794 CCB003
     C************LOCK     IN   LDA                                058067 CCB003
     C***********          MOVEL'SDCURRPD'DBFILE    ***************BHF794 CCB003
     C***********          MOVEL@OPTN     DBKEY     * DB ERROR 6   BHF794 CCB003
     C***********          MOVEL'006'     DBASE     ***************BHF794 CCB003
     C***********          OUT  LDA                                058067 CCB003
     C***********          EXSR ENDRT                              BHF794 CCB003
     C***********          ELSE                                    BHF794 CCB003
     C***********          ADD  1         W       30               BHF794 CCB003
     C***********W         OCUR CURLOD                             BHF794 CCB003
     C***********          MOVE CCY       CURC                     BHF794 CCB003
     C***********          MOVE A6NBDP    NODEC                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********A6NBDP    COMP 1                      4041        BHF794 CCB003
     C***********A6NBDP    COMP 2                    43  44        BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN40     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE PSTA      PSTAA                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN41     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE PSTA      PSTAB                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN44     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE PSTA      PSTAC                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN43     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE PSTA      PSTAD                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C*****PRINT*AN*AUDIT*OF*THE*OPERATION                         BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          EXSR OVRF                               BHF794 CCB003
     C***********          WRITED001                               BHF794 CCB003
     C***********          EXSR OVRF                               BHF794 CCB003
     C***********          WRITED002                               BHF794 CCB003
     C*                                                                   088498
     C                     MOVE BTIBCA    BRCA                            088498
     C*                                                                   088498
     C***********          EXSR AUDIT                              BHF794 CCB003
     C                     ENDIF                                          CMC001
     C*                                                                   S01117
     C*    FORMAT POSTING RECORD FOR HEADER BRANCH                        S01117
     C*                                                                   S01117
     C           BTDCIN    IFEQ 'C'                                       S01117
     C                     MOVE '1'       DRCR                            S01117
     C                     MOVE '0'       *IN77                           BHF794
     C*************        MOVE ADFRH     ACODA                     S01117LN0116
     C                     MOVE ADTOH     ACODA                           LN0116
     C                     ELSE                                           S01117
     C*************        MOVE ADTOH     ACODA                     S01117LN0116
     C                     MOVE ADFRH     ACODA                           LN0116
     C                     MOVE '0'       DRCR                            S01117
     C                     MOVE '1'       *IN77                           BHF794
     C                     END                                            S01117
     C*                                                                   S01117
     C********** *IN72     IFEQ '0'                                 S01117LN0116
     C           *IN74     IFEQ '0'                                       LN0116
     C***********BRCB      OREQ MAINB                               S01117LN0116
     C           BRBCDA    OREQ MAINB                                     LN0116
     C***********BRCA      OREQ MAINB                               S01117LN0116
     C           BTIBCA    OREQ MAINB                                     LN0116
     C/COPY WNCPYSRC,GL0260C024
     C                     MOVE BICNPD    CNUMA                           S01117
     C                     ELSE                                           S01117
     C                     MOVE BICNMD    CNUMA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C***********          MOVE BRCB      BRCA                      S01117LN0116
     C                     MOVE BRBCDA    BRCA                            LN0116
     C*                                                                   S01117
     C**  WRITE RECORD AFTER ALTERING RECORD ID TO P FOR POSTING          S01117
     C**               AND SETTING UP SOURCE OF POSTING                   S01117
     C*                                                                   S01117
     C                     EXSR CHGTYP                                    S01117
     C                     MOVE 'P'       RECI                            S01117
     C                     MOVE 'B'       TYPE                            S01117
     C                     MOVE SPOSDS    SPOS                            S01117
     C                     ADD  1         ACTOT                           S01117
     C************         MOVE ACODA     ACALFA  4                E30172 090139
     C                     EXSR ACTYPE                                    E30172
      *                                                                                       CSC054
     C           CSC054    IFEQ 'Y'                                                           CSC054
     C           *IN66     ANDEQ'0'                                                           CSC054
     C           HQBDTE    ANDNE*ZERO                                                         CSC054
     C                     Z-ADDHQBDTE    VALD                                                CSC054
     C                     ENDIF                                                              CSC054
      *                                                                   087773
      *****Setup*the*posting*narrative*for*interbranch*entries*for                     087773 145956
      *****batch*branch*level*with*NARR,2*************************                     087773 145956
      *                                                                   087773
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CP14                                           S01408
     C*                                                                   S01408
     C***********          MOVELNARR,2    PNAR                                         087773 145956
     C***********          MOVE W0BITM    PNAR                                         087773 145956
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP7                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCPG                                           S01408
     C*                                                                   S01408
     C           CMC001    IFNE 'Y'                                       CMC001
     C           CMC001    OREQ 'Y'                                       CMC001
     C           STAT      ANDNE'S'                                       CMC001
     C*                                                                   CEU013
     C* Generate extension record to file MANPOAPD if the Original        CEU013
     C*  currency and amount fields are non blank.                        CEU013
     C                     EXSR GENOX1                                    CEU013
     C*                                                                   CEU013
     C                     WRITEAPOSTPDF                                  S01117
     C*                                                                   BHF794
     C*****PRINT*AN*AUDIT*OF*THE*OPERATION                         BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          EXSR AUDIT                              BHF794 CCB003
     C                     ENDIF                                          CMC001
     C*                                                                   S01117
     C*   ADD POSTING AMOUNT TO HASH TOTAL                                S01117
     C*                                                                   S01117
     C           PSTA      ADD  PSTA      PSTA2  150                      S01117
     C           PSTA2     DIV  1000      ZZAMT  153                      S01117
     C                     EXSR GLZADD                                    S01117
     C                     MOVE *BLANK    WFRSR                           CAC001
     C*                                                                   S01117
     C           ENDHD     ENDSR                                          S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C* GENR SR - TO GENERATE INTER-BRANCH ENTERIES                       S01117
     C*                                                                   S01117
      *****************************************************************   CCB003
     C           GENR      BEGSR                                          S01117
     C*                                                                   S01117
     C**  WRITE RECORD TO POSTINGS FILE FOR INTERBRANCH ENTRY VIA THE     S01117
     C**  MAIN BRANCH AND POSTING BRANCH                                  S01117
     C*                                                                   S01117
     C                     MOVE 'Y'       WFRSR                           CAC001
     C                     MOVE BICNPD    CNUMA                           S01117
     C                     MOVE MAINB     BRCA                            S01117
     C*                                                                   S01117
     C* Set Debit/Credit Indicator AND ACCOUNT CODE FOR BATCH BRANCH      S01154
     C*                                                                   S01154
     C           BTDCIN    IFEQ 'C'                                       S01154
     C                     MOVE '1'       DRCR                            S01154
     C                     MOVE '0'       *IN77                           BHF794
     C***************      MOVE ADFRM     ACODA                     S01117LN0116
     C                     MOVE ADTOM     ACODA                           LN0116
     C                     ELSE                                           S01154
     C                     MOVE '0'       DRCR                            S01154
     C                     MOVE '1'       *IN77                           BHF794
     C***************      MOVE ADTOM     ACODA                     S01117LN0116
     C                     MOVE ADFRM     ACODA                           LN0116
     C                     END                                            S01154
     C*                                                                   S01154
     C                     EXSR CHGTYP                                    S01117
     C                     MOVE 'P'       RECI                            S01117
     C                     MOVE SPOSDS    SPOS                            S01117
     C                     ADD  1         ACTOT                           S01117
     C************         MOVE ACODA     ACALFA  4                E30172 090139
     C                     EXSR ACTYPE                                    E30172
      *                                                                                       CSC054
     C           CSC054    IFEQ 'Y'                                                           CSC054
     C           *IN66     ANDEQ'0'                                                           CSC054
     C           HQBDTE    ANDNE*ZERO                                                         CSC054
     C                     Z-ADDHQBDTE    VALD                                                CSC054
     C                     ENDIF                                                              CSC054
      *                                                                   087773
      **   Setup the posting narrative for interbranch entries for        087773
      **   main/entries branch level with NARR,3                          087773
      *                                                                   087773
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP8                                           S01408
     C*                                                                   S01408
     C***********          MOVELNARR,3    PNAR                                         087773 145956
     C***********          MOVE W0BITM    PNAR                                         087773 145956
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP9                                           S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCPG                                           S01408
     C*                                                                   S01408
     C           CMC001    IFNE 'Y'                                       CMC001
     C           CMC001    OREQ 'Y'                                       CMC001
     C           STAT      ANDNE'S'                                       CMC001
     C*                                                                   CEU013
     C* Generate extension record to file MANPOAPD if the Original        CEU013
     C*  currency and amount fields are non blank.                        CEU013
     C                     EXSR GENOX1                                    CEU013
     C*                                                                   CEU013
     C                     WRITEAPOSTPDF                                  S01117
     C*                                                                   BHF794
     C*****PRINT*AN*AUDIT*OF*THE*OPERATION                         BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          EXSR AUDIT                              BHF794 CCB003
     C                     ENDIF                                          CMC001
     C*                                                                   S01117
     C**  WRITE RECORD TO POSTINGS FILE FOR INTERBRANCH ENTRY VIA THE     S01117
     C**  MAIN BRANCH AND BATCH BRANCH                                    S01117
     C*                                                                   S01154
     C                     MOVE BICNHD    CNUMA                           S01117
     C*                                                                   S01117
     C* Set Debit/Credit Indicator AND ACCOUNT CODE                       S01154
     C*                                                                   S01154
     C           BTDCIN    IFEQ 'C'                                       S01154
     C                     MOVE '0'       DRCR                            S01154
     C                     MOVE '1'       *IN77                           BHF794
     C*************        MOVE ADTOM     ACODA                     S01117LN0116
     C                     MOVE ADFRM     ACODA                           LN0116
     C                     ELSE                                           S01154
     C                     MOVE '1'       DRCR                            S01154
     C                     MOVE '0'       *IN77                           BHF794
     C*************        MOVE ADFRM     ACODA                     S01117LN0116
     C                     MOVE ADTOM     ACODA                           LN0116
     C                     END                                            S01154
     C                     EXSR CHGTYP                                    S01117
     C                     MOVE 'P'       RECI                            S01117
     C                     MOVE SPOSDS    SPOS                            S01117
     C                     ADD  1         ACTOT                           S01117
     C************         MOVE ACODA     ACALFA  4                E30172 090139
     C                     EXSR ACTYPE                                    E30172
      *                                                                                       CSC054
     C           CSC054    IFEQ 'Y'                                                           CSC054
     C           *IN66     ANDEQ'0'                                                           CSC054
     C           HQBDTE    ANDNE*ZERO                                                         CSC054
     C                     Z-ADDHQBDTE    VALD                                                CSC054
     C                     ENDIF                                                              CSC054
      *                                                                   087773
      *****Setup*the*posting*narrative*for*interbranch*entries*for                     087773 145956
      *****main/batch*branch*level*with*NARR,4********************                     087773 145956
      *                                                                   087773
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CP10                                           S01408
     C*                                                                   S01408
     C***********          MOVELNARR,4    PNAR                                         087773 145956
     C***********          MOVE W0BITM    PNAR                                         087773 145956
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CP11                                           S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCPG                                           S01408
     C*                                                                   S01408
     C           CMC001    IFNE 'Y'                                       CMC001
     C           CMC001    OREQ 'Y'                                       CMC001
     C           STAT      ANDNE'S'                                       CMC001
     C*                                                                   CEU013
     C* Generate extension record to file MANPOAPD if the Original        CEU013
     C*  currency and amount fields are non blank.                        CEU013
     C                     EXSR GENOX1                                    CEU013
     C*                                                                   CEU013
     C                     WRITEAPOSTPDF                                  S01117
     C*                                                                   BHF794
     C*****PRINT*AN*AUDIT*OF*THE*OPERATION                         BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          EXSR AUDIT                              BHF794 CCB003
     C                     ENDIF                                          CMC001
     C*                                                                   S01154
     C*   ADD POSTING AMOUNT TO HASH TOTAL                                S01117
     C*                                                                   S01117
     C           PSTA      ADD  PSTA      PSTA2                           S01117
     C           PSTA2     DIV  1000      ZZAMT  153                      S01117
     C                     EXSR GLZADD                                    S01117
     C                     MOVE *BLANK    WFRSR                           CAC001
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*****************************************************************   BHF794
     C***********                                                  BHF794 CCB003
     C****AUDIT*SR - TO PRINT A REPORT OF THE RECORDS PROCESSED    BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****CALLED*BY SR/HDPSBR  SR/GENR                             BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C***********AUDIT     BEGSR                                   BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          EXSR OVRF                               BHF794 CCB003
     C***********          WRITED003                               BHF794 CCB003
     C*******UPDATE BRANCH CCY TOTALS                              BHF794 CCB003
     C***********          MOVELBRCA      BRCYKY  6                BHF794 CCB003
     C***********          MOVE CCY       BRCYKY                   BHF794 CCB003
     C***********          Z-ADD1         B       30               BHF794 CCB003
     C***********BRCYKY    LOKUPBRCY,B                   48        BHF794 CCB003
     C************IN48     IFEQ '0'                                BHF794 CCB003
     C***********          Z-ADD1         B                        BHF794 CCB003
     C************BLANK    LOKUPBRCY,B                   48        BHF794 CCB003
     C************IN48     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE BRCYKY    BRCY,B                   BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C************IN48     IFEQ '1'                                BHF794 CCB003
     C************IN77     IFEQ '1'                                BHF794 CCB003
     C***********          ADD  PSTA      BCDR,B                   BHF794 CCB003
     C***********          ELSE                                    BHF794 CCB003
     C***********          ADD  PSTA      BCCR,B                   BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          ENDSR                                   BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****OVRF*SR*-*TO*HANDLE*OVERFLOW                             BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****CALLED*AT*VARIOUS*PLACES                                 BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C***********OVRF      BEGSR                                   BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN10     IFEQ '1'                                BHF794 CCB003
     C***********          WRITEH001                               BHF794 CCB003
     C***********          SETOF                     10            BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          ENDSR                                   BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****TOTREP*SR*-*TO*HANDLE*END*OF*BRANCH*TOTAL*REPORTING      BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****CALLED*AT*VARIOUS*PLACES                                 BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C***********TOTREP    BEGSR                                   BHF794 CCB003
     C***********          Z-ADD1         B                        BHF794 CCB003
     C***********BRCY,B    DOWNE*BLANK                             BHF794 CCB003
     C***********B         ANDLE500                                BHF794 CCB003
     C***********BCDR,B    IFNE 0                                  BHF794 CCB003
     C***********BCCR,B    ORNE 0                                  BHF794 CCB003
     C***********          MOVE BRCY,B    CCY                      BHF794 CCB003
     C***********          MOVELBRCY,B    BRCA                     BHF794 CCB003
     C***********          Z-ADD1         V       30               BHF794 CCB003
     C***********          SETOF                     96            BHF794 CCB003
     C***********V         DOWLEW                                  BHF794 CCB003
     C************IN96     ANDNE'1'                                BHF794 CCB003
     C***********V         OCUR CURLOD                             BHF794 CCB003
     C***********CCY       IFEQ CURC                               BHF794 CCB003
     C***********          MOVE NODEC     A6NBDP                   BHF794 CCB003
     C***********          SETON                     96            BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          ADD  1         V                        BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********A6NBDP    COMP 1                      4041        BHF794 CCB003
     C***********A6NBDP    COMP 2                    43  44        BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN40     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE BCDR,B    TDRAA                    BHF794 CCB003
     C***********          MOVE BCCR,B    TCRAA                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN41     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE BCDR,B    TDRAB                    BHF794 CCB003
     C***********          MOVE BCCR,B    TCRAB                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN44     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE BCDR,B    TDRAC                    BHF794 CCB003
     C***********          MOVE BCCR,B    TCRAC                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN43     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE BCDR,B    TDRAD                    BHF794 CCB003
     C***********          MOVE BCCR,B    TCRAD                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C************IN10     IFEQ '1'                                BHF794 CCB003
     C***********          EXSR OVRF                               BHF794 CCB003
     C***********          WRITET001                               BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          WRITET002                               BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          Z-ADD1         C       30               BHF794 CCB003
     C***********CCY       LOKUPCCCY,C                   48        BHF794 CCB003
     C************IN48     IFEQ '0'                                BHF794 CCB003
     C***********          Z-ADD1         C                        BHF794 CCB003
     C************BLANK    LOKUPCCCY,C                   48        BHF794 CCB003
     C************IN48     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE CCY       CCCY,C                   BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C************IN48     IFEQ '1'                                BHF794 CCB003
     C***********          ADD  BCDR,B    CCDR,C                   BHF794 CCB003
     C***********          ADD  BCCR,B    CCCR,C                   BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          ADD  1         B                        BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          Z-ADD0         BCDR                     BHF794 CCB003
     C***********          Z-ADD0         BCCR                     BHF794 CCB003
     C***********          MOVE *BLANK    BRCY                     BHF794 CCB003
     C***********          ENDSR                                   BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****FINREP*SR*-*TO*HANDLE*END*OF*REPORT*TOTAL*REPORTING      BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****CALLED*BY*LRSR                                           BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C*************************************************************BHF794 CCB003
     C***********FINREP    BEGSR                                   BHF794 CCB003
     C***********          XFOOTCCCR      CCCRT  150               BHF794 CCB003
     C***********CCCRT     IFNE 0                                  BHF794 CCB003
     C***********          CLOSEGL0260P1                           BHF794 CCB003
     C***********          SETON                     10            BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          OPEN GL0260P1                           BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C****ENSURE*REPORT*SPOOL*FILE*RECORDED*BY*RCF                 BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          Z-ADDSFNUM     SFNUM1  60               BHF794 CCB003
     C***********          CALL 'ZSFILE'                           BHF794 CCB003
     C***********          PARM           SEQ                      BHF794 CCB003
     C************         PARM BRBCDA    SENTY   3                BHF794 067360
     C***********          PARM *BLANKS   SENTY   3                067360 CCB003
     C***********          PARM           SFILE                    BHF794 CCB003
     C***********          PARM           SFNUM1                   BHF794 CCB003
     C***********          PARM           ZSERR   1                BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********ZSERR     IFEQ 'Y'                                BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C**ERROR*DURING*ZSFILE*PROCESSING,*RETURN*TO*CALLING*PROGRAMMEBHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********          SETON                     U7U8LR        BHF794 CCB003
     C***********          RETRN                                   BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          Z-ADD0         PAGE1                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          Z-ADD1         C                        BHF794 CCB003
     C***********CCCY,C    DOWNE*BLANK                             BHF794 CCB003
     C***********C         ANDLE100                                BHF794 CCB003
     C***********CCDR,C    IFNE 0                                  BHF794 CCB003
     C***********CCCR,C    ORNE 0                                  BHF794 CCB003
     C***********          MOVE CCCY,C    CCY                      BHF794 CCB003
     C***********          Z-ADD1         V       30               BHF794 CCB003
     C***********          SETOF                     96            BHF794 CCB003
     C***********V         DOWLEW                                  BHF794 CCB003
     C************IN96     ANDNE'1'                                BHF794 CCB003
     C***********V         OCUR CURLOD                             BHF794 CCB003
     C***********CCY       IFEQ CURC                               BHF794 CCB003
     C***********          MOVE NODEC     A6NBDP                   BHF794 CCB003
     C***********          SETON                     96            BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          ADD  1         V                        BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C***********A6NBDP    COMP 1                      4041        BHF794 CCB003
     C***********A6NBDP    COMP 2                    43  44        BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN40     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE CCDR,C    FDRAA                    BHF794 CCB003
     C***********          MOVE CCCR,C    FCRAA                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN41     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE CCDR,C    FDRAB                    BHF794 CCB003
     C***********          MOVE CCCR,C    FCRAB                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN44     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE CCDR,C    FDRAC                    BHF794 CCB003
     C***********          MOVE CCCR,C    FCRAC                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********                                                  BHF794 CCB003
     C************IN43     IFEQ '1'                                BHF794 CCB003
     C***********          MOVE CCDR,C    FDRAD                    BHF794 CCB003
     C***********          MOVE CCCR,C    FCRAD                    BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C************IN10     IFEQ '1'                                BHF794 CCB003
     C***********          EXSR OVRF                               BHF794 CCB003
     C***********          WRITEF001                               BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          WRITEF002                               BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          ADD  1         C                        BHF794 CCB003
     C***********          END                                     BHF794 CCB003
     C***********          ENDSR                                   BHF794 CCB003
     C********************************************************************S01194
     C*                                                                   S01194
     C*   BANKD - TO OBTAIN THE BANK DETAILS                              S01194
     C*                                                                   S01194
     C*   CALLED BY - FIRST CYCLE AND LRSR                                S01194
     C*                                                                   S01194
     C*   CALLS - ACCESS OBJECT 'AOBANKR0'                                S01194
     C*                                                                   S01194
     C********************************************************************S01194
     C*                                                                   S01194
     C           BANKD     BEGSR                                          S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01117
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     42                   S01194
     C           *LOCK     IN   LDA                                       058067
     C                     MOVE 'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 1   S01194
     C                     MOVEL'001'     DBASE            ***************S01194
     C                     OUT  LDA                                       058067
     C                     EXSR ENDRT                                     S01194
     C                     END                                            S01194
     C                     Z-ADDBJRDNB    PSTD                            047771
     C                     ENDSR                                          S01194
     C*****************************************************************   S01117
     C*                                                                   S01194
     C*   MMODD - TO OBTAIN THE MODULE DETAILS                            S01194
     C*                                                                   S01194
     C*   CALLED BY - FIRST CYCLE AND LRSR                                S01194
     C*                                                                   S01194
     C*   CALLS - ACCESS OBJECT 'AOMMODR0'                                S01194
     C*                                                                   S01194
     C********************************************************************S01194
     C*                                                                   S01194
     C           MMODD     BEGSR                                          S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01117
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     42                   S01194
     C           *LOCK     IN   LDA                                       058067
     C                     MOVE 'SDMMODPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 008 S01194
     C                     MOVEL'008'     DBASE            ***************S01194
     C                     OUT  LDA                                       058067
     C                     EXSR ENDRT                                     S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C*****************************************************************   S01117
     C*   GELRD - TO OBTAIN THE GENERAL LEDGER DETAILS                    S01117
     C*                                                                   S01117
     C*   CALLED BY - FIRST CYCLE AND LRSR                                S01117
     C*                                                                   S01117
     C*   CALLS - ACCESS OBJECT 'AOGELRR0'                                S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           GELRD     BEGSR                                          S01117
     C*                                                                   S01117
     C**********           CALL 'AOGELRR0'                                S01117              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     71                   S01117
     C           *LOCK     IN   LDA                                       058067
     C                     MOVE 'SDGELRPD'DBFILE           ***************S01117
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 7   S01117
     C                     MOVEL'007'     DBASE            ***************S01117
     C                     OUT  LDA                                       058067
     C                     EXSR ENDRT                                     S01117
     C                     END                                            S01117
     C                     ENDSR                                          S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C**  CHGTYP - SUBROUTINE TO MOVE THE VARIABLES CNUMA, ACSQA,         S01117
     C**           ACNOA, TRATA, ASOCA AND CHQNA FOR OUTPUT TO            S01117
     C**           PF/MANPOPD                                             S01117
     C**                                                                  S01117
     C**  CALLED BY - WHENEVER A RECORD IS READ FROM LF/GLJENPL0   S01117 S01229
     C**                                                                  S01117
     C**  CALLS - NOTHING                                                 S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C           CHGTYP    BEGSR                                          S01117
     C                     MOVE CNUMA     CNUM                            S01117
     C                     MOVE ACODA     ACOD                            S01117
     C                     MOVE ACSQA     ACSQ                            S01117
     C*********************MOVE ACNOA     ACNO                     S01117 S01229
     C                     MOVE BTRACN    ACNO                     S01117 S01229
     C                     MOVE TRATA     TRAT                            S01117
     C                     MOVE ASOCA     ASOC                            S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP5                                           S01408
     C*                                                                   S01408
     C                     MOVE CHQNA     CHQN                            S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP6                                           S01408
     C*                                                                   S01408
      *                                                                   CAC001
      **  If Analytical Accounting module is switched on and if this      CAC001
      **  is called from SR/HDPSBR or SR/GENR (interbranch postings),     CAC001
      **  profit centre should be the 'Primary Funding Profit Centre'     CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           WFRSR     ANDEQ'Y'                                       CAC001
     C                     MOVE FTPRFP    PRFC                            CAC001
     C                     ELSE                                           CAC001
     C                     MOVE PRFCA     PRFC                            S10736
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     MOVE BOKCA     BOKC                            S10736
     C                     ENDSR                                          S01117
     C*****************************************************************   S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP3                                           S01408
     C*                                                                   S01408
      *****************************************************************   CCB003
     C*                                                                   S01194
     C           ENDRT     BEGSR                                          S01194
      *                                                                   CCB003
     C                     SETON                     U7U8LR               S01194
      *                                                                   CCB003
     C***********@RUN      IFEQ *BLANK                             S01194 CCB003
     C***********          MOVE 'Y'       @RUN    1                S01194 CCB003
      *                                                                   CCB003
     C***********CEU013    IFNE 'Y'                                                   CEU013 BUG4970
     C***********          CLOSEGL0260AU                                              188470 BUG4970
     C***********          OPEN GL0260AU                                              CCB003 BUG4970
     C***********          ENDIF                                                      CEU013 BUG4970
     C***********          EXCPT                                                      CCB003 BUG4970
     C***********CEU013    IFNE 'Y'                                                   CEU013 BUG4970
     C***********          CLOSEGL0260AU                                              CCB003 BUG4970
     C***********          ENDIF                                                      CEU013 BUG4970
      *                                                                   CCB003
     C                     DUMP                                           S01194
     C                     EXCPT                                                            CGL127AM
     C                     RETRN                                          CCB003
      *                                                                   CCB003
     C***********          END                                     S01194 CCB003
      *                                                                   CCB003
     C                     ENDSR                                          S01194
     C*                                                                   S01194
     C*****************************************************************   S01117
     C*                                                                   S01117
     C/COPY WNCPYSRC,GL0260C004
     C*  WHEN LR IS ON-  TOTAL TIME CALCULATIONS                          S01117
      *****************************************************************   CCB003
     C           LRSR      BEGSR                                          S01117
      *                                                                   E25952
     C***ENSURE*TOTALS*SPOOL*FILE*RECORDED*BY*RCF                  E25952 CCB003
     C***********          Z-ADDSFNUMU    SFNUM2  60               E25952 CCB003
     C***********          OUT  LDA                                E25952 058067
     C***********          CALL 'ZSFILE'                           E25952 CCB003
     C***********          PARM           SEQ                      E25952 CCB003
     C***********          PARM *BLANK    SENTY                    E25952 CCB003
     C***********          PARM           SFILEU                   E25952 CCB003
     C***********          PARM           SFNUM2                   E25952 CCB003
     C***********          PARM           ZSERR                    E25952 CCB003
     C************LOCK     IN   LDA                                E25952 058067
     C***********                                                  E25952 CCB003
     C***********ZSERR     IFEQ 'Y'                                E25952 CCB003
     C***********                                                  E25952 CCB003
     C**ERROR*DURING*ZSFILE*PROCESSING,*RETURN*TO*CALLING*PROGRAMMEE25952 CCB003
     C***********                                                  E25952 CCB003
     C***********          SETON                     U7U8LR        E25952 CCB003
     C***********          RETRN                                   E25952 CCB003
     C***********          END                                     E25952 CCB003
     C***********                                                  S01117 CCB003
     C****IF*NOT*INITIALISED*OUTPUT*HEADER*RECORD                  S01117 CCB003
     C************IN50     IFEQ '0'                                S01117 CCB003
     C***********          EXSR BANKD                              S01117 CCB003
     C************IN42     IFEQ '1'                                S01117 CCB003
     C***********          GOTO ELRSR                              S01117 CCB003
     C***********          END                                     S01117 CCB003
     C***********          SETON                     60            S01117 CCB003
     C***********          EXCPT                                   S01117 CCB003
     C***********          SETOF                     60            S01117 CCB003
     C****************WRITE*HEADING*FOR*REPORT                     S01117 CCB003
     C***********          SETON                     51            S01117 CCB003
     C***********          END                                     S01117 CCB003
     C***********                                                  S01117 CCB003
     C***WRITE*CCY*TOTALS*IF*APPLICABLE*TO*GL0260P1                BHF794 CCB003
     C***********          SETON                     10            BHF794 CCB003
     C***********          EXSR TOTREP                             BHF794 CCB003
     C***********          SETON                     10            BHF794 CCB003
     C***********          EXSR FINREP                             BHF794 CCB003
     C***********                                                  S01117 CCB003
0133 C*****TOTAL*TIME*CALCULATIONS.                                S01117 CCB003
0134 C***********ACTOT     ADD  2         RECS    50               S01117 CCB003
0135 C***********ZZTOTD    MULT 10        TOTD    40   47          S01117 CCB003
0136 C**N47******ZZTOTI    COMP 0                      47          S01117 CCB003
     C           ZZTOTD    MULT 10        TOTD    40   47                                    BUG4970
     C  N47      ZZTOTI    COMP 0                      47                                    BUG4970
      *                                                                   CCB003
      ** Access record on GLBATHPA                                        CCB003
     C                     READ GLBATHPA                 80               CCB003
      *                                                                   CCB003
      ** Accumulate number of records and hash total amount               CCB003
      ** processed by this sub-task if trailer not empty                  CCB003
     C           *IN80     IFEQ '0'                                       CCB003
     C                     ADD  NORE1     ACTOT                           CCB003
     C                     Z-ADDHRWN      ZZAMTI                          CCB003
     C                     Z-ADDHRDC      ZZAMTD                          CCB003
     C                     EXSR GLZSUM                                    CCB003
     C                     ENDIF                                          CCB003
      *                                                                   CCB003
     C                     MOVE 'T'       RECI                            CCB003
     C                     Z-ADDACTOT     NORE1                           CCB003
     C                     Z-ADDZZTOTI    HRWN                            CCB003
     C                     Z-ADDZZTOTD    HRDC                            CCB003
      *                                                                   CCB003
      ** If Trailer is empty, write a record; otherwise, update it        CCB003
     C           *IN80     IFEQ '0'                                       CCB003
     C                     UPDATAPOSTZZF                                  CCB003
     C                     ELSE                                           CCB003
     C                     WRITEAPOSTZZF                                  CCB003
     C                     ENDIF                                          CCB003
     C*                                                                   CEU013
     C           PXRFI     CHAINGLAPNAPD             9083                                   MD036415
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           WKUPDT    IFEQ 'Y'                                       CEU013
     C                     Z-ADDWKNARN    GLNARN                          CEU013
     C                     UPDATGLAPNAPF               83                 CEU013
     C                     ELSE                                           CEU013
     C                     MOVE PXRFI     GLNARI                          CEU013
     C                     Z-ADDWKNARN    GLNARN                          CEU013
     C                     WRITEGLAPNAPF               83                 CEU013
     C                     ENDIF                                          CEU013
     C           *IN83     IFEQ *ON                                       CEU013
     C           *LOCK     IN   LDA                                       CEU013
     C                     MOVE 'GLAPNAPD'DBFILE           ***************CEU013
     C                     MOVE PXRFI     DBKEY            * DB ERROR 12 *CEU013
     C                     Z-ADD12        DBASE            ***************CEU013
     C                     OUT  LDA                                       CEU013
     C                     DUMP                                                             MD036415
     C                     EXSR ENDRT                                     CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
      *                                                                                     CGL127AM
      ** Commit if no records left in driving file and number of                            CGL127AM
      ** records processed is not 0                                                         CGL127AM
      *                                                                                     CGL127AM
     C           *IN19     IFEQ '1'                                                         CGL127AM
     C           #COMIT    ANDGT0                                                           CGL127AM
     C                     EXSR UPDPTR                                                      CGL127AM
     C                     COMIT                                                            CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
     C                     EXCPT                                                            CGL127AM
     C                     UNLCKGLBATHPA                                                    CGL127AM
     C                     UNLCKGLAPNAPD                                                    CGL127AM
     C                     CLOSEGLBATHPD                                                    CGL127AM
     C                     CLOSEGL0260AU                                                    CGL127AM
     C                     RETRN                                                            CGL127AM
     C*                                                                   CEU013
     C*                                                                   S01117
     C           ELRSR     ENDSR                                          S01117
     C*                                                                   S01117
0137 C********************************************************************
0138 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0139 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0140 C*
0141 C           GLZADD    BEGSR                           *** GLZADD ****
0142 C*
0143 C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0144 C   91                GOTO ZZAEND                     AMT = 0.BYPASS
0145 C*
0146 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0147 C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0148 C                     Z-ADDZZAMT     ZZWK1   33
0149 C                     MOVE ZZWK1     ZZAMTD  30       DECIMAL FIELD
0150 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0151 C*
0152 C                     EXSR GLZSUM
0153 C           ZZAEND    ENDSR                           ** ZZAEND TAG *
0154 C*
0155 C********************************************************************
0156 C********************************************************************
0157 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0158 C*                        GLZADD, GLZSUB, GLZCMP.
0159 C*          PARAMETERS PASSED -
0160 C*                     I/P ZZAMTI ZZAMTD
0161 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0162 C*
      *****************************************************************   CCB003
0163 C           GLZSUM    BEGSR                           *** GLZSUM ****
0164 C*
0165 C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0166 C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0167 C                     SETOF                     919293
0168 C                     SETOF                     949599
0169 C*
0170 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0171 C           ZZAMTI    COMP 0                      9293
0172 C   93      ZZAMTD    COMP 0                      9293
0173 C   93                GOTO ZZSEND                     ZERO BYPASS
0174 C*
0175 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0176 C           ZZTOTI    COMP 0                      9193
0177 C   93      ZZTOTD    COMP 0                      9193
0178 C*
0179 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0180 C   93                Z-ADDZZAMTI    ZZTOTI
0181 C   93                Z-ADDZZAMTD    ZZTOTD
0182 C   93                GOTO ZZSEND                     ZERO BYPASS
0183 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0184 C   91N92
0185 CORN91 92             GOTO ZZOFPS
0186 C*
0187 C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0188 C           ZZWK2     COMP 999                  93    '93' = CARRY
0189 C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
0190 C*
0191 C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0192 C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0193 C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
0194 C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0195 C*
0196 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0197 C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0198 C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0199 C  N99                Z-ADDZZWK2     ZZTOTD
0200 C  N99                Z-ADDZZWK3     ZZTOTI
0201 C*
0202 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0203 C   99                Z-ADD0         ZZAMT  153
0204 C                     GOTO ZZSEND
0205 C*
0206 C* THE 'SIGNS' ARE DIFFERENT
0207 C           ZZOFPS    TAG                             ** ZZOFPS TAG**
0208 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0209 C*
0210 C   92                Z-SUBZZAMTI    ZZAMTI 150
0211 C   92                Z-SUBZZAMTD    ZZAMTD  30
0212 C*
0213 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0214 C*
0215 C   91                Z-SUBZZTOTI    ZZTOTI
0216 C   91                Z-SUBZZTOTD    ZZTOTD
0217 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0218 C*
0219 C           ZZTOTI    COMP ZZAMTI               93  95
0220 C   95      ZZTOTD    COMP ZZAMTD               93  95
0221 C*
0222 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0223 C   95                Z-ADD0         ZZTOTI
0224 C   95                Z-ADD0         ZZTOTD
0225 C   95                GOTO ZZSEND
0226 C*
0227 C* IF ZZTOT GT. ZZAMT.
0228 C   93      ZZAMTD    COMP ZZTOTD               94
0229 C   93 94   ZZTOTI    SUB  1         ZZTOTI
0230 C   93 94   ZZTOTD    ADD  1000      ZZWK2
0231 C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0232 C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0233 C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0234 C*
0235 C*
0236 C* IF ZZAMT GT. ZZTOT.
0237 C  N93      ZZTOTD    COMP ZZAMTD               94
0238 C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
0239 C  N93 94   ZZAMTD    ADD  1000      ZZWK2
0240 C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0241 C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0242 C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0243 C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0244 C*
0245 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0246 C                     SETOF                     94
0247 C   93 91
0248 CORN93 92             SETON                     94
0249 C   94                Z-SUBZZTOTI    ZZTOTI
0250 C   94                Z-SUBZZTOTD    ZZTOTD
0251 C**
0252 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0253 C   92                Z-SUBZZAMTI    ZZAMTI
0254 C   92                Z-SUBZZAMTD    ZZAMTD
0255 C           ZZSEND    TAG                             ** ZZSEND TAG *
0256 C**
0257 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0258 C                     SETOF                     96
0259 C           ZZTOTD    COMP 0                        91
0260 C   91      ZZTOTI    COMP 0                      96
0261 C   96                MOVE '.000-'   ZZNEGD  5
0262 C                     ENDSR                             ** ENDSR **
0263 C********************************************************************
     C*  ACTYPE SR - TO OBTAIN RETAIL INDICATOR FROM ACCOUNT CODE         E30172
     C*                                                                   E30172
     C*   CALLED BY SUBROUTINES                                           E30172
     C*                                                                   E30172
     C*****************************************************************   E30172
     C*                                                                   E30172
     C           ACTYPE    BEGSR                                          E30172
     C*                                                                   E30172
     C*  Move account code to ACALFA via a numeric field to re-instate    090139
     C*  leading zeros if missing.                                        090139
     C*                                                                   090139
     C**********           MOVE ACODA     @TACN   40                                   090139 CGL029
     C**********           MOVE @TACN     ACALFA  4                                    090139 CGL029
     C                     MOVE ACODA     @TACN  100                                          CGL029
     C                     MOVE @TACN     ACALFA 10                                           CGL029
     C*                                                                   090139
     C                     CALL 'AOACODR0'                                E30172
     C                     PARM *BLANK    @RTCD   7                       E30172
     C                     PARM '*KEY    '@OPTN   7                       E30172
     C                     PARM           ACALFA                          E30172
     C********** SDACOD    PARM SDACOD    DSFDY                                        E30172 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   E30172
     C           @RTCD     IFEQ *BLANKS                                   E30172
     C           ATYP      IFEQ 'R'                                       E30172
     C                     MOVE '1'       RIND                            E30172
     C                     ELSE                                           E30172
     C                     MOVE '0'       RIND                            E30172
     C                     MOVE *ZEROS    ACNO                            E30172
     C                     END                                            E30172
     C                     ELSE                                           E30172
     C           *LOCK     IN   LDA                                       E30172
     C                     MOVE 'SDACODPD'DBFILE           ***************E30172
     C***********          MOVEL@OPTN     DBKEY     * DB ERROR 05 *E30172 CCB003
     C                     MOVELACALFA    DBKEY            * DBERR 05 *   CCB003
     C                     MOVEL'005'     DBASE            ***************E30172
     C                     MOVEL'GL0260'  DBPGM                           E30172
     C                     OUT  LDA                                       E30172
     C***********@DUMP1    IFNE 'Y'                                090139 CCB003
     C***********          MOVE 'Y'       @DUMP1  1                090139 CCB003
     C***********          DUMP                                    090139 CCB003
     C***********          END                                     090139 CCB003
     C***********          SETON                     U7U8LR        E30172 CCB003
     C                     EXSR ENDRT                                     CCB003
     C                     END                                            E30172
     C*                                                                   E30172
     C                     ENDSR                                          E30172
     C*                                                                   E30172
     C********************************************************************E30172
      /EJECT                                                              CEU013
      *****************************************************************   CEU013
      *                                                               *   CEU013
      *  GENOX1 - SR TO RETRIEVE CURRENCY DETAILS                     *   CEU013
      *                                                               *   CEU013
      *****************************************************************   CEU013
      *                                                                   CEU013
     C           GENOX1    BEGSR                                          CEU013
     C*  If the Original currency and Amount fields are non-blank on      CEU013
     C*   the batch item, write the next available Reference ID and       CEU013
     C*   Reference Number to the Account posting file.                   CEU013
     C*   The Original currency and amount fields are written to          CEU013
     C*   Account Posting Extension file using the same next available    CEU013
     C*   Reference ID and Number.                                        CEU013
     C*                                                                   CEU013
     C                     MOVE *BLANKS   XRFI             Exten Ref ID   CEU013
     C                     Z-ADD0         XRFN             Exten Ref No.  CEU013
      *                                                                                       CER030
      ** Retriving the values from the file GLJENXL2 for extended                             CER030
      ** narrative                                                                            CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           KBATCH    CHAINGLJENXL2             97                                       CER030
      *                                                                                       CER030
     C           *IN97     IFEQ '1'                                                           CER030
      *                                                                                       CER030
     C                     MOVE *BLANKS   BAADI1                                              CER030
     C                     MOVE *BLANKS   BAADI2                                              CER030
     C                     MOVE *BLANKS   BAADI3                                              CER030
     C                     MOVE *BLANKS   BAADI4                                              CER030
     C                     MOVE *BLANKS   BAADI5                                              CER030
     C                     MOVE *BLANKS   BAADI6                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           BTOCCY    ANDNE*BLANKS                                   CEU013
     C           BTOAMT    ANDNE*ZEROS                                    CEU013
      *                                                                                       CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C           BAADI1    ANDNE*BLANKS                                                       CER030
     C********** BTOCCY    ANDNE*BLANKS                                           BUG22939 BUG22979A
     C********** BTOAMT    ANDNE*ZEROS                                            BUG22939 BUG22979A
      *                                                                                       CER030
     C*  Set up the fields for Account posting file                       CEU013
     C                     MOVE PXRFI     XRFI             Exten Ref ID   CEU013
     C                     Z-ADDWKNARN    XRFN             Exten Ref No.  CEU013
     C*  Set up the fields for Account posting extension file             CEU013
     C                     MOVE PXRFI     RFID             Reference ID   CEU013
     C                     Z-ADDWKNARN    RFNO             Reference No.  CEU013
     C                     MOVE BTOCCY    OCCY             Orig. currency CEU013
     C                     Z-ADDBTOAMT    OAMT             Orig. amount   CEU013
      *                                                                                       CER030
      ** Wrinting the extended naratives to the file MANPOAPD                                 CER030
      *                                                                                       CER030
     C                     MOVE BAADI1    PSNAR1                                              CER030
     C                     MOVE BAADI2    PSNAR2                                              CER030
     C                     MOVE BAADI3    PSNAR3                                              CER030
     C                     MOVE BAADI4    PSNAR4                                              CER030
     C                     MOVE BAADI5    PSNAR5                                              CER030
     C                     MOVE BAADI6    PSNAR6                                              CER030
      *                                                                                       CER030
     C                     WRITEMANPOAPF                                  CEU013
     C                     ADD  1         WKNARN                          CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C                     ENDSR                                          CEU013
      *****************************************************************   CEU013
      /EJECT                                                              CEU013
      *                                                                                       CER030
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  *PSSR  Subroutine to handle abnormal error conditions        *                       CER030
      *                                                               *                       CER030
      *  Called by:  FIRST                                            *                       CER030
      *                                                               *                       CER030
      *  Calls    :  -                                                *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
     C           *PSSR     BEGSR                                                              CER030
      *                                                                                       CER030
     C           @RUN      IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       @RUN    1                                           CER030
     C                     DUMP                                                               CER030
     C                     END                                                                CER030
      *                                                                                       CER030
     C                     MOVE '1'       *INU7                                               CER030
     C                     MOVE '1'       *INU8                                               CER030
     C                     MOVE '1'       *INLR                                               CER030
      *                                                                                       CER030
     C                     RETRN                                                              CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                     CGL127AM
      *                                                               *                     CGL127AM
      *  UPDPTR - Update GLBATHPD with Start Key for restart          *                     CGL127AM
      *                                                               *                     CGL127AM
      *  Called by:                                                   *                     CGL127AM
      *                                                               *                     CGL127AM
      *****************************************************************                     CGL127AM
      *                                                                                     CGL127AM
     C           UPDPTR    BEGSR                                                            CGL127AM
      *                                                                                     CGL127AM
     C                     MOVE 'A'       IXCKEY                                            CGL127AM
     C*                    MOVE NXTKEY    LSTKEY                                            CGL127AM
     C           IXCKEY    CHAINDRIVEF               38                                     CGL127AM
     C           *IN38     IFEQ '0'                                                         CGL127AM
     C                     MOVE LBTNB     BRBTNB                                            CGL127AM
     C                     MOVE LBCDA     BRBCDA                                            CGL127AM
     C                     MOVE 'C'       PROT                                              CGL127AM
     C                     UPDATDRIVEF                                                      CGL127AM
     C                     ENDIF                                                            CGL127AM
      *                                                                                     CGL127AM
     C                     ENDSR                                                            CGL127AM
      *****************************************************************                     CGL127AM
     C/EJECT                                                                                CGL127AM
      *****************************************************************                     CGL127AM
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0260CCP1                                           S01408
     C*                                                                   S01408
      *****************************************************************   CCB003
      *                                                                   CCB003
     O*MANPOHH*E*       60                                                CCB003
     O***********                         1 'H'                           CCB003
0264 O*ANPOPD*E**      04                                                 S01117
0265 O***********              DATA     128                               S01117
     O***********                         1 'P'                     S01154S01117
0269 O***********              BNUM      99                         S01154S01117
0269 O***********              ITEM     102                         S01154S01117
0269 O***********              BRCB     105                         S01154S01117
0267 O***********                       108 '00'                    S01154S01117
0266 O***********              ZERO5    114P                              S01117
0266 O***********                       126 '  '                    S01154S01117
0266 O***********                       127 ' '                     S01154S01117
0266 O***********                       128 '0'                     S01154S01117
0267 O***********                       130 '0'                           S01117
0268 O***********              ZERO     152P                              S01117
0269 O***********                       154 '00'                          S01117
0270 O***********              ZERO     160P                              S01117
0266 O***********                        22 '      '                S05452S01117
0267 O***********                        96 ' '                     S05452S01117
0268 O***********                       123 '         '             S05452S01117
0269 O*                        OSWCR    176                         S05452S01154
0269 O***********              SWCR     176                         S01154S01117
0270 O***********                       200 '000000'                S05452S01117
0271 O*MANPOZZ*T*       LR                                                CCB003
0272 O***********                         1 'T'                           CCB003
0273 O***********              RECS       6                               CCB003
0274 O***********              ZZTOTI    14P                              CCB003
0275 O***********              ZZTOTD    16P                              CCB003
0276 O*
0277 O*L0260P1D**203   51                                           S01124S01117
      *                                                                   CCB003
      ** Do detail processing for discrepancy only                        CCB003
      *                                                                   CCB003
0277 O*GL0260AUD**203***51                                         S01117 CCB003
0278 O*******OR********OF                                                 CCB003
     O**GL0260AUE  203   46                                                           CCB003 BUG4970
     O***GL0260AUD  203   51                                                        BUG4970 CGL127AM
     OGL0260AUE  203   51      HEADER                                                       CGL127AM
     O       OR        OF                                                                    BUG4970
0279 O***********                        22 'REFERENCE GL0260'            S01117
0280 O***********              TITL      89                               S01194
0279 O                                   24 'REFERENCE GL0260AU'          S01117
     O                         BJURPT    89                               S01194
0281 O                                  104 'DATE'
0282 O***********              RUNA     113                               S01194
     O                         BJMRDT   113                               S01194
0283 O                                  122 'PAGE'
0284 O                         PAGE  Z  127
0285 O********D**1*****51                                                 CCB003
0286 O*******OR********OF                                                 CCB003
     O******  E  1     46                                                             CCB003 BUG4970
     O********D  1     51                                                           BUG4970 CGL127AM
     O        E  1     51      HEADER                                                       CGL127AM
     O       OR        OF                                                                    BUG4970
0287 O                                   70 'BATCH TRANSACTIONS FILE'
0288 O                                   76 'SPLIT'
0289 O********D**2*****51                                                 CCB003
0290 O*******OR********OF                                                 CCB003
     O******* E  1     46                                                             CCB003 BUG4970
     O********D  2     51                                                           BUG4970 CGL127AM
     O        E  2     51      HEADER                                                       CGL127AM
     O       OR        OF                                                                    BUG4970
0291 O                                   70 '-----------------------'
0292 O                                   76 '------'
0293 O*       D  2     01                                                 S01154
0293 O********D**2                                                  S01154S01117
0293 O********D**2     08                                           E18574S01117
0293 O********D**2*****08*64                                        S01117CCB003
     O******* E  2     46                                                             CCB003 BUG4970
     O********D  2     08 64                                                        BUG4970 CGL127AM
     O        E  2     08 64   DETAIL                                                       CGL127AM
0294 O                                   19 'BATCH NO.-'
0295 O                         BNUM      23
0296 O                                   34 'ACTUAL -'
0297 O                         BTCH  3   39
0298 O                                   53 'PROCESSED -'
0299 O                         NII   3   58
0300 O                 46                75 '*** NO OF ITEMS'
0301 O                 46                92 'DISCREPANCY ***'
     O*                                                                   S01117
     O**********                                                    E19908S01117
     O********T* 2 3   LRN50                                        E19908S01117
0279 O**********                         22 'REFERENCE GL0260'      E19908S01117
0280 O**********               TITL      89                         E19908S01117
0281 O**********                        104 'DATE'                  E19908S01117
0282 O**********               RUNA     113                         E19908S01117
0283 O**********                        122 'PAGE'                  E19908S01117
0284 O**********               PAGE  Z  127                         E19908S01117
     O**********                                                    E19908S01117
      *                                                                   CCB003
      ** Do total processing for database error only                      CCB003
      *                                                                   CCB003
0277 O********T**203***LR U7 U8                                    S01117 CCB003
     O*******OR********LRN50                                       S01117 CCB003
     O******* E  203   U7 U8                                                          CCB003 BUG4970
     O********T  203   LR U7 U8                                                     BUG4970 CGL127AM
     O        E  203   LR U7 U8                                                             CGL127AM
     O       OR        LRN50                                                                 BUG4970
0279 O                                   24 'REFERENCE GL0260AU'          S01117
     O                         BJURPT    89                               S01117
0281 O                                  104 'DATE'                        S01117
     O                         BJMRDT   113                               S01117
0283 O                                  122 'PAGE'                        S01117
0284 O                         PAGE  Z  127                               S01117
0285 O********T**1*****LR U7 U8                                    S01117 CCB003
     O*******OR********LRN50                                       S01117 CCB003
     O******  E  1     U7 U8                                                          CCB003 BUG4970
     O********T  1     LR U7 U8                                                     BUG4970 CGL127AM
     O        E  1     LR U7 U8                                                             CGL127AM
     O       OR        LRN50                                                                 BUG4970
0287 O                                   70 'BATCH TRANSACTIONS FILE'     S01117
0288 O                                   76 'SPLIT'                       S01117
0289 O********T**2*****LR U7 U8                                    S01117 CCB003
     O*******OR********LRN50                                       S01117 CCB003
     O******  E  2     U7 U8                                                          CCB003 BUG4970
     O********T  2     LR U7 U8                                                     BUG4970 CGL127AM
     O        E  2     LR U7 U8                                                             CGL127AM
     O       OR        LRN50                                                                 BUG4970
0291 O                                   70 '-----------------------'     S01117
0292 O                                   76 '------'                      S01117
0302 O********T**2     LR                                                 S01117
0302 O********T**2*****LRNU7                                       S01117 CCB003
0303 O*****************                  26 'NUMBER OF BATCHES'           CCB003
0304 O*****************                  36 'PROCESSED'                   CCB003
     O********T  2     LRNU7                                                        BUG4970 CGL127AM
     O        E  2       NU7                                                                CGL127AM
     O                                   26 'NUMBER OF BATCHES'                              BUG4970
     O                                   36 'PROCESSED'                                      BUG4970
0305 O**                       COUNT 1   53
0305 O*****************        COUNT 1   67                               CCB003
     O                         COUNT 1   67                                                  BUG4970
0306 O********T**2     LR                                                 S01117
0306 O********T**2*****LRNU7                                       S01117 CCB003
0307 O*****************                  26 'NUMBER OF ACCOUNT'           CCB003
0308 O*****************                  43 'POSTINGS WRITTEN'            CCB003
0309 O*****************        ACTOT 1   67                               CCB003
     O********T  2     LRNU7                                                        BUG4970 CGL127AM
     O        E  2       NU7                                                                CGL127AM
     O                                   26 'NUMBER OF ACCOUNT'                              BUG4970
     O                                   43 'POSTINGS WRITTEN'                               BUG4970
     O                         ACTOT 1   67                                                  BUG4970
0310 O********T**2     LR                                                 S01117
0310 O********T**2*****LRNU7                                       S01117 CCB003
0311 O*****************                  26 'VALUE OF ACCOUNT '           CCB003
0312 O*****************                  43 'POSTINGS WRITTEN'            CCB003
0313 O*****************        ZZTOTIZ   64                               CCB003
0314 O*****************        TOTD      68                               CCB003
0315 O*****************                  68 ' '                           CCB003
0316 O*****************47                68 '-'                           CCB003
     O********T  2     LRNU7                                                        BUG4970 CGL127AM
     O        E  2       NU7                                                                CGL127AM
     O                                   26 'VALUE OF ACCOUNT '                              BUG4970
     O                                   43 'POSTINGS WRITTEN'                               BUG4970
     O                         ZZTOTIZ   64                                                  BUG4970
     O                         TOTD      68                                                  BUG4970
     O                                   68 ' '                                              BUG4970
     O                 47                68 '-'                                              BUG4970
0677 O********T*3******LR U7 U8                                    S01194 CCB003
     O******* E 3      U7 U8                                                          CCB003 BUG4970
     O********T 3      LR U7 U8                                                     BUG4970 CGL127AM
     O        E 3      LR U7 U8                                                             CGL127AM
0376 O                                   42 '*** REFERENCE'               S01194
0377 O                         DBPGM     53                               S01194
0378 O                                   71 '-DATABASE ERROR AT'          S01194
0379 O                         DBASE     75                               S01194
0682 O********T*1******LR U7 U8                                    S01194 CCB003
     O******* E 1      U7 U8                                                          CCB003 BUG4970
     O********T 1      LR U7 U8                                                     BUG4970 CGL127AM
     O        E 1      LR U7 U8                                                             CGL127AM
0381 O                                   37 'FILE NAME'                   S01194
0382 O                         DBFILE    48                               S01194
0383 O                                   52 'KEY'                         S01194
0384 O                         DBKEY     82                               S01194
0317 O********T*3******LR                                                 CCB003
0318 O**********                         70 '*** END OF REPORT ***'       LN0905
     O********T 3      LR                                                           BUG4970 CGL127AM
     O        E 3      LR                                                                   CGL127AM
     O       OR        51                                                                   CGL127AM
     O                                   70 '*** END OF REPORT ***'                          BUG4970
     O/COPY WNCPYSRC,GL0260OOP1                                           S01408
      *****************************************************************   CCB003
**
NARRATIVE DELETED
** NARR                                                                   087773
INTERBRANCH-ENTRY BRNCH                                                   087773
INTERBRANCH-BATCH BRNCH                                                   087773
INTERBRC-MAIN/ENTRY BRC                                                   087773
INTERBRC-MAIN/BATCH BRC                                                   087773
     X/COPY WNCPYSRC,GL0260X001                                           S01408
ENTRY FOR A/C                                                             090139
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001