     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Capn Req-Initial Screen')                        *
     F*****************************************************************
     F*                                                               *
     F*  Midas General Ledger Module
     F*                                                               *
     F*  GL0290 - Interest/Capitalisation Request                     *
     F*              Initial Screen Set-Up                            *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD040423           Date 16Aug16               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG6131            Date 05Mar05               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 16Apr04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01413             Date 13Apr93               *
     F*                 050778             Date 15Jul93               *
     F*                 LN0513             DATE 12JUL90               *
     F*                 S01117             DATE 15MAR89               *
     F*                 S01194             DATE 14MAR89               *
     F*                 S01197             DATE 14MAR89               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD040423 - Remove check(fe) keyword from display file.       *
      *             (Recompile)                                       *
      *  BUG6131 - Missing fields from statement/capitalisation       *
      *            request                                            *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes (Recompile)                       *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  050778 - LN0513 is causing problems with the output of       *
     F*           detail screen for retail accounts when Retail ICD   *
     F*           says Retail numbers not used - Use a different      *
     F*           indicator.                                          *
     F*  LN0513 - MAKE RETAIL NUMBERS NON DISPLAY WHEN RETAIL ICD     *
     F*           SAYS RETAIL NUMBERS NOT USED                        *
     F*  S01197 - RE -- > GL CONVERSION                               *
     F*  S01194 - NEW STANDING DATA                                   *
     F*  S01117 - MULTIBRANCHING                                      *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*E0290FMCF**F*****258**          WORKSTN                            S01197
     FGL0290FMCF  F     258            WORKSTN                            S01197
     F*ABLE***IF**F****  96 12AI     2 DISK                               S01194
     F*
     F*       FUNCTION OF INDICATORS
     F*       STANDARD INPUT PROGRAM INDICATORS
     F*       41      RETAIL NUMBER USE                                   S01197
     F*       44      MULTIBRANCHING INDICATOR = 'Y'                      S01117
     F*       45      RETAIL MODULE EXISTS                                S01197
     F*       NON-STANDARD INPUT PROGRAM INDICATORS
     F*       77      USED TO CONDITION READ FROM THE WORKSTATION
     F*       78      SET ON IF ERROR DURING READ FROM THE WORKSTATION
     F*       79      SYSTEM SET-UP FLAG ON
     F*       80      BLINK DELETE CHECK FIELD LABEL
     F*       81      OUTPUT INITIAL - SF - SCREEN
     F*       82      OUTPUT INSERT - SI - SCREEN
     F*       83      OUTPUT AMEND - SA - SCREEN
     F*       84      OUTPUT DELETE - SD - SCREEN
     F*       85      OUTPUT ENQUIRE - SE - SCREEN
     F*       86      NON-DISPLAY USEFUL DATA
     F*       87      NON-DISPLAY CHANGE DETAILS
     F*       88      NON-DISPLAY ERROR MESSAGE/CODES
     F*       89      BLINK ACTION CODE LABEL
     F*       U7      DATABASE ERROR
     E                    CPY@    1   1 80                                S01117
     I*    WORKSTATION FILE
     I*
     I*E0290FMNS*******                                                   S01197
     IGL0290FMNS                                                          S01197
     I*
     I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA RECORD 1.               S01194
     I***********                                                         S01194
     I*ABLE***NS***    2 C0   3 C1  12 C1                                 S01194
     I*******AND*     13 C0                                               S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            12  130RCDE                  S01194
     I***********                            14  66 TITL                  S01194
     I***********                            67  67 DATF                  S01194
     I***********                            68  700DFBR                  S01194
     I***********                            74  74 MODI1                 S01194
     I***********                            75  75 MODI2                 S01194
     I***********                            76  76 MODI3                 S01194
     I***********                         P  77  790RUND                  S01194
     I***********                            80  86 RUNA                  S01194
     I***********                            87  870SFLG                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I***********                                                         S01194
     I*****CATCHALL**                                                     S01194
     I********NS*                                                         S01194
     I*
     I*    STANDARD LOCAL DATA AREA FIELDS
     I*
     ILDA        UDS                            256
     I                                        1   8 LPROC
     I***********                           134 138 LFILE                 S01194
     I***********                           139 167 LKEY                  S01194
     I***********                           168 175 LPROG                 S01194
     I***********                           176 1770LDBNO                 S01194
     I**********                            181 1850LRUND                 S01194
     I**********                            186 192 LRUNA                 S01194
     I**********                            193 193 LDATF                 S01194
     I***********                           194 1940LSFLG                 S01194
     I**********                            195 1960LKEYL                 S01194
     I**********                            197 202 LISP                  S01194
     I**********                            203 203 LTWOL                 S01194
     I**********                            204 2040LLDLP                 S01194
     I**********                            205 2090LTNLU                 S01194
     I**********                            210 210 LDELM                 S01194
     I**********                            211 211 LDUD                  S01194
     I**********                            212 212 LRET2                 S01194
     I**********                            213 213 LRUSE                 S01194
     I**********                            134 141 DBFILE                            S01194 BUG6131
     I**********                            142 170 DBKEY                             S01194 BUG6131
     I**********                            171 180 DBPGM                             S01194 BUG6131
     I**********                            181 1830DBASE                             S01194 BUG6131
     I**********                            184 1880LRUND                             S01194 BUG6131
     I**********                            189 195 LRUNA                             S01194 BUG6131
     I**********                            196 196 LDATF                             S01194 BUG6131
     I**********                            197 197 LSFLG                             S01194 BUG6131
     I**********                            198 1990LKEYL                             S01194 BUG6131
     I**********                            200 205 LISP                              S01194 BUG6131
     I**********                            206 206 LTWOL                             S01194 BUG6131
     I**********                            207 2070LLDLP                             S01194 BUG6131
     I**********                            208 2120LTNLU                             S01194 BUG6131
     I**********                            213 213 LDELM                             S01194 BUG6131
     I**********                            214 214 LDUD                              S01194 BUG6131
     I**********                            215 215 LRET2                             S01194 BUG6131
     I**********                            216 216 LRUSE                             S01194 BUG6131
     I                                      140 147 DBFILE                                   BUG6131
     I                                      148 176 DBKEY                                    BUG6131
     I                                      177 186 DBPGM                                    BUG6131
     I                                      187 1890DBASE                                    BUG6131
     I                                      190 1940LRUND                                    BUG6131
     I                                      195 201 LRUNA                                    BUG6131
     I                                      202 202 LDATF                                    BUG6131
     I                                      203 203 LSFLG                                    BUG6131
     I                                      204 2050LKEYL                                    BUG6131
     I                                      206 211 LISP                                     BUG6131
     I                                      212 212 LTWOL                                    BUG6131
     I                                      213 2130LLDLP                                    BUG6131
     I                                      214 2180LTNLU                                    BUG6131
     I                                      219 219 LDELM                                    BUG6131
     I                                      220 220 LDUD                                     BUG6131
     I                                      221 221 LRET2                                    BUG6131
     I                                      222 222 LRUSE                                    BUG6131
     I**                                                                  S01194
     I**   DATA AREA RUNDAT                                               S01194
     I**                                                                  S01194
     IRUNDT       DS                                                      S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
     I**                                                                  S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I**  EXTERNAL DS FOR MIDAS MODULES                                   S01194
     I**                                                                  S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I**  EXTERNAL DS FOR RETAIL DETAILS                                  S01194
     I*
     IPSDS       SDS
     I                                      244 246 WSID
     I*
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     C*  AMEND STANDARD INPUT PROGRAM FIELDS
     C*  WPROG IS THIS PROGRAM NAME
     C*
     C                     MOVEACPY@      BIS@   80                       S01117
     C                     MOVE '0'       *IN
     C           *NAMVAR   DEFN           LDA
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C           *LOCK     IN   LDA
     C                     IN   RUNDT                                     S01194
     C           *ENTRY    PLIST                                          S01197
     C                     PARM           MODULE  1                       S01197
     C**
     C***77******          READ RE0290FM                 78               S01197
     C   77                READ GL0290FM                 78               S01197
     C  N77                SETON                     77
     C                     SETOF                     78
     C***********          MOVE 'RE0290  'WPROG   8                       S01197
     C                     MOVE 'GL0290  'WPROG   8                       S01197
     C*
     C*  SET-UP STANDARD LDA
     C*
     C                     MOVE ' '       BLK29  29
     C                     MOVE '1  '     LPROC
     C                     MOVE MODULE    LPROC                           S01197
     C***********          MOVE BLK29     LKEY                            S01194
     C***********          MOVE WPROG     LPROG                           S01194
     C***********          Z-ADD0         LDBNO                           S01194
     C                     MOVE *BLANK    DBKEY                           S01194
     C                     MOVELWPROG     DBPGM                           S01194
     C                     Z-ADD0         DBASE                           S01194
     C                     MOVELWPROG     LISP
     C                     MOVE 'Y'       LTWOL
     C                     Z-ADD0         LLDLP
     C                     Z-ADD0         LTNLU
     C**                                                                  S01117
     C** SETON INDICATOR WHEN MULTIBRANCHING INDICATOR = 'Y'              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                        *IF001*        S01117
     C                     SETON                     44                   S01117
     C                     ELSE                            *X001*         S01117
     C                     SETOF                     44                   S01117
     C                     END                             *E001*         S01117
     C*
     C***EXECUTE*SYSTEM*SUBR.*ZSYSTM.***                                  S01194
     C***********                                                         S01194
     C***********          EXSR ZSYSTM                                    S01194
     C***********                                                         S01194
     C********** *IN99     IFEQ '1'                        *IF001*        S01194
     C***********          SETON                     U7LR                 S01194
     C***********          MOVE 'TABLE'   LFILE                           S01194
     C***********          MOVELZTABKY    LKEY                            S01194
     C***********          MOVE '90'      LDBNO            ** DB ERROR 90 S01194
     C***********                                                         S01194
     C***********          ELSE                            *X001*         S01194
     C*
     C                     MOVE RUND      LRUND
     C                     MOVE RUNA      LRUNA
     C                     MOVE DATF      LDATF
     C***********          MOVE SFLG      LSFLG                           S01194
     C                     MOVE SSF       LSFLG                           S01194
     C**                                                                  S01197
     C**   ACCESS MIDAS MODULES                                           S01197
     C**                                                                  S01197
     C                     CALL 'AOMMODR0'                                S01197
     C                     PARM '*DBERR ' @RTCD   7                       S01197
     C                     PARM '*FIRST ' @OPTN   7                       S01197
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01197
     C*                                                                   S01197
     C**                                                                  S01197
     C**   SET ON INDICATOR WHEN RETAIL MODULE EXISTS                     S01197
     C**                                                                  S01197
     C           BGRTBN    IFEQ 'Y'                        *IF002*        S01197
     C           MODULE    ANDNE'G'                                       S01117
     C                     SETON                     45                   S01197
     C                     MOVE 'Y'       LRET2                           S01197
     C                     ELSE                            *X002*         S01197
     C                     SETOF                     4541                 S01197
     C                     MOVE 'N'       LRET2                           S01197
     C                     MOVE 'N'       LRUSE                           S01197
     C                     END                             *E002*         S01197
     C**                                                                  S01197
     C**   ACCESS RETAIL DETAILS, WHEN RETAIL MODULE EXISTS               S01197
     C**                                                                  S01197
     C           *IN45     IFEQ '1'                        *IF003*        S01197
     C*                                                                   S01197
     C                     CALL 'AORETLR0'                                S01197
     C                     PARM '*DBERR ' @RTCD   7                       S01197
     C                     PARM '*FIRST ' @OPTN   7                       S01197
     C           SDRETL    PARM SDRETL    DSFDY                           S01197
     C*                                                                   S01197
     C           BMRANR    COMP 'Y'                      41RETAIL NUMBERS S01197
     C   41                MOVE 'Y'       LRUSE                           S01197
     C  N41                MOVE 'N'       LRUSE                           S01197
     C**N41******          SETOF                     45            LN0513 050778
     C*                                                                   S01197
     C                     END                             *E003*         S01197
     C*
     C*    SET INDICATORS AND O/P INITIAL SCREEN.
     C*
     C                     SETON                     8881
     C                     MOVE 'SF'      SID     2
     C                     MOVELWPROG     SPID    6
     C*
     C*
     C                     TIME           MTIME   60
     C   81                EXCPT
     C                     OUT  LDA
     C                     RETRN
     C*
     C********************************************************************
     C***********                                                         S01194
     C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION CONTROL DATA RECORD.   S01194
     C***********                                                         S01194
     C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
     C***********                                                         S01194
     C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL RECORD.                    S01194
     C***********          MOVEL'01      'ZTABKY 12                       S01194
     C***********          MOVE '  10'    ZTABKY                          S01194
     C***********                                                         S01194
     C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C***********                                                         S01194
     C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY OR MMDDYY.                    S01194
     C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C***********                                                         S01194
     C***********          ENDSR                                          S01194
     C***********                                                         S01194
     C***********                                                         S01194
     C********************************************************************
     O*
     O*  WORKSTATION - INITIAL SCREEN OUTPUT
     O*
     O*E0290FME********81**                                               S01197
     OGL0290FME        81                                                 S01197
     O***********                        K8 'RE0290F1'                    S01197
     O                                   K8 'GL0290F1'                    S01197
     O                         RUNA       7
     O                         SID        9
     O                         SPID      15
     O                         MTIME     23 '  .  .  '
     O                         WSID      26
**  CPY@
(c) Finastra International Limited 2001
