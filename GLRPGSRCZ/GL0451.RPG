     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Real Time Posting - Error Recovery')
     F*****************************************************************
     F*                                                               *
     F*  Midas - GENERAL LEDGER MODULE
     F*                                                               *
     F*  GL0451 - REAL TIME POSTING                                   *
     F*                                                               *
     F*  Function: If GL0450 has failed while writing records to      *
     F*  (I/C Bat) LF/APOST and updating LF/ACCNT, this program sets  *
     F*            the status flag on the LF/GLJENHL1 record back to  *
     F*            'A' to allow the user to try again.                *
     F*                                                               *
     F*  Called by: GLC450 - Real Time Postings                       *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSC024             Date 07Feb05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                                    Date                       *
     F*                                                               *
     F*****************************************************************
      *                                                               *                       CSC024
      *  MD046248 - Finastra Rebranding                               *
      *  CSC024 - Open Month End (Recompile)                          *                       CSC024
      *                                                               *                       CSC024
     F*****************************************************************                       CSC024
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
      *
     FGLJENHL0UF  E           K        DISK         KCOMIT
      /EJECT
      *****************************************************************
      *                                                               *
      *  F U N C T I O N   O F   I N D I C A T O R S                  *
      *                                                               *
      *  60  -  Unsuccessful chain GLJENHL0                           *
      *                                                               *
      *****************************************************************
      /SPACE 3
      *****************************************************************
     E                    CPY@    1   1 80
     I/EJECT
      *
     ICPYR@#      DS
      *
      **  Data Structure for Compilation  - Copyright Insertion
      *
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *
     ILDA       E DSLDA
      *
     C/EJECT
      *================================================================
      *  P R O G R A M     S T A R T                                  *
      *================================================================
      *
     C           *ENTRY    PLIST
     C                     PARM           BTCHN   3
      *
     C                     MOVEACPY@      BIS@   80
      *
      **  Prepare LDA
      *
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVEL'GL0451  'DBPGM
     C                     OUT  LDA
      *
      **  Obtain Batch Header Details
      *
     C           BTCHN     CHAINGLJENHL0             60
      *
     C           *IN60     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE 'GLJENHL0'DBFILE           ***************
     C                     MOVE BTCHN     DBKEY            * DB ERROR 01 *
     C                     Z-ADD1         DBASE            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
      *
      **  Update flag on file and commit the update
      *
     C                     ELSE
     C                     MOVE 'A'       BRBTSF
     C                     EXCPTUPJEN
     C                     COMIT
     C                     END
      *
      *================================================================
      *  P R O G R A M     E N D                                      *
      *                                                               *
     C                     SETON                         LR
      *                                                               *
      *================================================================
      /EJECT
      *****************************************************************
      *                                                               *
      *  *PSSR - SR TO HANDLE ABNORMAL ERROR CONDITIONS               *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
      *
     C                     SETON                     U7U8LR
     C                     RETRN
      *
     C                     ENDSR
      *
      *****************************************************************
      *
     O@BRREAG E                UPJEN
     O                         BRBTSF
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
