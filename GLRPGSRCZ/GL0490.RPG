0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Generated entries report')                    *
0001 H***********                                                         S01194
0002 F*****************************************************************
     F*                                                               *
     F*  Midas - General Ledger Module
0004 F*                                                               *
0005 F*  GL0490  -  LIST GENERATED ENTRIES                            *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CGL160             Date 11Nov14               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CGL030             Date 18Dec09               *
      *                 CAP204             Date 17Feb10               *
      *                 CGL047             Date 30Jun06               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG4309            Date 23Sep04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 186369             Date 15Nov00               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CRE004             Date 20Jan97               *
      *                 S01408             Date 16Aug96               *
     F*                 S01408             Date 07Aug96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 S01408             DATE 23JUN95               *
     F*                 CRT001             DATE 28FEB95               *
     F*                 069461             DATE 13APR94               *  *
     F*                 056113             DATE 04FEB94               *
     F*                 S01421             DATE 01JUL93               *
     F*                 S01427             DATE 21JAN93               *
     F*                 S10736             DATE 03SEP92               *
     F*                 S01244             DATE 07MAR90               *
     F*                 S01117             DATE 06/03/89              *
     F*                 S01194             DATE 06/03/89              *
     F*                 S01127             DATE 03/06/88              *
     F*                 S03220             DATE 19/05/88              *
     F*                 S01099             DATE 29/04/86              *
     F*                 S01102             DATE 29/04/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL160 - Cheque Details Upload via Generic Posting Interface *
      *             (Recompile)                                       *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompiled)                                        *
      *  CGL030 - Sundry Postings                                     *
      *  CAP204 - Retail Account Transfer                             *
      *  CGL047 - Midas Generic Posting Interface                     *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG4309- Spelling errors in the header due to overlapping    *
      *           texts.                                              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  186369 - Move the PRFC onto the same detail line.            *
      *           Chg size of DR/CR totals to avoid truncation        *
      *  CGL007 - Account Postings Enquiry (Recompile)                *
     F*  CRE004 - Sweep Accounting:                                   *
     F*           Amended to process new Sweep Accounting Generated   *
     F*           Entries and associated Generated Entry Type('V').   *
     F*  S01408 - Addition of core hook GL0490CCP1                    *
     F*  S01408 - Addition of core hook GL0490FFP2                    *
     F*           Addition of core hook GL0490FFP1                    *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           Add Profit Centre to the report on each posting.    *
     F*  S01408 - Addition of core hook GL0490EEPG                    *
     F*           Addition of core hook GL0490EEP1                    *
     F*           Addition of core hook GL0490OOPG                    *
     F*  CRT001 - Retail Teller System                                *
     F*  069461 - Process new generated entry types for fixed a/c     *
     F*           and statement charge postings.                      *
     F*  056113 - Total time output prints over perforations. To fix  *
     F*           put in, fetch overflow.                             *
     F*  S01421 - AMENDED TO PROCESS ENTRIES FOR NUMBERED ACCOUNTS    *
     F*           AND HOLD MAIL  (S01423 STEP 1.)                     *
     F*  S01427 - R10 CHIPS INCORPORATIONS                            *
     F*  S10736 - MANAGEMENT ACCOUNTING                               *
     F*         - RECOMPILED OVER NEW LF/SGE.                         *
     F*  S01244 - BRANCH TOTALS LINE CORRECTED FOR UNDERLINE          *
     F*  S01244 - GENERATED ENTRIES REPORT RESEQUENCED                *
     F*           FROM: BRANCH           TO: BRANCH                   *
     F*                 GE TYPE              CCY                      *
     F*                 CUST-CCY-ACOD-SEQ    CUST-ACOD-SEQ            *
     F*                                      GE TYPE                  *
     F*           AND CCY TOTALS REPLACE GE TYPE TOTALS (BHF174)      *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01194 - NEW STANDING DATA                                   *
     F*  S01127 - INTERFACE FUTURES AND OPTIONS                       *
     F*  S03220 - FUNDS TRANSFER INTERFACE                            *
     F*  S01099 - INCLUSION BASE CCY I/E XFER                         *
     F*  S01102 - INCLUSION OF AMOUNT ACCRUALS                        *
     F*                                                               *
0011 F*****************************************************************
0012 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*       FILE OF SORTED GENERATED ENTRIES
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0490FFP1                                           S01408
     F*                                                                   S01408
0014 FSGE     IP  E           K        DISK
0015 F*     FILE OF INSTALLATION CONTROL DATA
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0490FFP2                                           S01408
     F*                                                                   S01408
0016 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
     FSDCURRL0IF  E           K        DISK                               S01194
     FGLGPICL1IF  E           K        DISK                               CGL047
0017 F*       PRINTED REPORT
0018 F*L0490P1O** F     132     OF     PRINTER                  S01124    S01117
0018 FGL0490P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0018 FGL0490AUO   F     132     OV     PRINTER      KINFDS SPOOLU         S01117
0019 F* 01            GENERATED ENTRY DETAIL RECORD
0021 F* 02            GENERATED ENTRY TRAILER RECORD
0022 F*    20         DEBIT INDICATOR
0023 F*    21         RETAIL ACCOUNT
0024 F**   22         NEGATIVE HASH TOTAL
0025 F*    22         NEGATIVE PART HASH TOTAL
0026 F*    23         ASOC IS ZEROES
0027 F*    24         TRAT IS ZEROES
0028 F*    25         HASH TOTALS OUT OF BALANCE
0029 F*    26         NEGATIVE OVERALL HASH TOTAL
0030 F*    27         NEGATIVE FILE CONTROL TOTAL
     F*    28         TOTAL TIME PROCESSING                               056113
0031 F*       30      CURRENCY HAS 0 DECIMAL PLACES
0032 F*       31      CURRENCY HAS 1 DECIMAL PLACE
0033 F*       32      CURRENCY HAS 2 DECIMAL PLACES
0034 F*       33      CURRENCY HAS 3 DECIMAL PLACES
0035 F********34**    CHANGE OF CURRENCY                                  S01244
0036 F*       35      NO GENERATED ENTRIES
0037 F*       40      FIRST CYCLE INDICATOR
0038 F*       41      RESULT OF GENERATED ENTRY TABLE LOOKUP
     F*       47      ALL BRANCHES ARE REQUESTED FOR REPORTING            S01117
     F*       48      CONSOLIDATED REPORT REQUESTED                       S01117
     F*       49      MULTIBRANCH INDICATOR = 'Y'                         S01117
0038 F*       58      MULTIBRANCHING OUTPUT INDICATOR                     S01117
0038 F*       60      INCLUDE PROFIT CENTRE                               CAC001
0039 F*************L1 CONTROL BREAK ON CHANGE OF GE TYPE                  S01244
0039 F*            L1 CONTROL BREAK ON CHANGE OF CCY                      S01244
0039 F*            L2 CONTROL BREAK ON CHANGE OF BRANCH                   S01117
     F*       U7   U8 DATABASE ERROR                                      S01194
      *  (c) Finastra International Limited 2001                      *
0041 E*       TABLE OF GENERATED ENTRY TYPES AND NARRATIVES
0042 E********                                                            S01244
0043 E****                TABGE   1  14  1   TABNAR 29                    S01099
0043 E******              TABGE   1  16  1   TABNAR 29              S01099S03220
0043 E****                TABGE   1  17  1   TABNAR 29              S03220S01127
0043 E************        TABGE   1  18  1   TABNAR 29              S01127S01244
0043 E***********         TABGE   1  16  1   TABNAR 15             S01244 S01427
0043 E************        TABGE   1  17  1   TABNAR 15              S01427S01421
0043 E***********         TABGE   1  19  1   TABNAR 15             S01421 069461
0043 E***********         TABGE   1  20  1   TABNAR 15             069461 CRT001
     E*                                                                   S01408
     E/COPY WNCPYSRC,GL0490EEPG                                           S01408
     E*                                                                   S01408
0043 E********************TABGE   1  21  1   TABNAR 15              CRT001CRE004
0043 E********************TABGE   1  22  1   TABNAR 15              CRE004186369
0043 E**********          TABGE   1  22  1   TABNAR 14                                 186369 CRE026
     E**********          TABGE   1  23  1   TABNAR 14                                 CRE026 CAP204
     E                    TABGE   1  24  1   TABNAR 14                                        CAP204
     E/COPY WNCPYSRC,GL0490E001
     E                    CPY@    1   1 80
0044 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0045 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0046 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E*                                                                   S01408
     E/COPY WNCPYSRC,GL0490EEP1                                           S01408
     E*                                                                   S01408
0047 E**
0048 E                    CCYA      150  3
0049 E                    DPA       150  1 0
0050 I*       SORTED GENERATED ENTRY RECORD
0051 I*
0052 IAPOSTPDF    01
     I*             ZZ0017                          ZZ0018
0057 I              ACNO                            ACNO        2121
0059 I              TRAT                            TRAT            24
0062 I              DRCR                            DRCR            20
0063 I              ASOC                            ASOC            23
0064 I***********   BRCD                            BRCD  L2              S01117
0064 I              BRCA                            BRCA  L2              S01117
0066 I************  GETP                            GETP  L1              S01244
0066 I              CCY                             CCY   L1              S01244
0067 I*
0068 I*     TRAILER
0069 I*
0070 IAPOSTZZF    02
0077 I*
0078 I*       INSTALLATION CONTROL DATA LAYOUT
0079 I*
0080 I*ABLE***NS*     13 C0   2 C0   3 C1                                 S01194
0081 I*******AND*     12 C1                                               S01194
0082 I***********                             1   1 RECI                  S01194
0083 I***********                            14  66 TITL                  S01194
0084 I***********                            67  67 DATF                  S01194
0085 I***********                            80  86 DATE                  S01194
0086 I********NS*      1 CD   2 C2   3 C0                                 S01194
0087 I*******AND*     13 C1                                               S01194
0088 I***********                             1   1 RECIX                 S01194
0089 I***********                             2   30RECTX                 S01194
0090 I***********                            10  12 CCYX                  S01194
0091 I***********                            13  130SRECX                 S01194
0092 I***********                            38  380CDPX                  S01194
0093 I**                                                                  S01194
0094 I********NS*                                                         S01194
0095 I***********                             1   1 RECIX                 S01194
0096 I***********                             2   30RECTX                 S01194
0097 I***********                            13  130SRECX                 S01194
     I*                                                                   S01194
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     ILDA        UDS                            256                       S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     IRUNDT       DS                                                      S01194
     I** DATA AREA RUNDAT                                                 S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
     I/COPY WNCPYSRC,GL0490I001
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I**   BANK DETAILS                                                   S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I**   BRANCH DETAILS                                                 S01194
     I*                                                                   CAC001
     ISDMMOD    E DSSDMMODPD                                              CAC001
     I**   MODULE DETAILS                                                 CAC001
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  90 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  90 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I/EJECT                                                              S01194
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C/COPY WNCPYSRC,GL0490C001
     C**                                                                  S01117
0098 C* SKIP TITLE INFO AFTER FIRST CYCLE
0099 C*
0100 C   40                GOTO START
     C                     MOVEACPY@      BIS@   80
0101 C*
0102 C* SET INDICATOR ON FIRST CYCLE & OBTAIN TITLE INFO
0103 C*
0104 C                     SETON                     40
0105 C***********          EXSR ZSYSTM                     * TABLES KEY   S01194
     C*                                                                   S01194
     C                     MOVEL'GL0490'  DBPGM  10                       S01194
     C*                                                                   S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C                     IN   RUNDT                                     S01194
0183 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           DATF      IFEQ 'M'                                       S01194
     C                     SETON                     98                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     98                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C**   CHECK MULTIBRANCHING INDICATOR AND TYPE OF REPORT REQUESTED    S01194
     C                     SETOF                     474849               S01194
     C*                                                                   S01194
     C           MBIN      IFEQ 'Y'                        B1             S01194
     C                     SETON                     49     1             S01194
     C           BRNCH     IFEQ 'ALL'                      B2             S01194
     C                     SETON                     47     2             S01194
     C                     ELSE                            X2             S01194
     C           BRNCH     IFEQ *BLANKS                    B3             S01194
     C                     SETON                     48     3             S01194
     C                     END                             E3             S01194
     C                     END                             E2             S01194
     C                     END                             E1             S01194
     C*                                                                   S01194
     C**  OBTAIN BANK TITLE VIA BANK DETAILS                              S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL'001'     DBASE            ** DBERR 001 **S01194
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO FINISH                                    S01194
     C                     END                                            S01194
     C*                                                                   CAC001
     C**  Obtain Analytical Accounting Indicator via Module Details.      CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*MSG   ' @RTCD   7                       CAC001
     C                     PARM '*FIRST ' @OPTN   7                       CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     MOVEL'SDMMODPD'DBFILE           ***************CAC001
     C                     MOVEL'004'     DBASE            ** DBERR 004 **CAC001
     C                     MOVEL@OPTN     DBOPTN  7        ***************CAC001
     C                     MOVEL@OPTN     DBKEY  29                       CAC001
     C                     EXSR *PSSR                                     CAC001
     C                     SETON                     U7U8LR               CAC001
     C                     GOTO FINISH                                    CAC001
     C                     END                                            CAC001
     C*                                                                   CAC001
     C**  Check if Analytical Accounting Module is switched on.           CAC001
     C**  If switched on, display Profit Centre in the report.            CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     SETON                     60                   CAC001
     C                     ELSE                                           CAC001
     C                     SETOF                     60                   CAC001
     C                     ENDIF                                          CAC001
     C**                                                                  S01194
0106 C*
0107 C*    SETUP CURRENCY DECIMAL PLACE ARRAY
0108 C                     EXSR CCYARR
0109 C**   ZERO HASH TOTAL & PART TOTAL FIELDS
0110 C                     Z-ADD0         HASHIT
0111 C                     Z-ADD0         HASHDT
0112 C                     Z-ADD0         HASHIP
0113 C                     Z-ADD0         HASHDP
0114 C*
0115 C* LOOK UP GENERATED ENTRY TABLE FOR NARRATIVE
0116 C*
0117 C           START     TAG                             * START TAG ***
     C                     MOVE '0'       *IN28                           056113
0118 C  N01                GOTO FINISH
0119 C*
0146 C** CONSOLIDATED REPORT OPENS OUTPUT FILE ONCE AND ONLY ONCE         S01117
     C           BRNCH     IFEQ *BLANKS                                   S01117
     C           *IN58     ANDNE'1'                                       S01117
     C                     SETON                     58                   S01117
     C                     Z-ADD0         BNUM                            S01117
     C                     OPEN GL0490P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
     C           *INL1     IFEQ '1'                                       S01117
     C                     Z-ADD0         PNUM                            S01117
     C                     END                                            S01117
     C           *INL2     IFEQ '1'                                       S01117
     C           BRNCH     ANDNE*BLANKS                                   S01117
     C                     Z-ADD0         BNUM                            S01117
     C                     CLOSEGL0490P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     58                   S01117
     C**                                                                  S01117
     C** To get Branch Name(in BRNM) :                                    S01117
     C** OBTAIN BRANCH DETAILS WHEN IN MULTIBRANCH CASE                   S01117
     C           *IN49     IFEQ '1'                        B1             S01117
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRCA      @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01194
     C                     MOVEL'002'     DBASE            ** DBERR 002 **S01194
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01194
     C                     MOVELBRCA      DBKEY  29                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETOF                     58                   S01194
     C                     GOTO FINISH                                    S01194
     C                     END                                            S01194
     C                     END                             E1             S01117
     C**                                                                  S01117
     C                     OPEN GL0490P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**  FOR SINGLE BRANCH REPORT REQUESTS, END PROGRAM IF NO MORE       S01117
     C**  RECORDS FOR THE REQUESTED BRANCH                                S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     58                   S01117
     C                     GOTO FINISH                                    S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
0120 C*    IF NEW CURRENCY DETERMINE DECIMAL
     C***********CCY       COMP XCCY                     34               S01244
     C***34******          GOTO ENDCCY                                    S01244
     C           *INL1     IFEQ '1'                                       S01244
     C***********          Z-ADD0         CDEBS  130                S01244186369
     C***********          Z-ADD0         CCRED  130                S01244186369
     C                     Z-ADD0         CDEBS  160                      186369
     C                     Z-ADD0         CCRED  160                      186369
0123 C                     MOVE CCY       XCCY    3
0124 C                     EXSR CCYDEP
0125 C           XDECP     COMP 1                      3031
0126 C           XDECP     COMP 2                    33  32
0127 C***********ENDCCY    TAG                             ** ENDCCY TAG *S01244
0127 C                     END                                           *S01244
0127 C**                                                                 *S01244
0128 C***L1******GETP      LOKUPTABGE     TABNAR         41               S01244
0128 C           GETP      LOKUPTABGE     TABNAR         41               S01244
     C*                                                                   S01408
      ** Check if generic posting interface                               CGL047
     C           *IN41     IFEQ *OFF                                      CGL047
     C           GETP      CHAINGLGPICL1             90                   CGL047
     C           *IN90     IFEQ *OFF                                      CGL047
     C           GETP      OREQ 'Z'                                       CGL047
     C           'EXTERNAL'CAT  ' POST'   TABNAR    P                     CGL047
     C                     MOVEL*ON       *IN41                           CGL047
     C                     ENDIF                                          CGL047
     C                     ENDIF                                          CGL047
     C           GETP      IFEQ '2'                                                           CGL030
     C                     MOVEL'SUNDRY'  TABNAR    P                                         CGL030
     C                     MOVEL*ON       *IN41                                               CGL030
     C                     END                                                                CGL030
     C/COPY WNCPYSRC,GL0490CCP1                                           S01408
     C*                                                                   S01408
0129 C                     Z-ADDVALD      ZDAYNO  50
0130 C                     EXSR ZDATE2
0131 C**   PRINT BLANKS INSTEAD OF ZERO
0132 C   23                MOVE '      '  ASOC
     C                     MOVE TRAT      TRATO   5
0133 C   24                MOVE '     '   TRATO
     C/COPY WNCPYSRC,GL0490C002
0134 C*
0135 C* ADD TO NUMBER OF POSTINGS & CALL S/R FOR HASH TOTALLING
0136 C*
0137 C           PNUM      ADD  1         PNUM    40
     C           DRCR      IFEQ 0                                         S01244
     C                     ADD  PSTA      CDEBS                           S01244
     C                     ELSE                                           S01244
     C                     ADD  PSTA      CCRED                           S01244
     C                     END                                            S01244
0138 C                     Z-ADD0         ZZAMT
0139 C                     MOVE PSTA      ZZAMT
0140 C                     EXSR GLZADD
0141 C           FINISH    TAG                             ** FINISH TAG *
0142 C/SPACE 3
     CL1                   MOVE '1'       *IN28                           056113
0143 CL1                   Z-ADDZZTOTI    HASHIP 150
0144 CL1                   Z-ADDZZTOTD    HASHDP  30
0145 CL1         ZZTOTD    MULT 10        DEC     40
0146 CL1         BNUM      ADD  PNUM      BNUM    50
0147 CL1         TNUM      ADD  PNUM      TNUM    50
0148 CL1                   Z-ADDHASHIT    ZZAMTI
0149 CL1                   Z-ADDHASHDT    ZZAMTD
0150 CL1                   EXSR GLZSUM
0151 CL1                   Z-ADDZZTOTI    HASHIT 150
0152 CL1                   Z-ADDZZTOTD    HASHDT  30
0153 CL1                   Z-ADD0         ZZTOTD
0154 CL1         DEC       COMP 0                      22
0155 CL1N22      HASHIP    COMP 0                      22
0156 CL1                   Z-ADD0         ZZTOTI
0157 CL1                   Z-ADD0         ZZTOTD
0158 C/SPACE 3
      *                                                                   S01117
      ** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUMU    SFNUM2  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           SFNUM2                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR         *INU7     IFNE '1'                        B1             S01117
     CLR         *INU8     ANDNE'1'                                       S01117
0159 CLRN30N31N32
0160 CANN33                SETON                     35    NO ENTRIES
0161 CLR         NORE1     COMP TNUM                 2525
0162 CLRN25      HRWN      COMP HASHIT               2525
0163 CLRN25      HRDC      COMP HASHDT               2525
     C** THE HASH TOTAL SHOULD NOT BE REPORTED SINCE THE SGE FILE         S01117
     C** SCREEN OUT SOME OF THE ENTIRES IN ENDPOPD                        S01117
     C*                                                                   S01117
     CLR         *IN49     IFEQ '1'                        B2             S01117
     CLR         *IN47     ANDEQ'0'                                       S01117
     CLR         *IN48     ANDEQ'0'                                       S01117
     C*                                                                   S01117
     C** OBTAIN BRANCH NAME WHEN REQUEST FOR A BRANCH HAS NO DETAIL       S01117
     C** TO REPORT                                                        S01117
     CLR         *IN35     IFEQ '1'                        B3             S01117
     C*LR*******            CALL 'AOBRCHR0'                  3                         S01117 CGL029
     CLR                   CALL 'AOBRCHR1'                                                    CGL029
     CLR                   PARM '*MSG   ' @RTCD   7                       S01117
     CLR                   PARM '*KEY   ' @OPTN   7                       S01117
     CLR                   PARM BRNCH     @DSNB   3                       S01117
     C*LR*******  SDBRCH    PARM SDBRCH    DSFDY                                       S01194 CGL029
     CLR         SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     CLR         @RTCD     IFNE *BLANKS                    B4             S01117
     CLR                   MOVEL'SDBRCHPD'DBFILE           ***************S01117
     CLR                   MOVEL'003'     DBASE            ** DBERR 003 **S01117
     CLR                   MOVEL@OPTN     DBOPTN  7        ***************S01117
     CLR                   MOVELBRNCH     DBKEY  29                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   SETON                     U7U8   4             S01117
     CLR                   SETOF                     35     4             S01117
     CLR                   END                             E4             S01117
     CLR                   END                             E3             S01117
     CLR                   END                             E2             S01117
     C*                                                                   S01117
     C** OUTPUT GL0490P1 HERE IF A SINGLE BRANCH REQUEST HAS NO DETAIL    S01117
     C** TO REPORT                                                        S01117
     CLR         *IN35     IFEQ '1'                                       S01117
     CLR         *IN48     ANDEQ'0'                                       S01117
     CLR         *IN47     ANDEQ'0'                                       S01117
     CLR                   OPEN GL0490P1                                  S01117
     CLR                   Z-ADD0         PAGE                            S01117
     CLR                   Z-ADDSFNUM     SFNUM1  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM BRNCH     SENTY   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           SFNUM1                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
0164 CLR         HASHDT    COMP 0                      26
0165 CLRN26      HASHIT    COMP 0                      26
0166 CLR         HRDC      COMP 0                      27
0167 CLRN27      HRWN      COMP 0                      27
     CLR                   END                             E1             S01117
0168 C/EJECT
0169 C********************************************************************
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C**                                                                  S01194
0169 C********************************************************************
0170 C**
0171 C*****ZSYSTM*SR.*TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0172 C**
0173 C*R*********ZSYSTM    BEGSR                           *** ZSYSTM  ***S01194
0174 C**
0175 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.                    S01194
0176 C*R*********          MOVEL'01      'ZTABKY 12                       S01194
0177 C*R*********          MOVE '  10'    ZTABKY                          S01194
0178 C**
0179 C*R*********ZTABKY    SETLLTABLE                      ON NOT THERE   S01194
0180 C***********          READ TABLE                    99               S01194
0181 C*RN99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0182 C**
0183 C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0184 C*R*********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0185 C**
0186 C*R*********          ENDSR                                          S01194
0187 C**
0188 C**
0189 C********************************************************************
0190 C********************************************************************
0191 C**
0192 C**   SR. TO SET UP ANARRAY OF CURRENCIES AND AN ARRAY OF
0193 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0194 C**
0195 C           CCYARR    BEGSR                           *** CCYARR  ***
0196 C**
0197 C**   SET ARRAY INDEX TO ZERO.
0198 C                     Z-ADD0         X       30
0199 C**
0200 C**   SET UP KEY FOR CURRENCY TABLE.
0201 C***********          MOVEL'20      'XCYKEY 12                       S01194
0202 C***********          MOVE '    '    XCYKEY                          S01194
     C                     MOVE *BLANKS   W@CKEY  3                       S01194
0203 C**
0204 C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
0205 C***********XCYKEY    SETLLTABLE                                     S01194
0205 C           W@CKEY    SETLLSDCURRL0                                  S01194
0206 C**
0207 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0208 C           XLOOP     TAG                             ** XLOOP TAG **
0209 C***********          READ TABLE                    99               S01194
0209 C                     READ SDCURRL0                 99               S01194
0210 C**N99******RECTX     COMP 20                   9999                 S01194
0211 C**
0212 C**   END IF ALL CURRENCY RECORDS PROCESSED
0213 C   99                GOTO XEND
0214 C**
0215 C**   IGNOR DELETED RECORDS AND NON-SUB-RECORD ONE.
0216 C***********RECIX     COMP 'D'                  9797                 S01194
0217 C***97******          GOTO XLOOP                                     S01194
0218 C***********SRECX     COMP 1                    9797                 S01194
0219 C***97******          GOTO XLOOP                                     S01194
0220 C**
0221 C**   INCREMENT ARRAY INDEX.
0222 C           X         ADD  1         X
0223 C**
0224 C**   MOVE DATA INTO ARRAYS.
0225 C***********          MOVE CCYX      CCYA,X                          S01194
0225 C                     MOVE A6CYCD    CCYA,X                          S01194
0226 C***********          MOVE CDPX      DPA,X                           S01194
0226 C                     MOVE A6NBDP    DPA,X                           S01194
0227 C**
0228 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0229 C           X         COMP 150                      96
0230 C**
0231 C**   GO TO READ NEXT RECORD.
0232 C  N96                GOTO XLOOP
0233 C**
0234 C           XEND      TAG                             ** XEND TAG  **
0235 C                     ENDSR
0236 C**
0237 C********************************************************************
0238 C**
0239 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0240 C**
0241 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0242 C**
0243 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0244 C                     Z-ADD1         X            99
0245 C**
0246 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0247 C                     Z-ADD0         XDECP   10
0248 C                     MOVE XCCY      XCCY    3
0249 C**
0250 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0251 C**   99 SETON FOR INVALID CURRENCY.
0252 C           XCCY      LOKUPCCYA,X                   95
0253 C   95                MOVE DPA,X     XDECP
0254 C  N95                SETON                     99
0255 C**
0256 C                     ENDSR
0257 C**
0258 C********************************************************************
0259 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0260 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0261 C*
0262 CSR         GLZADD    BEGSR                           *** GLZADD ****
0263 C*
0264 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0265 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0266 C*
0267 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0268 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0269 CSR                   Z-ADDZZAMT     ZZWK1   33
0270 CSR                   MOVE ZZWK1     ZZAMTD  30       DECIMAL FIELD
0271 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0272 C*
0273 CSR                   EXSR GLZSUM
0274 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0275 C*
0276 C********************************************************************
0277 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0278 C*                        GLZADD, GLZSUB, GLZCMP.
0279 C*          PARAMETERS PASSED -
0280 C*                     I/P ZZAMTI ZZAMTD
0281 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0282 C*
0283 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0284 C*
0285 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0286 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0287 CSR                   SETOF                     919293
0288 CSR                   SETOF                     949599
0289 C*
0290 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0291 CSR         ZZAMTI    COMP 0                      9293
0292 CSR 93      ZZAMTD    COMP 0                      9293
0293 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0294 C*
0295 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0296 CSR         ZZTOTI    COMP 0                      9193
0297 CSR 93      ZZTOTD    COMP 0                      9193
0298 C*
0299 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0300 CSR 93                Z-ADDZZAMTI    ZZTOTI
0301 CSR 93                Z-ADDZZAMTD    ZZTOTD
0302 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0303 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0304 CSR 91N92
0305 CORN91 92             GOTO ZZOFPS
0306 C*
0307 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0308 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0309 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0310 C*
0311 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0312 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0313 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0314 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0315 C*
0316 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0317 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0318 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0319 CSRN99                Z-ADDZZWK2     ZZTOTD
0320 CSRN99                Z-ADDZZWK3     ZZTOTI
0321 C*
0322 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0323 CSR 99                Z-ADD0         ZZAMT  153
0324 CSR                   GOTO ZZSEND
0325 C*
0326 C* THE 'SIGNS' ARE DIFFERENT
0327 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0328 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0329 C*
0330 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0331 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0332 C*
0333 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0334 C*
0335 CSR 91                Z-SUBZZTOTI    ZZTOTI
0336 CSR 91                Z-SUBZZTOTD    ZZTOTD
0337 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0338 C*
0339 CSR         ZZTOTI    COMP ZZAMTI               93  95
0340 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0341 C*
0342 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0343 CSR 95                Z-ADD0         ZZTOTI
0344 CSR 95                Z-ADD0         ZZTOTD
0345 CSR 95                GOTO ZZSEND
0346 C*
0347 C* IF ZZTOT GT. ZZAMT.
0348 CSR 93      ZZAMTD    COMP ZZTOTD               94
0349 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0350 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0351 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0352 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0353 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0354 C*
0355 C*
0356 C* IF ZZAMT GT. ZZTOT.
0357 CSRN93      ZZTOTD    COMP ZZAMTD               94
0358 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0359 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0360 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0361 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0362 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0363 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0364 C*
0365 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0366 CSR                   SETOF                     94
0367 CSR 93 91
0368 CORN93 92             SETON                     94
0369 CSR 94                Z-SUBZZTOTI    ZZTOTI
0370 CSR 94                Z-SUBZZTOTD    ZZTOTD
0371 C**
0372 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0373 CSR 92                Z-SUBZZAMTI    ZZAMTI
0374 CSR 92                Z-SUBZZAMTD    ZZAMTD
0375 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0376 C**
0377 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0378 CSR                   SETOF                     96
0379 CSR         ZZTOTD    COMP 0                        91
0380 CSR 91      ZZTOTI    COMP 0                      96
0381 CSR 96                MOVE '.000-'   ZZNEGD  5
0382 CSR                   ENDSR                             ** ENDSR **
0383 C********************************************************************
0384 C**
0385 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0386 C**
0387 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0388 C**
0389 C**   CLEAR DATE FIELDS.
0390 C                     Z-ADD0         ZDATE   60
0391 C                     MOVEL'       ' ZADATE  7
0392 C**
0393 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0394 C                     Z-ADDZDAYNO    ZDAYNO  50
0395 C**
0396 C**   DETERMINE YEAR NUMBER.
0397 C**
0398 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0399 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0400 C   99                GOTO ZDEND2
0401 C**
0402 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0403 C           ZDAYN1    DIV  1461      ZLYR    20
0404 C                     MVR            ZDAYN1           SAVE REMAINING
0405 C**                                                   DAYS
0406 C**   CALCULATE NUMBER OF REMAINING YEARS.
0407 C                     Z-ADD1         ZWRK2   20
0408 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0409 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0410 C  N90      ZWRK2     ADD  1         ZWRK2
0411 C  N90                GOTO ZDTAG1
0412 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0413 C**
0414 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0415 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0416 C**
0417 C**   CALCULATE ACTUAL YEAR NUMBER.
0418 C           ZLYR      MULT 4         ZWRK3   30
0419 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0420 C                     Z-ADDZWRK3     ZYEAR   20
0421 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0422 C**
0423 C**   DETERMINE MONTH NUMBER.
0424 C**
0425 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0426 C                     SETOF                     9293
0427 C   91      ZDAYN1    COMP 59                     9293
0428 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0429 C**
0430 C**   CALCULATE MONTH NUMBER.
0431 C                     Z-ADD2         ZWRK2
0432 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0433 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0434 C  N94      ZWRK2     ADD  1         ZWRK2
0435 C  N94                GOTO ZDTAG2
0436 C           ZWRK2     SUB  1         ZWRK2
0437 C**
0438 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0439 C**
0440 C**   DETERMINE DAY OF MONTH.
0441 C**
0442 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0443 C           ZDAYN1    ADD  1         ZDAYN1
0444 C**
0445 C**   CALCULATE DAY OF MONTH.
0446 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0447 C**
0448 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0449 C   93      ZDAY      ADD  1         ZDAY
0450 C**
0451 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0452 C  N98                MOVELZDAY      ZWRK4   40
0453 C   98                MOVE ZDAY      ZWRK4
0454 C  N98                MOVE ZMTH      ZWRK4
0455 C   98                MOVELZMTH      ZWRK4
0456 C                     MOVELZWRK4     ZDATE
0457 C                     MOVE ZYEAR     ZDATE
0458 C**
0459 C**   FORMAT ALPHA DATE, DDMMMYY.
0460 C           ZDAY      COMP 10                     95
0461 C                     MOVELZDAY      ZWRK5   5
0462 C   95                MOVEL' '       ZWRK5
0463 C                     MOVE ZMNM,ZMTH ZWRK5
0464 C                     MOVELZWRK5     ZADATE
0465 C                     MOVE ZYEAR     ZADATE
0466 C**
0467 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0468 C**
0469 C**
0470 C********************************************************************
0471 O*L0490P1H**203   OFNL1                                    S01124    S01117
0471 OGL0490P1H  203   OFNL1 58                                           S01117
0472 O*******OR**      L1                                                 S01117
0472 O       OR        L1 58                                              S01117
     O       OR        OF 28 58                                           056113
0473 O***********                        22 'REFERENCE GL0490'            S01117
0473 O                                   24 'REFERENCE GL0490P1'          S01117
0474 O***********              TITL      89                               S01194
0474 O                         BJURPT    89                               S01194
0475 O                                  104 'DATE'
0476 O***********              DATE     113                               S01194
0476 O                         RUNA     113                               S01194
0477 O                                  122 'PAGE'
0478 O                         PAGE     127
0479 O********H**1     OFNL1                                              S01117
0479 O        H  1     OFNL1 58                                           S01117
0480 O*******OR**      L1                                                 S01117
0480 O       OR        L1 58                                              S01117
     O       OR        OF 28 58                                           056113
0481 O***********                        72 'GENERATED ENTRIES'           S01117
0482 O***********           N35          74 '-'                           S01117
0483 O***********      41      TABNAR   104                               S01117
0484 O***********                       112 'BRANCH'                      S01117
0485 O***********              BRCD     116                               S01117
0481 O************                       42 'GENERATED ENTRIES'     S01117S01244
0482 O************          N35          44 '-'                     S01117S01244
     O                         CCY       68                               S01244
0481 O                                   62 'GENERATED ENTRIES'           S01244
0482 O                      N35          64 '-'                           S01244
0483 O***********      41      TABNAR    74                         S01117S01244
*    O                N48 49             83 'BRANCH'                      S01117
*    O                N48 49   BRCA      87                               S01117
     O                N48 49             88 '-'                           S01117
*    O                N48 49   A8BRNM   118                               S01117
     O                 48                89 'CONSOLIDATED'                S01117
     O*                                                                   S01117
0486 O********H**2     OFNL1                                              S01117
0486 O        H  2     OFNL1 58                                           S01117
0487 O*******OR**      L1                                                 S01117
0487 O       OR        L1 58                                              S01117
     O       OR        OF 28 58                                           056113
0488 O***********                        72 '-----------------'           S01117
0488 O************                       42 '-----------------'     S01117S01244
0488 O                                   68 '-----------------------'     S01244
0489 O********H**1     OFNL1                                              S01117
0489 O        H  1     OFNL1 58                                           S01117
0490 O*******OR**      L1                                                 S01117
0490 O       OR        L1 58                                              S01117
     O       OR        OF 28 58                                           056113
     O/COPY WNCPYSRC,GL0490O001
0491 O***********                        24 'CUST.   CCY   A/C   SEQ'     S01117
     O************     49                 4 'BRN'                   S01117S01244
0491 O***********                        24 'CUST.  CCY A/C  SEQ'   S01117S01244
0491 O***********                        16 'CUST. A/C  SEQ'        S01244186369
     O***********                        31 'GEN.ENTRY TYPE'        S01244186369
0492 O************                       45 'RETAIL   NARRATIVE'          S01244
0492 O***********                        53 'RETAIL    NARRATIVE'   S01244186369
0493 O************                       91 'TRANS DEPT ASSOC   VALUE'    S01244
0493 O***********                        95 'TRANS  ASSOC   VALUE'  S01244186369
0494 O************                      108 'DEBITS'                      S01244
0494 O***********                       113 'DEBITS'                S01244186369
     O**********                         15 'CUST. A/C  SQ'                           186369 BUG4309
     O**********                         25 'GEN.ENTRY'                               186369 BUG4309
     O**********       60                34 'PRFC'                                    186369 BUG4309
0492 O**********                         55 'RETAIL    NARRATIVE'                     186369 BUG4309
0493 O**********                         96 'TRANS ASSOC   VALUE'                     186369 BUG4309
0494 O**********                        115 'DEBITS'                                  186369 BUG4309
     O                                   21 'CUST.      A/C    SQ'                            CGL029
     O                                   34 'GEN.ENTRY'                                       CGL029
     O                 60                41 'PRFC'                                            CGL029
     O                                   62 'RETAIL   NARRATIVE'                              CGL029
     O                                  103 'TRANS ASSOC   VALUE'                             CGL029
     O                                  114 'DEBITS'                                          CGL029
0495 O************                      126 'CREDITS'                     S01244
0495 O**********                        131 'CREDITS'                                  S01244 CGL029
     O                                  132 'CREDITS'                                         CGL029
0496 O********H**2     OFNL1                                              S01117
0496 O        H  2     OFNL1 58                                           S01117
0497 O*******OR**      L1                                                 S01117
0497 O       OR        L1 58                                              S01117
     O       OR        OF 28 58                                           056113
0498 O***********                        19 'NUMBER        CODE'          S01117
0498 O***********                        20 'NUMBER     CODE'       S01117S01244
0498 O***********                        12 'NUMBER CODE'           S01244186369
0499 O************                       34 'A/C NO.'                     S01244
0499 O***********                        41 'A/C NO.'               S01244186369
0500 O************                       90 'TYPE  CODE CUST.   DATE'     S01244
0500 O***********                        94 ' TYPE   CUST.   DATE'  S01244186369
0498 O**********                         20 'NUMBER CODE    TYPE'                      186369 CGL029
0499 O**********                         43 'A/C NO.'                                  186369 CGL029
0500 O**********                         95 ' TYPE  CUST.   DATE'                      186369 CGL029
     O                                   15 'NUMBER    CODE'                                  CGL029
     O                                   32 'TYPE'                                            CGL029
     O                                   50 'A/C NO.'                                         CGL029
     O                                  103 'TYPE  CUST.   DATE'                              CGL029
     O/COPY WNCPYSRC,GL0490O002
0501 O********D**1     01                                                 S01117
0501 O********D**1*****01*58*************                          S01117 056113
     O        DF 1     01 58                                              056113
     O/COPY WNCPYSRC,GL0490O003
0502 O***********              CNUM       7                               S01117
0503 O***********              CCY       12                               S01117
0504 O***********              ACOD      19                               S01117
0505 O************             ACSQ      24                               S01244
0505 O**********               ACSQ      15                                            S01244 CGL029
     O                         ACSQ      21                                                   CGL029
0483 O***********      41      TABNAR    32                         S01244186369
0506 O************           21ACNO      35                               S01244
0506 O***********            21ACNO      43                         S01244186369
     O************     49      BRCA       4                               S01117
0502 O************             CNUM      11                         S01117S01244
0502 O                         CNUM       7                               S01244
0503 O************             CCY       15                         S01117S01244
0504 O************             ACOD      20                         S01117S01244
0504 O**********               ACOD      12                                            S01244 CGL029
0483 O**********       41      TABNAR    30                                            186369 CGL029
0506 O**********       60      PRFC      34                                            186369 CGL029
0506 O**********             21ACNO      45                                            186369 CGL029
     O                         ACOD      18                                                   CGL029
     O                 41      TABNAR    36                                                   CGL029
     O                 60      PRFC      41                                                   CGL029
     O                       21ACNO      52                                                   CGL029
0507 O************             PNAR      66                               S01244
0507 O***********              PNAR      74                         S01244186369
0508 O************             TRATO     72                               S01244
0508 O***********              TRATO     80                         S01244186369
0509 O************             DPMT      76                               S01244
0510 O************          N23ASOC      83                               S01244
0510 O************          N23ASOC      88                         S01244186369
0511 O************             ZADATE    92                               S01244
0511 O***********              ZADATE    96                         S01244186369
0512 O************     20    30PSTA  1  110                               S01244
0513 O************        20 31PSTA     110 '   ,   ,   , 0 . '           S01244
0514 O************        20 32PSTA     110 '  ,   ,   , 0 .  '           S01244
0515 O************        20 33PSTA     110 ' ,   ,   , 0 .   '           S01244
0512 O***********      20    30PSTA  1  113                         S01244186369
0513 O***********         20 31PSTA     113 '   ,   ,   , 0 . '     S01244186369
0514 O***********         20 32PSTA     113 '  ,   ,   , 0 .  '     S01244186369
0515 O***********         20 33PSTA     113 ' ,   ,   , 0 .   '     S01244186369
0507 O**********               PNAR      76                                            186369 CGL029
0508 O**********               TRATO     82                                            186369 CGL029
0510 O**********            N23ASOC      89                                            186369 CGL029
0511 O**********               ZADATE    97                                            186369 CGL029
0512 O**********       20    30PSTA  1  115                                            186369 CGL029
0513 O**********          20 31PSTA     115 '   ,   ,   , 0 . '                        186369 CGL029
0514 O**********          20 32PSTA     115 '  ,   ,   , 0 .  '                        186369 CGL029
0515 O**********          20 33PSTA     115 ' ,   ,   , 0 .   '                        186369 CGL029
     O                         PNAR      83                                                   CGL029
     O                         TRATO     89                                                   CGL029
     O                      N23ASOC      96                                                   CGL029
     O                         ZADATE   104                                                   CGL029
     O        DF 1     01 58                                                                  CGL029
     O                 20    30PSTA  1  114                                                   CGL029
     O                    20 31PSTA     114 '   ,   ,   , 0 . '                               CGL029
     O                    20 32PSTA     114 '  ,   ,   , 0 .  '                               CGL029
     O                    20 33PSTA     114 ' ,   ,   , 0 .   '                               CGL029
0516 O************    N20    30PSTA  1  128                               S01244
0517 O************       N20 31PSTA     128 '   ,   ,   , 0 . '           S01244
0518 O************       N20 32PSTA     128 '  ,   ,   , 0 .  '           S01244
0519 O************       N20 33PSTA     128 ' ,   ,   , 0 .   '           S01244
0516 O**********      N20    30PSTA  1  131                                            S01244 CGL029
0517 O**********         N20 31PSTA     131 '   ,   ,   , 0 . '                        S01244 CGL029
0518 O**********         N20 32PSTA     131 '  ,   ,   , 0 .  '                        S01244 CGL029
0519 O**********         N20 33PSTA     131 ' ,   ,   , 0 .   '                        S01244 CGL029
     O                N20    30PSTA  1  132                                                   CGL029
     O                   N20 31PSTA     132 '   ,   ,   , 0 . '                               CGL029
     O                   N20 32PSTA     132 '  ,   ,   , 0 .  '                               CGL029
     O                   N20 33PSTA     132 ' ,   ,   , 0 .   '                               CGL029
     O/COPY WNCPYSRC,GL0490O004
     O********D**1     01 58 60                                     CAC001186369
     O***********                        19 'PROFIT CENTRE:'        CAC001186369
     O***********              PRFC      25                         CAC001186369
0520 O********T**203   35                                                 S01117
0521 O***********                        22 'REFERENCE GL0490'            S01117
0522 O***********              TITL      89                               S01117
0523 O***********                       104 'DATE'                        S01117
0524 O***********              DATE     113                               S01117
0525 O***********                       122 'PAGE'                        S01117
0526 O***********              PAGE     127                               S01117
0527 O********T**1     35                                                 S01117
0528 O***********                        72 'GENERATED ENTRIES'           S01117
0529 O***********           N35          74 '-'                           S01117
0530 O***********      41      TABNAR   104                               S01117
0531 O********T**2     35                                                 S01117
0531 O********T**2     35 58                                              S01117
0532 O***********                        72 '-----------------'           S01117
0533 O********TF21     L1N35                                              S01117
0533 O********TF21     L1N35 58                                     S01117S01244
0534 O************                       34 'CATEGORY TOTALS'             S01244
0533 O********T*21*****L1N35*58**********                          S01244 056113
     O        TF11     L1N35 58                                           056113
0534 O                                  100 'CURRENCY TOTALS'             S01244
     O        T  1     L1N35 58                                           S01244
     O                                  100 '---------------'             S01244
0535 O********T**      L1N35                                              S01117
0535 O        T        L1N35 58                                           S01117
     O                                   93 'DEBITS'                      186369
0536 O***********                        49 'NUMBER OF POSTINGS'          S01244
0537 O***********              PNUM  3B  54                               S01117
0537 O***********              PNUM  3   54                         S01117S01244
     O***********            30CDEBS 1  113                         S01244186369
     O***********            31CDEBS    113 '   ,   ,   , 0 . '     S01244186369
     O***********            32CDEBS    113 '  ,   ,   , 0 .  '     S01244186369
     O***********            33CDEBS    113 ' ,   ,   , 0 .   '     S01244186369
     O**********             30CDEBS 1  115                                            186369 CGL029
     O**********             31CDEBS    115 '   ,   ,   ,   , 0 . '                    186369 CGL029
     O**********             32CDEBS    115 '  ,   ,   ,   , 0 .  '                    186369 CGL029
     O**********             33CDEBS    115 ' ,   ,   ,   , 0 .   '                    186369 CGL029
     O                       30CDEBS 1  114                                                   CGL029
     O                       31CDEBS    114 '   ,   ,   ,   , 0 . '                           CGL029
     O                       32CDEBS    114 '  ,   ,   ,   , 0 .  '                           CGL029
     O                       33CDEBS    114 ' ,   ,   ,   , 0 .   '                           CGL029
     O        T        L1N35 58                                           186369
     O                                   94 'CREDITS'                     186369
     O***********            30CCRED 1  131                         S01244186369
     O***********            31CCRED    131 '   ,   ,   , 0 . '     S01244186369
     O***********            32CCRED    131 '  ,   ,   , 0 .  '     S01244186369
     O***********            33CCRED    131 ' ,   ,   , 0 .   '     S01244186369
     O**********             30CCRED 1  131                                            186369 CGL029
     O**********             31CCRED    131 '   ,   ,   ,   , 0 . '                    186369 CGL029
     O**********             32CCRED    131 '  ,   ,   ,   , 0 .  '                    186369 CGL029
     O**********             33CCRED    131 ' ,   ,   ,   , 0 .   '                    186369 CGL029
     O                       30CCRED 1  132                                                   CGL029
     O                       31CCRED    132 '   ,   ,   ,   , 0 . '                           CGL029
     O                       32CCRED    132 '  ,   ,   ,   , 0 .  '                           CGL029
     O                       33CCRED    132 ' ,   ,   ,   , 0 .   '                           CGL029
0538 O********T*11     L2N35                                              S01117
0538 O********T*11*****L2N35*58**********                          S01117 056113
     O        TF11     L2N35 58                                           056113
     O       AND       49N48                                              S01117
0539 O***********                        32 'BRANCH TOTALS'               S01244
0539 O***********                        98 'BRANCH TOTAL'                S01244
0539 O                                   97 'BRANCH TOTAL'                S01244
0538 O********T*11     L2N35 58                                           S01244
0538 O        T  1     L2N35 58                                           S01244
     O       AND       49N48                                              S01244
0539 O***********                        98 '-------------'               S01244
0539 O                                   97 '------------'                S01244
0540 O********T**      L2N35                                              S01117
0540 O        T        L2N35 58                                           S01117
     O       AND       49N48                                              S01117
0541 O***********                        49 'NUMBER OF POSTINGS'  S01117  S0124
0542 O***********              BNUM  3B  54                               S01117
0542 O***********              BNUM  3   54                       S01117  S01244
0541 O                                  115 'NUMBER OF POSTINGS'          S01244
0542 O                         BNUM  3  120                               S01244
     O********T*3******L2*58*************                          S01117 056113
     O        TF2      L2 58                                              056113
     O       AND       49N48                                              S01117
     O                                   69 '*** END OF REPORT FOR'       S01117
     O                                   76 'BRANCH'                      S01117
     O                         BRCA      80                               S01117
     O                                   84 '***'                         S01117
     O*                                                                   S01117
     O        T 3      LR 58N49                                           S01117
     O       OR        LR 58 48                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0471 OGL0490P1E  203           NODTL                                      S01117
0473 O                                   24 'REFERENCE GL0490P1'          S01117
0474 O                         BJURPT    89                               S01117
0475 O                                  104 'DATE'                        S01117
0476 O                         RUNA     113                               S01117
0477 O                                  122 'PAGE'                        S01117
0478 O                         PAGE     127                               S01117
0479 O        E  1             NODTL                                      S01117
0481 O                                   72 'GENERATED ENTRIES'           S01117
*    O                    49             83 'BRANCH'                      S01117
*    O                    49   BRNCH     87                               S01117
     O                    49             88 '-'                           S01117
*    O                    49   A8BRNM   118                               S01117
     O        E                NODTL                                      S01117
0554 O                                   72 '-----------------'           S01117
     O        E   26           NODTL                                      S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
     O        E   48           NODTL                                      S01117
     O                 49                69 '*** END OF REPORT FOR'       S01117
     O                 49                76 'BRANCH'                      S01117
     O                 49      BRNCH     80                               S01117
     O                 49                84 '***'                         S01117
     O                N49                76 '*** END OF REPORT ***'       S01117
0543 O**      FILE CONTROLS
0544 O********T**203   LRN35                                              S01117
0544 OGL0490AUT  203   LR                                                 S01117
0545 O***********                        22 'REFERENCE GL0490'            S01117
0545 O                                   24 'REFERENCE GL0490AU'          S01117
0546 O***********              TITL      89                               S01194
0546 O                         BJURPT    89                               S01194
0547 O                                  104 'DATE'
0548 O***********              DATE     113                               S01194
0548 O                         RUNA     113                               S01194
0549 O                                  122 'PAGE'
0550 O***********              PAGE     127                               S01117
0550 O                         PAGE1    127                               S01117
0551 O********T**1     LRN35                                              S01117
0551 O        T  1     LR                                                 S01117
0552 O                                   72 'GENERATED ENTRIES'
     O                                   87 'RUN CONTROLS'                S01117
0553 O********T**2     LRN35                                              S01117
0553 O        T  2     LR                                                 S01117
0554 O                                   72 '-----------------'
0555 O********T**315   LR                                                 S01117
0556 O***********                        32 'FILE CONTROLS'               S01117
0557 O********T**2     LR                                                 S01117
0557 O        T  218   LR                                                 S01117
0558 O                                   43 'TOTAL NUMBER OF POSTINGS'
0559 O                         TNUM  3   49
0560 O                                   65 'HASH TOTAL OF'
0561 O                                   81 'POSTING AMOUNTS'
0562 O                         HASHITZ  102
0563 O                         HASHDT   105
0564 O                       26         106 '-'
     O        T 21     LR 35                                              S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
0375 O        T 21     U8 U7 LR                                           S01194
0376 O                                   42 '*** REFERENCE'               S01194
0377 O                         DBPGM     53                               S01194
0378 O                                   71 '-DATABASE ERROR AT'          S01194
0379 O                         DBASE     75                               S01194
0380 O        T  1     U8 U7 LR                                           S01194
0381 O                                   37 'FILE NAME'                   S01194
0382 O                         DBFILE    48                               S01194
0383 O                                   52 'KEY'                         S01194
0384 O                         DBKEY     82                               S01194
0565 O********T** 30   LR                                                 S01117
0566 O***********                        76 '*** END OF REPORT ***'       S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0490OOPG                                           S01408
     O*                                                                   S01408
     O*                                                                   186369
     O* TABNAR Table reduced to width 14 (types E,O,C,P,Q,M)              186369
**  TABLE OF GENERATED ENTRY TYPES AND THEIR RELATED NARRATIVES
RSPOT REVAL
XTFR F/CCY I&E
IPOST TO I&E
FFWD REVAL
DDEALS
ECUST EXCHANGE                                                            186369
OSTANDING ORD                                                             186369
CCAPITALIS'N                                                              186369
PFIXED A/C CHG                                                            186369
QSTATEMENT CHG                                                            186369
UCUST. LENDING
SSEC.TRADING
MAMOUNT ACCRUAL
YTFR B/CCY I&E
GFUNDS TFR
TFUTURES & OPT
HCHIPS/MIDAS                                                              S01427
ANUMBERED A/C                                                             S01421
JHOLD MAIL                                                                S01421
KPROFIT CENTRE
NTELLER TRANS                                                             CRT001
0CONSUMER BANK                                                                                CRE026
     X/COPY WNCPYSRC,GL0490X001
VSWEEP ACCTG.                                                             CRE004
LACCT TRANSFER                                                                                CAP204
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
