0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Cash flow report')                            *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *       GL0540 - CASH FLOW REPORT                               *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CLE172             Date 01Oct20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE154             Date 06Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER049             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP204             Date 09Feb10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 214232             Date 05Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 04May04               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 223572             Date 03Dec03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003             Date 13Sep00               *
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 174051             Date 15May00               *
      *                 151655             Date 13Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 163486             DATE 14Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 155669             DATE 05MAR99               *
     F*                 154989             DATE 17FEB99               *
     F*                 151083             DATE 23DEC98               *
     F*                 149411             DATE 22DEC98               *
     F*                 CEU020             Date 29May98               *
     F*                 CEU011             Date 29May98               *
     F*                 CEU017             DATE 02Apr98                  *
     F*                 CSE007             DATE 18Mar98                  *
     F*                 CEU003             Date 12Jan98               *
     F*                 CLE005             Date 22May97                  *
     F*                 CLE004             Date 22May97                  *
     F*                 CLE006             Date 22May97                  *
      *                 CTI001             Date 12AUG97               *
     F*                 099250             Date 24Feb97                  *
     F*                 CFF004             Date 02Oct96                  *
     F*                 105140             DATE 20NOV96                  *
     F*                 S01408             DATE 04NOV96                  *
     F*                 S01408             DATE 06AUG96                  *
      * Midas 10.6 (DBA 1.0) -------- PTF09 or earlier ---------------*
     F*                 S01408             DATE 24APR96                  *
     F*                 094563             DATE 13OCT95                  *
     F*                 S01408             DATE 05JAN96                  *
     F*                 S01408             DATE 08NOV95                  *
     F*                 088851             DATE 10OCT95                  *
     F*                    S01408             DATE   12SEP95             *
     F*                    073714             DATE   01MAR95             *
     F*                    081958             DATE   20JAN95             *
     F*                    CIR001             DATE   13JUN95             *
     F*                    S01496             DATE   21JUL94             *
     F*                    S01512             DATE   25NOV94             *
     F*                    S01408             DATE   18NOV94             *
     F*                    S01473             DATE   30OCT94             *
     F*                    S01408             DATE   21SEP94             *
     F*                    S01408             DATE   18AUG94             *
     F*                    045634             DATE   23APR93             *
     F*                    S01393             DATE   30OCT92             *
     F*                    S01392             DATE   22SEP92             *
     F*                    S01392             DATE   20JUL92             *
     F*                    S01117             DATE   18MAR92             *
     F*                    DT0021             DATE   21MAR91             *
     F*                    E22608             DATE   04SEP90             *
     F*                    E23028             DATE   02AUG90             *
     F*                    E20823             DATE   06FEB90             *
     F*                    E20669             DATE   01JAN90             *
     F*                    E20348             DATE   13DEC89             *
     F*                    LN0264             DATE   29MAY90             *LN0264
     F*                    S01243             DATE   11MAY90             *S01243
     F*                    E20778             DATE   18APR90             *E20778
     F*                    S01211             DATE   18APR90             *S01211
     F*                    E299               DATE   23MAR90             *  0018
     F*                    E175               DATE.  14DEC89             *E175
     F*                    E91                DATE.  23NOV89             *E91
     F*                    S84089             DATE.  12/06/89            *S84089
     F*                    S01196             DATE.   8/06/89            *S01196
     F*                    S01194             DATE.   6/06/89            *S01194
     F*                    S01195             DATE.   7/06/89            *S01195
     F*                    S01117             DATE.   7/06/89            *S01117
     F*                    S01157             DATE.   8/12/88            *
     F*                    S01153             DATE.  17/05/88            *S01153
0009 F*                    E14017             DATE.  30/06/87            *S01127
0009 F*                    S01127             DATE.  16/06/87            *S01127
     F*                    S03220             DATE.  10/05/88            *
     F*                    S01129             DATE.  31/07/87            *
     F*                    S01119             DATE.  15/06/87            *
     F*                    S01124             DATE.  00/00/00            *
0010 F*                                                                  *
      *****************************************************************
      *                                                               *
      *  CLE172 - LIBOR Deregulation - Lending                        *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CER049 - Stamp Tax                                           *
      *  CLE064 - Enhancement of Lending Frequencies                  *
      *  CAP204 - Teller Related APIs - Account Transfer              *
      *  214232 - Exclude Risk Parts Sold event for principal amount. *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha (Recompile)  *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  223572 - Events By Nostro Rprt is showing the All In and     *
      *           NTR Events (Recompile)                              *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CIR003 - Principal Exchange on Cross Currencies IRS          *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps. Coding done for Amortisation of  *
      *           Caps/Collars/Floors only.                           *
     F*  174051 - Opening balance truncated.  Changed definition of   *
     F*           ZZAMT from 15,3 to 18,3.                            *
     F*  151655 - Inserted additional checking if leap year for 4th      *
     F*           sub-totalling period.                                  *
     F*  163486 - Recompiled due to changes to DLEVNTL6 & EVNTXED.       *
     F*  155669 - GLEVCFL0 is open only when CEU011 .                    *
     F*           Condition the write to GLEVCFL0 on CEU011 being ON .   *
     F*  154989 - EXX spot rate shown on report should be EURO rate,     *
     F*           AND CUM TOTAL is wrongly added to the NET DAY to give  *
     F*           the BASE EQU total which should be the cum tot by spot *
     F*           rate .                                                 *
     F*  151083 - Recompiled over changes in DLEVNTL6                    *
     F*  149411 - Wrong processing for EURO Consolidated Currency.    *
     F*  CEU020 - EMU Lending Multi-currency Rollover                 *
     F*  CEU011 - EMU Position/Risk Enquiries & Reports.              *
     F*  CEU017 - Securities Redenomination Euro Changes                 *
     F*           Same coding as CSE007                                  *
     F*  CSE007 - Corporate Actions                                      *
     F*  CEU003 - Settlement currency conversion.
     F*  CLE005 - Customer Lending Enhancements - Tranche 3              *
     F*  CLE004 - Customer Lending Enhancements - Tranche 2              *
     F*  CLE006 - Customer Lending Enhancements - Syndications           *
     F*  CTI001 - Midas / Trade Innovation Interface Phase 1
     F*  099250 - Interest settlement for nostro branch doubled.         *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)     *
     F*  105140 - Recompile over changed LVENTZZ.                        *
0010 F*  S01408 - Addition of Core Hook GL0540CP14                       *
0010 F*           Addition of Core Hook GL0540FFP3                       *
     F*  S01408 - Addition of core hook GL0540IIP1                       *
     F*  S01408 - Addition of core hook GL0540CP11                       *
     F*                                 GL0540CP12                       *
     F*                                 GL0540CP13                       *
     F*                                 GL0540FFP1                       *
     F*                                 GL0540FFP2                       *
0010 F*  094563 - Incorrect fix of 081958 on the ACCNT I-spec,           *
0010 F*           the OR keyword should be one space to the left         *
0010 F*           This caused all ccy nostro opening balance to be       *
0010 F*           zero.                                                  *
     F*  S01408 - Addition of core hook GL0540CP10                       *
     F*       S01408  - Addition of Hook GL0540OOP1                      *
     F*                                  GL0540OOP2                      *
     F*                                  GL0540OOP3                      *
     F*                                  GL0540OOP4                      *
     F*                                  GL0540OOP5                      *
     F*                                  GL0540OOP6                      *
     F*                                  GL0540OOP7                      *
     F*                                  GL0540OOP8                      *
     F*                                  GL0540OOP9                      *
     F*                                  GL0540OP10                      *
     F*       088851  - Interbranch entries from SE Trade should add or  *
     F*                 subtract amounts based on the In/Out indicator   *
     F*       S01408  - Addition of Hook GL0540CCP7                      *
     F*                 Addition of Hook GL0540CCP8                      *
     F*                 Addition of Hook GL0540CCP9                      *
     F*       073714  - OTC ENHANCEMENTS                                 *
0010 F*       081958 -  Process Closed Accounts correctly.               *
     F*       CIR001 -  Interest Rate Calendars.                         *
     F*       S01496 -  Incorporation of Jyske Enhancements(S01978)      *
     F*                 Recompiled due to changes in PF/TREVED           *
     F*       S01512 -  Use payment date for coupon event due on a       *
     F*                 holiday and payment on the next working date     *
     F*       S01408  - Addition of Hook GL0540CCP4                      *
     F*                 Addition of Hook GL0540CCP5                      *
     F*                 Addition of Hook GL0540CCP6                      *
     F*                 Addition of Hook GL0540IIPG                      *
     F*       S01473  - Midas Leo Integration. Addition of LC files and  *
     F*                 events processing                                *
     F*       S01408  - Addition of Hook GL0540CCP2                      *
     F*                 Addition of Hook GL0540CCP3                      *
     F*       S01408  - Addition of Hooks:                               *
     F*                 GL0540FFPG,GL0540IPG1,GL0540IPG2,GL0540CPG1,     *
     F*                 GL0540CPG2,GL0540CPG3,GL0540CPG4,GL0540CPG5,     *
     F*                 GL0540CPG6,GL0540CPG7,GL0540CPG8,GL0540CPG9,     *
     F*                 GL0540OPG1,GL0540OPG2,GL0540OPG,GL0540PDR        *
     F*                 GL0540CP1,GL0540LH1 ,GL0540CPG                   *
     F*       045634  - Addition of lending fees in the OLPOS/PRONOS     *
     F*                 processing - previously all lending fees were    *
     F*                 omitted by the logical omit criteria. They are   *
     F*                 processed in the same way as loan payments etc   *
     F*                 In addition the primary file has been altered    *
     F*                 to only process LENDING events that are for      *
     F*                 AUTO settlement                                  *
     F*       S01393 - Strategic Risk Management Release 10.             *
     F*                Production of SRM Cashflow files is now performed *
     F*                in a separate program (RM0005).                   *
     F*                (S01211 - SRM ENHANCEMENTS WAS NOT APPLIED TO     *
     F*                THIS PROGRAM AT R10 SO NO BACKING OUT OF          *
     F*                S01211 NECESSARY)                                 *
     F*       S01392 - JAPANESE SUBMODULE ENHANCEMENTS (LE)              *S01392
     F*       S01392 - JAP.SUB-MODULE INCORPORATION (CORE)               *
0010 F*       S01117 - RECOMPILED FOR FT RELEASE 10                      *
     F*       DT0021 - HEDGED EVENTS ARE NO LONGER REPORTED ON THIS      *
     F*                REPORT                                            *
     F*       E22608 - PROGRAM RENAMED FROM DL0540                       *
     F*       E23028 - Stop MMOD being locked during the run time of     *
     F*                this program.  (Redundant at R10 PTF              *
     F*                Incorporation, due to S01211 having been partly   *
     F*                removed relative to Release 2.)                   *
     F*       E20823 - SECURITY INTEREST BEING SHOWN IN WRONG COLUMN,    *
     F*                IF SE2 INSTALLED.                                 *
     F*       E20669 - STEVEAB AND BPEVED RECORD FORMATS REMOVED FROM    *
     F*                LOGICAL EVNTML6.                                  *
     F*       E20348 - To stop event types of the form '24--' being sent *
     F*                SRM file RMPCCF.  (Redundant in R10 PTF           *
     F*                Incorporation, as SRM changes have been removed   *
     F*                from this program.                                *
     F*       LN0264 - THE CUMULATIVE TOTAL AND BASE EQUIVALENT FIELDS   *LN0264
     F*                WERE NOT BEING CLEARED FOR EACH CHANGE OF         *LN0264
     F*                CURRENCY. ONLY THE FIRST RECORD ON THE NOSTRO     *LN0264
     F*                FILE WAS BEING READ IRRESPCTIVE OF CURRENCY       *LN0264
     F*       S01243 - PROCESS EVENTS FOR PRINCIPAL INCREASES ON         *S01243
     F*                TERM LOANS                                        *S01243
     F*       E20778 - CALL ITEMS APPEARING AS NOTICE                    *E20778
     F*       S01211 - Corrections made to SR/SFREQB and processing      *S01211
     F*                of Event Type '21C3'                              *S01211
     F*       E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'      *
     F*       E175    -  TEST FOR MULTIBRANCH BEFORE SETTING OUTPUT      *
     F*                  AND WHETHER FLOW OF CURRENCY IS IN OR OUT       *
     F*       E91     -  EMPTY EVENT FILE SHOULD PRODUCE NO P1           *E91
     F*       S01196  -  REMOVAL OF LETTERS OF CREDIT FILES              *S01196
     F*       S01195  -  NEW HOLIDAY FILE PROCESSING                     *S01195
     F*       S01117  -  MULTI-BRANCHING MODIFICATIONS                   *S01117
     F*       S01194  -  NEW STANDING DATA MODIFICATIONS                 *S01194
     F*       S01157  -  Deal type 'RL' has been replaced with separate  *
     F*                  deal types for cap(RP),collar(RR) or floor(RF)  *
     F*       S01153  -  COB ENHANCEMENTS - CHANGE OF PRIME FILE         *S01153
     F*                  (NOW OMITS UNREQUIRED EVENT TYPES)              *S01153
     F*       E14017 - PROCESS LONG TERM SECURITIES.INCLUDES CHANGE      *E14017
     F*       TO ZFREQB ,NOW RENAMED TO SFREQB                           *E14017
     F*       S01127 - LVENTM NOW ALSO BASED OVER FOEVED AND FOEVEZZ     *S01127
     F*                OF FUTURE AND OPTION. PURCHASE AND SALE EVENTS    *S01127
     F*                FROM PF/FOEVED ARE TO BE HANDLED IN AN IDENTICAL  *S01127
     F*                FASHION TO FOREIGN EXCHANGE PURCHASE AND SALES.   *S01127
     F*       S03220 - FUNDS TRANSFER                                    *S03220
     F*       S01129 - PROCESS SECURITIES TRADING 2 FILES ON EVNTM       *S01129
     F*                (TREVED,CPEVED,DPEVED,BPEVED).                    *S01129
0010 F*       S01119  -  FORWARD RATE AGREEMENTS/INTEREST RATE SWAPS     *
0011 F*                                                                  *
0012 F********************************************************************
0014 F**NTM***IP AE           K        DISK                               S01153
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0540FFP1                                           S01408
     F*                                                                   S01408
     F*DLEVNTML6*IP*AE****       K        DISK                     S01153 CEU011
     FDLEVNTL6IP AE           K        DISK                               CEU011
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0540FFP2                                           S01408
     F*                                                                   S01408
0014 F***TABICD**IF**E           K        DISK                      S01119S01194
     F****        TABLETAF                          KIGNORE         S01119S01194
     F****        TABLETHF                          KIGNORE         S01119S01194
     F****        TABLETRF                          KIGNORE         S01119S01194
     F****        TABLETXF                          KIGNORE         S01119S01194
     F****        TABTB10F                          KIGNORE         S01119S01194
     F****        TABTB11F                          KIGNORE         S01119S01194
     F****        TABTB20F                          KIGNORE         S01119S01194
     F****        TABTB30F                          KIGNORE         S01119S01194
     F****        TABTB35F                          KIGNORE         S01119S01194
     F****        TABTB50F                          KIGNORE         S01119S01194
     F****        TABTB55F                          KIGNORE         S01119S01194
     F****        TABTE10F                          KIGNORE         S01119S01194
     F****        TABTE20F                          KIGNORE         S01119S01194
     F****        TABTG10F                          KIGNORE         S01119S01194
     F****        TABTG20F                          KIGNORE         S01119S01194
     F*REVEA**IF**E                    DISK                         S01129S01153
     F*PEVEA**IF**E                    DISK                         S01129S01153
     F*PEVEA**IF**E                    DISK                         S01129S01153
     F*PEVEA**IF**E                    DISK                         S01129S01153
0015 F**ACCNT***IF  F     400 15AI     2 DISK                             S01117
     F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     FACCNT   IF  F     573 24AI     2 DISK                                                   CGL029
     FSDNOSTL1IF  E           K        DISK                               S01194
     FGLEVCFL0UF  E           K        DISK                      A    UC  CEU011
0016 F**TABLE***IF  F      96 12AI     2 DISK                             S01194
0017 F**TABLE2**IF  F      96 12AI     2 DISK                             S01194
0018 F*PRINT  O   F     132     OF     PRINTER                      S01124S01117
0018 F*L0540P1O***F     132     OF     PRINTER                      S01124S01117
0018 F*DL0540P1O***F*****132     OF     PRINTER      KINFDS SPOOL   S01117E22608
0018 F*DL0540AUO***F*****132     OA     PRINTER      KINFDS SPOOLU  S01117E22608
0018 FGL0540P1O   F     132     OF     PRINTER      KINFDS SPOOL          E22608
0018 FGL0540AUO   F     132     OA     PRINTER      KINFDS SPOOLU         E22608
0019 F*
     F/COPY WNCPYSRC,GL0540FFPG                                           S01408
     F*                                                                   S01408
0020 F* ID F  C  H  L    FUNCTION OF INDICATORS
0021 F* 01            EVNTM HEADER
0022 F* 02            EVNTM DETAIL - DEAL RECORD
0023 F**03************EVNTM TRAILER                                       S01153
0022 F* 04            EVNTM DETAIL - FO RECORD                            S01127
0023 F**14************EVNTM TRAILER- FO RECORD                     S01153 S01127
0024 F**04************EVNTM CATCHALL*****************                     S01127
0025 F**05************ICR 1                                               S01194
0026 F**06************CURRENCIES RECORD 1                                 S01194
0027 F**07************NOSTROS RECORD                                      S01194
0028 F* 08*********** HOLIDAYS RECORD                                     S01194
0029 F* 09            ********** *** ACCOUNTS MASTER FILE CATCHALL        S01194
0030 F* 10            ACCOUNTS MASTER DETAIL
0031 F**11*********** ICR 2                                               S01194
     F* 12            EVNTM DETAIL - CUSTOMER LENDING
0032 F* 13            EVNTM DETAIL - COMMERCIAL LOAN RECORD
     F**14************WORK INDICATOR FOR EVENT DATE > 7 DAYS HENCE***     S01127
     F**15************EVNTM TRAILER - CUSTOMER LENDING                    S01153
     F**16************EVNTM DETAIL  - LETTERS OF CREDIT RECORD            S01196
     F* 16            BVNTXED - Letter of credit Record                   S01473
     F**17************EVNTM TRAILER - LETTERS OF CREDIT RECORD            S01196
     F**18******      EVNTM DETAIL  - SECURITIES TRADING RECORD           E20669
     F* 19            EVNTM TRAILER - SECURITIES TRADING RECORD
0033 F*****20*********SPOT IS ZERO                                        S01194
     F*       21      FIRST CYCLE INDICATOR
     F********23******COMMERCIAL LOAN TRAILER READ                        S01153
     F*       24      DEALING TRAILER HAS BEEN READ
     F*       25      SETOF IF NOTHING WRITTEN TO SPOOL FILE              S01117
0034 F*       30      DETERMINE 4TH SUB-TOTALLING PERIOD
0035 F*       31      NO DETAILS FOR NEW SUB-TOTALLING PERIOD
0036 F*       32      DETERMINE 2ND SUB-TOTALLING PERIOD
0037 F*       33      DETERMINE 3RD SUB-TOTALLING PERIOD
0038 F*       34      DETERMINE 5TH OR LATER SUB-TOTALLING PERIODS
0039 F*    35         NEGATIVE EVENT AMOUNT
0040 F*       36      1ST LEG OF SWAP
0041 F*       37      DEAL TYPE IS 'PS'
     F*       38      WORK INDICATOR
     F*       39      PRINT TRAILER                                       LN0264
     F*       40      END OF FILE FOR @A7REB9                             LN0264
     F*       41      ACCOUNT FOR NOSTRO NOT FOUND                        LN0264
0042 F*       45      CALL/NOTICE LINES HAVE BEEN PRINTED
0043 F*       46      CONDITIONS HEADING OUTPUT
0044 F*       47      FFVD EQUALS OR PRECEDES END DAY OF PERIOD
0045 F*       48      FFVD IS AFTER END DAY OF PERIOD
0046 F******* 50      END OF NOSTRO RECORDS FOR NEW CURRENCY              LN0264
     F* 51            EVNTM DETAIL  - FUNDS TRANSFER RECORD               S03220
     F**52************EVNTM TRAILER - FUNDS TRANSFER RECORD        S01153 S03220
0047 F*    55         FFVD EQUALS ZERO
0048 F*       56      FFVD PRECEDES RUN DATE
0049 F*       57      FFVD DOES NOT PRECEDE RUN DATE
0050 F*       58      ETYP IS 17V1
0051 F*       59      DTYP IS C1
0052 F*       60-65   SET ACCORDING TO EVENT CODE
0053 F*       67      OUTPUT CALL/NOTICE LINES
0054 F*       68      OUTPUT DATE ACCUMULATORS LINE AND PERIOD
0055 F*               SUB-TOTALLING LINES IF APPROPRIATE
     F*       69      INDICATES COUPON EVENT
0056 F*       70-73   NEW CURRENCY HAS 0-3 DECIMAL PLACES
0057 F*       79      DEALING FILE CONTROL DIFFERENCES
0058 F*       80      COMMERCIAL LOANS FILE CONTROL DIFFERENCES
     F* 81            EVNTM DETAIL  - TRADE EVENTS RECORD                 S01129
     F* 82            END OF FILE ON TREVEA/CPEVEA/DPEVEA/BPEVEA FILES    S01129
     F* 83            EVNTM DETAIL  - CUSTOMER POSITION EVENTS RECORD     S01129
     F* 85            EVNTM DETAIL  - DEPOT POSITION EVENTS RECORD        S01129
     F**87************CONDITIONS CALCULATION OF BASE EQUIVALENT     S01129S01194
     F**88********    EVNTM DETAIL  - BOOK POSITION EVENTS RECORD  S01129 E20669
     F**89**************BICD CHAIN FAILED                           S01129S01194
0061 F*             L1CHANGE OF FED. FUNDS VALUE DATE
0062 F*             L2CHANGE OF EVENT CURRENCY
0064 F*    U5         SECURITY TRADING 1 ONLY - FILE OVERRIDE             S01129
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0540FFP3                                           S01408
     F*                                                                   S01408
     E/COPY ZSRSRC,ZPOWERZ1                                               CEU011
0063 E********************************************************************
0064 E********************INT         3 15 0             HASH TOTALS      S01129
0065 E********************DEC         3  3 0             HASH TOTALS      S01129
     E                    CPY@    1   1 80                                S01194
0064 E                    INT         4 15 0             HASH TOTALS      S01129
0065 E                    DEC         4  3 0             HASH TOTALS      S01129
0066 E                    ACC         9 13 0
0067 E                    TOT         9 13 0
0068 E                    RND         9 10 0
0069 E                    TOTO        9 10 0
     E                    ERND        9 10 0                              CEU011
0070 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0071 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0072 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0073 E**
0074 E                    ZHC        50  3               ZFREQ SR. ARRAY
0075 E                    ZFMD   12  12  2               ZFREQ SR. ARRAY
0076 E                    TABM   12  12  2
0077 E                    TABD   12  12  2
     E                    CMD     1   1 21                                CEU011
     E/COPY ZSRSRC,ZHOLE                                                  S01195
0078 E********************************************************************
0079 I*
0080 I*****EVENTS*FILE*-*HEADER*RECORD.
0081 I*
0082 I*
0084 I*
0085 IEVNTXECF    01
0083 I*    EVNTM FILE - DEAL HEADER RECORD.
0087 I*
0088 I*****EVENTS*FILE*-*DETAIL*RECORD.
0089 I*
0093 I*
0094 IEVNTXEDF    02
0092 I*    EVNTM FILE - DEAL DETAIL RECORD
0100 I                                              EAMT          35
0101 I                                              ECCY  L2
0135 I                                              EDAT  L1      5555
0146 I*
     I/COPY WNCPYSRC,GL0540IPG1                                           S01408
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0540IIPG                                           S01408
0147 I*****EVENTS*FILE*-*TRAILER*RECORD.
0148 I*
0149 I*
0150 I*****CATCHALL
0151 I*
0152 I*
0154 ICEVNXCCF    13
0153 I*    EVNTM - COMMERCIAL LOANS DETAIL RECORD
0161 I                                              EAMT          35
0162 I                                              ECCY  L2
0135 I                                              EDAT  L1      5555
     ILVENTELF    12
     I* EVNTM FILE CUSTOMER LENDING DETAIL RECORD
     I                                              EAMT          35
     I                                              ECCY  L2
     I*******************                           EDAT  L1              E20778
     I                                              EDAT  L1      5555    E20778
     I              DFCE                            LCEQ
     I              CDOM                            CLOC
     I              ECDP                            DEC1
     I              FACT                            FTYP
     I              FCNO                            FSEQ
0200 I*
0201 I*    EVNTM FILE - TRAILER RECORD.
0202 I*
0203 I**NTXZZF****03                                                      S01153
0213 I*
0218 I*****CVENT - COMMERCIAL LOANS EVENTS FILE            - TRAILER
     I**VNXZZF****23                                                      S01153
     I**ENTZZF****15                                                      S01153
     I*
0154 I**NTXEDF****16                                                      S01196
0161 I****                                          EAMT          35      S01196
0162 I****                                          ECCY  L2              S01196
0194 I****                                          EDAT  L1      5555    S01196
     I*
     IBVNTXEDF    16                                                      S01473
     I                                              EAMT          35      S01473
     I                                              ECCY  L2              S01473
     I                                              EDAT  L1      5555    S01473
      ** Leo DL Events File                                               S01473
      *                                                                   S01473
     I*****EVNTM FILE - LETTERS OF CREDIT TRAILER                         S01196
     I**NTXEZF****17                                                      S01153
     I*
     I*STEVEABF*   18                                                     E20669
     I*    EVNTM FILE - SECURITIES TRADING DETAIL
     I**********                                    EAMT          35      E20669
     I**********                                    ECCY  L2              E20669
     I**********                                    EDAT  L1      5555    E20669
     I*
     I*    EVNTM FILE - SECURITIES TRADING TRAILER
     I**EVEFCF****19                                                      S01153
     I**************HSTA                            HRWN                  S01153
     I**************HSTB                            HRDC                  S01153
     I*                                                                   S01129
     ITREVEDF     81                                                      S01129
     I*    EVNTM FILE - TRADE EVENTS DETAIL                               S01129
     I              TREC                            ETYP                  S01129
     I              TRVS                            EAMT          35      S01129
     I              TRSC                            ECCY  L2              S01129
     I              TRVD                            EDAT  L1      5555    S01129
     I              TRIO                            CCIO                  S01129
     I*                                                                   S01129
     ICPEVEDF     83                                                      S01129
     I*    EVNTM FILE - CUSTOMER POSITION EVENTS DETAIL                   S01129
     I              CCCE                            ETYP                  S01129
     I              CCEA                            EAMT          35      S01129
     I              CCEC                            ECCY  L2              S01129
     I**************CCDT                            EDAT  L1      5S01129 S01512
     I              CPYD                            EDAT  L1      5555    S01512
     I*                                                                   S01129
     IDPEVEDF     85                                                      S01129
     I*    EVNTM FILE - DEPOT POSITION EVENTS DETAIL                      S01129
     I              CCCE                            ETYP                  S01129
     I              CCEA                            EAMT          35      S01129
     I              CCEC                            ECCY  L2              S01129
     I**************CCDT                            EDAT  L1      5S01129 S01512
     I              CCPD                            EDAT  L1      5555    S01512
     I*                                                                   S01129
     I*BPEVEDF**   88                                              S01129 E20669
     I*    EVNTM FILE - BOOK POSITION EVENTS DETAIL                       S01129
     I**********    CCCE                     ETYP                  S01129 E20669
     I**********    CCEA                     EAMT          35      S01129 E20669
     I**********    CCEC                     ECCY  L2              S01129 E20669
     I**********    CCDT                     EDAT  L1      5555    S01129 E20669
     I*                                                                   S03220
     IFPVNTDDF    51                                                      S03220
     I*    EVNTM FILE - FUNDS TRANSFER DETAIL                             S03220
     I                                              EAMT          35      S03220
     I                                              ECCY  L2              S03220
     I                                              EDAT  L1      5555    S03220
     I*                                                                   S03220
     I*    EVNTM FILE - FUNDS TRANSFER TRAILER                            S03220
     I**VNTZZF****52                                                S03220S01153
     I**********    NORE1                           NORE            S03220S01153
      *                                                                                       CAP204
     IGLEVNTDF    53                                                                          CAP204
     I                                              EAMT          35                          CAP204
     I                                              ECCY  L2                                  CAP204
     I                                              EDAT  L1      5555                        CAP204
      *                                                                                       CAP204
     IGLEVNTZF    54                                                                          CAP204
     I              ZZ304                           GLFIL                                     CAP204
     I*                                                                   S01127
     IFOEVEDF     04                                                      S01127
     I*    EVNTM FILE - FO DETAIL RECORD                                  S01127
     I                                              EAMT          35      S01127
     I                                              ECCY  L2              S01127
     I                                              EDAT  L1      5555    S01127
     I*                                                                   S01127
     I*****EVNTM FILE - FO TRAILER                                  S01127S01153
     I*OEVEZZF****14                                                S01127S01153
     I/COPY WNCPYSRC,GL0540IPG2                                           S01408
     I*                                                                   S01408
     I*                                                                   S01408
0222 I*
     I** TABLE FILES ARE NO LONGER USED .REPLACED WITH NEW SYNON FILES.   S01194
0223 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0224 I*                                                                   S01194
0225 I**TABLE   NS  05   2 C0   3 C1  12 C1                               S01194
0226 I****   AND      13 C0                                               S01194
0227 I****                                    1   1 RECI                  S01194
0228 I****                                    2   30RECT                  S01194
0229 I****                                   12  130RCDE                  S01194
0230 I****                                   14  66 TITL                  S01194
0231 I****                                   67  67 DATF                  S01194
0232 I****                                   68  700DFBR                  S01194
0233 I****                                   74  74 MODI1                 S01194
0234 I****                                   75  75 MODI2                 S01194
0235 I****                                   76  76 MODI3                 S01194
0236 I****                                P  77  790RUND                  S01194
0237 I****                                   80  86 RUNA                  S01194
0238 I****                                   87  870SFLG                  S01194
0239 I****                                P  90  920LCD                   S01194
0240 I****                                   93  93 CHTP                  S01194
0241 I****                                P  94  960TNLU                  S01194
0242 I****                                                                S01194
0243 I**** TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0244 I****                                                                S01194
0245 I***TABLE***NS  11   1 CD   2 C0   3 C1                              S01194
0246 I****** AND      12 C1  13 C1                                        S01194
0247 I****                                    1   1 RECI                  S01194
0248 I****                                    2   30RECT                  S01194
0249 I****                                   12  130RCDE                  S01194
0250 I****                                   14  16 BCCY                  S01194
0251 I****                                   17  19 BCYL                  S01194
0252 I****                                   20  22 HOCY                  S01194
0253 I****                                   23  280HEAD                  S01194
0254 I****                                P  29  310APDA                  S01194
0255 I****                                   35  35 APFQ                  S01194
0256 I****                                P  36  380LOGS                  S01194
0257 I****                                   39  40 CUZR                  S01194
0258 I****                                P  41  430DNWD                  S01194
0259 I****                                   44  460BVLP                  S01194
0260 I****                                   47  49 LOCY                  S01194
0261 I****                                   50  510FDAY                  S01194
0262 I****                                   86  86 ISAV                  S01194
0263 I****                                P  87  890LLOG                  S01194
0264 I****                                P  90  920LCD                   S01194
0265 I****                                   93  93 CHTP                  S01194
0266 I****                                P  94  960TNLU                  S01194
0267 I****                                                                S01194
0268 I**** TABLE FILE - CURRENCIES RECORD 1.                              S01194
0269 I****                                                                S01194
0270 I**TABLE**NS  06   1 CD   2 C2   3 C0                                S01194
0271 I****   AND      13 C1                                               S01194
0272 I****                                    1   1 RECI                  S01194
0273 I****                                    2   30RECT                  S01194
0274 I****                                   10  12 CCY                   S01194
0275 I****                                   13  130SREC                  S01194
0276 I****                                   14  27 CCNM                  S01194
0277 I****                                P  28  348SPOT            20    S01194
0278 I****                                   35  37 CCYS                  S01194
0279 I****                                   38  380CDP                   S01194
0280 I****                                   39  390TNOT                  S01194
0281 I****                                   40  40 DCCY                  S01194
0282 I****                                   41  44 SRC1                  S01194
0283 I****                                   45  48 SRC2                  S01194
0284 I****                                   49  520TACC                  S01194
0285 I****                                   53  560TEQV                  S01194
0286 I****                                   57  600SWQV                  S01194
0287 I****                                   61  640TAC4                  S01194
0288 I****                                   65  680TAC5                  S01194
0289 I****                                   69  69 HIND                  S01194
0290 I****                                P  70  768PART                  S01194
0291 I****                                   77  780SSNO                  S01194
0292 I****                                P  79  858ERLC                  S01194
0293 I****                                   86  860MDIN            87    S01194
0294 I****                                P  90  920LCD                   S01194
0295 I****                                   93  93 CHTP                  S01194
0296 I****                                P  94  960TNLU                  S01194
0297 I**** TABLE FILE - HOLIDAY RECORD.                                   S01194
0298 I****    E-EXCLUDE, I-INCLUDE.                                       S01194
0299 I****                                                                S01194
0300 I**TABLE***NS  08   1 CD   2 C2   3 C2                               S01194
0301 I****   AND      14 CE                                               S01194
0302 I****   OR   08   1 CD   2 C2   3 C2                                 S01194
0303 I****   AND      14 CI                                               S01194
0304 I****                                    1   1 RECI                  S01194
0305 I****                                    2   30RECT                  S01194
0306 I****                                    8  120HOL                   S01194
0307 I****                                   13  130SREC                  S01194
0308 I****                                   14  14 INEX                  S01194
0309 I****                                   15  89 HCCY                  S01194
0310 I****                                P  90  920LCD                   S01194
0311 I****                                   93  93 CHTP                  S01194
0312 I****                                P  94  960TNLU                  S01194
0313 I****                                                                S01194
0314 I**** CATCHALL                                                       S01194
0315 I****                                                                S01194
0316 I****    NS  09                                                      S01194
0317 I****                                    1   1 RECI                  S01194
0318 I****                                                                S01194
0319 I**** TABLE FILE - NOSTROS RECORD.                                   S01194
0320 I****                                                                S01194
0321 I**TABLE2**NS  07   1 CD   2 C7   3 C0                               S01194
0322 I****                                    1   1 RECI                  S01194
0323 I****                                    2   30RECTA                 S01194
0324 I****                                    9  11 CCY                   S01194
0325 I****                                   12  130NOSN                  S01194
0326 I****                                   16  29 ONAC                  S01194
0327 I****                                   30  350CNUMNO                S01194
0328 I****                                   36  370ACSQ                  S01194
0329 I****                                   38  410ACOD                  S01194
0330 I****                                P  90  920LCD                   S01194
0331 I****                                   93  93 CHTP                  S01194
0332 I****                                P  94  960TNLU                  S01194
0333 I****                                                                S01194
0334 I**** CATCHALL                                                       S01194
0335 I****                                                                S01194
0336 I****    NS  09                                                      S01194
0337 I****                                    1   1 RECI                  S01194
0338 I****                                    2   30RECTA                 S01194
0339 I*
0340 I*    ACCOUNTS MASTER FILE
0341 I*
0342 IACCNT   NS  10   1 CD
0342 I********OR* 10   1 CC                                         081958094563
0342 I       OR   10   1 CC                                               094563
0343 I                                    P  56  630LDBL
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0540IIP1                                           S01408
     I*                                                                   S01408
0344 I*
0345 I*    CATCHALL
0346 I*
0347 I        NS  09
     I*                                                                   S01194
     I*                                                                   S01117
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
     ISPOOLU      DS                                                      S01117
     I*  FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*  DUMMY RECORD FORMATS FOR USE BY ACCESS OBJECTS                   S01194
     I@BANK     E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     I*@MMOD*****E DSSDMMODPD                                       S01194DT0021
     I***EXTERNAL*DS*FOR*MODULES*DETAILS                            S01194DT0021
     I**********                                                    S01194DT0021
     I@GELR     E DSSDGELRPD                                              S01194
     I** EXTERNAL DS FOR GENERAL LEDGER DETAILS                           S01194
     I*                                                                   S01194
     I@CURR     E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I*                                                                   S01194
     I*@FAIS*****E DSSDFAISPD                                       S01194DT0021
     I***EXTERNAL*DS*FOR*FRA/IRS**DETAILS                           S01194DT0021
     I**********                                                          DT0021
     ISCSARD    E DSSCSARDPD                                              S01473
      ** Switchable Features File                                         S01473
      *                                                                   S01473
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     ISDMOD     E DSSDMMODPD                                              CTI001
     I**  EXTERNAL DS FOR MODULE ID'S                                     CTI001
     I*                                                                   CTI001
     I/COPY ZSRSRC,ZHOLI                                                  S01195
0242 I/EJECT
0348 I********************************************************************
0349 C********************************************************************
     C*                                                                   S01194
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ                             S01117
      *                                                                   S01117
     C*                                                                   S01194
0350 C*    CONDITION FIRST CYCLE CALCS. ON EVENT FILE HEADER
0351 C*
0352 C**N01                GOTO DETAIL
0352 C   21                GOTO DETAIL
     C                     SETON                     21
     C                     MOVEACPY@      BIS@   80                       S01194
0353 C***                  EXSR ZSYSTM                                    S01194
0354 C***99                SETON                     U7U8LR               S01194
0355 C***99                GOTO END                                       S01194
     C*  OBTAIN BANK DETAILS FROM SDBANKPD                                S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10         ************* S01194
     C                     MOVEL'001'     DBASE   3         *DBERROR 001* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CEU011
      * Obtain General Ledger Details Via Access Object                   CEU011
      *                                                                   CEU011
     C**********           CALL 'AOGELRR0'                                             CEU011 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       CEU011
     C                     PARM '*FIRST ' @OPTN   7                       CEU011
     C********** @GELR     PARM @GELR     DSFDY                                        CEU011 CGL029
     C           @GELR     PARM @GELR     DSSDY                                               CGL029
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANK                                    CEU011
     C                     MOVEL'SDGELRPD'DBFILE           **********     CEU011
     C                     MOVEL'011'     DBASE            *DBERR 11*     CEU011
     C                     MOVEL@OPTN     DBOPTN  7        **********     CEU011
     C                     MOVEL@OPTN     DBKEY                           CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     GOTO END                                       CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CTI001
     C                     CALL 'AOMMODR0'                                CTI001
     C                     PARM '*DBERR ' @RTCD                           CTI001
     C                     PARM '*FIRST ' @OPTN                           CTI001
     C           SDMOD     PARM SDMOD     DSFDY                           CTI001
      *                                                                   CTI001
     C           @RTCD     IFNE *BLANK                                    CTI001
     C                     MOVEL'SDMMODPD'DBFILE            ************* CTI001
     C                     MOVEL'002'     DBASE             *DBERROR 002* CTI001
     C                     MOVEL@OPTN     DBOPTN            ************* CTI001
     C                     MOVEL@OPTN     DBKEY                           CTI001
     C                     SETON                     U7U8LR               CTI001
     C                     EXSR *PSSR                                     CTI001
     C                     GOTO END                                       CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     MOVE 'Y'       ULEO                            CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG1                                           S01408
     C*                                                                   S01408
     C*
0327 C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0328 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*
0356 C                     EXSR PEREND
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG                                            S01408
     C*                                                                   S01408
0357 C****                 MOVEL'20'      KEYCUR 12                       S01194
0358 C****                 MOVE '1'       WRK4    4                       S01194
     C*                                                                   S01119
     C**NEW*STANDING*DATA*BEING*USED*THUS*TABLE*FILES*REPLACED      S01194DT0021
     C******** TABTB40 FOR FRA/IRS PRESENT FLAG AND IF 'Y' ACCESS         S01119
     C********  FOR HEDGED EVENTS ON CASHFLOW FLAG                        S01119
     C*                                                                   S01119
     C***                  MOVEL'01'      ICDKEY 12                 S01119S01194
     C***                  MOVE '40'      ICDKEY                    S01119S01194
     C*                                                                   S01194
     C***        ICDKEY    CHAINTABICD               81             S01119S01129
     C***        *IN81     IFEQ '0'                                 S01119S01129
     C***        ICDKEY    CHAINTABICD               89             S01129S01194
     C**********                                                    S01194DT0021
     C***OBTAIN*MODULES*DETAILS*VIA*ACCESS*OBJECT                   S01194DT0021
     C**********           CALL 'AOMMODR0'                          S01194DT0021
     C**********           PARM '*MSG   ' @RTCD   7                 S01194DT0021
     C**********           PARM '*FIRST ' @OPTN   7                 S01194DT0021
     C********** @MMOD     PARM @MMOD     DSFDY                     S01194DT0021
     C**********                                                    S01194DT0021
     C********** @RTCD     IFNE *BLANK                              S01194DT0021
     C**********           MOVEL'SDMMODPD'DBFILE 10       **********S01194DT0021
     C**********           MOVEL'002'     DBASE   3       *DBERR 02*S01194DT0021
     C**********           MOVEL@OPTN     DBOPTN  7       **********S01194DT0021
     C**********           MOVEL@OPTN     DBKEY  29                 S01194DT0021
     C**********           SETON                     U7U8LR         S01194DT0021
     C**********           EXSR *PSSR                               S01194DT0021
     C**********           GOTO END                                 S01194DT0021
     C**********           END                                      S01194DT0021
     C**********                                                    S01194DT0021
     C***IF*FRA/IRS*FLAG*IS*ON*THEN*OBTAIN*HEDGED*EVENTS*ON*CASHFLOWS01194DT0021
     C***FLAG*FROM*SDFAISPD,*NEW*STANDING*DATA                      S01194DT0021
     C********** BGFIIN    IFEQ 'Y'                                 S01194DT0021
     C**********                                                    S01194DT0021
     C***        *IN89     IFEQ '0'                                 S01129S01194
     C***        IRFRA     ANDEQ'Y'                                 S01119S01194
     C***                  MOVE '70'      ICDKEY                    S01119S01194
     C***        ICDKEY    CHAINTABICD               81             S01129S01194
     C***81                MOVE 'N'       HEOCF                     S01119S01129
     C***        ICDKEY    CHAINTABICD               89             S01129S01194
     C**********                                                    S01194DT0021
     C***OBTAIN*FRA/IRS*DETAILS*VIA*ACCESS*OBJECT*FOR*HEDGED*EVENTS*S01194DT0021
     C**ON*CASHFLOW*                                                S01194DT0021
     C**********           CALL 'AOFAISR0'                          S01194DT0021
     C**********           PARM '*MSG   ' @RTCD   7                 S01194DT0021
     C**********           PARM '*FIRST ' @OPTN   7                 S01194DT0021
     C********** @FAIS     PARM @FAIS     DSFDY                     S01194DT0021
     C**********                                                    S01194DT0021
     C********** @RTCD     IFNE *BLANK                              S01194DT0021
     C**********           MOVEL'SDFAISPD'DBFILE 10       **********S01194DT0021
     C**********           MOVEL'003'     DBASE   3       *DBERR 03*S01194DT0021
     C**********           MOVEL@OPTN     DBOPTN  7       **********S01194DT0021
     C**********           MOVEL@OPTN     DBKEY  29                 S01194DT0021
     C**********           SETON                     U7U8LR         S01194DT0021
     C**********           EXSR *PSSR                               S01194DT0021
     C**********           MOVE 'N'       BQHEOC                    S01194DT0021
     C**********           END                                      S01194DT0021
     C**********                                                    S01194DT0021
     C***89                MOVE 'N'       HEOCF                     S01129S01194
     C***                  ELSE                                     S01119S01194
     C***                  MOVE 'N'       HEOCF                     S01119S01194
     C**********           ELSE                                     S01194DT0021
     C**********           MOVE 'N'       BQHEOC                    S01194DT0021
     C**********           END                                      S01119DT0021
     C*                                                                   S01119
      *                                                                   S01473
      ** Check the switchable features file for the Midas Leo Integration S01473
      ** number, S01473. If it is present, set the flag ULEO to 'Y'       S01473
     C                     CALL 'AOSARDR0'                                S01473
     C                     PARM *BLANKS   @RTCD                           S01473
     C                     PARM '*VERIFY' @OPTN                           S01473
     C                     PARM 'S01473'  @KEY    6                       S01473
     C           SCSARD    PARM SCSARD    DSFDY                           S01473
      *                                                                   S01473
     C           @RTCD     IFEQ *BLANKS                                   S01473
     C                     MOVE 'Y'       ULEO    1                       S01473
     C                     END                                            S01473
     C*                                                                   S01408
      **  Access SAR details file to determine if Australian              CIR001
      **  Modifications is switched on.                                   CIR001
     C                     CALL 'AOSARDR0'                                CIR001
     C                     PARM *BLANKS   @RTCD                           CIR001
     C                     PARM '*VERIFY' @OPTN                           CIR001
     C                     PARM 'CIR001'  @SARD   6                       CIR001
     C           SCSARD    PARM SCSARD    DSFDY                           CIR001
      *                                                                   CIR001
     C           @RTCD     IFEQ *BLANKS                                   CIR001
     C                     MOVE 'Y'       CIR001  1                       CIR001
     C                     ELSE                                           CIR001
     C                     MOVEL'N'       CIR001                          CIR001
     C                     END                                            CIR001
      *                                                                   CLE005
      **  Access Switchable SAR details for the existence of CLE005       CLE005
      **  (Tranch 3)                                                      CLE005
      *                                                                   CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANK    @RTCD                           CLE005
     C                     PARM '*VERIFY' @OPTN                           CLE005
     C                     PARM 'CLE005'  @SARD                           CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANK                                    CLE005
     C                     MOVE 'Y'       CLE005                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           @RTCD     IFNE *BLANKS                                   CLE005
     C           @RTCD     ANDNE'*NRF  '                                  CLE005
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE005
     C                     MOVEL'06'      DBASE            * DBERR 06 *   CLE005
     C                     MOVEL@OPTN     DBKEY            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     EXSR *PSSR                                     CLE005
     C                     GOTO END                                       CLE005
     C                     END                                            CLE005
      *                                                                   CLE004
      **  Access Switchable SAR details for the existence of CLE004       CLE004
      **  (Tranch 2)                                                      CLE004
      *                                                                   CLE004
     C                     MOVE 'N'       CLE004  1                       CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANK    @RTCD                           CLE004
     C                     PARM '*VERIFY' @OPTN                           CLE004
     C                     PARM 'CLE004'  @SARD                           CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANK                                    CLE004
     C                     MOVE 'Y'       CLE004                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANKS                                   CLE004
     C           @RTCD     ANDNE'*NRF  '                                  CLE004
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE004
     C                     MOVEL'07'      DBASE            * DBERR 07 *   CLE004
     C                     MOVEL@OPTN     DBKEY            ************   CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     GOTO END                                       CLE004
     C                     END                                            CLE004
      *                                                                   CLE004
      **  Access Switchable SAR details for the existence of CLE006       CLE006
      **  (Syndications)                                                  CLE006
      *                                                                   CLE006
     C                     MOVE 'N'       CLE006  1                       CLE006
     C                     CALL 'AOSARDR0'                                CLE006
     C                     PARM *BLANK    @RTCD                           CLE006
     C                     PARM '*VERIFY' @OPTN                           CLE006
     C                     PARM 'CLE006'  @SARD                           CLE006
      *                                                                   CLE006
     C           @RTCD     IFEQ *BLANK                                    CLE006
     C                     MOVE 'Y'       CLE006                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           @RTCD     ANDNE'*NRF  '                                  CLE006
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE006
     C                     MOVEL'08'      DBASE            * DBERR 08 *   CLE006
     C                     MOVEL@OPTN     DBKEY            ************   CLE006
     C                     SETON                     U7U8LR               CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     GOTO END                                       CLE006
     C                     END                                            CLE006
      *                                                                   CEU011
      ** Check if Position/Risk Enquiries & Reports feature (CEU011)      CEU011
      ** is on.                                                           CEU011
      *                                                                   CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*VERIFY' @OPTN                           CEU011
     C                     PARM 'CEU011'  @KEY    6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFEQ *BLANKS                                   CEU011
     C                     MOVE 'Y'       CEU011  1                       CEU011
     C                     MOVE *ON       *IN86                           CEU011
     C                     ELSE                                           CEU011
     C                     MOVE 'N'       CEU011                          CEU011
     C                     MOVE *OFF      *IN86                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF  '                                  CEU011
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU011
     C                     MOVEL'09'      DBASE            * DBERR 09 *   CEU011
     C                     MOVEL'CEU011'  DBKEY            ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      **  Access Switchable SAR details for the existence of CEU020       CEU020
      **  (EMU Multi-ccy Rollover)                                        CEU020
      *                                                                   CEU020
     C                     MOVE 'N'       CEU020  1                       CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANK    @RTCD                           CEU020
     C                     PARM '*VERIFY' @OPTN                           CEU020
     C                     PARM 'CEU020'  @SARD                           CEU020
      *                                                                   CEU020
     C           @RTCD     IFEQ *BLANK                                    CEU020
     C                     MOVE 'Y'       CEU020                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CEU020
     C           @RTCD     IFNE *BLANKS                                   CEU020
     C           @RTCD     ANDNE'*NRF  '                                  CEU020
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CEU020
     C                     MOVEL'09'      DBASE            * DBERR 09 *   CEU020
     C                     MOVEL@OPTN     DBKEY            ************   CEU020
     C                     SETON                     U7U8LR               CEU020
     C                     EXSR *PSSR                                     CEU020
     C                     GOTO END                                       CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CIR006
      ** Determine if SAR CIR006 is installed                             CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY '@OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD                           CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
      *                                                                   CIR006
     C           @RTCD     IFNE *BLANKS                                   CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE                          CIR006
     C                     MOVEL'24'      DBASE                           CIR006
     C                     MOVEL'CIR006'  DBKEY                           CIR006
     C                     MOVE *ON       *INU7                           CIR006
     C                     MOVE *ON       *INU8                           CIR006
     C                     MOVE *ON       *INLR                           CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR003
      ** Determine if SAR CIR003 is installed                             CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY '@OPTN                           CIR003
     C                     PARM 'CIR003'  @SARD                           CIR003
     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANKS                                   CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'DBFILE                          CIR003
     C                     MOVEL'25'      DBASE                           CIR003
     C                     MOVEL'CIR003'  DBKEY                           CIR003
     C                     MOVE *ON       *INU7                           CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     MOVE *ON       *INLR                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                                       CLE028
      ** Check if enhancement CLE028 is installed                                             CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD                                               CLE028
     C                     PARM '*VERIFY 'POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD   6                                           CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'CLE028'  DBKEY                                               CLE028
     C                     MOVEL'26'      DBASE                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CAS009
      ** Access SAR Details File to determine if CAS009 is installed                          CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD   7                                           CAS009
     C                     PARM '*VERIFY' POPTN   7                                           CAS009
     C                     PARM 'CAS009'  PSARD   6                                           CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
      ** Handle Datebase Error.                                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE *BLANK                                                        CAS009
     C           PRTCD     ANDNE'*NRF   '                                                     CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVEL'CAS009'  DBKEY                                               CAS009
     C                     MOVEL'26'      DBASE                                               CAS009
     C                     MOVE *ON       *INU7                                               CAS009
     C                     MOVE *ON       *INU8                                               CAS009
     C                     MOVE *ON       *INLR                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      ** CAS009 is installed                                                                  CAS009
      *                                                                                       CAS009
     C           PRTCD     IFEQ *BLANK                                                        CAS009
     C                     MOVE 'Y'       CAS009  1                                           CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'N'       CAS009                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAP204
      ** Determine if SAR CAP204 is installed                                                 CAP204
      *                                                                                       CAP204
     C                     CALL 'AOSARDR0'                                                    CAP204
     C                     PARM *BLANKS   @RTCD                                               CAP204
     C                     PARM '*VERIFY '@OPTN                                               CAP204
     C                     PARM 'CAP204'  @SARD                                               CAP204
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP204
      *                                                                                       CAP204
     C           @RTCD     IFNE *BLANKS                                                       CAP204
     C           @RTCD     ANDNE'*NRF   '                                                     CAP204
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP204
     C                     MOVEL'27'      DBASE                                               CAP204
     C                     MOVEL'CAP204'  DBKEY                                               CAP204
     C                     MOVE *ON       *INU7                                               CAP204
     C                     MOVE *ON       *INU8                                               CAP204
     C                     MOVE *ON       *INLR                                               CAP204
     C                     EXSR *PSSR                                                         CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C           @RTCD     IFEQ *BLANKS                                                       CAP204
     C                     MOVE 'Y'       CAP204  1                                           CAP204
     C                     ELSE                                                               CAP204
     C                     MOVE 'N'       CAP204                                              CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CER049
      ** Determine if SAR CER049 is installed                                                 CER049
      *                                                                                       CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*VERIFY '@OPTN                                               CER049
     C                     PARM 'CER049'  @SARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
      *                                                                                       CER049
     C           @RTCD     IFNE *BLANKS                                                       CER049
     C           @RTCD     ANDNE'*NRF   '                                                     CER049
     C                     MOVEL'SCSARDPD'DBFILE                                              CER049
     C                     MOVEL'28'      DBASE                                               CER049
     C                     MOVEL'CER049'  DBKEY                                               CER049
     C                     MOVE *ON       *INU7                                               CER049
     C                     MOVE *ON       *INU8                                               CER049
     C                     MOVE *ON       *INLR                                               CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           @RTCD     IFEQ *BLANKS                                                       CER049
     C                     MOVE 'Y'       CER049  1                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE 'N'       CER049                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                   CEU020
     C           CEU011    IFEQ 'Y'                                       CEU011
      *                                                                   154989
      ** Obtain Euro spot rate for Consolidated Euro EXX in report        154989
      ** via access object from SDCURRPD .                                154989
      *                                                                   154989
     C                     CALL 'AOCURRR0'                                154989
     C                     PARM '*MSG   ' @RTCD                           154989
     C                     PARM '*KEY   ' @OPTN                           154989
     C                     PARM BKEURO    @AJCD                           154989
     C           @CURR     PARM @CURR     DSSDY                           154989
      *                                                                   154989
     C           @RTCD     IFNE *BLANK                                    154989
     C                     MOVEL'SDCURRPD'DBFILE                          154989
     C                     MOVEL'23'      DBASE            ************   154989
     C                     MOVELBKEURO    DBKEY            * DBERR 23 *   154989
     C                     MOVEL@OPTN     DBOPTN           ************   154989
     C                     SETON                     U7U8LR               154989
     C                     EXSR *PSSR                                     154989
     C                     GOTO END                                       154989
     C                     ELSE                                           154989
     C                     MOVELA6SPRT    EUSPRT 138                      154989
     C                     MOVELA6MDIN    EUMDIN  1        EURO M/D IND   154989
     C                     ENDIF                                          154989
      *                                                                   CEU011
      ** Obtain currency details via Access object from SDCURRPD          CEU011
      *                                                                   CEU011
     C                     CALL 'AOCURRR0'                                CEU011
     C                     PARM '*MSG   ' @RTCD   7                       CEU011
     C                     PARM '*KEY   ' @OPTN   7                       CEU011
     C                     PARM BJCYCD    @AJCD   3                       CEU011
     C           @CURR     PARM @CURR     DSSDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANK                                    CEU011
     C                     MOVEL'SDCURRPD'DBFILE 10                       CEU011
     C                     MOVEL'10'      DBASE   3        ************   CEU011
     C                     MOVELBJCYCD    DBKEY  29        * DBERR 10 *   CEU011
     C                     MOVEL@OPTN     DBOPTN  7        ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     GOTO END                                       CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      **   Save details fields for settlement currency                    CEU011
      *                                                                   CEU011
     C                     MOVE A6INCY    BCCY1   1                       CEU011
     C                     MOVE A6SPRT    WSSPRT 138                      CEU011
     C                     MOVE A6NBDP    WSNBDP  10                      CEU011
     C**********           MOVE A6SPAE    WSSPAE  4                                    CEU011 CGL029
     C                     MOVE A6SPAE    WSSPAE 10                                           CGL029
     C                     MOVE A6MDIN    WSMDIN  1                       CEU011
      *                                                                   CEU011
     C                     Z-ADD21        MSGLEN 155                      CEU011
     C                     CALL 'QCMDEXC'                                 CEU011
     C                     PARM           CMD,1                           CEU011
     C                     PARM           MSGLEN                          CEU011
      *                                                                   CEU011
     C                     OPEN GLEVCFL0                                  CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      *                                                                   CLE006
     C/COPY WNCPYSRC,GL0540CCP7                                           S01408
     C*                                                                   S01408
      *                                                                   S01473
0359 C           DETAIL    TAG                             ** DETAIL TAG *
0360 C*   ACC. NUMBER OF RECORDS READ.
      * Keep separate record count for the Security (II) Events.          S01129
      *                                                                   S01129
     C           *IN81     IFEQ '1'                                       S01129
     C           *IN83     OREQ '1'                                       S01129
     C           *IN85     OREQ '1'                                       S01129
     C********** *IN88     OREQ '1'                                S01129 E20669
     C                     ADD  1         #SEIN   50                      S01129
     C                     ELSE                                           S01129
      *                                                                   S01129
0361 C********** RECRED    ADD  1         RECRED  50                      S01127
     C*    IN FUTURE AND OPTION, TRAILER IS NOT INCLUDED IN NORE          S01127
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CCP4                                           S01408
     C*                                                                   S01408
     C**N14******RECRED    ADD  1         RECRED  50                S01127S01153
     C           RECRED    ADD  1         RECRED  50                      S01153
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CCP5                                           S01408
     C*                                                                   S01408
     C                     END                                            S01129
      *                                                                   S01473
      ** If processing LEO events, check if a LEO event record was        S01473
      ** read and if so bypass check for EOF that follows and set         S01473
      ** LEO record read flag to 'Y'                                      S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           *IN16     ANDEQ'1'                                       S01473
     C                     MOVE 'Y'       ULREC   1                       S01473
     C                     ELSE                                           S01473
      *                                                                   S01473
     C  N02N12N13
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG2                                           S01408
     C*                                                                   S01408
     C*NN16N18****         GOTO END                                       S01129
     C**N16N18N81                                                  S01196 S01129
     C*ANN18N81************                                  S01196 S01129E20669
     CANN81                                                               E20669
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CCP6                                           S01408
     C*                                                                   S01408
     C*NN51*******                                                 S03220 S01127
     CANN51N04                                                            S01127
     CANN53                                                                                   CAP204
     C*ANN83N85N88          GOTO END                               S01129 E20669
     CANN83N85             GOTO END                                       E20669
      *                                                                   S01473
     C                     END                                            S01473
0363 C*
0364 C*****ACCUMULATE*NUMBER*AND*VALUE*OF*DETAIL*RECORDS*READ*IN*INT,1    S01153
0365 C*****DEC,1*****************************************************     S01153
0366 C*****FOR*DEALING*RECORDS,*AND*INT,3*AND*DEC,3*FOR***IGNORE***
0367 C*****COMMERCIAL*LOANS***IGNORE***
0368 C***********EAMT      DIV  1000      ZZAMT                           S01153
0369 C***35******          Z-SUBZZAMT     ZZAMT                           S01153
      ***********                                                   S01129
      **Keep*separate record count for the Security (II) Events.    S01129
      ***********                                                   S01129
     C************IN81     IFEQ '1'                                 S01129
     C************IN83     OREQ '1'                                 S01129S01153
     C************IN85     OREQ '1'                                 S01129S01153
     C************IN88     OREQ '1'                                 S01129S01153
     C***********          MOVE 4         X                         S01129S01153
     C***********          ELSE                                     S01129S01153
      ***********                                                   S01129S01153
0370 C***********          MOVE 1         X                               S01153
     C***********          END                                      S01129S01153
      ***********                                                   S01129S01153
0371 C***********          EXSR HASH                                      S01153
0372 C*
0373 C*    WHEN NEW CURRENCY IS ENCOUNTERED, ACCUMULATE TOTAL BALANCE OF
0374 C*    ALL NOSTRO ACCOUNTS FOR THAT CURRENCY IN INT,2  DEC,2
0375 C*    AND FIND SPOT RATE
0376 C*
0377 C  NL2                GOTO NOTL2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG3                                           S01408
     C*                                                                   S01408
0378 C***                  MOVELECCY      WRK4                            S01194
0379 C***                  MOVE WRK4      KEYCUR                          S01194
0380 C***        KEYCUR    CHAINTABLE                99                   S01194
0381 C**N06                SETON                     U7U8LR* DATABASE     S01194
0382 C**N06                GOTO END                           ERROR       S01194
     C** OBTAIN CURRENCY DETAILS VIA ACCESS OBJECT FROM SDCURRPD          S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM ECCY      @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE 10                       S01194
     C                     MOVEL'004'     DBASE   3        **********     S01194
     C                     MOVELECCY      DBKEY  29        *DBERR 04*     S01194
     C                     MOVEL@OPTN     DBOPTN  7        **********     S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C                     MOVE A6INCY    WINCY   1                       CEU011
     C                     ENDIF                                          CEU011
     C*                                                                   S01194
     C* OBTAIN NUMBER OF DECIMAL PLACES FOR THIS CURRENCY                 S01194
0384 C***        CDP       COMP 1                      7071               S01194
0385 C***        CDP       COMP 2                    73  72               S01194
0384 C           A6NBDP    COMP 1                      7071               S01194
0385 C           A6NBDP    COMP 2                    73  72               S01194
     C           CEU011    IFEQ 'Y'                                       149411
     C           *IN70     IFEQ '1'                                       149411
     C                     MOVE 6         E       10                      149411
     C                     ELSE                                           149411
     C                     MOVE 4         E                               149411
     C                     END                                            149411
     C                     END                                            149411
0386 C*
0387 C*    CLEAR ACCUMULATORS FOR NEW CURRENCY
0388 C                     Z-ADD0         INT,2
0389 C                     Z-ADD0         DEC,2
0388 C                     Z-ADD0         CUMTT                           LN0264
0389 C                     Z-ADD0         BCEQV                           LN0264
0390 C*
     C* SETTING OF LOWER LIMITS NO LONGER NECESSARY BECAUSE OF NEW FILE   S01194
0391 C**** SET LOWER LIMITS FOR NOSTRO ACCOUNTS                           S01194
0392 C***                  MOVEL'70'      KEYT   12                       S01194
0393 C***                  MOVELECCY      WRK5    5                       S01194
0394 C***                  MOVE '00'      WRK5                            S01194
0395 C***                  MOVE WRK5      KEYT                            S01194
0396 C***        KEYT      SETLLTABLE2                                    S01194
0397 C***********                                                         LN0264
0398 C*****READ*NOSTRO RECORDS                                            LN0264
0399 C******-*FIND LEDGER BALANCE FOR NOSTRO IF IT IS LIVE AND            LN0264
0400 C******-*THE CORRECT CURRENCY                                        LN0264
0397 C************LOVAL    SETLL@A7REB9                             S01194LN0264
0401 C***********RDNSTR    TAG                             ** RDNSTR TAG *LN0264
0402 C***********          SETOF                     500709               S01194
0403 C***********          READ TABLE2                   50               S01194
0403 C***********          READ @A7REB9                  50         S01194LN0264
0404 C***50******          GOTO NOTL2                      END OF FILE    LN0264
0405 C***09******RECTA     COMP 70                   5050  STILL NOSTRO   S01194
0406 C***07******CCY       COMP ECCY                 5050  CORRECT CCY    S01194
0406 C***********A7CYCD    COMP ECCY                 5050  CORRECT CS01194LN0264
0407 C***50******          GOTO NOTL2                               S01194LN0264
0408 C**N07******          GOTO RDNSTR                                    S01194
0409 C***********                                                         LN0264
0410 C*****SET*UP KEY FOR CHAINING TO ACCOUNTS MASTER                     LN0264
0411 C***********                                                         LN0264
0412 C***********          MOVELCNUMNO    LKACC   9                       S01194
0412 C***********          MOVELA7CUST    LKACC   9                 S01194LN0264
0414 C***********          MOVE CCY       LKACC                           S01194
0414 C***********          MOVE A7CYCD    LKACC                     S01194LN0264
0415 C***********          MOVELACOD      RKACC   6                       S01194
0415 C***********          MOVELA7ACCD    RKACC   6                 S01194LN0264
0416 C***********          MOVE ACSQ      RKACC                           S01194
0416 C***********          MOVE A7ACSN    RKACC                     S01194LN0264
0397 C***********          MOVELRKACC     WK9     9                 S01117LN0264
0397 C***********          MOVE A7BRCD    WK9                       S01117LN0264
0417 C***********          MOVELLKACC     KEYACC 15                       S01117
0417 C***********          MOVELLKACC     KEYACC 18                 S01117LN0264
0418 C***********          MOVE RKACC     KEYACC                          S01117
0397 C***********          MOVE WK9       KEYACC                    S01117LN0264
0419 C***********                                                         LN0264
0420 C*****CHAIN*TO ACCOUNTS MASTER                                       LN0264
0421 C***********          SETOF                     10                   LN0264
0422 C***********KEYACC    CHAINACCNT                99                   LN0264
0423 C***********                                                         LN0264
0424 C**N10******          GOTO RDNSTR                        ERROR       LN0264
0425 C***********                                                         LN0264
0426 C*****ACCUMULATE LEDGER BALANCE FOR ACCOUNTS                         LN0264
0427 C***********LDBL      DIV  1000      ZZAMT                           LN0264
0428 C***********          Z-ADD2         X       10                      LN0264
0429 C***********          EXSR HASH                                      LN0264
0430 C***********          GOTO RDNSTR                                    LN0264
0397 C***********                                                         LN0264
     C*                                                                   LN0264
     C* SET-LOWER LIMITS AND READ NOSTRO DETAILS                          LN0264
     C*    READ NOSTRO RECORDS                                            LN0264
     C*     - FIND LEDGER BALANCE FOR NOSTRO IF IT IS LIVE AND            LN0264
     C*       THE CORRECT CURRENCY                                        LN0264
     C*                                                                   LN0264
     C           ECCY      SETLL@A7REB9                                   LN0264
     C                     READ @A7REB9                  40               LN0264
     C           *IN40     DOWEQ'0'                                       LN0264
     C           ECCY      ANDEQA7CYCD                                    LN0264
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   LN0264
     C*    SET UP KEY FOR CHAINING TO ACCOUNTS MASTER                     LN0264
     C*                                                                   LN0264
     C                     MOVELA7CUST    LKACC   9                       LN0264
     C                     MOVE A7CYCD    LKACC                           LN0264
     C**********           MOVELA7ACCD    RKACC   6                                    LN0264 CGL029
     C                     MOVELA7ACCD    RKACC  12                                           CGL029
     C                     MOVE A7ACSN    RKACC                           LN0264
     C**********           MOVELRKACC     WK9     9                                    LN0264 CGL029
     C                     MOVELRKACC     WK9    15                                           CGL029
     C                     MOVE A7BRCD    WK9                             LN0264
     C**********           MOVELLKACC     KEYACC 18                                    LN0264 CGL029
     C                     MOVELLKACC     KEYACC 24                                           CGL029
     C                     MOVE WK9       KEYACC                          LN0264
     C*                                                                   LN0264
     C*    CHAIN TO ACCOUNTS MASTER                                       LN0264
     C*                                                                   LN0264
     C           KEYACC    CHAINACCNT                41                   LN0264
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CP10                                           S01408
     C*                                                                   S01408
     C*                                                                   LN0264
     C*    ACCUMULATE LEDGER BALANCE FOR ACCOUNTS                         LN0264
     C           *IN41     IFEQ '0'                                       LN0264
     C           LDBL      DIV  1000      ZZAMT                           LN0264
     C                     Z-ADD2         X       10                      LN0264
     C                     EXSR HASH                                      LN0264
     C                     END                                            LN0264
     C*                                                                   LN0264
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CCP3                                           S01408
     C*                                                                   S01408
     C                     READ @A7REB9                  40               LN0264
     C                     END                                            LN0264
     C*                                                                   LN0264
0431 C*
     C/COPY WNCPYSRC,GL0540CPG4                                           S01408
     C*                                                                   S01408
0432 C*    APPLY DECIMAL PLACES TO ACCUMULATED AMOUNTS
0433 C********** NOTL2     TAG                             ** NOTL2 TAG **S01211
0434 C   L2                MOVE INT,2     CUMTT  100
0435 C   L2 71   CUMTT     DIV  10        CUMTT     H
0436 C   L2 72   CUMTT     DIV  100       CUMTT     H
0437 C   L2 73   CUMTT     DIV  1000      CUMTT     H
     C* CALCULATIONS DONE DEPENDING ON THE VALUE OF SPOT RATE AND
     C* MULT/DIV INDICATOR ,I.E. SPOT RATE NE ZERO
0438 C***L2N20 87CUMTT     DIV  SPOT      BCEQV     H                     S01194
     C   L2      A6SPRT    IFNE 0                                         S01194
     C           A6MDIN    ANDEQ'D'                                       S01194
     C   L2      CUMTT     DIV  A6SPRT    BCEQV     H                     S01194
     C                     END                                            S01194
0439 C***L2N20N87CUMTT     MULT SPOT      BCEQV     H                     S01194
     C   L2      A6SPRT    IFNE 0                                         S01194
     C           A6MDIN    ANDEQ'M'                                       S01194
     C   L2      CUMTT     MULT A6SPRT    BCEQV     H                     S01194
     C                     END                                            S01194
0440 C   L2                Z-ADD2         D       50
     C*                                                                   S01211
     C*----------------------------------------------------------------   S01211
     C*                                                                   S01211
     C/COPY WNCPYSRC,GL0540CPG5                                           S01408
     C* Apply decimal places to accumulated amounts                       S01408
     C*                                                                   S01408
     C           NOTL2     TAG                             ** NOTL2 TAG **S01211
0441 C*
0442 C*    OUTPUT HEADINGS
0443 C   L2
0444 COR OF                SETON                     4639
0445 C   46                EXCPT
0446 C                     SETOF                     46
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540LH1                                            S01408
     C*                                                                   S01408
0447 C*
0448 C  NL1                GOTO SETIND
0449 C*
     C***  CONVERT EVENT DATE
      *                                                                   CEU011
      ** If CEU011 is switched on,save the event date to                  CEU011
      ** Temporary variable.                                              CEU011
      *                                                                   CEU011
     C*          CEU011    IFEQ 'Y'                                CEU011 149411
     C*                    Z-ADDEDAT      EEDAT   50               CEU011 149411
     C*                    ENDIF                                   CEU011 149411
      *                                                                   CEU011
     C                     MOVE EDAT      ZDAYNO
0452 C                     EXSR ZDATE2
0453 C                     MOVE ZADATE    FFVDAN  7
0454 C*
     C****       EDAT      COMP RUND                 575657               S01194
     C           EDAT      COMP BJRDNB               575657               S01194
0457 C   56                GOTO SETIND
0458 C   45                GOTO TAG45
0459 C*
0460 C*    OUTPUT CALL, NOTICE AND OPENING BALANCE LINES
0461 C  N45                EXSR DEPS
0462 C  N45                SETON                     67
     C/COPY WNCPYSRC,GL0540C001
0463 C  N45                EXCPT
0464 C  N45                SETOF                     67
0465 C                     SETON                     45
0466 C           EDAT      COMP ENDDY                484747
0467 C   48                EXSR NXTDAY
0468 C                     GOTO SETIND
0469 C*
0470 C           TAG45     TAG                             ** TAG45 TAG **
0471 C*    THIS PART DONE IF NEW DATE EXCEEDS RUND AND CALL/NOTICE LINES
0472 C*    HAVE ALREADY BEEN OUTPUT
0473 C           EDAT      COMP ENDDY                484747
0474 C*
0475 C*    PERFORM S/R TO DIVIDE AND OUTPUT AMOUNTS
0476 C                     EXSR DIVOUT
0477 C*
0478 C*    OBTAIN START AND END DATES FOR NEXT PERIOD
0479 C   48                EXSR NXTDAY
0480 C           SETIND    TAG                             ** SETIND TAG *
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG6                                           S01408
     C*                                                                   S01408
0481 C                     MOVE FFVDAN    FFVDA   7
0482 C*
     C                     SETOF                       3637
0483 C*    CHECK FOR INTERNAL CONTRACT EVENT
0485 C*
0486 C*    CHECK SWAP LEG INDICATOR
0488 C*
     C*    CHECK FOR POSITION SWAP AND FIRST LEG INDICATOR IF DEAL EVENT
     C*
     C                     SETOF                       3637
0484 C   02      DTYP      COMP 'PS'                     37
0487 C   02      FSLI      COMP 1                        36
0489 C*
0490 C*    SET INDICATORS ACCORDING TO EVENT CODE
0491 C*
     C                     SETOF                     60                   S01129
     C           ETYP      IFEQ '31S1'                                    S01129
     C           ETYP      OREQ '39C1'                                    CSE007
     C           ETYP      OREQ '39D1'                                    CSE007
     C                     SETON                     60                   S01129
     C                     ELSE                                           S01129
     C                     MOVELETYP      WETYP   2                       S01129
     C           WETYP     IFEQ '31'                                      S01129
     C           CCIO      ANDEQ'I'                                       S01129
     C*                                                                   E20823
     C**  EXCLUDE COUPONS AND DIVIDENDS FROM PRINCIPAL COLUMN             E20823
     C           ETYP      ANDNE'31D2'                                    E20823
     C           ETYP      ANDNE'31D3'                                    E20823
     C           ETYP      ANDNE'31C2'                                    E20823
     C           ETYP      ANDNE'31C3'                                    E20823
     C*                                                                   E20823
     C                     SETON                     60                   S01129
     C           EAMT      IFLT 0                                         S01129
     C           EAMT      MULT -1        EAMT                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
0492 C*****      ETYP      COMP '15M1'                   60               S01129
0492 C  N60      ETYP      COMP '15M1'                   60               S01129
0493 C  N60      ETYP      COMP '15M4'                   60
0494 C  N60      ETYP      COMP '16V1'                   60
0495 C  N60      ETYP      COMP '16V3'                   60
0496 C  N60      ETYP      COMP '18M1'                   60
0497 C  N60      ETYP      COMP '17M1'                   60
     C  N60      ETYP      COMP '15MX'                   60               CEU003
     C  N60      ETYP      COMP '15MZ'                   60               CEU003
     C  N60      ETYP      COMP '16VX'                   60               CEU003
     C  N60      ETYP      COMP '16VZ'                   60               CEU003
     C  N60      ETYP      COMP '18MX'                   60               CEU003
     C  N60      ETYP      COMP '17MX'                   60               CEU003
0498 C  N60      ETYP      COMP '20V2'                   60
0499 C  N60      ETYP      COMP '41M3'                   60
0500 C  N60      ETYP      COMP '41R1'                   60
0501 C  N60      ETYP      COMP '41M1'                   60
0502 C  N60      ETYP      COMP '42M1'                   60
0503 C  N60      ETYP      COMP '41R4'                   60
     C  N60      ETYP      COMP '61R1'                   60
     C  N60      ETYP      COMP '61M1'                   60
     C  N60      ETYP      COMP '62R1'                   60
     C  N60      ETYP      COMP '62M1'                   60
     C  N60      ETYP      COMP '63M1'                   60
     C  N60      ETYP      COMP '64R1'                   60
     C  N60      ETYP      COMP '64M1'                   60
     C  N60      ETYP      COMP '65M1'                   60
     C  N60      ETYP      COMP '66V1'                   60
     C  N60      ETYP      COMP '67V1'                   60
     C  N60      ETYP      COMP '61RX'                   60               CEU003
     C  N60      ETYP      COMP '61MX'                   60               CEU003
     C  N60      ETYP      COMP '62RX'                   60               CEU003
     C  N60      ETYP      COMP '62MX'                   60               CEU003
     C  N60      ETYP      COMP '63MX'                   60               CEU003
     C  N60      ETYP      COMP '64RX'                   60               CEU003
     C  N60      ETYP      COMP '64MX'                   60               CEU003
     C  N60      ETYP      COMP '65MX'                   60               CEU003
     C  N60      ETYP      COMP '66VX'                   60               CEU003
     C  N60      ETYP      COMP '67VX'                   60               CEU003
     C  N60      ETYP      COMP '80M1'                   60
     C  N60      ETYP      COMP '81D1'                   60
     C  N60      ETYP      COMP '81M1'                   60
     C  N60      ETYP      COMP '81M3'                   60
     C  N60      ETYP      COMP '82A1'                   60
     C  N60      ETYP      COMP '82M1'                   60
     C  N60      ETYP      COMP '84V1'                   60
     C  N60      ETYP      COMP '84V2'                   60
     C  N60      ETYP      COMP '63R4'                   60               S01392
     C  N60      ETYP      COMP '30S1'                   60
     C  N60      ETYP      COMP '30C1'                   60
     C  N60      ETYP      COMP '30D1'                   60
     C  N60      ETYP      COMP '30M1'                   60
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN60     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68R1'                                    CLE005
     C           ETYP      OREQ '68M1'                                    CLE005
     C           ETYP      OREQ '68R7'                                    CLE005
     C           ETYP      OREQ '68R9'                                    CLE005
     C           ETYP      OREQ '69V1'                                    CLE005
     C           ETYP      OREQ '69V5'                                    CLE005
     C           ETYP      OREQ '69V7'                                    CLE005
     C********** ETYP      OREQ '72V1'                                                 CLE005 214232
     C********** ETYP      OREQ '72V5'                                                 CLE005 214232
     C********** ETYP      OREQ '72V7'                                                 CLE005 214232
     C                     SETON                     60                   CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN60     ANDEQ'0'                                       CLE004
     C           ETYP      IFEQ '61R7'                                    CLE004
     C           ETYP      OREQ '62R7'                                    CLE004
     C           ETYP      OREQ '63R7'                                    CLE004
     C           ETYP      OREQ '64R7'                                    CLE004
     C           ETYP      OREQ '65R7'                                    CLE004
     C           ETYP      OREQ '66V5'                                    CLE004
     C           ETYP      OREQ '67V5'                                    CLE004
     C                     SETON                     60                   CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           *IN60     ANDEQ'0'                                       CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C           *IN60     ANDEQ'0'                                       CEU020
     C           ETYP      IFEQ '61R9'                                    CLE006
     C           ETYP      OREQ '62R9'                                    CLE006
     C           ETYP      OREQ '63R9'                                    CLE006
     C           ETYP      OREQ '64R9'                                    CLE006
     C           ETYP      OREQ '65R9'                                    CLE006
     C           ETYP      OREQ '66V7'                                    CLE006
     C           ETYP      OREQ '67V7'                                    CLE006
     C                     SETON                     60                   CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CP13                                           S01408
     C*                                                                   S01408
     C**********                                                    S01119DT0021
     C**SET*INDICATOR*FOR*ACCUMULATION*OF*RECORD*AMOUNT             S01119DT0021
     C**********                                                    S01119DT0021
     C********** *IN60     IFEQ '0'                                 S01119DT0021
     C****       HEOCF     ANDEQ'Y'                                 S01119S01194
     C********** BQHEOC    ANDEQ'Y'                                 S01194DT0021
     C********** INOI      ANDEQ'I'                                 S01119DT0021
     C********** ETYP      COMP '21C1'                   60         S01119DT0021
     C**N60***** ETYP      COMP '21C2'                   60         S01119DT0021
     C**N60***** ETYP      COMP '22C1'                   60         S01119DT0021
     C**N60***** ETYP      COMP '22C2'                   60         S01119DT0021
     C**N60***** ETYP      COMP '23C1'                   60         S01119DT0021
     C**N60***** ETYP      COMP '23C2'                   60         S01119DT0021
     C**N60***** ETYP      COMP '24C1'                   60         S01119DT0021
     C**N60***** ETYP      COMP '24C2'                   60         S01119DT0021
     C**********           END                                      S01119DT0021
     C**********                                                    S01119DT0021
0504 C*
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           *IN60     ANDEQ*OFF                                      CIR003
     C           INOI      ANDEQ'I'                                       CIR003
      *                                                                   CIR003
     C           ETYP      IFEQ '23C3'                                    CIR003
     C           ETYP      OREQ '23C4'                                    CIR003
     C           ETYP      OREQ '23S3'                                    CIR003
     C           ETYP      OREQ '23S4'                                    CIR003
     C                     MOVE *ON       *IN60                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN60     ANDEQ*OFF                                                          CLE028
     C           ETYP      ANDEQ'80R1'                                                        CLE028
     C                     MOVE *ON       *IN60                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     SETOF                     61                   S01129
     C           ETYP      IFEQ '31P1'                                    S01129
     C                     SETON                     61                   S01129
     C                     MOVE CCIO      INOI                            088851
     C                     ELSE                                           S01129
     C                     MOVELETYP      WETYP                           S01129
     C           WETYP     IFEQ '31'                                      S01129
     C           CCIO      ANDEQ'O'                                       S01129
     C*                                                                   E20823
     C**  EXCLUDE COUPONS AND DIVIDENDS FROM PRINCIPAL COLUMN             E20823
     C           ETYP      ANDNE'31D2'                                    E20823
     C           ETYP      ANDNE'31D3'                                    E20823
     C           ETYP      ANDNE'31C2'                                    E20823
     C           ETYP      ANDNE'31C3'                                    E20823
     C*                                                                   E20823
     C                     SETON                     61                   S01129
     C           EAMT      IFLT 0                                         S01129
     C           EAMT      MULT -1        EAMT                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
0505 C*****      ETYP      COMP '15V1'                   61               S01129
0505 C  N61      ETYP      COMP '15V1'                   61               S01129
0506 C  N61      ETYP      COMP '15V3'                   61
0507 C  N61      ETYP      COMP '16M1'                   61
0508 C  N61      ETYP      COMP '16M4'                   61
0509 C  N61      ETYP      COMP '17V1'                   61
0510 C  N61      ETYP      COMP '17V3'                   61
     C  N61      ETYP      COMP '15VX'                   61               CEU003
     C  N61      ETYP      COMP '15VZ'                   61               CEU003
     C  N61      ETYP      COMP '16MX'                   61               CEU003
     C  N61      ETYP      COMP '16MZ'                   61               CEU003
     C  N61      ETYP      COMP '17VX'                   61               CEU003
     C  N61      ETYP      COMP '17VZ'                   61               CEU003
0511 C  N61      ETYP      COMP '20V1'                   61
0512 C  N61      ETYP      COMP '41S1'                   61
0513 C  N61      ETYP      COMP '41R3'                   61
0514 C  N61      ETYP      COMP '42S8'                   61
     C  N61      ETYP      COMP '61V1'                   61
     C  N61      ETYP      COMP '61V3'                   61
     C  N61      ETYP      COMP '62V1'                   61
     C  N61      ETYP      COMP '63V1'                   61
     C  N61      ETYP      COMP '64V1'                   61
     C  N61      ETYP      COMP '65V1'                   61
     C  N61      ETYP      COMP '66R1'                   61
     C  N61      ETYP      COMP '66M1'                   61
     C  N61      ETYP      COMP '67M1'                   61
     C  N61      ETYP      COMP '62V3'                   61               S01243
     C  N61      ETYP      COMP '64V3'                   61               S01243
     C  N61      ETYP      COMP '66V3'                   61               S01243
     C  N61      ETYP      COMP '61VX'                   61               CEU003
     C  N61      ETYP      COMP '61VZ'                   61               CEU003
     C  N61      ETYP      COMP '62VX'                   61               CEU003
     C  N61      ETYP      COMP '63VX'                   61               CEU003
     C  N61      ETYP      COMP '64VX'                   61               CEU003
     C  N61      ETYP      COMP '65VX'                   61               CEU003
     C  N61      ETYP      COMP '66RX'                   61               CEU003
     C  N61      ETYP      COMP '66MX'                   61               CEU003
     C  N61      ETYP      COMP '67MX'                   61               CEU003
     C  N61      ETYP      COMP '62VZ'                   61               CEU003
     C  N61      ETYP      COMP '64VZ'                   61               CEU003
     C  N61      ETYP      COMP '66VZ'                   61               CEU003
      *                                                                                       CLE028
     C           *IN12     IFEQ *OFF                                                          CLE028
     C  N61      ETYP      COMP '80M2'                   61
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C  N61      ETYP      COMP '81A2'                   61
     C  N61      ETYP      COMP '81P1'                   61
     C  N61      ETYP      COMP '81M2'                   61
     C  N61      ETYP      COMP '81M4'                   61
     C  N61      ETYP      COMP '82A2'                   61
     C  N61      ETYP      COMP '82M2'                   61
     C  N61      ETYP      COMP '84V3'                   61
     C  N61      ETYP      COMP '63R3'                   61               S01392
0515 C*
     C  N61      ETYP      COMP '30P1'                   61
     C  N61      ETYP      COMP '30C2'                   61
     C  N61      ETYP      COMP '30A1'                   61
     C  N61      ETYP      COMP '30D2'                   61
     C  N61      ETYP      COMP '30M2'                   61
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN61     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68V1'                                    CLE005
     C           ETYP      OREQ '68V3'                                    CLE005
     C           ETYP      OREQ '68V5'                                    CLE005
     C           ETYP      OREQ '68V7'                                    CLE005
     C           ETYP      OREQ '69R1'                                    CLE005
     C           ETYP      OREQ '69M1'                                    CLE005
     C           ETYP      OREQ '69V3'                                    CLE005
     C           ETYP      OREQ '69R7'                                    CLE005
     C           ETYP      OREQ '69R9'                                    CLE005
     C********** ETYP      OREQ '72R1'                                                 CLE005 214232
     C********** ETYP      OREQ '72M1'                                                 CLE005 214232
     C********** ETYP      OREQ '72V3'                                                 CLE005 214232
     C********** ETYP      OREQ '72R7'                                                 CLE005 214232
     C********** ETYP      OREQ '72R9'                                                 CLE005 214232
     C                     SETON                         61               CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN61     ANDEQ'0'                                       CLE004
     C           ETYP      IFEQ '61V5'                                    CLE004
     C           ETYP      OREQ '62V5'                                    CLE004
     C           ETYP      OREQ '63V5'                                    CLE004
     C           ETYP      OREQ '64V5'                                    CLE004
     C           ETYP      OREQ '65V5'                                    CLE004
     C           ETYP      OREQ '66R7'                                    CLE004
     C           ETYP      OREQ '67R7'                                    CLE004
     C                     SETON                         61               CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           *IN61     ANDEQ'0'                                       CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C           *IN61     ANDEQ'0'                                       CEU020
     C           ETYP      IFEQ '61V7'                                    CLE006
     C           ETYP      OREQ '62V7'                                    CLE006
     C           ETYP      OREQ '63V7'                                    CLE006
     C           ETYP      OREQ '64V7'                                    CLE006
     C           ETYP      OREQ '65V7'                                    CLE006
     C           ETYP      OREQ '66R9'                                    CLE006
     C           ETYP      OREQ '67R9'                                    CLE006
     C                     SETON                         61               CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CP11                                           S01408
     C*                                                                   S01408
     C**********                                                    S01119DT0021
     C**SET*INDICATOR*FOR*ACCUMULATION*OF*RECORD*AMOUNT             S01119DT0021
     C**********                                                    S01119DT0021
     C********** *IN61     IFEQ '0'                                 S01119DT0021
     C****       HEOCF     ANDEQ'Y'                                 S01119S01194
     C********** BQHEOC    ANDEQ'Y'                                 S01194DT0021
     C********** INOI      ANDEQ'O'                                 S01119DT0021
     C********** ETYP      COMP '21C1'                   61         S01119DT0021
     C**N61***** ETYP      COMP '21C2'                   61         S01119DT0021
     C**N61***** ETYP      COMP '22C1'                   61         S01119DT0021
     C**N61***** ETYP      COMP '22C2'                   61         S01119DT0021
     C**N61***** ETYP      COMP '23C1'                   61         S01119DT0021
     C**N61***** ETYP      COMP '23C2'                   61         S01119DT0021
     C**N61***** ETYP      COMP '24C1'                   61         S01119DT0021
     C**N61***** ETYP      COMP '24C2'                   61         S01119DT0021
     C**********           END                                      S01119DT0021
     C**********                                                    S01119DT0021
     C*
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           *IN61     ANDEQ*OFF                                      CIR003
     C           INOI      ANDEQ'O'                                       CIR003
      *                                                                   CIR003
     C           ETYP      IFEQ '23C3'                                    CIR003
     C           ETYP      OREQ '23C4'                                    CIR003
     C           ETYP      OREQ '23S3'                                    CIR003
     C           ETYP      OREQ '23S4'                                    CIR003
     C                     MOVE *ON       *IN61                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN61     ANDEQ*OFF                                                          CLE028
     C           ETYP      ANDEQ'80V1'                                                        CLE028
     C                     MOVE *ON       *IN61                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           CER049    IFEQ 'Y'                                                           CER049
     C           *IN61     ANDEQ*OFF                                                          CER049
     C           ETYP      ANDEQ'49ST'                                                        CER049
     C                     MOVE *ON       *IN61                                               CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
0516 C           ETYP      COMP '15I2'                   62
0517 C  N62      ETYP      COMP '15M2'                   62
0518 C  N62      ETYP      COMP '17I2'                   62
0519 C  N62      ETYP      COMP '17M2'                   62
     C  N62      ETYP      COMP '15IY'                   62               CEU003
     C  N62      ETYP      COMP '15MY'                   62               CEU003
     C  N62      ETYP      COMP '17IY'                   62               CEU003
     C  N62      ETYP      COMP '17MY'                   62               CEU003
0520 C  N62      ETYP      COMP '20V3'                   62
0521 C  N62      ETYP      COMP '41I2'                   62
0522 C  N62      ETYP      COMP '41M4'                   62
0523 C  N62      ETYP      COMP '41R2'                   62
0524 C  N62      ETYP      COMP '41M2'                   62
     C  N62      ETYP      COMP '61R2'                   62
     C  N62      ETYP      COMP '61M2'                   62
     C  N62      ETYP      COMP '61I2'                   62
     C  N62      ETYP      COMP '62R2'                   62
     C  N62      ETYP      COMP '62M2'                   62
     C  N62      ETYP      COMP '62I2'                   62
     C  N62      ETYP      COMP '64I2'                   62
     C  N62      ETYP      COMP '64R2'                   62
     C  N62      ETYP      COMP '64M2'                   62
     C  N62      ETYP      COMP '70I2'                   62
     C  N62      ETYP      COMP '70M2'                   62
     C  N62      ETYP      COMP '61RY'                   62               CEU003
     C  N62      ETYP      COMP '61MY'                   62               CEU003
     C  N62      ETYP      COMP '61IY'                   62               CEU003
     C  N62      ETYP      COMP '62RY'                   62               CEU003
     C  N62      ETYP      COMP '62MY'                   62               CEU003
     C  N62      ETYP      COMP '62IY'                   62               CEU003
     C  N62      ETYP      COMP '64IY'                   62               CEU003
     C  N62      ETYP      COMP '64RY'                   62               CEU003
     C  N62      ETYP      COMP '64MY'                   62               CEU003
     C  N62      ETYP      COMP '70IY'                   62               CEU003
     C  N62      ETYP      COMP '70MY'                   62               CEU003
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN62     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68R2'                                    CLE005
     C           ETYP      OREQ '68M2'                                    CLE005
     C           ETYP      OREQ '68I2'                                    CLE005
     C           ETYP      OREQ '71M2'                                    CLE005
     C           ETYP      OREQ '71I2'                                    CLE005
     C                     SETON                         62               CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CP12                                           S01408
     C*                                                                   S01408
     C*                                                                   045634
     C* Add the Lending fee processing types here to be included in       045634
     C* as part of the interest income reporting                          045634
     C*                                                                   045634
     C  N62      ETYP      COMP '71F1'                   62               045634
     C  N62      ETYP      COMP '71F2'                   62               045634
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           *IN62     ANDEQ*OFF                                                          CAS009
      *                                                                                       CAS009
     C           ETYP      IFEQ '15F1'                                                        CAS009
     C           ETYP      OREQ '17F1'                                                        CAS009
     C                     MOVE *ON       *IN62                                               CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C*                                                                   S01119
     C* SET INDICATOR FOR ADDITION OF RECORD AMOUNT                       S01119
     C*                                                                   S01119
     C           *IN62     IFEQ '0'                                       S01119
     C           INOI      ANDEQ'I'                                       S01119
     C           ETYP      COMP '21I1'                   62               S01119
     C  N62      ETYP      COMP '22I1'                   62               S01119
     C  N62      ETYP      COMP '23I1'                   62               S01119
     C  N62      ETYP      COMP '24I1'                   62               S01119
     C  N62      ETYP      COMP '21IX'                   62               CEU003
     C  N62      ETYP      COMP '22IX'                   62               CEU003
     C  N62      ETYP      COMP '23IX'                   62               CEU003
     C  N62      ETYP      COMP '24IX'                   62               CEU003
     C                     END                                            S01119
     C*                                                                   S01119
     C********** *IN62     IFEQ '0'                                 S01119DT0021
     C********** INOI      ANDEQ'I'                                 S01119DT0021
     C****       HEOCF     ANDEQ'Y'                                 S01119S01194
     C********** BQHEOC    ANDEQ'Y'                                 S01194DT0021
     C********** ETYP      COMP '21C3'                   62         S01119DT0021
     C**********           END                                      S01119DT0021
     C*                                                                   E20823
     C           *IN62     IFEQ '0'                                       E20823
     C           CCIO      ANDEQ'I'                                       E20823
     C           ETYP      COMP '31D2'                   62               E20823
     C  N62      ETYP      COMP '31D3'                   62               E20823
     C  N62      ETYP      COMP '31C2'                   62               E20823
     C  N62      ETYP      COMP '31C3'                   62               E20823
     C                     END                                            E20823
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN12     ANDEQ*ON                                                           CLE028
     C           *IN62     ANDEQ*OFF                                                          CLE028
      *                                                                                       CLE028
     C           ETYP      IFEQ '80R2'                                                        CLE028
     C           ETYP      OREQ '80M2'                                                        CLE028
     C                     MOVE *ON       *IN62                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
     C*                                                                   CIR001
     C** Up-Front and Buy-Out                                             CIR001
     C*                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C*                                                                   CIR001
     C                     MOVE '0'       *IN63                           CIR001
     C           ETYP      IFEQ '22FE'                                    CIR001
     C           ETYP      OREQ '23FE'                                    CIR001
     C           ETYP      OREQ '24FE'                                    CIR001
     C           ETYP      OREQ '22BO'                                    CIR001
     C           ETYP      OREQ '23BO'                                    CIR001
     C           ETYP      OREQ '24BO'                                    CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           INOI      IFEQ 'I'                                       CIR001
     C                     MOVE '1'       *IN62                           CIR001
     C                     MOVE '0'       *IN63                           CIR001
     C                     ELSE                                           CIR001
     C           INOI      IFEQ 'O'                                       CIR001
     C                     MOVE '0'       *IN62                           CIR001
     C                     MOVE '1'       *IN63                           CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           *IN63     IFEQ '0'                                       CIR001
     C           ETYP      ANDEQ'16I2'                                    CIR001
     C           *IN63     OREQ '0'                                       CEU003
     C           ETYP      ANDEQ'16IY'                                    CEU003
     C                     MOVE '1'       *IN63                           CIR001
     C                     END                                            CIR001
     C                     ELSE                                           CIR001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CCP8                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
0525 C*
0526 C           ETYP      COMP '16I2'                   63
     C  N63      ETYP      COMP '16IY'                   63               CEU003
     C                     END                                            CIR001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CCP9                                           S01408
     C*                                                                   S01408
0527 C  N63      ETYP      COMP '20V4'                   63
0528 C  N63      ETYP      COMP '16M2'                   63
     C  N63      ETYP      COMP '66I2'                   63
     C  N63      ETYP      COMP '66R2'                   63
     C  N63      ETYP      COMP '66M2'                   63
     C  N63      ETYP      COMP '63R5'                   63               S01392
     C  N63      ETYP      COMP '16MY'                   63               CEU003
     C  N63      ETYP      COMP '66IY'                   63               CEU003
     C  N63      ETYP      COMP '66RY'                   63               CEU003
     C  N63      ETYP      COMP '66MY'                   63               CEU003
     C  N63      ETYP      COMP '63RZ'                   63               CEU003
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN63     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '69I2'                                    CLE005
     C           ETYP      OREQ '69R2'                                    CLE005
     C           ETYP      OREQ '69M2'                                    CLE005
     C           ETYP      OREQ '72I2'                                    CLE005
     C           ETYP      OREQ '72R2'                                    CLE005
     C           ETYP      OREQ '72M2'                                    CLE005
     C                     SETON                         63               CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           *IN63     ANDEQ*OFF                                                          CAS009
      *                                                                                       CAS009
     C           ETYP      IFEQ '16F1'                                                        CAS009
     C                     MOVE *ON       *IN63                                               CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C*                                                                   S01119
     C* SET INDICATOR FOR SUBTRACTION OF RECORD AMOUNT                    S01119
     C*                                                                   S01119
     C           *IN63     IFEQ '0'                                       S01119
     C           INOI      ANDEQ'O'                                       S01119
     C           ETYP      COMP '21I1'                   63               S01119
     C  N63      ETYP      COMP '22I1'                   63               S01119
     C  N63      ETYP      COMP '23I1'                   63               S01119
     C  N63      ETYP      COMP '24I1'                   63               S01119
     C  N63      ETYP      COMP '21IX'                   63               CEU003
     C  N63      ETYP      COMP '22IX'                   63               CEU003
     C  N63      ETYP      COMP '23IX'                   63               CEU003
     C  N63      ETYP      COMP '24IX'                   63               CEU003
     C                     END                                            S01119
     C*                                                                   S01119
     C********** *IN63     IFEQ '0'                                 S01119DT0021
     C********** INOI      ANDEQ'I'                                S01119 S01211
     C********** INOI      ANDEQ'O'                                 S01211DT0021
     C****       HEOCF     ANDEQ'Y'                                 S01119S01194
     C********** BQHEOC    ANDEQ'Y'                                 S01194DT0021
     C********** ETYP      COMP '21C3'                   63         S01119DT0021
     C**********           END                                      S01119DT0021
     C*                                                                   E20823
     C           *IN62     IFEQ '0'                                       E20823
     C           CCIO      ANDEQ'I'                                       E20823
     C           ETYP      COMP '31D2'                   62               E20823
     C  N62      ETYP      COMP '31D3'                   62               E20823
     C  N62      ETYP      COMP '31C2'                   62               E20823
     C  N62      ETYP      COMP '31C3'                   62               E20823
     C                     END                                            E20823
     C*                                                                   E20823
     C           *IN63     IFEQ '0'                                       E20823
     C           CCIO      ANDEQ'O'                                       E20823
     C           ETYP      COMP '31D2'                   63               E20823
     C  N63      ETYP      COMP '31D3'                   63               E20823
     C  N63      ETYP      COMP '31C2'                   63               E20823
     C  N63      ETYP      COMP '31C3'                   63               E20823
     C                     END                                            E20823
0529 C*
0530 C           ETYP      COMP '11V1'                   64
0531 C  N64      ETYP      COMP '12V1'                   64
0532 C  N64      ETYP      COMP '13V1'                   64
0533 C  N64      ETYP      COMP '14V1'                   64
     C  N64      ETYP      COMP '11VX'                   64               CEU003
     C  N64      ETYP      COMP '12VX'                   64               CEU003
     C  N64      ETYP      COMP '13VX'                   64               CEU003
     C  N64      ETYP      COMP '14VX'                   64               CEU003
0529 C*                                                                   S01127
0530 C  N64      ETYP      COMP '94V1'                   64               S01127
0531 C  N64      ETYP      COMP '95V1'                   64               S01127
0532 C  N64      ETYP      COMP '96V1'                   64               S01127
0533 C  N64      ETYP      COMP '97V1'                   64               S01127
0532 C  N64      ETYP      COMP '98V1'                   64               S01127
0533 C  N64      ETYP      COMP '99V1'                   64               S01127
0534 C*
0535 C           ETYP      COMP '11V2'                   65
0536 C  N65      ETYP      COMP '12V2'                   65
0537 C  N65      ETYP      COMP '13V2'                   65
0538 C  N65      ETYP      COMP '14V2'                   65
     C  N65      ETYP      COMP '11VY'                   65               CEU003
     C  N65      ETYP      COMP '12VY'                   65               CEU003
     C  N65      ETYP      COMP '13VY'                   65               CEU003
     C  N65      ETYP      COMP '14VY'                   65               CEU003
0534 C*                                                                   S01127
0535 C  N65      ETYP      COMP '94V2'                   65               S01127
0536 C  N65      ETYP      COMP '95V2'                   65               S01127
0537 C  N65      ETYP      COMP '96V2'                   65               S01127
0536 C  N65      ETYP      COMP '97V2'                   65               S01127
0537 C  N65      ETYP      COMP '98V2'                   65               S01127
0538 C  N65      ETYP      COMP '99V2'                   65               S01127
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN53     ANDEQ'1'                                                           CAP204
      *                                                                                       CAP204
     C           INOI      IFEQ 'I'                                                           CAP204
     C                     SETON                     64                                       CAP204
     C                     ELSE                                                               CAP204
     C                     SETON                     65                                       CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C*                                                                   S03220
     C* IF THE RECORD IS FROM FPVNT                                       S03220
     C* AND THE TYPE IS NOT EQUAL TO '91P7'                               S03220
     C*    ADD TO FX PURCH'S (64) OR                                      S03220
     C*    ADD TO FX SALES   (65)                                         S03220
     C*                                                                   S03220
     C           *IN51     IFEQ '1'                        ## B001        S03220
     C           ETYP      ANDNE'91P7'                                    S03220
     C*                                                                   S03220
     C           INOI      IFEQ 'I'                        ## B002        S03220
     C                     SETON                     64                   S03220
     C                     ELSE                            ## X002        S03220
     C                     SETON                     65                   S03220
     C                     END                             ## E002        S03220
     C                     END                             ## E001        S03220
     C*                                                                   073714
     C* IF THE EVENT TYPE REPRESENTS FUTURES & OPTIONS PREMIUM PAYABLE    073714
     C*    ADD TO FX PURCH'S (64) OR                                      073714
     C*    ADD TO FX SALES   (65)                                         073714
     C*                                                                   073714
     C           ETYP      IFEQ '93V1'                     ## B001        073714
     C           INOI      IFEQ 'I'                        ## B002        073714
     C                     SETON                     64                   073714
     C                     ELSE                            ## X002        073714
     C                     SETON                     65                   073714
     C                     END                             ## E002        073714
     C                     END                             ## E001        073714
     C**********                                                    S01119DT0021
     C**SET*TRANSACTION*TYPE*MARKER*FOR*FRA/IRS*IF*HEDGED*EVENTS    S01119DT0021
     C**ARE*TO*BE*REPORTED                                          S01119DT0021
     C**********                                                    S01119DT0021
     C****       HEOCF     IFEQ 'Y'                                 S01119S01194
     C********** BQHEOC    IFEQ 'Y'                                 S01194DT0021
     C********** ETYP      IFEQ '21C1'                              S01119DT0021
     C********** ETYP      OREQ '21C2'                              S01119DT0021
     C********** ETYP      OREQ '21C3'                              S01119DT0021
     C**********           MOVE 'FRA'     HMKR    3                 S01119DT0021
     C**********           END                                      S01119DT0021
     C**********                                                    S01119DT0021
     C********** ETYP      IFEQ '22C1'                              S01119DT0021
     C********** ETYP      OREQ '22C2'                              S01119DT0021
     C********** ETYP      OREQ '23C1'                              S01119DT0021
     C********** ETYP      OREQ '23C2'                              S01119DT0021
     C**********           MOVE 'IRS'     HMKR                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********                                                    S01119DT0021
     C********** ETYP      IFEQ '24C1'                              S01119DT0021
     C********** ETYP      OREQ '24C2'                              S01119DT0021
     C******************   MOVE 'IRL'     HMKR                      S01119S01157
     C**********           MOVE 'CCF'     HMKR                      S01157DT0021
     C**********           END                                      S01119DT0021
     C**SET*UP*FRA/IRS*TYPE*MARKER*ON*DETAIL*LINE                   S01119DT0021
     C********** HMKR      IFNE *BLANK                              S01119DT0021
     C********** MKR       IFEQ *BLANK                              S01119DT0021
     C**********           MOVE HMKR      MKR     3                 S01119DT0021
     C**********           ELSE                                     S01119DT0021
     C********** HMKR      IFNE MKR                                 S01119DT0021
     C**********           MOVE 'F/I'     MKR                       S01119DT0021
     C**********           END                                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********           MOVE *BLANK    HMKR                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********                                                    S01119DT0021
     C* TEST FOR MULTIBRANCH AND PURCH/IN, SALES/OUT TO ENSURE OUTPUT       E175
     C* IS IN CORRECT COLUMN                                                E175
     C*                                                                     E175
     C           IBRE      IFEQ 'Y'                                         E175
     C*                                                                     E175
     C           *IN60     IFEQ '1'                                         E175
     C           INOI      ANDEQ'O'                                         E175
     C                     SETON                     61                     E175
     C                     SETOF                     60                     E175
     C                     END                                              E175
     C*                                                                     E175
     C           *IN61     IFEQ '1'                                         E175
     C           INOI      ANDEQ'I'                                         E175
     C                     SETON                     60                     E175
     C                     SETOF                     61                     E175
     C                     END                                              E175
     C*                                                                     E175
     C           *IN64     IFEQ '1'                                         E175
     C           INOI      ANDEQ'O'                                         E175
     C                     SETON                     65                     E175
     C                     SETOF                     64                     E175
     C                     END                                              E175
     C*                                                                     E175
     C           *IN65     IFEQ '1'                                         E175
     C           INOI      ANDEQ'I'                                         E175
     C                     SETON                     64                     E175
     C                     SETOF                     65                     E175
     C                     END                                              E175
     C*                                                                     E175
     C                     END                                              E175
     C*                                                                     E175
0539 C   60                MOVE 1         I       10
0540 C   61                MOVE 2         I
0541 C   62
0542 COR 63                MOVE 3         I
0543 C   64                MOVE 4         I
0544 C   65                MOVE 5         I
0545 C*
0546 C*    REVERSE SIGN OF AMOUNT IF '16I2' OR '16M2'
0547 C*    OR '20V3'
     C*    OR '66I2' OR '66R2' OR '66M2'
      *                                                                   099250
      ** If multibranching event, do not reverse event amount             099250
      *                                                                   099250
     C           IBRE      IFNE 'Y'                                       099250
0548 C   63                Z-SUBEAMT      EAMT
     C                     ELSE                                           099250
     C   63                Z-ADDEAMT      EAMT                            099250
     C                     END                                            099250
0549 C*
0550 C*    ONLY PRIMARY CD. REQUIRES EVENT TYPE 17V1 TO APPEAR ON REPORT
     C                     SETOF                       5859
0551 C   61 02   ETYP      COMP '17V1'                   58
     C   61 02N58ETYP      COMP '17VX'                   58               CEU003
0552 C   61 02   DTYP      COMP 'C1'                     59
0553 C   61 58N59          SETOF                     61
0554 C*
0555 C*    ADD EVENT AMOUNT INTO CALL OR NOTICE ACCUMULATORS
0556 C   55 60   CALLI     ADD  EAMT      CALLI  130
0557 C   55 61   CALLO     ADD  EAMT      CALLO  130
0558 C  N55 56 60NOTICI    ADD  EAMT      NOTICI 130
0559 C  N55 56 61NOTICO    ADD  EAMT      NOTICO 130
0560 C*
0561 C  N60N61N62
0562 CANN63N64N65          GOTO END
     C*
     C*
     C           ETYP      COMP '30C1'                   69
     C  N69      ETYP      COMP '30C2'                   69
     C  N69                GOTO NOTCPN
     C*
     C                     ADD  EAMT      ACC,3
     C                     GOTO END
     C           NOTCPN    TAG
     C*
0563 C*
0564 C*    UPDATE DEPOSITS AND F/X FOR INTERNAL CONTRACTS
0565 C   37 36   ACC,I     ADD  EAMT      ACC,I
0566 C   37N36   ACC,I     ADD  ICAM      ACC,I
0567 C   37 60   I         ADD  4         I
0568 C   37 61   I         ADD  2         I
     C*                                                                   S01392
     C* IF FRONT-UP INTEREST = Y INCLUDE INTEREST ON VALUE DATE EVENT     S01392
     C*                                                                   S01392
     C   02      FUID      IFEQ 'Y'                                       S01392
     C           ETYP      IFEQ '15V1'                                    S01392
     C           ETYP      OREQ '15VX'                                    CEU003
     C                     ADD  OTHA      ACC,3                           S01392
     C                     END                                            S01392
     C           ETYP      IFEQ '16V1'                                    S01392
     C           ETYP      OREQ '16VX'                                    CEU003
     C                     SUB  OTHA      ACC,3                           S01392
     C                     END                                            S01392
     C                     END                                            S01392
0569 C*
0570 C  N55 57   ACC,I     ADD  EAMT      ACC,I
0571 C*
0572 C           END       TAG                             ** END TAG **
0573 C*
0597 C*
0598 C*    PROCESS DEALING AND COMMERCIAL LOANS TRAILER RECORDS
     C*    AND FINANCIAL FUTURE TRAILER RECORD                            S01127
0599 C*    AND THEN CHECK RUN CONTROL, CONTROLS.
0601 C*
     C******     *IN03     IFEQ '1'                                       S01153
     C******               SETON                     24                   S01153
     C******               Z-ADDHRWN      ZZTOTI                          S01153
     C******               Z-ADDHRDC      ZZTOTD                          S01153
     C******               Z-ADDNORE      NORED   50                      S01153
     C******               END                                            S01153
0597 C*
     C***FINANCIAL*FUTURE                                                 S01127
     C******     *IN14     IFEQ '1'                                       S01127
     C******               Z-ADDHRWN      ZZAMTI                          S01127
     C******               Z-ADDHRDC      ZZAMTD                          S01127
     C******               EXSR GLZSUM                                    S01127
     C******     NORE      ADD  NORED     NORED                           S01127
     C******               END                                      S01127S01153
     C*                                                             S01127S01153
     C******     *IN23     IFEQ '1'                                       S01153
     C******               Z-ADDHRWN      ZZAMTI                          S01153
     C******               Z-ADDHRDC      ZZAMTD                          S01153
     C******               EXSR GLZSUM                                    S01153
     C******     NORE      ADD  NORED     NORED                           S01153
     C******     NORED     SUB  1         NORED                           S01153
     C******               END                                            S01153
     C*
     C******     *IN15     IFEQ '1'                                       S01153
     C******               Z-ADDHRWN      ZZAMTI                          S01153
     C******               Z-ADDHRDC      ZZAMTD                          S01153
     C******               EXSR GLZSUM                                    S01153
     C******     NORE      ADD  NORED     NORED                           S01153
     C******     NORED     SUB  1         NORED                           S01153
     C******               END                                            S01153
     C******TERS OF CREDIT                                                S01153
     C******     *IN17     IFEQ '1'                                       S01153
     C******               Z-ADDHRWN      ZZAMTI                          S01153
     C******               Z-ADDHRDC      ZZAMTD                          S01153
     C******               EXSR GLZSUM                                    S01153
     C******     NORE      ADD  NORED     NORED                           S01153
     C******     NORED     SUB  1         NORED                           S01153
     C******               END                                            S01153
     C******URITIES TRADING                                               S01153
     C******     *IN19     IFEQ '1'                                       S01153
     C******     *IN24     IFEQ '1'                                 S01129S01153
     C******               Z-ADDHRWN      ZZAMTI                          S01153
     C******               Z-ADDHRDC      ZZAMTD                          S01153
     C******               EXSR GLZSUM                                    S01153
     C******               ELSE                                     S01129S01153
     C******               Z-ADDHRWN      ZZTOTI                    S01129S01153
     C******               Z-ADDHRDC      ZZTOTD                    S01129S01153
     C******               END                                      S01129S01153
     C******     NORE      ADD  NORED     NORED                           S01153
     C******               END                                            S01153
     C******                                                              S01153
     C***FUNDS*TRANSFER                                             S03220S01153
     C******     *IN52     IFEQ '1'                                 S03220S01153
     C******               Z-ADDHRWN      ZZAMTI                    S03220S01153
     C******               Z-ADDHRDC      ZZAMTD                    S03220S01153
     C******               EXSR GLZSUM                              S03220S01153
     C******     NORE      ADD  NORED     NORED                     S03220S01153
     C******               END                                      S03220S01153
     C*
      *                                                                   S01473
      ** If Leo events are being processed, check the Leo record          S01473
      ** read flag                                                        S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULREC     ANDEQ'Y'                                       S01473
      *                                                                   S01473
      ** Reset LEO record read flag                                       S01473
     C                     MOVE *BLANK    ULREC                           S01473
     C                     END                                            S01473
     CL1         CEU011    IFEQ 'Y'                                       149411
     CL1                   MOVE ECCY      ECCYB   3                       149411
     CL1                   Z-ADDEDAT      EEDAT   50                      149411
     CL1                   ENDIF                                          149411
      *                                                                   S01473
      ** For a change of currency (L2 on), check if Leo records are       S01473
      ** being processed, and a Leo record hasn't been read, OR if        S01473
      ** Leo records are not being processed. If either of these          S01473
      ** condition are met, perform the BYEXC check, else miss out        S01473
      ** the BYEXC check                                                  S01473
     CL2         ULEO      IFEQ 'Y'                                       S01473
     CL2         ULREC     ANDEQ'N'                                       S01473
     CL2         ULEO      ORNE 'Y'                                       S01473
      *                                                                   S01473
     C**   IF NO DETAILS READ - BYPASS EXCEPTION OUTPUT
     CL2N02N12N13
     C*NN16N18****         GOTO BYEXC                                     S01129
     C**N16N18N81                                                   S01129S01196
     C*ANN18N81************                                   S01129S01196E20669
     CANN81                                                               E20669
     CANN04                                                               S01127
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG7                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C*ANN83N85N88          GOTO BYEXC                             S01129 E20669
     CANN83N85             GOTO BYEXC                                     E20669
      *                                                                   S01473
     CL2                   END                                            S01473
0597 C*
0574 C*    OPERATIONS ON CHANGE OF CURRENCY
0575 C*
0576 C*
0577 C*    OUTPUT CALL, NOTICE AND OPENING BALANCE LINES
0578 C*    IF NOT ALREADY PRINTED FOR THIS CURRENCY
0579 CL2N45                EXSR DEPS
0580 CL2N45                SETON                     67
0581 CL2N45                EXCPT
     C/COPY WNCPYSRC,GL0540C002
0582 CL2N45                SETOF                     67
     CL2         BYEXC     TAG                             ** BYEXC TAG **
0583 C*
0584 C*
0585 C*    OUTPUT DETAILS FOR LAST RECORD OF PREVIOUS GROUP
0586 CL2 45                SETOF                     47
0587 CL2 45                SETON                     48
0588 CL2 45                EXSR DIVOUT
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CP1                                            S01408
     C*                                                                   S01408
0589 C*
0590 C*    CLEAR ACCUMULATORS
0591 CL2                   Z-ADD0         CALLI
0592 CL2                   Z-ADD0         CALLO
0593 CL2                   Z-ADD0         NOTICI
0594 CL2                   Z-ADD0         NOTICO
0595 CL2                   EXSR PEREND
0596 CL2                   SETOF                     45
     C/EJECT                                                              S01129
0599 C*
0598 C*    LAST CYCLE CALCS
0599 C*
      ****Read*Securities*Trading 2 Audit files and print separate  S01129S01153
      *****totals                                                   S01129S01153
      ***********                                                   S01129S01153
     C*R**********INU5     IFEQ '0'                                 S01129S01153
      ***********                                                   S01129S01153
     C*R*********          Z-ADD0         HRWN                      S01129S01153
     C*R*********          Z-ADD0         HRDC                      S01129S01153
     C*R*********          Z-ADD0         NORE                      S01129S01153
      ***********                                                   S01129S01153
      ***Save*previous accumulater values.                          S01129S01153
      ***********                                                   S01129S01153
     C*R*********          Z-ADDZZTOTI    #TOTI  150                S01129S01153
     C*R*********          Z-ADDZZTOTD    #TOTD   30                S01129S01153
      ***********                                                   S01129S01153
      ***Read*all Audit files.                                      S01129S01153
      ***********                                                   S01129S01153
     C*R*********1         CHAINTREVEAF              82             S01129S01153
     C*R*********          Z-ADDHRWN      ZZTOTI                    S01129S01153
     C*R*********          Z-ADDHRDC      ZZTOTD                    S01129S01153
     C*R*********          Z-ADDNORE      #SEREC  50                S01129S01153
      ***********                                                   S01129S01153
     C*R*********1         CHAINCPEVEAF              82             S01129S01153
     C*R**********IN82     IFEQ '0'                                 S01129S01153
     C*R*********          Z-ADDHRWN      ZZAMTI                    S01129S01153
     C*R*********          Z-ADDHRDC      ZZAMTD                    S01129S01153
     C*R*********          EXSR GLZSUM                              S01129S01153
     C*R*********          ADD  NORE      #SEREC                    S01129S01153
     C*R*********          END                                      S01129S01153
      ***********                                                   S01129S01153
     C*R*********1         CHAINDPEVEAF              82             S01129S01153
     C*R**********IN82     IFEQ '0'                                 S01129S01153
     C*R*********          Z-ADDHRWN      ZZAMTI                    S01129S01153
     C*R*********          Z-ADDHRDC      ZZAMTD                    S01129S01153
     C*R*********          EXSR GLZSUM                              S01129S01153
     C*R*********          ADD  NORE      #SEREC                    S01129S01153
     C*R*********          END                                      S01129S01153
      ***********                                                   S01129S01153
     C*R*********1         CHAINBPEVEAF              82             S01129S01153
     C*R**********IN82     IFEQ '0'                                 S01129S01153
     C*R*********          Z-ADDHRWN      ZZAMTI                    S01129S01153
     C*R*********          Z-ADDHRDC      ZZAMTD                    S01129S01153
     C*R*********          EXSR GLZSUM                              S01129S01153
     C*R*********          ADD  NORE      #SEREC                    S01129S01153
     C*R*********          END                                      S01129S01153
      ***********                                                   S01129S01153
     C*R*********          Z-ADDZZTOTI    #SETI  150                S01129S01153
     C*R*********          Z-ADDZZTOTD    #SETD   30                S01129S01153
     C*R*********          END                                      S01129S01153
     C/EJECT
0599 C*
0600 C*    CHECK DEALING FILE CONTROL CONTROLS
0601 C*
0602 C*
0603 C*    CHECK COMMERCIAL LOANS FILE CONTROLS
0604 C*
0605 C*R 79
0606 C*
0607 C*R 79
      *                                                             S01129S01153
      ***Restore*previousely saved accumulator values               S01129S01153
      ***********                                                   S01129S01153
     C*R**********INU5     IFEQ '0'                                 S01129S01153
     C*R*********          Z-ADD#TOTI     ZZTOTI                    S01129S01153
     C*R*********          Z-ADD#TOTD     ZZTOTD                    S01129S01153
     C*R*********          END                                      S01129S01153
      ***********                                                   S01129S01153
     C**LR**               Z-ADDZZTOTI    HRWN                            S01153
     C**LR**               Z-ADDZZTOTD    HRDC                            S01153
     C**LR**               Z-ADDNORED     NORE                            S01153
0608 C**LR**     INT,1     COMP HRWN                 U8U8                 S01153
0609 C**NU8      DEC,1     COMP HRDC                 U8U8                 S01153
0610 C**NU8      RECRED    COMP NORE                 U8U8                 S01153
     C*
     C*   TOTAL TIME CALCULATIONS
     C*
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     C** ALSO AU FILE RECORDS 'NO DETAILS 'IF P1 NOT WRITTEN TO
     CLR                   MOVE '0'       *IN25                           S01117
      *                                                                   CEU011
      ** Check if CEU011 is on.                                           CEU011
      *                                                                   CEU011
     CLR         CEU011    IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
     CLR                   EXSR PEREND                                    CEU011
     CLR                   EXSR P01                                       CEU011
     CLR                   ENDIF                                          CEU011
      *                                                                   CEU011
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     CLR                   MOVE '1'       *IN25                           S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR                   END                                            S01117
0509 C*                                                                   S01117
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      /EJECT                                                              S01129
0611 C********************************************************************
0612 C*
0613 C*    CALCS FOR PRINTING CALL/NOTICE LINES
0614 C*
0615 C           DEPS      BEGSR                           DEPS
0616 C*
0617 C           CALLI     SUB  CALLO     CALNET 130
0618 C           CALLI     DIV  1000      CITH   100H
0619 C           CALLO     DIV  1000      COTH   100H
0620 C           CALNET    DIV  1000      CNTTH  100H
0621 C*
0622 C   71      CITH      DIV  10        CITH      H
0623 C   71      COTH      DIV  10        COTH      H
0624 C   71      CNTTH     DIV  10        CNTTH     H
0625 C   72      CITH      DIV  100       CITH      H
0626 C   72      COTH      DIV  100       COTH      H
0627 C   72      CNTTH     DIV  100       CNTTH     H
0628 C   73      CITH      DIV  1000      CITH      H
0629 C   73      COTH      DIV  1000      COTH      H
0630 C   73      CNTTH     DIV  1000      CNTTH     H
0631 C*
0632 C           NOTICI    SUB  NOTICO    NOTNET 130
0633 C           NOTICI    DIV  1000      NITH   100H
0634 C           NOTICO    DIV  1000      NOTH   100H
0635 C           NOTNET    DIV  1000      NNETTH 100H
0636 C*
0637 C   71      NITH      DIV  10        NITH      H
0638 C   71      NOTH      DIV  10        NOTH      H
0639 C   71      NNETTH    DIV  10        NNETTH    H
0640 C   72      NITH      DIV  100       NITH      H
0641 C   72      NOTH      DIV  100       NOTH      H
0642 C   72      NNETTH    DIV  100       NNETTH    H
0643 C   73      NITH      DIV  1000      NITH      H
0644 C   73      NOTH      DIV  1000      NOTH      H
0645 C   73      NNETTH    DIV  1000      NNETTH    H
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540PDR                                            S01408
     C*                                                                   S01408
      *                                                                   CEU011
      ** If CEU011 is switched on and Event ccy is 'IN' ccy.              CEU011
      ** convert the ffg. amount to their Euro equivalent.                CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           WINCY     ANDEQ'Y'                                       CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C           CITH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCITH      PFRAM                           CEU011
     C                     MOVEL'12'      @DBASE  3                       CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECITHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ECITHX 100H                     149411
     C                     ADD  ECITHX    ECITH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert COTH amount to its Euro equivalent amt.                  CEU011
     C           COTH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCOTH      PFRAM                           CEU011
     C                     MOVEL'13'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECOTHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ECOTHX 100H                     149411
     C                     ADD  ECOTHX    ECOTH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert CNTTH amount to its Euro equivalent amt.                 CEU011
     C           CNTTH     IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCNTTH     PFRAM                           CEU011
     C                     MOVEL'14'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECNTTX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ECNTTX 100H                     149411
     C                     ADD  ECNTTX    ECNTTH 100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert NITH amount to its Euro equivalent amt.                  CEU011
     C           NITH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDNITH      PFRAM                           CEU011
     C                     MOVEL'15'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ENITHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ENITHX 100H                     149411
     C                     ADD  ENITHX    ENITH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert NOTH amount to its Euro equivalent amt.                  CEU011
     C           NOTH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDNOTH      PFRAM                           CEU011
     C                     MOVEL'16'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C*                    Z-ADDPOUTA     ENOTHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ENOTHX 100H                     149411
     C                     ADD  ENOTHX    ENOTH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert NNETTH amount to its Euro equivalent amt.                CEU011
     C           NNETTH    IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDNNETTH    PFRAM                           CEU011
     C                     MOVEL'17'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C*                    Z-ADDPOUTA     ENETTX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ENETTX 100H                     149411
     C                     ADD  ENETTX    ENETTH 100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert CUMTT amount to its Euro equivalent amt.                 CEU011
     C           CUMTT     IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCUMTT     PFRAM                           CEU011
     C                     MOVEL'18'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     WCUMTX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   WCUMTX 100H                     149411
     C                     ADD  WCUMTX    WCUMTT 100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
     C           BCCY1     IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
      ** Convert BCEQV amount to its Euro equivalent amt.                 CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE BJCYCD    PFRCY                           CEU011
     C                     Z-ADDBCEQV     PFRAM                           CEU011
     C                     MOVEL'19'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     TBCEQV 100               CEU011 149411
     C           POUTA     DIV  POWER,E   TBCEQV 100H                     149411
     C                     ADD  TBCEQV    WBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
     C           BJCYCD    IFEQ BKEURO                                    CEU011
     C                     ADD  BCEQV     WBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
      ** Use the standard subroutine ZCONV.                               CEU011
     C                     Z-ADDBCEQV     ZAMTCI                          CEU011
      *                                                                   CEU011
     C                     MOVE WSMDIN    ZMD                             CEU011
     C                     MOVE BJCYCD    ZCCYI                           CEU011
     C                     MOVE BKEURO    ZCCYO                           CEU011
     C                     MOVE WSNBDP    ZCDPI                           CEU011
     C                     MOVE WSNBDP    ZCDPO                           CEU011
     C                     MOVE WSSPRT    ZEXCH                           CEU011
      *                                                                   CEU011
     C                     EXSR ZCONV                                     CEU011
      *                                                                   CEU011
     C                     Z-ADDZAMTCO    XBCEQV 100                      CEU011
     C                     ADD  XBCEQV    WBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
     C           CEU011    IFEQ 'Y'                                       149411
     C           ECCY      ANDEQBKEURO                                    149411
     C                     ADD  CITH      ECITH                           149411
     C                     ADD  COTH      ECOTH                           149411
     C                     ADD  CNTTH     ECNTTH                          149411
     C                     ADD  NITH      ENITH                           149411
     C                     ADD  NOTH      ENOTH                           149411
     C                     ADD  NNETTH    ENETTH                          149411
     C                     ADD  CUMTT     WCUMTT                          149411
     C                     ADD  BCEQV     WBCEQV                          149411
     C                     END                                            149411
0646 C*
0647 C                     ENDSR
0648 C*
0649 C********************************************************************
0650 C*
0651 C*    PERFORM HASH TOTALLING
0652 C*
0653 C           HASH      BEGSR                           HASH
0654 C*
0655 C                     Z-ADDINT,X     ZZTOTI
0656 C                     Z-ADDDEC,X     ZZTOTD
0657 C                     EXSR GLZADD
0658 C                     Z-ADDZZTOTI    INT,X
0659 C                     Z-ADDZZTOTD    DEC,X
      *                                                                   S01129
      ** Clear previous accumulater values.                               S01129
     C                     Z-ADD0         ZZTOTI                          S01129
     C                     Z-ADD0         ZZTOTD                          S01129
0660 C*
0661 C                     ENDSR
0662 C*
0663 C********************************************************************
0664 C*
0665 C*    DIVIDE AMOUNTS AND OUTPUT DETAIL LINES
0666 C*
0667 C           DIVOUT    BEGSR
0668 C*
0669 C*    ADD DATE ACCUMULATORS INTO PERIOD ACCUMULATORS
0670 C                     EXSR NETS
0671 C                     EXSR TOTAL
0672 C*
0673 C*    DIVIDE FIELDS TO BE PRINTED OUT BY 1000
0674 C           ACC,1     DIV  1000      RND,1     H
0675 C           ACC,2     DIV  1000      RND,2     H
0676 C           ACC,3     DIV  1000      RND,3     H
0677 C           ACC,4     DIV  1000      RND,4     H
0678 C           ACC,5     DIV  1000      RND,5     H
0679 C           ACC,6     DIV  1000      RND,6     H
0680 C           ACC,7     DIV  1000      RND,7     H
0681 C           ACC,8     DIV  1000      RND,8     H
0682 C           ACC,9     DIV  1000      RND,9     H
0683 C                     Z-ADD0         ACC
0684 C   71      RND       DIV  10        RND       H
0685 C   72      RND       DIV  100       RND       H
0686 C   73      RND       DIV  1000      RND       H
0687 C           CUMTT     ADD  RND,9     CUMTT
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG8                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C* CALCULATIONS DONE DEPENDING ON THE VALUE OF SPOT RATE AND         S01194
     C* MULT/DIV INDICATOR ,I.E. SPOT RATE NE ZERO                        S01194
0688 C**N20 87   CUMTT     DIV  SPOT      BCEQV  100H                     S01194
     C           A6SPRT    IFNE 0                                         S01194
     C           A6MDIN    ANDEQ'D'                                       S01194
     C           CUMTT     DIV  A6SPRT    BCEQV  100H                     S01194
     C                     END                                            S01194
0689 C**N20N87   CUMTT     MULT SPOT      BCEQV     H                     S01194
     C           A6SPRT    IFNE 0                                         S01194
     C           A6MDIN    ANDEQ'M'                                       S01194
     C           CUMTT     MULT A6SPRT    BCEQV     H                     S01194
     C                     END                                            S01194
0690 C*
0691 C   47                GOTO OLDPER
0692 C           TOT,1     DIV  1000      TOTO,1    H
0693 C           TOT,2     DIV  1000      TOTO,2    H
0694 C           TOT,3     DIV  1000      TOTO,3    H
0695 C           TOT,4     DIV  1000      TOTO,4    H
0696 C           TOT,5     DIV  1000      TOTO,5    H
0697 C           TOT,6     DIV  1000      TOTO,6    H
0698 C           TOT,7     DIV  1000      TOTO,7    H
0699 C           TOT,8     DIV  1000      TOTO,8    H
0700 C           TOT,9     DIV  1000      TOTO,9    H
0701 C                     Z-ADD0         TOT
0702 C   71      TOTO      DIV  10        TOTO      H
0703 C   72      TOTO      DIV  100       TOTO      H
0704 C   73      TOTO      DIV  1000      TOTO      H
0705 C*
0706 C*    OUTPUT DETAIL AND FFVD TOTAL LINES
0707 C           OLDPER    TAG                             ** OLDPER TAG *
     C   48                GOTO OPLNS
     C**
     C**   CHECK EACH ELEMENT OF RND IS NOT ZERO
     C**
     C                     Z-ADD0         A       10
     C           LOOP1     TAG                             ** LOOP1 TAG **
     C           A         ADD  1         A
     C           RND,A     COMP 0                    3838
     C   38                GOTO OPLNS
     C           A         COMP 9                        38
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CPG9                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C   38                GOTO ENDDIV
     C                     GOTO LOOP1
     C*SET*UP*FRA/IRS*TYPE*MARKER*FOR*SUBTOTAL*LINE*IF*HEDGED*EVENTSS01119DT0021
     C**ARE*TO*BE*REPORTED                                          S01119DT0021
     C**********                                                    S01119DT0021
     C***        HEOCF     IFEQ 'Y'                                 S01119S01194
     C********** BQHEOC    IFEQ 'Y'                                 S01194DT0021
     C********** MKR       IFEQ *BLANK                              S01119DT0021
     C**********           MOVE MKR       TMKR    3                 S01119DT0021
     C**********           ELSE                                     S01119DT0021
     C**********           MOVE 'F/I'     TMKR                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**
     C           OPLNS     TAG                             ** OPLNS TAG **
0708 C                     SETON                     68
      *                                                                   CEU011
      **  Divide amount and output detail lines.                          CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           WINCY     ANDEQ'Y'                                       CEU011
     C                     Z-ADD1         Z       20                      CEU011
     C           Z         DOWLE9                                         CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDRND,Z     PFRAM                           CEU011
     C                     MOVEL'20'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ERND,Z                   CEU011 149411
     C                     Z-ADD0         ERND,Z                          149411
     C           POUTA     DIV  POWER,E   ERND,Z                          149411
      *                                                                   CEU011
     C                     ADD  1         Z                               CEU011
     C                     ENDDO                                          CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCUMTT     PFRAM                           CEU011
     C                     MOVEL'21'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECUMTT 100               CEU011 149411
     C                     Z-ADD0         ECUMTT 100                      149411
     C           POUTA     DIV  POWER,E   ECUMTT                          149411
      *                                                                   CEU011
     C           BCCY1     IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE BJCYCD    PFRCY                           CEU011
     C                     Z-ADDBCEQV     PFRAM                           CEU011
     C                     MOVEL'22'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     EBCEQV 100               CEU011 149411
     C                     Z-ADD0         EBCEQV 100                      149411
     C           POUTA     DIV  POWER,E   EBCEQV                          149411
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
     C           BJCYCD    IFEQ BKEURO                                    CEU011
     C                     Z-ADDBCEQV     EBCEQV                          CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
      ** Use the standard subroutine ZCONV.                               CEU011
     C                     Z-ADDBCEQV     ZAMTCI                          CEU011
      *                                                                   CEU011
     C                     MOVE WSMDIN    ZMD                             CEU011
     C                     MOVE BJCYCD    ZCCYI                           CEU011
     C                     MOVE BKEURO    ZCCYO                           CEU011
     C                     MOVE WSNBDP    ZCDPI                           CEU011
     C                     MOVE WSNBDP    ZCDPO                           CEU011
     C                     MOVE WSSPRT    ZEXCH                           CEU011
      *                                                                   CEU011
     C                     EXSR ZCONV                                     CEU011
      *                                                                   CEU011
     C                     Z-ADDZAMTCO    EBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      * Write record to LF/GLEVCFL0                                       CEU011
      *                                                                   CEU011
     C                     EXSR W01                                       CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
     C*                                                                   149411
     C           ECCYB     IFEQ BKEURO                                    149411
     C           CEU011    ANDEQ'Y'                                       155669
     C                     EXSR W01                                       149411
     C                     END                                            149411
      *                                                                   CEU011
0709 C                     EXCPT
     C/COPY WNCPYSRC,GL0540C003
0710 C                     SETOF                     68
0711 C*
0712 C           ENDDIV    ENDSR
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/SREURO - Call program to convert amount to Euro           *   CEU011
      *              Equivalent.                                      *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           SREURO    BEGSR                                          CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'               8787               CEU011
     C                     PARM           PRTCD   7                       CEU011
     C                     PARM           PFRAM  183                      CEU011
     C                     PARM           PFRCY   3                       CEU011
     C                     PARM           PTOCY   3                       CEU011
     C                     PARM           POUTA  150                      CEU011
     C                     PARM           PINTA  183                      CEU011
     C                     PARM           PEXRT  159                      CEU011
     C                     PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     C           PRTCD     IFNE *BLANKS                                   CEU011
     C                     MOVEL'*CALL   'DBFILE                          CEU011
     C                     MOVEL'EU0200  'DBKEY             ************  CEU011
     C                     MOVEL@DBASE    DBASE             * DBERR XX *  CEU011
     C                     SETON                     U7U8LR ************  CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     GOTO END                                       CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/W01  -   Write record to LF/GLEVCFL0.                     *   CEU011
      *                                                               *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           W01       BEGSR                                          CEU011
      *                                                                   CEU011
     C           ECCYB     IFEQ BKEURO                                    149411
     C                     Z-ADDEEDAT     CEVDT                           149411
     C                     Z-ADDRND,1     CLODI                           149411
     C                     Z-ADDRND,2     CLODO                           149411
     C                     Z-ADDRND,6     CLODN                           149411
     C                     Z-ADDRND,3     CLDIN                           149411
     C                     Z-ADDRND,4     CFORP                           149411
     C                     Z-ADDRND,5     CFORS                           149411
     C                     Z-ADDRND,7     CFORN                           149411
     C                     Z-ADDRND,8     CNFXI                           149411
     C                     Z-ADDRND,9     CNETD                           149411
     C                     Z-ADDCUMTT     CCTOT                           149411
     C                     Z-ADDBCEQV     CBEQV                           149411
     C                     ELSE                                           149411
     C                     Z-ADDEEDAT     CEVDT                           CEU011
     C                     Z-ADDERND,1    CLODI                           CEU011
     C                     Z-ADDERND,2    CLODO                           CEU011
     C                     Z-ADDERND,6    CLODN                           CEU011
     C                     Z-ADDERND,3    CLDIN                           CEU011
     C                     Z-ADDERND,4    CFORP                           CEU011
     C                     Z-ADDERND,5    CFORS                           CEU011
     C                     Z-ADDERND,7    CFORN                           CEU011
     C                     Z-ADDERND,8    CNFXI                           CEU011
     C                     Z-ADDERND,9    CNETD                           CEU011
     C                     Z-ADDECUMTT    CCTOT                           CEU011
     C                     Z-ADDEBCEQV    CBEQV                           CEU011
     C                     END                                            149411
      *                                                                   CEU011
     C                     WRITEGLEVCFPF                                  CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/P01  -  Generate Consolidated Euro Report.                *   CEU011
      *                                                               *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           P01       BEGSR                                          CEU011
     C                     MOVE *OFF      *IN48                           149411
      *                                                                   CEU011
     C                     MOVE 'N'       PR1     1                       CEU011
     C                     MOVE 'N'       PR2     1                       CEU011
     C           *LOVAL    SETLLGLEVCFL0                                  CEU011
     C                     READ GLEVCFL0                 84               CEU011
     C           *IN84     DOWEQ'0'                                       CEU011
      *                                                                   CEU011
      ** If Report Header is not yet printed or overflow line             CEU011
      ** ind. is on.                                                      CEU011
      *                                                                   CEU011
     C           PR1       IFEQ 'N'                                       CEU011
     C           *INOF     OREQ '1'                                       CEU011
     C                     MOVE *ON       *IN46                           CEU011
     C                     MOVE *ON       *IN75                           CEU011
     C                     EXCPT                                          CEU011
     C                     MOVE *OFF      *IN46                           CEU011
     C                     MOVE 'Y'       PR1                             CEU011
     C                     MOVE *OFF      *IN75                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** If Call/Notice and Opening Balance Lines is not yet              CEU011
      ** printed.                                                         CEU011
      *                                                                   CEU011
     C           PR2       IFEQ 'N'                                       CEU011
     C                     MOVE *ON       *IN67                           CEU011
     C                     Z-ADDECITH     CITH                            CEU011
     C                     Z-ADDECOTH     COTH                            CEU011
     C                     Z-ADDECNTTH    CNTTH                           CEU011
     C                     Z-ADDENITH     NITH                            CEU011
     C                     Z-ADDENOTH     NOTH                            CEU011
     C                     Z-ADDENETTH    NNETTH                          CEU011
     C                     Z-ADDWCUMTT    CUMTT                           CEU011
     C                     Z-ADDWBCEQV    BCEQV                           CEU011
     C                     EXCPT                                          CEU011
     C                     MOVE *OFF      *IN67                           CEU011
     C                     MOVE 'Y'       PR2                             CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ADD  CLODI     RND,1                           CEU011
     C                     ADD  CLODO     RND,2                           CEU011
      *                                                                   CEU011
     C                     ADD  CLODN     RND,6                           CEU011
     C                     ADD  CLDIN     RND,3                           CEU011
      *                                                                   CEU011
     C                     ADD  CFORP     RND,4                           CEU011
     C                     ADD  CFORS     RND,5                           CEU011
      *                                                                   CEU011
     C                     ADD  CFORN     RND,7                           CEU011
     C                     ADD  CNFXI     RND,8                           CEU011
     C                     ADD  CNETD     RND,9                           CEU011
      *                                                                   CEU011
     C***********          ADD  CCTOT     CUMTT                    CEU011 149411
     C***********          ADD  CBEQV     BCEQV                    CEU011 149411
     C                     ADD  CNETD     CUMTT                           149411
     C***********          ADD  CNETD     BCEQV                    149411*154989
     C*                                                                   154989
     C           EUMDIN    IFEQ 'M'                                       154989
     C           CUMTT     MULT EUSPRT    BCEQV     H                     154989
     C                     ELSE                                           154989
     C           CUMTT     DIV  EUSPRT    BCEQV     H                     154989
     C                     END                                            154989
     C*                                                                   154989
     C                     ADD  CLODI     TOTO,1                          149411
     C                     ADD  CLODO     TOTO,2                          149411
      *                                                                   149411
     C                     ADD  CLODN     TOTO,6                          149411
     C                     ADD  CLDIN     TOTO,3                          194111
      *                                                                   149411
     C                     ADD  CFORP     TOTO,4                          149411
     C                     ADD  CFORS     TOTO,5                          149411
      *                                                                   149411
     C                     ADD  CFORN     TOTO,7                          149411
     C                     ADD  CNFXI     TOTO,8                          149411
     C                     ADD  CNETD     TOTO,9                          149411
      *                                                                   CEU011
     C***********          Z-ADD1         Z                        CEU011 149411
      *                                                                   CEU011
     C***********Z         DOWLE9                                  CEU011 149411
     C***********          ADD  RND,Z     TOTO,Z                   CEU011 149411
     C***********          ADD  1         Z                        CEU011 149411
     C***********          ENDDO                                   CEU011 149411
      *                                                                   CEU011
     C                     Z-ADDCEVDT     PEVDT   50                      CEU011
      * Read next record.                                                 CEU011
     C                     READ GLEVCFL0                 84               CEU011
      *                                                                   CEU011
     C           PEVDT     IFNE CEVDT                                     CEU011
     C           *IN84     OREQ '1'                                       CEU011
      *                                                                   CEU011
     C                     MOVE PEVDT     ZDAYNO                          CEU011
     C                     EXSR ZDATE2                                    CEU011
     C                     MOVE ZADATE    FFVDA                           CEU011
      *                                                                   CEU011
     C           CEVDT     IFGT ENDDY                                     CEU011
     C           *IN84     OREQ *ON                                       149411
     C                     MOVE *ON       *IN48                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     MOVE *ON       *IN68                           CEU011
     C                     EXCPT                                          CEU011
      *                                                                   CEU011
     C           *IN48     IFEQ '1'                                       CEU011
     C                     MOVE EDAT      EDATX   50                      CEU011
     C                     MOVE CEVDT     EDAT                            CEU011
     C                     EXSR NXTDAY                                    CEU011
     C                     MOVE EDATX     EDAT                            CEU011
     C                     Z-ADD*ZERO     TOTO                            CEU011
     C                     MOVE *OFF      *IN48                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     Z-ADD*ZERO     RND                             CEU011
     C                     MOVE *OFF      *IN68                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDDO                                          CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/INITF -  Initialise fields before call to EU0200.         *   CEU011
      *                                                               *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           INITF     BEGSR                                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   PRTCD                           CEU011
     C                     MOVE BKEURO    PTOCY                           CEU011
     C                     Z-ADD0         POUTA                           CEU011
     C                     Z-ADD0         PINTA                           CEU011
     C                     Z-ADD0         PEXRT                           CEU011
     C                     MOVE *BLANKS   PMDIN                           CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
0713 C*
0714 C********************************************************************
0715 C*
0716 C*    ACCUMULATE NET AMOUNTS
0717 C*
0718 C           NETS      BEGSR                           NETS
0719 C*
0720 C           ACC,1     SUB  ACC,2     ACC,6            NET DEP AMT
0721 C           ACC,4     SUB  ACC,5     ACC,7            NET FX
0722 C           ACC,7     ADD  ACC,3     ACC,8            NET FX AND INT
0723 C           ACC,6     ADD  ACC,8     ACC,9            NET DAY
0724 C*
0725 C                     ENDSR
0726 C*
0727 C********************************************************************
0728 C           TOTAL     BEGSR                           TOTAL
     C*SET*UP*FRA/IRS*TYPE*MARKER*ON*SUB-TOTAL*LINE*IF*HEDGED*EVENTSS01119DT0021
     C**ARE*TO*BE*REPORTED                                          S01119DT0021
     C**********                                                    S01119DT0021
     C***        HEOCF     IFEQ 'Y'                                 S01194S01119
     C********** BQHEOC    IFEQ 'Y'                                 S01194DT0021
     C********** MKR       IFNE *BLANK                              S01119DT0021
     C********** TMKR      IFEQ *BLANK                              S01119DT0021
     C**********           MOVE MKR       TMKR    3                 S01119DT0021
     C**********           ELSE                                     S01119DT0021
     C********** MKR       IFNE TMKR                                S01119DT0021
     C**********           MOVE 'F/I'     TMKR                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********           END                                      S01119DT0021
     C**********                                                    S01119DT0021
0729 C*
0730 C*    MAINTENANCE OF PERIOD TOTALS
0731 C           TOT,1     ADD  ACC,1     TOT,1
0732 C           TOT,2     ADD  ACC,2     TOT,2
0733 C           TOT,3     ADD  ACC,3     TOT,3
0734 C           TOT,4     ADD  ACC,4     TOT,4
0735 C           TOT,5     ADD  ACC,5     TOT,5
0736 C           TOT,6     ADD  ACC,6     TOT,6
0737 C           TOT,7     ADD  ACC,7     TOT,7
0738 C           TOT,8     ADD  ACC,8     TOT,8
0739 C           TOT,9     ADD  ACC,9     TOT,9
0740 C                     ENDSR
0741 C********************************************************************
0742 C*
0743 C*    CALCULATE END DATE OF FIRST PERIOD
0744 C*
0745 C           PEREND    BEGSR
0746 C*
0747 C***                  MOVE RUNA      STDAYA  7                       S01194
0747 C                     MOVE BJMRDT    STDAYA  7                       S01194
0748 C***        RUND      ADD  7         ENDDY   50                      S01194
0748 C           BJRDNB    ADD  7         ENDDY   50                      S01194
0749 C                     MOVE ENDDY     ZDAYNO
0750 C                     EXSR ZDATE2
0751 C                     MOVE ZADATE    ENDDYA  7
0752 C*
0753 C                     ENDSR
0754 C*
0755 C********************************************************************
0756 C*
0757 C*    SUBROUTINE TO FIND START AND END DAYS OF NEXT PERIOD
0758 C           NXTDAY    BEGSR
0759 C           DOAGIN    TAG                             ** DOAGIN TAG *
0760 C                     SETOF                     3233
0761 C           ENDDY     ADD  1         STDAY   50
0762 C           D         COMP 4                    34  30
0763 C   34                GOTO TAG34
0764 C   30                GOTO TAG30
0765 C*
0766 C*    END OF 4TH PERIOD NOT YET REACHED
0767 C           D         COMP 2                        32
0768 C           D         COMP 3                        33
0769 C   32      ENDDY     ADD  3         ENDDY
0770 C   33      ENDDY     ADD  5         ENDDY
0771 C                     GOTO FORMAT
0772 C           TAG30     TAG                             ** TAG30 TAG **
     C*                                                                   E14017
     C** IF END DATE AFTER 31 DEC 2071                                    E14017
     C*                                                                   E14017
     C           ENDDY     IFGT 36525                                     E14017
     C                     MOVEL'Y'       OVRFL   1                       E14017
     C                     ELSE                                           E14017
     C                     MOVEL'N'       OVRFL                           E14017
     C                     END                                            E14017
     C*                                                                   E14017
0773 C                     Z-ADDENDDY     ZDAYNO
0774 C                     EXSR ZDATE2
0775 C*
0776 C*    ZDATE NOW CONTAINS ENDDY IN DDMMYY/MMDDYY FORMAT
0777 C   98                GOTO MMDDYY
0778 C*    THIS PART DONE IF FORMAT IS DDMMYY
0779 C                     MOVELZDATE     DD      2
     C           DD        COMP '15'                   38
     C   38                MOVEL15        ZDATE
     C   38                GOTO CNVRT
0783 C                     MOVELZDATE     WRK1    4
0784 C                     MOVE WRK1      MM      2
0785 C           MM        LOKUPTABM      TABD           33
0786 C                     MOVELTABD      ZDATE
0787 C                     GOTO CNVRT
0788 C           MMDDYY    TAG                             ** MMDDYY TAG *
0789 C*    THIS PART DONE IF FORMAT IS MMDDYY
0790 C                     MOVELZDATE     WRK1
0791 C                     MOVE WRK1      DD
     C           DD        COMP '15'                   38
     C   38                MOVE '15'      WRK1
     C   38                MOVELWRK1      ZDATE
     C   38                GOTO CNVRT
0796 C                     MOVELWRK1      MM
0797 C           MM        LOKUPTABM      TABD           33
0798 C                     MOVE TABD      WRK1
0799 C                     MOVELWRK1      ZDATE
0800 C           CNVRT     TAG                             ** CNVRT TAG **
0801 C                     EXSR ZDATE1
     C           *IN91     IFEQ '1'                                       151655
     C           ZMTH      ANDEQ2                                         151655
     C           *IN38     ANDEQ'0'                                       151655
     C                     ADD  1         ZDAYNO                          151655
     C                     ENDIF                                          151655
     C*                                                                   E14017
     C** RESTORE DATE                                                     E14017
     C*                                                                   E14017
     C           OVRFL     IFEQ 'Y'                                       E14017
     C                     ADD  36525     ZDAYNO                          E14017
     C                     END                                            E14017
     C*                                                                   E14017
0802 C                     MOVE ZDAYNO    ENDDY
0803 C                     GOTO FORMAT
0804 C           TAG34     TAG                             ** TAG34 TAG **
0805 C                     MOVE ENDDY     ZDAYNO
0806 C                     MOVE 'S'       ZFREQ
0807 C***                  EXSR ZFREQB                                    E14017
0807 C                     EXSR SFREQB                                    E14017
0808 C                     MOVE ZDAYNO    ENDDY
0809 C*
0810 C           FORMAT    TAG                             ** FORMAT TAG *
0811 C                     MOVE STDAY     ZDAYNO
0812 C                     EXSR ZDATE2
0813 C                     MOVE ZADATE    STDAYA
0814 C                     MOVE ENDDY     ZDAYNO
0815 C                     EXSR ZDATE2
0816 C                     MOVE ZADATE    ENDDYA
0817 C           D         ADD  1         D
0818 C           EDAT      COMP ENDDY                31
0819 C   31                GOTO DOAGIN
0820 C                     ENDSR
0821 C********************************************************************
0822 C**
0823 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
0824 C**              CONVERT TO A NUMBER OF DAYS.
0825 C**
0826 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0827 C**
0828 C           ZDATE1    BEGSR                           *** ZDATE1 ***
0829 C**
0830 C**   CLEAR DAY NUMBER.
0831 C                     Z-ADD0         ZDAYNO  50
0832 C**
0833 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
0834 C                     Z-ADDZDATE     ZDATE   60
0835 C**
0836 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
0837 C                     MOVE ZDATE     ZYEAR   20
0838 C  N98                MOVELZDATE     ZDAY    20
0839 C   98                MOVELZDATE     ZMTH    20
0840 C                     MOVE ZDATE     ZWRK4   40
0841 C  N98                MOVELZWRK4     ZMTH
0842 C   98                MOVELZWRK4     ZDAY
0843 C**
0844 C**   ENSURE MONTH IS VALID.
0845 C           ZMTH      COMP 0                      9999
0846 C  N99      ZMTH      COMP 12                   99
0847 C   99                GOTO ZDEND1                     BYPASS IF ERROR
0848 C**
0849 C**   CHECK FOR 30 DAY MONTHS.
0850 C           ZMTH      COMP 4                        90IF 90 ON, 30
0851 C  N90      ZMTH      COMP 6                        90DAY MONTH.
0852 C  N90      ZMTH      COMP 9                        90
0853 C  N90      ZMTH      COMP 11                       90
0854 C**
0855 C**   ENSURE DAY IS VALID.
0856 C           ZDAY      COMP 0                      9999
0857 C   90N99   ZDAY      COMP 30                   99
0858 C  N90N99   ZDAY      COMP 31                   99
0859 C   99                GOTO ZDEND1                     BYPASS IF ERROR
0860 C**
0861 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
0862 C           ZYEAR     ADD  28        ZYEAR
0863 C           ZYEAR     DIV  4         ZLYR    20
0864 C                     MVR            ZLY     10     91LEAP YR, 91 ON
0865 C           ZMTH      COMP 2                    93  92FEB., 92 ON
0866 C**                                                   PAST FEB, 93 ON
0867 C**   IF FEBUARY FURTHER VALIDATE DAY.
0868 C  N91 92   ZDAY      COMP 28                   99
0869 C   91 92   ZDAY      COMP 29                   99
0870 C   99                GOTO ZDEND1                     BYPASS IF ERROR
0871 C**
0872 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
0873 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
0874 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
0875 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
0876 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
0877 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
0878 C**
0879 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
0880 C**
0881 C********************************************************************
0882 C**
0883 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0884 C**
0885 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0886 C**
0887 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0888 C**
0889 C**   CLEAR DATE FIELDS.
0890 C                     Z-ADD0         ZDATE   60
0891 C                     MOVEL'       ' ZADATE  7
0892 C**
0893 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0894 C                     Z-ADDZDAYNO    ZDAYNO  50
0895 C**
0896 C**   DETERMINE YEAR NUMBER.
0897 C**
0898 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0899 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0900 C   99                GOTO ZDEND2
0901 C**
0902 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0903 C           ZDAYN1    DIV  1461      ZLYR    20
0904 C                     MVR            ZDAYN1           SAVE REMAINING
0905 C**                                                   DAYS
0906 C**   CALCULATE NUMBER OF REMAINING YEARS.
0907 C                     Z-ADD1         ZWRK2   20
0908 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0909 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0910 C  N90      ZWRK2     ADD  1         ZWRK2
0911 C  N90                GOTO ZDTAG1
0912 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0913 C**
0914 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0915 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0916 C**
0917 C**   CALCULATE ACTUAL YEAR NUMBER.
0918 C           ZLYR      MULT 4         ZWRK3   30
0919 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0920 C                     Z-ADDZWRK3     ZYEAR   20
0921 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0922 C**
0923 C**   DETERMINE MONTH NUMBER.
0924 C**
0925 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0926 C                     SETOF                     9293
0927 C   91      ZDAYN1    COMP 59                     9293
0928 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0929 C**
0930 C**   CALCULATE MONTH NUMBER.
0931 C                     Z-ADD2         ZWRK2
0932 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0933 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0934 C  N94      ZWRK2     ADD  1         ZWRK2
0935 C  N94                GOTO ZDTAG2
0936 C           ZWRK2     SUB  1         ZWRK2
0937 C**
0938 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0939 C**
0940 C**   DETERMINE DAY OF MONTH.
0941 C**
0942 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0943 C           ZDAYN1    ADD  1         ZDAYN1
0944 C**
0945 C**   CALCULATE DAY OF MONTH.
0946 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0947 C**
0948 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0949 C   93      ZDAY      ADD  1         ZDAY
0950 C**
0951 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0952 C  N98                MOVELZDAY      ZWRK4   40
0953 C   98                MOVE ZDAY      ZWRK4
0954 C  N98                MOVE ZMTH      ZWRK4
0955 C   98                MOVELZMTH      ZWRK4
0956 C                     MOVELZWRK4     ZDATE
0957 C                     MOVE ZYEAR     ZDATE
0958 C**
0959 C**   FORMAT ALPHA DATE, DDMMMYY.
0960 C           ZDAY      COMP 10                     95
0961 C                     MOVELZDAY      ZWRK5   5
0962 C   95                MOVEL' '       ZWRK5
0963 C                     MOVE ZMNM,ZMTH ZWRK5
0964 C                     MOVELZWRK5     ZADATE
0965 C                     MOVE ZYEAR     ZADATE
0966 C**
0967 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0968 C**
0969 C********************************************************************
0970 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0971 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0972 C*
0973 CSR         GLZADD    BEGSR                           *** GLZADD ****
0974 C*
0975 C*SR********          Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  174051
0975 CSR                   Z-ADDZZAMT     ZZAMT  183     91-DEFINE ZZAMT  174051
0976 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0977 C*
0978 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0979 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0980 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0981 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0982 C*
0983 CSR                   EXSR GLZSUM
0984 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0985 C*
0986 C********************************************************************
0987 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0988 C*                        GLZADD, GLZSUB, GLZCMP.
0989 C*          PARAMETERS PASSED -
0990 C*                     I/P ZZAMTI ZZAMTD
0991 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0992 C*
0993 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0994 C*
0995 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0996 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0997 CSR                   SETOF                     919293
0998 CSR                   SETOF                     949599
0999 C*
1000 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
1001 CSR         ZZAMTI    COMP 0                      9293
1002 CSR 93      ZZAMTD    COMP 0                      9293
1003 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1004 C*
1005 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
1006 CSR         ZZTOTI    COMP 0                      9193
1007 CSR 93      ZZTOTD    COMP 0                      9193
1008 C*
1009 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
1010 CSR 93                Z-ADDZZAMTI    ZZTOTI
1011 CSR 93                Z-ADDZZAMTD    ZZTOTD
1012 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1013 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
1014 CSR 91N92
1015 CORN91 92             GOTO ZZOFPS
1016 C*
1017 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
1018 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
1019 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
1020 C*
1021 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
1022 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
1023 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
1024 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1025 C*
1026 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1027 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1028 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1029 CSRN99                Z-ADDZZWK2     ZZTOTD
1030 CSRN99                Z-ADDZZWK3     ZZTOTI
1031 C*
1032 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1033 C*SR*99*****          Z-ADD0         ZZAMT  153                      174051
1033 CSR 99                Z-ADD0         ZZAMT                           174051
1034 CSR                   GOTO ZZSEND
1035 C*
1036 C* THE 'SIGNS' ARE DIFFERENT
1037 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
1038 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1039 C*
1040 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
1041 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
1042 C*
1043 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1044 C*
1045 CSR 91                Z-SUBZZTOTI    ZZTOTI
1046 CSR 91                Z-SUBZZTOTD    ZZTOTD
1047 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1048 C*
1049 CSR         ZZTOTI    COMP ZZAMTI               93  95
1050 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
1051 C*
1052 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1053 CSR 95                Z-ADD0         ZZTOTI
1054 CSR 95                Z-ADD0         ZZTOTD
1055 CSR 95                GOTO ZZSEND
1056 C*
1057 C* IF ZZTOT GT. ZZAMT.
1058 CSR 93      ZZAMTD    COMP ZZTOTD               94
1059 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
1060 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
1061 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1062 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1063 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1064 C*
1065 C*
1066 C* IF ZZAMT GT. ZZTOT.
1067 CSRN93      ZZTOTD    COMP ZZAMTD               94
1068 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1069 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1070 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1071 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1072 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1073 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1074 C*
1075 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1076 CSR                   SETOF                     94
1077 CSR 93 91
1078 CORN93 92             SETON                     94
1079 CSR 94                Z-SUBZZTOTI    ZZTOTI
1080 CSR 94                Z-SUBZZTOTD    ZZTOTD
1081 C**
1082 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1083 CSR 92                Z-SUBZZAMTI    ZZAMTI
1084 CSR 92                Z-SUBZZAMTD    ZZAMTD
1085 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1086 C**
1087 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1088 CSR                   SETOF                     96
1089 CSR         ZZTOTD    COMP 0                        91
1090 CSR 91      ZZTOTI    COMP 0                      96
1091 CSR 96                MOVE '.000-'   ZZNEGD  5
1092 CSR                   ENDSR                             ** ENDSR **
1181 C**
     C********************************************************************E14017
     C*                                                                   E14017
1182 C*****ZFREQB-SR.*TO*INCREMENT A DAY NUMBER DATE BY A*********        E14017
1182 C**   SFREQB-SR. TO INCREMENT A DAY NUMBER DATE BY A                 E14017
1183 C**             PERIOD VALUE DETERMINED BY A CODE.
1184 C**
1185 C****       ZFREQB    BEGSR                           *** ZFREQB *** E14017
1185 C           SFREQB    BEGSR                           *** SFREQB *** E14017
1186 C**
1187 C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
1188 C                     MOVE ZFREQ     ZFREQ   1
1189 C                     Z-ADDZDAYNO    ZDAYNO  50
1190 C                     Z-ADDZMDAY     ZMDAY   20
1191 C                     MOVE ZCCY      ZCCY    3
1192 C**
1193 C                     MOVE '   '     ZHC
1194 C                     MOVE ' '       ZTABKY 12
1195 C*
1196 C*            FIELDS USED FOR PERIOD CODES M,T,Q,X,Y
1197 C*
1198 C                     MOVE '  '      ZINDE   2
1199 C                     Z-ADD0         ZINTO   20
1200 C**
     C*                                                                   E14017
     C** SAVE THE INPUT DATE                                              E14017
     C*                                                                   E14017
     C                     Z-ADDZDAYNO    SZDYN   50                      E14017
     C*                                                                   E14017
1201 C**   CONVERT DAY NUMBER TO DATE.
1202 C                     EXSR ZDATE2
1203 C                     SETOF                     90
1204 C**
1205 C**   CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.
1206 C           ZFREQ     COMP 'D'                      91
1207 C   91      ZDAYNO    ADD  1         ZDAYNO
1208 C   91                GOTO ZFHCHK
1209 C**
1210 C**   CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.
1211 C           ZFREQ     COMP 'W'                      91
1212 C   91      ZDAYNO    ADD  7         ZDAYNO
1213 C   91                GOTO ZFEND
1214 C**
1215 C**   CHECK FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.
1216 C           ZFREQ     COMP 'F'                      91
1217 C   91      ZDAYNO    ADD  14        ZDAYNO
1218 C   91                GOTO ZFEND
1219 C**
1220 C**   CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.
1221 C           ZFREQ     COMP 'S'                      91
1222 C   91      ZDAY      COMP 15                   939292
1223 C   91 92             Z-ADD31        ZDAY
1224 C   91 93             Z-ADD15        ZDAY
1225 C   91 93   ZMTH      ADD  1         ZMTH
1226 C   91                GOTO ZFDATE
1227 C**
1228 C**   CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.
1229 C           ZFREQ     COMP 'M'                      91
1230 C   91                MOVE 'IN'      ZINDE
1231 C** 91 ************** Z-ADDZMDAY *** ZDAY ************               S01211
1232 C   91      ZMTH      ADD  1         ZMTH
1233 C   91                GOTO ZFDATE
1234 C**
1235 C**   CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTH
1236 C           ZFREQ     COMP 'R'                      91
1237 C   91                Z-ADD31        ZDAY
1238 C   91      ZMTH      ADD  1         ZMTH
1239 C   91                GOTO ZFDATE
1240 C**
1241 C**   CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.
1242 C           ZFREQ     COMP 'T'                      91
1243 C   91                MOVE 'IN'      ZINDE
1244 C   91                Z-ADDZMDAY     ZDAY
1245 C   91      ZMTH      ADD  2         ZMTH
1246 C   91                GOTO ZFDATE
1247 C**
1248 C**   CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.
1249 C           ZFREQ     COMP 'Q'                      91
1250 C   91                MOVE 'IN'      ZINDE
1251 C   91                Z-ADDZMDAY     ZDAY
1252 C   91      ZMTH      ADD  3         ZMTH
1253 C   91                GOTO ZFDATE
1254 C**
1255 C**   CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.
1256 C           ZFREQ     COMP 'X'                      91
1257 C   91                MOVE 'IN'      ZINDE
1258 C   91                Z-ADDZMDAY     ZDAY
1259 C   91      ZMTH      ADD  6         ZMTH
1260 C   91                GOTO ZFDATE
1261 C**
1262 C**   CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.
1263 C           ZFREQ     COMP 'Y'                      91
1264 C   91                MOVE 'IN'      ZINDE
1258 C** 91 ************** Z-ADDZMDAY *** ZDAY ************               S01211
1265 C   91      ZYEAR     ADD  1         ZYEAR
1266 C   91                GOTO ZFDATE
1267 C**
1268 C**   CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH.
1269 C           ZFREQ     COMP 'L'                      91
1270 C   91                Z-ADD31        ZDAY
1271 C** 91 **** ZMTH **** ADD  1 ******* ZMTH ************               S01211
1272 C   91                GOTO ZFDATE
1273 C**
1274 C**   CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.
1275 C           ZFREQ     COMP 'B'                      91
1276 C   91                Z-ADD31        ZDAY
1277 C   91      ZMTH      ADD  1         ZMTH
1278 C   91                GOTO ZFDATE
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 4- 4 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '4'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  4         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 5- 5 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '5'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  5         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 7- 7 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '7'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  7         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 8- 8 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '8'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  8         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 9- 9 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '9'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  9         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE V- 10 MONTHLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'V'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  10        ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE E- 11 MONTHLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'E'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  11        ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE C- TWO YEARLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'C'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  2         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE I- THREE YEARLY                                   CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'I'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  3         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE J- FOUR YEARLY                                    CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'J'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  4         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE N- FIVE YEARLY                                    CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'N'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  5         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE U- TEN YEARLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'U'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  10        ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
1279 C**
1280 C**   CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.
1281 C           ZFREQ     COMP 'A'                      91
1282 C**                   MOVEL'01    '  ZTABKY
1282 C***91                MOVEL'01    '  ZTABKY                          S01194
1283 C***91                MOVE '    11'  ZTABKY                          S01194
1284 C***91      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
1285 C**N99      RECI      COMP '*'                      99               S01194
     C* OBTAIN GENERAL LEDGER DETAILS VIA ACCESS OBJECT                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** @GELR     PARM @GELR     DSFDY                                        S01194 CGL029
     C           @GELR     PARM @GELR     DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDGELRPD'DBFILE           **********     S01194
     C                     MOVEL'005'     DBASE            *DBERR 05*     S01194
     C                     MOVEL@OPTN     DBOPTN  7        **********     S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
1286 C***91N99             Z-ADDAPDA      ZDAYNO                          S01194
1286 C   91                Z-ADDBKAPDT    ZDAYNO                          S01194
1287 C**
1288 C**   BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE
1289 C                     GOTO ZFEND
1290 C**
1291 C**
1292 C**   REFORMAT DATE AND ENSURE VALID.
1293 C           ZFDATE    TAG                             ** ZFDATE TAG*
1294 C**
1295 C**   VALIDATE MONTH.
1296 C           ZMTH      COMP 12                   91
1297 C   91      ZMTH      SUB  12        ZMTH
1298 C   91      ZYEAR     ADD  1         ZYEAR
1299 C**
1300 C**   CHECK FOR LEAP YEAR.
1301 C           ZYEAR     DIV  4         ZLYR    20
1302 C                     MVR            ZLY     10     92LEAP YEAR-92 ON
1303 C**
1304 C**   VALIDATE DAY NUMBER.
1305 C                     MOVE ZFMD,ZMTH ZWRK2   20
1306 C           ZMTH      COMP 2                        93
1307 C   92 93             Z-ADD29        ZWRK2
1308 C**
1309 C           ZDAY      COMP ZWRK2                94
1310 C   94                Z-ADDZWRK2     ZDAY
1311 C**
1312 C**   CHECK IF CODE R, TO SUBTRACT 6 DAYS.
1313 C           ZFREQ     COMP 'R'                      91
1314 C   91      ZDAY      SUB  6         ZDAY
1315 C**
1316 C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.
1317 C                     MOVELZDAY      ZWRK4   40
1318 C                     MOVE ZMTH      ZWRK4
1319 C   98                MOVELZMTH      ZWRK4
1320 C   98                MOVE ZDAY      ZWRK4
1321 C                     MOVELZWRK4     ZDATE
1322 C                     MOVE ZYEAR     ZDATE
1323 C                     EXSR ZDATE1
     C*                                                                   E14017
     C** OVERFLOW DUE TO CROSSING 1 JAN 2071                              E14017
     C*                                                                   E14017
     C           ZDAYNO    IFLT SZDYN                                     E14017
     C                     ADD  36525     ZDAYNO                          E14017
     C                     END                                            E14017
     C*                                                                   S01211
     C**   BYPASS HOLIDAY CHECK - NOT REQUIRED FOR THIS PROGRAM           S01211
     C                     GOTO ZFEND                                     S01211
     C*                                                                   E14017
1324 C**
1325 C**   CHECK IF CODE B, OR M,T,Q,X,Y TO BE CHECKED FOR HOLIDAY.
1326 C           ZFREQ     COMP 'B'                      91
1327 C           ZINDE     COMP 'IN'                     92
1328 C   92N99
1329 COR 91N99             GOTO ZFHCHK
1330 C**
1331 C                     GOTO ZFEND
1332 C**
1333 C**   CHECK IF DAY NUMBER IS A HOLIDAY.
1334 C**
1335 C           ZFHCHK    TAG                             ** ZFHCHK TAG *
1336 C                     SETOF                     94
1337 C           ZFREQ     COMP 'D'                      91
1338 C           ZFREQ     COMP 'B'                      92
1339 C   91
1340 COR 92                GOTO ZSETK
1341 C*
1342 C*   FOR CODES M,T,Q,X,Y, CHECK ZINDE - 'IN' TO INCREMENT,
1343 C*                                    - 'DE' TO DECREMENT
1344 C*
1345 C           ZINDE     COMP 'IN'                     90
1346 C           ZINDE     COMP 'IN'                     91
1347 C           ZINDE     COMP 'DE'                     92
1348 C**
1349 C******ET KEY FOR FIRST HOLIDAY RECORD.                              S01194
1350 C           ZSETK     TAG                             ** ZSETK TAG **
1351 C****                 MOVEL'22    '  ZTABKY                          S01195
1352 C****                 MOVELZDAYNO    ZWRK6   6                       S01195
1353 C****                 MOVE 1         ZWRK6                           S01195
1354 C****                 MOVE ZWRK6     ZTABKY                          S01195
1355 C****                                                                S01195
1356 C**** GET HOLIDAY RECORD.                                            S01195
1357 C****       ZFHCHN    TAG                             ** ZFHCHN TAG* S01195
1358 C****       ZTABKY    CHAINTABLE                93    ON NOT THERE   S01195
1359 C**N93      RECI      COMP '*'                      93               S01195
     C**N94                MOVE '   '     ZHC                             S01195
1360 C****                                                                S01195
1361 C**** STORE CURRENCIES IF RECORD FOUND.                              S01195
1362 C**N94N93             MOVEAHCCY      ZHC,1                           S01195
1363 C***94N93             MOVEAHCCY      ZHC,26                          S01195
1364 C****                                                                S01195
1365 C**** GET SECOND RECORD, IF NOT ALREADY DONE.                        S01195
1366 C****                 MOVE ZTABKY    ZWRK1N  10                      S01195
1367 C****       ZWRK1N    COMP 1                        94               S01195
1368 C****                 MOVE '2'       ZTABKY                          S01195
1369 C***94N93             GOTO ZFHCHN                                    S01195
1370 C****                                                                S01195
1371 C**** BYPASS TO END IF NO FIRST RECORD FOUND.                        S01195
1372 C***93 94             GOTO ZFEND                                     S01195
1373 C**                                                                  S01195
1374 C**** DETERMINE HOLIDAY RECORD TYPE.                                 S01195
1375 C****       INEX      COMP 'E'                      95               S01195
1376 C****       INEX      COMP 'I'                      96               S01195
1377 C****                                                                S01195
1378 C**** CHECK IF CURRENCY ON HOLIDAY.                                  S01195
1379 C****       ZCCY      LOKUPZHC                      97               S01195
1380 C****                                                                S01195
1381 C**   BYPASS IF NOT HOLIDAY FOR CURRENCY.                            S01195
1382 C***95 97                                             EXCLUDE FOUND  S01195
1383 C*R*96N97             GOTO ZFEND                      INCL. NOT FOUNDS01195
1384 C****                                                                S01195
1385 C****                                                                S01195
     C*                                                                   S01195
     C*  NEW PROCESSING FOR HOLIDAYS FILE.                                S01195
     C*  INPUT FIELDS FOR SUBROUTINE TO CHECK DAYS ARE ZDAYNO,ZCCY,ZLOC   S01195
     C                     MOVELBJSLCD    ZLOC                            S01195
     C                     EXSR ZCHKH                                     S01195
     C*                                                                   S01195
     C* IF WORKING DAY GOTO END OF THIS SR.                               S01195
     C           ZIND      CABEQ'W'       ZFEND                           S01195
     C*
1386 C   92                GOTO ZDECR
1387 C*
1388 C**   INCREMENT OR DECREMENT DAY NUMBER AS REQUIRED.
1389 C   91      ZDAYNO    ADD  1         ZDAYNO
1390 C*
1391 C*    ONLY FOR PERIOD CODE = M,T,Q,X OR Y, IF INCREMENTATION
1392 C*    TAKES THE OUTPUT DATE INTO THE FOLLOWING MONTH, RETURN TO
1393 C*    THE INPUT DATE AND DECREMENT - 92 ON.
1394 C*
1395 C   90 91   ZINTO     ADD  1         ZINTO
1396 C   90 91   ZINTO     ADD  ZDAY      ZINTOT  20
1397 C   90 91             MOVE ZINTOT    ZINTOA  2
     C                     SETOF                     93
     C   90 91   ZYEAR     DIV  4         ZLYR
     C   90 91             MVR            ZLY            92
     C   90 91 92ZMTH      COMP 2                        93
     C   93      ZINTOA    COMP '29'                 92
     C   90 91N93ZINTOA    COMP ZFMD,ZMTH            92
1399 C   90 91 92ZDAYNO    SUB  ZINTO     ZDAYNO
1400 C   90 91 92          MOVE 'DE'      ZINDE
1401 C**
1402 C           ZDECR     TAG                             ** ZDECR TAG **
1403 C***92 95N97                                          EXCL. NOT FOUND
1404 C*R 92 96 97ZDAYNO    SUB  1         ZDAYNO           INCLUDE FOUND
1403 C   92 95                                             EXCL. NOT FOUND
1404 COR 92 96   ZDAYNO    SUB  1         ZDAYNO           INCLUDE FOUND
1405 C                     GOTO ZFHCHK
1406 C**
1407 C**
1408 C           ZFEND     ENDSR                           * ZFEND ENDSR *
1409 C**
     C*                                                                   S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C*                                                                   S01195
     C/COPY ZSRSRC,ZCHKH                                                  S01195
     C/COPY WNCPYSRC,GL0540C005
1410 C********************************************************************
     C*                                                                   S01194
     C*  *PSSR  SR. TO HANDLE DATABASE ERRORS                             S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                           ** *PSSR *     S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
1411 C********************************************************************
1412 C****                                                                S01194
1413 C**** ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
1414 C****                                                                S01194
1415 C****       ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
1416 C****                                                                S01194
1417 C**** SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
1418 C****                 MOVEL'01      'ZTABKY 12                       S01194
1419 C****                 MOVE '  10'    ZTABKY                          S01194
1420 C****                                                                S01194
1421 C****       ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
1422 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
1423 C****                                                                S01194
1424 C**** CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
1425 C****       DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
1426 C****                                                                S01194
1427 C****                 ENDSR                                          S01194
1428 C****                                                                S01194
1429 C****                                                                S01194
1430 C********************************************************************
1431 C********************************************************************
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0540CP14                                           S01408
      /EJECT                                                              CEU011
     C/COPY ZSRSRC,ZCONVZ1                                                CEU011
     C*                                                                   S01408
1432 O********************************************************************
1433 O*    CASH FLOW REPORT
1434 O*
1435 O*PRINT  E  203   46                                                 S01124
1435 O*DL0540P1E**203***46**************                            S01124E22608
1436 O***                                22 'REFERENCE DL0540'            S01117
1436 O********************************** 22 'REFERENCE DL0540P1'    S01194E22608
1435 OGL0540P1E  203   46                                                 E22608
1436 O                                   22 'REFERENCE GL0540P1'          E22608
1437 O***                      TITL      89                               S01194
1437 O                         BJURPT    89                               S01194
1438 O                                  104 'DATE'                        S01194
1439 O***                      RUNA     112                               S01194
1439 O                         BJMRDT   112                               S01194
1440 O                                  122 'PAGE'
1441 O                         PAGE  Z  127
1442 O        E  1     46
1443 O                                   73 'CASH FLOW IN 000''S FOR'
1444 O***********              ECCY      77                               CEU011
     O                N75      ECCY      77                               CEU011
     O                 86 75   BKEUCP    77                               CEU011
1445 O        E  2     46
1446 O                                   75 '------------------------'
1447 O                                   77 '--'
1448 O                                  110 'SPOT'
1449 O****                     SPOT     124 '   0 .        '              S01194
1449 O***********              A6SPRT   124 '   0 .        '       S01194*154989
1449 O                N75      A6SPRT   124 '   0 .        '              154989
1449 O                 86 75   EUSPRT   124 '   0 .        '              154989
1445 O        E  2     46
     O                                   18 'CONSOLIDATED'
1450 O        E  1     46
1451 O*************                      33 '* - - - L O A N S / D E '    S01119
1452 O*************                      57 'P O S I T S - - - * * - '    S01119
1453 O*************                      81 '- - -  F O R E X - - - -'    S01119
1454 O*************                     106 '- *   NET FX &       NET'    S01119
1455 O*************                     129 'CUM        BASE'             S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP1                                           S01408
      *                                                                   S01408
1451 O                                   36 '* - - - L O A N S / D E '    S01119
1452 O                                   60 'P O S I T S - - - * * - '    S01119
1453 O                                   84 '- - -  F O R E X - - - -'    S01119
1454 O                                  109 '- *   NET FX &       NET'    S01119
1455 O                                  132 'CUM        BASE'             S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP2                                           S01408
      *                                                                   S01408
1456 O        E  2     46
1457 O*************                      30 'INCOMING   OUTGOING'         S01119
1458 O*************                      60 'NET     INTEREST      PU'    S01119
1459 O*************                      84 'RCH      SALES       NET'    S01119
1460 O*************                     106 'INTEREST       DAY'          S01119
1461 O*************                     129 'TOTAL      EQUIV'            S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP3                                           S01408
      *                                                                   S01408
1457 O                                   33 'INCOMING   OUTGOING'         S01119
1458 O                                   63 'NET     INTEREST      PU'    S01119
1459 O*************                      87 'RCH      SALES       NET'S01119E175
1459 O                                   87 'RCH/IN   SALES/OUT   NET'      E175
1460 O                                  109 'INTEREST       DAY'          S01119
1461 O                                  132 'TOTAL      EQUIV'            S01119
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0540OPG1                                           S01408
     O*                                                                   S01408
1462 O        E  1     67
1463 O                                    4 'CALL'
1464 O************             CITH  LB  19                               S01119
1465 O************             COTH  LB  30                               S01119
1466 O************             CNTTH LB  41                               S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP4                                           S01408
      *                                                                   S01408
1464 O                         CITH  LB  22                               S01119
1465 O                         COTH  LB  33                               S01119
1466 O                         CNTTH LB  44                               S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP5                                           S01408
      *                                                                   S01408
1467 O        E  2     67
1468 O                                    6 'NOTICE'
1469 O************             NITH  LB  19                               S01119
1470 O************             NOTH  LB  30                               S01119
1471 O************             NNETTHLB  41                               S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP6                                           S01408
      *                                                                   S01408
1469 O                         NITH  LB  22                               S01119
1470 O                         NOTH  LB  33                               S01119
1471 O                         NNETTHLB  44                               S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP7                                           S01408
      *                                                                   S01408
1472 O        E  1     67
1473 O***                      RUNA       7                               S01194
1473 O                         BJMRDT     7                               S01194
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0540OPG2                                           S01408
     O*                                                                   S01408
1474 O************             CUMTT L  118                               S01119
1475 O************             BCEQV L  129                               S01119
1474 O                         CUMTT L  121                               S01119
1475 O                         BCEQV L  132                               S01119
1476 O        E  1     68
1477 O                         FFVDA      7
1478 O*************            RND,1 LB  19                               S01119
1479 O*************            RND,2 LB  30                               S01119
1480 O*************            RND,6 LB  41                               S01119
1481 O*************            RND,3 LB  52                               S01119
1482 O*************            RND,4 LB  63                               S01119
1483 O*************            RND,5 LB  74                               S01119
1484 O*************            RND,7 LB  85                               S01119
1485 O*************            RND,8 LB  96                               S01119
1486 O*************            RND,9 LB 107                               S01119
1487 O*************            CUMTT L  118                               S01119
1488 O*************            BCEQV L  129                               S01119
1478 O**********               MKR    B  11                         S01119DT0021
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP8                                           S01408
      *                                                                   S01408
1478 O                         RND,1 LB  22                               S01119
1479 O                         RND,2 LB  33                               S01119
1480 O                         RND,6 LB  44                               S01119
1481 O                         RND,3 LB  55                               S01119
1482 O                         RND,4 LB  66                               S01119
1483 O                         RND,5 LB  77                               S01119
1484 O                         RND,7 LB  88                               S01119
1485 O                         RND,8 LB  99                               S01119
1486 O                         RND,9 LB 110                               S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OOP9                                           S01408
      *                                                                   S01408
1487 O                         CUMTT L  121                               S01119
1488 O                         BCEQV L  132                               S01119
     O/COPY WNCPYSRC,GL0540O001
1489 O        E  1     68 48
1490 O                         STDAYA     7
1491 O                                   10 'TO'
1492 O        E  2     68 48
1493 O                         ENDDYA     7
1494 O************             TOTO,1LB  19                               S01119
1495 O************             TOTO,2LB  30                               S01119
1496 O************             TOTO,6LB  41                               S01119
1497 O************             TOTO,3LB  52                               S01119
1498 O************             TOTO,4LB  63                               S01119
1499 O************             TOTO,5LB  74                               S01119
1500 O************             TOTO,7LB  85                               S01119
1501 O************             TOTO,8LB  96                               S01119
1502 O************             TOTO,9LB 107                               S01119
1478 O**********               TMKR   B  11                         S01119DT0021
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0540OP10                                           S01408
      *                                                                   S01408
1494 O                         TOTO,1LB  22                               S01119
1495 O                         TOTO,2LB  33                               S01119
1496 O                         TOTO,6LB  44                               S01119
1497 O                         TOTO,3LB  55                               S01119
1498 O                         TOTO,4LB  66                               S01119
1499 O                         TOTO,5LB  77                               S01119
1500 O                         TOTO,7LB  88                               S01119
1501 O                         TOTO,8LB  99                               S01119
1502 O                         TOTO,9LB 110                               S01119
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0540OPG                                            S01408
     O*                                                                   S01408
     O********T 3      LR                                              S01117E91
     O********T 3      LR 46                                           E91LN0264
     O        T 3      LR 39                                              LN0264
     O                                   72 '*** END OF REPORT ***'       S01117
1503 O******* T  203   LRNU7                                              S01117
1503 O*DL0540AUT**203***LR**************                            S01117E22608
1504 O****                               22 'REFERENCE DL0540'            S01117
1504 O********************************** 22 'REFERENCE DL0540AU'    S01117E22608
1503 OGL0540AUT  203   LR                                                 E22608
1504 O                                   22 'REFERENCE GL0540AU'          E22608
1505 O***                      TITL      89                               S01194
1505 O                         BJURPT    89                               S01194
1506 O                                  104 'DATE'
1507 O****                     RUNA     112                               S01194
1507 O                         BJMRDT   112                               S01194
1508 O                                  122 'PAGE'
1509 O***                      PAGE  Z  127                               S01117
1509 O                         PAGE1 Z  127                               S01117
1510 O        T  1     LRNU7
1511 O                                   65 'CASH FLOW REPORT'
1512 O                                   80 '- RUN CONTROLS'
1513 O        T  1     LRNU7
1514 O                                   65 '----------------'
1515 O                                   80 '---------------'
1516 O        T  236   LRNU7
1517 O                                   18 'RUN CONTROLS'
1518 O        T  2     LRNU7
1519 O                                   59 'NUMBER'
1520 O*******                            84 'VALUE'                       S01153
1521 O        T  2     LRNU7
1522 O                                   32 'EVENTS FILE RECORDS READ'
1523 O                         RECRED3   59
1524 O*******                  INT,1 Z   81                               S01153
1525 O*******                  DEC,1     84                               S01153
1526 O******* T  2     LRNU7                                              S01153
1527 O*******                            27 'EVENTS FILE CONTROL'         S01153
1528 O*******                            34 'TOTALS'                      S01153
1529 O*******                  NORE  3   59                               S01153
1530 O*******                  HRWN  Z   81                               S01153
1531 O*******                  HRDC      84                               S01153
1532 O*******                U8         102 '** DIFFERENCE **'            S01153
     O        T 22     LRNU7NU5                                           S01129
     O                                   26 'SECURITY TRADING 2'          S01129
     O                                 +  1 'RECORDS READ'                S01129
     O                         #SEIN 3   59                               S01129
     O*******                  INT,4 Z   81                         S01129S01153
     O*******                  DEC,4     84                         S01129S01153
     O******* T  2     LRNU7NU5                                     S01129S01153
     O*******                            26 'SECURITY TRADING 2'    S01129S01153
     O*******                          +  1 'AUDIT TOTALS'          S01129S01153
     O*******                  #SEREC3   59                         S01129S01153
     O*******                  #SETI Z   81                         S01129S01153
     O*******                  #SETD     84                         S01129S01153
1533 O        T 22     LR U7 U8
1534 O************                       22 'REFERENCE DL0540'
1535 O************                       62 'PRINT TERMINATED, '
1536 O************                       82 'DATABASE IN ERROR'           S01194
     O                                   71 '*** PRINT TERMINATED ***'    S01117
1533 O        T 2      LR U7 U8                                           S01194
     O                         DBASE     61                               S01194
     O                                   57 'DATABASE ERROR'              S01194
     O                                   67 'FILE'                        S01194
     O                         DBFILE    78                               S01194
     O        T 13     LR U7 U8                                           S01194
     O                                   49 'OPTION'                      S01194
     O                         DBOPTN    57                               S01194
     O                                   66 'KEY'                         S01194
     O                         DBKEY     96                               S01194
     O        T 3      LRNU7N25                                           S01117
0564 O                                   63 '***   NO DETAILS TO REPO'    S01117
0565 O                                   71 'RT   ***'                    S01117
1537 O******  T 2      LR                                                 E299
1538 O******                             72 '*** END OF REPORT ***'       E299
      /COPY ZSRSRC,ZPOWERZ2                                               CEU011
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**   TABM - MONTH NUMBERS
010203040506070809101112
**   TABD - TABLE OF DAYS IN MONTH
312831303130313130313031
** CMD   **      QCMDEXC                                                  CEU011
CLRPFM FILE(GLEVCFPD)                                                     CEU011
