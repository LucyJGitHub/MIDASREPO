     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Cash flow report by branch')                  *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *       GL0541 - CASH FLOW REPORT BY BRANCH                     *
      *                                                               *
      *       THIS PROGRAM HAS BEEN GENERATED FROM DL0540             *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CLE148             Date 23Jul12               *
      *  Prev Amend No. CER049             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP204             Date 09Feb10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 214232             Date 05Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 04May04               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 223572             Date 03Dec03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003             Date 13Sep00               *
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 151655             Date 13Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163486             Date 14Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 155669             DATE 05MAR99               *
     F*                 154989             DATE 17FEB99               *
     F*                 151083             DATE 23DEC98               *
     F*                 149411             DATE 11DEC98               *
      *                 145423             Date 27OCT98               *
     F*                 CEU020             Date 29May98               *
     F*                 CEU011             Date 29May98               *
     F*                 CEU017             DATE 02Apr98               *
     F*                 CSE007             DATE 18Mar98               *
     F*                 CEU003                Date 13Jan98            *
      *                    CTI001             Date   12AUG97
     F*                 CLE005             Date 22May97                  *
     F*                 CLE004             Date 22May97                  *
     F*                 CLE006             Date 22May97                  *
     F*                 099250             Date 24Feb97                  *
     F*                 098013             Date 12Feb97                  *
     F*                    S01408             DATE   25NOV96             *
     F*                    CFF004             DATE   02OCT96             *
      *                    105140             DATE   20NOV96             *
      * Midas 10.6 (DBA 1.0) -------- PTF09 or earlier ---------------*
     F*                    S01408             DATE   15MAY96             *
     F*                    094563             DATE   13OCT95             *
     F*                    S01408             DATE   08JAN96             *
     F*                    S01408             DATE   12SEP95             *
     F*                    073714             DATE   01MAR95             *
     F*                    081958             DATE   20JAN95             *
     F*                    CIR001             DATE   13JUN95             *
     F*                    S01512             DATE   25NOV94
     F*                    S01408             DATE   21NOV94             *
     F*                    S01473             DATE   30OCT94             *
     F*                    S01408             DATE   21SEP94             *
     F*                    S01408             DATE   18AUG94             *
     F*                    045634             DATE   23APR93             *
     F*                    S01393             DATE   30OCT92             *
     F*                    S01392             DATE   22SEP92             *S01392
     F*                    S01392             DATE   20JUL92             *
     F*                    S01117             DATE   18MAR92             *
     F*                    E33042             DATE   09DEC91             *
     F*                    E28817             DATE   14OCT91             *
     F*                    DT0021             DATE   21MAR91             *
     F*                    E22608             DATE   04SEP90             *
     F*                    E20823             DATE   06FEB90             *
     F*                    E20669             DATE   01JAN90             *
     F*                    LN0746             DATE   14SEP90             *LN0264
     F*                    LN0264             DATE   29MAY90             *LN0264
     F*                    S01243             DATE   11MAY90             *S01243
     F*                    S01243             DATE   11MAY90             *S01243
     F*                    E20778             DATE   18APR90             *
     F*                    S01211             DATE   18APR90             *
     F*                    E299               DATE.  23MAR90             *
     F*                    E257               DATE.  08MAR90             *
     F*                    E196               DATE.  06MAR90             *
     F*                    E175               DATE.  12DEC89             *
     F*            AMEND.  E62                DATE.  15/11/89            *
     F*                                                                  *
      *****************************************************************
      *                                                               *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CER049 - Stamp Tax                                           *
      *  CLE064 - Enhancement of Lending Frequencies                  *
      *  CAP204 - Teller Related APIs - Account Transfer              *
      *  214232 - Exclude Risk Parts Sold event for principal amount. *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha (Recompile)  *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  223572 - Events By Nostro Rprt is showing the All In and     *
      *           NTR Events (Recompile)                              *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CIR003 - Principal Exchange on Cross Currencies IRS          *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps. Coding done for Amortisation of  *
      *           Caps/Collars/Floors only.                           *
     F*  151655 - Inserted additional checking if leap year for 4th      *
     F*           sub-totalling period.                                  *
     F*  163486 - Recompiled due to changes to DLEVNTL7 & EVNTXED.       *
     F*  155669 - GLEVCFL0 is open only when CEU011 .                    *
     F*           Condition the write to GLEVCFL0 on CEU011 being ON .   *
     F*  154989 - EXX spot rate shown on report should be EURO rate,     *
     F*           AND CUM TOTAL is wrongly added to the NET DAY to give  *
     F*           the BASE EQU total which should be the cum tot by spot *
     F*           rate .                                                 *
     F*  151083 - Recompiled over changes in DLEVNTL7                    *
     F*  149411 - Wrong processing for EURO Consolidated Currency.    *
      *  145423 - WINCY is left with previous currency when the       *
      *           selection is requested at branch level.
     F*    CEU020 - EMU Lending Multi-currency Rollover               *
     F*    CEU011 - EMU Position/Risk Enquiries & Reports.            *
     F*    CEU017 - Securities Redenomination Euro Changes               *
     F*             Same coding as CSE007                                *
     F*    CSE007 - Corporate Actions                                    *
     F*    CEU003 - Settlement currency conversion.
     F*  CLE005 - Customer Lending Enhancements - Tranche 3              *
     F*  CLE004 - Customer Lending Enhancements - Tranche 2              *
     F*  CLE006 - Customer Lending Enhancements - Syndications           *
     F*    CTI001 - Midas / Trade Innovation Interface Phase 1
     F*    099250 - Interest settlement for nostro branch doubled.       *
     F*    098013  - Interest reflected on booking branch but not on     *
     F*              the settlement branch.                              *
     F*    S01408  - Addition of Core Hook GL0541CP16                    *
     F*    CFF004 - Increase in size of Price Fields,(Recompiled Only)   *
     F*    105140  - Recompile over changed LVENTZZ.                     *
     F*    S01408  - Core hook GL0541FFP2 added.                         *
     F*              Core hook GL0541FFP1 added.                         *
     F*              Core hook GL0541IP17 added.                         *
     F*              Core hook GL0541IP16 added.                         *
     F*              Core hook GL0541IP15 added.                         *
     F*              Core hook GL0541IP14 added.                         *
     F*              Core hook GL0541IP13 added.                         *
     F*              Core hook GL0541IP12 added.                         *
     F*              Core hook GL0541IP11 added.                         *
     F*              Core hook GL0541IP10 added.                         *
     F*              Core hook GL0541IIP9 added.                         *
     F*              Core hook GL0541IIP8 added.                         *
     F*              Core hook GL0541IIP7 added.                         *
     F*              Core hook GL0541IIP6 added.                         *
     F*              Core hook GL0541IIP5 added.                         *
     F*              Core hook GL0541IIP4 added.                         *
     F*              Core hook GL0541IIP3 added.                         *
     F*              Core hook GL0541IIP2 added.                         *
     F*              Core hook GL0541IIP1 added.                         *
     F*              Core hook GL0541CP15 added.                         *
     F*              Core hook GL0541CP14 added.                         *
     F*              Core hook GL0541CP13 added.                         *
     F*              Core hook GL0541CP12 added.                         *
     F*              Core hook GL0541CP11 added.                         *
     F*              Core hook GL0541OOP3 added.                         *
     F*              Core hook GL0541OOP2 added.                         *
     F*              Core hook GL0541OOP1 added.                         *
0010 F*    094563  - Incorrect fix of 081958 on the ACCNT I-spec,        *
0010 F*              the OR keyword should be one space to the left      *
0010 F*              This caused all ccy nostro opening balance to be    *
0010 F*              zero.                                               *
     F*    S01408  - Addition of Hook GL0541CP10                         *
     F*    S01408  - Addition of Hook GL0541CCP7                         *
     F*              Addition of Hook GL0541CCP8                         *
     F*              Addition of Hook GL0541CCP9                         *
     F*    073714  - OTC ENHANCEMENTS                                    *
0010 F*    081958  - Process Closed Accounts correctly.                  *
     F*  CIR001 - Interest Rate Calendars.                               *
     F*  S01512 - Use payment date for coupon event due on a             *
     F*           holiday and payment on the next working date           *
     F*    S01408 -  Addition of Hook GL0541CCP4                         *
     F*              Addition of Hook GL0541CCP5                         *
     F*              Addition of Hook GL0541CCP6                         *
     F*              Addition of Hook GL0541IIPG                         *
     F*    S01473  - Midas Leo Integration. Addition of LC files and     *
     F*              events processing                                   *
     F*    S01408  - Addition of Hook GL0541CCP2                         *
     F*              Addition of Hook GL0541CCP3                         *
     F*    S01408  - Addition of Hooks:                                  *
     F*              GL0541FFPG,GL0541IPG1,GL0541IPG2,GL0541CPG1,        *
     F*              GL0541CPG2,GL0541CPG3,GL0541CPG4,GL0541CPG5,        *
     F*              GL0541CPG6,GL0541CPG7,GL0541CPG8,GL0541CPG9,        *
     F*              GL0541OPG1,GL0541OPG2,GL0541OPG,GL0541PDR           *
     F*              GL0541CP1,GL0541LH1,GL0541CPG,                      *
     F*    045634  - Addition of lending fees in the OLPOS/PRONOS        *
     F*              processing - previously all lending fees were       *
     F*              omitted by the logical omit criteria. They are      *
     F*              processed in the same way as loan payments etc      *
     F*              In addition the primary file has been altered       *
     F*              to only process LENDING events that are for         *
     F*              AUTO settlement                                     *
     F*    S01393 - Strategic Risk Management Release 10.                *
     F*             Production of SRM Cashflow files is now performed    *
     F*             in a separate program (RM0005).                      *
     F*             (S01211 - SRM ENHANCEMENTS WAS NOT APPLIED TO THIS   *
     F*             PROGRAM AT R10 SO NO BACKING OUT OF S01211 NECESSARY)*
     F*    S01392 - JAPANESE SUBMODULE ENHANCEMENTS (LE)                 *S01392
     F*    S01392 - JAP.SUB-MODULE INCORPORATION (CORE)                  *
     F*    S01117 - RECOMPILED FOR FT RELEASE 10                         *
     F*    E33042 - Recompile due to change to EVNTML7                   *
     F*    E28817 - Recompile due to change to EVNTML7                   *
     F*    DT0021 - HEDGED EVENTS ARE NO LONGER REPORTED ON THIS REPORT  *
     F*    E22608 - PROGRAM RENAMED FROM DL0541                          *
     F*    E20823 - SECURITY INTEREST BEING SHOWN IN WRONG COLUMN,       *
     F*             IF SE2 INSTALLED.                                    *
     F*    E20669 - STEVEAB AND BPEVED RECORD FORMATS REMOVED FROM       *
     F*                LOGICAL EVNTML7.                                  *
     F*    LN0746 - P1 & AU FILES CHANGED TO SAME NAME AS PROGRAM        *LN0746
     F*             DUMMY FILES CREATED                                  *LN0746
     F*    LN0264  -  THE CUMULATIVE TOTAL AND BASE EQUIVALENT FIELDS    *LN0264
     F*               WERE NOT BEING CLEARED FOR EACH CHANGE OF          *LN0264
     F*               CURRENCY/BRANCH. ONLY THE FIRST RECORD ON THE      *LN0264
     F*               NOSTRO FILE WAS BEING READ IRRESPCTIVE OF CURRENCY *LN0264
     F*               AND ALL ACOUNTS WERE BEING PROCESSED IRRESPECTIVE  *LN0264
     F*               OF BRANCH.                                         *LN0264
     F*    S01243  -  PROCESS EVENTS FOR PRINCIPAL INCREASES ON          *S01243
     F*               TERM LOANS                                         *S01243
     F*    E20778 - CALL ITEMS APPEARING AS NOTICE                       *E20778
     F*    S01211 - Corrections made to SR/SFREQB and processing         *S01211
     F*             of Event Type '21C3'                                 *S01211
     F*    E299 - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'           *
     F*    E257 - PRINTER FILE SHOULD BE CHANGED TO SYSTEM REPORT        *
     F*           PRINTER FILE                                           *
     F*    E196 - INTEREST AMOUNT BEING RECORDED FOR INTERBRANCH EVENTS  *
     F*           WILL BE PUT IN  THE INCOMING OR OUTGOING COLUMNS       *
     F*    E175 - TEST FOR MULTIBRANCHING EVENT BEFORE SETTING OUTPUT    *
     F*           AND WHETHER FLOW OF CURRENCY IS IN OR OUT              *
     F*     E62 - FIELD NAME NO LONGER NEEDS REDEFINING - HAS BEEN CHANGED
     F*           IN FOEVED                                              *
     F*                                                                  *
     F*****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F********************************************************************
     F* 01            EVNTML7 HEADER
     F* 02            EVNTML7 DETAIL - DEAL RECORD
     F* 04            EVNTML7 DETAIL - FO RECORD
     F* 09            ACCOUNTS MASTER FILE CATCHALL
     F* 10            ACCOUNTS MASTER DETAIL
     F* 12            EVNTML7 DETAIL - CUSTOMER LENDING
     F* 13            EVNTML7 DETAIL - COMMERCIAL LOAN RECORD
     F* 16            BVNTXED - Letter of credit Record                   S01473
     F**18******      EVNTML7 DETAIL  - SECURITIES TRADING RECORD         E20669
     F**18******      EVNTM DETAIL  - SECURITIES TRADING RECORD           E20669
     F*       21      FIRST CYCLE INDICATOR
     F*       24      DEALING TRAILER HAS BEEN READ
     F*       25      SETOF IF NOTHING WRITTEN TO SPOOL FILE
     F*       30      DETERMINE 4TH SUB-TOTALLING PERIOD
     F*       31      NO DETAILS FOR NEW SUB-TOTALLING PERIOD
     F*       32      DETERMINE 2ND SUB-TOTALLING PERIOD
     F*       33      DETERMINE 3RD SUB-TOTALLING PERIOD
     F*       34      DETERMINE 5TH OR LATER SUB-TOTALLING PERIODS
     F*    35         NEGATIVE EVENT AMOUNT
     F*       36      1ST LEG OF SWAP
     F*       37      DEAL TYPE IS 'PS'
     F*       38      WORK INDICATOR
     F*       40      END OF FILE FOR @A7REB9                             LN0264
     F*       41      ACCOUNT FOR NOSTRO NOT FOUND                        LN0264
     F*       45      CALL/NOTICE LINES HAVE BEEN PRINTED
     F*       46      CONDITIONS HEADING OUTPUT
     F*       47      FFVD EQUALS OR PRECEDES END DAY OF PERIOD
     F*       48      FFVD IS AFTER END DAY OF PERIOD
0046 F******* 50      END OF NOSTRO RECORDS FOR NEW CURRENCY              LN0264
     F* 51            EVNTML7 DETAIL  - FUNDS TRANSFER RECORD
     F*    55         FFVD EQUALS ZERO
     F*       56      FFVD PRECEDES RUN DATE
     F*       57      FFVD DOES NOT PRECEDE RUN DATE
     F*       58      ETYP IS 17V1
     F*       59      DTYP IS C1
     F*       60-65   SET ACCORDING TO EVENT CODE
     F*       67      OUTPUT CALL/NOTICE LINES
     F*       68      OUTPUT DATE ACCUMULATORS LINE AND PERIOD
     F*               SUB-TOTALLING LINES IF APPROPRIATE
     F*       69      INDICATES COUPON EVENT
     F*       70-73   NEW CURRENCY HAS 0-3 DECIMAL PLACES
     F********74******DL0541P1 OPEN FOR OUTPUT                              E257
     F********74******DL0540P1 OPEN FOR OUTPUT                       E257 LN0746
     F********74***** DL0541P1 OPEN FOR OUTPUT                      LN0746E22608
     F*       74      GL0541P1 OPEN FOR OUTPUT                            E22608
     F*       79      DEALING FILE CONTROL DIFFERENCES
     F*       80      COMMERCIAL LOANS FILE CONTROL DIFFERENCES
     F* 81            EVNTML7 DETAIL  - TRADE EVENTS RECORD
     F* 82            END OF FILE ON TREVEA/CPEVEA/DPEVEA/BPEVEA FILES
     F* 83            EVNTML7 DETAIL  - CUSTOMER POSITION EVENTS RECORD
     F* 85            EVNTML7 DETAIL  - DEPOT POSITION EVENTS RECORD
     F**88********    EVNTML7 DETAIL  - BOOK POSITION EVENTS RECORDS01129 E20669
     F*             L1CHANGE OF FED. FUNDS VALUE DATE
     F*             L2CHANGE OF EVENT CURRENCY
     F*             L3CHANGE OF BRANCH CODE
     F*    U5         SECURITY TRADING 1 ONLY - FILE OVERRIDE
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0541FFP1                                           S01408
     F*                                                                   S01408
     F*EVNTML7*IP*AE******     K        DISK                              CEU011
     FDLEVNTL7IP AE           K        DISK                               CEU011
     F***ACCNT** IF  F     400 18AI     2 DISK                                                CGL029
     FACCNT   IF  F     573 24AI     2 DISK                                                   CGL029
     FSDNOSTL1IF  E           K        DISK
     FGLEVCFL0UF  E           K        DISK                      A    UC  CEU011
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0541FFP2                                           S01408
     F*                                                                   S01408
     F**DL0541P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  E257
     F**DL0540P1O***F*****132*****OF*****PRINTER      KINFDS SPOOL   E257 LN0746
     F*DL0541P1O**F*****132**** OF     PRINTER      KINFDS SPOOL  UCLN0746E22608
     FGL0541P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  E22608
     F**DL0541AUO   F     132     OA     PRINTER      KINFDS SPOOLU         E257
     F**DL0540AUO***F*****132*****OA*****PRINTER      KINFDS SPOOLU  E257 LN0746
     F*DL0541AUO  F     132     OA     PRINTER      KINFDS SPOOLU   LN0746E22608
     FGL0541AUO   F     132     OA     PRINTER      KINFDS SPOOLU         E22608
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0541FFPG                                           S01408
     F*                                                                   S01408
     F*                                                                   S01408
     E********************************************************************
     E/COPY ZSRSRC,ZPOWERZ1                                               CEU011
     E                    CPY@    1   1 80
     E                    INT         4 15 0             HASH TOTALS
     E                    DEC         4  3 0             HASH TOTALS
     E                    ACC         9 13 0
     E                    TOT         9 13 0
     E                    RND         9 10 0
     E                    TOTO        9 10 0
     E                    ERND        9 10 0                              CEU011
     E/COPY WNCPYSRC,GL0541E001
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E**
     E                    ZHC        50  3               ZFREQ SR. ARRAY
     E                    ZFMD   12  12  2               ZFREQ SR. ARRAY
     E                    TABM   12  12  2
     E                    TABD   12  12  2
     E                    CMD     1   1 21                                CEU011
     E/COPY ZSRSRC,ZHOLE
     E********************************************************************
     IEVNTXECF    01
     I*    EVNTML7 FILE -DEAL HEADER RECORD
     I*
     IEVNTXEDF    02
     I*    EVNTML7 FILE - DEAL DETAIL RECORD
     I                                              EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP1                                           S01408
     I*                                                                   S01408
     I                                              EBRC  L3
     I                                              ECCY  L2
     I                                              EDAT  L1      5555
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIPG                                           S01408
     I*                                                                   S01408
     I*
     ICEVNXCCF    13
     I*    EVNTML7 - COMMERCIAL LOANS DETAIL RECORD
     I                                              EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP2                                           S01408
     I*                                                                   S01408
     I              BRCA                            EBRC  L3
     I                                              ECCY  L2
     I                                              EDAT  L1      5555
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP3                                           S01408
     I*                                                                   S01408
     ILVENTELF    12
     I* EVNTML7 CUSTOMER LENDING  DETAIL RECORD
     I                                              EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP4                                           S01408
     I*                                                                   S01408
     I                                              EBRC  L3
     I                                              ECCY  L2
     I*******************                           EDAT  L1              E20778
     I                                              EDAT  L1      5555    E20778
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP5                                           S01408
     I*                                                                   S01408
     I              DFCE                            LCEQ
     I              CDOM                            CLOC
     I              ECDP                            DEC1
     I              FACT                            FTYP
     I              FCNO                            FSEQ
     I*
     IBVNTXEDF    16                                                      S01473
     I                                              EAMT          35      S01473
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP6                                           S01408
     I*                                                                   S01408
     I              BRCA                            EBRC  L3              S01473
     I                                              ECCY  L2              S01473
     I                                              EDAT  L1      5555    S01473
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP7                                           S01408
     I*                                                                   S01408
      ** Leo DL Events File                                               S01473
      *                                                                   S01473
     I*STEVEABF****18**********************                               E20669
     I*****EVNTML7*FILE*-*SECURITIES*TRADING*DETAIL                       E20669
     I**************************************        EAMT          35      E20669
     I**************BRCA                            EBRC  L3              E20669
     I**************************************        ECCY  L2              E20669
     I**************************************        EDAT  L1      5555    E20669
     I*
     ITREVEDF     81
     I*    EVNTML7 FILE - TRADE EVENTS DETAIL
     I              TREC                            ETYP
     I              TRVS                            EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP8                                           S01408
     I*                                                                   S01408
     I              TRBA                            EBRC  L3
     I              TRSC                            ECCY  L2
     I              TRVD                            EDAT  L1      5555
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IIP9                                           S01408
     I*                                                                   S01408
     I              TRIO                            CCIO
     I*
     ICPEVEDF     83
     I*    EVNTML7 FILE - CUSTOMER POSITION EVENTS DETAIL
     I              CCCE                            ETYP
     I              CCEA                            EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP10                                           S01408
     I*                                                                   S01408
     I              CCBA                            EBRC  L3
     I              CCEC                            ECCY  L2
     I**************CCDT                            EDAT  L1      5555    S01512
     I              CPYD                            EDAT  L1      5555    S01512
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP11                                           S01408
     I*                                                                   S01408
     I*
     IDPEVEDF     85
     I*    EVNTML7 FILE - DEPOT POSITION EVENTS DETAIL
     I              CCCE                            ETYP
     I              CCEA                            EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP12                                           S01408
     I*                                                                   S01408
     I              CCBA                            EBRC  L3
     I              CCEC                            ECCY  L2
     I**************CCDT                            EDAT  L1      5555    S01512
     I              CCPD                            EDAT  L1      5555    S01512
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP13                                           S01408
     I*                                                                   S01408
     I*
     I*BPEVEDF*****88****************                                     E20669
     I*****EVNTML7*FILE*-*BOOK*POSITION*EVENTS*DETAIL                     E20669
     I**************CCCE                            ETYP                  E20669
     I**************CCEA                            EAMT          35      E20669
     I**************CCBA                            EBRC  L3              E20669
     I**************CCEC                            ECCY  L2              E20669
     I**************CCDT                            EDAT  L1      5555    E20669
     I*
     IFPVNTDDF    51
     I*    EVNTML7 FILE - FUNDS TRANSFER DETAIL
     I                                              EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP14                                           S01408
     I*                                                                   S01408
     I              BRCA                            EBRC  L3
     I                                              ECCY  L2
     I                                              EDAT  L1      5555
      *                                                                                       CAP204
     IGLEVNTDF    53                                                                          CAP204
     I                                              EAMT          35                          CAP204
     I              BRCA                            EBRC  L3                                  CAP204
     I                                              ECCY  L2                                  CAP204
     I                                              EDAT  L1      5555                        CAP204
     IGLEVNTZF    54                                                                          CAP204
     I              ZZ304                           GLFIL                                     CAP204
      *                                                                                       CAP204
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP15                                           S01408
     I*                                                                   S01408
     I*
     IFOEVEDF     04
     I*    EVNTML7 FILE - FO DETAIL RECORD
     I                                              EAMT          35
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP16                                           S01408
     I*                                                                   S01408
     I*****         BRCA                            EBRC  L3              E62
     I                                              EBRC  L3              E62
     I                                              ECCY  L2
     I                                              EDAT  L1      5555
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IPG1                                           S01408
     I*                                                                   S01408
     I*                                                                   S01408
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IPG2                                           S01408
     I*                                                                   S01408
     I*                                                                   S01408
     I*
     IACCNT   NS  10   1 CD
0342 I********OR* 10   1 CC                                         081958094563
0342 I       OR   10   1 CC                                               094563
     I*    ACCOUNTS MASTER FILE
     I                                    P  56  630LDBL
     I*
     I        NS  09
     I*    CATCHALL
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0541IP17                                           S01408
     I*                                                                   S01408
     I*
     I*
     ISPOOL       DS
     I** FILE INFORMATION DATA STRUCTURE
     I                                       83  92 SFILE
     I                                    B 123 1240SFNUM
     ISPOOLU      DS
     I*  FILE INFORMATION DATA STRUCTURE
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I*
     IRUNDAT      DS
     I** DATA STRUCTURE FOR MULTI-BRANCH INDICATOR USING RUNDAT
     I                                       13  13 @MBIN
     I*
     I*  DUMMY RECORD FORMATS FOR USE BY ACCESS OBJECTS
     I@BANK     E DSSDBANKPD
     I** EXTERNAL DS FOR BANK DETAILS
     I*
     I*@MMOD**** E DSSDMMODPD                                             DT0021
     I***EXTERNAL*DS*FOR*MODULES*DETAILS                                  DT0021
     I**********                                                          DT0021
     I@GELR     E DSSDGELRPD
     I** EXTERNAL DS FOR GENERAL LEDGER DETAILS
     I*
     I@CURR     E DSSDCURRPD
     I** EXTERNAL DS FOR CURRENCY DETAILS
     I*
     I*@FAIS**** E DSSDFAISPD                                             DT0021
     I***EXTERNAL*DS*FOR*FRA/IRS**DETAILS                                 DT0021
     I**********                                                          DT0021
     I@BRCH     E DSSDBRCHPD
     I** EXTERNAL DS FOR BRANCH DETAILS
     ISCSARD    E DSSCSARDPD                                              S01473
      ** Switchable Features File                                         S01473
      *                                                                   S01473
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01117
     ISDMOD     E DSSDMMODPD                                              CTI001
     I**  EXTERNAL DS FOR MODULE ID'S                                     CTI001
     I*                                                                   CTI001
     I/COPY ZSRSRC,ZHOLI
     I/EJECT
     C*
     C** PARAMETERS FOR MULTI-BRANCHING
     C*
     C           *ENTRY    PLIST
     C                     PARM           SEQ     5
     C                     PARM           BRNCH   3
     C*    CONDITION FIRST CYCLE CALCS. ON EVENT FILE HEADER
     C/COPY WNCPYSRC,GL0541C001
     C*
     C   21                GOTO DETAIL
     C                     SETON                     21
     C/COPY WNCPYSRC,GL0541C002
     C                     MOVEACPY@      BIS@   80
     C*  OBTAIN BANK DETAILS FROM SDBANKPD
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG    '@RTCD   7
     C                     PARM '*FIRST  '@OPTN   7
     C           @BANK     PARM @BANK     DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBANKPD'DBFILE 10         *************
     C                     MOVEL'001'     DBASE   3         *DBERROR 001*
     C                     MOVEL@OPTN     DBOPTN  7         *************
     C                     MOVEL@OPTN     DBKEY  29
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
      *                                                                   CEU011
      * Obtain General Ledger Details Via Access Object                   CEU011
      *                                                                   CEU011
     C**********           CALL 'AOGELRR0'                                             CEU011 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       CEU011
     C                     PARM '*FIRST ' @OPTN   7                       CEU011
     C********** @GELR     PARM @GELR     DSFDY                                        CEU011 CGL029
     C           @GELR     PARM @GELR     DSSDY                                               CGL029
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANK                                    CEU011
     C                     MOVEL'SDGELRPD'DBFILE           **********     CEU011
     C                     MOVEL'011'     DBASE            *DBERR 11*     CEU011
     C                     MOVEL@OPTN     DBOPTN  7        **********     CEU011
     C                     MOVEL@OPTN     DBKEY                           CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     GOTO END                                       CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CTI001
     C                     CALL 'AOMMODR0'                                CTI001
     C                     PARM '*DBERR ' @RTCD                           CTI001
     C                     PARM '*FIRST ' @OPTN                           CTI001
     C           SDMOD     PARM SDMOD     DSFDY                           CTI001
      *                                                                   CTI001
     C           @RTCD     IFNE *BLANK                                    CTI001
     C                     MOVEL'SDMMODPD'DBFILE            ************* CTI001
     C                     MOVEL'002'     DBASE             *DBERROR 002* CTI001
     C                     MOVEL@OPTN     DBOPTN            ************* CTI001
     C                     MOVEL@OPTN     DBKEY                           CTI001
     C                     SETON                     U7U8LR               CTI001
     C                     EXSR *PSSR                                     CTI001
     C                     GOTO END                                       CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     MOVE 'Y'       ULEO                            CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG1                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C*
     C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C*
     C                     EXSR PEREND
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG                                            S01408
     C*                                                                   S01408
     C*
     C**********                                                          DT0021
     C***OBTAIN*MODULES*DETAILS*VIA*ACCESS*OBJECT                         DT0021
     C**********           CALL 'AOMMODR0'                                DT0021
     C**********           PARM '*MSG   ' @RTCD   7                       DT0021
     C**********           PARM '*FIRST ' @OPTN   7                       DT0021
     C********** @MMOD     PARM @MMOD     DSFDY                           DT0021
     C**********                                                          DT0021
     C********** @RTCD     IFNE *BLANK                                    DT0021
     C**********           MOVEL'SDMMODPD'DBFILE 10        **********     DT0021
     C**********           MOVEL'002'     DBASE   3        *DBERR 02*     DT0021
     C**********           MOVEL@OPTN     DBOPTN  7        **********     DT0021
     C**********           MOVEL@OPTN     DBKEY  29                       DT0021
     C**********           SETON                     U7U8LR               DT0021
     C**********           EXSR *PSSR                                     DT0021
     C**********           GOTO END                                       DT0021
     C**********           END                                            DT0021
     C**********                                                          DT0021
     C***IF*FRA/IRS*FLAG*IS*ON*THEN*OBTAIN*HEDGED*EVENTS*ON*CASHFLOW      DT0021
     C***FLAG*FROM*SDFAISPD,*NEW*STANDING*DATA                            DT0021
     C********** BGFIIN    IFEQ 'Y'                                       DT0021
     C**********                                                          DT0021
     C***OBTAIN*FRA/IRS*DETAILS*VIA*ACCESS*OBJECT*FOR*HEDGED*EVENTS*ON    DT0021
     C**CASHFLOW                                                          DT0021
     C**********           CALL 'AOFAISR0'                                DT0021
     C**********           PARM '*MSG   ' @RTCD   7                       DT0021
     C**********           PARM '*FIRST ' @OPTN   7                       DT0021
     C********** @FAIS     PARM @FAIS     DSFDY                           DT0021
     C**********                                                          DT0021
     C********** @RTCD     IFNE *BLANK                                    DT0021
     C**********           MOVEL'SDFAISPD'DBFILE 10        **********     DT0021
     C**********           MOVEL'003'     DBASE   3        *DBERR 03*     DT0021
     C**********           MOVEL@OPTN     DBOPTN  7        **********     DT0021
     C**********           MOVEL@OPTN     DBKEY  29                       DT0021
     C**********           SETON                     U7U8LR               DT0021
     C**********           EXSR *PSSR                                     DT0021
     C**********           MOVE 'N'       BQHEOC                          DT0021
     C**********           END                                            DT0021
     C**********                                                          DT0021
     C**********           ELSE                                           DT0021
     C**********           MOVE 'N'       BQHEOC                          DT0021
     C**********           END                                            DT0021
     C*
      *                                                                   S01473
      ** Check the switchable features file for the Midas Leo Integration S01473
      ** number, S01473. If it is present, set the flag ULEO to 'Y'       S01473
     C                     CALL 'AOSARDR0'                                S01473
     C                     PARM *BLANKS   @RTCD                           S01473
     C                     PARM '*VERIFY' @OPTN                           S01473
     C                     PARM 'S01473'  @KEY    6                       S01473
     C           SCSARD    PARM SCSARD    DSFDY                           S01473
      *                                                                   S01473
     C           @RTCD     IFEQ *BLANKS                                   S01473
     C                     MOVE 'Y'       ULEO    1                       S01473
     C                     END                                            S01473
      **  Access SAR details file to determine if Australian              CIR001
      **  Modifications is switched on.                                   CIR001
     C                     CALL 'AOSARDR0'                                CIR001
     C                     PARM *BLANKS   @RTCD                           CIR001
     C                     PARM '*VERIFY' @OPTN                           CIR001
     C                     PARM 'CIR001'  @SARD   6                       CIR001
     C           SCSARD    PARM SCSARD    DSFDY                           CIR001
      *                                                                   CIR001
     C           @RTCD     IFEQ *BLANKS                                   CIR001
     C                     MOVE 'Y'       CIR001  1                       CIR001
     C                     ELSE                                           CIR001
     C                     MOVEL'N'       CIR001                          CIR001
     C                     END                                            CIR001
      *                                                                   CLE005
      **  Access Switchable SAR details for the existence of CLE005       CLE005
      **  (Tranch 3)                                                      CLE005
      *                                                                   CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANK    @RTCD                           CLE005
     C                     PARM '*VERIFY' @OPTN                           CLE005
     C                     PARM 'CLE005'  @SARD                           CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANK                                    CLE005
     C                     MOVE 'Y'       CLE005                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           @RTCD     IFNE *BLANKS                                   CLE005
     C           @RTCD     ANDNE'*NRF  '                                  CLE005
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE005
     C                     MOVEL'08'      DBASE            * DBERR 08 *   CLE005
     C                     MOVEL@OPTN     DBKEY            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     EXSR *PSSR                                     CLE005
     C                     GOTO END                                       CLE005
     C                     END                                            CLE005
      *                                                                   CLE004
      **  Access Switchable SAR details for the existence of CLE004       CLE004
      **  (Tranch 2)                                                      CLE004
      *                                                                   CLE004
     C                     MOVE 'N'       CLE004  1                       CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANK    @RTCD                           CLE004
     C                     PARM '*VERIFY' @OPTN                           CLE004
     C                     PARM 'CLE004'  @SARD                           CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANK                                    CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANKS                                   CLE004
     C           @RTCD     ANDNE'*NRF  '                                  CLE004
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE004
     C                     MOVEL'09'      DBASE            * DBERR 09 *   CLE004
     C                     MOVEL@OPTN     DBKEY            ************   CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     GOTO END                                       CLE004
     C                     END                                            CLE004
      *                                                                   CLE006
      **  Access Switchable SAR details for the existence of CLE006       CLE006
      **  (Syndications)                                                  CLE006
      *                                                                   CLE006
     C                     MOVE 'N'       CLE006  1                       CLE006
     C                     CALL 'AOSARDR0'                                CLE006
     C                     PARM *BLANK    @RTCD                           CLE006
     C                     PARM '*VERIFY' @OPTN                           CLE006
     C                     PARM 'CLE006'  @SARD                           CLE006
      *                                                                   CLE006
     C           @RTCD     IFEQ *BLANK                                    CLE006
     C                     MOVE 'Y'       CLE006  1                       CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           @RTCD     ANDNE'*NRF  '                                  CLE006
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE006
     C                     MOVEL'10'      DBASE            * DBERR 10 *   CLE006
     C                     MOVEL@OPTN     DBKEY            ************   CLE006
     C                     SETON                     U7U8LR               CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     GOTO END                                       CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
      ** Check if Position/Risk Enquiries & Reports feature (CEU011)      CEU011
      ** is on.                                                           CEU011
      *                                                                   CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*VERIFY' @OPTN                           CEU011
     C                     PARM 'CEU011'  @KEY    6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFEQ *BLANKS                                   CEU011
     C                     MOVE 'Y'       CEU011  1                       CEU011
     C                     MOVE *ON       *IN86                           CEU011
     C                     ELSE                                           CEU011
     C                     MOVE 'N'       CEU011                          CEU011
     C                     MOVE *OFF      *IN86                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF  '                                  CEU011
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU011
     C                     MOVEL'09'      DBASE            * DBERR 09 *   CEU011
     C                     MOVEL'CEU011'  DBKEY            ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      **  Access Switchable SAR details for the existence of CEU020       CEU020
      **  (Syndications)                                                  CEU020
      *                                                                   CEU020
     C                     MOVE 'N'       CEU020  1                       CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANK    @RTCD                           CEU020
     C                     PARM '*VERIFY' @OPTN                           CEU020
     C                     PARM 'CEU020'  @SARD                           CEU020
      *                                                                   CEU020
     C           @RTCD     IFEQ *BLANK                                    CEU020
     C                     MOVE 'Y'       CEU020                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CEU020
     C           @RTCD     IFNE *BLANKS                                   CEU020
     C           @RTCD     ANDNE'*NRF  '                                  CEU020
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CEU020
     C                     MOVEL'11'      DBASE            * DBERR 11 *   CEU020
     C                     MOVEL@OPTN     DBKEY            ************   CEU020
     C                     SETON                     U7U8LR               CEU020
     C                     EXSR *PSSR                                     CEU020
     C                     GOTO END                                       CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CIR006
      ** Determine if SAR CIR006 is installed                             CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY '@OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD                           CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
      *                                                                   CIR006
     C           @RTCD     IFNE *BLANKS                                   CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE                          CIR006
     C                     MOVEL'24'      DBASE                           CIR006
     C                     MOVEL'CIR006'  DBKEY                           CIR006
     C                     MOVE *ON       *INU7                           CIR006
     C                     MOVE *ON       *INU8                           CIR006
     C                     MOVE *ON       *INLR                           CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR003
      ** Determine if SAR CIR003 is installed                             CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY '@OPTN                           CIR003
     C                     PARM 'CIR003'  @SARD                           CIR003
     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANKS                                   CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'DBFILE                          CIR003
     C                     MOVEL'25'      DBASE                           CIR003
     C                     MOVEL'CIR003'  DBKEY                           CIR003
     C                     MOVE *ON       *INU7                           CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     MOVE *ON       *INLR                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                                       CLE028
      ** Check if enhancement CLE028 is installed                                             CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD                                               CLE028
     C                     PARM '*VERIFY 'POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD   6                                           CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'CLE028'  DBKEY                                               CLE028
     C                     MOVEL'26'      DBASE                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CAS009
      ** Access SAR Details File to determine if CAS009 is installed                          CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD   7                                           CAS009
     C                     PARM '*VERIFY' POPTN   7                                           CAS009
     C                     PARM 'CAS009'  PSARD   6                                           CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
      ** Handle Datebase Error.                                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE *BLANK                                                        CAS009
     C           PRTCD     ANDNE'*NRF   '                                                     CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVEL'CAS009'  DBKEY                                               CAS009
     C                     MOVEL'26'      DBASE                                               CAS009
     C                     MOVE *ON       *INU7                                               CAS009
     C                     MOVE *ON       *INU8                                               CAS009
     C                     MOVE *ON       *INLR                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      ** CAS009 is installed                                                                  CAS009
      *                                                                                       CAS009
     C           PRTCD     IFEQ *BLANK                                                        CAS009
     C                     MOVE 'Y'       CAS009  1                                           CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'N'       CAS009                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAP204
      ** Check if enhancement CAP204 is installed                                             CAP204
      *                                                                                       CAP204
     C                     CALL 'AOSARDR0'                                                    CAP204
     C                     PARM *BLANKS   PRTCD                                               CAP204
     C                     PARM '*VERIFY 'POPTN   7                                           CAP204
     C                     PARM 'CAP204'  PSARD   6                                           CAP204
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP204
      *                                                                                       CAP204
     C           PRTCD     IFNE *BLANKS                                                       CAP204
     C           PRTCD     ANDNE'*NRF   '                                                     CAP204
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP204
     C                     MOVEL'CAP204'  DBKEY                                               CAP204
     C                     MOVEL'27'      DBASE                                               CAP204
     C                     MOVE *ON       *INU7                                               CAP204
     C                     MOVE *ON       *INU8                                               CAP204
     C                     MOVE *ON       *INLR                                               CAP204
     C                     EXSR *PSSR                                                         CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C           PRTCD     IFEQ *BLANKS                                                       CAP204
     C                     MOVE 'Y'       CAP204  1                                           CAP204
     C                     ELSE                                                               CAP204
     C                     MOVE 'N'       CAP204                                              CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CER049
      ** Determine if SAR CER049 is installed                                                 CER049
      *                                                                                       CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*VERIFY '@OPTN                                               CER049
     C                     PARM 'CER049'  @SARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
      *                                                                                       CER049
     C           @RTCD     IFNE *BLANKS                                                       CER049
     C           @RTCD     ANDNE'*NRF   '                                                     CER049
     C                     MOVEL'SCSARDPD'DBFILE                                              CER049
     C                     MOVEL'28'      DBASE                                               CER049
     C                     MOVEL'CER049'  DBKEY                                               CER049
     C                     MOVE *ON       *INU7                                               CER049
     C                     MOVE *ON       *INU8                                               CER049
     C                     MOVE *ON       *INLR                                               CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           @RTCD     IFEQ *BLANKS                                                       CER049
     C                     MOVE 'Y'       CER049  1                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE 'N'       CER049                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                   CEU020
     C           CEU011    IFEQ 'Y'                                       CEU011
      *                                                                   154989
      ** Obtain Euro spot rate for Consolidated Euro EXX in report        154989
      ** via access object from SDCURRPD .                                154989
      *                                                                   154989
     C                     CALL 'AOCURRR0'                                154989
     C                     PARM '*MSG   ' @RTCD                           154989
     C                     PARM '*KEY   ' @OPTN                           154989
     C                     PARM BKEURO    @AJCD                           154989
     C           @CURR     PARM @CURR     DSSDY                           154989
      *                                                                   154989
     C           @RTCD     IFNE *BLANK                                    154989
     C                     MOVEL'SDCURRPD'DBFILE                          154989
     C                     MOVEL'23'      DBASE            ************   154989
     C                     MOVELBKEURO    DBKEY            * DBERR 23 *   154989
     C                     MOVEL@OPTN     DBOPTN           ************   154989
     C                     SETON                     U7U8LR               154989
     C                     EXSR *PSSR                                     154989
     C                     GOTO END                                       154989
     C                     ELSE                                           154989
     C                     MOVELA6SPRT    EUSPRT 138                      154989
     C                     MOVELA6MDIN    EUMDIN  1        EURO M/D IND   154989
     C                     ENDIF                                          154989
      *                                                                   CEU011
      ** Obtain currency details via Access object from SDCURRPD          CEU011
      *                                                                   CEU011
     C                     CALL 'AOCURRR0'                                CEU011
     C                     PARM '*MSG   ' @RTCD   7                       CEU011
     C                     PARM '*KEY   ' @OPTN   7                       CEU011
     C                     PARM BJCYCD    @AJCD   3                       CEU011
     C           @CURR     PARM @CURR     DSSDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANK                                    CEU011
     C                     MOVEL'SDCURRPD'DBFILE 10                       CEU011
     C                     MOVEL'10'      DBASE   3        ************   CEU011
     C                     MOVELBJCYCD    DBKEY  29        * DBERR 10 *   CEU011
     C                     MOVEL@OPTN     DBOPTN  7        ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     GOTO END                                       CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      **   Save details fields for settlement currency                    CEU011
      *                                                                   CEU011
     C                     MOVE A6INCY    BCCY1   1                       CEU011
     C                     MOVE A6SPRT    WSSPRT 138                      CEU011
     C                     MOVE A6NBDP    WSNBDP  10                      CEU011
     C**********           MOVE A6SPAE    WSSPAE  4                                    CEU011 CGL029
     C                     MOVE A6SPAE    WSSPAE 10                                           CGL029
     C                     MOVE A6MDIN    WSMDIN  1                       CEU011
      *                                                                   CEU011
     C                     Z-ADD21        MSGLEN 155                      CEU011
     C                     CALL 'QCMDEXC'                                 CEU011
     C                     PARM           CMD,1                           CEU011
     C                     PARM           MSGLEN                          CEU011
      *                                                                   CEU011
     C                     OPEN GLEVCFL0                                  CEU011
     C                     MOVE 'Y'       PR3     1                       CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP7                                           S01408
     C*                                                                   S01408
      *                                                                   S01473
     C           DETAIL    TAG                             ** DETAIL TAG *
     C/COPY WNCPYSRC,GL0541C003
     C*   ACC. NUMBER OF RECORDS READ.
      * Keep separate record count for the Security (II) Events.
      *
     C           *IN81     IFEQ '1'
     C           *IN83     OREQ '1'
     C           *IN85     OREQ '1'
     C********** *IN88     OREQ '1'                                       E20669
     C                     ADD  1         #SEIN   50
     C                     ELSE
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP4                                           S01408
     C*                                                                   S01408
      *
     C           RECRED    ADD  1         RECRED  50
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP5                                           S01408
     C*                                                                   S01408
     C                     END
      *                                                                   S01473
      ** If processing LEO events, check if a LEO event record was        S01473
      ** read and if so bypass check for EOF that follows and set         S01473
      ** LEO record read flag to 'Y'                                      S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           *IN16     ANDEQ'1'                                       S01473
     C                     MOVE 'Y'       ULREC   1                       S01473
     C                     ELSE                                           S01473
     C  N02N12N13
     C*ANN18N81N51****************                                        E20669
     CANN81N51                                                            E20669
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP6                                           S01408
     C*                                                                   S01408
     C*ANN04N83N85****************                                        E20669
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     CANN53                                                                                   CAP204
     CANN04N83N85          GOTO END                                       E20669
     C*ANN88****************GOTO END                                      E20669
      *                                                                   S01473
     C                     END                                            S01473
     C*
     C** MULTI-BRANCHING OUTPUT CONTROL
     C           *INL3     IFEQ '1'
     C*********************CLOSEDL0541P1                                    E257
     C*********************CLOSEDL0540P1                             E257 LN0746
     C*********************CLOSEDL0541P1                            LN0746E22608
     C                     CLOSEGL0541P1                                  E22608
     C                     MOVE *BLANKS   WINCY                           145423
     C           BRNCH     IFEQ 'ALL'
     C           BRNCH     OREQ EBRC
     C* ALLOW OUTPUT:
     C                     SETON                         74
     C                     Z-ADD0         PAGE
     C*
     C*********************OPEN DL0541P1                                    E257
     C*********************OPEN DL0540P1                             E257 LN0746
     C*********************OPEN DL0541P1                            LN0746E22608
     C                     OPEN GL0541P1                                  E22608
     C*
     C* IF P1 FILE OPENED THEN SET ON FLAG
     C                     MOVE '1'       *IN25
     C*
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C* REPORT SPOOL FILE GENERATION
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM EBRC      @PARM   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**  GET BRANCH NAME :
     C*    CALL ACCESS PROGRAM FOR BRANCH DETAILS
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM EBRC      @DSNB   3
     C********** @BRCH     PARM @BRCH     DSFDY                                               CGL029
     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
     C*
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBRCHPD'DBFILE 10        **********
     C                     MOVEL'07'      DBASE            *DBERR 07*
     C                     MOVEL@OPTN     DBOPTN           **********
     C                     MOVELEBRC      DBKEY
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
      *                                                                   CEU011
      ** If CEU011 is on.                                                 CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           PR3       IFEQ 'Y'                                       CEU011
     C                     CLOSEGLEVCFL0                                  CEU011
     C                     MOVE 'N'       PR3                             CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     Z-ADD21        MSGLEN 155                      CEU011
     C                     CALL 'QCMDEXC'                                 CEU011
     C                     PARM           CMD,1                           CEU011
     C                     PARM           MSGLEN                          CEU011
      *                                                                   CEU011
     C                     OPEN GLEVCFL0                                  CEU011
     C                     MOVE 'Y'       PR3                             CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ELSE
     C                     SETOF                         74
     C                     GOTO END                                       LN0264
     C                     END
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP11                                           S01408
     C*                                                                   S01408
     C**
     C*    WHEN NEW CURRENCY IS ENCOUNTERED, ACCUMULATE TOTAL BALANCE OF
     C*    ALL NOSTRO ACCOUNTS FOR THAT CURRENCY IN INT,2  DEC,2
     C*    AND FIND SPOT RATE
     C*
     C  NL2                GOTO NOTL2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG3                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C** OBTAIN CURRENCY DETAILS VIA ACCESS OBJECT FROM SDCURRPD
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM ECCY      @AJCD   3
     C           @CURR     PARM @CURR     DSSDY
     C*
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'DBFILE 10
     C                     MOVEL'004'     DBASE   3        **********
     C                     MOVELECCY      DBKEY  29        *DBERR 04*
     C                     MOVEL@OPTN     DBOPTN  7        **********
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C                     MOVE A6INCY    WINCY   1                       CEU011
     C                     ENDIF                                          CEU011
     C*
     C* OBTAIN NUMBER OF DECIMAL PLACES FOR THIS CURRENCY
     C           A6NBDP    COMP 1                      7071
     C           A6NBDP    COMP 2                    73  72
     C           CEU011    IFEQ 'Y'                                       149411
     C           *IN70     IFEQ '1'                                       149411
     C                     MOVE 6         E       10                      149411
     C                     ELSE                                           149411
     C                     MOVE 4         E                               149411
     C                     END                                            149411
     C                     END                                            149411
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP12                                           S01408
     C*                                                                   S01408
     C*
     C*    CLEAR ACCUMULATORS FOR NEW CURRENCY
     C                     Z-ADD0         INT,2
     C                     Z-ADD0         DEC,2
     C*
     C                     Z-ADD0         CUMTT                           LN0264
     C                     Z-ADD0         BCEQV                           LN0264
     C*                                                                   LN0264
     C*                                                                   LN0264
     C**SET-LOWER*LIMITS AND READ NOSTRO DETAILS                          LN0264
     C*****READ*NOSTRO RECORDS                                            LN0264
     C******-*FIND*LEDGER BALANCE FOR NOSTRO IF IT IS LIVE AND            LN0264
     C******-*THE*CORRECT CURRENCY                                        LN0264
     C************LOVAL    SETLL@A7REB9                                   LN0264
     C***********RDNSTR    TAG                             ** RDNSTR TAG *LN0264
     C*************        READ @A7REB9                  50               LN0264
     C***50********        GOTO NOTL2                      END OF FILE    LN0264
     C***********A7CYCD    COMP ECCY                 5050  CORRECT CCY ?  LN0264
     C***50********        GOTO NOTL2                                     LN0264
     C*************                                                       LN0264
     C*****SET*UP*KEY FOR CHAINING TO ACCOUNTS MASTER                     LN0264
     C*************                                                       LN0264
     C*************        MOVELA7CUST    LKACC   9                       LN0264
     C*************        MOVE A7CYCD    LKACC                           LN0264
     C*************        MOVELA7ACCD    RKACC   6                       LN0264
     C*************        MOVE A7ACSN    RKACC                           LN0264
     C*************        MOVELRKACC     WK9     9                       LN0264
     C*************        MOVE A7BRCD    WK9                             LN0264
     C*************        MOVELLKACC     KEYACC 18                       LN0264
     C*************        MOVE WK9       KEYACC                          LN0264
     C*************                                                       LN0264
     C*****CHAIN*TO ACCOUNTS MASTER                                       LN0264
     C*************        SETOF                     10                   LN0264
     C***********KEYACC    CHAINACCNT                99                   LN0264
     C*************                                                       LN0264
     C**N10********        GOTO RDNSTR                        ERROR       LN0264
     C*************                                                       LN0264
     C*****ACCUMULATE LEDGER BALANCE FOR ACCOUNTS                         LN0264
     C***********LDBL      DIV  1000      ZZAMT                           LN0264
     C*************        Z-ADD2         X       10                      LN0264
     C*************        EXSR HASH                                      LN0264
     C*************        GOTO RDNSTR                                    LN0264
     C*                                                                   LN0264
     C* SET-LOWER LIMITS AND READ NOSTRO DETAILS                          LN0264
     C*    READ NOSTRO RECORDS                                            LN0264
     C*     - FIND LEDGER BALANCE FOR NOSTRO IF IT IS LIVE AND            LN0264
     C*       THE CORRECT CURRENCY                                        LN0264
     C*                                                                   LN0264
     C           ECCY      SETLL@A7REB9                                   LN0264
     C                     READ @A7REB9                  40               LN0264
     C           *IN40     DOWEQ'0'                                       LN0264
     C           ECCY      ANDEQA7CYCD                                    LN0264
     C           EBRC      IFEQ A7BRCD                                    LN0264
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP2                                           S01408
     C/COPY WNCPYSRC,GL0541CP20
     C*                                                                   S01408
     C*                                                                   LN0264
     C*    SET UP KEY FOR CHAINING TO ACCOUNTS MASTER                     LN0264
     C*                                                                   LN0264
     C                     MOVELA7CUST    LKACC   9                       LN0264
     C                     MOVE A7CYCD    LKACC                           LN0264
     C**********           MOVELA7ACCD    RKACC   6                                    LN0264 CGL029
     C                     MOVELA7ACCD    RKACC  12                                           CGL029
     C                     MOVE A7ACSN    RKACC                           LN0264
     C**********           MOVELRKACC     WK9     9                                    LN0264 CGL029
     C                     MOVELRKACC     WK9    15                                           CGL029
     C                     MOVE A7BRCD    WK9                             LN0264
     C**********           MOVELLKACC     KEYACC 18                                    LN0264 CGL029
     C                     MOVELLKACC     KEYACC 24                                           CGL029
     C                     MOVE WK9       KEYACC                          LN0264
     C*                                                                   LN0264
     C*    CHAIN TO ACCOUNTS MASTER                                       LN0264
     C*                                                                   LN0264
     C           KEYACC    CHAINACCNT                41                   LN0264
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP10                                           S01408
     C/COPY WNCPYSRC,GL0541CP17                                           S01408
     C*                                                                   S01408
     C*                                                                   LN0264
     C*    ACCUMULATE LEDGER BALANCE FOR ACCOUNTS                         LN0264
     C           *IN41     IFEQ '0'                                       LN0264
     C           LDBL      DIV  1000      ZZAMT                           LN0264
     C                     Z-ADD2         X       10                      LN0264
     C                     EXSR HASH                                      LN0264
     C                     END                                            LN0264
     C*                                                                   LN0264
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP3                                           S01408
     C/COPY WNCPYSRC,GL0541CP18                                           S01408
     C*                                                                   S01408
     C                     END                                            LN0264
     C                     READ @A7REB9                  40               LN0264
     C                     END                                            LN0264
     C*                                                                   LN0264
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG4                                           S01408
     C/COPY WNCPYSRC,GL0541CP19
     C*                                                                   S01408
     C*                                                                   S01408
     C*
     C*    APPLY DECIMAL PLACES TO ACCUMULATED AMOUNTS
     C********** NOTL2     TAG                             ** NOTL2 TAG **S01211
     C   L2                MOVE INT,2     CUMTT  100
     C   L2 71   CUMTT     DIV  10        CUMTT     H
     C   L2 72   CUMTT     DIV  100       CUMTT     H
     C   L2 73   CUMTT     DIV  1000      CUMTT     H
     C* CALCULATIONS DONE DEPENDING ON THE VALUE OF SPOT RATE AND
     C* MULT/DIV INDICATOR ,I.E. SPOT RATE NE ZERO
     C   L2      A6SPRT    IFNE 0
     C           A6MDIN    ANDEQ'D'
     C   L2      CUMTT     DIV  A6SPRT    BCEQV     H
     C                     END
     C   L2      A6SPRT    IFNE 0
     C           A6MDIN    ANDEQ'M'
     C   L2      CUMTT     MULT A6SPRT    BCEQV     H
     C                     END
     C   L2                Z-ADD2         D       50
     C*                                                                   S01211
     C*----------------------------------------------------------------   S01211
     C*                                                                   S01211
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG5                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C*                                                                   S01211
     C           NOTL2     TAG                             ** NOTL2 TAG **S01211
     C*
     C*    OUTPUT HEADINGS
     C   L2
     COR OF                SETON                     46
     C   46                EXCPT
     C                     SETOF                     46
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541LH1                                            S01408
     C*                                                                   S01408
     C*
     C  NL1                GOTO SETIND
     C*
     C***  CONVERT EVENT DATE
      *                                                                   CEU011
      ** If CEU011 is switched on,save the event date to                  CEU011
      ** Temporary variable.                                              CEU011
      *                                                                   CEU011
     C********** CEU011    IFEQ 'Y'                                CEU011 149411
     C**********           Z-ADDEDAT      EEDAT   50               CEU011 149411
     C**********           ENDIF                                   CEU011 149411
      *                                                                   CEU011
     C                     MOVE EDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    FFVDAN  7
     C*
     C           EDAT      COMP BJRDNB               575657
     C   56                GOTO SETIND
     C   45                GOTO TAG45
     C*
     C*    OUTPUT CALL, NOTICE AND OPENING BALANCE LINES
     C  N45                EXSR DEPS
     C  N45                SETON                     67
     C  N45                EXCPT
     C/COPY WNCPYSRC,GL0541C008
     C  N45                SETOF                     67
     C                     SETON                     45
     C           EDAT      COMP ENDDY                484747
     C   48                EXSR NXTDAY
     C                     GOTO SETIND
     C*
     C           TAG45     TAG                             ** TAG45 TAG **
     C*    THIS PART DONE IF NEW DATE EXCEEDS RUND AND CALL/NOTICE LINES
     C*    HAVE ALREADY BEEN OUTPUT
     C           EDAT      COMP ENDDY                484747
     C*
     C*    PERFORM S/R TO DIVIDE AND OUTPUT AMOUNTS
     C                     EXSR DIVOUT
     C*
     C*    OBTAIN START AND END DATES FOR NEXT PERIOD
     C   48                EXSR NXTDAY
     C           SETIND    TAG                             ** SETIND TAG *
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG6                                           S01408
     C*                                                                   S01408
     C                     MOVE FFVDAN    FFVDA   7
     C*
     C                     SETOF                       3637
     C*    CHECK FOR INTERNAL CONTRACT EVENT
     C*
     C*    CHECK SWAP LEG INDICATOR
     C*
     C*    CHECK FOR POSITION SWAP AND FIRST LEG INDICATOR IF DEAL EVENT
     C*
     C                     SETOF                       3637
     C   02      DTYP      COMP 'PS'                     37
     C   02      FSLI      COMP 1                        36
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP13                                           S01408
     C*                                                                   S01408
     C*
     C*    SET INDICATORS ACCORDING TO EVENT CODE
     C*
     C                     SETOF                     60
     C           ETYP      IFEQ '31S1'
     C           ETYP      OREQ '39C1'                                    CSE007
     C           ETYP      OREQ '39D1'                                    CSE007
     C                     SETON                     60
     C                     ELSE
     C                     MOVELETYP      WETYP   2
     C           WETYP     IFEQ '31'
     C           CCIO      ANDEQ'I'
     C*                                                                   E20823
     C**  EXCLUDE COUPONS AND DIVIDENDS FROM PRINCIPAL COLUMN             E20823
     C           ETYP      ANDNE'31D2'                                    E20823
     C           ETYP      ANDNE'31D3'                                    E20823
     C           ETYP      ANDNE'31C2'                                    E20823
     C           ETYP      ANDNE'31C3'                                    E20823
     C*                                                                   E20823
     C                     SETON                     60
     C           EAMT      IFLT 0
     C           EAMT      MULT -1        EAMT
     C                     END
     C                     END
     C                     END
     C*
     C  N60      ETYP      COMP '15M1'                   60
     C  N60      ETYP      COMP '15M4'                   60
     C  N60      ETYP      COMP '16V1'                   60
     C  N60      ETYP      COMP '16V3'                   60
     C  N60      ETYP      COMP '18M1'                   60
     C  N60      ETYP      COMP '17M1'                   60
     C  N60      ETYP      COMP '15MX'                   60               CEU003
     C  N60      ETYP      COMP '15MZ'                   60               CEU003
     C  N60      ETYP      COMP '16VX'                   60               CEU003
     C  N60      ETYP      COMP '16VZ'                   60               CEU003
     C  N60      ETYP      COMP '18MX'                   60               CEU003
     C  N60      ETYP      COMP '17MX'                   60               CEU003
     C  N60      ETYP      COMP '20V2'                   60
     C  N60      ETYP      COMP '41M3'                   60
     C  N60      ETYP      COMP '41R1'                   60
     C  N60      ETYP      COMP '41M1'                   60
     C  N60      ETYP      COMP '42M1'                   60
     C  N60      ETYP      COMP '41R4'                   60
     C  N60      ETYP      COMP '61R1'                   60
     C  N60      ETYP      COMP '61M1'                   60
     C  N60      ETYP      COMP '62R1'                   60
     C  N60      ETYP      COMP '62M1'                   60
     C  N60      ETYP      COMP '63M1'                   60
     C  N60      ETYP      COMP '64R1'                   60
     C  N60      ETYP      COMP '64M1'                   60
     C  N60      ETYP      COMP '65M1'                   60
     C  N60      ETYP      COMP '66V1'                   60
     C  N60      ETYP      COMP '67V1'                   60
     C  N60      ETYP      COMP '61RX'                   60               CEU003
     C  N60      ETYP      COMP '61MX'                   60               CEU003
     C  N60      ETYP      COMP '62RX'                   60               CEU003
     C  N60      ETYP      COMP '62MX'                   60               CEU003
     C  N60      ETYP      COMP '63MX'                   60               CEU003
     C  N60      ETYP      COMP '64RX'                   60               CEU003
     C  N60      ETYP      COMP '64MX'                   60               CEU003
     C  N60      ETYP      COMP '65MX'                   60               CEU003
     C  N60      ETYP      COMP '66VX'                   60               CEU003
     C  N60      ETYP      COMP '67VX'                   60               CEU003
     C  N60      ETYP      COMP '80M1'                   60
     C  N60      ETYP      COMP '81D1'                   60
     C  N60      ETYP      COMP '81M1'                   60
     C  N60      ETYP      COMP '81M3'                   60
     C  N60      ETYP      COMP '82A1'                   60
     C  N60      ETYP      COMP '82M1'                   60
     C  N60      ETYP      COMP '84V1'                   60
     C  N60      ETYP      COMP '84V2'                   60
     C  N60      ETYP      COMP '63R4'                   60               S01392
     C  N60      ETYP      COMP '30S1'                   60
     C  N60      ETYP      COMP '30C1'                   60
     C  N60      ETYP      COMP '30D1'                   60
     C  N60      ETYP      COMP '30M1'                   60
     C/COPY WNCPYSRC,GL0541C006
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN60     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68R1'                                    CLE005
     C           ETYP      OREQ '68M1'                                    CLE005
     C           ETYP      OREQ '68R7'                                    CLE005
     C           ETYP      OREQ '68R9'                                    CLE005
     C           ETYP      OREQ '69V1'                                    CLE005
     C           ETYP      OREQ '69V5'                                    CLE005
     C           ETYP      OREQ '69V7'                                    CLE005
     C********** ETYP      OREQ '72V1'                                                 CLE005 214232
     C********** ETYP      OREQ '72V5'                                                 CLE005 214232
     C********** ETYP      OREQ '72V7'                                                 CLE005 214232
     C                     SETON                     60                   CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN60     ANDEQ'0'                                       CLE004
     C           ETYP      IFEQ '61R7'                                    CLE004
     C           ETYP      OREQ '62R7'                                    CLE004
     C           ETYP      OREQ '63R7'                                    CLE004
     C           ETYP      OREQ '64R7'                                    CLE004
     C           ETYP      OREQ '65R7'                                    CLE004
     C           ETYP      OREQ '66V5'                                    CLE004
     C           ETYP      OREQ '67V5'                                    CLE004
     C                     SETON                     60                   CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE006
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           *IN60     ANDEQ'0'                                       CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C           *IN60     ANDEQ'0'                                       CEU020
     C           ETYP      IFEQ '61R9'                                    CLE006
     C           ETYP      OREQ '62R9'                                    CLE006
     C           ETYP      OREQ '63R9'                                    CLE006
     C           ETYP      OREQ '64R9'                                    CLE006
     C           ETYP      OREQ '65R9'                                    CLE006
     C           ETYP      OREQ '66V7'                                    CLE006
     C           ETYP      OREQ '67V7'                                    CLE006
     C                     SETON                     60                   CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C**********                                                          DT0021
     C**SET*INDICATOR*FOR*ACCUMULATION*OF*RECORD*AMOUNT                   DT0021
     C**********                                                          DT0021
     C********** *IN60     IFEQ '0'                                       DT0021
     C********** BQHEOC    ANDEQ'Y'                                       DT0021
     C********** INOI      ANDEQ'I'                                       DT0021
     C********** ETYP      COMP '21C1'                   60               DT0021
     C**N60***** ETYP      COMP '21C2'                   60               DT0021
     C**N60***** ETYP      COMP '22C1'                   60               DT0021
     C**N60***** ETYP      COMP '22C2'                   60               DT0021
     C**N60***** ETYP      COMP '23C1'                   60               DT0021
     C**N60***** ETYP      COMP '23C2'                   60               DT0021
     C**N60***** ETYP      COMP '24C1'                   60               DT0021
     C**N60***** ETYP      COMP '24C2'                   60               DT0021
     C**********           END                                            DT0021
     C*
     C*
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           *IN60     ANDEQ*OFF                                      CIR003
     C           INOI      ANDEQ'I'                                       CIR003
      *                                                                   CIR003
     C           ETYP      IFEQ '23C3'                                    CIR003
     C           ETYP      OREQ '23C4'                                    CIR003
     C           ETYP      OREQ '23S3'                                    CIR003
     C           ETYP      OREQ '23S4'                                    CIR003
     C                     MOVE *ON       *IN60                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN60     ANDEQ*OFF                                                          CLE028
     C           ETYP      ANDEQ'80R1'                                                        CLE028
     C                     MOVE *ON       *IN60                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     SETOF                     61
     C           ETYP      IFEQ '31P1'
     C                     SETON                     61
     C                     ELSE
     C                     MOVELETYP      WETYP
     C           WETYP     IFEQ '31'
     C           CCIO      ANDEQ'O'
     C*                                                                   E20823
     C**  EXCLUDE COUPONS AND DIVIDENDS FROM PRINCIPAL COLUMN             E20823
     C           ETYP      ANDNE'31D2'                                    E20823
     C           ETYP      ANDNE'31D3'                                    E20823
     C           ETYP      ANDNE'31C2'                                    E20823
     C           ETYP      ANDNE'31C3'                                    E20823
     C*                                                                   E20823
     C                     SETON                     61
     C           EAMT      IFLT 0
     C           EAMT      MULT -1        EAMT
     C                     END
     C                     END
     C                     END
     C*
     C  N61      ETYP      COMP '15V1'                   61
     C  N61      ETYP      COMP '15V3'                   61
     C  N61      ETYP      COMP '16M1'                   61
     C  N61      ETYP      COMP '16M4'                   61
     C  N61      ETYP      COMP '17V1'                   61
     C  N61      ETYP      COMP '17V3'                   61
     C  N61      ETYP      COMP '15VX'                   61               CEU003
     C  N61      ETYP      COMP '15VZ'                   61               CEU003
     C  N61      ETYP      COMP '16MX'                   61               CEU003
     C  N61      ETYP      COMP '16MZ'                   61               CEU003
     C  N61      ETYP      COMP '17VX'                   61               CEU003
     C  N61      ETYP      COMP '17VZ'                   61               CEU003
     C  N61      ETYP      COMP '20V1'                   61
     C  N61      ETYP      COMP '41S1'                   61
     C  N61      ETYP      COMP '41R3'                   61
     C  N61      ETYP      COMP '42S8'                   61
     C  N61      ETYP      COMP '61V1'                   61
     C  N61      ETYP      COMP '61V3'                   61
     C  N61      ETYP      COMP '62V1'                   61
     C  N61      ETYP      COMP '63V1'                   61
     C  N61      ETYP      COMP '64V1'                   61
     C  N61      ETYP      COMP '65V1'                   61
     C  N61      ETYP      COMP '66R1'                   61
     C  N61      ETYP      COMP '66M1'                   61
     C  N61      ETYP      COMP '67M1'                   61
     C  N61      ETYP      COMP '62V3'                   61               S01243
     C  N61      ETYP      COMP '64V3'                   61               S01243
     C  N61      ETYP      COMP '66V3'                   61               S01243
     C  N61      ETYP      COMP '61VX'                   61               CEU003
     C  N61      ETYP      COMP '61VZ'                   61               CEU003
     C  N61      ETYP      COMP '62VX'                   61               CEU003
     C  N61      ETYP      COMP '63VX'                   61               CEU003
     C  N61      ETYP      COMP '64VX'                   61               CEU003
     C  N61      ETYP      COMP '65VX'                   61               CEU003
     C  N61      ETYP      COMP '66RX'                   61               CEU003
     C  N61      ETYP      COMP '66MX'                   61               CEU003
     C  N61      ETYP      COMP '67MX'                   61               CEU003
     C  N61      ETYP      COMP '62VZ'                   61               CEU003
     C  N61      ETYP      COMP '64VZ'                   61               CEU003
     C  N61      ETYP      COMP '66VZ'                   61               CEU003
      *                                                                                       CLE028
     C           *IN12     IFEQ *OFF                                                          CLE028
     C  N61      ETYP      COMP '80M2'                   61
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C  N61      ETYP      COMP '81A2'                   61
     C  N61      ETYP      COMP '81P1'                   61
     C  N61      ETYP      COMP '81M2'                   61
     C  N61      ETYP      COMP '81M4'                   61
     C  N61      ETYP      COMP '82A2'                   61
     C  N61      ETYP      COMP '82M2'                   61
     C  N61      ETYP      COMP '84V3'                   61
     C  N61      ETYP      COMP '63R3'                   61               S01392
     C*
     C  N61      ETYP      COMP '30P1'                   61
     C  N61      ETYP      COMP '30C2'                   61
     C  N61      ETYP      COMP '30A1'                   61
     C  N61      ETYP      COMP '30D2'                   61
     C  N61      ETYP      COMP '30M2'                   61
     C/COPY WNCPYSRC,GL0541C007
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN61     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68V1'                                    CLE005
     C           ETYP      OREQ '68V3'                                    CLE005
     C           ETYP      OREQ '68V5'                                    CLE005
     C           ETYP      OREQ '68V7'                                    CLE005
     C           ETYP      OREQ '69R1'                                    CLE005
     C           ETYP      OREQ '69M1'                                    CLE005
     C           ETYP      OREQ '69V3'                                    CLE005
     C           ETYP      OREQ '69R7'                                    CLE005
     C           ETYP      OREQ '69R9'                                    CLE005
     C********** ETYP      OREQ '72R1'                                                 CLE005 214232
     C********** ETYP      OREQ '72M1'                                                 CLE005 214232
     C********** ETYP      OREQ '72V3'                                                 CLE005 214232
     C********** ETYP      OREQ '72R7'                                                 CLE005 214232
     C********** ETYP      OREQ '72R9'                                                 CLE005 214232
     C                     SETON                         61               CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN61     ANDEQ'0'                                       CLE004
     C           ETYP      IFEQ '61V5'                                    CLE004
     C           ETYP      OREQ '62V5'                                    CLE004
     C           ETYP      OREQ '63V5'                                    CLE004
     C           ETYP      OREQ '64V5'                                    CLE004
     C           ETYP      OREQ '65V5'                                    CLE004
     C           ETYP      OREQ '66R7'                                    CLE004
     C           ETYP      OREQ '67R7'                                    CLE004
     C                     SETON                         61               CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           *IN61     ANDEQ'0'                                       CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C           *IN61     ANDEQ'0'                                       CEU020
     C           ETYP      IFEQ '61V7'                                    CLE006
     C           ETYP      OREQ '62V7'                                    CLE006
     C           ETYP      OREQ '63V7'                                    CLE006
     C           ETYP      OREQ '64V7'                                    CLE006
     C           ETYP      OREQ '65V7'                                    CLE006
     C           ETYP      OREQ '66R9'                                    CLE006
     C           ETYP      OREQ '67R9'                                    CLE006
     C                     SETON                         61               CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C**********                                                          DT0021
     C**SET*INDICATOR*FOR*ACCUMULATION*OF*RECORD*AMOUNT                   DT0021
     C**********                                                          DT0021
     C********** *IN61     IFEQ '0'                                       DT0021
     C********** BQHEOC    ANDEQ'Y'                                       DT0021
     C********** INOI      ANDEQ'O'                                       DT0021
     C********** ETYP      COMP '21C1'                   61               DT0021
     C**N61***** ETYP      COMP '21C2'                   61               DT0021
     C**N61***** ETYP      COMP '22C1'                   61               DT0021
     C**N61***** ETYP      COMP '22C2'                   61               DT0021
     C**N61***** ETYP      COMP '23C1'                   61               DT0021
     C**N61***** ETYP      COMP '23C2'                   61               DT0021
     C**N61***** ETYP      COMP '24C1'                   61               DT0021
     C**N61***** ETYP      COMP '24C2'                   61               DT0021
     C**********           END                                            DT0021
     C*
     C*
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           *IN61     ANDEQ*OFF                                      CIR003
     C           INOI      ANDEQ'O'                                       CIR003
      *                                                                   CIR003
     C           ETYP      IFEQ '23C3'                                    CIR003
     C           ETYP      OREQ '23C4'                                    CIR003
     C           ETYP      OREQ '23S3'                                    CIR003
     C           ETYP      OREQ '23S4'                                    CIR003
     C                     MOVE *ON       *IN61                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN61     ANDEQ*OFF                                                          CLE028
     C           ETYP      ANDEQ'80V1'                                                        CLE028
     C                     MOVE *ON       *IN61                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           CER049    IFEQ 'Y'                                                           CER049
     C           *IN61     ANDEQ*OFF                                                          CER049
     C           ETYP      ANDEQ'49ST'                                                        CER049
     C                     MOVE *ON       *IN61                                               CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           ETYP      COMP '15I2'                   62
     C  N62      ETYP      COMP '15M2'                   62
     C  N62      ETYP      COMP '17I2'                   62
     C  N62      ETYP      COMP '17M2'                   62
     C  N62      ETYP      COMP '15IY'                   62               CEU003
     C  N62      ETYP      COMP '15MY'                   62               CEU003
     C  N62      ETYP      COMP '17IY'                   62               CEU003
     C  N62      ETYP      COMP '17MY'                   62               CEU003
     C  N62      ETYP      COMP '20V3'                   62
     C  N62      ETYP      COMP '41I2'                   62
     C  N62      ETYP      COMP '41M4'                   62
     C  N62      ETYP      COMP '41R2'                   62
     C  N62      ETYP      COMP '41M2'                   62
     C  N62      ETYP      COMP '61R2'                   62
     C  N62      ETYP      COMP '61M2'                   62
     C  N62      ETYP      COMP '61I2'                   62
     C  N62      ETYP      COMP '62R2'                   62
     C  N62      ETYP      COMP '62M2'                   62
     C  N62      ETYP      COMP '62I2'                   62
     C  N62      ETYP      COMP '64I2'                   62
     C  N62      ETYP      COMP '64R2'                   62
     C  N62      ETYP      COMP '64M2'                   62
     C  N62      ETYP      COMP '70I2'                   62
     C  N62      ETYP      COMP '70M2'                   62
     C  N62      ETYP      COMP '61RY'                   62               CEU003
     C  N62      ETYP      COMP '61MY'                   62               CEU003
     C  N62      ETYP      COMP '61IY'                   62               CEU003
     C  N62      ETYP      COMP '62RY'                   62               CEU003
     C  N62      ETYP      COMP '62MY'                   62               CEU003
     C  N62      ETYP      COMP '62IY'                   62               CEU003
     C  N62      ETYP      COMP '64IY'                   62               CEU003
     C  N62      ETYP      COMP '64RY'                   62               CEU003
     C  N62      ETYP      COMP '64MY'                   62               CEU003
     C  N62      ETYP      COMP '70IY'                   62               CEU003
     C  N62      ETYP      COMP '70MY'                   62               CEU003
     C/COPY WNCPYSRC,GL0541C015
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN62     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68R2'                                    CLE005
     C           ETYP      OREQ '68M2'                                    CLE005
     C           ETYP      OREQ '68I2'                                    CLE005
     C           ETYP      OREQ '71M2'                                    CLE005
     C           ETYP      OREQ '71I2'                                    CLE005
     C                     SETON                         62               CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C*                                                                   045634
     C* Add the Lending fee processing types here to be included in       045634
     C* as part of the interest income reporting                          045634
     C*                                                                   045634
     C  N62      ETYP      COMP '71F1'                   62               045634
     C  N62      ETYP      COMP '71F2'                   62               045634
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           *IN62     ANDEQ*OFF                                                          CAS009
      *                                                                                       CAS009
     C           ETYP      IFEQ '15F1'                                                        CAS009
     C           ETYP      OREQ '17F1'                                                        CAS009
     C                     MOVE *ON       *IN62                                               CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C*
     C* SET INDICATOR FOR ADDITION OF RECORD AMOUNT
     C*
     C           *IN62     IFEQ '0'
     C           INOI      ANDEQ'I'
     C           ETYP      COMP '21I1'                   62
     C  N62      ETYP      COMP '22I1'                   62
     C  N62      ETYP      COMP '23I1'                   62
     C  N62      ETYP      COMP '24I1'                   62
     C  N62      ETYP      COMP '21IX'                   62               CEU003
     C  N62      ETYP      COMP '22IX'                   62               CEU003
     C  N62      ETYP      COMP '23IX'                   62               CEU003
     C  N62      ETYP      COMP '24IX'                   62               CEU003
     C                     END
     C*
     C********** *IN62     IFEQ '0'                                       DT0021
     C********** INOI      ANDEQ'I'                                       DT0021
     C********** BQHEOC    ANDEQ'Y'                                       DT0021
     C********** ETYP      COMP '21C3'                   62               DT0021
     C**********           END                                            DT0021
     C*                                                                   E20823
     C           *IN62     IFEQ '0'                                       E20823
     C           CCIO      ANDEQ'I'                                       E20823
     C           ETYP      COMP '31D2'                   62               E20823
     C  N62      ETYP      COMP '31D3'                   62               E20823
     C  N62      ETYP      COMP '31C2'                   62               E20823
     C  N62      ETYP      COMP '31C3'                   62               E20823
     C                     END                                            E20823
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN12     ANDEQ*ON                                                           CLE028
     C           *IN62     ANDEQ*OFF                                                          CLE028
      *                                                                                       CLE028
     C           ETYP      IFEQ '80R2'                                                        CLE028
     C           ETYP      OREQ '80M2'                                                        CLE028
     C                     MOVE *ON       *IN62                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C** Up-Front and Buy-Out                                             CIR001
     C*                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C*                                                                   CIR001
     C                     MOVE '0'       *IN63                           CIR001
     C           ETYP      IFEQ '22FE'                                    CIR001
     C           ETYP      OREQ '23FE'                                    CIR001
     C           ETYP      OREQ '24FE'                                    CIR001
     C           ETYP      OREQ '22BO'                                    CIR001
     C           ETYP      OREQ '23BO'                                    CIR001
     C           ETYP      OREQ '24BO'                                    CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           INOI      IFEQ 'I'                                       CIR001
     C                     MOVE '1'       *IN62                           CIR001
     C                     MOVE '0'       *IN63                           CIR001
     C                     ELSE                                           CIR001
     C           INOI      IFEQ 'O'                                       CIR001
     C                     MOVE '0'       *IN62                           CIR001
     C                     MOVE '1'       *IN63                           CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           *IN63     IFEQ '0'                                       CIR001
     C           ETYP      ANDEQ'16I2'                                    CIR001
     C           *IN63     OREQ '0'                                       CEU003
     C           ETYP      ANDEQ'16IY'                                    CEU003
     C                     MOVE '1'       *IN63                           CIR001
     C                     END                                            CIR001
     C                     ELSE                                           CIR001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP8                                           S01408
     C*                                                                   S01408
     C*
     C*
     C           ETYP      COMP '16I2'                   63
     C  N63      ETYP      COMP '16IY'                   63               CEU003
     C                     END                                            CIR001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CCP9                                           S01408
     C*                                                                   S01408
     C  N63      ETYP      COMP '20V4'                   63
     C  N63      ETYP      COMP '16M2'                   63
     C  N63      ETYP      COMP '66I2'                   63
     C  N63      ETYP      COMP '66R2'                   63
     C  N63      ETYP      COMP '66M2'                   63
     C  N63      ETYP      COMP '63R5'                   63               S01392
     C  N63      ETYP      COMP '16MY'                   63               CEU003
     C  N63      ETYP      COMP '66IY'                   63               CEU003
     C  N63      ETYP      COMP '66RY'                   63               CEU003
     C  N63      ETYP      COMP '66MY'                   63               CEU003
     C  N63      ETYP      COMP '63RZ'                   63               CEU003
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN63     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '69I2'                                    CLE005
     C           ETYP      OREQ '69R2'                                    CLE005
     C           ETYP      OREQ '69M2'                                    CLE005
     C           ETYP      OREQ '72I2'                                    CLE005
     C           ETYP      OREQ '72R2'                                    CLE005
     C           ETYP      OREQ '72M2'                                    CLE005
     C                     SETON                         63               CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           *IN63     ANDEQ*OFF                                                          CAS009
      *                                                                                       CAS009
     C           ETYP      IFEQ '16F1'                                                        CAS009
     C                     MOVE *ON       *IN63                                               CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C*
     C* SET INDICATOR FOR SUBTRACTION OF RECORD AMOUNT
     C*
     C           *IN63     IFEQ '0'
     C           INOI      ANDEQ'O'
     C           ETYP      COMP '21I1'                   63
     C  N63      ETYP      COMP '22I1'                   63
     C  N63      ETYP      COMP '23I1'                   63
     C  N63      ETYP      COMP '24I1'                   63
     C  N63      ETYP      COMP '21IX'                   63               CEU003
     C  N63      ETYP      COMP '22IX'                   63               CEU003
     C  N63      ETYP      COMP '23IX'                   63               CEU003
     C  N63      ETYP      COMP '24IX'                   63               CEU003
     C                     END
     C*
     C********** *IN63     IFEQ '0'                                       DT0021
     C********** INOI      ANDEQ'I'                                       S01211
     C********** INOI      ANDEQ'O'                                 S01211DT0021
     C********** BQHEOC    ANDEQ'Y'                                       DT0021
     C********** ETYP      COMP '21C3'                   63               DT0021
     C**********           END                                            DT0021
     C*                                                                   E20823
     C           *IN62     IFEQ '0'                                       E20823
     C           CCIO      ANDEQ'I'                                       E20823
     C           ETYP      COMP '31D2'                   62               E20823
     C  N62      ETYP      COMP '31D3'                   62               E20823
     C  N62      ETYP      COMP '31C2'                   62               E20823
     C  N62      ETYP      COMP '31C3'                   62               E20823
     C                     END                                            E20823
     C*                                                                   E20823
     C           *IN63     IFEQ '0'                                       E20823
     C           CCIO      ANDEQ'O'                                       E20823
     C           ETYP      COMP '31D2'                   63               E20823
     C  N63      ETYP      COMP '31D3'                   63               E20823
     C  N63      ETYP      COMP '31C2'                   63               E20823
     C  N63      ETYP      COMP '31C3'                   63               E20823
     C                     END                                            E20823
     C*
     C           ETYP      COMP '11V1'                   64
     C  N64      ETYP      COMP '12V1'                   64
     C  N64      ETYP      COMP '13V1'                   64
     C  N64      ETYP      COMP '14V1'                   64
     C  N64      ETYP      COMP '11VX'                   64               CEU003
     C  N64      ETYP      COMP '12VX'                   64               CEU003
     C  N64      ETYP      COMP '13VX'                   64               CEU003
     C  N64      ETYP      COMP '14VX'                   64               CEU003
     C*
     C  N64      ETYP      COMP '94V1'                   64
     C  N64      ETYP      COMP '95V1'                   64
     C  N64      ETYP      COMP '96V1'                   64
     C  N64      ETYP      COMP '97V1'                   64
     C  N64      ETYP      COMP '98V1'                   64
     C  N64      ETYP      COMP '99V1'                   64
     C*
     C           ETYP      COMP '11V2'                   65
     C  N65      ETYP      COMP '12V2'                   65
     C  N65      ETYP      COMP '13V2'                   65
     C  N65      ETYP      COMP '14V2'                   65
     C  N65      ETYP      COMP '11VY'                   65               CEU003
     C  N65      ETYP      COMP '12VY'                   65               CEU003
     C  N65      ETYP      COMP '13VY'                   65               CEU003
     C  N65      ETYP      COMP '14VY'                   65               CEU003
     C*
     C  N65      ETYP      COMP '94V2'                   65
     C  N65      ETYP      COMP '95V2'                   65
     C  N65      ETYP      COMP '96V2'                   65
     C  N65      ETYP      COMP '97V2'                   65
     C  N65      ETYP      COMP '98V2'                   65
     C  N65      ETYP      COMP '99V2'                   65
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN53     ANDEQ'1'                                                           CAP204
      *                                                                                       CAP204
     C           INOI      IFEQ 'I'                                                           CAP204
     C                     SETON                     64                                       CAP204
     C                     ELSE                                                               CAP204
     C                     SETON                     65                                       CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C*
     C* IF THE RECORD IS FROM FPVNT
     C* AND THE TYPE IS NOT EQUAL TO '91P7'
     C*    ADD TO FX PURCH'S (64) OR
     C*    ADD TO FX SALES   (65)
     C*
     C           *IN51     IFEQ '1'                        ## B001
     C           ETYP      ANDNE'91P7'
     C*
     C           INOI      IFEQ 'I'                        ## B002
     C                     SETON                     64
     C                     ELSE                            ## X002
     C                     SETON                     65
     C                     END                             ## E002
     C                     END                             ## E001
     C*                                                                   073714
     C* IF THE EVENT TYPE REPRESENTS FUTURES & OPTIONS PREMIUM PAYABLE    073714
     C*    ADD TO FX PURCH'S (64) OR                                      073714
     C*    ADD TO FX SALES   (65)                                         073714
     C*                                                                   073714
     C           ETYP      IFEQ '93V1'                     ## B001        073714
     C           INOI      IFEQ 'I'                        ## B002        073714
     C                     SETON                     64                   073714
     C                     ELSE                            ## X002        073714
     C                     SETON                     65                   073714
     C                     END                             ## E002        073714
     C                     END                             ## E001        073714
     C**********                                                          DT0021
     C**SET*TRANSACTION*TYPE*MARKER*FOR*FRA/IRS*IF*HEDGED*EVENTS          DT0021
     C**ARE*TO*BE*REPORTED                                                DT0021
     C**********                                                          DT0021
     C********** BQHEOC    IFEQ 'Y'                                       DT0021
     C********** ETYP      IFEQ '21C1'                                    DT0021
     C********** ETYP      OREQ '21C2'                                    DT0021
     C********** ETYP      OREQ '21C3'                                    DT0021
     C**********           MOVE 'FRA'     HMKR    3                       DT0021
     C**********           END                                            DT0021
     C**********                                                          DT0021
     C********** ETYP      IFEQ '22C1'                                    DT0021
     C********** ETYP      OREQ '22C2'                                    DT0021
     C********** ETYP      OREQ '23C1'                                    DT0021
     C********** ETYP      OREQ '23C2'                                    DT0021
     C**********           MOVE 'IRS'     HMKR                            DT0021
     C**********           END                                            DT0021
     C**********                                                          DT0021
     C********** ETYP      IFEQ '24C1'                                    DT0021
     C********** ETYP      OREQ '24C2'                                    DT0021
     C**********           MOVE 'CCF'     HMKR                            DT0021
     C**********           END                                            DT0021
     C**SET*UP*FRA/IRS*TYPE*MARKER*ON*DETAIL*LINE                         DT0021
     C********** HMKR      IFNE *BLANK                                    DT0021
     C********** MKR       IFEQ *BLANK                                    DT0021
     C**********           MOVE HMKR      MKR     3                       DT0021
     C**********           ELSE                                           DT0021
     C********** HMKR      IFNE MKR                                       DT0021
     C**********           MOVE 'F/I'     MKR                             DT0021
     C**********           END                                            DT0021
     C**********           END                                            DT0021
     C**********           MOVE *BLANK    HMKR                            DT0021
     C**********           END                                            DT0021
     C**********           END                                            DT0021
     C*
     C* TEST FOR MULTIBRANCH AND PURCH/IN, SALES/OUT TO ENSURE OUTPUT       E175
     C* IS IN CORRECT COLUMN                                                E175
     C*                                                                     E175
     C           IBRE      IFEQ 'Y'                                         E175
     C*                                                                     E175
     C           *IN60     IFEQ '1'                                         E175
     C           INOI      ANDEQ'O'                                         E175
     C                     SETON                     61                     E175
     C                     SETOF                     60                     E175
     C                     END                                              E175
     C*                                                                     E175
     C           *IN61     IFEQ '1'                                         E175
     C           INOI      ANDEQ'I'                                         E175
     C                     SETON                     60                     E175
     C                     SETOF                     61                     E175
     C                     END                                              E175
     C*                                                                     E175
     C           *IN64     IFEQ '1'                                         E175
     C           INOI      ANDEQ'O'                                         E175
     C                     SETON                     65                     E175
     C                     SETOF                     64                     E175
     C                     END                                              E175
     C*                                                                     E175
     C           *IN65     IFEQ '1'                                         E175
     C           INOI      ANDEQ'I'                                         E175
     C                     SETON                     64                     E175
     C                     SETOF                     65                     E175
     C                     END                                              E175
     C*                                                                     E175
     C                     END                                              E175
     C*                                                                     E175
     C   60                MOVE 1         I       10
     C   61                MOVE 2         I
     C**                                                                  E196
     C* IF INTEREST AMOUNT AND MULTI-BRANCH FLAG IS ON , THIS AMOUNT IS   E196
     C* PLACED EITHER IN THE IN/OUT COLUMNS I.E. IT SHOULD NOT BE REPORTEDE196
     C* AS INTEREST AMOUNT FOR THAT BRANCH.                               E196
     C*                                                                   E196
     C***62*                                                              E196
     C*R*63*               MOVE 3         I                               E196
     C*                                                                   E196
     C           *IN62     IFEQ '1'                        B1             E196
     C           *IN63     OREQ '1'                        B1             E196
     C*                                                                   E196
     C           IBRE      IFEQ 'Y'                        B*2            E196
     C*                                                                   E196
     C           INOI      IFEQ 'O'                        B**3           E196
     C                     MOVE 2         I                ***3           E196
     C                     ELSE                            X**3           E196
     C                     MOVE 1         I                ***3           E916
     C                     END                             E**3           E196
     C*                                                                   E196
     C                     ELSE                            X*2            E196
     C                     MOVE 3         I                **2            E196
     C                     END                             E*2            E196
     C                     END                             E1             E196
     C*                                                                   E196
     C   64                MOVE 4         I
     C   65                MOVE 5         I
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP14                                           S01408
     C*                                                                   S01408
     C*
     C*    REVERSE SIGN OF AMOUNT IF '16I2' OR '16M2'
     C*    OR '20V3'
     C*    OR '66I2' OR '66R2' OR '66M2'
      *                                                                   099250
      ** If multibranching event, do not reverse event amount             099250
      *                                                                   099250
     C           IBRE      IFNE 'Y'                                       099250
     C   63                Z-SUBEAMT      EAMT
     C                     ELSE                                           099250
     C   63                Z-ADDEAMT      EAMT                            099250
     C                     END                                            099250
     C*
     C*    ONLY PRIMARY CD. REQUIRES EVENT TYPE 17V1 TO APPEAR ON REPORT
     C                     SETOF                       5859
     C   61 02   ETYP      COMP '17V1'                   58
     C   61 02N58ETYP      COMP '17VX'                   58               CEU003
     C   61 02   DTYP      COMP 'C1'                     59
     C   61 58N59          SETOF                     61
     C*
     C*    ADD EVENT AMOUNT INTO CALL OR NOTICE ACCUMULATORS
     C   55 60   CALLI     ADD  EAMT      CALLI  130
     C   55 61   CALLO     ADD  EAMT      CALLO  130
     C  N55 56 60NOTICI    ADD  EAMT      NOTICI 130
     C  N55 56 61NOTICO    ADD  EAMT      NOTICO 130
     C*
     C  N60N61N62
     CANN63N64N65          GOTO END
     C*
     C*
     C           ETYP      COMP '30C1'                   69
     C  N69      ETYP      COMP '30C2'                   69
     C  N69                GOTO NOTCPN
     C*
     C                     ADD  EAMT      ACC,3
     C                     GOTO END
     C           NOTCPN    TAG
     C*
     C*
     C*    UPDATE DEPOSITS AND F/X FOR INTERNAL CONTRACTS
     C   37 36   ACC,I     ADD  EAMT      ACC,I
     C   37N36   ACC,I     ADD  ICAM      ACC,I
     C   37 60   I         ADD  4         I
     C   37 61   I         ADD  2         I
     C*                                                                   S01392
     C* IF FRONT-UP INTEREST = Y INCLUDE INTEREST ON VALUE DATE EVENT     S01392
     C*                                                                   S01392
     C   02      FUID      IFEQ 'Y'                                       S01392
     C           ETYP      IFEQ '15V1'                                    S01392
     C           ETYP      OREQ '15VX'                                    CEU003
     C                     ADD  OTHA      ACC,3                           S01392
     C                     END                                            S01392
     C           ETYP      IFEQ '16V1'                                    S01392
     C           ETYP      OREQ '16VX'                                    CEU003
     C                     SUB  OTHA      ACC,3                           S01392
     C                     END                                            S01392
     C                     END                                            S01392
     C*                                                                   098013
     C** If Multibranching event, include the interest at maturity        098013
     C           *IN02     IFEQ *ON                                       098013
     C           IBRE      ANDEQ'Y'                                       098013
     C*                                                                   098013
     C           ETYP      IFEQ '15M1'                                    098013
     C           ETYP      OREQ '16M1'                                    098013
     C           ETYP      OREQ '15MX'                                    CEU003
     C           ETYP      OREQ '16MX'                                    CEU003
     C                     ADD  OTHA      ACC,I                           098013
     C                     ENDIF                                          098013
     C*                                                                   098013
     C                     ENDIF                                          098013
     C*
     C  N55 57   ACC,I     ADD  EAMT      ACC,I
     C*
     C           END       TAG                             ** END TAG **
     C*
     C**   IF NO DETAILS READ - BYPASS EXCEPTION OUTPUT
      *                                                                   S01473
      ** If processing LEO events, check LEO record read flag.            S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULREC     ANDEQ'Y'                                       S01473
      *                                                                   S01473
      ** Reset LEO record read flag                                       S01473
     C                     MOVE *BLANK    ULREC                           S01473
     C                     END                                            S01473
     CL1         CEU011    IFEQ 'Y'                                       149411
     CL1                   MOVE ECCY      ECCYB   3                       149411
     CL1                   Z-ADDEDAT      EEDAT   50                      149411
     CL1                   ENDIF                                          149411
      ** For a change of currency (L2 on), check if Leo records are       S01473
      ** being processed, and a Leo record hasn't been read, OR if        S01473
      ** Leo records are not being processed. If either of these          S01473
      ** condition are met, perform the BYEXC check, else miss out        S01473
      ** the BYEXC check                                                  S01473
     CL2         ULEO      IFEQ 'Y'                                       S01473
     CL2         ULREC     ANDEQ'N'                                       S01473
     CL2         ULEO      ORNE 'Y'                                       S01473
      *                                                                   S01473
     CL2N02N12N13
     C*ANN18N81N04********************                                    E20669
     C*ANN83N85N88**********GOTO BYEXC                                    E20669
     CANN81N04                                                            E20669
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG7                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     CANN83N85             GOTO BYEXC                                     E20669
      *                                                                   S01473
     CL2                   END                                            S01473
     C*
     C*    OPERATIONS ON CHANGE OF CURRENCY
     C*
     C*
     C*    OUTPUT CALL, NOTICE AND OPENING BALANCE LINES
     C*    IF NOT ALREADY PRINTED FOR THIS CURRENCY
     CL2N45                EXSR DEPS
     CL2N45                SETON                     67
     CL2N45                EXCPT
     C/COPY WNCPYSRC,GL0541C009
     CL2N45                SETOF                     67
     CL2         BYEXC     TAG                             ** BYEXC TAG **
     C*
     C*
     C*    OUTPUT DETAILS FOR LAST RECORD OF PREVIOUS GROUP
     CL2 45                SETOF                     47
     CL2 45                SETON                     48
     CL2 45                EXSR DIVOUT
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP1                                            S01408
     C*                                                                   S01408
     C*
     C*    CLEAR ACCUMULATORS
     CL2                   Z-ADD0         CALLI
     CL2                   Z-ADD0         CALLO
     CL2                   Z-ADD0         NOTICI
     CL2                   Z-ADD0         NOTICO
     CL2                   EXSR PEREND
     CL2                   SETOF                     45
      *                                                                   CEU011
      ** Check if CEU011 is on.                                           CEU011
      *                                                                   CEU011
     CL3         CEU011    IFEQ 'Y'                                       CEU011
     CL3                   EXSR PEREND                                    CEU011
     CL3                   EXSR P01                                       CEU011
     CL3                   ENDIF                                          CEU011
      *                                                                   CEU011
     C*
     C*
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ
     CLR                   PARM *BLANKS   @PARM   3
     CLR                   PARM           SFILEU
     CLR                   PARM           ZSNUM
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*
      /EJECT
     C********************************************************************
     C*
     C*    CALCS FOR PRINTING CALL/NOTICE LINES
     C*
     C           DEPS      BEGSR                           DEPS
     C*
     C           CALLI     SUB  CALLO     CALNET 130
     C           CALLI     DIV  1000      CITH   100H
     C           CALLO     DIV  1000      COTH   100H
     C           CALNET    DIV  1000      CNTTH  100H
     C*
     C   71      CITH      DIV  10        CITH      H
     C   71      COTH      DIV  10        COTH      H
     C   71      CNTTH     DIV  10        CNTTH     H
     C   72      CITH      DIV  100       CITH      H
     C   72      COTH      DIV  100       COTH      H
     C   72      CNTTH     DIV  100       CNTTH     H
     C   73      CITH      DIV  1000      CITH      H
     C   73      COTH      DIV  1000      COTH      H
     C   73      CNTTH     DIV  1000      CNTTH     H
     C*
     C           NOTICI    SUB  NOTICO    NOTNET 130
     C           NOTICI    DIV  1000      NITH   100H
     C           NOTICO    DIV  1000      NOTH   100H
     C           NOTNET    DIV  1000      NNETTH 100H
     C*
     C   71      NITH      DIV  10        NITH      H
     C   71      NOTH      DIV  10        NOTH      H
     C   71      NNETTH    DIV  10        NNETTH    H
     C   72      NITH      DIV  100       NITH      H
     C   72      NOTH      DIV  100       NOTH      H
     C   72      NNETTH    DIV  100       NNETTH    H
     C   73      NITH      DIV  1000      NITH      H
     C   73      NOTH      DIV  1000      NOTH      H
     C   73      NNETTH    DIV  1000      NNETTH    H
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541PDR                                            S01408
     C*                                                                   S01408
      *                                                                   CEU011
      ** If CEU011 is switched on and Event ccy is 'IN' ccy.              CEU011
      ** convert the ffg. amount to their Euro equivalent.                CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           WINCY     ANDEQ'Y'                                       CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C           CITH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCITH      PFRAM                           CEU011
     C                     MOVEL'12'      @DBASE  3                       CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECITHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ECITHX 100H                     149411
     C                     ADD  ECITHX    ECITH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert COTH amount to its Euro equivalent amt.                  CEU011
     C           COTH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCOTH      PFRAM                           CEU011
     C                     MOVEL'13'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECOTHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ECOTHX 100H                     149411
     C                     ADD  ECOTHX    ECOTH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert CNTTH amount to its Euro equivalent amt.                 CEU011
     C           CNTTH     IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCNTTH     PFRAM                           CEU011
     C                     MOVEL'14'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECNTTX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ECNTTX 100H                     149411
     C                     ADD  ECNTTX    ECNTTH 100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert NITH amount to its Euro equivalent amt.                  CEU011
     C           NITH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDNITH      PFRAM                           CEU011
     C                     MOVEL'15'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ENITHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ENITHX 100H                     149411
     C                     ADD  ENITHX    ENITH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert NOTH amount to its Euro equivalent amt.                  CEU011
     C           NOTH      IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDNOTH      PFRAM                           CEU011
     C                     MOVEL'16'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ENOTHX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ENOTHX 100H                     149411
     C                     ADD  ENOTHX    ENOTH  100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert NNETTH amount to its Euro equivalent amt.                CEU011
     C           NNETTH    IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDNNETTH    PFRAM                           CEU011
     C                     MOVEL'17'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ENETTX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   ENETTX 100H                     149411
     C                     ADD  ENETTX    ENETTH 100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
      ** Convert CUMTT amount to its Euro equivalent amt.                 CEU011
     C           CUMTT     IFNE 0                                         149411
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCUMTT     PFRAM                           CEU011
     C                     MOVEL'18'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     WCUMTX 100               CEU011 149411
     C           POUTA     DIV  POWER,E   WCUMTX 100H                     149411
     C                     ADD  WCUMTX    WCUMTT 100                      CEU011
     C                     END                                            149411
      *                                                                   CEU011
     C           BCCY1     IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
      ** Convert BCEQV amount to its Euro equivalent amt.                 CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE BJCYCD    PFRCY                           CEU011
     C                     Z-ADDBCEQV     PFRAM                           CEU011
     C                     MOVEL'19'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     TBCEQV 100               CEU011 149411
     C           POUTA     DIV  POWER,E   TBCEQV 100H                     149411
     C                     ADD  TBCEQV    WBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
     C           BJCYCD    IFEQ BKEURO                                    CEU011
     C                     ADD  BCEQV     WBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
      ** Use the standard subroutine ZCONV.                               CEU011
     C                     Z-ADDBCEQV     ZAMTCI                          CEU011
      *                                                                   CEU011
     C                     MOVE WSMDIN    ZMD                             CEU011
     C                     MOVE BJCYCD    ZCCYI                           CEU011
     C                     MOVE BKEURO    ZCCYO                           CEU011
     C                     MOVE WSNBDP    ZCDPI                           CEU011
     C                     MOVE WSNBDP    ZCDPO                           CEU011
     C                     MOVE WSSPRT    ZEXCH                           CEU011
      *                                                                   CEU011
     C                     EXSR ZCONV                                     CEU011
      *                                                                   CEU011
     C                     Z-ADDZAMTCO    XBCEQV 100                      CEU011
     C                     ADD  XBCEQV    WBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
     C           CEU011    IFEQ 'Y'                                       149411
     C           ECCY      ANDEQBKEURO                                    149411
     C                     ADD  CITH      ECITH                           149411
     C                     ADD  COTH      ECOTH                           149411
     C                     ADD  CNTTH     ECNTTH                          149411
     C                     ADD  NITH      ENITH                           149411
     C                     ADD  NOTH      ENOTH                           149411
     C                     ADD  NNETTH    ENETTH                          149411
     C                     ADD  CUMTT     WCUMTT                          149411
     C                     ADD  BCEQV     WBCEQV                          149411
     C                     END                                            149411
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*
     C*    PERFORM HASH TOTALLING
     C*
     C           HASH      BEGSR                           HASH
     C*
     C                     Z-ADDINT,X     ZZTOTI
     C                     Z-ADDDEC,X     ZZTOTD
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    INT,X
     C                     Z-ADDZZTOTD    DEC,X
      *
      ** Clear previous accumulater values.
     C                     Z-ADD0         ZZTOTI
     C                     Z-ADD0         ZZTOTD
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*
     C*    DIVIDE AMOUNTS AND OUTPUT DETAIL LINES
     C*
     C           DIVOUT    BEGSR
     C*
     C*    ADD DATE ACCUMULATORS INTO PERIOD ACCUMULATORS
     C                     EXSR NETS
     C                     EXSR TOTAL
     C*
     C*    DIVIDE FIELDS TO BE PRINTED OUT BY 1000
     C           ACC,1     DIV  1000      RND,1     H
     C           ACC,2     DIV  1000      RND,2     H
     C           ACC,3     DIV  1000      RND,3     H
     C           ACC,4     DIV  1000      RND,4     H
     C           ACC,5     DIV  1000      RND,5     H
     C           ACC,6     DIV  1000      RND,6     H
     C           ACC,7     DIV  1000      RND,7     H
     C           ACC,8     DIV  1000      RND,8     H
     C           ACC,9     DIV  1000      RND,9     H
     C                     Z-ADD0         ACC
     C   71      RND       DIV  10        RND       H
     C   72      RND       DIV  100       RND       H
     C   73      RND       DIV  1000      RND       H
     C           CUMTT     ADD  RND,9     CUMTT
     C*                                                                   S01048
     C/COPY WNCPYSRC,GL0541CPG8                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C* CALCULATIONS DONE DEPENDING ON THE VALUE OF SPOT RATE AND
     C* MULT/DIV INDICATOR ,I.E. SPOT RATE NE ZERO
     C           A6SPRT    IFNE 0
     C           A6MDIN    ANDEQ'D'
     C           CUMTT     DIV  A6SPRT    BCEQV  100H
     C                     END
     C           A6SPRT    IFNE 0
     C           A6MDIN    ANDEQ'M'
     C           CUMTT     MULT A6SPRT    BCEQV     H
     C                     END
     C*
     C   47                GOTO OLDPER
     C           TOT,1     DIV  1000      TOTO,1    H
     C           TOT,2     DIV  1000      TOTO,2    H
     C           TOT,3     DIV  1000      TOTO,3    H
     C           TOT,4     DIV  1000      TOTO,4    H
     C           TOT,5     DIV  1000      TOTO,5    H
     C           TOT,6     DIV  1000      TOTO,6    H
     C           TOT,7     DIV  1000      TOTO,7    H
     C           TOT,8     DIV  1000      TOTO,8    H
     C           TOT,9     DIV  1000      TOTO,9    H
     C                     Z-ADD0         TOT
     C   71      TOTO      DIV  10        TOTO      H
     C   72      TOTO      DIV  100       TOTO      H
     C   73      TOTO      DIV  1000      TOTO      H
     C*
     C*    OUTPUT DETAIL AND FFVD TOTAL LINES
     C           OLDPER    TAG                             ** OLDPER TAG *
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP15                                           S01408
     C*                                                                   S01408
     C   48                GOTO OPLNS
     C**
     C**   CHECK EACH ELEMENT OF RND IS NOT ZERO
     C**
     C                     Z-ADD0         A       10
     C           LOOP1     TAG                             ** LOOP1 TAG **
     C           A         ADD  1         A
     C           RND,A     COMP 0                    3838
     C   38                GOTO OPLNS
     C           A         COMP 9                        38
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CPG9                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C   38                GOTO ENDDIV
     C                     GOTO LOOP1
     C**SET*UP*FRA/IRS*TYPE*MARKER*FOR*SUBTOTAL*LINE*IF*HEDGED*EVENTS     DT0021
     C**ARE*TO*BE*REPORTED                                                DT0021
     C**********                                                          DT0021
     C********** BQHEOC    IFEQ 'Y'                                       DT0021
     C********** MKR       IFEQ *BLANK                                    DT0021
     C**********           MOVE MKR       TMKR    3                       DT0021
     C**********           ELSE                                           DT0021
     C**********           MOVE 'F/I'     TMKR                            DT0021
     C**********           END                                            DT0021
     C**********           END                                            DT0021
     C**
     C           OPLNS     TAG                             ** OPLNS TAG **
     C                     SETON                     68
      *                                                                   CEU011
      **  Divide amount and output detail lines.                          CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           WINCY     ANDEQ'Y'                                       CEU011
     C                     Z-ADD1         Z       20                      CEU011
     C           Z         DOWLE9                                         CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDRND,Z     PFRAM                           CEU011
     C                     MOVEL'20'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ERND,Z                   CEU011 149411
     C                     Z-ADD0         ERND,Z                          149411
     C           POUTA     DIV  POWER,E   ERND,Z                          149411
      *                                                                   CEU011
     C                     ADD  1         Z                               CEU011
     C                     ENDDO                                          CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     Z-ADDCUMTT     PFRAM                           CEU011
     C                     MOVEL'21'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     ECUMTT 100               CEU011 149411
     C                     Z-ADD0         ECUMTT 100                      149411
     C           POUTA     DIV  POWER,E   ECUMTT                          149411
     C           BCCY1     IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
      *                                                                   CEU011
      ** Initialise fields to be used to call EU0200.                     CEU011
      *                                                                   CEU011
     C                     EXSR INITF                                     CEU011
     C                     MOVE BJCYCD    PFRCY                           CEU011
     C                     Z-ADDBCEQV     PFRAM                           CEU011
     C                     MOVEL'22'      @DBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C**********           Z-ADDPOUTA     EBCEQV 100               CEU011 149411
     C                     Z-ADD0         EBCEQV 100                      149411
     C           POUTA     DIV  POWER,E   EBCEQV                          149411
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
     C           BJCYCD    IFEQ BKEURO                                    CEU011
     C                     Z-ADDBCEQV     EBCEQV                          CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
      ** Use the standard subroutine ZCONV.                               CEU011
     C                     Z-ADDBCEQV     ZAMTCI                          CEU011
      *                                                                   CEU011
     C                     MOVE WSMDIN    ZMD                             CEU011
     C                     MOVE BJCYCD    ZCCYI                           CEU011
     C                     MOVE BKEURO    ZCCYO                           CEU011
     C                     MOVE WSNBDP    ZCDPI                           CEU011
     C                     MOVE WSNBDP    ZCDPO                           CEU011
     C                     MOVE WSSPRT    ZEXCH                           CEU011
      *                                                                   CEU011
     C                     EXSR ZCONV                                     CEU011
      *                                                                   CEU011
     C                     Z-ADDZAMTCO    EBCEQV 100                      CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      * Write record to LF/GLEVCFL0                                       CEU011
      *                                                                   CEU011
     C                     EXSR W01                                       CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
     C*                                                                   149411
     C           ECCYB     IFEQ BKEURO                                    149411
     C           CEU011    ANDEQ'Y'                                       155669
     C                     EXSR W01                                       149411
     C                     END                                            149411
     C/COPY WNCPYSRC,GL0541C013
      *                                                                   CEU011
     C                     EXCPT
     C/COPY WNCPYSRC,GL0541C010
     C                     SETOF                     68
     C*
     C           ENDDIV    ENDSR
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/SREURO - Call program to convert amount to Euro           *   CEU011
      *              Equivalent.                                      *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           SREURO    BEGSR                                          CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'               8787               CEU011
     C                     PARM           PRTCD   7                       CEU011
     C                     PARM           PFRAM  183                      CEU011
     C                     PARM           PFRCY   3                       CEU011
     C                     PARM           PTOCY   3                       CEU011
     C                     PARM           POUTA  150                      CEU011
     C                     PARM           PINTA  183                      CEU011
     C                     PARM           PEXRT  159                      CEU011
     C                     PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     C           PRTCD     IFNE *BLANKS                                   CEU011
     C                     MOVEL'*CALL   'DBFILE                          CEU011
     C                     MOVEL'EU0200  'DBKEY             ************  CEU011
     C                     MOVEL@DBASE    DBASE             * DBERR XX *  CEU011
     C                     SETON                     U7U8LR ************  CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     GOTO END                                       CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/W01  -   Write record to LF/GLEVCFL0.                     *   CEU011
      *                                                               *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           W01       BEGSR                                          CEU011
      *                                                                   CEU011
     C           ECCYB     IFEQ BKEURO                                    149411
     C                     Z-ADDEEDAT     CEVDT                           149411
     C                     Z-ADDRND,1     CLODI                           149411
     C                     Z-ADDRND,2     CLODO                           149411
     C                     Z-ADDRND,6     CLODN                           149411
     C                     Z-ADDRND,3     CLDIN                           149411
     C                     Z-ADDRND,4     CFORP                           149411
     C                     Z-ADDRND,5     CFORS                           149411
     C                     Z-ADDRND,7     CFORN                           149411
     C                     Z-ADDRND,8     CNFXI                           149411
     C                     Z-ADDRND,9     CNETD                           149411
     C                     Z-ADDCUMTT     CCTOT                           149411
     C                     Z-ADDBCEQV     CBEQV                           149411
     C                     ELSE                                           149411
     C                     Z-ADDEEDAT     CEVDT                           CEU011
     C                     Z-ADDERND,1    CLODI                           CEU011
     C                     Z-ADDERND,2    CLODO                           CEU011
     C                     Z-ADDERND,6    CLODN                           CEU011
     C                     Z-ADDERND,3    CLDIN                           CEU011
     C                     Z-ADDERND,4    CFORP                           CEU011
     C                     Z-ADDERND,5    CFORS                           CEU011
     C                     Z-ADDERND,7    CFORN                           CEU011
     C                     Z-ADDERND,8    CNFXI                           CEU011
     C                     Z-ADDERND,9    CNETD                           CEU011
     C                     Z-ADDECUMTT    CCTOT                           CEU011
     C                     Z-ADDEBCEQV    CBEQV                           CEU011
     C                     END                                            149411
      *                                                                   CEU011
     C                     WRITEGLEVCFPF                                  CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/P01  -  Generate Consolidated Euro Report.                *   CEU011
      *                                                               *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           P01       BEGSR                                          CEU011
     C                     MOVE *OFF      *IN48                           149411
      *                                                                   CEU011
     C                     MOVE 'N'       PR1     1                       CEU011
     C                     MOVE 'N'       PR2     1                       CEU011
     C           *LOVAL    SETLLGLEVCFL0                                  CEU011
     C                     READ GLEVCFL0                 84               CEU011
     C           *IN84     DOWEQ'0'                                       CEU011
      *                                                                   CEU011
      ** If Report Header is not yet printed or overflow line             CEU011
      ** ind. is on.                                                      CEU011
      *                                                                   CEU011
     C           PR1       IFEQ 'N'                                       CEU011
     C           *INOF     OREQ '1'                                       CEU011
     C                     MOVE *ON       *IN46                           CEU011
     C                     MOVE *ON       *IN75                           CEU011
     C                     EXCPT                                          CEU011
     C                     MOVE *OFF      *IN46                           CEU011
     C                     MOVE 'Y'       PR1                             CEU011
     C                     MOVE *OFF      *IN75                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** If Call/Notice and Opening Balance Lines is not yet              CEU011
      ** printed.                                                         CEU011
      *                                                                   CEU011
     C           PR2       IFEQ 'N'                                       CEU011
     C                     MOVE *ON       *IN67                           CEU011
     C                     Z-ADDECITH     CITH                            CEU011
     C                     Z-ADDECOTH     COTH                            CEU011
     C                     Z-ADDECNTTH    CNTTH                           CEU011
     C                     Z-ADDENITH     NITH                            CEU011
     C                     Z-ADDENOTH     NOTH                            CEU011
     C                     Z-ADDENETTH    NNETTH                          CEU011
     C                     Z-ADDWCUMTT    CUMTT                           CEU011
     C                     Z-ADDWBCEQV    BCEQV                           CEU011
      *                                                                   CEU011
     C                     EXCPT                                          CEU011
     C                     MOVE *OFF      *IN67                           CEU011
     C                     MOVE 'Y'       PR2                             CEU011
      *                                                                   CEU011
     C                     Z-ADD0         ECITH                           CEU011
     C                     Z-ADD0         ECOTH                           CEU011
     C                     Z-ADD0         ECNTTH                          CEU011
     C                     Z-ADD0         ENITH                           CEU011
     C                     Z-ADD0         ENOTH                           CEU011
     C                     Z-ADD0         ENETTH                          CEU011
     C                     Z-ADD0         WCUMTT                          CEU011
     C                     Z-ADD0         WBCEQV                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ADD  CLODI     RND,1                           CEU011
     C                     ADD  CLODO     RND,2                           CEU011
      *                                                                   CEU011
     C                     ADD  CLODN     RND,6                           CEU011
     C                     ADD  CLDIN     RND,3                           CEU011
      *                                                                   CEU011
     C                     ADD  CFORP     RND,4                           CEU011
     C                     ADD  CFORS     RND,5                           CEU011
      *                                                                   CEU011
     C                     ADD  CFORN     RND,7                           CEU011
     C                     ADD  CNFXI     RND,8                           CEU011
     C                     ADD  CNETD     RND,9                           CEU011
      *                                                                   CEU011
     C***********          ADD  CCTOT     CUMTT                    CEU011 149411
     C***********          ADD  CBEQV     BCEQV                    CEU011 149411
     C                     ADD  CNETD     CUMTT                           149411
     C***********          ADD  CNETD     BCEQV                    149411*154989
     C*                                                                   154989
     C           EUMDIN    IFEQ 'M'                                       154989
     C           CUMTT     MULT EUSPRT    BCEQV     H                     154989
     C                     ELSE                                           154989
     C           CUMTT     DIV  EUSPRT    BCEQV     H                     154989
     C                     END                                            154989
     C*
     C                     ADD  CLODI     TOTO,1                          149411
     C                     ADD  CLODO     TOTO,2                          149411
      *                                                                   149411
     C                     ADD  CLODN     TOTO,6                          149411
     C                     ADD  CLDIN     TOTO,3                          194111
      *                                                                   149411
     C                     ADD  CFORP     TOTO,4                          149411
     C                     ADD  CFORS     TOTO,5                          149411
      *                                                                   149411
     C                     ADD  CFORN     TOTO,7                          149411
     C                     ADD  CNFXI     TOTO,8                          149411
     C                     ADD  CNETD     TOTO,9                          149411
      *                                                                   149411
     C***********          Z-ADD1         Z                        CEU011 149411
      *                                                                   149411
     C***********Z         DOWLE9                                  CEU011 149411
     C***********          ADD  RND,Z     TOTO,Z                   CEU011 149411
     C***********          ADD  1         Z                        CEU011 149411
     C***********          ENDDO                                   CEU011 149411
      *                                                                   CEU011
     C                     Z-ADDCEVDT     PEVDT   50                      CEU011
      * Read next record.                                                 CEU011
     C                     READ GLEVCFL0                 84               CEU011
      *                                                                   CEU011
     C           PEVDT     IFNE CEVDT                                     CEU011
     C           *IN84     OREQ '1'                                       CEU011
      *                                                                   CEU011
     C                     MOVE PEVDT     ZDAYNO                          CEU011
     C                     EXSR ZDATE2                                    CEU011
     C                     MOVE ZADATE    FFVDA                           CEU011
      *                                                                   CEU011
     C           CEVDT     IFGT ENDDY                                     CEU011
     C           *IN84     OREQ *ON                                       149411
     C                     MOVE *ON       *IN48                           CEU011
     C/COPY WNCPYSRC,GL0541C011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     MOVE *ON       *IN68                           CEU011
     C/COPY WNCPYSRC,GL0541C016
     C                     EXCPT                                          CEU011
     C/COPY WNCPYSRC,GL0541C012
      *                                                                   CEU011
     C           *IN48     IFEQ '1'                                       CEU011
     C                     MOVE EDAT      EDATX   50                      CEU011
     C                     MOVE CEVDT     EDAT                            CEU011
     C                     EXSR NXTDAY                                    CEU011
     C                     MOVE EDATX     EDAT                            CEU011
     C                     Z-ADD*ZERO     TOTO                            CEU011
     C                     MOVE *OFF      *IN48                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     Z-ADD*ZERO     RND                             CEU011
     C                     MOVE *OFF      *IN68                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDDO                                          CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/INITF -  Initialise fields before call to EU0200.         *   CEU011
      *                                                               *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           INITF     BEGSR                                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   PRTCD                           CEU011
     C                     MOVE BKEURO    PTOCY                           CEU011
     C                     Z-ADD0         POUTA                           CEU011
     C                     Z-ADD0         PINTA                           CEU011
     C                     Z-ADD0         PEXRT                           CEU011
     C                     MOVE *BLANKS   PMDIN                           CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
     C*
     C********************************************************************
     C*
     C*    ACCUMULATE NET AMOUNTS
     C*
     C           NETS      BEGSR                           NETS
     C*
     C           ACC,1     SUB  ACC,2     ACC,6            NET DEP AMT
     C           ACC,4     SUB  ACC,5     ACC,7            NET FX
     C           ACC,7     ADD  ACC,3     ACC,8            NET FX AND INT
     C           ACC,6     ADD  ACC,8     ACC,9            NET DAY
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C           TOTAL     BEGSR                           TOTAL
     C**SET*UP*FRA/IRS*TYPE*MARKER*ON*SUB-TOTAL*LINE*IF*HEDGED*EVENTS     DT0021
     C**ARE*TO*BE*REPORTED                                                DT0021
     C**********                                                          DT0021
     C********** BQHEOC    IFEQ 'Y'                                       DT0021
     C********** MKR       IFNE *BLANK                                    DT0021
     C********** TMKR      IFEQ *BLANK                                    DT0021
     C**********           MOVE MKR       TMKR    3                       DT0021
     C**********           ELSE                                           DT0021
     C********** MKR       IFNE TMKR                                      DT0021
     C**********           MOVE 'F/I'     TMKR                            DT0021
     C**********           END                                            DT0021
     C**********           END                                            DT0021
     C**********           END                                            DT0021
     C**********           END                                            DT0021
     C/COPY WNCPYSRC,GL0541C004
     C*
     C*
     C*    MAINTENANCE OF PERIOD TOTALS
     C           TOT,1     ADD  ACC,1     TOT,1
     C           TOT,2     ADD  ACC,2     TOT,2
     C           TOT,3     ADD  ACC,3     TOT,3
     C           TOT,4     ADD  ACC,4     TOT,4
     C           TOT,5     ADD  ACC,5     TOT,5
     C           TOT,6     ADD  ACC,6     TOT,6
     C           TOT,7     ADD  ACC,7     TOT,7
     C           TOT,8     ADD  ACC,8     TOT,8
     C           TOT,9     ADD  ACC,9     TOT,9
     C/COPY WNCPYSRC,GL0541C005
     C                     ENDSR
     C********************************************************************
     C*
     C*    CALCULATE END DATE OF FIRST PERIOD
     C*
     C           PEREND    BEGSR
     C*
     C                     MOVE BJMRDT    STDAYA  7
     C           BJRDNB    ADD  7         ENDDY   50
     C                     MOVE ENDDY     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ENDDYA  7
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*
     C*    SUBROUTINE TO FIND START AND END DAYS OF NEXT PERIOD
     C           NXTDAY    BEGSR
     C           DOAGIN    TAG                             ** DOAGIN TAG *
     C                     SETOF                     3233
     C           ENDDY     ADD  1         STDAY   50
     C           D         COMP 4                    34  30
     C   34                GOTO TAG34
     C   30                GOTO TAG30
     C*
     C*    END OF 4TH PERIOD NOT YET REACHED
     C           D         COMP 2                        32
     C           D         COMP 3                        33
     C   32      ENDDY     ADD  3         ENDDY
     C   33      ENDDY     ADD  5         ENDDY
     C                     GOTO FORMAT
     C           TAG30     TAG                             ** TAG30 TAG **
     C*
     C** IF END DATE AFTER 31 DEC 2071
     C*
     C           ENDDY     IFGT 36525
     C                     MOVEL'Y'       OVRFL   1
     C                     ELSE
     C                     MOVEL'N'       OVRFL
     C                     END
     C*
     C                     Z-ADDENDDY     ZDAYNO
     C                     EXSR ZDATE2
     C*
     C*    ZDATE NOW CONTAINS ENDDY IN DDMMYY/MMDDYY FORMAT
     C   98                GOTO MMDDYY
     C*    THIS PART DONE IF FORMAT IS DDMMYY
     C                     MOVELZDATE     DD      2
     C           DD        COMP '15'                   38
     C   38                MOVEL15        ZDATE
     C   38                GOTO CNVRT
     C                     MOVELZDATE     WRK1    4
     C                     MOVE WRK1      MM      2
     C           MM        LOKUPTABM      TABD           33
     C                     MOVELTABD      ZDATE
     C                     GOTO CNVRT
     C           MMDDYY    TAG                             ** MMDDYY TAG *
     C*    THIS PART DONE IF FORMAT IS MMDDYY
     C                     MOVELZDATE     WRK1
     C                     MOVE WRK1      DD
     C           DD        COMP '15'                   38
     C   38                MOVE '15'      WRK1
     C   38                MOVELWRK1      ZDATE
     C   38                GOTO CNVRT
     C                     MOVELWRK1      MM
     C           MM        LOKUPTABM      TABD           33
     C                     MOVE TABD      WRK1
     C                     MOVELWRK1      ZDATE
     C           CNVRT     TAG                             ** CNVRT TAG **
     C                     EXSR ZDATE1
     C           *IN91     IFEQ '1'                                       151655
     C           ZMTH      ANDEQ2                                         151655
     C           *IN38     ANDEQ'0'                                       151655
     C                     ADD  1         ZDAYNO                          151655
     C                     ENDIF                                          151655
     C*
     C** RESTORE DATE
     C*
     C           OVRFL     IFEQ 'Y'
     C                     ADD  36525     ZDAYNO
     C                     END
     C*
     C                     MOVE ZDAYNO    ENDDY
     C                     GOTO FORMAT
     C           TAG34     TAG                             ** TAG34 TAG **
     C                     MOVE ENDDY     ZDAYNO
     C                     MOVE 'S'       ZFREQ
     C                     EXSR SFREQB
     C                     MOVE ZDAYNO    ENDDY
     C*
     C           FORMAT    TAG                             ** FORMAT TAG *
     C                     MOVE STDAY     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    STDAYA
     C                     MOVE ENDDY     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ENDDYA
     C           D         ADD  1         D
     C           EDAT      COMP ENDDY                31
     C   31                GOTO DOAGIN
     C                     ENDSR
     C********************************************************************
     C**
     C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
     C**              CONVERT TO A NUMBER OF DAYS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE1    BEGSR                           *** ZDATE1 ***
     C**
     C**   CLEAR DAY NUMBER.
     C                     Z-ADD0         ZDAYNO  50
     C**
     C**   CALCULATION TO DEFINE INPUT DATE FIELD.
     C                     Z-ADDZDATE     ZDATE   60
     C**
     C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
     C                     MOVE ZDATE     ZYEAR   20
     C  N98                MOVELZDATE     ZDAY    20
     C   98                MOVELZDATE     ZMTH    20
     C                     MOVE ZDATE     ZWRK4   40
     C  N98                MOVELZWRK4     ZMTH
     C   98                MOVELZWRK4     ZDAY
     C**
     C**   ENSURE MONTH IS VALID.
     C           ZMTH      COMP 0                      9999
     C  N99      ZMTH      COMP 12                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR 30 DAY MONTHS.
     C           ZMTH      COMP 4                        90IF 90 ON, 30
     C  N90      ZMTH      COMP 6                        90DAY MONTH.
     C  N90      ZMTH      COMP 9                        90
     C  N90      ZMTH      COMP 11                       90
     C**
     C**   ENSURE DAY IS VALID.
     C           ZDAY      COMP 0                      9999
     C   90N99   ZDAY      COMP 30                   99
     C  N90N99   ZDAY      COMP 31                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR LEAP YEAR AND FEBRUARY.
     C           ZYEAR     ADD  28        ZYEAR
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     91LEAP YR, 91 ON
     C           ZMTH      COMP 2                    93  92FEB., 92 ON
     C**                                                   PAST FEB, 93 ON
     C**   IF FEBUARY FURTHER VALIDATE DAY.
     C  N91 92   ZDAY      COMP 28                   99
     C   91 92   ZDAY      COMP 29                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
     C**
     C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
     C**
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C**
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     CSR         GLZADD    BEGSR                           *** GLZADD ****
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C**
     C********************************************************************
     C*
     C**   SFREQB-SR. TO INCREMENT A DAY NUMBER DATE BY A
     C**             PERIOD VALUE DETERMINED BY A CODE.
     C**
     C           SFREQB    BEGSR                           *** SFREQB ***
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ZFREQ     ZFREQ   1
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C                     Z-ADDZMDAY     ZMDAY   20
     C                     MOVE ZCCY      ZCCY    3
     C**
     C                     MOVE '   '     ZHC
     C                     MOVE ' '       ZTABKY 12
     C*
     C*            FIELDS USED FOR PERIOD CODES M,T,Q,X,Y
     C*
     C                     MOVE '  '      ZINDE   2
     C                     Z-ADD0         ZINTO   20
     C**
     C*
     C** SAVE THE INPUT DATE
     C*
     C                     Z-ADDZDAYNO    SZDYN   50
     C*
     C**   CONVERT DAY NUMBER TO DATE.
     C                     EXSR ZDATE2
     C                     SETOF                     90
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.
     C           ZFREQ     COMP 'D'                      91
     C   91      ZDAYNO    ADD  1         ZDAYNO
     C   91                GOTO ZFHCHK
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.
     C           ZFREQ     COMP 'W'                      91
     C   91      ZDAYNO    ADD  7         ZDAYNO
     C   91                GOTO ZFEND
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.
     C           ZFREQ     COMP 'F'                      91
     C   91      ZDAYNO    ADD  14        ZDAYNO
     C   91                GOTO ZFEND
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.
     C           ZFREQ     COMP 'S'                      91
     C   91      ZDAY      COMP 15                   939292
     C   91 92             Z-ADD31        ZDAY
     C   91 93             Z-ADD15        ZDAY
     C   91 93   ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.
     C           ZFREQ     COMP 'M'                      91
     C   91                MOVE 'IN'      ZINDE
     C** 91 ************** Z-ADDZMDAY *** ZDAY ************               S01211
     C   91      ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTH
     C           ZFREQ     COMP 'R'                      91
     C   91                Z-ADD31        ZDAY
     C   91      ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.
     C           ZFREQ     COMP 'T'                      91
     C   91                MOVE 'IN'      ZINDE
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZMTH      ADD  2         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.
     C           ZFREQ     COMP 'Q'                      91
     C   91                MOVE 'IN'      ZINDE
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZMTH      ADD  3         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.
     C           ZFREQ     COMP 'X'                      91
     C   91                MOVE 'IN'      ZINDE
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZMTH      ADD  6         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.
     C           ZFREQ     COMP 'Y'                      91
     C   91                MOVE 'IN'      ZINDE
     C** 91 ************** Z-ADDZMDAY *** ZDAY ************               S01211
     C   91      ZYEAR     ADD  1         ZYEAR
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH.
     C           ZFREQ     COMP 'L'                      91
     C   91                Z-ADD31        ZDAY
     C** 91 **** ZMTH **** ADD  1 ******* ZMTH ************               S01211
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.
     C           ZFREQ     COMP 'B'                      91
     C   91                Z-ADD31        ZDAY
     C   91      ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 4- 4 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '4'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  4         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 5- 5 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '5'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  5         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 7- 7 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '7'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  7         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 8- 8 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '8'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  8         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 9- 9 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '9'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  9         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE V- 10 MONTHLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'V'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  10        ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE E- 11 MONTHLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'E'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  11        ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE C- TWO YEARLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'C'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  2         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE I- THREE YEARLY                                   CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'I'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  3         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE J- 48 FOUR YEARLY                                 CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'J'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  4         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE N- FIVE YEARLY                                    CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'N'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  5         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE U- TEN YEARLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'U'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  10        ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.
     C           ZFREQ     COMP 'A'                      91
     C*
     C* OBTAIN GENERAL LEDGER DETAILS VIA ACCESS OBJECT
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C********** @GELR     PARM @GELR     DSFDY                                               CGL029
     C           @GELR     PARM @GELR     DSSDY                                               CGL029
     C*
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDGELRPD'DBFILE           **********
     C                     MOVEL'005'     DBASE            *DBERR 05*
     C                     MOVEL@OPTN     DBOPTN  7        **********
     C                     MOVEL@OPTN     DBKEY
     C                     EXSR *PSSR
     C                     SETON                     U7U8LR
     C                     GOTO END
     C                     END
     C   91                Z-ADDBKAPDT    ZDAYNO
     C**
     C**   BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE
     C                     GOTO ZFEND
     C**
     C**
     C**   REFORMAT DATE AND ENSURE VALID.
     C           ZFDATE    TAG                             ** ZFDATE TAG*
     C**
     C**   VALIDATE MONTH.
     C           ZMTH      COMP 12                   91
     C   91      ZMTH      SUB  12        ZMTH
     C   91      ZYEAR     ADD  1         ZYEAR
     C**
     C**   CHECK FOR LEAP YEAR.
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     92LEAP YEAR-92 ON
     C**
     C**   VALIDATE DAY NUMBER.
     C                     MOVE ZFMD,ZMTH ZWRK2   20
     C           ZMTH      COMP 2                        93
     C   92 93             Z-ADD29        ZWRK2
     C**
     C           ZDAY      COMP ZWRK2                94
     C   94                Z-ADDZWRK2     ZDAY
     C**
     C**   CHECK IF CODE R, TO SUBTRACT 6 DAYS.
     C           ZFREQ     COMP 'R'                      91
     C   91      ZDAY      SUB  6         ZDAY
     C**
     C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.
     C                     MOVELZDAY      ZWRK4   40
     C                     MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C   98                MOVE ZDAY      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C                     EXSR ZDATE1
     C*
     C** OVERFLOW DUE TO CROSSING 1 JAN 2071
     C*
     C           ZDAYNO    IFLT SZDYN
     C                     ADD  36525     ZDAYNO
     C                     END
     C*                                                                   S01211
     C**   BYPASS HOLIDAY CHECK - NOT REQUIRED FOR THIS PROGRAM           S01211
     C                     GOTO ZFEND                                     S01211
     C*
     C**
     C**   CHECK IF CODE B, OR M,T,Q,X,Y TO BE CHECKED FOR HOLIDAY.
     C           ZFREQ     COMP 'B'                      91
     C           ZINDE     COMP 'IN'                     92
     C   92N99
     COR 91N99             GOTO ZFHCHK
     C**
     C                     GOTO ZFEND
     C**
     C**   CHECK IF DAY NUMBER IS A HOLIDAY.
     C**
     C           ZFHCHK    TAG                             ** ZFHCHK TAG *
     C                     SETOF                     94
     C           ZFREQ     COMP 'D'                      91
     C           ZFREQ     COMP 'B'                      92
     C   91
     COR 92                GOTO ZSETK
     C*
     C*   FOR CODES M,T,Q,X,Y, CHECK ZINDE - 'IN' TO INCREMENT,
     C*                                    - 'DE' TO DECREMENT
     C*
     C           ZINDE     COMP 'IN'                     90
     C           ZINDE     COMP 'IN'                     91
     C           ZINDE     COMP 'DE'                     92
     C**
     C           ZSETK     TAG                             ** ZSETK TAG **
     C*
     C*  NEW PROCESSING FOR HOLIDAYS FILE.
     C*  INPUT FIELDS FOR SUBROUTINE TO CHECK DAYS ARE ZDAYNO,ZCCY,ZLOC
     C                     MOVELBJSLCD    ZLOC
     C                     EXSR ZCHKH
     C*
     C* IF WORKING DAY GOTO END OF THIS SR.
     C           ZIND      CABEQ'W'       ZFEND
     C*
     C   92                GOTO ZDECR
     C*
     C**   INCREMENT OR DECREMENT DAY NUMBER AS REQUIRED.
     C   91      ZDAYNO    ADD  1         ZDAYNO
     C*
     C*    ONLY FOR PERIOD CODE = M,T,Q,X OR Y, IF INCREMENTATION
     C*    TAKES THE OUTPUT DATE INTO THE FOLLOWING MONTH, RETURN TO
     C*    THE INPUT DATE AND DECREMENT - 92 ON.
     C*
     C   90 91   ZINTO     ADD  1         ZINTO
     C   90 91   ZINTO     ADD  ZDAY      ZINTOT  20
     C   90 91             MOVE ZINTOT    ZINTOA  2
     C                     SETOF                     93
     C   90 91   ZYEAR     DIV  4         ZLYR
     C   90 91             MVR            ZLY            92
     C   90 91 92ZMTH      COMP 2                        93
     C   93      ZINTOA    COMP '29'                 92
     C   90 91N93ZINTOA    COMP ZFMD,ZMTH            92
     C   90 91 92ZDAYNO    SUB  ZINTO     ZDAYNO
     C   90 91 92          MOVE 'DE'      ZINDE
     C**
     C           ZDECR     TAG                             ** ZDECR TAG **
     C   92      ZDAYNO    SUB  1         ZDAYNO
     C                     GOTO ZFHCHK
     C**
     C**
     C           ZFEND     ENDSR                           * ZFEND ENDSR *
     C**
     C*
     C/COPY ZSRSRC,ZACCH
     C*
     C/COPY ZSRSRC,ZCHKH
     C/COPY WNCPYSRC,GL0541C014
     C********************************************************************
     C*
     C*  *PSSR  SR. TO HANDLE DATABASE ERRORS
     C*
     C           *PSSR     BEGSR                           ** *PSSR *
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C                     ENDSR
     C********************************************************************
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0541CP16                                           S01408
      /EJECT                                                              CEU011
     C/COPY ZSRSRC,ZCONVZ1                                                CEU011
     C*                                                                   S01408
     O********************************************************************
     O*    CASH FLOW REPORT
     O*
     O**DL0541P1E**203***46*74***********                                   E257
     O**DL0540P1E**203***46*74***********                            E257 LN0746
     O*DL0541P1E**203***46 74                                       LN0746E22608
     O*********************************  22 'REFERENCE DL0541P1'      E257E22608
     OGL0541P1E  203   46 74                                              E22608
     O                                   22 'REFERENCE GL0541P1'          E22608
     O                         BJURPT    89
     O                                  104 'DATE'
     O                         BJMRDT   112
     O                                  122 'PAGE'
     O                         PAGE  Z  127
     O/COPY WNCPYSRC,GL0541O001
     O        E  1     46 74
     O                                   73 'CASH FLOW IN 000''S FOR'
     O***********              ECCY      77                               CEU011
     O                N75      ECCY      77                               CEU011
     O                 86 75   BKEUCP    77                               CEU011
     O        E  2     46 74
     O                                   75 '------------------------'
     O                                   77 '--'
     O                                  110 'SPOT'
     O***********              A6SPRT   124 '   0 .        '              154989
     O                N75      A6SPRT   124 '   0 .        '              154989
     O                 86 75   EUSPRT   124 '   0 .        '              154989
     O/COPY WNCPYSRC,GL0541O002
     O        E  2     46 74
     O                                   12 'BRANCH'
     O                         EBRC      16
     O                         A8BRNM    48
     O        E  1     46 74
     O                                   36 '* - - - L O A N S / D E '
     O                                   60 'P O S I T S - - - * * - '
     O                                   84 '- - -  F O R E X - - - -'
     O                                  109 '- *   NET FX &       NET'
     O                                  132 'CUM        BASE'
     O        E  2     46 74
     O                                   33 'INCOMING   OUTGOING'
     O                                   63 'NET     INTEREST      PU'
     O************                       87 'RCH      SALES       NET'      E175
     O                                   87 'RCH/IN   SALES/OUT   NET'      E175
     O                                  109 'INTEREST       DAY'
     O                                  132 'TOTAL      EQUIV'
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0541OPG1                                           S01408
     O*                                                                   S01408
     O*                                                                   S01408
     O        E  1     67 74
     O                                    4 'CALL'
     O                         CITH  LB  22
     O                         COTH  LB  33
     O                         CNTTH LB  44
     O        E  2     67 74
     O                                    6 'NOTICE'
     O                         NITH  LB  22
     O                         NOTH  LB  33
     O                         NNETTHLB  44
     O        E  1     67 74
     O                         BJMRDT     7
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0541OPG2                                           S01408
     O*                                                                   S01408
     O*                                                                   S01408
     O                         CUMTT L  121
     O                         BCEQV L  132
     O/COPY WNCPYSRC,GL0541O003
     O        E  1     68 74
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0541OOP1                                           S01408
     O*                                                                   S01408
     O                         FFVDA      7
     O**********               MKR    B  11                               DT0021
     O                         RND,1 LB  22
     O                         RND,2 LB  33
     O                         RND,6 LB  44
     O                         RND,3 LB  55
     O                         RND,4 LB  66
     O                         RND,5 LB  77
     O                         RND,7 LB  88
     O                         RND,8 LB  99
     O                         RND,9 LB 110
     O                         CUMTT L  121
     O                         BCEQV L  132
     O/COPY WNCPYSRC,GL0541O004
     O        E  1     68 48 74
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0541OOP2                                           S01408
     O*                                                                   S01408
     O                         STDAYA     7
     O                                   10 'TO'
     O        E  2     68 48 74
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0541OOP3                                           S01408
     O*                                                                   S01408
     O                         ENDDYA     7
     O**********               TMKR   B  11                               DT0021
     O                         TOTO,1LB  22
     O                         TOTO,2LB  33
     O                         TOTO,6LB  44
     O                         TOTO,3LB  55
     O                         TOTO,4LB  66
     O                         TOTO,5LB  77
     O                         TOTO,7LB  88
     O                         TOTO,8LB  99
     O                         TOTO,9LB 110
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0541OPG                                            S01408
     O*                                                                   S01408
     O        T 3      L3 74
     O                                   66 '*** END OF REPORT FOR'
     O                                   77 ' BRANCH ***'
     O********                           71 '*** END OF BRANCH REPORT'
     O********                           75 ' ***'
     O**DL0541AUT**203***LR**************                                   E257
     O**DL0540AUT**203***LR**************                            E257 LN0746
     O*DL0541AUT  203   LR                                          LN0746E22608
     O**************************************  22 'REFERENCE DL0541AU' E257E22608
     OGL0541AUT  203   LR                                                 E22608
     O                                   22 'REFERENCE GL0541AU'          E22608
     O                         BJURPT    89
     O                                  104 'DATE'
     O                         BJMRDT   112
     O                                  122 'PAGE'
     O                         PAGE1 Z  127
     O        T  1     LRNU7
     O                                   65 'CASH FLOW REPORT'
     O                                   80 '- RUN CONTROLS'
     O        T  1     LRNU7
     O                                   65 '----------------'
     O                                   80 '---------------'
     O        T  236   LRNU7
     O                                   18 'RUN CONTROLS'
     O        T  2     LRNU7
     O                                   59 'NUMBER'
     O        T  2     LRNU7
     O                                   32 'EVENTS FILE RECORDS READ'
     O                         RECRED3   59
     O        T 22     LRNU7NU5
     O                                   26 'SECURITY TRADING 2'
     O                                 +  1 'RECORDS READ'
     O                         #SEIN 3   59
     O        T 3      LRNU7N25
     O                                   63 '*** NO DETAILS TO REPO'
     O                                   70 'RT  ***'
     O        T 22     LR U7 U8
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 2      LR U7 U8
     O                         DBASE     61
     O                                   57 'DATABASE ERROR'
     O                                   67 'FILE'
     O                         DBFILE    78
     O        T 13     LR U7 U8
     O                                   49 'OPTION'
     O                         DBOPTN    57
     O                                   66 'KEY'
     O                         DBKEY     96
     O********T 3      LRNU7N25
     O********                           63 '***   NO DETAILS TO REPO'
     O********                           71 'RT   ***'
     O*****   T 2      LR                                                 E299
     O*****                              72 '*** END OF REPORT ***'       E299
      /COPY ZSRSRC,ZPOWERZ2                                               CEU011
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**   TABM - MONTH NUMBERS
010203040506070809101112
**   TABD - TABLE OF DAYS IN MONTH
312831303130313130313031
** CMD   **      QCMDEXC                                                  CEU011
CLRPFM FILE(GLEVCFPD)                                                     CEU011
