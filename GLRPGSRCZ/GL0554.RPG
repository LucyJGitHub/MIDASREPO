000100200528     H        1
000200200528      *****************************************************************
000300200528/*STD *  RPGBASE                                                      *
000400200528/*EXI *  TEXT('Midas GL Nostros events extract')                      *
000500200528      *****************************************************************
000600200528      *                                                               *
000700200528      *  Midas - Dealing Module                                       *
000800200528      *                                                               *
000900200528      *  GL0554 - Nostro's Events Extract                             *
001000200528      *         - This program is based on DL0550                     *
001100200528      *                                                               *
001200200528      *  (c) Finastra International Limited 2001                      *
001300200528      *                                                               *
001400200604      *  Last Amend No. 249578             Date 22May20               *
001500200528      *  Prev Amend No. MD053950           Date 16Jul19               *
001600200528      *                 MD052216           Date 04Apr19               *
001700200528      *                 MD051925           Date 18Sep18               *
001800200528      *                 MD047513A          Date 23Feb18               *
001900200528      *                 MD048346           Date 20Dec17               *
002000200528      *                 MD046248           Date 27Oct17               *
002100200528      *                 CDL099             Date 06Oct17               *
002200200528      *                 MD040629           Date 05Sep16               *
002300200528      *                 AR743357           Date 06Jul17               *
002400200528      *                 MD044815           Date 13Apr17               *
002500200528      *                 MD036589A          Date 22Feb17               *
002600200528      *                 MD036589           Date 14Feb16               *
002700200528      *                 CLE154             Date 06Aug12               *
002800200528      *                 MD033601           Date 06Aug15               *
002900200528      *                 AR877692           Date 23Jun15               *
003000200528      *                 CGL165             Date 17Feb15               *
003100200528      *                 CDL096             Date 22Sep14               *
003200200528      *                 CDL094             Date 11Jun14               *
003300200528      *                 MD022382A          Date 25Sep13               *
003400200528      *                 MD021048           Date 16Sep13               *
003500200528      *                 AR1028690          Date 29Nov12               *
003600200528      *                 CLE148             Date 23Jul12               *
003700200528      *                 AR745341           Date 09Jun11               *
003800200528      *                 263013             Date 21Jan10               *
003900200528      * Bank Fusion Midas 1.4 Base -----------------------------------*
004000200528      *                 CAP204             Date 15Feb10               *
004100200528      * Midas Plus 1.4 Base 04 ---------------------------------------*
004200200528      *                 CRE026             Date 24May06               *
004300200528      * Midas Plus 1.3 ----------- Base ------------------------------*
004400200528      *                 CDL049             Date 07Jul06               *
004500200528      *                 181612             Date 06Jun06               *
004600200528      *                 CGL044             Date 14Feb06               *
004700200528      *                 CSD031             Date 10Apr06               *
004800200528      *                 CSD027             Date 09Dec05               *
004900200528      *                 CLE042             Date 06Sep05               *
005000200528      *                 CDL038             Date 10May05               *
005100200528      *                 BUG7963            Date 25Jul05               *
005200200528      *                 CSW037A            Date 02May05               *
005300200528      *                 CDL028             Date 07Feb05               *
005400200528      *                 223026             Date 09Oct03               *
005500200528      *                 220952             Date 09Oct03               *
005600200528      *                 BUG5519            Date 22Feb05               *
005700200528      *                 CSD025             Date 11Jan05               *
005800200528      *                 BUG5319            Date 20Jan05               *
005900200528      *                 CSW037             Date 15Dec04               *
006000200528      *                 CSW036             Date 15Dec04               *
006100200528      *                 CLE025             Date 20Oct03               *
006200200528      *                 223572             Date 03Dec03               *
006300200528      *                 CGL029             Date 01Sep03               *
006400200528      *                 CLE033             Date 27Mar03               *
006500200528      *                 CAS006             Date 21Jan03               *
006600200528      *                 CAS005             Date 16Dec02               *
006700200528      *                 CGL015             Date 15Apr02               *
006800200528      *                 208461             Date 30May03               *
006900200528      *                 CLE028             Date 27Jun02               *
007000200528      * Midas Release 4.01.03 ----------------------------------------*
007100200528      *                 209676             Date 09Jan03               *
007200200528      * Midas Release 4.01.02 ----------------------------------------*
007300200528      *                 200529             Date 19Jun02               *
007400200528      * Midas Release 4.01 -------------------------------------------*
007500200528      *                 186084             Date 03Sep01               *
007600200528      * Midas Release 4 --------------- Base -------------------------*
007700200528      *                 196833             Date 16Aug01               *
007800200528      *                 CFF007             Date 13Feb01               *
007900200528      * Midas DBA 3.05 -----------------------------------------------*
008000200528      *                 168838             Date 29Jan01               *
008100200528      *                 CIR003             Date 12Sep00               *
008200200528      * Midas DBA 3.04 -----------------------------------------------*
008300200528      *                 178438             Date 12Sep00               *
008400200528      * Midas DBA 3.03 -----------------------------------------------*
008500200528      *                 177912             Date 26May00               *
008600200528      *                 154382             Date 17Jan00               *
008700200528      * Midas DBA 3.02 -----------------------------------------------*
008800200528      *                 163486             Date 13Oct99               *
008900200528      * Midas DBA 3.00 ---------------- Base -------------------------*
009000200528      *                 149024             Date 12JAN99               *
009100200528      *                 132029             Date 04Oct98               *
009200200528      *                 138007             Date 05Nov98               *
009300200528      *                 138004             Date 14Jul98               *
009400200528      *                 137359             Date 25Aug98               *
009500200528      *                 CEU017             Date 02Apr98               *
009600200528      *                 CSE007             Date 17Mar98               *
009700200528      *                 CEU003             Date 28MAR98               *
009800200528      *                 126735             DATE 18FEB98               *
009900200528      *                 CTI001             Date 12AUG97               *
010000200528      *                 CFF004             DATE 02OCT96               *
010100200528      *                 105140             DATE 18NOV96               *
010200200528      *                 S01408             DATE 12AUG96               *
010300200528      *                 087177             DATE 09JUL96               *
010400200528      *                 098711             DATE 28JUN96               *
010500200528      *                 030749             DATE 03JUN96               *
010600200528      *                 092853             DATE 24APR96               *
010700200528      *                 085626             DATE 23OCT95               *
010800200528      *                 090404             DATE 27SEP95               *
010900200528      *                 073714             DATE 01MAR95               *
011000200528      *                 085626             DATE 21JUN95               *
011100200528      *                 085479             DATE 11APR95               *
011200200528      *                 S01496             DATE 16NOV94               *
011300200528      *                 S01512             DATE 25NOV94               *
011400200528      *                 S01473             DATE 16AUG94               *
011500200528      *                 064882             DATE 06JAN94               *
011600200528      *                 046303             DATE 16JAN94               *
011700200528      *                 036796             DATE 10JAN94               *
011800200528      *                 057118             DATE 19SEP93               *
011900200528      *                 046872             DATE 03SEP93               *
012000200528      *                 045634             DATE 23APR93               *
012100200528      *                 S01393             DATE 30OCT92               *
012200200528      *                 S01392             DATE 20JUL92               *
012300200528      *                 E38323             DATE 31JUL92               *
012400200528      *                 S01117             DATE 18MAR92               *
012500200528      *                 E33033             DATE 09DEC91               *
012600200528      *                 E33042             DATE 09DEC91               *
012700200528      *                 E28817             DATE 14OCT91               *
012800200528      *                 RT0097             DATE 13MAY91               *
012900200528      *                 S01314             DATE 22FEB90               *
013000200528      *                 E23278             DATE 06NOV90               *
013100200528      *                 E22608             DATE 30SEP90               *
013200200528      *                 BHF136             DATE 06JUN90               *
013300200528      *                 LN0135             DATE 23MAY90               *
013400200528      *                 E321               DATE 11APR90               *
013500200528      *                 E306               DATE 09APR90               *
013600200528      *                                                               *
013700200528      *---------------------------------------------------------------*
013800200528      *                                                               *
013900200528      *  249578 - Posiiom settlements.                                *
014000200528      *  MD053950 - Incorrect Value Date for fee payment when CLE031  *
014100200528      *             is ON and settlement currency is not blank.       *
014200200528      *             Include event types FX and FY in checking of the  *
014300200528      *             actual event date.                                *
014400200528      *  MD052216 - Lending Fee's Payment Due and Taken Day           *
014500200528      *  MD051925 - SP18 Build Issue, remove excess ENDIF             *
014600200528      *  MD047513A - No reversal projections for swap deals.  Output  *
014700200528      *              FX net reference for swaps.                      *
014800200528      *  MD048346 - FX netting ICD against FXDEALS will not prioritize*
014900200528      *             customer branch of the FX nets, instead, it will  *
015000200528      *             prioritize (1) system value branch code; if blank,*
015100200528      *             (2) settlement branch of FX net; if blank, then   *
015200200528      *             revert to (3) customer branch of FX net.          *
015300200528      *  MD046248 - Finastra Rebranding                               *
015400200528      *  CDL099 - Split Value Date (Recompile)                        *
015500200528      *  MD040629 - Deposit interest is not shown in the              *
015600200528      *             projected movements.                              *
015700200528      *  AR743357 - Include principal movements in report when PDEI=  *
015800200528      *             Y and prevent unnecessary IRS events.             *
015900200528      *           - Applied for MD033602                              *
016000200528      *  MD044815 - System did not generate reversal projections when *
016100200528      *             FX netting transaction was reversed.  Ensure      *
016200200528      *             complete set of projections are created by the    *
016300200528      *             system during reversal.                           *
016400200528      *  MD036589A - Reopen.  Need to project on netting ICD account. *
016500200528      *  MD036589 - Create nostro event for FX nets.                  *
016600200528      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
016700200528      *  MD033601 - MM Deal Rollover with increase leads to wrong     *
016800200528      *             forecast and no payment message                   *
016900200528      *  AR877692 - Deal with retail nostro account (SETP = 14) do    *
017000200528      *             not post in Projected Account Movements. Applied  *
017100200528      *             fix 251196. (Child: AR877693)                     *
017200200528      *           - Applied for MD-32223.                             *
017300200528      *  CGL165 - Dual Withholding Tax (Recompile)                    *
017400200528      *  CDL096 - Business Day Conventions on MM Deals                *
017500200528      *           (Recompile)                                         *
017600200528      *  CDL094 - Enhance  Receive Settlement Instructions            *
017700200528      *           (Recompiled)                                        *
017800200528      *  MD022382A - PRONOPN differences after check cob 6            *
017900200528      *  MD021048 - DL Events missing from Nostro balance. Amended to *
018000200528      *             use DNWD-1 as start date/basis of event extraction*
018100200528      *           - Applied for MD022382
018200200528      *  AR1028690 - GLC0802C in MSGW with error, SETP not properly   *
018300200528      *              initialised causing a 'D' record to be written on*
018400200528      *              PF/NOSEXAT. Added validation if *IN60 = 0 before *
018500200528      *              SETP will turn on *IN65. (Child: AR1028693)      *
018600200528      *  CLE148 - Alpha Loan Reference                                *
018700200528      *  AR745341 - GLC0802C 00001 FOOB error. (Child: AR745342)      *
018800200528      *  263013 - Error on Projected Nostro Enquiry. Nostro events    *
018900200528      *           should base the extraction from the calendar setup  *
019000200528      *           of the deal currency, instead of local currency.    *
019100200528      *           Part of the fix is to apply 258293 and 259845.      *
019200200528      *  CAP204 - Retail Account Transfer                             *
019300200528      *  CRE026 - Consumer Banking (Recompile)                        *
019400200528      *  CDL049 - Addition of a Reference Rate field (recompile)      *
019500200528      *  181612 - Exclude events with event amount equal to zero.     *
019600200528      *  CGL044 - For Sec. Nostro Extract, Get  Coupon Rate, Issuer   *
019700200528      *           Name and Town.                                      *
019800200528      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
019900200528      *  CSD027 - Conversion Of Customer Number to Alpha              *
020000200528      *  CLE042 - Extended Loan Sub Type                              *
020100200528      *  CDL038 - Extended Deal Sub Type                              *
020200200528      *  BUG7963  Deals that settle across retail (SETP = 05) are     *
020300200528      *           not updating correct nostro.                        *
020400200528      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
020500200528      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
020600200528      *  223026 - Correction of 220952. if autopost posn sett = 'N'.  *
020700200528      *           authorised pos. settlements must be extracted.      *
020800200528      *  220952 - Projections may be duplicated during authorisation  *
020900200528      *           of posn settlements if autopost posn sett = 'N'.    *
021000200528      *           Applied fix 197959.                                 *
021100200528      *  BUG5519 - Fix 208461 conflicts with 209676. Reverse part of  *
021200200528      *            fix 208461. Principal exchange events for cross    *
021300200528      *            currencies should be projected.                    *
021400200528      *  CSD025 - Customer De-Activation                              *
021500200528      *  BUG5319 - Some events are not generated correctly due to     *
021600200528      *            incorrect value of OSAC1.                          *
021700200528      *  CSW037 - Additional Field Data on MT300/MT320                *
021800200528      *  CSW036 - Dual SWIFT BIC held on Client Details               *
021900200528      *  CLE025 - Credit Lines (Recompile)                            *
022000200528      *  223572 - Events By Nostro Rprt is showing the All In and     *
022100200528      *           NTR Events                                          *
022200200528      *  CGL029 - Increase Account Code to 10 digits                  *
022300200528      *  CLE033 - Settlement method 09                                *
022400200528      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
022500200528      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
022600200528      *           (Recompile)                                         *
022700200528      *  CGL015 - Net Amounts on Events by Nostro                     *
022800200528      *  208461 - Prevent incorrect event details for IRS deals from  *
022900200528      *           appearing on the daily events by currency report.   *
023000200528      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
023100200528      *  209676 - Allow the projection of principal changes and       *
023200200528      *           principal exchanges for cross currency IRS deals.   *
023300200528      *  200529 - Maturity posting amount of a loan did not appear on *
023400200528      *           the Events by Nostro report'. Fix will ensure that  *
023500200528      *           posting amounts will be posted on correct Nostro.   *
023600200528      *  186084 - Duplicate transaction in Events by Nostro report.   *
023700200528      *           Reinstate checking for rolled over deals removed by *
023800200528      *           138004 if IPSI is equal to 'Y'.                     *
023900200528      *  196833 - Additional SWIFT Address for CLS Nostros (Recompile)*
024000200528      *  CFF007 - Futures and Options Enhancement for Private Banking *
024100200528      *  168838 - Do not include 'OP' deals in 'Events by Nostro      *
024200200528      *           Report'.                                            *
024300200528      *  CIR003 - Principal Exchange on Cross Currencies IRS          *
024400200528      *  178438 - For SE Coupon and Maturity events, output the       *
024500200528      *           Security details on Events by Nostro report and     *
024600200528      *           on Projected Account Mvmts screen (based on 157381) *
024700200528      *  177912 - Error in 138004 - securities trade events not       *
024800200528      *           appearing in projected nostros.                     *
024900200528      *  154382 - Fix 138007 in this pgm causes events in PF/NOSEXED  *
025000200528      *           to have incorrect event branch and eventually will  *
025100200528      *           not be included in GL0580P1 report for deals which  *
025200200528      *           will settle to a nostro w/ a different branch from  *
025300200528      *           the deal booking branch.                            *
025400200528      *  163486 - Recompiled due to changes to EVNTXED.               *
025500200528      *  149024 - On rollover of a deal, only the amount not rolled   *
025600200528      *           over should appear on Projected Nostro Events rept. *
025700200528      *           Reinstate the line removed by 138004 which subtracts*
025800200528      *           the Rolled over by Deal amount from REPAMT to obtain*
025900200528      *           the correct event amount, if Rollover Ind is 'Y'.   *
026000200528      *  132029 - Do not process fields SETP or OSAC for FT.          *
026100200528      *           Applied fix 120733.                                 *
026200200528      *  138007 - Need to use EBRC not OSBR                           *
026300200528      *  138004 - Problem with events not being  split for Interest   *
026400200528      *         - when deal request that interest should be split.    *
026500200528      *           same fix to resolve problem on 138004/6/7
026600200528      *           REMOVED 137359 AS 138004 APPEARS TO COVER THIS.
026700200528      *  137359 - When Settlement Currency is entered for Deposits,   *
026800200528      *           Projected Movement amount was wrongly calculated by *
026900200528      *           adding Other amount 'IN-CCY' to Event Amount 'EUR'. *
027000200528      *  CEU017 - Securities Redenomination Euro Changes              *
027100200528      *  CSE007 - Corporate Actions                                   *
027200200528      *  CEU003 - EMU DL Settlement Currency Conversion:              *
027300200528      *           Include processing required by EMU switchable       *
027400200528      *           feature CEU003.                                     *
027500200528      *  126735 - FOR GUARANTEES (PTYP=70) ONLY THE INTEREST AND FEES *
027600200528      *           EVENTS SHOULD UPDATE THE PROJECTED NOSTRO BALANCE   *
027700200528      *  CTI001 - Midas / Trade Innovation Interface Phase 1          *
027800200528      *  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
027900200528      *  105140 - Recompile over changed LVENTZZ.                     *
028000200528      *  S01408 - Core Hook GL0554FFP1 Added
028100200528      *         - Core Hook GL0554OOP1 Added
028200200528      *  087177 - Include past-due position settlements               *
028300200528      *  098711 - Events by nostro report (GL0580P1) cannot print out *
028400200528      *           premium due events, even after installing the OTC   *
028500200528      *           enhancements. Branch Code (BRCA) on PF/NOSEXFF      *
028600200528      *           should be explicitly set up with Our Settlement     *
028700200528      *           Branch (OSBR) from PF/FOEVED.                       *
028800200528      *  030749 - Complete fix for 051227 to suppress FRA/IRS         *
028900200528      *           event types (originally only applied to GL0550).    *
029000200528      *           The fix done was to check if the event types are    *
029100200528      *           relevant otherwise, this shouldn't be reported. The *
029200200528      *           relevant event types are as follows: 21I1, 21N1,    *
029300200528      *           21N2, 22I1, 23I1, 24I1, 24N1, 24N2. All other       *
029400200528      *           FRA/IRS events not mentioned are skipped.           *
029500200528      *  092853 - Nostro events were incorrectly extracted based on   *
029600200528      *           Days Forward for Events by Currency                 *
029700200528      *  085626 - Previous incorporation of 085626 (21jun95) incomplete
029800200528      *  090404  - WHEN SETTLEMENT METHOD 5 OR 14 USED, AND THE ACCOUNT*
029900200528      *            IS A NOSTRO, THE PROJECTED NOSTRO BALANCE IS NOT   *
030000200528      *            UPDATED AND THE EVENT IS NOT REPORTED IN THE EVENT *
030100200528      *            BY CURRENCY REPORT.                                *
030200200528      *  073714 - OTC ENHANCEMENTS                                    *
030300200528      *  085626 - Events for rollovers should take into account       *
030400200528      *           interest paid separately and increases              *
030500200528      *  085479 - Customer Lending (LVENTEL) part of EVNTM1 ;         *
030600200528      *           Capitalised interest has an event type of X2 (see   *
030700200528      *           fix E25263 in LE0480 R10.5). This means that the    *
030800200528      *           lending event should have no impact on the Nostro   *
030900200528      *           i.e. should not be extracted as a Nostro event.     *
031000200528      *           The symptom of this error was that GL0580 was       *
031100200528      *           producing RSACMTPD records which were displayed     *
031200200528      *           in Projected Account Movements screen against the   *
031300200528      *           Nostro.                                             *
031400200528      *  S01496 - Incorporation of Jyske Enhancements (S10978).       *
031500200528      *  S01473 - Midas Leo Integration. Addition of LC files and     *
031600200528      *           events processing                                   *
031700200528      *  064882 - Incorrect branch written to pf/nosexfp for Funds    *
031800200528      *           Transfer events; should be settlement branch.       *
031900200528      *  046303 - /COPY source subr. ZFWDT amended to prevent array   *
032000200528      *           error if no holiday record found - fixed by S01434. *
032100200528      *           Program recompiled.                                 *
032200200528      *  036796 - NO. OF FORWARD DAYS FOR NOSTROS EVENTS REPORT       *
032300200528      *           AND EVENTS BY CCY, AND SPOT REVAL. WERE MOVED       *
032400200528      *           FROM DLSTAT TO GLSTAT                               *
032500200528      *  057118 - Rename branch codes in SE events files              *
032600200528      *  046872 - Do not call ZFWDT subroutine if No of Days is 99    *
032700200528      *           as system will set ZDYNBR to 99999 to generate      *
032800200528      *           events to End of Book.                              *
032900200528      *  045634 - Updated to include new lending fee events in        *
033000200528      *           the reporting - facility fees and loan fees         *
033100200528      *  S01393 - Additional Strategic Risk Management Event Types    *
033200200528      *           to skip have been added. Also Book Code added to    *
033300200528      *           PF/EVNTXED.                                         *
033400200528      *  S01392 - JAP.SUB-MODULE INCORPORATION (CORE)                 *
033500200528      *  E38323 - Recompiled over changed copy source ZFWDT subroutine*
033600200528      *  S01117 - RECOMPILED FOR FT RELEASE 10                        *
033700200528      *  E33033 - NOSEXES is an ST1 file so do not write to it.       *
033800200528      *  E33042 - Recompiled over changed lf/EVNTM1.                  *
033900200528      *  E28817 - STEVEAB and STEVEFC are now redundant               *
034000200528      *  RT0097 - Recompiled over changed lf/EVNTM1.                  *
034100200528      *  S01314 - The fix below (E23278), from DL/GL0550, is only used*
034200200528      *           in part in this program, and has been annotated with*
034300200528      *           the R10 PTF incorporation change number.            *
034400200528      *  E23278 - ALLOW DEAL EVENTS HAVING FIELD 'FIPI7 BLANK TO      *
034500200528      *           BE PROCESSED.                                       *
034600200528      *           DO NOT PROCESS DEAL EVENTS WITH ETYP 'M2'.          *
034700200528      *           INSERT NARRATIVES FOR 21C1, 21C2, 22C1, 22C2,       *
034800200528      *           22S1, 22S2, 23C1, 23C2, 24C1 & 24C2.                *
034900200528      *  E22608 - PROGRAM RENAMED FROM DL0554                         *
035000200528      *  BHF136 - EVENTS NOT EXTRACTED FOR DATES MORE THAN 99 WORKING *
035100200528      *           DAYS AFTER THE RUN DATE                             *
035200200528      *  LN0135 - REMOVE 'END OF REPORT' FROM AUDIT REPORT            *
035300200528      *  E321   - INCLUDE HEADER AND TRAILER IN COUNT                 *
035400200528      *  E306   - SHOULD READ SDBANK WHEN RUN ON EMPTY FILES          *
035500200528      *                                                               *
035600200528      *****************************************************************
035700200528     F/COPY WNCPYSRC,GL0554FFP1                                           S01408
035800200528     F*                                                                   S01408
035900200528     FEVNTM1  IP  E           K        DISK
036000200528     F/COPY WNCPYSRC,GL0554F001
036100200528     FDRSDEALSIF  F    1074  6AI     2 DISK                               S01392
036200200528     FDEALS   IF  E           K        DISK                                                 AR743357
036300200528     F            DEALSDAF                          KIGNORE                                 AR743357
036400200528     F**********  DEALSDBF                          KIGNORE                        AR743357 MD036589
036500200528     F            DEALSDCF                          KIGNORE                                 AR743357
036600200528     F            DEALSDDF                          KIGNORE                                 AR743357
036700200528     F            DEALSDEF                          KIGNORE                                 AR743357
036800200528     F            DEALSDFF                          KIGNORE                                 AR743357
036900200528     F**********  DEALSDGF                          KIGNORE                        MD036589 AR743357
037000200528     F/COPY WNCPYSRC,GL0554F003
037100200528     FSDNOSTL4IF  E           K        DISK                               090404
037200200528     FACNUM   IF  E           K        DISK                               090404
037300200528     FFXNETML3IF  E           K        DISK                                                MD036589A
037400200528     FNOSEXEC O   F     320            DISK
037500200528     F***NOSEXED O   F     320            DISK                                                CGL029
037600200528     F***NOSEXCC O   F     320            DISK                                                CGL029
037700200528     F***NOSEXEL O   F     320            DISK                                                CGL029
037800200528     F*NOSEXED*O   F     336            DISK                                           CGL029 CDL038
037900200528     FNOSEXED O   F     340            DISK                                                   CDL038
038000200528     F*NOSEXCC*O***F*****336            DISK                                           CGL029 CLE042
038100200528     F*NOSEXEL*O***F*****336            DISK                                           CGL029 CLE042
038200200528     FNOSEXCC O   F     340            DISK                                                   CLE042
038300200528     FNOSEXEL O   F     340            DISK                                                   CLE042
038400200528     F*NOSEXES*O***E                    DISK                      A       E33033
038500200528     FNOSEXSE O   E                    DISK                      A
038600200528     FNOSEXFP O   E                    DISK                      A
038700200528     F/COPY WNCPYSRC,GL0554F002
038800200528     FNOSEXZZ O   F     320            DISK
038900200528     FNOSEXFF O   E                    DISK                      A        073714
039000200528     FNSXBCED O   E                    DISK                      A        S01473
039100200528     FNOSEXAT O   E                    DISK                      A                            CAP204
039200200528     F*DL0554AUO***F*****132     OV     PRINTER                           E22608
039300200528     FGL0554AUO   F     132     OV     PRINTER                            E22608
039400200528     F* ID F  C  H  L    FUNCTION OF INDICATORS
039500200528     F* 01            EVENT HEADER
039600200528     F* 02            EVENT DETAIL - DEAL EVENT
039700200528     F* 03            EVENT DETAIL - COMMERCIAL LOAN EVENT
039800200528     F* 04            EVENT TRAILER
039900200528     F*       11      NEGATIVE INTEREST INDICATOR
040000200528     F* 12            EVENT TRAILER - COMMERCIAL LOAN EVENT
040100200528     F* 13            CUSTOMER LENDING EVENT
040200200528     F* 14            CUSTOMER LENDING EVENTS FILE TRAILER
040300200528     F* 15            LETTERS OF CREDIT EVENT DETAIL                      S01473
040400200528     F* 16            LETTERS OF CREDIT EVENT TRAILER                     S01473
040500200528     F**17************SECURITIES*TRADING*EVENT*DETAIL******************   E28817
040600200528     F**18************SECURITIES*TRADING*EVENT*TRAILER*****************   E28817
040700200528     F*    20         FULL INSTRUCTIONS PRESENT INDICATOR IS BLANK - DEAL
040800200528     F*    21         INCOMING/OUTGOING INDICATOR IS BLANK
040900200528     F*    26         TRADE EVENTS DETAIL HAS BEEN READ
041000200528     F*    27         CUSTOMER POSITION EVENTS DETAIL HAS BEEN READ
041100200528     F*    28         DEPOT POSITION EVENTS DETAIL HAS BEEN READ
041200200528     F*    29         BOOK POSITION EVENTS DETAIL HAS BEEN READ
041300200528     F*      N34      NO DETAILS TO REPORT
041400200528     F*       36      NEGATIVE AMOUNT IN HASH TOTALLING
041500200528     F* 37            FUNDS TRANSFER EVENT DETAIL
041600200528     F* 38            FUNDS TRANSFER EVENT TRAILER
041700200528     F*       40      NUMBER OF DAYS IS LESS THAN 5
041800200528     F*      N41      EVENT IS TO BE REPORTED
041900200528     F*       42      EVENT CODE ENDS WITH 'M1' DEAL EVENT ONLY
042000200528     F*       48      COMMITMENT FEE EVENT
042100200528     F*       49      FIRST CYCLE INDICATOR
042200200528     F********51******DAYS*FORWARD*HAS*NOT*BEEN*SET*                      036796
042300200528     F******************(CAN*OCCUR*IF*ST.*BUT*NOT*DL.*IS*IN*THE*SYSTEM.)* 036796
042400200528     F*       53      CSE007 present                                      CSE007
042500200528     F*       53      CEU017 present                                      CEU017
042600200528     F*       60      Generated Entries Event Detail                                          CAP204
042700200528     F*       61      Generated Entries Event Trailer                                         CAP204
042800200528     F*       63      S01496 present                                      S01496
042900200528     F*       65      EVENT RECORD IS TO BE OUTPUT TO NOSEX
043000200528     F* 81            ROLLOVER INDICATOR = 'Y', DEAL EVENT ONLY           149024
043100200528     F* 82            EVNTM DETAIL - FO RECORD
043200200528     F* 83            EVNTM TRAILER- FO RECORD
043300200528     F*       U7 U8   DATABASE ERROR
043400200528     E                    CPY@    1   1 80
043500200528     E                    INT         1 15 0             HASH TOTALS
043600200528     E                    DEC         1  3 0             HASH TOTALS
043700200528     E*
043800200528      /COPY ZSRSRC,ZHOLE
043900200528     E*
044000200528     I*
044100200528     I*    DEALS EVENTS FILE - HEADER RECORD.
044200200528     I*
044300200528     IEVNTXECF    01
044400200528     I*
044500200528     I*    EVENTS FILE - DEALS DETAIL RECORD.
044600200528     I*
044700200528     IEVNTXEDF    02
044800200528     I                                              FIPI            20
044900200528     I                                              INOI            21
045000200528     I*
045100200528     I*    MERGED EVENTS FILE - COMMERCIAL LOAN DETAIL RECORD.
045200200528     I*
045300200528     ICEVNXCCF    03
045400200528     I                                              INOI            21
045500200528     I**********    LNNO                            DLNO                                      CLE148
045600200528     I              BWCN                            CUNR
045700200528     I              LNTP                            DTYP
045800200528     I              LNST                            DLST
045900200528     I              OSACQQ                          OSC1QQ                                    CGL029
046000200528     I*
046100200528     I*    MERGED EVENTS FILE - CUSTOMER LENDING DETAIL RECORD
046200200528     I*
046300200528     ILVENTELF    13
046400200528     I                                              INOI            21
046500200528     I              LTYP                            DTYP
046600200528     I              SUTP                            DLST
046700200528     I              DFCE                            LCEQ
046800200528     I              CDOM                            CLOC
046900200528     I              ECDP                            DEC1
047000200528     I              FACT                            FTYP
047100200528     I              FCNO                            FSEQ
047200200528      *                                                                   S01473
047300200528     IBVNTXEDF    15                                                      S01473
047400200528     I                                              ECCY  L1              S01473
047500200528     I                                              OTHD            22    S01473
047600200528     I                                              INOI            21    S01473
047700200528      ** Letters of Credit Event Detail                                   S01473
047800200528      *                                                                   S01473
047900200528     IBVNTXEZF    16                                                      S01473
048000200528      ** Letters of Credit Events File Trailer                            S01473
048100200528      *                                                                   S01473
048200200528     I*
048300200528     I*   SECURITIES TRADING EVENT DETAIL
048400200528     I*
048500200528     I*STEVEABF    17                                                     E28817
048600200528     I***********   RECI                            RECIST                E28817
048700200528     I***********   ODTE                            OTHD                  E28817
048800200528     I***********   IOIN                            INOI            21    E28817
048900200528     I***********   SBEE                            BCEQ                  E28817
049000200528     I***********   DBRT                            DBCR                  E28817
049100200528     I***********   TRDR                            DLNO                  E28817
049200200528     I***********   TRSE                            DLST                  E28817
049300200528     I***********   TRTE                            DTYP                  E28817
049400200528     I***********   DNEE                            LCEQ                  E28817
049500200528     I***********   OURE                            OSAC                  E28817
049600200528     I***********   NOMC                            OTHC                  E28817
049700200528     I***********   REGR                            REGC                  E28817
049800200528     I***********   SETL                            SETP                  E28817
049900200528     I***********   OAME                            OTHA                  E28817
050000200528     I*
050100200528     I*   TRADE EVENT DETAIL
050200200528     I*
050300200528     ITREVEDF     26
050400200528     I              TRRI                            RECI
050500200528     I              TRSS                            SECS
050600200528     I              TRTT                            DTYP
050700200528     I              TRVD                            EDAT
050800200528     I              TRSC                            ECCY
050900200528     I              TRVS                            EAMT
051000200528     I              TRTS                            DLST
051100200528     I              TRCN                            CRNM
051200200528     I              TRTN                            CTWN
051300200528     I              TRIO                            INOI            21
051400200528     I              TREC                            ETYP
051500200528     I              EBRC                            BRCA                  057118
051600200528     I              EARL                            WEARL                 S01496
051700200528     I              COAF                            WCOAF                 CSE007
051800200528     I*
051900200528     I*   CUSTOMER POSTITION EVENTS DETAIL
052000200528     I*
052100200528     ICPEVEDF     27
052200200528     I              CCRN                            CRNM
052300200528     I              CCTR                            CTWN
052400200528     I**************CCDT                            EDAT                  S01512
052500200528     I              CPYD                            EDAT                  S01512
052600200528     I              CCCE                            ETYP
052700200528     I              CCEC                            ECCY
052800200528     I              CCSS                            SECS
052900200528     I              CCIO                            INOI            21
053000200528     I              CCEA                            EAMT
053100200528     I              EBRC                            BRCA                  057118
053200200528     I              MDTI                            WMDTI                 S01496
053300200528     I              EARL                            WEARL                 S01496
053400200528     I              COAF                            WCOAF                 CSE007
053500200528     I*
053600200528     I*   DEPOT POSTITION EVENTS DETAIL
053700200528     I*
053800200528     IDPEVEDF     28
053900200528     I              CCDN                            CRNM
054000200528     I              CCTW                            CTWN
054100200528     I**************CCDT                            EDAT                  S01512
054200200528     I              CCPD                            EDAT                  S01512
054300200528     I              CCCE                            ETYP
054400200528     I              CCEC                            ECCY
054500200528     I              CCSS                            SECS
054600200528     I              CCIO                            INOI            21
054700200528     I              CCEA                            EAMT
054800200528     I              EBRC                            BRCA                  057118
054900200528     I              MDTI                            WMDTI                 S01496
055000200528     I              EARL                            WEARL                 S01496
055100200528     I              COAF                            WCOAF                 CSE007
055200200528     I*
055300200528     I*   BOOK POSTITION EVENTS DETAIL
055400200528     I*
055500200528     IBPEVEDF     29
055600200528     I**************CCDT                            EDAT                  S01512
055700200528     I              CCPD                            EDAT                  S01512
055800200528     I              CCCE                            ETYP
055900200528     I              CCEC                            ECCY
056000200528     I              CCSS                            SECS
056100200528     I              CCIO                            INOI            21
056200200528     I              CCEA                            EAMT
056300200528     I*
056400200528     IFPVNTDDF    37
056500200528     I*
056600200528     I*  FUNDS TRANSFER EVENTS DETAIL RECORD
056700200528     I*
056800200528     I                                              INOI            21
056900200528      *                                                                                       CAP204
057000200528      ** ACCOUNT TRANSFER DETAIL RECORD                                                       CAP204
057100200528      *                                                                                       CAP204
057200200528     IGLEVNTDF    60                                                                          CAP204
057300200528     I                                              INOI            21                        CAP204
057400200528     I/COPY WNCPYSRC,GL0554I002
057500200528     I*
057600200528     I*
057700200528     I*
057800200528     I*    DEALS EVENTS FILE - TRAILER RECORD.
057900200528     I*
058000200528     IEVNTXZZF    04
058100200528     I*
058200200528     I*
058300200528     I*    COMMERCIAL LOANS EVENTS FILE - TRAILER RECORD.
058400200528     I*
058500200528     ICEVNXZZF    12
058600200528     I*
058700200528     I*    CUSTOMER LENDING EVENTS FILE TRAILER
058800200528     I*
058900200528     ILVENTZZF    14
059000200528     I*
059100200528     I*    SECURITIES TRADING EVENTS FILE TRAILER
059200200528     I*
059300200528     I*STEVEFCF    18                                                     E28817
059400200528     I***********   HSTA                            HRWN                  E28817
059500200528     I***********   HSTB                            HRDC                  E28817
059600200528     I*
059700200528     IFPVNTZZF    38
059800200528     I*
059900200528     I*    FUNDS TRANSFER EVENTS FILE TRAILER
060000200528     I*
060100200528     I              NORE1                           NORE
060200200528     I*
060300200528     I*    EVNTM FILE - FO DETAIL RECORD
060400200528     IFOEVEDF     82
060500200528     I                                              INOI            21    073714
060600200528     I*
060700200528     I*    EVNTM FILE - FO TRAILER
060800200528     IFOEVEZZF    83
060900200528      *                                                                                       CAP204
061000200528      **   ACCOUNT TRANSFER TRAILER RECORD                                                    CAP204
061100200528      *                                                                                       CAP204
061200200528     IGLEVNTZF    61                                                                          CAP204
061300200528     I              ZZ304                           GZZ304                                    CAP204
061400200528     IDRSDEALSNS                                                          S01392
061500200528     I                                    P 214 2200TOTI                  S01392
061600200528     I/COPY WNCPYSRC,GL0554I003
061700200528     I*
061800200528     ISDBANK    E DSSDBANKPD
061900200528     I** EXTERNAL DS FOR BANK DETAILS
062000200528     I*
062100200528     ISCSARD    E DSSCSARDPD                                              S01473
062200200528      ** Switchable Features File                                         S01473
062300200528      *                                                                   S01473
062400200528      ** Securities Trading ICD                                                               220952
062500200528      *                                                                                       220952
062600200528     ISDSTRD    E DSSDSTRDPD                                                                  220952
062700200528      *                                                                                       220952
062800200528     ISDMOD     E DSSDMMODPD                                              CTI001
062900200528     I**  EXTERNAL DS FOR MODULE ID'S                                     CTI001
063000200528     I*                                                                   CTI001
063100200528     ISDCUST    E DSSDCUSTPD                                              CFF007
063200200528      ** External data structure for customer details                     CFF007
063300200528      *                                                                   CFF007
063400200528     ISDBRCH    E DSSDBRCHPD                                                               MD036589A
063500200528     I              QQDFAC                          QQDFA1                                 MD036589A
063600200528      ** Branch Details                                                                    MD036589A
063700200528      *                                                                                    MD036589A
063800200528     ISDCTRY    E DSSDCTRYPD                                                               MD036589A
063900200528      ** Country Details                                                                   MD036589A
064000200528      *                                                                                    MD036589A
064100200528     ISDDEAL    E DSSDDEALPD                                                               MD036589A
064200200528     I              QQACCD                          QQACC1                                 MD036589A
064300200528     IDSFDY     E DSDSFDY
064400200528     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
064500200528     I*
064600200528     IDSSDY     E DSDSSDY
064700200528     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
064800200528     I*
064900200528      /COPY ZSRSRC,ZHOLI
065000200528     I*
065100200528     ILOT1        DS                            256
065200200528     I                                        1   1 RECI
065300200528     I                                        2   70DLNO
065400200528     I** (SOME FORMATS FOR EVNTM HAVE CNUM (6,0) , OTHERS CUNR (6A)
065500200528     I**  USE DATA STRUCTURE TO ENSURE ALL INPUT IN CNUM.)
065600200528     I**********                              8  130CNUM                                      CSD027
065700200528     I                                        8  13 CNUM                                      CSD027
065800200528     I                                        8  13 CUNR
065900200528     I                                       14  17 ETYP
066000200528     I                                    P  18  200EDAT
066100200528     I                                    P  21  270EAMT
066200200528     I                                       28  30 ECCY
066300200528     I                                       31  320ECSS
066400200528     I                                       33  34 DTYP
066500200528     I                                       35  36 DLST
066600200528     I*************                          37  39 OSBR                  138007
066700200528     I***********                            37  39 EBRC           138007 154382
066800200528     I                                       37  39 OSBR                  154382
066900200528     I                                    P  40  468EXRT
067000200528     I                                       47  47 NGII
067100200528     I                                       48  500NOTD
067200200528     I                                    P  51  530OTHD
067300200528     I                                    P  54  600OTHA
067400200528     I                                       61  63 OTHC
067500200528     I                                    P  64  700DBCE
067600200528     I                                    P  71  770BCEQ
067700200528     I                                    P  78  848DBCR
067800200528     I                                    P  85  910LCEQ
067900200528     I                                       92  930SETP
068000200528     I**********                             94 105 OSAC                                      CGL029
068100200528     I                                       94  95 OSAC1                                     CGL029
068200200528     I                                      106 115 TSEN
068300200528     I                                      116 118 ZZ0116
068400200528     I                                      119 119 FIPI
068500200528     I                                      120 120 INOI
068600200528     I                                      121 121 FCTI
068700200528     I                                      122 122 RLVI
068800200528     I** (SOME FORMATS FOR EVNTM HAVE CPAR (6,0) , OTHERS PTNU (6A)
068900200528     I**  USE DATA STRUCTURE TO ENSURE ALL INPUT IN CPAR.)
069000200528     I**********                            123 1280CPAR                                      CSD027
069100200528     I                                      123 128 CPAR                                      CSD027
069200200528     I                                      123 128 PTNU
069300200528     I                                      129 1290PARI
069400200528     I                                      130 149 CRNM
069500200528     I                                      150 159 CTWN
069600200528     I                                      160 167 CASK
069700200528     I                                      168 187 PRNM
069800200528     I                                      188 197 PTWN
069900200528     I                                      198 205 PASK
070000200528     I                                      206 207 CCTZ
070100200528     I                                      208 209 CLOC
070200200528     I                                      210 211 REGC
070300200528     I                                      212 2140DASN
070400200528     I                                    P 215 2170FFVD
070500200528     I                                      218 218 FFIN
070600200528     I                                      219 2210FACT
070700200528     I                                      222 2230FCNO
070800200528     I                                      224 233 FACO
070900200528     I                                      234 256 SPI11
071000200528     ILOT2        DS                             64
071100200528     I                                        1  12 SPI21
071200200528     I**********                             13  180CPCN                                      CSD027
071300200528     I                                       13  18 CPCN                                      CSD027
071400200528     I                                       19  190FSLI
071500200528     I                                    P  20  257ICIR
071600200528     I                                    P  26  320ICAM
071700200528     I                                    P  33  390RBDA
071800200528     I                                       40  40 OCFF
071900200528     I                                       41  63 ZZ0296
072000200528     I                                       64  64 TAXI
072100200528     ILOT3        DS                            256
072200200528     I                                        1   1 RECI1
072300200528     I                                        2   70DLNO1
072400200528     I**********                              8  130DDNO                                      CLE148
072500200528     I                                        8  13 DDNO                                      CLE148
072600200528     I**********                             14  190CNUM1                                     CSD027
072700200528     I                                       14  19 CNUM1                                     CSD027
072800200528     I                                       20  23 ETYP1
072900200528     I                                    P  24  260EDAT1
073000200528     I                                    P  27  330EAMT1
073100200528     I                                       34  36 ECCY1
073200200528     I                                       37  380ECSS1
073300200528     I                                       39  40 DTYP1
073400200528     I                                       41  42 DLST1
073500200528     I                                       43  45 BRCA1
073600200528     I                                    P  46  480OTHD1
073700200528     I                                    P  49  550OTHA1
073800200528     I                                       56  58 OTHC1
073900200528     I                                    P  59  650BCEQ1
074000200528     I                                    P  66  720LCEQ1
074100200528     I                                    P  73  750CSTD
074200200528     I                                    P  76  780CMTD
074300200528     I                                       79  790RPYT
074400200528     I                                    P  80  857EINR
074500200528     I                                       86  870SETP1
074600200528     I**********                             88  99 OSACA                                     CGL029
074700200528     I                                      100 109 TSEN1
074800200528     I                                    P 110 1179DXRT
074900200528     I                                      118 1180DEC1
075000200528     I                                      119 1190DEC2
075100200528     I                                      120 139 CRNM1
075200200528     I                                      140 149 CTWN1
075300200528     I                                      150 157 CASK1
075400200528     I                                      158 177 PRNM1
075500200528     I                                      178 187 PTWN1
075600200528     I                                      188 195 PASK1
075700200528     I                                      196 196 INOI1
075800200528     I                                      197 197 CYSW
075900200528     I                                      198 199 CRSK
076000200528     I                                      200 201 CLOC1
076100200528     I                                      202 203 REGC1
076200200528     I                                      204 204 FFIN1
076300200528     I                                    P 205 2070FFVD1
076400200528     I                                    P 208 2140OADD
076500200528     I                                    P 215 2170LIPD
076600200528     I                                      218 2180PARI1
076700200528     I**********                            219 2240CPAR1                                     CSD027
076800200528     I                                      219 224 CPAR1                                     CSD027
076900200528     I                                      225 256 ZZ0225
077000200528     ILOT4        DS                            256
077100200528     I                                        1   1 RECI2
077200200528     I**********                              2   70LNRF2                                     CLE148
077300200528     I                                        2   7 LNRF2                                     CLE148
077400200528     I                                        8  130ZZ0008
077500200528     I**********                             14  190CNUM2                                     CSD027
077600200528     I                                       14  19 CNUM2                                     CSD027
077700200528     I                                       20  23 ETYP2
077800200528     I                                    P  24  260EDAT2
077900200528     I                                    P  27  330EAMT2
078000200528     I                                       34  36 ECCY2
078100200528     I                                       37  380ECSS2
078200200528     I                                       39  40 DTYP2
078300200528     I                                       41  42 DLST2
078400200528     I                                       43  45 BRCA2
078500200528     I                                    P  46  480OTHD2
078600200528     I                                    P  49  550OTHA2
078700200528     I                                       56  58 ZZ0056
078800200528     I                                    P  59  650BCEQ2
078900200528     I                                    P  66  720LCEQ2
079000200528     I                                       73  78 ZZ0073
079100200528     I                                       79  790NGII2
079200200528     I                                    P  80  857INTR2
079300200528     I                                       86  870SETP2
079400200528     I**********                             88  99 OSACB                                     CGL029
079500200528     I                                      100 109 TSEN2
079600200528     I                                      110 117 ZZ0110
079700200528     I                                      118 1180DEC12
079800200528     I                                      119 119 ZZ0119
079900200528     I                                      120 139 CRNM2
080000200528     I                                      140 149 CTWN2
080100200528     I                                      150 157 CASK2
080200200528     I                                      158 177 PRNM2
080300200528     I                                      178 187 PTWN2
080400200528     I                                      188 195 PASK2
080500200528     I                                      196 196 INOI2
080600200528     I                                      197 197 ZZ0197
080700200528     I                                      198 199 CRSK2
080800200528     I                                      200 201 CLOC2
080900200528     I                                      202 203 REGC2
081000200528     I                                      204 217 ZZ0204
081100200528     I                                      218 2180PARI2
081200200528     I**********                            219 2240CPAR2                                     CSD027
081300200528     I                                      219 224 CPAR2                                     CSD027
081400200528     I                                      225 256 ZZ225
081500200528     I            DS                                                      045634
081600200528     I                                        1   30FTYP                  045634
081700200528     I                                        4   50FSEQ                  045634
081800200528     I                                        1   5 FLNRF                 045634
081900200528      *
082000200528      *  DS FOR SDNOSTL4                                                  090404
082100200528      *                                                                   090404
082200200528     I            DS                                                      090404
082300200528     I**********                              1  12 OSACNO                             090404 CGL029
082400200528     I                                        1  18 OSACNO                                    CGL029
082500200528     I                                        1   6 KCUST                 090404
082600200528     I**********                              7  10 KACCD                              090404 CGL029
082700200528     I**********                             11  120KACSN                              090404 CGL029
082800200528     I                                        7  16 KACCD                                     CGL029
082900200528     I                                       17  180KACSN                                     CGL029
083000200528      *                                                                   090404
083100200528     I            DS                                                      CFF007
083200200528     I                                        1 228 ZZ228                 CFF007
083300200528     I                                        1   60WTNBR                 CFF007
083400200528     I                                        7   80WCSLT                 CFF007
083500200528     I                                        9  20 WCSLA                 CFF007
083600200528      *                                                                   CFF007
083700200528     ISPI         DS                             35
083800200528     I                                        1  23 SPI1
083900200528     I                                       24  35 SPI2
084000200528     I*DLSTAT****UDS                            256                       036796
084100200528     I***********                            10  110DAYS                  036796
084200200528     I***********                            10  11 DYSA                  036796
084300200528     IGLSTAT     UDS                            256                       036796
084400200528     I**********                             33  340DAYS            036796092853
084500200528     I**********                             33  34 DYSA            036796092853
084600200528     I                                       31  320DAYS                  092853
084700200528     I                                       31  32 DYSA                  092853
084800200528     I/COPY WNCPYSRC,GL0554I001
084900200528     I              'CcyBasisForNosEvts  'C         SVALKK                                 MD022382A
085000200528     ISVAL1       DS                            200                                        MD022382A
085100200528     I                                        1   1 SVAL11                                 MD022382A
085200200528     I              'FXnetBranch'         C         FXSVAL                                  MD048346
085300200528     I/EJECT
085400200528     C*
085500200528     C* KLIST FOR SDNOSTL4                                                090404
085600200528      *                                                                   090404
085700200528     C           NOKEY     KLIST                                          090404
085800200528     C                     KFLD           KCUST                           090404
085900200528     C                     KFLD           ECCY                            090404
086000200528     C                     KFLD           KACCD                           090404
086100200528     C                     KFLD           KACSN                           090404
086200200528     C*
086300200528     C*    F I R S T   C Y C L E
086400200528     C*
086500200528     C***49*****           GOTO DETAIL                                                        263013
086600200528     C***49*****           GOTO PROJEC                                              263013 MD022382A
086700200528      *                                                                                    MD022382A
086800200528     C           *IN49     IFEQ '1'                                                        MD022382A
086900200528      * 'D' - Deal currency                                                                MD022382A
087000200528     C           CCYBAS    CABEQ'D'       PROJEC                                           MD022382A
087100200528      * 'L' - Local currency                                                               MD022382A
087200200528     C           CCYBAS    CABEQ'L'       DETAIL                                           MD022382A
087300200528     C                     ENDIF                                                           MD022382A
087400200528      *
087500200528     C                     SETON                     49
087600200528     C                     MOVEACPY@      BIS@   80
087700200528      *
087800200528     C*
087900200528     C** READ BANK DETAILS VIA ACCESS PROGRAM
088000200528     C                     CALL 'AOBANKR0'
088100200528     C                     PARM '*MSG   ' @RTCD   7
088200200528     C                     PARM '*FIRST ' @OPTN   7
088300200528     C           SDBANK    PARM SDBANK    DSFDY
088400200528     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
088500200528     C           @RTCD     IFNE *BLANK
088600200528     C                     MOVEL'SDBANKPD'DBFILE 10        ************
088700200528     C                     MOVEL'01'      DBASE   2        * DBERR 01 *
088800200528     C                     MOVEL@OPTN     DBOPTN  7        ************
088900200528     C                     MOVEL@OPTN     DBKEY  29
089000200528     C                     EXSR *PSSR
089100200528     C                     SETON                     99
089200200528     C                     GOTO END
089300200528     C                     END
089400200528     C***THIS*PROGRAM*CAN*BE*RUN*BY*SECURITIES*TRADING*WITHOUT*DEALING*   036796
089500200528     C***IN*THE*SYSTEM,*IN*WHICH*CASE*D/DLSTAT*WILL*NOT*BE*SET.***        036796
089600200528     C***********DYSA      COMP '  '                     51               036796
089700200528     C***51******          MOVE '99'      DYSA                            036796
089800200528     C*                                                                   046872
089900200528     C** If days not set to 99, calculate this no of working days fwd     046872
090000200528     C*                                                                   046872
090100200528     C           PROJEC    TAG                                                                263013
090200200528     C           DAYS      IFNE 99                                        046872
090300200528     C                     Z-ADDDAYS      ZNRDYS
090400200528     C           DAYS      COMP 5                      40
090500200528     C   40                Z-ADD5         ZNRDYS
090600200528     C**********           MOVE BJRDNB    ZDAYNO                                            MD021048
090700200528     C           BJDNWD    SUB  1         ZDAYNO                                            MD021048
090800200528     C                     MOVE BJLCCY    ZCCY
090900200528     C           *IN49     IFEQ '1'                                                           263013
091000200528     C           CCYBAS    ANDEQ'D'                                                        MD022382A
091100200528     C                     MOVE ECCY      ZCCY                                                263013
091200200528     C                     ENDIF                                                              263013
091300200528     C                     MOVE BJSLCD    ZLOC    3
091400200528     C                     EXSR ZFWDT
091500200528     C*
091600200528     C*    IF DAYS IS SET TO 99 ALLOW ALL EVENTS TO END OF BOOK TO        BHF136
091700200528     C*    BE PRODUCED                                                    BHF136
091800200528     C***********DAYS      IFEQ 99                                 BHF136 046872
091900200528     C                     ELSE                                           046872
092000200528     C                     MOVE 99999     ZDYNBR                          BHF136
092100200528     C                     END                                            BHF136
092200200528     C           *IN49     IFEQ '1'                                                           263013
092300200528     C           CCYBAS    ANDEQ'D'                                                        MD022382A
092400200528     C                     GOTO DETAIL                                                        263013
092500200528     C                     ENDIF                                                              263013
092600200528      *                                                                                       220952
092700200528     C                     CALL 'AOSTRDR0'                                                    220952
092800200528     C                     PARM *BLANKS   @RTCD                                               220952
092900200528     C                     PARM '*FIRST ' @OPTN                                               220952
093000200528     C           SDSTRD    PARM SDSTRD    DSFDY                                               220952
093100200528      *                                                                                       220952
093200200528     C           @RTCD     IFEQ *BLANKS                                                       220952
093300200528     C           BVAPST    IFEQ 'Y'                                                           220952
093400200528     C                     MOVE '1'       *IN85                                               220952
093500200528     C                     ENDIF                                                              220952
093600200528     C                     ENDIF                                                              220952
093700200528     C*
093800200528     C*    FUTURE DAY NUMBER NOW HELD IN ZDYNBR
093900200528      *                                                                   S01473
094000200528      ** Check the switchable features file for the Midas Leo Integration S01473
094100200528      ** number, S01473. If it is present, set the flag ULEO to 'Y'       S01473
094200200528     C                     CALL 'AOSARDR0'                                S01473
094300200528     C                     PARM *BLANKS   @RTCD                           S01473
094400200528     C                     PARM '*VERIFY' @OPTN                           S01473
094500200528     C                     PARM 'S01473'  @KEY    6                       S01473
094600200528     C           SCSARD    PARM SCSARD    DSFDY                           S01473
094700200528      *                                                                   S01473
094800200528     C           @RTCD     IFEQ *BLANKS                                   S01473
094900200528     C                     MOVE 'Y'       ULEO    1                       S01473
095000200528     C                     END                                            S01473
095100200528     C*                                                                   S01496
095200200528     C                     CALL 'AOMMODR0'                                CTI001
095300200528     C                     PARM '*DBERR ' @RTCD                           CTI001
095400200528     C                     PARM '*FIRST ' @OPTN                           CTI001
095500200528     C           SDMOD     PARM SDMOD     DSFDY                           CTI001
095600200528      *                                                                   CTI001
095700200528     C           @RTCD     IFNE *BLANK                                    CTI001
095800200528     C                     MOVEL'SDMMODPD'DBFILE            ************* CTI001
095900200528     C                     MOVEL'03'      DBASE             * DBERR 03 *  CTI001
096000200528     C                     MOVEL@OPTN     DBOPTN            ************* CTI001
096100200528     C                     MOVEL@OPTN     DBKEY                           CTI001
096200200528     C                     EXSR *PSSR                                     CTI001
096300200528     C                     ENDIF                                          CTI001
096400200528      *                                                                   CTI001
096500200528      ** Midas/TI interface installed?                                    CTI001
096600200528     C           BGN3ST    IFEQ 'Y'                                       CTI001
096700200528     C                     MOVE 'Y'       ULEO                            CTI001
096800200528     C                     ENDIF                                          CTI001
096900200528      *                                                                   CTI001
097000200528     C**  Access SAR details file to see if S01496 is installed.          S01496
097100200528     C*                                                                   S01496
097200200528     C                     CALL 'AOSARDR0'                                S01496
097300200528     C                     PARM '       ' @RTCD   7                       S01496
097400200528     C                     PARM '*VERIFY' @OPTN   7                       S01496
097500200528     C                     PARM 'S01496'  WSARD   6                       S01496
097600200528     C*                                                                   S01496
097700200528     C           @RTCD     IFEQ *BLANK                                    S01496
097800200528     C                     MOVE '1'       *IN63                           S01496
097900200528     C                     END                                            S01496
098000200528     C*                                                                   CSE007
098100200528     C**  Access SAR details file to see if CSE007 is installed.          CSE007
098200200528     C*                                                                   CSE007
098300200528     C                     CALL 'AOSARDR0'                                CSE007
098400200528     C                     PARM '       ' @RTCD   7                       CSE007
098500200528     C                     PARM '*VERIFY' @OPTN   7                       CSE007
098600200528     C                     PARM 'CSE007'  WSARD   6                       CSE007
098700200528     C*                                                                   CSE007
098800200528     C           @RTCD     IFEQ *BLANK                                    CSE007
098900200528     C                     MOVE '1'       *IN53                           CSE007
099000200528     C                     END                                            CSE007
099100200528     C*                                                                   CEU017
099200200528     C**  Access SAR details file to see if CEU017 is installed.          CEU017
099300200528     C*                                                                   CEU017
099400200528     C                     CALL 'AOSARDR0'                                CEU017
099500200528     C                     PARM '       ' @RTCD   7                       CEU017
099600200528     C                     PARM '*VERIFY' @OPTN   7                       CEU017
099700200528     C                     PARM 'CEU017'  WSARD   6                       CEU017
099800200528     C*                                                                   CEU017
099900200528     C           @RTCD     IFEQ *BLANK                                    CEU017
100000200528     C                     MOVE '1'       *IN53                           CEU017
100100200528     C                     END                                            CEU017
100200200528      *                                                                   CIR003
100300200528      ** Determine if SAR CIR003 is installed                             CIR003
100400200528      *                                                                   CIR003
100500200528     C                     CALL 'AOSARDR0'                                CIR003
100600200528     C                     PARM *BLANKS   @RTCD                           CIR003
100700200528     C                     PARM '*VERIFY '@OPTN                           CIR003
100800200528     C                     PARM 'CIR003'  WSARD                           CIR003
100900200528     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
101000200528      *                                                                   CIR003
101100200528     C           @RTCD     IFNE *BLANKS                                   CIR003
101200200528     C           @RTCD     ANDNE'*NRF   '                                 CIR003
101300200528     C                     MOVEL'SCSARDPD'DBFILE                          CIR003
101400200528     C                     MOVEL'05'      DBASE                           CIR003
101500200528     C                     MOVEL'CIR003'  DBKEY                           CIR003
101600200528     C                     EXSR *PSSR                                     CIR003
101700200528     C                     ENDIF                                          CIR003
101800200528      *                                                                   CIR003
101900200528     C           @RTCD     IFEQ *BLANKS                                   CIR003
102000200528     C                     MOVE 'Y'       CIR003  1                       CIR003
102100200528     C                     ELSE                                           CIR003
102200200528     C                     MOVE 'N'       CIR003                          CIR003
102300200528     C                     ENDIF                                          CIR003
102400200528      *                                                                   CIR003
102500200528     C                     MOVE 'N'       CFF007  1                       CFF007
102600200528     C                     CALL 'AOSARDR0'                                CFF007
102700200528     C                     PARM *BLANKS   PRTCD   7                       CFF007
102800200528     C                     PARM '*VERIFY' POPTN   7                       CFF007
102900200528     C                     PARM 'CFF007'  PSARD   6                       CFF007
103000200528     C           SCSARD    PARM SCSARD    DSFDY                           CFF007
103100200528     C           PRTCD     IFEQ *BLANKS                                   CFF007
103200200528     C                     MOVE 'Y'       CFF007                          CFF007
103300200528     C                     ELSE                                           CFF007
103400200528     C           PRTCD     IFNE '*NRF   '                                 CFF007
103500200528     C                     MOVEL'05'      DBASE                           CFF007
103600200528     C                     MOVEL'CFF007  'DBKEY                           CFF007
103700200528     C                     MOVEL'SCSARDPD'DBFILE                          CFF007
103800200528     C                     EXSR *PSSR                                     CFF007
103900200528     C                     GOTO END                                       CFF007
104000200528     C                     ENDIF                                          CFF007
104100200528     C                     ENDIF                                          CFF007
104200200528      *                                                                   CFF007
104300200528      ** Check if enhancement CLE028 is installed                                             CLE028
104400200528      *                                                                                       CLE028
104500200528     C                     CALL 'AOSARDR0'                                                    CLE028
104600200528     C                     PARM *BLANKS   PRTCD                                               CLE028
104700200528     C                     PARM '*VERIFY 'POPTN                                               CLE028
104800200528     C                     PARM 'CLE028'  PSARD                                               CLE028
104900200528     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
105000200528      *                                                                                       CLE028
105100200528     C           PRTCD     IFNE *BLANKS                                                       CLE028
105200200528     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
105300200528     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
105400200528     C                     MOVEL'CLE028'  DBKEY                                               CLE028
105500200528     C                     MOVEL'07'      DBASE                                               CLE028
105600200528     C                     EXSR *PSSR                                                         CLE028
105700200528     C                     ENDIF                                                              CLE028
105800200528      *                                                                                       CLE028
105900200528     C           PRTCD     IFEQ *BLANKS                                                       CLE028
106000200528     C                     MOVE 'Y'       CLE028  1                                           CLE028
106100200528     C                     ELSE                                                               CLE028
106200200528     C                     MOVE 'N'       CLE028                                              CLE028
106300200528     C                     ENDIF                                                              CLE028
106400200528      *                                                                                       CLE028
106500200528     C/COPY WNCPYSRC,GL0554C001
106600200528     C                     MOVE 'N'       CGL015  1                                           CGL015
106700200528     C                     CALL 'AOSARDR0'                                                    CGL015
106800200528     C                     PARM *BLANKS   PRTCD   7                                           CGL015
106900200528     C                     PARM '*VERIFY' POPTN   7                                           CGL015
107000200528     C                     PARM 'CGL015'  PSARD   6                                           CGL015
107100200528     C           SCSARD    PARM SCSARD    DSFDY                                               CGL015
107200200528     C           PRTCD     IFEQ *BLANKS                                                       CGL015
107300200528     C                     MOVE 'Y'       CGL015                                              CGL015
107400200528     C                     ELSE                                                               CGL015
107500200528     C           PRTCD     IFNE '*NRF   '                                                     CGL015
107600200528     C                     MOVEL'07'      DBASE                                               CGL015
107700200528     C                     MOVEL'CGL015  'DBKEY                                               CGL015
107800200528     C                     MOVEL'SCSARDPD'DBFILE                                              CGL015
107900200528     C                     EXSR *PSSR                                                         CGL015
108000200528     C                     GOTO END                                                           CGL015
108100200528     C                     ENDIF                                                              CGL015
108200200528     C                     ENDIF                                                              CGL015
108300200528      *                                                                                       CGL015
108400200528      *                                                                                       CLE033
108500200528      **  Read switchable features file SCSARDPD using access object                          CLE033
108600200528      **  to determine if switchable feature (CLE033) is switched ON                          CLE033
108700200528     C                     MOVE 'N'       CLE033  1                                           CLE033
108800200528      *                                                                                       CLE033
108900200528     C                     CALL 'AOSARDR0'                                                    CLE033
109000200528     C                     PARM *BLANKS   W0RTCD  7                                           CLE033
109100200528     C                     PARM '*VERIFY' W0OPTN  7                                           CLE033
109200200528     C                     PARM 'CLE033'  W0SARD  6                                           CLE033
109300200528     C           SCSARD    PARM SCSARD    DSFDY                                               CLE033
109400200528      *                                                                                       CLE033
109500200528      **  If feature is on, set up CLE033 variable                                            CLE033
109600200528     C           W0RTCD    IFEQ *BLANKS                                                       CLE033
109700200528      *                                                                                       CLE033
109800200528     C                     MOVE 'Y'       CLE033                                              CLE033
109900200528      *                                                                                       CLE033
110000200528     C                     ELSE                                                               CLE033
110100200528      *                                                                                       CLE033
110200200528      ** else, database error (return code other than *NRF)                                   CLE033
110300200528     C           W0RTCD    IFNE '*NRF   '                                                     CLE033
110400200528     C                     MOVEL'SCSARDPD'DBFILE           ************                       CLE033
110500200528     C                     MOVEL'*VERIFY' DBKEY            * DBERR 27 *                       CLE033
110600200528     C                     MOVEL'27'      DBASE            ************                       CLE033
110700200528     C                     SETON                     U7U8LR                                   CLE033
110800200528     C                     GOTO END                                                           CLE033
110900200528     C                     ENDIF                                                              CLE033
111000200528      *                                                                                       CLE033
111100200528     C                     ENDIF                                                              CLE033
111200200528      *                                                                                       CLE033
111300200528     C*                                                                                       CGL044
111400200528     C**  Access SAR details file to see if CGL044 is installed.                              CGL044
111500200528     C*                                                                                       CGL044
111600200528     C                     CALL 'AOSARDR0'                                                    CGL044
111700200528     C                     PARM '       ' @RTCD   7                                           CGL044
111800200528     C                     PARM '*VERIFY' @OPTN   7                                           CGL044
111900200528     C                     PARM 'CGL044'  WSARD   6                                           CGL044
112000200528     C*                                                                                       CGL044
112100200528     C           @RTCD     IFEQ *BLANK                                                        CGL044
112200200528     C                     MOVE 'Y'       CGL044  1                                           CGL044
112300200528     C                     ELSE                                                               CGL044
112400200528     C                     MOVE 'N'       CGL044                                              CGL044
112500200528     C                     END                                                                CGL044
112600200528      *                                                                                       CAP204
112700200528      ** Check if enhancement CAP204 is installed                                             CAP204
112800200528      *                                                                                       CAP204
112900200528     C                     CALL 'AOSARDR0'                                                    CAP204
113000200528     C                     PARM '       ' @RTCD                                               CAP204
113100200528     C                     PARM '*VERIFY' @OPTN                                               CAP204
113200200528     C                     PARM 'CAP204'  WSARD                                               CAP204
113300200528      *                                                                                       CAP204
113400200528     C           @RTCD     IFEQ *BLANK                                                        CAP204
113500200528     C                     MOVE 'Y'       CAP204  1                                           CAP204
113600200528     C                     ELSE                                                               CAP204
113700200528     C           PRTCD     IFNE *BLANKS                                                       CAP204
113800200528     C           PRTCD     ANDNE'*NRF   '                                                     CAP204
113900200528     C                     MOVEL'SCSARDPD'DBFILE                                              CAP204
114000200528     C                     MOVEL'CAP204'  DBKEY                                               CAP204
114100200528     C                     MOVEL'09'      DBASE                                               CAP204
114200200528     C                     EXSR *PSSR                                                         CAP204
114300200528     C                     ENDIF                                                              CAP204
114400200528     C                     ENDIF                                                              CAP204
114500200528      *                                                                                    MD022382A
114600200528      ** Check the value of Currency Basis for Nostro Events                               MD022382A
114700200528      *                                                                                    MD022382A
114800200528     C                     CALL 'AOSVALR0'                                                 MD022382A
114900200528     C                     PARM *BLANKS   @RTCD                                            MD022382A
115000200528     C                     PARM SVALKK    SVALK1 20                                        MD022382A
115100200528     C                     PARM           SVAL1 200                                        MD022382A
115200200528     C                     PARM *BLANK    SVALK2 20                                        MD022382A
115300200528     C                     PARM           SVAL2 200                                        MD022382A
115400200528     C                     PARM *BLANK    SVALK3 20                                        MD022382A
115500200528     C                     PARM           SVAL3 200                                        MD022382A
115600200528     C                     PARM *BLANK    SVALK4 20                                        MD022382A
115700200528     C                     PARM           SVAL4 200                                        MD022382A
115800200528     C                     PARM *BLANK    SVALK5 20                                        MD022382A
115900200528     C                     PARM           SVAL5 200                                        MD022382A
116000200528     C                     PARM *BLANK    SVALK6 20                                        MD022382A
116100200528     C                     PARM           SVAL6 200                                        MD022382A
116200200528     C                     PARM *BLANK    SVALK7 20                                        MD022382A
116300200528     C                     PARM           SVAL7 200                                        MD022382A
116400200528     C                     PARM *BLANK    SVALK8 20                                        MD022382A
116500200528     C                     PARM           SVAL8 200                                        MD022382A
116600200528     C                     PARM *BLANK    SVALK9 20                                        MD022382A
116700200528     C                     PARM           SVAL8 200                                        MD022382A
116800200528     C                     PARM *BLANK    SVALK9 20                                        MD022382A
116900200528     C                     PARM           SVAL9 200                                        MD022382A
117000200528     C                     PARM *BLANK    SVALK0 20                                        MD022382A
117100200528     C                     PARM           SVAL10200                                        MD022382A
117200200528      *                                                                                    MD022382A
117300200528     C           @RTCD     IFNE *BLANKS                                                    MD022382A
117400200528     C                     MOVEL'SDSVALPD'DBFILE                                           MD022382A
117500200528     C                     MOVEL'10'      DBASE                                            MD022382A
117600200528     C                     EXSR *PSSR                                                      MD022382A
117700200528     C                     ENDIF                                                           MD022382A
117800200528     C                     MOVE SVAL11    CCYBAS  1                                        MD022382A
117900200528      *                                                                                    MD036589A
118000200528      ** Access the Dealing ICD details.                                                   MD036589A
118100200528      *                                                                                    MD036589A
118200200528     C                     CALL 'AODEALR1'                                                 MD036589A
118300200528     C                     PARM *BLANKS   @RTCD   7                                        MD036589A
118400200528     C                     PARM '*FIRST ' @OPTN   7                                        MD036589A
118500200528     C           SDDEAL    PARM SDDEAL    DSSDY                                            MD036589A
118600200528     C           @RTCD     IFNE *BLANKS                                                    MD036589A
118700200528     C                     MOVEL'20'      DBASE                                            MD036589A
118800200528     C                     MOVEL'SDDEALPD'DBFILE                                           MD036589A
118900200528     C                     MOVEL'*FIRST'  DBKEY                                            MD036589A
119000200528     C                     EXSR *PSSR                                                      MD036589A
119100200528     C                     ENDIF                                                           MD036589A
119200200528      *                                                                   S01473
119300200528     C           DETAIL    TAG                             ** DETAIL TAG *
119400200528     C                     MOVE *BLANKS   ZZ0296                                            MD044815
119500200528     C           *IN02     IFEQ '1'
119600200528     C                     MOVE SPI1      SPI11
119700200528     C                     MOVE SPI2      SPI21
119800200528     C                     MOVELOSAC      OSAC1                                              BUG5319
119900200528     C                     END
120000200528     C           *IN03     IFEQ '1'
120100200528     C                     MOVE RECI      RECI1
120200200528     C                     MOVE LNNO      DLNO                                                CLE148
120300200528     C                     Z-ADDDLNO      DLNO1
120400200528     C**********           Z-ADDCNUM      CNUM1                                               CSD027
120500200528     C                     MOVE CNUM      CNUM1                                               CSD027
120600200528     C                     MOVE DTYP      DTYP1
120700200528     C                     MOVE DLST      DLST1
120800200528     C                     Z-ADDEDAT      EDAT1
120900200528     C                     Z-ADDEAMT      EAMT1
121000200528     C                     Z-ADDECSS      ECSS1
121100200528     C*******              MOVE OSBR      BRCA1                           138007
121200200528     C***********          MOVE EBRC      BRCA1                    138007 154382
121300200528     C                     MOVE OSBR      BRCA1                           154382
121400200528     C                     Z-ADDOTHD      OTHD1
121500200528     C                     Z-ADDOTHA      OTHA1
121600200528     C                     Z-ADDBCEQ      BCEQ1
121700200528     C                     Z-ADDLCEQ      LCEQ1
121800200528     C                     Z-ADDSETP      SETP1
121900200528     C                     Z-ADDFFVD      FFVD1
122000200528     C                     Z-ADDPARI      PARI1
122100200528     C**********           Z-ADDCPAR      CPAR1                                               CSD027
122200200528     C                     MOVE CPAR      CPAR1                                               CSD027
122300200528     C                     MOVE ETYP      ETYP1
122400200528     C                     MOVE ECCY      ECCY1
122500200528     C                     MOVE OTHC      OTHC1
122600200528     C**********           MOVE OSAC      OSACA                                               CGL029
122700200528     C                     MOVELOSAC      OSACA1  2                                           CGL029
122800200528     C                     MOVE OSAC      OSACA2 16                                           CGL029
122900200528     C                     MOVE TSEN      TSEN1
123000200528     C                     MOVE CRNM      CRNM1
123100200528     C                     MOVE CTWN      CTWN1
123200200528     C                     MOVE CASK      CASK1
123300200528     C                     MOVE PRNM      PRNM1
123400200528     C                     MOVE PTWN      PTWN1
123500200528     C                     MOVE PASK      PASK1
123600200528     C                     MOVE INOI      INOI1
123700200528     C                     MOVE CLOC      CLOC1
123800200528     C                     MOVE REGC      REGC1
123900200528     C                     MOVE FFIN      FFIN1
124000200528     C                     END
124100200528     C*     SETUP CUSTOMER LENDING OUTPUT DATA STRUCTURE
124200200528     C           *IN13     IFEQ '1'
124300200528     C                     MOVE RECI      RECI2
124400200528     C**********           Z-ADDLNRF      LNRF2                                               CLE148
124500200528     C                     MOVELLNRF      LNRF2                                               CLE148
124600200528     C**********           Z-ADDCNUM      CNUM2                                               CSD027
124700200528     C                     MOVE CNUM      CNUM2                                               CSD027
124800200528     C                     MOVE ETYP      ETYP2
124900200528     C                     Z-ADDEDAT      EDAT2
125000200528     C                     Z-ADDEAMT      EAMT2
125100200528     C                     MOVE ECCY      ECCY2
125200200528     C                     Z-ADDECSS      ECSS2
125300200528     C                     MOVE DTYP      DTYP2
125400200528     C                     MOVE DLST      DLST2
125500200528     C***********          MOVE OSBR      BRCA2                           138007
125600200528     C***********          MOVE EBRC      BRCA2                    138007 154382
125700200528     C                     MOVE OSBR      BRCA2                           154382
125800200528     C                     Z-ADDOTHD      OTHD2
125900200528     C                     Z-ADDOTHA      OTHA2
126000200528     C                     Z-ADDBCEQ      BCEQ2
126100200528     C                     Z-ADDLCEQ      LCEQ2
126200200528     C                     MOVE NGII      NGII2
126300200528     C                     Z-ADDINTR      INTR2
126400200528     C                     Z-ADDSETP      SETP2
126500200528     C**********           MOVE OSAC      OSACB                                               CGL029
126600200528     C                     MOVELOSAC      OSACB1  2                                           CGL029
126700200528     C                     MOVE OSAC      OSACB2 16                                           CGL029
126800200528     C                     MOVE TSEN      TSEN2
126900200528     C                     Z-ADDDEC1      DEC12
127000200528     C                     MOVE CRNM      CRNM2
127100200528     C                     MOVE CTWN      CTWN2
127200200528     C                     MOVE CASK      CASK2
127300200528     C                     MOVE PRNM      PRNM2
127400200528     C                     MOVE PTWN      PTWN2
127500200528     C                     MOVE PASK      PASK2
127600200528     C                     MOVE INOI      INOI2
127700200528     C                     MOVE CLOC      CLOC2
127800200528     C                     MOVE REGC      REGC2
127900200528     C                     Z-ADDPARI      PARI2
128000200528     C**********           Z-ADDCPAR      CPAR2                                               CSD027
128100200528     C                     MOVE CPAR      CPAR2                                               CSD027
128200200528     C                     MOVE *BLANKS   ZZ0056                                            MD052216
128300200528     C                     END
128400200528      *                                                                   S01473
128500200528      ** If processing Leo records, check for LEO trailer or detail       S01473
128600200528      ** has been read                                                    S01473
128700200528     C           ULEO      IFEQ 'Y'                                       S01473
128800200528      *                                                                   S01473
128900200528      ** If a detail record has been read.....                            S01473
129000200528     C           *IN15     IFEQ '1'                                       S01473
129100200528     C                     MOVE 'Y'       ULDET   1                       S01473
129200200528     C                     MOVELOSAC      OSAC1                           S01473
129300200528     C                     MOVE OSAC      OSAC2                           S01473
129400200528     C***********          MOVE OSBR      BRCA                      S01473138007
129500200528     C***********          MOVE EBRC      BRCA                     138007 154382
129600200528     C                     MOVE OSBR      BRCA                            154382
129700200528     C                     END                                            S01473
129800200528      *                                                                   S01473
129900200528      ** If a trailer record has been read.....                           S01473
130000200528     C           *IN16     IFEQ '1'                                       S01473
130100200528     C                     MOVE 'Y'       ULTRL   1                       S01473
130200200528     C                     END                                            S01473
130300200528      *                                                                   S01473
130400200528     C                     END                                            S01473
130500200528     C**
130600200528     C**   SET UP OUTPUT FIELDS FOR TRADE EVENTS
130700200528     C           *IN26     IFEQ '1'
130800200528      *                                                                   CGL044
130900200528      ** Get the Securities Coupon Rate, Issuer Name and Issuer Town      CGL044
131000200528      *  via SD2602 if CGL044 is switched on.                             CGL044
131100200528     C           CGL044    IFEQ 'Y'                                       CGL044
131200200528     C                     CALL 'SD2602'                                  CGL044
131300200528     C                     PARM           SECS                            CGL044
131400200528     C                     PARM           CPNR   117                      CGL044
131500200528     C                     PARM           CRNM                            CGL044
131600200528     C                     PARM           CTWN                            CGL044
131700200528     C                     ENDIF                                          CGL044
131800200528      *                                                                   CGL044
131900200528     C                     MOVE 'E'       NREI
132000200528     C                     MOVE ECCY      NEEC
132100200528     C                     MOVELTRSA      NENC
132200200528     C                     Z-ADDEDAT      NEED
132300200528     C                     MOVE CRNM      NERN
132400200528     C                     MOVE CTWN      NERT
132500200528     C                     MOVE TRTR      NETR
132600200528     C                     MOVE ETYP      NECD
132700200528     C                     Z-ADDEAMT      NEAM
132800200528     C                     MOVE INOI      NEIO
132900200528     C*                                                                   S01496
133000200528     C           *IN63     IFEQ '1'                                       S01496
133100200528     C                     MOVE WEARL     EARL                            S01496
133200200528     C                     END                                            S01496
133300200528     C*                                                                   S01496
133400200528     C           *IN53     IFEQ '1'                                       CSE007
133500200528     C                     MOVE WCOAF     COAF                            CSE007
133600200528     C                     END                                            CSE007
133700200528     C*                                                                   CSE007
133800200528     C                     MOVE TRTR      DLNO
133900200528      *                                                                   CGL044
134000200528     C           CGL044    IFEQ 'Y'                                       CGL044
134100200528     C                     MOVE TRTA      BRCA                            CGL044
134200200528     C                     ENDIF                                          CGL044
134300200528     C*
134400200528     C                     MOVE *BLANKS   NESS                            178438
134500200528     C                     MOVE *BLANKS   NBRC                            178438
134600200528     C*                                                                   178438
134700200528     C                     MOVE TRSM      SETP
134800200528     C                     MOVE ' '       FFIN
134900200528     C                     END
135000200528     C**
135100200528     C**   SET UP OUTPUT FIELDS FOR CUSTOMER POSITION EVENTS OR DEPOT
135200200528     C**   POSITION EVENTS
135300200528     C           *IN27     IFEQ '1'
135400200528     C*******    *IN85     ANDEQ'1'                                                    220952 223026
135500200528     C           *IN28     OREQ '1'
135600200528     C*******    *IN85     ANDEQ'1'                                                    220952 223026
135700200528      *                                                                   CGL044
135800200528      *  Get the Securities Coupon Rate, Issuer Name and Issuer Town      CGL044
135900200528      *  via SD2602 if CGL044 is switched on.                             CGL044
136000200528     C           CGL044    IFEQ 'Y'                                       CGL044
136100200528     C                     CALL 'SD2602'                                  CGL044
136200200528     C                     PARM           SECS                            CGL044
136300200528     C                     PARM           CPNR                            CGL044
136400200528     C                     PARM           CRNM                            CGL044
136500200528     C                     PARM           CTWN                            CGL044
136600200528     C                     ENDIF                                          CGL044
136700200528      *                                                                   CGL044
136800200528     C                     MOVE 'E'       NREI
136900200528     C                     MOVE ECCY      NEEC
137000200528     C                     MOVELCCSA      NENC
137100200528     C                     Z-ADDEDAT      NEED
137200200528     C                     MOVE CRNM      NERN
137300200528     C                     MOVE CTWN      NERT
137400200528     C                     MOVE *BLANKS   NETR
137500200528     C                     MOVE ETYP      NECD
137600200528     C                     Z-ADDEAMT      NEAM
137700200528     C                     MOVE INOI      NEIO
137800200528     C           *IN63     IFEQ '1'                                       S01496
137900200528     C                     MOVE WMDTI     MDTI                            S01496
138000200528     C                     MOVE WEARL     EARL                            S01496
138100200528     C                     END                                            S01496
138200200528     C*                                                                   S01496
138300200528     C           *IN53     IFEQ '1'                                       CSE007
138400200528     C                     MOVE WCOAF     COAF                            CSE007
138500200528     C                     END                                            CSE007
138600200528     C*
138700200528     C                     MOVE CCSM      SETP
138800200528     C*                                                                   178438
138900200528     C                     MOVE SECS      NESS                            178438
139000200528     C                     MOVE CCBA      NBRC                            178438
139100200528     C*                                                                   178438
139200200528     C                     MOVE ' '       FFIN
139300200528     C                     Z-ADD0         DLNO
139400200528      *                                                                   CGL044
139500200528     C           CGL044    IFEQ 'Y'                                       CGL044
139600200528     C                     MOVE CCTA      BRCA                            CGL044
139700200528     C                     ENDIF                                          CGL044
139800200528      *                                                                   CGL044
139900200528     C                     END
140000200528     C*
140100200528     C           *IN29     IFEQ '1'
140200200528     C                     MOVE ' '       FFIN
140300200528     C                     MOVE 00        SETP
140400200528     C                     END
140500200528      *                                                                   CFF007
140600200528      ** CFF007 is on and event is for Futures and Options                CFF007
140700200528     C           CFF007    IFEQ 'Y'                                       CFF007
140800200528     C           *IN82     ANDEQ*ON                                       CFF007
140900200528     C                     MOVE WCSLT     SETP                            CFF007
141000200528     C                     ENDIF                                          CFF007
141100200528      *                                                                   CFF007
141200200528     C/COPY WNCPYSRC,GL0554C002
141300200528     C**
141400200528     C*****SECURITIES*TRADING*EVENTS***********************************   E28817
141500200528     C************IN17     IFEQ '1'                                       E28817
141600200528     C***********          MOVELOSAC      OSAC1                           E28817
141700200528     C***********          MOVE OSAC      OSAC2                           E28817
141800200528     C***********          MOVE THRE      TSEN                            E28817
141900200528     C***********                                                         E28817
142000200528     C***********                                                         E28817
142100200528     C***********          END                                            E28817
142200200528     C*
142300200528     C                     SETOF                     414265
142400200528     C                     SETOF                     48
142500200528     C*****RESTORE*SECURITY*TRADING*RECI*******************************   E28817
142600200528     C************IN17     IFEQ '1'                                       E28817
142700200528     C***********          MOVE RECIST    RECI                            E28817
142800200528     C***********          END                                            E28817
142900200528      *
143000200528      ** If Leo records are being processed,check if the Leo              S01473
143100200528      ** trailer has been read                                            S01473
143200200528     C********** ULEO      IFEQ 'Y'                                                  S01473 AR745341
143300200528     C********** *IN16     ANDEQ'1'                                                  S01473 AR745341
143400200528     C           *IN16     IFEQ '1'                                                         AR745341
143500200528     C                     GOTO END                                       S01473
143600200528     C                     END                                            S01473
143700200528      *                                                                   S01473
143800200528      **  SKIP POSITION SETTLEMENT EVENTS IF AUTOPOST POSN SETT = N                           249578
143900200528      **  UNLESS POSITION SETTLEMENT ALREADY AUTHORISED                                       249578
144000200528      **  (THESE EVENTS HAVE RECI = 'A' NOW - CFR SE1540)                                     249578
144100200528      *                                                                                       249578
144200200528     C           *IN27     IFEQ '1'                                                           249578
144300200528     C           *IN85     ANDEQ'0'                                                           249578
144400200528     C           RECI      ANDNE'A'                                                           249578
144500200528     C           *IN28     OREQ '1'                                                           249578
144600200528     C           *IN85     ANDEQ'0'                                                           249578
144700200528     C           RECI      ANDNE'A'                                                           249578
144800200528     C                     GOTO END                                                           249578
144900200528     C                     ENDIF                                                              249578
145000200528      *                                                                                       249578
145100200528     C   12
145200200528     COR 14
145300200528     COR 38
145400200528     C**OR*18                                                             E28817
145500200528     COR 83
145600200528     COR 04
145700200528     COR 01                GOTO END
145800200528     C*                                                                   S01221
145900200528     C********** CAP204    IFEQ 'Y'                                                  CAP204 AR745341
146000200528     C********** *IN61     ANDEQ'1'                                                  CAP204 AR745341
146100200528     C           *IN61     IFEQ '1'                                                         AR745341
146200200528     C                     GOTO END                                                           CAP204
146300200528     C                     ENDIF                                                              CAP204
146400200528      *                                                                                     MD036589
146500200528      ***If*deal*is*netted,*skip.**************************************           MD036589 MD036589A
146600200528      ** Flag netted deals.                                                                MD036589A
146700200528      *                                                                                     MD036589
146800200528     C                     MOVE '0'       *IN24                                            MD036589A
146900200528     C                     MOVE *BLANKS   WNETR  19                                        MD036589A
147000200528     C           *IN02     IFEQ '1'                                                         MD036589
147100200528     C                     MOVE ETYP      PART                                              MD036589
147200200528     C           ETYP      IFEQ '11V1'                                                      MD036589
147300200528     C           ETYP      OREQ '11V2'                                                      MD036589
147400200528     C********** ETYP      OREQ '12V2'                                            MD036589 MD047513A
147500200528     C           ETYP      OREQ '13V1'                                                     MD047513A
147600200528     C           ETYP      OREQ '13V2'                                                      MD036589
147700200528     C           ETYP      OREQ '14V1'                                                      MD036589
147800200528     C           ETYP      OREQ '14V2'                                                      MD036589
147900200528     C           DLNO      CHAINDEALS                99                                     MD036589
148000200528     C           *IN99     IFEQ '1'                                                         MD036589
148100200528     C                     SETON                     U7U8LR                                 MD036589
148200200528     C                     MOVEL'DEALS'   DBFILE                                            MD036589
148300200528     C                     MOVEL'16'      DBASE                                             MD036589
148400200528     C                     MOVELDLNO      DBKEY                                             MD036589
148500200528     C                     GOTO END                                                         MD036589
148600200528     C                     ELSE                                                             MD036589
148700200528     C********** RCDC      IFEQ 11                                                MD036589 MD047513A
148800200528     C           NETBR     IFNE *BLANKS                                                     MD036589
148900200528     C           PART      ANDEQ'V1'                                                        MD036589
149000200528     C           NETSR     ORNE *BLANKS                                                     MD036589
149100200528     C           PART      ANDEQ'V2'                                                        MD036589
149200200528     C**********           GOTO END                                               MD036589 MD036589A
149300200528     C                     MOVE '1'       *IN24                                            MD036589A
149400200528     C           NETBR     IFNE *BLANKS                                                    MD036589A
149500200528     C           PART      ANDEQ'V1'                                                       MD036589A
149600200528     C                     MOVE NETBR     WNETR                                            MD036589A
149700200528     C                     ENDIF                                                           MD036589A
149800200528     C           NETSR     IFNE *BLANKS                                                    MD036589A
149900200528     C           PART      ANDEQ'V2'                                                       MD036589A
150000200528     C                     MOVE NETSR     WNETR                                            MD036589A
150100200528     C                     ENDIF                                                           MD036589A
150200200528     C                     ENDIF                                                            MD036589
150300200528     C**********           ENDIF                                                  MD036589 MD047513A
150400200528     C**********           ENDIF                                                   MD036589 MD051925
150500200528     C                     ENDIF                                                            MD036589
150600200528     C                     ENDIF                                                            MD036589
150700200528     C                     ENDIF                                                            MD036589
150800200528      *                                                                                     MD036589
150900200528     C**  Skip S.R.M. event types
151000200528     C****Do*not*skip*IRS*Event*22S1*and*22S2**********************S01314 030749
151100200528     C           ETYP      IFEQ '20S1'                                    S01393
151200200528     C           ETYP      OREQ '20S2'                                    S01393
151300200528     C********** ETYP      IFEQ '21S1'                                    S01393
151400200528     C           ETYP      OREQ '21S1'                                    S01393
151500200528     C           ETYP      OREQ '21S2'
151600200528     C           ETYP      OREQ '21S3'
151700200528     C           ETYP      OREQ '21S4'                                                        208461
151800200528     C           ETYP      OREQ '21C1'                                    030749
151900200528     C           ETYP      OREQ '21C2'                                    030749
152000200528     C           ETYP      OREQ '21C3'                                    030749
152100200528     C           ETYP      OREQ '21C4'                                                        208461
152200200528     C           ETYP      OREQ '21O1'                                    030749
152300200528     C           ETYP      OREQ '21E1'                                    030749
152400200528     C***********ETYP      OREQ '22S1'                            S01221  S01314
152500200528     C***********ETYP      OREQ '22S2'                            S01221  S01314
152600200528     C           ETYP      OREQ '22S1'                                    030749
152700200528     C           ETYP      OREQ '22S2'                                    030749
152800200528     C           ETYP      OREQ '22S3'                                    S01393
152900200528     C           ETYP      OREQ '22S4'                                    S01393
153000200528     C           ETYP      OREQ '22C1'                                    030749
153100200528     C           ETYP      OREQ '22C2'                                    030749
153200200528     C           ETYP      OREQ '22C3'                                                        208461
153300200528     C           ETYP      OREQ '22C4'                                                        208461
153400200528     C           ETYP      OREQ '22O1'                                    030749
153500200528     C           ETYP      OREQ '22E1'                                    030749
153600200528     C           ETYP      OREQ '23S1'
153700200528     C           ETYP      OREQ '23S2'
153800200528     C********** ETYP      OREQ '23S3'                                                208461 BUG5519
153900200528     C********** ETYP      OREQ '23S4'                                                208461 BUG5519
154000200528     C           ETYP      OREQ '23C1'                                    030749
154100200528     C           ETYP      OREQ '23C2'                                    030749
154200200528     C********** ETYP      OREQ '23C3'                                                208461 BUG5519
154300200528     C********** ETYP      OREQ '23C4'                                                208461 BUG5519
154400200528     C           ETYP      OREQ '23O1'                                    030749
154500200528     C           ETYP      OREQ '23E1'                                    030749
154600200528     C           ETYP      OREQ '24S1'
154700200528     C           ETYP      OREQ '24S2'
154800200528     C           ETYP      OREQ '24S3'                                                        208461
154900200528     C           ETYP      OREQ '24S4'                                                        208461
155000200528     C           ETYP      OREQ '24C1'                                    030749
155100200528     C           ETYP      OREQ '24C2'                                    030749
155200200528     C           ETYP      OREQ '24C3'                                                        208461
155300200528     C           ETYP      OREQ '24C4'                                                        208461
155400200528     C           ETYP      OREQ '24O1'                                    030749
155500200528     C           ETYP      OREQ '24E1'                                    030749
155600200528      *                                                                                       168838
155700200528      ** Event types for OP deals                                                             168838
155800200528      *                                                                                       168838
155900200528     C           ETYP      OREQ '12V1'                                                        168838
156000200528     C           ETYP      OREQ '12V2'                                                        168838
156100200528     C********** ETYP      OREQ '23C3'                                                 CIR003 209676
156200200528     C********** ETYP      OREQ '23C4'                                                 CIR003 209676
156300200528     C********** ETYP      OREQ '23S3'                                                 CIR003 209676
156400200528     C********** ETYP      OREQ '23S4'                                                 CIR003 209676
156500200528      *                                                                   CIR003
156600200528     C           CIR003    IFEQ *ON                                       CIR003
156700200528     C           ETYP      ANDEQ'23C2'                                    CIR003
156800200528     C           CIR003    OREQ *ON                                       CIR003
156900200528     C           ETYP      ANDEQ'23S2'                                    CIR003
157000200528     C                     MOVE *ON       *IN41                           CIR003
157100200528     C                     ENDIF                                          CIR003
157200200528     C*
157300200528     C           CIR003    IFEQ 'Y'                                                         AR743357
157400200528     C           DTYP      ANDEQ'RX'                                                        AR743357
157500200528      *                                                                                     AR743357
157600200528     C           *LIKE     DEFN DLNO      TDLNO                                             AR743357
157700200528     C                     Z-ADDDLNO      TDLNO                                             AR743357
157800200528     C           TDLNO     CHAINDEALS                05                                     AR743357
157900200528     C           *IN05     IFEQ '1'                                                         AR743357
158000200528     C                     MOVEL'DEALS   'DBFILE                                            AR743357
158100200528     C                     MOVEL'16'      DBASE                                             AR743357
158200200528     C                     MOVELDLNO      DBKEY                                             AR743357
158300200528     C                     EXSR *PSSR                                                       AR743357
158400200528     C                     MOVE '1'       *IN99                                             AR743357
158500200528     C                     GOTO END                                                         AR743357
158600200528     C                     ENDIF                                                            AR743357
158700200528      *                                                                                     AR743357
158800200528     C           ETYP      IFEQ '23S3'                                                      AR743357
158900200528     C           ETYP      OREQ '23C3'                                                      AR743357
159000200528      *                                                                                     AR743357
159100200528     C           VDEI      IFEQ 'Y'                                                         AR743357
159200200528     C           EDAT      ANDEQVDAT                                                        AR743357
159300200528     C           PDEI      OREQ 'Y'                                                         AR743357
159400200528     C           EDAT      ANDNEVDAT                                                        AR743357
159500200528     C                     MOVE '0'       *IN41                                             AR743357
159600200528     C                     ELSE                                                             AR743357
159700200528     C                     GOTO END                                                         AR743357
159800200528     C                     ENDIF                                                            AR743357
159900200528      *                                                                                     AR743357
160000200528     C                     ELSE                                                             AR743357
160100200528      *                                                                                     AR743357
160200200528     C           ETYP      IFEQ '23S4'                                                      AR743357
160300200528     C           ETYP      OREQ '23C4'                                                      AR743357
160400200528      *                                                                                     AR743357
160500200528     C           MDEI      IFEQ 'Y'                                                         AR743357
160600200528     C           EDAT      ANDEQMDAT                                                        AR743357
160700200528     C           PDEI      OREQ 'Y'                                                         AR743357
160800200528     C           EDAT      ANDNEMDAT                                                        AR743357
160900200528     C                     MOVE '0'       *IN41                                             AR743357
161000200528     C                     ELSE                                                             AR743357
161100200528     C                     GOTO END                                                         AR743357
161200200528     C                     ENDIF                                                            AR743357
161300200528      *                                                                                     AR743357
161400200528     C                     ELSE                                                             AR743357
161500200528     C                     GOTO END                                                         AR743357
161600200528     C                     ENDIF                                                            AR743357
161700200528     C                     ENDIF                                                            AR743357
161800200528     C                     ELSE                                                             AR743357
161900200528      *                                                                                     AR743357
162000200528     C                     GOTO END
162100200528     C                     ENDIF                                                            AR743357
162200200528     C*
162300200528     C                     END
162400200528     C/COPY WNCPYSRC,GL0554C005
162500200528     C*
162600200528     C*  FOR GUARANTEES, PRINCIPAL INCREASE OR PRINCIPAL AT START OR      126735
162700200528     C*  MATURITY SHOULD NOT UPDATE PROJECTED NOSTRO BALANCE              126735
162800200528     C*                                                                   126735
162900200528     C           ETYP      IFEQ '70V1'                     START PRINCIPAL126735
163000200528     C           ETYP      OREQ '70M1'                     MATURITY PRINC.126735
163100200528     C           ETYP      OREQ '70A1'                     CURRENT PRINCI.126735
163200200528     C           ETYP      OREQ '70V3'                     PRINC. INCREASE126735
163300200528     C*                                                                   126735
163400200528     C                     GOTO END                                       126735
163500200528     C*                                                                   126735
163600200528     C                     END                                            126735
163700200528     C*
163800200528     C*    TEST WHETHER EVENT IS TO BE EXTRACTED
163900200528     C*
164000200528     C                     SETOF                       42
164100200528     C*    IF EVENT IS SECURITIES TRADING, INCLUDE UNSETTLED TRADE
164200200528     C*    WITH EVENT DATE < RUN DATE
164300200528     C*    + ALL PAST-DUE POSITION SETTLEMENT EVENTS                      087177
164400200528     C           *IN26     IFEQ '1'
164500200528     C           *IN27     OREQ '1'                                       087177
164600200528     C           *IN28     OREQ '1'                                       087177
164700200528     C           EDAT      COMP ZDYNBR               41
164800200528     C                     ELSE
164900200528     C           EDAT      COMP ZDYNBR               41
165000200528     C  N41      EDAT      COMP BJRDNB                 4141
165100200528     C                     END
165200200528     C*****DO*NOT REPORT ROLLOVER DEAL IF EVENT IS 'START' (='V1')        CEU003
165300200528     C*    DO NOT REPORT ROLLOVER DEAL IF EVENT IS 'START'(='V1' OR 'VX') CEU003
165400200528     C                     MOVE ETYP      PART    2
165500200528     C           PART      COMP 'V1'                     47
165600200528     C  N47      PART      COMP 'VX'                     47               CEU003
165700200528     C   47      RLVI      COMP 'Y'                      47
165800200528      *                                                                   S01314
165900200528     C*****Do*not Process Deal Events with ETPY 'M2'               S01314 CEU003
166000200528     C**   Do not Process Deal Events with ETPY 'M2' or 'MY'              CEU003
166100200528      *                                                                   138004
166200200528     C**   If interest paid seperately indicator not equal to "Y"         138004
166300200528      *                                                                   138004
166400200528     C           IPSI      IFNE 'Y'                                       138004
166500200528      *                                                                   138004
166600200528     C           *IN02     IFEQ '1'                                       S01314
166700200528     C           PART      ANDEQ'M2'                                      S01314
166800200528     C           RLVI      ANDNE'Y'                                                         MD033601
166900200528     C           *IN02     OREQ '1'                                       CEU003
167000200528     C           PART      ANDEQ'MY'                                      CEU003
167100200528     C                     SETON                         41               S01314
167200200528     C                     GOTO END                                       S01314
167300200528     C                     END                                            S01314
167400200528      *                                                                   138004
167500200528     C                     END                                            138004
167600200528      *                                                                   138004
167700200528      **   Allow Deal Events having field 'FIPI' blank to be processed    S01314
167800200528     C   47 02
1679002005280292 C**********OR 20 02                                                  S01314
168000200528     COR 21                SETON                     41
168100200528     C*****DO*NOT EXTRACT EVENT FOR FUTURE AND OPTION                     073714
168200200528     C***82*****           SETON                     41                   073714
168300200528     C*                                                                   073714
168400200528     C** ONLY EXTRACT PREMIUM EVENTS FOR FUTURES & OPTIONS MODULE         073714
168500200528     C*                                                                   073714
168600200528     C   82      ETYP      COMP '93V1'               4141  *              073714
168700200528     C*                                                                   073714
168800200528     C   41                GOTO END
168900200528     C*
169000200528     C*    DO NOT EXTRACT BOOK EVENTS
169100200528     C   29                SETON                     41
169200200528     C   41                GOTO END
169300200528     C*
169400200528     C*    THIS PART DONE FOR EXTRACTED DEAL EVENTS
169500200528     C*
169600200528      ** If Leo records are being processed, check if a Leo detail        S01473
169700200528      ** record has been read                                             S01473
169800200528     C           ULEO      IFEQ 'Y'                                       S01473
169900200528     C           *IN15     ANDEQ'Y'                                       S01473
170000200528     C                     GOTO DATE                                      S01473
170100200528     C                     END                                            S01473
170200200528      *                                                                   S01473
170300200528     C   03                GOTO DATE
170400200528     C   13                GOTO DATE
170500200528     C***17****            GOTO DATE                                      E28817
170600200528     C   26                GOTO DATE
170700200528     C   27                GOTO DATE
170800200528     C   28                GOTO DATE
170900200528     C   29                GOTO DATE
171000200528     C   82                GOTO DATE                                      073714
171100200528      *                                                                                       CAP204
171200200528      ** If CAP204 is installed and Detail record is ON                                       CAP204
171300200528      **  convert event date to alphanumeric                                                  CAP204
171400200528     C           CAP204    IFEQ 'Y'                                                           CAP204
171500200528     C           *IN60     ANDEQ'1'                                                           CAP204
171600200528     C                     GOTO DATE                                                          CAP204
171700200528     C                     ENDIF                                                              CAP204
171800200528     C/COPY WNCPYSRC,GL0554C006
171900200528     C           PART      COMP 'M1'                     42
172000200528     C   42      ETYP      COMP '18M1'               4242
172100200528     C/COPY WNCPYSRC,GL0554C009
172200200528     C*                                                                   085626
172300200528      ** Check for Event type 18MX                                        CEU003
172400200528     C           ETYP      IFNE '18M1'                                    CEU003
172500200528     C           *IN42     ANDEQ*OFF                                      CEU003
172600200528     C           PART      COMP 'MX'                     42               CEU003
172700200528     C   42      ETYP      COMP '18MX'               4242                 CEU003
172800200528     C                     ENDIF                                          CEU003
172900200528     C*                                                                   CEU003
173000200528     C** When interest is paid separately, don't add interest to amount   085626
173100200528     C*                                                                   085626
173200200528     C           IPSI      IFEQ 'Y'                                       085626
173300200528     C           RLVI      OREQ 'Y'                                                         MD033601
173400200528     C           PART      ANDEQ'M1'                                                        MD033601
173500200528     C           *IN02     ANDEQ'1'                                                         MD033601
173600200528     C           RBDN      ANDNE0                                                           MD033601
173700200528     C***********RLVI      ANDEQ'Y'                                 085626138004
173800200528     C   42                Z-ADDEAMT      REPAMT                          085626
173900200528     C                     ELSE                                           085626
174000200528     C********** PART      IFEQ 'MX'                                137359138007
174100200528     C********** ECCY      ANDNEOTHC                                137359138007
174200200528     C***42*****           Z-ADDEAMT      REPAMT                    137359138007
174300200528     C**********           ELSE                                     137359138007
174400200528     C   42      EAMT      ADD  OTHA      REPAMT 130
174500200528     C*********            ENDIF                                    137359138007
174600200528     C                     END                                            085626
174700200528      *                                                                                     MD033601
174800200528     C           ETYP      IFEQ '16M2'                                                      MD033601
174900200528     C           *IN42     ANDEQ*OFF                                                        MD033601
175000200528     C           RLVI      ANDEQ'Y'                                                         MD033601
175100200528     C           *IN02     ANDEQ*ON                                                         MD033601
175200200528     C                     MOVE *ON       *IN42                                             MD033601
175300200528     C                     Z-ADDEAMT      REPAMT                                            MD033601
175400200528     C                     ENDIF                                                            MD033601
175500200528     C*
175600200528     C/COPY WNCPYSRC,GL0554C010
175700200528     C*
175800200528     C           DATE      TAG                             ** DATE TAG ***
175900200528     C*
176000200528     C********CUSTOMER*LENDING*COMMITMENT*FEES*EVENT*(SETUP*FIELDS)*******045634
176100200528     C***13******ETYP      COMP '71F2'                   48               045634
176200200528     C***13*48***          MOVELFTYP      LNRF2                           045634
176300200528     C***13*48***          MOVE FSEQ      LNRF2                           045634
176400200528     C*                                                                   045634
176500200528     C** If this is a customer lending event process according to type    045634
176600200528     C*                                                                   045634
176700200528     C           *IN13     IFEQ '1'                                       045634
176800200528     C           ETYP      ANDEQ'71F2'                                    045634
176900200528     C*                                                                   045634
177000200528     C* Customer Lending Facility Fees processing                         045634
177100200528     C*                                                                   045634
177200200528     C                     MOVE *BLANKS   LNRF2                           045634
177300200528     C                     MOVE FLNRF     LNRF2                           045634
177400200528     C                     END                                            045634
177500200528      *                                                                                     MD052216
177600200528      ** If Customer Lending Fee Event, save fee seq to Filler field                        MD052216
177700200528      *                                                                                     MD052216
177800200528     C           *IN13     IFEQ *ON                                                         MD052216
177900200528     C********** ETYP      ANDEQ'71F1'                                             MD052216 MD053950
178000200528     C********** *IN13     OREQ *ON                                                MD052216 MD053950
178100200528     C********** ETYP      ANDEQ'71F2'                                             MD052216 MD053950
178200200528     C           ETYP      IFEQ '71F1'                                                      MD053950
178300200528     C           ETYP      OREQ '71F2'                                                      MD053950
178400200528     C           ETYP      OREQ '71FX'                                                      MD053950
178500200528     C           ETYP      OREQ '71FY'                                                      MD053950
178600200528     C                     MOVE LASN      ZZ0056                                            MD052216
178700200528     C                     ENDIF                                                            MD052216
178800200528     C                     ENDIF                                                            MD053950
178900200528     C*
179000200528     C                     MOVE ETYP      ALPH2   2
179100200528     C*
179200200528     C*    IF EVENT TYPE ENDS IN 'N2'
179300200528     C*    EVENT MAY BE OUTPUT TO NOSEX FILE
179400200528     C*
179500200528     C           ALPH2     IFEQ 'N2'
179600200528     C                     MOVEA'1'       *IN,41
179700200528     C                     END
179800200528     C*
179900200528     C*
180000200528     C**   TEST WHETHER EVENT RECORD*IS TO BE OUTPUT TO NOSEX FILE
180100200528     C/COPY WNCPYSRC,GL0554C007
180200200528     C           *IN60     IFEQ '0'                                                        AR1028690
180300200528     C           SETP      COMP 01                       65
180400200528     C  N65      SETP      COMP 02                       65
180500200528     C  N65      SETP      COMP 07                       65
180600200528     C  N65      SETP      COMP 08                       65
180700200528     C  N65      SETP      COMP 12                       65
180800200528     C                     ENDIF                                                           AR1028690
180900200528      *                                                                                       CAP204
181000200528      ** If nostro code not equal to zero, set on write indicator                             CAP204
181100200528      **  for NOSEXAT file                                                                    CAP204
181200200528      *                                                                                       CAP204
181300200528     C           CAP204    IFEQ 'Y'                                                           CAP204
181400200528     C           *IN60     ANDEQ'1'                                                           CAP204
181500200528     C           NOSA      ANDNE'00'                                                          CAP204
181600200528     C                     MOVE '1'       *IN65                                               CAP204
181700200528     C                     ENDIF                                                              CAP204
181800200528     C/COPY WNCPYSRC,GL0554C008
181900200528     C*
182000200528      * IF ACCOUNT IS NOSTRO - WRITE RECORD (WITH NOSTRO                090404
182100200528      * NUMBER ) TO NOSEXED.                                            090404
182200200528      *                                                                 090404
182300200528      * Exclude Funds Transfers to stop Corruption of currency          132029
182400200528     C           *IN37     IFNE '1'                                     132029
182500200528      *                                                                 132029
182600200528     C           SETP      IFEQ 14                                      090404
182700200528     C                     MOVELOSAC      OSACX  100                    090404
182800200528     C           OSACX     CHAINACNUM                99                 090404
182900200528     C           *IN99     IFEQ '0'                                     090404
183000200528     C                     MOVE CNUM      KCUST                         090404
183100200528     C                     MOVE CCY       ECCY                          090404
183200200528     C                     MOVE ACOD      KACCD                         090404
183300200528     C                     MOVE ACSQ      KACSN                         090404
183400200528     C           NOKEY     CHAINSDNOSTL4             99                 090404
183500200528     C           *IN99     IFEQ '0'                                     090404
183600200528     C                     MOVE '1'       *IN65                         090404
183700200528     C**********           MOVE *BLANKS   OSAC                                       090404 AR877692
183800200528     C**********           MOVELA7NONB    OSAC                                       090404 AR877692
183900200528     C                     MOVE *BLANKS   OSAC1                                             AR877692
184000200528     C                     MOVELA7NONB    OSAC1                                             AR877692
184100200528     C**********           MOVE *BLANKS   OSACB                                        200529 CGL029
184200200528     C**********           MOVELA7NONB    OSACB                                        200529 CGL029
184300200528     C                     MOVELA7NONB    OSACB1                                              CGL029
184400200528     C                     END                                          090404
184500200528     C                     END                                          090404
184600200528     C                     END                                          090404
184700200528     C           SETP      IFEQ 05                                      090404
184800200528     C           OSAC      ANDNE*BLANKS                                 090404
184900200528     C                     MOVE OSAC      OSACNO                        090404
185000200528     C           NOKEY     CHAINSDNOSTL4             99                 090404
185100200528     C           *IN99     IFEQ '0'                                     090404
185200200528     C                     MOVE '1'       *IN65                         090404
185300200528     C*********************MOVE *BLANKS   OSAC                          090404               BUG7963
185400200528     C*********************MOVELA7NONB    OSAC                          090404               BUG7963
185500200528     C                     MOVE *BLANKS   OSAC1                         090404               BUG7963
185600200528     C                     MOVELA7NONB    OSAC1                         090404               BUG7963
185700200528     C**********           MOVE *BLANKS   OSACB                                        200529 CGL029
185800200528     C**********           MOVELA7NONB    OSACB                                        200529 CGL029
185900200528     C                     MOVELA7NONB    OSACB1                                              CGL029
186000200528     C                     END                                          090404
186100200528     C                     END                                          090404
186200200528     C           SETP      IFEQ 09                                                            CLE033
186300200528     C           CLE033    ANDEQ'Y'                                                           CLE033
186400200528     C           OSAC      ANDNE*BLANKS                                                       CLE033
186500200528     C                     MOVE OSAC      OSACNO                                              CLE033
186600200528     C           NOKEY     CHAINSDNOSTL4             99                                       CLE033
186700200528     C           *IN99     IFEQ '0'                                                           CLE033
186800200528     C                     MOVE '1'       *IN65                                               CLE033
186900200528     C**********           MOVE *BLANKS   OSAC                                       CLE033 AR877692
187000200528     C**********           MOVELA7NONB    OSAC                                       CLE033 AR877692
187100200528     C                     MOVE *BLANKS   OSAC1                                             AR877692
187200200528     C                     MOVELA7NONB    OSAC1                                             AR877692
187300200528     C**********           MOVE *BLANKS   OSACB                                        CLE033 CGL029
187400200528     C**********           MOVELA7NONB    OSACB                                        CLE033 CGL029
187500200528     C                     MOVE *BLANKS   OSACB1                                              CGL029
187600200528     C                     MOVELA7NONB    OSACB1                                              CGL029
187700200528     C                     END                                                                CLE033
187800200528     C                     END                                                                CLE033
187900200528     C                     END                                          132029
188000200528      *                                                                   085479
188100200528      * Customer Lending events (LVENTEL) with last 2 characters of       085479
188200200528      * event type = 'X2' are capitalised interest on customer loans.     085479
188300200528      * This should not produce a Nostro event.                           085479
188400200528      *                                                                   085479
188500200528     C           *IN65     IFEQ '1'                        SELECTED       085479
188600200528     C           *IN13     ANDEQ'1'                        LVENTELF       085479
188700200528     C           ALPH2     ANDEQ'X2'                       CAP INT        085479
188800200528     C           CLE028    OREQ 'Y'                                                           CLE028
188900200528     C           *IN65     ANDEQ'1'                                                           CLE028
189000200528     C           *IN13     ANDEQ'1'                                                           CLE028
189100200528     C           ETYP      ANDEQ'80H1'                                                        CLE028
189200200528     C                     SETOF                     65                   085479
189300200528     C                     END                                            085479
189400200528      *                                                                   085479
189500200528      *                                                                                       223572
189600200528     C           ALPH2     IFEQ 'I6'                                                          223572
189700200528     C           ALPH2     OREQ 'V4'                                                          223572
189800200528     C           ALPH2     OREQ 'V6'                                                          223572
189900200528     C           ALPH2     OREQ 'M6'                                                          223572
190000200528     C           ALPH2     OREQ 'M8'                                                          223572
190100200528     C           ALPH2     OREQ 'R6'                                                          223572
190200200528     C           ALPH2     OREQ 'R4'                                                          223572
190300200528     C           ETYP      ANDNE'63R4'                                                        223572
190400200528     C           ALPH2     OREQ 'R4'                                                          223572
190500200528     C           ETYP      ANDNE'41R4'                                                        223572
190600200528     C                     SETOF                     65                                       223572
190700200528     C                     ENDIF                                                              223572
190800200528     C*** MAINTAIN  NUMBER AND VALUE OF RECORDS WRITTEN TO NOSEX
190900200528     C*
191000200528     C**  If deal has been rolled over, event amount is the principal     149024
191100200528     C**  plus interest, less the amount rolled over.                     149024
191200200528     C                     MOVE *BLANK    WKROLI  1                                         MD033601
191300200528     C                     SETOF                     81
191400200528     C***02******RLVI      COMP 'Y'                      81               138004
191500200528     C   02      RLVI      COMP 'Y'                      81               149024
191600200528     C           PART      IFNE 'M2'                                                        MD033601
191700200528     C           *IN42     ANDEQ*ON                                                         MD033601
191800200528     C           *IN81     ANDEQ*ON                                                         MD033601
191900200528     C   42 81   REPAMT    SUB  RBDA      REPAMT
192000200528     C                     ENDIF                                                            MD033601
192100200528     C*                                                                   085626
192200200528     C           *IN42     IFEQ '1'                                       085626
192300200528     C           *IN81     ANDEQ'1'                                       085626
192400200528     C*                                                                   085626
192500200528     C** Save Ingoing / Outgoing Indicator                                085626
192600200528     C*                                                                   085626
192700200528     C           IPSI      IFEQ 'Y'                                       085626
192800200528     C                     MOVE INOI      XINOI   1                       085626
192900200528     C                     END                                            085626
193000200528     C*                                                                   085626
193100200528     C** If amount is negative, then rollover involves a capital          085626
193200200528     C** increase so change ingoing to outgoing and vice versa            085626
193300200528     C*                                                                   085626
193400200528     C           REPAMT    IFLT 0                                         085626
193500200528     C                     MULT -1        REPAMT                          085626
193600200528     C           INOI      IFEQ 'I'                                       085626
193700200528     C                     MOVE 'O'       INOI                            085626
193800200528     C                     ELSE                                           085626
193900200528     C                     MOVE 'I'       INOI                            085626
194000200528     C                     END                                            085626
194100200528     C                     MOVE 'Y'       WKROLI  1                                         MD033601
194200200528     C                     MOVE RBDN      DLNO                                              MD033601
194300200528     C                     Z-ADD0         RBDN                                              MD033601
194400200528     C                     Z-ADD0         RBDA                                              MD033601
194500200528     C                     Z-ADD0         OTHD                                              MD033601
194600200528     C                     Z-ADD0         OTHA                                              MD033601
194700200528     C           PART      IFEQ 'M1'                                                        MD033601
194800200528     C                     MOVE 'V1'      ETYP                                              MD033601
194900200528     C                     ENDIF                                                            MD033601
195000200528     C                     END                                            085626
195100200528     C                     END                                            085626
195200200528     C*                                                                   S01392
195300200528     C* IF FRONT-UP INTEREST = Y                                          S01392
195400200528     C*                                                                   S01392
195500200528     C   02      FUID      IFEQ 'Y'                                       S01392
195600200528     C*                                                                   S01392
195700200528     C* INCLUDE INTEREST ON VALUE DATE EVENT                              S01392
195800200528     C*                                                                   S01392
195900200528     C           ETYP      IFEQ '15V1'                                    S01392
196000200528     C           ETYP      OREQ '16V1'                                    S01392
196100200528     C           ETYP      OREQ '15VX'                                    CEU003
196200200528     C           ETYP      OREQ '16VX'                                    CEU003
196300200528     C           EAMT      SUB  OTHA      REPAMT                          S01392
196400200528     C                     MOVE '1'       *IN42                           S01392
196500200528     C                     END                                            S01392
196600200528     C*                                                                   S01392
196700200528     C* IF MATURITY DATE EVENT WITH ROLLOVER, ACCESS ROLLOVER DEAL        S01392
196800200528     C* FOR NET SETTLEMENT AMOUNT (FRONT-UP INTEREST ON THAT DEAL)        S01392
196900200528     C*                                                                   S01392
197000200528     C           ETYP      IFEQ '15M1'                                    S01392
197100200528     C           ETYP      OREQ '16M1'                                    S01392
197200200528     C           ETYP      OREQ '15MX'                                    CEU003
197300200528     C           ETYP      OREQ '16MX'                                    CEU003
197400200528     C           RLVI      IFEQ 'Y'                                       S01392
197500200528     C           RBDN      CHAINDRSDEALS             99    *              S01392
197600200528     C           *IN99     IFEQ '1'                                       S01392
197700200528     C                     SETON                     U7U8LR               S01392
197800200528     C                     MOVEL'DRSDEALS'DBFILE                          S01392
197900200528     C                     MOVEL'04'      DBASE                           S01392
198000200528     C                     MOVELRBDN      DBKEY                           S01392
198100200528     C                     GOTO END                                       S01392
198200200528     C                     END                                            S01392
198300200528     C                     Z-ADDTOTI      REPAMT                          S01392
198400200528     C                     MOVE '1'       *IN42                           S01392
198500200528     C                     END                                            S01392
198600200528     C                     END                                            S01392
198700200528     C                     END                                            S01392
198800200528     C** SHOW REPAYMENT AMOUNT ON THE EXTRACT IF DEAL ROLLED OVER.
198900200528     C*******
199000200528     C           *IN37     IFEQ '1'                        ## B0
199100200528     C                     MOVE 'F'       RECI             'FOR OUTPUT
199200200528     C**********           MOVE OSBR      BRCA                      064882138007
199300200528     C***********          MOVE EBRC      BRCA                     138007 154382
199400200528     C                     MOVE OSBR      BRCA                            154382
199500200528     C*
199600200528     C*
199700200528     C                     SETOF                     65
199800200528     C           STNI      IFEQ 'Y'                        ## B002
199900200528     C                     SETON                     65    'OUTPUT
200000200528     C                     END                             ## E002
200100200528     C*
200200200528     C                     END                             ## E001
200300200528     C*                                                                   073714
200400200528     C*  FUTURES & OPTIONS NOSTRO EVENTS                                  073714
200500200528     C*                                                                   073714
200600200528     C           *IN82     IFEQ '1'                        ## B0          073714
200700200528     C                     MOVE 'O'       RECI             'FOR OUTPUT    073714
200800200528     C*********            MOVELOSBR      BRCA                      098711138007
200900200528     C***********          MOVELEBRC      BRCA                     138007 154382
201000200528     C                     MOVELOSBR      BRCA                            154382
201100200528      *                                                                   CFF007
201200200528     C           CFF007    IFEQ 'Y'                                       CFF007
201300200528      *                                                                   CFF007
201400200528      ** Retreive customer report town and report name                    CFF007
201500200528     C                     MOVE CNUM      PCNUM                           CFF007
201600200528     C                     CALL 'AOCUSTR0'                                CFF007
201700200528     C                     PARM *BLANKS   PRTCD                           CFF007
201800200528     C                     PARM '*KEY   ' POPTN                           CFF007
201900200528     C                     PARM           PCNUM   6                       CFF007
202000200528     C                     PARM           PSTAT   7                       CFF007
202100200528     C           SDCUST    PARM SDCUST    DSSDY                           CFF007
202200200528     C           PRTCD     IFNE *BLANKS                                   CFF007
202300200528     C                     MOVEL'06'      DBASE                           CFF007
202400200528     C                     MOVEL'SDCUSTPD'DBFILE                          CFF007
202500200528     C                     MOVELPCNUM     DBKEY                           CFF007
202600200528     C                     EXSR *PSSR                                     CFF007
202700200528     C                     GOTO END                                       CFF007
202800200528     C                     ENDIF                                          CFF007
202900200528      *                                                                   CFF007
203000200528     C                     MOVE BBCRNM    CRNM                            CFF007
203100200528     C                     MOVE BBCRTN    CTWN                            CFF007
203200200528     C                     MOVE WCSLT     SETP                            CFF007
203300200528      *                                                                   CFF007
203400200528     C                     ENDIF                                          CFF007
203500200528      *                                                                   CFF007
203600200528     C/COPY WNCPYSRC,GL0554C003
203700200528     C                     END                             ## E001        073714
203800200528     C*                                                                   CEU003
203900200528     C**  If transaction is settled in another currency exclude events    CEU003
204000200528     C**  from report                                                     CEU003
204100200528     C*                                                                   CEU003
204200200528     C***********SIAC      IFEQ 'Y'                                 CEU003138004
204300200528     C***********          MOVE '0'       *IN65                     CUE003138004
204400200528     C***********          ENDIF                                    CUE003138004
204500200528     C           SIAC      IFEQ 'Y'                                       138004
204600200528     C           *IN02     ANDEQ'1'                                       177912
204700200528     C           EAMT      OREQ 0                                         181612
204800200528     C           OTHA      ANDEQ0                                                           MD040629
204900200528     C                     MOVE '0'       *IN65                           138004
205000200528     C                     ENDIF                                          138004
205100200528      *                                                                                    MD036589A
205200200528      ** If netting event, update so it will settle on netting ICD.                        MD036589A
205300200528      *                                                                                    MD036589A
205400200528     C           *IN24     IFEQ '1'                                                        MD036589A
205500200528      *                                                                                    MD036589A
205600200528      ** Get the netting ICD account.                                                      MD036589A
205700200528      *                                                                                    MD036589A
205800200528     C                     EXSR SRNET                                                      MD036589A
205900200528      *                                                                                    MD036589A
206000200528      ** Update PF/NOSEXED fields.                                                         MD036589A
206100200528      *                                                                                    MD036589A
206200200528     C           NETNOS    IFNE *BLANKS                                                    MD036589A
206300200528     C                     MOVE A8BICN    CNUM                                             MD036589A
206400200528     C**********           MOVE AMBRCA    OSBR                                    MD036589A MD048346
206500200528     C                     MOVE BRCD      OSBR                                              MD048346
206600200528     C                     MOVE '08'      SETP                                             MD036589A
206700200528     C                     MOVE NETNOS    OSAC1                                            MD036589A
206800200528     C                     MOVE *BLANKS   OSACQQ                                           MD036589A
206900200528     C                     MOVE BBPCNB    CPAR                                             MD036589A
207000200528     C           BBPAIN    IFEQ 'P'                                                        MD036589A
207100200528     C                     Z-ADD1         PARI                                             MD036589A
207200200528     C                     ELSE                                                            MD036589A
207300200528     C                     Z-ADD0         PARI                                             MD036589A
207400200528     C                     ENDIF                                                           MD036589A
207500200528     C                     MOVE BBCRNM    CRNM                                             MD036589A
207600200528     C                     MOVE BBCRTN    CTWN                                             MD036589A
207700200528     C                     MOVE BBCASC    CASK                                             MD036589A
207800200528     C                     MOVE BBCNCZ    CCTZ                                             MD036589A
207900200528     C                     MOVE BBCOLC    CLOC                                             MD036589A
208000200528     C                     CALL 'AOCTRYR0'                                                 MD036589A
208100200528     C                     PARM '*MSG   ' @RTCD                                            MD036589A
208200200528     C                     PARM '*KEY   ' @OPTN                                            MD036589A
208300200528     C                     PARM BBCNCZ    @CCTZ   2                                        MD036589A
208400200528     C           SDCTRY    PARM SDCTRY    DSFDY                                            MD036589A
208500200528     C           @RTCD     IFNE *BLANK                                                     MD036589A
208600200528     C                     MOVEL'19'      DBASE                                            MD036589A
208700200528     C                     MOVEL'SDCTRYPD'DBFILE                                           MD036589A
208800200528     C                     MOVELBBCNCZ    DBKEY                                            MD036589A
208900200528     C                     EXSR *PSSR                                                      MD036589A
209000200528     C                     ELSE                                                            MD036589A
209100200528     C                     MOVE A4RGCD    REGC                                             MD036589A
209200200528     C                     ENDIF                                                           MD036589A
209300200528      *                                                                                    MD036589A
209400200528     C                     MOVE *BLANKS   PRNM                                             MD036589A
209500200528     C                     MOVE *BLANKS   PTWN                                             MD036589A
209600200528     C                     MOVE *BLANKS   PASK                                             MD036589A
209700200528     C           BBPCNB    IFNE *BLANKS                                                    MD036589A
209800200528     C                     MOVE BBPCNB    PCNUM                                            MD036589A
209900200528     C                     CALL 'AOCUSTR0'                                                 MD036589A
210000200528     C                     PARM *BLANKS   PRTCD                                            MD036589A
210100200528     C                     PARM '*KEY   ' POPTN                                            MD036589A
210200200528     C                     PARM           PCNUM                                            MD036589A
210300200528     C                     PARM           PSTAT                                            MD036589A
210400200528     C           SDCUST    PARM SDCUST    DSSDY                                            MD036589A
210500200528     C           PRTCD     IFNE *BLANKS                                                    MD036589A
210600200528     C                     MOVEL'06'      DBASE                                            MD036589A
210700200528     C                     MOVEL'SDCUSTPD'DBFILE                                           MD036589A
210800200528     C                     MOVELPCNUM     DBKEY                                            MD036589A
210900200528     C                     EXSR *PSSR                                                      MD036589A
211000200528     C                     ELSE                                                            MD036589A
211100200528     C                     MOVE BBCRNM    PRNM                                             MD036589A
211200200528     C                     MOVE BBCRTN    PTWN                                             MD036589A
211300200528     C                     MOVE BBCASC    PASK                                             MD036589A
211400200528     C                     ENDIF                                                           MD036589A
211500200528     C                     ENDIF                                                           MD036589A
211600200528     C                     MOVELWNETR     ZZ0296                                            MD044815
211700200528      ** Switch on *IN65 to ensure writing to file.                                        MD036589A
211800200528     C                     MOVE '1'       *IN65                                            MD036589A
211900200528     C                     ENDIF                                                           MD036589A
212000200528     C                     ENDIF                                                           MD036589A
212100200528     C*
212200200528     C  N65                GOTO END
212300200528      *                                                                                       CGL015
212400200528     C           CGL015    IFEQ 'Y'                                                           CGL015
212500200528     C           *IN02     IFEQ '1'                                                           CGL015
212600200528     C           *IN42     IFEQ '1'                                                           CGL015
212700200528     C           REPAMT    SUB  ETAX      REPAMT                                              CGL015
212800200528     C                     ELSE                                                               CGL015
212900200528     C           EAMT      SUB  ETAX      REPAMT                                              CGL015
213000200528     C                     MOVE '1'       *IN42                                               CGL015
213100200528     C                     ENDIF                                                              CGL015
213200200528     C                     ENDIF                                                              CGL015
213300200528     C                     ENDIF                                                              CGL015
213400200528      *                                                                                       CGL015
213500200528     C           CAP204    IFEQ 'Y'                                                           CAP204
213600200528     C           *IN60     ANDEQ'1'                                                           CAP204
213700200528     C           NOSA      ANDNE'00'                                                          CAP204
213800200528     C                     MOVEL'R'       RECI                                                CAP204
213900200528     C                     MOVELEBRC      BRCA                                                CAP204
214000200528     C                     ENDIF                                                              CAP204
214100200528     C/COPY WNCPYSRC,GL0554C004
214200200528     C                     SETON                     34
214300200528     C           RECRIT    ADD  1         RECRIT  50
214400200528     C                     Z-ADD1         X       10
214500200528     C                     EXSR HASH
214600200528     C***********          GOTO END                                       138004
214700200528     C                     GOTO END                                       138004
214800200528     C*                                                                   085626
214900200528     C** If interest is paid separately, then need a separate record      085626
215000200528     C** for the interest. Event amount is the other amount,              085626
215100200528     C** event type is 'xxI2' and ingoing / outgoing ind. is as per       085626
215200200528     C** the original event.                                              085626
215300200528     C*                                                                   085626
215400200528     C           IPSI      IFEQ 'Y'                                       085626
215500200528     C***********RLVI      ANDEQ'Y'                                 085626138004
215600200528     C           RLVI      ANDEQ'Y'                                       186084
215700200528     C           RECRIT    ADD  1         RECRIT  50                      085626
215800200528     C                     Z-ADD1         X       10                      085626
215900200528     C                     MOVE INOI      SINOI   1                       085626
216000200528     C                     Z-ADDREPAMT    SAMT   130                      085626
216100200528     C                     MOVE ETYP      SETYP   4                       085626
216200200528     C***********          MOVE XINOI     INOI                      085626138004
216300200528     C                     Z-ADDOTHA      REPAMT                          085626
216400200528     C*                                                                   CEU003
216500200528     C* Event type should be 'xxIY' if processing one of the new events   CEU003
216600200528     C                     MOVE ETYP      WSETP1  1                       CEU003
216700200528     C           WSETP1    IFEQ 'X'                                       CEU003
216800200528     C           WSETP1    OREQ 'Y'                                       CEU003
216900200528     C           WSETP1    OREQ 'Z'                                       CEU003
217000200528     C                     MOVE 'IY'      ETYP                            CEU003
217100200528     C                     ELSE                                           CEU003
217200200528     C                     MOVE 'I2'      ETYP                            085626
217300200528     C                     ENDIF                                          CEU003
217400200528     C*                                                                   CEU003
217500200528     C                     EXSR HASH                                      085626
217600200528     C                     EXCPTRIPDS                                     085626
217700200528     C                     MOVE SINOI     INOI                            085626
217800200528     C                     Z-ADDSAMT      REPAMT                          085626
217900200528     C                     MOVE SETYP     ETYP                            085626
218000200528     C                     END                                            085626
218100200528     C*
218200200528     C/EJECT
218300200528     C           END       TAG                             ** END TAG **
218400200528     C**
218500200528     C*
218600200528     C*
218700200528     C*    T O T A L   T I M E   C A L C U L A T I O N S
218800200528     C*
218900200528     C*
219000200528     C***DO*NOT*UPDATE*D/DLSTAT*WITH*VALUE*'99'*IF*IT*WAS*NOT*SET*BEFORE.*036796
219100200528     C*LR*51******         MOVE '  '      DYSA                            036796
219200200528      *
219300200528     C*                                                                   E306
219400200528     C* READ THE BANK DETAILS FILE (WHEN RUN ON EMPTY FILES)              E306
219500200528     C*                                                                   E306
219600200528     CLRN49                CALL 'AOBANKR0'                                E306
219700200528     C                     PARM '*MSG    '@RTCD   7                       E306
219800200528     C                     PARM '*FIRST  '@OPTN   7                       E306
219900200528     C           SDBANK    PARM SDBANK    DSFDY                           E306
220000200528     C*                                                                   E306
220100200528     CLRN49      @RTCD     IFNE *BLANK                                    E306
220200200528     CLRN49                MOVEL'SDBANKPD'DBFILE 10        *************  E306
220300200528     CLRN49                MOVEL'02'      DBASE   2        * DBERR 02  *  E306
220400200528     CLRN49                MOVEL@OPTN     DBOPTN  7        *************  E306
220500200528     CLRN49                MOVEL@OPTN     DBKEY  29                       E306
220600200528     CLRN49                EXSR *PSSR                                     E306
220700200528     CLR                   END                                            E306
220800200528     C*                                                                   E321
220900200528     C** INCLUDE HEADER AND TRAILER RECORDS IN COUNT                      E321
221000200528     C*                                                                   E321
221100200528     CLR         RECRIT    ADD  2         RECRIT                          E321
221200200528     C*
221300200528     C**
221400200528     C*****************************************************************                    MD036589A
221500200528     C*                                                                                    MD036589A
221600200528     C           SRNET     BEGSR                                                           MD036589A
221700200528      *                                                                                    MD036589A
221800200528     C                     MOVE *BLANKS   NETNOS  2                                        MD036589A
221900200528      *                                                                                    MD036589A
222000200528      ** Check netting record to get the branch.                                           MD036589A
222100200528      *                                                                                    MD036589A
222200200528     C           *LIKE     DEFN AMBRCA    BRCD                                              MD048346
222300200528     C*Case*1:*System*Value*for*Branch*Code*is*used********************           MD048346 MD047513A
222400200528     C********** SVBRCA    IFNE *BLANKS                                           MD048346 MD047513A
222500200528     C**********           MOVELSVBRCA    BRCD                                    MD048346 MD047513A
222600200528     C**********           ELSE                                                   MD048346 MD047513A
222700200528     C           WNETR     CHAINFXNETML3             54                                    MD036589A
222800200528     C           *IN54     IFEQ '1'                                                        MD036589A
222900200528     C                     SETON                     U7U8LR                                MD036589A
223000200528     C                     MOVEL'FXNETML3'DBFILE                                           MD036589A
223100200528     C                     MOVEL'17'      DBASE                                            MD036589A
223200200528     C                     MOVELWNETR     DBKEY                                            MD036589A
223300200528     C                     EXSR *PSSR                                                      MD036589A
223400200528     C                     ELSE                                                             MD048346
223500200528     C*Case 1: System Value for Branch Code is used                                        MD047513A
223600200528     C           SVBRCA    IFNE *BLANKS                                                    MD047513A
223700200528     C                     MOVELSVBRCA    BRCD                                             MD047513A
223800200528     C                     ELSE                                                            MD047513A
223900200528     C           AMONOB    IFNE *BLANKS                                                     MD048346
224000200528     C*Case 2: FX net settlement branch is used.                                            MD048346
224100200528     C                     MOVELAMONOB    BRCD                                              MD048346
224200200528     C                     ELSE                                                             MD048346
224300200528     C*Case 3: Customer Branch is used                                                      MD048346
224400200528     C                     MOVELAMBRCA    BRCD                                              MD048346
224500200528     C                     ENDIF                                                            MD048346
224600200528     C                     ENDIF                                                           MD036589A
224700200528     C                     ENDIF                                                            MD048346
224800200528      *                                                                                    MD036589A
224900200528      ** Get customer details of branch.                                                   MD036589A
225000200528      *                                                                                    MD036589A
225100200528     C                     CALL 'AOBRCHR1'                                                 MD036589A
225200200528     C                     PARM *BLANK    @RTCD   7                                        MD036589A
225300200528     C                     PARM '*KEY'    @OPTN   7                                        MD036589A
225400200528     C**********           PARM AMBRCA    BRCHD   3                               MD036589A MD048346
225500200528     C                     PARM BRCD      BRCHD   3                                         MD048346
225600200528     C           SDBRCH    PARM SDBRCH    DSSDY                                            MD036589A
225700200528     C           @RTCD     IFNE *BLANK                                                     MD036589A
225800200528     C                     SETON                     U7U8LR                                MD036589A
225900200528     C                     MOVEL'SDBRCHPD'DBFILE                                           MD036589A
226000200528     C                     MOVEL'18'      DBASE                                            MD036589A
226100200528     C**********           MOVELAMBRCA    DBKEY                                   MD036589A MD048346
226200200528     C                     MOVELBRCD      DBKEY                                             MD048346
226300200528     C                     EXSR *PSSR                                                      MD036589A
226400200528     C                     ELSE                                                            MD036589A
226500200528      ** For the last step, get customer details.                                          MD036589A
226600200528     C                     MOVE A8BICN    PCNUM                                            MD036589A
226700200528     C                     CALL 'AOCUSTR0'                                                 MD036589A
226800200528     C                     PARM *BLANKS   PRTCD                                            MD036589A
226900200528     C                     PARM '*KEY   ' POPTN                                            MD036589A
227000200528     C                     PARM           PCNUM                                            MD036589A
227100200528     C                     PARM           PSTAT                                            MD036589A
227200200528     C           SDCUST    PARM SDCUST    DSSDY                                            MD036589A
227300200528     C           PRTCD     IFNE *BLANKS                                                    MD036589A
227400200528     C                     MOVEL'06'      DBASE                                            MD036589A
227500200528     C                     MOVEL'SDCUSTPD'DBFILE                                           MD036589A
227600200528     C                     MOVELPCNUM     DBKEY                                            MD036589A
227700200528     C                     EXSR *PSSR                                                      MD036589A
227800200528     C                     ENDIF                                                           MD036589A
227900200528     C                     ENDIF                                                           MD036589A
228000200528      *                                                                                    MD036589A
228100200528      ** If everything OK, then get nostro details.                                        MD036589A
228200200528      *                                                                                    MD036589A
228300200528     C                     MOVE BBCUST    KCUST                                            MD036589A
228400200528     C                     MOVE AMCCYD    ECCY                                             MD036589A
228500200528     C                     MOVE BNNEAC    KACCD                                            MD036589A
228600200528     C                     MOVE '01'      KACSN                                            MD036589A
228700200528     C           NOKEY     CHAINSDNOSTL4             99                                    MD036589A
228800200528     C           *IN99     IFEQ '0'                                                        MD036589A
228900200528     C                     MOVE A7NONB    NETNOS                                           MD036589A
229000200528     C                     ENDIF                                                           MD036589A
229100200528      *                                                                                    MD036589A
229200200528     C                     ENDSR                                                           MD036589A
229300200528      *                                                                                    MD036589A
229400200528     C*******************************************************************
229500200528     C*
229600200528     C           HASH      BEGSR
229700200528     C                     Z-ADDINT,X     ZZTOTI
229800200528     C                     Z-ADDDEC,X     ZZTOTD
229900200528     C  N42      EAMT      DIV  1000      ZZAMT        36
230000200528     C   42      REPAMT    DIV  1000      ZZAMT        36
230100200528     C   36                Z-SUBZZAMT     ZZAMT
230200200528     C                     EXSR GLZADD
230300200528     C                     Z-ADDZZTOTI    INT,X
230400200528     C                     Z-ADDZZTOTD    DEC,X
230500200528      *
230600200528      ** Clear previous accumulater values.
230700200528     C                     Z-ADD0         ZZTOTI
230800200528     C                     Z-ADD0         ZZTOTD
230900200528      *
231000200528     C                     ENDSR
231100200528     C**
231200200528     C********************************************************************
231300200528     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
231400200528     C*   IND '99' IS SET BY AN OVERFLOW ERROR
231500200528     C*
231600200528     CSR         GLZADD    BEGSR                           *** GLZADD ****
231700200528     C*
231800200528     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
231900200528     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
232000200528     C*
232100200528     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
232200200528     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
232300200528     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
232400200528     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
232500200528     C*
232600200528     CSR                   EXSR GLZSUM
232700200528     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
232800200528     C*
232900200528     C********************************************************************
233000200528     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
233100200528     C*                        GLZADD, GLZSUB, GLZCMP.
233200200528     C*          PARAMETERS PASSED -
233300200528     C*                     I/P ZZAMTI ZZAMTD
233400200528     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
233500200528     C*
233600200528     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
233700200528     C*
233800200528     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
233900200528     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
234000200528     CSR                   SETOF                     919293
234100200528     CSR                   SETOF                     949599
234200200528     C*
234300200528     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
234400200528     CSR         ZZAMTI    COMP 0                      9293
234500200528     CSR 93      ZZAMTD    COMP 0                      9293
234600200528     CSR 93                GOTO ZZSEND                     ZERO BYPASS
234700200528     C*
234800200528     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
234900200528     CSR         ZZTOTI    COMP 0                      9193
235000200528     CSR 93      ZZTOTD    COMP 0                      9193
235100200528     C*
235200200528     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
235300200528     CSR 93                Z-ADDZZAMTI    ZZTOTI
235400200528     CSR 93                Z-ADDZZAMTD    ZZTOTD
235500200528     CSR 93                GOTO ZZSEND                     ZERO BYPASS
235600200528     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
235700200528     CSR 91N92
235800200528     CORN91 92             GOTO ZZOFPS
235900200528     C*
236000200528     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
236100200528     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
236200200528     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
236300200528     C*
236400200528     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
236500200528     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
236600200528     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
236700200528     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
236800200528     C*
236900200528     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
237000200528     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
237100200528     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
237200200528     CSRN99                Z-ADDZZWK2     ZZTOTD
237300200528     CSRN99                Z-ADDZZWK3     ZZTOTI
237400200528     C*
237500200528     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
237600200528     CSR 99                Z-ADD0         ZZAMT  153
237700200528     CSR                   GOTO ZZSEND
237800200528     C*
237900200528     C* THE 'SIGNS' ARE DIFFERENT
238000200528     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
238100200528     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
238200200528     C*
238300200528     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
238400200528     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
238500200528     C*
238600200528     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
238700200528     C*
238800200528     CSR 91                Z-SUBZZTOTI    ZZTOTI
238900200528     CSR 91                Z-SUBZZTOTD    ZZTOTD
239000200528     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
239100200528     C*
239200200528     CSR         ZZTOTI    COMP ZZAMTI               93  95
239300200528     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
239400200528     C*
239500200528     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
239600200528     CSR 95                Z-ADD0         ZZTOTI
239700200528     CSR 95                Z-ADD0         ZZTOTD
239800200528     CSR 95                GOTO ZZSEND
239900200528     C*
240000200528     C* IF ZZTOT GT. ZZAMT.
240100200528     CSR 93      ZZAMTD    COMP ZZTOTD               94
240200200528     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
240300200528     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
240400200528     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
240500200528     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
240600200528     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
240700200528     C*
240800200528     C*
240900200528     C* IF ZZAMT GT. ZZTOT.
241000200528     CSRN93      ZZTOTD    COMP ZZAMTD               94
241100200528     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
241200200528     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
241300200528     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
241400200528     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
241500200528     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
241600200528     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
241700200528     C*
241800200528     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
241900200528     CSR                   SETOF                     94
242000200528     CSR 93 91
242100200528     CORN93 92             SETON                     94
242200200528     CSR 94                Z-SUBZZTOTI    ZZTOTI
242300200528     CSR 94                Z-SUBZZTOTD    ZZTOTD
242400200528     C**
242500200528     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
242600200528     CSR 92                Z-SUBZZAMTI    ZZAMTI
242700200528     CSR 92                Z-SUBZZAMTD    ZZAMTD
242800200528     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
242900200528     C**
243000200528     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
243100200528     CSR                   SETOF                     96
243200200528     CSR         ZZTOTD    COMP 0                        91
243300200528     CSR 91      ZZTOTI    COMP 0                      96
243400200528     CSR 96                MOVE '.000-'   ZZNEGD  5
243500200528     CSR                   ENDSR                             ** ENDSR **
243600200528     C********************************************************************
243700200528      /COPY ZSRSRC,ZFWDT
243800200528     C********************************************************************
243900200528      /COPY ZSRSRC,ZACCH
244000200528     C********************************************************************
244100200528     C*
244200200528     C           *PSSR     BEGSR
244300200528     C*
244400200528     C           @RUN      IFEQ *BLANK
244500200528     C                     MOVE 'Y'       @RUN    1
244600200528     C                     SETON                     U7U8LR
244700200528     C                     DUMP
244800200528     C                     END
244900200528     C*
245000200528     C                     ENDSR
245100200528     C*****************************************************************
245200200528     C/EJECT
245300200528      *****************************************************************                     MD048346
245400200528      *                                                               *                     MD048346
245500200528      * *INZSR - Program Initialisation routine                       *                     MD048346
245600200528      *                                                               *                     MD048346
245700200528      * Called by: Implicitly on program activation                   *                     MD048346
245800200528      *                                                               *                     MD048346
245900200528      * Calls: None                                                   *                     MD048346
246000200528      *                                                               *                     MD048346
246100200528      *****************************************************************                     MD048346
246200200528     C           *INZSR    BEGSR                                                            MD048346
246300200528      *                                                                                     MD048346
246400200528      ** Retrieve System Values                                                             MD048346
246500200528      *                                                                                     MD048346
246600200528     C                     CALL 'AOSVALR0'                                                  MD048346
246700200528     C                     PARM *BLANKS   PRTCD                                             MD048346
246800200528     C                     PARM FXSVAL    SVALK1 20                                         MD048346
246900200528     C                     PARM           SVAL1 200                                         MD048346
247000200528     C                     PARM *BLANK    SVALK2 20                                         MD048346
247100200528     C                     PARM           SVAL2 200                                         MD048346
247200200528     C                     PARM *BLANK    SVALK3 20                                         MD048346
247300200528     C                     PARM           SVAL3 200                                         MD048346
247400200528     C                     PARM *BLANK    SVALK4 20                                         MD048346
247500200528     C                     PARM           SVAL4 200                                         MD048346
247600200528     C                     PARM *BLANK    SVALK5 20                                         MD048346
247700200528     C                     PARM           SVAL5 200                                         MD048346
247800200528     C                     PARM *BLANK    SVALK6 20                                         MD048346
247900200528     C                     PARM           SVAL6 200                                         MD048346
248000200528     C                     PARM *BLANK    SVALK7 20                                         MD048346
248100200528     C                     PARM           SVAL7 200                                         MD048346
248200200528     C                     PARM *BLANK    SVALK8 20                                         MD048346
248300200528     C                     PARM           SVAL8 200                                         MD048346
248400200528     C                     PARM *BLANK    SVALK9 20                                         MD048346
248500200528     C                     PARM           SVAL9 200                                         MD048346
248600200528     C                     PARM *BLANK    SVALK0 20                                         MD048346
248700200528     C                     PARM           SVAL10200                                         MD048346
248800200528      * System Value for User Defined Branch Code for FX netting ICD                        MD048346
248900200528     C                     MOVELSVAL1     SVBRCA  3                                         MD048346
249000200528      *                                                                                     MD048346
249100200528     C                     ENDSR                                                            MD048346
249200200528     C*****************************************************************                     MD048346
249300200528     C/EJECT                                                                                MD048346
249400200528     O*
249500200528     O**   NOSTRO EVENTS EXTRACT FILE
249600200528     O*
249700200528     ONOSEXEC D        01
249800200528     O                                    1 'A'
249900200528     ONOSEXED D        02 65
250000200528     O                         LOT1     256
250100200528     O                         LOT2     320
250200200528     O                         OSAC2    336                                                   CGL029
250300200528     O                       42REPAMT    27P
250400200528     O                         CLAS     340                                                   CDL038
250500200528     ONOSEXED E        02 65   RIPDS                                      085626
250600200528     O                         LOT1     256                               085626
250700200528     O                         LOT2     320                               085626
250800200528     O                         OSAC2    336                                                   CGL029
250900200528     O                       42REPAMT    27P                              085626
251000200528     O                         CLAS     340                                                   CDL038
251100200528     ONOSEXCC D        03 65
251200200528     O                         LOT3     256
251300200528     O                         OSACA1    89                                                   CGL029
251400200528     O                         OSACA2   336                                                   CGL029
251500200528     O                         CLAS     340                                                   CLE042
251600200528     ONOSEXEL D        13 65
251700200528     O                         LOT4     256
251800200528     O                         OSACB1    89                                                   CGL029
251900200528     O                         OSACB2   336                                                   CGL029
252000200528     O                         CLAS     340                                                   CLE042
252100200528     ONSXBCEDFDADD     15 65                                              S01473
252200200528     O                         *ALL                                       S01473
252300200528     O**NOSEXESFDADD   17 65                                              E28817
252400200528     O*NOSEXESFDADD****    65                                      E28817 E33033
252500200528     O***********              *ALL                                       E33033
252600200528     ONOSEXSEFDADD     26 65
252700200528     O*******OR*       27 65                                                                  220952
252800200528     O*******OR*       28 65                                                                  220952
252900200528     O*******OR        27 65 85                                                        220952 223026
253000200528     O*******OR        28 65 85                                                        220952 223026
253100200528     O       OR        27 65                                                                  223026
253200200528     O       OR        28 65                                                                  223026
253300200528     O                         *ALL
253400200528     O*                                                                   S01408
253500200528     O/COPY WNCPYSRC,GL0554OOP1                                           S01408
253600200528     O*                                                                   S01408
253700200528     ONOSEXFPFDADD     37 65
253800200528     O                         *ALL
253900200528     ONOSEXFFFDADD     82 65                                              073714
254000200528     O                         *ALL                                       073714
254100200528     ONOSEXATFDADD     60 65                                                                  CAP204
254200200528     O                         *ALL                                                           CAP204
254300200528     O/COPY WNCPYSRC,GL0554O001
254400200528     ONOSEXZZ T        LR
254500200528     O                                    1 'T'
254600200528     O                         RECRIT     6
254700200528     O                         INT,1     14P
254800200528     O                         DEC,1     16P
254900200528     O*
255000200528     O*DL0554AUT**203***LR***************                                 E22608
255100200528     O***********************************24 'REFERENCE DL0554AU'          E22608
255200200528     OGL0554AUT  203   LR                                                 E22608
255300200528     O                                   24 'REFERENCE GL0554AU'          E22608
255400200528     O                         BJURPT    89
255500200528     O                                  104 'DATE'
255600200528     O                         BJMRDT   112
255700200528     O                                  122 'PAGE'
255800200528     O                         PAGE1 Z  127
255900200528     O        T  1     LR
256000200528     O                                   75 'NOSTROS EVENTS EXTRACT'
256100200528     O        T  2     LR
256200200528     O                                   75 '----------------------'
256300200528     O        T  210   LR   NU7
256400200528     O                                   30 'NOSTRO EVENTS EXTRACT '
256500200528     O                                   45 'RECORDS CREATED'
256600200528     O                         RECRIT3   59
256700200528     O                         INT,1 Z   81
256800200528     O                         DEC,1     84
256900200528     O        T 2      LRN34N99
257000200528     O                                   62 '***   NO DETAILS TO'
257100200528     O                                   75 'REPORT   ***'
257200200528     O        T 22     LR U7
257300200528     O                                   62 'PRINT TERMINATED, '
257400200528     O                                   80 'DATABASE IN ERROR'
257500200528     O        T 2      LR U7
257600200528     O                                   57 'DATABASE ERROR'
257700200528     O                         DBASE     61
257800200528     O                                   67 'FILE'
257900200528     O                         DBFILE    78
258000200528     O        T 13     LR U7
258100200528     O                                   46 'KEY'
258200200528     O                         DBKEY     76
258300200528     O*****   T 2      LR                                                 LN0135
258400200528     O*****                              65 '***   END OF REPORT'         LN0135
258500200528     O*****                              71 '***'                         LN0135
258600200528** CPY@   **      OBJECT COPYRIGHT
258700200528(c) Finastra International Limited 2001
