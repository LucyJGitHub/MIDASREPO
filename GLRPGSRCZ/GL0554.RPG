     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Nostros events extract')                      *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  GL0554 - Nostro's Events Extract                             *
      *         - This program is based on DL0550                     *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD040629           Date 05Sep16               *
      *  Prev Amend No. AR743357           Date 06Jul17               *
      *                 MD044815           Date 13Apr17               *
      *                 MD036589A          Date 22Feb17               *
      *                 MD036589           Date 14Feb16               *
      *                 CLE154             Date 06Aug12               *
      *                 MD033601           Date 06Aug15               *
      *                 AR877692           Date 23Jun15               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 MD022382A          Date 25Sep13               *
      *                 MD021048           Date 16Sep13               *
      *                 AR1028690          Date 29Nov12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR745341           Date 09Jun11               *
      *                 263013             Date 21Jan10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP204             Date 15Feb10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 07Jul06               *
      *                 181612             Date 06Jun06               *
      *                 CGL044             Date 14Feb06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 BUG7963            Date 25Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 223026             Date 09Oct03               *
      *                 220952             Date 09Oct03               *
      *                 BUG5519            Date 22Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 BUG5319            Date 20Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 223572             Date 03Dec03               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE033             Date 27Mar03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 CGL015             Date 15Apr02               *
      *                 208461             Date 30May03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 209676             Date 09Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 200529             Date 19Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 186084             Date 03Sep01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 196833             Date 16Aug01               *
      *                 CFF007             Date 13Feb01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 168838             Date 29Jan01               *
      *                 CIR003             Date 12Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 178438             Date 12Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 177912             Date 26May00               *
      *                 154382             Date 17Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163486             Date 13Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 149024             Date 12JAN99               *
      *                 132029             Date 04Oct98               *
      *                 138007             Date 05Nov98               *
      *                 138004             Date 14Jul98               *
      *                 137359             Date 25Aug98               *
      *                 CEU017             Date 02Apr98               *
      *                 CSE007             Date 17Mar98               *
      *                 CEU003             Date 28MAR98               *
      *                 126735             DATE 18FEB98               *
      *                 CTI001             Date 12AUG97               *
      *                 CFF004             DATE 02OCT96               *
      *                 105140             DATE 18NOV96               *
      *                 S01408             DATE 12AUG96               *
      *                 087177             DATE 09JUL96               *
      *                 098711             DATE 28JUN96               *
      *                 030749             DATE 03JUN96               *
      *                 092853             DATE 24APR96               *
      *                 085626             DATE 23OCT95               *
      *                 090404             DATE 27SEP95               *
      *                 073714             DATE 01MAR95               *
      *                 085626             DATE 21JUN95               *
      *                 085479             DATE 11APR95               *
      *                 S01496             DATE 16NOV94               *
      *                 S01512             DATE 25NOV94               *
      *                 S01473             DATE 16AUG94               *
      *                 064882             DATE 06JAN94               *
      *                 046303             DATE 16JAN94               *
      *                 036796             DATE 10JAN94               *
      *                 057118             DATE 19SEP93               *
      *                 046872             DATE 03SEP93               *
      *                 045634             DATE 23APR93               *
      *                 S01393             DATE 30OCT92               *
      *                 S01392             DATE 20JUL92               *
      *                 E38323             DATE 31JUL92               *
      *                 S01117             DATE 18MAR92               *
      *                 E33033             DATE 09DEC91               *
      *                 E33042             DATE 09DEC91               *
      *                 E28817             DATE 14OCT91               *
      *                 RT0097             DATE 13MAY91               *
      *                 S01314             DATE 22FEB90               *
      *                 E23278             DATE 06NOV90               *
      *                 E22608             DATE 30SEP90               *
      *                 BHF136             DATE 06JUN90               *
      *                 LN0135             DATE 23MAY90               *
      *                 E321               DATE 11APR90               *
      *                 E306               DATE 09APR90               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD040629 - Deposit interest is not shown in the              *
      *             projected movements.                              *
      *  AR743357 - Include principal movements in report when PDEI=  *
      *             Y and prevent unnecessary IRS events.             *
      *           - Applied for MD033602                              *
      *  MD044815 - System did not generate reversal projections when *
      *             FX netting transaction was reversed.  Ensure      *
      *             complete set of projections are created by the    *
      *             system during reversal.                           *
      *  MD036589A - Reopen.  Need to project on netting ICD account. *
      *  MD036589 - Create nostro event for FX nets.                  *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  MD033601 - MM Deal Rollover with increase leads to wrong     *
      *             forecast and no payment message                   *
      *  AR877692 - Deal with retail nostro account (SETP = 14) do    *
      *             not post in Projected Account Movements. Applied  *
      *             fix 251196. (Child: AR877693)                     *
      *           - Applied for MD-32223.                             *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  MD022382A - PRONOPN differences after check cob 6            *
      *  MD021048 - DL Events missing from Nostro balance. Amended to *
      *             use DNWD-1 as start date/basis of event extraction*
      *           - Applied for MD022382
      *  AR1028690 - GLC0802C in MSGW with error, SETP not properly   *
      *              initialised causing a 'D' record to be written on*
      *              PF/NOSEXAT. Added validation if *IN60 = 0 before *
      *              SETP will turn on *IN65. (Child: AR1028693)      *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR745341 - GLC0802C 00001 FOOB error. (Child: AR745342)      *
      *  263013 - Error on Projected Nostro Enquiry. Nostro events    *
      *           should base the extraction from the calendar setup  *
      *           of the deal currency, instead of local currency.    *
      *           Part of the fix is to apply 258293 and 259845.      *
      *  CAP204 - Retail Account Transfer                             *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  181612 - Exclude events with event amount equal to zero.     *
      *  CGL044 - For Sec. Nostro Extract, Get  Coupon Rate, Issuer   *
      *           Name and Town.                                      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  BUG7963  Deals that settle across retail (SETP = 05) are     *
      *           not updating correct nostro.                        *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  223026 - Correction of 220952. if autopost posn sett = 'N'.  *
      *           authorised pos. settlements must be extracted.      *
      *  220952 - Projections may be duplicated during authorisation  *
      *           of posn settlements if autopost posn sett = 'N'.    *
      *           Applied fix 197959.                                 *
      *  BUG5519 - Fix 208461 conflicts with 209676. Reverse part of  *
      *            fix 208461. Principal exchange events for cross    *
      *            currencies should be projected.                    *
      *  CSD025 - Customer De-Activation                              *
      *  BUG5319 - Some events are not generated correctly due to     *
      *            incorrect value of OSAC1.                          *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  223572 - Events By Nostro Rprt is showing the All In and     *
      *           NTR Events                                          *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE033 - Settlement method 09                                *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  CGL015 - Net Amounts on Events by Nostro                     *
      *  208461 - Prevent incorrect event details for IRS deals from  *
      *           appearing on the daily events by currency report.   *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  209676 - Allow the projection of principal changes and       *
      *           principal exchanges for cross currency IRS deals.   *
      *  200529 - Maturity posting amount of a loan did not appear on *
      *           the Events by Nostro report'. Fix will ensure that  *
      *           posting amounts will be posted on correct Nostro.   *
      *  186084 - Duplicate transaction in Events by Nostro report.   *
      *           Reinstate checking for rolled over deals removed by *
      *           138004 if IPSI is equal to 'Y'.                     *
      *  196833 - Additional SWIFT Address for CLS Nostros (Recompile)*
      *  CFF007 - Futures and Options Enhancement for Private Banking *
      *  168838 - Do not include 'OP' deals in 'Events by Nostro      *
      *           Report'.                                            *
      *  CIR003 - Principal Exchange on Cross Currencies IRS          *
      *  178438 - For SE Coupon and Maturity events, output the       *
      *           Security details on Events by Nostro report and     *
      *           on Projected Account Mvmts screen (based on 157381) *
      *  177912 - Error in 138004 - securities trade events not       *
      *           appearing in projected nostros.                     *
      *  154382 - Fix 138007 in this pgm causes events in PF/NOSEXED  *
      *           to have incorrect event branch and eventually will  *
      *           not be included in GL0580P1 report for deals which  *
      *           will settle to a nostro w/ a different branch from  *
      *           the deal booking branch.                            *
      *  163486 - Recompiled due to changes to EVNTXED.               *
      *  149024 - On rollover of a deal, only the amount not rolled   *
      *           over should appear on Projected Nostro Events rept. *
      *           Reinstate the line removed by 138004 which subtracts*
      *           the Rolled over by Deal amount from REPAMT to obtain*
      *           the correct event amount, if Rollover Ind is 'Y'.   *
      *  132029 - Do not process fields SETP or OSAC for FT.          *
      *           Applied fix 120733.                                 *
      *  138007 - Need to use EBRC not OSBR                           *
      *  138004 - Problem with events not being  split for Interest   *
      *         - when deal request that interest should be split.    *
      *           same fix to resolve problem on 138004/6/7
      *           REMOVED 137359 AS 138004 APPEARS TO COVER THIS.
      *  137359 - When Settlement Currency is entered for Deposits,   *
      *           Projected Movement amount was wrongly calculated by *
      *           adding Other amount 'IN-CCY' to Event Amount 'EUR'. *
      *  CEU017 - Securities Redenomination Euro Changes              *
      *  CSE007 - Corporate Actions                                   *
      *  CEU003 - EMU DL Settlement Currency Conversion:              *
      *           Include processing required by EMU switchable       *
      *           feature CEU003.                                     *
      *  126735 - FOR GUARANTEES (PTYP=70) ONLY THE INTEREST AND FEES *
      *           EVENTS SHOULD UPDATE THE PROJECTED NOSTRO BALANCE   *
      *  CTI001 - Midas / Trade Innovation Interface Phase 1          *
      *  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
      *  105140 - Recompile over changed LVENTZZ.                     *
      *  S01408 - Core Hook GL0554FFP1 Added
      *         - Core Hook GL0554OOP1 Added
      *  087177 - Include past-due position settlements               *
      *  098711 - Events by nostro report (GL0580P1) cannot print out *
      *           premium due events, even after installing the OTC   *
      *           enhancements. Branch Code (BRCA) on PF/NOSEXFF      *
      *           should be explicitly set up with Our Settlement     *
      *           Branch (OSBR) from PF/FOEVED.                       *
      *  030749 - Complete fix for 051227 to suppress FRA/IRS         *
      *           event types (originally only applied to GL0550).    *
      *           The fix done was to check if the event types are    *
      *           relevant otherwise, this shouldn't be reported. The *
      *           relevant event types are as follows: 21I1, 21N1,    *
      *           21N2, 22I1, 23I1, 24I1, 24N1, 24N2. All other       *
      *           FRA/IRS events not mentioned are skipped.           *
      *  092853 - Nostro events were incorrectly extracted based on   *
      *           Days Forward for Events by Currency                 *
      *  085626 - Previous incorporation of 085626 (21jun95) incomplete
      *  090404  - WHEN SETTLEMENT METHOD 5 OR 14 USED, AND THE ACCOUNT*
      *            IS A NOSTRO, THE PROJECTED NOSTRO BALANCE IS NOT   *
      *            UPDATED AND THE EVENT IS NOT REPORTED IN THE EVENT *
      *            BY CURRENCY REPORT.                                *
      *  073714 - OTC ENHANCEMENTS                                    *
      *  085626 - Events for rollovers should take into account       *
      *           interest paid separately and increases              *
      *  085479 - Customer Lending (LVENTEL) part of EVNTM1 ;         *
      *           Capitalised interest has an event type of X2 (see   *
      *           fix E25263 in LE0480 R10.5). This means that the    *
      *           lending event should have no impact on the Nostro   *
      *           i.e. should not be extracted as a Nostro event.     *
      *           The symptom of this error was that GL0580 was       *
      *           producing RSACMTPD records which were displayed     *
      *           in Projected Account Movements screen against the   *
      *           Nostro.                                             *
      *  S01496 - Incorporation of Jyske Enhancements (S10978).       *
      *  S01473 - Midas Leo Integration. Addition of LC files and     *
      *           events processing                                   *
      *  064882 - Incorrect branch written to pf/nosexfp for Funds    *
      *           Transfer events; should be settlement branch.       *
      *  046303 - /COPY source subr. ZFWDT amended to prevent array   *
      *           error if no holiday record found - fixed by S01434. *
      *           Program recompiled.                                 *
      *  036796 - NO. OF FORWARD DAYS FOR NOSTROS EVENTS REPORT       *
      *           AND EVENTS BY CCY, AND SPOT REVAL. WERE MOVED       *
      *           FROM DLSTAT TO GLSTAT                               *
      *  057118 - Rename branch codes in SE events files              *
      *  046872 - Do not call ZFWDT subroutine if No of Days is 99    *
      *           as system will set ZDYNBR to 99999 to generate      *
      *           events to End of Book.                              *
      *  045634 - Updated to include new lending fee events in        *
      *           the reporting - facility fees and loan fees         *
      *  S01393 - Additional Strategic Risk Management Event Types    *
      *           to skip have been added. Also Book Code added to    *
      *           PF/EVNTXED.                                         *
      *  S01392 - JAP.SUB-MODULE INCORPORATION (CORE)                 *
      *  E38323 - Recompiled over changed copy source ZFWDT subroutine*
      *  S01117 - RECOMPILED FOR FT RELEASE 10                        *
      *  E33033 - NOSEXES is an ST1 file so do not write to it.       *
      *  E33042 - Recompiled over changed lf/EVNTM1.                  *
      *  E28817 - STEVEAB and STEVEFC are now redundant               *
      *  RT0097 - Recompiled over changed lf/EVNTM1.                  *
      *  S01314 - The fix below (E23278), from DL/GL0550, is only used*
      *           in part in this program, and has been annotated with*
      *           the R10 PTF incorporation change number.            *
      *  E23278 - ALLOW DEAL EVENTS HAVING FIELD 'FIPI7 BLANK TO      *
      *           BE PROCESSED.                                       *
      *           DO NOT PROCESS DEAL EVENTS WITH ETYP 'M2'.          *
      *           INSERT NARRATIVES FOR 21C1, 21C2, 22C1, 22C2,       *
      *           22S1, 22S2, 23C1, 23C2, 24C1 & 24C2.                *
      *  E22608 - PROGRAM RENAMED FROM DL0554                         *
      *  BHF136 - EVENTS NOT EXTRACTED FOR DATES MORE THAN 99 WORKING *
      *           DAYS AFTER THE RUN DATE                             *
      *  LN0135 - REMOVE 'END OF REPORT' FROM AUDIT REPORT            *
      *  E321   - INCLUDE HEADER AND TRAILER IN COUNT                 *
      *  E306   - SHOULD READ SDBANK WHEN RUN ON EMPTY FILES          *
      *                                                               *
      *****************************************************************
     F/COPY WNCPYSRC,GL0554FFP1                                           S01408
     F*                                                                   S01408
     FEVNTM1  IP  E           K        DISK
     F/COPY WNCPYSRC,GL0554F001
     FDRSDEALSIF  F    1074  6AI     2 DISK                               S01392
     FDEALS   IF  E           K        DISK                                                 AR743357
     F            DEALSDAF                          KIGNORE                                 AR743357
     F**********  DEALSDBF                          KIGNORE                        AR743357 MD036589
     F            DEALSDCF                          KIGNORE                                 AR743357
     F            DEALSDDF                          KIGNORE                                 AR743357
     F            DEALSDEF                          KIGNORE                                 AR743357
     F            DEALSDFF                          KIGNORE                                 AR743357
     F**********  DEALSDGF                          KIGNORE                        MD036589 AR743357
     F/COPY WNCPYSRC,GL0554F003
     FSDNOSTL4IF  E           K        DISK                               090404
     FACNUM   IF  E           K        DISK                               090404
     FFXNETML3IF  E           K        DISK                                                MD036589A
     FNOSEXEC O   F     320            DISK
     F***NOSEXED O   F     320            DISK                                                CGL029
     F***NOSEXCC O   F     320            DISK                                                CGL029
     F***NOSEXEL O   F     320            DISK                                                CGL029
     F*NOSEXED*O   F     336            DISK                                           CGL029 CDL038
     FNOSEXED O   F     340            DISK                                                   CDL038
     F*NOSEXCC*O***F*****336            DISK                                           CGL029 CLE042
     F*NOSEXEL*O***F*****336            DISK                                           CGL029 CLE042
     FNOSEXCC O   F     340            DISK                                                   CLE042
     FNOSEXEL O   F     340            DISK                                                   CLE042
     F*NOSEXES*O***E                    DISK                      A       E33033
     FNOSEXSE O   E                    DISK                      A
     FNOSEXFP O   E                    DISK                      A
     F/COPY WNCPYSRC,GL0554F002
     FNOSEXZZ O   F     320            DISK
     FNOSEXFF O   E                    DISK                      A        073714
     FNSXBCED O   E                    DISK                      A        S01473
     FNOSEXAT O   E                    DISK                      A                            CAP204
     F*DL0554AUO***F*****132     OV     PRINTER                           E22608
     FGL0554AUO   F     132     OV     PRINTER                            E22608
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F* 01            EVENT HEADER
     F* 02            EVENT DETAIL - DEAL EVENT
     F* 03            EVENT DETAIL - COMMERCIAL LOAN EVENT
     F* 04            EVENT TRAILER
     F*       11      NEGATIVE INTEREST INDICATOR
     F* 12            EVENT TRAILER - COMMERCIAL LOAN EVENT
     F* 13            CUSTOMER LENDING EVENT
     F* 14            CUSTOMER LENDING EVENTS FILE TRAILER
     F* 15            LETTERS OF CREDIT EVENT DETAIL                      S01473
     F* 16            LETTERS OF CREDIT EVENT TRAILER                     S01473
     F**17************SECURITIES*TRADING*EVENT*DETAIL******************   E28817
     F**18************SECURITIES*TRADING*EVENT*TRAILER*****************   E28817
     F*    20         FULL INSTRUCTIONS PRESENT INDICATOR IS BLANK - DEAL
     F*    21         INCOMING/OUTGOING INDICATOR IS BLANK
     F*    26         TRADE EVENTS DETAIL HAS BEEN READ
     F*    27         CUSTOMER POSITION EVENTS DETAIL HAS BEEN READ
     F*    28         DEPOT POSITION EVENTS DETAIL HAS BEEN READ
     F*    29         BOOK POSITION EVENTS DETAIL HAS BEEN READ
     F*      N34      NO DETAILS TO REPORT
     F*       36      NEGATIVE AMOUNT IN HASH TOTALLING
     F* 37            FUNDS TRANSFER EVENT DETAIL
     F* 38            FUNDS TRANSFER EVENT TRAILER
     F*       40      NUMBER OF DAYS IS LESS THAN 5
     F*      N41      EVENT IS TO BE REPORTED
     F*       42      EVENT CODE ENDS WITH 'M1' DEAL EVENT ONLY
     F*       48      COMMITMENT FEE EVENT
     F*       49      FIRST CYCLE INDICATOR
     F********51******DAYS*FORWARD*HAS*NOT*BEEN*SET*                      036796
     F******************(CAN*OCCUR*IF*ST.*BUT*NOT*DL.*IS*IN*THE*SYSTEM.)* 036796
     F*       53      CSE007 present                                      CSE007
     F*       53      CEU017 present                                      CEU017
     F*       60      Generated Entries Event Detail                                          CAP204
     F*       61      Generated Entries Event Trailer                                         CAP204
     F*       63      S01496 present                                      S01496
     F*       65      EVENT RECORD IS TO BE OUTPUT TO NOSEX
     F* 81            ROLLOVER INDICATOR = 'Y', DEAL EVENT ONLY           149024
     F* 82            EVNTM DETAIL - FO RECORD
     F* 83            EVNTM TRAILER- FO RECORD
     F*       U7 U8   DATABASE ERROR
     E                    CPY@    1   1 80
     E                    INT         1 15 0             HASH TOTALS
     E                    DEC         1  3 0             HASH TOTALS
     E*
      /COPY ZSRSRC,ZHOLE
     E*
     I*
     I*    DEALS EVENTS FILE - HEADER RECORD.
     I*
     IEVNTXECF    01
     I*
     I*    EVENTS FILE - DEALS DETAIL RECORD.
     I*
     IEVNTXEDF    02
     I                                              FIPI            20
     I                                              INOI            21
     I*
     I*    MERGED EVENTS FILE - COMMERCIAL LOAN DETAIL RECORD.
     I*
     ICEVNXCCF    03
     I                                              INOI            21
     I**********    LNNO                            DLNO                                      CLE148
     I              BWCN                            CUNR
     I              LNTP                            DTYP
     I              LNST                            DLST
     I              OSACQQ                          OSC1QQ                                    CGL029
     I*
     I*    MERGED EVENTS FILE - CUSTOMER LENDING DETAIL RECORD
     I*
     ILVENTELF    13
     I                                              INOI            21
     I              LTYP                            DTYP
     I              SUTP                            DLST
     I              DFCE                            LCEQ
     I              CDOM                            CLOC
     I              ECDP                            DEC1
     I              FACT                            FTYP
     I              FCNO                            FSEQ
      *                                                                   S01473
     IBVNTXEDF    15                                                      S01473
     I                                              ECCY  L1              S01473
     I                                              OTHD            22    S01473
     I                                              INOI            21    S01473
      ** Letters of Credit Event Detail                                   S01473
      *                                                                   S01473
     IBVNTXEZF    16                                                      S01473
      ** Letters of Credit Events File Trailer                            S01473
      *                                                                   S01473
     I*
     I*   SECURITIES TRADING EVENT DETAIL
     I*
     I*STEVEABF    17                                                     E28817
     I***********   RECI                            RECIST                E28817
     I***********   ODTE                            OTHD                  E28817
     I***********   IOIN                            INOI            21    E28817
     I***********   SBEE                            BCEQ                  E28817
     I***********   DBRT                            DBCR                  E28817
     I***********   TRDR                            DLNO                  E28817
     I***********   TRSE                            DLST                  E28817
     I***********   TRTE                            DTYP                  E28817
     I***********   DNEE                            LCEQ                  E28817
     I***********   OURE                            OSAC                  E28817
     I***********   NOMC                            OTHC                  E28817
     I***********   REGR                            REGC                  E28817
     I***********   SETL                            SETP                  E28817
     I***********   OAME                            OTHA                  E28817
     I*
     I*   TRADE EVENT DETAIL
     I*
     ITREVEDF     26
     I              TRRI                            RECI
     I              TRSS                            SECS
     I              TRTT                            DTYP
     I              TRVD                            EDAT
     I              TRSC                            ECCY
     I              TRVS                            EAMT
     I              TRTS                            DLST
     I              TRCN                            CRNM
     I              TRTN                            CTWN
     I              TRIO                            INOI            21
     I              TREC                            ETYP
     I              EBRC                            BRCA                  057118
     I              EARL                            WEARL                 S01496
     I              COAF                            WCOAF                 CSE007
     I*
     I*   CUSTOMER POSTITION EVENTS DETAIL
     I*
     ICPEVEDF     27
     I              CCRN                            CRNM
     I              CCTR                            CTWN
     I**************CCDT                            EDAT                  S01512
     I              CPYD                            EDAT                  S01512
     I              CCCE                            ETYP
     I              CCEC                            ECCY
     I              CCSS                            SECS
     I              CCIO                            INOI            21
     I              CCEA                            EAMT
     I              EBRC                            BRCA                  057118
     I              MDTI                            WMDTI                 S01496
     I              EARL                            WEARL                 S01496
     I              COAF                            WCOAF                 CSE007
     I*
     I*   DEPOT POSTITION EVENTS DETAIL
     I*
     IDPEVEDF     28
     I              CCDN                            CRNM
     I              CCTW                            CTWN
     I**************CCDT                            EDAT                  S01512
     I              CCPD                            EDAT                  S01512
     I              CCCE                            ETYP
     I              CCEC                            ECCY
     I              CCSS                            SECS
     I              CCIO                            INOI            21
     I              CCEA                            EAMT
     I              EBRC                            BRCA                  057118
     I              MDTI                            WMDTI                 S01496
     I              EARL                            WEARL                 S01496
     I              COAF                            WCOAF                 CSE007
     I*
     I*   BOOK POSTITION EVENTS DETAIL
     I*
     IBPEVEDF     29
     I**************CCDT                            EDAT                  S01512
     I              CCPD                            EDAT                  S01512
     I              CCCE                            ETYP
     I              CCEC                            ECCY
     I              CCSS                            SECS
     I              CCIO                            INOI            21
     I              CCEA                            EAMT
     I*
     IFPVNTDDF    37
     I*
     I*  FUNDS TRANSFER EVENTS DETAIL RECORD
     I*
     I                                              INOI            21
      *                                                                                       CAP204
      ** ACCOUNT TRANSFER DETAIL RECORD                                                       CAP204
      *                                                                                       CAP204
     IGLEVNTDF    60                                                                          CAP204
     I                                              INOI            21                        CAP204
     I/COPY WNCPYSRC,GL0554I002
     I*
     I*
     I*
     I*    DEALS EVENTS FILE - TRAILER RECORD.
     I*
     IEVNTXZZF    04
     I*
     I*
     I*    COMMERCIAL LOANS EVENTS FILE - TRAILER RECORD.
     I*
     ICEVNXZZF    12
     I*
     I*    CUSTOMER LENDING EVENTS FILE TRAILER
     I*
     ILVENTZZF    14
     I*
     I*    SECURITIES TRADING EVENTS FILE TRAILER
     I*
     I*STEVEFCF    18                                                     E28817
     I***********   HSTA                            HRWN                  E28817
     I***********   HSTB                            HRDC                  E28817
     I*
     IFPVNTZZF    38
     I*
     I*    FUNDS TRANSFER EVENTS FILE TRAILER
     I*
     I              NORE1                           NORE
     I*
     I*    EVNTM FILE - FO DETAIL RECORD
     IFOEVEDF     82
     I                                              INOI            21    073714
     I*
     I*    EVNTM FILE - FO TRAILER
     IFOEVEZZF    83
      *                                                                                       CAP204
      **   ACCOUNT TRANSFER TRAILER RECORD                                                    CAP204
      *                                                                                       CAP204
     IGLEVNTZF    61                                                                          CAP204
     I              ZZ304                           GZZ304                                    CAP204
     IDRSDEALSNS                                                          S01392
     I                                    P 214 2200TOTI                  S01392
     I/COPY WNCPYSRC,GL0554I003
     I*
     ISDBANK    E DSSDBANKPD
     I** EXTERNAL DS FOR BANK DETAILS
     I*
     ISCSARD    E DSSCSARDPD                                              S01473
      ** Switchable Features File                                         S01473
      *                                                                   S01473
      ** Securities Trading ICD                                                               220952
      *                                                                                       220952
     ISDSTRD    E DSSDSTRDPD                                                                  220952
      *                                                                                       220952
     ISDMOD     E DSSDMMODPD                                              CTI001
     I**  EXTERNAL DS FOR MODULE ID'S                                     CTI001
     I*                                                                   CTI001
     ISDCUST    E DSSDCUSTPD                                              CFF007
      ** External data structure for customer details                     CFF007
      *                                                                   CFF007
     ISDBRCH    E DSSDBRCHPD                                                               MD036589A
     I              QQDFAC                          QQDFA1                                 MD036589A
      ** Branch Details                                                                    MD036589A
      *                                                                                    MD036589A
     ISDCTRY    E DSSDCTRYPD                                                               MD036589A
      ** Country Details                                                                   MD036589A
      *                                                                                    MD036589A
     ISDDEAL    E DSSDDEALPD                                                               MD036589A
     I              QQACCD                          QQACC1                                 MD036589A
     IDSFDY     E DSDSFDY
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     IDSSDY     E DSDSSDY
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
     I*
      /COPY ZSRSRC,ZHOLI
     I*
     ILOT1        DS                            256
     I                                        1   1 RECI
     I                                        2   70DLNO
     I** (SOME FORMATS FOR EVNTM HAVE CNUM (6,0) , OTHERS CUNR (6A)
     I**  USE DATA STRUCTURE TO ENSURE ALL INPUT IN CNUM.)
     I**********                              8  130CNUM                                      CSD027
     I                                        8  13 CNUM                                      CSD027
     I                                        8  13 CUNR
     I                                       14  17 ETYP
     I                                    P  18  200EDAT
     I                                    P  21  270EAMT
     I                                       28  30 ECCY
     I                                       31  320ECSS
     I                                       33  34 DTYP
     I                                       35  36 DLST
     I*************                          37  39 OSBR                  138007
     I***********                            37  39 EBRC           138007 154382
     I                                       37  39 OSBR                  154382
     I                                    P  40  468EXRT
     I                                       47  47 NGII
     I                                       48  500NOTD
     I                                    P  51  530OTHD
     I                                    P  54  600OTHA
     I                                       61  63 OTHC
     I                                    P  64  700DBCE
     I                                    P  71  770BCEQ
     I                                    P  78  848DBCR
     I                                    P  85  910LCEQ
     I                                       92  930SETP
     I**********                             94 105 OSAC                                      CGL029
     I                                       94  95 OSAC1                                     CGL029
     I                                      106 115 TSEN
     I                                      116 118 ZZ0116
     I                                      119 119 FIPI
     I                                      120 120 INOI
     I                                      121 121 FCTI
     I                                      122 122 RLVI
     I** (SOME FORMATS FOR EVNTM HAVE CPAR (6,0) , OTHERS PTNU (6A)
     I**  USE DATA STRUCTURE TO ENSURE ALL INPUT IN CPAR.)
     I**********                            123 1280CPAR                                      CSD027
     I                                      123 128 CPAR                                      CSD027
     I                                      123 128 PTNU
     I                                      129 1290PARI
     I                                      130 149 CRNM
     I                                      150 159 CTWN
     I                                      160 167 CASK
     I                                      168 187 PRNM
     I                                      188 197 PTWN
     I                                      198 205 PASK
     I                                      206 207 CCTZ
     I                                      208 209 CLOC
     I                                      210 211 REGC
     I                                      212 2140DASN
     I                                    P 215 2170FFVD
     I                                      218 218 FFIN
     I                                      219 2210FACT
     I                                      222 2230FCNO
     I                                      224 233 FACO
     I                                      234 256 SPI11
     ILOT2        DS                             64
     I                                        1  12 SPI21
     I**********                             13  180CPCN                                      CSD027
     I                                       13  18 CPCN                                      CSD027
     I                                       19  190FSLI
     I                                    P  20  257ICIR
     I                                    P  26  320ICAM
     I                                    P  33  390RBDA
     I                                       40  40 OCFF
     I                                       41  63 ZZ0296
     I                                       64  64 TAXI
     ILOT3        DS                            256
     I                                        1   1 RECI1
     I                                        2   70DLNO1
     I**********                              8  130DDNO                                      CLE148
     I                                        8  13 DDNO                                      CLE148
     I**********                             14  190CNUM1                                     CSD027
     I                                       14  19 CNUM1                                     CSD027
     I                                       20  23 ETYP1
     I                                    P  24  260EDAT1
     I                                    P  27  330EAMT1
     I                                       34  36 ECCY1
     I                                       37  380ECSS1
     I                                       39  40 DTYP1
     I                                       41  42 DLST1
     I                                       43  45 BRCA1
     I                                    P  46  480OTHD1
     I                                    P  49  550OTHA1
     I                                       56  58 OTHC1
     I                                    P  59  650BCEQ1
     I                                    P  66  720LCEQ1
     I                                    P  73  750CSTD
     I                                    P  76  780CMTD
     I                                       79  790RPYT
     I                                    P  80  857EINR
     I                                       86  870SETP1
     I**********                             88  99 OSACA                                     CGL029
     I                                      100 109 TSEN1
     I                                    P 110 1179DXRT
     I                                      118 1180DEC1
     I                                      119 1190DEC2
     I                                      120 139 CRNM1
     I                                      140 149 CTWN1
     I                                      150 157 CASK1
     I                                      158 177 PRNM1
     I                                      178 187 PTWN1
     I                                      188 195 PASK1
     I                                      196 196 INOI1
     I                                      197 197 CYSW
     I                                      198 199 CRSK
     I                                      200 201 CLOC1
     I                                      202 203 REGC1
     I                                      204 204 FFIN1
     I                                    P 205 2070FFVD1
     I                                    P 208 2140OADD
     I                                    P 215 2170LIPD
     I                                      218 2180PARI1
     I**********                            219 2240CPAR1                                     CSD027
     I                                      219 224 CPAR1                                     CSD027
     I                                      225 256 ZZ0225
     ILOT4        DS                            256
     I                                        1   1 RECI2
     I**********                              2   70LNRF2                                     CLE148
     I                                        2   7 LNRF2                                     CLE148
     I                                        8  130ZZ0008
     I**********                             14  190CNUM2                                     CSD027
     I                                       14  19 CNUM2                                     CSD027
     I                                       20  23 ETYP2
     I                                    P  24  260EDAT2
     I                                    P  27  330EAMT2
     I                                       34  36 ECCY2
     I                                       37  380ECSS2
     I                                       39  40 DTYP2
     I                                       41  42 DLST2
     I                                       43  45 BRCA2
     I                                    P  46  480OTHD2
     I                                    P  49  550OTHA2
     I                                       56  58 ZZ0056
     I                                    P  59  650BCEQ2
     I                                    P  66  720LCEQ2
     I                                       73  78 ZZ0073
     I                                       79  790NGII2
     I                                    P  80  857INTR2
     I                                       86  870SETP2
     I**********                             88  99 OSACB                                     CGL029
     I                                      100 109 TSEN2
     I                                      110 117 ZZ0110
     I                                      118 1180DEC12
     I                                      119 119 ZZ0119
     I                                      120 139 CRNM2
     I                                      140 149 CTWN2
     I                                      150 157 CASK2
     I                                      158 177 PRNM2
     I                                      178 187 PTWN2
     I                                      188 195 PASK2
     I                                      196 196 INOI2
     I                                      197 197 ZZ0197
     I                                      198 199 CRSK2
     I                                      200 201 CLOC2
     I                                      202 203 REGC2
     I                                      204 217 ZZ0204
     I                                      218 2180PARI2
     I**********                            219 2240CPAR2                                     CSD027
     I                                      219 224 CPAR2                                     CSD027
     I                                      225 256 ZZ225
     I            DS                                                      045634
     I                                        1   30FTYP                  045634
     I                                        4   50FSEQ                  045634
     I                                        1   5 FLNRF                 045634
      *
      *  DS FOR SDNOSTL4                                                  090404
      *                                                                   090404
     I            DS                                                      090404
     I**********                              1  12 OSACNO                             090404 CGL029
     I                                        1  18 OSACNO                                    CGL029
     I                                        1   6 KCUST                 090404
     I**********                              7  10 KACCD                              090404 CGL029
     I**********                             11  120KACSN                              090404 CGL029
     I                                        7  16 KACCD                                     CGL029
     I                                       17  180KACSN                                     CGL029
      *                                                                   090404
     I            DS                                                      CFF007
     I                                        1 228 ZZ228                 CFF007
     I                                        1   60WTNBR                 CFF007
     I                                        7   80WCSLT                 CFF007
     I                                        9  20 WCSLA                 CFF007
      *                                                                   CFF007
     ISPI         DS                             35
     I                                        1  23 SPI1
     I                                       24  35 SPI2
     I*DLSTAT****UDS                            256                       036796
     I***********                            10  110DAYS                  036796
     I***********                            10  11 DYSA                  036796
     IGLSTAT     UDS                            256                       036796
     I**********                             33  340DAYS            036796092853
     I**********                             33  34 DYSA            036796092853
     I                                       31  320DAYS                  092853
     I                                       31  32 DYSA                  092853
     I/COPY WNCPYSRC,GL0554I001
     I              'CcyBasisForNosEvts  'C         SVALKK                                 MD022382A
     ISVAL1       DS                            200                                        MD022382A
     I                                        1   1 SVAL11                                 MD022382A
     I/EJECT
     C*
     C* KLIST FOR SDNOSTL4                                                090404
      *                                                                   090404
     C           NOKEY     KLIST                                          090404
     C                     KFLD           KCUST                           090404
     C                     KFLD           ECCY                            090404
     C                     KFLD           KACCD                           090404
     C                     KFLD           KACSN                           090404
     C*
     C*    F I R S T   C Y C L E
     C*
     C***49*****           GOTO DETAIL                                                        263013
     C***49*****           GOTO PROJEC                                              263013 MD022382A
      *                                                                                    MD022382A
     C           *IN49     IFEQ '1'                                                        MD022382A
      * 'D' - Deal currency                                                                MD022382A
     C           CCYBAS    CABEQ'D'       PROJEC                                           MD022382A
      * 'L' - Local currency                                                               MD022382A
     C           CCYBAS    CABEQ'L'       DETAIL                                           MD022382A
     C                     ENDIF                                                           MD022382A
      *
     C                     SETON                     49
     C                     MOVEACPY@      BIS@   80
      *
     C*
     C** READ BANK DETAILS VIA ACCESS PROGRAM
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBANKPD'DBFILE 10        ************
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     MOVEL@OPTN     DBKEY  29
     C                     EXSR *PSSR
     C                     SETON                     99
     C                     GOTO END
     C                     END
     C***THIS*PROGRAM*CAN*BE*RUN*BY*SECURITIES*TRADING*WITHOUT*DEALING*   036796
     C***IN*THE*SYSTEM,*IN*WHICH*CASE*D/DLSTAT*WILL*NOT*BE*SET.***        036796
     C***********DYSA      COMP '  '                     51               036796
     C***51******          MOVE '99'      DYSA                            036796
     C*                                                                   046872
     C** If days not set to 99, calculate this no of working days fwd     046872
     C*                                                                   046872
     C           PROJEC    TAG                                                                263013
     C           DAYS      IFNE 99                                        046872
     C                     Z-ADDDAYS      ZNRDYS
     C           DAYS      COMP 5                      40
     C   40                Z-ADD5         ZNRDYS
     C**********           MOVE BJRDNB    ZDAYNO                                            MD021048
     C           BJDNWD    SUB  1         ZDAYNO                                            MD021048
     C                     MOVE BJLCCY    ZCCY
     C           *IN49     IFEQ '1'                                                           263013
     C           CCYBAS    ANDEQ'D'                                                        MD022382A
     C                     MOVE ECCY      ZCCY                                                263013
     C                     ENDIF                                                              263013
     C                     MOVE BJSLCD    ZLOC    3
     C                     EXSR ZFWDT
     C*
     C*    IF DAYS IS SET TO 99 ALLOW ALL EVENTS TO END OF BOOK TO        BHF136
     C*    BE PRODUCED                                                    BHF136
     C***********DAYS      IFEQ 99                                 BHF136 046872
     C                     ELSE                                           046872
     C                     MOVE 99999     ZDYNBR                          BHF136
     C                     END                                            BHF136
     C           *IN49     IFEQ '1'                                                           263013
     C           CCYBAS    ANDEQ'D'                                                        MD022382A
     C                     GOTO DETAIL                                                        263013
     C                     ENDIF                                                              263013
      *                                                                                       220952
     C                     CALL 'AOSTRDR0'                                                    220952
     C                     PARM *BLANKS   @RTCD                                               220952
     C                     PARM '*FIRST ' @OPTN                                               220952
     C           SDSTRD    PARM SDSTRD    DSFDY                                               220952
      *                                                                                       220952
     C           @RTCD     IFEQ *BLANKS                                                       220952
     C           BVAPST    IFEQ 'Y'                                                           220952
     C                     MOVE '1'       *IN85                                               220952
     C                     ENDIF                                                              220952
     C                     ENDIF                                                              220952
     C*
     C*    FUTURE DAY NUMBER NOW HELD IN ZDYNBR
      *                                                                   S01473
      ** Check the switchable features file for the Midas Leo Integration S01473
      ** number, S01473. If it is present, set the flag ULEO to 'Y'       S01473
     C                     CALL 'AOSARDR0'                                S01473
     C                     PARM *BLANKS   @RTCD                           S01473
     C                     PARM '*VERIFY' @OPTN                           S01473
     C                     PARM 'S01473'  @KEY    6                       S01473
     C           SCSARD    PARM SCSARD    DSFDY                           S01473
      *                                                                   S01473
     C           @RTCD     IFEQ *BLANKS                                   S01473
     C                     MOVE 'Y'       ULEO    1                       S01473
     C                     END                                            S01473
     C*                                                                   S01496
     C                     CALL 'AOMMODR0'                                CTI001
     C                     PARM '*DBERR ' @RTCD                           CTI001
     C                     PARM '*FIRST ' @OPTN                           CTI001
     C           SDMOD     PARM SDMOD     DSFDY                           CTI001
      *                                                                   CTI001
     C           @RTCD     IFNE *BLANK                                    CTI001
     C                     MOVEL'SDMMODPD'DBFILE            ************* CTI001
     C                     MOVEL'03'      DBASE             * DBERR 03 *  CTI001
     C                     MOVEL@OPTN     DBOPTN            ************* CTI001
     C                     MOVEL@OPTN     DBKEY                           CTI001
     C                     EXSR *PSSR                                     CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      ** Midas/TI interface installed?                                    CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     MOVE 'Y'       ULEO                            CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C**  Access SAR details file to see if S01496 is installed.          S01496
     C*                                                                   S01496
     C                     CALL 'AOSARDR0'                                S01496
     C                     PARM '       ' @RTCD   7                       S01496
     C                     PARM '*VERIFY' @OPTN   7                       S01496
     C                     PARM 'S01496'  WSARD   6                       S01496
     C*                                                                   S01496
     C           @RTCD     IFEQ *BLANK                                    S01496
     C                     MOVE '1'       *IN63                           S01496
     C                     END                                            S01496
     C*                                                                   CSE007
     C**  Access SAR details file to see if CSE007 is installed.          CSE007
     C*                                                                   CSE007
     C                     CALL 'AOSARDR0'                                CSE007
     C                     PARM '       ' @RTCD   7                       CSE007
     C                     PARM '*VERIFY' @OPTN   7                       CSE007
     C                     PARM 'CSE007'  WSARD   6                       CSE007
     C*                                                                   CSE007
     C           @RTCD     IFEQ *BLANK                                    CSE007
     C                     MOVE '1'       *IN53                           CSE007
     C                     END                                            CSE007
     C*                                                                   CEU017
     C**  Access SAR details file to see if CEU017 is installed.          CEU017
     C*                                                                   CEU017
     C                     CALL 'AOSARDR0'                                CEU017
     C                     PARM '       ' @RTCD   7                       CEU017
     C                     PARM '*VERIFY' @OPTN   7                       CEU017
     C                     PARM 'CEU017'  WSARD   6                       CEU017
     C*                                                                   CEU017
     C           @RTCD     IFEQ *BLANK                                    CEU017
     C                     MOVE '1'       *IN53                           CEU017
     C                     END                                            CEU017
      *                                                                   CIR003
      ** Determine if SAR CIR003 is installed                             CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY '@OPTN                           CIR003
     C                     PARM 'CIR003'  WSARD                           CIR003
     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANKS                                   CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'DBFILE                          CIR003
     C                     MOVEL'05'      DBASE                           CIR003
     C                     MOVEL'CIR003'  DBKEY                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     MOVE 'N'       CFF007  1                       CFF007
     C                     CALL 'AOSARDR0'                                CFF007
     C                     PARM *BLANKS   PRTCD   7                       CFF007
     C                     PARM '*VERIFY' POPTN   7                       CFF007
     C                     PARM 'CFF007'  PSARD   6                       CFF007
     C           SCSARD    PARM SCSARD    DSFDY                           CFF007
     C           PRTCD     IFEQ *BLANKS                                   CFF007
     C                     MOVE 'Y'       CFF007                          CFF007
     C                     ELSE                                           CFF007
     C           PRTCD     IFNE '*NRF   '                                 CFF007
     C                     MOVEL'05'      DBASE                           CFF007
     C                     MOVEL'CFF007  'DBKEY                           CFF007
     C                     MOVEL'SCSARDPD'DBFILE                          CFF007
     C                     EXSR *PSSR                                     CFF007
     C                     GOTO END                                       CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Check if enhancement CLE028 is installed                                             CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD                                               CLE028
     C                     PARM '*VERIFY 'POPTN                                               CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'CLE028'  DBKEY                                               CLE028
     C                     MOVEL'07'      DBASE                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C/COPY WNCPYSRC,GL0554C001
     C                     MOVE 'N'       CGL015  1                                           CGL015
     C                     CALL 'AOSARDR0'                                                    CGL015
     C                     PARM *BLANKS   PRTCD   7                                           CGL015
     C                     PARM '*VERIFY' POPTN   7                                           CGL015
     C                     PARM 'CGL015'  PSARD   6                                           CGL015
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL015
     C           PRTCD     IFEQ *BLANKS                                                       CGL015
     C                     MOVE 'Y'       CGL015                                              CGL015
     C                     ELSE                                                               CGL015
     C           PRTCD     IFNE '*NRF   '                                                     CGL015
     C                     MOVEL'07'      DBASE                                               CGL015
     C                     MOVEL'CGL015  'DBKEY                                               CGL015
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL015
     C                     EXSR *PSSR                                                         CGL015
     C                     GOTO END                                                           CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
      *                                                                                       CLE033
      **  Read switchable features file SCSARDPD using access object                          CLE033
      **  to determine if switchable feature (CLE033) is switched ON                          CLE033
     C                     MOVE 'N'       CLE033  1                                           CLE033
      *                                                                                       CLE033
     C                     CALL 'AOSARDR0'                                                    CLE033
     C                     PARM *BLANKS   W0RTCD  7                                           CLE033
     C                     PARM '*VERIFY' W0OPTN  7                                           CLE033
     C                     PARM 'CLE033'  W0SARD  6                                           CLE033
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE033
      *                                                                                       CLE033
      **  If feature is on, set up CLE033 variable                                            CLE033
     C           W0RTCD    IFEQ *BLANKS                                                       CLE033
      *                                                                                       CLE033
     C                     MOVE 'Y'       CLE033                                              CLE033
      *                                                                                       CLE033
     C                     ELSE                                                               CLE033
      *                                                                                       CLE033
      ** else, database error (return code other than *NRF)                                   CLE033
     C           W0RTCD    IFNE '*NRF   '                                                     CLE033
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CLE033
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 27 *                       CLE033
     C                     MOVEL'27'      DBASE            ************                       CLE033
     C                     SETON                     U7U8LR                                   CLE033
     C                     GOTO END                                                           CLE033
     C                     ENDIF                                                              CLE033
      *                                                                                       CLE033
     C                     ENDIF                                                              CLE033
      *                                                                                       CLE033
     C*                                                                                       CGL044
     C**  Access SAR details file to see if CGL044 is installed.                              CGL044
     C*                                                                                       CGL044
     C                     CALL 'AOSARDR0'                                                    CGL044
     C                     PARM '       ' @RTCD   7                                           CGL044
     C                     PARM '*VERIFY' @OPTN   7                                           CGL044
     C                     PARM 'CGL044'  WSARD   6                                           CGL044
     C*                                                                                       CGL044
     C           @RTCD     IFEQ *BLANK                                                        CGL044
     C                     MOVE 'Y'       CGL044  1                                           CGL044
     C                     ELSE                                                               CGL044
     C                     MOVE 'N'       CGL044                                              CGL044
     C                     END                                                                CGL044
      *                                                                                       CAP204
      ** Check if enhancement CAP204 is installed                                             CAP204
      *                                                                                       CAP204
     C                     CALL 'AOSARDR0'                                                    CAP204
     C                     PARM '       ' @RTCD                                               CAP204
     C                     PARM '*VERIFY' @OPTN                                               CAP204
     C                     PARM 'CAP204'  WSARD                                               CAP204
      *                                                                                       CAP204
     C           @RTCD     IFEQ *BLANK                                                        CAP204
     C                     MOVE 'Y'       CAP204  1                                           CAP204
     C                     ELSE                                                               CAP204
     C           PRTCD     IFNE *BLANKS                                                       CAP204
     C           PRTCD     ANDNE'*NRF   '                                                     CAP204
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP204
     C                     MOVEL'CAP204'  DBKEY                                               CAP204
     C                     MOVEL'09'      DBASE                                               CAP204
     C                     EXSR *PSSR                                                         CAP204
     C                     ENDIF                                                              CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                    MD022382A
      ** Check the value of Currency Basis for Nostro Events                               MD022382A
      *                                                                                    MD022382A
     C                     CALL 'AOSVALR0'                                                 MD022382A
     C                     PARM *BLANKS   @RTCD                                            MD022382A
     C                     PARM SVALKK    SVALK1 20                                        MD022382A
     C                     PARM           SVAL1 200                                        MD022382A
     C                     PARM *BLANK    SVALK2 20                                        MD022382A
     C                     PARM           SVAL2 200                                        MD022382A
     C                     PARM *BLANK    SVALK3 20                                        MD022382A
     C                     PARM           SVAL3 200                                        MD022382A
     C                     PARM *BLANK    SVALK4 20                                        MD022382A
     C                     PARM           SVAL4 200                                        MD022382A
     C                     PARM *BLANK    SVALK5 20                                        MD022382A
     C                     PARM           SVAL5 200                                        MD022382A
     C                     PARM *BLANK    SVALK6 20                                        MD022382A
     C                     PARM           SVAL6 200                                        MD022382A
     C                     PARM *BLANK    SVALK7 20                                        MD022382A
     C                     PARM           SVAL7 200                                        MD022382A
     C                     PARM *BLANK    SVALK8 20                                        MD022382A
     C                     PARM           SVAL8 200                                        MD022382A
     C                     PARM *BLANK    SVALK9 20                                        MD022382A
     C                     PARM           SVAL8 200                                        MD022382A
     C                     PARM *BLANK    SVALK9 20                                        MD022382A
     C                     PARM           SVAL9 200                                        MD022382A
     C                     PARM *BLANK    SVALK0 20                                        MD022382A
     C                     PARM           SVAL10200                                        MD022382A
      *                                                                                    MD022382A
     C           @RTCD     IFNE *BLANKS                                                    MD022382A
     C                     MOVEL'SDSVALPD'DBFILE                                           MD022382A
     C                     MOVEL'10'      DBASE                                            MD022382A
     C                     EXSR *PSSR                                                      MD022382A
     C                     ENDIF                                                           MD022382A
     C                     MOVE SVAL11    CCYBAS  1                                        MD022382A
      *                                                                                    MD036589A
      ** Access the Dealing ICD details.                                                   MD036589A
      *                                                                                    MD036589A
     C                     CALL 'AODEALR1'                                                 MD036589A
     C                     PARM *BLANKS   @RTCD   7                                        MD036589A
     C                     PARM '*FIRST ' @OPTN   7                                        MD036589A
     C           SDDEAL    PARM SDDEAL    DSSDY                                            MD036589A
     C           @RTCD     IFNE *BLANKS                                                    MD036589A
     C                     MOVEL'20'      DBASE                                            MD036589A
     C                     MOVEL'SDDEALPD'DBFILE                                           MD036589A
     C                     MOVEL'*FIRST'  DBKEY                                            MD036589A
     C                     EXSR *PSSR                                                      MD036589A
     C                     ENDIF                                                           MD036589A
      *                                                                   S01473
     C           DETAIL    TAG                             ** DETAIL TAG *
     C                     MOVE *BLANKS   ZZ0296                                            MD044815
     C           *IN02     IFEQ '1'
     C                     MOVE SPI1      SPI11
     C                     MOVE SPI2      SPI21
     C                     MOVELOSAC      OSAC1                                              BUG5319
     C                     END
     C           *IN03     IFEQ '1'
     C                     MOVE RECI      RECI1
     C                     MOVE LNNO      DLNO                                                CLE148
     C                     Z-ADDDLNO      DLNO1
     C**********           Z-ADDCNUM      CNUM1                                               CSD027
     C                     MOVE CNUM      CNUM1                                               CSD027
     C                     MOVE DTYP      DTYP1
     C                     MOVE DLST      DLST1
     C                     Z-ADDEDAT      EDAT1
     C                     Z-ADDEAMT      EAMT1
     C                     Z-ADDECSS      ECSS1
     C*******              MOVE OSBR      BRCA1                           138007
     C***********          MOVE EBRC      BRCA1                    138007 154382
     C                     MOVE OSBR      BRCA1                           154382
     C                     Z-ADDOTHD      OTHD1
     C                     Z-ADDOTHA      OTHA1
     C                     Z-ADDBCEQ      BCEQ1
     C                     Z-ADDLCEQ      LCEQ1
     C                     Z-ADDSETP      SETP1
     C                     Z-ADDFFVD      FFVD1
     C                     Z-ADDPARI      PARI1
     C**********           Z-ADDCPAR      CPAR1                                               CSD027
     C                     MOVE CPAR      CPAR1                                               CSD027
     C                     MOVE ETYP      ETYP1
     C                     MOVE ECCY      ECCY1
     C                     MOVE OTHC      OTHC1
     C**********           MOVE OSAC      OSACA                                               CGL029
     C                     MOVELOSAC      OSACA1  2                                           CGL029
     C                     MOVE OSAC      OSACA2 16                                           CGL029
     C                     MOVE TSEN      TSEN1
     C                     MOVE CRNM      CRNM1
     C                     MOVE CTWN      CTWN1
     C                     MOVE CASK      CASK1
     C                     MOVE PRNM      PRNM1
     C                     MOVE PTWN      PTWN1
     C                     MOVE PASK      PASK1
     C                     MOVE INOI      INOI1
     C                     MOVE CLOC      CLOC1
     C                     MOVE REGC      REGC1
     C                     MOVE FFIN      FFIN1
     C                     END
     C*     SETUP CUSTOMER LENDING OUTPUT DATA STRUCTURE
     C           *IN13     IFEQ '1'
     C                     MOVE RECI      RECI2
     C**********           Z-ADDLNRF      LNRF2                                               CLE148
     C                     MOVELLNRF      LNRF2                                               CLE148
     C**********           Z-ADDCNUM      CNUM2                                               CSD027
     C                     MOVE CNUM      CNUM2                                               CSD027
     C                     MOVE ETYP      ETYP2
     C                     Z-ADDEDAT      EDAT2
     C                     Z-ADDEAMT      EAMT2
     C                     MOVE ECCY      ECCY2
     C                     Z-ADDECSS      ECSS2
     C                     MOVE DTYP      DTYP2
     C                     MOVE DLST      DLST2
     C***********          MOVE OSBR      BRCA2                           138007
     C***********          MOVE EBRC      BRCA2                    138007 154382
     C                     MOVE OSBR      BRCA2                           154382
     C                     Z-ADDOTHD      OTHD2
     C                     Z-ADDOTHA      OTHA2
     C                     Z-ADDBCEQ      BCEQ2
     C                     Z-ADDLCEQ      LCEQ2
     C                     MOVE NGII      NGII2
     C                     Z-ADDINTR      INTR2
     C                     Z-ADDSETP      SETP2
     C**********           MOVE OSAC      OSACB                                               CGL029
     C                     MOVELOSAC      OSACB1  2                                           CGL029
     C                     MOVE OSAC      OSACB2 16                                           CGL029
     C                     MOVE TSEN      TSEN2
     C                     Z-ADDDEC1      DEC12
     C                     MOVE CRNM      CRNM2
     C                     MOVE CTWN      CTWN2
     C                     MOVE CASK      CASK2
     C                     MOVE PRNM      PRNM2
     C                     MOVE PTWN      PTWN2
     C                     MOVE PASK      PASK2
     C                     MOVE INOI      INOI2
     C                     MOVE CLOC      CLOC2
     C                     MOVE REGC      REGC2
     C                     Z-ADDPARI      PARI2
     C**********           Z-ADDCPAR      CPAR2                                               CSD027
     C                     MOVE CPAR      CPAR2                                               CSD027
     C                     END
      *                                                                   S01473
      ** If processing Leo records, check for LEO trailer or detail       S01473
      ** has been read                                                    S01473
     C           ULEO      IFEQ 'Y'                                       S01473
      *                                                                   S01473
      ** If a detail record has been read.....                            S01473
     C           *IN15     IFEQ '1'                                       S01473
     C                     MOVE 'Y'       ULDET   1                       S01473
     C                     MOVELOSAC      OSAC1                           S01473
     C                     MOVE OSAC      OSAC2                           S01473
     C***********          MOVE OSBR      BRCA                      S01473138007
     C***********          MOVE EBRC      BRCA                     138007 154382
     C                     MOVE OSBR      BRCA                            154382
     C                     END                                            S01473
      *                                                                   S01473
      ** If a trailer record has been read.....                           S01473
     C           *IN16     IFEQ '1'                                       S01473
     C                     MOVE 'Y'       ULTRL   1                       S01473
     C                     END                                            S01473
      *                                                                   S01473
     C                     END                                            S01473
     C**
     C**   SET UP OUTPUT FIELDS FOR TRADE EVENTS
     C           *IN26     IFEQ '1'
      *                                                                   CGL044
      ** Get the Securities Coupon Rate, Issuer Name and Issuer Town      CGL044
      *  via SD2602 if CGL044 is switched on.                             CGL044
     C           CGL044    IFEQ 'Y'                                       CGL044
     C                     CALL 'SD2602'                                  CGL044
     C                     PARM           SECS                            CGL044
     C                     PARM           CPNR   117                      CGL044
     C                     PARM           CRNM                            CGL044
     C                     PARM           CTWN                            CGL044
     C                     ENDIF                                          CGL044
      *                                                                   CGL044
     C                     MOVE 'E'       NREI
     C                     MOVE ECCY      NEEC
     C                     MOVELTRSA      NENC
     C                     Z-ADDEDAT      NEED
     C                     MOVE CRNM      NERN
     C                     MOVE CTWN      NERT
     C                     MOVE TRTR      NETR
     C                     MOVE ETYP      NECD
     C                     Z-ADDEAMT      NEAM
     C                     MOVE INOI      NEIO
     C*                                                                   S01496
     C           *IN63     IFEQ '1'                                       S01496
     C                     MOVE WEARL     EARL                            S01496
     C                     END                                            S01496
     C*                                                                   S01496
     C           *IN53     IFEQ '1'                                       CSE007
     C                     MOVE WCOAF     COAF                            CSE007
     C                     END                                            CSE007
     C*                                                                   CSE007
     C                     MOVE TRTR      DLNO
      *                                                                   CGL044
     C           CGL044    IFEQ 'Y'                                       CGL044
     C                     MOVE TRTA      BRCA                            CGL044
     C                     ENDIF                                          CGL044
     C*
     C                     MOVE *BLANKS   NESS                            178438
     C                     MOVE *BLANKS   NBRC                            178438
     C*                                                                   178438
     C                     MOVE TRSM      SETP
     C                     MOVE ' '       FFIN
     C                     END
     C**
     C**   SET UP OUTPUT FIELDS FOR CUSTOMER POSITION EVENTS OR DEPOT
     C**   POSITION EVENTS
     C           *IN27     IFEQ '1'
     C*******    *IN85     ANDEQ'1'                                                    220952 223026
     C           *IN28     OREQ '1'
     C*******    *IN85     ANDEQ'1'                                                    220952 223026
      *                                                                   CGL044
      *  Get the Securities Coupon Rate, Issuer Name and Issuer Town      CGL044
      *  via SD2602 if CGL044 is switched on.                             CGL044
     C           CGL044    IFEQ 'Y'                                       CGL044
     C                     CALL 'SD2602'                                  CGL044
     C                     PARM           SECS                            CGL044
     C                     PARM           CPNR                            CGL044
     C                     PARM           CRNM                            CGL044
     C                     PARM           CTWN                            CGL044
     C                     ENDIF                                          CGL044
      *                                                                   CGL044
     C                     MOVE 'E'       NREI
     C                     MOVE ECCY      NEEC
     C                     MOVELCCSA      NENC
     C                     Z-ADDEDAT      NEED
     C                     MOVE CRNM      NERN
     C                     MOVE CTWN      NERT
     C                     MOVE *BLANKS   NETR
     C                     MOVE ETYP      NECD
     C                     Z-ADDEAMT      NEAM
     C                     MOVE INOI      NEIO
     C           *IN63     IFEQ '1'                                       S01496
     C                     MOVE WMDTI     MDTI                            S01496
     C                     MOVE WEARL     EARL                            S01496
     C                     END                                            S01496
     C*                                                                   S01496
     C           *IN53     IFEQ '1'                                       CSE007
     C                     MOVE WCOAF     COAF                            CSE007
     C                     END                                            CSE007
     C*
     C                     MOVE CCSM      SETP
     C*                                                                   178438
     C                     MOVE SECS      NESS                            178438
     C                     MOVE CCBA      NBRC                            178438
     C*                                                                   178438
     C                     MOVE ' '       FFIN
     C                     Z-ADD0         DLNO
      *                                                                   CGL044
     C           CGL044    IFEQ 'Y'                                       CGL044
     C                     MOVE CCTA      BRCA                            CGL044
     C                     ENDIF                                          CGL044
      *                                                                   CGL044
     C                     END
     C*
     C           *IN29     IFEQ '1'
     C                     MOVE ' '       FFIN
     C                     MOVE 00        SETP
     C                     END
      *                                                                   CFF007
      ** CFF007 is on and event is for Futures and Options                CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C           *IN82     ANDEQ*ON                                       CFF007
     C                     MOVE WCSLT     SETP                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C/COPY WNCPYSRC,GL0554C002
     C**
     C*****SECURITIES*TRADING*EVENTS***********************************   E28817
     C************IN17     IFEQ '1'                                       E28817
     C***********          MOVELOSAC      OSAC1                           E28817
     C***********          MOVE OSAC      OSAC2                           E28817
     C***********          MOVE THRE      TSEN                            E28817
     C***********                                                         E28817
     C***********                                                         E28817
     C***********          END                                            E28817
     C*
     C                     SETOF                     414265
     C                     SETOF                     48
     C*****RESTORE*SECURITY*TRADING*RECI*******************************   E28817
     C************IN17     IFEQ '1'                                       E28817
     C***********          MOVE RECIST    RECI                            E28817
     C***********          END                                            E28817
      *
      ** If Leo records are being processed,check if the Leo              S01473
      ** trailer has been read                                            S01473
     C********** ULEO      IFEQ 'Y'                                                  S01473 AR745341
     C********** *IN16     ANDEQ'1'                                                  S01473 AR745341
     C           *IN16     IFEQ '1'                                                         AR745341
     C                     GOTO END                                       S01473
     C                     END                                            S01473
      *                                                                   S01473
     C   12
     COR 14
     COR 38
     C**OR*18                                                             E28817
     COR 83
     COR 04
     COR 01                GOTO END
     C*                                                                   S01221
     C********** CAP204    IFEQ 'Y'                                                  CAP204 AR745341
     C********** *IN61     ANDEQ'1'                                                  CAP204 AR745341
     C           *IN61     IFEQ '1'                                                         AR745341
     C                     GOTO END                                                           CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                     MD036589
      ***If*deal*is*netted,*skip.**************************************           MD036589 MD036589A
      ** Flag netted deals.                                                                MD036589A
      *                                                                                     MD036589
     C                     MOVE '0'       *IN24                                            MD036589A
     C                     MOVE *BLANKS   WNETR  19                                        MD036589A
     C           *IN02     IFEQ '1'                                                         MD036589
     C                     MOVE ETYP      PART                                              MD036589
     C           ETYP      IFEQ '11V1'                                                      MD036589
     C           ETYP      OREQ '11V2'                                                      MD036589
     C           ETYP      OREQ '12V2'                                                      MD036589
     C           ETYP      OREQ '13V2'                                                      MD036589
     C           ETYP      OREQ '14V1'                                                      MD036589
     C           ETYP      OREQ '14V2'                                                      MD036589
     C           DLNO      CHAINDEALS                99                                     MD036589
     C           *IN99     IFEQ '1'                                                         MD036589
     C                     SETON                     U7U8LR                                 MD036589
     C                     MOVEL'DEALS'   DBFILE                                            MD036589
     C                     MOVEL'16'      DBASE                                             MD036589
     C                     MOVELDLNO      DBKEY                                             MD036589
     C                     GOTO END                                                         MD036589
     C                     ELSE                                                             MD036589
     C           RCDC      IFEQ 11                                                          MD036589
     C           NETBR     IFNE *BLANKS                                                     MD036589
     C           PART      ANDEQ'V1'                                                        MD036589
     C           NETSR     ORNE *BLANKS                                                     MD036589
     C           PART      ANDEQ'V2'                                                        MD036589
     C**********           GOTO END                                               MD036589 MD036589A
     C                     MOVE '1'       *IN24                                            MD036589A
     C           NETBR     IFNE *BLANKS                                                    MD036589A
     C           PART      ANDEQ'V1'                                                       MD036589A
     C                     MOVE NETBR     WNETR                                            MD036589A
     C                     ENDIF                                                           MD036589A
     C           NETSR     IFNE *BLANKS                                                    MD036589A
     C           PART      ANDEQ'V2'                                                       MD036589A
     C                     MOVE NETSR     WNETR                                            MD036589A
     C                     ENDIF                                                           MD036589A
     C                     ENDIF                                                            MD036589
     C                     ENDIF                                                            MD036589
     C                     ENDIF                                                            MD036589
     C                     ENDIF                                                            MD036589
     C                     ENDIF                                                            MD036589
      *                                                                                     MD036589
     C**  Skip S.R.M. event types
     C****Do*not*skip*IRS*Event*22S1*and*22S2**********************S01314 030749
     C           ETYP      IFEQ '20S1'                                    S01393
     C           ETYP      OREQ '20S2'                                    S01393
     C********** ETYP      IFEQ '21S1'                                    S01393
     C           ETYP      OREQ '21S1'                                    S01393
     C           ETYP      OREQ '21S2'
     C           ETYP      OREQ '21S3'
     C           ETYP      OREQ '21S4'                                                        208461
     C           ETYP      OREQ '21C1'                                    030749
     C           ETYP      OREQ '21C2'                                    030749
     C           ETYP      OREQ '21C3'                                    030749
     C           ETYP      OREQ '21C4'                                                        208461
     C           ETYP      OREQ '21O1'                                    030749
     C           ETYP      OREQ '21E1'                                    030749
     C***********ETYP      OREQ '22S1'                            S01221  S01314
     C***********ETYP      OREQ '22S2'                            S01221  S01314
     C           ETYP      OREQ '22S1'                                    030749
     C           ETYP      OREQ '22S2'                                    030749
     C           ETYP      OREQ '22S3'                                    S01393
     C           ETYP      OREQ '22S4'                                    S01393
     C           ETYP      OREQ '22C1'                                    030749
     C           ETYP      OREQ '22C2'                                    030749
     C           ETYP      OREQ '22C3'                                                        208461
     C           ETYP      OREQ '22C4'                                                        208461
     C           ETYP      OREQ '22O1'                                    030749
     C           ETYP      OREQ '22E1'                                    030749
     C           ETYP      OREQ '23S1'
     C           ETYP      OREQ '23S2'
     C********** ETYP      OREQ '23S3'                                                208461 BUG5519
     C********** ETYP      OREQ '23S4'                                                208461 BUG5519
     C           ETYP      OREQ '23C1'                                    030749
     C           ETYP      OREQ '23C2'                                    030749
     C********** ETYP      OREQ '23C3'                                                208461 BUG5519
     C********** ETYP      OREQ '23C4'                                                208461 BUG5519
     C           ETYP      OREQ '23O1'                                    030749
     C           ETYP      OREQ '23E1'                                    030749
     C           ETYP      OREQ '24S1'
     C           ETYP      OREQ '24S2'
     C           ETYP      OREQ '24S3'                                                        208461
     C           ETYP      OREQ '24S4'                                                        208461
     C           ETYP      OREQ '24C1'                                    030749
     C           ETYP      OREQ '24C2'                                    030749
     C           ETYP      OREQ '24C3'                                                        208461
     C           ETYP      OREQ '24C4'                                                        208461
     C           ETYP      OREQ '24O1'                                    030749
     C           ETYP      OREQ '24E1'                                    030749
      *                                                                                       168838
      ** Event types for OP deals                                                             168838
      *                                                                                       168838
     C           ETYP      OREQ '12V1'                                                        168838
     C           ETYP      OREQ '12V2'                                                        168838
     C********** ETYP      OREQ '23C3'                                                 CIR003 209676
     C********** ETYP      OREQ '23C4'                                                 CIR003 209676
     C********** ETYP      OREQ '23S3'                                                 CIR003 209676
     C********** ETYP      OREQ '23S4'                                                 CIR003 209676
      *                                                                   CIR003
     C           CIR003    IFEQ *ON                                       CIR003
     C           ETYP      ANDEQ'23C2'                                    CIR003
     C           CIR003    OREQ *ON                                       CIR003
     C           ETYP      ANDEQ'23S2'                                    CIR003
     C                     MOVE *ON       *IN41                           CIR003
     C                     ENDIF                                          CIR003
     C*
     C           CIR003    IFEQ 'Y'                                                         AR743357
     C           DTYP      ANDEQ'RX'                                                        AR743357
      *                                                                                     AR743357
     C           *LIKE     DEFN DLNO      TDLNO                                             AR743357
     C                     Z-ADDDLNO      TDLNO                                             AR743357
     C           TDLNO     CHAINDEALS                05                                     AR743357
     C           *IN05     IFEQ '1'                                                         AR743357
     C                     MOVEL'DEALS   'DBFILE                                            AR743357
     C                     MOVEL'16'      DBASE                                             AR743357
     C                     MOVELDLNO      DBKEY                                             AR743357
     C                     EXSR *PSSR                                                       AR743357
     C                     MOVE '1'       *IN99                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
      *                                                                                     AR743357
     C           ETYP      IFEQ '23S3'                                                      AR743357
     C           ETYP      OREQ '23C3'                                                      AR743357
      *                                                                                     AR743357
     C           VDEI      IFEQ 'Y'                                                         AR743357
     C           EDAT      ANDEQVDAT                                                        AR743357
     C           PDEI      OREQ 'Y'                                                         AR743357
     C           EDAT      ANDNEVDAT                                                        AR743357
     C                     MOVE '0'       *IN41                                             AR743357
     C                     ELSE                                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
      *                                                                                     AR743357
     C                     ELSE                                                             AR743357
      *                                                                                     AR743357
     C           ETYP      IFEQ '23S4'                                                      AR743357
     C           ETYP      OREQ '23C4'                                                      AR743357
      *                                                                                     AR743357
     C           MDEI      IFEQ 'Y'                                                         AR743357
     C           EDAT      ANDEQMDAT                                                        AR743357
     C           PDEI      OREQ 'Y'                                                         AR743357
     C           EDAT      ANDNEMDAT                                                        AR743357
     C                     MOVE '0'       *IN41                                             AR743357
     C                     ELSE                                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
      *                                                                                     AR743357
     C                     ELSE                                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
     C                     ENDIF                                                            AR743357
     C                     ELSE                                                             AR743357
      *                                                                                     AR743357
     C                     GOTO END
     C                     ENDIF                                                            AR743357
     C*
     C                     END
     C/COPY WNCPYSRC,GL0554C005
     C*
     C*  FOR GUARANTEES, PRINCIPAL INCREASE OR PRINCIPAL AT START OR      126735
     C*  MATURITY SHOULD NOT UPDATE PROJECTED NOSTRO BALANCE              126735
     C*                                                                   126735
     C           ETYP      IFEQ '70V1'                     START PRINCIPAL126735
     C           ETYP      OREQ '70M1'                     MATURITY PRINC.126735
     C           ETYP      OREQ '70A1'                     CURRENT PRINCI.126735
     C           ETYP      OREQ '70V3'                     PRINC. INCREASE126735
     C*                                                                   126735
     C                     GOTO END                                       126735
     C*                                                                   126735
     C                     END                                            126735
     C*
     C*    TEST WHETHER EVENT IS TO BE EXTRACTED
     C*
     C                     SETOF                       42
     C*    IF EVENT IS SECURITIES TRADING, INCLUDE UNSETTLED TRADE
     C*    WITH EVENT DATE < RUN DATE
     C*    + ALL PAST-DUE POSITION SETTLEMENT EVENTS                      087177
     C           *IN26     IFEQ '1'
     C           *IN27     OREQ '1'                                       087177
     C           *IN28     OREQ '1'                                       087177
     C           EDAT      COMP ZDYNBR               41
     C                     ELSE
     C           EDAT      COMP ZDYNBR               41
     C  N41      EDAT      COMP BJRDNB                 4141
     C                     END
     C*****DO*NOT REPORT ROLLOVER DEAL IF EVENT IS 'START' (='V1')        CEU003
     C*    DO NOT REPORT ROLLOVER DEAL IF EVENT IS 'START'(='V1' OR 'VX') CEU003
     C                     MOVE ETYP      PART    2
     C           PART      COMP 'V1'                     47
     C  N47      PART      COMP 'VX'                     47               CEU003
     C   47      RLVI      COMP 'Y'                      47
      *                                                                   S01314
     C*****Do*not Process Deal Events with ETPY 'M2'               S01314 CEU003
     C**   Do not Process Deal Events with ETPY 'M2' or 'MY'              CEU003
      *                                                                   138004
     C**   If interest paid seperately indicator not equal to "Y"         138004
      *                                                                   138004
     C           IPSI      IFNE 'Y'                                       138004
      *                                                                   138004
     C           *IN02     IFEQ '1'                                       S01314
     C           PART      ANDEQ'M2'                                      S01314
     C           RLVI      ANDNE'Y'                                                         MD033601
     C           *IN02     OREQ '1'                                       CEU003
     C           PART      ANDEQ'MY'                                      CEU003
     C                     SETON                         41               S01314
     C                     GOTO END                                       S01314
     C                     END                                            S01314
      *                                                                   138004
     C                     END                                            138004
      *                                                                   138004
      **   Allow Deal Events having field 'FIPI' blank to be processed    S01314
     C   47 02
0292 C**********OR 20 02                                                  S01314
     COR 21                SETON                     41
     C*****DO*NOT EXTRACT EVENT FOR FUTURE AND OPTION                     073714
     C***82*****           SETON                     41                   073714
     C*                                                                   073714
     C** ONLY EXTRACT PREMIUM EVENTS FOR FUTURES & OPTIONS MODULE         073714
     C*                                                                   073714
     C   82      ETYP      COMP '93V1'               4141  *              073714
     C*                                                                   073714
     C   41                GOTO END
     C*
     C*    DO NOT EXTRACT BOOK EVENTS
     C   29                SETON                     41
     C   41                GOTO END
     C*
     C*    THIS PART DONE FOR EXTRACTED DEAL EVENTS
     C*
      ** If Leo records are being processed, check if a Leo detail        S01473
      ** record has been read                                             S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           *IN15     ANDEQ'Y'                                       S01473
     C                     GOTO DATE                                      S01473
     C                     END                                            S01473
      *                                                                   S01473
     C   03                GOTO DATE
     C   13                GOTO DATE
     C***17****            GOTO DATE                                      E28817
     C   26                GOTO DATE
     C   27                GOTO DATE
     C   28                GOTO DATE
     C   29                GOTO DATE
     C   82                GOTO DATE                                      073714
      *                                                                                       CAP204
      ** If CAP204 is installed and Detail record is ON                                       CAP204
      **  convert event date to alphanumeric                                                  CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN60     ANDEQ'1'                                                           CAP204
     C                     GOTO DATE                                                          CAP204
     C                     ENDIF                                                              CAP204
     C/COPY WNCPYSRC,GL0554C006
     C           PART      COMP 'M1'                     42
     C   42      ETYP      COMP '18M1'               4242
     C/COPY WNCPYSRC,GL0554C009
     C*                                                                   085626
      ** Check for Event type 18MX                                        CEU003
     C           ETYP      IFNE '18M1'                                    CEU003
     C           *IN42     ANDEQ*OFF                                      CEU003
     C           PART      COMP 'MX'                     42               CEU003
     C   42      ETYP      COMP '18MX'               4242                 CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C** When interest is paid separately, don't add interest to amount   085626
     C*                                                                   085626
     C           IPSI      IFEQ 'Y'                                       085626
     C           RLVI      OREQ 'Y'                                                         MD033601
     C           PART      ANDEQ'M1'                                                        MD033601
     C           *IN02     ANDEQ'1'                                                         MD033601
     C           RBDN      ANDNE0                                                           MD033601
     C***********RLVI      ANDEQ'Y'                                 085626138004
     C   42                Z-ADDEAMT      REPAMT                          085626
     C                     ELSE                                           085626
     C********** PART      IFEQ 'MX'                                137359138007
     C********** ECCY      ANDNEOTHC                                137359138007
     C***42*****           Z-ADDEAMT      REPAMT                    137359138007
     C**********           ELSE                                     137359138007
     C   42      EAMT      ADD  OTHA      REPAMT 130
     C*********            ENDIF                                    137359138007
     C                     END                                            085626
      *                                                                                     MD033601
     C           ETYP      IFEQ '16M2'                                                      MD033601
     C           *IN42     ANDEQ*OFF                                                        MD033601
     C           RLVI      ANDEQ'Y'                                                         MD033601
     C           *IN02     ANDEQ*ON                                                         MD033601
     C                     MOVE *ON       *IN42                                             MD033601
     C                     Z-ADDEAMT      REPAMT                                            MD033601
     C                     ENDIF                                                            MD033601
     C*
     C/COPY WNCPYSRC,GL0554C010
     C*
     C           DATE      TAG                             ** DATE TAG ***
     C*
     C********CUSTOMER*LENDING*COMMITMENT*FEES*EVENT*(SETUP*FIELDS)*******045634
     C***13******ETYP      COMP '71F2'                   48               045634
     C***13*48***          MOVELFTYP      LNRF2                           045634
     C***13*48***          MOVE FSEQ      LNRF2                           045634
     C*                                                                   045634
     C** If this is a customer lending event process according to type    045634
     C*                                                                   045634
     C           *IN13     IFEQ '1'                                       045634
     C           ETYP      ANDEQ'71F2'                                    045634
     C*                                                                   045634
     C* Customer Lending Facility Fees processing                         045634
     C*                                                                   045634
     C                     MOVE *BLANKS   LNRF2                           045634
     C                     MOVE FLNRF     LNRF2                           045634
     C                     END                                            045634
     C*
     C                     MOVE ETYP      ALPH2   2
     C*
     C*    IF EVENT TYPE ENDS IN 'N2'
     C*    EVENT MAY BE OUTPUT TO NOSEX FILE
     C*
     C           ALPH2     IFEQ 'N2'
     C                     MOVEA'1'       *IN,41
     C                     END
     C*
     C*
     C**   TEST WHETHER EVENT RECORD*IS TO BE OUTPUT TO NOSEX FILE
     C/COPY WNCPYSRC,GL0554C007
     C           *IN60     IFEQ '0'                                                        AR1028690
     C           SETP      COMP 01                       65
     C  N65      SETP      COMP 02                       65
     C  N65      SETP      COMP 07                       65
     C  N65      SETP      COMP 08                       65
     C  N65      SETP      COMP 12                       65
     C                     ENDIF                                                           AR1028690
      *                                                                                       CAP204
      ** If nostro code not equal to zero, set on write indicator                             CAP204
      **  for NOSEXAT file                                                                    CAP204
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN60     ANDEQ'1'                                                           CAP204
     C           NOSA      ANDNE'00'                                                          CAP204
     C                     MOVE '1'       *IN65                                               CAP204
     C                     ENDIF                                                              CAP204
     C/COPY WNCPYSRC,GL0554C008
     C*
      * IF ACCOUNT IS NOSTRO - WRITE RECORD (WITH NOSTRO                090404
      * NUMBER ) TO NOSEXED.                                            090404
      *                                                                 090404
      * Exclude Funds Transfers to stop Corruption of currency          132029
     C           *IN37     IFNE '1'                                     132029
      *                                                                 132029
     C           SETP      IFEQ 14                                      090404
     C                     MOVELOSAC      OSACX  100                    090404
     C           OSACX     CHAINACNUM                99                 090404
     C           *IN99     IFEQ '0'                                     090404
     C                     MOVE CNUM      KCUST                         090404
     C                     MOVE CCY       ECCY                          090404
     C                     MOVE ACOD      KACCD                         090404
     C                     MOVE ACSQ      KACSN                         090404
     C           NOKEY     CHAINSDNOSTL4             99                 090404
     C           *IN99     IFEQ '0'                                     090404
     C                     MOVE '1'       *IN65                         090404
     C**********           MOVE *BLANKS   OSAC                                       090404 AR877692
     C**********           MOVELA7NONB    OSAC                                       090404 AR877692
     C                     MOVE *BLANKS   OSAC1                                             AR877692
     C                     MOVELA7NONB    OSAC1                                             AR877692
     C**********           MOVE *BLANKS   OSACB                                        200529 CGL029
     C**********           MOVELA7NONB    OSACB                                        200529 CGL029
     C                     MOVELA7NONB    OSACB1                                              CGL029
     C                     END                                          090404
     C                     END                                          090404
     C                     END                                          090404
     C           SETP      IFEQ 05                                      090404
     C           OSAC      ANDNE*BLANKS                                 090404
     C                     MOVE OSAC      OSACNO                        090404
     C           NOKEY     CHAINSDNOSTL4             99                 090404
     C           *IN99     IFEQ '0'                                     090404
     C                     MOVE '1'       *IN65                         090404
     C*********************MOVE *BLANKS   OSAC                          090404               BUG7963
     C*********************MOVELA7NONB    OSAC                          090404               BUG7963
     C                     MOVE *BLANKS   OSAC1                         090404               BUG7963
     C                     MOVELA7NONB    OSAC1                         090404               BUG7963
     C**********           MOVE *BLANKS   OSACB                                        200529 CGL029
     C**********           MOVELA7NONB    OSACB                                        200529 CGL029
     C                     MOVELA7NONB    OSACB1                                              CGL029
     C                     END                                          090404
     C                     END                                          090404
     C           SETP      IFEQ 09                                                            CLE033
     C           CLE033    ANDEQ'Y'                                                           CLE033
     C           OSAC      ANDNE*BLANKS                                                       CLE033
     C                     MOVE OSAC      OSACNO                                              CLE033
     C           NOKEY     CHAINSDNOSTL4             99                                       CLE033
     C           *IN99     IFEQ '0'                                                           CLE033
     C                     MOVE '1'       *IN65                                               CLE033
     C**********           MOVE *BLANKS   OSAC                                       CLE033 AR877692
     C**********           MOVELA7NONB    OSAC                                       CLE033 AR877692
     C                     MOVE *BLANKS   OSAC1                                             AR877692
     C                     MOVELA7NONB    OSAC1                                             AR877692
     C**********           MOVE *BLANKS   OSACB                                        CLE033 CGL029
     C**********           MOVELA7NONB    OSACB                                        CLE033 CGL029
     C                     MOVE *BLANKS   OSACB1                                              CGL029
     C                     MOVELA7NONB    OSACB1                                              CGL029
     C                     END                                                                CLE033
     C                     END                                                                CLE033
     C                     END                                          132029
      *                                                                   085479
      * Customer Lending events (LVENTEL) with last 2 characters of       085479
      * event type = 'X2' are capitalised interest on customer loans.     085479
      * This should not produce a Nostro event.                           085479
      *                                                                   085479
     C           *IN65     IFEQ '1'                        SELECTED       085479
     C           *IN13     ANDEQ'1'                        LVENTELF       085479
     C           ALPH2     ANDEQ'X2'                       CAP INT        085479
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           *IN65     ANDEQ'1'                                                           CLE028
     C           *IN13     ANDEQ'1'                                                           CLE028
     C           ETYP      ANDEQ'80H1'                                                        CLE028
     C                     SETOF                     65                   085479
     C                     END                                            085479
      *                                                                   085479
      *                                                                                       223572
     C           ALPH2     IFEQ 'I6'                                                          223572
     C           ALPH2     OREQ 'V4'                                                          223572
     C           ALPH2     OREQ 'V6'                                                          223572
     C           ALPH2     OREQ 'M6'                                                          223572
     C           ALPH2     OREQ 'M8'                                                          223572
     C           ALPH2     OREQ 'R6'                                                          223572
     C           ALPH2     OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'63R4'                                                        223572
     C           ALPH2     OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'41R4'                                                        223572
     C                     SETOF                     65                                       223572
     C                     ENDIF                                                              223572
     C*** MAINTAIN  NUMBER AND VALUE OF RECORDS WRITTEN TO NOSEX
     C*
     C**  If deal has been rolled over, event amount is the principal     149024
     C**  plus interest, less the amount rolled over.                     149024
     C                     MOVE *BLANK    WKROLI  1                                         MD033601
     C                     SETOF                     81
     C***02******RLVI      COMP 'Y'                      81               138004
     C   02      RLVI      COMP 'Y'                      81               149024
     C           PART      IFNE 'M2'                                                        MD033601
     C           *IN42     ANDEQ*ON                                                         MD033601
     C           *IN81     ANDEQ*ON                                                         MD033601
     C   42 81   REPAMT    SUB  RBDA      REPAMT
     C                     ENDIF                                                            MD033601
     C*                                                                   085626
     C           *IN42     IFEQ '1'                                       085626
     C           *IN81     ANDEQ'1'                                       085626
     C*                                                                   085626
     C** Save Ingoing / Outgoing Indicator                                085626
     C*                                                                   085626
     C           IPSI      IFEQ 'Y'                                       085626
     C                     MOVE INOI      XINOI   1                       085626
     C                     END                                            085626
     C*                                                                   085626
     C** If amount is negative, then rollover involves a capital          085626
     C** increase so change ingoing to outgoing and vice versa            085626
     C*                                                                   085626
     C           REPAMT    IFLT 0                                         085626
     C                     MULT -1        REPAMT                          085626
     C           INOI      IFEQ 'I'                                       085626
     C                     MOVE 'O'       INOI                            085626
     C                     ELSE                                           085626
     C                     MOVE 'I'       INOI                            085626
     C                     END                                            085626
     C                     MOVE 'Y'       WKROLI  1                                         MD033601
     C                     MOVE RBDN      DLNO                                              MD033601
     C                     Z-ADD0         RBDN                                              MD033601
     C                     Z-ADD0         RBDA                                              MD033601
     C                     Z-ADD0         OTHD                                              MD033601
     C                     Z-ADD0         OTHA                                              MD033601
     C           PART      IFEQ 'M1'                                                        MD033601
     C                     MOVE 'V1'      ETYP                                              MD033601
     C                     ENDIF                                                            MD033601
     C                     END                                            085626
     C                     END                                            085626
     C*                                                                   S01392
     C* IF FRONT-UP INTEREST = Y                                          S01392
     C*                                                                   S01392
     C   02      FUID      IFEQ 'Y'                                       S01392
     C*                                                                   S01392
     C* INCLUDE INTEREST ON VALUE DATE EVENT                              S01392
     C*                                                                   S01392
     C           ETYP      IFEQ '15V1'                                    S01392
     C           ETYP      OREQ '16V1'                                    S01392
     C           ETYP      OREQ '15VX'                                    CEU003
     C           ETYP      OREQ '16VX'                                    CEU003
     C           EAMT      SUB  OTHA      REPAMT                          S01392
     C                     MOVE '1'       *IN42                           S01392
     C                     END                                            S01392
     C*                                                                   S01392
     C* IF MATURITY DATE EVENT WITH ROLLOVER, ACCESS ROLLOVER DEAL        S01392
     C* FOR NET SETTLEMENT AMOUNT (FRONT-UP INTEREST ON THAT DEAL)        S01392
     C*                                                                   S01392
     C           ETYP      IFEQ '15M1'                                    S01392
     C           ETYP      OREQ '16M1'                                    S01392
     C           ETYP      OREQ '15MX'                                    CEU003
     C           ETYP      OREQ '16MX'                                    CEU003
     C           RLVI      IFEQ 'Y'                                       S01392
     C           RBDN      CHAINDRSDEALS             99    *              S01392
     C           *IN99     IFEQ '1'                                       S01392
     C                     SETON                     U7U8LR               S01392
     C                     MOVEL'DRSDEALS'DBFILE                          S01392
     C                     MOVEL'04'      DBASE                           S01392
     C                     MOVELRBDN      DBKEY                           S01392
     C                     GOTO END                                       S01392
     C                     END                                            S01392
     C                     Z-ADDTOTI      REPAMT                          S01392
     C                     MOVE '1'       *IN42                           S01392
     C                     END                                            S01392
     C                     END                                            S01392
     C                     END                                            S01392
     C** SHOW REPAYMENT AMOUNT ON THE EXTRACT IF DEAL ROLLED OVER.
     C*******
     C           *IN37     IFEQ '1'                        ## B0
     C                     MOVE 'F'       RECI             'FOR OUTPUT
     C**********           MOVE OSBR      BRCA                      064882138007
     C***********          MOVE EBRC      BRCA                     138007 154382
     C                     MOVE OSBR      BRCA                            154382
     C*
     C*
     C                     SETOF                     65
     C           STNI      IFEQ 'Y'                        ## B002
     C                     SETON                     65    'OUTPUT
     C                     END                             ## E002
     C*
     C                     END                             ## E001
     C*                                                                   073714
     C*  FUTURES & OPTIONS NOSTRO EVENTS                                  073714
     C*                                                                   073714
     C           *IN82     IFEQ '1'                        ## B0          073714
     C                     MOVE 'O'       RECI             'FOR OUTPUT    073714
     C*********            MOVELOSBR      BRCA                      098711138007
     C***********          MOVELEBRC      BRCA                     138007 154382
     C                     MOVELOSBR      BRCA                            154382
      *                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
      *                                                                   CFF007
      ** Retreive customer report town and report name                    CFF007
     C                     MOVE CNUM      PCNUM                           CFF007
     C                     CALL 'AOCUSTR0'                                CFF007
     C                     PARM *BLANKS   PRTCD                           CFF007
     C                     PARM '*KEY   ' POPTN                           CFF007
     C                     PARM           PCNUM   6                       CFF007
     C                     PARM           PSTAT   7                       CFF007
     C           SDCUST    PARM SDCUST    DSSDY                           CFF007
     C           PRTCD     IFNE *BLANKS                                   CFF007
     C                     MOVEL'06'      DBASE                           CFF007
     C                     MOVEL'SDCUSTPD'DBFILE                          CFF007
     C                     MOVELPCNUM     DBKEY                           CFF007
     C                     EXSR *PSSR                                     CFF007
     C                     GOTO END                                       CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     MOVE BBCRNM    CRNM                            CFF007
     C                     MOVE BBCRTN    CTWN                            CFF007
     C                     MOVE WCSLT     SETP                            CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C/COPY WNCPYSRC,GL0554C003
     C                     END                             ## E001        073714
     C*                                                                   CEU003
     C**  If transaction is settled in another currency exclude events    CEU003
     C**  from report                                                     CEU003
     C*                                                                   CEU003
     C***********SIAC      IFEQ 'Y'                                 CEU003138004
     C***********          MOVE '0'       *IN65                     CUE003138004
     C***********          ENDIF                                    CUE003138004
     C           SIAC      IFEQ 'Y'                                       138004
     C           *IN02     ANDEQ'1'                                       177912
     C           EAMT      OREQ 0                                         181612
     C           OTHA      ANDEQ0                                                           MD040629
     C                     MOVE '0'       *IN65                           138004
     C                     ENDIF                                          138004
      *                                                                                    MD036589A
      ** If netting event, update so it will settle on netting ICD.                        MD036589A
      *                                                                                    MD036589A
     C           *IN24     IFEQ '1'                                                        MD036589A
      *                                                                                    MD036589A
      ** Get the netting ICD account.                                                      MD036589A
      *                                                                                    MD036589A
     C                     EXSR SRNET                                                      MD036589A
      *                                                                                    MD036589A
      ** Update PF/NOSEXED fields.                                                         MD036589A
      *                                                                                    MD036589A
     C           NETNOS    IFNE *BLANKS                                                    MD036589A
     C                     MOVE A8BICN    CNUM                                             MD036589A
     C                     MOVE AMBRCA    OSBR                                             MD036589A
     C                     MOVE '08'      SETP                                             MD036589A
     C                     MOVE NETNOS    OSAC1                                            MD036589A
     C                     MOVE *BLANKS   OSACQQ                                           MD036589A
     C                     MOVE BBPCNB    CPAR                                             MD036589A
     C           BBPAIN    IFEQ 'P'                                                        MD036589A
     C                     Z-ADD1         PARI                                             MD036589A
     C                     ELSE                                                            MD036589A
     C                     Z-ADD0         PARI                                             MD036589A
     C                     ENDIF                                                           MD036589A
     C                     MOVE BBCRNM    CRNM                                             MD036589A
     C                     MOVE BBCRTN    CTWN                                             MD036589A
     C                     MOVE BBCASC    CASK                                             MD036589A
     C                     MOVE BBCNCZ    CCTZ                                             MD036589A
     C                     MOVE BBCOLC    CLOC                                             MD036589A
     C                     CALL 'AOCTRYR0'                                                 MD036589A
     C                     PARM '*MSG   ' @RTCD                                            MD036589A
     C                     PARM '*KEY   ' @OPTN                                            MD036589A
     C                     PARM BBCNCZ    @CCTZ   2                                        MD036589A
     C           SDCTRY    PARM SDCTRY    DSFDY                                            MD036589A
     C           @RTCD     IFNE *BLANK                                                     MD036589A
     C                     MOVEL'19'      DBASE                                            MD036589A
     C                     MOVEL'SDCTRYPD'DBFILE                                           MD036589A
     C                     MOVELBBCNCZ    DBKEY                                            MD036589A
     C                     EXSR *PSSR                                                      MD036589A
     C                     ELSE                                                            MD036589A
     C                     MOVE A4RGCD    REGC                                             MD036589A
     C                     ENDIF                                                           MD036589A
      *                                                                                    MD036589A
     C                     MOVE *BLANKS   PRNM                                             MD036589A
     C                     MOVE *BLANKS   PTWN                                             MD036589A
     C                     MOVE *BLANKS   PASK                                             MD036589A
     C           BBPCNB    IFNE *BLANKS                                                    MD036589A
     C                     MOVE BBPCNB    PCNUM                                            MD036589A
     C                     CALL 'AOCUSTR0'                                                 MD036589A
     C                     PARM *BLANKS   PRTCD                                            MD036589A
     C                     PARM '*KEY   ' POPTN                                            MD036589A
     C                     PARM           PCNUM                                            MD036589A
     C                     PARM           PSTAT                                            MD036589A
     C           SDCUST    PARM SDCUST    DSSDY                                            MD036589A
     C           PRTCD     IFNE *BLANKS                                                    MD036589A
     C                     MOVEL'06'      DBASE                                            MD036589A
     C                     MOVEL'SDCUSTPD'DBFILE                                           MD036589A
     C                     MOVELPCNUM     DBKEY                                            MD036589A
     C                     EXSR *PSSR                                                      MD036589A
     C                     ELSE                                                            MD036589A
     C                     MOVE BBCRNM    PRNM                                             MD036589A
     C                     MOVE BBCRTN    PTWN                                             MD036589A
     C                     MOVE BBCASC    PASK                                             MD036589A
     C                     ENDIF                                                           MD036589A
     C                     ENDIF                                                           MD036589A
     C                     MOVELWNETR     ZZ0296                                            MD044815
      ** Switch on *IN65 to ensure writing to file.                                        MD036589A
     C                     MOVE '1'       *IN65                                            MD036589A
     C                     ENDIF                                                           MD036589A
     C                     ENDIF                                                           MD036589A
     C*
     C  N65                GOTO END
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           *IN02     IFEQ '1'                                                           CGL015
     C           *IN42     IFEQ '1'                                                           CGL015
     C           REPAMT    SUB  ETAX      REPAMT                                              CGL015
     C                     ELSE                                                               CGL015
     C           EAMT      SUB  ETAX      REPAMT                                              CGL015
     C                     MOVE '1'       *IN42                                               CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN60     ANDEQ'1'                                                           CAP204
     C           NOSA      ANDNE'00'                                                          CAP204
     C                     MOVEL'R'       RECI                                                CAP204
     C                     MOVELEBRC      BRCA                                                CAP204
     C                     ENDIF                                                              CAP204
     C/COPY WNCPYSRC,GL0554C004
     C                     SETON                     34
     C           RECRIT    ADD  1         RECRIT  50
     C                     Z-ADD1         X       10
     C                     EXSR HASH
     C***********          GOTO END                                       138004
     C                     GOTO END                                       138004
     C*                                                                   085626
     C** If interest is paid separately, then need a separate record      085626
     C** for the interest. Event amount is the other amount,              085626
     C** event type is 'xxI2' and ingoing / outgoing ind. is as per       085626
     C** the original event.                                              085626
     C*                                                                   085626
     C           IPSI      IFEQ 'Y'                                       085626
     C***********RLVI      ANDEQ'Y'                                 085626138004
     C           RLVI      ANDEQ'Y'                                       186084
     C           RECRIT    ADD  1         RECRIT  50                      085626
     C                     Z-ADD1         X       10                      085626
     C                     MOVE INOI      SINOI   1                       085626
     C                     Z-ADDREPAMT    SAMT   130                      085626
     C                     MOVE ETYP      SETYP   4                       085626
     C***********          MOVE XINOI     INOI                      085626138004
     C                     Z-ADDOTHA      REPAMT                          085626
     C*                                                                   CEU003
     C* Event type should be 'xxIY' if processing one of the new events   CEU003
     C                     MOVE ETYP      WSETP1  1                       CEU003
     C           WSETP1    IFEQ 'X'                                       CEU003
     C           WSETP1    OREQ 'Y'                                       CEU003
     C           WSETP1    OREQ 'Z'                                       CEU003
     C                     MOVE 'IY'      ETYP                            CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'I2'      ETYP                            085626
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     EXSR HASH                                      085626
     C                     EXCPTRIPDS                                     085626
     C                     MOVE SINOI     INOI                            085626
     C                     Z-ADDSAMT      REPAMT                          085626
     C                     MOVE SETYP     ETYP                            085626
     C                     END                                            085626
     C*
     C/EJECT
     C           END       TAG                             ** END TAG **
     C**
     C*
     C*
     C*    T O T A L   T I M E   C A L C U L A T I O N S
     C*
     C*
     C***DO*NOT*UPDATE*D/DLSTAT*WITH*VALUE*'99'*IF*IT*WAS*NOT*SET*BEFORE.*036796
     C*LR*51******         MOVE '  '      DYSA                            036796
      *
     C*                                                                   E306
     C* READ THE BANK DETAILS FILE (WHEN RUN ON EMPTY FILES)              E306
     C*                                                                   E306
     CLRN49                CALL 'AOBANKR0'                                E306
     C                     PARM '*MSG    '@RTCD   7                       E306
     C                     PARM '*FIRST  '@OPTN   7                       E306
     C           SDBANK    PARM SDBANK    DSFDY                           E306
     C*                                                                   E306
     CLRN49      @RTCD     IFNE *BLANK                                    E306
     CLRN49                MOVEL'SDBANKPD'DBFILE 10        *************  E306
     CLRN49                MOVEL'02'      DBASE   2        * DBERR 02  *  E306
     CLRN49                MOVEL@OPTN     DBOPTN  7        *************  E306
     CLRN49                MOVEL@OPTN     DBKEY  29                       E306
     CLRN49                EXSR *PSSR                                     E306
     CLR                   END                                            E306
     C*                                                                   E321
     C** INCLUDE HEADER AND TRAILER RECORDS IN COUNT                      E321
     C*                                                                   E321
     CLR         RECRIT    ADD  2         RECRIT                          E321
     C*
     C**
     C*****************************************************************                    MD036589A
     C*                                                                                    MD036589A
     C           SRNET     BEGSR                                                           MD036589A
      *                                                                                    MD036589A
     C                     MOVE *BLANKS   NETNOS  2                                        MD036589A
      *                                                                                    MD036589A
      ** Check netting record to get the branch.                                           MD036589A
      *                                                                                    MD036589A
     C           WNETR     CHAINFXNETML3             54                                    MD036589A
     C           *IN54     IFEQ '1'                                                        MD036589A
     C                     SETON                     U7U8LR                                MD036589A
     C                     MOVEL'FXNETML3'DBFILE                                           MD036589A
     C                     MOVEL'17'      DBASE                                            MD036589A
     C                     MOVELWNETR     DBKEY                                            MD036589A
     C                     EXSR *PSSR                                                      MD036589A
     C                     ENDIF                                                           MD036589A
      *                                                                                    MD036589A
      ** Get customer details of branch.                                                   MD036589A
      *                                                                                    MD036589A
     C                     CALL 'AOBRCHR1'                                                 MD036589A
     C                     PARM *BLANK    @RTCD   7                                        MD036589A
     C                     PARM '*KEY'    @OPTN   7                                        MD036589A
     C                     PARM AMBRCA    BRCHD   3                                        MD036589A
     C           SDBRCH    PARM SDBRCH    DSSDY                                            MD036589A
     C           @RTCD     IFNE *BLANK                                                     MD036589A
     C                     SETON                     U7U8LR                                MD036589A
     C                     MOVEL'SDBRCHPD'DBFILE                                           MD036589A
     C                     MOVEL'18'      DBASE                                            MD036589A
     C                     MOVELAMBRCA    DBKEY                                            MD036589A
     C                     EXSR *PSSR                                                      MD036589A
     C                     ELSE                                                            MD036589A
      ** For the last step, get customer details.                                          MD036589A
     C                     MOVE A8BICN    PCNUM                                            MD036589A
     C                     CALL 'AOCUSTR0'                                                 MD036589A
     C                     PARM *BLANKS   PRTCD                                            MD036589A
     C                     PARM '*KEY   ' POPTN                                            MD036589A
     C                     PARM           PCNUM                                            MD036589A
     C                     PARM           PSTAT                                            MD036589A
     C           SDCUST    PARM SDCUST    DSSDY                                            MD036589A
     C           PRTCD     IFNE *BLANKS                                                    MD036589A
     C                     MOVEL'06'      DBASE                                            MD036589A
     C                     MOVEL'SDCUSTPD'DBFILE                                           MD036589A
     C                     MOVELPCNUM     DBKEY                                            MD036589A
     C                     EXSR *PSSR                                                      MD036589A
     C                     ENDIF                                                           MD036589A
     C                     ENDIF                                                           MD036589A
      *                                                                                    MD036589A
      ** If everything OK, then get nostro details.                                        MD036589A
      *                                                                                    MD036589A
     C                     MOVE BBCUST    KCUST                                            MD036589A
     C                     MOVE AMCCYD    ECCY                                             MD036589A
     C                     MOVE BNNEAC    KACCD                                            MD036589A
     C                     MOVE '01'      KACSN                                            MD036589A
     C           NOKEY     CHAINSDNOSTL4             99                                    MD036589A
     C           *IN99     IFEQ '0'                                                        MD036589A
     C                     MOVE A7NONB    NETNOS                                           MD036589A
     C                     ENDIF                                                           MD036589A
      *                                                                                    MD036589A
     C                     ENDSR                                                           MD036589A
      *                                                                                    MD036589A
     C*******************************************************************
     C*
     C           HASH      BEGSR
     C                     Z-ADDINT,X     ZZTOTI
     C                     Z-ADDDEC,X     ZZTOTD
     C  N42      EAMT      DIV  1000      ZZAMT        36
     C   42      REPAMT    DIV  1000      ZZAMT        36
     C   36                Z-SUBZZAMT     ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    INT,X
     C                     Z-ADDZZTOTD    DEC,X
      *
      ** Clear previous accumulater values.
     C                     Z-ADD0         ZZTOTI
     C                     Z-ADD0         ZZTOTD
      *
     C                     ENDSR
     C**
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     CSR         GLZADD    BEGSR                           *** GLZADD ****
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C********************************************************************
      /COPY ZSRSRC,ZFWDT
     C********************************************************************
      /COPY ZSRSRC,ZACCH
     C********************************************************************
     C*
     C           *PSSR     BEGSR
     C*
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     END
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     O*
     O**   NOSTRO EVENTS EXTRACT FILE
     O*
     ONOSEXEC D        01
     O                                    1 'A'
     ONOSEXED D        02 65
     O                         LOT1     256
     O                         LOT2     320
     O                         OSAC2    336                                                   CGL029
     O                       42REPAMT    27P
     O                         CLAS     340                                                   CDL038
     ONOSEXED E        02 65   RIPDS                                      085626
     O                         LOT1     256                               085626
     O                         LOT2     320                               085626
     O                         OSAC2    336                                                   CGL029
     O                       42REPAMT    27P                              085626
     O                         CLAS     340                                                   CDL038
     ONOSEXCC D        03 65
     O                         LOT3     256
     O                         OSACA1    89                                                   CGL029
     O                         OSACA2   336                                                   CGL029
     O                         CLAS     340                                                   CLE042
     ONOSEXEL D        13 65
     O                         LOT4     256
     O                         OSACB1    89                                                   CGL029
     O                         OSACB2   336                                                   CGL029
     O                         CLAS     340                                                   CLE042
     ONSXBCEDFDADD     15 65                                              S01473
     O                         *ALL                                       S01473
     O**NOSEXESFDADD   17 65                                              E28817
     O*NOSEXESFDADD****    65                                      E28817 E33033
     O***********              *ALL                                       E33033
     ONOSEXSEFDADD     26 65
     O*******OR*       27 65                                                                  220952
     O*******OR*       28 65                                                                  220952
     O*******OR        27 65 85                                                        220952 223026
     O*******OR        28 65 85                                                        220952 223026
     O       OR        27 65                                                                  223026
     O       OR        28 65                                                                  223026
     O                         *ALL
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0554OOP1                                           S01408
     O*                                                                   S01408
     ONOSEXFPFDADD     37 65
     O                         *ALL
     ONOSEXFFFDADD     82 65                                              073714
     O                         *ALL                                       073714
     ONOSEXATFDADD     60 65                                                                  CAP204
     O                         *ALL                                                           CAP204
     O/COPY WNCPYSRC,GL0554O001
     ONOSEXZZ T        LR
     O                                    1 'T'
     O                         RECRIT     6
     O                         INT,1     14P
     O                         DEC,1     16P
     O*
     O*DL0554AUT**203***LR***************                                 E22608
     O***********************************24 'REFERENCE DL0554AU'          E22608
     OGL0554AUT  203   LR                                                 E22608
     O                                   24 'REFERENCE GL0554AU'          E22608
     O                         BJURPT    89
     O                                  104 'DATE'
     O                         BJMRDT   112
     O                                  122 'PAGE'
     O                         PAGE1 Z  127
     O        T  1     LR
     O                                   75 'NOSTROS EVENTS EXTRACT'
     O        T  2     LR
     O                                   75 '----------------------'
     O        T  210   LR   NU7
     O                                   30 'NOSTRO EVENTS EXTRACT '
     O                                   45 'RECORDS CREATED'
     O                         RECRIT3   59
     O                         INT,1 Z   81
     O                         DEC,1     84
     O        T 2      LRN34N99
     O                                   62 '***   NO DETAILS TO'
     O                                   75 'REPORT   ***'
     O        T 22     LR U7
     O                                   62 'PRINT TERMINATED, '
     O                                   80 'DATABASE IN ERROR'
     O        T 2      LR U7
     O                                   57 'DATABASE ERROR'
     O                         DBASE     61
     O                                   67 'FILE'
     O                         DBFILE    78
     O        T 13     LR U7
     O                                   46 'KEY'
     O                         DBKEY     76
     O*****   T 2      LR                                                 LN0135
     O*****                              65 '***   END OF REPORT'         LN0135
     O*****                              71 '***'                         LN0135
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
