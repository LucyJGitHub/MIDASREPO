0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Events by Currency with Running Total Consolidated')   *
0002 F*****************************************************************
0003 F*                                                               *
0004 F*  Midas - Dealing Module                                       *
0005 F*                                                               *
0006 F*  GL0557 - Events by Currency with Running Total Consolidated  *
0007 F*                                                               *
      *     Note: Any changes to GL0550 should be considered for      *
      *           this program.                                       *
      *                                                               *
      *  (c) Finastra International Limited 2021                      *
      *                                                               *
      *  Last Amend No. MD059528           Date 02Feb21               *
      *  Prev Amend No. CGL091  *CRATE     Date 02Nov21
0010 F*                                                               *
0012 F*---------------------------------------------------------------*
      *                                                               *
      *  MD059528 - Issues on GL0557 Report.                          *
      *             Incorrect daily Principal Total (selected deals)  *
      *  CGL091 - EVENTS BY CURRENCY WITH RUNNING TOTALS REPORT       *
0011 F*                                                               *
0012 F*****************************************************************
0013 F*EVNTM   IP  E           K        DISK                              E19293
0013 F***EVNTM1**IP  E           K        DISK                     E19293 CEU011
      *                                                                   CEU011
     FDLEVNIL1IP  E           K        DISK                               CEU011
      *                                                                   CEU011
      ** Midas Merged Events File                                         CEU011
      *                                                                   CEU011
     FTREVEA  IF  E                    DISK                               S01129
     FCPEVEA  IF  E                    DISK                               S01129
     FDPEVEA  IF  E                    DISK                               S01129
     FBPEVEA  IF  E                    DISK                               S01129
     FCLOAN   IF  E           K        DISK                           UC  CLE004
     F            CLOANHHF                          KIGNORE               CLE004
     F            CLOANCKF                          KIGNORE               CLE004
     F            CLOANZ1F                          KIGNORE               CLE004
      *                                                                                       CGL091
     FINTYP   IF  E           K        DISK                                                   CGL091
     FDLDTSCL5IF  E           K        DISK                                                   CGL091
     FDLDLDGDEIF  E           K        DISK                                                   CGL091
     F            DEALSDGF                          KRENAMEDEALSDGE                           CGL091
      *                                                                                       CGL091
     F/COPY WNCPYSRC,GL0557F001
     FDRSDEALSIF  F    1074  6AI     2 DISK                               S01392
     FDEALS   IF  E           K        DISK                                                 AR743357
     F            DEALSDAF                          KIGNORE                                 AR743357
     F            DEALSDBF                          KIGNORE                                 AR743357
     F            DEALSDCF                          KIGNORE                                 AR743357
     F            DEALSDDF                          KIGNORE                                 AR743357
     F            DEALSDEF                          KIGNORE                                 AR743357
     F            DEALSDFF                          KIGNORE                                 AR743357
0015 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
0016 F*NOSEXEC*O***F*****320************DISK                              E193
0016 F*NOSEXED*O***F*****320************DISK                              E193
0016 F*NOSEXCC*O***F*****320************DISK                              E193
     F*NOSEXEL*O***F*****320************DISK                              E193
     F*****NSXBCED O   E                    DISK                      A   S01196
     F************BVNTXEDF                          KRENAMENSXBCEDF       S01196
     F*                                                                   E193
     F*NOSEXSE*O***E********************DISK                      A S01129E193
     F*NOSEXFP*O***E********************DISK                      A S03220E193
0016 F*NOSEXZZ*O***F*****320************DISK                              E193
0017 F*PRINT  O   F     132     OF     PRINTER                            S01124
0017 F*L0550P1O***F*****132     OF     PRINTER                      S01124S01117
0017 F*DL0550AUO***F*****132     OV     PRINTER      KINFDS SPOOLU  S01117E22608
0017 F***GL0550AUO   F     132     OV     PRINTER      KINFDS SPOOLU                   E22608 CGL091
     FGL0557AUO   F     132     OV     PRINTER      KINFDS SPOOLU                             CGL091
0017 F****DL0550P1O***F****132     OF     PRINTER      KINFDS SPOOL       E102
0017 F*DL0550P1O   F     132     OF     PRINTER                     S01124E22608
0017 F***GL0550P1O***F     132     OF     PRINTER                   E22608RT0106
0017 F***GL0550P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC            RT0106 CGL091
     F***GL0550P2O   E             79     PRINTER      KINFDS SPOOL2     UC            CLE004 CGL091
     FGL0557P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC                      CGL091
     FGL0557P2O   E             79     PRINTER      KINFDS SPOOL2     UC                      CGL091
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS
0019 F* 01            EVENT HEADER
0413 F* 02            EVENT DETAIL - DEAL EVENT
0021 F* 03            EVENT DETAIL - COMMERCIAL LOAN EVENT
0022 F* 04            EVENT TRAILER
0024 F**06************TABLE*ICR*1********                                 S01194
0025 F**07************TABLE*HOLIDAYS*****                                 S01194
0026 F**08************TABLE*CURRENCIES***                                 S01194
0027 F**09************TABLE*ICR*2********                                 S01194
0028 F**10************TABLE*CATCHALL*****                                 S01194
     F*       11      NEGATIVE INTEREST INDICATOR
0021 F* 12            EVENT TRAILER - COMMERCIAL LOAN EVENT
     F* 13            CUSTOMER LENDING EVENT
     F* 14            CUSTOMER LENDING EVENTS FILE TRAILER
     F**15************LETTERS OF CREDIT EVENT DETAIL                      S01196
     F**16************LETTERS OF CREDIT EVENT TRAILER                     S01196
     F* 15            LETTERS OF CREDIT EVENT DETAIL                      S01473
     F* 16            LETTERS OF CREDIT EVENT TRAILER                     S01473
     F**17******      SECURITIES TRADING EVENT DETAIL                     E20669
     F**18******      SECURITIES TRADING EVENT TRAILER                    E20669
     F*    19         END OF FILE ON EVENTS TRAILERS                      S01129
0029 F*    20         FULL INSTRUCTIONS PRESENT INDICATOR IS BLANK - DEAL
0030 F*    21         INCOMING/OUTGOING INDICATOR IS BLANK
0031 F*    22         OTHER DATE IS ZERO
0032 F*    23         INTEREST/EXCHANGE RATE IS ZERO
0032 F*    24         DEALING TRAILER HAS BEEN READ
     F*    25         REPORTING SECURITY SHORTNAME FOR COUPON/MATURITY
     F*    26         TRADE EVENTS DETAIL HAS BEEN READ                   S01129
     F*    27         CUSTOMER POSITION EVENTS DETAIL HAS BEEN READ       S01129
     F*    28         DEPOT POSITION EVENTS DETAIL HAS BEEN READ          S01129
     F*****29**       BOOK POSITION EVENTS DETAIL HAS BEEN READ    S01129 E20669
      *    29         EMU Position/Risk Enquiries & Reports               CEU011
      *                   feature indicator                               CEU011
0033 F*       30      CURRENCY HAS 0 D.P.
0034 F*       31      CURRENCY HAS 1 D.P.
0035 F*       32      CURRENCY HAS 2 D.P.
0036 F*       33      CURRENCY HAS 3 D.P.
0037 F*      N34      NO DETAILS TO REPORT
0038 F********35******PRINT*DEALT*BASE*CCY*RATE*FOR*FX*EVENTS*-*DEALS*****090909
0039 F*       36      NEGATIVE AMOUNT IN HASH TOTALLING
     F* 37            FUNDS TRANSFER EVENT DETAIL                         S03220
     F* 38            FUNDS TRANSFER EVENT TRAILER                        S03220
0040 F********39******WHOLE BOOK TO BE REPORTED                           S01243
      *    39         'In' ccy indicator                                  CEU011
0041 F********40******NUMBER OF DAYS ENTERED BY OPERATOR IS LESS THAN 5   S01243
     F*       40      NUMBER OF DAYS IS LESS THAN 5                       S01243
0042 F*      N41      EVENT IS TO BE REPORTED
0043 F*       42      EVENT CODE ENDS WITH 'M1' DEAL EVENT ONLY
0044 F*       43      OUTPUT NEW CURRENCY HEADINGS
     F*       48      COMMITMENT FEE EVENT
     F*       49      FIRST CYCLE INDICATOR
     F********51******DAYS FORWARD HAS NOT BEEN SET                       036796
     F******************(CAN OCCUR IF ST. BUT NOT DL. IS IN THE SYSTEM.)  036796
0045 F**   NARRATIVES FOR EVENT TYPES
0046 F********50******VALUE DATE
0047 F********51******OPTION MATURITY
0048 F********52******START DATE
     F*       52      CA event narrative to be printed                    CSE007
0049 F********53******INT. DUE DATE
     F*       53      CSE007 present                                      CSE007
     F*       53      or CEU017 present                                   CEU017
     F*       54      Generated Entries Event Detail                                          CAP204
     F*       55      Generated Entries Event Trailer                                         CAP204
0050 F********54******MATURITY DATE
0051 F********55******PURCHASE DATE
0052 F********56******SALE DATE
0053 F********57******INCREASE
0054 F********58******DECREASE
0055 F*       60      INCOMING/OUTGOING INDICATOR EQUALS 'I'              S01186
0056 F*       61          '       '         '        '   'O'              S01186
     F*       62      ER event narrative to be printed                    S01496
     F*       63      S01496 present                                      S01496
0057 F********65******EVENT RECORD IS TO BE OUTPUT TO NOSEX
     F*       66      FX Daily Events by Currency Only                    AUS017
     F*       67      MM Daily Events by Currency Only                    AUS017
 057 F*       70      FILE CONTROL TOTALS ZEROISED
     F*       75      MATURITY DATE INDICATOR IS 'O'                      S01176
     F*       76      MATURITY DATE INDICATOR IS 'A'                      S01176
     F*       77      No internal parts purchased to report               CLE004
     F*       78      Chain to CLOAN failed                               CLE004
     F********79      Overflow indicator for GL0550P2                                  CLE004 CGL091
     F*       79      Overflow indicator for GL0557P2                                         CGL091
     F********79******Midas/TI Interface is installed               CTI001CLE005
     F*       80      Midas/TI Interface is installed                     CLE005
0022 F* 82            EVNTM DETAIL - FO RECORD                            S01127
0023 F* 83            EVNTM TRAILER- FO RECORD                            S01127
0058 F********99******FAIL OF CHAIN TO TABLE                              S01194
0059 F*       U7 U8   DATABASE ERROR
0060 F*       50      TABLE ACCESS SUCCESSFUL
0061 F*             L1CHANGE OF CURRENCY
     F*       U4      RUN WITH ONLY ST EVENTS
0064 F*       U5      SECURITIES TRADING ONE - ONLY , OVERRIDE            S01129
     E                    CPY@    1   1 80
     E********************CPY@    1   1 80                                S01194
0064 E********************INT         3 15 0                              S01129
0065 E********************DEC         3  3 0                              S01129
0064 E                    INT         4 15 0             HASH TOTALS      S01129
0065 E                    DEC         4  3 0             HASH TOTALS      S01129
0064 E********************HCCY       25  3                                S01194
0065 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0066 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0067 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0068 E************        TABA    1  97  4   TABB   15   EVENT NARRATIVES.S01108
0068 E************        TABA    1  99  4   TABB   15   EVENT NARRATIVES.S01119
0068 E************        TABA    1 105  4   TABB   15   EVENT NARRATIVES.S01119
0068 E************        TABA    1 122  4   TABB   15   EVENT NARRATIVES.S03220
     E************        TABA    1 131  4   TABB   15   EVENT NARRATIVES.S03220
     E************        TABA    1 132  4   TABB   15   EVENT NARRATIVES.S01243
     E*                                                                   S01314
     E** R10 PTF Incorporation changes: E23278 has changed the size and   S01314
     E** contents of this array, but the above fixes have also changed it;S01314
     E** both changes must apply here.                                    S01314
     E********************TABA    1 134  4   TABB   15   EVENT NARR S01243S01314
     E********************TABA    1 144  4   TABB   15   EVENT NARR S01314S01270
     E*****               TABA    1 147  4   TABB   15   EVENT NARRAS01270S01392
     E********************TABA    1 148  4   TABB   15   EVENT NARRAS01392E34885
     E********************TABA    1 150  4   TABB   15   EVENT NARRAE34885045634
     E********************TABA  1 149 4 TABB 15   EVENT NARRATIVES.045634 051227
     E********************TABA    1 151  4   TABB   15   Event Narr051227 S01464
     E********************TABA    1 152  4   TABB   15   EVENT NARRAS01464073714
     E*                                                                   S01408
     E/COPY WNCPYSRC,GL0557EEP1                                           S01408
     E*                                                                   S01408
     E********************TABA    1 153  4   TABB   15   EVENT NARRA073714CIR001
     E***********         TABA    1 158  4   TABB   15   EVENT NARRCIR001 CLE004
     E***********         TABA    1 180  4   TABB   15   EVENT NARRCLE004 CLE005
     E***********         TABA    1 226  4   TABB   15   EVENT NARRCLE005 CEU003
     E***********         TABA    1 299  4   TABB   15   EVENT NARRCEU003 142393
     E***********         TABA    1 303  4   TABB   15   EVENT NARR142393 142388
     E***********         TABA    1 307  4   TABB   15   EVENT NARR142388 CDL008
     E**********          TABA    1 309  4   TABB   15   EVENT NARRCDL008 CIR006
     E**********          TABA    1 310  4   TABB   15   EVENT NARRCIR006 CIR003
     E**********          TABA    1 314  4   TABB   15   EVENT NARRATIVES              CIR003 CAS009
     E**********          TABA    1 317  4   TABB   15   EVENT NARRATIVES              CAS009 CAP204
     E**********          TABA    1 315  4   TABB   15   EVENT NARRATIVES            CAP204 MD055652
     E                    TABA    1 318  4   TABB   15   EVENT NARRATIVES                   MD055652
     E*                                                                   S01408
     E/COPY WNCPYSRC,GL0557EEP2                                           S01408
     E*                                                                   S01408
     E*                                                                   S01195
      /COPY ZSRSRC,ZHOLE                                                  S01195
      /COPY ZSRSRC,ZSEDITZ1                                               CLE004
     E*                                                                   S01195
     E**  Narratives for Early Redemption Events                          S01496
     E*                                                                   S01496
     E                    NARR    1   4 15                                S01496
     E*                                                                   CSE007
     E**  Narratives for Corporate Action Events                          CSE007
     E*                                                                   CSE007
     E                    NARR1   1   4 15                                CSE007
      *                                                                                       CLE028
      ** Event types/narratives for CLE028 (Rule of 78)                                       CLE028
     E                    TABA2   1   5  4   TABB2  15                                        CLE028
      *                                                                                       CLE028
0069 I*
0070 I*    DEALS EVENTS FILE - HEADER RECORD.
0071 I*
0072 IEVNTXECF    01
0074 I*
0076 I*    EVENTS FILE - DEALS DETAIL RECORD.
0077 I*
0078 IEVNTXEDF    02
     I              EBRC                            BRCA                  S01117
0085 I                                              ECCY  L1
0090 I                                              EXRT            23
0093 I                                              OTHD            22
0103 I                                              FIPI            20
0104 I                                              INOI            21
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0557IIPG                                           S01408
     I*                                                                   S01408
0129 I*
0130 I*    MERGED EVENTS FILE - COMMERCIAL LOAN DETAIL RECORD.
0131 I*
0132 ICEVNXCCF    03
0140 I                                              ECCY  L1
0153 I                                              EINR            23
0166 I                                              INOI            21
     I                                              OTHD            22
     I**********    LNNO                            DLNO                                      CLE148
     I**************BWCN                            CNUM                  S01117
     I              BWCN                            CUNR                  S01117
     I              LNTP                            DTYP
     I              LNST                            DLST
 129 I*
 130 I*    MERGED EVENTS FILE - CUSTOMER LENDING DETAIL RECORD
 131 I*
     ILVENTELF    13
0140 I                                              ECCY  L1
0153 I                                              INTR            23
0166 I                                              INOI            21
     I                                              OTHD            22
     I              LTYP                            DTYP
     I              SUTP                            DLST
     I              DFCE                            LCEQ
     I              CDOM                            CLOC
     I              ECDP                            DEC1
     I              FACT                            FTYP
     I              FCNO                            FSEQ
     I********************                                                S01196
     I****LETTERS*OF*CREDIT*EVENT*DETAIL**                                S01196
     I********************                                                S01196
     I*****BVNTXEDF****15*                                                S01196
     I********************                          ECCY  L1              S01196
     I********************                          OTHD            22    S01196
     I********************                          INOI            21    S01196
     IBVNTXEDF    15                                                      S01473
     I                                              ECCY  L1              S01473
     I                                              OTHD            22    S01473
     I                                              INOI            21    S01473
      ** Letters of Credit Event Detail                                   S01473
      *                                                                   S01473
     IBVNTXEZF    16                                                      S01473
      ** Letters of Credit Events File Trailer                            S01473
      *                                                                   S01473
     I*
     I*   SECURITIES TRADING EVENT DETAIL
     I*
     I*STEVEABF    17                                                     E20669
     I**********    RECI                            RECIST                E20669
     I**********                                    ECCY  L1              E20669
     I**********    ODTE                            OTHD            22    E20669
     I**********    IOIN                            INOI            21    E20669
     I**********    SBEE                            BCEQ                  E20669
     I**********    DBRT                            DBCR                  E20669
     I**********    TRDR                            DLNO                  E20669
     I**********    TRSE                            DLST                  E20669
     I**********    TRTE                            DTYP                  E20669
     I**********    DNEE                            LCEQ                  E20669
     I**********    OURE                            OSAC                  E20669
     I**********    NOMC                            OTHC                  E20669
     I**********    REGR                            REGC                  E20669
     I**********    SETL                            SETP                  E20669
     I**********    OAME                            OTHA                  E20669
     I*                                                                   S01129
     I*   TRADE EVENT DETAIL                                              S01129
     I*                                                                   S01129
     ITREVEDF     26                                                      S01129
     I              TRRI                            RECI                  S01129
     I              TRTR                            TRNO                  055798
     I              TRSS                            SECS                  S01129
     I              TRTT                            DTYP                  S01129
     I              TRVD                            EDAT                  S01129
     I              TRSC                            ECCY  L1              S01129
     I              TRVS                            EAMT                  S01129
     I              TRTS                            DLST                  S01129
     I              TRCN                            CRNM                  S01129
     I              TRTN                            CTWN                  S01129
     I              TRIO                            INOI            21    S01129
     I              TREC                            ETYP                  S01129
     I              EARL                            WEARL                 S01496
     I              COAF                            WCOAF                 CSE007
     I*                                                                   S01129
     I*   CUSTOMER POSTITION EVENTS DETAIL                                S01129
     I*                                                                   S01129
     ICPEVEDF     27                                                      S01129
     I              CCRN                            CRNM                  S01129
     I              CCTR                            CTWN                  S01129
     I**************CCDT                            EDAT           S01129 S01512
     I              CPYD                            EDAT                  S01512
     I              CCCE                            ETYP                  S01129
     I              CCEC                            ECCY  L1              S01129
     I              CCSS                            SECS                  S01129
     I              CCIO                            INOI            21    S01129
     I              CCEA                            EAMT                  S01129
     I              EARL                            WEARL                 S01496
     I              COAF                            WCOAF                 CSE007
     I*                                                                   S01129
     I*   DEPOT POSTITION EVENTS DETAIL                                   S01129
     I*                                                                   S01129
     IDPEVEDF     28                                                      S01129
     I              CCDN                            CRNM                  S01129
     I              CCTW                            CTWN                  S01129
     I**************CCDT                            EDAT           S01129 S01512
     I              CCPD                            EDAT                  S01512
     I              CCCE                            ETYP                  S01129
     I              CCEC                            ECCY  L1              S01129
     I              CCSS                            SECS                  S01129
     I              CCIO                            INOI            21    S01129
     I              CCEA                            EAMT                  S01129
     I              EARL                            WEARL                 S01496
     I              COAF                            WCOAF                 CSE007
     I*                                                                   S01129
     I*   BOOK POSTITION EVENTS DETAIL                                    S01129
     I*                                                                   S01129
     I*BPEVEDF     29                                              S01129 E20669
     I**********    CCDT                            EDAT           S01129 E20669
     I**********    CCCE                            ETYP           S01129 E20669
     I**********    CCEC                            ECCY  L1       S01129 E20669
     I**********    CCSS                            SECS           S01129 E20669
     I**********    CCIO                            INOI            21    E20669
     I**********    CCEA                            EAMT           S01129 E20669
     I*
     IFPVNTDDF    37                                                      S03220
     I*                                                                   S03220
     I*  FUNDS TRANSFER EVENTS DETAIL RECORD                              S03220
     I*                                                                   S03220
     I                                              ECCY  L1              S03220
     I                                              OTHD            22    S03220
     I                                              INOI            21    S03220
      *                                                                                       CAP204
      ** ACCOUNT TRANSFER DETAIL RECORD                                                       CAP204
      *                                                                                       CAP204
     IGLEVNTDF    54                                                                          CAP204
     I                                              ECCY  L1                                  CAP204
     I                                              INOI            21                        CAP204
     I                                              OTHD            22                        CAP204
     I*
0179 I*
0180 I*
0181 I*    DEALS EVENTS FILE - TRAILER RECORD.
0182 I*
0183 IEVNTXZZF    04
0179 I*
0180 I*
0181 I*    COMMERCIAL LOANS EVENTS FILE - TRAILER RECORD.
0182 I*
0183 ICEVNXZZF    12
     I*
     I*    CUSTOMER LENDING EVENTS FILE TRAILER
     I*
     ILVENTZZF    14
     I********************                                                S01196
     I*****LETTERS*OF*CREDIT*EVENTS*FILE*TRAILER**                        S01196
     I********************                                                S01196
     I*****BVNTXEZF****16*                                                S01196
     I*
     I*    SECURITIES TRADING EVENTS FILE TRAILER
     I*
     I*STEVEFCF    18                                                     E20669
     I**********    HSTA                            HRWN                  E20669
     I**********    HSTB                            HRDC                  E20669
0179 I*
     IFPVNTZZF    38                                                      S03220
     I*                                                                   S03220
     I*    FUNDS TRANSFER EVENTS FILE TRAILER                             S03220
     I*                                                                   S03220
     I              NORE1                           NORE                  S03220
     I*                                                                   S01127
     I*    EVNTM FILE - FO DETAIL RECORD                                  S01127
     IFOEVEDF     82                                                      S01127
     I                                              ECCY  L1              073714
     I                                              INOI            21    073714
     I*                                                                   S01127
     I*    EVNTM FILE - FO TRAILER                                        S01127
     IFOEVEZZF    83                                                      S01127
     I*                                                                   S03220
      *                                                                                       CAP204
      **   ACCOUNT TRANSFER TRAILER FILE                                                      CAP204
      *                                                                                       CAP204
     IGLEVNTZF    55                                                                          CAP204
     I              ZZ304                           GZZ304                                    CAP204
     IDRSDEALSNS                                                          S01392
     I                                    P 214 2200TOTI                  S01392
      *                                                                                       CGL091
      * Rename IRS look-ahead fields to prevent corruption                                    CGL091
     IDLDTSCD0                                                                                CGL091
     I              DLNO                            @DLNO                                     CGL091
      *                                                                                     MD059528
      ** Rename TPAMT(THEIR PRINCIPAL AMOUNT) to avoid conflict with TPAMT(Daily Total)     MD059528
      *                                                                                     MD059528
     IDEALSDGF                                                                              MD059528
     I              TPAMT                           TPAMTD                                  MD059528
0180 I*******************                                                 S01194
0193 I*****T*A*B*L*E***F*I*L*E***I*N*P*U*T*                               S01194
0194 I*******************                                                 S01194
0195 I*****ICR*1*********                                                 S01194
0196 I*******************                                                 S01194
0197 I**TABLE***NS**06***1*CD***2*C0***3*C1**                             S01194
0198 I*******AND******12*C1**13*C0***********                             S01194
0199 I****************                        1   1 RECI                  S01194
0200 I****************                       14  66 TITL                  S01194
0201 I****************                       67  67 DATF                  S01194
0202 I****************                    P  77  790RUND                  S01194
0203 I****************                       80  86 RUNA                  S01194
0204 I*****HOLIDAYS*RECORD**                                              S01194
0205 I****************                                                    S01194
0206 I********NS**07** 1 CD   2 C2   3 C2                                 S01194
0207 I****************                        1   1 RECI                  S01194
0208 I****************                       14  14 INEX                  S01194
0209 I****************                       15  89 HCCY                  S01194
0210 I*****CURRENCIES*RECORD*1**                                          S01194
0211 I****************                                                    S01194
0212 I********NS**08**01*CD***2*C2***3*C0*                                S01194
0213 I*******AND******13*C1**                                             S01194
0214 I****************                        1   1 RECI                  S01194
0215 I****************                       14  27 CCNM                  S01194
0216 I****************                       38  380CDP                   S01194
0217 I*****ICR*2******                                                    S01194
0218 I****************                                                    S01194
0219 I********NS**09** 1 CD   2 C0   3 C1                                 S01194
0220 I*******AND******12 C1  13 C1                                        S01194
0221 I****************                       47  49 LOCY                  S01194
0222 I****************                                                    S01194
0223 I*****CATCHALL***                                                    S01194
0224 I****************                                                    S01194
0225 I********NS**10**                                                    S01194
     I*                                                                   035170
     ISDDEAL    E DSSDDEALPD                                              035170
     I** EXTERNAL DS FOR DEAL DETAILS                                     035170
     I*                                                                   S01117
     I/COPY WNCPYSRC,GL0557I001
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              S01473
      ** Switchable Features File                                         S01473
      *                                                                   S01473
     ISDGELR    E DSSDGELRPD                                              CEU011
     I              QQACCD                          QQACD1                                    CGL029
      ** General ledger details                                           CEU011
      *                                                                   CEU011
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01195
     ISDMOD     E DSSDMMODPD                                              CTI001
     I**  EXTERNAL DS FOR MODULE ID'S                                     CTI001
     I*                                                                   CTI001
      *****COPY*ZSRSRC,ZHOLI                                                           S01195 CGL091
      /COPY ZSRSRC,ZHOLIA                                                                     CGL091
      /COPY ZSRSRC,ZSEDITZ2                                               CLE004
     I*                                                                   S01195
     I*LOT1********DS****************************256                      E193
     I*************************************** 1   1 RECI                  E193
     I**************************************  2   70DLNO                  E193
     I** (SOME FORMATS FOR EVNTM HAVE CNUM (6,0) , OTHERS CUNR (6A) S01117E193
     I**  USE DATA STRUCTURE TO ENSURE ALL INPUT IN CNUM.)          S01117E193
     I*************************************** 8  130CNUM                  E193
     I*************************************** 8  13 CUNR            S01117E193
     I*************************************  14  17 ETYP                  E193
     I*********************************** P  18  200EDAT                  E193
     I*********************************** P  21  270EAMT                  E193
     I*************************************  28  30 ECCY                  E193
     I*************************************  31  320ECSS                  E193
     I************************************   33  34 DTYP                  E193
     I*************************************  35  36 DLST                  E193
     I***************************************37  390BRCD            S01117E193
     I************************************** 37  39 BRCA            S01117E193
     I************************************P  40  468EXRT                  E193
     I************************************   47  47 NGII                  E193
     I***********************************    48  500NOTD                  E193
     I*********************************** P  51  530OTHD                  E193
     I*********************************** P  54  600OTHA                  E193
     I**********************************     61  63 OTHC                  E193
     I************************************P  64  700DBCE                  E193
     I*********************************** P  71  770BCEQ                  E193
     I*********************************** P  78  848DBCR                  E193
     I************************************P  85  910LCEQ                  E193
     I***********************************    92  930SETP                  E193
     I***********************************    94 105 OSAC                  E193
     I***********************************   106 115 TSEN                  E193
     I***********************************   116 118 ZZ0116                E193
     I************************************  119 119 FIPI                  E193
     I************************************* 120 120 INOI                  E193
     I************************************  121 121 FCTI                  E193
     I************************************  122 122 RLVI                  E193
     I** (SOME FORMATS FOR EVNTM HAVE CPAR (6,0) , OTHERS PTNU (6A) S01117E193
     I**  USE DATA STRUCTURE TO ENSURE ALL INPUT IN CPAR.)          S01117E193
     I************************************* 123 1280CPAR                  E193
     I************************************* 123 128 PTNU            S01117E193
     I************************************* 129 1290PARI                  E193
     I************************************* 130 149 CRNM                  E193
     I************************************* 150 159 CTWN                  E193
     I************************************  160 167 CASK                  E193
     I************************************* 168 187 PRNM                  E193
     I************************************* 188 197 PTWN                  E193
     I************************************* 198 205 PASK                  E193
     I************************************* 206 207 CCTZ                  E193
     I************************************* 208 209 CLOC                  E193
     I************************************* 210 211 REGC                  E193
     I**************************************212 2140DASN                  E193
     I************************************P 215 2170FFVD                  E193
     I***********************************   218 218 FFIN                  E193
     I************************************  219 2210FACT                  E193
     I************************************* 222 2230FCNO                  E193
     I**************************************224 233 FACO                  E193
     I************************************* 234 256 SPI11                 E193
     I*LOT2********DS**********************       64                      E193
     I************************************    1  12 SPI21                 E193
     I*************************************  13  180CPCN                  E193
     I************************************   19  190FSLI                  E193
     I*********************************** P  20  257ICIR                  E193
     I*********************************** P  26  320ICAM                  E193
     I*********************************** P  33  390RBDA                  E193
     I************************************   40  40 OCFF                  E193
     I************************************** 41  63 ZZ0296                E193
     I************************************** 64  64 TAXI                  E193
     I*LOT3********DS***********************     256                      E193
     I**************************************  1   1 RECI1                 E193
     I*************************************   2   70DLNO1                 E193
     I*************************************   8  130DDNO                  E193
     I*************************************  14  190CNUM1                 E193
     I*************************************  20  23 ETYP1                 E193
     I************************************P  24  260EDAT1                 E193
     I************************************P  27  330EAMT1                 E193
     I*************************************  34  36 ECCY1                 E193
     I*************************************  37  380ECSS1                 E193
     I*************************************  39  40 DTYP1                 E193
     I************************************** 41  42 DLST1                 E193
     I***************************************43  450BRCD1                 S01117
     I************************************** 43  45 BRCA1           S01117E193
     I************************************P  46  480OTHD1                 E193
     I*********************************** P  49  550OTHA1                 E193
     I***************************************56* 58 OTHC1                 E193
     I*********************************** P  59  650BCEQ1                 E193
     I*********************************** P  66  720LCEQ1                 E193
     I************************************P  73  750CSTD                  E193
     I*********************************** P  76  780CMTD                  E193
     I***********************************    79  790RPYT                  E193
     I*********************************** P  80  857EINR                  E193
     I***************************************86**870SETP1                 E193
     I***********************************    88  99 OSACA                 E193
     I**********************************    100 109 TSEN1                 E193
     I**********************************  P 110 1179DXRT                  E193
     I************************************  118 1180DEC1                  E193
     I************************************  119 1190DEC2                  E193
     I************************************  120 139 CRNM1                 E193
     I************************************  140 149 CTWN1                 E193
     I************************************* 150 157 CASK1                 E193
     I**************************************158 177 PRNM1                 E193
     I************************************  178 187 PTWN1                 E193
     I************************************  188 195 PASK1                 E193
     I************************************* 196 196 INOI1                 E193
     I************************************  197 197 CYSW                  E193
     I***********************************   198 199 CRSK                  E193
     I************************************* 200 201 CLOC1                 E193
     I************************************  202 203 REGC1                 E193
     I************************************* 204 204 FFIN1                 E193
     I*********************************** P 205 2070FFVD1                 E193
     I************************************P 208 2140OADD                  E193
     I*********************************** P 215 2170LIPD                  E193
     I***********************************   218 2180PARI1                 E193
     I************************************  219 2240CPAR1                 E193
     I************************************* 225 256 ZZ0225                E193
     I*LOT4********DS***********************     256                      E193
     I**************************************  1   1 RECI2                 E193
     I**************************************  2   70LNRF2                 E193
     I**************************************  8  130ZZ0008                E193
     I***************************************14  190CNUM2                 E193
     I*************************************  20  23 ETYP2                 E193
     I************************************P  24  260EDAT2                 E193
     I************************************P  27  330EAMT2                 E193
     I*************************************  34  36 ECCY2                 E193
     I*************************************  37  380ECSS2                 E193
     I*************************************  39  40 DTYP2                 E193
     I*************************************  41  42 DLST2                 E193
     I***************************************43  450BRCD2                 S01117
     I*************************************  43  45 BRCA2           S01117E193
     I*********************************** P  46  480OTHD2                 E193
     I**********************************  P  49  550OTHA2                 E193
     I***********************************    56  58 ZZ0056                E193
     I**********************************  P  59  650BCEQ2                 E193
     I*********************************** P  66  720LCEQ2                 E193
     I***********************************    73  78 ZZ0073                E193
     I**********************************     79  790NGII2                 E193
     I**********************************  P  80  857INTR2                 E193
     I***********************************    86  870SETP2                 E193
     I**********************************     88  99 OSACB                 E193
     I***********************************   100 109 TSEN2                 E193
     I***********************************   110 117 ZZ0110                E193
     I***********************************   118 1180DEC12                 E193
     I***********************************   119 119 ZZ0119                E193
     I***********************************   120 139 CRNM2                 E193
     I***********************************   140 149 CTWN2                 E193
     I***********************************   150 157 CASK2                 E193
     I************************************  158 177 PRNM2                 E193
     I************************************  178 187 PTWN2                 E193
     I************************************  188 195 PASK2                 E193
     I***********************************   196 196 INOI2                 E193
     I************************************  197 197 ZZ0197                E193
     I************************************  198 199 CRSK2                 E193
     I************************************  200 201 CLOC2                 E193
     I************************************* 202 203 REGC2                 E193
     I************************************* 204 217 ZZ0204                E193
     I************************************  218 2180PARI2                 E193
     I************************************* 219 2240CPAR2                 E193
     I**************************************225 256 ZZ225                 E193
     I*SPI*********DS**********************       35                      E193
     I************************************    1  23 SPI1                  E193
     I************************************   24  35 SPI2                  E193
     I*DLSTAT****UDS                            256                       036796
     I**************                         10  110DAYS                  036796
     I**************                         10  11 DYSA                  036796
     IGLSTAT     UDS                            256                       036796
     I                                       33  340DAYS                  036796
     I                                       33  34 DYSA                  036796
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
      *                                                                   CLE004
     ISPOOL2      DS                                                      CLE004
     I** File information data structure - P2                             CLE004
     I                                       83  92 SFILE2                CLE004
     I                                    B 123 1240SFNUM2                CLE004
     I                                    B 243 2460SWRIT2                CLE004
      *                                                                   CLE004
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     ISPOOLU      DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I************                                                        S01117
     I***DATA*STRUCTURE*FOR*COMPILATION**-*COPYRIGHT*INSERTION**          S01117
     I***CPYR@#******DS                                                   S01117
     I************                            1  80 CPY@                  S01117
     I************                            1  20 CPY@##                S01117
     I              'INT. ESTIMATE  '     C         WINEST                                    CIR007
      ** Value of Event Description if either side of the deal is an                          CIR007
      ** OIS                                                                                  CIR007
      *                                                                                       CIR007
0226 I/EJECT
0227 C*
0229 C*
     C*    F I R S T   C Y C L E
0229 C*
0230 C   49                GOTO DETAIL
     C                     SETON                     49
     C                     MOVEACPY@      BIS@   80
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           TYPE    2                       AUS017
     C                     PARM           SEQ                             S01117
     C                     PARM           FWDDAY  3                                           CGL091
     C*                                                                   S01496
     C/COPY WNCPYSRC,GL0557C011
     C**  Access SAR details file to see if S01496 is installed.          S01496
     C*                                                                   S01496
     C                     CALL 'AOSARDR0'                                S01496
     C                     PARM '       ' @RTCD   7                       S01496
     C                     PARM '*VERIFY' @OPTN   7                       S01496
     C                     PARM 'S01496'  WSARD   6                       S01496
     C*                                                                   S01496
     C           @RTCD     IFEQ *BLANK                                    S01496
     C                     MOVE '1'       *IN63                           S01496
     C                     END                                            S01496
     C*                                                                   CSE007
     C**  Access SAR details file to see if CSE007 is installed.          CSE007
     C*                                                                   CSE007
     C                     CALL 'AOSARDR0'                                CSE007
     C                     PARM '       ' @RTCD   7                       CSE007
     C                     PARM '*VERIFY' @OPTN   7                       CSE007
     C                     PARM 'CSE007'  WSARD   6                       CSE007
     C*                                                                   CSE007
     C           @RTCD     IFEQ *BLANK                                    CSE007
     C                     MOVE '1'       *IN53                           CSE007
     C                     END                                            CSE007
     C*                                                                   CEU017
     C**  Access SAR details file to see if CEU017 is installed.          CEU017
     C*                                                                   CEU017
     C                     CALL 'AOSARDR0'                                CEU017
     C                     PARM '       ' @RTCD   7                       CEU017
     C                     PARM '*VERIFY' @OPTN   7                       CEU017
     C                     PARM 'CEU017'  WSARD   6                       CEU017
     C*                                                                   CEU017
     C           @RTCD     IFEQ *BLANK                                    CEU017
     C                     MOVE '1'       *IN53                           CEU017
     C                     END                                            CEU017
     C*                                                                   AUS017
     C**   INITIALIZE FX AND MM DEAL INDICATORS                           AUS017
     C*                                                                   AUS017
     C                     MOVE '0'       *IN66                           AUS017
     C                     MOVE '0'       *IN67                           AUS017
     C*                                                                   AUS017
     C**   CHECK DEAL AND SET CORRESPONDING INDICATOR                     AUS017
     C*                                                                   AUS017
     C           TYPE      IFEQ 'FX'                                      AUS017
     C                     MOVE '1'       *IN66                           AUS017
     C                     ELSE                                           AUS017
     C           TYPE      IFEQ 'MM'                                      AUS017
     C                     MOVE '1'       *IN67                           AUS017
     C                     END                                            AUS017
     C                     END                                            AUS017
      *                                                                   S01117
     C*                                                                   S01117
     C/COPY WNCPYSRC,GL0557C008
0231 C*********************EXSR ZSYSTM                                    S01194
0232 C***99****************SETON                     U7U8LR               S01194
0233 C***99****************GOTO END                                       S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     99                   S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *
      ** Read the deal details via access object program
      *                                                                   035170
     C**********           CALL 'AODEALR0'                                035170              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       035170
     C                     PARM '*FIRST ' @OPTN   7                       035170
     C********** SDDEAL    PARM SDDEAL    DSFDY                           035170              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    035170
     C                     MOVEL'SDDEALPD'DBFILE 10        ************   035170
     C                     MOVEL'04'      DBASE   2        * DBERR 04 *   035170
     C                     MOVEL@OPTN     DBOPTN  7        ************   035170
     C                     MOVEL@OPTN     DBKEY  29                       035170
     C                     EXSR *PSSR                                     035170
     C                     SETON                     99                   035170
     C                     GOTO END                                       035170
     C                     END                                            035170
      *                                                                   035170
     C                     CALL 'AOMMODR0'                                CTI001
     C                     PARM '*DBERR ' @RTCD                           CTI001
     C                     PARM '*FIRST ' @OPTN                           CTI001
     C           SDMOD     PARM SDMOD     DSFDY                           CTI001
      *                                                                   CTI001
     C           @RTCD     IFNE *BLANK                                    CTI001
     C                     MOVEL'SDMMODPD'DBFILE            ************* CTI001
     C                     MOVEL'05'      DBASE             * DBERR 05 *  CTI001
     C                     MOVEL@OPTN     DBOPTN            ************* CTI001
     C                     MOVEL@OPTN     DBKEY                           CTI001
     C                     SETON                     U7U8LR               CTI001
     C                     EXSR *PSSR                                     CTI001
     C                     GOTO END                                       CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      ** Midas/TI interface installed?                                    CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     MOVE 'Y'       M#TION  1                       CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      *                                                                   035170
     C***THIS*PROGRAM*CAN*BE*RUN*BY*SECURITIES*TRADING*WITHOUT*DEALING    036796
     C***IN*THE*SYSTEM,*IN*WHICH*CASE*D/DLSTAT*WILL*NOT*BE*SET.           036796
     C***********DYSA      COMP '  '                     51               036796
     C***51******          MOVE '99'      DYSA                            036796
     C**********                                                                       046872 CGL091
     C***If*days*not*set*to*99,*calculate*this*no*of*working*days*fwd*****             046872 CGL091
     C**********                                                                       046872 CGL091
     C********** DAYS      IFNE 99                                                     046872 CGL091
0241 C**********           Z-ADDDAYS      ZNRDYS                                              CGL091
0242 C********** DAYS      COMP 5                      40                                     CGL091
      *                                                                                       CGL091
     C                     MOVE FWDDAY    #DAYS   30                                          CGL091
     C           #DAYS     IFEQ *ZEROS                                                        CGL091
     C                     Z-ADD999       #DAYS                                               CGL091
     C                     ENDIF                                                              CGL091
     C           #DAYS     IFNE *ZEROS                                                        CGL091
     C           #DAYS     ANDNE999                                                           CGL091
     C                     SETON                     56                                       CGL091
     C                     ENDIF                                                              CGL091
      *                                                                                       CGL091
      ** If days not set to 999,calculate this no of working days fwd                         CGL091
      *                                                                                       CGL091
     C           #DAYS     IFNE 999                                                           CGL091
     C                     Z-ADD#DAYS     ZNRDYS                                              CGL091
0242 C           #DAYS     COMP 5                      40                                     CGL091
0243 C   40                Z-ADD5         ZNRDYS
0244 C*********************MOVE RUND      ZDAYNO                          S01194
0245 C*********************MOVE '1'       ZTABKY                          S01194
0246 C***********ZTABKY****CHAINTABLE                99                   S01194
0247 C***99****************SETON                     U7U8LR               S01194
0248 C***99****************GOTO END                                       S01194
0249 C*********************MOVE LOCY      ZCCY                            S01194
     C                     MOVE BJRDNB    ZDAYNO                          S01195
     C                     MOVE BJLCCY    ZCCY                            S01195
     C                     MOVE BJSLCD    ZLOC    3                       S01195
0250 C*********************EXSR ZDATE3                                    S01195
0250 C**********           EXSR ZFWDT                                                  S01195 CGL091
     C                     EXSR ZFWDTA                                                        CGL091
0251 C********** DAYS      COMP 99                       39               S01243
0252 C***39*****           MOVE 99999     ZDYNBR                          S01243
     C*
     C*    IF DAYS IS SET TO 99 ALLOW ALL EVENTS TO END OF BOOK TO        BHF136
     C*    BE PRODUCED                                                    BHF136
     C***********DAYS      IFEQ 99                                 BHF136 046872
     C                     ELSE                                           046872
     C                     MOVE 99999     ZDYNBR                          BHF136
     C                     END                                            BHF136
     C*                                                                   S01496
     C           *IN63     IFEQ '1'                                       S01496
     C                     MOVE '0'       *IN62                           S01496
     C                     END                                            S01496
     C*                                                                   CSE007
     C           *IN53     IFEQ '1'                                       CSE007
     C                     MOVE '0'       *IN52                           CSE007
     C                     END                                            CSE007
      *                                                                   S01473
      ** Check the switchable features file for the Midas Leo Integration S01473
      ** number, S01473. If it is present, set the flag ULEO to 'Y'       S01473
     C                     CALL 'AOSARDR0'                                S01473
     C                     PARM *BLANKS   @RTCD                           S01473
     C                     PARM '*VERIFY' @OPTN                           S01473
     C                     PARM 'S01473'  @KEY    6                       S01473
     C           SCSARD    PARM SCSARD    DSFDY                           S01473
      *                                                                   S01473
     C           @RTCD     IFEQ *BLANKS                                   S01473
     C                     MOVE 'Y'       ULEO    1                       S01473
     C                     END                                            S01473
      *                                                                   S01473
     C/COPY WNCPYSRC,GL0557C005
      ** Check if customer lending enhancement - syndication is           CLE004
      ** installed                                                        CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*VERIFY' @OPTN                           CLE004
     C                     PARM 'CLE004'  @KEY                            CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     OPEN CLOAN                                     CLE004
     C**********           OPEN GL0550P2                                               CLE004 CGL091
     C                     OPEN GL0557P2                                                      CGL091
     C                     MOVEA'001'     *IN,77                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE005
      **  Access Switchable SAR details for the existence of CLE005       CLE005
      **  (Tranch 3)                                                      CLE005
      *                                                                   CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANK    @RTCD                           CLE005
     C                     PARM '*VERIFY' @OPTN                           CLE005
     C                     PARM 'CLE005'  @SARD   6                       CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANK                                    CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           @RTCD     IFNE *BLANKS                                   CLE005
     C           @RTCD     ANDNE'*NRF  '                                  CLE005
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE005
     C                     MOVEL'06'      DBASE   2        * DBERR 06 *   CLE005
     C                     MOVEL@OPTN     DBKEY            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     EXSR *PSSR                                     CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** Check if Position/Risk Enquiries & Reports feature (CEU011)      CEU011
      ** is on.                                                           CEU011
      *                                                                   CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*VERIFY' @OPTN                           CEU011
     C                     PARM 'CEU011'  @KEY    6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFEQ *BLANKS                                   CEU011
     C                     MOVE 'Y'       CEU011  1                       CEU011
     C                     MOVE *ON       *IN29                           CEU011
     C                     ELSE                                           CEU011
     C                     MOVE 'N'       CEU011                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF  '                                  CEU011
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU011
     C                     MOVEL'07'      DBASE            * DBERR 07 *   CEU011
     C                     MOVEL'CEU011  'DBKEY            ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                                       CIR007
      ** Access SAR details file to determine if CIR007                                       CIR007
      ** (Overnight Index Swaps) is switched on.                                              CIR007
      *                                                                                       CIR007
     C                     CALL 'AOSARDR0'                                                    CIR007
     C                     PARM *BLANK    PRTCD   7                                           CIR007
     C                     PARM '*VERIFY' POPTN   7                                           CIR007
     C                     PARM 'CIR007'  PSARD   6                                           CIR007
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR007
      *                                                                                       CIR007
     C           PRTCD     IFNE *BLANKS                                                       CIR007
     C           PRTCD     ANDNE'*NRF   '                                                     CIR007
      *                                                                                       CIR007
     C                     MOVEL'SCSARDPD'DBFILE                                              CIR007
     C                     MOVEL'08'      DBASE                                               CIR007
     C                     MOVEL'CIR007  'DBKEY                                               CIR007
     C                     EXSR *PSSR                                                         CIR007
     C**********           OPEN GL0550P1                                               CIR007 CGL091
     C                     OPEN GL0557P1                                                      CGL091
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C           PRTCD     IFEQ *BLANKS                                                       CIR007
     C                     MOVE 'Y'       CIR007  1                                           CIR007
     C                     ELSE                                                               CIR007
     C                     MOVE 'N'       CIR007                                              CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CLE028
      ** Check if enhancement CLE028 is installed                                             CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD                                               CLE028
     C                     PARM '*VERIFY 'POPTN                                               CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'CLE028'  DBKEY                                               CLE028
     C                     MOVEL'16'      DBASE                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                     AR743357
     C                     CALL 'AOSARDR0'                                                  AR743357
     C                     PARM *BLANK    PRTCD   7                                         AR743357
     C                     PARM '*VERIFY' POPTN   7                                         AR743357
     C                     PARM 'CIR003'  PSARD   6                                         AR743357
     C           SCSARD    PARM SCSARD    DSFDY                                             AR743357
      *                                                                                     AR743357
     C           PRTCD     IFNE *BLANKS                                                     AR743357
     C           PRTCD     ANDNE'*NRF   '                                                   AR743357
      *                                                                                     AR743357
     C                     MOVEL'SCSARDPD'DBFILE                                            AR743357
     C                     MOVEL'15'      DBASE                                             AR743357
     C                     MOVEL'CIR003'  DBKEY                                             AR743357
     C                     EXSR *PSSR                                                       AR743357
     C**********           OPEN GL0550P1                                             AR743357 CGL091
     C                     OPEN GL0557P1                                                      CGL091
     C                     ENDIF                                                            AR743357
      *                                                                                     AR743357
     C           PRTCD     IFEQ *BLANKS                                                     AR743357
     C                     MOVE 'Y'       CIR003  1                                         AR743357
     C                     ELSE                                                             AR743357
     C                     MOVE 'N'       CIR003                                            AR743357
     C                     ENDIF                                                            AR743357
     C/COPY WNCPYSRC,GLH00787
      *                                                                   CEU011
      ** Retrieve general ledger details                                  CEU011
      *                                                                   CEU011
     C**********           CALL 'AOGELRR0'                                CEU011              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*FIRST ' @OPTN                           CEU011
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU011              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF   '                                 CEU011
     C                     MOVEL'SDGELRPD'DBFILE           ************   CEU011
     C                     MOVEL'09'      DBASE            * DBERR 09 *   CEU011
     C                     MOVEL'*FIRST'  DBKEY            ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                                       CAP204
      ** Check if enhancement CAP204 is installed                                             CAP204
      *                                                                                       CAP204
     C                     CALL 'AOSARDR0'                                                    CAP204
     C                     PARM '       ' @RTCD                                               CAP204
     C                     PARM '*VERIFY' @OPTN                                               CAP204
     C                     PARM 'CAP204'  WSARD                                               CAP204
      *                                                                                       CAP204
     C           @RTCD     IFEQ *BLANK                                                        CAP204
     C                     MOVE 'Y'       CAP204  1                                           CAP204
     C                     ELSE                                                               CAP204
     C           PRTCD     IFNE *BLANKS                                                       CAP204
     C           PRTCD     ANDNE'*NRF   '                                                     CAP204
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP204
     C                     MOVEL'CAP204'  DBKEY                                               CAP204
     C                     MOVEL'17'      DBASE                                               CAP204
     C                     EXSR *PSSR                                                         CAP204
     C                     ENDIF                                                              CAP204
     C                     ENDIF                                                              CAP204
     C*
0253 C*    FUTURE DAY NUMBER NOW HELD IN ZDYNBR
0254 C           DETAIL    TAG                             ** DETAIL TAG *
     C************IN02**** IFEQ '1'                                       E193
     C******************** MOVE SPI1      SPI11                           E193
     C******************** MOVE SPI2      SPI21                           E193
     C******************** END                                            E193
     C************IN03**** IFEQ '1'                                       E193
     C******************** MOVE RECI      RECI1                           E193
     C******************** Z-ADDDLNO      DLNO1                           E193
     C*********************Z-ADDCNUM      CNUM1                           E193
     C*********************MOVE DTYP      DTYP1                           E193
     C******************** MOVE DLST      DLST1                           E193
     C******************** Z-ADDEDAT      EDAT1                           E193
     C******************** Z-ADDEAMT      EAMT1                           E193
     C******************** Z-ADDECSS      ECSS1                           E193
     C*********************Z-ADDBRCD      BRCD1                           S01117
     C******************** MOVE BRCA      BRCA1                     S01117E193
     C******************** Z-ADDOTHD      OTHD1                           E193
     C*********************Z-ADDOTHA      OTHA1                           E193
     C******************** Z-ADDBCEQ      BCEQ1                           E193
     C******************** Z-ADDLCEQ      LCEQ1                           E193
     C******************** Z-ADDSETP      SETP1                           E193
     C******************** Z-ADDFFVD      FFVD1                           E193
     C*********************Z-ADDPARI      PARI1                           E193
     C******************** Z-ADDCPAR      CPAR1                           E193
     C******************** MOVE ETYP      ETYP1                           E193
     C******************** MOVE ECCY      ECCY1                           E193
     C*******************  MOVE OTHC      OTHC1                           E193
     C******************** MOVE OSAC      OSACA                           E193
     C*********************MOVE TSEN      TSEN1                           E193
     C******************** MOVE CRNM      CRNM1                           E193
     C******************** MOVE CTWN      CTWN1                           E193
     C******************** MOVE CASK      CASK1                           E193
     C******************** MOVE PRNM      PRNM1                           E193
     C*********************MOVE PTWN      PTWN1                           E193
     C******************** MOVE PASK      PASK1                           E193
     C******************** MOVE INOI      INOI1                           E193
     C******************** MOVE CLOC      CLOC1                           E193
     C******************** MOVE REGC      REGC1                           E193
     C******************** MOVE FFIN      FFIN1                           E193
     C******************** END                                            E193
     C******SETUP CUSTOMER LENDING OUTPUT DATA STRUCTURE                  E193
     C************IN13**** IFEQ '1'                                       E193
     C*******************  MOVE RECI      RECI2                           E193
     C******************** Z-ADDLNRF      LNRF2                           E193
     C******************** Z-ADDCNUM      CNUM2                           E193
     C******************** MOVE ETYP      ETYP2                           E193
     C******************** Z-ADDEDAT      EDAT2                           E193
     C******************** Z-ADDEAMT      EAMT2                           E193
     C******************** MOVE ECCY      ECCY2                           E193
     C*********************Z-ADDECSS      ECSS2                           E193
     C*********************MOVE DTYP      DTYP2                           E193
     C*********************MOVE DLST      DLST2                           E193
     C*********************Z-ADDBRCD      BRCD2                           S01117
     C******************** MOVE BRCA      BRCA2                     S01117E193
     C******************** Z-ADDOTHD      OTHD2                           E193
     C******************** Z-ADDOTHA      OTHA2                           E193
     C*********************Z-ADDBCEQ      BCEQ2                           E193
     C******************** Z-ADDLCEQ      LCEQ2                           E193
     C******************** MOVE NGII      NGII2                           E193
     C******************** Z-ADDINTR      INTR2                           E193
     C******************** Z-ADDSETP      SETP2                           E193
     C*********************MOVE OSAC      OSACB                           E193
     C*********************MOVE TSEN      TSEN2                           E193
     C******************** Z-ADDDEC1      DEC12                           E193
     C*********************MOVE CRNM      CRNM2                           E193
     C******************** MOVE CTWN      CTWN2                           E193
     C******************** MOVE CASK      CASK2                           E193
     C******************** MOVE PRNM      PRNM2                           E193
     C******************** MOVE PTWN      PTWN2                           E193
     C******************** MOVE PASK      PASK2                           E193
     C******************** MOVE INOI      INOI2                           E193
     C*********************MOVE CLOC      CLOC2                           E193
     C*********************MOVE REGC      REGC2                           E193
     C*********************Z-ADDPARI      PARI2                           E193
     C*********************Z-ADDCPAR      CPAR2                           E193
     C*********************END                                            E193
     C*********************                                         S01196E193
     C*****LETTERS*OF*CREDIT*EVENTS**                               S01196E193
     C************IN15*****IFEQ '1'                                 S01196E193
     C*********************MOVELOSAC      OSAC1                     S01196E193
     C*********************MOVE OSAC      OSAC2                     S01196E193
     C*********************END                                      S01196E193
     C**                                                            S01129E193
     C**   SET UP OUTPUT FIELDS FOR TRADE EVENTS                    S01129E193
     C************IN26*****IFEQ '1'                                 S01129E193
     C*********************MOVE 'E'       NREI                      S01129E193
     C*********************MOVE ECCY      NEEC                      S01129E193
     C*********************MOVELTRSA      NENC                      S01129E193
     C*********************Z-ADDEDAT      NEED                      S01129E193
     C*********************MOVE CRNM      NERN                      S01129E193
     C*********************MOVE CTWN      NERT                      S01129E193
     C*********************MOVE TRTR      NETR                      S01129E193
     C*********************MOVE ETYP      NECD                      S01129E193
     C*********************Z-ADDEAMT      NEAM                      S01129E193
     C******************** MOVE INOI      NEIO                      S01129E193
     C******************** MOVE TRTR      DLNO                      S01129E193
     C*                                                             S01129E193
     C******************** MOVE TRSM      SETP                      S01129E193
     C******************** MOVE '       ' OTHDA                     S01129E193
     C******************** MOVE ' '       FFIN                      S01129E193
     C*********************END                                      S01129E193
     C**                                                            S01129E193
     C**   SET UP OUTPUT FIELDS FOR CUSTOMER POSITION EVENTS OR DEPOT01129E193
     C**   POSITION EVENTS                                          S01129E193
     C************IN27*****IFEQ '1'                                 S01129E193
     C************IN28*****OREQ '1'                                 S01129E193
     C*********************MOVE 'E'       NREI                      S01129E193
     C*********************MOVE ECCY      NEEC                      S01129E193
     C*********************MOVELCCSA      NENC                      S01129E193
     C*********************Z-ADDEDAT      NEED                      S01129E193
     C*********************MOVE CRNM      NERN                      S01129E193
     C*********************MOVE CTWN      NERT                      S01129E193
     C******************** MOVE *BLANKS   NETR                      S01129E193
     C******************** MOVE ETYP      NECD                      S01129E193
     C******************** Z-ADDEAMT      NEAM                      S01129E193
     C******************** MOVE INOI      NEIO                      S01129E193
     C*                                                             S01129E193
     C*********************MOVE CCSM      SETP                      S01129E193
     C******************** MOVE '       ' OTHDA                     S01129E193
     C*********************MOVE ' '       FFIN                      S01129E193
     C******************** Z-ADD0         DLNO                      S01129E193
     C*********************END                                      S01129E193
     C*                                                             S01129E193
     C************IN29*****IFEQ '1'                                 S01129E193
     C*********************MOVE '       ' OTHDA                     S01129E193
     C******************** MOVE ' '       FFIN                      S01129E193
     C******************** MOVE 00        SETP                      S01129E193
     C*********************END                                      S01129E193
     C**                                                                  E193
     C**   SECURITIES TRADING EVENTS                                      E193
     C************IN17*****IFEQ '1'                                       E193
     C*********************MOVELOSAC      OSAC1                           E193
     C*********************MOVE OSAC      OSAC2                           E193
     C*********************MOVE THRE      TSEN                            E193
     C           *IN03     IFEQ *ON                                                           CLE148
     C                     MOVE LNNO      DLNO                                                CLE148
     C                     ENDIF                                                              CLE148
     C*
     C** If trade events file is read, move trade ref. to DLNO            055798
     C*                                                                   055798
     C           *IN26     IFEQ '1'                                       055798
     C                     MOVE TRNO      DLNO                            055798
     C                     END                                            055798
     C*                                                                   055798
     C**CHECK*FOR*TYPE*C1,C2,M1*AND*M2*********************************   CEU003
     C* CHECK FOR TYPE C1,C2,M1,M2,MX AND MY                              CEU003
     C*
     C**N17*****           GOTO NOT17                              E43518 E20669
     C                     GOTO NOT17                                     E20669
     C*
     C                     MOVE ETYP      ALPH2   2
     C           ALPH2     COMP 'C1'                     25
     C  N25      ALPH2     COMP 'C2'                     25
     C  N25      ALPH2     COMP 'M1'                     25
     C  N25      ALPH2     COMP 'M2'                     25
     C  N25      ALPH2     COMP 'MX'                     25               CEU003
     C  N25      ALPH2     COMP 'MY'                     25               CEU003
     C*
     C           NOT17     TAG                             ** NOT17 TAG **E43518
     C*
     C*********************END                                            E193
0255 C***L1****************MOVEL'20'      KEYT   12                       S01194
0256 C***L1****************MOVELECCY      WRK     4                       S01194
0257 C***L1****************MOVE '1'       WRK                             S01194
0258 C***L1****************MOVE WRK       KEYT                            S01194
0259 C***L1******KEYT******CHAINTABLE                99                   S01194
     C*                                                                   S01194
     C/COPY WNCPYSRC,GL0557C001
     C**                                                                                      CGL091
     C** IF CHANGE IN EVENT DATE PRINT THE SUBTOTAL DETAILS IF EVENT                          CGL091
     C** PRINTED                                                                              CGL091
     C                     MOVE 'N'       ROLLY   1                                           CGL091
      *                                                                                       CGL091
      * If change of currency, reset running totals                                           CGL091
     C           *INL1     IFEQ '1'                                                           CGL091
     C                     Z-ADD0         RPAMT  130                                          CGL091
     C                     Z-ADD0         RINTAM 130                                          CGL091
     C                     Z-ADD0         RTAMT  130                                          CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
     C           EDAT      IFNE SAVDAT                                                        CGL091
     C           SAVDAT    ANDNE0                                                             CGL091
     C           *INL1     OREQ '1'                                                           CGL091
     C           SAVDAT    ANDNE0                                                             CGL091
     C   34                EXCPTSUBTL                                                         CGL091
      *                                                                                       CGL091
      * After output of subtotal, output running total                                        CGL091
     C                     ADD  TPAMT     RPAMT  130                                          CGL091
     C                     ADD  TINTAM    RINTAM 130                                          CGL091
     C                     ADD  TTAMT     RTAMT  130                                          CGL091
     C   34                EXCPTRUNTL                                                         CGL091
      *                                                                                       CGL091
      **If change of currency, reset running totals                                           CGL091
     C           *INL1     IFEQ '1'                                                           CGL091
     C                     Z-ADD0         RPAMT  130                                          CGL091
     C                     Z-ADD0         RINTAM 130                                          CGL091
     C                     Z-ADD0         RTAMT  130                                          CGL091
     C                     END                                                                CGL091
     C                     Z-ADD0         TPAMT  130                                          CGL091
     C                     Z-ADD0         TINTAM 130                                          CGL091
     C                     Z-ADD0         TTAMT  130                                          CGL091
     C                     Z-ADD0         SAVDAT                                              CGL091
     C                     END                                                                CGL091
     C*                                                                                       CGL091
     C           *INL1     IFEQ '1'                                       S01194
     C*                                                                   S01194
     C** READ CURRENCY DETAILS VIA ACCESS PROGRAM                         S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM ECCY      @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVELECCY      DBKEY                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
0260 C***L1*99*************SETON                     U7U8LR               S01194
0261 C***L1N08*************SETON                     U7U8LR               S01194
0262 C***L1******CDP*******COMP 1                      3031               S01194
0263 C***L1******CDP*******COMP 2                    33  32               S01194
0262 C   L1      A6NBDP    COMP 1                      3031               S01194
0263 C   L1      A6NBDP    COMP 2                    33  32               S01194
0264 C   L1                SETOF                     4344
     C   L1                MOVE *OFF      *IN39                           CEU011
0265 C   L1
0266 COR 45 46             SETOF                     4546
0267 C   OF                SETON                     45
0268 C                     SETOF                     43
0269 C                     SETOF                     414265
     C                     SETOF                     48
     C*****RESTORE*SECURITY*TRADING*RECI                                  E20669
     C********** *IN17     IFEQ '1'                                       E20669
     C**********           MOVE RECIST    RECI                            E20669
     C**********           END                                            E20669
0270 C*    COUNT NUMBER OF RECORDS READ FROM EVENTM
      * Keep separate record count for the Security (II) Events.          S01129
      *                                                                   S01129
     C           *IN26     IFEQ '1'                                       S01129
     C           *IN27     OREQ '1'                                       S01129
     C           *IN28     OREQ '1'                                       S01129
     C********** *IN29     OREQ '1'                                S01129 E20669
     C                     ADD  1         #SEIN   50                      S01129
     C                     ELSE                                           S01129
      *                                                                   S01129
0271 C********   RECRED    ADD  1         RECRED  50                      S01127
     C*    IN FUTURE AND OPTION, TRAILER IS NOT INCLUDED IN NORE          S01127
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0557CCP1                                           S01408
     C*                                                                   S01408
     C  N83      RECRED    ADD  1         RECRED  50                      S01127
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0557CCP2                                           S01408
     C*                                                                   S01408
     C                     END                                            S01129
      *                                                                   S01129
0272 C   U8                GOTO END
     C*                                                                   AUS017
     C/COPY WNCPYSRC,GL0557C002
     C**    PROCESSING FOR FX OR MM DEALS ONLY                            AUS017
     C*                                                                   AUS017
     C           TYPE      IFEQ 'FX'                                      AUS017
     C           TYPE      OREQ 'MM'                                      AUS017
     C*                                                                   AUS017
     C**    IF RECORD READ IS NOT A DEAL RECORD                           AUS017
     C*                                                                   AUS017
     C           *IN02     IFEQ '0'                                       AUS017
     C                     MOVE '1'       *IN41                           AUS017
     C                     GOTO END                                       AUS017
     C                     END                                            AUS017
     C*                                                                   AUS017
     C                     END                                            AUS017
     C*                                                                   AUS017
      *                                                                                       CAP204
      ** If CAP204 is installed and trailer indicator is ON                                   CAP204
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN55     ANDEQ'1'                                                           CAP204
     C                     GOTO TRAIL                                                         CAP204
     C                     ENDIF                                                              CAP204
0274 C   12
     COR 14
     C*R*16****************                                               S01196
     COR 38                                                               S03220
     C*OR*18****                                                          E20669
     COR 83                                                               S01127
0273 COR 04                GOTO TRAIL
      *                                                                   S01473
      ** 'Turn off' display of Midas TI Reference                         CTI001
     C*********************MOVE *OFF*******IN79                     CTI001CLE005
     C                     MOVE *OFF      *IN80                           CLE005
      *                                                                   CTI001
      ** If processing Leo records, check for LEO trailer or detail       S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           M#TION    OREQ 'Y'                                       CTI001
      *                                                                   S01473
     C           *IN16     IFEQ '1'                                       S01473
     C                     MOVE 'Y'       ULTRL   1                       S01473
     C                     GOTO TRAIL                                     S01473
     C                     END                                            S01473
      *                                                                   S01473
     C           *IN15     IFEQ '1'                                       S01473
     C                     MOVE 'Y'       ULDET   1                       S01473
     C           M#TION    IFEQ 'Y'                                       CTI001
     C*********************MOVE *ON********IN79                     CTI001CLE005
     C                     MOVE *ON       *IN80                           CLE005
     C                     ENDIF                                          CTI001
     C                     END                                            S01473
      *                                                                   S01473
     C                     END                                            S01473
      *                                                                   S01473
0275 C   01                GOTO END
     C*                                                                   CEU003
     C**  If transaction is settled in another currency exclude events    CEU003
     C**  from report                                                     CEU003
     C*                                                                   CEU003
     C           SIAC      IFEQ 'Y'                                       CEU003
     C                     MOVE '1'       *IN41                           CEU003
     C                     GOTO END                                       CEU003
     C                     END                                            CEU003
     C*                                                                   S01221
     C**  Skip S.R.M. event types                                         S01221
     C****Do*not*skip*IRS*Event*22S1*and*22S2**********************E23278 051227
     C********** ETYP      IFEQ '20S1'                                                 S01393 CGL091
     C********** ETYP      OREQ '20S2'                                                 S01393 CGL091
     C********** ETYP      IFEQ '21S1'                             S01221 S01393
     C********** ETYP      OREQ '21S1'                                                 S01393 CGL091
     C********** ETYP      OREQ '21S2'                                                 S01221 CGL091
     C********** ETYP      OREQ '21S3'                                                 S01221 CGL091
     C********** ETYP      OREQ '21S4'                                                 208461 CGL091
     C********** ETYP      OREQ '21C1'                                                 051227 CGL091
     C********** ETYP      OREQ '21C2'                                                 051227 CGL091
     C********** ETYP      OREQ '21C3'                                                 051227 CGL091
     C********** ETYP      OREQ '21C4'                                                 208461 CGL091
     C********** ETYP      OREQ '21O1'                                                 051227 CGL091
     C********** ETYP      OREQ '21E1'                                                 051227 CGL091
     C***********ETYP      OREQ '22S1'                            S01221  E23278
     C***********ETYP      OREQ '22S2'                            S01221  E23278
     C********** ETYP      OREQ '22S1'                                                 051227 CGL091
     C********** ETYP      OREQ '22S2'                                                 051227 CGL091
     C********** ETYP      OREQ '22S3'                                                 S01393 CGL091
     C********** ETYP      OREQ '22S4'                                                 S01393 CGL091
     C********** ETYP      OREQ '22C1'                                                 051227 CGL091
     C********** ETYP      OREQ '22C2'                                                 051227 CGL091
     C********** ETYP      OREQ '22C3'                                                 208461 CGL091
     C********** ETYP      OREQ '22C4'                                                 208461 CGL091
     C********** ETYP      OREQ '22O1'                                                 051227 CGL091
     C********** ETYP      OREQ '22E1'                                                 051227 CGL091
     C********** ETYP      OREQ '23S1'                                                 S01221 CGL091
     C********** ETYP      OREQ '23S2'                                                 S01221 CGL091
     C********** ETYP      OREQ '23S3'                                                 208461 CGL091
     C********** ETYP      OREQ '23S4'                                                 208461 CGL091
     C********** ETYP      OREQ '23C1'                                                 051227 CGL091
     C********** ETYP      OREQ '23C2'                                                 051227 CGL091
     C********** ETYP      OREQ '23C3'                                                 208461 CGL091
     C********** ETYP      OREQ '23C4'                                                 208461 CGL091
     C********** ETYP      OREQ '23O1'                                                 051227 CGL091
     C********** ETYP      OREQ '23E1'                                                 051227 CGL091
     C********** ETYP      OREQ '24S1'                                                 S01221 CGL091
     C********** ETYP      OREQ '24S2'                                                 S01221 CGL091
     C********** ETYP      OREQ '24S3'                                                 208461 CGL091
     C********** ETYP      OREQ '24S4'                                                 208461 CGL091
     C********** ETYP      OREQ '24C1'                                                 051227 CGL091
     C********** ETYP      OREQ '24C2'                                                 051227 CGL091
     C********** ETYP      OREQ '24C3'                                                 208461 CGL091
     C********** ETYP      OREQ '24C4'                                                 208461 CGL091
     C********** ETYP      OREQ '24O1'                                                 051227 CGL091
     C********** ETYP      OREQ '24E1'                                                 051227 CGL091
      *                                                                                       CGL091
      * Include FRA/IRS notional principal and interest events                                CGL091
     C           ETYP      IFEQ '20S1'                                                        CGL091
     C           ETYP      OREQ '20S2'                                                        CGL091
     C           ETYP      OREQ '21O1'                                                        CGL091
     C           ETYP      OREQ '21E1'                                                        CGL091
     C           ETYP      OREQ '22S3'                                                        CGL091
     C           ETYP      OREQ '22S4'                                                        CGL091
     C           ETYP      OREQ '22O1'                                                        CGL091
     C           ETYP      OREQ '22E1'                                                        CGL091
     C           ETYP      OREQ '23O1'                                                        CGL091
     C           ETYP      OREQ '23E1'                                                        CGL091
     C           ETYP      OREQ '24O1'                                                        CGL091
     C           ETYP      OREQ '24E1'                                                        CGL091
     C           ETYP      OREQ '23C3'                                                        CGL091
     C           ETYP      OREQ '23C4'                                                        CGL091
     C           ETYP      OREQ '23S3'                                                        CGL091
     C           ETYP      OREQ '23S4'                                                        CGL091
     C           ETYP      OREQ '22C3'                                                        CGL091
     C           ETYP      OREQ '22C4'                                                        CGL091
     C*                                                                   S01221
      ** Set on *IN41 so that S.R.M. event types are not output to        LN0597
      ** spool file                                                       LN0597
     C                     MOVE '1'       *IN41                           LN0597
     C*                                                                   LN0597
     C           CIR003    IFEQ 'Y'                                                         AR743357
     C           DTYP      ANDEQ'RX'                                                        AR743357
      *                                                                                     AR743357
     C           *LIKE     DEFN DLNO      TDLNO                                             AR743357
     C                     Z-ADDDLNO      TDLNO                                             AR743357
     C           TDLNO     CHAINDEALS                05                                     AR743357
     C           *IN05     IFEQ '1'                                                         AR743357
     C                     MOVEL'DEALS   'DBFILE                                            AR743357
     C                     MOVEL'16'      DBASE                                             AR743357
     C                     MOVELDLNO      DBKEY                                             AR743357
     C                     EXSR *PSSR                                                       AR743357
     C                     MOVE '1'       *IN99                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
      *                                                                                     AR743357
     C           ETYP      IFEQ '23S3'                                                      AR743357
     C           ETYP      OREQ '23C3'                                                      AR743357
      *                                                                                     AR743357
     C           VDEI      IFEQ 'Y'                                                         AR743357
     C           EDAT      ANDEQVDAT                                                        AR743357
     C           PDEI      OREQ 'Y'                                                         AR743357
     C           EDAT      ANDNEVDAT                                                        AR743357
     C                     MOVE '0'       *IN41                                             AR743357
     C                     ELSE                                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
      *                                                                                     AR743357
     C                     ELSE                                                             AR743357
      *                                                                                     AR743357
     C           ETYP      IFEQ '23S4'                                                      AR743357
     C           ETYP      OREQ '23C4'                                                      AR743357
      *                                                                                     AR743357
     C           MDEI      IFEQ 'Y'                                                         AR743357
     C           EDAT      ANDEQMDAT                                                        AR743357
     C           PDEI      OREQ 'Y'                                                         AR743357
     C           EDAT      ANDNEMDAT                                                        AR743357
     C                     MOVE '0'       *IN41                                             AR743357
     C                     ELSE                                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
      *                                                                                     AR743357
     C                     ELSE                                                             AR743357
     C                     GOTO END                                                         AR743357
     C                     ENDIF                                                            AR743357
     C                     ENDIF                                                            AR743357
     C                     ELSE                                                             AR743357
      *                                                                                     AR743357
     C                     GOTO END                                       S01221
     C                     ENDIF                                                            AR743357
     C*                                                                   S01221
     C                     END                                            S01221
     C/COPY WNCPYSRC,GL0557C006
      *                                                                                       223572
     C                     MOVE ETYP      EVTP2   2                                           223572
      *                                                                                       223572
     C*                                                                   S01221
     C**  SKIP CAPITALISED INTEREST LOANS                                 E25263
     C           ETYP      IFEQ '61X2'                                    E25263
     C           ETYP      OREQ '62X2'                                    E25263
     C           ETYP      OREQ '64X2'                                    E25263
     C           ETYP      OREQ '66X2'                                    E25263
     C           ETYP      OREQ '70X2'                                    E25263
      *                                                                   CLE005
     C           CLE005    OREQ 'Y'                                       CLE005
     C           ETYP      ANDEQ'68X2'                                    CLE005
     C           CLE005    OREQ 'Y'                                       CLE005
     C           ETYP      ANDEQ'69X2'                                    CLE005
     C           CLE005    OREQ 'Y'                                       CLE005
     C           ETYP      ANDEQ'71X2'                                    CLE005
     C           CLE005    OREQ 'Y'                                       CLE005
     C           ETYP      ANDEQ'72X2'                                    CLE005
      *                                                                                       223572
     C           EVTP2     OREQ 'I6'                                                          223572
     C           EVTP2     OREQ 'V4'                                                          223572
     C           EVTP2     OREQ 'V6'                                                          223572
     C           EVTP2     OREQ 'M6'                                                          223572
     C           EVTP2     OREQ 'M8'                                                          223572
     C           EVTP2     OREQ 'R6'                                                          223572
     C           EVTP2     OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'63R4'                                                        223572
     C           EVTP2     OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'41R4'                                                        223572
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           ETYP      ANDEQ'80X2'                                                        CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           ETYP      ANDEQ'80H1'                                                        CLE028
     C*                                                                   E25263
      * Set on *IN41 so these event types are not output to spool file.   E25263
     C                     SETON                     41                   E25263
     C                     GOTO END                                       E25263
     C                     END                                            E25263
     C*                                                                   E25263
     C/COPY WNCPYSRC,GL0557C007
     C****SET*ON*DETAILS*TO REPORT INDICATOR AND OPEN P1 SPOOL FILE E102  E244
     C**N34****************OPEN DL0550P1                            E102  E244
0276 C***********          SETON                     34            E244   058817
0277 C*
0278 C*    ACC. AMOUNT OF DETAIL RECORDS READ
0279 C*
      * Keep separate record count for the Security (II) Events.          S01129
      *                                                                   S01129
     C           *IN26     IFEQ '1'                                       S01129
     C           *IN27     OREQ '1'                                       S01129
     C           *IN28     OREQ '1'                                       S01129
     C********** *IN29     OREQ '1'                                S01129 E20669
     C                     Z-ADD4         X                               S01129
     C                     ELSE                                           S01129
0279 C*
0280 C                     Z-ADD3         X
     C                     END                                            S01129
      *                                                                   S01129
0281 C                     EXSR HASH
0282 C*    TEST WHETHER EVENT IS TO BE REPORTED
0283 C*
0284 C                     SETOF                     3542
     C*    IF EVENT IS SECURITIES TRADING, INCLUDE UNSETTLED TRADE        E19293
     C*    WITH EVENT DATE < RUN DATE                                     E19293
     C*    + ALL PAST-DUE POSITION SETTLEMENT EVENTS                      087177
     C           *IN26     IFEQ '1'                                       E19293
     C           *IN27     OREQ '1'                                       087177
     C           *IN28     OREQ '1'                                       087177
     C           EDAT      COMP ZDYNBR               41                   E19293
     C                     ELSE                                           E19293
0285 C           EDAT      COMP ZDYNBR               41
0286 C**N41******EDAT******COMP RUND                   4141               S01194
0286 C  N41      EDAT      COMP BJRDNB                 4141               S01194
     C                     END                                            E19293
     C*                                                                   AUS017
     C*    IF TYPE = 'FX' (SELECT FX DAILY EVENTS ONLY)                   AUS017
     C*                                                                   AUS017
     C           TYPE      IFEQ 'FX'                                      AUS017
     C           *IN41     ANDEQ'0'                                       AUS017
     C*                                                                   AUS017
     C*    SELECT ONLY F.X. DEALS                                         AUS017
     C*                                                                   AUS017
     C                     MOVELETYP      ET12    2                       AUS017
     C*                                                                   AUS017
     C           ET12      IFNE '11'                                      AUS017
     C           ET12      ANDNE'12'                                      AUS017
     C           ET12      ANDNE'13'                                      AUS017
     C           ET12      ANDNE'14'                                      AUS017
     C           ETYP      ANDNE'CPV1'                                    CDL008
     C           ETYP      ANDNE'CRV1'                                    CDL008
     C                     MOVE '1'       *IN41                           AUS017
     C                     END                                            AUS017
     C*                                                                   AUS017
     C                     END                                            AUS017
     C*                                                                   AUS017
     C*    IF TYPE = 'MM' (SELECT MM DAILY EVENTS ONLY)                   AUS017
     C*                                                                   AUS017
     C           TYPE      IFEQ 'MM'                                      AUS017
     C           *IN41     ANDEQ'0'                                       AUS017
     C*                                                                   AUS017
     C*    SELECT ONLY F.X. DEALS                                         AUS017
     C*                                                                   AUS017
     C                     MOVELETYP      ET12    2                       AUS017
     C*                                                                   AUS017
     C           ET12      IFNE '15'                                      AUS017
     C           ET12      ANDNE'16'                                      AUS017
     C           ET12      ANDNE'17'                                      AUS017
     C           ET12      ANDNE'18'                                      AUS017
     C                     MOVE '1'       *IN41                           AUS017
     C                     END                                            AUS017
     C*                                                                   AUS017
     C                     END                                            AUS017
     C*                                                                   AUS017
0287 C*****DO*NOT*REPORT*ROLLOVER*DEAL*IF*EVENT*IS*'START'*(='V1')*****   CEU003
     C*    DO NOT REPORT ROLLOVER DEAL IF EVENT IS 'START'(='V1' OR 'VX') CEU003
0288 C                     MOVE ETYP      PART    2
0289 C           PART      COMP 'V1'                     47
     C  N47      PART      COMP 'VX'                     47               CEU003
0290 C   47      RLVI      COMP 'Y'                      47
      *                                                                   E23278
     C*****Do*not*Process*Deal*Events*with*ETPY*'M2'***************E23278 CEU003
     C*    Do not Process Deal Events with ETPY 'M2' or 'MY'              CEU003
     C           *IN02     IFEQ '1'                                       E23278
     C           PART      ANDEQ'M2'                                      E23278
     C           *IN02     OREQ '1'                                       CEU003
     C           PART      ANDEQ'MY'                                      CEU003
     C                     SETON                         41               E23278
     C                     GOTO END                                       E23278
     C                     END                                            E23278
      *                                                                   E23278
      **   Allow Deal Events having field 'FIPI' blank to be processed    E23278
     C***47*02***                                                         CLE004
0292 C**********OR 20 02                                                  E23278
0293 C*  20
0294 C** 20 02
0295 C***OR*21***             SETON                     41                CLE004
     C*****DO*NOT REPORT EVENT FOR FUTURE AND OPTION               S01127 073714
     C***82*****           SETON                     41            S01127 073714
      *                                                                   CLE004
     C           *IN47     IFEQ '1'                                       CLE004
     C           *IN02     ANDEQ'1'                                       CLE004
     C           *IN21     OREQ '1'                                       CLE004
     C           CLE004    ANDNE'Y'                                       CLE004
     C           *IN21     OREQ '1'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
     C           *IN13     ANDEQ'0'                                       CLE004
     C                     MOVE '1'       *IN41                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Report lending events with blank I/O indicator if it is          CLE004
      ** an internal parts purchased                                      CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN13     ANDEQ'1'                                       CLE004
     C           *IN21     ANDEQ'1'                                       CLE004
     C           LNRF      CHAINCLOAN                78                   CLE004
     C           *IN78     IFEQ '1'                                       CLE004
     C                     MOVEL'CLOAN   'DBFILE           ************   CLE004
     C                     MOVEL'05'      DBASE            * DBERR 05 *   CLE004
     C                     MOVELLNRF      DBKEY            ************   CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     MOVE '1'       *IN99                           CLE004
     C                     GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           LNKS      IFNE 'Y'                                       CLE004
     C                     MOVE '1'       *IN41                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   073714
     C** ONLY REPORT PREMIUM EVENTS FOR FUTURES & OPTIONS MODULE          073714
     C*                                                                   073714
     C***82***** ETYP      COMP '93V1'               4141  *                           073714 CGL091
     C*                                                                   073714
      *                                                                                       CGL091
      * Check for eligible FF events                                                          CGL091
     C           *IN82     IFEQ '1'                                                           CGL091
      *                                                                                       CGL091
     C           ETYP      IFEQ '93V1'                                                        CGL091
     C           ETYP      OREQ '94V1'                                                        CGL091
     C           ETYP      OREQ '94V2'                                                        CGL091
     C           ETYP      OREQ '95V1'                                                        CGL091
     C           ETYP      OREQ '95V2'                                                        CGL091
     C           ETYP      OREQ '96V1'                                                        CGL091
     C           ETYP      OREQ '96V2'                                                        CGL091
     C           ETYP      OREQ '97V1'                                                        CGL091
     C           ETYP      OREQ '97V2'                                                        CGL091
     C           ETYP      OREQ '98V1'                                                        CGL091
     C           ETYP      OREQ '98V2'                                                        CGL091
     C           ETYP      OREQ '99V1'                                                        CGL091
     C           ETYP      OREQ '99V2'                                                        CGL091
     C                     MOVE '0'       *IN41                                               CGL091
      *                                                                                       CGL091
      * Only report events for OTC instrument types                                           CGL091
     C           ISTT      CHAININTYP                99                                       CGL091
     C           *IN99     IFEQ '1'                                                           CGL091
     C                     SETON                     U7U8LR                                   CGL091
     C                     MOVEL'INTYP   'DBFILE                                              CGL091
     C                     MOVEL'99'      DBASE                                               CGL091
     C                     MOVELISTT      DBKEY                                               CGL091
     C                     GOTO END                                                           CGL091
     C                     END                                                                CGL091
     C           ISTI      IFNE 'Y'                                                           CGL091
     C                     MOVE '1'       *IN41                                               CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * else event type not required on report                                                CGL091
     C                     ELSE                                                               CGL091
     C                     MOVE '1'       *IN41                                               CGL091
     C                     END                                                                CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
0296 C   41                GOTO END
0297 C*
     C*****DO*NOT*REPORT*BOOK*EVENTS*                              S01186 E20669
     C***29*****           SETON                     41            S01186 E20669
     C***41*****           GOTO END                                S01186 E20669
     C*                                                                   S01186
0298 C*    THIS PART DONE FOR REPORTED DEAL EVENTS
0299 C*
0300 C   45                SETON                     46
0301 C  N44                SETON                     4344
      *                                                                   S01473
      ** If processing Leo records check for the Leo detail file having   S01473
      ** been read.                                                       S01473
      ** OR if processing TI events check for the Leo detail file having  CTI001
      ** been read.                                                       CTI001
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULDET     ANDEQ'Y'                                       S01473
     C           M#TION    OREQ 'Y'                                       CTI001
     C           ULDET     ANDEQ'Y'                                       CTI001
     C                     GOTO DATE                                      S01473
     C                     END                                            S01473
      *                                                                   S01473
0302 C   03                GOTO DATE
     C   13                GOTO DATE
     C***15****************GOTO DATE                                      S01196
     C***17*****           GOTO DATE                                      E20669
     C   26                GOTO DATE                                      S01129
     C   27                GOTO DATE                                      S01129
     C   28                GOTO DATE                                      S01129
     C   82                GOTO DATE                                      073714
     C***29*****           GOTO DATE                               S01129 E20669
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN54     ANDEQ'1'                                                           CAP204
     C                     GOTO DATE                                                          CAP204
     C                     ENDIF                                                              CAP204
     C           NGII      COMP 'Y'                      11
0303 C           PART      COMP 'M1'                     42
0304 C   42      ETYP      COMP '18M1'               4242
     C/COPY WNCPYSRC,GL0557C010
      *                                                                   CEU003
      ** Check for Event type 18MX                                        CEU003
     C           ETYP      IFNE '18M1'                                    CEU003
     C           *IN42     ANDEQ*OFF                                      CEU003
     C           PART      COMP 'MX'                     42               CEU003
     C   42      ETYP      COMP '18MX'               4242                 CEU003
     C                     ENDIF                                          CEU003
      *                                                                   035170
      ** If amount is taxable deduct tax from gross interest              035170
      *                                                                   035170
     C           TAXI      IFEQ 'Y'                                       035170
     C           *IN42     ANDEQ'1'                                       035170
     C/COPY WNCPYSRC,GLH00788
     C           OTHA      MULT BNHKTR    TAXA   130H                     035170
     C           TAXA      DIV  100       TAXA      H                     035170
     C           OTHA      SUB  TAXA      OTHA                            035170
     C/COPY WNCPYSRC,GLH00789
     C                     END                                            035170
      *                                                                   035170
0305 C   42      EAMT      ADD  OTHA      REPAMT 130
0306 C*
0307 C*****FOR*FX*EVENTS*PRINT*DEALT*BASE*CCY*RATE************************090909
0308 C                     MOVELETYP      ET12    2
0309 C***********ET12      COMP '11'                     35               090909
0310 C**N35******ET12      COMP '12'                     35               090909
0311 C**N35******ET12      COMP '13'                     35               090909
0312 C**N35******ET12      COMP '14'                     35               090909
0313 C*
     C**   SUPPRESS PRINTING OF RATE IF NX                                S01108
     C*****      ET12      COMP '10'                     23         S01108S01119
     C           ET12      IFEQ '10'                                      S01119
     C                     SETON                         23               S01119
     C                     END                                            S01119
0313 C*
0314 C*    CONVERT DAY NUMBERS TO ALPHAMERIC FORMAT
0315 C*
0316 C           DATE      TAG                             ** DATE TAG ***
0317 C                     Z-ADDEDAT      ZDAYNO
0318 C                     EXSR ZDATE2
0319 C                     MOVE ZADATE    EDATA   7
     C*                                                                   S01129
     C                     MOVE *BLANKS   OTHDA                           055798
     C           *IN26     IFEQ '0'                                       S01129
     C           *IN27     ANDEQ'0'                                       S01129
     C           *IN28     ANDEQ'0'                                       S01129
     C********** *IN29     ANDEQ'0'                                S01129 E20669
     C*                                                                   S01129
0320 C  N22                Z-ADDOTHD      ZDAYNO
0321 C  N22                EXSR ZDATE2
0322 C  N22                MOVE ZADATE    OTHDA   7
     C*                                                                   S01129
     C                     END                                            S01129
0323 C*
0324 C*    FOR C/L EVENTS MOVE INTEREST RATE TO FIELD WITH 8 DEC. POSNS.
0325 C*
0326 C   03                Z-ADDEINR      EINRX  128
     C   13                Z-ADDINTR      EINRX
0327 C*
0328 C*    OBTAIN EVENT NARRATIVE FOR OUTPUT TO REPORT
0329 C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0557CCP3                                           S01408
     C*                                                                   S01408
     C** SAVE THE EVENT DATE TO CONTROL SUBTOTAL OUTPUT WHEN NEW DATE                         CGL091
     C*                                                                                       CGL091
     C                     Z-ADDEDAT      SAVDAT  50                                          CGL091
     C           ETYP      IFEQ '    '                                    E20669
     C*                    MOVE *BLANKS   TABB                    E20669  E21676
     C                     MOVE *BLANKS   TABB                            E21676
     C                     MOVE *BLANKS   TABB2                                               CLE028
     C                     ELSE                                           E20669
      *                                                                                       CLE028
      ** If CLE028 is on and event is for flat rate loans,                                    CLE028
      ** use table TABA2/TABB2 so as to distinguish                                           CLE028
      ** event types '80M1' and '80M2' from that of TABA/TABB.                                CLE028
      *                                                                                       CLE028
     C           2         SUBSTETYP      WVAR2   2                                           CLE028
     C                     MOVE *OFF      *IN64                                               CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN13     ANDEQ*ON                                                           CLE028
     C           WVAR2     ANDEQ'80'                                                          CLE028
     C           ETYP      LOKUPTABA2     TABB2          50                                   CLE028
     C                     MOVE *ON       *IN64                                               CLE028
     C                     ELSE                                                               CLE028
0330 C           ETYP      LOKUPTABA      TABB           50
     C                     ENDIF                                                              CLE028
     C                     END                                            E20669
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0557CCP5                                           S01408
     C*                                                                   S01408
     C*                                                                   S01496
     C           *IN63     IFEQ '1'                        B*1            S01496
     C                     MOVE *BLANKS   EVNARR 15                       S01496
     C                     MOVE '0'       *IN62                           S01496
     C*                                                                   S01496
     C**  Record is from PF/TREVED and Due to ER indicator is on.         S01496
     C*                                                                   S01496
     C           *IN26     IFEQ '1'                        B*2            S01496
     C           WEARL     ANDEQ'Y'                                       S01496
     C*                                                                   S01496
     C                     MOVE '1'       *IN62                           S01496
     C*                                                                   S01496
     C**  Check In/Out indicator.                                         S01496
     C*                                                                   S01496
     C           INOI      IFEQ 'I'                        B*3            S01496
     C                     MOVELNARR,1    EVNARR                          S01496
     C                     ELSE                            X*3            S01496
     C                     MOVELNARR,2    EVNARR                          S01496
     C                     END                             E*3            S01496
     C                     END                             E*2            S01496
     C*                                                                   S01496
     C**  Record is from PF/CPEVED and Due to ER indicator is on.         S01496
     C*                                                                   S01496
     C           *IN27     IFEQ '1'                        B*2            S01496
     C           WEARL     ANDEQ'Y'                                       S01496
     C                     MOVE '1'       *IN62                           S01496
     C                     MOVELNARR,3    EVNARR                          S01496
     C                     END                             E*2            S01496
     C*                                                                   S01496
     C**  Record is from PF/DPEVED and Due to ER indicator is on.         S01496
     C*                                                                   S01496
     C           *IN28     IFEQ '1'                        B*2            S01496
     C           WEARL     ANDEQ'Y'                                       S01496
     C                     MOVE '1'       *IN62                           S01496
     C                     MOVELNARR,4    EVNARR                          S01496
     C                     END                             E*2            S01496
     C*                                                                   S01496
     C                     END                             E*1            S01496
     C*                                                                   CSE007
     C           *IN53     IFEQ '1'                        B*1            CSE007
     C                     MOVE *BLANKS   CANARR 15                       CSE007
     C                     MOVE '0'       *IN52                           CSE007
     C*                                                                   CSE007
     C**  Record is from PF/TREVED and Due to CA indicator is on.         CSE007
     C*                                                                   CSE007
     C           *IN26     IFEQ '1'                        B*2            CSE007
     C           WCOAF     ANDEQ'Y'                                       CSE007
     C*                                                                   CSE007
     C                     MOVE '1'       *IN52                           CSE007
     C*                                                                   CSE007
     C**  Check In/Out indicator.                                         CSE007
     C*                                                                   CSE007
     C           INOI      IFEQ 'I'                        B*3            CSE007
     C                     MOVELNARR1,1   CANARR                          CSE007
     C                     ELSE                            X*3            CSE007
     C                     MOVELNARR1,2   CANARR                          CSE007
     C                     END                             E*3            CSE007
     C                     END                             E*2            CSE007
     C*                                                                   CSE007
     C**  Record is from PF/CPEVED and Due to CA indicator is on.         CSE007
     C*                                                                   CSE007
     C           *IN27     IFEQ '1'                        B*2            CSE007
     C           WCOAF     ANDEQ'Y'                                       CSE007
     C                     MOVE '1'       *IN52                           CSE007
     C                     MOVELNARR1,3   CANARR                          CSE007
     C                     END                             E*2            CSE007
     C*                                                                   CSE007
     C**  Record is from PF/DPEVED and Due to CA indicator is on.         CSE007
     C*                                                                   CSE007
     C           *IN28     IFEQ '1'                        B*2            CSE007
     C           WCOAF     ANDEQ'Y'                                       CSE007
     C                     MOVE '1'       *IN52                           CSE007
     C                     MOVELNARR1,4   CANARR                          CSE007
     C                     END                             E*2            CSE007
     C*                                                                   CSE007
     C                     END                             E*1            CSE007
      *                                                                                       CIR007
      ** Change the 'Event Type' description to 'INT.ESTIMATE' if                             CIR007
      ** either side of the deal is an OIS and the event record                               CIR007
      ** represent an interest event for an IRS deal (ETYP='22I1')                            CIR007
      *                                                                                       CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
      *                                                                                       CIR007
     C           ETYP      IFEQ '22I1'                                                        CIR007
      *                                                                                       CIR007
     C                     MOVE *BLANKS   CANARR                                              CIR007
      *                                                                                       CIR007
      ** Call program DL1660 to obtain deal information from deals file                       CIR007
      ** DEALSDG.                                                                             CIR007
      *                                                                                       CIR007
     C                     CALL 'DL1660'                                                      CIR007
     C                     PARM DLNO      PDLNUM  60                                          CIR007
     C                     PARM 'N'       POIS    1                                           CIR007
     C                     PARM 'N'       PERR    1                                           CIR007
      *                                                                                       CIR007
     C           PERR      IFEQ 'Y'                                                           CIR007
     C                     MOVE *ON       *INU7                                               CIR007
     C                     MOVE *ON       *INU8                                               CIR007
     C                     MOVE *ON       *INLR                                               CIR007
     C                     MOVEL'14'      DBASE                                               CIR007
     C                     MOVEL'DEALSDG' DBFILE    P                                         CIR007
     C                     MOVELPDLNUM    DBKEY     P                                         CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
      ** Returned code POIS is equal to Y if either OUR or THEIR side                         CIR007
      ** of the deal is an OIS.                                                               CIR007
      *                                                                                       CIR007
     C           POIS      IFEQ 'Y'                                                           CIR007
     C                     MOVE *ON       *IN52                                               CIR007
     C                     MOVE WINEST    CANARR                                              CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0557CCP4                                           S01408
     C*                                                                   S01408
0331 C*
     C*
     C*       CUSTOMER LENDING COMMITMENT FEES EVENT (SETUP FIELDS)
     C   13      ETYP      COMP '71F2'                   48
     C***13*48*************MOVELFTYP      LNRF2                           E193
     C***13*48*************MOVE FSEQ      LNRF2                           E193
     C*
0332 C*
0333 C           INOI      COMP 'I'                      60
0334 C           INOI      COMP 'O'                      61
     C*                                                                   S01119
     C*    IF EVENT TYPE ENDS IN 'N1' DONT PRINT EVENT AMOUNT             S01119
     C*                                                                   S01119
     C                     MOVE ETYP      ALPH2                           S01119
     C           ALPH2     IFEQ 'N1'                                      S01119
     C                     MOVEA'00'      *IN,60                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*    IF EVENT TYPE ENDS IN 'N2' DONT PRINT EVENT                    S01119
     C*    EVENT MAY BE OUTPUT TO NOSEX FILE                              S01119
     C*                                                                   S01119
     C           ALPH2     IFEQ 'N2'                                      S01119
     C                     MOVEA'1'       *IN,41                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
0335 C*
0336 C*****TEST*WHETHER*EVENT*RECORD*IS TO BE OUTPUT TO NOSEX FILE        E193
0337 C***********SETP******COMP 01                       65               E193
0338 C**N65******SETP***** COMP 02                       65               E193
0339 C**N65******SETP******COMP 07                       65               E193
0340 C**N65******SETP******COMP 08                       65               E193
0341 C**N65******SETP******COMP 12                       65               E193
0342 C*
0343 C*    MAINTAIN TOTALS OF NUMBER AND VALUE OF RECORDS REPORTED,
0344 C*****AND*OF*NUMBER*AND*VALUE*OF*RECORDS*WRITTEN*TO*NOSEX*********   E193
0345 C*
0346 C                     SETOF                     81
     C           *IN41     IFEQ '0'                                       S01119
0347 C           RECREP    ADD  1         RECREP  50
0348 C                     Z-ADD1         X       10
0349 C                     EXSR HASH
     C                     END                                            S01119
0351 C   02      RLVI      COMP 'Y'                      81
0352 C   42 81   REPAMT    SUB  RBDA      REPAMT
     C*                                                                   S01392
     C* IF FRONT-UP INTEREST = Y                                          S01392
     C*                                                                   S01392
     C   02      FUID      IFEQ 'Y'                                       S01392
     C*                                                                   S01392
     C* INCLUDE INTEREST ON VALUE DATE EVENT                              S01392
     C*                                                                   S01392
     C           ETYP      IFEQ '15V1'                                    S01392
     C           ETYP      OREQ '16V1'                                    S01392
     C           ETYP      OREQ '15VX'                                    CEU003
     C           ETYP      OREQ '16VX'                                    CEU003
     C           EAMT      SUB  OTHA      REPAMT                          S01392
     C                     MOVE '1'       *IN42                           S01392
     C                     END                                            S01392
     C*                                                                   S01392
     C* IF MATURITY DATE EVENT WITH ROLLOVER, ACCESS ROLLOVER DEAL        S01392
     C* FOR NET SETTLEMENT AMOUNT (FRONT-UP INTEREST ON THAT DEAL)        S01392
     C*                                                                   S01392
     C           ETYP      IFEQ '15M1'                                    S01392
     C           ETYP      OREQ '16M1'                                    S01392
     C           ETYP      OREQ '15MX'                                    CEU003
     C           ETYP      OREQ '16MX'                                    CEU003
     C           RLVI      IFEQ 'Y'                                       S01392
     C           RBDN      CHAINDRSDEALS             99    *              S01392
     C           *IN99     IFEQ '1'                                       S01392
     C                     SETON                     U7U8LR               S01392
     C                     MOVEL'DRSDEALS'DBFILE                          S01392
     C                     MOVEL'04'      DBASE                           S01392
     C                     MOVELRBDN      DBKEY                           S01392
     C                     GOTO END                                       S01392
     C                     END                                            S01392
     C                     Z-ADDTOTI      REPAMT                          S01392
     C                     MOVE '1'       *IN42                           S01392
     C                     MOVE 'Y'       ROLLY   1                                           CGL091
     C/COPY WNCPYSRC,GL0557C003
     C                     END                                            S01392
     C                     END                                            S01392
     C                     END                                            S01392
     C** SHOW REPAYMENT AMOUNT ON THE REPORT IF DEAL ROLLED OVER.
     C*******                                                             S03220
     C           *IN37     IFEQ '1'                        ## B001        S03220
     C                     MOVE 'F'       RECI             'FOR OUTPUT    S03220
     C*                                                                   S03220
     C           INOI      IFEQ 'I'                        ## B002        S03220
     C                     Z-ADDEAMT      INPYAM 130       'INOI = I      S03220
     C                     Z-ADD*ZEROS    OTPYAM 130                      S03220
     C                     ELSE                            ## X002        S03220
     C                     Z-ADDEAMT      OTPYAM           'INOI = O      S03220
     C                     Z-ADD*ZEROS    INPYAM                          S03220
     C                     END                             ## E002        S03220
     C*                                                                   S03220
     C           ETYP      IFEQ '91P3'                     ## B002        S03220
     C           ETYP      OREQ '91P5'                                    S03220
     C           ETYP      OREQ '91P7'                                    S03220
     C                     MOVE *BLANKS   OTHDA                           S03220
     C                     END                             ## E002        S03220
     C*                                                                   S03220
     C                     SETOF                     65                   S03220
     C           STNI      IFEQ 'Y'                        ## B002        S03220
     C                     SETON                     65    'OUTPUT        S03220
     C                     END                             ## E002        S03220
     C*                                                                   S03220
     C                     END                             ## E001        S03220
     C*                                                                   S01176
      *                                                                                       CAP204
      ** Move Incoming and Outgoing amount                                                    CAP204
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN54     ANDEQ'1'                                                           CAP204
     C           INOI      IFEQ 'I'                                                           CAP204
     C                     Z-ADDEAMT      INAMT  130                                          CAP204
     C                     Z-ADD0         OTAMT  130                                          CAP204
     C                     ELSE                                                               CAP204
     C                     Z-ADD0         INAMT                                               CAP204
     C                     Z-ADDEAMT      OTAMT                                               CAP204
     C                     ENDIF                                                              CAP204
     C                     ENDIF                                                              CAP204
      ** Convert Amounts to Euro equivalent for 'In' ccy                  CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           A6INCY    ANDEQ'Y'                                       CEU011
      *                                                                   CEU011
     C                     MOVE *ON       *IN39                           CEU011
     C                     MOVE *BLANKS   PRTCD                           CEU011
     C                     MOVE ECCY      PFRCY                           CEU011
     C                     MOVE BKEURO    PTOCY                           CEU011
     C                     Z-ADD0         POUTA                           CEU011
     C                     Z-ADD0         PINTA                           CEU011
     C                     Z-ADD0         PEXRT                           CEU011
     C                     MOVE *BLANKS   PMDIN                           CEU011
      *                                                                   CEU011
     C           *IN02     IFEQ *ON                                       CEU011
     C           *IN03     OREQ *ON                                       CEU011
     C           *IN13     OREQ *ON                                       CEU011
     C           *IN15     OREQ *ON                                       CEU011
     C           *IN26     OREQ *ON                                       CEU011
     C           *IN27     OREQ *ON                                       CEU011
     C           *IN28     OREQ *ON                                       CEU011
     C           *IN82     OREQ *ON                                       CEU011
      *                                                                   CEU011
     C                     Z-ADDEAMT      PFRAM                           CEU011
     C                     MOVEL'10'      WDBASE  2                       CEU011
     C                     EXSR SREURO                                    CEU011
     C                     Z-ADDPOUTA     WEAMT  130                      CEU011
      *                                                                   CEU011
     C           *IN82     IFEQ *OFF                                      CEU011
     C                     Z-ADDREPAMT    PFRAM                           CEU011
     C                     MOVEL'11'      WDBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C                     Z-ADDPOUTA     WPAMT  130                      CEU011
     C                     ENDIF                                          CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
     C           *IN37     IFEQ *ON                                       CEU011
      *                                                                   CEU011
     C                     Z-ADDINPYAM    PFRAM                           CEU011
     C                     MOVEL'12'      WDBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C                     Z-ADDPOUTA     WINPY  130                      CEU011
      *                                                                   CEU011
     C                     Z-ADDOTPYAM    PFRAM                           CEU011
     C                     MOVEL'13'      WDBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C                     Z-ADDPOUTA     WOTPY  130                      CEU011
     C                     ENDIF                                          CEU011
      *                                                                                       CAP204
      ** Convert amounts to EURO                                                              CAP204
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN54     ANDEQ'1'                                                           CAP204
     C                     Z-ADDINAMT     PFRAM                                               CAP204
     C                     MOVEL'14'      WDBASE                                              CAP204
     C                     EXSR SREURO                                                        CAP204
     C                     Z-ADDPOUTA     WINAMT 130                                          CAP204
      *                                                                                       CAP204
     C                     Z-ADDOTAMT     PFRAM                                               CAP204
     C                     MOVEL'15'      WDBASE                                              CAP204
     C                     EXSR SREURO                                                        CAP204
     C                     Z-ADDPOUTA     WOTAMT 130                                          CAP204
     C                     ENDIF                                                              CAP204
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C*  FOR EVENT TYPES  31B5, 31C5, 31D5, CHECK MATURITY DATE           S01176
     C*  INDICATOR                                                        S01176
     C*                                                                   S01176
     C           ETYP      IFEQ '31B5'                                    S01176
     C           ETYP      OREQ '31C5'                                    S01176
     C           ETYP      OREQ '31D5'                                    S01176
     C*                                                                   S01176
     C*  IF MATURITY DATE INDICATOR = 'O', SET ON INDICATOR TO            S01176
     C*  OUTPUT '* OVERDUE *' ON REPORT                                   S01176
     C*  IF MATURITY DATE INDICATOR = 'A', SET ON INDICATOR TO            S01176
     C*  OUTPUT '* APPROXIMATE *' ON REPORT                               S01176
     C*                                                                   S01176
     C           MDTI      IFEQ 'O'                                       S01176
     C                     MOVE '1'       *IN75                           S01176
     C                     ELSE                                           S01176
     C                     MOVE '0'       *IN75                           S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C           MDTI      IFEQ 'A'                                       S01176
     C                     MOVE '1'       *IN76                           S01176
     C                     ELSE                                           S01176
     C                     MOVE '0'       *IN76                           S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C                     ELSE                                           S01176
     C                     MOVE '0'       *IN75                           S01176
     C                     MOVE '0'       *IN76                           S01176
     C                     END                                            S01176
0358 C*
     C           *IN41     IFEQ '0'                                       E244
     C           SWRIT     IFEQ 0                                         E244
     C           SWRIT     OREQ @BKBIN                                    E244
     C*********************OPEN DL0550P1                              E244E22608
     C**********           OPEN GL0550P1                                               E22608 CGL091
     C                     OPEN GL0557P1                                                      CGL091
     C                     MOVE '1'       *IN34                           E244
     C                     END                                            E244
     C                     END                                            E244
      *                                                                   CLE004
      ** For CLE004, if a LE event is read that is an internal parts      CLE004
      ***purchased,*output*to*GL0550P2******************************                   CLE004 CGL091
      ** purchased, output to GL0557P2                                                        CGL091
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN13     ANDEQ'1'                                       CLE004
     C           *IN21     ANDEQ'1'                                       CLE004
     C           LNKS      ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      ** Write details of internal parts purchased                        CLE004
      *                                                                   CLE004
     C                     MOVE CRNM      RCRNM                           CLE004
     C                     MOVE CTWN      RCTWN                           CLE004
     C           *IN48     IFEQ '0'                                       CLE004
     C                     MOVE LNRF      RLNRF                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVELFTYP      RLNRF                           CLE004
     C                     MOVEL'/'       WTEMP   3                       CLE004
     C                     MOVE FSEQ      WTEMP                           CLE004
     C                     MOVE WTEMP     RLNRF                           CLE004
     C                     ENDIF                                          CLE004
     C                     MOVE EDATA     REDAT                           CLE004
     C                     MOVE TABB      RENAR                           CLE004
     C                     MOVE OTHDA     ROTHD                           CLE004
     C                     MOVE EAMT      ZFLD15                          CLE004
     C                     MOVE 'J'       ZECODE                          CLE004
     C                     Z-ADDA6NBDP    ZDECS                           CLE004
     C                     EXSR ZSEDIT                                    CLE004
     C                     MOVE ZOUT21    REAMT                           CLE004
     C                     MOVE EINRX     ZFLD15                          CLE004
     C                     Z-ADD8         ZDECS                           CLE004
     C                     EXSR ZSEDIT                                    CLE004
     C                     MOVE ZOUT21    RINTR                           CLE004
      *                                                                   CLE004
      ** Write on a new page for overflows or new currencies              CLE004
      *                                                                   CLE004
     C           *IN79     IFEQ '1'                                       CLE004
     C           A6CYNM    ORNE RCYNM                                     CLE004
     C                     MOVE A6CYNM    RCYNM                           CLE004
     C                     WRITEHEADP2                                    CLE004
     C                     WRITECOLMP2                                    CLE004
     C                     MOVE '0'       *IN79                           CLE004
     C                     ENDIF                                          CLE004
     C                     WRITEDETLP2                                    CLE004
     C                     MOVE '1'       *IN41                           CLE004
     C                     MOVE '1'       *IN77                           CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
     C*******                                                             S03220
0350 C**N65****************GOTO END                                       E193
0353 C***********RECRIT****ADD  1         RECRIT  50                      E193
0354 C*********************Z-ADD2         X                               E193
0355 C*********************EXSR HASH                                      E193
     C**                                                                                      CGL091
     C** SETUP THE OUTPUT FIELDS FOR THE NEW COLUMNS                                          CGL091
     C           *IN41     IFEQ '0'                                                           CGL091
     C** CLEAR THE FIELDS                                                                     CGL091
     C                     Z-ADD*ZEROS    PRAMT  130                                          CGL091
     C                     Z-ADD*ZEROS    INTAMT 130                                          CGL091
     C                     MOVE ETYP      TEST2   2                                           CGL091
     C           TEST2     IFEQ 'V1'                                                          CGL091
     C           TEST2     OREQ 'V2'                                                          CGL091
     C           TEST2     OREQ 'V3'                                                          CGL091
     C           TEST2     OREQ 'M4'                                                          CGL091
     C           TEST2     OREQ 'R1'                                                          CGL091
     C           TEST2     OREQ 'R3'                                                          CGL091
     C           TEST2     OREQ 'M1'                                                          CGL091
      *                                                                                       CGL091
      * Include FRA/IRS notional principal amounts and SE trade,                              CGL091
      * part payment, mortgage and maturity amounts in principal                              CGL091
      * column                                                                                CGL091
     C           ETYP      OREQ '21S1'                                                        CGL091
     C           ETYP      OREQ '21S2'                                                        CGL091
     C           ETYP      OREQ '21C1'                                                        CGL091
     C           ETYP      OREQ '21C2'                                                        CGL091
     C           ETYP      OREQ '22S1'                                                        CGL091
     C           ETYP      OREQ '22S2'                                                        CGL091
     C           ETYP      OREQ '22C1'                                                        CGL091
     C           ETYP      OREQ '22C2'                                                        CGL091
     C           ETYP      OREQ '23S1'                                                        CGL091
     C           ETYP      OREQ '23S2'                                                        CGL091
     C           ETYP      OREQ '23C1'                                                        CGL091
     C           ETYP      OREQ '23C2'                                                        CGL091
     C           ETYP      OREQ '24S1'                                                        CGL091
     C           ETYP      OREQ '24S2'                                                        CGL091
     C           ETYP      OREQ '24C1'                                                        CGL091
     C           ETYP      OREQ '24C2'                                                        CGL091
     C           ETYP      OREQ '31P1'                                                        CGL091
     C           ETYP      OREQ '31S1'                                                        CGL091
     C           ETYP      OREQ '31C1'                                                        CGL091
     C           ETYP      OREQ '31C4'                                                        CGL091
     C           ETYP      OREQ '31C5'                                                        CGL091
     C           ETYP      OREQ '31D1'                                                        CGL091
     C           ETYP      OREQ '31D4'                                                        CGL091
     C           ETYP      OREQ '31D5'                                                        CGL091
     C                     Z-ADDEAMT      PRAMT                                               CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * Include FRA/IRS notional interest amounts and SE coupon                               CGL091
      * and dividend amounts in interest column                                               CGL091
     C           TEST2     IFEQ 'I2'                                                          CGL091
     C           TEST2     OREQ 'R2'                                                          CGL091
     C           TEST2     OREQ 'M2'                                                          CGL091
     C           ETYP      OREQ '21S3'                                                        CGL091
     C           ETYP      OREQ '21C3'                                                        CGL091
     C           ETYP      OREQ '22I1'                                                        CGL091
     C           ETYP      OREQ '23I1'                                                        CGL091
     C           ETYP      OREQ '24I1'                                                        CGL091
     C           ETYP      OREQ '31C2'                                                        CGL091
     C           ETYP      OREQ '31C3'                                                        CGL091
     C           ETYP      OREQ '31D2'                                                        CGL091
     C           ETYP      OREQ '31D3'                                                        CGL091
     C                     Z-ADDEAMT      INTAMT                                              CGL091
     C                     END                                                                CGL091
     C** IF 42 = 'M1'                                                                         CGL091
     C   42                Z-ADDEAMT      PRAMT                                               CGL091
     C   42                Z-ADDOTHA      INTAMT                                              CGL091
     C* ROLLOVER DEAL                                                                         CGL091
     C   42      ROLLY     IFEQ 'Y'                                                           CGL091
     C                     Z-ADDREPAMT    INTAMT                                              CGL091
     C                     Z-ADD*ZEROS    PRAMT                                               CGL091
     C                     END                                                                CGL091
     C** IF ROLLOVER AMOUNT IS ZEROS - REPORT OTHERS AS ZEROS                                 CGL091
     C   42      REPAMT    IFEQ *ZEROS                                                        CGL091
     C                     Z-ADD*ZEROS    PRAMT                                               CGL091
     C                     Z-ADD*ZEROS    INTAMT                                              CGL091
     C                     END                                                                CGL091
     C*                                                                                       CGL091
     C** IF ETYP IS "N1" - DO NOT REPORT THE AMOUNT                                           CGL091
     C           TEST2     IFEQ 'N1'                                                          CGL091
     C                     Z-ADD*ZEROS    PRAMT                                               CGL091
     C                     Z-ADD*ZEROS    INTAMT                                              CGL091
     C                     Z-ADD*ZEROS    EAMT                                                CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * FRA/IRS notional principal events and FF option events should                         CGL091
      * not be reckoned in Total column but should only show amount                           CGL091
     C           ETYP      IFEQ '21S1'                                                        CGL091
     C           ETYP      OREQ '21S2'                                                        CGL091
     C           ETYP      OREQ '21S3'                                                        CGL091
     C           ETYP      OREQ '21C1'                                                        CGL091
     C           ETYP      OREQ '21C2'                                                        CGL091
     C           ETYP      OREQ '22S1'                                                        CGL091
     C           ETYP      OREQ '22S2'                                                        CGL091
     C           ETYP      OREQ '22C1'                                                        CGL091
     C           ETYP      OREQ '22C2'                                                        CGL091
     C           ETYP      OREQ '23S1'                                                        CGL091
     C           ETYP      OREQ '23S2'                                                        CGL091
     C           ETYP      OREQ '23C1'                                                        CGL091
     C           ETYP      OREQ '23C2'                                                        CGL091
     C           ETYP      OREQ '24S1'                                                        CGL091
     C           ETYP      OREQ '24S2'                                                        CGL091
     C           ETYP      OREQ '24C1'                                                        CGL091
     C           ETYP      OREQ '24C2'                                                        CGL091
     C           ETYP      OREQ '96V1'                                                        CGL091
     C           ETYP      OREQ '96V2'                                                        CGL091
     C           ETYP      OREQ '97V1'                                                        CGL091
     C           ETYP      OREQ '97V2'                                                        CGL091
     C           ETYP      OREQ '98V1'                                                        CGL091
     C           ETYP      OREQ '98V2'                                                        CGL091
     C           ETYP      OREQ '99V1'                                                        CGL091
     C           ETYP      OREQ '99V2'                                                        CGL091
     C                     Z-ADD*ZEROS    EAMT                                                CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * For Rate swap and cap/collar/floor deal events, set the other                         CGL091
      * date to the rate change date prior to this event date - this is                       CGL091
      * obtained by reading backwards through the IRS date schedule                           CGL091
      * file. If no schedule is found then the last date is calculated                        CGL091
      * based on the rate change frequencies of each side of the deal                         CGL091
     C           ETYP      IFEQ '22I1'                                                        CGL091
     C           ETYP      OREQ '22S1'                                                        CGL091
     C           ETYP      OREQ '22S2'                                                        CGL091
     C           ETYP      OREQ '22C1'                                                        CGL091
     C           ETYP      OREQ '22C2'                                                        CGL091
     C           ETYP      OREQ '23I1'                                                        CGL091
     C           ETYP      OREQ '23S1'                                                        CGL091
     C           ETYP      OREQ '23S2'                                                        CGL091
     C           ETYP      OREQ '23C1'                                                        CGL091
     C           ETYP      OREQ '23C2'                                                        CGL091
     C           ETYP      OREQ '24I1'                                                        CGL091
     C           ETYP      OREQ '24S1'                                                        CGL091
     C           ETYP      OREQ '24S2'                                                        CGL091
     C           ETYP      OREQ '24C1'                                                        CGL091
     C           ETYP      OREQ '24C2'                                                        CGL091
      *                                                                                       CGL091
     C           EVNTKY    KLIST                                                              CGL091
     C                     KFLD           DLNO                                                CGL091
     C                     KFLD           EDAT                                                CGL091
      *                                                                                       CGL091
     C           EVNTKY    SETLLDLDTSCD0                                                      CGL091
     C                     READPDLDTSCD0                 99                                   CGL091
      *                                                                                       CGL091
      * If end of file or different deal number, then retrieve deal                           CGL091
      * details to enable last rate change date to be calculated                              CGL091
      * based on the floating side rate fix frequency                                         CGL091
     C           *IN99     IFNE '1'                                                           CGL091
     C           @DLNO     ANDEQDLNO                                                          CGL091
     C                     Z-ADDPRDT      ZDAYNO                                              CGL091
     C                     EXSR ZDATE2                                                        CGL091
     C                     MOVE ZADATE    OTHDA   7                                           CGL091
     C                     MOVE '0'       *IN22                                               CGL091
     C                     ELSE                                                               CGL091
     C           DLNO      CHAINDLDLDGDE             99                                       CGL091
      *                                                                                       CGL091
      * Database error if deal not found                                                      CGL091
     C           *IN99     IFEQ '1'                                                           CGL091
     C                     MOVEL'DEALSDG' DBFILE           ************                       CGL091
     C                     MOVEL'99'      DBASE            * DBERR 99 *                       CGL091
     C                     MOVELDLNO      DBKEY            ************                       CGL091
     C                     EXSR *PSSR                                                         CGL091
     C                     GOTO END                                                           CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * Check rate change frequency for both sides of deal and                                CGL091
      * calculate last rate change dates based on frequencies.                                CGL091
      * If no frequency specified then default to deal value date.                            CGL091
      * Output the later of the two dates calculated                                          CGL091
     C                     MOVE RUICFR    WUICFR  1                                           CGL091
     C                     MOVE RTICFR    WTICFR  1                                           CGL091
     C                     SELEC                                                              CGL091
     C           WUICFR    WHEQ *BLANK                                                        CGL091
     C                     Z-ADDRVDAT     UOTHD   50                                          CGL091
     C           WUICFR    WHEQ 'Z'                                                           CGL091
     C                     Z-ADDRVDAT     UOTHD                                               CGL091
     C           WUICFR    WHEQ 'Y'                                                           CGL091
     C           EDAT      SUB  365       UOTHD                                               CGL091
     C           WUICFR    WHEQ 'Q'                                                           CGL091
     C           EDAT      SUB  91        UOTHD                                               CGL091
     C           WUICFR    WHEQ 'M'                                                           CGL091
     C           EDAT      SUB  31        UOTHD                                               CGL091
     C           WUICFR    WHEQ 'X'                                                           CGL091
     C           EDAT      SUB  183       UOTHD                                               CGL091
     C                     ENDSL                                                              CGL091
      *                                                                                       CGL091
     C                     SELEC                                                              CGL091
     C           WTICFR    WHEQ *BLANK                                                        CGL091
     C                     Z-ADDRVDAT     TOTHD   50                                          CGL091
     C           WTICFR    WHEQ 'Z'                                                           CGL091
     C                     Z-ADDRVDAT     TOTHD                                               CGL091
     C           WTICFR    WHEQ 'Y'                                                           CGL091
     C           EDAT      SUB  365       TOTHD                                               CGL091
     C           WTICFR    WHEQ 'Q'                                                           CGL091
     C           EDAT      SUB  91        TOTHD                                               CGL091
     C           WTICFR    WHEQ 'M'                                                           CGL091
     C           EDAT      SUB  31        TOTHD                                               CGL091
     C           WTICFR    WHEQ 'X'                                                           CGL091
     C           EDAT      SUB  183       TOTHD                                               CGL091
     C                     ENDSL                                                              CGL091
      *                                                                                       CGL091
     C           UOTHD     IFGT TOTHD                                                         CGL091
     C                     Z-ADDUOTHD     ZDAYNO                                              CGL091
     C                     ELSE                                                               CGL091
     C                     Z-ADDTOTHD     ZDAYNO                                              CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
     C                     EXSR ZDATE2                                                        CGL091
     C                     MOVE ZADATE    OTHDA   7                                           CGL091
     C                     MOVE '0'       *IN22                                               CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * For IRS interest events check if our/their interest processing                        CGL091
      * method is 'C' (capitalize). For these interest events, the                            CGL091
      * event amount should only show in the total column on maturity                         CGL091
      * date since this is the actual date of payment.                                        CGL091
     C           ETYP      IFEQ '22I1'                                                        CGL091
     C           ETYP      OREQ '23I1'                                                        CGL091
     C           ETYP      OREQ '24I1'                                                        CGL091
      *                                                                                       CGL091
     C           DLNO      CHAINDLDLDGDE             99                                       CGL091
      *                                                                                       CGL091
      * Database error if deal not found                                                      CGL091
     C           *IN99     IFEQ '1'                                                           CGL091
     C                     MOVEL'DEALSDG' DBFILE           ************                       CGL091
     C                     MOVEL'98'      DBASE            * DBERR 98 *                       CGL091
     C                     MOVELDLNO      DBKEY            ************                       CGL091
     C                     EXSR *PSSR                                                         CGL091
     C                     SETON                     99                                       CGL091
     C                     GOTO END                                                           CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * If both sides are capitalizing and event date *NE maturity                            CGL091
      * date, then set event amount to zero - no further processing                           CGL091
      * required                                                                              CGL091
     C           RUINPM    IFEQ 'C'                                                           CGL091
     C           RTINPM    ANDEQ'C'                                                           CGL091
      *                                                                                       CGL091
     C           EDAT      IFNE RMDAT                                                         CGL091
     C                     Z-ADD0         EAMT                                                CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * If only one side is using method 'C', need to determine                               CGL091
      * whether the event is on the side that is capitalizing                                 CGL091
     C           RUINPM    IFEQ 'C'                                                           CGL091
     C           RTINPM    ANDNE'C'                                                           CGL091
     C           RTINPM    OREQ 'C'                                                           CGL091
     C           RUINPM    ANDNE'C'                                                           CGL091
      *                                                                                       CGL091
      * If amount is incoming, check Their side                                               CGL091
     C           INOI      IFEQ 'I'                                                           CGL091
     C           RTINPM    IFEQ 'C'                                                           CGL091
     C           EDAT      ANDNERMDAT                                                         CGL091
     C                     Z-ADD0         EAMT                                                CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
      * else amount is outgoing, check Our side                                               CGL091
     C                     ELSE                                                               CGL091
     C           RUINPM    IFEQ 'C'                                                           CGL091
     C           EDAT      ANDNERMDAT                                                         CGL091
     C                     Z-ADD0         EAMT                                                CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
     C                     END                                                                CGL091
     C                     END                                                                CGL091
     C                     END                                                                CGL091
      *                                                                                       CGL091
     C           *IN41     IFEQ *OFF                                                          CGL091
     C           *IN34     IFEQ *ON                                                           CGL091
     C           *IN02     IFEQ *ON                                                           CGL091
     C           *IN03     OREQ *ON                                                           CGL091
     C           *IN13     OREQ *ON                                                           CGL091
     C           *IN15     OREQ *ON                                                           CGL091
     C           *IN26     OREQ *ON                                                           CGL091
     C           *IN27     OREQ *ON                                                           CGL091
     C           *IN28     OREQ *ON                                                           CGL091
     C           *IN37     OREQ *ON                                                           CGL091
     C           *IN82     OREQ *ON                                                           CGL091
      *                                                                                       CGL091
     C** IF OUTGOING AMOUNT REVERSE THE SIGN (-)                                              CGL091
     C           *IN61     IFEQ '1'                                                           CGL091
     C                     Z-SUBPRAMT     PRAMT                                               CGL091
     C                     Z-SUBINTAMT    INTAMT                                              CGL091
     C  N42                Z-SUBEAMT      EAMT                                                CGL091
     C   42                Z-SUBREPAMT    REPAMT                                              CGL091
     C                     END                                                                CGL091
     C** MAINTAIN SUBTOTAL FOR EACH COLUMN                                                    CGL091
     C           TPAMT     ADD  PRAMT     TPAMT                                               CGL091
     C           TINTAM    ADD  INTAMT    TINTAM                                              CGL091
     C   42      TTAMT     ADD  REPAMT    TTAMT                                               CGL091
     C  N42N82   TTAMT     ADD  EAMT      TTAMT                                               CGL091
     C           *IN37     IFEQ '1'                                                           CGL091
     C   60      TTAMT     ADD  INPYAM    TTAMT                                               CGL091
     C   61      TTAMT     SUB  OTPYAM    TTAMT                                               CGL091
     C                     END                                                                CGL091
     C           *IN82     IFEQ '1'                                                           CGL091
     C   60      TTAMT     ADD  EAMT      TTAMT                                               CGL091
     C   61      TTAMT     SUB  EAMT      TTAMT                                               CGL091
     C                     END                                                                CGL091
      *                                                                                     AR407101
     C                     ENDIF                                                            AR407101
     C                     ENDIF                                                            AR407101
     C                     ENDIF                                                            AR407101
      *                                                                                     AR407101
     C                     END                                                                CGL091
     C**                                                                                      CGL091
     C/COPY WNCPYSRC,GL0557C004
0356 C                     GOTO END
0357 C           TRAIL     TAG                             ** TRAIL TAG **
     C*
     C  N70                Z-ADD0         ZZTOTI
     C  N70                Z-ADD0         ZZTOTD
     C  N70                Z-ADD0         NORED
     C  N70                SETON                     70
     C*
0359 C*    PROCESS TRAILER  RECORD
0358 C*
     C           *IN04     IFEQ '1'
     C*                    SETON                     24                   S01125
     C**********           Z-ADDHRWN      ZZTOTI                          E20669
     C**********           Z-ADDHRDC      ZZTOTD                          E20669
     C**********           Z-ADDNORE      NORED   50                      105140
     C                     Z-ADDNORE      NORED   90                      105140
     C                     END
0358 C*
     C           *IN14     IFEQ '1'
     C**********           Z-ADDHRWN      ZZAMTI                          E20669
     C**********           Z-ADDHRDC      ZZAMTD                          E20669
     C                     EXSR GLZSUM
     C********** NORE      ADD  NORED     NORED                           105140
     C           NORE0     ADD  NORED     NORED                           105140
     C           NORED     SUB  1         NORED
     C                     END
     C*
     C           *IN12     IFEQ '1'
     C**********           Z-ADDHRWN      ZZAMTI                          E20669
     C**********           Z-ADDHRDC      ZZAMTD                          E20669
     C                     EXSR GLZSUM
     C           NORE      ADD  NORED     NORED
     C           NORED     SUB  1         NORED
     C                     END
     C***LETTERS*OF*CREDIT*TRAILER**                                      S01196
     C************IN16*****IFEQ '1'                                       S01196
     C*********************Z-ADDHRWN      ZZAMTI                          S01196
     C*********************Z-ADDHRDC      ZZAMTD                          S01196
     C*********************EXSR GLZSUM                                    S01196
     C***********NORE******ADD  NORED     NORED                           S01196
     C***********NORED*****SUB  1         NORED                           S01196
     C*********************END                                            S01196
      *                                                                   S01473
      ** If processing LEO records, check for the Leo trailer having      S01473
      ** been read.                                                       S01473
      ** Also if processing TI events                                     CTI001
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULTRL     ANDEQ'Y'                                       S01473
     C           M#TION    OREQ 'Y'                                       CTI001
     C           ULTRL     ANDEQ'Y'                                       CTI001
     C                     Z-ADDHRWN      ZZAMTI                          S01473
     C                     Z-ADDHRDC      ZZAMTD                          S01473
     C                     EXSR GLZSUM                                    S01473
     C           NORE      ADD  NORED     NORED                           S01473
     C           NORED     SUB  1         NORED                           S01473
     C                     END                                            S01473
      *                                                                   S01473
     C***SECURITIES*TRADING*TRAILER****                                   E20669
     C********** *IN18     IFEQ '1'                                       E20669
     C***24*****           Z-ADDHRWN      ZZAMTI                   S01125 E20669
     C***24*****           Z-ADDHRDC      ZZAMTD                   S01125 E20669
     C**N24*****           Z-ADDHRWN      ZZTOTI                   S01125 E20669
     C**N24*****           Z-ADDHRDC      ZZTOTD                   S01125 E20669
     C***24*****           EXSR GLZSUM                             S01125 E20669
     C**********           Z-ADDHRWN      ZZAMTI                   S01125 E20669
     C**********           Z-ADDHRDC      ZZAMTD                   S01125 E20669
     C**********           EXSR GLZSUM                             S01125 E20669
     C********** NORE      ADD  NORED     NORED                           E20669
     C**********           END                                            E20669
     C*  'FT' TRAILER                                                     S03220
     C           *IN38     IFEQ '1'                                       S03220
     C**********           Z-ADDHRWN      ZZAMTI                   S03220 E20669
     C**********           Z-ADDHRDC      ZZAMTD                   S03220 E20669
     C                     EXSR GLZSUM                                    S03220
     C           NORE      ADD  NORED     NORED                           S03220
     C                     END                                            S03220
     C*  FINANCIAL FUTURE                                                 S01127
     C           *IN83     IFEQ '1'                                       S01127
     C**********           Z-ADDHRWN      ZZAMTI                   S01127 E20669
     C**********           Z-ADDHRDC      ZZAMTD                   S01127 E20669
     C                     EXSR GLZSUM                                    S01127
     C           NORE      ADD  NORED     NORED                           S01127
     C                     END                                            S01127
      *                                                                                       CAP204
      ** Generated Entries Trailer                                                            CAP204
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN55     ANDEQ'1'                                                           CAP204
     C                     EXSR GLZSUM                                                        CAP204
     C           NORE      ADD  NORED     NORED                                               CAP204
     C                     END                                                                CAP204
     C/EJECT                                                              S01129
0364 C           END       TAG                             ** END TAG **
     C**                                                            E102  E244
     C*   SET ON DETAILS TO REPORT INDICATOR AND OPEN P1 SPOOL FILE E102  E244
     C***34N41*46**********OPEN DL0550P1                            E102  E244
     C*
     C                     MOVE *BLANKS   PDLNO   6                       S01129
     C**N27N28N29***       MOVE DLNO      PDLNO                    S01129 E20669
     C  N27N28             MOVE DLNO      PDLNO                           E20669
      *                                                                   S01473
      ** If Leo records are being processed, check for Leo detail records S01473
      ** having been read, if they have set on *in15 for output           S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           M#TION    OREQ 'Y'                                                           189129
      *                                                                   S01473
     C           ULDET     IFEQ 'Y'                                       S01473
     C                     SETON                       15                 S01473
     C                     ELSE                                           S01473
     C                     SETOF                       15                 S01473
     C                     END                                            S01473
      *                                                                   S01473
      * Reset the Leo Detail and Trailer records read flags               S01473
     C                     MOVE *BLANK    ULDET                           S01473
     C                     MOVE *BLANK    ULTRL                           S01473
     C                     END                                            S01473
      *                                                                                       CGL091
      ** Last record subtotal processing                                                      CGL091
      *                                                                                       CGL091
     CLR 34                EXCPTSUBTL                                                         CGL091
      *                                                                                       CGL091
      * After output of subtotal, output running total                                        CGL091
     CLR                   ADD  TPAMT     RPAMT  130                                          CGL091
     CLR                   ADD  TINTAM    RINTAM 130                                          CGL091
     CLR                   ADD  TTAMT     RTAMT  130                                          CGL091
     CLR 34                EXCPTRUNTL                                                         CGL091
     C/COPY WNCPYSRC,GL0557C009
0365 C*
0366 C*    T O T A L   T I M E   C A L C U L A T I O N S
0367 C*
0358 C*
      *                                                                   S01129
      **  Read Securities Trading 2 Audit files and print separate        S01129
      **   totals.                                                        S01129
     CLR         *INU5     IFEQ '0'                                       S01129
     C*LR**********         Z-ADD0         HRWN                    S01129 E20669
     C*LR**********         Z-ADD0         HRDC                    S01129 E20669
     CLR                   Z-ADD0         HRWN                            E26329
     CLR                   Z-ADD0         HRDC                            E26329
     CLR                   Z-ADD0         NORE                            S01129
      *                                                                   S01129
      ** Save previous accumulater values.                                S01129
     CLR                   Z-ADDZZTOTI    #TOTI  150                      S01129
     CLR                   Z-ADDZZTOTD    #TOTD   30                      S01129
      *                                                                   S01129
      ** Read all Audit files.                                            S01129
     CLR         1         CHAINTREVEAF              19                   S01129
     C*LR*********          Z-ADDHRWN      ZZTOTI                  S01129 E20669
     C*LR*********          Z-ADDHRDC      ZZTOTD                  S01129 E20669
     CLR                   Z-ADDHRWN      ZZTOTI                          E26329
     CLR                   Z-ADDHRDC      ZZTOTD                          E26329
     CLR                   Z-ADDNORE      #SEREC  50                      S01129
      *                                                                   S01129
     CLR         1         CHAINCPEVEAF              19                   S01129
     CLR         *IN19     IFEQ '0'                                       S01129
     C*LR********           Z-ADDHRWN      ZZAMTI                  S01129 E20669
     C*LR*********          Z-ADDHRDC      ZZAMTD                  S01129 E20669
     CLR                   Z-ADDHRWN      ZZAMTI                          E26329
     CLR                   Z-ADDHRDC      ZZAMTD                          E26329
     CLR                   EXSR GLZSUM                                    S01129
     CLR                   ADD  NORE      #SEREC                          S01129
     CLR                   END                                            S01129
      *                                                                   S01129
     CLR         1         CHAINDPEVEAF              19                   S01129
     CLR         *IN19     IFEQ '0'                                       S01129
     C*LR*********          Z-ADDHRWN      ZZAMTI                  S01129 E20669
     C*LR*********          Z-ADDHRDC      ZZAMTD                  S01129 E20669
     CLR                   Z-ADDHRWN      ZZAMTI                          E26329
     CLR                   Z-ADDHRDC      ZZAMTD                          E26329
     CLR                   EXSR GLZSUM                                    S01129
     CLR                   ADD  NORE      #SEREC                          S01129
     CLR                   END                                            S01129
      *                                                                   S01129
     CLR         1         CHAINBPEVEAF              19                   S01129
     CLR         *IN19     IFEQ '0'                                       S01129
     C*LR*********          Z-ADDHRWN      ZZAMTI                  S01129 E20669
     C*LR*********          Z-ADDHRDC      ZZAMTD                  S01129 E20669
     CLR                   Z-ADDHRWN      ZZAMTI                          E26329
     CLR                   Z-ADDHRDC      ZZAMTD                          E26329
     CLR                   EXSR GLZSUM                                    S01129
     CLR                   ADD  NORE      #SEREC                          S01129
     CLR                   END                                            S01129
      *                                                                   S01129
     CLR                   Z-ADDZZTOTI    #SETI  150                      S01129
     CLR                   Z-ADDZZTOTD    #SETD   30                      S01129
     CLR                   END                                            S01129
      /EJECT                                                              S01129
     C***DO*NOT*UPDATE*D/DLSTAT*WITH*VALUE*'99'*IF*IT*WAS*NOT*SET*BEFORE. 036796
     C*LR*51******         MOVE '  '      DYSA                            036796
      *                                                                   S01129
      ** Restore previousely saved accumulator values                     S01129
      *                                                                   S01129
     CLR         *INU5     IFEQ '0'                                       S01129
     CLR                   Z-ADD#TOTI     ZZTOTI                          S01129
     CLR                   Z-ADD#TOTD     ZZTOTD                          S01129
     CLR                   END                                            S01129
      *                                                                   S01129
     C*LR*********          Z-ADDZZTOTI    HRWN                           E20669
     C*LR*********          Z-ADDZZTOTD    HRDC                           E20669
     CLR                   Z-ADDNORED     NORE
0361 C*LR*********NORE***** COMP RECRED               U8U8                LN0209
0362 C*LRNU8******INT,3**** COMP HRWN                 U8U8                LN0209
0363 C*LRNU8******DEC,3**** COMP HRDC                 U8U8                LN0209
0368 C*LR         RECRIT    ADD  2         RECRIT                         E193
0369 CLR         INT,1     COMP 0                        80
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     C*
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANK    ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     C*
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM *BLANK    ZSERR                           S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      *                                                                   CLE004
      ** Ensure that P2 file is recorded by RCF                           CLE004
      *                                                                   CLE004
     CLR         CLE004    IFEQ 'Y'                                       CLE004
     CLR         *IN77     IFEQ '0'                                       CLE004
     CLR                   MOVE *BLANKS   RCYNM                           CLE004
     CLR                   WRITEHEADP2                                    CLE004
     CLR                   WRITECOLMP2                                    CLE004
     CLR                   ENDIF                                          CLE004
     CLR                   WRITETRAILP2                                   CLE004
     CLR                   Z-ADDSFNUM2    ZSNUM2  60                      CLE004
     CLR                   CALL 'ZSFILE'                                  CLE004
     CLR                   PARM           SEQ                             CLE004
     CLR                   PARM *BLANKS   @PARM                           CLE004
     CLR                   PARM           SFILE2                          CLE004
     CLR                   PARM           ZSNUM2                          CLE004
     CLR                   PARM *BLANK    ZSERR                           CLE004
     C*                                                                   CLE004
     CLR         ZSERR     IFEQ 'Y'                                       CLE004
     CLR                   SETON                     U7U8                 CLE004
     CLR                   RETRN                                          CLE004
     CLR                   ENDIF                                          CLE004
     CLR                   ENDIF                                          CLE004
0370 C**
     C** READ BANK DETAILS VIA ACCESS PROGRAM (WHEN EMPTY FILES)          E296
     CLRN49                CALL 'AOBANKR0'                                E296
     C                     PARM '*MSG   ' @RTCD   7                       E296
     C                     PARM '*FIRST ' @OPTN   7                       E296
     C           SDBANK    PARM SDBANK    DSFDY                           E296
     CLRN49      BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  E296
     CLRN49      @RTCD     IFNE *BLANK                                    E296
     CLRN49                MOVEL'SDBANKPD'DBFILE 10        ************   E296
     CLRN49                MOVEL'03'      DBASE   2        * DBERR 03 *   E296
     CLRN49                MOVEL@OPTN     DBOPTN  7        ************   E296
     CLRN49                MOVEL@OPTN     DBKEY  29                       E296
     CLRN49                EXSR *PSSR                                     E296
     CLRN49                SETON                     99                   E296
     CLR                   END                                            E296
0370 C**                                                                  E296
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/SREURO - Call program to convert amount to Euro           *   CEU011
      *              Equivalent.                                      *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           SREURO    BEGSR                                          CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'               8383               CEU011
     C                     PARM           PRTCD   7                       CEU011
     C                     PARM           PFRAM  183                      CEU011
     C                     PARM           PFRCY   3                       CEU011
     C                     PARM           PTOCY   3                       CEU011
     C                     PARM           POUTA  150                      CEU011
     C                     PARM           PINTA  183                      CEU011
     C                     PARM           PEXRT  159                      CEU011
     C                     PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     C           PRTCD     IFNE *BLANKS                                   CEU011
     C                     MOVEL'*CALL   'DBFILE                          CEU011
     C                     MOVEL'EU0200  'DBKEY             ************  CEU011
     C                     MOVELWDBASE    DBASE             * DBERR nn *  CEU011
     C                     SETON                     U7U8LR ************  CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     GOTO END                                       CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
0371 C********************************************************************
0372 C*
0373 C           HASH      BEGSR
0374 C                     Z-ADDINT,X     ZZTOTI
0375 C                     Z-ADDDEC,X     ZZTOTD
0376 C  N42      EAMT      DIV  1000      ZZAMT        36
0377 C   42      REPAMT    DIV  1000      ZZAMT        36
0378 C   36                Z-SUBZZAMT     ZZAMT
0379 C                     EXSR GLZADD
0380 C                     Z-ADDZZTOTI    INT,X
0381 C                     Z-ADDZZTOTD    DEC,X
      *                                                                   S01129
      ** Clear previous accumulater values.                               S01129
     C                     Z-ADD0         ZZTOTI                          S01129
     C                     Z-ADD0         ZZTOTD                          S01129
      *                                                                   S01129
0382 C                     ENDSR
0383 C**
0384 C********************************************************************
0385 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0386 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0387 C*
0388 CSR         GLZADD    BEGSR                           *** GLZADD ****
0389 C*
0390 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0391 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0392 C*
0393 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0394 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0395 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0396 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0397 C*
0398 CSR                   EXSR GLZSUM
0399 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0400 C*
0401 C********************************************************************
0402 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0403 C*                        GLZADD, GLZSUB, GLZCMP.
0404 C*          PARAMETERS PASSED -
0405 C*                     I/P ZZAMTI ZZAMTD
0406 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0407 C*
0408 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0409 C*
0410 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0411 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0412 CSR                   SETOF                     919293
0413 CSR                   SETOF                     949599
0414 C*
0415 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0416 CSR         ZZAMTI    COMP 0                      9293
0417 CSR 93      ZZAMTD    COMP 0                      9293
0418 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0419 C*
0420 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0421 CSR         ZZTOTI    COMP 0                      9193
0422 CSR 93      ZZTOTD    COMP 0                      9193
0423 C*
0424 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0425 CSR 93                Z-ADDZZAMTI    ZZTOTI
0426 CSR 93                Z-ADDZZAMTD    ZZTOTD
0427 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0428 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0429 CSR 91N92
0430 CORN91 92             GOTO ZZOFPS
0431 C*
0432 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0433 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0434 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0435 C*
0436 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0437 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0438 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0439 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0440 C*
0441 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0442 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0443 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0444 CSRN99                Z-ADDZZWK2     ZZTOTD
0445 CSRN99                Z-ADDZZWK3     ZZTOTI
0446 C*
0447 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0448 CSR 99                Z-ADD0         ZZAMT  153
0449 CSR                   GOTO ZZSEND
0450 C*
0451 C* THE 'SIGNS' ARE DIFFERENT
0452 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0453 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0454 C*
0455 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0456 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0457 C*
0458 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0459 C*
0460 CSR 91                Z-SUBZZTOTI    ZZTOTI
0461 CSR 91                Z-SUBZZTOTD    ZZTOTD
0462 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0463 C*
0464 CSR         ZZTOTI    COMP ZZAMTI               93  95
0465 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0466 C*
0467 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0468 CSR 95                Z-ADD0         ZZTOTI
0469 CSR 95                Z-ADD0         ZZTOTD
0470 CSR 95                GOTO ZZSEND
0471 C*
0472 C* IF ZZTOT GT. ZZAMT.
0473 CSR 93      ZZAMTD    COMP ZZTOTD               94
0474 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0475 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0476 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0477 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0478 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0479 C*
0480 C*
0481 C* IF ZZAMT GT. ZZTOT.
0482 CSRN93      ZZTOTD    COMP ZZAMTD               94
0483 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0484 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0485 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0486 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0487 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0488 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0489 C*
0490 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0491 CSR                   SETOF                     94
0492 CSR 93 91
0493 CORN93 92             SETON                     94
0494 CSR 94                Z-SUBZZTOTI    ZZTOTI
0495 CSR 94                Z-SUBZZTOTD    ZZTOTD
0496 C**
0497 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0498 CSR 92                Z-SUBZZAMTI    ZZAMTI
0499 CSR 92                Z-SUBZZAMTD    ZZAMTD
0500 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0501 C**
0502 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0503 CSR                   SETOF                     96
0504 CSR         ZZTOTD    COMP 0                        91
0505 CSR 91      ZZTOTI    COMP 0                      96
0506 CSR 96                MOVE '.000-'   ZZNEGD  5
0507 CSR                   ENDSR                             ** ENDSR **
0508 C********************************************************************
0509 C**
0510 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0511 C**
0512 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0513 C**
0514 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0515 C**
0516 C**   CLEAR DATE FIELDS.
0517 C                     Z-ADD0         ZDATE   60
0518 C                     MOVEL'       ' ZADATE  7
0519 C**
0520 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0521 C                     Z-ADDZDAYNO    ZDAYNO  50
0522 C**
0523 C**   DETERMINE YEAR NUMBER.
0524 C**
0525 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0526 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0527 C   99                GOTO ZDEND2
0528 C**
0529 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0530 C           ZDAYN1    DIV  1461      ZLYR    20
0531 C                     MVR            ZDAYN1           SAVE REMAINING
0532 C**                                                   DAYS
0533 C**   CALCULATE NUMBER OF REMAINING YEARS.
0534 C                     Z-ADD1         ZWRK2   20
0535 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0536 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0537 C  N90      ZWRK2     ADD  1         ZWRK2
0538 C  N90                GOTO ZDTAG1
0539 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0540 C**
0541 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0542 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0543 C**
0544 C**   CALCULATE ACTUAL YEAR NUMBER.
0545 C           ZLYR      MULT 4         ZWRK3   30
0546 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0547 C                     Z-ADDZWRK3     ZYEAR   20
0548 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0549 C**
0550 C**   DETERMINE MONTH NUMBER.
0551 C**
0552 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0553 C                     SETOF                     9293
0554 C   91      ZDAYN1    COMP 59                     9293
0555 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0556 C**
0557 C**   CALCULATE MONTH NUMBER.
0558 C                     Z-ADD2         ZWRK2
0559 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0560 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0561 C  N94      ZWRK2     ADD  1         ZWRK2
0562 C  N94                GOTO ZDTAG2
0563 C           ZWRK2     SUB  1         ZWRK2
0564 C**
0565 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0566 C**
0567 C**   DETERMINE DAY OF MONTH.
0568 C**
0569 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0570 C           ZDAYN1    ADD  1         ZDAYN1
0571 C**
0572 C**   CALCULATE DAY OF MONTH.
0573 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0574 C**
0575 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0576 C   93      ZDAY      ADD  1         ZDAY
0577 C**
0578 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0579 C  N98                MOVELZDAY      ZWRK4   40
0580 C   98                MOVE ZDAY      ZWRK4
0581 C  N98                MOVE ZMTH      ZWRK4
0582 C   98                MOVELZMTH      ZWRK4
0583 C                     MOVELZWRK4     ZDATE
0584 C                     MOVE ZYEAR     ZDATE
0585 C**
0586 C**   FORMAT ALPHA DATE, DDMMMYY.
0587 C           ZDAY      COMP 10                     95
0588 C                     MOVELZDAY      ZWRK5   5
0589 C   95                MOVEL' '       ZWRK5
0590 C                     MOVE ZMNM,ZMTH ZWRK5
0591 C                     MOVELZWRK5     ZADATE
0592 C                     MOVE ZYEAR     ZADATE
0593 C**
0594 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0595 C**
0596 C********************************************************************S01195
      *****/COPY*ZSRSRC,ZFWDT                                                          S01195 CGL091
      /COPY ZSRSRC,ZFWDTA                                                                     CGL091
0596 C********************************************************************S01195
      /COPY ZSRSRC,ZACCH                                                  S01195
      /EJECT                                                              CLE004
      /COPY ZSRSRC,ZSEDITZ3                                               CLE004
0596 C********************************************************************S01195
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
0596 C********************************************************************
0597 C*********************                                               S01195
0598 C*****ZDATE3*SR.*TO*CALCULATE*ANY*NUMBER*OF*WORKING**                S01195
0599 C****************DAYS*FORWARD*IN*ANY*CURRENCY.*******                S01195
0600 C*********************                                               S01195
0601 C*********THIS*SR.*CAN*BE*USED*WHEN*THE*INPUT*CYCLE*IS*RUNNING*AS    S01195
0602 C*********HOLIDAY*RECORDS*ARE*ACCESSED*BY*CHAIN.*THEREFORE*NEWLY*    S01195
0603 C*********ADDED*RECORDS*IN*THE*OVERFLOW*AREA*CAN*ALSO*BE*ACCESSED.   S01195
0604 C*********************                                               S01195
0605 C***********ZDATE3****BEGSR                           *** ZDATE3 *** S01195
0606 C*********************                                               S01195
0607 C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.***                        S01195
0608 C*********************Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
0609 C*********************MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
0610 C*********************Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
0611 C*********************                                DAYS FORWARD   S01195
0612 C*****CLEAR*COUNT*OF*NBR*OF*DAYS*ADDED,*&*DEFINE*ZDYNBR.*            S01195
0613 C*********************Z-ADD0         ZDCNT   20                      S01195
0614 C*********************Z-ADDZDAYNO    ZDYNBR  50                      S01195
0615 C*********************                                               S01195
0616 C*****LOOP*TO*INCREMENT*DAY*NUMBER*AND*CHECK*FOR*HOLIDAY.**          S01195
0617 C***********ZDLOP1****TAG                             ** ZDLOP1 TAG *S01195
0618 C*********************                                               S01195
0619 C*********************SETOF                     9596                 S01195
0620 C***********ZDYNBR****ADD  1         ZDYNBR                          S01195
0621 C*********************                                               S01195
0622 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.**                            S01195
0623 C*********************MOVEL'22    '  ZDHKEY 12                       S01195
0624 C*********************MOVELZDYNBR    ZWRK6   6                       S01195
0625 C*********************MOVE '1'       ZWRK6                           S01195
0626 C*********************MOVE ZWRK6     ZDHKEY                          S01195
0627 C*********************                                               S01195
0628 C*****CHAIN*FOR*HOLIDAY*RECORD,*RECORD*1*OR*2**                      S01195
0629 C***********ZDHCHN****TAG                             ** ZDHCHN TAG *S01195
0630 C*********************                                               S01195
0631 C***********ZDHKEY****CHAINTABLE                90    ON NOT THERE   S01195
0632 C**N90******RECI******COMP 'D'                  9090  DELETED        S01195
0633 C*********************                                               S01195
0634 C*****NO*RECORD*1*FOUND,*IS*NOT*A*HOLIDAY**                          S01195
0635 C***90N95*************GOTO ZDOAGN                                    S01195
0636 C*********************                                               S01195
0637 C*****NO*RECORD*2*FOUND**                                            S01195
0638 C***90*95*96**********GOTO ZDLOP1                     EXC. NOT FOUND S01195
0639 C***90*95N96**********GOTO ZDOAGN                     INC. NOT FOUND S01195
0640 C*********************                                               S01195
0641 C*****DETERMINE*TYPE*FOUND,*INCLUDE*OR*EXCLUDE**                     S01195
0642 C***********INEX******COMP 'E'                  92  91               S01195
0643 C*********************                                               S01195
0644 C*****CHECK*IF*DAY*IS*HOLIDAY*FOR*CURRENCY.**                        S01195
0645 C***********ZCCY******LOKUPHCCY                     93               S01195
0646 C***91*93*************GOTO ZDOAGN                     EXCLUDE FOUND  S01195
0647 C***92*93*************GOTO ZDLOP1                     INCLUDE FOUND  S01195
0648 C*********************                                               S01195
0649 C*****IF*EXCLUDE*OR*INCLUDE*NOT*FOUND*CHECK***                       S01195
0650 C*****FOR*SECOND*HOLIDAY*RECORD,*IF*REQUIRED.*                       S01195
0651 C***********'   '*****LOKUPHCCY                     94ON IF NO RCD.2 S01195
0652 C*********************MOVE ZDHKEY    ZWRK1   1                       S01195
0653 C***********ZWRK1*****COMP '1'                      95               S01195
0654 C***91*95*************SETON                     96                   S01195
0655 C***95N94*************MOVE '2'       ZDHKEY                          S01195
0656 C***95N94*************GOTO ZDHCHN                     GET SECOND REC S01195
0657 C*********************                                               S01195
0658 C***91****************GOTO ZDLOP1                     EXC. NOT FOUND S01195
0659 C***92****************GOTO ZDOAGN                     INC. NOT FOUND S01195
0660 C*********************                                               S01195
0661 C*****INCREMENT*COUNT*AND*CHECK*IF*REQUIRED*NUMBER*OF*DAYS**         S01195
0662 C*****HAVE*BEEN*ADDED.*IF*NOT,*GO*THROUGH*LOOP1*AGAIN.******         S01195
0663 C***********ZDOAGN****TAG                             ** ZDOAGN TAG *S01195
0664 C*********************                                               S01195
0665 C***********ZDCNT*****ADD  1         ZDCNT                           S01195
0666 C***********ZDCNT*****COMP ZNRDYS                 97                 S01195
0667 C***97****************GOTO ZDLOP1                                    S01195
0668 C*********************                                               S01195
0669 C*********************ENDSR                                          S01195
0670 C*********************                                               S01195
0671 C********************************************************************S01195
0672 C*********************                                               S01194
0673 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.   S01194
0674 C*********************                                               S01194
0675 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
0676 C*********************                                               S01194
0677 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.****                S01194
0678 C*********************MOVEL'01      'ZTABKY 12                       S01194
0679 C*********************MOVE '  10'    ZTABKY                          S01194
0680 C*********************                                               S01194
0681 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0682 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0683 C*********************                                               S01194
0684 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.***                 S01194
0685 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
0686 C*********************                                               S01194
0687 C*********************ENDSR                                          S01194
0688 C*********************                                               S01194
0689 C*********************                                               S01194
0690 C********************************************************************
0691 C/EJECT
0692 O*
0693 O*****NOSTRO*EVENTS*EXTRACT*FILE                                     E193
0694 O************************                                            E193
0695 O*NOSEXEC*D********01*****                                           E193
0696 O**************************          1 'A'                           E193
0697 O*NOSEXED*D********02*65****                                         E193
0699 O*************************LOT1     256                               E193
0700 O*************************LOT2     320                               E193
0701 O***********************42REPAMT    27P                              E193
0697 O*NOSEXCC*D********03*65**                                           E193
0699 O*************************LOT3     256                               E193
0697 O*NOSEXEL*D********13*65                                             E193
0699 O*************************LOT4     256                               E193
     O*****NSXBCEDFDADD*****15*65****                                     S01196
     O**************************ALL**                                     S01196
     O*NOSEXESFDADD*****17 65                                             E193
     O**************************ALL                                       E193
     O*NOSEXSEFDADD*****26 65                                       S01129E193
     O*******OR********27 65                                        S01129E193
     O*******OR********28 65                                        S01129E193
     O***********************  *ALL                                 S01129E193
     O*NOSEXFPFDADD*****37*65                                       S03220E193
     O************************ *ALL                                 S03220E193
0702 O*NOSEXZZ*T********LR****                                            E193
0703 O*****************************       1 'T'                           E193
0704 O*************************RECRIT     6                               E193
0705 O*************************INT,2     14P                              E193
0706 O*************************DEC,2     16P                              E193
0707 O*
0708 O*PRINT  D  203   43                                                 S01124
0708 O*DL0550P1D  203   43                                          S01124E22608
0708 O***GL0550P1D  203   43                                                           E22608 CGL091
     OGL0557P1D  203   43                                                                     CGL091
0709 O       OR        46N41
     O*****  OR        L1                                                 S01194
0710 O***********************************22 'REFERENCE DL0550'            S01117
0710 O***********************************24 'REFERENCE DL0550P1'    S01117E22608
0710 O**********                         22 'REFERENCE GL0550P1'                       E22608 CGL091
     O                                   22 'REFERENCE GL0557P1'                              CGL091
0711 O*************************TITL      89                               S01194
     O                         BJURPT    89                               S01194
0712 O                                  104 'DATE'
0713 O*************************RUNA     112                               S01194
     O                         BJMRDT   112                               S01194
0714 O                                  122 'PAGE'
0715 O                         PAGE  Z  127
0716 O        D  1     43
0717 O       OR        46N41
     O**********          66NU4          51 'F.X. '                                    AUS017 CGL091
     O**********          67NU4          51 'M.M. '                                    AUS017 CGL091
0718 O**********            NU4          75 'DAILY EVENTS BY CURRENCY'                        CGL091
     O                    66NU4          38 'F.X. '                                           CGL091
     O                    67NU4          38 'M.M. '                                           CGL091
     O                      NU4          62 'EVENTS BY CURRENCY WITH '                        CGL091
     O                      NU4          81 'RUNNING TOTALS - TO'                             CGL091
     O                   N56NU4          94 'END OF BOOKS'                                    CGL091
     O                    56NU4#DAYS     85                                                   CGL091
     O                    56NU4          98 'DAYS FORWARD'                                    CGL091
     O/COPY WNCPYSRC,GL0557O001
0718 O                       U4          71 'SECURITIES TRADING EVENT'
0718 O*                      U4          83 'S BY CURRENCY'               E43518
0718 O                       U4          84 'S BY CURRENCY'               E43518
0719 O        D  2     43
0720 O       OR        46N41
0721 O*************************CCNM      19                               S01194
0721 O                         A6CYNM    19                               S01194
     O**********          66NU4          51 '-----'                                    AUS017 CGL091
     O**********          67NU4          51 '-----'                                    AUS017 CGL091
0718 O**********            NU4          75 '------------------------'                        CGL091
     O                    66NU4          38 '-----'                                           CGL091
     O                    67NU4          38 '-----'                                           CGL091
     O                      NU4          62 '------------------------'                        CGL091
     O                      NU4          81 '--------------------'                            CGL091
     O                   N56NU4          94 '-------------'                                   CGL091
     O                    56NU4          85 '----'                                            CGL091
     O                    56NU4          98 '---------------'                                 CGL091
0718 O*                      U4          70 '------------------------'    E43518
0718 O*                      U4          81 '-----------'                 E43518
0718 O                       U4          71 '------------------------'    E43518
0718 O                       U4          84 '-------------'               E43518
0723 O        D  1     43
0724 O       OR        46N41
     O                                   18 'CONSOLIDATED'
     O** BEGIN THE NEW REPORT LAYOUT                                                          CGL091
     O        D  1     43    34                                                               CGL091
     O       OR        46N41 34                                                               CGL091
     O                                    8 ' EVENT'                                          CGL091
     O                                   45 ' LOAN/DEAL'                                      CGL091
     O                                   61 'PRINCIPAL'                                       CGL091
     O                                   92 'INTEREST'                                        CGL091
     O                                  122 'TOTAL'                                           CGL091
     O        D  2     43    34                                                               CGL091
     O       OR        46N41 34                                                               CGL091
     O                                    7 '  DATE'                                          CGL091
     O                                   22 'CUSTOMER'                                        CGL091
     O                                   45 ' NUMBER  TYPE'                                   CGL091
     O                                   75 'AMOUNT          VAL/MAT'                         CGL091
     O                                  104 'AMOUNT          RATE'                            CGL091
     O                                  123 'AMOUNT'                                          CGL091
     O        D  1     02N41 34                                                               CGL091
      *                                                                                       CGL091
     O       OR  1     03N41 34                                                               CGL091
     O       OR  1     13N41 34                                                               CGL091
     O       OR  1     15N41 34                                                               CGL091
     O       OR  1     26N41 34                                                               CGL091
     O       OR  1     27N41 34                                                               CGL091
     O       OR  1     28N41 34                                                               CGL091
     O                         EDATA      8                                                   CGL091
     O                         CRNM      30                                                   CGL091
     O*                                                                                       CGL091
     O                N13                39 '      '                                          CGL091
     O                N13N15   PDLNO     39                                                   CGL091
     O                 15      LCNO      39                                                   CGL091
     O                 25                39 '      '                                          CGL091
     O                 26                39 '      '                                          CGL091
     O                 27                39 '      '                                          CGL091
     O                 28                39 '      '                                          CGL091
O    O                 13                33 'LE'                                              CGL091
     O                 13N48   LNRF      39                                                   CGL091
     O                 13 48   FTYP      36                                                   CGL091
     O                 13 48             37 '/'                                               CGL091
     O                 13 48   FSEQ      39                                                   CGL091
     O                N27N28   DTYP      42                                                   CGL091
     O                N27N28             43 '-'                                               CGL091
     O                N27N28   DLST      45                                                   CGL091
     O                N13      FFIN      47                                                   CGL091
     O                      N22OTHDA     75                                                   CGL091
     O*                                                                                       CGL091
     O** PRINCIPAL AMOUNT                                                                     CGL091
     O                       30PRAMT     67 ' ,   ,   ,   , 0 -'                              CGL091
     O                       31PRAMT     67 '   ,   ,   , 0 . -'                              CGL091
     O                       32PRAMT     67 '  ,   ,   , 0 .  -'                              CGL091
     O                       33PRAMT     67 ' ,   ,   , 0 .   -'                              CGL091
     O*                                                                                       CGL091
     O** INTEREST AMOUNT                                                                      CGL091
     O                       30INTAMT    96 ' ,   ,   ,   , 0 -'                              CGL091
     O                       31INTAMT    96 '   ,   ,   , 0 . -'                              CGL091
     O                       32INTAMT    96 '  ,   ,   , 0 .  -'                              CGL091
     O                       33INTAMT    96 ' ,   ,   , 0 .   -'                              CGL091
     O** TOTAL AMOUNT                                                                         CGL091
     O                 42    30REPAMT   132 ' ,   ,   ,   , 0 -'                              CGL091
     O                 42    31REPAMT   132 '   ,   ,   , 0 . -'                              CGL091
     O                 42    32REPAMT   132 '  ,   ,   , 0 .  -'                              CGL091
     O                 42    33REPAMT   132 ' ,   ,   , 0 .   -'                              CGL091
     O*                                                                                       CGL091
     O                N42    30EAMT     132 ' ,   ,   ,   , 0 -'                              CGL091
     O                N42    31EAMT     132 '   ,   ,   , 0 . -'                              CGL091
     O                N42    32EAMT     132 '  ,   ,   , 0 .  -'                              CGL091
     O                N42    33EAMT     132 ' ,   ,   , 0 .   -'                              CGL091
     O                 02N23   EXRT     111 '   0 .        '                                  CGL091
     O                 03N23   EINRX    111 '  0 .        '                                   CGL091
     O                 13N23   EINRX    111 '  0 .        '                                   CGL091
     O                 02 11N23         112 '-'                                               CGL091
     O*                                                                                       CGL091
     O*     OUTPUT SECURITY SHORTNAME INSTEAD OF RATE                                         CGL091
     O*                25      SECS     111                                                   CGL091
     O                 25      SECS     111                                                   CGL091
     O                 26      SECS     111                                                   CGL091
     O                 27      SECS     111                                                   CGL091
     O                 28      SECS     111                                                   CGL091
     O*                                                                                       CGL091
     O        D  1     37N41 34                                                               CGL091
     O                         EDATA      8                                                   CGL091
     O                         PREF      39                                                   CGL091
     O                         PYTP      42                                                   CGL091
     O                                   43 '-'                                               CGL091
     O                         PYST      45                                                   CGL091
     O                                   47 'N'                                               CGL091
     O                         OTHDA     75                                                   CGL091
     O** TOTAL AMOUNT                                                                         CGL091
     O                    30 60INPYAM   131 ' ,   ,   ,   , 0 '                               CGL091
     O                    31 60INPYAM   131 '   ,   ,   , 0 . '                               CGL091
     O                    32 60INPYAM   131 '  ,   ,   , 0 .  '                               CGL091
     O                    33 60INPYAM   131 ' ,   ,   , 0 .   '                               CGL091
     O                       60         132 ' '                                               CGL091
     O                         RATE     111 '   0 .        '                                  CGL091
     O                    30 61OTPYAM   131 ' ,   ,   ,   , 0 '                               CGL091
     O                    31 61OTPYAM   131 '   ,   ,   , 0 . '                               CGL091
     O                    32 61OTPYAM   131 '  ,   ,   , 0 .  '                               CGL091
     O                    33 61OTPYAM   131 ' ,   ,   , 0 .   '                               CGL091
     O                       61         132 '-'                                               CGL091
     O        D  1     82N41 34                                                               CGL091
     O                         EDATA      8                                                   CGL091
     O                         CRNM      30                                                   CGL091
     O                                   33 'FF'                                              CGL091
     O                         TNBR      39                                                   CGL091
     O                    30 60EAMT     131 ' ,   ,   ,   , 0 '                               CGL091
     O                    31 60EAMT     131 '   ,   ,   , 0 . '                               CGL091
     O                    32 60EAMT     131 '  ,   ,   , 0 .  '                               CGL091
     O                    33 60EAMT     131 ' ,   ,   , 0 .   '                               CGL091
     O                       60         132 ' '                                               CGL091
     O                    30 61EAMT     131 ' ,   ,   ,   , 0 '                               CGL091
     O                    31 61EAMT     131 '   ,   ,   , 0 . '                               CGL091
     O                    32 61EAMT     131 '  ,   ,   , 0 .  '                               CGL091
     O                    33 61EAMT     131 ' ,   ,   , 0 .   '                               CGL091
     O                       61         132 '-'                                               CGL091
     O        D  1     27N41 34                                                               CGL091
     O       OR  1     28N41 34                                                               CGL091
     O                       75          73 '* OVERDUE *    '                                 CGL091
     O                       76          73 '* APPROXIMATE *'                                 CGL091
     O        D  1     03N41 34                                                               CGL091
     O                       03          34 'D/D'                                             CGL091
     O                       03DDNO      41                                                   CGL091
     O* SUBTOTAL LINE FOR CHANGE OF EVENT DATE                                                CGL091
     O        E 12             SUBTL                                                          CGL091
     O**                                                                                      CGL091
     O                                   45 'DAILY TOTAL'                                     CGL091
     O** TOTAL PRINCIPAL AMOUNT                                                               CGL091
     O                       30TPAMT     67 ' ,   ,   ,   , 0 -'                              CGL091
     O                       31TPAMT     67 '   ,   ,   , 0 . -'                              CGL091
     O                       32TPAMT     67 '  ,   ,   , 0 .  -'                              CGL091
     O                       33TPAMT     67 ' ,   ,   , 0 .   -'                              CGL091
     O*                                                                                       CGL091
     O** TOTAL INTEREST AMOUNT                                                                CGL091
     O                       30TINTAM    96 ' ,   ,   ,   , 0 -'                              CGL091
     O                       31TINTAM    96 '   ,   ,   , 0 . -'                              CGL091
     O                       32TINTAM    96 '  ,   ,   , 0 .  -'                              CGL091
     O                       33TINTAM    96 ' ,   ,   , 0 .   -'                              CGL091
     O** TOTAL AMOUNT                                                                         CGL091
     O                       30TTAMT    132 ' ,   ,   ,   , 0 -'                              CGL091
     O                       31TTAMT    132 '   ,   ,   , 0 . -'                              CGL091
     O                       32TTAMT    132 '  ,   ,   , 0 .  -'                              CGL091
     O                       33TTAMT    132 ' ,   ,   , 0 .   -'                              CGL091
     O**                                                                                      CGL091
     O** END OF NEW LAYOUT CGL091                                                             CGL091
      *                                                                                       CGL091
      * Format for output of running totals of Principal, Interest                            CGL091
      * and total amounts                                                                     CGL091
     O        E  1             RUNTL                                                          CGL091
     O                                   56 '------------------------'                        CGL091
     O                                   80 '------------------------'                        CGL091
     O                                  104 '------------------------'                        CGL091
     O                                  128 '------------------------'                        CGL091
     O                                  132 '----'                                            CGL091
     O        E  1             RUNTL                                                          CGL091
     O**                                                                                      CGL091
     O                                   45 'RUNNING TOTAL'                                   CGL091
      *                                                                                       CGL091
      * 5/15/97 - Bank decided that running totals for principal                              CGL091
      * and interest were, after all, unnecessary                                             CGL091
     O** RUNNING TOTAL TOTAL AMOUNT                                                           CGL091
     O                       30RTAMT    132 ' ,   ,   ,   , 0 -'                              CGL091
     O                       31RTAMT    132 '   ,   ,   , 0 . -'                              CGL091
     O                       32RTAMT    132 '  ,   ,   , 0 .  -'                              CGL091
     O                       33RTAMT    132 ' ,   ,   , 0 .   -'                              CGL091
      *                                                                                       CGL091
     O        E  2             RUNTL                                                          CGL091
     O                                   56 '------------------------'                        CGL091
     O                                   80 '------------------------'                        CGL091
     O                                  104 '------------------------'                        CGL091
     O                                  128 '------------------------'                        CGL091
     O                                  132 '----'                                            CGL091
0723 O********D* 1     43                                                                     CGL091
0724 O*******OR*       46N41                                                                  CGL091
     O/COPY WNCPYSRC,GL0557O002
0725 O***********                        56 ' LOAN/DEAL  FED EVENT'       AUS017
     O***********************************46 ' LOAN/DEAL'           AUS017 CDL038
     O**********                         44 ' LOAN/DEAL'                               CDL038 CGL091
     O**********         N67             50 ' FED'                                     AUS017 CGL091
     O**********                         56 ' EVENT'                                   AUS017 CGL091
0726 O**********                         97 'INCOMING'                                        CGL091
0727 O**********                        130 'OUTGOING'                                        CGL091
0728 O********D* 2     43                                                                     CGL091
0729 O*******OR*       46N41                                                                  CGL091
0730 O**********                         12 'CUSTOMER'                                        CGL091
0731 O***********                        56 'NUMBER  TYPE FDS  DATE'      AUS017
     O***********************************46 ' NUMBER  TYPE'        AUS017 CDL038
     O**********                         44 ' NUMBER  TYPE'                            CDL038 CGL091
     O**********         N67             50 ' FDS'                                     AUS017 CGL091
     O**********                         56 '  DATE'                                   AUS017 CGL091
0732 O**********                         81 'EVENT         VAL/MAT'                           CGL091
0733 O**********                        107 'AMOUNT       RATE'                               CGL091
0734 O**********                        129 'AMOUNT'                                          CGL091
      *                                                                   CEU011
     O********D* 1     43                                                              CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O*******OR*       46N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O**********                         99 'EURO EQUIVALENT'                          CEU011 CGL091
     O**********                        131 'EURO EQUIVALENT'                          CEU011 CGL091
0735 O********D* 1     02N41                                                                  CGL091
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0557OOP1                                           S01408
     O*                                                                   S01408
0736 O*******OR* 1     03N41                                                                  CGL091
     O*******OR* 1     13N41                                                                  CGL091
     O*******OR**1*****15N41                                              S01196
     O*******OR* 1     15N41                                                           S01473 CGL091
     O*******OR  1     17N41                                              E20669
     O*******OR* 1     26N41                                                           S01129 CGL091
     O*******OR* 1     27N41                                                           S01129 CGL091
     O*******OR* 1     28N41                                                           S01129 CGL091
     O*******OR  1     29N41                                       S01129 E20669
0737 O*****                    CRNM      20                               S01129
0738 O*****                    CTWN      31                               S01129
0737 O**********      N29      CRNM      20                        S01129 E20669
0738 O**********      N29      CTWN      31                        S01129 E20669
0737 O**********               CRNM      20                                            E20669 CGL091
0738 O**********               CTWN      31                                            E20669 CGL091
     O**********      N13                38 '      '                                   CDL038 CGL091
     O**********      N13N15   PDLNO     38                                            CDL038 CGL091
     O**********       15      LCNO      38                                            CDL038 CGL091
     O**********       13                32 'LE'                                       CDL038 CGL091
     O**********       13N48   LNRF      38                                            CDL038 CGL091
     O**********       13 48   FTYP      35                                            CDL038 CGL091
     O**********       13 48             36 '/'                                        CDL038 CGL091
     O**********       13 48   FSEQ      38                                            CDL038 CGL091
     O**********      N27N28   DTYP      41                                            CDL038 CGL091
     O**********      N27N28             42 '-'                                        CDL038 CGL091
     O**********      N27N28   DLST      44                                            CDL038 CGL091
     O**********       02      CLAS      48                                            CDL038 CGL091
     O**********       13      CLAS      48                                            CLE042 CGL091
     O**********       29      CCBD      30                        S01129 E20669
0751 O*
0763 O*
0739 O*****           N13      DLNO      40                               S01129
     O****************N13      PDLNO     40                        S01129 S01473
     O****************N13                40 '      '               S01473 CDL038
     O****************N13N15   PDLNO     40                        S01473 CDL038
     O**************** 15      LCNO      40                        S01473 CDL038
O    O**************** 13                34 'LE'                          CDL038
     O**************** 13N48   LNRF      40                               CDL038
     O**************** 13 48   FTYP      37                               CDL038
     O**************** 13 48             38 '/'                           CDL038
     O**************** 13 48   FSEQ      40                               CDL038
0740 O*****                    DTYP      43                               S01129
     O**********      N27N28N29DTYP      43                        S01129 E20669
     O****************N27N28   DTYP      43                        E20669 CDL038
0741 O*****                              44 '-'                           S01129
     O**********      N27N28N29          44 '-'                    S01129 E20669
     O****************N27N28             44 '-'                    E20669 CDL038
0742 O*****                    DLST      46                               S01129
     O**********      N27N28N29DLST      46                        S01129 E20669
     O****************N27N28   DLST      46                        E20669 CDL038
0743 O**********      N13N17   FFIN      49                               E20669
0743 O**********      N13      FFIN      49                               E20669
0744 O**********               EDATA     57                                                   CGL091
0745 O*************************TABB      73                               S01496
     O****************N62******TABB      73                        S01496 CSE007
     O**********      N62N52   TABB      73                                            CSE007 CLE028
     O**********      N62N52N64TABB      73                                            CLE028 CGL091
     O**********       64      TABB2     73                                            CLE028 CGL091
     O**********       62 63   EVNARR    73                               S01496              CGL091
     O**********       52 53   CANARR    73                               CSE007              CGL091
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0557OOP3                                                        S01408 CGL091
      *                                                                   S01408
0746 O**********            N22OTHDA     81                                                   CGL091
0747 O***             N42 60 30EAMT      99 ' ,   ,   ,   , 0 '           S01119
0748 O***             N42 60 31EAMT      99 '   ,   ,   , 0 . '           S01119
0749 O***             N42 60 32EAMT      99 '  ,   ,   , 0 .  '           S01119
0750 O***             N42 60 33EAMT      99 ' ,   ,   , 0 .   '           S01119
 751 O*
0752 O***              42 60 30REPAMT    99 ' ,   ,   ,   , 0 '           S01119
0753 O***              42 60 31REPAMT    99 '   ,   ,   , 0 . '           S01119
0754 O***              42 60 32REPAMT    99 '  ,   ,   , 0 .  '           S01119
0755 O***              42 60 33REPAMT    99 ' ,   ,   , 0 .   '           S01119
0747 O*                                                                   S01119
0747 O**********      N42 60 30EAMT      99 ' ,   ,   ,   , 0 -'                       S01119 CGL091
0748 O**********      N42 60 31EAMT      99 '   ,   ,   , 0 . -'                       S01119 CGL091
0749 O**********      N42 60 32EAMT      99 '  ,   ,   , 0 .  -'                       S01119 CGL091
0750 O**********      N42 60 33EAMT      99 ' ,   ,   , 0 .   -'                       S01119 CGL091
0750 O*                                                                   S01119
0752 O**********       42 60 30REPAMT    99 ' ,   ,   ,   , 0 -'                       S01119 CGL091
0753 O**********       42 60 31REPAMT    99 '   ,   ,   , 0 . -'                       S01119 CGL091
0754 O**********       42 60 32REPAMT    99 '  ,   ,   , 0 .  -'                       S01119 CGL091
0755 O**********       42 60 33REPAMT    99 ' ,   ,   , 0 .   -'                       S01119 CGL091
0756 O***********      02N23N35EXRT     113 '   0 .        '              090909
0757 O***********      02 35   DBCR     113 '   0 .        '              090909
     O***********      02N23   EXRT     113 '   0 .        '                           090909 CGL091
0758 O***********      03N23   EINRX    113 '  0 .        '                                   CGL091
0758 O***********      13N23   EINRX    113 '  0 .        '                                   CGL091
     O*****************02 11************114 '-'                           S01119
     O***********      02 11N23         114 '-'                                        S01119 CGL091
     O*
     O*     OUTPUT SECURITY SHORTNAME INSTEAD OF RATE
     O*
     O*                25      SECS     113                               E43518
     O**********       17 25   SECS     113                        E43518 E20669
     O***********      25      SECS     113                                            E20669 CGL091
     O***********      26      SECS     113                                            S01129 CGL091
     O***********      27      SECS     113                                            S01129 CGL091
     O***********      28      SECS     113                                            S01129 CGL091
     O**********       29      SECS     113                        S01129 E20669
0759 O***             N42 61 30EAMT     132 ' ,   ,   ,   , 0 '           S01119
0760 O***             N42 61 31EAMT     132 '   ,   ,   , 0 . '           S01119
0761 O***             N42 61 32EAMT     132 '  ,   ,   , 0 .  '           S01119
0762 O***             N42 61 33EAMT     132 ' ,   ,   , 0 .   '           S01119
 763 O*
0764 O***              42 61 30REPAMT   132 ' ,   ,   ,   , 0 '           S01119
0765 O***              42 61 31REPAMT   132 '   ,   ,   , 0 . '           S01119
0766 O***              42 61 32REPAMT   132 '  ,   ,   , 0 .  '           S01119
0767 O***              42 61 33REPAMT   132 ' ,   ,   , 0 .   '           S01119
0759 O*                                                                   S01119
0759 O**********      N42 61 30EAMT     132 ' ,   ,   ,   , 0 -'                       S01119 CGL091
0760 O**********      N42 61 31EAMT     132 '   ,   ,   , 0 . -'                       S01119 CGL091
0761 O**********      N42 61 32EAMT     132 '  ,   ,   , 0 .  -'                       S01119 CGL091
0762 O**********      N42 61 33EAMT     132 ' ,   ,   , 0 .   -'                       S01119 CGL091
0759 O*                                                                   S01119
0764 O**********       42 61 30REPAMT   132 ' ,   ,   ,   , 0 -'                       S01119 CGL091
0765 O**********       42 61 31REPAMT   132 '   ,   ,   , 0 . -'                       S01119 CGL091
0766 O**********       42 61 32REPAMT   132 '  ,   ,   , 0 .  -'                       S01119 CGL091
0767 O**********       42 61 33REPAMT   132 ' ,   ,   , 0 .   -'                       S01119 CGL091
      *                                                                   CEU011
     O********D* 1     02N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O*******OR* 1     03N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O*******OR* 1     13N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O*******OR* 1     15N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O*******OR* 1     26N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O*******OR* 1     27N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O*******OR* 1     28N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O**********      N42 60 30WEAMT     97 ' ,   ,   ,   , 0 -'    CEU011146393
     O**********      N42 60 31WEAMT     97 '   ,   ,   , 0 . -'    CEU011146393
     O**********      N42 60 32WEAMT     97 '  ,   ,   , 0 .  -'    CEU011146393
     O**********      N42 60 33WEAMT     97 ' ,   ,   , 0 .   -'    CEU011146393
     O**********      N42 60   WEAMT     97 '  ,   ,   , 0 .  -'                       146393 CGL091
      *                                                                   CEU011
     O**********       42 60 30WPAMT     97 ' ,   ,   ,   , 0 -'    CEU011146393
     O**********       42 60 31WPAMT     97 '   ,   ,   , 0 . -'    CEU011146393
     O**********       42 60 32WPAMT     97 '  ,   ,   , 0 .  -'    CEU011146393
     O**********       42 60 33WPAMT     97 ' ,   ,   , 0 .   -'    CEU011146393
     O**********       42 60   WPAMT     97 '  ,   ,   , 0 .  -'                       146393 CGL091
      *                                                                   CEU011
     O**********      N42 61 30WEAMT    130 ' ,   ,   ,   , 0 -'    CEU011146393
     O**********      N42 61 31WEAMT    130 '   ,   ,   , 0 . -'    CEU011146393
     O**********      N42 61 32WEAMT    130 '  ,   ,   , 0 .  -'    CEU011146393
     O**********      N42 61 33WEAMT    130 ' ,   ,   , 0 .   -'    CEU011146393
     O**********      N42 61   WEAMT    130 '  ,   ,   , 0 .  -'                       146393 CGL091
      *                                                                   CEU011
     O**********       42 61 30WPAMT    130 ' ,   ,   ,   , 0 -'    CEU011146393
     O**********       42 61 31WPAMT    130 '   ,   ,   , 0 . -'    CEU011146393
     O**********       42 61 32WPAMT    130 '  ,   ,   , 0 .  -'    CEU011146393
     O**********       42 61 33WPAMT    130 ' ,   ,   , 0 .   -'    CEU011146393
     O**********       42 61   WPAMT    130 '  ,   ,   , 0 .  -'                       146393 CGL091
      *                                                                   CEU011
     O********D**1*****15N41*79*********                            CTI001CLE005
     O********D* 1     15N41 80                                                        CLE005 CGL091
     O**********                         25 'TRADE INNOVATION REFEREN'                 CTI001 CGL091
     O**********                         48 'CE'                                       CTI001 CGL091
     O**********               TIRF      68                                            CTI001 CGL091
0735 O********D* 1     37N41                                                                  CGL091
0771 O**********               PREF      40                                            S03220 CGL091
     O**********               PYTP      43                                            S03220 CGL091
     O**********                         44 '-'                                        S03220 CGL091
     O**********               PYST      46                                            S03220 CGL091
     O**********                         49 'N'                                        S03220 CGL091
     O**********               EDATA     57                                            S03220 CGL091
     O**********               TABB      73                                            S03220 CLE028
     O**********      N64      TABB      73                                            CLE028 CGL091
     O**********       64      TABB2     73                                            CLE028 CGL091
     O**********               OTHDA     81                                            S03220 CGL091
0759 O**********          30 60INPYAM    99 ' ,   ,   ,   , 0 '                        S03220 CGL091
0760 O**********          31 60INPYAM    99 '   ,   ,   , 0 . '                        S03220 CGL091
0761 O**********          32 60INPYAM    99 '  ,   ,   , 0 .  '                        S03220 CGL091
0762 O**********          33 60INPYAM    99 ' ,   ,   , 0 .   '                        S03220 CGL091
0758 O**********               RATE     113 '   0 .        '                           S03220 CGL091
0759 O**********          30 61OTPYAM   132 ' ,   ,   ,   , 0 '                        S03220 CGL091
0760 O**********          31 61OTPYAM   132 '   ,   ,   , 0 . '                        S03220 CGL091
0761 O**********          32 61OTPYAM   132 '  ,   ,   , 0 .  '                        S03220 CGL091
0762 O**********          33 61OTPYAM   132 ' ,   ,   , 0 .   '                        S03220 CGL091
      *                                                                   CEU011
     O********D* 1     37N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O**********          30 60WINPY     97 ' ,   ,   ,   , 0 '     CEU011146393
     O**********          31 60WINPY     97 '   ,   ,   , 0 . '     CEU011146393
     O**********          32 60WINPY     97 '  ,   ,   , 0 .  '     CEU011146393
     O**********          33 60WINPY     97 ' ,   ,   , 0 .   '     CEU011146393
     O**********             60WINPY     97 '  ,   ,   , 0 .  '                        146393 CGL091
      *                                                                   CEU011
     O**********          30 61WOTPY    130 ' ,   ,   ,   , 0 '     CEU011146393
     O**********          31 61WOTPY    130 '   ,   ,   , 0 . '     CEU011146393
     O**********          32 61WOTPY    130 '  ,   ,   , 0 .  '     CEU011146393
     O**********          33 61WOTPY    130 ' ,   ,   , 0 .   '     CEU011146393
     O**********             61WOTPY    130 '  ,   ,   , 0 .  '                        146393 CGL091
      *                                                                   CEU011
      *                                                                                       CAP204
      ** GENERATED ENTRIES DETAIL                                                             CAP204
      *                                                                                       CAP204
     O        D  1     54N41                                                                  CAP204
     O                         TREF      40                                                   CAP204
     O                         RTYP      43                                                   CAP204
     O                                   49 'N'                                               CAP204
     O                         EDATA     57                                                   CAP204
     O                         TABB      73                                                   CAP204
     O                         OTHDA     81                                                   CAP204
     O                    30 60INAMT     99 ' ,   ,   ,   , 0 '                               CAP204
     O                    31 60INAMT     99 '   ,   ,   , 0 . '                               CAP204
     O                    32 60INAMT     99 '  ,   ,   , 0 .  '                               CAP204
     O                    33 60INAMT     99 ' ,   ,   , 0 .   '                               CAP204
     O                    30 61OTAMT    132 ' ,   ,   ,   , 0 '                               CAP204
     O                    31 61OTAMT    132 '   ,   ,   , 0 . '                               CAP204
     O                    32 61OTAMT    132 '  ,   ,   , 0 .  '                               CAP204
     O                    33 61OTAMT    132 ' ,   ,   , 0 .   '                               CAP204
      *                                                                                       CAP204
     O        D  1     54N41                                                                  CAP204
     O       AND       29 39                                                                  CAP204
     O                       60WINAMT    97 '  ,   ,   , 0 .  '                               CAP204
     O                       61WOTAMT   130 '  ,   ,   , 0 .  '                               CAP204
     O********D* 1     82N41                                                           073714 CGL091
     O**********               CRNM      20                                            073714 CGL091
     O**********               CTWN      31                                            073714 CGL091
     O**********                         34 'FF'                                       073714 CGL091
     O**********               TNBR      40                                            073714 CGL091
     O**********               EDATA     57                                            073714 CGL091
     O**********               TABB      73                                            073714 CLE028
     O**********      N64      TABB      73                                            CLE028 CGL091
     O**********       64      TABB2     73                                            CLE028 CGL091
     O**********          30 60EAMT      99 ' ,   ,   ,   , 0 '                        073714 CGL091
     O**********          31 60EAMT      99 '   ,   ,   , 0 . '                        073714 CGL091
     O**********          32 60EAMT      99 '  ,   ,   , 0 .  '                        073714 CGL091
     O**********          33 60EAMT      99 ' ,   ,   , 0 .   '                        073714 CGL091
     O**********          30 61EAMT     132 ' ,   ,   ,   , 0 '                        073714 CGL091
     O**********          31 61EAMT     132 '   ,   ,   , 0 . '                        073714 CGL091
     O**********          32 61EAMT     132 '  ,   ,   , 0 .  '                        073714 CGL091
     O**********          33 61EAMT     132 ' ,   ,   , 0 .   '                        073714 CGL091
      *                                                                   CEU011
     O********D* 1     82N41                                                           CEU011 CGL091
     O*******AND       29 39                                                           CEU011 CGL091
     O**********          30 60WEAMT     97 ' ,   ,   ,   , 0 '     CEU011146393
     O**********          31 60WEAMT     97 '   ,   ,   , 0 . '     CEU011146393
     O**********          32 60WEAMT     97 '  ,   ,   , 0 .  '     CEU011146393
     O**********          33 60WEAMT     97 ' ,   ,   , 0 .   '     CEU011146393
     O**********          30 61WEAMT    130 ' ,   ,   ,   , 0 '     CEU011146393
     O**********          31 61WEAMT    130 '   ,   ,   , 0 . '     CEU011146393
     O**********          32 61WEAMT    130 '  ,   ,   , 0 .  '     CEU011146393
     O**********          33 61WEAMT    130 ' ,   ,   , 0 .   '     CEU011146393
     O**********             60WEAMT     97 '  ,   ,   , 0 .  '                        146393 CGL091
     O**********             61WEAMT    130 '  ,   ,   , 0 .  '                        146393 CGL091
      *                                                                   CEU011
     O********D* 1     27N41                                                           S01176 CGL091
     O*******OR* 1     28N41                                                           S01176 CGL091
     O*******OR* 1     29N41                                                    S01176 E20669 CGL091
     O*********              75          73 '* OVERDUE *    '                          S01176 CGL091
     O*********              76          73 '* APPROXIMATE *'                          S01176 CGL091
0768 O********D* 1     02N41                                                                  CGL091
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0557OOP2                                           S01408
     O*                                                                   S01408
0769 O*******OR* 1     03N41                                                                  CGL091
     O*******OR* 1     13N41                                                                  CGL091
     O*******OR**1*****15N41**                                            S01196
     O*******OR* 1     15N41                                                           S01473 CGL091
     O*******OR  1     17N41                                              E20669
     O*******OR* 1     26N41                                                           S01129 CGL091
     O*******OR* 1     27N41                                                           S01129 CGL091
     O*******OR* 1     28N41                                                           S01129 CGL091
     O*******OR* 1     29N41                                       S01129 E20669
     O**********             03          34 'D/D'                                      S01194 CGL091
     O**********             03DDNO      41                                            S01194 CGL091
     O/COPY WNCPYSRC,GL0557O003
0819 O        T 22     LR U7                                              S01194
0773 O***                                22 'REFERENCE DL0550'            E22608
0773 O**********                         22 'REFERENCE GL0550'                         E22608 CGL091
     O                                   22 'REFERENCE GL0557'                                CGL091
0821 O                                   62 'PRINT TERMINATED, '          S01194
0822 O                                   80 'DATABASE IN ERROR'           S01194
     O********T 2      LR                                                 E102
     O********T 2      LR 34                                              E102
     O        T 2      LR 34N41                                           E102
     O*******AND       46                                             E102LN0817
0824 O                                   65 '***   END OF REPORT'         S01117
0825 O                                   71 '***'                         S01117
0772 O********T**203***LRNU7**                                            S01117
0772 O*DL0550AUT**203***LR***************                           S01117E22608
0772 O***GL0557AUT  203   LR                                                           E22608 CGL091
     OGL0557AUT  203   LR                                                                     CGL091
0773 O***********************************22 'REFERENCE DL0550'            S01117
0773 O***********************************24 'REFERENCE DL0550AU'    S01117E22608
0773 O**********                         24 'REFERENCE GL0550AU'                       E22608 CGL091
     O                                   24 'REFERENCE GL0557AU'                              CGL091
0774 O*************************TITL      89                               S01194
     O                         BJURPT    89                               S01194
0775 O                                  104 'DATE'
0776 O*************************RUNA     112                               S01194
     O                         BJMRDT   112                               S01194
0777 O                                  122 'PAGE'
0778 O*************************PAGE  Z  127                               S01117
0778 O                         PAGE1 Z  127                               S01117
0779 O********T**1     LRNU7                                              S01117
0779 O        T  1     LR                                                 S01117
     O**********          66NU4          51 'F.X. '                                    AUS017 CGL091
     O**********          67NU4          51 'M.M. '                                    AUS017 CGL091
0780 O**********            NU4          75 'DAILY EVENTS BY CURRENCY'                        CGL091
0781 O**********            NU4          90 '- RUN CONTROLS'                                  CGL091
     O                    66NU4          38 'F.X. '                                           CGL091
     O                    67NU4          38 'M.M. '                                           CGL091
     O                      NU4          62 'EVENTS BY CURRENCY WITH '                        CGL091
     O                      NU4          81 'RUNNING TOTALS - TO'                             CGL091
     O                   N56NU4          95 'END OF BOOKS '                                   CGL091
     O                   N56NU4         109 '- RUN CONTROLS'                                  CGL091
     O                    56NU4#DAYS     85                                                   CGL091
     O                    56NU4          98 'DAYS FORWARD'                                    CGL091
     O                    56NU4         113 '- RUN CONTROLS'                                  CGL091
0780 O                       U4          64 'SECURITIES TRADING '
0780 O                       U4          82 'EVENTS BY CURRENCY'
0781 O                       U4          97 '- RUN CONTROLS'
0782 O********T**1     LRNU7                                              S01117
0782 O        T  1     LR                                                 S01117
     O**********          66NU4          51 '-----'                                    AUS017 CGL091
     O**********          67NU4          51 '-----'                                    AUS017 CGL091
0783 O**********            NU4          75 '------------------------'                        CGL091
0784 O**********            NU4          90 '----------------'                                CGL091
     O                    66NU4          38 '-----'                                           CGL091
     O                    67NU4          38 '-----'                                           CGL091
     O                      NU4          62 '------------------------'                        CGL091
     O                      NU4          81 '-------------------'                             CGL091
     O                   N56NU4          95 '----------------'                                CGL091
     O                   N56NU4         109 '---------------'                                 CGL091
     O                    56NU4          85 '----'                                            CGL091
     O                    56NU4          98 '-------------'                                   CGL091
     O                    56NU4         113 '---------------'                                 CGL091
0780 O                       U4          64 '-------------------'
0780 O                       U4          82 '------------------'
0781 O                       U4          97 '--------------'
0785 O********T  236   LR 34NU7                                           S01187
0785 O        T  236   LR   NU7                                           S01187
0786 O                                   18 'RUN CONTROLS'
0787 O********T  2     LR 34NU7                                           S01187
0787 O        T  2     LR   NU7                                           S01187
0788 O                                   59 'NUMBER'
0789 O                                   84 'VALUE'
0790 O********T  2     LR 34NU7                                           S01187
0790 O        T  2     LR   NU7                                           S01187
0791 O                                   30 'EVENTS FILE RECORDS RE'
0792 O                                   32 'AD'
0793 O                         RECRED3   59
0794 O                         INT,3 Z   81
0795 O                         DEC,3     84
0796 O********T  2     LR 34NU7                                           S01187
0796 O        T  2     LR   NU7                                           S01187
0797 O                                   27 'EVENTS FILE CONTROL'
0798 O                                   34 'TOTALS'
0799 O                         NORE  3   59
0800 O**********               HRWN  Z   81                               E20669
0801 O**********               HRDC      84                               E20669
0802 O*****                  U8         102 '** DIFFERENCE **'            S01117
     O********T 22     LR 34                                      S01129  S01187
     O        T 22     LR                                                 S01187
     O       AND         NU7NU5                                           S01129
     O       AND         N66N67                                           AUS017
     O                                   26 'SECURITY TRADING 2'          S01129
     O                                 +  1 'RECORDS READ'                S01129
     O                         #SEIN 3   59                               S01129
     O                         INT,4 Z   81                               S01129
     O                         DEC,4     84                               S01129
     O********T  2     LR 34                                      S01129  S01187
     O        T  2     LR                                                 S01187
     O       AND         NU7NU5                                           S01129
     O       AND         N66N67                                           AUS017
     O                                   26 'SECURITY TRADING 2'          S01129
     O                                 +  1 'AUDIT TOTALS'                S01129
     O                         #SEREC3   59                               S01129
     O                         #SETI Z   81                               S01129
     O                         #SETD     84                               S01129
0803 O********T  2     LR 34NU7                                           S01187
0803 O        T  2     LR   NU7                                           S01187
0804 O                                   29 'EVENTS RECORDS LISTED'
0805 O                                   44 'IN THIS REPORT'
0806 O                         RECREP3   59
0807 O                         INT,1 Z   81
0808 O                       80DEC,1 3   84
0809 O                      N80DEC,1     84
0810 O********T        LR 34NU7                                           S01187
0810 O        T        LR   NU7                                           S01187
0811 O**************************         30 'NOSTRO EVENTS EXTRACT '      E193
0812 O**************************         45 'RECORDS CREATED'             E193
0813 O*************************RECRIT3   59                               E193
0814 O*************************INT,2 Z   81                               E193
0815 O*************************DEC,2     84                               E193
0816 O********T   49   LRN34N99
0817 O********                           58 '***   NO DETAILS TO'
     O********                           71 'REPORT   ***'
     O        T 2      LRN34N99                                           E131
     O                                   62 '***   NO DETAILS TO'         E131
0818 O                                   75 'REPORT   ***'                E131
0819 O********T*22*****LR U7 U8                                           S01117
0819 O********T 22     LR U7                                              S01117
0820 O********                           22 'REFERENCE DL0550'            S01117
0821 O********                           62 'PRINT TERMINATED, '          S01117
0822 O********                           80 'DATABASE IN ERROR'           S01117
     O        T 3      LR U7                                              S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7                                              S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7                                              S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
0823 O******  T 2      LR                                                 E299
0824 O******                             65 '***   END OF REPORT'         E299
0825 O******                             71 '***'                         E299
     O/COPY WNCPYSRC,GL0557O004
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2021
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   TABA/TABB - EVENT NARATIVES
10V1VALUE DATE
10V2VALUE DATE
11V1VALUE DATE
11V2VALUE DATE
13V1VALUE DATE
13V2VALUE DATE
14V1VALUE DATE
14V2VALUE DATE
12V1OPTION MATURITY
12V2OPTION MATURITY
15V1START DATE
16V1START DATE
15I2INT. DUE DATE
16I2INT. DUE DATE
17I2INT. DUE DATE
15M1MATURITY DATE
16M1MATURITY DATE
17M1MATURITY DATE
17V1PURCHASE DATE
17V3PURCHASE DATE
18M1SALE DATE
15V3PRINCIPAL INC.
16V3PRINCIPAL INC.
15M4PRINCIPAL DEC.
16M4PRINCIPAL DEC.
41S1START
41I2INTEREST
41M3REPAYMENT
41M4REPAY INTEREST
41R1ROLLOVER
41R2ROLLOVER INT.
41R3NEW PRINCIPAL
41R4ROLLOVER REPAY.
41M1MATURITY
41M2MATURITY INT.
42S8START DISC.
42M1MATURITY
61V1START DATE
62V1START DATE
63V1START DATE
63V2START DATE
64V1START DATE
65V1START DATE
65V2START DATE
66V1START DATE
67V1START DATE
67V2START DATE
71F1LOAN FEE DUE
71F2FACLTY FEE DUE
61I2INT. DUE DATE
62I2INT. DUE DATE
64I2INT. DUE DATE
66I2INT. DUE DATE
70I2INT. DUE DATE
61M1MATURITY DATE
62M1MATURITY DATE
63M1MATURITY DATE
64M1MATURITY DATE
65M1MATURITY DATE
66M1MATURITY DATE
67M1MATURITY DATE
70M2MATURITY DATE
61V3PRIN. INCREASE
62V3PRIN. INCREASE                                                        S01243
64V3PRIN. INCREASE                                                        S01243
66V3PRIN. INCREASE                                                        S01243
61R1REPAY - PRINC                                                         077500
61R2REPAY - INT                                                           077500
62R1REPAY - PRINC                                                         077500
62R2REPAY - INT                                                           077500
64R1REPAY - PRINC                                                         077500
64R2REPAY - INT                                                           077500
66R1REPAY - PRINC                                                         077500
66R2REPAY - INT                                                           077500
61M2MATURITY INT
62M2MATURITY INT
64M2MATURITY INT
66M2MATURITY INT
63R3ROLLOVER PRINC                                                        S01392
63R4ROLLOVER                                                              S01392
63R5ROLLOVER DISC.                                                        S01392
81A2START PAYMENT
82A2START PAYMENT
82A1START RECEIPT
81D1DISHONOR DATE
81P1PAYMENT DATE
80M1MATURITY RECPT.
81M1MATURITY RECPT.
82M1MATURITY RECPT.
80M2MATURITY PAYMT.
81M2MATURITY PAYMT.
82M2MATURITY PAYMT.
81M3MATURITY EXC.
81M4MATURITY EXC.
84V1VALUE DATE
84V2VALUE DATE
84V3VALUE DATE
30P1VALUE DATE
30S1VALUE DATE
30C1COUPON PAYMENT
30C2COUPON PAYMENT
30A1PART. PAID CALL
30D1DIVIDEND RECPT.
30D2DIVIDEND RECPT.
30M1MATURITY
30M2MATURITY
21N1VALUE DATE                                                            S01119
21N2VALUE DATE                                                            051227
21I1SETTLEMENT                                                            S01119
22I1INTEREST                                                              S01119
23I1INTEREST                                                              S01119
24N1INTEREST                                                              S01119
24N2INTEREST                                                              051227
24I1INTEREST                                                              S01119
21C1VALUE DATE                                                            E23278
22C1VALUE DATE                                                            E23278
22S1VALUE DATE                                                            E23278
23C1RATE CHANGE                                                           E23278
24C1RATE CHANGE                                                           E23278
21C2MATURITY                                                              E23278
22C2MATURITY                                                              E23278
22S2MATURITY                                                              E23278
23C2MATURITY                                                              E23278
24C2MATURITY                                                              E23278
31P1TRADE-PURCHASE                                                        S01129
31S1TRADE-SALE                                                            S01129
31C1CUST-PART PAYT.                                                       S01129
31C2CUST-COUPON                                                           S01129
31C3CUST-DIVIDEND                                                         S01129
31C4CUST-MORT.PAYT.                                                       S01129
31C5CUST-MATURITY                                                         S01129
31D1DEPOT-PART PAYT                                                       S01129
31D2DEPOT-COUPON                                                          S01129
31D3DEPOT-DIVIDEND                                                        S01129
31D4DEPOT-MORT.PAYT                                                       S01129
31D5DEPOT-MATURITY                                                        S01129
31B1BOOK-PART PAYT.                                                       S01129
31B2BOOK-COUPON                                                           S01129
31B3BOOK-DIVIDEND                                                         S01129
31B4BOOK-MORT.PAYT.                                                       S01129
31B5BOOK-MATURITY                                                         S01129
91P1PAYMENT DATE
91P2RECEIPT DATE
91P3CHQ REC DATE
91P4CREDIT DATE
91P5CHQ PAY DATE
91P6DEBIT DATE
91P7TRANSFER DATE
91P8REGULAR RECEIPT
91P9REGULAR PAYMENT
70V3PRIN.INCREASE                                                         S01270
31C6SAFE CUST FEE                                                         S01464
93V1PREMIUM                                                               073714
22FEUp-Front Fee                                                          CIR001
23FEUp-Front Fee                                                          CIR001
24FEPremium                                                               CIR001
22BOBuy-Out                                                               CIR001
23BOBuy-Out                                                               CIR001
61R7PRIN. TFR. FROM                                                       CLE004
62R7PRIN. TFR. FROM                                                       CLE004
63R7PRIN. TFR. FROM                                                       CLE004
64R7PRIN. TFR. FROM                                                       CLE004
65R7PRIN. TFR. FROM                                                       CLE004
66R7PRIN. TFR. FROM                                                       CLE004
67R7PRIN. TFR. FROM                                                       CLE004
70R7PRIN. TFR. FROM                                                       CLE004
61V5PRIN. TFR. TO                                                         CLE004
62V5PRIN. TFR. TO                                                         CLE004
63V5PRIN. TFR. TO                                                         CLE004
64V5PRIN. TFR. TO                                                         CLE004
65V5PRIN. TFR. TO                                                         CLE004
66V5PRIN. TFR. TO                                                         CLE004
67V5PRIN. TFR. TO                                                         CLE004
70V5PRIN. TFR. TO                                                         CLE004
62R9MULCCY ROL PAY                                                        CLE004
63R9MULCCY ROL PAY                                                        CLE004
64R9MULCCY ROL PAY                                                        CLE004
62V7MULCCY ROL DRAW                                                       CLE004
63V7MULCCY ROL DRAW                                                       CLE004
64V7MULCCY ROL DRAW                                                       CLE004
68R1REPAY - PRINC                                                         CLE005
68R2REPAY - INT                                                           CLE005
68R7PRIN. TFR.  FROM                                                      CLE005
68R9MULCCY ROL PAY                                                        CLE005
69R1REPAY - PRINC                                                         CLE005
69R2REPAY - INT                                                           CLE005
69R7PRIN. TFR. FROM                                                       CLE005
69R9MULCCY ROL PAY                                                        CLE005
72R1REPAY - PRINC                                                         CLE005
72R2REPAY - INT                                                           CLE005
72R7PRIN. TFR. FROM                                                       CLE005
72R9MILCCY ROL PAY                                                        CLE005
68V1START DATE                                                            CLE005
68V3PRIN. INCREASE                                                        CLE005
68V5PRIN. TFR. TO                                                         CLE005
68V7MULCCY ROL DRAW                                                       CLE005
69V1START DATE                                                            CLE005
69V3PRIN. INCREASE                                                        CLE005
69V5PRIN. TFR. TO                                                         CLE005
69V7MULCCY ROL DRAW                                                       CLE005
72V1START DATE                                                            CLE005
72V3PRIN. INCREASE                                                        CLE005
72V5PRIN. TFR. TO                                                         CLE005
72V7MULCCY ROL DRAW                                                       CLE005
68M1MATURITY DATE                                                         CLE005
68M2MATURITY INT                                                          CLE005
69M1MATURITY DATE                                                         CLE005
69M2MATURITY INT                                                          CLE005
71M2MATURITY DATE                                                         CLE005
72M1MATURITY DATE                                                         CLE005
72M2MATURITY INT                                                          CLE005
68I2INT. DUE DATE                                                         CLE005
69I2INT. DUE DATE                                                         CLE005
71I2INT. DUE DATE                                                         CLE005
72I2INT. DUE DATE                                                         CLE005
61R9MULCCY ROL PAY                                                        CLE005
66R9MULCCY ROL PAY                                                        CLE005
67R9MULCCY ROL PAY                                                        CLE005
61V7MULCCY ROL DRAW                                                       CLE005
65V7MULCCY ROL DRAW                                                       CLE005
66V7MULCCY ROL DRAW                                                       CLE005
67V7MULCCY ROL DRAW                                                       CLE005
71M1MATURITY DATE                                                         CLE005
71R7PRIN. TFR. FROM                                                       CLE005
71V5PRIN. TRF. TO                                                         CLE005
65R9MULCCY ROL PAY                                                        CLE005
10VXVALUE DATE                                                            CEU003
10VYVALUE DATE                                                            CEU003
11VXVALUE DATE                                                            CEU003
11VYVALUE DATE                                                            CEU003
13VXVALUE DATE                                                            CEU003
13VYVALUE DATE                                                            CEU003
14VXVALUE DATE                                                            CEU003
14VYVALUE DATE                                                            CEU003
12VXOPTION MATURITY                                                       CEU003
12VYOPTION MATURITY                                                       CEU003
15VXSTART DATE                                                            CEU003
16VXSTART DATE                                                            CEU003
15IYINT. DUE DATE                                                         CEU003
16IYINT. DUE DATE                                                         CEU003
17IYINT. DUE DATE                                                         CEU003
15MXMATURITY DATE                                                         CEU003
16MXMATURITY DATE                                                         CEU003
17MXMATURITY DATE                                                         CEU003
17VXPURCHASE DATE                                                         CEU003
17VZPURCHASE DATE                                                         CEU003
18MXSALE DATE                                                             CEU003
15VZPRINCIPAL INC.                                                        CEU003
16VZPRINCIPAL INC.                                                        CEU003
15MZPRINCIPAL DEC.                                                        CEU003
16MZPRINCIPAL DEC.                                                        CEU003
61VXSTART DATE                                                            CEU003
62VXSTART DATE                                                            CEU003
63VXSTART DATE                                                            CEU003
63VYSTART DATE                                                            CEU003
64VXSTART DATE                                                            CEU003
65VXSTART DATE                                                            CEU003
65VYSTART DATE                                                            CEU003
66VXSTART DATE                                                            CEU003
67VXSTART DATE                                                            CEU003
67VYSTART DATE                                                            CEU003
61IYINT. DUE DATE                                                         CEU003
62IYINT. DUE DATE                                                         CEU003
64IYINT. DUE DATE                                                         CEU003
66IYINT. DUE DATE                                                         CEU003
70IYINT. DUE DATE                                                         CEU003
61MXMATURITY DATE                                                         CEU003
62MXMATURITY DATE                                                         CEU003
63MXMATURITY DATE                                                         CEU003
64MXMATURITY DATE                                                         CEU003
65MXMATURITY DATE                                                         CEU003
66MXMATURITY DATE                                                         CEU003
67MXMATURITY DATE                                                         CEU003
70MYMATURITY DATE                                                         CEU003
61VZPRIN. INCREASE                                                        CEU003
62VZPRIN. INCREASE                                                        CEU003
64VZPRIN. INCREASE                                                        CEU003
66VZPRIN. INCREASE                                                        CEU003
61RXREPAY - PRINC                                                         CEU003
61RYREPAY - INT                                                           CEU003
62RXREPAY - PRINC                                                         CEU003
62RYREPAY - INT                                                           CEU003
64RXREPAY - PRINC                                                         CEU003
64RYREPAY - INT                                                           CEU003
66RXREPAY - PRINC                                                         CEU003
66RYREPAY - INT                                                           CEU003
61MYMATURITY INT                                                          CEU003
62MYMATURITY INT                                                          CEU003
64MYMATURITY INT                                                          CEU003
66MYMATURITY INT                                                          CEU003
63RZROLLOVER DISC.                                                        CEU003
21IXSETTLEMENT                                                            CEU003
22IXINTEREST                                                              CEU003
23IXINTEREST                                                              CEU003
24IXINTEREST                                                              CEU003
70R9MULCCY ROL PAY                                                        142393
70V7MULCCY ROL DRAW                                                       142393
71R9MULCCY ROL PAY                                                        142393
71V7MULCCY ROL DRAW                                                       142393
70R1REPAY - PRINC                                                         142388
70R2REPAY - INT                                                           142388
71R1REPAY - PRINC                                                         142388
71R2REPAY - INT                                                           142388
CPV1CLS PAYMENT                                                           CDL008
CRV1CLS RECEIVE                                                           CDL008
24BOBUY-OUT                                                               CIR006
23C3VALUE DATE                                                            CIR003
23S3VALUE DATE                                                            CIR003
23C4MATURITY DATE                                                         CIR003
23S4MATURITY DATE                                                         CIR003
15F1LOAN FEE DUE                                                                              CAS009
16F1DEPOSIT FEE DUE                                                                           CAS009
17F1PURCH FEE DUE                                                                             CAS009
DTV1DEBIT TRANSFER                                                                            CAP204
CTV1CREDIT TRANSFER                                                                           CAP204
63R1REPAY - PRINC                                                                           MD055652
65R1REPAY - PRINC                                                                           MD055652
67R1REPAY - PRINC                                                                           MD055652
**  Narratives for ER Events                                              S01496
RED. CALL IN                                                              S01496
RED. CALL OUT                                                             S01496
CUST-RED. CALL                                                            S01496
DEPOT-RED.CALL                                                            S01496
**  Narratives for CA Events                                              CSE007
COR. ACT. SALE                                                            CSE007
COR. ACT. PURCH                                                           CSE007
CUST-COR. ACT                                                             CSE007
DEPOT-COR. ACT                                                            CSE007
** TABA2/TABB2 - Event types/narratives for CLE028 (Rule of 78)                               CLE028
80V1VALUE DATE                                                                                CLE028
80R1REPAY PRIN                                                                                CLE028
80R2REPAY INT                                                                                 CLE028
80M1MATURITY PRIN                                                                             CLE028
80M2MATURITY INT                                                                              CLE028
     X/COPY WNCPYSRC,GL0557X001
