0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Create temp projected nostro bals file')
0002 F********************************************************************
0003 F*                                                                  *
     F*  Midas - Dealing Module
0005 F*                                                                  *
0006 F*       DL0575 - CREATE TEMPORARY PROJECTED NOSTRO BALANCES FILE   *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD032907           Date 27Apr15               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 210796             Date 24Jun03               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 09Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 02Sep96               *
      *                 S01408             Date 08Jan96               *
     F*                      E22608           DATE 04SEP90               *T8452
     F*                      LN0135           DATE 23MAY90               *T8452
     F*                      E260             DATE 09MAR90               *T8452
     F*                      E15139           DATE 21/03/89              *T8452
0009 F*                      S01117           DATE 15/03/89              *S01194
0009 F*                      S01194           DATE 15/03/89              *S01194
     F*                      E10217           DATE 29/12/86              *T8452
     F*                      E80833           DATE 13/06/86              *T8452
0011 F*                                                                  *
0011 F*----------------------------------------------------------------  *
0011 F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  MD032907 - Allow Projected Clear Balance for PRB             *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  210796 - Recompile for changes to SDNOSTPD.                  *
      *  CDL006 - Temporary fix to sort out CCY corruption in PRONTPP *
     F*       S01408  -  Addition of Hook GL0575CCP2                     *
     F*               -  Addition of Hook GL0575IIPG                     *
     F*       S01408  -  Addition of Hook GL0575CCP1                     *
0011 F*       E22608  -  PROGRAM RENAMED FROM DL0575                     *
     F*       LN0135  -  REMOVE 'END OF REPORT' FROM AUDIT REPORT        *LN0135
     F*       E260    -  NO DATE BASE ERROR PROCESSING FOR MISSING       *
     F*                  NOSTRO ACCOUNT                                  *
0011 F*       E15139  -  INCORRECT DETAILS BEING PRINTED FOR DELETED     *E15139
0011 F*                  CLIENTS.                                        *E15139
     F*       S01194 - STANDING DATA CHANGES - TO USE ACCESS PROGRAMS    *S01194
     F*       S01117 - AMENDMENTS FOR MULTIBRANCHING R10                 *S01117
0011 F*       E10217  -  PHASA IS NOW REDUNDANT                          *
0011 F*                                                                  *
0012 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
*******/*OVRF*:*OVRDBF*TABLE*TABDLEE******************************* : *   S01194
     F*                                                               *
     F*****************************************************************
0013 F*HASA***IP**F      32            DISK                               E10217
0014 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
0015 F*****CLINT   IF  F     256  7AI     2 DISK                          S01194
0016 F*****ACCNT***IF  F     400 15AI     2 DISK                          S01117
     F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     FACCNT   IF  F     573 24AI     2 DISK                                                   CGL029
0017 FPRONTHH O   F     128            DISK
0017 FPRONTPP O   F     128            DISK
0017 FPRONTZX O   F     128            DISK
0015 FSDNOSTL0IF  E           K        DISK                               S01194
0018 F*****DL0575P1O***F*****132            PRINTER                S01124 S01117
0018 F*DL0575AUO***F*****132            PRINTER                     S01117E22608
0018 FGL0575AUO   F     132            PRINTER                            E22608
0019 F* ID F  C  H  L    FUNCTION OF INDICATORS
0020 F* 01            PHASE FILE
0021 F**02************TABLE*ICR**************                             S01194
0022 F**03************TABLE*NOSTRO*DETAILS***                             S01194
0023 F* 04            FILES CATCHALL
0024 F**05************CLIENT*-*CUSTOMER*STANDING*DATA*RECORD              S01194
0025 F* 06            ACCOUNT MASTER DETAIL
0026 F********20******CLINT*RECORD*NOT*FOUND*                             S01194
0027 F********21******SHORTNAME*MISSING*FROM*CLINT*RECORD                 S01194
0028 F*       22      NOSTRO CLIENT NUMBER MISSING
0029 F*       23      NEGATIVE AMOUNT IN HASH TOTALLING
0030 F*       40      OUTPUT HEADER TO PRONT
0031 F*       41      OUTPUT CHANGE OF CURRENCY RECORD TO PRONT
0032 F*       42      OUTPUT DETAIL RECORD TO PRONT
0033 F*       60      CHANGE OF CURRENCY
0034 F********79******END*OF*FILE*INDICATOR*FOR*READ*OF*TABLE*ICR         S01194
0035 F*       80      END OF NOSTRO RECORDS
0036 F*       99      FAIL OF CHAIN TO ACCNT
0037 F*       U7,U8   DATABASE ERROR - ICDR 1
     E                    CPY@    1   1 80
0038 I*
0039 I*****DUMMY*INPUT PRIMARY FILE                                       E10217
0040 I***********                                                         E10217
0041 I*HASA***NS* 01                                                      E10217
0042 I*****                                                               S01194
0043 I*****TABLE FILE - ICR 1                                             S01194
0044 I*****                                                               S01194
0045 I*****TABLE   NS  02   2 C0   3 C1  12 C1                            S01194
0046 I*****       AND      13 C0                                          S01194
0047 I*****                                   1   1 RECI                  S01194
0048 I*****                                   2   30RECT                  S01194
0049 I*****                                  12  130RCDE                  S01194
0050 I*****                                  14  66 TITL                  S01194
0051 I*****                                  67  67 DATF                  S01194
0052 I*****                                  68  700DFBR           S01117 S01194
0053 I*****                                 74  74 MODI1                  S01194
0054 I*****                                  75  75 MODI2                 S01194
0055 I*****                                  76  76 MODI3                 S01194
0056 I*****                               P  77  790RUND                  S01194
0057 I*****                                  80  86 RUNA                  S01194
0058 I*****                                  87  870SFLG                  S01194
0059 I*****                               P  90  920LCD                   S01194
0060 I*****                                  93  93 CHTP                  S01194
0061 I*****                               P  94  960TNLU                  S01194
0062 I*****                                                               S01194
0063 I*****                                                               S01194
0064 I*****TABLE   NS  03   1 CD   2 C7   3 C0                            S01194
0065 I*****                                   1   1 RECI                  S01194
0066 I*****                                   2   30RECT                  S01194
0067 I*****                                   9  11 CCY                   S01194
0068 I*****                                  12  130NOSN                  S01194
0069 I*****                                  16  29 ONAC                  S01194
0070 I*****                                  30  350CNUM                  S01194
0071 I*****                                  36  370ACSQ                  S01194
0072 I*****                                  38  410ACOD                  S01194
0073 I*****                               P  90  920LCD                   S01194
0074 I*****                                  93  93 CHTP                  S01194
0075 I*****                               P  94  960TNLU                  S01194
0076 I*****                                                               S01194
0077 I*****CATCHALL                                                       S01194
0078 I*****                                                               S01194
0079 I*****   NS  04                                                      S01194
0080 I*****                                   2   30RECT                  S01194
0081 I*****                                                               S01194
0082 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD                    S01194
0083 I*****                                                               S01194
0084 I*****CLINT   NS  05   1 CD   8 CA                                   S01194
0085 I*****                                   1   1 RECI                  S01194
0086 I*****                                   2   70CNUM                  S01194
0087 I*****                                   8   8 RCDT                  S01194
0088 I*****                                   9  28 CRNM                  S01194
0089 I*****                                  29  38 CTWN                  S01194
0090 I*****                                  39  48 CSNM                  S01194
0091 I*****                                  49  56 CASK                  S01194
0092 I*****                                  57  68 TELX                  S01194
0093 I*****                                  69  80 CSID                  S01194
0094 I*****                                  81  82 ACOC                  S01194
0095 I*****                                  83  83 CBSI                  S01194
0096 I*****                                  84  85 CCTZ                  S01194
0097 I*****                                  86  87 CLOC                  S01194
0098 I*****                                  88  930CPAR                  S01194
0099 I*****                                  94  960BRCD                  S01194
0100 I*****                                  97  980LINS                  S01194
0101 I*****                                  99 1010LIND                  S01194
0102 I*****                               P 102 1040DASU                  S01194
0103 I*****                               P 105 1070CDIC                  S01194
0104 I*****                               P 108 1100DADE                  S01194
0105 I*****                                 111 111 CMIN                  S01194
0106 I*****                                 112 112 CTYP                  S01194
0107 I*****                                 113 124 TELF                  S01194
0108 I*****                                 125 133 CHID                  S01194
0109 I*****                                 134 136 CHAB                  S01194
0110 I*****                               P 250 2520LCD                   S01194
0111 I*****                                 253 253 CHTP                  S01194
0112 I*****                               P 254 2560TNLU                  S01194
0113 I*****                                                               S01194
0114 I*****CATCHALL                                                       S01194
0115 I*****                                                               S01194
0116 I*****   NS  04                                                      S01194
0117 I*
0118 I*    ACCOUNTS MASTER FILE
0119 I*
0120 IACCNT   NS  06   1 CD
0121 I                                       23  25 BRCA                  S01117
0121 I                                    P  56  630LDBL
     I                                    P  64  710CLBL                                    MD032907
      *                                                                   S01408
     I/COPY WNCPYSRC,GL0575IIPG                                           S01408
      *                                                                   S01408
0122 I*
0123 I*    CATCHALL
0124 I*
0125 I        NS  04
     I*                                                                   S01194
     I@BANK     E DSSDBANKPD                                              S01194
     I* BANK DETAILS FILE - EXTERNALLY DESCRIBED                          S01194
     I*                                                                   S01194
     I@CUST     E DSSDCUSTPD                                              S01194
     I* CUSTOMER DETAILS FILE - EXTERNALLY DESCRIBED                      S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0647 I* D A T A   S T R U C T U R E S                                     S01117
0649 I            DS                                                      S01117
0650 I**********                              1  18 KEYACC                             S01117 CGL029
     I                                        1  24 KEYACC                                    CGL029
0651 I*****                                   1   60CNUM           S01117 S01194
0652 I*****                                   7   9 CCY            S01117 S01194
0653 I*****                                  10  130ACOD           S01117 S01194
     I*****                                  14  150ACSQ           S01117 S01194
     I*****                                  16  18 BRCH           S01117 S01194
0651 I                                        1   6 A7CUST                S01194
0652 I                                        7   9 A7CYCD                S01194
0653 I**********                             10  13 A7ACCD                             S01194 CGL029
     I**********                             14  150A7ACSN                             S01194 CGL029
     I**********                             16  18 A7BRCD                             S01194 CGL029
     I                                       10  19 A7ACCD                                    CGL029
     I                                       20  210A7ACSN                                    CGL029
     I                                       22  24 A7BRCD                                    CGL029
     I*****                                                               S01117
     I*****  FILE INFORMATION DATA STRUCTURE                              S01117
     I*                                                                   S01117
0131 I/EJECT
0132 C*
0133 C                     MOVE '   '     CURR    3
0134 C                     MOVE 'A'       KEYCL   7
0135 C**********           Z-ADD0         ZERO6   60                                          CSD027
0135 C                     MOVE *BLANKS   ZERO6   6                                           CSD027
0136 C                     Z-ADD0         ZERO15 150
     C                     MOVEACPY@      BIS@   80
0137 C*    DO ALL PROCESSING AT LR TIME
0138 C                     SETON                     LR
     C***                                                                 S01117
0139 C*****READ*ICR*1***                                                  S01194
0140 C*R****               MOVEL'01'      LLTAB  12                       S01194
0141 C*R****               MOVE '10'      LLTAB                           S01194
0142 C*R****     LLTAB     SETLLTABLE                                     S01194
0143 C*R****               READ TABLE                    79               S01194
     C** USE ACCESS PROGRAM TO READ BANK DETAILS FILE                     S01194
     CLR                   CALL 'AOBANKR0'                                S01194
     CLR                   PARM '*MSG   ' @RTCD   7                       S01194
     CLR                   PARM '*FIRST ' @OPTN   7                       S01194
     CLR         @BANK     PARM @BANK     DSFDY                           S01194
     C**
0144 C*R***************    MOVE BLNK10    BLNK10 10                       S01117
0145 C*****LRN02                SETON                     U7U8            S01194
0146 C*****LRN02           GOTO END                                       S01194
     CLR         @RTCD     IFNE *BLANK                                    S01194
     CLR                   MOVEL'SDBANKPD'DBFILE 10                       S01194
     CLR                   MOVEL'01'      DBASE   2        ************   S01194
     CLR                   MOVEL@OPTN     DBOPTN  7        * DBERR 01 *   S01194
     CLR                   MOVEL@OPTN     DBKEY  29        ************   S01194
     CLR                   SETON                     U7U8                 S01194
     CLR                   EXSR *PSSR                                     S01194
     CLR                   GOTO END                                       S01194
     CLR                   END                                            S01194
0147 C*
0148 C*    OUTPUT HEADER RECORD TO PRONT
0149 CLR                   Z-ADD10000     PRON    50
0150 CLR                   SETON                     40
0151 CLR                   EXCPT
0152 CLR                   SETOF                     40
0153 C*R****               MOVEL'70'      LLTAB                           S01194
0154 C*R****               MOVE '  '      LLTAB                           S01194
0155 C*R****     LLTAB     SETLLTABLE                                     S01194
     CLR         *LOVAL    SETLLSDNOSTL0                                  S01194
0156 CLR         RDNSTR    TAG                             ** RDNSTR TAG *
0157 CLR                   SETOF                     0304
0158 C*
0159 C* USE ACCESS PROGRAM TO READ THE NOSTRO DETAILS FILE                S01194
0160 C*R****               READ TABLE                    80               S01194
0160 CLR                   READ SDNOSTL0                 80               S01194
0161 C*RN80****  RECT      COMP 70                   8080                 S01194
0162 CLR 80                GOTO END
0163 C*RN03****            GOTO RDNSTR                                    S01194
0164 C*R****     CCY       COMP CURR                     60               S01194
     CLR         A7CYCD    COMP CURR                     60               S01194
0175 C*                                                                   S01117
0176 C* CHAIN TO ACCOUNTS MASTER FILE TO RECOVER CURRENT BALANCE & BRCA   S01117
0177 C*                                                                   S01117
     CLR                   SETOF                     06                   S01117
0184 CLR         KEYACC    CHAINACCNT                99                   S01117
     C*                                                                   E260
     CLR         *IN99     IFEQ '1'                                       E260
     CLR                   MOVEL'ACCNT   'DBFILE                          E260
     CLR                   MOVEL'02'      DBASE            ************   E260
     CLR                   MOVELKEYACC    DBKEY  29        * DBERR 02 *   E260
     CLR                   SETON                     U7U8  ************   E260
     CLR                   EXSR *PSSR                                     E260
     CLR                   GOTO END                                       E260
     CLR                   END                                            E260
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0575CCP1                                           S01408
     C*                                                                   S01408
     C*                                                                   E260
     C***LR*06**             Z-ADDLDBL      LDBLNG 150                               S01117 MD032907
     CLR 06                Z-ADDCLBL      LDBLNG 150                                        MD032907
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0575CCP2                                           S01408
      *                                                                   S01408
     CLRN06                Z-ADD0         LDBLNG                          S01117
0165 CLR 60                GOTO CHAIN
0166 C*
0167 C*    WRITE CHANGE OF CURRENCY RECORD TO PRONT
0168 C*
     CLR                   MOVE *BLANKS   BRCAB   3                       E260
0169 CLR                   SETON                     41
0170 CLR                   EXCPT
0171 CLR         DETREC    ADD  1         DETREC
0172 CLR                   SETOF                     41
0173 C*R****               MOVE CCY       CURR                            S01194
     CLR                   MOVE A7CYCD    CURR                            S01194
     CLR                   MOVE A7CYCD    WCCY    3                       CDL006
0174 CLR         CHAIN     TAG                             ** CHAIN TAG **
0175 C*
0176 C*****CHAIN*TO*ACCOUNTS MASTER FILE TO RECOVER CURRENT BALANCE       S01117
0177 C*****                                                               S01117
0178 C*****LR                   MOVELCNUM      LPART   9                  S01117
0179 C*****LR                   MOVE CCY       LPART                      S01117
0180 C*****LR                   MOVELACOD      RPART   6                  S01117
0181 C*****LR                   MOVE ACSQ      RPART                      S01117
0182 C*****LR                   MOVELLPART     KEYACC 15                  S01117
0183 C*****LR                   MOVE RPART     KEYACC                     S01117
     C*****LR                   SETOF                     06              S01117
0184 C*****LR         KEYACC    CHAINACCNT                99              S01117
     C*****LR 06                Z-ADDLDBL      LDBLNG 150                 S01117
     C*****LRN06                Z-ADD0         LDBLNG                     S01117
0185 C*RN99**              Z-ADDLDBL      LDBLNG 150                      E80833
0186 C*R*99*               Z-ADD0         LDBLNG                          E80833
0187 C*
0188 C*    USE ACCESS PROGRAM TO RECOVER CUSTOMER NAME, TOWN              S01194
0189 C*    AND SHORTNAME FROM THE CUSTOMER DETAILS FILE                   S01194
0190 C*
0191 CLR                   SETOF                     202122
0191 CLR                   SETOF                     04                   E15139
0192 C*R****     CNUM      COMP 0                        22               S01194
     C*                                                                   S01194
     C*  IF CUSTOMER NO NOT FOUND ON ACCNT DONT CHAIN TO CUST             S01194
     C*                                                                   S01194
     CLR         A7CUST    COMP *ALL'0'                  22               S01194
     CLR         A7CUST    COMP *BLANK                   22               S01194
0193 C*RN22****            MOVELCNUM      KEYCL                           S01194
0194 C*RN22****  KEYCL     CHAINCLINT                20                   S01194
     C*                                                                   S01194
     CLRN22                CALL 'AOCUSTR0'                                S01194
     CLR                   PARM '*MSG   ' @RTCD                           S01194
     CLR                   PARM '*KEY   ' @OPTN                           S01194
     CLR                   PARM A7CUST    @KEY1  10                       S01194
     CLR                   PARM *BLANK    @KYST   7                       S01194
     CLR         @CUST     PARM @CUST     DSSDY                           S01194
      *                                                                   CDL006
      ** Restore currency code (A7CYCD) for PRONTPP since it is being     CDL006
      ** corrupted after issuing AOCUSTR0.                                CDL006
      *                                                                   CDL006
     CLR                   MOVELWCCY      A7CYCD                          CDL006
     C*
0195 C*RN20N22***CSNM******COMP BLNK10                   21               S01194
     C*                                                                   S01194
     C**  IF CUSTOMER RECORD NOT FOUND SET ON *IN20                       S01194
     CLR         @RTCD     IFNE *BLANK                                    S01194
     CLR         *IN22     ANDNE'1'                                       S01194
     CLR                   SETON                         20               S01194
     CLR                   END                                            S01194
0194 CLRN22 04             SETON                     20                   E15139
     C*                                                                   S01194
     C**  IF CUSTOMER SNAME BLANK SET ON *IN21                            S01194
     CLR         @RTCD     IFEQ *BLANK                                    S01194
     CLR         *IN22     ANDNE'1'                                       S01194
     CLR         BBCSSN    COMP *BLANKS                  21               S01194
     CLR                   END                                            S01194
0196 C*
0197 C*    WRITE DETAIL RECORD TO PRONT AND ACCUMULATE HASH TOTAL
0198 C*
0199 CLR                   EXSR DPRONT
0200 CLR                   GOTO RDNSTR
0201 CLR         END       TAG                             ** END TAG **
0202 CLR         DETREC    ADD  2         RECRIT  50
0203 C**
0204 C********************************************************************
0205 C           DPRONT    BEGSR
0206 C           DETREC    ADD  1         DETREC  50
0207 C           LDBLNG    DIV  1000      ZZAMT        23
     C/COPY WNCPYSRC,GL0575C001
0208 C   23                Z-SUBZZAMT     ZZAMT
0209 C                     EXSR GLZADD
0210 C                     SETON                     42
0211 C                     EXCPT
0212 C                     SETOF                     42
0213 C                     ENDSR
0214 C********************************************************************
0215 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0216 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0217 C*
0218 CSR         GLZADD    BEGSR                           *** GLZADD ****
0219 C*
0220 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0221 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0222 C*
0223 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0224 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0225 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0226 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0227 C*
0228 CSR                   EXSR GLZSUM
0229 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0230 C*
0231 C********************************************************************
0232 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0233 C*                        GLZADD, GLZSUB, GLZCMP.
0234 C*          PARAMETERS PASSED -
0235 C*                     I/P ZZAMTI ZZAMTD
0236 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0237 C*
0238 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0239 C*
0240 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0241 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0242 CSR                   SETOF                     919293
0243 CSR                   SETOF                     949599
0244 C*
0245 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0246 CSR         ZZAMTI    COMP 0                      9293
0247 CSR 93      ZZAMTD    COMP 0                      9293
0248 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0249 C*
0250 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0251 CSR         ZZTOTI    COMP 0                      9193
0252 CSR 93      ZZTOTD    COMP 0                      9193
0253 C*
0254 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0255 CSR 93                Z-ADDZZAMTI    ZZTOTI
0256 CSR 93                Z-ADDZZAMTD    ZZTOTD
0257 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0258 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0259 CSR 91N92
0260 CORN91 92             GOTO ZZOFPS
0261 C*
0262 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0263 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0264 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0265 C*
0266 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0267 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0268 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0269 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0270 C*
0271 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0272 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0273 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0274 CSRN99                Z-ADDZZWK2     ZZTOTD
0275 CSRN99                Z-ADDZZWK3     ZZTOTI
0276 C*
0277 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0278 CSR 99                Z-ADD0         ZZAMT  153
0279 CSR                   GOTO ZZSEND
0280 C*
0281 C* THE 'SIGNS' ARE DIFFERENT
0282 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0283 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0284 C*
0285 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0286 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0287 C*
0288 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0289 C*
0290 CSR 91                Z-SUBZZTOTI    ZZTOTI
0291 CSR 91                Z-SUBZZTOTD    ZZTOTD
0292 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0293 C*
0294 CSR         ZZTOTI    COMP ZZAMTI               93  95
0295 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0296 C*
0297 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0298 CSR 95                Z-ADD0         ZZTOTI
0299 CSR 95                Z-ADD0         ZZTOTD
0300 CSR 95                GOTO ZZSEND
0301 C*
0302 C* IF ZZTOT GT. ZZAMT.
0303 CSR 93      ZZAMTD    COMP ZZTOTD               94
0304 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0305 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0306 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0307 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0308 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0309 C*
0310 C*
0311 C* IF ZZAMT GT. ZZTOT.
0312 CSRN93      ZZTOTD    COMP ZZAMTD               94
0313 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0314 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0315 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0316 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0317 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0318 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0319 C*
0320 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0321 CSR                   SETOF                     94
0322 CSR 93 91
0323 CORN93 92             SETON                     94
0324 CSR 94                Z-SUBZZTOTI    ZZTOTI
0325 CSR 94                Z-SUBZZTOTD    ZZTOTD
0326 C**
0327 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0328 CSR 92                Z-SUBZZAMTI    ZZAMTI
0329 CSR 92                Z-SUBZZAMTD    ZZAMTD
0330 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0331 C**
0332 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0333 CSR                   SETOF                     96
0334 CSR         ZZTOTD    COMP 0                        91
0335 CSR 91      ZZTOTI    COMP 0                      96
0336 CSR 96                MOVE '.000-'   ZZNEGD  5
0337 CSR                   ENDSR                             ** ENDSR **
0338 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*****************************************************************   S01194
0339 C/EJECT
0340 O*
0341 O*    TEMPORARY PROJECTED NOSTRO BALANCES FILE
0342 O*
0343 OPRONTHH E        40
0344 O                                    6 'A   00'
0345 O                         PRON       9P
0346 OPRONTPP E        41
0347 O                                    1 'D'
0348 O*****                    CCY        4                               S01194
     O                         A7CYCD     4                               S01194
0349 O                                   17 '00NEW/UNALLOC'
0350 O                         ZERO15    44P
0351 O                         ZERO6     50
0352 O                                   60 'NEW/UNALLC'
     O***********************  BRCA      80                         S01117E260
     O                         BRCAB     80                               E260
0353 OPRONTPP E        42
0354 O                                    1 'D'
0355 O*****                    CCY        4                               S01194
     O                         A7CYCD     4                               S01194
0356 O*****                    NOSN       6                               S01194
     O                         A7NONB     6                               S01194
0357 O*****              N22N20CRNM      26                               S01194
     O                   N22N20BBCRNM    26                               S01194
0358 O                   N22 20          17 'CLINT MISSG'
0359 O                       22          17 'CLINT MISSG'
0360 O*****              N22N20CTWN      36                               S01194
     O                   N22N20BBCRTN    36                               S01194
     O/COPY WNCPYSRC,GL0575O001
0361 O                         LDBLNG    44P
     O/COPY WNCPYSRC,GL0575O003
0362 O*****                 N22CNUM      50                               S01194
0363 O*****           N20N22N21CSNM      60                               S01194
     O                      N22BBCUST    50                               S01194
     O                N20N22N21BBCSSN    60                               S01194
0364 O                       21          60 'STNM MISSG'
0365 O                       22          60 'CLINT MISG'
0366 O                       20          60 'CLINT MISG'
     O                         BRCA      80                               S01117
0367 OPRONTZX T        LR
0368 O                                    1 'T'
0369 O                         RECRIT     6
0370 O*
0371 O*    CONTROL REPORT
0372 O*
0373 O*****DL0575P1T**203***LR**                                   S01124 S01117
     O*DL0575AUT**203***LR**************                            S01117E22608
     OGL0575AUT  203   LR                                                 E22608
0374 O*****                              22 'REFERENCE DL0575'            S01117
0374 O***********************************22 'REFERENCE DL0575AU'    S01117E22608
0374 O                                   22 'REFERENCE GL0575AU'          E22608
0375 O*****                    TITL      89                               S01194
     O                         BJURPT    89                               S01194
0376 O                                  104 'DATE'
0377 O*****                    RUNA     112                               S01194
     O                         BJMRDT   112                               S01194
0378 O                                  127 'PAGE    1'
0379 O        T  1     LR
0380 O                                   63 'CREATION OF TEMPORARY PR'
0381 O                                   87 'OJECTED NOSTRO BALANCES '
0382 O                                   91 'FILE'
0383 O        T        LR
0384 O                                   63 '------------------------'
0385 O                                   87 '------------------------'
0386 O                                   91 '----'
0387 O        T  236   LR
0388 O                                   18 'RUN CONTROLS'
0389 O        T  2     LR
0390 O                                   59 'NUMBER'
0391 O                                   84 'VALUE'
0392 O        T  3     LR
0393 O                                   28 'EXTRACT FILE CREATED'
0394 O                         RECRIT3   59
0395 O                         ZZTOTIZ   81
0396 O                         ZZTOTD    84
0397 O        T 3      LR U7 U8
0398 O***********************************22 'REFERENCE DL0575'            S01117
0399 O***********************************62 'PRINT TERMINATED, '          S01117
0400 O***********************************80 'DATABASE IN ERROR'           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
0401 O*****   T 1      LRNU7NU8                                           LN0135
0402 O*****                              65 '***   END OF REPORT'         LN0135
0403 O*****                              71 '***'                         LN0135
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
