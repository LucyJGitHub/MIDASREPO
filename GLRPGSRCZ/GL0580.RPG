0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Events by nostro rpt crt prjtd nostro')       *
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Dealing Module                                       *
0005 F*                                                               *
0006 F***GL0580*-*Events*by*Nostro*Report********                     *080723
     F*  GL0580 - Generate Projected Nostro Events                    *080723
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD054101           Date 08Aug19               *
      *  Prev Amend No. MD053950           Date 16Jul19               *
      *                 MD053873           Date 10Jul19               *
      *                 MD052216           Date 04Apr19               *
      *                 AR375646           Date 17Oct19               *
      *                 MD046248           Date 27Oct17               *
      *                 MD044815           Date 13Apr17               *
      *                 MD036589A          Date 22Feb17               *
      *                 MD036589           Date 14Feb16               *
      *                 CLE154             Date 06Aug12               *
      *                 AR1071639          Date 12Mar15               *
      *                 AR847588           Date 12Mar15               *
      *                 MD022382A          Date 25Sep13               *
      *                 MD021048           Date 16Sep13               *
      *                 CGL124             Date 12Dec12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR987769           Date 22Jun12               *
      *                 263013             Date 21Jan10               *
      *                 CER059             Date 19Jul10               *
      *                 259845             Date 11Sep09               *
      *                 BUG24690           Date 07Jul09               *
      *                 BUG27920           Date 21Jul10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 18Feb09               *
      *                 CAP204             Date 15Feb10               *
      *                 260194             Date 11May09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CPK028             Date 24May07               *
      *                 247870             Date 06Jun07               *
      *                 246761             Date 30Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 245212             Date 23Feb07               *
      *                 240943             Date 20Jul06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12888           Date 15Dec06               *
      *                 237473             Date 25Oct06               *
      *                 242615             Date 03Oct06               *
      *                 237466             Date 24Mar06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG8552            Date 29Sep05               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 04May04               *
      *                 CRE020             Date 20Jan04               *
      *                 223572             Date 03Dec03               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE028             Date 27Jun02               *
      *                 209995             Date 30Sep02               *
      *                 CRE009             Date 23AUG02               *
      *                 174759             Date 07Feb00               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 210261             Date 17Jan03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 193207             Date 14Sep01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CIR007             Date 11May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003             Date 13Sep00               *
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      *                 178438             Date 12Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 102748             DATE 24May96               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CGL010             Date 08Nov99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01Mar99               *
      *                 151088             Date 23Dec98               *
     F*                 138004             Date 21Oct98               *
      *                 CTI002             Date 23Sep98               *
     F*                 CEU017             Date 02Apr98               *
     F*                 CSE007             Date 17Mar98               *
     F*                 CEU003             Date 21Jan98               *
     F*                 CLE005             Date 22May97               *
     F*                 CLE004             Date 02Dec96               *
      *                 CTI001             Date 24NOV97               *
     F*                 119081             DATE 17OCT97               *
     F*                 CFF004             DATE 02OCT96               *
     F*                 S01408             DATE 02SEP96               *
     F*                 S01408             Date 04Jul96               *
     F*                 S01408             Date 26Jun96               *
     F*                 S01408             DATE 15MAY96               *
     F*                 S01408             DATE 10MAY96               *
     F*                 S01408             DATE 24APR96               *
     F*                 S01408             DATE 04APR96               *
     F*                 068596             DATE 23JAN96               *
     F*                 096560             DATE 04DEC95               *
     F*                 S01408             DATE 08JAN96               *
     F*                 S01408             DATE 07NOV95               *
     F*                 090909             DATE 24AUG95               *
     F*                 S01408             DATE 23AUG95               *
     F*                 073714             DATE 01MAR95               *
     F*                 CIR001             DATE 13JUN95               *
     F*                 080723             DATE 20DEC94               *
     F*                 S01408             DATE 13DEC94               *
     F*                 S01408             DATE 11NOV94               *
     F*                 S01473             DATE 16AUG94               *
     F*                 055773             DATE 26MAY94               *
     F*                 052613             DATE 25MAY94               *
     F*                 058106             DATE 25APR94               *
     F*                 058757             DATE 30AUG93               *
     F*                 042757             DATE 13DEC93               *
     F*                 046303             DATE 09DEC93               *
     F*                 E36796             DATE 10JAN94               *
     F*                 055800             DATE 18NOV93               *
     F*                 046872             DATE 03SEP93               *
     F*                 033647             DATE 19MAR93               *
     F*                 045634             DATE 23APR93               *
     F*                 S01392             DATE 22SEP92               *
     F*                 E38323             DATE 31JUL92               *
     F*                 E36449             DATE 11DEC91               *
     F*                 S01270             DATE 01OCT91               *
     F*                 E26063             DATE 24SEP91               *
     F*                 E27024             DATE 24SEP91               *
0009 F*                 E22608             DATE 27SEP90               *
0009 F*                 E20190             DATE 01FEB90               *
     F*                 LN0819             DATE 01OCT90               *
     F*                 LN0763             DATE 21SEP90               *
     F*                 LN0730             DATE 17SEP90               *
     F*                 LN0720             DATE 12SEP90               *
     F*                 BHF259             DATE 07AUG90               *
     F*                 BHF276             DATE 16JUL90               *
     F*                 LN0354             DATE 12JUN90               *
     F*                 LN0135             DATE 24MAY90               *
     F*                 S01243             DATE 05MAY90               *
     F*                 E249               DATE 1MAR90                *
     F*                 S01178             DATE 30/08/89              *
     F*                 E194               DATE 19DEC89               *
     F*                 E00045             DATE 09/11/89              *
     F*                 S01194             DATE 13/04/89              *
     F*                 S01117             DATE 13/04/89              *
     F*                 S84089             DATE 13/04/89              *
     F*                 S01195             DATE 13/04/89              *
     F*                 S01196             DATE 13/04/89              *
     F*                 S01154             DATE 19/08/88              *
     F*                 S01176             DATE 18/08/88              *
     F*                 S03220             DATE 11/05/88              *
     F*                 S01155             DATE 26/04/88              *
     F*                 E11718             DATE 15/03/88              *
     F*                 S01129             DATE 06/08/87              *
0009 F*                 S01119             DATE 15/06/87              *
     F*                 E10305             DATE 09/02/87              *
     F*                 E81277             DATE 20/01/87              *
0010 F*                 S01108             DATE 24/09/86              *
0009 F*                 S01124             DATE 00/00/00              *
     F*                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD054101 - Incorrect Value Date for fee payment when CLE141  *
      *             is ON and settlement is Nostro. Add processing    *
      *             to check holiday in currency/location combination *
      *             defined for the loan when CLE141 is ON.           *
      *  MD053950 - Incorrect Value Date for fee payment when CLE031  *
      *             is ON and settlement currency is not blank.       *
      *             Include event types FX and FY in checking of the  *
      *             actual event date.                                *
      *  MD053873 - Set fee currency as first basis for checking      *
      *             currency holiday setup. Then, use settlement      *
      *             currency when CLE031 is ON and value is not blank *
      *  MD052216 - Lending Fee's Payment Due and Taken Day           *
      *  AR375646 - Loans with -neg principal display as positive.    *
      *             Amount should be positive on PAMV with DORC = 1.  *
      *             to balance settlement account. Applied fix 220213.*
      *           - Applied for MD053091                              *
      *  MD046248 - Finastra Rebranding                               *
      *  MD044815 - System did not generate reversal projections when *
      *             FX netting transaction was reversed.  Ensure      *
      *             complete set of projections are created by the    *
      *             system during reversal.                           *
      *  MD036589A - Reopened. Correct the transaction ref for FX     *
      *              netting event.                                   *
      *  MD036589 - Create nostro event for FX nets.                  *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  AR1071639 - Allow negative base rate. Condition fix AR847588 *
      *              to lending transaction only. (Child: AR1071642)  *
      *  AR847588 - Reverse EAMT when negative to ensure that amount  *
      *             is posted accurately in PF/RSACMTPD.              *
      *           - Applied for MD033488                              *
      *  MD022382A - PRONOPN differences after check cob 6            *
      *  MD021048 - DL Events missing from Nostro balance. Amended to *
      *             use DNWD-1 as start date/basis of event extraction*
      *           - Applied for MD022382                              *
      *  CGL124 - Postings Narrative on Event by Nostro Report        *
      *           Added hooks: OFCPYSRCZ,CGL124_001                   *
      *                        OFCPYSRCZ,CGL124_002                   *
      *                        OFCPYSRCZ,CGL124_003                   *
      *                        OFCPYSRCZ,CGL124_004                   *
      *                        OFCPYSRCZ,CGL124_005                   *
      *                        OFCPYSRCZ,CGL124_006                   *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR987769 - Discrepancies on the Projected Nostro Balances    *
      *             enquiry. Extended projections for 6th & 7th day   *
      *             in RSACMTPD for latter use in GPNOSBGEN &         *
      *             GPNOSBUPD modules. Apply GEMS 261481.             *
      *  263013 - Error on Projected Nostro enquiry. Nostro events    *
      *           should base the extraction from the calendar setup  *
      *           of the deal currency, instead of local currency.    *
      *           Part of the fix is to apply 258293 and 259845.      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  259845 - Wrong forward days generated for local currency.    *
      *           Save previous ZCCY and ZLOC in SRPSTD for use when  *
      *           ccy changes in PRONT and need to set up new forward *
      *           days.                                               *
      *  BUG24690 - Set correct narrative for the corresponding event *
      *  BUG27920 - all account transfers should have movement type   *
      *             'F' in GL0580 and RE0672                          *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CAP204 - Teller Related APIs - Account Transfer              *
      *  260194 - Applied core fix 243352. Applied the same condition *
      *           to the other call to SRRPAD.                        *
      *  243352 - SR/SRRPAD should only be executed for LE events so  *
      *           that shadow posting for other module's events will  *
      *           be generated to the correct settlement account.     *
      *  CPK028 - Duplicate /COPY statement for ZBKDT introduced by   *
      *           246761.                                             *
      *  247870 - Transaction Type (TRYP) is incorrect on Position    *
      *           Settlements Projected Account Movement entries.     *
      *  246761 - Posting Date is always equal to the posting Value   *
      *           Date even if it falls on a holiday.
      *  245212 - Fee Type truncated. Adjust LNRF to move Fee type    *
      *           correctly to field FTYP.                            *
      *  240943 - Fix overprinting of line "TRADE INNOVATION REFE-    *
      *           RENCE NUMBER FOR ABOVE CUSTOMER:" when "D/D" info   *
      *           is not printed in front of it.                      *
      *  BUG12888 - Account Movements Enquiry missing source          *
      *             of Posting                                        *
      *  237473 - Dates in PRONOPN should be based on local currency  *
      *           holidays instead of nostro a/c currency holidays.   *
      *  242615 - Correct System Values.                              *
      *           Apply 240976.                                       *
      *  237466 - Repayment not displayed on the account.             *
      *           Repayment base date should reflect as actual Event  *
      *           Date. PTDI = ' ' should be processed the same way   *
      *           as PTDI='M'. Include Settlement Types 02 and 12 in  *
      *           the validation for Transaction CCY.  Apply 236098.  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG8552 - Interest payment on holiday not shown on PAMV of   *
      *            next working day. Allow EDAT<RUND but not equal to *
      *            0 to be written to RSACMTPD. Set posting date equal*
      *            to next working date. (Based on Fix 234914)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CRE020 - Midas Plus Online Printing of Advices (GE7)         *
      *  223572 - Events By Nostro Rprt is showing the All In and     *
      *           NTR Events                                          *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  209995 - Apply the following fixes:                          *
      *  -179918  Further enhancement of 144042: Check the prono date *
      *           array to set the array index on when to start the   *
      *           updating of the prono balances.                     *
      *  -179918  Further enhancement to 144042: Check the SO's event *
      *           date against variable REPDAT (no. of days fwd to    *
      *           project) to determine if the event should be        *
      *           included in the report.                             *
      *  -144042  Reopen : Wrong narrative for standing orders .      *
      *  -137834  FX/MM deals with 00 settlement method are missing   *
      *           in the Events By Nostro report.  Fix is to include  *
      *           in LF/NOSEV.                                        *
      *  -144042  Include events from Standing Order transactions.    *
      *                                                               *
      *  CRE009 - Projected Account Movements for Retail Accounts     *
      *  174759 - Nostro balances are being updated incorrectly by    *
      *           Financial Futures events                            *
      *  210261 - Missing info on Projected Nostro Balance enquiry.   *
      *           Removed core fix 102748 from source. Also corrected *
      *           the coding of 178438.
      *  193207 - Move the correct transaction type and number for    *
      *           Trade Innovation transactions.                      *
      *  CIR007 - Overnight Index Swaps                               *
      *  CIR003 - Principal Exchange on Cross Currencies IRS          *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps. Coding done for Amortisation of  *
      *           Caps/Collars/Floors only.                           *
      *  CDL008 - Continuous Linked Settlement                        *
     F*  178438 - For SE Coupon and Maturity events, output the       *
     F*           Security details on Events by Nostro report and     *
     F*           on Projected Account Mvmts screen (based on 157381) *
      *  102748 - For non-trade SE events show trans type as 'SE' and *
      *           move event description from TABNAM to TNMR field,   *
      *           to give more meaningful description.                *
      *  CGL010 - Future Value Dated Journal Entries for Non-Retail   *
      *           Accounts.                                           *
      *  CDL006 - Dealing Fiduciary                                   *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
     F*  151088 - TI postings not producing projected postings or     *
     F*           updating projected nostros.                         *
     F*  138004 - Add 4 elements to TABCOD TABNAM 15M2, 16M2,15MY,16MY*
     F*         - Name MATUR INT                                      *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  CEU017 - Securities Redenomination Euro Changes              *
     F*           Same coding than CSE007                             *
     F*  CSE007 - Corporate Actions                                   *
     F*  CEU003 -  Include processing required by EMU switchable      *
     F*            feature CEU003. Replaced 16V1 by 61V1 in TABCOD and*
     F*            added 69 entries to TABCOD and TABNAM respectively.*
     F*  CLE005 - Customer Lending Enhancements - Tranche 3           *
     F*  CLE004 - Customer Lending Enhancements - Syndications.       *
     F*  CTI001 - Midas / Trade Innovation Interface Phase 1          *
     F*  119081 - The field lengths of NOSEXFF for change CFF004      *
     F*           were not applied properly.                          *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
     F*  S01408 - Core hook GL0580IP31 added.                         *
     F*         - Core hook GL0580OP22 added.                         *
     F*  S01408 - Core hook GL0580CP35 added.                         *
     F*  S01408 - Core hook GL0580CP34 added.                         *
     F*  S01408 - Core hook GL0580FFP3 added.                         *
     F*           Core hook GL0580IP30 added.                         *
     F*           Core hook GL0580IP29 added.                         *
     F*           Core hook GL0580IP28 added.                         *
     F*           Core hook GL0580IP27 added.                         *
     F*           Core hook GL0580IP26 added.                         *
     F*           Core hook GL0580IP25 added.                         *
     F*           Core hook GL0580IP24 added.                         *
     F*           Core hook GL0580IP23 added.                         *
     F*           Core hook GL0580IP22 added.                         *
     F*           Core hook GL0580IP21 added.                         *
     F*           Core hook GL0580IP20 added.                         *
     F*           Core hook GL0580IP19 added.                         *
     F*           Core hook GL0580IP18 added.                         *
     F*           Core hook GL0580IP17 added.                         *
     F*           Core hook GL0580IP16 added.                         *
     F*           Core hook GL0580IP15 added.                         *
     F*           Core hook GL0580IP14 added.                         *
     F*           Core hook GL0580IP13 added.                         *
     F*           Core hook GL0580IP12 added.                         *
     F*           Core hook GL0580IP11 added.                         *
     F*           Core hook GL0580IP10 added.                         *
     F*           Core hook GL0580IIP9 added.                         *
     F*           Core hook GL0580CP33 added.                         *
     F*           Core hook GL0580CP32 added.                         *
     F*           Core hook GL0580CP31 added.                         *
     F*           Core hook GL0580CP30 added.                         *
     F*           Core hook GL0580CP29 added.                         *
     F*           Core hook GL0580CP28 added.                         *
     F*           Core hook GL0580CP27 added.                         *
     F*           Core hook GL0580CP26 added.                         *
     F*           Core hook GL0580CP25 added.                         *
     F*           Core hook GL0580CP24 added.                         *
     F*           Core hook GL0580CP23 added.                         *
     F*           Core hook GL0580CP22 added.                         *
     F*           Core hook GL0580CP21 added.                         *
     F*           Core hook GL0580OP21 added.                         *
     F*           Core hook GL0580OP20 added.                         *
     F*           Core hook GL0580OP19 added.                         *
     F*           Core hook GL0580OP18 added.                         *
     F*           Core hook GL0580OP17 added.                         *
     F*           Core hook GL0580OP16 added.                         *
     F*           Core hook GL0580OP15 added.                         *
     F*           Core hook GL0580OP14 added.                         *
     F*           Core hook GL0580OP13 added.                         *
     F*           Core hook GL0580OP12 added.                         *
     F*           Core hook GL0580OP11 added.                         *
     F*  S01408 - Addition of core hook GL0580CP20                    *
     F*           Addition of core hook GL0580CP19                    *
     F*           Addition of core hook GL0580CP18                    *
     F*           Addition of core hook GL0580OP10                    *
     F*           Addition of core hook GL0580OOP9                    *
     F*           Addition of core hook GL0580OOP8                    *
     F*           Addition of core hook GL0580OOP7                    *
     F*           Addition of core hook GL0580OOP6                    *
     F*           Addition of core hook GL0580OOP5                    *
     F*           Addition of core hook GL0580OOP4                    *
     F*           Addition of core hook GL0580OOP3                    *
     F*  S01408 - Addition of core hook GL0580FFP1                    *
     F*           Addition of core hook GL0580FFP2                    *
     F*           Addition of core hook GL0580IIP1                    *
     F*           Addition of core hook GL0580IIP2                    *
     F*           Addition of core hook GL0580IIP3                    *
     F*           Addition of core hook GL0580IIP4                    *
     F*           Addition of core hook GL0580IIP5                    *
     F*           Addition of core hook GL0580IIP6                    *
     F*           Addition of core hook GL0580IIP7                    *
     F*           Addition of core hook GL0580IIP8                    *
     F*           Addition of core hook GL0580CP17                    *
     F*  S01408 - Addition of core hook GL0580CP14                    *
     F*           Addition of core hook GL0580CP15                    *
     F*           Addition of core hook GL0580CP16                    *
     F*           Addition of core hook GL0580OOP2                    *
     F*  073714 - OTC ENHANCEMENTS                                    *
     F*  068596 - Events by Nostro report missing final balance       *
     F*           for last account for each branch because fix        *
     F*           064666 closes GL0580P1 after printing "End of       *
     F*           Branch" line. Reinstate total output for this       *
     F*           line and just close prtf and set off indicators     *
     F*           in detail time.                                     *
     F*  096560 - Output correct type to RSACMTPD for SE events       *
     F*  S01408 - Addition of core hook GL0580CP13                    *
     F*           Addition of core hook GL0580CP12                    *
     F*           Addition of core hook GL0580CP11                    *
     F*  S01408 - Addition of core hook GL0580CP10                    *
     F*           Addition of core hook GL0580OOP1                    *
     F*  090909 - EXCHANGE RATE SHOULD BE SHOWN FOR FX DEALS          *
     F*  S01408 - Addition of core hook GL0580EEP1                    *
     F*           Addition of core hook GL0580EEP2                    *
     F*  073714 - OTC ENHANCEMENTS                                    *
     F*  CIR001 - Interest Rate Calendars.                            *
     F*           Add new event types to TABCOD and TABNAM.           *
     F*  080723 - This pgm is the projected nostro event generation   *
     F*           program, not just a report. This option must be run *
     F*           for all branches, and there should not be an option *
     F*           to run this on request in I/C or COB, especially    *
     F*           for only one branch, as this will corrupt the       *
     F*           Projected Nostro Enquiry function.                  *
     F*  S01408 - Addition of core hook GL0580OPG2                    *
     F*  S01408 - Addition of core hook GL0580IIPG                    *
     F*           Addition of core hook GL0580CCP1                    *
     F*           Addition of core hook GL0580CCP2                    *
     F*           Addition of core hook GL0580CCP3                    *
     F*           Addition of core hook GL0580CCP4                    *
     F*           Addition of core hook GL0580CCP5                    *
     F*           Addition of core hook GL0580CCP6                    *
     F*           Addition of core hook GL0580CCP7                    *
     F*           Addition of core hook GL0580CCP8                    *
     F*           Addition of core hook GL0580CCP9                    *
     F*           Addition of core hook GL0580CCPG                    *
     F*           Addition of core hook GL0580OPG1                    *
     F*  S01473 - Midas Leo Integration. Addition of LC files and     *
     F*           events processing                                   *
     F*  055773 - Events by Nostro reports does not show some MM      *
     F*           events if system is on retrospective accruals.      *
     F*           If Accrual for Non-working days indicator is 2,     *
     F*           then the following checking is needed.  If the      *
     F*           Accrual/Profit Date is less than or equal to        *
     F*           Date of Next Working Day minus 1, then the          *
     F*           Opening Balance's Date should be the Accrual/       *
     F*           Profit Date.  Otherwise, it should be Run Date.     *
     F*  052613 - Nostros with balances but no movements are not      *
     F*           printed - apply fix E44817 from BHF Singapore       *
     F*           Note - this fix was amended so that if branch       *
     F*           code parameter is blank, details for all branches   *
     F*           are output.                                         *
     F*  058106 - Proj. Nostro Balances Enqy for non-local ccy show   *
     F*           projected dates which have already passed when the  *
     F*           non-local ccy have working days prior to BJDNWD.    *
     F*  058757 - Event narratives are incorrect for Funds Transfer.  *
     F*  042757 - Projected Nostro account movement value dated on    *
     F*           a non-working day should be reflected on the next   *
     F*           working day (and not on the previous working day).  *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  E36796 - NO. OF FORWARD DAYS FOR NOSTROS EVENTS REPORT       *
     F*           AND EVENTS BY CCY, AND SPOT REVAL. WERE MOVED       *
     F*           FROM DLSTAT TO GLSTAT                               *
     F*  055800 - Write to RSACMTPD for SE events                     *
     F*  046872 - Do not call ZFWDT subroutine if No of Days is 99    *
     F*           as system will set ZDYNBR to 99999 to generate      *
     F*           events to End of Book.                              *
     F*  033647 - Output to new field 'FUND' in RSACMTPD for FT       *
     F*           events. Also move transaction type, not event       *
     F*           type to TRYP.                                       *
     F*  045634 - Updated to include new lending fee events in        *
     F*           the reporting - facility fees and loan fees         *
     F*  S01392 - JAPANESE SUBMODULE ENHANCEMENTS                     *
     F*  E38323 - Recompiled over changed copy source ZFWDT subr.     *
     F*  E36449 - FILE NOSEXES REDUNDANT (OLD ST FILE)                *
     F*  S01270 - CUSTOMER LENDING ENHANCEMENTS                       *
     F*  E26063 - Ensure new page on change of currency, also         *
     F*           report nostros with no events                       *
     F*  E27024 - LN0819 NOT CORRECT.  EXTRA BALANCE TOTALS           *
     F*           PRINT WHEN THERE IS A NOSTRO WITH NO EVENTS         *
     F*  E22608 - PROGRAM RENAMED TO GL0580                           *
     F*  E20190 - EVENT TYPE NARRATIVE INCORRECTLY SHOWN ON REPORT    *
     F*  LN0819 - 1 space up another line after branch heading;       *
     F*         - 2 avoid P1 being opened/closed when no events       *
     F*             exist;                                            *
     F*         - 3 nostro name and balances not always being         *
     F*             output;                                           *
     F*         - 4 only print 'No details etc.' in AU if P1          *
     F*             never been opened;                                *
     F*         - 5 stop extra lines being spaced up in P1;           *
     F*         - 6 if unallocated nostro then set branch name        *
     F*             to 'UNALLOCATED'.                                 *
     F*  LN0763 - AT END OF REPORT 'END OF REPORT FOR BRANCH'       H'*
     F*           SHOULD BE PRINTED                                 H'*
     F*  LN0730 - CHANGED TO PREVENT OUTPUT OF NOSTROS WITH NO        *
     F*           EVENTS                                              *
     F*  LN0720 - SHOULD CHECK NOSTRO HOLIDAYS NOT SYSTEM HOLS        *
     F*           FOR PRONO DATES.                                    *
     F*  BHF259 - P1 REPORT WAS GETTING CLOSED AND OPENED WHEN A      *
     F*         - SECONDARY FILE RECORD READ INSTEAD OF A PRIMARY     *
     F*  BHF276 - HEADING  NOT PRODUCED ON FIRST PAGE                 *
     F*  LN0354 - ONLY OPEN P1 AND OUTPUT HEADINGS IF DETAILS TO      *
     F*           BE REPORTED.                                        *
     F*  LN0135 - REMOVE 'END OF REPORT' FROM AUDIT REPORT            *
     F*  S01243 - INCLUDE EVENTS FOR PRINCIPAL INCREASES ON           *
     F*           TERM LOANS                                          *
     F*  E249   - DEFINE FIELD USED BY /COPY ROUTINE & DL0580         *
     F*           SO THAT THEY ARE THE SAME DEFINITION, FIELD IS 'Z'  *
     F*  S01178 - WRITE TO RSACMTPD FOR FT EVENTS (RTS)               *
     F*  E194   - LEVEL BREAK ON BRCA INCORRECTLY PLACED              *
     F*  E00045 - USED MIDAS RUN DATE INSTEAD OF RUN DAY NUMBER       *
     F*  S01194 - STANDING DATA CHANGES DERIVED FROM SYNON.           *
     F*  S01117 - MULTIBRANCHING CHANGES.                             *
     F*  S84089 - PRINCIPLE INCREASE FOR TERM LOANS, THIS SAR IS      *
     F*           NUMBER IS PART OF CORE.                             *
     F*  S01195 - HOLIDAYS PROCESSING.                                *
     F*  S01196 - REMOVAL OF LETTERS OF CREDIT                        *
     F*  S01154 - WRITE TO RSACMTPD FOR LE AND DL EVENTS (RTS)        *
     F*  S01176 - SECURITIES TRADING 3.1                              *
     F*  S03220 - INTERFACE FUNDS TRANSFER                            *
     F*  S01155 - SECURITIES TRADING 2. INCORP ERROR FIX              *
     F*  E11718 - IF RUN DATE IS FOLLOWED BY A HOLIDAY THE            *
     F*           NOSTRO  REPORT OPENING BALANCE INCLUDES             *
     F*           HOLIDAY TRANSACTIONS SO OPENING DATE TO BE          *
     F*           SHOWN IS NOT RUN DATE BUT NEXT WORKING DAY          *
     F*           MINUS ONE                                           *
     F*  S01129 - SECURITIES TRADING 2. PROCESS RECORDS FROM FILE     *
     F*           NOSEXSE                                             *
0010 F*  S01119 - FORWARD RATE AGREEMENTS/INTEREST RATE SWAPS         *
     F*  E10305 - FIELD TNLU MUST NOT HAVE BLANKS IN IT AS THIS       *
     F*           CAUSES A DECIMAL DATA ERROR IN OTHER PROGRAMS       *
     F*  E81277 - ADD RUN DATE TO THE START OF EACH NOSTRO            *
     F*           DETAIL                                              *
     F*  S01108 - PROCESS NEW DEAL TYPE, 'NX' , NOSTRO TRANSFERS      *
0011 F*                                                               *
0012 F*****************************************************************
     F/EJECT
     F*****************************************************************
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0580FFP3                                           S01408
     F*                                                                   S01408
0013 FPRONT   IP AE           K        DISK
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0580FFP1                                           S01408
     F*                                                                   S01408
0014 F*NOSEV   IS AF     320  3AI    28 DISK                              CTI001
0014 FNOSEV   IS AF     340  3AI    28 DISK                               CTI001
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0580F001
     FEVNTD   IF  E           K        DISK                           UC  CDL006
      ** Midas DL Events creation logical file (DLNO/ETYP)                CDL006
      *                                                                   CDL006
     F/COPY WNCPYSRC,GL0580FFP2                                           S01408
     F*                                                                   S01408
0016 F**BLE***IF**F******96*12AI*****2*DISK****************************
0017 FPRONOHH IF  F     128            DISK                      A        S01117
0017 FPRONOPN IF  F     128            DISK                      A        S01117
     FCLOAN   IF  E           K        DISK                                                   237466
     F            CLOANHHF                          KIGNORE                                   237466
     F            CLOANCKF                          KIGNORE                                   237466
     F            CLOANZ1F                          KIGNORE                                   237466
     FLVENTL6 IF  E           K        DISK                                                   237466
     FLEFEEDL0IF  E           K        DISK                                                 MD052216
     FLEFEEXQDIF  E           K        DISK                                                 MD052216
     F/COPY WNCPYSRC,GL0580F002
     FRSACMTPDO   E                    DISK                               S01154
0018 F*PRINT  O   F     132     OF     PRINTER                            S01124
0018 F*L0580P1O   F     132     OF     PRINTER      KINFDS SPOOL  S01124  S01117
0018 F*DL0580P1O**F*****132*****OF     PRINTER      KINFDS SPOOLUC  S01117E22608
0018 F*DL0580AUO***F*****132****OE     PRINTER      KINFDS SPOOLU   S01117E22608
0018 FGL0580P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  E22608
0018 FGL0580AUO   F     132     OE     PRINTER      KINFDS SPOOLU         E22608
      *
     F*****ACCNT   IF  F     400 18AI     2 DISK                                              CRE009
     FACCNT   IF  E           K        DISK                                                   CRE009
     F            ACCNTAAF                          KIGNORE                                   CRE009
     F            ACCNTACF                          KIGNORE                                   CRE009
     F***GLATMIL0IF  E           K        DISK                                       CAP205 BUG27920
      *                                                                                       CGL124
     F/COPY OFCPYSRCZ,CGL124_001                                                              CGL124
      *
     F/EJECT
0019 F* ID F  C  H  L    FUNCTION OF INDICATORS
0020 F* 01            PRONT DETAIL
0021 F* 02            PRONT TRAILER
0022 F* 03            PRONT HEADER
0022 F* 14            NOSEV HEADER
0023 F**04            NOSEV DETAIL
0024 F* 04            NOSEV DETAIL - DEAL RECORD
0025 F**05            NOSEV TRAILER
0026 F* 05            NOSEV DETAIL - COMMERCIAL LOAN RECORD
0027 F****            CURRENCIES RECORD 1                        *****    S01194
0028 F* 06            NOSEV TRAILER
0029 F**07*           ICR 1                                      *****    S01194
0030 F**07*           CURRENCIES RECORD 1                        *****    S01194
0031 F**08*           ICR 2                                      *****    S01194
0032 F**08*           ICR 1                                      *****    S01194
0033 F**09*           HOLIDAYS RECORD                            *****    S01194
0034 F**09*           ICR 2                                      *****    S01194
0035 F**10*           NOSTRO RECORD                              *****    S01194
0029 F* 07            PRINT OUT NEW NOSTRO HEADINGS                       LN0819
0036 F* 10            HOLIDAYS RECORD
0037 F**11*           TABLE CATCHALL, ACCNT CATCHALL             *****    S01194
0038 F* 11            NOSTRO RECORD
0039 F**12*           ACCOUNTS MASTER DETAIL
0040 F* 12            TABLE CATCHALL, ACCNT CATCHALL             *****    S01194
0041 F* 13            ACCOUNTS MASTER DETAIL
     F* 14            CATCHALL
     F* 15            CUSTOMER LENDING EVENT
     F**16*           NOSEV - LETTERS OF CREDIT                  *****   S01196
     F* 16            Nosev - Letters of Credit                           S01473
     F**17************NOSEV*-*SECURITIES*TRADING***********************   E36449
     F* 18            NOSEV - SECURITIES TRADING 2                        S01155
     F* 19            NOSEV - FUNDS TRANSFER                              S03220
     F* 20            NOSEV - FUTURES & OPTIONS                           073714
     F****            TABLE - TABLETL : NOSTRO RECORD            S01154   S01194
0042 F*    21         NOSTRO NUMBER ON PRONT EQUALS 00
0043 F*    22         NOSTRO NUMBER ON NOSEV EQUALS 00
0029 F****N23*********'NO DETAILS TO REPORT' ON DL0580AU*********   LN0819E22608
0029 F*   N23         'NO DETAILS TO REPORT' ON GL0580AU                  E22608
     F*    25         AT LEAST ONE RECORD OUTPUT FOR BRANCH               LN0730
     F*    26         NOSEV - STANDING ORDERS                             209995
0044 F*       30-33   CURRENCY HAS 0-3 DECIMAL PLACES
0045 F*       34      NEGATIVE AMOUNT IN HASH TOTALLING
     F*       35      NOSEXGL record                                  *   CGL010
     F*       39      PRINT HEADER                                        BHF276
0046 F*       40      BYPASS FIRST CYCLE CALCS
0047 F*****   41******'DAYS*FORWARD'*ENTERED*BY*OPERATOR*DEFAULTS*TO*5*   S84089
0048 F*       43      CONTROLS INDEX IN LOOP TO WRITE DAY NUMBERS OF NEXT
0049 F*               6 WORKING DAYS TO ARRAY 'DATE'
0050 F*      N44      SUPRESS AMOUNT FOR EVENT TYPES ENDING 'N1' 'N2'     S01119
0051 F*       45      AMOUNT IS INCOMING
0052 F*       46      AMOUNT IS OUTGOING
0053 F********47******PRINT*DEALT*BASE*CCY*RATE*FOR*FX*EVENTS*************090909
     F*       48      COMMITMENT FEE EVENT (LE)
0054 F*******N49      NO DETAILS TO REPORT                                LN0354
0055 F*       50      CHANGE OF CURRENCY
0056 F*       51      WHOLE BOOK IS TO BE REPORTED                        S84089
0057 F*       52      CHANGE OF EVENT DATE
0058 F*       53      FIRST EVENT FOR NOSTRO
0058 F********54******DAYS FORWARD HAS NOT BEEN SET                       036796
     F*****************(CAN OCCUR IF ST. BUT NOT DL. IS IN THE SYSTEM.)   036796
0058 F******* 55***** PRTF DL0580P1 OPEN FOR OUTPUT.                S01117E22608
0058 F*       55      PRTF GL0580P1 OPEN FOR OUTPUT.                      E22608
     F*      N55      NO DETAILS TO REPORT                                LN0354
0058 F*****   56      TABLE CHAIN FAIL.                           S01117  S01194
0059 F*       60      FIRST PRONT DETAIL RECORD FOR EACH CURRENCY
0067 F*       61 63 64USED TO EDIT HASH TOTALS ON REPORT
     F*       65      MATURITY DATE INDICATOR = 'O'                       S01176
     F*       66      MATURITY DATE INDICATOR = 'A'                       S01176
     F*       69      CHANGE OF BRANCH                                    LN0354
0060 F*       70      EVENT IS TO BE REPORTED
0061 F*       71      LOKUP INDICATOR
0062 F*       72      CONTROLS INDEX IN LOOP TO UPDATE DAILY BALANCES
0063 F*       75      PRONT FILE CONTROLS IMBALANCE
0064 F*       76      NOSEV FILE CONTROLS IMBALANCE
     F*       77      AT LEAST ONE EVENT FOR THE NOSTRO                   E27024
     F*       78      OUTPUT MEANINGFUL NARRATIVES FOR SE POSTN SETLMTS   178438
     F*       79      TRADE INNOVATION SWITCHED ON                        CTI001
0065 F*       81      TEMP NOSTRO TRAILER READ
0066 F*       82      NOSTRO EVENT TRAILER READ
      *       83      Read of Fee Detail Main and Extension File      *                     MD052216
     F*       89      DEALING EVENT-SUPPRESS RATE                         S01108
     E/EJECT
     E******************* CPY@    1   1 80                        *****   S01194
     E                    CPY@    1   1 80
0068 E                    HCCY       25  3
0069 E                    INT         4 15 0
0070 E                    DEC         4  3 0
0071 E**********          DATE        6  5 0A                                               AR987769
     E                    DATE        8  5 0A                                               AR987769
0072 E                    CBAL        5 15 0
0073 E************        TABCOD 18 104  4               EVENT CODE TABLE S01108
0074 E************        TABNAM  8 104 10               EVENT NARRATIVE  S01108
0073 E************        TABCOD 18 106  4               EVENT CODE TABLE S01119
0074 E************        TABNAM  8 106 10               EVENT NARRATIVE  S01119
0073 E************        TABCOD 18 114  4         EVENT CODE TABLE S01119S01129
0074 E************        TABNAM  8 114 10         EVENT NARRATIVE  S01119S01129
0073 E************        TABCOD 18 131  4         EVENT CODE TABLE S01129S03220
0074 E************        TABNAM  8 131 10         EVENT NARRATIVE  S01129S03220
0073 E************        TABCOD 18 142  4         EVENT CODE TABLE S03220S84089
0074 E************        TABNAM  8 142 10         EVENT NARRATIVE  S03220S84089
0073 E************        TABCOD 18 144  4     EVENT CODE TABLE S84089    S01243
0074 E************        TABNAM  8 144 10     EVENT NARRATIVE  S84089    S01243
0073 E************        TABCOD 18 145  4     EVENT CODE TABLE S01243    S01270
0074 E************        TABNAM  8 145 10     EVENT NARRATIVE  S01243    S01270
0073 E************        TABCOD 18 147  4               EVENT CODE TABLE S01392
0074 E************        TABNAM  8 147 10               EVENT NARRATIVE  S01392
0073 E********************TABCOD 18 150  4               EVENT CODE S01392073714
0074 E********************TABNAM  8 150 10               EVENT NARRAS01392073714
      *                                                                   S01408
     E/COPY WNCPYSRC,GL0580EEP1                                           S01408
      *                                                                   S01408
     E********************TABCOD 18 151  4               EVENT CODE 073714CIR001
     E********************TABNAM  8 151 10               EVENT NARRA073714CIR001
     E***********         TABCOD 18 156  4               EVENT CODECIR001 CLE004
     E***********         TABNAM  8 156 10               EVENT NARRCIR001 CLE004
     E********************TABCOD 18 178  4               EVENT COD CLE004 CLE005
     E********************TABNAM  8 178 10               EVENT NAR CLE004 CLE005
      ** Event Code Table                                                 CLE005
     E********************TABCOD 18 218  4                          CLE005CEU003
     E********************TABCOD 18 287  4                          CEU003138004
     E***********         TABCOD 18 291  4                         138004 CGL010
     E***********         TABCOD 18 292  4                         CGL010 CDL008
     E**********          TABCOD 18 294  4                         CDL008 CIR006
     E**********          TABCOD 18 295  4                         CIR006 CIR003
     E**********          TABCOD 18 299  4                                             CIR003 CAS009
     E**********          TABCOD 18 302  4                                             CAS009 CAP204
     E                    TABCOD 18 306  4                                                    CAP204
      ** Event Narrative                                                  CLE005
     E********************TABNAM  8 218 10                          CLE005CEU003
     E********************TABNAM  8 287 10                          CEU003138004
     E***********         TABNAM  8 291 10                         138004 CGL010
     E***********         TABNAM  8 292 10                         CGL010 CDL008
     E**********          TABNAM  8 294 10                         CDL008 CIR006
     E**********          TABNAM  8 295 10                         CIR006 CIR003
     E**********          TABNAM  8 299 10                                             CIR003 CAS009
     E**********          TABNAM  8 302 10                                             CAS009 CAP204
     E                    TABNAM  8 306 10                                                    CAP204
      *                                                                   S01408
     E/COPY WNCPYSRC,GL0580EEP2                                           S01408
      *                                                                   S01408
0075 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0076 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0077 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0077 E/COPY ZSRSRC,ZHOLE                                                  S01195
      *                                                                                       CLE028
      ** Event Codes for CLE028 (Rule of 78)                                                  CLE028
     E                    TABCD2  5   5  4                                                    CLE028
      *                                                                                       CLE028
      ** Event Narratives for CLE028 (Rule of 78)                                             CLE028
     E                    TABNM2  5   5 10                                                    CLE028
      *                                                                                       CAP205
      ** Event Codes for CAP205                                                               CAP205
     E                    TABCD3 18  47  4                                                    CAP205
      *                                                                                       CLE028
     I/EJECT
     I*                                                                   S01408
      *                                                                                       237466
      ** Fields for program described CLOAN.                                                  237466
      *                                                                                       237466
     ICLOANCLF                                                                                237466
     I              RECI                            MRECI                                     237466
     I              LNRF                            MLNRF                                     237466
     I              CCY                             MCCY                                      237466
     I              LCD                             MLCD                                      237466
     I              CNUM                            MCNUM                                     237466
     I              LTYP                            MLTYP                                     237466
     I              SUTP                            MSUTP                                     237466
     I              FCUS                            MFCUS                                     237466
     I              INTR                            MINTR                                     237466
     I              WTRT                            MWTRT                                     237466
     I              FCCY                            MFCCY                                     237466
     I              CRSK                            MCRSK                                     237466
     I              FACO                            MFACO                                     237466
     I              IBDT                            MIBDT                                     237466
     I              RBDT                            MRBDT                                     237466
     I              CPAM                            MCPAM                                     237466
     I              AUTO                            MAUTO                                     237466
     I              MRIN                            MMRIN                                     237466
     I              ACOF                            MACOF                                     237466
     I              RCSI                            MRCSI                                     237466
     I              ORBR                            MORBR                                     237466
     I              BRCA                            MBRCA                                     237466
     I              OLNO                            MOLNO                                     237466
     I              BOKC                            MBOKC                                     237466
     I              PTFR                            MPTFR                                     237466
     I              NRPD                            MNRPD                                     237466
     I              NIDT                            MNIDT                                     237466
     I              MDAT                            MMDAT                                     237466
      *                                                                                       237466
      ** Fields for program described LVENTL6                                                 237466
      *                                                                                       237466
     ILVENTELF                                                                                237466
     I              LNRF                            LLNRF                                     237466
     I              EDAT                            LEDAT                                     237466
     I              STYP                            LSTYP                                     237466
     I/COPY WNCPYSRC,GL0580IIP9                                           S01408
     I*                                                                   S01408
0078 I*
0079 I*    TEMPORARY PROJECTED NOSTRO BALANCES - HEADER RECORD.
0081 IPRONTHHF    03
0079 I*    TEMPORARY PROJECTED NOSTRO BALANCES - DETAIL RECORD.
0080 I*
0081 IPRONTPPF    01
0083 I                                              BRCA  L3M3            S01117
0083 I                                              CCY   L2M2
0084 I                                              NOSN  L1M1      21
0088 I              CNUM                            CNUM1
0090 I*
0091 I*
0092 I*    TEMPORARY PROJECTED NOSTRO BALANCES - TRAILER RECORD.
0093 I*
0094 IPRONTZXF    02
0074 I*
0075 I*
0076 I*    NOSEV FILE - DEALS DETAIL RECORD.
0077 I*
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP1                                           S01408
     I*                                                                   S01408
0078 INOSEV   NS  04   1 CD
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP2                                           S01408
     I*                                                                   S01408
0079 I                                        1   1 RECI
0080 I                                        2   70DLNO
0081 I**********                              8  130CNUM                                      CSD027
0081 I                                        8  13 CNUM                                      CSD027
0082 I                                       14  17 ETYP
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP11                                           S01408
     I*                                                                   S01408
0083 I                                    P  18  200EDAT
0084 I                                    P  21  270EAMT
0085 I                                       28  30 ECCY    M2
0086 I                                       31  320ECSS
0087 I                                       33  34 DTYP
0088 I                                       35  36 DLST
0089 I*****                                  37  390BRCD          *****   S01117
0089 I*****                                  37  39 BRCA  L3M3     S01117 E194
0089 I                                       37  39 BRCA    M3            E194
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP12                                           S01408
     I*                                                                   S01408
0090 I                                    P  40  468EXRT
0091 I                                       47  47 NGII
0092 I                                       48  500NOTD
0093 I                                    P  51  530OTHD
0094 I                                    P  54  600OTHA
0095 I                                       61  63 OTHC
0096 I                                    P  64  700DBCE
0097 I                                    P  71  770BCEQ
0098 I                                    P  78  848DBCR
0099 I                                    P  85  910LCEQ
0100 I                                       92  930SETP
0101 I                                       94 105 OSAC
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP13                                           S01408
     I*                                                                   S01408
     I                                       94  950NOSNNV  M1      22
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP14                                           S01408
     I*                                                                   S01408
     I                                       96 105 OSACQQ                                  MD036589
0102 I                                      106 115 TSEN
0103 I                                      119 119 FIPI
0104 I                                      120 120 INOI
0105 I                                      121 121 FCTI
0106 I                                      122 122 RLVI
0107 I**********                            123 1280CPAR                                      CSD027
0107 I                                      123 128 CPAR                                      CSD027
0108 I                                      129 1290PARI
0109 I                                      130 149 CRNM
0110 I                                      150 159 CTWN
0111 I                                      160 167 CASK
0112 I                                      168 187 PRNM
0113 I                                      188 197 PTWN
0114 I                                      198 205 PASK
0115 I                                      206 207 CCTZ
0116 I                                      208 209 CLOC
0117 I                                      210 211 REGC
0118 I                                      212 2140DASN
0119 I                                    P 215 2170FFVD
0120 I                                      218 218 FFIN
0121 I                                      219 2210FACT
0122 I                                      222 2230FCN0
0123 I                                      224 233 FACO
0124 I                                      234 268 SPI
0125 I**********                            269 2740CPCN                                      CSD027
0125 I                                      269 274 CPCN                                      CSD027
     I                                      297 319 ZZ023                                   MD036589
      *                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIPG                                           S01408
      *                                                                   S01408
0129 I*
0130 I*    NOSEV FILE - COMMERCIAL LOAN DETAIL RECORD.
0131 I*
0132 INOSEV   NS  05   1 CC
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP3                                           S01408
     I*                                                                   S01408
0133 I                                        1   1 RECI
0134 I                                        2   70DLNO
0135 I                                        8  130DDNO
0136 I**********                             14  190CNUM                                      CSD027
0136 I                                       14  19 CNUM                                      CSD027
0137 I                                       20  23 ETYP
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP15                                           S01408
     I*                                                                   S01408
0138 I                                    P  24  260EDAT
0139 I                                    P  27  330EAMT
0140 I                                       34  36 ECCY    M2
0141 I                                       37  380ECSS
0142 I                                       39  40 DTYP
0143 I                                       41  42 DLST
0144 I*****                                  43  450BRCD          *****   S01117
0144 I*****                                  43  45 BRCA  L3M3     S01117 E194
0144 I                                       43  45 BRCA    M3            E194
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP16                                           S01408
     I*                                                                   S01408
0145 I                                    P  46  480OTHD
0146 I                                    P  49  550OTHA
0147 I                                       56  58 OTHC
0148 I                                    P  59  650BCEQ
0149 I                                    P  66  720LCEQ
0150 I                                    P  73  750CSTD
0151 I                                    P  76  780CMTD
0152 I                                       79  790RPYT
0153 I                                    P  80  857EINR
0154 I                                       86  870SETP
0155 I                                       88  99 OSAC
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP17                                           S01408
     I*                                                                   S01408
     I                                       88  890NOSNNV  M1      22
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP18                                           S01408
     I*                                                                   S01408
0156 I                                      100 109 TSEN
0157 I                                    P 110 1179DXRT
0158 I                                      118 1180DEC1
0159 I                                      119 1190DEC2
0160 I                                      120 139 CRNM
0161 I                                      140 149 CTWN
0162 I                                      150 157 CASK
0163 I                                      158 177 PRNM
0164 I                                      178 187 PTWN
0165 I                                      188 195 PASK
0166 I                                      196 196 INOI
0167 I                                      197 197 CYSW
0168 I                                      198 1990CRSK
0169 I                                      200 201 CLOC
0170 I                                      202 203 REGC
0171 I                                      204 204 FFIN
0172 I                                    P 205 2070FFVD
0173 I                                    P 208 2140OADD
0174 I                                    P 215 2170LIPD
0175 I                                      218 2180PARI
0176 I**********                            219 2240CPAR                                      CSD027
0176 I                                      219 224 CPAR                                      CSD027
0129 I*
 130 I*    NOSEV FILE - CUSTOMER LENDING DETAIL RECORD
 131 I*
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP4                                           S01408
     I*                                                                   S01408
0132 INOSEV   NS  15   1 CL
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP5                                           S01408
     I*                                                                   S01408
0133 I                                        1   1 RECI
0134 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0136 I**********                             14  190CNUM                                      CSD027
0136 I                                       14  19 CNUM                                      CSD027
0137 I                                       20  23 ETYP
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP19                                           S01408
     I*                                                                   S01408
0138 I                                    P  24  260EDAT
0139 I                                    P  27  330EAMT
0140 I                                       34  36 ECCY    M2
0141 I                                       37  380ECSS
0142 I                                       39  40 LTYP
0143 I                                       41  42 SUTP
0144 I*****                                  43  450BRCD          *****   S01117
0144 I*****                                  43  45 BRCA  L3M3     S01117 E194
0144 I                                       43  45 BRCA    M3            E194
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP20                                           S01408
     I*                                                                   S01408
0145 I                                    P  46  480OTHD
0146 I                                    P  49  550OTHA
0147 I                                       56  58 OTHC
     I                                       56  58 CFSEQ                                   MD052216
0148 I                                    P  59  650BCEQ
0149 I                                    P  66  720LCEQ
     I                                       79  79 NGII
0153 I                                    P  80  857INTR
0154 I                                       86  870SETP
0155 I                                       88  99 OSAC
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP21                                           S01408
     I*                                                                   S01408
     I                                       88  890NOSNNV  M1      22
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP22                                           S01408
     I*                                                                   S01408
0156 I                                      100 109 TSEN
0158 I                                      118 1180DEC1
0159 I                                      119 1190DEC2
0160 I                                      120 139 CRNM
0161 I                                      140 149 CTWN
0162 I                                      150 157 CASK
0163 I                                      158 177 PRNM
0164 I                                      178 187 PTWN
0165 I                                      188 195 PASK
0166 I                                      196 196 INOI
0168 I                                      198 1990CRSK
0169 I                                      200 201 CLOC
0170 I                                      202 203 REGC
0171 I                                      204 204 FFIN
0175 I                                      218 2180PARI
0176 I**********                            219 2240CPAR                                      CSD027
0176 I                                      219 224 CPAR                                      CSD027
     I*****                                                       *****   S01196
     I*****NOSEV FILE - LETTERS OF CREDIT                         *****   S01196
     I*****                                                       *****   S01196
 179 I*****                                                       *****   S01196
     I*****   NS  16   1 CB                                       *****   S01196
     I*****                                   1   1 RECI          *****   S01196
     I*****                                   2   70DLNO          *****   S01196
     I*****                                   8  130CNUM          *****   S01196
     I*****                                  14  17 ETYP          *****   S01196
     I*****                               P  18  200EDAT          *****   S01196
     I*****                               P  21  270EAMT          *****   S01196
     I*****                                  28  30 ECCY    M2    *****   S01196
     I*****                                  31  320ECSS          *****   S01196
     I*****                                  33  34 DTYP          *****   S01196
     I*****                                  35  36 DLST          *****   S01196
     I*****                                  37  390BRCD          *****   S01196
     I*****                                  37  39 BRCA  L3M3    *****   S01196
     I*****                               P  40  420OTHD          *****   S01196
     I*****                               P  43  490OTHA          *****   S01196
     I*****                                  50  52 OTHC          *****   S01196
     I*****                               P  53  590DBCE          *****   S01196
     I*****                               P  60  660BCEQ          *****   S01196
     I*****                               P  67  738DBCR          *****   S01196
     I*****                                  74  750SETP          *****   S01196
     I*****                                  76  87 OSAC          *****   S01196
     I*****                                  76  770NOSNNV  M1    ***22   S01196
     I*****                                  88  97 TSEN          *****   S01196
     I*****                                  98 107 FACO          *****   S01196
     I*****                                 108 142 SPI           *****   S01196
     I*****                                 143 143 FIPI          *****   S01196
     I*****                                 144 144 INOI          *****   S01196
     I*****                                 145 1500CPCN          *****   S01196
     I*****                                 151 1560CPAR          *****   S01196
     I*****                                 157 1570PARI          *****   S01196
     I*****                                 158 177 CRNM          *****   S01196
     I*****                                 178 187 CTWN          *****   S01196
     I*****                                 188 195 CASK          *****   S01196
     I*****                                 196 215 PRNM          *****   S01196
     I*****                                 216 225 PTWN          *****   S01196
     I*****                                 226 233 PASK          *****   S01196
     I*****                                 234 235 CCTZ          *****   S01196
     I*****                                 236 237 CLOC          *****   S01196
     I*****                                 238 239 REGC          *****   S01196
     I*****                                 240 240 FFIN          *****   S01196
     I*****                               P 241 2470LCEQ          *****   S01196
      *                                                                   S01473
     I        NS  16   1 CB                                               S01473
     I                                        1   1 RECI                  S01473
     I                                        2   7 LCNO                  S01473
     I**********                              8  130CNUM                               S01473 CSD027
     I                                        8  13 CNUM                                      CSD027
     I                                       14  17 ETYP                  S01473
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP23                                           S01408
     I*                                                                   S01408
     I                                    P  18  200EDAT                  S01473
     I                                    P  21  270EAMT                  S01473
     I                                       28  30 ECCY    M2            S01473
     I                                       31  320ECSS                  S01473
     I                                       33  34 DTYP                  S01473
     I                                       35  36 DLST                  S01473
     I                                       37  39 BRCA    M3            S01473
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP24                                           S01408
     I*                                                                   S01408
     I                                    P  40  420OTHD                  S01473
     I                                    P  43  490OTHA                  S01473
     I                                       50  52 OTHC                  S01473
     I                                    P  53  590DBCE                  S01473
     I                                    P  60  660BCEQ                  S01473
     I                                    P  67  738DBCR                  S01473
     I                                       74  750SETP                  S01473
     I                                       76  87 OSAC                  S01473
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP25                                           S01408
     I*                                                                   S01408
     I                                       76  770NOSNNV  M1      22    S01473
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP26                                           S01408
     I*                                                                   S01408
     I                                       88  97 TSEN                  S01473
     I                                       98 107 FACO                  S01473
     I                                      108 142 SPI                   S01473
     I                                      143 143 FIPI                  S01473
     I                                      144 144 INOI                  S01473
     I**********                            145 1500CPCN                               S01473 CSD027
     I**********                            151 1560CPAR                               S01473 CSD027
     I                                      145 150 CPCN                                      CSD027
     I                                      151 156 CPAR                                      CSD027
     I                                      157 1570PARI                  S01473
     I                                      158 177 CRNM                  S01473
     I                                      178 187 CTWN                  S01473
     I                                      188 195 CASK                  S01473
     I                                      196 215 PRNM                  S01473
     I                                      216 225 PTWN                  S01473
     I                                      226 233 PASK                  S01473
     I                                      234 235 CCTZ                  S01473
     I                                      236 237 CLOC                  S01473
     I                                      238 239 REGC                  S01473
     I                                      240 240 FFIN                  S01473
     I                                    P 241 2470LCEQ                  S01473
     I                                      321 340 TIRF                  CTI001
      ** Letters of Credit Nostro Events File                             S01473
      *                                                                   S01473
     I*
     I*****NOSEV*FILE*-*SECURITIES*TRADING*****************************   E36449
     I********                                                            E36449
     I********NS  17   1 CS                                               E36449
     I********                                1   1 RECI                  E36449
     I********                                2  11 SECS                  E36449
     I********                               12  12 MARK                  E36449
     I********                               13  180DLNO                  E36449
     I********                               19  240CNUM                  E36449
     I********                               25  28 ETYP                  E36449
     I********                            P  29  310EDAT                  E36449
     I********                            P  32  380EAMT                  E36449
     I********                               39  41 ECCY    M2            E36449
     I********                               42  430ECSS                  E36449
     I********                               44  45 TRTE                  E36449
     I********                               46  47 TRSE                  E36449
     I********                               48  500BRCS                  E36449
     I********                            P  51  567CRAT                  E36449
     I********                               57  57 NGII                  E36449
     I********                            P  58  600ODTE                  E36449
     I********                            P  61  670OAME                  E36449
     I********                               68  70 NOMC                  E36449
     I********                               71  720NCSC                  E36449
     I********                               73  730ECDP                  E36449
     I********                               74  740NCDP                  E36449
     I********                            P  75  810DBEE                  E36449
     I********                            P  82  880SBEE                  E36449
     I********                            P  89  958DBRT                  E36449
     I********                            P  96 1020DNEE                  E36449
     I********                            P 103 1090SNEE                  E36449
     I********                            P 110 1168DNRT                  E36449
     I********                              117 117 FIPI                  E36449
     I********                              118 1190SETL                  E36449
     I********                              120 1210NOSNNV  M1      22    E36449
     I********                              122 131 OSAC2                 E36449
     I********                              132 1430THRE                  E36449
     I********                              144 153 FACE                  E36449
     I********                              154 188 SPI                   E36449
     I********                              189 1890STCL                  E36449
     I********                              190 190 PYCD                  E36449
     I********                              191 191 PRCD                  E36449
     I********                              192 192 INOI                  E36449
     I********                              193 1980CPAR                  E36449
     I********                              199 1990PARI                  E36449
     I********                              200 219 CRNM                  E36449
     I********                              220 229 CTWN                  E36449
     I********                              230 237 CASK                  E36449
     I********                              238 257 PRNM                  E36449
     I********                              258 267 PTWN                  E36449
     I********                              268 275 PASK                  E36449
     I********                            P 276 2810NOMT                  E36449
     I********                              282 2830CRSK                  E36449
     I********                              284 285 REGR                  E36449
     I********                              286 287 CLOC                  E36449
     I********                              288 289 REGD                  E36449
     I********                              290 290 WTYP                  E36449
     I********                            P 291 2930WRAT                  E36449
     I********                              294 294 ASIN                  E36449
     I********                            P 295 2960ACCF                  E36449
     I*****                                 297 2990BRCD          *****   S01117
     I*****                                 297 299 BRCA  L3M3     E194   E36449
     I********                              297 299 BRCA    M3     E194   E36449
     I********                            P 300 3070DSAM                  E36449
     I********                              308 308 AIND                  E36449
     I********                              309 320 ZZ0290                E36449
     I*
     I*    NOSEV FILE - SECURITIES TRADING 2                              S01129
     I*                                                                   S01129
     I        NS  18   1 CE                                               S01129
     I                                        1   1 RECI                  S01129
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP27                                           S01408
     I*                                                                   S01408
     I                                        2   4 ECCY    M2            S01129
     I                                        5   60NOSNNV  M1      22    S01129
     I                                    P   7   90EDAT                  S01129
     I                                       10  29 CRNM                  S01129
     I                                       30  39 CTWN                  S01129
     I                                       40  450DLNO                  S01129
     I                                       46  49 ETYP                  S01129
     I                                    P  50  560EAMT                  S01129
     I                                       57  57 INOI                  S01129
     I                                       58  58 MDTI                  S01176
0089 I******                                 59  61 BRCA  L3M3     S01117 E194
0089 I                                       59  61 BRCA    M3            E194
     I                                       63  63 COAF                  CSE007
     I                                       64  73 NESS                  178438
     I**********                             75  76 NBRC                               178438 210261
     I                                       74  76 NBRC                                      210261
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP28                                           S01408
     I*                                                                   S01408
0180 I*                                                                   S03220
0181 I*    NOSEV FILE - FUNDS TRANSFER                                    S03220
0182 I*                                                                   S03220
0183 I        NS  19   1 CF                                               S03220
     I                                        1   1 RECI                  S03220
     I                                        2  16 PREF                  S03220
     I                                       13  14 FTTRYP                033647
     I                                       17  20 ETYP                  S03220
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP29                                           S01408
     I*                                                                   S01408
     I                                    P  21  230EDAT                  S03220
     I                                    P  24  300EAMT                  S03220
     I                                       31  33 ECCY    M2            S03220
     I                                       34  350NOSNNV  M1      22    S03220
     I                                       36  36 INOI                  S03220
     I                                    P  37  438RATE                  S03220
0089 I******                                 44  46 BRCA  L3M3     S01117 E194
0089 I                                       44  46 BRCA    M3            E194
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP6                                           S01408
     I*                                                                   S01408
     I*                                                                   073714
     I*    NOSEV FILE - FUTURES & OPTIONS                                 073714
     I*                                                                   073714
     I        NS  20   1 CO                                               073714
     I**********                              1   1 RECI            073714119081
     I**********                              2   7 TNBR            073714119081
     I**********                             24  43 CRNM            073714119081
     I**********                             44  53 CTWN            073714119081
     I**********                             54  57 ETYP            073714119081
     I                                        1   1 RECI                  119081
     I                                        2   7 TNBR                  119081
     I                                       26  45 CRNM                  119081
     I                                       46  55 CTWN                  119081
     I                                       56  59 ETYP                  119081
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP30                                           S01408
     I*                                                                   S01408
     I**********                          P  58  600EDAT            073714119081
     I**********                          P  61  670EAMT            073714119081
     I**********                             68  70 ECCY    M2      073714119081
     I**********                             71  720NOSNNV  M1      073714119081
     I**********                             73  73 INOI            073714119081
     I**********                             74  76 BRCA    M3      073714119081
     I                                    P  60  620EDAT                  119081
     I                                    P  63  690EAMT                  119081
     I                                       70  72 ECCY    M2            119081
     I                                       73  740NOSNNV  M1      22    119081
     I                                       75  75 INOI                  119081
     I                                       76  78 BRCA    M3            119081
     I*                                                                   209995
     I** NOSEV FILE - STANDING ORDERS                                     209995
     I*                                                                   209995
     I        NS  26   1 CS                                               209995
     I                                        1   1 RECI                  209995
     I                                        2   6 STOR                  209995
     I                                        7  10 ETYP                  209995
     I                                    P  11  130EDAT                  209995
     I                                    P  14  200EAMT                  209995
     I                                       21  23 ECCY    M2            209995
     I                                       24  250NOSNNV  M1      22    209995
     I                                       26  26 INOI                  209995
     I                                       27  29 BRCA    M3            209995
     I                                       30  49 CRNM                  209995
     I                                       50  59 CTWN                  209995
     I*                                                                                       CAP204
     I*    NOSEV FILE - Account Transfer                                                      CAP204
     I*                                                                                       CAP204
     I        NS  28   1 CR                                                                   CAP204
     I                                        1   1 RECI                                      CAP204
     I                                        2  16 TREF                                      CAP204
     I                                       17  20 ETYP                                      CAP204
     I                                    P  21  230EDAT                                      CAP204
     I                                    P  24  300EAMT                                      CAP204
     I                                       31  33 ECCY    M2                                CAP204
     I                                       34  350NOSNNV  M1      22                        CAP204
     I                                       36  36 INOI                                      CAP204
     I                                       37  39 BRCA    M3                                CAP204
0180 I*
0181 I*    NOSEV FILE - TRAILER RECORD.
0182 I*
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP7                                           S01408
     I*                                                                   S01408
0183 INOSEV   NS  06   1 CT
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IIP8                                           S01408
     I*                                                                   S01408
0184 I                                        1   1 RECI
0185 I                                        2   60NOREN
0186 I                                    P   7  140HRWN
0187 I                                    P  15  160HRDC
      *                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP31                                           S01408
      *                                                                   S01408
     I*
0102 I*    CATCHALL
0103 I*
0104 I        NS  14
0078 I*
0079 I*    DUMMY PROJECTED NOSTRO BALANCES - HEADER RECORD.               S01117
0078 I*                                                                   S01117
0081 IPRONOHH NS                                                          S01117
0311 I                                        1   1 RECI
007  I*
0079 I*    DUMMY PROJECTED NOSTRO BALANCES - DETAIL RECORD.               S01117
0080 I*                                                                   S01117
0081 IPRONOPN NS                                                          S01117
0311 I                                        1   1 RECI
     I/COPY WNCPYSRC,GL0580I001
0215 I*****TABLE FILE - CURRENCIES RECORD 1.                      *****   S01194
0216 I*****                                                       *****   S01194
0217 I**BLE   NS  07   1 CD   2 C2   3 C0                         *****   S01194
0218 I*****  AND      13 C1                                       *****   S01194
0219 I*****                                   1   1 RECI          *****   S01194
0220 I*****                                   2   30RECT          *****   S01194
0221 I*****                                  10  12 CCY           *****   S01194
0222 I*****                                  13  130SREC          *****   S01194
0223 I*****                                  14  27 CCNM          *****   S01194
0224 I*****                               P  28  348SPOT          *****   S01194
0225 I*****                                  35  37 CCYS          *****   S01194
0226 I*****                                  38  380CDP           *****   S01194
0227 I*****                                  39  390TNOT          *****   S01194
0228 I*****                                  40  40 DCCY          *****   S01194
0229 I*****                                  41  44 SRC1          *****   S01194
0230 I*****                                  45  48 SRC2          *****   S01194
0231 I*****                                  49  520TACC          *****   S01194
0232 I*****                                  53  560TEQV          *****   S01194
0233 I*****                                  57  600SWQV          *****   S01194
0234 I*****                                  61  640TAC4          *****   S01194
0235 I*****                                  65  680TAC5          *****   S01194
0236 I*****                                  69  69 HIND          *****   S01194
0237 I*****                               P  70  768PART          *****   S01194
0238 I*****                                  77  780SSNO          *****   S01194
0239 I*****                               P  79  858ERLC          *****   S01194
0240 I*****                               P  90  920LCD           *****   S01194
0241 I*****                                  93  93 CHTP          *****   S01194
0242 I*****                               P  94  960TNLU          *****   S01194
0243 I*****************************************************************   S01194
0244 I*****TABLE FILE - BRANCH NAME                               *****   S01194
0245 I*****                                                       *****   S01194
0246 I*****   NS       2 C1   3 C0                                *****   S01194
0248 I*****                                   1   1 RECI          *****   S01194
0249 I*****                                  14  43 BRNM          *****   S01194
0243 I*****************************************************************   S01194
0244 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.       *****   S01194
0245 I*****                                                       *****   S01194
0246 I**BLE   NS  08   2 C0   3 C1  12 C1                         *****   S01194
0247 I*****  AND      13 C0                                       *****   S01194
0248 I*****                                   1   1 RECI          *****   S01194
0249 I*****                                   2   30RECT          *****   S01194
0250 I*****                                  12  130RCDE          *****   S01194
0251 I*****                                  14  66 TITL          *****   S01194
0252 I*****                                  67  67 DATF          *****   S01194
0253 I*****                                  68  700DFBR          *****   S01194
0254 I*****                                  74  74 MODI1         *****   S01194
0255 I*****                                  75  75 MODI2         *****   S01194
0256 I*****                                  76  76 MODI3         *****   S01194
0257 I*****                               P  77  790RUND          *****   S01194
0258 I*****                                  80  86 RUNA          *****   S01194
0259 I*****                                  87  870SFLG          *****   S01194
0260 I*****                               P  90  920LCD           *****   S01194
0261 I*****                                  93  93 CHTP          *****   S01194
0262 I*****                               P  94  960TNLU          *****   S01194
0263 I*****************************************************************   S01194
0264 I*****                                                       *****   S01194
0265 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.       *****   S01194
0266 I*****                                                       *****   S01194
0267 I***LE   NS  09   1 CD   2 C0   3 C1                         *****   S01194
0268 I*****  AND      12 C1  13 C1                                *****   S01194
0269 I*****                                   1   1 RECI          *****   S01194
0270 I*****                                   2   30RECT          *****   S01194
0271 I*****                                  12  130RCDE          *****   S01194
0272 I*****                                  14  16 BCCY          *****   S01194
0273 I*****                                  17  19 BCYL          *****   S01194
0274 I*****                                  20  22 HOCY          *****   S01194
0275 I*****                                  23  280HEAD          *****   S01194
0276 I*****                               P  29  310APDA          *****   S01194
0277 I*****                                  35  35 APFQ          *****   S01194
0278 I*****                               P  36  380LOGS          *****   S01194
0279 I*****                                  39  40 CUZR          *****   S01194
0280 I*****                               P  41  430DNWD          *****   S01194
0281 I*****                                  44  460BVLP          *****   S01194
0282 I*****                                  47  49 LOCY          *****   S01194
0283 I*****                                  50  510FDAY          *****   S01194
0284 I*****                                  86  86 ISAV          *****   S01194
0285 I*****                               P  87  890LLOG          *****   S01194
0286 I*****                               P  90  920LCD           *****   S01194
0287 I*****                                  93  93 CHTP          *****   S01194
0288 I*****                               P  94  960TNLU          *****   S01194
0289 I*****************************************************************   S01194
0290 I*****TABLE FILE - HOLIDAY RECORD.                           *****   S01194
0291 I*****   E-EXCLUDE, I-INCLUDE.                               *****   S01194
0292 I*****                                                       *****   S01194
0293 I***LE   NS  10   1 CD   2 C2   3 C2                         *****   S01194
0294 I*****  AND      14 CE                                       *****   S01194
0296 I*****  OR   10   1 CD   2 C2   3 C2                         *****   S01194
0297 I*****  AND      14 CI                                       *****   S01194
0298 I*****                                   1   1 RECI          *****   S01194
0299 I*****                                   2   30RECT          *****   S01194
0300 I*****                                   8  120HOL           *****   S01194
0301 I*****                                  13  130SREC          *****   S01194
0302 I*****                                  14  14 INEX          *****   S01194
0303 I*****                                  15  89 HCCY          *****   S01194
0304 I*****                               P  90  920LCD           *****   S01194
0305 I*****                                  93  93 CHTP          *****   S01194
0306 I*****                               P  94  960TNLU          *****   S01194
     I************************************************************S01154  S01194
     I****BLETL --- NOSTROS: S01154                               S01154  S01194
     I*****                                                       S01154  S01194
     I***LE   NS  20   1 CD   2 C7   3 C0                         S01154  S01194
0298 I*****                                   1   1 RECI          S01154  S01194
0299 I*****                                   2   30RECT          S01154  S01194
     I*****                                  30  35 CNUMNS        S01154  S01194
     I*****                                  36  37 ACSQNS        S01154  S01194
     I*****                                  38  41 ACODNS        S01154  S01194
0307 I*****************************************************************   S01194
0308 I*****CATCHALL                                               *****   S01194
0309 I*****                                                       *****   S01194
0310 I*****   NS  12                                              *****   S01194
0311 I*****                                   1   1 RECI          *****   S01194
0312 I*****************************************************************   S01194
0393 I/EJECT
     IDSCSNM      DS                             10                                           237466
      ** Data area for the location code in customer shortname field                          237466
     I                                        8  10 NRLC                                      237466
0392 ISDBANK    E DSSDBANKPD                                              S01194
0393 I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
0393 I*                                                                   S01194
0392 ISDTRAD    E DSSDTRADPD                                              S01194
0393 I* TRADING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
0393 I*
0392 ISDGELR    E DSSDGELRPD                                              S01194
     I              QQACCD                          QQACC1                                    CGL029
0393 I* LEDGER DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
0393 I*
0392 ISDACOD    E DSSDACODPD                                              S01194
     I              QQACCD                          QQACC2                                    CGL029
0393 I* ACCOUNT CODE DETAILS ACCESSED VIA ACCESS PROGRAM                  S01194
0393 I*
0392 ISDCURR    E DSSDCURRPD                                              S01194
0393 I* CURRENCIES DETAILS ACCESSED VIA ACCESS PROGRAM                    S01194
0393 I*
0392 ISDBRCH    E DSSDBRCHPD                                              S01194
0393 I* BRANCH CODE DETAILS ACCESSED VIA ACCESS PROGRAM                   S01194
0393 I*
0392 ISDNOST    E DSSDNOSTPD                                              S01194
     I              QQACCD                          QQACC3                                    CGL029
0393 I* BRANCH CODE DETAILS ACCESSED VIA ACCESS PROGRAM                   S01194
     I*
     ISCSARD    E DSSCSARDPD                                              S01473
      ** Switchable Features File                                         S01473
      *                                                                   S01473
     ISDSVAL    E DSSDSVALPD                                              CRE009
      ** SYSTEM VALUES FILE                                               CRE009
      *                                                                   CRE009
     ISDMOD     E DSSDMMODPD                                              CTI001
     I**  EXTERNAL DS FOR MODULE ID'S                                     CTI001
     I*                                                                   CTI001
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
0393 I*
0313 I*****DATA STRUCTURE OF KEY FOR TABLE CHAIN                  *****   S01194
0314 I*****       DS                                              *****   S01194
0315 I*****                                   1  12 KEYT          *****   S01194
0316 I*****                                   1   2 RTYPE         *****   S01194
0317 I*****                                   9  11 DATACY        *****   S01194
0318 I*****                                  12  12 SUBTP         *****   S01194
     ISPOOL       DS                                                      S01117
     I*  FILE INFORMATION DATA STRUCTURE.                                 S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I*  AUDIT FILE INFORMATION DATA STRUCTURE.                           S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01117
     I*DLSTAT****UDS                            256                       036796
     I***********                             8   90DYSFWD                036796
     I***********                             8   9 DYSA                  036796
     IGLSTAT     UDS                            256                       036796
     I                                       31  320DYSFWD                036796
     I                                       31  32 DYSA                  036796
     I@NOSN       DS
     I                                        1   20NOSN                  S01194
     I                                        1   2 @NOSNA                S01194
      *****************************************************************            MD036589 MD044815
      ***Data*structure*for*FX*nets*reference**************************            MD036589 MD044815
     I***WNETR2   DS                             19                                MD036589 MD044815
     I**********                              1   7 W7                             MD036589 MD044815
     I**********                              8  10 WCCY                           MD036589 MD044815
     I**********                             11  19 W19                            MD036589 MD044815
      *                                                                                     MD054101
     IARCY        DS                             30                                         MD054101
     I                                        1   3 C1PI                                    MD054101
     I                                        4   6 C2PI                                    MD054101
     I                                        7   9 C3PI                                    MD054101
     I                                       10  12 C4PI                                    MD054101
     I                                       13  15 C5PI                                    MD054101
     I                                       16  18 C6PI                                    MD054101
     I                                       19  21 C7PI                                    MD054101
     I                                       22  24 C8PI                                    MD054101
     I                                       25  27 C9PI                                    MD054101
     I                                       28  30 C0PI                                    MD054101
      *                                                                                     MD054101
     IALOC        DS                             30                                         MD054101
     I                                        1   3 L1PI                                    MD054101
     I                                        4   6 L2PI                                    MD054101
     I                                        7   9 L3PI                                    MD054101
     I                                       10  12 L4PI                                    MD054101
     I                                       13  15 L5PI                                    MD054101
     I                                       16  18 L6PI                                    MD054101
     I                                       19  21 L7PI                                    MD054101
     I                                       22  24 L8PI                                    MD054101
     I                                       25  27 L9PI                                    MD054101
     I                                       28  30 L0PI                                    MD054101
      *                                                                   CRE009
     ILDA       E DSLDA                         256                       CRE009
      *                                                                   CRE009
     IREPMED      DS                              5                       CRE009
      *                                                                   CRE009
     I            DS                                                      CRE009
     I                                        1 200 SVAL1                 CRE009
     I                                        1   1 SVAL11                CRE009
      *                                                                   CRE009
     I            DS                                                      CRE009
     I                                        1  24 DVALK                 CRE009
     I                                        1   8 DVAL1                 CRE009
     I                                        9  16 DVAL2                 CRE009
     I                                       17  24 DVAL3                 CRE009
      *                                                                   CRE009
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0580IP10                                           S01408
     I*                                                                   S01408
     I                                        1  80 CPY@
     I              'ESTM INTRS'          C         WINEST                                    CIR007
      ** Value of Event Description if either side of the deal is an                          CIR007
      ** OIS                                                                                  CIR007
     I              'CcyBasisForNosEvts  'C         SVALKK                                 MD022382A
     I/COPY ZSRSRC,ZHOLI                                                  S01195
0323 C/EJECT
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3                       S01117
      *
      ** KEY LIST TO ACCESS ACCNT                                                             CRE009
     C           NOSKEY    KLIST                                                              CRE009
     C**********           KFLD           NCNUM   60                                   CRE009 CSD027
     C                     KFLD           NCNUM   6                                           CSD027
     C                     KFLD           NCCY    3                                           CRE009
     C**********           KFLD           NCODE   40                                   CRE009 CGL029
     C                     KFLD           NCODE  100                                          CGL029
     C                     KFLD           NCSEQ   20                                          CRE009
     C                     KFLD           NBRCD   3                                           CRE009
     C*                                                                                       CGL124
     C/COPY OFCPYSRCZ,CGL124_003                                                              CGL124
      *                                                                                       CAP205
      ** Account Transfer Key List                                                            CAP205
      *                                                                                       CAP205
     C********** KEYATM    KLIST                                                     CAP205 BUG27920
     C**********           KFLD           BRCA                                       CAP205 BUG27920
     C**********           KFLD           TREF                                       CAP205 BUG27920
     C*
0324 C*    FIRST CYCLE CALCS.
0325 C   40                GOTO START
0326 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80
     C                     Z-ADD10000     FSIZE   50
0327 C*****                EXSR ZSYSTM                            *****   S01194
0328 C***99                SETON                     U7U8LR       *****   S01194
0329 C***99                GOTO END                               *****   S01194
     C*
0327 C**  DUMMY READ TO PRONOHH AND PRONOPN RECORDS.                      S01117
0328 C*                                                                   S01117
0329 C           *IN85     IFEQ '1'                                       S01117
     C                     READ PRONOHH                  85               S01117
0329 C                     READ PRONOPN                  85               S01117
     C/COPY WNCPYSRC,GL0580C013
     C                     END                                            S01117
0327 C*                                                                   S01117
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C**********           MOVEL'SDBANKPD'DBFILE 10        * * * * * * *               S01194 CRE009
     C**********           MOVEL'001'     DBASE   3        * DBERR 001 *               S01194 CRE009
     C                     MOVEL'SDBANKPD'DBFILE           * * * * * * *                      CRE009
     C                     MOVEL'001'     DBASE            * DBERR 001 *                      CRE009
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
0330 C*****                MOVE '1'       SUBTP                   *****   S01194
0331 C*****                MOVE '20'      RTYPE                   *****   S01194
     C***THIS*PROGRAM*CAN*BE*RUN*BY*SECURITIES*TRADING*WITHOUT*DEALING*   036796
     C***IN*THE SYSTEM,*IN*WHICH*CASE*D/DLSTAT*WILL*NOT*BE*SET*UP.*       036796
     C***********DYSA      COMP '  '                     54               036796
     C***54******          MOVE '99'      DYSA                     S84089 036796
0340 C           DYSFWD    COMP 99                       51               S84089
0341 C           DYSFWD    COMP 5                      41                 S84089
0342 C   41                Z-ADD5         DYSFWD                          S84089
0343 C*****                MOVE DYSFWD    ZNRDYS                  *****   S01195
0343 C                     MOVE DYSFWD    ZNRDYS
0344 C*****                MOVE RUND      ZDAYNO                  *****   S01194
0344 C                     MOVE BJRDNB    ZDAYNO                          S01194
0345 C*****                MOVE '1'       ZTABKY                  *****   S01194
     C*****                SETOF                     09           *****   S01194
     C*****      ZTABKY    CHAINTABLE                99           *****   S01194
0348 C***09**              MOVE LOCY      ZCCY                    *****   S01194
0349 C**N09*               SETON                     U7U8LR       *****   S01194
0350 C**N09*               GOTO END                               *****   S01194
0351 C*****                EXSR ZDATE3                            *****   S01195
     C*                                                                   046872
     C** If days not set to 99, calculate this no of working days fwd     046872
     C*                                                                   046872
     C           *IN51     IFEQ '0'                                       046872
0348 C                     MOVE BJLCCY    ZCCY                            S01194
0351 C                     MOVE BJSLCD    ZLOC                            S01195
0351 C                     EXSR ZFWDT                                     S01195
0352 C                     MOVE ZDYNBR    REPDAT  50
0353 C*    REPDAT NOW CONTAINS DATE TO WHICH REPORT IS PRODUCED
0354 C*
     C**   If days is set to 99 allow all events to End of Book to        046872
     C**   be produced                                                    046872
     C*                                                                   046872
     C                     ELSE                                           046872
0355 C   51                MOVE 99999     REPDAT                          S84089
     C                     END                                            046872
0356 C                     MOVE '   '     ZCCY
1649 C*                                                                   055773
1649 C** Access GL details.                                               055773
1649 C**********           CALL 'AOGELRR0'                                055773              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
1649 C                     PARM '*MSG   ' @RTCD                           055773
1649 C                     PARM '*FIRST ' @OPTN                           055773
1649 C********** SDGELR    PARM SDGELR    DSFDY                           055773              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
1649 C*                                                                   055773
1649 C           @RTCD     IFNE *BLANK                                    055773
1649 C                     SETON                     U7U8LR               055773
1649 C                     MOVEL'SDGELRPD'DBFILE           *************  055773
1649 C                     MOVE '004'     DBASE            * DBERR 004 *  055773
1649 C                     MOVEL@OPTN     DBOPTN           *************  055773
1649 C                     MOVEL@OPTN     DBKEY                           055773
     C                     GOTO END                                       055773
1649 C                     END                                            055773
     C*
     C*   DATE FROM WHICH REPORT IS PRODUCED IS THE DATE OF NEXT          E11718
     C*   WORKING DAY MINUS 1.                                            E11718
     C** This applies only if Accrual for Non-working Days Processing     055773
     C** Type is 0 or 1 - for type 2 this date is recalculated.           055773
     C*                                                                   055773
     C*****      DNWD      SUB  1         FRDAT   50              E11718  S01194
     C           BJDNWD    SUB  1         FRDAT   50                      S01194
     C*                                                                   055773
     C** If Accrual for Non-working days indicator is equal 2, then       055773
     C** if the Accrual/Profit Date is less than or equal to Date of      055773
     C** Next Working Day minus 1, the Openning Balance's Date should     055773
     C** be the Accrual/Profit Date.  Otherwise, it should be Run Date.   055773
     C** This is because Processing Type 2 processes non-working days     055773
     C** retrospectively and will only generate events up to today,       055773
     C** unless the next accrual day is before the next working day. in   055773
     C** which case it will generate events to accrual day.               055773
     C*                                                                   055773
     C           BKANWD    IFEQ '2'                                       055773
     C           BKAPDT    IFLE FRDAT                                     055773
     C                     Z-ADDBKAPDT    FRDAT                           055773
     C                     ELSE                                           055773
     C                     Z-ADDBJRDNB    FRDAT                           055773
     C                     END                                            055773
     C                     END                                            055773
     C*                                                                   055773
     C                     Z-ADDFRDAT     ZDAYNO                          E11718
     C                     EXSR ZDATE2                                    E11718
     C                     MOVE ZADATE    FRDATA  7                       E11718
     C*
     C*   SET ZERO FIELD FOR OUTPUT ON PRONOPN AS INITIAL TNLU            E10305
     C                     Z-ADD0         ZERO5   50                      E10305
     C*
      *                                                                   S01473
     C/COPY WNCPYSRC,GL0580C009
      ** Check the switchable features file for the Midas Leo Integration S01473
      ** number, S01473. If it is present, set the flag ULEO to 'Y'       S01473
     C                     CALL 'AOSARDR0'                                S01473
     C                     PARM *BLANKS   @RTCD                           S01473
     C                     PARM '*VERIFY' @OPTN                           S01473
     C                     PARM 'S01473'  @KEY    6                       S01473
     C           SCSARD    PARM SCSARD    DSFDY                           S01473
      *                                                                   S01473
     C           @RTCD     IFEQ *BLANKS                                   S01473
     C                     MOVE 'Y'       ULEO    1                       S01473
     C                     END                                            S01473
      *                                                                   CDL006
      ** Determine if feature CDL006 is installed.                        CDL006
      *                                                                   CDL006
     C                     MOVE 'N'       CDL006  1                       CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM '       ' @RTCD                           CDL006
     C                     PARM '*VERIFY' @OPTN                           CDL006
     C                     PARM 'CDL006'  @KEY                            CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           @RTCD     IFNE *BLANKS                                   CDL006
     C           @RTCD     ANDNE'*NRF   '                                 CDL006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CDL006
     C                     MOVEL'CDL006'  DBKEY            * DBERR 07 *   CDL006
     C                     MOVEL'007'     DBASE            ************   CDL006
     C                     MOVE *ON       *INU7                           CDL006
     C                     MOVE *ON       *INU8                           CDL006
     C                     MOVE *ON       *INLR                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           @RTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CGL010
      ** Determine if feature CGL010 is installed.                        CGL010
      *                                                                   CGL010
     C                     MOVE 'N'       CGL010  1                       CGL010
      *                                                                   CGL010
     C                     CALL 'AOSARDR0'                                CGL010
     C                     PARM '       ' @RTCD                           CGL010
     C                     PARM '*VERIFY' @OPTN                           CGL010
     C                     PARM 'CGL010'  @KEY                            CGL010
     C           SCSARD    PARM SCSARD    DSFDY                           CGL010
      *                                                                   CGL010
     C           @RTCD     IFNE *BLANKS                                   CGL010
     C           @RTCD     ANDNE'*NRF   '                                 CGL010
     C                     MOVEL'SCSARDPD'DBFILE           ************   CGL010
     C                     MOVEL'CGL010'  DBKEY            * DBERR 08 *   CGL010
     C                     MOVEL'008'     DBASE            ************   CGL010
     C                     MOVE *ON       *INU7                           CGL010
     C                     MOVE *ON       *INU8                           CGL010
     C                     MOVE *ON       *INLR                           CGL010
     C                     EXSR *PSSR                                     CGL010
     C                     ENDIF                                          CGL010
      *                                                                   CGL010
     C           @RTCD     IFEQ *BLANKS                                   CGL010
     C                     MOVE 'Y'       CGL010                          CGL010
     C                     ENDIF                                          CGL010
      *                                                                                       CRE020
      ** Determine if feature CRE020 is installed.                                            CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       CRE020  1                                           CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSARDR0'                                                    CRE020
     C                     PARM '       ' @RTCD                                               CRE020
     C                     PARM '*VERIFY' @OPTN                                               CRE020
     C                     PARM 'CRE020'  @KEY                                                CRE020
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE020
      *                                                                                       CRE020
     C           @RTCD     IFNE *BLANKS                                                       CRE020
     C           @RTCD     ANDNE'*NRF   '                                                     CRE020
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CRE020
     C                     MOVEL'CRE020'  DBKEY            * DBERR 07 *                       CRE020
     C                     MOVEL'007'     DBASE            ************                       CRE020
     C                     MOVE *ON       *INU7                                               CRE020
     C                     MOVE *ON       *INU8                                               CRE020
     C                     MOVE *ON       *INLR                                               CRE020
     C                     EXSR *PSSR                                                         CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C           @RTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVE 'Y'       CRE020                                              CRE020
     C                     ENDIF                                                              CRE020
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     OPEN EVNTD                                     CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,GL0580C003
      *                                                                   S01473
     C                     CALL 'AOMMODR0'                                CTI001
     C                     PARM '*DBERR ' @RTCD                           CTI001
     C                     PARM '*FIRST ' @OPTN                           CTI001
     C           SDMOD     PARM SDMOD     DSFDY                           CTI001
      *                                                                   CTI001
     C           @RTCD     IFNE *BLANK                                    CTI001
     C                     MOVEL'SDMMODPD'DBFILE            ************* CTI001
     C                     MOVEL'05'      DBASE             * DBERR 05 *  CTI001
     C                     MOVEL@OPTN     DBOPTN            ************* CTI001
     C                     MOVEL@OPTN     DBKEY                           CTI001
     C                     EXSR *PSSR                                     CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      ** Midas/TI interface installed?                                    CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     MOVE 'Y'       ULEO                            CTI001
     C                     MOVE *ON       *IN79                           CTI001
     C                     ELSE                                           CTI001
     C                     MOVE *OFF      *IN79                           CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      ** Determine if Customer Lending Enhancements - Tranche 3           CLE005
      ** (CLE005) is installed                                            CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   W0RTCD  7                       CLE005
     C                     PARM '*VERIFY' W0OPTN  7                       CLE005
     C                     PARM 'CLE005'  W0SARD  6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
      *                                                                   CLE005
      ** If feature is on, set up SAR work flag                           CLE005
      *                                                                   CLE005
     C           W0RTCD    IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005                          CLE005
     C                     ELSE                                           CLE005
      *                                                                   CLE005
      ** else, database error (return code other than *NRF)               CLE005
      *                                                                   CLE005
     C           W0RTCD    IFNE '*NRF   '                                 CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 005*   CLE005
     C                     MOVEL'005'     DBASE            ************   CLE005
     C                     MOVE '1'       *INU7                           CLE005
     C                     MOVE '1'       *INU8                           CLE005
     C                     MOVE '1'       *INLR                           CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      ** Access SAR details file to determine if CIR007                                       CIR007
      ** (Overnight Index Swaps) is switched on.                                              CIR007
     C                     CALL 'AOSARDR0'                                                    CIR007
     C                     PARM *BLANK    PRTCD   7                                           CIR007
     C                     PARM '*VERIFY' POPTN   7                                           CIR007
     C                     PARM 'CIR007'  PSARD   6                                           CIR007
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR007
     C           PRTCD     IFNE *BLANKS                                                       CIR007
     C           PRTCD     ANDNE'*NRF   '                                                     CIR007
     C                     MOVEL'SCSARDPD'DBFILE                                              CIR007
     C                     MOVEL'009'     DBASE                                               CIR007
     C                     MOVEL'CIR007  'DBKEY                                               CIR007
     C                     MOVE *ON       *INU7                                               CIR007
     C                     MOVE *ON       *INU8                                               CIR007
     C                     MOVE *ON       *INLR                                               CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
     C           PRTCD     IFEQ *BLANKS                                                       CIR007
     C                     MOVE 'Y'       CIR007  1                                           CIR007
     C                     ELSE                                                               CIR007
     C                     MOVE 'N'       CIR007                                              CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CAS009
      ** Access SAR details file to determine if CAS009                                       CAS009
      ** (Effective Interest Rate/Amortised Cost Accounting)                                  CAS009
      ** is switched on.                                                                      CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANK    PRTCD                                               CAS009
     C                     PARM '*VERIFY' POPTN                                               CAS009
     C                     PARM 'CAS009'  PSARD                                               CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE *BLANKS                                                       CAS009
     C           PRTCD     ANDNE'*NRF   '                                                     CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVEL'011'     DBASE                                               CAS009
     C                     MOVEL'CAS009  'DBKEY                                               CAS009
     C                     MOVE *ON       *INU7                                               CAS009
     C                     MOVE *ON       *INU8                                               CAS009
     C                     MOVE *ON       *INLR                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
     C           PRTCD     IFEQ *BLANKS                                                       CAS009
     C                     MOVE 'Y'       CAS009  1                                           CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'N'       CAS009                                              CAS009
     C                     ENDIF                                                              CAS009
     C/COPY WNCPYSRC,GL0580C014
      *                                                                   CLE005
      ** Determine if feature CRE009 is installed.                        CRE009
      *                                                                   CRE009
     C           *NAMVAR   DEFN           LDA                             CRE009
     C           *NAMVAR   DEFN           REPMED                          CRE009
     C                     MOVE 'N'       CRE009  1                       CRE009
      *                                                                   CRE009
     C                     CALL 'AOSARDR0'                                CRE009
     C                     PARM '       ' @RTCD                           CRE009
     C                     PARM '*VERIFY' @OPTN                           CRE009
     C                     PARM 'CRE009'  @KEY                            CRE009
     C           SCSARD    PARM SCSARD    DSFDY                           CRE009
      *                                                                   CRE009
     C           @RTCD     IFNE *BLANKS                                   CRE009
     C           @RTCD     ANDNE'*NRF   '                                 CRE009
     C                     MOVEL'SCSARDPD'DBFILE           ************   CRE009
     C                     MOVEL'CRE009'  DBKEY            * DBERR 09 *   CRE009
     C                     MOVEL'009'     DBASE            ************   CRE009
     C                     MOVE *ON       *INU7                           CRE009
     C                     MOVE *ON       *INU8                           CRE009
     C                     MOVE *ON       *INLR                           CRE009
     C                     EXSR *PSSR                                     CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           @RTCD     IFEQ *BLANKS                                   CRE009
     C                     MOVE 'Y'       CRE009                          CRE009
      *                                                                   CRE009
      ** RETRIEVE SYSTEM VALUES.                                          CRE009
      *                                                                   CRE009
     C                     MOVE *BLANKS   SVALK1                          CRE009
     C                     MOVE *BLANKS   SVALK2                          CRE009
     C                     MOVE *BLANKS   SVALK3                          CRE009
     C                     MOVE *BLANKS   SVALK4                          CRE009
     C                     MOVE *BLANKS   SVALK5                          CRE009
     C                     MOVE *BLANKS   SVALK6                          CRE009
     C                     MOVE *BLANKS   SVALK7                          CRE009
     C                     MOVE *BLANKS   SVALK8                          CRE009
     C                     MOVE *BLANKS   SVALK9                          CRE009
     C                     MOVE *BLANKS   SVALK0                          CRE009
      *                                                                   CRE009
     C**********           MOVEL'RETAILPR'DVAL1                                        CRE009 242615
     C**********           MOVEL'OJECTEDD'DVAL2                                        CRE009 242615
     C**********           MOVEL'AYS     'DVAL3                                        CRE009 242615
     C                     MOVEL'Projecte'DVAL1                                               242615
     C                     MOVEL'dDaysRet'DVAL2                                               242615
     C                     MOVEL'ail     'DVAL3                                               242615
      *                                                                   CRE009
     C                     MOVELDVALK     SVALK1                          CRE009
      *                                                                   CRE009
     C                     CALL 'AOSVALR0'                                CRE009
     C                     PARM           RTNCDE  7                       CRE009
     C                     PARM           SVALK1 20                       CRE009
     C                     PARM           SVAL1 200                       CRE009
     C                     PARM           SVALK2 20                       CRE009
     C                     PARM           SVAL2 200                       CRE009
     C                     PARM           SVALK3 20                       CRE009
     C                     PARM           SVAL3 200                       CRE009
     C                     PARM           SVALK4 20                       CRE009
     C                     PARM           SVAL4 200                       CRE009
     C                     PARM           SVALK5 20                       CRE009
     C                     PARM           SVAL5 200                       CRE009
     C                     PARM           SVALK6 20                       CRE009
     C                     PARM           SVAL6 200                       CRE009
     C                     PARM           SVALK7 20                       CRE009
     C                     PARM           SVAL7 200                       CRE009
     C                     PARM           SVALK8 20                       CRE009
     C                     PARM           SVAL8 200                       CRE009
     C                     PARM           SVALK9 20                       CRE009
     C                     PARM           SVAL9 200                       CRE009
     C                     PARM           SVALK0 20                       CRE009
     C                     PARM           SVAL10200                       CRE009
      *                                                                   CRE009
     C           RTNCDE    IFNE *BLANKS                                   CRE009
     C           SVAL10    IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK0    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL9     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK9    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL8     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK8    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL7     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK7    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL6     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK6    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL5     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK5    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL4     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK4    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL3     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK3    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL2     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK2    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           SVAL1     IFEQ '*NRF'                                    CRE009
     C                     MOVE SVALK1    DBKEY                           CRE009
     C                     ENDIF                                          CRE009
     C           *LOCK     IN   LDA                                       CRE009
     C                     Z-ADD1         DBASE                           CRE009
     C                     MOVE 'SDSVALPD'DBFILE                          CRE009
     C                     MOVE 'GL0580'  DBPGM                           CRE009
     C                     OUT  LDA                                       CRE009
     C                     EXSR *PSSR                                     CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
      *
      *                                                                                       CLE028
      ** Check if enhancement CLE028 is installed                                             CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD                                               CLE028
     C                     PARM '*VERIFY 'POPTN                                               CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'CLE028'  DBKEY                                               CLE028
     C                     MOVEL'010'     DBASE                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       237466
      ** Access SAR details file to see if CEU004 is installed                                237466
      *                                                                                       237466
     C                     MOVE 'N'       CEU004  1                                           237466
      *                                                                                       237466
     C                     CALL 'AOSARDR0'                                                    237466
      *                                                                                       237466
     C                     PARM '       ' @RTCD   7                                           237466
     C                     PARM '*VERIFY' @OPTN   7                                           237466
     C                     PARM 'CEU004'  P@SARD  6                                           237466
      *                                                                                       237466
     C           SCSARD    PARM SCSARD    DSFDY                                               237466
      *                                                                                       237466
     C           @RTCD     IFEQ *BLANK                                                        237466
     C                     MOVE 'Y'       CEU004                                              237466
      *                                                                                       237466
     C                     ENDIF                                                              237466
      *                                                                                       CAP204
      ** Access SAR details file to see if CAP204 is installed                                CAP204
      *                                                                                       CAP204
     C                     CALL 'AOSARDR0'                                                    CAP204
     C                     PARM '       ' @RTCD                                               CAP204
     C                     PARM '*VERIFY' @OPTN                                               CAP204
     C                     PARM 'CAP204'  @KEY                                                CAP204
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP204
      *                                                                                       CAP204
     C           @RTCD     IFNE *BLANKS                                                       CAP204
     C           @RTCD     ANDNE'*NRF   '                                                     CAP204
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CAP204
     C                     MOVEL'CAP204'  DBKEY            * DBERR 12 *                       CAP204
     C                     MOVEL'012'     DBASE            ************                       CAP204
     C                     MOVE *ON       *INU7                                               CAP204
     C                     MOVE *ON       *INU8                                               CAP204
     C                     MOVE *ON       *INLR                                               CAP204
     C                     EXSR *PSSR                                                         CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C           @RTCD     IFEQ *BLANKS                                                       CAP204
     C                     MOVE 'Y'       CAP204  1                                           CAP204
     C                     ELSE                                                               CAP204
     C                     MOVE 'N'       CAP204                                              CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP205
      ** Determine if feature CAP205 is installed                                             CAP205
      *                                                                                       CAP205
     C                     MOVE 'N'       CAP205  1                                           CAP205
      *                                                                                       CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM '       ' @RTCD                                               CAP205
     C                     PARM '*VERIFY' @OPTN                                               CAP205
     C                     PARM 'CAP205'  @KEY                                                CAP205
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP205
      *                                                                                       CAP205
     C           @RTCD     IFNE *BLANKS                                                       CAP205
     C           @RTCD     ANDNE'*NRF   '                                                     CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     MOVEL'CAP205'  DBKEY                                               CAP205
     C                     MOVEL'013'     DBASE                                               CAP205
     C                     MOVE *ON       *INU7                                               CAP205
     C                     MOVE *ON       *INU8                                               CAP205
     C                     MOVE *ON       *INLR                                               CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C           @RTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVE 'Y'       CAP205                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                     MD053873
      ** Check if CLE031 is switched on                                                     MD053873
      *                                                                                     MD053873
     C                     MOVEL'N'       CLE031  1                                         MD053873
     C                     CALL 'AOSARDR0'                                                  MD053873
     C                     PARM *BLANKS   PRTCD                                             MD053873
     C                     PARM '*VERIFY' POPTN                                             MD053873
     C                     PARM 'CLE031'  PSARD                                             MD053873
     C           SCSARD    PARM SCSARD    DSFDY                                             MD053873
     C           PRTCD     IFEQ *BLANKS                                                     MD053873
     C                     MOVEL'Y'       CLE031                                            MD053873
     C                     ENDIF                                                            MD053873
      *                                                                                     MD054101
      ** Check if CLE141 is switched on                                                     MD054101
      *                                                                                     MD054101
     C                     MOVEL'N'       CLE141  1                                         MD054101
     C                     CALL 'AOSARDR0'                                                  MD054101
     C                     PARM *BLANKS   PRTCD                                             MD054101
     C                     PARM '*VERIFY' POPTN                                             MD054101
     C                     PARM 'CLE141'  PSARD                                             MD054101
     C           SCSARD    PARM SCSARD    DSFDY                                             MD054101
     C           PRTCD     IFEQ *BLANKS                                                     MD054101
     C                     MOVE 'Y'       CLE141                                            MD054101
     C                     ENDIF                                                            MD054101
      *                                                                                     MD054101
     C           BDCHK     PLIST                                                            MD054101
     C                     PARM           ZDAYNO                                            MD054101
     C                     PARM           ARCY                                              MD054101
     C                     PARM           ALOC                                              MD054101
     C                     PARM           PAYIND  1                                         MD054101
     C                     PARM           BJDFIN                                            MD054101
     C                     PARM           ZCCY                                              MD054101
     C                     PARM           ZLOC                                              MD054101
     C                     PARM *ZEROS    ZADJDT  50                                        MD054101
      *                                                                                    MD022382A
      ** Check the value of Currency Basis for Nostro Events                               MD022382A
      *                                                                                    MD022382A
     C                     CALL 'AOSVALR0'                                                 MD022382A
     C                     PARM *BLANKS   @RTCD                                            MD022382A
     C                     PARM SVALKK    SVALK1                                           MD022382A
     C                     PARM           SVAL1                                            MD022382A
     C                     PARM *BLANK    SVALK2                                           MD022382A
     C                     PARM           SVAL2                                            MD022382A
     C                     PARM *BLANK    SVALK3                                           MD022382A
     C                     PARM           SVAL3                                            MD022382A
     C                     PARM *BLANK    SVALK4                                           MD022382A
     C                     PARM           SVAL4                                            MD022382A
     C                     PARM *BLANK    SVALK5                                           MD022382A
     C                     PARM           SVAL5                                            MD022382A
     C                     PARM *BLANK    SVALK6                                           MD022382A
     C                     PARM           SVAL6                                            MD022382A
     C                     PARM *BLANK    SVALK7                                           MD022382A
     C                     PARM           SVAL7                                            MD022382A
     C                     PARM *BLANK    SVALK8                                           MD022382A
     C                     PARM           SVAL8                                            MD022382A
     C                     PARM *BLANK    SVALK9                                           MD022382A
     C                     PARM           SVAL8                                            MD022382A
     C                     PARM *BLANK    SVALK9                                           MD022382A
     C                     PARM           SVAL9                                            MD022382A
     C                     PARM *BLANK    SVALK0                                           MD022382A
     C                     PARM           SVAL10                                           MD022382A
      *                                                                                    MD022382A
     C           @RTCD     IFNE *BLANKS                                                    MD022382A
     C                     MOVEL'SDSVALPD'DBFILE                                           MD022382A
     C                     MOVELSVALK1    DBKEY                                            MD022382A
     C                     MOVEL'014'     DBASE                                            MD022382A
     C                     MOVE *ON       *INU7                                            MD022382A
     C                     MOVE *ON       *INU8                                            MD022382A
     C                     MOVE *ON       *INLR                                            MD022382A
     C                     EXSR *PSSR                                                      MD022382A
     C                     ENDIF                                                           MD022382A
     C                     MOVE SVAL11    CCYBAS  1                                        MD022382A
      *
     C/COPY OFCPYSRCZ,CGL124_002                                                              CGL124
      *                                                                                       CGL124
0357 C           START     TAG                             ** START TAG **
0358 C   L2                SETOF                     6061
     C                     SETOF                     39                   BHF276
0359 C                     SETOF                     70
     C                     SETOF                     48
     C                     SETOF                     78                   178438
     C                     SETOF                     89                   S01119
      *                                                                                       CGL124
     C/COPY OFCPYSRCZ,CGL124_004                                                              CGL124
     C*                                                                   S01408
     C** Initialise RSACMTPD fields                                       178438
     C                     MOVE *BLANKS   NRTD                            178438
     C                     MOVE *BLANKS   NRTC                                              MD036589
     C                     MOVE *BLANKS   OTR1                                              MD044815
     C*                                                                   178438
     C/COPY WNCPYSRC,GL0580CP18                                           S01408
     C*                                                                   S01408
     C*                                                                   068596
     C* When branch changes, close GL0580P1                               068596
     C*                                                                   068596
     C           *INL3     IFEQ '1'                                       068596
     C                     CLOSEGL0580P1                                  068596
     C                     MOVE '0'       *IN55                           068596
     C                     MOVE '0'       *IN69                           068596
     C                     MOVE '0'       *IN25                           068596
     C                     END                                            068596
     C*                                                                   068596
     C   14
     COR 03                GOTO END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP21                                           S01408
     C*                                                                   S01408
0360 C   02
0369 COR 06                GOTO TRAIL
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP22                                           S01408
     C*                                                                   S01408
     C*                                                                   052613
     C** Do not continue if the criterion is not met                      052613
     C*                                                                   052613
     C**  Generate Projected Nostro Events should be run once only,       080723
     C**  during COB, and should be run for all branches.                 080723
     C***********BRNCH     IFEQ 'ALL'                               052613052613
     C***********BRNCH     OREQ '   '                               052613052613
     C***********BRNCH     OREQ BRCA                                052613052613
      *                                                                   S01473
      ** If Leo records are being processed, check if a Leo record has    S01473
      ** been read, if so, set the flag to 'Y'                            S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           *IN16     ANDEQ'1'                                       S01473
     C                     MOVE 'Y'       ULDET   1                       S01473
     C                     GOTO PROSEC                                    S01473
     C                     END                                            S01473
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP5                                           S01408
      *                                                                   S01408
0363 C   04
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP20                                           S01408
     C*                                                                   S01408
     COR 15
     C*R*16***                                                    *****   S01196
     C*R*17***                                                            E36449
     COR 18                                                               S01155
     COR 19                                                               S03220
     COR 20                                                               073714
     COR 26                                                               209995
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP13                                           S01408
      *                                                                   S01408
     COR 28                                                                                   CAP204
0364 COR 05                GOTO PROSEC
     C**                                                                  LN0819
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP17                                           S01408
      *                                                                   S01408
     C** Since nostro record just read from PRONT (*IN01) set @NOHD       LN0819
     C**   to 'Y' to indicate that new nostro heading needs printing      LN0819
     C**   when detail record read and save report name, town and         LN0819
     C**   opening balance to output to header.                           LN0819
     C***********          MOVEL'Y'       @NOHD                    LN0819 052613
     C                     MOVEL'Y'       @NOHD   1                       052613
     C                     MOVELCRNM      @CRNM  20                       LN0819
     C                     MOVELCTWN      @CTWN  10                       LN0819
     C                     MOVELNOBL      @NOBL  150                      LN0819
     C*                                                                   052613
     C** Remove extra line                                                052613
     C*                                                                   052613
     C***********          MOVEL'Y'       @NOHD                    LN0819 052613
     C**                                                                  LN0819
0365 C                     SETON                     60
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP23                                           S01408
     C*                                                                   S01408
0366 C   MR
0367 CORN21                SETON                     61
0368 C*
0369 C*    ACC. NUMBER AND VALUE OF PRONT RECORDS READ
0370 C           PTREC     ADD  1         PTREC   50
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP24                                           S01408
     C*                                                                   S01408
0371 C*
     C**                                                                  S01117
     C***********                                                         LN0354
     C***IF*A*REQUIRED BRANCH AND A LEVEL BREAK, OPEN DL0580P1     S01117 LN0354
     C** IF CHANGE OF BRANCH SET ON INDICATOR                             LN0354
     C           *INL3     IFEQ '1'                                       LN0354
     C                     SETON                     69                   LN0354
     C*                                                                   052613
     C** Only open PRTF if already closed and details to print            052613
     C*                                                                   052613
     C/COPY WNCPYSRC,GL0580C001
     C           NOSN      IFNE *ZEROS                                    052613
     C           *IN55     ANDNE'1'                                       052613
     C/COPY WNCPYSRC,GL0580C002
     C                     SETON                     253955               052613
     C                     OPEN GL0580P1                                  052613
     C*                                                                   052613
     C** Transfer binary data into numeric field                          052613
     C                     Z-ADDSFNUM     ZSNUM   60                      052613
     C*                                                                   052613
     C                     CALL 'ZSFILE'                                  052613
     C                     PARM           SEQ                             052613
     C                     PARM BRCA      @PARM   3                       052613
     C                     PARM           SFILE                           052613
     C                     PARM           ZSNUM                           052613
     C                     PARM *BLANK    ZSERR   1                       052613
     C*                                                                   052613
     C           ZSERR     IFEQ 'Y'                                       052613
     C                     SETON                     U7U8LR               052613
     C                     RETRN                                          052613
     C                     END                                            052613
     C*                                                                   052613
     C** If P1 file opened then set on flag                               052613
     C*                                                                   052613
     C                     MOVE '1'       *IN49                           052613
     C                     Z-ADD*ZEROS    PAGE                            052613
     C*                                                                   052613
     C** Get Branch name                                                  052613
     C*                                                                   052613
     C**********           CALL 'AOBRCHR0'                                052613              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       052613
     C                     PARM '*KEY   ' @OPTN   7                       052613
     C                     PARM BRCA      @DSNB   3                       052613
     C********** SDBRCH    PARM SDBRCH    DSFDY                           052613              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C                     END                                            052613
     C                     END                                            LN0354
     C************INL3     IFEQ '1'                                S01117 LN0354
     C***********          CLOSEDL0580P1                           S01117 LN0354
     C***********          SETOF                     55            S01117 LN0354
     C***********BRNCH     IFEQ 'ALL'                              S01117 LN0354
     C***********BRNCH     OREQ BRCA                               S01117 LN0354
     C***********          SETON                     55            S01117 LN0354
     C***********          OPEN DL0580P1                           S01117 LN0354
     C***TRANSFER BINARY DATA INTO NUMERIC FIELD                   S01117 LN0354
     C***********          Z-ADDSFNUM     ZSNUM   60               S01117 LN0354
     C***********                                                  S01117 LN0354
     C***********          CALL 'ZSFILE'                           S01117 LN0354
     C***********          PARM           SEQ                      S01117 LN0354
     C***********          PARM BRCA      @PARM   3                S01117 LN0354
     C***********          PARM           SFILE                    S01117 LN0354
     C***********          PARM           ZSNUM                    S01117 LN0354
     C***********          PARM *BLANK    ZSERR   1                S01117 LN0354
     C***********                                                  S01117 LN0354
     C***********ZSERR     IFEQ 'Y'                                S01117 LN0354
     C***********          SETON                     U7U8LR        S01117 LN0354
     C***********          RETRN                                   S01117 LN0354
     C***********          END                                     S01117 LN0354
     C***********                                                  S01117 LN0354
     C***IF*P1*FILE OPENED THEN SET ON FLAG                        S01117 LN0354
     C***********          MOVE '1'       *IN49                    S01117 LN0354
     C***********                                                  S01117 LN0354
     C***********                                                  S01117 LN0354
     C***********          Z-ADD0         PAGE                     S01117 LN0354
     C***********                                                  S01117 LN0354
     C***GET*BRANCH NAME                                           S01117 LN0354
     C***********          MOVE *BLANKS   ZTABKY                  ********S01194
     C***********          MOVEL'10'      ZTABKY 12               ********S01194
     C***********          MOVE BRCA      ZTABKY                  ********S01194
     C***********ZTABKY    CHAINTABLE                56           ********S01194
     C***********                                                         LN0354
     C***********          CALL 'AOBRCHR0'                         S01194 LN0354
     C***********          PARM '*MSG   ' @RTCD   7                S01194 LN0354
     C***********          PARM '*KEY   ' @OPTN   7                S01194 LN0354
     C***********          PARM BRCA      @DSNB   3                S01194 LN0354
     C***********SDBRCH    PARM SDBRCH    DSFDY                    S01194 LN0354
     C***********          END                                     S01117 LN0354
     C***********          END                                     S01117 LN0354
     C**S01154***CHAIN*TABLETL}FOR A/C CODE & SEQUENCE FOR NOSTROS*****   S01154
     C*                                                                   S01154
     C           *INL1     IFEQ '1'                                       S01154
     C           *INL2     OREQ '1'                             B001      S01154
     C*                                                                   S01154
     C                     SETOF                     77                   E27024
     C*                                                                   E27024
     C           NOSN      IFNE 0                               B002      S01154
     C*                                                                   S01154
     C**CHAIN*TABLETL*FOR NEW DETAILS                             *****   S01154
     C*                                                                   S01154
     C** ACCESS CURRENCY FILE.                                            S01117
     C*****                MOVELCCY       NOSKY1  5               S01154  S01194
     C*****                MOVE NOSN      NOSKY1                  S01154  S01194
     C*****                MOVEL'70     ' NOSKEY 12               S01154  S01194
     C*****                MOVE NOSKY1    NOSKEY                  S01154  S01194
     C*****      NOSKEY    CHAINTABLE                99           S01154  S01194
     C*****                SETON                     U7U8LR       S01154  S01194
     C*****                GOTO END                               S01154  S01194
     C*
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @PARM1  6                       S01194
     C                     PARM CCY       @KEYB   3                       S01194
     C**********           PARM *BLANKS   @PARM2  4                                    S01194 CGL029
     C                     PARM *BLANKS   @PARM2 10                                           CGL029
     C                     PARM *BLANKS   @PARM3  2                       S01194
     C                     PARM @NOSNA    @KEYE   3                       S01194
     C                     PARM *BLANKS   @KEYF   3                       S01194
     C                     PARM *BLANKS   @KEYG  10                       S01194
     C                     PARM *BLANKS   @KEYH   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVELCCY       @DBKEY  6                       S01194
     C                     MOVE @NOSNA    @DBKEY                          S01194
     C******************** MOVEL'SDNOSTPD'DBFILE 10        * * * * * * *  S01194CRE009
     C******************** MOVEL'002'     DBASE   3        * DBERR 002 *  S01194CRE009
     C******************** MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194CRE009
     C******************** MOVEL@DBKEY    DBKEY  29                       S01194CRE009
     C                     MOVEL'SDNOSTPD'DBFILE           * * * * * * *  CRE009
     C                     MOVEL'002'     DBASE            * DBERR 002 *  CRE009
     C                     MOVEL@OPTN     DBOPTN           * * * * * * *  CRE009
     C                     MOVEL@DBKEY    DBKEY                           CRE009
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   LN0720
     C** SAVE NOSTRO LOCATION                                             LN0720
     C                     MOVE A7NOSN    @LOC    3                       LN0720
      *                                                                   S01154
      ** RETRIEVE NOSTRO DETAILS TO CHECK IF RETAIL A/C                   CRE009
     C                     MOVE A7CUST    NCNUM                           CRE009
     C                     MOVE A7CYCD    NCCY                            CRE009
     C                     MOVE A7ACCD    NCODE                           CRE009
     C                     Z-ADDA7ACSN    NCSEQ                           CRE009
     C                     MOVE A7BRCD    NBRCD                           CRE009
     C*                                                                   S01154
     C                     END                                  E002      S01154
     C*                                                                   S01154
     C                     END                                  E001      S01154
0371 C*
0372 C*    AT CHANGE OF CURRENCY ON PRONT, PUT THE NEXT 6 WORKING DAYS
0373 C*    INTO DATE ARRAY
     C**   OR IF THE NOSTRO LOCATION CHANGES MUST CHECK FOR LOCATIONS     LN0720
     C**   HOLIDAYS                                                       LN0720
0374 C*
0375 C           CCY       COMP ZCCY                 5050
     C  N50      @LOC      COMP ZLOC                 5050                 LN0720
0376 C  N50                GOTO NOTNEW
0377 C                     MOVE CCY       ZCCY
     C                     MOVE @LOC      ZLOC                            LN0720
     C/COPY WNCPYSRC,GL0580C015
0378 C                     Z-ADD0         X       10
0379 C           INCX      TAG                             ** INCX TAG **
0380 C           X         ADD  1         X
0381 C*********  X         COMP 6                    43                                     AR987769
     C           X         COMP 8                    43                                     AR987769
0382 C   43                GOTO DECP
0383 C                     Z-ADDX         ZNRDYS
0384 C           X         COMP 1                        43
0385 C***43**              MOVE RUND      ZDAYNO                  *****   S01194
0344 C***43***             MOVE BJHZNB    ZDAYNO                    S01194E00045
0344 C***43******          MOVE BJRDNB    ZDAYNO                   E00045 058106
     C           *IN43     IFEQ '1'                                       058106
     C********** CCY       IFEQ BJLCCY                                               058106 MD021048
     C**********           MOVE BJRDNB    ZDAYNO                                     058106 MD021048
     C**********           ELSE                                                      058106 MD021048
     C           BJDNWD    SUB  1         ZDAYNO                          058106
     C**********           END                                                       058106 MD021048
     C                     END                                            058106
0351 C*****************    MOVE BJSLCD    ZLOC                      S01195LN0720
0386 C*****                EXSR ZDATE3                            *****   S01195
      *****************************************************************                237473 263013
      ***Save*the*current*value*of*ZLOC*and*ZCCY*and*replace*with******                237473 263013
      ***local*currency*and*location.**********************************                237473 263013
      *****************************************************************                237473 263013
     C**********           MOVE ZCCY      W#CCY   3                                    237473 263013
     C**********           MOVE ZLOC      W#LOC   3                                    237473 263013
     C**********           MOVE BJLCCY    ZCCY                                         237473 263013
     C**********           MOVE BJSLCD    ZLOC                                         237473 263013
     C           CCYBAS    IFEQ 'L'                                                        MD022382A
     C                     MOVE ZCCY      W#CCY   3                                        MD022382A
     C                     MOVE ZLOC      W#LOC   3                                        MD022382A
     C                     MOVE BJLCCY    ZCCY                                             MD022382A
     C                     MOVE BJSLCD    ZLOC                                             MD022382A
     C                     ENDIF                                                           MD022382A
0386 C                     EXSR ZFWDT                                     S01195
0387 C                     MOVE ZDYNBR    DATE,X
     C**********           MOVE W#CCY     ZCCY                                         237473 263013
     C**********           MOVE W#LOC     ZLOC                                         237473 263013
     C           CCYBAS    IFEQ 'L'                                                        MD022382A
     C                     MOVE W#CCY     ZCCY                                             MD022382A
     C                     MOVE W#LOC     ZLOC                                             MD022382A
     C                     ENDIF                                                           MD022382A
0388 C                     GOTO INCX
0389 C           DECP      TAG                             ** DECP  TAG **
     C/COPY WNCPYSRC,GL0580C016
0390 C*
0391 C*    SET INDICATORS ACCORDING TO NUMBER OF DECIMAL PLACES OF CCY
0392 C*
0393 C*****                MOVELCCY       DATACY                  *****   S01194
0394 C*****                SETOF                     07           *****   S01194
0395 C*****      KEYT      CHAINTABLE                99           *****   S01194
0396 C*****                SETON                     U7U8LR       *****   S01194
0397 C*****                GOTO END                               *****   S01194
     C*
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C******************** MOVEL'SDCURRPD'DBFILE 10        * * * * * * *  S01194CRE009
     C******************** MOVEL'003'     DBASE   3        * DBERR 003 *  S01194CRE009
     C******************** MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194CRE009
     C******************** MOVELCCY       DBKEY  29                       S01194CRE009
     C                     MOVEL'SDCURRPD'DBFILE           * * * * * * *  CRE009
     C                     MOVEL'003'     DBASE            * DBERR 003 *  CRE009
     C                     MOVEL@OPTN     DBOPTN           * * * * * * *  CRE009
     C                     MOVELCCY       DBKEY                           CRE009
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0398 C*****      CDP       COMP 1                      3031       *****   S01194
0398 C           A6NBDP    COMP 1                      3031               S01194
0399 C*****      CDP       COMP 2                    33  32       *****   S01194
0399 C           A6NBDP    COMP 2                    33  32               S01194
0400 C           NOTNEW    TAG                             ** NOTNEW TAG *
0401 C*****                SETON                     49                   S01117
0402 C*
0403 C**   PRIMARY RECORD
0404 C*
0405 C                     SETOF                     53
0406 C                     Z-ADDNOBL      CBAL,1
0407 C                     Z-ADDNOBL      CBAL,2
0408 C                     Z-ADDNOBL      CBAL,3
0409 C                     Z-ADDNOBL      CBAL,4
0410 C                     Z-ADDNOBL      CBAL,5
     C/COPY WNCPYSRC,GL0580C017
     C**                                                                  BHF259
     C***IF*A*REQUIRED*BRANCH, DETAILS TO REPORT AND LEVEL BREAK HABHF259 LN0819
     C***OCCURRED**OPEN*DL0580P1                                   BHF259 LN0819
     C***IF*CHANGE*OF*BRANCH*THEN*CLOSE*DL0580P1                    LN0819E22608
     C*                                                                   052613
     C** Codes removed                                                    052613
     C*                                                                   052613
     C***IF*CHANGE*OF*BRANCH*THEN*CLOSE*GL0580P1*******************E22608 052613
     C************IN69     IFEQ '1'                                BHF259 052613
     C************IN61     ANDEQ'1'                                BHF259 052613
0422 C***********                                                         LN0730
0422 C***IF*DETAILS*HAVE*BEEN*PRINTED*FOR*PREVIOUS*BRANCH*WRITE****LN0730 052613
0422 C***'END*OF*BRANCH'*TO*REPORT*BEFORE*CLOSING.*****************LN0730 052613
0422 C***********                                                         LN0730
0422 C************IN25     IFEQ '1'                                LN0730 052613
0422 C***********          EXCPT@EOBLN                             LN0730 052613
0422 C***********          MOVE '0'       *IN25                    LN0730 052613
0422 C***********          END                                     LN0730 052613
0422 C*                                                                   LN0730
     C*********************CLOSEDL0580P1                            BHF259E22608
     C***********          CLOSEGL0580P1                           E22608 052613
     C***********          SETOF                     5569          BHF259 052613
     C***********BRNCH*****IFEQ 'ALL'                              BHF259 LN0819
     C***********BRNCH*****OREQ BRCA                               BHF259 LN0819
     C*********************SETON                     55            BHF259 LN0819
     C*********************SETON                     39            BHF259 LN0819
     C*********************OPEN DL0580P1                           BHF259 LN0819
      ***TRANSFER*BINARY*DATA INTO NUMERIC FIELD                   BHF259 LN0819
     C*********************Z-ADDSFNUM     ZSNUM   60               BHF259 LN0819
     C*********************                                        BHF259 LN0819
     C*********************CALL 'ZSFILE'                           BHF259 LN0819
     C*********************PARM           SEQ                      BHF259 LN0819
     C*********************PARM BRCA      @PARM   3                BHF259 LN0819
     C*********************PARM           SFILE                    BHF259 LN0819
     C*********************PARM           ZSNUM                    BHF259 LN0819
     C*********************PARM *BLANK    ZSERR   1                BHF259 LN0819
     C*********************                                        BHF259 LN0819
     C***********ZSERR*****IFEQ 'Y'                                BHF259 LN0819
     C*********************SETON                     U7U8LR        BHF259 LN0819
     C*********************RETRN                                   BHF259 LN0819
     C*********************END                                     BHF259 LN0819
     C*********************                                        BHF259 LN0819
     C*********************Z-ADD0         PAGE                     BHF259 LN0819
     C*********************                                        BHF259 LN0819
     C***GET*BRANCH NAME***                                        BHF259 LN0819
     C*********************                                        BHF259 LN0819
     C*********************CALL 'AOBRCHR0'                         BHF259 LN0819
     C*********************PARM '*MSG   ' @RTCD   7                BHF259 LN0819
     C*********************PARM '*KEY   ' @OPTN   7                BHF259 LN0819
     C*********************PARM BRCA      @DSNB   3                BHF259 LN0819
     C***********SDBRCH****PARM SDBRCH    DSFDY                    BHF259 LN0819
     C*********************END                                     BHF259 LN0819
     C***********          END                                     BHF259 052613
0411 C                     GOTO END
0412 C           PROSEC    TAG                             ** PROSEC TAG *
0413 C*
0414 C*    ACCUMULATE NUMBER AND VALUE OF NOSEV RECORDS READ
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP9                                           S01408
      *                                                                   S01408
0415 C           NSVRED    ADD  1         NSVRED  50
0416 C           EAMT      DIV  1000      ZZAMT        34
0417 C                     Z-ADD2         I       10
0418 C                     EXSR HASH
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCPG                                           S01408
      *                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP34                                           S01408
     C*                                                                   S01408
0419 C*
0420 C*    IGNORE UNMATCHED SECONDARY RECORD
0421 C  NMR                GOTO END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP26                                           S01408
     C*                                                                   S01408
0422 C*
     C*                                                                   052613
     C** Codes removed                                                    052613
     C*                                                                   052613
     C***If*new*nostro*heading*needs*printing*(@NOHD*=*Y)*then*set*LN0819 052613
     C***on**IN07*first*time*and*set*off*second*time*to*avoid******LN0819 052613
     C***further*printing******************************************LN0819 052613
     C***********@NOHD     IFEQ 'Y'                                LN0819 052613
     C***(set*@NOHD*to*'N'*since*will*not*need*printing*next*time)*LN0819 052613
     C***********          MOVEL'1'       *IN07                    LN0819 052613
     C***********          MOVEL'N'       @NOHD   1                LN0819 052613
     C***********          ELSE                                    LN0819 052613
     C***(already*been*printed)************************************LN0819 052613
     C***********          MOVEL'0'       *IN07                    LN0819 052613
     C***********          END                                     LN0819 052613
      *                                                                                    MD036589A
      ** If FX netting event, switch on *IN24.                                             MD036589A
      *                                                                                    MD036589A
     C                     MOVE '0'       *IN24                                            MD036589A
     C           ETYP      IFEQ 'NTV1'                                                     MD036589A
     C           ETYP      OREQ 'NTV2'                                                     MD036589A
     C                     MOVE '1'       *IN24                                            MD036589A
     C                     MOVE *BLANKS   WNETD  19                                        MD036589A
     C                     MOVELZZ023     WNETD                                            MD036589A
     C                     ENDIF                                                           MD036589A
     C*                                                                   S01119
     C* IF EVENT TYPE ENDS IN 'N1' OR 'N2' DONT PRINT AMOUNT              S01119
     C*                                                                   S01119
     C                     MOVE ETYP      ALPHA2  2                       S01119
     C           ALPHA2    IFEQ 'N1'                                      S01119
     C           ALPHA2    OREQ 'N2'                                      S01119
     C                     SETOF                     44                   S01119
     C                     ELSE                                           S01119
     C                     SETON                     44                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* IF EVENT FOR FRA/IRS DEAL SUPPRESS RATE                           S01119
     C*                                                                   S01119
     C                     MOVELETYP      NUMEL   20                      S01119
     C           NUMEL     IFEQ 21                                        S01119
     C           NUMEL     OREQ 22                                        S01119
     C           NUMEL     OREQ 23                                        S01119
     C           NUMEL     OREQ 24                                        S01119
     C                     SETON                     89                   S01119
     C                     END                                            S01119
0423 C*
0424 C*    TEST INCOMING/OUTGOING INDICATOR
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP27                                           S01408
     C*                                                                   S01408
0425 C           INOI      COMP 'I'                      45
0426 C           INOI      COMP 'O'                      46
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP28                                           S01408
     C*                                                                   S01408
0427 C*    TEST WHETHER EVENT IS DUE BEFORE 6TH WORKING DAY
     C**   L/C EVENTS USES EDAT
     C**
     C***16**                                                     *****   S01196
     C*R*17**                                                     *****   S01196
     C***17**                                                      S01196 E36449
     C*R*18**                                                      S01129 E36449
      *                                                                   CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C                     Z-ADD0         @REPMD  50                      CRE009
     C                     Z-ADD0         WNBR    20                      CRE009
     C                     MOVE SVAL1     WNBR                            CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           DYSFWD    ANDLTWNBR                                      CRE009
     C           NOSN      ANDNE0                                         CRE009
      *                                                                   CRE009
     C           NOSKEY    CHAINACCNT                38                   CRE009
     C           *IN38     IFEQ *OFF                                      CRE009
     C           ATYP      ANDEQ'R'                                       CRE009
      *                                                                   CRE009
     C           *LOCK     IN   REPMED                                    CRE009
     C                     MOVE REPMED    @REPMD                          CRE009
      *                                                                   CRE009
     C                     ENDIF                                          CRE009
     C                     ELSE                                           CRE009
     C                     MOVEL*BLANK    ATYP                            CRE009
     C                     ENDIF                                          CRE009
      *                                                                   151088
      ** If TI records are being processed, and a TI record has           151088
      ** been read                                                        151088
     C           ULEO      IFEQ 'Y'                                       151088
     C           ULDET     ANDEQ'Y'                                       151088
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           ATYP      ANDEQ'R'                                       CRE009
     C           EDAT      COMP @REPMD                 7070               CRE009
     C                     ELSE                                           CRE009
     C*********  EDAT      COMP DATE,6                 70                            151088 AR987769
     C           EDAT      COMP DATE,8                 70                                   AR987769
     C                     ENDIF                                          CRE009
     C                     END                                            151088
      *                                                                   151088
     C***18****                                                                        E36449 CRE009
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP6                                           S01408
      *                                                                   S01408
     C           CRE009    IFEQ 'Y'                                                           CRE009
     C           ATYP      ANDEQ'R'                                                           CRE009
     C           *IN18     IFEQ *ON                                                           CRE009
     C           *IN19     OREQ *ON                                                           CRE009
     C           *IN20     OREQ *ON                                                           CRE009
     C           *IN26     OREQ *ON                                                           CRE009
     C           *IN15     OREQ *ON                                                           CRE009
     C           CAP204    OREQ 'Y'                                                           CAP204
     C           *IN28     ANDEQ*ON                                                           CAP204
     C           EDAT      COMP @REPMD                 7070                                   CRE009
     C                     ENDIF                                                              CRE009
     C                     ELSE                                                               CRE009
     C*OR*19****                                                                       S03220 CRE009
     C*OR*20****                                                                       073714 CRE009
     C*OR*26****                                                                       209995 CRE009
     C*OR*15****  EDAT      COMP DATE,6                 70                                    CRE009
     C           *IN18     IFEQ *ON                                                           CRE009
     C           *IN19     OREQ *ON                                                           CRE009
     C           *IN20     OREQ *ON                                                           CRE009
     C           *IN26     OREQ *ON                                                           CRE009
     C           *IN15     OREQ *ON                                                           CRE009
     C           CAP204    OREQ 'Y'                                                           CAP204
     C           *IN28     ANDEQ*ON                                                           CAP204
     C********** EDAT      COMP DATE,6                 70                            CRE009 AR987769
     C           EDAT      COMP DATE,8                 70                                   AR987769
     C                     ENDIF                                                              CRE009
     C                     ENDIF                                                              CRE009
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP12                                           S01408
      *                                                                   S01408
     C           CRE009    IFEQ 'Y'                                                           CRE009
     C           ATYP      ANDEQ'R'                                                           CRE009
     C           *IN04     IFEQ *ON                                                           CRE009
     C           *IN05     OREQ *ON                                                           CRE009
     C           FFVD      COMP @REPMD                 7070                                   CRE009
     C                     ENDIF                                                              CRE009
     C                     ELSE                                                               CRE009
     C****04****                                                                              CRE009
0428 C*OR*05****  FFVD      COMP DATE,6                 70                                    CRE009
     C           *IN04     IFEQ *ON                                                           CRE009
     C           *IN05     OREQ *ON                                                           CRE009
     C********** FFVD      COMP DATE,6                 70                            CRE009 AR987769
     C           FFVD      COMP DATE,8                 70                                   AR987769
     C                     ENDIF                                                              CRE009
     C                     ENDIF                                                              CRE009
0429 C  N70                GOTO AFTSIX
0430 C*************        MOVE 1         Z       10                      E249
     C                     Z-ADD1         Y       10                S01117E249
     C***16**                                                     *****   S01196
     C*R*17**                                                     *****   S01196
     C***17**                                                      S01196 E36449
     C*R*18**                                                      S01196 E36449
      *                                                                   S01473
      ** If Leo records are being processed, and a Leo record has         S01473
      ** been read                                                        S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULDET     ANDEQ'Y'                                       S01473
     C           EDAT      LOKUPDATE,Y                 7171               S01473
     C                     END                                            S01473
      *                                                                   209995
      ** If Standing Orders are being processed check the prono           209995
      ** dates to set the array index.                                    209995
      *                                                                   209995
     C           *IN26     IFEQ '1'                                       209995
     C           EDAT      LOKUPDATE,Y                 7171               209995
     C                     END                                            209995
      *                                                                   S01473
     C   18                                                               E36449
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP7                                           S01408
      *                                                                   S01408
     COR 19                                                               S03220
     COR 20                                                               073714
     COR 28                                                                                   CAP204
0431 C*OR*15******EDAT******LOKUPDATE,Z                 7171              E249
0431 COR 15      EDAT      LOKUPDATE,Y                 7171               E249
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP11                                           S01408
      *                                                                   S01408
     C   04
0431 C*OR*05******FFVD******LOKUPDATE,Z                 7171              E249
0431 COR 05      FFVD      LOKUPDATE,Y                 7171               E249
     C**                                                                  S01154
     C**    Save posting date to be shadow posted later                   S01154
     C**                                                                  S01154
     C*********************Z-ADDDATE,Z    PTDT                      S01154E249
     C                     Z-ADDDATE,Y    PTDT                            E249
0432 C*
     C**ADD*IN*EVENT*AMOUNT*TO*ALL*CLOSING*BALANCES*INCLUDING*AND*AFTER   042757
     C**THE*DATE*DUE***************************************************   042757
     C*                                                                   042757
     C** Access the date 'equal to' or 'greater than' the                 042757
     C** event date and update the appropriate balances                   042757
     C*                                                                   042757
     C*                                                                   042757
     C                     Z-ADD1         Y       10                      042757
      *                                                                   151088
      ** If TI records are being processed, and a TI record has           151088
      ** been read                                                        151088
     C           ULEO      IFEQ 'Y'                                       151088
     C           ULDET     ANDEQ'Y'                                       151088
     C           EDAT      LOKUPDATE,Y               71  71               151088
     C                     END                                            151088
      *                                                                   151088
     C   18                                                               042757
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP35                                           S01408
     C*                                                                   S01408
     COR 19                                                               042757
     COR 20                                                               174759
     COR 28                                                                                   CAP204
     COR 15      EDAT      LOKUPDATE,Y               71  71               042757
      *                                                                   209995
      ** If Standing Orders are being processed check the prono           209995
      ** dates to set the array index.                                    209995
      *                                                                   209995
     C           *IN26     IFEQ '1'                                       209995
     C           EDAT      LOKUPDATE,Y               71  71               209995
     C                     END                                            209995
     C   04                                                               042757
     COR 05      FFVD      LOKUPDATE,Y               71  71               042757
     C*                                                                   042757
     C********** Y         IFEQ 6                                                    042757 AR987769
     C           Y         IFGE 6                                                           AR987769
     C                     GOTO BALEND                                    042757
     C                     END                                            042757
0435 C*
0436 C           UDCBAL    TAG                             ** UDCBAL TAG *
0437 C***45******CBAL,Z****ADD  EAMT      CBAL,Z                          E249
0438 C***46******CBAL,Z****SUB  EAMT      CBAL,Z                          E249
0439 C***********Z******** ADD  1         Z                               E249
0440 C***********Z*********COMP 5                    72                   E249
     C/COPY WNCPYSRC,GL0580C007
0437 C   45      CBAL,Y    ADD  EAMT      CBAL,Y                          E249
0438 C   46      CBAL,Y    SUB  EAMT      CBAL,Y                          E249
     C/COPY WNCPYSRC,GL0580C008
0439 C           Y         ADD  1         Y                               E249
0440 C           Y         COMP 5                    72                   E249
0441 C  N72                GOTO UDCBAL
     C/COPY WNCPYSRC,GL0580C018
     C*                                                                   042757
     C           BALEND    TAG                             ** BALEND TAG *042757
     C*                                                                   042757
     C*                                                                   S01154
     C* S01154 - OUTPUT TO NEW FILE 'RSACMTPD' FOR RE OR DL EVENTS        S01154
     C* S01178 - OR FT EVENTS.                                            S01178
     C*                                                                   S01154
      *                                                                   S01473
      ** If Leo records are being processed, and a Leo record has         S01473
      ** been read perform the PF/RSACMTPD processing                     S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULDET     ANDEQ'Y'                                       S01473
      *                                                                   S01473
     C           NOSN      IFEQ 0                                         S01473
     C**********           MOVE *ZEROS    CUSN                                         S01473 CSD027
     C                     MOVE *BLANKS   CUSN                                                CSD027
     C                     MOVE *ZEROS    ACDE                            S01473
     C                     MOVE *ZEROS    ASNC                            S01473
     C                     ELSE                                           S01473
     C                     MOVE A7CUST    CUSN                            S01473
     C                     MOVE A7ACCD    ACDE                            S01473
     C                     MOVE A7ACSN    ASNC                            S01473
     C                     END                                            S01473
      *                                                                   S01473
     C                     MOVE ECCY      CCYD                            S01473
     C                     MOVE EDAT      PTDT                            S01473
     C                     MOVE ETYP      ETP     2 P                                         237466
      *                                                                                       260194
     C           *IN15     IFEQ '1'                                                           260194
     C           ETP       IFEQ 'I2'                                                          237466
     C           ETP       OREQ 'M1'                                                          237466
     C           ETP       OREQ 'M2'                                                          237466
     C           ETP       OREQ 'R1'                                                          237466
     C           ETP       OREQ 'R2'                                                          237466
     C                     EXSR SRRPAD                                                        237466
     C                     ENDIF                                                              237466
     C                     ENDIF                                                              260194
      *                                                                                       260194
     C           *IN15     IFEQ *ON                                                         MD052216
     C           ETP       IFEQ 'F1'                                                        MD052216
     C           ETP       OREQ 'F2'                                                        MD052216
     C           ETP       OREQ 'FX'                                                        MD053950
     C           ETP       OREQ 'FY'                                                        MD053950
     C                     EXSR SRFPAD                                                      MD052216
     C                     ENDIF                                                            MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     EXSR SRPSTD                                                        246761
     C                     MOVE EDAT      VUDT                            S01473
      *                                                                                     AR847588
      ** Reverse sign of EAMT if negative                                                   AR847588
      *                                                                                     AR847588
     C           EAMT      IFLT 0                                                           AR847588
     C           *IN15     ANDEQ'1'                                                        AR1071639
     C                     Z-SUBEAMT      MVAM                                              AR847588
     C                     ELSE                                                             AR847588
     C                     MOVE EAMT      MVAM                            S01473
     C                     ENDIF                                                            AR847588
     C                     MOVE *ZEROS    CQNR                            S01473
      *                                                                   S01473
      ** Include the reference number and event type for Leo events       S01473
     C********** BGN3ST    IFNE 'Y'                                       CTI001       CTI001 193207
     C           BGN3ST    IFEQ 'Y'                                                           193207
     C                     MOVE LCNO      TNMR                            S01473
     C**********           MOVE ETYP      TRYP                            S01473       S01473 193207
     C                     MOVELTIRF      TIREF3  3                                           193207
     C                     MOVE TIREF3    TRYP                                                193207
     C                     ENDIF                                          CTI001
      *                                                                   S01473
     C           INOI      IFEQ 'I'                                       S01473
     C                     Z-ADD0         DORC                            S01473
     C                     ELSE                                           S01473
     C                     Z-ADD1         DORC                            S01473
     C                     END                                            S01473
      *                                                                                       223572
     C                     MOVE ETYP      EVNTP2  2                                           223572
      *                                                                                       223572
     C           EVNTP2    IFEQ 'V4'                                                          223572
     C           EVNTP2    OREQ 'V6'                                                          223572
     C           EVNTP2    OREQ 'I6'                                                          223572
     C           EVNTP2    OREQ 'M6'                                                          223572
     C           EVNTP2    OREQ 'M8'                                                          223572
     C           EVNTP2    OREQ 'R6'                                                          223572
     C           EVNTP2    OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'63R4'                                                        223572
     C           EVNTP2    OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'41R4'                                                        223572
     C                     MOVE '0'       *IN70                                               223572
     C                     GOTO NOTREP                                                        223572
     C                     ENDIF                                                              223572
     C/COPY WNCPYSRC,GL0580C012
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C                     EXSR SRMOD                                                         CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CAP205
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     EXSR SRACMT                                                        CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   S01473
     C                     WRITERSACMTPO                                  S01473
     C/COPY WNCPYSRC,GL0580C010
     C                     GOTO AFTSIX                                    S01473
     C                     END                                            S01473
      *                                                                   S01473
     C           *IN04     IFEQ '1'                                       S01154
     C           *IN15     OREQ '1'                             B001      S01154
     C*                                                                   S01178
     C           *IN18     OREQ '1'                                       055800
     C           *IN19     OREQ '1'                                       S01178
     C*                                                                   073714
     C           *IN20     OREQ '1'                                       073714
     C           *IN26     OREQ '1'                                       209995
     C           CAP204    OREQ 'Y'                                                           CAP204
     C           *IN28     ANDEQ'1'                                                           CAP204
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP14                                           S01408
     C*                                                                   S01408
     C*                                                                   S01154
     C* ie. ONLY WRITE RECORD TO RSACMTPD FOR LE AND DL EVENTS.           S01154
     C* (AND FT EVENTS)                                                   S01178
     C*                                                                   S01154
     C           NOSN      IFEQ 0                               B002      S01154
     C*                                                                   S01154
     C**********           MOVE *ZEROS    CUSN                                         S01154 CSD027
     C                     MOVE *BLANKS   CUSN                                                CSD027
     C                     MOVE *ZEROS    ACDE                            S01154
     C                     MOVE *ZEROS    ASNC                            S01154
     C*                                                                   S01154
     C                     ELSE                                 X002      S01154
     C*                                                                   S01154
     C*****                MOVE CNUMNS    CUSN                    S01154  S01194
     C                     MOVE A7CUST    CUSN                            S01194
     C*****                MOVE ACODNS    ACDE                    S01154  S01194
     C                     MOVE A7ACCD    ACDE                            S01194
     C*****                MOVE ACSQNS    ASNC                    S01154  S01194
     C                     MOVE A7ACSN    ASNC                            S01194
     C*                                                                   S01154
     C                     END                                  E002      S01154
     C*                                                                   S01154
     C                     MOVE ECCY      CCYD                            S01154
     C                     MOVE EDAT      PTDT                            S01154
      *                                                                                      BUG8552
     C           *IN15     IFEQ '1'                                                          BUG8552
     C           EDAT      ANDLTBJDNWD                                                       BUG8552
     C           EDAT      ANDNE0                                                            BUG8552
     C                     MOVE BJDNWD    PTDT                                               BUG8552
     C                     ENDIF                                                             BUG8552
      *                                                                                      BUG8552
     C                     MOVE ETYP      ETP       P                                         237466
      *                                                                                       243352
     C           *IN15     IFEQ '1'                                                           243352
     C           ETP       IFEQ 'I2'                                                          237466
     C           ETP       OREQ 'M1'                                                          237466
     C           ETP       OREQ 'M2'                                                          237466
     C           ETP       OREQ 'R1'                                                          237466
     C           ETP       OREQ 'R2'                                                          237466
     C                     EXSR SRRPAD                                                        237466
     C                     ENDIF                                                              237466
     C                     ENDIF                                                              243352
      *                                                                                       243352
     C           *IN15     IFEQ *ON                                                         MD052216
     C           ETP       IFEQ 'F1'                                                        MD052216
     C           ETP       OREQ 'F2'                                                        MD052216
     C           ETP       OREQ 'FX'                                                        MD053950
     C           ETP       OREQ 'FY'                                                        MD053950
     C                     EXSR SRFPAD                                                      MD052216
     C                     ENDIF                                                            MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     EXSR SRPSTD                                                        246761
     C                     MOVE EDAT      VUDT                            S01154
      *                                                                                     AR847588
      ** Reverse sign of EAMT if negative                                                   AR847588
      *                                                                                     AR847588
     C           EAMT      IFLT 0                                                           AR847588
     C           *IN15     ANDEQ'1'                                                        AR1071639
     C                     Z-SUBEAMT      MVAM                                              AR847588
     C                     ELSE                                                             AR847588
     C                     MOVE EAMT      MVAM                            S01154
     C                     ENDIF                                                            AR847588
     C                     MOVE *ZEROS    CQNR                            S01154
     C                     MOVELTIRF      NRTD                            151088
      *                                                                   CDL008
      ** If event type is for CLS, move event name to narrative           CDL008
      *                                                                   CDL008
     C           ETYP      IFEQ 'CPV1'                                    CDL008
     C           ETYP      OREQ 'CRV1'                                    CDL008
     C           ETYP      LOKUPTABCOD    TABNAM         71               CDL008
     C           *IN71     IFEQ '1'                                       CDL008
     C                     MOVELTABNAM    NRTD                            CDL008
     C                     ENDIF                                          CDL008
     C                     ENDIF                                          CDL008
     C*                                                                   S01154
     C   04                MOVE DTYP      TRYP                            S01154
     C   04                MOVE DLNO      TNMR                            S01154
     C*                                                                                     BUG12888
     C   04      DTYP      IFEQ *BLANKS                                                     BUG12888
     C                     MOVE 'DL'      TRYP                                              BUG12888
     C                     ENDIF                                                            BUG12888
     C*                                                                                     BUG12888
      *                                                                                     MD036589
      ** If FX netting, seT up narrative and OTR1                                           MD036589
      *                                                                                     MD036589
     C           DTYP      IFEQ 'NT'                                                        MD036589
     C           *IN04     ANDEQ'1'                                                         MD036589
     C                     MOVE '00'      NRTC                                              MD036589
     C                     MOVELZZ023     NRTD                                              MD036589
     C                     MOVE '000000'  TNMR                                              MD036589
     C**********           MOVE '1'       *IN89                                   MD036589 MD036589A
     C********** OTHC      IFNE *BLANKS                                            MD036589 MD044815
     C**********           MOVELZZ023     WNETR1 19                                MD036589 MD044815
     C**********           MOVELWNETR1    W7                                       MD036589 MD044815
     C**********           MOVE WNETR1    W19                                      MD036589 MD044815
     C**********           MOVE OTHC      WCCY                                     MD036589 MD044815
     C**********           MOVE WNETR2    OTR1                                     MD036589 MD044815
     C                     MOVELZZ023     OTR1                                              MD044815
     C**********           ENDIF                                                   MD036589 MD044815
     C                     ENDIF                                                            MD036589
      *                                                                                     MD036589
     C           ETYP      IFEQ '11V1'                                                      MD044815
     C           ETYP      OREQ '11V2'                                                      MD044815
     C           ETYP      OREQ '12V2'                                                      MD044815
     C           ETYP      OREQ '13V2'                                                      MD044815
     C           ETYP      OREQ '14V1'                                                      MD044815
     C           ETYP      OREQ '14V2'                                                      MD044815
     C                     MOVELZZ023     OTR1                                              MD044815
     C                     ENDIF                                                            MD044815
     C   15                MOVE LTYP      TRYP                            S01154
     C   15                MOVE LNRF      TNMR                            S01154
     C*                                                                                     BUG12888
     C   15      LTYP      IFEQ *BLANKS                                                     BUG12888
     C                     MOVE 'CL'      TRYP                                              BUG12888
     C                     ENDIF                                                            BUG12888
     C*                                                                                     BUG12888
     C           *IN26     IFEQ '1'                                       209995
     C                     MOVE 'SO'      TRYP                            209995
     C                     MOVE STOR      TNMR      P                     209995
     C                     ENDIF                                          209995
     C           *IN18     IFEQ '1'                                       055800
     C***********          MOVE DTYP      TRYP                      055800096560
     C**********           MOVELETYP      ALPHA3  3                                    102748 210261
     C********** ALPHA3    IFEQ '31B'                                                  102748 210261
     C********** ALPHA3    OREQ '31C'                                                  102748 210261
     C********** ALPHA3    OREQ '31D'                                                  102748 210261
     C**********           MOVE 'SE'      TRYP                                         102748 210261
     C********** DLNO      IFNE *ZEROS                                                 102748 210261
     C**********           MOVE DLNO      TNMR                                         102748 210261
     C**********           ELSE                                                        102748 210261
     C********** ETYP      LOKUPTABCOD    TABNAM         71*                           102748 210261
     C***71*****           MOVELTABNAM    TNMR                                         102748 210261
     C**N71*****           MOVE *BLANKS   TNMR                                         102748 210261
     C**********           END                                                         102748 210261
     C**********           ELSE                                                        102748 210261
     C           INOI      IFEQ 'I'                                       096560
     C                     MOVE 'TS'      TRYP                            096560
     C                     ELSE                                           096560
     C                     MOVE 'TP'      TRYP                            096560
     C                     END                                            096560
      *                                                                                       247870
      ** Setup Transaction Type for Position Settlement events                                247870
      *                                                                                       247870
     C           ETYP      IFEQ '31B1'                                                        247870
     C           ETYP      OREQ '31C1'                                                        247870
     C           ETYP      OREQ '31D1'                                                        247870
     C                     MOVE 'PP'      TRYP                                                247870
     C                     ENDIF                                                              247870
      *                                                                                       247870
     C           ETYP      IFEQ '31B2'                                                        247870
     C           ETYP      OREQ '31C2'                                                        247870
     C           ETYP      OREQ '31D2'                                                        247870
     C                     MOVE 'CP'      TRYP                                                247870
     C                     ENDIF                                                              247870
      *                                                                                       247870
     C           ETYP      IFEQ '31B3'                                                        247870
     C           ETYP      OREQ '31C3'                                                        247870
     C           ETYP      OREQ '31D3'                                                        247870
     C                     MOVE 'DV'      TRYP                                                247870
     C                     ENDIF                                                              247870
      *                                                                                       247870
     C           ETYP      IFEQ '31B4'                                                        247870
     C           ETYP      OREQ '31C4'                                                        247870
     C           ETYP      OREQ '31D4'                                                        247870
     C                     MOVE 'MP'      TRYP                                                247870
     C                     ENDIF                                                              247870
      *                                                                                       247870
     C           ETYP      IFEQ '31B5'                                                        247870
     C           ETYP      OREQ '31C5'                                                        247870
     C           ETYP      OREQ '31D5'                                                        247870
     C                     MOVE 'MA'      TRYP                                                247870
     C                     ENDIF                                                              247870
      *                                                                                       247870
     C                     MOVE DLNO      TNMR                            055800
     C                     END                                            055800
     C**********           END                                                         102748 210261
     C*                                                                   055800
     C                     MOVELETYP      ALPHA2                          045634
     C           ALPHA2    IFEQ '71'                       Loan fee       045634
     C           CLE005    ANDEQ'N'                                       CLE005
     C                     MOVE ETYP      TRYP                            045634
     C                     END                                            045634
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           ETYP      IFEQ '71F1'                                    CLE005
     C           ETYP      OREQ '71F2'                                    CLE005
     C                     MOVE ETYP      TRYP                            CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C*                                                                   S01154
     C                     MOVE *BLANKS   FUND                            033647
     C***19******          MOVE ETYP      TRYP                            S01178
     C   19                MOVE FTTRYP    TRYP                            033647
     C   19                MOVE PREF      TNMR                            S01178
     C***19*****           MOVE PREF      FUND                                         033647 CRE020
     C   19                MOVELPREF      FUND                                                CRE020
     C*                                                                   073714
     C   20                MOVE *BLANK    TRYP                            073714
     C   20                MOVE TNBR      TNMR                            073714
      *                                                                   CDL006
      ** If feature CDL006 installed, add Fiduciary processing.           CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** If Call/Notice or Fixed term deposit.                            CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DT'                                      CDL006
     C           *IN04     ANDEQ'1'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           *IN04     ANDEQ'1'                                       CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           *IN04     ANDEQ'1'                                       CDL006
      *                                                                   CDL006
      ** Key list to access Events creation logical file.                 CDL006
      *                                                                   CDL006
     C           KEVNTD    KLIST                                          CDL006
     C                     KFLD           DLNO                            CDL006
     C                     KFLD           ETYP                            CDL006
      *                                                                   CDL006
      ** Access Events creation logical file to retrieve Fiduciary        CDL006
      ** information.                                                     CDL006
      *                                                                   CDL006
     C           KEVNTD    CHAINEVNTD                83                   CDL006
      *                                                                   CDL006
      ** If event doesn't exist.                                          CDL006
      *                                                                   CDL006
     C           *IN83     IFEQ *ON                                       CDL006
     C           *IN83     OREQ *OFF                                      CDL006
     C           RECI      ANDNE'D'                                       CDL006
     C                     MOVEL'EVNTD'   DBFILE           ************   CDL006
     C                     MOVEL'006'     DBASE            * DBERR 06 *   CDL006
     C                     MOVEL'*KEY   ' DBOPTN           ************   CDL006
     C                     MOVELDLNO      WU1@10 10                       CDL006
     C                     MOVE ETYP      WU1@10                          CDL006
     C                     MOVELWU1@10    DBKEY                           CDL006
     C                     MOVE *ON       *INU7                           CDL006
     C                     MOVE *ON       *INU8                           CDL006
     C                     MOVE *ON       *INLR                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If Fiduciary indicator is 'L' or 'D'.                            CDL006
      *                                                                   CDL006
     C           CFID      IFEQ 'L'                                       CDL006
     C           CFID      OREQ 'D'                                       CDL006
      *                                                                   CDL006
     C                     MOVE ETYP      ALPHA2                          CDL006
      *                                                                   CDL006
      ** If Value date ('V1') or Principal Increase ('V3') events.        CDL006
      *                                                                   CDL006
     C           ALPHA2    IFEQ 'V1'                                      CDL006
     C           ALPHA2    OREQ 'V3'                                      CDL006
     C                     ADD  CGAMT     MVAM                            CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If Interim interest date ('I2') or Maturity date ('M1') event.   CDL006
      *                                                                   CDL006
     C           ALPHA2    IFEQ 'I2'                                      CDL006
     C           ALPHA2    OREQ 'M1'                                      CDL006
     C                     SUB  CMAMT     MVAM                            CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If Principal decrease ('M4') event.                              CDL006
      *                                                                   CDL006
     C           ALPHA2    IFEQ 'M4'                                      CDL006
     C                     SUB  CGAMT     MVAM                            CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
      *                                                                                       CAS009
     C           ETYP      IFEQ '15F1'                                                        CAS009
     C           ETYP      OREQ '16F1'                                                        CAS009
     C           ETYP      OREQ '17F1'                                                        CAS009
      *                                                                                       CAS009
     C                     MOVE ETYP      TRYP                                                CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP15                                           S01408
     C*                                                                   S01408
     C* FOR DEPOT OR CUSTOMER POSITION EVENTS: WRITE EVENT NAME           178438
     C* SECURITY SHORTNAME AND BRANCH IN NARRATIVE                        178438
     C           *IN18     IFEQ '1'                                       178438
     C           DLNO      IFEQ 0                                         178438
     C                     MOVELNBRC      NAR25  25                       178438
     C                     MOVE NESS      NAR21  21                       178438
     C********** ETYP      IFNE '        '                                             178438 210261
     C           ETYP      IFNE '    '                                                        210261
     C           ETYP      LOKUPTABCOD    TABNAM         71               178438
     C                     END                                            178438
     C                     MOVELTABNAM    NAR21                           178438
     C                     MOVE NAR21     NAR25                           178438
     C**********           MOVE NAR25     NRTD                                         178438 210261
     C                     MOVELNAR25     NRTD                                                210261
     C                     SETON                     78                   178438
     C                     END                                            178438
     C                     END                                            178438
     C*                                                                   S01178
     C           INOI      IFEQ 'I'                             B002      S01154
     C                     Z-ADD0         DORC                            S01154
      *                                                                                     AR375646
      ** If Lending IN amount is negative, output amount to                                 AR375646
      ** RSACMTPD as positive, but with DR/CR indicator = '1'.                              AR375646
      *                                                                                     AR375646
     C           *IN15     IFEQ '1'                                                         AR375646
     C           EAMT      ANDLT0                                                           AR375646
     C                     Z-ADD1         DORC                                              AR375646
     C                     Z-SUBEAMT      MVAM                                              AR375646
     C                     ENDIF                                                            AR375646
      *                                                                                     AR375646
     C                     ELSE                                 X002      S01154
     C                     Z-ADD1         DORC                            S01154
     C                     END                                  E002      S01154
     C*                                                                   S01154
     C                     MOVE ETYP      EVNTP2  2                                           223572
     C*                                                                                       223572
     C           EVNTP2    IFEQ 'V4'                                                          223572
     C           EVNTP2    OREQ 'V6'                                                          223572
     C           EVNTP2    OREQ 'I6'                                                          223572
     C           EVNTP2    OREQ 'M6'                                                          223572
     C           EVNTP2    OREQ 'M8'                                                          223572
     C           EVNTP2    OREQ 'R6'                                                          223572
     C           EVNTP2    OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'63R4'                                                        223572
     C           EVNTP2    OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'41R4'                                                        223572
     C                     MOVE '0'       *IN70                                               223572
     C                     GOTO NOTREP                                                        223572
     C                     ENDIF                                                              223572
      *                                                                                       223572
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C                     EXSR SRMOD                                                         CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                     BUG24690
     C           NRTD      IFEQ *BLANKS                                                     BUG24690
     C           ETYP      ANDNE'    '                                                      BUG24690
     C           ETYP      LOKUPTABCOD    TABNAM         71                                 BUG24690
     C           *IN71     IFEQ '1'                                                         BUG24690
     C                     MOVE *BLANKS   NRTD                                              BUG24690
     C                     MOVELTABNAM    NRTD                                              BUG24690
     C                     ENDIF                                                            BUG24690
     C                     END                                                              BUG24690
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN28     ANDEQ'1'                                                           CAP204
     C                     MOVELTREF      OTR1                                                CAP204
     C                     MOVE 'ZT'      TRYP                                                CAP204
     C           ETYP      LOKUPTABCOD    TABNAM         71                                   CAP204
     C   71                MOVELTABNAM    NRTD                                                CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CRE020
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     EXSR SRACMT                                                        CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C                     WRITERSACMTPO                                  S01154
     C/COPY WNCPYSRC,GL0580C011
     C*                                                                   S01154
     C                     END                                  E001      S01154
0442 C           AFTSIX    TAG                             ** AFTSIX TAG *
0443 C*
      *                                                                                       223572
     C                     MOVE ETYP      EVNTP2  2                                           223572
      *                                                                                       223572
     C           EVNTP2    IFEQ 'V4'                                                          223572
     C           EVNTP2    OREQ 'V6'                                                          223572
     C           EVNTP2    OREQ 'I6'                                                          223572
     C           EVNTP2    OREQ 'M6'                                                          223572
     C           EVNTP2    OREQ 'M8'                                                          223572
     C           EVNTP2    OREQ 'R6'                                                          223572
     C           EVNTP2    OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'63R4'                                                        223572
     C           EVNTP2    OREQ 'R4'                                                          223572
     C           ETYP      ANDNE'41R4'                                                        223572
     C                     MOVE '0'       *IN70                                               223572
     C                     GOTO NOTREP                                                        223572
     C                     ENDIF                                                              223572
      *
      *
0444 C*    TEST WHETHER EVENT IS TO BE REPORTED
      *                                                                   S01473
      ** If Leo records are being processed, and a Leo record has been    S01473
      ** read, check if the event is to be reported                       S01473
     C           ULEO      IFEQ 'Y'                                       S01473
      *                                                                   S01473
     C           ULDET     IFEQ 'Y'                                       S01473
     C           *IN70     ANDNE'1'                                       S01473
     C           EDAT      COMP REPDAT                 7070               S01473
     C                     END                                            S01473
      *                                                                   S01473
     C                     END                                            S01473
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP29                                           S01408
     C*                                                                   S01408
0445 C  N70 15   EDAT      COMP REPDAT                 7070
     C  N70 20   EDAT      COMP REPDAT                 7070               073714
0445 C**N70*16** EDAT      COMP REPDAT                 7070       *****   S01196
     C**N70*17***EDAT      COMP REPDAT                 7070               E36449
     C  N70 18   EDAT      COMP REPDAT                 7070               S01129
     C  N70 19   EDAT      COMP REPDAT                 7070               S03220
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP8                                           S01408
      *                                                                   S01408
     C  N70 04
0445 CORN70 05   FFVD      COMP REPDAT                 7070
     C           *IN26     IFEQ '1'                                       209995
     C           *IN70     ANDEQ'0'                                       209995
     C           EDAT      IFLE REPDAT                                    209995
     C                     MOVE '1'       *IN70                           209995
     C                     END                                            209995
     C                     END                                            209995
0446 C  N70                GOTO NOTREP
0447 C*
0422 C***IF*PRINT*FILE*OPEN*AND A MATCHING RECORD EXISTS SET ON    LN0730 LN0819
0422 C****IN25*TO*INDICATE*AT LEAST ONE RECORD TO BE PRINTED FOR   LN0730 LN0819
0422 C***THIS BRANCH.******                                        LN0730 LN0819
0422 C*********************                                        LN0730 LN0819
0422 C************INMR*****IFEQ '1'                        B1      LN0730 LN0819
0422 C************IN55*****ANDEQ'1'                        B1      LN0730 LN0819
0422 C*********************MOVE '1'       *IN25                    LN0730 LN0819
     C*********************END                             E1      LN0730 LN0819
      *                                                                   LN0819
      ***If*matching*record*exists*and*print*file*closed*then*set*oLN0819 E26063
      ******set*on**in25*to*indicate*at*least*one*record*to*be*****LN0819 E26063
      ******printed*for*this*branch********************************LN0819 E26063
     C********** *INMR     IFEQ '1'                                LN0819 E26063
     C********** *IN55     ANDEQ'0'                                LN0819 E26063
      *                                                                   E26063
      * Ensure first nostro for a branch is printed                       E26063
     C           *IN55     IFEQ '0'                                       E26063
     C                     MOVE '1'       *IN25                           LN0819
      *                                                                   LN0819
      ** If branch is the one required then open the P1                   LN0819
     C           BRNCH     IFEQ 'ALL'                                     LN0819
     C           BRNCH     OREQ BRCA                                      LN0819
     C                     MOVE '1'       *IN55                           LN0819
     C                     MOVE '1'       *IN39                           LN0819
     C**                                                                  LN0819
     C****Set*on**IN23*1*do*not*print*'No*Details*etc.' on DL0580AU LN0819E22608
     C**  Set on *IN23 - do not print 'No Details etc.' on GL0580AU       E22608
     C                     MOVEL'1'       *IN23                           LN0819
      *                                                                   209995
     C           BRCA      IFEQ *BLANKS                                   209995
     C           NOSNNV    ANDEQ*ZEROS                                    209995
     C                     MOVEL'UNALLOCA'@UNALL 11                       209995
     C                     MOVE 'TED'     @UNALL                          209995
     C                     MOVEL@UNALL    A8BRNM                          209995
     C                     END                                            209995
      *                                                                   209995
     C**                                                                  LN0819
     C*********************OPEN DL0580P1                           LN0819 E22608
     C                     OPEN GL0580P1                                  E22608
     C*                                                                   052613
     C** Codes removed                                                    052613
     C*                                                                   052613
     C***********                                                         LN0819
     C***Transfer*binary*data*into*numeric*field*******************LN0819 052613
     C***********          Z-ADDSFNUM     ZSNUM   60               LN0819 052613
     C***********                                                         LN0819
     C***********          CALL 'ZSFILE'                           LN0819 052613
     C***********          PARM           SEQ                      LN0819 052613
     C***********          PARM BRCA      @PARM   3                LN0819 052613
     C***********          PARM           SFILE                    LN0819 052613
     C***********          PARM           ZSNUM                    LN0819 052613
     C***********          PARM *BLANK    ZSERR   1                LN0819 052613
     C***********                                                         LN0819
     C***Error*during*ZSFILE*processing,*return*to*calling*program*LN0819 052613
     C***********ZSERR     IFEQ 'Y'                                LN0819 052613
     C***********          SETON                     U7U8LR        LN0819 052613
     C***********          RETRN                                   LN0819 052613
     C***********          END                                     LN0819 052613
     C***********                                                         LN0819
     C***********          Z-ADD0         PAGE                     LN0819 052613
     C***********                                                         LN0819
     C***if*Branch*not*blank*use*access*program*to*access*branch***LN0819 052613
     C***name******************************************************LN0819 052613
     C***********BRCA      IFNE *BLANKS                            LN0819 052613
     C***********          CALL 'AOBRCHR0'                         LN0819 052613
     C***********          PARM '*MSG   ' @RTCD   7                LN0819 052613
     C***********          PARM '*KEY   ' @OPTN   7                LN0819 052613
     C***********          PARM BRCA      @DSNB   3                LN0819 052613
     C***********SDBRCH    PARM SDBRCH    DSFDY                    LN0819 052613
     C**                                                                  LN0819
     C** else, if branch blank then nostro 00, set branch name to         LN0819
     C** 'UNALLOCATED'                                                    LN0819
     C                     ELSE                                           LN0819
     C                     MOVEL'UNALLOCA'@UNALL 11                       LN0819
     C                     MOVE 'TED'     @UNALL                          LN0819
     C                     MOVEL@UNALL    A8BRNM                          LN0819
     C***********          END                                     LN0819 052613
      *                                                                   LN0819
     C                     END                                            LN0819
     C                     END                                            LN0819
      *                                                                   LN0819
0448 C*    FOR C/L EVENTS MOVE RATE TO FIELD WITH 8 DEC.POSNS.
0449 C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP16                                           S01408
     C*                                                                   S01408
0450 C   05                Z-ADDEINR      EINRX  128
     C   15                Z-ADDINTR      EINRX
     C   19                Z-ADDRATE      EXRT                            S03220
0451 C*
0452 C*    TRANSLATE EVENT CODE TO NARRATIVE
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP3                                           S01408
      *                                                                   S01408
     C           ETYP      IFNE '    '                                    E20190
      *                                                                                       CLE028
      ** If CLE028 is on and event is for flat rate loans,                                    CLE028
      ** use arrays TABCD2 and TABNM2 so as to distinguish                                    CLE028
      ** event types '80M1' and '80M2' from that of TABCOD and TABNAM                         CLE028
      *                                                                                       CLE028
     C                     MOVELETYP      WVAR2   2                                           CLE028
     C                     MOVE *OFF      *IN27                                               CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN15     ANDEQ*ON                                                           CLE028
     C           WVAR2     ANDEQ'80'                                                          CLE028
     C           ETYP      LOKUPTABCD2    TABNM2         71                                   CLE028
     C                     MOVE *ON       *IN27                                               CLE028
     C                     ELSE                                                               CLE028
0453 C           ETYP      LOKUPTABCOD    TABNAM         71
     C                     ENDIF                                                              CLE028
     C                     END                                            E20190
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP4                                           S01408
      *                                                                   S01408
      ** Record retrieved is from file NOSEXGL                            CGL010
      *                                                                   CGL010
     C           CGL010    IFEQ 'Y'                                       CGL010
     C           ETYP      ANDEQ'ZZZZ'                                    CGL010
     C           *IN04     ANDEQ*ON                                       CGL010
     C                     MOVE *ON       *IN35                           CGL010
     C                     ELSE                                           CGL010
     C                     MOVE *OFF      *IN35                           CGL010
     C                     ENDIF                                          CGL010
      *                                                                                       CGL124
     C/COPY OFCPYSRCZ,CGL124_005                                                              CGL124
     C*                                                                   CSE007
     C**   IF THE INDICATOR 'DUE TO CORPORATE ACTION' SET TO 'Y'          CSE007
     C**   (FROM PF/NOSEXSE)                                              CSE007
     C*                                                                   CSE007
     C                     MOVE '0'       *IN73                           CSE007
     C*                                                                   CSE007
     C           *IN18     IFEQ '1'                                       CSE007
     C           COAF      ANDEQ'Y'                                       CSE007
     C*                                                                   CSE007
     C           ETYP      IFEQ '31P1'                                    CSE007
     C                     MOVE '1'       *IN73                           CSE007
     C                     MOVEL'C.A. PUR'CANARR 10                       CSE007
     C                     MOVE 'CH'      CANARR                          CSE007
     C                     ENDIF                                          CSE007
     C*                                                                   CSE007
     C           ETYP      IFEQ '31S1'                                    CSE007
     C                     MOVE '1'       *IN73                           CSE007
     C                     MOVEL'C.A. SAL'CANARR                          CSE007
     C                     MOVE 'E '      CANARR                          CSE007
     C                     ENDIF                                          CSE007
     C*                                                                   CSE007
     C           ETYP      IFEQ '39C1'                                    CSE007
     C           ETYP      OREQ '31C3'                                    CSE007
     C                     MOVE '1'       *IN73                           CSE007
     C                     MOVEL'CUST C.A'CANARR                          CSE007
     C                     MOVE '. '      CANARR                          CSE007
     C                     ENDIF                                          CSE007
     C*                                                                   CSE007
     C           ETYP      IFEQ '39D1'                                    CSE007
     C           ETYP      OREQ '31D3'                                    CSE007
     C                     MOVE '1'       *IN73                           CSE007
     C                     MOVEL'DEPOT C.'CANARR                          CSE007
     C                     MOVE 'A.'      CANARR                          CSE007
     C                     ENDIF                                          CSE007
     C                     ENDIF                                          CSE007
0454 C*
     C***
     C*****CUSTOMER*LENDING*COMMITMENT*FEE*EVENTS                   S01270
     C*                                                             S01270
     C*    Customer Lending Facility Fee Events                     S01270
     C*                                                             S01270
     C           ETYP      COMP '71F2'                   48
     C   48                MOVELLNRF      ZTYP    40                                          245212
     C   48                MOVE ZTYP      FTYP    30                                          245212
     C***48*****           MOVELLNRF      FTYP    30                                          245212
     C   48                MOVE LNRF      FSEQ    20
     C***
0455 C*****FOR*FX*EVENTS*PRINT*DEALT*BASE*CCY*RATE
0456 C*****FOR*FX*EVENTS*PRINT*DEALT*BASE*CCY*RATE*DEAL*EVENTS*ONLY*******090909
0457 C***********          SETOF                     47                   090909
0458 C                     MOVELETYP      ET12    2
0459 C***04******ET12      COMP '11'                     47               090909
0460 C**N47*04***ET12      COMP '12'                     47               090909
0461 C**N47*04***ET12      COMP '13'                     47               090909
0462 C**N47*04***ET12      COMP '14'                     47               090909
      ** Change the 'Event Type' description to 'ESTM INTRS' if                               CIR007
      ** either side of the deal is an OIS and the event record                               CIR007
      ** represent an interest event for an IRS deal (ETYP='22I1')                            CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
     C           ETYP      IFEQ '22I1'                                                        CIR007
     C                     MOVE *BLANKS   CANARR                                              CIR007
      ** Call program DL1660 to obtain deal information from deals file                       CIR007
      ** DEALSDG.                                                                             CIR007
     C                     CALL 'DL1660'                                                      CIR007
     C                     PARM DLNO      PDLNUM  60                                          CIR007
     C                     PARM 'N'       POIS    1                                           CIR007
     C                     PARM 'N'       PERR    1                                           CIR007
     C           PERR      IFEQ 'Y'                                                           CIR007
     C                     MOVE *ON       *INU7                                               CIR007
     C                     MOVE *ON       *INU8                                               CIR007
     C                     MOVE *ON       *INLR                                               CIR007
     C                     MOVEL'010'     DBASE                                               CIR007
     C                     MOVEL'DEALSDG' DBFILE    P                                         CIR007
     C                     MOVELPDLNUM    DBKEY     P                                         CIR007
     C                     ENDIF                                                              CIR007
      ** Returned code POIS is equal to Y if either OUR or THEIR side                         CIR007
      ** of the deal is an OIS.                                                               CIR007
     C           POIS      IFEQ 'Y'                                                           CIR007
     C                     MOVE *ON       *IN73                                               CIR007
     C                     MOVE WINEST    CANARR                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
0463 C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP30                                           S01408
     C*                                                                   S01408
     C**   SET INDICATOR TO SUPRESS PRINTING OF RATE IF NX                S01108
     C**N47 04   ET12      COMP '10'                     89         S01108S01119
     C**N47*04***ET12      IFEQ '10'                                S01119090909
     C      04   ET12      IFEQ '10'                                      090909
     C                     SETON                         89               S01119
     C                     END                                            S01119
     C*                                                                   S01176
     C*  FOR EVENT TYPES 31C5, 31D5, CHECK MATURITY DATE                  S01176
     C*  INDICATOR                                                        S01176
     C*                                                                   S01176
     C           ETYP      IFEQ '31C5'                                    S01176
     C           ETYP      OREQ '31D5'                                    S01176
     C*                                                                   S01176
     C*  IF MATURITY DATE INDICATOR = 'O', SET ON INDICATOR TO            S01176
     C*  OUTPUT '* OVERDUE *' ON REPORT                                   S01176
     C*  IF MATURITY DATE INDICATOR = 'A', SET ON INDICATOR TO            S01176
     C*  OUTPUT '* APPROXIMATE *' ON REPORT                               S01176
     C*                                                                   S01176
     C           MDTI      IFEQ 'O'                                       S01176
     C                     MOVE '1'       *IN65                           S01176
     C                     ELSE                                           S01176
     C                     MOVE '0'       *IN65                           S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C           MDTI      IFEQ 'A'                                       S01176
     C                     MOVE '1'       *IN66                           S01176
     C                     ELSE                                           S01176
     C                     MOVE '0'       *IN66                           S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C                     ELSE                                           S01176
     C                     MOVE '0'       *IN65                           S01176
     C                     MOVE '0'       *IN66                           S01176
     C                     END                                            S01176
     C***********                                                   LN0354BHF259
     C***IF*A*REQUIRED BRANCH, DETAILS TO REPORT AND LEVEL BREAK HASLN0354BHF259
     C***OCCURRED, OPEN DL0580P1                                    LN0354BHF259
     C************IN69     IFEQ '1'                                 LN0354BHF259
     C************IN61     ANDEQ'1'                                 LN0354BHF259
     C***********          CLOSEDL0580P1                            LN0354BHF259
     C***********          SETOF                     5569           LN0354BHF259
     C***********BRNCH     IFEQ 'ALL'                               LN0354BHF259
     C***********BRNCH     OREQ BRCA                                LN0354BHF259
     C***********          SETON                     55             LN0354BHF259
     C***********          SETON                     39             BHF276BHF259
     C***********          OPEN DL0580P1                            LN0354BHF259
      ***TRANSFER BINARY DATA INTO NUMERIC FIELD                    LN0354BHF259
     C***********          Z-ADDSFNUM     ZSNUM   60                LN0354BHF259
     C***********                                                   LN0354BHF259
     C***********          CALL 'ZSFILE'                            LN0354BHF259
     C***********          PARM           SEQ                       LN0354BHF259
     C***********          PARM BRCA      @PARM   3                 LN0354BHF259
     C***********          PARM           SFILE                     LN0354BHF259
     C***********          PARM           ZSNUM                     LN0354BHF259
     C***********          PARM *BLANK    ZSERR   1                 LN0354BHF259
     C***********                                                   LN0354BHF259
     C***********ZSERR     IFEQ 'Y'                                 LN0354BHF259
     C***********          SETON                     U7U8LR         LN0354BHF259
     C***********          RETRN                                    LN0354BHF259
     C***********          END                                      LN0354BHF259
     C***********                                                   LN0354BHF259
     C***********          Z-ADD0         PAGE                      LN0354BHF259
     C***********                                                   LN0354BHF259
     C***GET*BRANCH NAME                                            LN0354BHF259
     C***********                                                   LN0354BHF259
     C***********          CALL 'AOBRCHR0'                          LN0354BHF259
     C***********          PARM '*MSG   ' @RTCD   7                 LN0354BHF259
     C***********          PARM '*KEY   ' @OPTN   7                 LN0354BHF259
     C***********          PARM BRCA      @DSNB   3                 LN0354BHF259
     C***********SDBRCH    PARM SDBRCH    DSFDY                     LN0354BHF259
     C***********          END                                      LN0354BHF259
     C***********          END                                      LN0354BHF259
0463 C*
0464 C*    ACCUMULATE NUMBER AND VALUE OF NOSEV RECORDS REPORTED
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP1                                           S01408
      *                                                                   S01408
     C           *IN55     IFEQ '1'                                       S01117
     C*                                                                   052613
     C** Set on *IN23 - do not print 'No Details etc.' on GL0580AU       052613
     C*                                                                   052613
     C                     MOVEL'1'       *IN23                           052613
0465 C           NSVLIS    ADD  1         NSVLIS  50
0466 C           EAMT      DIV  1000      ZZAMT        34
0467 C                     Z-ADD3         I
0468 C                     EXSR HASH
     C                     END                                            S01117
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0580CCP2                                           S01408
      *                                                                   S01408
0469 C*
0470 C*    CONVERT EVENT DATE TO ALPHAMERIC FORMAT
0471 C                     MOVE EDAT      ZDAYNO
0472 C                     EXSR ZDATE2
0473 C*
0474 C*    IF EVENT DATE NOT EQUAL TO LAST DATE OUTPUT, NOT FIRST DATE FOR
0475 C*    NOSTRO, PRINT BALANCE AT CHANGE OF DATE
0476 C   53      ZADATE    COMP EDATA                5252
     C/COPY WNCPYSRC,GL0580C004
0477 C***53*52             EXCPT                                          LN0730
0477 C   53 52             EXCPT@BALIN                                    LNO730
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP10                                           S01408
     C*                                                                   S01408
0478 C                     MOVE ZADATE    EDATA   7
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP19                                           S01408
     C*                                                                   S01408
0479 C*
0480 C*    UPDATE BALANCE FOR REPORTING
0481 C   45      NOBL      ADD  EAMT      NOBL
0482 C   46      NOBL      SUB  EAMT      NOBL
     C/COPY WNCPYSRC,GL0580C005
0483 C*    FIRST EVENT FOR NOSTRO
0484 C***70*******         SETON                     53                   E27024
0484 C   70                SETON                     5377                 E27024
     C*                                                                   052613
     C*********************END                                      052613080723
     C*                                                                   052613
0485 C           NOTREP    TAG                             ** NOTREP TAG *
0486 C                     GOTO END
0487 C           TRAIL     TAG                             ** TRAIL TAG **
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP31                                           S01408
     C*                                                                   S01408
0488 C  N02                GOTO TAG05
0489 C*    PROCESS PRONT TRAILER
0490 C                     SETON                     81
0491 C           NORE      SUB  2         NORE
0492 C           NORE      COMP PTREC                7575
0493 C           TAG05     TAG                             ** TAG05 TAG **
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP32                                           S01408
     C*                                                                   S01408
0494 C  N06                GOTO END
0495 C*    PROCESS NOSEV TRAILER
0496 C                     SETON                     82
0497 C           NOREN     SUB  2         NOREN
0498 C           NOREN     COMP NSVRED               7676
0499 C  N76      INT,2     COMP HRWN                 7676
0500 C  N76      DEC,2     COMP HRDC                 7676
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP33                                           S01408
     C*                                                                   S01408
0501 C   75
0502 COR 76                SETON                     U8
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0580CP25                                           S01408
     C*                                                                   S01408
0503 C           END       TAG
     C*                                                                   S01129
      ** If Leo records are being processed, and a Leo record has been    S01473
      ** read, seton *IN16 for output                                     S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULDET     ANDEQ'Y'                                       S01473
     C                     SETON                       16                 S01473
      *                                                                   S01473
      ** Reset value of LEO record read flag for next cycle               S01473
     C                     MOVE *BLANK    ULDET                           S01473
     C                     MOVE *BLANKS   NRTD                            151088
     C                     ELSE                                           S01473
     C                     SETOF                       16                 S01473
     C                     END                                            S01473
      *                                                                   S01473
     C                     MOVE *BLANKS   PDLNO   6                       S01129
     C           DLNO      IFNE 0                                         S01129
     C                     MOVE DLNO      PDLNO                           S01129
     C                     END                                            S01129
0504 C*
0505 C*    T O T A L   T I M E   C A L C S
0506 C*
0507 C*    FIND VALUE OF PRONO RECORD CREATED
0508 C*
0509 CL1 60                XFOOTCBAL      VALPRO 150
     C/COPY WNCPYSRC,GL0580C019
0510 CL1 60      VALPRO    DIV  1000      ZZAMT        34
0511 CL1 60                Z-ADD4         I
0512 CL1 60                EXSR HASH
0513 CL1 60      RECRIT    ADD  1         RECRIT  50
0514 C*
0515 C*    MOVE BALANCE INTO SMALLER FIELD FOR OUTPUT
0516 CL1                   MOVE NOBL      NOBL14 140
0517 CL1                   Z-ADD0         NOBL
     C/COPY WNCPYSRC,GL0580C006
     C**************                                                052613068596
     C***On*change*of branch, print close of report for previous bra052613068596
     C**************                                                052613068596
     C***L3*69******       EXCPT@EOBLN                              052613068596
     C***L3*69******       CLOSEGL0580P1                            052613068596
     C***L3*69******       SETOF                     556925         052613068596
     C**************                                                052613068596
     C**DO*NOT*UPDATE*D/DLSTAT*WITH*CHANGED*'99'*IF*IT*WAS*NOT*SET*BEFORE*036796
     C*LR*54********       MOVE '  '      DYSA                            036796
     C*
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM *BLANK    ZSERR                           S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
0323 C/EJECT
0518 C********************************************************************
0519 C*
0520 C           HASH      BEGSR
0521 C   34                Z-SUBZZAMT     ZZAMT
0522 C                     MOVE INT,I     ZZTOTI
0523 C                     MOVE DEC,I     ZZTOTD
0524 C                     EXSR GLZADD
0525 C                     MOVE ZZTOTI    INT,I
0526 C                     MOVE ZZTOTD    DEC,I
0527 C                     ENDSR
0528 C********************************************************************
0323 C/EJECT
0529 C**
0530 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0531 C**
0532 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0533 C**
0534 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0535 C**
0536 C**   CLEAR DATE FIELDS.
0537 C                     Z-ADD0         ZDATE   60
0538 C                     MOVEL'       ' ZADATE  7
0539 C**
0540 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0541 C                     Z-ADDZDAYNO    ZDAYNO  50
0542 C**
0543 C**   DETERMINE YEAR NUMBER.
0544 C**
0545 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0546 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0547 C   99                GOTO ZDEND2
0548 C**
0549 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0550 C           ZDAYN1    DIV  1461      ZLYR    20
0551 C                     MVR            ZDAYN1           SAVE REMAINING
0552 C**                                                   DAYS
0553 C**   CALCULATE NUMBER OF REMAINING YEARS.
0554 C                     Z-ADD1         ZWRK2   20
0555 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0556 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0557 C  N90      ZWRK2     ADD  1         ZWRK2
0558 C  N90                GOTO ZDTAG1
0559 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0560 C**
0561 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0562 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0563 C**
0564 C**   CALCULATE ACTUAL YEAR NUMBER.
0565 C           ZLYR      MULT 4         ZWRK3   30
0566 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0567 C                     Z-ADDZWRK3     ZYEAR   20
0568 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0569 C**
0570 C**   DETERMINE MONTH NUMBER.
0571 C**
0572 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0573 C                     SETOF                     9293
0574 C   91      ZDAYN1    COMP 59                     9293
0575 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0576 C**
0577 C**   CALCULATE MONTH NUMBER.
0578 C                     Z-ADD2         ZWRK2
0579 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0580 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0581 C  N94      ZWRK2     ADD  1         ZWRK2
0582 C  N94                GOTO ZDTAG2
0583 C           ZWRK2     SUB  1         ZWRK2
0584 C**
0585 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0586 C**
0587 C**   DETERMINE DAY OF MONTH.
0588 C**
0589 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0590 C           ZDAYN1    ADD  1         ZDAYN1
0591 C**
0592 C**   CALCULATE DAY OF MONTH.
0593 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0594 C**
0595 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0596 C   93      ZDAY      ADD  1         ZDAY
0597 C**
0598 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0829 C**   I.E. IND 98 ON IF DATE FORMAT IND = 'M'                        S01194
0829 C           BJDFIN    COMP 'M'                      98               S01194
0599 C  N98                MOVELZDAY      ZWRK4   40
0600 C   98                MOVE ZDAY      ZWRK4
0601 C  N98                MOVE ZMTH      ZWRK4
0602 C   98                MOVELZMTH      ZWRK4
0603 C                     MOVELZWRK4     ZDATE
0604 C                     MOVE ZYEAR     ZDATE
0605 C**
0606 C**   FORMAT ALPHA DATE, DDMMMYY.
0607 C           ZDAY      COMP 10                     95
0608 C                     MOVELZDAY      ZWRK5   5
0609 C   95                MOVEL' '       ZWRK5
0610 C                     MOVE ZMNM,ZMTH ZWRK5
0611 C                     MOVELZWRK5     ZADATE
0612 C                     MOVE ZYEAR     ZADATE
0613 C**
0614 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0615 C**
0616 C*****************************************************************   S01195
0617 C*****                                                       *****   S01195
0618 C*****ZDATE3 SR. TO CALCULATE ANY NUMBER OF WORKING          *****   S01195
0619 C*****           DAYS FORWARD IN ANY CURRENCY.               *****   S01195
0620 C*****                                                       *****   S01195
0621 C*****    THIS SR. CAN BE USED WHEN THE INPUT CYCLE IS RUNNING*AS*   S01195
0622 C*****    HOLIDAY RECORDS ARE ACCESSED BY CHAIN. THEREFORE NEWLY**   S01195
0623 C*****    ADDED RECORDS IN THE OVERFLOW AREA CAN ALSO BE ACCESSED*   S01195
0624 C*****                                                       *****   S01195
0625 C*****      ZDATE3    BEGSR                           *** ZDATE3**** S01195
0626 C*****                                                       *****   S01195
0627 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                   *****   S01195
0628 C*****                Z-ADDZDAYNO    ZDAYNO  50       STARTING*DATE  S01195
0629 C*****                MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
0630 C*****                Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
0631 C*****                                                DAYS FORWARD   S01195
0632 C*****CLEAR COUNT OF NBR OF DAYS ADDED, & DEFINE ZDYNBR.     *****   S01195
0633 C*****                Z-ADD0         ZDCNT   20              *****   S01195
0634 C*****                Z-ADDZDAYNO    ZDYNBR  50              *****   S01195
0635 C*****                                                       *****   S01195
0636 C*****LOOP TO INCREMENT DAY NUMBER AND CHECK FOR HOLIDAY.    *****   S01195
0637 C*****      ZDLOP1    TAG                             ** ZDLOP1*TAG *S01195
0638 C*****                                                       *****   S01195
0639 C*****                SETOF                     9596         *****   S01195
0640 C*****      ZDYNBR    ADD  1         ZDYNBR                  *****   S01195
0641 C*****                                                       *****   S01195
0642 C*****SET KEY FOR FIRST HOLIDAY RECORD.                      *****   S01195
0643 C*****                MOVEL'22    '  ZDHKEY 12               *****   S01195
0644 C*****                MOVELZDYNBR    ZWRK6   6               *****   S01195
0645 C*****                MOVE '1'       ZWRK6                   *****   S01195
0646 C*****                MOVE ZWRK6     ZDHKEY                  *****   S01195
0647 C*****                                                       *****   S01195
0648 C*****CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2                *****   S01195
0649 C*****      ZDHCHN    TAG                             ** ZDHCHN*TAG  S01195
0650 C*****                                                       *****   S01195
0651 C*****      ZDHKEY    CHAINTABLE                90    ON NOT THERE   S01195
0652 C*****      RECI      COMP 'D'                  9090  DELETED*****   S01195
0653 C*****                                                       *****   S01195
0654 C*****NO RECORD 1 FOUND, IS NOT A HOLIDAY                    *****   S01195
0655 C*****N95             GOTO ZDOAGN                            *****   S01195
0656 C*****                                                       *****   S01195
0657 C*****NO RECORD 2 FOUND                                      *****   S01195
0658 C***** 95 96          GOTO ZDLOP1                     EXC. NOT*FOUND S01195
0659 C***** 95N96          GOTO ZDOAGN                     INC. NOT*FOUND S01195
0660 C*****                                                       *****   S01195
0661 C*****DETERMINE TYPE FOUND, INCLUDE OR EXCLUDE               *****   S01195
0662 C*****      INEX      COMP 'E'                  92  91       *****   S01195
0663 C*****                                                       *****   S01195
0664 C*****CHECK IF DAY IS HOLIDAY FOR CURRENCY.                  *****   S01195
0665 C*****      ZCCY      LOKUPHCCY                     93       *****   S01195
0666 C***** 93             GOTO ZDOAGN                     EXCLUDE*FOUND  S01195
0667 C***** 93             GOTO ZDLOP1                     INCLUDE*FOUND  S01195
0668 C*****                                                       *****   S01195
0669 C*****IF EXCLUDE OR INCLUDE NOT FOUND CHECK                  *****   S01195
0670 C*****FOR SECOND HOLIDAY RECORD, IF REQUIRED.                *****   S01195
0671 C*****      '   '     LOKUPHCCY                     94ON IF NO*RCD.2 S01195
0672 C*****                MOVE ZDHKEY    ZWRK1   1               *****   S01195
0673 C*****      ZWRK1     COMP '1'                      95       *****   S01195
0674 C***** 95             SETON                     96           *****   S01195
0675 C*****N94             MOVE '2'       ZDHKEY                  *****   S01195
0676 C*****N94             GOTO ZDHCHN                     GET SECOND*REC S01195
0677 C*****                                                       *****   S01195
0678 C*****                GOTO ZDLOP1                     EXC. NOT*FOUND S01195
0679 C*****                GOTO ZDOAGN                     INC. NOT*FOUND S01195
0680 C*****                                                       *****   S01195
0681 C*****INCREMENT COUNT AND CHECK IF REQUIRED NUMBER OF DAYS   *****   S01195
0682 C*****HAVE BEEN ADDED. IF NOT, GO THROUGH LOOP1 AGAIN.       *****   S01195
0683 C*****      ZDOAGN    TAG                             ** ZDOAGN*TAG *S01195
0684 C*****                                                       *****   S01195
0685 C*****      ZDCNT     ADD  1         ZDCNT                   *****   S01195
0686 C*****      ZDCNT     COMP ZNRDYS                 97         *****   S01195
0687 C*****                GOTO ZDLOP1                            *****   S01195
0688 C*****                                                       *****   S01195
0689 C*****                ENDSR                                  *****   S01195
0690 C*****                                                       *****   S01195
0691 C*****************************************************************   S01195
0323 C/EJECT
0692 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0693 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0694 C*
0695 CSR         GLZADD    BEGSR                           *** GLZADD ****
0696 C*
0697 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0698 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0699 C*
0700 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0701 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0702 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0703 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0704 C*
0705 CSR                   EXSR GLZSUM
0706 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0707 C*
0708 C********************************************************************
0323 C/EJECT
0709 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0710 C*                        GLZADD, GLZSUB, GLZCMP.
0711 C*          PARAMETERS PASSED -
0712 C*                     I/P ZZAMTI ZZAMTD
0713 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0714 C*
0715 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0716 C*
0717 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0718 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0719 CSR                   SETOF                     919293
0720 CSR                   SETOF                     949599
0721 C*
0722 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0723 CSR         ZZAMTI    COMP 0                      9293
0724 CSR 93      ZZAMTD    COMP 0                      9293
0725 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0726 C*
0727 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0728 CSR         ZZTOTI    COMP 0                      9193
0729 CSR 93      ZZTOTD    COMP 0                      9193
0730 C*
0731 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0732 CSR 93                Z-ADDZZAMTI    ZZTOTI
0733 CSR 93                Z-ADDZZAMTD    ZZTOTD
0734 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0735 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0736 CSR 91N92
0737 CORN91 92             GOTO ZZOFPS
0738 C*
0739 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0740 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0741 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0742 C*
0743 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0744 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0745 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0746 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0747 C*
0748 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0749 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0750 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0751 CSRN99                Z-ADDZZWK2     ZZTOTD
0752 CSRN99                Z-ADDZZWK3     ZZTOTI
0753 C*
0754 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0755 CSR 99                Z-ADD0         ZZAMT  153
0756 CSR                   GOTO ZZSEND
0757 C*
0758 C* THE 'SIGNS' ARE DIFFERENT
0759 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0760 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0761 C*
0762 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0763 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0764 C*
0765 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0766 C*
0767 CSR 91                Z-SUBZZTOTI    ZZTOTI
0768 CSR 91                Z-SUBZZTOTD    ZZTOTD
0769 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0770 C*
0771 CSR         ZZTOTI    COMP ZZAMTI               93  95
0772 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0773 C*
0774 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0775 CSR 95                Z-ADD0         ZZTOTI
0776 CSR 95                Z-ADD0         ZZTOTD
0777 CSR 95                GOTO ZZSEND
0778 C*
0779 C* IF ZZTOT GT. ZZAMT.
0780 CSR 93      ZZAMTD    COMP ZZTOTD               94
0781 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0782 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0783 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0784 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0785 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0786 C*
0787 C*
0788 C* IF ZZAMT GT. ZZTOT.
0789 CSRN93      ZZTOTD    COMP ZZAMTD               94
0790 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0791 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0792 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0793 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0794 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0795 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0796 C*
0797 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0798 CSR                   SETOF                     94
0799 CSR 93 91
0800 CORN93 92             SETON                     94
0801 CSR 94                Z-SUBZZTOTI    ZZTOTI
0802 CSR 94                Z-SUBZZTOTD    ZZTOTD
0803 C**
0804 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0805 CSR 92                Z-SUBZZAMTI    ZZAMTI
0806 CSR 92                Z-SUBZZAMTD    ZZAMTD
0807 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0808 C**
0809 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0810 CSR                   SETOF                     96
0811 CSR         ZZTOTD    COMP 0                        91
0812 CSR 91      ZZTOTI    COMP 0                      96
0813 CSR 96                MOVE '.000-'   ZZNEGD  5
0814 CSR                   ENDSR                             ** ENDSR **
0815 C*****************************************************************   S01194
0323 C/EJECT
0816 C**                                                          *****   S01194
0817 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RE*****   S01194
0818 C*****                                                       *****   S01194
0819 C*****      ZSYSTM    BEGSR                           *** ZSY*****   S01194
0820 C*****                                                       *****   S01194
0821 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.            *****   S01194
0822 C*****                MOVEL'01      'ZTABKY 12               *****   S01194
0823 C*****                MOVE '  10'    ZTABKY                  *****   S01194
0824 C*****                                                       *****   S01194
0825 C*****      ZTABKY    CHAINTABLE                99    ON NOT *****   S01194
0826 C*****      RECI      COMP 'D'                  9999  ON, IS *****   S01194
0827 C*****                                                       *****   S01194
0828 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
0829 C*****      DATF      COMP 'M'                      98MMDDYY,*****   S01194
0830 C*****                                                       *****   S01194
0831 C*****                ENDSR                                  *****   S01194
0832 C*****                                                       *****   S01194
0833 C*****                                                       *****   S01194
0834 C*****************************************************************   S01194
      /EJECT                                                                                  237466
      *****************************************************************                       237466
      *                                                               *                       237466
      *  SRRPAD - Subroutine to get Repayment base date to reflect    *                       237466
      *           actual Event Date.                                  *                       237466
      *                                                               *                       237466
      *****************************************************************                       237466
     C           SRRPAD    BEGSR                                                              237466
      *                                                                                       237466
     C                     Z-ADD999       LASN                                                237466
     C           KLOAN     KLIST                                                              237466
     C                     KFLD           LNRF                                                237466
     C                     KFLD           ETP                                                 237466
     C                     KFLD           EDAT                                                237466
     C           KLOAN     CHAINLVENTELF             80                                       237466
      *                                                                                       237466
      ** Key list for CLOANCL of CLOAN.                                                       237466
      *                                                                                       237466
     C           KLNRF     KLIST                                                              237466
     C                     KFLD           LNRF                                                237466
     C                     KFLD           KRTP    1                                           237466
     C                     MOVE 'A'       KRTP                                                237466
     C           KLNRF     CHAINCLOANCLF             80                                       237466
      *                                                                                       237466
     C           *IN80     IFEQ '0'                                                           237466
     C           LASN      ANDEQ0                                                             237466
      *                                                                                       237466
      ** Check if repayment event date was obtaind from base date.                            237466
      *                                                                                       237466
     C           CLE005    IFEQ 'Y'                                                           237466
     C                     Z-ADD0         ZNRDYS                                              237466
     C                     Z-ADD0         WEDAT   50                                          237466
     C                     EXSR SRSCUR                                                        237466
     C                     EXSR MATLOC                                                        237466
     C                     MOVE ZCCY      ZCCY3   3                                           237466
     C                     MOVE ZLOC      ZLOC3   3                                           237466
     C                     MOVE ZCCY2     ZCCY                                                237466
     C                     MOVE W@MDSL    ZLOC                                                237466
     C           ETP       IFEQ 'I2'                                                          237466
     C                     Z-ADDMIBDT     WEDAT                                               237466
     C                     ENDIF                                                              237466
     C           ETP       IFEQ 'M1'                                                          237466
     C           ETP       OREQ 'M2'                                                          237466
     C                     Z-ADDMMDAT     WEDAT                                               237466
     C                     ENDIF                                                              237466
     C           ETP       IFEQ 'R1'                                                          237466
     C           ETP       OREQ 'R2'                                                          237466
     C                     Z-ADDMRBDT     WEDAT                                               237466
     C                     ENDIF                                                              237466
     C                     Z-ADDWEDAT     ZDAYNO                                              237466
      *                                                                                     MD054101
     C           CLE141    IFEQ 'Y'                                                         MD054101
     C                     MOVELPTDI      PAYIND                                            MD054101
     C                     CALL 'LEZBDYCD'BDCHK                                             MD054101
     C                     MOVELZADJDT    ZDYNBR                                            MD054101
     C                     ELSE                                                             MD054101
     C                     SELEC                                                              237466
     C           PTDI      WHEQ 'P'                                                           237466
     C                     EXSR ZBKDT                                                         237466
     C           PTDI      WHEQ 'N'                                                           237466
     C                     EXSR ZFWDT                                                         237466
     C           PTDI      WHEQ 'M'                                                           237466
     C           PTDI      OREQ *BLANK                                                        237466
     C                     EXSR ZDATE2                                                        237466
     C           *IN98     IFEQ *OFF                                                          237466
     C                     MOVE ZDATE     MMYY    40P                                         237466
     C                     MOVELMMYY      MMNLCD  20P                                         237466
     C                     ELSE                                                               237466
     C                     MOVELZDATE     MMNLCD    P                                         237466
     C                     ENDIF                                                              237466
     C                     Z-ADDZDAYNO    @DAYNO  50                                          237466
     C                     EXSR ZFWDT                                                         237466
     C                     Z-ADDZDYNBR    ZDAYNO                                              237466
     C                     EXSR ZDATE2                                                        237466
     C           *IN98     IFEQ *OFF                                                          237466
     C                     MOVE ZDATE     MMYY      P                                         237466
     C                     MOVELMMYY      MMNWKD  20P                                         237466
     C                     ELSE                                                               237466
     C                     MOVELZDATE     MMNWKD    P                                         237466
     C                     ENDIF                                                              237466
     C           MMNLCD    IFNE MMNWKD                                                        237466
     C                     Z-ADD@DAYNO    ZDAYNO                                              237466
     C                     EXSR ZBKDT                                                         237466
     C                     ENDIF                                                              237466
     C                     ENDSL                                                              237466
     C                     ENDIF                                                            MD054101
      *                                                                                     MD054101
     C                     Z-ADDZDYNBR    WEDAT                                               237466
     C                     MOVE ZCCY3     ZCCY                                                237466
     C                     MOVE ZLOC3     ZLOC                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If event type is I2.                                                                 237466
      *                                                                                       237466
     C           ETP       IFEQ 'I2'                                                          237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C                     Z-ADDMNIDT     EDAT                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If event type is M1 or  M2.                                                          237466
      *                                                                                       237466
     C           ETP       IFEQ 'M1'                                                          237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C           ETP       OREQ 'M2'                                                          237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C                     Z-ADDMMDAT     EDAT                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If event type is R1 or  R2.                                                          237466
      *                                                                                       237466
     C           ETP       IFEQ 'R1'                                                          237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C           ETP       OREQ 'R2'                                                          237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C                     Z-ADDMNRPD     EDAT                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDSR                                                              237466
      *****************************************************************                       237466
      *                                                               *                       237466
      *  SRSCUR - Subroutine to set correct currency depeding on the  *                       237466
      *           settlement type.                                    *                       237466
      *                                                               *                       237466
      *  Called By: SRRPAD - get Repayment base date to reflect       *                       237466
      *                      actual Event Date.                       *                       237466
      *****************************************************************                       237466
      *                                                                                       237466
     C           SRSCUR    BEGSR                                                              237466
      *                                                                                       237466
     C           MDST      IFEQ 01                                                            237466
     C           MDST      OREQ 07                                                            237466
     C           MDST      OREQ 08                                                            237466
     C           MDST      OREQ 02                                                            237466
     C           MDST      OREQ 12                                                            237466
     C                     MOVE MCCY      ZCCY2   3                                           237466
     C                     ELSE                                                               237466
     C                     MOVE BJLCCY    ZCCY2                                               237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If feature CEU004 is on, use settlement currency                                     237466
      ** if Settlement currency from the LOAN is not blank.                                   237466
      *                                                                                       237466
     C           CEU004    IFEQ 'Y'                                                           237466
     C           SCCY      ANDNE*BLANKS                                                       237466
     C                     MOVE SCCY      ZCCY2                                               237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDSR                                                              237466
      /EJECT                                                                                  237466
      *****************************************************************                       237466
      *                                                               *                       237466
      *  MATLOC - Subroutine to get maturity location                 *                       237466
      *                                                               *                       237466
      *  Called By: SRRPAD - get Repayment base date to reflect       *                       237466
      *                      actual Event Date.                       *                       237466
      *****************************************************************                       237466
     C           MATLOC    BEGSR                                                              237466
      *                                                                                       237466
     C           *LIKE     DEFN NRLC      W@MDSL                                              237466
     C                     MOVE *BLANKS   W@MDSL                                              237466
      *                                                                                       237466
      ** For Type 01,02,07,08 OR 12, settlement location is determined                        237466
      ** by the nostro branch.                                                                237466
      *                                                                                       237466
     C           MDST      IFEQ 01                                                            237466
     C           MDST      OREQ 02                                                            237466
     C           MDST      OREQ 07                                                            237466
     C           MDST      OREQ 08                                                            237466
     C           MDST      OREQ 12                                                            237466
      *                                                                                       237466
     C                     MOVELOMDA      SNOS    2                                           237466
      *                                                                                       237466
      ** If feature CEU004 is on                                                              237466
      ** If Settlement currency for EMU non-blank, set the Nostro Cccy                        237466
      *                                                                                       237466
     C                     MOVE MCCY      @KEYB                                               237466
      *                                                                                       237466
     C           CEU004    IFEQ 'Y'                                                           237466
      *                                                                                       237466
     C           SCCY      IFNE *BLANKS                                                       237466
     C                     MOVE SCCY      @KEYB                                               237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     CALL 'AONOSTR0'                                                    237466
     C                     PARM '*MSG   ' @RTCD   7                                           237466
     C                     PARM '*KEY   ' @OPTN   7                                           237466
     C                     PARM *BLANKS   @KEYA   6                                           237466
     C                     PARM           @KEYB   3                                           237466
     C                     PARM *BLANKS   @KEYC   4                                           237466
     C                     PARM *BLANKS   @KEYD   2                                           237466
     C                     PARM SNOS      @KEYEE  2                                           237466
     C                     PARM *BLANKS   @KEYF   3                                           237466
     C                     PARM *BLANKS   @KEYG  10                                           237466
     C                     PARM *BLANKS   @KEYH   1                                           237466
     C           SDNOST    PARM SDNOST    DSFDY                                               237466
      *                                                                                       237466
     C           @RTCD     IFEQ *BLANKS                                                       237466
      *                                                                                       237466
      **                                                                                      237466
      ** Move the last 3 characters of customer short code (which is                          237466
      ** the location code) to start location code field                                      237466
      **                                                                                      237466
      *                                                                                       237466
     C                     MOVE A7NOSN    DSCSNM                                              237466
     C                     MOVE NRLC      W@MDSL                                              237466
     C                     END                                                                237466
      *                                                                                       237466
     C                     END                                                                237466
     C                     ENDSR                                                              237466
      *****************************************************************                     MD052216
      /EJECT                                                                                MD052216
      *****************************************************************                     MD052216
      *                                                                                     MD052216
      *  SRFPAD - Subroutine to get Fee Payment Base Date to reflect                        MD052216
      *           actual Event Date                                                         MD052216
      *                                                                                     MD052216
      *  CALLED FROM: Main Processing                                                       MD052216
      *                                                                                     MD052216
      *  CALLS: CCYLOC                                                                      MD052216
      *                                                                                     MD052216
      *****************************************************************                     MD052216
     C           SRFPAD    BEGSR                                                            MD052216
      *                                                                                     MD052216
      ** Key list for Fee Main and Extension File                                           MD052216
      *                                                                                     MD052216
     C           KFEE      KLIST                                                            MD052216
     C                     KFLD           CNUM                                              MD052216
     C                     KFLD           WFACL                                             MD052216
     C                     KFLD           WLNRF                                             MD052216
     C                     KFLD           WFSEQ                                             MD052216
      *                                                                                     MD052216
     C           ETYP      IFEQ '71F2'                                                      MD052216
     C           ETYP      OREQ '71FY'                                                      MD053950
     C                     MOVE LNRF      WFACL   50                                        MD052216
     C                     MOVEL*BLANKS   WLNRF   6                                         MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C           ETYP      IFEQ '71F1'                                                      MD052216
     C           ETYP      OREQ '71FX'                                                      MD053950
     C                     Z-ADD*ZEROS    WFACL                                             MD052216
     C                     MOVELLNRF      WLNRF                                             MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     MOVE CFSEQ     WFSEQ   20                                        MD052216
     C           KFEE      CHAINLEFEEDL0             83                                     MD052216
     C           *IN83     IFEQ *OFF                                                        MD052216
     C           KFEE      CHAINLEFEEXQD             83                                     MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C           *IN83     IFEQ *OFF                                                        MD052216
     C           FECALT    ANDNE*BLANKS                                                     MD052216
      *                                                                                     MD052216
      ** Set fee payment date                                                               MD052216
      *                                                                                     MD052216
     C           FELPDT    IFGT BJRDNB                                                      MD052216
     C                     Z-ADDFELPDT    WENPYD  50                                        MD052216
     C                     ELSE                                                             MD052216
     C                     Z-ADDFENPYD    WENPYD                                            MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C           WENPYD    IFEQ *ZEROS                                                      MD052216
     C                     Z-ADDFEPEND    WENPYD                                            MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     Z-ADDFQFPBD    WEDAT                                             MD052216
     C                     MOVE ZCCY      ZCCY3                                             MD052216
     C                     MOVE ZLOC      ZLOC3                                             MD052216
     C                     EXSR CCYLOC                                                      MD052216
     C                     Z-ADDWEDAT     ZDAYNO                                            MD052216
     C                     Z-ADDWEDAT     ZDYNBR                                            MD052216
     C                     Z-ADD*ZEROS    ZNRDYS                                            MD052216
      *                                                                                     MD054101
     C           CLE141    IFEQ 'Y'                                                         MD054101
     C           FELOAN    ANDNE*BLANKS                                                     MD054101
      *                                                                                     MD054101
     C           FELOAN    CHAINCLOANCLF             97                                     MD054101
     C           FQPTDI    IFEQ *BLANK                                                      MD054101
     C                     MOVEL'M'       PAYIND                                            MD054101
     C                     ELSE                                                             MD054101
     C                     MOVELFQPTDI    PAYIND                                            MD054101
     C                     ENDIF                                                            MD054101
     C                     CALL 'LEZBDYCD'BDCHK                                             MD054101
     C                     MOVELZADJDT    ZDYNBR                                            MD054101
      *                                                                                     MD054101
     C                     ELSE                                                             MD054101
     C                     SELEC                                                            MD052216
      *                                                                                     MD052216
     C           FQPTDI    WHEQ 'P'                                                         MD052216
     C                     EXSR ZBKDT                                                       MD052216
      *                                                                                     MD052216
     C           FQPTDI    WHEQ 'N'                                                         MD052216
     C                     EXSR ZFWDT                                                       MD052216
      *                                                                                     MD052216
     C           FQPTDI    WHEQ 'M'                                                         MD052216
     C           FQPTDI    OREQ *BLANK                                                      MD052216
     C                     EXSR ZDATE2                                                      MD052216
     C           *IN98     IFEQ *OFF                                                        MD052216
     C                     MOVE ZDATE     MMYY      P                                       MD052216
     C                     MOVELMMYY      MMNLCD    P                                       MD052216
     C                     ELSE                                                             MD052216
     C                     MOVELZDATE     MMNLCD    P                                       MD052216
     C                     ENDIF                                                            MD052216
     C                     Z-ADDZDAYNO    @DAYNO                                            MD052216
     C                     EXSR ZFWDT                                                       MD052216
     C                     Z-ADDZDYNBR    ZDAYNO                                            MD052216
     C                     EXSR ZDATE2                                                      MD052216
     C           *IN98     IFEQ *OFF                                                        MD052216
     C                     MOVE ZDATE     MMYY      P                                       MD052216
     C                     MOVELMMYY      MMNWKD    P                                       MD052216
     C                     ELSE                                                             MD052216
     C                     MOVELZDATE     MMNWKD    P                                       MD052216
     C                     ENDIF                                                            MD052216
     C           MMNLCD    IFNE MMNWKD                                                      MD052216
     C                     Z-ADD@DAYNO    ZDAYNO                                            MD052216
     C                     EXSR ZBKDT                                                       MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ENDSL                                                            MD052216
     C                     ENDIF                                                            MD054101
      *                                                                                     MD054101
     C                     Z-ADDZDYNBR    WEDAT                                             MD052216
      *                                                                                     MD052216
     C           WEDAT     IFEQ EDAT                                                        MD052216
     C                     Z-ADDWENPYD    EDAT                                              MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     MOVE ZCCY3     ZCCY                                              MD052216
     C                     MOVE ZLOC3     ZLOC                                              MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ENDSR                                                            MD052216
      *****************************************************************                     MD052216
      /EJECT                                                                                MD052216
      *****************************************************************                     MD052216
      *                                                                                     MD052216
      *  CCYLOC - Set currency & location depending on settlement type                      MD052216
      *                                                                                     MD052216
      *  CALLED FROM: SRFPAD                                                                MD052216
      *                                                                                     MD052216
      *  CALLS:                                                                             MD052216
      *                                                                                     MD052216
      *****************************************************************                     MD052216
     C           CCYLOC    BEGSR                                                            MD052216
      *                                                                                     MD052216
      ** If Fee Settlement type is '01', '02', '07', '08' or '12',                          MD052216
      ** use Fee Currency and Nostro location                                               MD052216
      *                                                                                     MD052216
     C           FESTTL    IFEQ 01                                                          MD052216
     C           FESTTL    OREQ 02                                                          MD052216
     C           FESTTL    OREQ 07                                                          MD052216
     C           FESTTL    OREQ 08                                                          MD052216
     C           FESTTL    OREQ 12                                                          MD052216
      *                                                                                     MD052216
     C                     MOVELFEFCCY    PCURR                                             MD053873
      *                                                                                     MD053873
     C           CLE031    IFEQ 'Y'                                                         MD053873
      *                                                                                     MD053873
     C           PTFI      IFEQ *BLANKS                                                     MD053873
     C           FESCCY    ANDNE*BLANKS                                                     MD053873
     C                     MOVELFESCCY    PCURR                                             MD053873
     C                     ENDIF                                                            MD053873
      *                                                                                     MD053873
     C           PTFI      IFNE *BLANKS                                                     MD053873
     C           FEPSCY    ANDNE*BLANKS                                                     MD053873
     C                     MOVELFEPSCY    PCURR                                             MD053873
     C                     ENDIF                                                            MD053873
      *                                                                                     MD053873
     C                     ENDIF                                                            MD053873
      *                                                                                     MD053873
     C                     CALL 'AONOSTR0'                                                  MD052216
     C                     PARM *BLANKS   PRTCD   7                                         MD052216
     C                     PARM '*KEY   ' POPTN   7                                         MD052216
     C                     PARM *BLANKS   PCUSN   6                                         MD052216
     C**********           PARM FEFCCY    PCURR   3                                MD052216 MD053873
     C                     PARM           PCURR   3                                         MD053873
     C                     PARM *BLANKS   PACCD  10                                         MD052216
     C                     PARM *BLANKS   PACSN   2                                         MD052216
     C                     PARM FEOURS    PNONB   2                                         MD052216
     C                     PARM *BLANKS   PBRCA   3                                         MD052216
     C                     PARM *BLANKS   PCSSN  10                                         MD052216
     C                     PARM *BLANKS   PPNOI   1                                         MD052216
     C           SDNOST    PARM SDNOST    DSFDY                                             MD052216
      *                                                                                     MD052216
     C           PRTCD     IFNE *BLANKS                                                     MD052216
     C           *LOCK     IN   LDA                                                         MD052216
     C                     MOVEL'AONOSTR0'DBFILE                                            MD052216
     C                     Z-ADD56        DBASE                                             MD052216
     C                     MOVELFEFCCY    DBKEY                                             MD052216
     C                     OUT  LDA                                                         MD052216
     C                     EXSR *PSSR                                                       MD052216
     C                     ELSE                                                             MD052216
      *                                                                                     MD052216
     C**********           MOVELFEFCCY    ZCCY                                     MD052216 MD053873
     C                     MOVELPCURR     ZCCY                                              MD053873
     C                     MOVE A7NOSN    ZLOC                                              MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ELSE                                                             MD052216
      *                                                                                     MD052216
      ** For other settlement types, use Local Currency & Location                          MD052216
      *                                                                                     MD052216
     C                     MOVE BJLCCY    ZCCY                                              MD052216
     C                     MOVE BJSLCD    ZLOC                                              MD052216
      *                                                                                     MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ENDSR                                                            MD052216
      *****************************************************************                     MD052216
      /EJECT                                                                                  237466
     C/COPY ZSRSRC,ZBKDT                                                                      237466
0835 C/COPY ZSRSRC,ZACCH                                                  S01195
0835 C/COPY ZSRSRC,ZFWDT                                                  S01195
0835 C*COPY*ZSRSRC,ZBKDT                                                               246761 CPK028
1024 C*    ERROR DUMP SUBROUTINE.                                         S01194
1048 C*                                                                   S01194
1034 C           *PSSR     BEGSR                           ***  PSSR **   S01194
1020 C           @RUN      IFEQ *BLANK                                    S01194
1021 C                     MOVE 'Y'       @RUN    1                       S01194
1020 C                     DUMP                                           S01194
1021 C                     END                                            S01194
1022 C                     ENDSR                           *** *PSSR **   S01194
1048 C**                                                                  S01194
     C/EJECT                                                                                  CRE020
      *****************************************************************                       CRE020
      *                                                               *                       CRE020
      *  SRMOD    : Subroutine that would identify which module the   *                       CRE020
      *             posting came from.                                *                       CRE020
      *                                                               *                       CRE020
      *  CALLED BY: Main                                              *                       CRE020
      *                                                               *                       CRE020
      *****************************************************************                       CRE020
     C           SRMOD     BEGSR                                                              CRE020
      *                                                                                       CRE020
      ** Dealing postings                                                                     CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           *IN04     IFEQ '1'                                                           CRE020
     C                     MOVEL'D'       WGNAR   2                                           CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Lending postings                                                                     CRE020
      *                                                                                       CRE020
     C           *IN05     IFEQ '1'                                                           CRE020
     C           *IN15     OREQ '1'                                                           CRE020
     C           *IN16     OREQ '1'                                                           CRE020
     C           *IN48     OREQ '1'                                                           CRE020
     C                     MOVEL'U'       WGNAR                                               CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Securities Postings                                                                  CRE020
      *                                                                                       CRE020
     C           *IN18     IFEQ '1'                                                           CRE020
     C                     MOVEL'S'       WGNAR                                               CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Funds Transfer Postings                                                              CRE020
      *                                                                                       CRE020
     C           *IN19     IFEQ '1'                                                           CRE020
     C                     MOVEL'G'       WGNAR                                               CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Futuresa and Option postings                                                         CRE020
      *                                                                                       CRE020
     C           *IN20     IFEQ '1'                                                           CRE020
     C                     MOVEL'F'       WGNAR                                               CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Retail Postings                                                                      CRE020
      *                                                                                       CRE020
     C           *IN20     IFEQ '1'                                                           CRE020
     C                     MOVEL'R'       WGNAR                                               CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Account Transfer                                                                     CAP204
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN28     ANDEQ'1'                                                           CAP204
     C                     MOVEL'T'       WGNAR                                               CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C                     MOVE WGNAR     NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
1022 C                     ENDSR                                                              CRE020
     C/EJECT                                                                                  CAP205
      *****************************************************************                       CAP205
      *                                                               *                       CAP205
      *  SRACMT   : Subroutine that would populate CMOD, ETYP,        *                       CAP205
      *             and MTYP fields of RSACMTPD file.                 *                       CAP205
      *                                                               *                       CAP205
      *  CALLED BY: Main                                              *                       CAP205
      *                                                               *                       CAP205
      *****************************************************************                       CAP205
     C           SRACMT    BEGSR                                                              CAP205
      *                                                                                       CAP205
      ** Set Module value                                                                     CAP205
      ** Dealing postings                                                                     CAP205
      *                                                                                       CAP205
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C           *IN04     IFEQ '1'                                                           CAP205
     C                     MOVE 'DL'      CMOD                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** Lending postings                                                                     CAP205
      *                                                                                       CAP205
     C           *IN05     IFEQ '1'                                                           CAP205
     C           *IN15     OREQ '1'                                                           CAP205
     C           *IN16     OREQ '1'                                                           CAP205
     C           *IN48     OREQ '1'                                                           CAP205
     C                     MOVE 'LE'      CMOD                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** Securities Postings                                                                  CAP205
      *                                                                                       CAP205
     C           *IN18     IFEQ '1'                                                           CAP205
     C                     MOVE 'SE'      CMOD                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** Funds Transfer Postings                                                              CAP205
      *                                                                                       CAP205
     C           *IN19     IFEQ '1'                                                           CAP205
     C                     MOVE 'FT'      CMOD                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** Futuresa and Option postings                                                         CAP205
      *                                                                                       CAP205
     C           *IN20     IFEQ '1'                                                           CAP205
     C                     MOVE 'FF'      CMOD                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** Retail Postings                                                                      CAP205
      *                                                                                       CAP205
     C           *IN26     IFEQ '1'                                                           CAP205
     C                     MOVE 'RE'      CMOD                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** General Ledger Postings                                                              CAP205
      *                                                                                       CAP205
     C           *IN28     IFEQ '1'                                                           CAP205
     C                     MOVE 'GL'      CMOD                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** Set Movement Type field                                                              CAP205
      *                                                                                       CAP205
     C           ETYP      LOKUPTABCD3                   71                                   CAP205
     C           1         SUBSTETYP:3    @ETYP   1                                           CAP205
     C           2         SUBSTETYP:1    @ETYP2  2                                           CAP205
     C                     SELEC                                                              CAP205
     C           CMOD      WHEQ 'GL'                                                          CAP205
     C           TRYP      ANDEQ'ZT'                                                          CAP205
     C********** KEYATM    CHAINGLATMIL0             99                              CAP205 BUG27920
     C********** R1EXDT    IFGT BJRDNB                                               CAP205 BUG27920
     C                     MOVE 'F'       MTYP                                                CAP205
     C**********           ELSE                                                      CAP205 BUG27920
     C**********           MOVE 'S'       MTYP                                       CAP205 BUG27920
     C**********           ENDIF                                                     CAP205 BUG27920
      *                                                                                       CAP205
      ** If the event type is for FX deals                                                    CAP205
      *                                                                                       CAP205
     C           @ETYP2    WHEQ '11'                                                          CAP205
     C           @ETYP2    OREQ '12'                                                          CAP205
     C           @ETYP2    OREQ '13'                                                          CAP205
     C           @ETYP2    OREQ '14'                                                          CAP205
     C                     MOVE ECCY      ZCCY                                                CAP205
     C                     MOVE *BLANK    ZLOC                                                CAP205
     C                     Z-ADDPTDT      ZDAYNO                                              CAP205
     C                     Z-ADD0         ZDYNBR                                              CAP205
     C                     Z-ADD2         ZNRDYS                                              CAP205
     C                     EXSR ZFWDT                                                         CAP205
     C                     Z-ADDZDYNBR    @PTDT   50                                          CAP205
     C           VUDT      IFGT @PTDT                                                         CAP205
     C                     MOVE 'F'       MTYP                                                CAP205
     C                     ELSE                                                               CAP205
     C                     MOVE 'S'       MTYP                                                CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** If the event type is in the list of same day event                                   CAP205
      *                                                                                       CAP205
     C           *IN71     WHEQ '1'                                                           CAP205
     C                     MOVE 'S'       MTYP                                                CAP205
     C                     OTHER                                                              CAP205
      *                                                                                       CAP205
      ** If 3rd position of the event type is 'V'                                             CAP205
      *                                                                                       CAP205
     C           @ETYP     IFEQ 'V'                                                           CAP205
     C                     MOVE 'S'       MTYP                                                CAP205
     C                     ELSE                                                               CAP205
     C                     MOVE 'F'       MTYP                                                CAP205
     C                     ENDIF                                                              CAP205
     C                     ENDSL                                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
1022 C                     ENDSR                                                              CAP205
     C/EJECT                                                                                  246761
      *****************************************************************                       246761
      *                                                               *                       246761
      *  SRPSTD   : Subroutine to calculate the correct posting date. *                       246761
      *                                                               *                       246761
      *  CALLED BY: Main                                              *                       246761
      *                                                               *                       246761
      *****************************************************************                       246761
      *                                                                                       246761
     C           SRPSTD    BEGSR                                                              246761
      *                                                                                       246761
      ** If the event date is less than the next working date, then                           246761
      ** use the next working date.                                                           246761
      *                                                                                       246761
     C           PTDT      IFLT BJDNWD                                                        246761
     C                     Z-ADDBJDNWD    PTDT                                                246761
     C                     ENDIF                                                              246761
      *                                                                                       246761
      ** If the event date is greater than the next working date,                             246761
      ** then calculate for the correct posting date based on the                             246761
      ** Accrual on Non-Working Day indicator and the local currency                          246761
      ** holiday and location.                                                                246761
      *                                                                                       246761
     C           PTDT      IFGT BJDNWD                                                        246761
     C           *LIKE     DEFN ZCCY      ZCCY1                                               259845
     C           *LIKE     DEFN ZLOC      ZLOC1                                               259845
     C                     MOVE ZCCY      ZCCY1                                               259845
     C                     MOVE ZLOC      ZLOC1                                               259845
      *                                                                                       246761
     C                     MOVE BJLCCY    ZCCY                                                246761
     C                     MOVE BJSLCD    ZLOC                                                246761
     C                     Z-ADDPTDT      ZDAYNO                                              246761
     C                     Z-ADDPTDT      ZDYNBR                                              246761
     C                     Z-ADD0         ZNRDYS                                              246761
      *                                                                                       246761
     C           BKANWD    IFEQ '1'                                                           246761
     C                     EXSR ZBKDT                                                         246761
     C                     ENDIF                                                              246761
      *                                                                                       246761
     C           BKANWD    IFEQ '2'                                                           246761
     C                     EXSR ZFWDT                                                         246761
     C                     ENDIF                                                              246761
      *                                                                                       246761
     C                     Z-ADDZDYNBR    PTDT                                                246761
      *                                                                                       246761
     C                     MOVE ZCCY1     ZCCY                                                259845
     C                     MOVE ZLOC1     ZLOC                                                259845
     C                     ENDIF                                                              246761
      *                                                                                       246761
     C                     ENDSR                                                              246761
      *                                                                                       246761
      *****************************************************************                       246761
      *****************************************************************                       CRE020
0835 C/EJECT
0836 O*PRINT  D  203   L2                                         *****   S01124
0836 O*LO580P1D  203   L2                                         *****   S01117
0837 O*****  OR       NL2 OF                                      *****   S01117
0838 O*****                              22 'REFERENCE DL0580'    *****   S01117
0836 O*DL0580P1D**203***L2*55*******                                S01117E22608
0836 OGL0580P1D  203   L2 55                                              E22608
     O*******AND**     MR                                          LN0730 E26063
0837 O       OR       NL2 OF 55                                           S01117
     O       OR           55 39                                           BHF276
     O*******AND**     MR                                          LN0730 E26063
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP10                                           S01408
     O*                                                                   S01408
0838 O********************************** 24 'REFERENCE DL0580P1'    S01117E22608
0838 O                                   24 'REFERENCE GL0580P1'          E22608
0839 O*****                    TITL      89                       *****   S01194
0839 O                         BJURPT    89                               S01194
0840 O                                  104 'DATE'
0841 O*****                    RUNA     112                       *****   S01194
0841 O                         BJMRDT   112                               S01194
0842 O                                  122 'PAGE'
0843 O                         PAGE     127
0844 O*****   D  1     L2                                         *****   S01117
0845 O*****  OR       NL2 OF                                      *****   S01117
0844 O        D  1     L2 55                                              S01117
     O*******AND**     MR                                          LN0730 E26063
0845 O       OR       NL2 OF 55                                           S01117
     O       OR           55 39                                           BHF276
     O*******AND**     MR                                          LN0730 E26063
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP3                                           S01408
     O*                                                                   S01408
0846 O                    U4             54 'SECURITIES TRADING '
0846 O                                   70 'EVENTS BY NOSTRO'
0847 O*****   D  2     L2                                         *****   S01117
0848 O*****  OR       NL2 OF                                      *****   S01117
0847 O        D  2     L2 55                                              S01117
     O*******AND**     MR                                          LN0730 E26063
0848 O       OR       NL2 OF 55                                           S01117
     O       OR           55 39                                           BHF276
     O*******AND***    MR                                          LN0730 E26063
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP4                                           S01408
     O*                                                                   S01408
0846 O                    U4             54 '-------------------'
0849 O                                   70 '----------------'
0847 O        D  1     L2 55                                              S01117
     O*******AND**     MR                                          LN0730 E26063
0848 O       OR       NL2 OF 55                                           S01117
     O       OR           55 39                                           BHF276
     O*******AND**     MR                                          LN0730 E26063
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP5                                           S01408
     O*                                                                   S01408
0846 O                                   12 'BRANCH'                      S01117
0849 O                         BRCA      16                               S01117
0849 O*****                    BRNM      48                       *****   S01194
0849 O                         A8BRNM    48                               S01194
0850 O*****   D  1     L2                                         *****   S01117
0851 O*****  OR       NL2 OF                                      *****   S01117
0850 O********D**1*****L2*55***                                    S01117 LN0819
0850 O        D 11     L2 55                                              LN0819
     O*******AND**     MR                                          LN0730 E26063
0851 O       OR       NL2 OF 55                                           S01117
     O       OR           55 39                                           BHF276
     O*******AND**     MR                                          LN0730 E26063
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP6                                           S01408
     O*                                                                   S01408
0852 O                                    9 'CURRENCY'
0853 O                         CCY       16
0854 O*****   D  1     L2                                         *****   S01117
0855 O*****  OR       NL2 OF                                      *****   S01117
0854 O        D  1     L2 55                                              S01117
     O*******AND**     MR                                          LN0730 E26063
0855 O       OR       NL2 OF 55                                           S01117
     O       OR           55 39                                           BHF276
     O*******AND**     MR                                          LN0730 E26063
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP7                                           S01408
     O*                                                                   S01408
     O                                   57 'TRANSACTION  EVENT'          209995
0856 O**********                         57 'LOAN/DEAL  EVENT'            209995
0856 O                                   70 ' RATE / '                    178438
0857 O                                   92 'FED        INCOMING'
0858 O                                  111 'OUTGOING'
0859 O*****   D  1     L2                                         *****   S01117
0860 O*****  OR       NL2 OF                                      *****   S01117
0859 O        D  1     L2 55                                              S01117
     O*******AND**     MR                                          LN0730 E26063
0860 O       OR       NL2 OF 55                                           S01117
     O       OR           55 39                                           BHF276
     O*******AND**     MR                                          LN0730 E26063
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP8                                           S01408
     O*                                                                   S01408
0861 O                                   21 'DATE        CUSTOMER'
0862 O                                   57 'NUMBER     TYPE'             178438
0856 O                                   70 'SECURITY'                    178438
0863 O                                   90 'FDS         AMOUN'           178438
0862 O***********************************66 'NUMBER     TYPE       RA'    178438
0863 O***********************************90 'TE     FDS         AMOUN'    178438
0864 O                                  110 'T             AMOUNT'
0865 O                                  128 'BALANCE'
0866 O********D*11*****MR 01 21                                           LN0819
0866 O*******AND*******55                                           S01117LN0819
0867 O****   OR        01N21                                      *****   S01117
0867 O*******OR********01N21 55                                     S01117LN0819
     O*******AND*******MR                                           LN0730LN0819
0866 O********D*11     MR 55 07                                    LN0819 E26063
0866 O        D 11     L1 55                                              E26063
0866 O       OR        55 39                                              E26063
     O/COPY WNCPYSRC,GL0580O003
0868 O                                   12 'NOSTRO NAME'
0869 O*************************CRNM      33                               LN0819
0869 O                         @CRNM     33                               LN0819
0870 O                         NOSN      38
0871 O********D**2*****MR 01 21                                           LN0819
0871 O*******AND*******55                                           S01117LN0819
0872 O*****  OR        01N21                                      *****   S01117
0872 O*******OR********01N21 55                                     S01117LN0819
     O*******AND*******MR                                           LN0730LN0819
0866 O********D**2     MR 55 07                                    LN0819 E26063
0866 O        D  2     L1 55                                              E26063
0866 O       OR        55 39                                              E26063
     O/COPY WNCPYSRC,GL0580O004
0873 O                                   12 'TOWN'
0874 O*************************CTWN      23                               LN0819
0874 O                         @CTWN     23                               LN0819
0875 O********D**0*****MR 01 21                                           LN0819
0875 O*******AND*******55                                           S01117LN0819
0876 O*****  OR        01N21                                      *****   S01117
0876 O*******OR********01N21 55                                     S01117LN0819
     O*******AND*******MR                                           LN0730LN0819
0866 O********D**0     MR 55 07                                    LN0819 E26063
0866 O        D  0     L1 55                                              E26063
0866 O       OR        55 39                                              E26063
     O*****                    RUNA       7                               E11718
     O                         FRDATA     7                               E11718
0878 O***********************30NOBL     131 '   ,   ,   ,   , 0 -'        LN0819
0879 O***********************31NOBL     131 '  ,   ,   ,   , 0 . -'       LN0819
0880 O***********************32NOBL     131 ' ,   ,   ,   , 0 .  -'       LN0819
0881 O***********************33NOBL     131 '   ,   ,   , 0 .   -'        LN0819
0878 O                       30@NOBL    131 '   ,   ,   ,   , 0 -'        LN0819
0879 O                       31@NOBL    131 '  ,   ,   ,   , 0 . -'       LN0819
0880 O                       32@NOBL    131 ' ,   ,   ,   , 0 .  -'       LN0819
0881 O                       33@NOBL    131 '   ,   ,   , 0 .   -'        LN0819
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP1                                           S01408
     O*                                                                   S01408
0882 O*****   E 0      52 53                                      *****   S01117
0882 O*****   E 0      52 53 55                                    S01117 LN0730
0882 O********E*0******52 53 55@BALIN                               LN0730LN0819
0882 O        E 10     52 53 55@BALIN                                     LN0819
     O       AND       MR                                                 LN0730
     O/COPY WNCPYSRC,GL0580O002
0878 O                       30NOBL     131 '   ,   ,   ,   , 0 -'
0879 O                       31NOBL     131 '  ,   ,   ,   , 0 . -'
0880 O                       32NOBL     131 ' ,   ,   ,   , 0 .  -'
0881 O                       33NOBL     131 '   ,   ,   , 0 .   -'
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP9                                           S01408
     O*                                                                   S01408
0887 O        D 10     MR 04 70
0887 O       AND       55                                                 S01117
0888 O       OR 10     MR 05 70
0887 O       AND       55                                                 S01117
     O       OR 10     MR 15 70
0887 O       AND       55                                                 S01117
     O       OR 10     MR 16 70                                           S01473
     O       AND       55                                                 S01473
     O*****  OR 10     MR 16 70                                   *****   S01196
0887 O*****  AND       55                                         *****   S01196
     O*****  OR 10     MR 17 70                                           E36449
0887 O*****  AND       55                                          S01117 E36449
     O       OR 10     MR 18 70                                           S01129
0887 O       AND       55                                                 S01117
     O       OR 10     MR 26 70                                           209995
     O       AND       55                                                 209995
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0580OPG1                                           S01408
      *                                                                   S01408
0889 O                         EDATA      7
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP11                                           S01408
     O*                                                                   S01408
0890 O                         CRNM      28
0891 O                         CTWN      39
0892 O*****           N15      DLNO      48                               S01129
     O****************N15      PDLNO     48                        S01129 S01473
     O**********      N15 16             48 '      '               S01473 209995
     O**********      N15N16   PDLNO     48                        S01473 209995
     O                N15 16N26          48 '      '                      209995
     O                N15N16N26PDLNO     48                               209995
     O**********       26      STOR      48                                         209995 MD036589A
     O                 26N24   STOR      48                                                MD036589A
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP12                                           S01408
     O*                                                                   S01408
     O                 16      LCNO      48                               S01473
     O                 16                42 'LC'                          S01473
     O                 15                42 'LE'
     O*****            16                42 'BC'                  *****   S01196
     O*****            17                42 'ST'                          E36449
     O                 18                42 'SE'                          S01129
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OOP2                                           S01408
     O*                                                                   S01408
     O                 15N48   LNRF      48
     O                 15 48   FTYP      45
     O                 15 48   FSEQ      48
     O                 15 48             46 '/'
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP13                                           S01408
     O*                                                                   S01408
0893 O*************************TABNAM    59                               CSE007
     O                 26                59 'S.O. PYMNT'                  209995
     O                N73N26N27TABNAM    59                               209995
     O                 73N26   CANARR    59                               209995
     O                 27      TABNM2    59                                                   CLE028
     O                 24      WNETD     59                                                MD036589A
     O**********      N73      TABNAM    59                        CSE007 209995
     O**********       73      CANARR    59                        CSE007 209995
     O                 18      NESS      73                               178438
      *                                                                   S01408
     O/COPY WNCPYSRC,GL0580OPG2                                           S01408
      *                                                                   S01408
0894 O*                04N47   EXRT      73 '   0 .        -'             S01108
0894 O***********      04N47N89EXRT      73 '   0 .        -'       S01108090909
0895 O***********      04 47   DBCR      73 '   0 .        -'             090909
     O***********      04   N89EXRT      73 '   0 .        -'      090909 CGL010
     O                 04N35N89EXRT      73 '   0 .        -'             CGL010
0896 O                 05      EINRX     73 '  0 .        -'
0896 O                 15      EINRX     73 '  0 .        -'
     O                    18 65          75 '* OVERDUE *    '             S01176
     O                    18 66          75 '* APPROXIMATE *'             S01176
0897 O*****           N15      FFIN      75                               S01129
     O                N15N18   FFIN      75                               S01129
0898 O********            45 30EAMT  1   93
0899 O********            45 31EAMT      93 '   ,   ,   , 0 . '           S01119
0900 O********            45 32EAMT      93 '  ,   ,   , 0 .  '           S01119
0901 O********            45 33EAMT      93 ' ,   ,   , 0 .   '           S01119
0903 O********            46 30EAMT  1  111                               S01119
0904 O********            46 31EAMT     111 '   ,   ,   , 0 . '           S01119
0905 O********            46 32EAMT     111 '  ,   ,   , 0 .  '           S01119
0906 O********            46 33EAMT     111 ' ,   ,   , 0 .   '           S01119
0902 O*                                                                   S01119
0898 O                 44 45 30EAMT  J   93                               S01119
0899 O                 44 45 31EAMT      93 '   ,   ,   , 0 . -'          S01119
0900 O                 44 45 32EAMT      93 '  ,   ,   , 0 .  -'          S01119
0901 O                 44 45 33EAMT      93 ' ,   ,   , 0 .   -'          S01119
0903 O                 44 46 30EAMT  J  111                               S01119
0904 O                 44 46 31EAMT     111 '   ,   ,   , 0 . -'          S01119
0905 O                 44 46 32EAMT     111 '  ,   ,   , 0 .  -'          S01119
0906 O                 44 46 33EAMT     111 ' ,   ,   , 0 .   -'          S01119
0902 O*                                                                   S03220
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP14                                           S01408
     O*                                                                   S01408
     O        D 10     MR 19 70                                           S03220
0887 O       AND       55                                                 S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP15                                           S01408
     O*                                                                   S01408
0889 O                         EDATA      7                               S03220
0890 O                         PREF      48                               S03220
0895 O**********               TABNAM    59                                            S03220 CLE028
0895 O                N27      TABNAM    59                                                   CLE028
0895 O                 27      TABNM2    59                                                   CLE028
0894 O                         EXRT      73 '   0 .        '              S03220
0896 O                                   75 'N'                           S03220
0898 O                    45 30EAMT  1   93                               S03220
0899 O                    45 31EAMT      93 '   ,   ,   , 0 . '           S03220
0900 O                    45 32EAMT      93 '  ,   ,   , 0 .  '           S03220
0901 O                    45 33EAMT      93 ' ,   ,   , 0 .   '           S03220
0903 O                    46 30EAMT  1  111                               S03220
0904 O                    46 31EAMT     111 '   ,   ,   , 0 . '           S03220
0905 O                    46 32EAMT     111 '  ,   ,   , 0 .  '           S03220
0906 O                    46 33EAMT     111 ' ,   ,   , 0 .   '           S03220
0902 O*                                                                   S03220
0902 O*                                                                   S01119
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP16                                           S01408
      *                                                                                       CAP204
     O        D 10     MR 28 70                                                               CAP204
     O       AND       55                                                                     CAP204
      *                                                                                       CAP204
     O                         EDATA      7                                                   CAP204
     O                         TREF      48                                                   CAP204
     O                N27      TABNAM    59                                                   CAP204
     O                 27      TABNM2    59                                                   CAP204
     O                         EXRT      73 '   0 .        '                                  CAP204
     O                                   75 'N'                                               CAP204
     O                    45 30EAMT  1   93                                                   CAP204
     O                    45 31EAMT      93 '   ,   ,   , 0 . '                               CAP204
     O                    45 32EAMT      93 '  ,   ,   , 0 .  '                               CAP204
     O                    45 33EAMT      93 ' ,   ,   , 0 .   '                               CAP204
     O                    46 30EAMT  1  111                                                   CAP204
     O                    46 31EAMT     111 '   ,   ,   , 0 . '                               CAP204
     O                    46 32EAMT     111 '  ,   ,   , 0 .  '                               CAP204
     O                    46 33EAMT     111 ' ,   ,   , 0 .   '                               CAP204
     O*                                                                   S01408
     O        D 10     MR 20 70                                           073714
0887 O       AND       55                                                 073714
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP17                                           S01408
     O*                                                                   S01408
0889 O                         EDATA      7                               073714
0890 O                         CRNM      28                               073714
0891 O                         CTWN      39                               073714
     O                         TNBR      48                               073714
     O                                   42 'FF'                          073714
0893 O**********               TABNAM    59                                            073714 CLE028
     O                N27      TABNAM    59                                                   CLE028
     O                 27      TABNM2    59                                                   CLE028
0898 O                 44 45 30EAMT  J   93                               073714
0899 O                 44 45 31EAMT      93 '   ,   ,   , 0 . -'          073714
0900 O                 44 45 32EAMT      93 '  ,   ,   , 0 .  -'          073714
0901 O                 44 45 33EAMT      93 ' ,   ,   , 0 .   -'          073714
0903 O                 44 46 30EAMT  J  111                               073714
0904 O                 44 46 31EAMT     111 '   ,   ,   , 0 . -'          073714
0905 O                 44 46 32EAMT     111 '  ,   ,   , 0 .  -'          073714
0906 O                 44 46 33EAMT     111 ' ,   ,   , 0 .   -'          073714
0907 O********D*10*****MR 04 70                                           LN0819
0907 O*******AND*******55                                           S01117LN0819
0908 O*******OR*10*****MR 05 70                                           LN0819
0907 O*******AND*******55                                           S01117LN0819
     O*******OR*10*****MR 15 70                                           LN0819
0907 O*******AND*******55                                           S01117LN0819
     O*****  OR 10     MR 16 70                                   *****   S01196
0907 O*****  AND       55                                         *****   S01196
     O*******OR*10*****MR 17 70                                           LN0819
0907 O*******AND*******55                                           S01117LN0819
     O*******OR*10*****MR 18 70                                     S01129LN0819
0907 O*******AND*******55                                           S01117LN0819
0909 O*****************      05          42 'D/D'                         LN0819
0910 O*****************      05DDNO      49                               LN0819
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP18                                           S01408
     O*                                                                   S01408
0908 O        D 10     MR 05 70                                           LN0819
0908 O       AND       55                                                 LN0819
     O       OR 10     MR 16 70                                           S01473
     O       AND       55                                                 S01473
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP19                                           S01408
     O*                                                                   S01408
0909 O                                   42 'D/D'                         LN0819
0910 O                         DDNO      49                               LN0819
     O        D 10     16 79NMR                                                               240943
     O                                   75 'TRADE INNOVATION REFEREN'                        240943
     O                                   98 'CE FOR ABOVE CUSTOMER :'                         240943
     O                         TIRF     119                                                   240943
     O********D*       16 79                                                           CTI001 240943
     O        D        16 79 MR                                                               240943
     O                                   75 'TRADE INNOVATION REFEREN'    CTI001
     O                                   98 'CE FOR ABOVE CUSTOMER :'     CTI001
     O                         TIRF     119                               CTI001
      *                                                                                       CGL124
     O/COPY OFCPYSRCZ,CGL124_006                                                              CGL124
      *                                                                                       CGL124
0911 O*****   T 13     L1 61                                      *****   S01117
0911 O        T 13     L1 61 55                                           S01117
0911 O       AND       77                                                 E27024
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP22                                           S01408
     O*                                                                   S01408
     O*******AND*******MR                                           LN0730LN0819
0912 O********               30NOBL14   131 '  ,   ,   ,   , 0 -'         S01119
0913 O********               31NOBL14   131 ' ,   ,   ,   , 0 . -'        S01119
0914 O********               32NOBL14   131 '   ,   ,   , 0 .  -'         S01119
0915 O********               33NOBL14   131 '  ,   ,   , 0 .   -'         S01119
0912 O*****************44    30NOBL14   131 '  ,   ,   ,   , 0 -'   S01119LN0819
0913 O*****************44    31NOBL14   131 ' ,   ,   ,   , 0 . -'  S01119LN0819
0914 O*****************44    32NOBL14   131 '   ,   ,   , 0 .  -'   S01119LN0819
0915 O*****************44    33NOBL14   131 '  ,   ,   , 0 .   -'   S01119LN0819
0912 O                       30NOBL14   131 '  ,   ,   ,   , 0 -'         LN0819
0913 O                       31NOBL14   131 ' ,   ,   ,   , 0 . -'        LN0819
0914 O                       32NOBL14   131 '   ,   ,   , 0 .  -'         LN0819
0915 O                       33NOBL14   131 '  ,   ,   , 0 .   -'         LN0819
     O*                                                                   S01117
0911 O        T 2      LR U7 U8                                           S01117
0911 O       AND       55                                                 S01117
0912 O********************************** 22 'REFERENCE DL0580'      S01117E22608
0912 O                                   22 'REFERENCE GL0580'            E22608
0913 O                                   62 'PRINT TERMINATED, '          S01117
0914 O                                   80 'DATABASE IN ERROR'           S01117
0911 O*****   T 3      L3 55                                       S01117 LN0730
0915 O*****                              71 '*** END OF BRANCH REPORT'117 LN0730
0915 O*****                              75 '***'                  S01117 LN0730
0911 O*****   E 3      L3 55   @EOBLN                              LN0730 068596
     O*****  AND       25                                          LN0730 068596
0915 O*****                              71 '*** END OF BRANCH REPOLN0730 LN0763
0915 O*****                              75 '***'                  LN0730 LN0763
     O*                                                                   068596
     O        T 3      L3 55                                              068596
     O       AND       25                                                 068596
0915 O                                   68 '*** END OF REPORT FOR'       LN0763
0915 O*********************              78 'BRANCH ***'           LN0763 LN0819
0915 O                                   79 'BRANCH ***'                  LN0819
0916 O/EJECT
0917 O*    R U N  C O N T R O L S
0918 O*
0919 O*****   T  203   LRNU7                                      *****   S01117
0919 O*DL0580AUT**203***LR********                                S01117  E22608
0919 OGL0580AUT  203   LR                                                 E22608
0920 O*****                              22 'REFERENCE DL0580'    *****   S01117
0920 O***********************************24 'REFERENCE DL0580AU'    S01117E22608
0920 O                                   24 'REFERENCE GL0580AU'          E22608
0921 O*****                    TITL      89                       *****   S01194
0839 O                         BJURPT    89                               S01194
0922 O                                  104 'DATE'
0923 O*****                    RUNA     112                       *****   S01194
0841 O                         BJMRDT   112                               S01194
0924 O                                  122 'PAGE'
0925 O*****                    PAGE     127                       *****   S01117
0925 O                         PAGE1    127                               S01117
0926 O********T  1     LRNU7                                              S01117
0926 O        T  1     LR                                                 S01117
0927 O                                   70 'EVENTS BY NOSTRO'
0928 O********T  2     LRNU7                                              S01117
0928 O        T  2     LR                                                 S01117
0929 O                                   70 '----------------'
0930 O        T  136   LRNU7
0931 O                                   18 'RUN CONTROLS'
0932 O        T  1     LRNU7
0933 O                                   60 'PROGRAM'
0934 O                                  101 'CONTROL'
0935 O        T  2     LRNU7
0936 O                                   59 'NUMBER'
0937 O                                   84 'VALUE'
0938 O                                  100 'NUMBER'
0939 O                                  125 'VALUE'
0940 O        T  2     LRNU7
0941 O                                   32 'RECORDS LISTED IN THIS R'
0942 O                                   37 'EPORT'
0943 O                         NSVLIS3   59
0944 O                         INT,3 Z   81
0945 O                         DEC,3     84
0946 O                         NOREN 3  100
0947 O                         HRWN  Z  122
0948 O                         HRDC     125
0949 O                 76               130 '***'
0950 O        T  2     LRNU7
0951 O                                   32 'PROJECTED NOSTRO RECORDS'
0952 O                                   40 'CREATED'
0953 O                         RECRIT3   59
0954 O                         INT,4 Z   81
0955 O                         DEC,4     84
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP20                                           S01408
     O*                                                                   S01408
0956 O        T  2     LRNU7
0957 O                                   32 'TEMP NOSTRO RECORDS READ'
0958 O                         PTREC 3   59
0959 O                         NORE  3  100
0960 O                 75               130 '***'
0961 O        T  2     LR 75NU7
0962 O       OR        LR 76NU7
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0580OP21                                           S01408
     O*                                                                   S01408
0963 O                                   63 '***  RECORD COUNT DIFFER'
0964 O                                   71 'ENCE ***'
0965 O********T  2     LRN49NU7                                           LN0354
0965 O********T**2     LRN55NU7                                     LN0354LN0819
0965 O        T  2     LRN23NU7                                           LN0819
0966 O                                   63 '***   NO DETAILS TO REPO'
0967 O                                   71 'RT   ***'
     O** OUTPUT DATABASE ERROR IF NECESSARY                               S01117
     O        T 3      LR U7 U8                                           S01117
0969 O*****                              22 'REFERENCE DL0580'    *****   S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
0968 O*****   T  2     LR U7 U8                                   *****   S01117
0970 O*****                              62 'PRINT TERMINATED, '  *****   S01117
0971 O*****                              80 'DATABASE IN ERROR'   *****   S01117
0972 O********T*2******LR                                                 LN0135
0973 O*********************************  65 '***   END OF REPORT'         LN0135
0974 O*********************************  71 '***'                         LN0135
0975 O*
0976 O*    PROJECTED NOSTRO BALANCES FILE
0977 O*
0978 O*****HH D        03                                         *****   S01117
0978 OPRONOHH DADD     03                                                 S01117
0979 O                                    6 'H   00'
0980 O                         FSIZE      9P
0981 O*****PN T        L1 60                                      *****   S01117
0981 OPRONOPN TADD     L1 60                                              S01117
0982 O                                    1 'D'
0983 O                         CCY        4
0984 O                         NOSN       6
0985 O                         CBAL,1    14P
0986 O                         CBAL,2    22P
0987 O                         CBAL,3    30P
0988 O                         CBAL,4    38P
0989 O                         CBAL,5    46P
0990 O*
0991 O*
0992 O                         DATE,1    49P
0993 O                         DATE,2    52P
0994 O                         DATE,3    55P
0995 O                         DATE,4    58P
0996 O                         DATE,5    61P
0997 O*
0998 O*
0999 O                         CNUM1     67
1000 O                         CSNM      77
     O*                                                                   E10305
     O                         ZERO5    128P                              E10305
1001 O*
1001 O*** E0211  THE ARRAY TABNAM HAS HAD EVENT NARATIVES ADDED
1001 O***    FOR LC EVENTS  (THREE LINES AT THE BOTTOM)
     O* TABNAM CHANGED: ALL SECURITIES TRADING EVENT NARRATIVES MOVED ONE
     O* PLACE RIGHT IN TABNAM TO MATCH EVENT CODES THEY REFERENCE. E1309
     O*                                                                   S01119
     O* TABCOD & TABNAM, EIGHT ENTRIES ADDED AT END OF TABLE FOR FRA/IRS  S01119
     O* TABCOD & TABNAM, 1 ENTRY ADDED FOR EVENT TYPE 66V3 FOR THE     S  S01243
     O* PRINCIPAL INCREASE ON TERM LOAN CHANGE                         S  S01243
     O* Addition of 71F1 - 'LOAN FEE' and amendment of text for 71F2      S01270
     O* to 'FCTY FEE' from 'CMMT FEE'.                                    S01270
     O* ADDED 63R3, 63R4, 63R5 IN TABCOD                                  S01392
     O* ADDED RVER PRINC, ROLLOVER, RVER DISC. IN TABNAM                  S01392
     O* Added 22FE, 23FE, 24FE, 22BO, 23BO to TABCOD                      CIR001
     O* Added Up-Fr. Fee, Up-Fr. Fee, Premium, Buy-Out, Buy-Out to TABNAM CIR001
     O* Replaced 16V1(entry 36) by 61V1 and added 69 entries after 23BO   CEU003
     O*  in TABCOD.                                                       CEU003
     O*  Added 69 entries to TABNAM after Buy-Out to match event codes.   CEU003
     O*  Corrected Event narratives overlap for entries 146 to 149 in     CEU003
     O*  TABNAM corresponding to 71F1, 63R3, 63R4 and 63R5 in TABCOD.     CEU003
     O*  Add two entries for TABCOD and TABNAM for CLS events             CDL008
      *  Added 24BO - Buy-Out in TABCOD and TABNAM                        CIR006
      *  Added 23C3 - Value in TABCOD and TABNAM                          CIR003
      *  Added 23S3 - Value in TABCOD and TABNAM                          CIR003
      *  Added 23C4 - Maturity in TABCOD and TABNAM                       CIR003
      *  Added 23S4 - Maturity in TABCOD and TABNAM                       CIR003
     O*                                                                   S01119
     O/COPY WNCPYSRC,GL0580O001
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,GL0580X002
**   TABCOD -- EVENT CODES
11V111V212V112V213V113V214V114V215V115I215M115V315M416V116I216M116M417V1
17I217M117V318M116V341S141I241M341M441R141R241R341R441M141M242S842M161V1  CEU003
62V163V164V165V166V167V161I262I264I266I270I261R162R164R166R161R262R264R2
66R261V361M162M163M164M165M166M167M163V265V267V270M271F261M262M264M266M2
80A180M180M281A181A281D181D281F181P181M181M281M381M482A182A282M182M282M3
83A183M184V184V284V330P130S130C130C230A130D130D230M130M221N121N221I122I1  S01119
23I124N124N224I110V110V231P131S131C131C231C331C431C531D131D231D331D431D5  S01119
31B131B231B331B431B591P191P291P391P491P591P691P791P891P910V110V262V364V3  S03220
66V371F163R363R463R593V122FE23FE24FE22BO23BO61R762R763R764R765R766R767R7  CLE004
70R761V562V563V564V565V566V567V570V562R963R964R962V763V764V768I268R168R2  CLE004
68V368M168M268R768V569V169I269R169R269M169M269V369R769V571I271M271R771V5  CLE005
72V172I272R172R272M172M272V372R772V566R966V765R965V767R967V769R969V772R9  CLE005
72V710VX10VY11VX11VY12VX12VY13VX13VY14VX14VY15VX15VZ15IY15MX15MZ16VX16VZ  CEU003
16IY16MX16MZ17VX17VZ17IY17MX18MX21IX22IX23IX24IX61VX62VX63VX64VX65VX66VX  CEU003
67VX61IY62IY64IY66IY70IY61RX62RX64RX66RX61RY62RY64RY66RY61VZ61MX62MX63MX  CEU003
64MX65MX66MX67MX63VY65VY67VY70MY61MY62MY64MY66MY62VZ64VZ66VZ63RZ15M216M2  CEU003
15MY16MYZZZZCPV1CRV124BO23C323S323C423S415F116F117F1DTV1CTV1                    CIR003 CAS009 CAP204
     X/COPY WNCPYSRC,GL0580X004
**   TABNAM -- EVENT NARRATIVES
VALUE     VALUE     OP MAT    OP MAT    OP VALUE  OP VALUE  SW VALUE  SW VALUE
START     INT PAY   MATURITY  INCREASE  DECREASE  START     INT PAY   MATURITY
DECREASE  N/A VALUE INT PAY   MATURITY  N/A VALUE N/A SALE  INCREASE  START
INTEREST  REPAYMENT REPAY INT ROLLOVER  RVER INT  NEW PRINC RVER REPAYMATURITY
MAT INT   START DISCMATURITY  START     START     START     START     START
START     START     INT DUE   INT DUE   INT DUE   INT DUE   INT DUE   REPAY PRIN
REPAY PRINREPAY PRINREPAY PRINREPAY INT REPAY INT REPAY INT REPAY INT PRIN INC.
MATURITY  MATURITY  MATURITY  MATURITY  MATURITY  MATURITY  MATURITY  START INT
START INT START INT GTEE FEE  FCTY FEE  MATUR INT MATUR INT MATUR INT MATUR INT
START     MAT RCV   MAT PAY   START     START PAY DISHONOR  DISHONOR  ACCEPTANCE
PAYMENT   MAT RCV   MAT PAY   MAT EXC   MAT DEF   START RCV START PAY MAT RCV
MAT PAY   DISC RCV  GRANT     REDEEM    VALUE     VALUE     VALUE     PURCHASE
SALE      COUPON LNGCOUPON SHTP/P CALLS DIVIDEND  DIVIDEND  MATURITY  MATURITY
VALUE     VALUE     SETTLEMENTINTEREST  INTEREST  INTEREST  INTEREST  INTEREST
TRANSFER  TRANSFER  TRD PURCH TRADE SALEC-PART PAYC-COUPON  C-DIVIDENDC-MORT PAY
C-MATURITYD-PART PAYD-COUPON  D-DIVIDENDD-MORT PAYD-MATURITYB-PART PAYB-COUPON
B-DIVIDENDB-MORT PAYB-MATURITYPAYMENT   RECEIPT   CHQ RECPT CHQ CREDITCHQ PYMNT
CHQ DEBIT TRANSFER  REG RECPT REG PYMNT TRANSFER  TRANSFER  PRIN INC. PRIN INC.
PRIN INC. LOAN FEE RVER PRINCROLLOVER  RVER DSC.  PREMIUM   Up-Fr. FeeUp-Fr.Fee
Premium   Buy-Out   Buy-Out   PR TFR FRMPR TFR FRMPR TFR FRMPR TFR FRMPR TFR FRM
PR TFR FRMPR TFR FRMPR TFR FRMPR TFR TO PR TFR TO PR TFR TO PR TFR TO PR TFR TO
PR TFR TO PR TFR TO PR TFR TO MCCY RLPAYMCCY RLPAYMCCY RLPAYMCCY RLDRWMCCY RLDRW
MCCY RLDRWINT DUE   REPAY PRINREPAY INT PRIN INC  MATURITY  MATUR INT PR TFR FRM
PR TFR TO START     INT DUE   REPAY PRINREPAY INT MATURITY  MATUR INT PRIN INC
PR TFR FRMPR TFR TO INT DUE   MATUR INT PR TFR FRMPR TFR TO START     INT DUE
REPAY PRINREPAY INT MATURITY  MATUR INT PRIN INC  PR TFR FRMPR TFR TO MCCY RLPAY
MCCY RLDRWMCCY RLPAYMCCY RLDRWMCCY RLPAYMCCY RLDRWMCCY RLPAYMCCY RLDRWMCCY RLPAY
MCCY RLDRWTRANSFER  TRANSFER  VALUE     VALUE     OP MAT    OP MAT    OP VALUE
OP VALUE  SW VALUE  SW VALUE  START     INCREASE  INT PAY   MATURITY  DECREASE
START     INCREASE  INT PAY   MATURITY  DECREASE  N/A VALUE N/A VALUE INT PAY
MATURITY  N/A SALE  SETTLEMENTINTEREST  INTEREST  INTEREST  START     START
START     START     START     START     START     INT DUE   INT DUE   INT DUE
INT DUE   INT DUE   REPAY PRINREPAY PRINREPAY PRINREPAY PRINREPAY INT REPAY INT
REPAY INT REPAY INT PRIN INC. MATURITY  MATURITY  MATURITY  MATURITY  MATURITY
MATURITY  MATURITY  START INT START INT START INT GTEE FEE  MATUR INT MATUR INT
MATUR INT MATUR INT PRIN INC. PRIN INC. PRIN INC. RVER DSC. MATUR INT MATUR INT
     X/COPY WNCPYSRC,GL0580X003
MATUR INT MATUR INT MANUAL    CLS PAY   CLS RCV   BUY-OUT   VALUE     VALUE
MATURITY  MATURITY                                DR XFER   CR XFER                           CAP204
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** TABCD2 - Event Codes for CLE028 (Rule of 78)                                               CLE028
80V180R180R280M180M2                                                                          CLE028
** TABNM2 - Event Narratives for CLE028 (Rule of 78)                                          CLE028
VALUE DATEREPAY PRINREPAY INT MATUR PRINMATUR INT                                             CLE028
** TABCD3 - Event Codes for CAP205                                                            CAP205
15M416M441S141R341R442S881A282A283A230P130S121N121N221C122C122S131P131S1                      CAP205
61R762R763R764R765R766R767R770R762R963R964R968R768R969R769R972R772R961R9                      CAP205
66R967R971R765R915MZ16MZ70R971R923C323S397P1                                                  CAP205
     X/COPY WNCPYSRC,GL0580X001
