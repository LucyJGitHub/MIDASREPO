0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Creation of Online Positions File')              *
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Dealing Module
0004 F*                                                               *
0005 F*  GL0610 - CREATION OF ONLINE POSITIONS FILE                   *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CGL187             Date 06Oct17               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 10Jan96               *
      *                 S01408             Date 20Jan95               *
     F*                 046303             DATE 16JAN94               *
0004 F*                 E38323             DATE 30JUL92               *
0004 F*                 S01314             DATE 28MAR91               *
0004 F*                 E22608             DATE 04SEP90               *
0004 F*                 LN0755             DATE 14SEP90               *
0004 F*                 BHF463             DATE 25SEP90               *
0004 F*                 LN0135             DATE 23MAY90               *
0004 F*                 S01117             DATE  4/05/89              *
0004 F*                 S01194             DATE  4/05/89              *
     F*                 S01195             DATE  4/05/89              *
     F*                 E10217             DATE 29/12/86              *
     F*                                                               *
0004 F*                                                               *
0004 F*---------------------------------------------------------------*
0004 F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL187 - Amendment to Net Trading Position Report.           *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  S01408 - Addition of core hook GL0610FFP1                    *
     F*           Addition of core hook GL0610CCP1                    *
     F*           Addition of core hook GL0610CCP2                    *
     F*  S01408 - Addition of core hook GL0610FFPG                    *
     F*           Addition of core hook GL0610OOPG                    *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
0004 F*  E38323 - Recompiled due to a change in copy source ZFWDT SR  *
0004 F*  S01314 - CHGS MADE DURING PTF INCORPORATION                  *
0004 F*  E22608 - PROGRAM RENAMED FROM DL0610                         *
     F*  LN0755 - BRANCH CODE NOT SET UP ON OLPOSOB                   *
     F*  BHF463 - FOR BASE CCY SPOT POSITION, PROGRAM SHOULD USE      *
0004 F*           EQUIV. SPOT A/C CODE INSTEAD OF SWAP A/C CODE       *
     F*  LN0135 - REMOVE 'END OF REPORT' FROM AUDIT REPORT            *
0004 F*  S01117 - MULTIBRANCHING                                      *
0004 F*  S01194 - NEW STANDING DATA                                   *
0004 F*  S01195 - NEW HOLIDAYS PROCESSING                             *
0004 F*  E10217 - PHASA NOW REDUNDANT                                 *
0004 F*                                                               *
0010 F*****************************************************************
0004 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
/****F***OVRDBF*TABLE*TABDLEE***************************************: *   S01194
/****F*:*OVRDBF*TABLC*TABDLEI***************************************: *   S01194
     F*                                                               *
     F*****************************************************************
0011 F*HASA***IP**F      32            DISK                               E10217
0012 F*TABLE***IF**F******96**2AI*****2 DISK***************************   S01194
     F*TABLC***IF**F******96 12AI     2 DISK                              S01194
     FSDBRCHL0IF  E           K        DISK                               S01194
     F*DCURRL0IF  E           K        DISK                        S01194 S01314
     FSDCURRL1IF  E           K        DISK                               S01314
0014 F*ACCNT***IF**F*****400 15AI     2 DISK                              S01117
0014 F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     FACCNT   IF  F     573 24AI     2 DISK                                                   CGL029
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0610FFP1                                           S01408
     F*                                                                   S01408
0015 FOLPOSHH O   F     400            DISK
0015 FOLPOSOA O   F     400            DISK
0015 FOLPOSOB O   F     400            DISK
     FOLPOSOX0O   E                    DISK                           UC                      CGL187
      *                                                                                       CGL187
0016 F*L0610P1O***F*****132************PRINTER******************S01124    S01117
     F*DL0610AUO***F*****132************PRINTER*********************S01117E22608
     FGL0610AUO   F     132            PRINTER                            S02260
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0610FFPG                                           S01408
     F*                                                                   S01408
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F**01************TABLE FILE - HEADER                                 S01194
0019 F**02***********************- INST.CONT.DATA RECD.1                  S01194
0020 F**03***********************- INST.CONT.DATA RECD.3                  S01194
0021 F**04***********************- CURRENCIES RECD.1                      S01117
0022 F**10***********************- CURRENCIES RECD.2                      S01117
0023 F**05***********************- HOLIDAYS RECD.                         S01194
0024 F**06*************          - BRANCH CODES RECD.                     S01194
0025 F**07*************          - CATCHALL                               S01194
0026 F* 08            ACCOUNT MASTER FILE - DETAIL RECD.
0027 F* 09                                - CATCHALL
0028 F********20******END OF FILE ON TABLE                                S01194
0029 F********22******TABLE RECORD TYPE CHECK                             S01194
0030 F*       23      TABLE RECORD TYPE CHECK
0031 F*       24      CCY IS NOT A DEALING CCY
0032 F*       25      16TH WORKING DAY IN ARRAY
0033 F*       26      CHAIN FAIL TO ACCNT
0034 F*       27      CURRENCY IS BASE
0035 F*       28      READ CCY TABLE FIRST OF 2 TIMES,TO LOAD ARRAY OF    S01194
0036 F*                 BASE CCY EQUIVALENT A/C CODES                     S01194
0037 F*       29      WORK
0038 F*       60      EXCEPTION OUTPUT TO OLPOS - HEADER
0039 F*       62                                - DETAIL
0040 F*       64                                - TRAILER
0041 F*         U7&U8 DATABASE ERROR
     E                    CPY@    1   1 80                                S01194
0042 E                    HCCY       25  3               * HOLIDAY CCYS **
0043 E                    OLI        16 15 0
0044 E                    OLO        16 15 0
0045 E                    DAY        16  5 0
0046 E                    BCN      1000  6               BRCH.INT.CUSTNO
     E                    BRC      1000  3               BRANCH CODE      S01117
     E                    CMP      1000  3               COMPANY CODES    S01117
0047 E**********          SPC       150  4               SP.TR.EQUIV.A/CS                     CGL029
     E                    SPC       150 10                                                    CGL029
     E/COPY WNCPYSRC,GL0610E001
      *                                                                   S01194
     E/COPY ZSRSRC,ZHOLE                                                  S01195
0048 I*****PHASA FILE.                                                    E10217
0049 I*******                                                             E10217
0050 I*HASA** NS  01                                                      E10217
0051 I**********************************                                  S01194
0052 I*****TABLE FILE*-*CURRENCIES*RECORD*1.                              S01194
0053 I**********************************                                  S01194
0054 I*ABLE***NS**04***1*CD***2 C2   3 C0                                 S01194
0055 I*******AND******13*C1*************                                  S01194
0056 I**********************************      1   1 RECI                  S01194
0057 I**********************************      2   30RECT                  S01194
0058 I**********************************     10  12 CCYTAB                S01194
0059 I**********************************     13  130SREC                  S01194
0060 I**********************************     14  27 CCNM                  S01194
0061 I**********************************  P  28  348SPOT                  S01194
0062 I**********************************     35  37 CCYS                  S01194
0063 I**********************************     38  380CDP                   S01194
0064 I**********************************     39  390TNOT                  S01194
0065 I**********************************     40  40 DCCY                  S01194
0066 I**********************************     41  44 SRC1                  S01194
0067 I**********************************     45  48 SRC2                  S01194
0068 I**********************************     49  520TACC                  S01194
0069 I**********************************     53  560TEQV                  S01194
0070 I**********************************     57  600SWQV                  S01194
0071 I**********************************     61  640TAC4                  S01194
0072 I**********************************     65  680TAC5                  S01194
0073 I**********************************     69  69 HIND                  S01194
0074 I**********************************  P  70  768PART                  S01194
0075 I*****************************          77  780SSNO                  S01194
0076 I**********************************  P  79  858ERLC                  S01194
0077 I**********************************  P  90  920LCD                   S01194
0078 I**********************************     93  93 CHTP                  S01194
0079 I***********                         P  94  960TNLU                  S01194
0080 I**********************************                                  S01194
0081 I*****TABLE FILE - CURRENCIES RECORD 2.                              S01194
0082 I**********************************                                  S01194
0083 I******* NS**10***1*CD***2*C2***3*C0                                 S01194
0084 I*******AND******13*C2*************                                  S01194
0085 I**********************************      1   1 RECI                  S01194
0086 I**********************************      2   30RECT                  S01194
0087 I**********************************     10  12 CCY                   S01194
0088 I**********************************     13  130SREC                  S01194
0089 I**********************************     14  42 EURB                  S01194
0090 I**********************************  P  43  498HBER                  S01194
0091 I**********************************  P  90  920LCD                   S01194
0092 I**********************************     93  93 CHTP                  S01194
0093 I**********************************  P  94  960TNLU                  S01194
0094 I*****TABLE*FILE*-*BRANCH*CODES*RECORD.                              S01194
0095 I**********************************                                  S01194
0096 I********NS**06***1*CD***2*C1***3 C0                                 S01194
0097 I**********************************      1   1 RECI                  S01194
0098 I**********************************      2   30RECT                  S01194
0099 I**********************************     11  130BRCD                  S01194
0100 I**********************************     14  43 BRNM                  S01194
0101 I**********************************     44  490BICN                  S01194
0102 I**********************************     50  51 LOCC                  S01194
0103 I**********************************     52  53 CMPY                  S01194
0104 I**********************************  P  90  920LCD                   S01194
0105 I**********************************     93  93 CHTP                  S01194
0106 I**********************************  P  94  960TNLU                  S01194
0107 I**********************************                                  S01194
0108 I*****CATCHALL**********************************                     S01194
0109 I********NS**07**********************************                    S01194
0110 I**********************************      1   1 RECI                  S01194
0111 I**********************************      2   30RECT                  S01194
0112 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0113 I**********************************                                  S01194
0114 I*TABLC***NS**02***2*C0***3*C1**12*C1*****************************   S01194
0115 I*******AND******13*C0********************************************   S01194
0116 I*************************************** 1   1 RECI                  S01194
0117 I*************************************** 2   30RECT                  S01194
0118 I***************************************12  130RCDE                  S01194
0119 I***************************************14  66 TITL                  S01194
0120 I************************************** 67  67 DATF                  S01194
0121 I************************************** 68  700DFBR                  S01194
0122 I************************************** 74  74 MODI1                 S01194
0123 I************************************** 75  75 MODI2                 S01194
0124 I************************************   76  76 MODI3                 S01194
0125 I************************************P  77  790RUND                  S01194
0126 I************************************   80  86 RUNA                  S01194
0127 I***********************************    87  870SFLG                  S01194
0128 I********************************    P  90  920LCD                   S01194
0129 I********************************       93  93 CHTP                  S01194
0130 I********************************    P  94  960TNLU                  S01194
0131 I*********************************                                   S01194
0132 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*3.               S01194
0133 I*****************************************************************   S01194
0134 I*TABLC***NS**03***1*CD***2*C0***3*C1********************            S01194
0135 I*******AND******12*C2**13*C0************************************    S01194
0136 I****************************************1***1 RECI                  S01194
0137 I*************************************** 2   30RECT                  S01194
0138 I*************************************  12  130RCDE                  S01194
0139 I*************************************  14  170COMS                  S01194
0140 I************************************   18  210CADC                  S01194
0141 I*********************************** P  22  240MDIC                  S01194
0142 I**********************************  P  25  270MCIC                  S01194
0143 I*********************************   P  28  300MDIA                  S01194
0144 I*********************************   P  31  330MCIA                  S01194
0145 I********************************       34  370SRPL                  S01194
0146 I********************************       38  410SPAC                  S01194
0147 I*****************************          42  450SWAC                  S01194
0148 I**************************             46  490FTAC                  S01194
0149 I************************               50  530TAC4                  S01194
0150 I************************               54  570TAC5                  S01194
0151 I*********************               P  63  650NOBA                  S01194
0152 I************************            P  66  680TSIZ                  S01194
0153 I*************************              69  69 RACN                  S01194
0154 I***************************            70  700GLSI                  S01194
0155 I*****************************          71  710RTSI                  S01194
0156 I*******************************        72  720DLSI                  S01194
0157 I********************************       73  730NOSI                  S01194
0158 I*********************************      74  740CTSI                  S01194
0159 I**********************************  P  75  770ELAC                  S01194
0160 I************************************P  78  800ECAC                  S01194
0161 I********************************    P  90  920LCD                   S01194
0162 I******************************         93  93 CHTP                  S01194
0163 I*****************************       P  94  960TNLU                  S01194
0164 I**************************                                          S01194
0165 I*****TABLE FILE*-*INSTALLATION*CONTROL*DATA*RECORD 5.               S01194
0166 I****************************************                            S01194
0167 I*TABLC***NS**10***1*CD***2*C0***3*C1******************              S01194
0168 I*******AND******12*C4**13*C0************************                S01194
0169 I**************************************  1   1 RECI                  S01194
1170 I*************************************   2   30RECT                  S01194
0171 I*************************************  12  130RCDE                  S01194
0172 I************************************** 18  210CSAC                  S01194
0173 I*************************************  22  22 TLII                  S01194
0174 I************************************   23  23 MCRI                  S01194
0175 I*********************************** P  24  250MCEP                  S01194
0176 I*********************************      26  270MCLP                  S01194
0177 I******************************         28  28 FRDI                  S01194
0178 I***************************            29  29 BRCF                  S01194
0179 I***********************                30  350PSCN                  S01194
0180 I*********************                  36  380DLBR                  S01194
0181 I*****************                      39  420FRPA                  S01194
0182 I***********                            43  460FRPC                  S01194
0183 I*********************                  47  49 USCY                  S01194
0184 I*********************                  50  52 STCY                  S01194
0185 I*********************               P  53  553MBGE                  S01194
0186 I*********************               P  90  920LCD                   S01194
0187 I*********************                  93  93 CHTP                  S01194
0188 I*********************               P  94  960TNLU                  S01194
0189 I*****TABLE*FILE*-*INSTALLATION CONTROL DATA RECORD 2.               S01194
0190 I*****************************************************               S01194
0191 I******* NS  11   1 CD   2 C0   3 C1                                 S01194
0192 I****** AND      12 C1  13 C1                                        S01194
0193 I*************************************** 1   1 RECI                  S01194
0194 I*************************************** 2   30RECT                  S01194
0195 I************************************** 12  130RCDE                  S01194
0196 I************************************   14  16 BCCY                  S01194
0197 I**********************************     17  19 BCYL                  S01194
0198 I*********************************      20  22 HOCY                  S01194
0199 I*******************************        23  280HEAD                  S01194
0200 I*****************************       P  29  310APDA                  S01194
0201 I*****************************          35  35 APFQ                  S01194
0202 I*******************************     P  36  380LOGS                  S01194
0203 I********************************       39  40 CUZR                  S01194
0204 I**********************************  P  41  430DNWD                  S01194
0205 I*******************************        44  460BVLP                  S01194
0206 I*******************************        47  49 LOCY                  S01194
0207 I********************************       50  510FDAY                  S01194
0208 I*********************************      86  86 ISAV                  S01194
0209 I*******************************     P  87  890LLOG                  S01194
0210 I********************************    P  90  920LCD                   S01194
0211 I*********************************      93  93 CHTP                  S01194
0212 I**********************************  P  94  960TNLU                  S01194
0213 I**************************************************************      S01194
0214 I****                                                                S01194
0215 I****                                                                S01194
0216 I**** TABLE FILE - HOLIDAY RECORD.                                   S01194
0217 I***     E-EXCLUDE, I-INCLUDE.                                       S01194
0218 I***                                                                 S01194
0219 I*TABLC***NS****** 1 CD   2 C2   3 C2                                S01194
0220 I*******AND      14 CE                                               S01194
0221 I****** OR        1 CD   2 C2   3 C2                                 S01194
0222 I****** AND      14 CI                                               S01194
0223 I*************************************** 1   1 RECI                  S01194
0224 I**************************************  2   30RECT                  S01194
0225 I*************************************   8  120HOL                   S01194
0226 I************************************   13  130SREC                  S01194
0227 I**********************************     14  14 INEX                  S01194
0228 I********************************       15  89 HCCY                  S01194
0229 I**********************************  P  90  920LCD                   S01194
0230 I************************************   93  93 CHTP                  S01194
0231 I*********************************** P  94  960TNLU                  S01194
0232 I*******************************************************             S01194
0233 I*****CATCH*ALL***************************************               S01194
0234 I********NS***********************************                       S01194
0235 I**********************************      1   1 RECI                  S01194
0236 I**************************************  2   30RECT                  S01194
0237 I**
0238 I*    ACCOUNT MASTER DETAIL RECORD
0239 I**
0240 IACCNT   NS  08   1 CD
1111 I                                        1   1 RECI
0242 I                                        2  16 ACMDKY
0243 I**********                              2   70CNUM                                      CSD027
0243 I                                        2   7 CNUM                                      CSD027
0244 I                                        8  10 CCY
0245 I**********                             11  140ACOD                                      CGL029
     I                                       11  140ACODQQ                                    CGL029
0246 I                                       15  160ACSQ
0247 I***************************************23  250BRCD                  S01194
0247 I                                       23  25 BRCA                  S01194
0248 I                                       26  26 ATYP
0249 I                                       27  27 STYP
0250 I                                       29  29 ACST
0251 I                                    P  30  320DACO
0252 I                                    P  33  350DACC
0253 I                                       36  55 ANAM
0254 I                                    P  56  630LDBLAC
0255 I                                    P  64  710CLBL
0256 I                                       72  72 STFQ
0257 I                                       73  740STDY
0258 I                                    P  75  770LSTD
0259 I                                    P  78  800NSTD
0260 I                                    P  81  820LSTP
0261 I                                    P  83  900CFSB
0262 I                                    P  91  930LMVD
0263 I                                    P  94 1010EPLB
0264 I                                    P 102 1090EPCB
0265 I                                    P 110 1170YTDB
0266 I                                      118 118 GLBT
0267 I                                    P 138 1400DLIM
0268 I                                    P 141 1430LRCR
0269 I                                    P 144 1510RTCB
0270 I                                    P 152 1590RTLB
0271 I                                    P 160 1660DITM
0272 I                                    P 167 1730CITM
0273 I                                    P 178 1837CDIR
0274 I                                    P 184 1897CCIR
0275 I                                    P 178 1837CDIR
0276 I                                    P 184 1897CCIR
0277 I                                      190 1990ACNO
0278 I                                      200 200 RETB
0279 I                                      201 201 ODSC
0280 I                                    P 202 2070ODLN
0281 I                                    P 208 2100ODED
0282 I                                    P 211 2120DIOD
0283 I                                      213 2150FACT
0284 I                                      216 2170FCNO
0285 I                                      218 219 EFAC
0286 I                                    P 220 2270HELD
0287 I                                    P 228 2330MINB
0288 I                                    P 234 2360LACD
0289 I                                    P 237 2380LISP
0290 I                                    P 239 2410RRNM
0291 I**********                            242 2430DRIB                                      CSD103
0291 I                                      242 243 DRIB                                      CSD103
0292 I                                    P 244 2497DRIS
0293 I                                    P 250 2520DRCD
0294 I                                      253 2530DRIC
0295 I                                      254 254 DRIF
0296 I                                      255 2560DRDY
0297 I                                    P 257 2590NDID
0298 I                                    P 260 2620LDID
0299 I                                    P 263 2690LDIA
0300 I                                      270 270 SDAP
0301 I                                    P 271 2730LPAR
0302 I                                    P 274 2800DIIE
0303 I                                    P 281 2882DAIC
0304 I                                    P 289 2950MADI
0305 I                                    P 296 3020GADI
0306 I                                      303 303 DDIS
0307 I                                    P 304 3060DDIA
0308 I                                    P 307 3090OLDR
0309 I**********                            310 3110OLDB                                      CSD103
0309 I                                      310 311 OLDB                                      CSD103
0310 I                                    P 312 3177OLDS
0311 I**********                            318 3190CRIB                                      CSD103
0311 I                                      318 319 CRIB                                      CSD103
0312 I                                    P 320 3257CRIS
0313 I                                    P 326 3280CRCD
0314 I                                      329 3290CRIC
0315 I                                      330 330 CRIF
0316 I                                      331 3320CRDY
0317 I                                    P 333 3350NCID
0318 I                                    P 336 3380LCID
0319 I                                    P 339 3450LCIA
0320 I                                      346 346 SCAP
0321 I                                    P 347 3490LPAP
0322 I                                    P 350 3560CIIE
0323 I                                    P 357 3642CAIC
0324 I                                    P 365 3710MACI
0325 I                                    P 372 3780GACI
0326 I                                      379 379 CDIS
0327 I                                    P 380 3820DCIA
0328 I                                    P 383 3850OLCR
0329 I**********                            386 3870OLCB                                      CSD103
0329 I                                      386 387 OLCB                                      CSD103
0330 I                                    P 388 3937OLCS
0331 I                                    P 394 3960LCD
0332 I                                      397 397 CHTP
0333 I                                    P 398 4000TNLU
     I                                      554 5630ACOD                                      CGL029
0334 I**
0335 I*    CATCHALL FOR DELETED RECORDS
0336 I**
0337 I        NS  09
0338 I*
0339 I*    DATA STRUCTURE FOR A/C MASTER KEY
0340 I            DS
0341 I****************************************1  15 KEYB                  S01117
0341 I**********                              1  18 KEYB                               S01117 CGL029
     I                                        1  24 KEYB                                      CGL029
0342 I                                        1   9 KEYB1
0343 I**********                             10  15 KEYB2                                     CGL029
     I**********                             16  18 KEYB3                              S01117 CGL029
     I                                       10  21 KEYB2                                     CGL029
     I                                       22  24 KEYB3                                     CGL029
     ISDBANK    E DSSDBANKPD                                              S01194
      *  EXTERNAL DS FOR BANK DETAILS                                     S01194
      *                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
      *  EXTERNAL DS FOR TRADING DETAILS                                  S01194
      *                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I/COPY WNCPYSRC,GL0610I001
      *                                                                   S01194
      /COPY ZSRSRC,ZHOLDS                                                 S01195
      *                                                                   S01194
     IERROR       DS                             30
     I** DATA STRUCTURE FOR DB ERROR FIELDS - OUTPUT TO SPOOL FILE        S01194
      *                                                                   S01194
     I                                        1   8 DBFILE                S01194
     I                                       10  16 DBOPTN                S01194
     I                                       17  28 DBKEY                 S01194
     I                                       29  30 DBASE                 S01194
      *                                                                                       CGL029
      ** Define a constant containing 10 zeros for A/C code comparison                        CGL029
      *                                                                                       CGL029
     I              '0000000000'          C         WZEROS                                    CGL029
      /COPY ZSRSRC,ZHOLI                                                  S01195
     C                     MOVEACPY@      BIS@   80                       S01194
0344 C**
0345 C** DETAIL PROCESSING
0346 C**
0347 C***01********        SETON                     LR                   E10219
0347 C                     SETON                     LR                   E10219
0348 C**
0349 C** LAST RECORD PROCESSING - ONE RPG CYCLE ONLY
0350 C**
0351 CLR                   Z-ADD0         Z15    150
0352 CLR                   Z-ADD0         ZERO05  50
0353 CLR                   Z-ADD0         OLI
0354 CLR                   Z-ADD0         OLO
0355 CLR                   MOVE '01'      KEYB2
0356 C**
0357 C***SET*UP*KEY*&*READ*INST.CONT.RECDS.1,2,3&5*********************   S01194
0358 C**                                                                  S01194
0359 C*R*******************MOVEL'01    '  KEY    12                       S01194
0360 C*R*******************MOVE '    10'  KEY                             S01194
0361 C*R*********KEY*******CHAINTABLC                20                   S01194
0362 C*RN02****************MOVELKEY       ERROR  15                       S01194
0363 C*RN02****************GOTO QERROR                                    S01194
0364 C*R*******************MOVE '    11'  KEY                             S01194
0365 C*R*********KEY*******CHAINTABLC                20                   S01194
0366 C*RN11****************MOVELKEY       ERROR                           S01194
0367 C*RN11****************GOTO QERROR                                    S01194
0368 C***************************                                         S01194
0369 C*R*******************MOVE '    20'  KEY                             S01194
0370 C*R*********KEY*******CHAINTABLC                20                   S01194
0371 C*RN03****************MOVELKEY       ERROR                           S01194
0372 C*RN03****************GOTO QERROR                                    S01194
0373 C**                                                                  S01194
0374 C*R*******************MOVE '      40'KEY                             S01194
0375 C*R*********KEY*******CHAINTABLC                20                   S01194
0376 C*RN10****************MOVELKEY       ERROR                           S01194
0377 C*RN10****************GOTO QERROR                                    S01194
     C*                                                                   S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     CLR                   CALL 'AOBANKR0'                                S01194
     CLR                   PARM '*MSG   ' @RTCD   7                       S01194
     CLR                   PARM '*FIRST ' @OPTN   7                       S01194
     CLR         SDBANK    PARM SDBANK    DSFDY                           S01194
     CLR         @RTCD     IFNE *BLANK                                    S01194
     CLR                   MOVEL'SDBANKPD'DBFILE           ************   S01194
     CLR                   MOVEL'01'      DBASE            * DBERR 01 *   S01194
     CLR                   MOVEL@OPTN     DBOPTN           ************   S01194
     CLR                   MOVEL@OPTN     DBKEY                           S01194
     CLR                   GOTO QERROR                                    S01194
     CLR                   END                                            S01194
     C*                                                                   S01194
     C** READ TRADING DETAILS VIA ACCESS PROGRAM                          S01194
     CLR                   CALL 'AOTRADR0'                                S01194
     CLR                   PARM '*MSG   ' @RTCD                           S01194
     CLR                   PARM '*FIRST ' @OPTN                           S01194
     CLR         SDTRAD    PARM SDTRAD    DSFDY                           S01194
     CLR         @RTCD     IFNE *BLANK                                    S01194
     CLR                   MOVEL'SDTRADPD'DBFILE           ************   S01194
     CLR                   MOVEL'02'      DBASE            * DBERR 02 *   S01194
     CLR                   MOVEL@OPTN     DBOPTN           ************   S01194
     CLR                   MOVEL@OPTN     DBKEY                           S01194
     CLR                   GOTO QERROR                                    S01194
     CLR                   END                                            S01194
      *                                                                                       CGL187
      ** Access Switchable Features File for CGL187                                           CGL187
      *                                                                                       CGL187
     CLR                   CALL 'AOSARDR0'                                                    CGL187
     CLR                   PARM *BLANKS   @RTCD                                               CGL187
     CLR                   PARM '*VERIFY' @OPTN                                               CGL187
     CLR                   PARM 'CGL187'  WSARD   6                                           CGL187
      *                                                                                       CGL187
     CLR                   MOVE 'N'       CGL187  1                                           CGL187
     CLR         @RTCD     IFEQ *BLANK                                                        CGL187
      *                                                                                       CGL187
     CLR                   MOVE 'Y'       CGL187                                              CGL187
     CLR                   OPEN OLPOSOX0                                                      CGL187
      *                                                                                       CGL187
     CLR                   Z-ADD0         TTFOT  150                                          CGL187
     CLR                   Z-ADD0         WWWKFL 150                                          CGL187
      *                                                                                       CGL187
     CLR                   ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,GL0610C001
0378 C**
0379 C** SET UP KEYS TO READ BRANCH CODES & CHAIN TO ACCOUNTS MASTER
0380 C**
0381 CLR                   Z-ADD0         X       30
0382 C*R*******************MOVEL'10      'KEYA   12        ** OBTAIN *****S01194
0383 C*R*******************MOVE ' 001'    KEYA             ** DEALING ****S01194
0384 C*R*********KEYA******SETLLTABLE                      ** BRANCH NO. *S01194
0384 CLR         *LOVAL    SETLL@A8REB1                                   S01194
0385 CLR         READ1     TAG                             ** READ1**
0386 C*R*******************EXSR READT                                     S01194
     CLR                   READ @A8REB1                  20               S01194
0387 C*R*********RECI******COMP 'D'                      23               S01194
0388 C*R*********RECT******COMP 10                       22               S01194
0389 C*R*22N23*************GOTO READ1                      DEL BRANCH     S01194
0390 C*RN22**********************************                             S01194
0391 C*R*20****************GOTO HEADO                                     S01194
0391 CLR 20                GOTO HEADO                                     S01194
0392 C*RN06****************GOTO READ1                                     S01194
0393 C**
0394 C**
0395 C*R*06******X*********ADD  1         X                               S01194
0395 CLR         X         ADD  1         X                               S01194
0396 C*R*06****************MOVE BICN      BCN,X            ** SET UP KEY *S01117
0396 CLR                   MOVE A8BICN    BCN,X            ** SET UP KEY *S01117
0396 C*R*06****************MOVE BRCD      BRC,X            ** SET UP KEY* S01117
0396 CLR                   MOVE A8BRCD    BRC,X            ** SET UP KEY* S01117
0396 CLR                   MOVE A8CMCD    CMP,X                           S01117
0397 CLR                   GOTO READ1
0398 CLR         HEADO     TAG                             ** HEADO **
0399 C**
0400 C** OUTPUT HEADER RECORD TO OLPOS FILE & INCREMENT COUNT
0401 CLR         COUNT     ADD  1         COUNT   50
0402 CLR                   SETON                     60
0403 CLR                   EXCPT
0404 CLR                   SETOF                     60
0405 C**
0406 C***SET*LOWER*LIMITS*ON*THE*CURRENCIES*TABLE
0407 C**
0408 C*R*******************MOVEL'20    '  KEY                             S01194
0409 C*R*******************MOVE '     1'  KEY                             S01194
0410 C**  SET INDEX FOR SPOT TRADE EQUIV.A/C CODE ARRAY
0411 CLR                   Z-ADD0         Y       30
0412 CLR                   SETON                     28                   S01194
0413 C**
0414 C** LOOP TO READ CURRENCIES TABLE                                    S01194
0415 C**   1. TO LOAD ARRAY OF EQUIV. A/C CODES  IND. 28 ON               S01194
0416 C**   2. TO FIND*SPOT TRADE A/C BALANCES FOR ALL CCYS - IND. 28 OFF  S01194
0417 C**
0419 CLR         SECOND    TAG                             ** SECOND **
0420 C**
0421 C*R*******************EXSR SETLO                                     S01194
0406 C** SET LOWER LIMITS ON THE CURRENCIES FILE
0421 CLR         *LOVAL    SETLL@A6REA3                                   S01194
0418 C**
0422 CLR         READ2     TAG                             ** READ2 **
0423 CLR                   Z-ADD0         N       20
0424 C*R*******************SETOF                     04                   S01194
0425 C*R*******************EXSR READT                                     S01194
     CLR                   READ @A6REA3                  20               S01194
0426 C*R*********RECI      COMP 'D'                      23               S01194
0427 C*R*********RECT      COMP 20                       22               S01194
0428 C*R 22N23**********   GOTO READ2                      DEL CCY        S01194
0429 C*RN22N28*********                                    END OF TABLE   S01194
0430 CLR 20N28             GOTO ENDD                       END OF FILE    S01194
0431 C*RN22*28************                                                S01194
0432 CLR 20 28             SETOF                     28
0433 C*RN22***************                                                S01194
0434 C*R*20*************** GOTO SECOND                     SECOND READ    S01194
0434 CLR 20N28             GOTO SECOND                     SEC.READ       S01194
0435 C*RN04*************** GOTO READ2                                     S01194
0436 C*R*********DCCY******COMP 'Y'                  2424                 S01194
0436 CLR         A6DLCI    COMP 'Y'                  2424                 S01194
0437 CLR 24                GOTO READ2
0438 CLRN28                GOTO ACBAL                      SECOND READ
0439 C**
0440 C*********************
0441 C**
0442 C**   LOAD EQUIV.ARRAY.
0443 C*R*********CCYTAB    COMP BCCY                     27               S01194
0444 C*R*********TACC      COMP 0000                     29               S01194
0443 CLR         A6CYCD    COMP BJCYCD                   27               S01194
0444 C*R         A6SWAE    COMP *BLANKS                  29         S01194BHF463
     C/COPY WNCPYSRC,GL0610C002
0444 CLR         A6SPAE    COMP *BLANKS                  29               BHF463
     C/COPY WNCPYSRC,GL0610C003
0445 CLR 27
0446 COR 29                GOTO READ2
0447 CLR         Y         COMP 150                  29  29
0448 C*R*29****************MOVEL'TOO MANY'ERROR                           S01117
0449 C*R*29****************MOVE 'CCYS   ' ERROR                           S01117
0448 CLR 29                MOVEL'TOO MANY'DBKEY                           S01117
0449 CLR 29                MOVE 'CCYS'    DBKEY                           S01117
0450 CLR 29                GOTO QERROR
0451 CLR         Y         ADD  1         Y
0452 C*R*******************MOVE TACC      SPC,Y                           S01194
0452 C*R                   MOVE A6SWAE    SPC,Y                     S01194BHF463
0452 CLR                   MOVE A6SPAE    SPC,Y                           BHF463
     C/COPY WNCPYSRC,GL0610C006
0453 CLR                   GOTO READ2
0454 C*********************
     C/COPY WNCPYSRC,GL0610C004
0455 CLR         ACBAL     TAG                             ** ACBAL **
0456 C**
0457 C***CALCULATE*NEXT*16*WORKING*DAYS*VIA*ZDATE3                        S01194
0457 C** CALCULATE NEXT 16 WORKING DAYS VIA ZFWDT                         S01194
0458 C**
0459 C*R*********BCCY******COMP CCYTAB                   27               S01194
0443 CLR         A6CYCD    COMP BJCYCD                   27               S01194
0460 CLR                   Z-ADD0         DAY
0461 CLR                   Z-ADD1         ZNRDYS
0461 CLR                   MOVE BJSLCD    ZLOC                            S01195
0462 C*R*******************Z-ADDRUND      ZDYNBR                          S01194
0462 CLR                   Z-ADDBJRDNB    ZDYNBR                          S01194
0463 CLR         HOLTAG    TAG
0464 CLR         N         ADD  1         N
0461 CLR                   Z-ADD1         ZNRDYS                          S01117
0465 CLR                   Z-ADDZDYNBR    ZDAYNO
0466 C*R*******************MOVE CCYTAB    ZCCY                            S01194
0466 CLR                   MOVE A6CYCD    ZCCY                            S01194
0467 C*R*******************EXSR ZDATE3                                    S01195
0467 CLR                   EXSR ZFWDT                                     S01195
0468 CLR                   MOVE ZDYNBR    DAY,N
0469 CLR         N         COMP 16                       25
0470 CLRN25                GOTO HOLTAG
0471 C*R*******************MOVE CCYTAB    KEYB1                           S01194
0471 CLR                   MOVE A6CYCD    KEYB1                           S01194
0472 C*R*********          Z-ADD0         TOTBAL 150                      S01117
0473 CLR                   Z-ADD1         X
0474 CLR         LOOP      TAG                             ** LOOP **:
0472 CLR                   Z-ADD0         TOTBAL 150                      S01117
0475 CLR                   MOVELBCN,X     KEYB1
0475 CLR                   MOVELBRC,X     KEYB3                           S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0610CCP1                                           S01408
     C*                                                                   S01408
0476 C**
0477 CLR 27                EXSR EQUIV                      CCY IS BASE
0478 C**
0479 C**
     CLR                   SETOF                     0809
0480 C*RN27****************MOVELSPAC      KEYB2            CCY NOT BASE   S01194
0480 CLRN27                MOVELBLSPTA    KEYB2            CCY NOT BASE   S01194
0481 CLRN27      KEYB      CHAINACCNT                26
0482 C*                                                                   S01117
0483 C*    REVERSE SIGN OF LDBL                                           S01117
0484 C*                                                                   S01117
0485 C**                                                                  S01117
     CLR 08N27   TOTBAL    SUB  LDBLAC    TOTBAL                          S01117
0482 C*************************                                           S01117
0483 C*****REVERSE*SIGN*OF*LDBL                                           S01117
0484 C*************************                                           S01117
     C*R*08N27***TOTBAL    SUB  LDBLAC    TOTBAL                          S01117
0487 C*R*********X         ADD  1         X                               S01117
0488 C*R*********BCN,X     COMP '000000'             5353                 S01117
0489 C*R*53******BCN,X     COMP '      '             5353                 S01117
0490 C*R*53******X         COMP 1000                   5353               S01117
0491 C*R*53******          GOTO LOOP                                      S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0610CCP2                                           S01408
     C*                                                                   S01408
0492 C**                                                                  S01117
0493 C***OUTPUT*3*DETAIL*RECORDS*TO*OLPOS*FILE                            S01117
     C**                                                                  S01117
0493 C***WRITE THREE RECORDS TO THE POSITIONS FILE                        S01117
0494 C**
0495 CLR                   SETON                     62
0496 CLR                   EXCPT
      *                                                                                       CGL187
     CLR         CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     CLR                   MOVE BRC,X     LBRCA                                               CGL187
     CLR                   MOVE A6CYCD    LCCY                                                CGL187
     CLR                   MOVE '01'      LRECN                                               CGL187
     CLR                   WRITEOLPOSOD0                                                      CGL187
      *                                                                                       CGL187
     CLR                   MOVE BRC,X     LBRCA                                               CGL187
     CLR                   MOVE A6CYCD    LCCY                                                CGL187
     CLR                   MOVE '02'      LRECN                                               CGL187
     CLR                   WRITEOLPOSOD0                                                      CGL187
      *                                                                                       CGL187
     CLR                   MOVE BRC,X     LBRCA                                               CGL187
     CLR                   MOVE A6CYCD    LCCY                                                CGL187
     CLR                   MOVE '03'      LRECN                                               CGL187
     CLR                   WRITEOLPOSOD0                                                      CGL187
      *                                                                                       CGL187
     CLR                   ENDIF                                                              CGL187
      *                                                                                       CGL187
0497 CLR                   SETOF                     62
0498 C**
0499 C** INCREMENT COUNT OF RECDS.READ & HASH TOTAL BALANCE VALUES
0500 C**
0501 CLR         COUNT     ADD  3         COUNT
0502 CLR         TOTBAL    DIV  1000      ZZAMT        52
0503 CLR 52                Z-SUBZZAMT     ZZAMT
0504 CLR                   MOVE TOTI      ZZTOTI
0505 CLR                   MOVE TOTD      ZZTOTD
0506 CLR                   EXSR GLZADD
0507 CLR                   MOVE ZZTOTI    TOTI   150
0508 CLR                   MOVE ZZTOTD    TOTD    30
     C**                                                                  S01117
     C** GET NEXT BRANCH AND INTERNAL CUSTOMER NUMBER                     S01117
     C**                                                                  S01117
0487 CLR         X         ADD  1         X                               S01117
0488 CLR         BCN,X     COMP '000000'             5353                 S01117
0489 CLR 53      BCN,X     COMP '      '             5353                 S01117
0490 CLR 53      X         COMP 1000                   5353               S01117
0491 CLR 53                GOTO LOOP                                      S01117
0509 C**
0510 C** GO BACK THRU LOOP TO READ NEXT CURRENCIES RECORD
0511 C**
0512 CLR                   GOTO READ2
0513 C**   SET ERROR INDICATORS
0514 CLR         QERROR    TAG                             ** ERROR TAG **
0515 C*R*******************SETON                     U7U8                 S01194
     CLR                   EXSR *PSSR                                     S01194
0516 CLR                   GOTO ENDALL
0517 C**
0518 CLR         ENDD      TAG
0519 C**
0520 C** INCREMENT COUNT & OUTPUT TRAILER
0521 C**
0522 CLR         COUNT     ADD  1         COUNT
0523 CLR                   SETON                     64
0524 CLR                   EXCPT
0525 CLR                   SETOF                     64
0526 C**
0527 CLR         ENDALL    TAG
0528 C**
0529 C********************************************************************
0530 C**   EQUIV SR TO GET A/C BALS.FROM SPOT TRADE EQUIV.A/CS
0531 C**
0532 C           EQUIV     BEGSR                           ** EQUIV **
0533 C                     Z-ADD1         Y
0534 C           EQV       TAG                             ** EQV **
     C                     SETOF                     0809
0535 C                     MOVELSPC,Y     KEYB2
0536 C           KEYB      CHAINACCNT                26
0537 C   08      TOTBAL    SUB  LDBLAC    TOTBAL
0538 C           Y         ADD  1         Y
0539 C********** SPC,Y     COMP '    '               5353                                     CGL029
0540 C***53***** SPC,Y     COMP '0000'               5353                                     CGL029
0539 C           SPC,Y     COMP *BLANKS              5353                                     CGL029
0540 C   53      SPC,Y     COMP WZEROS               5353                                     CGL029
0541 C   53      Y         COMP 151                    53
0542 C   53                GOTO EQV
0543 C                     ENDSR
0544 C**
     C/COPY WNCPYSRC,GL0610C005
0545 C*****************************************************************   S01194
0546 C*****SR.*TO*SET*LOWER*LIMITS*ON TABLE FILE                          S01194
0547 C***********SETLO     BEGSR                           *** SETLO ***  S01194
0548 C**********************************                                  S01194
0549 C********** KEY       SETLLTABLE                                     S01194
0550 C**********************************                                  S01194
0551 C******************** ENDSR                                          S01194
0552 C**********************************                                  S01194
0553 C********************************************************************S01194
0554 C*****SR. TO READ TABLE FILE                                         S01194
0555 C***********READT*****BEGSR                           *** READT ***  S01194
0556 C**********************************                                  S01194
0557 C*********************READ TABLE                    20               S01194
0558 C**********************************                                  S01194
0559 C*********************ENDSR                                          S01194
0560 C**********************************                                  S01194
0561 C********************************************************************S01195
0562 C**********************************                                  S01195
0563 C*****ZDATE3*SR.*TO CALCULATE ANY NUMBER OF WORKING                  S01195
0564 C****************DAYS FORWARD IN ANY CURRENCY.                       S01195
0565 C**********************************                                  S01195
0566 C*********THIS SR. CAN BE USED WHEN THE INPUT CYCLE IS RUNNING AS    S01195
0567 C*********HOLIDAY RECORDS ARE ACCESSED BY CHAIN. THEREFORE NEWLY     S01195
0568 C*********ADDED RECORDS IN THE OVERFLOW AREA CAN ALSO BE ACCESSED.   S01195
0569 C**********************************                                  S01195
0570 C***********ZDATE3    BEGSR                           *** ZDATE3 *** S01195
0571 C**********************************                                  S01195
0572 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           S01195
0573 C*********************Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
0574 C*********************MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
0575 C******************** Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
0576 C***********************************                  DAYS FORWARD   S01195
0577 C**** CLEAR COUNT OF NBR OF DAYS ADDED, & DEFINE ZDYNBR.             S01195
0578 C*********************Z-ADD0         ZDCNT   20                      S01195
0579 C*********************Z-ADDZDAYNO    ZDYNBR  50                      S01195
0580 C*********************                                               S01195
0581 C**** LOOP TO INCREMENT DAY NUMBER AND CHECK FOR HOLIDAY.            S01195
0582 C***********ZDLOP1    TAG                             ** ZDLOP1 TAG *S01195
0583 C*********************                                               S01195
0584 C*********************SETOF                     9596                 S01195
0585 C********** ZDYNBR    ADD  1         ZDYNBR                          S01195
0586 C*********************                                               S01195
0587 C**** SET KEY FOR FIRST HOLIDAY RECORD.                              S01195
0588 C*********************MOVEL'22    '  ZDHKEY 12                       S01195
0589 C*********************MOVELZDYNBR    ZWRK6   6                       S01195
0590 C*********************MOVE '1'       ZWRK6                           S01195
0591 C*********************MOVE ZWRK6     ZDHKEY                          S01195
0592 C*********************                                               S01195
0593 C*****CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2                        S01195
0594 C***********ZDHCHN    TAG                             ** ZDHCHN TAG *S01195
0595 C*********************                                               S01195
0596 C***********ZDHKEY    CHAINTABLC                90    ON NOT THERE   S01195
0597 C**N90******RECI      COMP 'D'                  9090  DELETED        S01195
0598 C*********************                                               S01195
0599 C*****NO*RECORD 1 FOUND, IS NOT A HOLIDAY                            S01195
0600 C***90N95************ GOTO ZDOAGN                                    S01195
0601 C*********************                                               S01195
0602 C*****NO RECORD 2 FOUND                                              S01195
0603 C***90*95*96**********GOTO ZDLOP1                     EXC. NOT FOUND S01195
0604 C***90*95N96********* GOTO ZDOAGN                     INC. NOT FOUND S01195
0605 C*********************                                               S01195
0606 C*****DETERMINE TYPE FOUND, INCLUDE OR EXCLUDE                       S01195
0607 C***********INEX      COMP 'E'                  92  91               S01195
0608 C*********************                                               S01195
0609 C*****CHECK IF DAY IS HOLIDAY FOR CURRENCY.                          S01195
0610 C***********ZCCY      LOKUPHCCY                     93               S01195
0611 C***91*93***********  GOTO ZDOAGN                     EXCLUDE FOUND  S01195
0612 C***92*93***********  GOTO ZDLOP1                     INCLUDE FOUND  S01195
0613 C*********************                                               S01195
0614 C**** IF EXCLUDE OR INCLUDE NOT FOUND CHECK                          S01195
0615 C*****FOR SECOND HOLIDAY RECORD, IF REQUIRED.                        S01195
0616 C***********'   '     LOKUPHCCY                     94ON IF NO RCD.2 S01195
0617 C*********************MOVE ZDHKEY    ZWRK1   1                       S01195
0618 C***********ZWRK1     COMP '1'                      95               S01195
0619 C***91*95****         SETON                     96                   S01195
0620 C***95N94             MOVE '2'       ZDHKEY                          S01195
0621 C***95N94             GOTO ZDHCHN                     GET SECOND REC S01195
0622 C*********************                                               S01195
0623 C***91                GOTO ZDLOP1                     EXC. NOT FOUND S01195
0624 C***92                GOTO ZDOAGN                     INC. NOT FOUND S01195
0625 C**********************                                              S01195
0626 C*****INCREMENT COUNT AND CHECK IF REQUIRED NUMBER OF DAYS           S01195
0627 C*****HAVE BEEN ADDED. IF NOT, GO THROUGH LOOP1 AGAIN.               S01195
0628 C***********ZDOAGN    TAG                             ** ZDOAGN TAG *S01195
0629 C*********************                                               S01195
0630 C***********ZDCNT     ADD  1         ZDCNT                           S01195
0631 C***********ZDCNT     COMP ZNRDYS                 97                 S01195
0632 C***97                GOTO ZDLOP1                                    S01195
0633 C*********************                                               S01195
0634 C*********************ENDSR                                          S01195
0635 C*********************                                               S01195
0636 C*********************                                               S01195
      /EJECT                                                              S01195
      /COPY ZSRSRC,ZFWDT                                                  S01195
      /EJECT                                                              S01195
      /COPY ZSRSRC,ZACCH                                                  S01195
      /EJECT                                                              S01195
0637 C********************************************************************
0638 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0639 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0640 C*
0641 CSR         GLZADD    BEGSR                           *** GLZADD ****
0642 C*
0643 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0644 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0645 C*
0646 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0647 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0648 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0649 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0650 C*
0651 CSR                   EXSR GLZSUM
0652 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0653 C*
0654 C********************************************************************
0655 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0656 C*                        GLZADD, GLZSUB, GLZCMP.
0657 C*          PARAMETERS PASSED -
0658 C*                     I/P ZZAMTI ZZAMTD
0659 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0660 C*
0661 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0662 C*
0663 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0664 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0665 CSR                   SETOF                     919293
0666 CSR                   SETOF                     949599
0667 C*
0668 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0669 CSR         ZZAMTI    COMP 0                      9293
0670 CSR 93      ZZAMTD    COMP 0                      9293
0671 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0672 C*
0673 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0674 CSR         ZZTOTI    COMP 0                      9193
0675 CSR 93      ZZTOTD    COMP 0                      9193
0676 C*
0677 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0678 CSR 93                Z-ADDZZAMTI    ZZTOTI
0679 CSR 93                Z-ADDZZAMTD    ZZTOTD
0680 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0681 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0682 CSR 91N92
0683 CORN91 92             GOTO ZZOFPS
0684 C*
0685 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0686 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0687 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0688 C*
0689 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0690 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0691 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0692 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0693 C*
0694 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0695 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0696 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0697 CSRN99                Z-ADDZZWK2     ZZTOTD
0698 CSRN99                Z-ADDZZWK3     ZZTOTI
0699 C*
0700 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0701 CSR 99                Z-ADD0         ZZAMT  153
0702 CSR                   GOTO ZZSEND
0703 C*
0704 C* THE 'SIGNS' ARE DIFFERENT
0705 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0706 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0707 C*
0708 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0709 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0710 C*
0711 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0712 C*
0713 CSR 91                Z-SUBZZTOTI    ZZTOTI
0714 CSR 91                Z-SUBZZTOTD    ZZTOTD
0715 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0716 C*
0717 CSR         ZZTOTI    COMP ZZAMTI               93  95
0718 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0719 C*
0720 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0721 CSR 95                Z-ADD0         ZZTOTI
0722 CSR 95                Z-ADD0         ZZTOTD
0723 CSR 95                GOTO ZZSEND
0724 C*
0725 C* IF ZZTOT GT. ZZAMT.
0726 CSR 93      ZZAMTD    COMP ZZTOTD               94
0727 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0728 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0729 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0730 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0731 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0732 C*
0733 C*
0734 C* IF ZZAMT GT. ZZTOT.
0735 CSRN93      ZZTOTD    COMP ZZAMTD               94
0736 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0737 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0738 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0739 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0740 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0741 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0742 C*
0743 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0744 CSR                   SETOF                     94
0745 CSR 93 91
0746 CORN93 92             SETON                     94
0747 CSR 94                Z-SUBZZTOTI    ZZTOTI
0748 CSR 94                Z-SUBZZTOTD    ZZTOTD
0749 C**
0750 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0751 CSR 92                Z-SUBZZAMTI    ZZAMTI
0752 CSR 92                Z-SUBZZAMTD    ZZAMTD
0753 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0754 C**
0755 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0756 CSR                   SETOF                     96
0757 CSR         ZZTOTD    COMP 0                        91
0758 CSR 91      ZZTOTI    COMP 0                      96
0759 CSR 96                MOVE '.000-'   ZZNEGD  5
0760 CSR                   ENDSR                             ** ENDSR **
0761 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************
0762 OOLPOSHH E        60
0763 O                                    1 'H'
0764 O                                    4 '   '
0765 O                                    6 '00'
0766 O                         ZERO05     9P
     O                                   12 '   '                         S01117
0767 OOLPOSOA E        62
0768 O                                    1 'D'
0769 O*********************    CCYTAB     4                               S01194
0769 O                         A6CYCD     4                               S01194
0770 O                                    6 '01'
0771 O                         TOTBAL    14P
0772 O                         DAY       62P
0773 O                         OLI      190P
0774 O                         OLO      318P
     O                         BRC,X    321                               S01117
     O                         CMP,X    324                               S01117
0775 O                         ZERO05   400P
0776 O        E        62
0777 O                                    1 'D'
0769 O*********************    CCYTAB     4                               S01194
0769 O                         A6CYCD     4                               S01194
0779 O                                    6 '02'
0780 O                         Z15       14P
0781 O                         DAY       62P
0782 O                         OLI      190P
0783 O                         OLO      318P
     O                         BRC,X    321                               S01117
     O                         CMP,X    324                               S01117
0784 O                         ZERO05   400P
0785 O        E        62
0786 O                                    1 'D'
0769 O*********************    CCYTAB     4                               S01194
0769 O                         A6CYCD     4                               S01194
0788 O                                    6 '03'
0789 O                         Z15       14P
0790 O                         DAY       62P
0791 O                         OLI      190P
0792 O                         OLO      318P
     O                         BRC,X    321                               S01117
     O                         CMP,X    324                               S01117
0793 O                         ZERO05   400P
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0610OOPG                                           S01408
     O*                                                                   S01408
0794 OOLPOSOB E        64
0795 O                                    1 'T'
0796 O                                    4 '999'
0797 O                                    6 '99'
0798 O                         COUNT      9P
     O                                   12 '999'                         LN0755
0799 O*L0610P1T  203   LRNU7NU8                                 S01124    S01117
     O*DL0610AUT**203***LR***************                           S01117E22608
     O*********************************** 24 'REFERENCE DL0610AU'   S01117E22608
     OGL0610AUT  203   LR                                                 E22608
     O                                   24 'REFERENCE GL0610AU'          E22608
0800 O*****                              22 'REFERENCE DL0610'
0801 O*********************    TITL      89                               S01194
0801 O                         BJURPT    89                               S01194
0802 O                                  104 'DATE'
0803 O*********************    RUNA     112                               S01194
0803 O                         BJMRDT   112                               S01194
0804 O                                  122 'PAGE'
0805 O                         PAGE  Z  127
0806 O********T**1*****LRNU7NU8                                           S01117
0806 O        T  1     LR                                                 S01117
0807 O                                   66 'CREATION OF ON LINE'
0808 O                                   80 'POSITION FILE'
0809 O********T**1*****LRNU7NU8                                           S01117
0809 O        T  1     LR                                                 S01117
0810 O                                   66 '-------------------'
0811 O                                   80 '--------------'
0812 O        T  236   LRNU7NU8
0813 O                                   18 'RUN CONTROLS'
0814 O        T  2     LRNU7NU8
0815 O                                   59 'NUMBER'
0816 O                                   84 'VALUE'
0817 O        T        LRNU7NU8
0818 O                                   28 'EXTRACT FILE CREATED'
0819 O                         COUNT 3   59
0820 O                         TOTI  Z   81
0821 O                         TOTD      84
0317 O********T*3***** LR                                                 S01194
0317 O*****   T 3      LRNU7NU8                                    S01194 LN0135
0318 O*****                              76 '*** END OF REPORT ***'       LN0135
0822 O        T 3      LR U7 U8
0823 O********                           22 'REFERENCE DL0610'            S01117
0824 O********                           64 'PRINT TERMINATED, '          S01117
0825 O********                           82 'DATABASE IN ERROR.'          S01117
0826 O********                 ERROR    100                               S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    76                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   51 'KEY/TEXT'                    S01117
     O                         DBKEY     64                               S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
