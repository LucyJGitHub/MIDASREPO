0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Update of Online Positions File')             *
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Dealing Module                                       *
0004 F*                                                               *
0005 F*     GL0630 - UPDATE ONLINE POSITIONS FILE                     *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                               *
      *  Last Amend No. CLE172             Date 01Oct20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CGL187             Date 06Oct17               *
      *                 CLE154             Date 06Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP204             Date 15Feb10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 187879             Date 18Jul01               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163486             Date 13Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 149439             DATE 24DEC98               *
     F*                 CEU020             Date 29May98               *
     F*                 CEU017             DATE 02Apr98               *
     F*                 CSE007             DATE 18Mar98               *
     F*                 CEU003             Date 23Jan98               *
     F*                 CLE005             Date 22May97               *
     F*                  CLE006             Date 02Dec96              *
     F*                   CFF004                Date 02OCT96          *
     F*                   103382                Date 06Jun96          *
     F*                   S01408                Date 04Apr96          *
     F*                  S01408             DATE   22FEB96            *
     F*                  S01408             DATE   03FEB95            *
     F*                  S01512             DATE   30SEP94            *
     F*                  S01473             DATE   16AUG94            *
     F*                  S01440             DATE   07OCT93            *
     F*                  045634             DATE   23APR93            *
0009 F*                  S01393             DATE.  30OCT92            *
     F*                  E34885             DATE.  13OCT92            *
     F*                  S01392             DATE.  22SEP92            *
     F*                  S01392             DATE   20JUL92            *
     F*                  S01117             DATE.  18MAR92            *
     F*                  E28817             DATE   14OCT91            *
     F*                  S01270             DATE.  30SEP91            *
     F*                  E23463             DATE.  05NOV90            *
0009 F*                  E22608             DATE.  04SEP90            *
0008 F*                  BHF293             DATE.  25SEP90            *   2933
     F*                  LN0135             DATE   24MAY90            *   LN0135
0009 F*                  E20103             DATE.  18APR90            *   E20103
0008 F*                  S01243             DATE.  20APR90            *
0009 F*                  S01117             DATE.  20/04/89           *   S01117
0009 F*                  S01194             DATE.  20/04/89           *   S01194
0009 F*                  S01196             DATE.  20/04/89           *   S01196
0009 F*                  S01153             DATE.  01/09/88           *   S01153
0009 F*                  S01127             DATE.  16/06/87           *   S01127
0008 F*                  S03220             DATE.  10/05/88           *
0008 F*                  S01119             DATE.  10/08/87           *
0008 F*                  S01119             DATE.  15/06/87           *
0008 F*                  s01124             DATE.  00/00/00           *
0010 F*                                                               *
0010 F*****************************************************************
0010 F*                                                               *
      *  CLE172 - LIBOR Deregulation - Lending                        *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL187 - Amendment to Net Trading Position Report.           *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CAP204 - Teller Related APIs - Account Transfer              *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
     F*  187879 - OLPOS should not be updated if pay and settle       *
     F*           currencies are equal.                               *
     F*  163486 - Recompile due to changes in LVENTEL.                *
     F*  149439 - RECOMPILED OVER CHANGES EVNTML4                     *
     F*  CEU020 - EMU Lending Multi-Ccy Rollover                      *
     F*  CEU017 - Securities Redenomination Euro Changes              *
     F*           Same coding as CSE007                               *
     F*  CSE007 - Corporate Actions                                   *
     F*  CEU003 -  EMU DL Settlement Currency Conversion:             *
     F*            Include processing required by EMU switchable      *
     F*            feature CEU003.                                    *
     F*  CLE005 - Customer Lending Enhancements - Tranche 3           *
     F*  CLE006 - Customer Lending Enhancements - Rollovers           *
     F*     CFF004 - Increase in size of Price Fields,(Recompiled Only)
     F*     103382 - Remove DB error if dealing not installed         *
     F*     S01408 - Addition of core hook GL0630CCP4                 *
     F*              Addition of core hook GL0630CCP5                 *
     F*              Addition of core hook GL0630CCP6                 *
     F*              Addition of core hook GL0630CCP7                 *
     F*              Addition of core hook GL0630CCP8                 *
     F*              Addition of core hook GL0630CCP9                 *
     F*              Addition of core hook GL0630IIP2                 *
     F*     S01408 - Addition of core hook GL0630EEP1                 *
     F*              Addition of core hook GL0630IIP1                 *
     F*              Addition of core hook GL0630CCP3                 *
     F*     S01408 - Addition of core hook GL0630FFPG                 *
     F*              Addition of core hook GL0630CCPG                 *
     F*              Addition of core hook GL0630CCP1                 *
     F*              Addition of core hook GL0630CCP2                 *
     F*              Addition of core hook GL0630CBDU                 *
     F*              Addition of core hook GL0630OOPG                 *
     F*              Addition of core hook GL0630CADU                 *
     F*     S01512  -  Use payment date for coupon event due on a     *
     F*                holiday and payment on the next working date   *
     F*     S01473  -  Midas Leo Integration. Addition of LC files and*
     F*                events processing                              *
     F*     S01440  -  If 'Accruals on Interest Outrights'flag        *
     F*                on Dealing I.C.D. is on, update record 02      *
     F*                (Interest), on LF/OLPOS if deal type is        *
     F*                PI or SI, rather than record 01 (FX).          *
     F*     045634  -  Updated to include new lending fee events in   *
     F*                the reporting - facility fees and loan fees    *
     F*     S01393  -  Recompiled for Strategic Risk Management       *
     F*                Book Code added to PF/EVNTXED                  *
     F*     E34885  -  REMOVAL OF CUSTOMER LENDING CHANGES (S01270)   *
     F*     S01392  -  JAPANESE SUBMODULE ENHANCEMENTS (LE)           *
     F*     S01392  -  JAP.SUB-MODULE INCORPORATION (CORE)            *
0010 F*     S01117  -  RECOMPILED FOR FT RELEASE 10                   *
     F*     E28817  -  STEVEAB and STEVEFC are now redundant          *
     F*     S01270  -  CUSTOMER LENDING AMENDMENTS                    *
     F*     E23463  -  REMOVES TEST FOR "SETTLEMENT CCY NOT EQUAL TO  *   E23463
     F*                NOMINAL CCY" FOR SE POSITIONS DETAILS          *   E23463
0010 F*     E22608  -  PROGRAM RENAMED FROM DL0630                    *   E22608
     F*     BHF293   - RECOMPILE FOR CHANGED LF/EVNTML4               *     2933
     F*     LN0135  -  REMOVE 'END OF REPORT' FROM AUDIT REPORT       *   LN0135
     F*     E20103  -  REINTRODUCTION OF SUBROUTINE 'SRHASH' TO COUNT *   E20103
     F*                NUMBER OF RECORDS READ FROM EVENTS FILE.       *   E20103
0010 F*     S01243  -  PRINCIPAL INCREASES FOR TERM LOANS             *
0010 F*                (THIS IS NOW PART OF CORE)                     *
0004 F*     S01117  -  MULTIBRANCHING                                 *   S01117
0010 F*     S01194  -  NEW STANDING DATA - ADD ACCESS PROGRAMS        *   S01194
0010 F*     S01196  -  REMOVAL OF LETTERS OF CREDIT                   *   S01196
0010 F*     S01153  -  CLOSE OF BUSINESS ENHANCEMENTS                 *   S01153
0010 F*                                                               *
     F*     S01127  -  LVENTM NOW ALSO BASED OVER FOEVED AND FOEVEZZ  *   S01127
     F*                OF FUTURE AND OPTION.                          *   S01127
0010 F*     S03220  -  FUNDS TRANSFER                                 *
0010 F*     S01119  -  FORWARD RATE AGREEMENTS/INTEREST RATE SWAPS    *
0004 F*                                                               *
0010 F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F*VNTM***IP**E***********K        DISK                               S01153
0011 F************BPEVEDF*****                      KIGNORE     S01129    S01153
     F*REVEA**IF**E***********         DISK                     S01129    S01153
     F*PEVEA**IF**E***********         DISK                     S01129    S01153
     F*PEVEA**IF**E***********         DISK                     S01129    S01153
0012 F*LPOS***UF* F     400  5AI     2 DISK                               S01117
0012 FOLPOS   UF  F     400  8AI     2 DISK                               S01117
0013 F*****TABLE***IF  F      96 12AI     2 DISK                          S01194
     FOLPOSOL0UF  E           K        DISK                           UC                      CGL187
      *                                                                                       CGL187
     FEVNTXEL0IF  E           K        DISK                           UC                      CGL187
      *                                                                                       CGL187
0011 FEVNTML4 IP  E           K        DISK                               S01153
0014 F*PRINT  O   F     132     OF     PRINTER                            S01124
0014 F*L0630P1O   F     132     OF     PRINTER                    S01124  S01117
     F*DL0630AUO**F*****132*****OF*****PRINTER                      S01117E22608
     FGL0630AUO   F     132     OF     PRINTER                            E22608
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL0630FFPG                                           S01408
     F*                                                                   S01408
0015 F* ID F  C  H  L    FUNCTION OF INDICATORS
0016 F**01************EVENTS FILE - HEADER                                S01153
0017 F* 02                        - DETAIL - DEALING
0018 F* 13                        - DETAIL - COMMERCIAL LOANS
0019 F**03*******                 - TRAILER - DEALING                     S01153
0020 F**14*******                 - CATCHALL -COMMERCIAL LOANS            S01153
0022 F* 04            EVNTM DETAIL - FO RECORD                            S01127
0023 F**07*******     EVNTM TRAILER- FO RECORD                  S01127    S01153
0021 F* 05            ONLINE POSITIONS FILE - HEADER
0022 F* 06                                  - DETAIL FX POSNS.
0023 F* 09                                  - TRAILER
0024 F* 10                                  - CATCHALL
0025 F**11************TABLES FILE - INST.CONT.RECD.1                      S01194
0026 F**12************************- CATCHALL                              S01194
0027 F*    15         ZERO FED FUNDS VALUE DATE
0028 F*    16         ZERO FIRST/SECOND LEG SWAP INDICATOR
0029 F*       17      FIRST DETAIL RECORD READ INDICATOR
0025 F* 18            EVNTM - FUNDS TRANSFER DETAIL                       S03220
0026 F**19*******     EVNTM - FUNDS TRANSFER TRAILER            S03220    S01153
0029 F*       20      FIRST CYCLE INDICATOR
0030 F*       21      FED FUNDS VALUE DATE LESS THAN RUN DATE
0031 F*       22      UNSUCCESSFUL CHAIN TO OLPOS
     F*       24      DEALING TRAILER HAS BEEN READ
0032 F*       25      DEAL TYPE IS 'C1'
0033 F*       26      EVENT AMOUNT NEGATIVE
0034 F*       27      FIRST/SECOND LEG SWAP INDICATOR IS 1
0035 F*     30-33     EVENT DATE COMPARISON WITH 16 WKING DAYS INDICATOR
0036 F*       34      IDENTIFIES FIRST DATE IN ARRAY
0037 F*     35-36     INDICATORS TO DETERMINE EVENT TYPE
0038 F*     40-49     INDICATORS TO DETERMINE EVENT TYPE
0039 F*       50      INCOMING INDICATOR ON EVENTS FILE
0040 F*       51      OUTGOING INDICATOR ON EVENTS FILE
0041 F*     53-59     INDICATORS TO DETERMINE EVENT TYPE
0042 F*       60      OUTPUT TO OPLOS - FX POSNS.INCOMING
0043 F*       62               - INTEREST POSNS.INCOMING
0044 F*       64               - LOAN/DEP.POSNS.INCOMING
0045 F*       66      POSITIVE RESULT TO EVENT AMOUNT CALCULATION
0046 F*       67      NEGATIVE RESULT TO EVENT AMOUNT CALCULATION
0047 F********70******DATABASE ERROR                                      S01153
     F********76******LETTERS*OF*CREDIT*LOAN/DEPOSIT*EVENT*               S01196
     F*       77      SECURITIES TRADING EVENT
     F*       78      TREVED/CPEVED/DPEVED EVENT RECORD                   S01129
     F********79******END OF FILE ON TREVEA/CPEVEA/DPEVEA       S01129    S01153
0048 F********80******CONTROL TOTALS DO NOT AGREE                         S01153
0049 F********81******CONTROL TOTALS DO NOT AGREE                         S01153
     F* 82            EVENTS FILE - CUSTOMER LENDING DETAIL
     F**83************EVENTS FILE - CUSTOMER LENDING TRAILER              S01153
     F**84************EVENTS FILE - LETTERS OF CREDIT DETAIL              S01196
     F* 84            Events file - Letters of Credit Detail              S01473
     F**85************EVENTS FILE - LETTERS OF CREDIT TRAILER             S01153
     F**86************EVENTS FILE - SECURITIES TRADING DETAIL             E28817
     F**87************EVENTS FILE - SECURITIES TRADING TRAILER            S01153
     F********88******DEALING EVENTS HEADER HAS BEEN READ                 S01153
0050 F*     90-99     USED IN Z-SUBROUTINES
0051 F*        U7&U8  DATABASE ERROR
0052 F************U8**FILE CONTROL TOTALS OUT OF BALANCE                  S01153
0053 F*             L1LEVEL BREAK ON CURRENCY OF EVENTS FILE
     F*             L2LEVEL BREAK ON BRANCH ON EVENTS FILE                S01117
     E                    CPY@    1   1 80
0054 E                    ODT        16  5 0
0055 E                    OFI        16 15 0
0056 E                    OFO        16 15 0
0057 E                    OII        16 15 0
0058 E                    OIO        16 15 0
0059 E                    OLI        16 15 0
0060 E                    OLO        16 15 0
0061 E******************  TABEV1  6   6  4   *********   * EVENT TYPES    S01119
0061 E***********         TABEV1 10  10  4               * EVENT TY S01119CEU003
     E                    TABEV1 10  20  4               * EVENT TYPES    CEU003
0062 E***********         TABEV2  8   8  4               * EVENT TYPES 2  CEU003
     E                    TABEV2  8  16  4               * EVENT TYPES 2  CEU003
     E                    TABEV3 10  10  4               * EVENT TYPES 3                      CGL187
      *                                                                   S01408
     E/COPY WNCPYSRC,GL0630EEP1                                           S01408
      *                                                                   S01408
0063 I*    EVENTS FILE - HEADER RECORD.
0064 I*
0065 I*VNTXECF****01**                                                    S01153
0067 I*
0068 I*
0069 I*    EVENTS FILE - DETAIL RECORD - DEALS
0070 I*
0071 IEVNTXEDF    02
0077 I                                              EAMT          26
0078 I                                              ECCY  L1
0112 I                                              FFVD            15
0119 I                                              FSLI            16
     I              EBRC                            ACRB  L2              S01117
0122 I*
0123 I*    EVENTS FILE - DETAIL RECORD - COMMERCIAL LOANS
0124 ICEVNXCCF    13
0131 I                                              EAMT          26
0132 I                                              ECCY  L1
0164 I                                              FFVD            15
     I              BRCA                            ACRB  L2              S01117
     I*
     ILVENTELF    82
     I                                              EAMT          26
     I                                              ECCY  L1
     I              DFCE                            LCEQ
     I              CDOM                            CLOC
     I              ECDP                            DEC1
     I              FACT                            FTYP
     I              FCNO                            FSEQ
     I              EBRC                            ACRB  L2              S01117
      *                                                                   S01473
     IBVNTXEDF    84                                                      S01473
     I                                              EAMT          26      S01473
     I                                              ECCY  L1              S01473
     I              BRCA                            ACRB  L2              S01473
      ** Leo DL Events File                                               S01473
      *                                                                   S01473
     I*******************                                                 S01196
     I*****EVENTS*FILE*-*LETTERS*OF*CREDIT*DETAIL**                       S01196
     I*******************                                                 S01196
     I****BVNTXEDF****84*                                                 S01196
     I*******************                           EAMT          26      S01196
     I*******************                           ECCY  L1              S01196
     I*
     I*    EVENTS FILE - SECURITIES TRADING DETAIL
     I*
     I*STEVEABF    86                                                     E28817
     I***********                                   EAMT          26      E28817
     I***********                                   ECCY  L1              E28817
     I***********   DNEE                            LCEQ                  E28817
     I***********   IOIN                            INOI                  E28817
     I***********   OAME                            OTHA                  E28817
     I***********   ODTE                            OTHD                  E28817
     I***********   BRCA                            ACRB  L2       S01117 E28817
     I*
     I*    EVENTS FILE - TRADE EVENTS DETAIL                              S01129
     I*
     ITREVEDF     78                                                      S01129
     I              TRSC                            ECCY  L1              S01129
     I              TRNC                            CCNC                  S01129
     I              TREC                            CCCE                  S01129
     I              TRVD                            CCDT                  S01129
     I              TRVS                            CCEA          26      S01129
     I              TRBA                            ACRB  L2              S01117
     I*
     I*    EVENTS FILE - CUSTOMER POSITIONS EVENTS DETAIL                 S01129
     I*                                                                   S01129
     ICPEVEDF     78                                                      S01129
     I              CCEC                            ECCY  L1              S01129
     I                                              CCEA          26      S01129
     I              CCBA                            ACRB  L2              S01117
     I              CPYD                            CCPD                  S01512
     I*                                                                   S01129
     I*    EVENTS FILE - DEPOT POSITIONS EVENTS DETAIL                    S01129
     I*                                                                   S01129
     IDPEVEDF     78                                                      S01129
     I              CCEC                            ECCY  L1              S01129
     I                                              CCEA          26      S01129
     I              CCBA                            ACRB  L2              S01117
     I*                                                                   S03220
     I*    EVENTS FILE - FUNDS TRANSFER DETAIL                            S03220
     I*                                                                   S03220
     IFPVNTDDF    18                                                      S03220
     I                                              EAMT          26      S03220
     I                                              ECCY  L1              S03220
     I              BRCA                            ACRB  L2              S01117
0169 I*
0170 I*
0171 I*    EVENTS FILE - TRAILER RECORD - DEALING
0172 I*
0173 I*VNTXZZF****03**                                                    S01153
0170 I*
0171 I*    EVENTS FILE - TRAILER RECORD - COMMERCIAL LOANS
0172 I*
0179 I*EVNXZZF****14**                                                    S01153
     I*VENTZZF****83**                                                    S01153
     I*
     I*    EVENTS FILE - LETTERS OF CREDIT TRAILER
     I*VNTXEZF****85**                                                    S01153
     I*
     I*    EVENTS FILE - SECURITIES TRADING TRAILER
     I*TEVEFCF****87**                                                    S01153
     I***********   HSTA                            HRWN                  S01153
     I***********   HSTB                            HRDC                  S01153
     I*                                                                   S03220
     I*    EVENTS FILE - FUNDS TRANSFER TRAILER                           S03220
     I*PVNTZZF****19**                                           S03220   S01153
     I***********   NORE1                           NORE         S03220   S01153
     I*                                                                   S01127
     I*    EVNTM FILE - FO DETAIL RECORD                                  S01127
     IFOEVEDF     04                                                      S01127
     I                                              EAMT          26      S01127
     I                                              ECCY  L1              S01127
     I              BRCA                            ACRB  L2              S01117
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0630IIP2                                           S01408
     I*                                                                   S01408
     I*                                                                   S01127
     I*    EVNTM FILE - FO TRAILER                                        S01127
     I*OEVEZZF****07**                                           S01127   S01153
     I*                                                                   S01127
     IGLEVNTDF    80                                                                          CAP204
     I                                              EAMT          26                          CAP204
     I                                              ECCY  L1                                  CAP204
     I              EBRC                            ACRB  L2                                  CAP204
     I*
0180 I*    ONLINE POSITIONS FILE - HEADER RECORD.
0181 I*
0182 IOLPOS   NS  05   1 CH
0183 I                                        1   1 RECI
0184 I                                        2   4 CCY
0185 I                                        5   60RECN
0186 I                                    P   7   90FLSZ
     I                                       10  12 BRCA                  S01117
0187 I*
0188 I*
0189 I*    ONLINE POSITIONS FILE - DETAIL RECORD.
0190 I*
0191 I        NS  06   1 CD   5 C0   6 C1
0192 I                                        1   1 RECI
     I                                        2   4 CCY                   S01117
0193 I                                    P  15  62 ODT
     I                                      319 321 BRCA                  S01117
0194 I*
0195 I*
0196 I*    ONLINE POSITIONS FILE - TRAILER RECORD.
0197 I*
0198 I        NS  09   1 CT
0199 I                                        1   1 RECI
0200 I                                        2   4 CCY
0201 I                                        5   60RECN
0202 I                                    P   7   90NORE
     I                                       10  12 BRCA                  S01117
0203 I*
0204 I        NS  10
0205 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.**             S01194
0206 I****************                                                    S01194
0207 I*****TABLE***NS* 11   2 C0   3 C1  12 C1                            S01194
0208 I*******AND******13 C0                                               S01194
0209 I****************                        1   1 RECI                  S01194
0210 I****************                        2   30RECT                  S01194
0211 I****************                       12  130RCDE                  S01194
0212 I****************                       14  66 TITL                  S01194
0213 I****************                       67  67 DATF                  S01194
0214 I****************                       68  700DFBR                  S01194
0215 I****************                       74  74 MODI1                 S01194
0216 I****************                       75  75 MODI2                 S01194
0217 I****************                       76  76 MODI3                 S01194
0218 I****************                    P  77  790RUND                  S01194
0219 I****************                       80  86 RUNA                  S01194
0220 I****************                       87  870SFLG                  S01194
0221 I****************                    P  90  920LCD                   S01194
0222 I****************                       93  93 CHTP                  S01194
0223 I****************                    P  94  960TNLU                  S01194
0224 I****************                                                    S01194
0225 I*****CATCHALL***                                                    S01194
0226 I********NS**12**                                                    S01194
     I*                                                                   S01117
     I            DS                                                      S01117
     I                                        1   8 OLKEY                 S01117
     I                                        1   3 ACRB                  S01117
     I                                        4   6 ECCY                  S01117
     I                                        7   8 RECX                  S01117
0315 I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*
     ISDDEAL    E DSSDDEALPD                                              S01440
     I* DEALING DATA FILE - EXTERNALLY DESCRIBED                          S01440
     I*                                                                   S01440
     ISCSARD    E DSSCSARDPD                                              S01473
      ** Switchable Features File                                         S01473
      *                                                                   S01473
     ISDMMOD    E DSSDMMODPD                                              103382
      ** Midas Modules access objest                                      103382
      *                                                                   103382
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
      *                                                                   S01408
     I/COPY WNCPYSRC,GL0630IIP1                                           S01408
      *                                                                   S01408
0315 I*                                                                   S01194
0227 I/EJECT
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
0228 C**
0229 C** FIRST CYCLE PROCESSING
0230 C**
0231 C   20                GOTO START
0232 C                     SETON                     20
     C                     MOVEACPY@      BIS@   80
0233 C*********************EXSR ZSYSTM                                    S01194
0234 C***99****************SETON                     U7U8                 S01194
0235 C***99****************GOTO ENDD                                      S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     SETON                     U7U8                 S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDD                                      S01194
     C                     END                                            S01194
     C*                                                                   S01440
     C** READ MODULE DETAILS VIA ACCESS PROGRAM                           103382
     C*                                                                   103382
     C                     CALL 'AOMMODR0'                                103382
     C                     PARM '*MSG   ' @RTCD   7                       103382
     C                     PARM '*FIRST ' @OPTN   7                       103382
     C           SDMMOD    PARM SDMMOD    DSFDY                           103382
     C           @RTCD     IFNE *BLANK                                    103382
     C                     MOVEL'SDMMODPD'DBFILE 10        ************   103382
     C                     MOVEL'04'      DBASE   2        * DBERR 04 *   103382
     C                     MOVEL@OPTN     DBOPTN  7        ************   103382
     C                     SETON                     U7U8                 103382
     C                     EXSR *PSSR                                     103382
     C                     GOTO ENDD                                      103382
     C                     END                                            103382
     C*                                                                   103382
     C** Access SDDEALPD via access program, for Accruals on Interest     S01440
     C** Outrights flag                                                   S01440
     C*                                                                   S01440
     C           BGDLFX    IFEQ 'Y'                                       103382
     C           BGDLMM    OREQ 'Y'                                       103382
     C**********           CALL 'AODEALR0'                                S01440              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD                           S01440
     C                     PARM '*FIRST ' @OPTN                           S01440
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01440              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C*                                                                   S01440
     C           @RTCD     IFNE *BLANKS                    B1             S01440
     C                     MOVEL'03 '     DBASE            ***************S01440
     C                     MOVEL'SDDEALPD'DBFILE           *             *S01440
     C                     MOVEL@OPTN     DBOPTN           * DBERR 03    *S01440
     C                     MOVE '1'       *INU7            *             *S01440
     C                     MOVE '1'       *INU8            ***************S01440
     C                     EXSR *PSSR                      *1             S01440
     C                     GOTO ENDD                       *1             S01440
     C                     END                             E1             S01440
     C                     ELSE                                           103382
     C                     MOVEL'N'       BNAOIO                          103382
     C                     ENDIF                                          103382
0330 C*
0236 C***01******COUNT     ADD  2         COUNT   50                      S01153
0236 C**N01******COUNT*****ADD  1         COUNT                           S01129
0236 C**N01******COUNT*****ADD  1         COUNT   50                      S01153
0236 C**N01N78***COUNT*****ADD  1         COUNT                 S01129    S01153
0236 C           COUNT     ADD  1         COUNT   50                      S01153
     C                     Z-ADD00000     WTNLU   50                      S01129
     C*                                                                   S01129
     C** SET DEALING EVENTS HEADER RCD READ IND
     C***01******          SETON                     88                   S01153
      *                                                                   S01473
      ** Check the switchable features file for the Midas Leo Integration S01473
      ** number, S01473. If it is present, set the flag ULEO to 'Y'       S01473
     C                     CALL 'AOSARDR0'                                S01473
     C                     PARM *BLANKS   @RTCD                           S01473
     C                     PARM '*VERIFY' @OPTN                           S01473
     C                     PARM 'S01473'  @KEY    6                       S01473
     C           SCSARD    PARM SCSARD    DSFDY                           S01473
      *                                                                   S01473
     C           @RTCD     IFEQ *BLANKS                                   S01473
     C                     MOVE 'Y'       ULEO    1                       S01473
     C                     END                                            S01473
     C*                                                                   S01408
      *                                                                                       CGL187
      ** Access Switchable Features File For CGL187                                           CGL187
      *                                                                                       CGL187
     C                     CALL 'AOSARDR0'                                                    CGL187
     C                     PARM *BLANKS   @RTCD                                               CGL187
     C                     PARM '*VERIFY' @OPTN                                               CGL187
     C                     PARM 'CGL187'  WSARD   6                                           CGL187
      *                                                                                       CGL187
     C                     MOVE 'N'       CGL187  1                                           CGL187
     C           @RTCD     IFEQ *BLANK                                                        CGL187
      *                                                                                       CGL187
     C                     MOVE 'Y'       CGL187                                              CGL187
     C                     OPEN OLPOSOL0                                                      CGL187
     C                     OPEN EVNTXEL0                                                      CGL187
      *                                                                                       CGL187
     C                     Z-ADD*ZEROS    WWWKFL 150                                          CGL187
      *                                                                                       CGL187
     C           W0KEY1    KLIST                                                              CGL187
     C                     KFLD           BRCA                                                CGL187
     C                     KFLD           CCY                                                 CGL187
     C                     KFLD           REXX    20                                          CGL187
      *                                                                                       CGL187
     C           W0KEY2    KLIST                                                              CGL187
     C                     KFLD           DLNO                                                CGL187
     C                     KFLD           CUNR                                                CGL187
     C                     KFLD           ETYP                                                CGL187
     C                     KFLD           EDAT                                                CGL187
     C                     KFLD           ECCY                                                CGL187
     C                     KFLD           ECSS                                                CGL187
     C                     KFLD           DTYP                                                CGL187
     C                     KFLD           DLST                                                CGL187
     C                     KFLD           BRCA                                                CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,GL0630CCPG                                           S01408
     C*                                                                   S01408
      *                                                                   CLE006
      ** Check if CLE006 is switched *ON.                                 CLE006
      *                                                                   CLE006
     C                     MOVE 'N'       CLE006  1                       CLE006
     C                     CALL 'AOSARDR0'                                CLE006
     C                     PARM *BLANKS   @RTCD                           CLE006
     C                     PARM '*VERIFY' @OPTN                           CLE006
     C                     PARM 'CLE006'  @SARD   6                       CLE006
     C           SCSARD    PARM SCSARD    DSFDY                           CLE006
      *                                                                   CLE006
     C           @RTCD     IFEQ *BLANKS                                   CLE006
     C                     MOVE 'Y'       CLE006                          CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           @RTCD     ANDNE'*NRF   '                                 CLE006
      *                                                                   CLE006
      ** Call to program ended in error                                   CLE006
      *                                                                   CLE006
     C                     MOVEL'CLE006'  DBOPTN           ************   CLE006
     C                     MOVE 'SCSARDPD'DBFILE           * DBERR 05 *   CLE006
     C                     MOVEL'05'      DBASE            ************   CLE006
     C                     SETON                     U7U8                 CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     GOTO ENDD                                      CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE005
      ** Determine if Customer Lending Enhancements - Tranche 3           CLE005
      ** (CLE005) is installed                                            CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   W0RTCD  7                       CLE005
     C                     PARM '*VERIFY' W0OPTN  7                       CLE005
     C                     PARM 'CLE005'  W0SARD  6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
      *                                                                   CLE005
      ** If feature is on, set up SAR work flag                           CLE005
      *                                                                   CLE005
     C           W0RTCD    IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005                          CLE005
     C                     ELSE                                           CLE005
      *                                                                   CLE005
      ** else, database error (return code other than *NRF)               CLE005
      *                                                                   CLE005
     C           W0RTCD    IFNE '*NRF   '                                 CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     MOVEL'*VERIFY' DBOPTN           * DBERR 06 *   CLE005
     C                     MOVEL'06'      DBASE            ************   CLE005
     C                     MOVE '1'       *INU7                           CLE005
     C                     MOVE '1'       *INU8                           CLE005
     C                     MOVE '1'       *INLR                           CLE005
     C                     GOTO ENDD                                      CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CEU020
      ** Access SAR details file to see if EMU Lending                    CEU020
      ** Multi-Ccy Rollover is switched on.                               CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANK    @RTCD   7                       CEU020
     C                     PARM '*VERIFY' @OPTN   7                       CEU020
     C                     PARM 'CEU020'  @SARD   6                       CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
      *                                                                   CEU020
     C           @RTCD     IFNE *BLANKS                                   CEU020
     C           @RTCD     ANDNE'*NRF'                                    CEU020
     C                     MOVEL'SDSARDPD'DBFILE           ************   CEU020
     C                     MOVEL'CEU020'  DBOPTN           * DBERR 07 *   CEU020
     C                     MOVEL'07'      DBASE            ************   CEU020
     C                     SETON                     U7U8                 CEU020
     C                     EXSR *PSSR                                     CEU020
     C                     GOTO ENDD                                      CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CEU020
     C           @RTCD     IFEQ *BLANK                                    CEU020
     C                     MOVE 'Y'       CEU020  1                       CEU020
     C                     ELSE                                           CEU020
     C                     MOVE 'N'       CEU020                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                                       CLE028
      ** Check if enhancement CLE028 is installed                                             CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY 'POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD   6                                           CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'08'      DBASE                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CAP204
      ** Check if enhancement CAP204 is installed                                             CAP204
      *                                                                                       CAP204
     C                     CALL 'AOSARDR0'                                                    CAP204
     C                     PARM *BLANKS   PRTCD                                               CAP204
     C                     PARM '*VERIFY 'POPTN                                               CAP204
     C                     PARM 'CAP204'  PSARD                                               CAP204
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP204
      *                                                                                       CAP204
     C           PRTCD     IFNE *BLANKS                                                       CAP204
     C           PRTCD     ANDNE'*NRF   '                                                     CAP204
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP204
     C                     MOVEL'09'      DBASE                                               CAP204
     C                     MOVE *ON       *INU7                                               CAP204
     C                     MOVE *ON       *INU8                                               CAP204
     C                     MOVE *ON       *INLR                                               CAP204
     C                     EXSR *PSSR                                                         CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C           PRTCD     IFEQ *BLANKS                                                       CAP204
     C                     MOVE 'Y'       CAP204  1                                           CAP204
     C                     ELSE                                                               CAP204
     C                     MOVE 'N'       CAP204                                              CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C/COPY WNCPYSRC,GL0630C006
      *                                                                   S01473
0237 C           START     TAG                             ** START TAG **
      *                                                                   S01473
      ** If Leo records are being processd, and a Leo record has          S01473
      ** been read, bypass the check for other record types               S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           *IN84     ANDEQ'1'                                       S01473
     C                     MOVE 'Y'       ULDET   1                       S01473
     C                     ELSE                                           S01473
      *                                                                   S01473
0238 C  N02
     CANN80                                                                                   CAP204
     CANN82
     C*****ANN84***                                                       S01196
     C*****ANN86                                                          E28817
     CANN78                                                               S01129
     CANN18                                                               S03220
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP4                                           S01408
     C*                                                                   S01408
     CANN04                                                               S01127
0239 CANN13                GOTO ENDD
      *
     C                     END                                            S01473
      *
     C                     SETON                     17
0240 C**
0241 C** CHAIN TO OLPOS FOR CURRENCY DATE ARRAY
0242 C**
0243 C***L1******          MOVELECCY      OLKEY   5                       S01117
0244 C***L1******          MOVE '01'      OLKEY                           S01117
0244 C   L1                MOVE '01'      RECX                            S01117
0245 C   L1      OLKEY     CHAINOLPOS                22
     C*                                                                   S01129
     C** FOR SECURITIES TRADING 2 EVENTS SET UP AMOUNT FIELD FOR          S01129
     C** HASH SUB ROUTINE                                                 S01129
      *                                                                   S01129
     C           *IN78     IFEQ '1'                                       S01129
      *                                                                   S01129
     C************         Z-ADDCCEA      EAMT                  S01129    S01153
     C                     ADD  1         SETOT   50                      S01129
      *                                                                   S01129
0376 C***********EAMT      DIV  1000      ZZAMT                 S01129    S01153
0378 C***26******          Z-SUBZZAMT     ZZAMT                 S01129    S01153
      *                                                                   S01129
0374 C***********          Z-ADDSETOTI    ZZTOTI                S01129    S01153
0375 C***********          Z-ADDSETOTD    ZZTOTD                S01129    S01153
0379 C***********          EXSR GLZADD                          S01129    S01153
0380 C***********          Z-ADDZZTOTI    SETOTI 150            S01129    S01153
0381 C***********          Z-ADDZZTOTD    SETOTD  30            S01129    S01153
     C                     ELSE                                 S01129    S01153
0246 C***********                                                         S01153
0247 C***HASH*TOTALLING FOR RECORDS READ                                  S01153
0248 C***********                                                         S01153
0249 C***********          EXSR SRHASH                                    S01153
0434 C***********COUNT     ADD  1         COUNT                 S01117    E20103
0247 C*  HASH TOTALLING FOR RECORDS READ                                  E20103
0248 C*                                                                   E20103
0249 C                     EXSR SRHASH                                    E20103
     C                     END                                            S01129
      *                                                                   S01129
      ***Clear*previous accumulater values.                     S01129    S01153
     C***********          Z-ADD0         ZZTOTI                S01129    S01153
     C***********          Z-ADD0         ZZTOTD                S01129    S01153
0250 C**
0251 C**
0252 C** CHECK INCOMING/OUTGOING INDICATOR
0253 C**
0254 C                     SETOF                     51
0255 C           INOI      COMP 'I'                      50
0256 C  N50      INOI      COMP 'O'                      51
     C*                                                                   S01129
     C** IF RECORD IS A SECURITIES TRADING 2 EVENT(*AND SETTLEMENT  S01129E23463
     C** CURRENCY IS NOT THE SAME AS THE NOMINAL CURRENCY*)THEN DO  S01129E23463
     C** SUB ROUTINE FOR SECURITIES TRADING 2 EVENTS(*OTHERWISE BYPAS01129E23463
     C** DETAIL PROCESSING*)                                        S01129E23463
     C** (E23463 REMOVED BRACKETED CONDITION)                             E23463
     C*                                                                   S01129
     C           *IN78     IFEQ '1'                                       S01129
     C***********ECCY      IFNE CCNC                               S01129 E23463
     C                     EXSR ST2                                       S01129
     C                     GOTO ENDD                                      S01129
     C***********          ELSE                                    S01129 E23463
     C***********          GOTO ENDD                               S01129 E23463
     C***********          END                                     S01129 E23463
     C                     END                                            S01129
0257 C**
0258 C** CHECK FIRST/SECOND LEG SWAP INDICATOR
0259 C**
0260 C  N16      FSLI      COMP 1                        27
0261 C**
0262 C** CHECK WHETHER DEAL TYPE IS C1
0263 C**
0264 C           DTYP      COMP 'C1'                     25
     C   13
     COR 82                SETOF                     2527
0265 C**
0266 C** DETERMINE EVENT TYPE FOR UPDATE OF OLPOS FILE
0267 C**
0268 C                     SETOF                     213536
0269 C                     SETOF                     404142
0270 C                     SETOF                     434445
0271 C                     SETOF                     464748
0272 C                     SETOF                     495354
0273 C                     SETOF                     555657
0274 C                     SETOF                     5859
0275 C                     SETOF                     6667
     C                     SETOF                     7173
     C*********************SETOF                     76                   S01196
     C                     SETOF                     77
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP5                                           S01408
     C*                                                                   S01408
0276 C**
0277 C** IGNORE FOR UPDATING POSITIONS
0278 C**
0279 C***********ETYP      COMP '14V5'                   40               S01153
0280 C**N40******ETYP      COMP '14V6'                   40               S01153
0281 C**N40******ETYP      COMP '17S1'                   40               S01153
0282 C**N40******ETYP      COMP '17V1'                   41               S01153
0283 C**N40N41***ETYP      COMP '17M1'                   59               S01153
0284 C***40******                                                         S01153
0285 C*R*41N25***                                                         S01153
0286 C*R*59N25***          GOTO ENDD                                      S01153
     C***********                                               S01119    S01153
     C**FRA/IRS*EVENT TYPES IGNORE FOR UPDATING POSITIONS       S01119    S01153
     C***********                                               S01119    S01153
     C***********          MOVELETYP      ET12                  S01119    S01153
     C***********          MOVE ETYP      ET34    2             S01119    S01153
     C***********ET12      IFGE '21'                            S01119    S01153
     C***********ET12      ANDLE'24'                            S01119    S01153
     C***********ET34      ANDNE'I1'                            S01119    S01153
     C***********          GOTO ENDD                            S01119    S01153
     C***********          END                                  S01119    S01153
0287 C**
0288 C** CHECK FOR UPDATING FX POSITIONS
0289 C**
0290 C           ETYP      COMP '20V1'                   42
0291 C  N42      ETYP      COMP '20V2'                   43
      *                                                                                       CAP204
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN80     ANDEQ'1'                                                           CAP204
      *                                                                                       CAP204
     C           INOI      IFEQ 'I'                                                           CAP204
     C                     SETON                     42                                       CAP204
     C                     ELSE                                                               CAP204
     C                     SETON                     43                                       CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
0292 C   42
0293 COR 43                GOTO UPDATE
0294 C**
0295 C                     MOVELETYP      ET12    2
0296 C           ET12      COMP '11'                     44
0297 C  N44      ET12      COMP '12'                     44
0298 C  N44      ET12      COMP '13'                     44
0297 C  N44      ET12      COMP '94'                     44               S01127
0297 C  N44      ET12      COMP '95'                     44               S01127
0297 C  N44      ET12      COMP '96'                     44               S01127
0297 C  N44      ET12      COMP '97'                     44               S01127
0297 C  N44      ET12      COMP '98'                     44               S01127
0297 C  N44      ET12      COMP '99'                     44               S01127
0299 C   44                GOTO UPDATE
0300 C**
0301 C** CHECK FOR UPDATING INTEREST POSITIONS
0302 C**
0303 C           ETYP      COMP '14V3'                   45
0304 C  N45      ETYP      COMP '20V3'                   45
0305 C  N45      ETYP      COMP '14V4'                   46
0306 C*  SWAP LOSS -VE ON FILE  SO MAKE +VE   -- SWAPS ONLY, NOT IC'S
0307 C   46                Z-SUBEAMT      EAMT
0308 C  N45N46   ETYP      COMP '20V4'                   46
0309 C   45
0310 COR 46                GOTO UPDATE
0311 C**
0312 C           ETYP      COMP '41I2'                   35
0313 C  N35      ETYP      COMP '41M4'                   35
0314 C  N35      ETYP      COMP '41R2'                   35
0315 C  N35      ETYP      COMP '41M2'                   35
0316 C   35                GOTO UPDATE
0317 C**
0318 C           ETYP      COMP '42M1'                   36
0319 C   36                GOTO UPDATE
0320 C**
0321 C           ETYP      LOKUPTABEV1                   47
0322 C   47                GOTO UPDATE
     C**
     C           ETYP      COMP '61I2'                   71
     C  N71      ETYP      COMP '61R2'                   71
     C  N71      ETYP      COMP '61M2'                   71
     C  N71      ETYP      COMP '62I2'                   71
     C  N71      ETYP      COMP '62R2'                   71
     C  N71      ETYP      COMP '62M2'                   71
     C  N71      ETYP      COMP '64I2'                   71
     C  N71      ETYP      COMP '64R2'                   71
     C  N71      ETYP      COMP '64M2'                   71
     C  N71      ETYP      COMP '66I2'                   71
     C  N71      ETYP      COMP '66R2'                   71
     C  N71      ETYP      COMP '66M2'                   71
     C  N71      ETYP      COMP '70I2'                   71
     C  N71      ETYP      COMP '70M2'                   71
     C  N71      ETYP      COMP '61IY'                   71               CEU003
     C  N71      ETYP      COMP '61RY'                   71               CEU003
     C  N71      ETYP      COMP '61MY'                   71               CEU003
     C  N71      ETYP      COMP '62IY'                   71               CEU003
     C  N71      ETYP      COMP '62RY'                   71               CEU003
     C  N71      ETYP      COMP '62MY'                   71               CEU003
     C  N71      ETYP      COMP '64IY'                   71               CEU003
     C  N71      ETYP      COMP '64RY'                   71               CEU003
     C  N71      ETYP      COMP '64MY'                   71               CEU003
     C  N71      ETYP      COMP '66IY'                   71               CEU003
     C  N71      ETYP      COMP '66RY'                   71               CEU003
     C  N71      ETYP      COMP '66MY'                   71               CEU003
     C  N71      ETYP      COMP '70IY'                   71               CEU003
     C  N71      ETYP      COMP '70MY'                   71               CEU003
     C*                                                                   045634
     C* Add the Lending fee processing types here to be included in       045634
     C* as part of the interest income reporting                          045634
     C*                                                                   045634
     C  N71      ETYP      COMP '71F1'                   71               045634
     C  N71      ETYP      COMP '71F2'                   71               045634
      *                                                                   CLE005
      ** Include the new event types for the new loan processing          CLE005
      ** types 68, 69, 71 and 72 when CLE005 is switched on.              CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN71     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68I2'                                    CLE005
     C           ETYP      OREQ '68R2'                                    CLE005
     C           ETYP      OREQ '68M2'                                    CLE005
     C           ETYP      OREQ '69I2'                                    CLE005
     C           ETYP      OREQ '69R2'                                    CLE005
     C           ETYP      OREQ '69M2'                                    CLE005
     C           ETYP      OREQ '71I2'                                    CLE005
     C           ETYP      OREQ '71M2'                                    CLE005
     C           ETYP      OREQ '72I2'                                    CLE005
     C           ETYP      OREQ '72R2'                                    CLE005
     C           ETYP      OREQ '72M2'                                    CLE005
     C                     MOVE *ON       *IN71                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
      ** If CLE028 is on, process the event types                                             CLE028
      ** for loan processing type '80'                                                        CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN82     ANDEQ*ON                                                           CLE028
     C           *IN71     ANDEQ*OFF                                                          CLE028
     C           ETYP      IFEQ '80R2'                                                        CLE028
     C           ETYP      OREQ '80M2'                                                        CLE028
     C                     MOVE *ON       *IN71                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   CLE005
     C   71                GOTO UPDATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP6                                           S01408
     C*                                                                   S01408
0323 C**
0324 C** CHECK FOR UPDATING LOANS/DEPOSITS POSITIONS
0325 C**
0326 C           ETYP      LOKUPTABEV2                   48
     C/COPY WNCPYSRC,GL0630C002
0327 C   48                GOTO UPDATE
0328 C**
0329 C           ETYP      COMP '14V1'                   49
     C  N49      ETYP      COMP '14VX'                   49               CEU003
0330 C  N49      ETYP      COMP '14V2'                   53
     C  N49N53   ETYP      COMP '14VY'                   53               CEU003
0331 C   49
0332 COR 53                GOTO UPDATE
0333 C**
0334 C           ETYP      COMP '14V7'                   54
0335 C  N54      ETYP      COMP '20V7'                   54
0336 C  N54      ETYP      COMP '14V8'                   55
0337 C  N54N55   ETYP      COMP '20V8'                   55
0338 C   54
0339 COR 55                GOTO UPDATE
0340 C**
0341 C           ETYP      COMP '17V3'                   56
     C  N56      ETYP      COMP '17VZ'                   56               CEU003
0342 C  N56      ETYP      COMP '17M3'                   57
0343 C  N56N57   ETYP      COMP '18M1'                   58
     C  N56N57N58ETYP      COMP '18MX'                   58               CEU003
     C   56
     COR 57
     COR 58                GOTO UPDATE
     C**
     C           ETYP      COMP '61V1'                   73
     C  N73      ETYP      COMP '61R1'                   73
     C  N73      ETYP      COMP '61V3'                   73
     C  N73      ETYP      COMP '62V3'                   73               S01243
     C  N73      ETYP      COMP '64V3'                   73               S01243
     C  N73      ETYP      COMP '66V3'                   73               S01243
     C  N73      ETYP      COMP '61M1'                   73
     C  N73      ETYP      COMP '62V1'                   73
     C  N73      ETYP      COMP '62R1'                   73
     C  N73      ETYP      COMP '62M1'                   73
     C  N73      ETYP      COMP '64V1'                   73
     C  N73      ETYP      COMP '64R1'                   73
     C  N73      ETYP      COMP '64M1'                   73
     C  N73      ETYP      COMP '66V1'                   73
     C  N73      ETYP      COMP '66R1'                   73
     C  N73      ETYP      COMP '66M1'                   73
     C  N73      ETYP      COMP '63V1'                   73
     C  N73      ETYP      COMP '63V2'                   73
     C  N73      ETYP      COMP '63M1'                   73
     C  N73      ETYP      COMP '65V1'                   73
     C  N73      ETYP      COMP '65V2'                   73
     C  N73      ETYP      COMP '65M1'                   73
     C  N73      ETYP      COMP '67V1'                   73
     C  N73      ETYP      COMP '67V2'                   73
     C  N73      ETYP      COMP '67M1'                   73
     C  N73      ETYP      COMP '63R3'                   73               S01392
     C  N73      ETYP      COMP '63R4'                   73               S01392
     C  N73      ETYP      COMP '63R5'                   73               S01392
     C/COPY WNCPYSRC,GL0630C003
     C  N73      ETYP      COMP '61VX'                   73               CEU003
     C  N73      ETYP      COMP '61RX'                   73               CEU003
     C  N73      ETYP      COMP '61VZ'                   73               CEU003
     C  N73      ETYP      COMP '62VZ'                   73               CEU003
     C  N73      ETYP      COMP '64VZ'                   73               CEU003
     C  N73      ETYP      COMP '66VZ'                   73               CEU003
     C  N73      ETYP      COMP '61MX'                   73               CEU003
     C  N73      ETYP      COMP '62VX'                   73               CEU003
     C  N73      ETYP      COMP '62RX'                   73               CEU003
     C  N73      ETYP      COMP '62MX'                   73               CEU003
     C  N73      ETYP      COMP '64VX'                   73               CEU003
     C  N73      ETYP      COMP '64RX'                   73               CEU003
     C  N73      ETYP      COMP '64MX'                   73               CEU003
     C  N73      ETYP      COMP '66VX'                   73               CEU003
     C  N73      ETYP      COMP '66RX'                   73               CEU003
     C  N73      ETYP      COMP '66MX'                   73               CEU003
     C  N73      ETYP      COMP '63VX'                   73               CEU003
     C  N73      ETYP      COMP '63VY'                   73               CEU003
     C  N73      ETYP      COMP '63MX'                   73               CEU003
     C  N73      ETYP      COMP '65VX'                   73               CEU003
     C  N73      ETYP      COMP '65VY'                   73               CEU003
     C  N73      ETYP      COMP '65MX'                   73               CEU003
     C  N73      ETYP      COMP '67VX'                   73               CEU003
     C  N73      ETYP      COMP '67VY'                   73               CEU003
     C  N73      ETYP      COMP '67MX'                   73               CEU003
     C  N73      ETYP      COMP '63RZ'                   73               CEU003
      *                                                                   CLE006
      ** Do additional processings for multi-currency rollover            CLE006
      ** events.                                                          CLE006
      *                                                                   CLE006
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C  N73      ETYP      COMP '62R9'                   73               CLE006
     C  N73      ETYP      COMP '63R9'                   73               CLE006
     C  N73      ETYP      COMP '64R9'                   73               CLE006
     C  N73      ETYP      COMP '65R9'                   73               CLE006
     C  N73      ETYP      COMP '66R9'                   73               CLE006
     C  N73      ETYP      COMP '67R9'                   73               CLE006
     C  N73      ETYP      COMP '62V7'                   73               CLE006
     C  N73      ETYP      COMP '63V7'                   73               CLE006
     C  N73      ETYP      COMP '64V7'                   73               CLE006
     C  N73      ETYP      COMP '65V7'                   73               CLE006
     C  N73      ETYP      COMP '66V7'                   73               CLE006
     C  N73      ETYP      COMP '67V7'                   73               CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Include the new event types for the new loan processing          CLE005
      ** types 68, 69, 71 and 72 when CLE005 is switched on.              CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN73     ANDEQ'0'                                       CLE005
     C           ETYP      IFEQ '68V1'                                    CLE005
     C           ETYP      OREQ '68R1'                                    CLE005
     C           ETYP      OREQ '68V3'                                    CLE005
     C           ETYP      OREQ '69M1'                                    CLE005
     C           ETYP      OREQ '69V1'                                    CLE005
     C           ETYP      OREQ '69R1'                                    CLE005
     C           ETYP      OREQ '69V3'                                    CLE005
     C           ETYP      OREQ '69M1'                                    CLE005
     C           ETYP      OREQ '69R9'                                    CLE005
     C           ETYP      OREQ '69V7'                                    CLE005
     C           ETYP      OREQ '72V1'                                    CLE005
     C           ETYP      OREQ '72R1'                                    CLE005
     C           ETYP      OREQ '72V3'                                    CLE005
     C           ETYP      OREQ '72M1'                                    CLE005
     C           ETYP      OREQ '72R9'                                    CLE005
     C           ETYP      OREQ '72V7'                                    CLE005
     C                     MOVE *ON       *IN73                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** If CLE028 is on, process the event types                                             CLE028
      ** for loan processing type '80'                                                        CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN82     ANDEQ*ON                                                           CLE028
     C           *IN73     ANDEQ*OFF                                                          CLE028
     C           ETYP      IFEQ '80V1'                                                        CLE028
     C           ETYP      OREQ '80R1'                                                        CLE028
     C           ETYP      OREQ '80M1'                                                        CLE028
     C                     MOVE *ON       *IN73                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C**
     C***********                                                  S01270 E34885
     C****PROCESSING*ADDED*TO*INCLUDE*'62R3'*AND*'62R4'*EVENTS     S01270 E34885
     C***********                                                  S01270 E34885
     C************IN73     IFEQ '0'                                S01270 E34885
     C***********ETYP      ANDEQ'62R3'                             S01270 E34885
     C***********          MOVE '1'       *IN73                    S01270 E34885
     C***********          END                                     S01270 E34885
     C***********                                                  S01270 E34885
     C************IN73     IFEQ '0'                                S01270 E34885
     C***********ETYP      ANDEQ'62R4'                             S01270 E34885
     C***********          MOVE '1'       *IN73                    S01270 E34885
     C***********          END                                     S01270 E34885
     C***********                                                  S01270 E34885
     C**
     C**N76******ETYP******COMP '80M1'                   76               S01196
     C**N76******ETYP******COMP '81D1'                   76               S01196
     C**N76******ETYP******COMP '81M1'                   76               S01196
     C**N76******ETYP******COMP '81M3'                   76               S01196
     C**N76******ETYP******COMP '82A1'                   76               S01196
     C**N76******ETYP******COMP '82M1'                   76               S01196
     C**N76******ETYP******COMP '84V1'                   76               S01196
     C**N76******ETYP******COMP '84V2'                   76               S01196
     C**N76******ETYP******COMP '80M2'                   76               S01196
     C**N76******ETYP******COMP '81A2'                   76               S01196
     C**N76******ETYP******COMP '81P1'                   76               S01196
     C**N76******ETYP******COMP '81M2'                   76               S01196
     C**N76******ETYP******COMP '81M4'                   76               S01196
     C**N76******ETYP******COMP '82A2'                   76               S01196
     C**N76******ETYP******COMP '82M2'                   76               S01196
     C**N76******ETYP******COMP '84V3'                   76               S01196
     C**
      ** If Leo records are being processed, check for Leo event types    S01473
     C           ULEO      IFEQ 'Y'                                       S01473
      *                                                                   S01473
     C           ETYP      IFEQ '80M1'                                    S01473
     C           ETYP      OREQ '81D1'                                    S01473
     C           ETYP      OREQ '81M1'                                    S01473
     C           ETYP      OREQ '81M3'                                    S01473
     C           ETYP      OREQ '82A1'                                    S01473
     C           ETYP      OREQ '82M1'                                    S01473
     C           ETYP      OREQ '84V1'                                    S01473
     C           ETYP      OREQ '84V2'                                    S01473
     C           ETYP      OREQ '80M2'                                    S01473
     C           ETYP      OREQ '81A2'                                    S01473
     C           ETYP      OREQ '81P1'                                    S01473
     C           ETYP      OREQ '81M2'                                    S01473
     C           ETYP      OREQ '81M4'                                    S01473
     C           ETYP      OREQ '82A2'                                    S01473
     C           ETYP      OREQ '82M2'                                    S01473
     C           ETYP      OREQ '84V3'                                    S01473
     C                     MOVE 'Y'       ULEVNT  1                       S01473
     C                     END                                            S01473
      *                                                                   S01473
     C                     END                                            S01473
      *                                                                   S01473
     C           ETYP      COMP '30P1'                   77
     C  N77      ETYP      COMP '30S1'                   77
     C  N77      ETYP      COMP '30C1'                   77
     C  N77      ETYP      COMP '30C2'                   77
     C  N77      ETYP      COMP '30A1'                   77
     C  N77      ETYP      COMP '30D1'                   77
     C  N77      ETYP      COMP '30D2'                   77
     C  N77      ETYP      COMP '30M1'                   77
     C  N77      ETYP      COMP '30M2'                   77
0344 C**
0345 C** CHECK WHETHER EVENT DATE IS WORKING DAY.
0346 C** NOT GREATER THAN 16TH. WORKING DAY.
0347 C**
0348 C           UPDATE    TAG                             ** UPDATE TAG *
0349 C***48******EDAT******COMP RUND                   21                 S01194
0349 C   48      EDAT      COMP BJRDNB                 21                 S01194
0350 C   21                Z-ADD16        S
0351 C   21                GOTO INADD
0352 C**
0353 C   57      EAMT      SUB  OTHA      IAMT   130 6667
0354 C   57 67             Z-SUBIAMT      IAMT
0355 C   58      OTHA      SUB  EAMT      IAMT       6667
0356 C   58 67             Z-SUBIAMT      IAMT
     C/COPY WNCPYSRC,GL0630C004
0357 C   36      EAMT      SUB  OTHA      IAMT       6667
0358 C   36 67             Z-SUBIAMT      IAMT
0359 C                     Z-ADD0         S       20
0360 C           LOOP      TAG                             ** LOOP TAG  **
0361 C           S         ADD  1         S
      *                                                                   S01473
      ** If Leo records are being processed, and a one has been read      S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULDET     ANDEQ'Y'                                       S01473
     C           EDAT      COMP ODT,S                323130               S01473
     C                     END                                            S01473
      *                                                                   S01473
     C   82      EDAT      COMP ODT,S                323130
     C***84******EDAT******COMP ODT,S                323130               S01196
     C***86******EDAT      COMP ODT,S                323130               E28817
     C   18      EDAT      COMP ODT,S                323130               S03220
     C   04      EDAT      COMP ODT,S                323130               S01127
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP7                                           S01408
     C*                                                                   S01408
     C           CAP204    IFEQ 'Y'                                                           CAP204
     C           *IN80     ANDEQ'1'                                                           CAP204
     C           EDAT      COMP ODT,S                323130                                   CAP204
     C                     ENDIF                                                              CAP204
      *                                                                                       CAP204
     C   02
0362 COR 13      FFVD      COMP ODT,S                323130
0363 C           S         COMP 1                        34
0364 C   31 34             GOTO INADD
0365 C   31      S         SUB  1         S
0366 C           S         COMP 16                       33
0367 C   32N33             GOTO LOOP
0368 C**
0369 C** ADD EVENT AMOUNTS INTO OLPOS ARRAY READY FOR UPDATE
0370 C**
0371 C           INADD     TAG                             ** INADD TAG **
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP1                                           S01408
     C*                                                                   S01408
0372 C   42      OFI,S     ADD  EAMT      OFI,S            ** FX  20V1
      *                                                                   S01440
      ** If 'Accruals on Interest Outrights Flag' on dealing I.C.D.       S01440
      ** is on, only add amounts to FX record if deal type is not         S01440
      ** 'PI' or 'SI'                                                     S01440
      *                                                                   S01440
     C           BNAOIO    IFEQ 'Y'                        B1             S01440
     C*                                                                   S01440
     C** Do not update the FX incoming/outgoing position for              S01440
     C** Deals with deal types 'PI' or 'SI'                               S01440
     C*                                                                   S01440
     C           DTYP      IFNE 'PI'                       B*2            S01440
     C           DTYP      ANDNE'SI'                                      S01440
     C           *IN44     IFEQ '1'                        B**3           S01440
     C           *IN50     ANDEQ'1'                                       S01440
     C           OFI,S     ADD  EAMT      OFI,S                           S01440
     C                     END                             E**3           S01440
     C           *IN44     IFEQ '1'                        B**3           S01440
     C           *IN51     ANDEQ'1'                                       S01440
     C           OFO,S     ADD  EAMT      OFO,S                           S01440
     C                     END                             E**3           S01440
     C                     END                             E*2            S01440
     C*                                                                   S01440
     C                     ELSE                            X1             S01440
     C*                                                                   S01440
      ** If 'Accruals on Interest Outrights Flag' on dealing I.C.D.       S01440
      ** is off, update the FX positions including 'PI' and 'SI'          S01440
      ** Deal types                                                       S01440
     C*                                                                   S01440
     C           *IN44     IFEQ '1'                        B*2            S01440
     C           *IN50     ANDEQ'1'                                       S01440
     C           OFI,S     ADD  EAMT      OFI,S                           S01440
     C                     END                             E*2            S01440
     C           *IN44     IFEQ '1'                        B*2            S01440
     C           *IN51     ANDEQ'1'                                       S01440
     C           OFO,S     ADD  EAMT      OFO,S                           S01440
     C                     END                             E*2            S01440
     C                     END                             E1             S01440
     C*                                                                   S01440
0373 C***44*50***OFI,S*****ADD  EAMT      OFI,S            * 11,12,13 IN  S01440
0374 C   43      OFO,S     ADD  EAMT      OFO,S            * 20V2
0375 C***44*51***OFO,S*****ADD  EAMT      OFO,S            * 11,12,13 OUT S01440
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S03220
     C* FOR FP DETAIL RECORDS AND IGNORING TYPE '91P7'                    S03220
     C*        (50) ADD TO FX IN                                          S03220
     C*        (51) ADD TO FX OUT                                         S03220
     C*                                                                   S03220
     C           *IN18     IFEQ '1'                        ## B001        S03220
      *                                                                   187879
      ** Bypass the processing if the record read is coming from the      187879
      ** events file FPVNTDD and the event currency is equal to the       187879
      ** other currency                                                   187879
      *                                                                   187879
     C           ECCY      IFEQ OTCY                          B2          187879
     C                     ELSE                               X2          187879
      *                                                                   187879
     C********** ETYP      ANDNE'91P7'                             S03220 187879
     C           ETYP      IFNE '91P7'                        B3          187879
     C*                                                                   S03220
     C*                                                                   S03220
     C      50             ADD  EAMT      OFI,S                           S03220
     C      51             ADD  EAMT      OFO,S                           S03220
     C                     END                                E3          187879
     C                     END                                E2          187879
     C                     END                             ## E001        S03220
     C*                                                                   S03220
0376 C**                                                   ** INTEREST
0377 C   45                                                * 14V3,20V3
0378 COR 35 50
     COR 71 50
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP8                                           S01408
     C*                                                                   S01408
0379 COR 47 50   OII,S     ADD  EAMT      OII,S            * TABEV1 IN
0380 C   57 67                                             * DISC/PREM
0381 COR 36 66
0382 COR 58 67   OII,S     ADD  IAMT      OII,S
0383 C   46                                                * 14V4,20V4
0384 COR 35 51
     COR 71 51
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP9                                           S01408
     C*                                                                   S01408
0385 COR 47 51   OIO,S     ADD  EAMT      OIO,S            * TABEV1 OUT
0386 C   57 66
0387 COR 36 67
0388 COR 58 66   OIO,S     ADD  IAMT      OIO,S
     C*                                                                   S01392
     C**IF*FRONT-UP*INTEREST*=*Y*AND*'V1'*EVENT*BEING*PROCESSED*** S01392 CEU003
     C* IF FRONT-UP INTEREST = Y AND 'V1' OR 'VX' EVENT BEING PROCESSED   CEU003
     C* INCLUDE FRONT-UP INTEREST DUE ON VALUE DATE (NOTE THAT ALTHOUGH   S01392
     C* PRINCIPAL IS INCOMING, INTEREST IS OUTGOING - AND VICE VERSA)     S01392
     C*                                                                   S01392
     C   02      FUID      IFEQ 'Y'                                       S01392
     C           ETYP      IFEQ '15V1'                                    S01392
     C           ETYP      OREQ '16V1'                                    S01392
     C           ETYP      OREQ '15VX'                                    CEU003
     C           ETYP      OREQ '16VX'                                    CEU003
0379 C      51   OII,S     ADD  OTHA      OII,S            * INTEREST IN  S01392
0385 C      50   OIO,S     ADD  OTHA      OIO,S            * INTEREST OUT S01392
     C                     END                                            S01392
     C                     END                                            S01392
      *                                                                   S01440
      ** If 'Accruals on Interest Outrights Flag' on dealing I.C.D.       S01440
      ** is on, only add amounts to Interest record if deal type is       S01440
      ** 'PI' or 'SI'                                                     S01440
      *                                                                   S01440
     C           BNAOIO    IFEQ 'Y'                        B1             S01440
     C*                                                                   S01440
     C           DTYP      IFEQ 'PI'                       B*2            S01440
     C           DTYP      OREQ 'SI'                                      S01440
     C*                                                                   S01440
     C           *IN44     IFEQ '1'                        B**3           S01440
     C           *IN50     ANDEQ'1'                                       S01440
     C           OII,S     ADD  EAMT      OII,S                           S01440
     C                     END                             E**3           S01440
     C           *IN44     IFEQ '1'                        B**3           S01440
     C           *IN51     ANDEQ'1'                                       S01440
     C           OIO,S     ADD  EAMT      OIO,S                           S01440
     C                     END                             E**3           S01440
     C                     END                             B*2            S01440
     C                     END                             B1             S01440
0389 C**
0390 C*  55                                                ** LOANS/DEPS
0391 C   54
0392 COR 57
0393 COR 58
0394 COR 48 50
0395 COR 43 27
0396 COR 49 27
     COR 73 50
0397 COR 59 25   OLI,S     ADD  EAMT      OLI,S
0397 C***76*50***OLI,S*****ADD  EAMT      OLI,S                           S01196
0397 C   77 50   OLI,S     ADD  EAMT      OLI,S
     C/COPY WNCPYSRC,GL0630C005
      *                                                                   S01473
      ** If Leo records are being processed, and this is a Leo            S01473
      ** event type                                                       S01473
     C           ULEO      IFEQ 'Y'                                       S01473
     C           ULEVNT    ANDEQ'Y'                                       S01473
     C           *IN50     ANDEQ'1'                                       S01473
     C           OLI,S     ADD  EAMT      OLI,S                           S01473
     C                     END                                            S01473
      *                                                                     0003
0398 C*  54
0399 C   55
0400 COR 56
0401 COR 48 51
0402 COR 42 27
     COR 73 51
0403 COR 53 27
0403 C*R*76*51*************                                               S01196
0404 COR 41 25   OLO,S     ADD  EAMT      OLO,S
      *                                                                   S01473
      ** If Leo records are being processed, check for Leo event types    S01473
     C           ULEO      IFEQ 'Y'                                       S01473
      *                                                                   S01473
     C           ULEVNT    IFEQ 'Y'                                       S01473
     C           *IN51     ANDEQ'1'                                       S01473
     C           OLO,S     ADD  EAMT      OLO,S                           S01473
     C                     END                                            S01473
      *                                                                   S01473
      ** Reset the Leo flags for next cycle                               S01473
     C                     MOVE *BLANK    ULDET                           S01473
     C                     MOVE *BLANK    ULEVNT                          S01473
     C                     END                                            S01473
      *                                                                   S01473
     C   77 51   OLO,S     ADD  EAMT      OLO,S
0405 C**
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C           W0KEY2    CHAINEVNTXEL0             18                                       CGL187
      *                                                                                       CGL187
      ** For FX Deal Type PI,SI - Add Int Outright Accrued In                                 CGL187
      ** New Total TTFOT (TFI - TFO)                                                          CGL187
      *                                                                                       CGL187
     C           ETYP      IFEQ '11V1'                                                        CGL187
     C           ETYP      OREQ '11V2'                                                        CGL187
     C           INOI      IFEQ 'O'                                                           CGL187
     C                     ADD  AIPD      TFO                                                 CGL187
     C                     ELSE                                                               CGL187
     C                     ADD  AIPD      TFI                                                 CGL187
     C                     END                                                                CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
      ** For Fixed Term Loan/Deposit And Neg. Assets Purch,                                   CGL187
      ** Add Interest Accrued To Date In New Total TTFOT (TFI - TFO)                          CGL187
      *                                                                                       CGL187
     C           ETYP      LOKUPTABEV1                   18                                   CGL187
     C           *IN18     IFEQ '1'                                                           CGL187
     C           INOI      IFEQ 'O'                                                           CGL187
     C                     ADD  PSAIP     TFO                                                 CGL187
     C                     ELSE                                                               CGL187
     C                     ADD  PSAIP     TFI                                                 CGL187
     C                     END                                                                CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
      ** For Loans - Add Interest Accrued To Date In New Total TTFOT                          CGL187
      ** (TFI - TFO)                                                                          CGL187
      *                                                                                       CGL187
     C           ETYP      LOKUPTABEV3                   18                                   CGL187
     C           *IN18     IFEQ '1'                                                           CGL187
     C           INOI      IFEQ 'O'                                                           CGL187
     C                     ADD  PSAIP     TFO                                                 CGL187
     C                     ELSE                                                               CGL187
     C                     ADD  PSAIP     TFI                                                 CGL187
     C                     END                                                                CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
      ** For Swap FX Deals, Add P/L Already Accrued In Total TTMO                             CGL187
      *                                                                                       CGL187
     C           ETYP      IFEQ '14V3'                                                        CGL187
     C           ETYP      OREQ '14V4'                                                        CGL187
     C           INOI      IFEQ 'O'                                                           CGL187
     C                     ADD  PSAIP     TFO                                                 CGL187
     C                     ELSE                                                               CGL187
     C                     ADD  PSAIP     TFI                                                 CGL187
     C                     END                                                                CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,GL0630C001
0406 C           ENDD      TAG                             ** ENDD TAG  **
     C************IN03     IFEQ '1'                                       S01153
     C************         SETON                     24                   S01153
     C************         Z-ADDHRWN      ZZTOTI                          S01153
     C************         Z-ADDHRDC      ZZTOTD                          S01153
     C************         Z-ADDNORE      NORED   50                      S01153
     C************         END                                            S01153
     C*                                                         S01127    S01153
     C***FINANCIAL FUTURE                                       S01127    S01153
     C************IN07     IFEQ '1'                             S01127    S01153
     C************         Z-ADDHRWN      ZZAMTI                S01127    S01153
     C************         Z-ADDHRDC      ZZAMTD                S01127    S01153
     C************         EXSR GLZSUM                          S01127    S01153
     C***********NORE      ADD  NORED     NORED                 S01127    S01153
     C************         END                                  S01127    S01153
0597 C*
     C************IN14     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  2         NORED                           S01153
     C***********          END                                            S01153
0597 C*
     C************IN83     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  2         NORED                           S01153
     C***********          END                                            S01153
0409 C** LETTERS OF CREDIT
     C************IN85     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  2         NORED                           S01153
     C***********          END                                            S01153
     C** SECURITIES TRADING
     C************IN87     IFEQ '1'                                       S01153
     C************IN24     IFEQ '1'                             S01129    S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C*********************ELSE                                 S01129    S01153
     C*********************Z-ADDHRWN      ZZTOTI                S01129    S01153
     C*********************Z-ADDHRDC      ZZTOTD                S01129    S01153
     C*********************END                                  S01129    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***88******NORED     SUB  1         NORED                           S01153
     C************         END                                            S01153
     C***FUNDS*TRANSFER                                         S03220    S01153
     C************IN19     IFEQ '1'                             S03220    S01153
     C************         Z-ADDHRWN      ZZAMTI                S03220    S01153
     C************         Z-ADDHRDC      ZZAMTD                S03220    S01153
     C************         EXSR GLZSUM                          S03220    S01153
     C***********NORE      ADD  NORED     NORED                 S03220    S01153
     C***88******NORED     SUB  1         NORED                 S03220    S01153
     C************         END                                  S03220    S01153
      /EJECT                                                              S01129
0409 C**
0407 C***U7*U8*****        SETON                     LR70                 S01153
0408 C*1*17N70*****        EXSR OUTPUT                                    S01153
0408 CL1 17                EXSR OUTPUT                                    S01153
0409 C**
0410 C*R*70********        GOTO ENDLR                                     S01153
0411 C**
      ****Read*Securities Trading 2 Audit files and print separateS01129  S01153
      *****totals**                                             S01129    S01153
      *************                                             S01129    S01153
     C*R***********        Z-ADD0         HRWN                  S01129    S01153
     C*R***********        Z-ADD0         HRDC                  S01129    S01153
     C*R***********        Z-ADD0         NORE                  S01129    S01153
      *************                                             S01129    S01153
      ***Save*previous accumulatOr values.                      S01129    S01153
      *************                                             S01129    S01153
     C*R***********        Z-ADDZZTOTI    #TOTI  150            S01129    S01153
     C*R***********        Z-ADDZZTOTD    #TOTD   30            S01129    S01153
      *************                                             S01129    S01153
      ***Read*all*SE 2 Audit files.                             S01129    S01153
      *************                                             S01129    S01153
     C*R*********1*        CHAINTREVEAF              79         S01129    S01153
     C*R***********        Z-ADDHRWN      ZZTOTI                S01129    S01153
     C*R***********        Z-ADDHRDC      ZZTOTD                S01129    S01153
     C*R***********        Z-ADDNORE      #SEREC  50            S01129    S01153
      *************                                             S01129    S01153
     C*R*********1*        CHAINCPEVEAF              79         S01129    S01153
     C*R**********IN79     IFEQ '0'                             S01129    S01153
     C*R**********         Z-ADDHRWN      ZZAMTI                S01129    S01153
     C*R**********         Z-ADDHRDC      ZZAMTD                S01129    S01153
     C*R**********         EXSR GLZSUM                          S01129    S01153
     C*R**********         ADD  NORE      #SEREC                S01129    S01153
     C*R**********         END                                  S01129    S01153
      ************                                              S01129    S01153
     C*R*********1         CHAINDPEVEAF              79         S01129    S01153
     C*R**********IN79     IFEQ '0'                             S01129    S01153
     C*R**********         Z-ADDHRWN      ZZAMTI                S01129    S01153
     C*R**********         Z-ADDHRDC      ZZAMTD                S01129    S01153
     C*R**********         EXSR GLZSUM                          S01129    S01153
     C*R**********         ADD  NORE      #SEREC                S01129    S01153
     C*R**********         END                                  S01129    S01153
      ************                                              S01129    S01153
     C*R**********         Z-ADDZZTOTI    #SETI  150            S01129    S01153
     C*R**********         Z-ADDZZTOTD    #SETD   30            S01129    S01153
      ************                                              S01129    S01153
      ***Restore*previousely saved accumulator values           S01129    S01153
      ************                                              S01129    S01153
     C*R**********         Z-ADD#TOTI     ZZTOTI                S01129    S01153
     C*R**********         Z-ADD#TOTD     ZZTOTD                S01129    S01153
      *                                                         S01129    S01153
      /EJECT                                                              S01129
0412 C**
0413 C** COMPARE ACCUMULATED & TRAILER HASH & COUNT VALUES
0414 C**
     C*R***********        Z-ADDZZTOTI    HRWN                            S01153
     C*R***********        Z-ADDZZTOTD    HRDC                            S01153
     C*R***********        Z-ADDNORED     NORE                            S01153
0415 C*R*********TOTI      COMP HRWN                 8080                 S01153
0416 C*RN80******TOTD      COMP HRDC                 8080                 S01153
0417 C*R*********COUNT     COMP NORE                 8181                 S01153
0418 C*R*80********                                                       S01153
0419 C*R*81********        SETON                     U8                   S01153
0420 C**
0421 CLR         ENDLR     TAG                             ** ENDLR TAG **
     C** TOTAL CALCULATIONS                                               S01117
     C*                                                                   S01117
     C** IF NO RECORDS ON FILE THEN READ BANK DETAILS FOR OUTPUT          S01194
     CLR   N20             EXSR #ZZ                                       S01194
      /EJECT                                                              S01129
     C********************************************************************S01129
     C**                                                                  S01129
     C** SUBROUTINE FOR SECURITIES TRADING 2 EVENT RECORDS                S01129
     C**                                                                  S01129
     C********************************************************************S01129
     C           ST2       BEGSR                           ***** ST2 *****S01129
     C*                                                                   S01129
     C** FIND WHICH ARRAY ELEMENT IS TO BE UPDATED                        S01129
     C*                                                                   S01129
     C                     Z-ADD0         X       20                      S01129
     C                     MOVE ' '       FOUND   1                       S01129
     C*                                                                   S01512
     C           CCCE      IFNE '31P1'                                    S01512
     C           CCCE      ANDNE'31S1'                                    S01512
     C           CCCE      ANDNE'39C1'                                    CSE007
     C           CCCE      ANDNE'39D1'                                    CSE007
     C                     Z-ADDCCPD      CCDT                            S01512
     C                     END                                            S01512
     C*                                                                   S01129
     C           *IN65     DOUEQ'1'                                       S01129
     C           FOUND     OREQ 'Y'                                       S01129
     C*                                                                   S01129
     C                     ADD  1         X                               S01129
     C           CCDT      COMP ODT,X                616365               S01129
     C           *IN63     IFEQ '1'                                       S01129
     C           X         IFEQ 1                                         S01129
     C                     MOVE 'Y'       FOUND                           S01129
     C                     ELSE                                           S01129
     C                     SUB  1         X                               S01129
     C                     MOVE 'Y'       FOUND                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           *IN61     IFEQ '1'                                       S01129
     C           X         ANDEQ16                                        S01129
     C                     MOVE 'Y'       FOUND                           S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C** ADD TRADE EVENTS TO LOAN/DEPOSIT ARRAY                           S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31S1'                                    S01129
     C/COPY WNCPYSRC,GL0630C007
     C                     ADD  TRVN      OLO,X                           S01129
     C                     ADD  CCEA      OLI,X                           S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31P1'                                    S01129
     C/COPY WNCPYSRC,GL0630C008
     C                     ADD  TRVN      OLI,X                           S01129
     C                     ADD  CCEA      OLO,X                           S01129
     C                     END                                            S01129
     C*                                                                   CSE007
     C           CCCE      IFEQ '39C1'                                    CSE007
     C           CCCE      OREQ '39D1'                                    CSE007
     C*                                                                   CSE007
     C           INOI      IFEQ 'I'                                       CSE007
     C                     ADD  TRVN      OLO,X                           CSE007
     C                     ADD  CCEA      OLI,X                           CSE007
     C                     ELSE                                           CSE007
     C                     ADD  TRVN      OLI,X                           CSE007
     C                     ADD  CCEA      OLO,X                           CSE007
     C                     ENDIF                                          CSE007
     C*                                                                   CSE007
     C                     ENDIF                                          CSE007
     C*                                                                   S01129
     C** FOR COUPON OR DIVIDEND TYPE EVENTS ADD TO INTEREST ARRAY         S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31C2'                                    S01129
     C           CCCE      OREQ '31C3'                                    S01129
     C           CCNA      IFGT 0                                         S01129
     C                     ADD  CCNA      OII,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCNA                            S01129
     C                     ADD  CCNA      OIO,X                           S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCEA      IFGT 0                                         S01129
     C                     ADD  CCEA      OIO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCEA                            S01129
     C                     ADD  CCEA      OII,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31D2'                                    S01129
     C           CCCE      OREQ '31D3'                                    S01129
     C           CCNA      IFGT 0                                         S01129
     C                     ADD  CCNA      OIO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCNA                            S01129
     C                     ADD  CCNA      OII,X                           S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCEA      IFGT 0                                         S01129
     C                     ADD  CCEA      OII,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCEA                            S01129
     C                     ADD  CCEA      OIO,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C** ADD PART PAYMENT TYPE EVENTS TO LOAN/DEPOSIT ARRAY               S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31C1'                                    S01129
     C           CCNA      IFGT 0                                         S01129
     C                     ADD  CCNA      OLO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCNA                            S01129
     C                     ADD  CCNA      OLI,X                           S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCEA      IFGT 0                                         S01129
     C                     ADD  CCEA      OLI,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCEA                            S01129
     C                     ADD  CCEA      OLO,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31D1'                                    S01129
     C           CCNA      IFGT 0                                         S01129
     C                     ADD  CCNA      OLI,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCNA                            S01129
     C                     ADD  CCNA      OLO,X                           S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCEA      IFGT 0                                         S01129
     C                     ADD  CCEA      OLO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCEA                            S01129
     C                     ADD  CCEA      OLI,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C** FOR MORTGAGE PAYMENT MATURITY EVENTS CALCULATE PRINCIPAL         S01129
     C** AMOUNT IN SETTLEMENT AND NOMINAL CURRENCIES AND ADD TO           S01129
     C** LOAN/DEPOSIT ARRAY                                               S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31C4'                                    S01129
     C           CCCE      OREQ '31C5'                                    S01129
     C           CCCE      OREQ '31D4'                                    S01129
     C           CCCE      OREQ '31D5'                                    S01129
     C                     SUB  CCAS      CCEA                            S01129
     C                     SUB  CCAN      CCNA                            S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31C4'                                    S01129
     C           CCCE      OREQ '31C5'                                    S01129
     C           CCEA      IFGT 0                                         S01129
     C                     ADD  CCEA      OLO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCEA                            S01129
     C                     ADD  CCEA      OLI,X                           S01129
     C                     END                                            S01129
     C           CCNA      IFGT 0                                         S01129
     C                     ADD  CCNA      OLI,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCNA                            S01129
     C                     ADD  CCNA      OLO,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31D4'                                    S01129
     C           CCCE      OREQ '31D5'                                    S01129
     C           CCEA      IFGT 0                                         S01129
     C                     ADD  CCEA      OLI,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCEA                            S01129
     C                     ADD  CCEA      OLO,X                           S01129
     C                     END                                            S01129
     C           CCNA      IFGT 0                                         S01129
     C                     ADD  CCNA      OLO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCNA                            S01129
     C                     ADD  CCNA      OLI,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C** IF COUPON AMOUNT IN NOMINAL OR SETTLEMENT CURRENCY IS NOT ZERO   S01129
     C** ADD TO INTEREST ARRAY                                            S01129
     C*                                                                   S01129
     C           CCAS      IFNE 0                                         S01129
     C           CCAN      ORNE 0                                         S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31C4'                                    S01129
     C           CCCE      OREQ '31C5'                                    S01129
     C           CCAS      IFGT 0                                         S01129
     C                     ADD  CCAS      OIO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCAS                            S01129
     C                     ADD  CCAS      OII,X                           S01129
     C                     END                                            S01129
     C           CCAN      IFGT 0                                         S01129
     C                     ADD  CCAN      OII,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCAN                            S01129
     C                     ADD  CCAN      OIO,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           CCCE      IFEQ '31D4'                                    S01129
     C           CCCE      OREQ '31D5'                                    S01129
     C           CCAS      IFGT 0                                         S01129
     C                     ADD  CCAS      OII,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCAS                            S01129
     C                     ADD  CCAS      OIO,X                           S01129
     C                     END                                            S01129
     C           CCAN      IFGT 0                                         S01129
     C                     ADD  CCAN      OIO,X                           S01129
     C                     ELSE                                           S01129
     C                     MULT -1        CCAN                            S01129
     C                     ADD  CCAN      OII,X                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C                     ENDSR                                          S01129
     C*                                                                   S01129
0422 C********************************************************************
0423 C*****                                                        S01117 E20103
0424 C***SUBROUTINE TO HASH TOTAL AND COUNT EVENT RECORDS          S01117 E20103
0425 C*****      SRHASH    BEGSR                    *** SRHASH  ***S01117 E20103
0426 C*****                MOVE EAMT      ZZAMT                    S01117 E20103
0427 C***26                Z-SUBZZAMT     ZZAMT                    S01117 E20103
0428 C*****                MOVE TOTI      ZZTOTI                   S01117 E20103
0429 C*****                MOVE TOTD      ZZTOTD                   S01117 E20103
0430 C*****                EXSR GLZADD                             S01117 E20103
0431 C*****                MOVE ZZTOTI    TOTI   150               S01117 E20103
0432 C*****                MOVE ZZTOTD    TOTD    30               S01117 E20103
0433 C*****                                                        S01117 E20103
0434 C*****      COUNT     ADD  1         COUNT                    S01117 E20103
0435 C*****                                                        S01117 E20103
0436 C*****                ENDSR                    ***  ENDSR  ***S01117 E20103
0437 C*****                                                        S01117 E20103
0438 C********************************************************************
0423 C**                                                                  E20103
0424 C** SUBROUTINE TO HASH TOTAL AND COUNT EVENT RECORDS                 E20103
0425 C           SRHASH    BEGSR                           *** SRHASH  ***E20103
0426 C                     MOVE EAMT      ZZAMT                           E20103
0427 C   26                Z-SUBZZAMT     ZZAMT                           E20103
0428 C                     MOVE TOTI      ZZTOTI                          E20103
0429 C                     MOVE TOTD      ZZTOTD                          E20103
0430 C                     EXSR GLZADD                                    E20103
0431 C                     MOVE ZZTOTI    TOTI   150                      E20103
0432 C                     MOVE ZZTOTD    TOTD    30                      E20103
0433 C**                                                                  E20103
0434 C           COUNT     ADD  1         COUNT                           E20103
0435 C**                                                                  E20103
0436 C                     ENDSR                           ***  ENDSR  ***E20103
0437 C**                                                                  E20103
0438 C********************************************************************
0440 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.   S01194
0441 C*********************                                               S01194
0442 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
0443 C*********************                                               S01194
0444 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.**                  S01194
0445 C*********************MOVEL'01      'ZTABKY 12                       S01194
0446 C*********************MOVE '  10'    ZTABKY                          S01194
0447 C*********************                                               S01194
0448 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0449 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0450 C*********************                                               S01194
0451 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.**                  S01194
0452 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
0453 C*********************                                               S01194
0454 C*********************ENDSR                                          S01194
0455 C*********************                                               S01194
0456 C*********************                                               S01194
0457 C********************************************************************
0458 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0459 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0460 C*
0461 CSR         GLZADD    BEGSR                           *** GLZADD ****
0462 C*
0463 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0464 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0465 C*
0466 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0467 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0468 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0469 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0470 C*
0471 CSR                   EXSR GLZSUM
0472 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0473 C*
0474 C********************************************************************
0475 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0476 C*                        GLZADD, GLZSUB, GLZCMP.
0477 C*          PARAMETERS PASSED -
0478 C*                     I/P ZZAMTI ZZAMTD
0479 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0480 C*
0481 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0482 C*
0483 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0484 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0485 CSR                   SETOF                     919293
0486 CSR                   SETOF                     949599
0487 C*
0488 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0489 CSR         ZZAMTI    COMP 0                      9293
0490 CSR 93      ZZAMTD    COMP 0                      9293
0491 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0492 C*
0493 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0494 CSR         ZZTOTI    COMP 0                      9193
0495 CSR 93      ZZTOTD    COMP 0                      9193
0496 C*
0497 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0498 CSR 93                Z-ADDZZAMTI    ZZTOTI
0499 CSR 93                Z-ADDZZAMTD    ZZTOTD
0500 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0501 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0502 CSR 91N92
0503 CORN91 92             GOTO ZZOFPS
0504 C*
0505 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0506 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0507 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0508 C*
0509 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0510 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0511 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0512 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0513 C*
0514 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0515 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0516 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0517 CSRN99                Z-ADDZZWK2     ZZTOTD
0518 CSRN99                Z-ADDZZWK3     ZZTOTI
0519 C*
0520 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0521 CSR 99                Z-ADD0         ZZAMT  153
0522 CSR                   GOTO ZZSEND
0523 C*
0524 C* THE 'SIGNS' ARE DIFFERENT
0525 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0526 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0527 C*
0528 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0529 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0530 C*
0531 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0532 C*
0533 CSR 91                Z-SUBZZTOTI    ZZTOTI
0534 CSR 91                Z-SUBZZTOTD    ZZTOTD
0535 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0536 C*
0537 CSR         ZZTOTI    COMP ZZAMTI               93  95
0538 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0539 C*
0540 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0541 CSR 95                Z-ADD0         ZZTOTI
0542 CSR 95                Z-ADD0         ZZTOTD
0543 CSR 95                GOTO ZZSEND
0544 C*
0545 C* IF ZZTOT GT. ZZAMT.
0546 CSR 93      ZZAMTD    COMP ZZTOTD               94
0547 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0548 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0549 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0550 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0551 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0552 C*
0553 C*
0554 C* IF ZZAMT GT. ZZTOT.
0555 CSRN93      ZZTOTD    COMP ZZAMTD               94
0556 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0557 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0558 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0559 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0560 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0561 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0562 C*
0563 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0564 CSR                   SETOF                     94
0565 CSR 93 91
0566 CORN93 92             SETON                     94
0567 CSR 94                Z-SUBZZTOTI    ZZTOTI
0568 CSR 94                Z-SUBZZTOTD    ZZTOTD
0569 C**
0570 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0571 CSR 92                Z-SUBZZAMTI    ZZAMTI
0572 CSR 92                Z-SUBZZAMTD    ZZAMTD
0573 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0574 C**
0575 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0576 CSR                   SETOF                     96
0577 CSR         ZZTOTD    COMP 0                        91
0578 CSR 91      ZZTOTI    COMP 0                      96
0579 CSR 96                MOVE '.000-'   ZZNEGD  5
0580 CSR                   ENDSR                             ** ENDSR **
0581 C********************************************************************
0582 C**
0583 C***SUBROUTINE*TO*UPDATE*OLPOS*FILE*******************************   S01117
0583 C** SUBROUTINE TO ADD/UPDATE RECORDS IN THE POSITIONS FILE (OLPOS)   S01117
0584 C**
0585 C           OUTPUT    BEGSR                           *** OUTPUT  ***
0586 C**
     C                     MOVE 'N'       WEXNXT  1                       CLE005
     C           *IN22     CABEQ'1'       UPZED                           S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL0630CBDU                                           S01408
     C*                                                                   S01408
      *                                                                   CLE006
      ** Do not update foreign exchange position and Interest             CLE006
      ** records.                                                         CLE006
      *                                                                   CLE006
     C           CLE006    IFEQ 'N'                                       CLE006
     C           CEU020    ANDEQ'N'                                       CEU020
     C                     MOVE 'Y'       WEXNXT                          CEU020
     C                     ENDIF                                          CEU020
     C           CEU020    IFEQ 'Y'                                       CEU020
     C           CLE006    OREQ 'Y'                                       CLE006
     C***********ETYP      ANDNE'62R9'                             CLE006 CEU020
     C           ETYP      IFNE '62R9'                                    CEU020
     C           ETYP      ANDNE'63R9'                                    CLE006
     C           ETYP      ANDNE'64R9'                                    CLE006
     C           ETYP      ANDNE'65R9'                                    CLE006
     C           ETYP      ANDNE'66R9'                                    CLE006
     C           ETYP      ANDNE'67R9'                                    CLE006
     C           ETYP      ANDNE'62V7'                                    CLE006
     C           ETYP      ANDNE'63V7'                                    CLE006
     C           ETYP      ANDNE'64V7'                                    CLE006
     C           ETYP      ANDNE'65V7'                                    CLE006
     C           ETYP      ANDNE'66V7'                                    CLE006
     C           ETYP      ANDNE'67V7'                                    CLE006
     C                     MOVE 'Y'       WEXNXT                          CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CEU020
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           ETYP      IFEQ '69R9'                                    CLE005
     C           ETYP      OREQ '69V7'                                    CLE005
     C           ETYP      OREQ '72R9'                                    CLE005
     C           ETYP      OREQ '72V7'                                    CLE005
     C                     MOVE 'N'       WEXNXT                          CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C           WEXNXT    IFEQ 'Y'                                       CLE005
0587 C                     SETON                     60
0588 C                     EXCPT
0589 C                     SETOF                     60
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     MOVE RECX      REXX                                                CGL187
      *                                                                                       CGL187
     C           W0KEY1    CHAINOLPOSOD0             22                                       CGL187
      *                                                                                       CGL187
     C                     Z-ADDWWWKFL    TTFOT                                               CGL187
      *                                                                                       CGL187
     C                     UPDATOLPOSOD0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
0590 C*
0591 C***********          MOVE '02'      OLKEY                           S01117
0591 C                     MOVE '02'      RECX                            S01117
0592 C           OLKEY     CHAINOLPOS                22
0593 C*
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     MOVE RECX      REXX                                                CGL187
      *                                                                                       CGL187
     C           W0KEY1    CHAINOLPOSOD0             22                                       CGL187
      *                                                                                       CGL187
     C           TFI       SUB  TFO       TTFOT  150                                          CGL187
      *                                                                                       CGL187
     C                     UPDATOLPOSOD0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
0594 C                     SETON                     62
0595 C                     EXCPT
0596 C                     SETOF                     62
     C                     ENDIF                                          CLE006
0597 C*
0598 C***********          MOVE '03'      OLKEY                           S01117
0598 C                     MOVE '03'      RECX                            S01117
0599 C           OLKEY     CHAINOLPOS                22
0600 C*
0601 C                     SETON                     64
0602 C                     EXCPT
0603 C                     SETOF                     64
0604 C*
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     MOVE RECX      REXX                                                CGL187
      *                                                                                       CGL187
     C           W0KEY1    CHAINOLPOSOD0             22                                       CGL187
      *                                                                                       CGL187
     C                     Z-ADDWWWKFL    TTFOT                                               CGL187
      *                                                                                       CGL187
     C                     UPDATOLPOSOD0                                                      CGL187
      *                                                                                       CGL187
     C                     Z-ADD*ZEROS    TTFOT                                               CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
0605 C*
0606 C           UPZED     TAG                             ** UPZED TAG **
0607 C                     Z-ADD0         OFI
0608 C                     Z-ADD0         OFO
0609 C                     Z-ADD0         OII
0610 C                     Z-ADD0         OIO
0611 C                     Z-ADD0         OLI
0612 C                     Z-ADD0         OLO
     C*                                                                   S01408
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     Z-ADD0         TFI    150                                          CGL187
     C                     Z-ADD0         TFO    150                                          CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,GL0630CADU                                           S01408
     C*                                                                   S01408
0613 C**
0614 C                     ENDSR                           ***  ENDSR  ***
0615 C**
     C*****************************************************************   S01194
     C*                                                                   S01194
     C* SUBROUTINE : #ZZ                                                  S01194
     C*                                                                   S01194
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01194
     C* NO RECORDS READ AND THEREFORE SDBANKPD NOT READ                   S01194
     C*                                                                   S01194
     C           #ZZ       BEGSR                                          S01194
     C*                                                                   S01194
     C** IF FIRST CYCLE NOT PERFORMED GET BANK DETAILS FOR HEADINGS       S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'02'      DBASE   2        * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #ZZ9                                      S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           #ZZ9      ENDSR                                          S01194
0616 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
      *                                                                   S01408
     C/COPY WNCPYSRC,GL0630CCP3                                           S01408
      *                                                                   S01408
0617 C/EJECT
0618 OOLPOS   E        60
0619 O                         OFI      190P
0620 O                         OFO      318P
     O                         WTNLU    400P                              S01129
0621 O        E        62
0622 O                         OII      190P
0623 O                         OIO      318P
     O                         WTNLU    400P                              S01129
0624 O        E        64
0625 O                         OLI      190P
0626 O                         OLO      318P
     O                         WTNLU    400P                              S01129
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0630OOPG                                           S01408
     O*                                                                   S01408
0627 O**
0628 O*PRINT  T  203   LR                                                 S01124
0628 O*****DL0630P1T  203   LR                                      S01124S01117
     O*DL0630AUT**203***LR***************                           S01117E22608
     OGL0630AUT  203   LR                                                 E22608
0629 O***********************************22 'REFERENCE DL0630'            S01117
     O***********************************24 'REFERENCE DL0630AU'    S01117E22608
     O                                   24 'REFERENCE GL0630AU'          E22608
0630 O*************************TITL      89                               S01194
0909 O                         BJURPT    89                               S01194
0631 O                                  104 'DATE'
0632 O*************************RUNA     112                               S01194
0911 O                         BJMRDT   112                               S01194
0633 O                                  122 'PAGE'
0634 O                         PAGE  Z  127
0635 O        T  1     LR
0636 O                 U4                41 'SECURITIES TRADING '
0636 O                                   65 'EVENTS FILE UPDATE OF ON'
0637 O                                   85 'LINE POSITIONS FILE'
0638 O        T        LR
0636 O                 U4                41 '-------------------'
0639 O                                   64 '------------------------'
0640 O                                   85 '---------------------'
0641 O********T  236   LRN70                                              S01153
0641 O        T  236   LR                                                 S01153
0642 O                                   18 'RUN CONTROLS'
0643 O********T  2     LRN70                                              S01153
0643 O        T  2     LR                                                 S01153
0644 O                                   59 'NUMBER'
0645 O*****                              84 'VALUE'                       S01117
0646 O********T  2     LRN70                                              S01153
0646 O        T  2     LR                                                 S01153
0647 O***********************************32 'RECORDS READ IN THIS PRO'    S01129
0648 O***********************************36 'GRAM'                        S01129
0791 O                                   30 'EVENTS FILE RECORDS RE'      S01129
0792 O                                   32 'AD'                          S01129
0649 O                         COUNT 3   59
0650 O*****                    TOTI  Z   81                               S01117
0651 O*****                    TOTD      84                               S01117
0652 O********T**3     LRN70                                              S01153
0653 O************                       27 'FILE CONTROL TOTALS'         S01153
0654 O************             NORE  3   59                               S01153
0655 O************             HRWN  Z   81                               S01153
0656 O************             HRDC      84                               S01153
0657 O********T**3*****LR U8NU7                                 S01129    S01153
0658 O***********************************71 '***   DIFFERENCE   ***'S01129S01153
     O                    U8NU7         102 '** DIFFERENCE **'            S01129
     O        T 22     LR                                                 S01153
     O                                   26 'SECURITY TRADING 2'          S01129
     O                                 +  1 'RECORDS READ'                S01129
     O                         SETOT 3   59                               S01129
     O***********              SETOTIZ   81                     S01129    S01153
     O***********              SETOTD    84                     S01129    S01153
     O********T**2     LRN70                                    S01129    S01153
     O***********                        26 'SECURITY TRADING 2'S01129    S01153
     O***********                      +  1 'AUDIT TOTALS'      S01129    S01153
     O***********              #SEREC3   59                     S01129    S01153
     O***********              #SETI Z   81                     S01129    S01153
     O***********              #SETD     84                     S01129    S01153
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBOPTN    54                               S01117
     O********T*3******LR                                                 LN0135
0660 O********************************   65 '***   END OF REPORT'         LN0135
0661 O********************************   71 '***'                         LN0135
     O* Added 10 entries to TABEV1 after 24I1 for the new events          CEU003
     O*  Added 8 entries to TABEV2 after 16M4 for the new events          CEU003
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  TABEV1 -- EVENT TYPES FOR INTEREST UPDATING
15I216I217I215M216M217M221I122I123I124I1                                  S01119
15IY16IY17IY15MY16MY17MY21IX22IX23IX24IX                                  CEU003
**  TABEV2 -- EVENT TYPES FOR LOANS/DEPOSITS UPDATING
15V115V316V116V315M115M416M116M4
15VX15VZ16VX16VZ15MX15MZ16MX16MZ                                          CEU003
**  TABEV3 -- EVENT TYPES FOR LOANS INTEREST UPDATING                                         CGL187
61I261M262I262M264I264M266I266M270I270M2                                                      CGL187
