     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas General Ledger Data Extract')
0001 H***********                                                         S01117
0002 F********************************************************************GL0705
     F*                                                                  *GL0705
     F*  Midas - General Ledger Module
0004 F*                                                                  *GL0705
0005 F*    GL0705 - GENERAL LEDGER DATA EXTRACT                          *GL0705
0006 F*                                                                  *GL0705
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *GL0705
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. BUG3826            Date 27Jul04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01MAR99               *
      *                 CTI002 EM / TI Interface 23/09/98             *
     F*                   S01333   DATE  18APR91                         *
     F*                   S01117   DATE  07/04/89                        *
0009 F*                   S01194   DATE  08/03/89                        *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  BUG3826 - General Ledger bals report produces 5,000 spool files *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *    CSD005  -  Standing Data Account Narrative.  Add new field
      *               to SDACODPD.  Recompilation of programs.
      *    CTI002  -  Recompiled : File SDACODPD changed
     F*    S01333  -  MIS REL 10, TITLE A/C CODE MISSING FROM EXDAEA     *
     F*               BECAUSE FILE NOT READ IN KEY SEQUENCE              *
     F*    S01117  -  MULTIBRANCHING                                     *
     F*    S01194  -  NEW STANDING DATA                                  *
0010 F*                                                                  *GL0705
0011 F********************************************************************GL0705
0012 F*                                                                   GL0705
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*ABLE***IP* F      96 12AI     2 DISK                               S01194
     F*SDACODL1IP**E****                DISK                       S01194 S01333
     FSDACODL1IP  E           K        DISK                               S01333
0014 F***EXDAEA* O   F      64  4AI     2 DISK                                         GL0705 CGL029
0014 FEXDAEA  O   F      84 10AI     2 DISK                                                   CGL029
0015 F*L0705P1O** F     132            PRINTER                      S01124S01117
0015 FGL0705AUO   F     132            PRINTER                            S01117
0016 F*                                                                   GL0705
0017 F**01*******      TABLE FILE INSTALLATION CONTROL RECORD             S01194
0018 F**02*******      TABLE FILE ACCOUNT CODES RECORD                    S01194
0019 F**03*******      TABLE HEADER RECORDS                               S01194
     F*       20       OFF - FIRST CYCLE                                  S01194
0020 F*       40       TITLE ONLY RECORD                                  GL0705
0021 F*       41       ACCOUNT SECTION 1                                  GL0705
0022 F*       42       ACCOUNT SECTION 2                                  GL0705
0023 F*       43       ACCOUNT SECTION 3                                  GL0705
0024 F*       44       ACCOUNT SECTION 4                                  GL0705
0025 F*       45       ACCOUNT SECTION 5                                  GL0705
     E                    CPY@    1   1 80
0026 I***********                                                         S01194
0027 I*****TABLE*FILE INSTALLATION CONTROL RECORD                         S01194
0028 I*ABLE***NS* 01   1 CD   2 C0   3 C1                                 S01194
0029 I*******AND*     12 C1  13 C0                                        S01194
0030 I***********                             1   1 RECI                  S01194
0031 I***********                            14  66 TITL                  S01194
0032 I***********                            80  86 RUNA                  S01194
0033 I***********                                                         S01194
0034 I*****TABLE*FILE ACCOUNT CODE RECORD                                 S01194
0035 I********NS* 02   1 CD   2 C3   3 C0                                 S01194
0036 I*******AND*     13 C1                                               S01194
0037 I***********                             9  120ACOD                  S01194
0038 I***********                            14  38 ACKN                  S01194
0039 I***********                            48  48 TITO                  S01194
0040 I***********                            75  76 ACCS                  S01194
0041 I***********                                                         S01194
0042 I*****HEADER RECORD                                                  S01194
0043 I********NS* 03   1 CH                                               S01194
0044 I***********                                                         S01194
0045 I*****CATCH*ALL                                                      S01194
0046 I********NS*                                                         S01194
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     ILDA        UDS                            256                       S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     IRUNDT       DS                                                      S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*                                                                   S01194
     I**   BANK DETAILS                                                   S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     C********************************************************************
     C*                                                                   S01194
     C**   F I R S T    C Y C L E                                         S01194
     C*                                                                   S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C*                                                                   S01194
     C           *IN20     IFEQ '0'                                       S01194
     C                     MOVEACPY@      BIS@   80
     C                     SETON                     20                   S01194
     C                     MOVEL'GL0705'  DBPGM  10                       S01194
     C*                                                                   S01194
     C**   OBTAIN BANK TITLE AND RUNDATE                                  S01194
     C*                                                                   S01194
     C                     EXSR SYSTM                                     S01194
     C           *INU8     IFEQ '1'                                       S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
0047 C*    INITIALIZE COUNT OF RECORDS WRITTEN                            GL0705
0048 C***01******          Z-ADD2         NORE    50                      S01194
     C                     Z-ADD0         NORE    50                      S01194
     C                     END                                            S01194
0049 C***********                                                         S01194
0050 C*END*JOB*IF ALL ACCOUNT CODES HAVE BEEN PROCESSED.                  S01194
0049 C***********                                                         S01194
0051 C***20*03***          SETON                     LR                   S01194
0052 C***********                                                         S01194
0053 C*SET*INDICATOR*WHEN FIRST ACCOUNT CODE IS READ.                     S01194
0052 C***********                                                         S01194
0054 C***02******          SETON                     20                   S01194
0052 C***********                                                         S01194
0055 C*BYPASS*PROCESSING*IF NOT ACCOUNT CODE RECORD                       S01194
0052 C***********                                                         S01194
0056 C************IN02     IFEQ '1'                                       S01194
0052 C*****                                                               GL0705
0058 C*ACCUMULATE NO. OF RECORDS READ                                     GL0705
0052 C*****                                                               GL0705
0059 C           TOTRD     ADD  1         TOTRD   50                      GL0705
0060 C*****                                                               GL0705
0061 C*IF TITLE ONLY RECORD SAVE FIELDS AND READ NEXT RECORD              GL0705
0060 C*****                                                               GL0705
0062 C***********TITO      COMP 'Y'                      40               S01194
     C           A5TOIN    IFEQ 'Y'                                       S01194
     C                     SETON                     40                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     40                   S01194
     C                     END                                            S01194
     C           *IN40     IFEQ '1'
0063 C***********          MOVE ACOD      TACD    40                      S01194
0064 C***********          MOVE ACKN      TANM   25                       S01194
     C**********           MOVE A5ACCD    TACD    40                                   S01194 CGL029
     C                     MOVE A5ACCD    TACD   100                                          CGL029
     C                     MOVE A5ACCN    TANM   25                       S01194
0065 C                     ELSE                                           GL0705
0066 C*****                                                               GL0705
0067 C*ACCUMULATE NO OF RECORDS WRITTEN                                   GL0705
0066 C*****                                                               GL0705
0068 C           NORE      ADD  1         NORE                            GL0705
0069 C*****                                                               GL0705
0070 C*DETERMINE ACCOUNT SECTION                                          GL0705
0069 C*****                                                               GL0705
0071 C                     SETOF                     45                   GL0705
0072 C***********ACCS      COMP 'AS'                     41 ACCS 1        S01194
0073 C***********ACCS      COMP 'LI'                     42 ACCS 2        S01194
0074 C***********ACCS      COMP 'IN'                     43 ACCS 3        S01194
0075 C***********ACCS      COMP 'EX'                     44 ACCS 4        S01194
0072 C           A5ACSC    COMP 'AS'                     41 ACCS 1        S01194
0073 C           A5ACSC    COMP 'LI'                     42 ACCS 2        S01194
0074 C           A5ACSC    COMP 'IN'                     43 ACCS 3        S01194
0075 C           A5ACSC    COMP 'EX'                     44 ACCS 4        S01194
0076 C  N41N42N43                                                         GL0705
0077 CAN   N44             SETON                         45 ACCS 5        GL0705
0069 C*****                                                               GL0705
0079 C                     END                              ** END **     GL0705
     C           END       TAG                                            S01194
     C*                                                                   S01194
     C**  IF LF/SDACODL1 IS EMPTY THEN OBTAIN THE RUNDATE AND BANK        S01194
     C**  REPORTING NAME VIA SDBANKR0                                     S01194
     C*                                                                   S01194
     CLRN20                EXSR SYSTM                                     S01194
0315 C********************************************************************S01194
0316 C**                                                                  S01194
     C**   SR. TO ACCESS BANK DETAILS                                     S01194
0318 C**                                                                  S01194
0319 C           SYSTM     BEGSR                           *SYSTM SR.  *  S01194
0320 C**                                                                  S01194
     C                     IN   RUNDT                                     S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL'001'     DBASE            * DB ERROR 001 S01194
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
0330 C**                                                                  S01194
0331 C                     ENDSR                                          S01194
0332 C**                                                                  S01194
0333 C**                                                                  S01194
0169 C********************************************************************S01194
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C**                                                                  S01194
     C********************************************************************
0082 O*XDAEA**D**      02N40                                              S01194
     OEXDAEA  D        20N40NU8                                           S01194
0083 O                                    1 'D'                           GL0705
0084 O***********              ACOD       5                               S01194
0085 O***********              ACKN      30                               S01194
     O**********               A5ACCD     5                                            S01194 CGL029
     O                         A5ACCN    30                               S01194
0086 O                 41                31 '1'                           GL0705
0087 O                 42                31 '2'                           GL0705
0088 O                 43                31 '3'                           GL0705
0089 O                 44                31 '4'                           GL0705
0090 O                 45                31 '5'                           GL0705
0091 O**********               TACD      35                                            GL0705 CGL029
0092 O                         TANM      60                               GL0705
0092 O                         A5ACCD    74                                                   CGL029
0091 O                         TACD      84                                                   CGL029
     O*                                                                                      BUG3826
     O                         A5ACCD    11                                                  BUG3826
     O                         A5ACCN    36                                                  BUG3826
0086 O                 41                38 '01'                                             BUG3826
0087 O                 42                38 '02'                                             BUG3826
0088 O                 43                38 '03'                                             BUG3826
0089 O                 44                38 '04'                                             BUG3826
0090 O                 45                38 '05'                                             BUG3826
0091 O                         TACD      48                                                  BUG3826
0092 O                         TANM      73                                                  BUG3826
0097 O*L0705P1T**203   LR                                           S01124S01117
0097 OGL0705AUT  203   LR                                                 S01117
0098 O***********                        22 'REFERENCE GL0705'            S01117
0098 O                                   22 'REFERENCE GL0705AU'          S01117
0099 O***********              TITL      89                               S01194
     O                         BJURPT    89                               S01194
0100 O                                  104 'DATE'                        GL0705
0101 O                         RUNA     113
0102 O                                  122 'PAGE'                        GL0705
0103 O                         PAGE  Z  126                               GL0705
0104 O        T  1     LR                                                 GL0705
0105 O                                   60 'GENERAL LEDGER EXTRACT'      GL0705
0106 O***********                        85 'DATA FILE CONTROL REPORT'    S01117
     O                                   75 'RUN CONTROLS'                S01117
0107 O        T  3     LR                                                 GL0705
0108 O                                   60 '----------------------'      S01117
0108 O***********                        61 '-----------------------'     S01117
0109 O***********                        85 '------------------------'    S01117
0110 O        T  2     LRNU7NU8                                           GL0705
0111 O                                   31 'NUMBER OF ACCOUNT CODE'      GL0705
0112 O                                   44 'RECORDS READ'                GL0705
0113 O                         TOTRD 1   53                               GL0705
0114 O        T  3     LRNU7NU8                                           GL0705
0115 O                                   31 'NUMBER OF EXTRACT DATA'      GL0705
0116 O                                   47 'RECORDS WRITTEN'             GL0705
0117 O                         NORE  1   53                               GL0705
0677 O        T 3      LR U7 U8                                           S01194
0376 O                                   42 '*** REFERENCE'               S01194
0377 O                         DBPGM     53                               S01194
0378 O                                   71 '-DATABASE ERROR AT'          S01194
0379 O                         DBASE     75                               S01194
0682 O        T 1      LR U7 U8                                           S01194
0381 O                                   37 'FILE NAME'                   S01194
0382 O                         DBFILE    48                               S01194
0383 O                                   52 'KEY'                         S01194
0384 O                         DBKEY     82                               S01194
0118 O********T**1     LR                                                 S01117
0119 O***********                        70 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
