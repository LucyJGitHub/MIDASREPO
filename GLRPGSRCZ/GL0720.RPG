0010 H        1                                                           S01194
      *****************************************************************
     F/COPY WNCPYSRC,GLH00347
/*OVR *  OVRDBF UTRACCTD  TOFILE(UTRACCTDM)                           *                       HUT107
/*OVR *  OVRDBF UGL0720P  TOFILE(UGL0720PF)                           *                       HUT107
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Balances Report by Curr and Ind')             *
0010 H***********                                                         S01194
0002 F********************************************************************
0004 F*                                                                  *
0003 F*   Midas - General Ledger Module                                  *
0004 F*                                                                  *
0005 F*        GL0720 - GENERAL LEDGER BALANCE REPORT 1                  *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                         *
0010 F*                                                                  *
      *  Last Amend No. HUT107             Date 01Apr20               *
      *  Prev Amend No. MD054509           Date 15Oct19               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL127AO           Date 06Aug12               *
      *                 262907             Date 03Aug12               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 238461             Date 18Dec09               *
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 240139             Date 30May06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG3826            Date 27Jul04               *
      *                 BUG3633            Date 13Jul04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 191861             Date 15May01               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 23Feb99               *
      *                 113024             Date 10Mar97               *
0010 F*                       S01408           Date 01Nov96              *
0010 F*                       066997           Date 11Jun96              *
     F*                       S01408           DATE 17MAY94              *
     F*                       067360           DATE 22FEB94              *
     F*                       067532           DATE 14FEB94              *
     F*                       050005           DATE 28MAY93              *
     F*                       E42846           DATE 16JUL92              *
     F*                       LN0529           DATE 29OCT90              *
0010 F*                       S01290           DATE 10APR90              *
0010 F*                       S01117           DATE 08/03/89             *
0010 F*                       S01194           DATE 08/03/89             *
0010 F*                       E15058           DATE 10/10/88             *
0010 F*                       E10939           DATE 12/10/87             *
0010 F*                       E10014           DATE 29/01/87             *
0010 F*                                                                  *
0011 F********************************************************************
      *  HUT107 - Additional 3rd Party Trust Indicator                *
      *           (Upgrade HUT016 to FM2.1 SP22)                      *
      *           Use core hooks GL0720C001, GL0720C003, GL0720C006   *
      *           GL0720FFPG, GL0720IIPG, GL0720OOP7 and GLH00349 to  *
      *           GLH00365.                                           *
      *  MD054509 - Print string 'CR' beside total net balance for    *
      *             negative balance.                                 *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL127AO - COB Restructure - GL COB Optimisation Phase 1     *
      *  262907 - FOOB GLC0730 and GLC0750 due to truncated balance   *
      *         - Increase the length of the LDBL from 15,0 to 18,0 to*
      *           make sure that balance will not be truncated.       *
      *         - Reformat the printer file to accommodate the length *
      *           of the balance                                      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompiled)                                        *
      *  238461 - Incorrect account name is shown on the report.      *
      *           If switchable feature CRE015 is 'ON', report should *
      *           get account name from A5ACCN in file SDACODPD.      *
      *  CSC042 - COB Performance fix.                                   *
      *           Store Branch details rather than call the AOBRCHR*     *
      *           pgm more than 500K times - RZB Sofia                   *
      *           Same for AOCOMPR*
      *  240139  - Applied fix 237955.                                 *
      *  237955  - Reverse fix BUG3633 and consolidate account code    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG3826 - General Ledger bals report produces 5,000 spool files *
      *  BUG3633 - Reverse fix 191861 and consolidate account code    *
      *            per branch.                                        *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  191861 - Overflow error occurs because several totals may be *
      *           written on the same page for four kinds of level    *
      *           break (account code, title code, section and        *
      *           currency). Thus, the overflow indicator used in the *
      *           printer file specification is ignored. Introduced a *
      *           dummy overflow indicator to be switched on when a   *
      *           maximum line number is reached or when there is     *
      *           section or currency level break.                    *
      *     CSD005 - Switchable feature- if account narrative feature *
      *              is active the current account description shall  *
      *              be replaced with the account narrative.          *
     F*     113024 - COB COMPONENT FCC0301 FAILED DUE TO COMPANY CODE    *
     F*              NOT EXIST.                                          *
     F*     S01408 - Addition of Core Hook GL0720OP14                    *
     F*              Addition of Core Hook GL0720OP13                    *
     F*              Addition of Core Hook GL0720OP12                    *
     F*              Addition of Core Hook GL0720OP11                    *
     F*              Addition of Core Hook GL0720OP10                    *
     F*              Addition of Core Hook GL0720OOP9                    *
     F*              Addition of Core Hook GL0720OOP8                    *
     F*              Addition of Core Hook GL0720OOP7                    *
     F*              Addition of Core Hook GL0720OOP6                    *
     F*              Addition of Core Hook GL0720OOP5                    *
     F*              Addition of Core Hook GL0720OOP4                    *
     F*              Addition of Core Hook GL0720OOP3                    *
     F*     066997 - "BRANCH XXX" positioning should be consistent       *
     F*              with "COMPANY XXX" in order to ease STORFICHE       *
     F*              patterning. Change also done to GL0740.             *
     F*     S01408 - Core hook GL0720OOP1 added                          *
     F*              Core hook GL0720OOP2 added                          *
     F*              Core hook GL0720FFPG added                          *
     F*              Core hook GL0720CPLH added                          *
     F*              Core hook GL0720CCPG added                          *
     F*              Core hook GL0720IIPG added                          *
     F*     067360 - Output correct Branch No for each individual spool  *
     F*              file, instead of 'ALL',  to ensure that all spool   *
     F*              files for a multibranched report are distributed by *
     F*              RCF, not just the spool file for the last entity.   *
     F*     067532 - Set up Overflow Line correctly in the Print File    *
     F*              definition instead of amending it in the RPG code   *
     F*              as this means that the page length is hard-coded.   *
     F*     050005 - 'UNKNOWN COMPANY' being printed                     *
     F*        E42846  -  ADD ADDITIONAL INFO FOR RUN TYPE               *
     F*        LN0529  -  PROGRAM DID NOT PRODUCE ANY DETAILS WHEN       *
     F*                   ALL COMPANIES REQUESTED.                       *
     F*                   EXTRANEOUS BITS IN THE AUDIT PRINT.            *
     F*                                                                  *
     F*        S01290  - MIS GL REPORTING CHANGES                        *
     F*                                                                  *
     F*        S01117  - MULTIBRANCHING                                  *
     F*                                                                  *
     F*        S01194  -  NEW STANDING DATA                              *
     F*                                                                  *
     F*        E15058  -  LINES CAN BE PRINTED TOO NEAR END OF PAGE.     *
     F*                                                                  *
     F*        E10939  -  REPORT DOES NOT PRINT COMPANY NAME             *
     F*                                                                  *
0010 F*        E10014  -  PRINT 'NO DETAIL RECS' MESSAGE WHEN NO VALID   *
0010 F*                   RECORDS FOUND                                  *
0010 F*                                                                  *
0011 F********************************************************************
0014 FGLEXHH  IP  E                    DISK
0013 F*GLEX   IS  F     128 25AI     2 DISK                               S01117
0013 F***SGLEX** IS  F     128 24AI     2 DISK                                         S01117 CGL029
0013 F***SGLEX** IS  F     141 24AI     2 DISK                                         CGL029 262907
0013 FSGLEX   IS  F     143 24AI     2 DISK                                                   262907
0013 FGLEXZY  IS  E                    DISK
0014 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
     FSDCURRL0IF  E           K        DISK                               S01194
     F*                                                                   S01408
     F** Core hook for externalisation.                                   S01408
     F/COPY WNCPYSRC,GL0720FFPG                                           S01408
     F*                                                                   S01408
0015 FGL0720P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  067532
0015 FGL0720AUO   F     132     OA     PRINTER      KINFDS SPOOLU         067532
0015 F*L0720P1O** F     132     OF    LPRINTER                            S01117
0015 F*L0720P1O***F     132     OF    LPRINTER      KINFDS SPOOL UC S01117067532
0015 F*L0720AUO** F     132           LPRINTER                            S01117
0015 F*L0720AUO***F     132     OA    LPRINTER      KINFDS SPOOLU   S01117067532
0016 F*
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            DETAIL RECORDS - GLEX FILE
0019 F**02*******     INSTALLATION CONTROL RECORD                         S01194
0020 F**03*******     COMPANY CODES                                       S01194
0021 F* 04            GLEX FILE HEADER
0022 F* 05            GLEX FILE TRAILER
0021 F**07*******     TABLE FILE RECORD                                   S01194
0022 F**08*******     CATCHALL ON TABLE FILE                              S01194
0023 F*    09         BALANCE ZERO
0024 F*    10         DEBIT BALANCE
0025 F*    11         CREDIT BALANCE
0026 F*       12      CREDIT RETAIL BALANCE
0027 F*       13      CREDIT ACCOUNT CODES BALANCE
0028 F*       14      CREDIT TITLE CODE BALANCE
0029 F*       15      CREDIT ACCOUNT SECTION BALANCE
0030 F*       16      CREDIT CURRENCY BALANCE
0031 F*       20      CONTROL BREAK ON BRANCH OR COMPANY
0031 F*       21      AT LEAST 1 DETAIL RECORD READ
0031 F*               FOR THE REQUESTED BRANCH(ES)/COMPANY                S01117
0031 F*       22      TRAILER RECORD READ WITH NO DETAIL RECS
0032 F*       30      CURRENCY HAS 0 DECIMAL PLACES
0033 F*       31      CURRENCY HAS 1 DECIMAL PLACE
0034 F*       32      CURRENCY HAS 2 DECIMAL PLACES
0035 F*       33      CURRENCY HAS 3 DECIMAL PLACES
0036 F***********39   COMPANY CODE NOT ON TABLE FILE                      S01194
0036 F*          39   ACCESS TO COMPANY CODES FILE FAIL                   S01194
0037 F********40*     CHAIN FAIL TO TABLES FILE                           S01194
0037 F*       40      ACCESS TO BANK DETAILS FAIL OR CURRENCY NOT FOUND   S01194
0038 F*       41      RETAIL ACCOUNT
0039 F*       42      ACCOUNT SECTION TYPE ASSETS
0040 F*       43                           LIABILITY
0041 F*       44                           INCOME
0042 F*       45                           EXPENSE
0043 F*       46                           CONTINGENT
      *       47      Cache hit for Account Code array                                      CGL127AO
     F*       48      ALL BRANCHES ARE REQUESTED FOR REPORTING            S01117
     F*       49      MULTIBRANCH INDICATOR = 'Y'                         S01117
0044 F*       55      NBR OF RECORDS OUT OF BALANCE
0045 F*       56      DEBIT HASH TOTAL NOT EQUAL TO VALUE ON TRAILER
0046 F*       57      CREDIT HASH TOTAL NOT EQUAL TO VALUE ON TRAILER
     F*       60      RUN TYPE AFTER FINAL POST                           E42846
     F*       61      RUN TYPE AFTER DAILY POST                           E42846
     F*       62      RUN TYPE AFTER SPOT REVALS                          E42846
     F*       63      RUN TYPE AFTER B/CCY TFR                            E42846
     F*       64      RUN TYPE AFTER F/CCY TFR                            E42846
     F*       75      PRINT FILE GL0720P1 OPEN                            S01117
     F*       77      OPEN PRINTER FILE ERROR ON CONSOLIDATED REPORT      S01117
0047 F*       90-99   USED IN Z-SUBROUTINE
0048 F*            L1 ACCOUNT CODES
0049 F*            L2 TITLE CODE
0050 F*            L3 ACCOUNT SECTION
0051 F*            L4 CURRENCY CHANGE
0052 F*            U1 LISTING BY COMPANY ORDER
0053 F*            U2 LISTING BY BRANCH ORDER
0054 F*            U8 CONTROL TOTALS OUT OF BALANCE
0054 F*         U7 U8 DATABASE ERROR                                      S01194
     F/EJECT                                                              S01117
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,GLH00365
0055 E                    CCYA      150  3               CCYARR SR
0056 E                    DPA       150  1 0             CCYARR SR
     E                    ##BR      999  3               Branch Codes                         CSC042
     E                    ##BN      999 30               Branch Name                          CSC042
     E                    ##PC      999  3               Company Codes                        CSC042
     E                    ##PN      999 30               Company Names                        CSC042
      *                                                                                     CGL127AO
      ** Account Code (Key for Cache)                                                       CGL127AO
      *                                                                                     CGL127AO
     E                    CDAC      300 10                                                  CGL127AO
      *                                                                                     CGL127AO
      ** Least recently used array and sorted LRU array                                     CGL127AO
      *                                                                                     CGL127AO
     E                    LRUA      300 13 0                                                CGL127AO
     E                    LRUS      300 13 0                                                CGL127AO
     E/EJECT                                                                                CGL127AO
     E/COPY WNCPYSRC,GLH00348
0057 L**GL0720P1 66FL 55OL                                          S01124E15058
     L*GL0720P1*66FL*52OL*                                          E15058067532
0057 L*GL0720AU*66FL*55OL*                                          S01117067532
0058 ISGLEX   NS  01
     I                                        1   1 RECI
0064 I**************                          2   4 DUMMY                 E10939
     I***********                             2   2 DUMMY1         E10939 S01117
     I***********                             3   4 COMCOD         E10939 S01117
0060 I                                        5   7 CCYCODL4
0069 I                                        8   80ACCSECL3
0070 I**********                              9  120TITCODL2                                  CGL029
0061 I**********                             13  160ACCCODL1                                  CGL029
0063 I**********                             17  170RETIND                                    CGL029
0059 I**********                             18  230CUSTNO                                    CGL029
0062 I**********                             24  250ACCSEQ                                    CGL029
0064 I***********                            26  280BRCHNO                S01117
0064 I**********                             26  28 BRCHNO                             S01117 CGL029
0065 I**************                         29  30 COMCOD                E10939
     I**********                             29  30 DUMMY2                             E10939 CGL029
0066 I*****                                  31  50 NAME                  S01117
0067 I*****                                  51  60 TOWN                  S01117
0068 I*****                                  61  85 ACCNAM                S01117
0071 I*****                                  86 110 TITNAM                S01117
0072 I*****                               P 111 1180BALANC      101109    S01117
0071 I*****                                 119 127 ZZ0009                S01117
0065 I**********                             29  31 COMCOD                             S01117 CGL029
0066 I**********                             32  51 NAME                               S01117 CGL029
0067 I**********                             52  61 TOWN                               S01117 CGL029
0068 I**********                             62  86 ACCNAM                             S01117 CGL029
0071 I**********                             87 111 TITNAM                             S01117 CGL029
0072 I**********                          P 112 1190BALANC      101109                 S01117 CGL029
0071 I**********                            120 128 ZZ0009                             S01117 CGL029
0071 I**********                            128 128 DCIN                                      CGL029
0070 I                                        9  180TITCODL2                                  CGL029
0061 I                                       19  280ACCCODL1                                  CGL029
0063 I                                       29  290RETIND                                    CGL029
0059 I**********                             30  350CUSTNO                             CGL029 CSD027
0059 I                                       30  35 CUSTNO                                    CSD027
0062 I                                       36  370ACCSEQ                                    CGL029
0064 I                                       38  40 BRCHNO                                    CGL029
0065 I                                       41  43 COMCOD                                    CGL029
0066 I                                       44  63 NAME                                      CGL029
0067 I                                       64  73 TOWN                                      CGL029
0068 I                                       74  98 ACCNAM                                    CGL029
0071 I                                       99 123 TITNAM                                    CGL029
0072 I**********                          P 124 1310BALANC      101109                 CGL029 262907
0071 I**********                            132 140 ZZ0009                             CGL029 262907
0071 I**********                            141 141 DCIN                               CGL029 262907
     I                                    P 124 1330BALANC      101109                        262907
     I                                      134 142 ZZ0009                                    262907
     I                                      143 143 DCIN                                      262907
0073 I*
0074 I*    LOOK AHEAD FIELDS
0075 I        NS  **
0076 I                                        1   1 LRECI
0077 I***********                            26  280LBRNO                 S01117
0077 I***********                            26  28 LBRNO                             S01117 BUG3826
0078 I***************                        29  30 LCMCD                 E10939
     I***********                             3   4 LCMCD          E10939 S01117
0078 I*************                          29  31 LCMCD                             S01117 BUG3826
     I                                       38  40 LBRNO                                    BUG3826
     I                                       41  43 LCMCD                                    BUG3826
0079 I**
0080 I**   HEADER
0081 IGLEXHHF     04
0083 I**
0084 I**   TRAILER
0085 IGLEXZYF     05
0094 I*
0095 I*ABLE***NS* 02   1 CD   2 C0   3 C1                                 S01194
0096 I*******AND*     12 C1  13 C0                                        S01194
0097 I***********                            14  66 TITL                  S01194
0098 I***********                            67  67 DATF                  S01194
0099 I***********                         P  77  790RUND                  S01194
0100 I***********                            80  86 RUNA                  S01194
0101 I********NS* 03   1 CD   2 C1   3 C1                                 S01194
0102 I***********                            14  43 CMNM                  S01194
0103 I********NS* 07   2 C2   3 C0                                        S01194
0104 I***********                             1   1 RECIX                 S01194
0105 I***********                             2   30RECTX                 S01194
0106 I***********                            10  12 CCYX                  S01194
0107 I***********                            13  130SRECX                 S01194
0108 I***********                            38  380CDPX                  S01194
0109 I*****CATCH*ALL                                                      S01194
0110 I********NS* 08                                                      S01194
0111 I***********                             1   1 RECIX                 S01194
0112 I***********                             2   30RECTX                 S01194
0113 I***********                            13  130SRECX                 S01194
0114 I*
     I*                                                                   S01408
     I** Core hook for externalisation.                                   S01408
     I/COPY WNCPYSRC,GL0720IIPG                                           S01408
     I*                                                                   S01408
     ISPOOL       DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  90 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  90 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01194
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     ILDA        UDS                            256                       S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I** DATA AREA RUNDAT                                                 S01194
     IRUNDT       DS                                                      S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
0115 I*
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I**   BRANCH DETAILS                                                 S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I**   BANK DETAILS                                                   S01194
     I*                                                                   S01194
     ISDCOMP    E DSSDCOMPPD                                              S01194
     I**   COMPANY CODES                                                  S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                                     CGL029
     I* FIRST DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                                     CGL029
     I*                                                                                       CGL029
     I/EJECT                                                              S01117
     I*                                                                   CSD005
     ISCSARD    E DSSCSARDPD                                              CSD005
     I** MIDAS Switchable Features Accessed Via Access Program            CSD005
      *                                                                   CSD005
      *                                                                   CSD005
     I***SDACOD*   E DSSDACODPD                                                      CSD005 CGL127AO
     ISDACOD    E DSSDACODPD                300                                             CGL127AO
      **  Account code details                                            CSD005
      *                                                                   CSD005
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           RUNTYP  1                       E42846
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C/COPY WNCPYSRC,GL0720C008
     C**                                                                  E42846
     C** WRITE THE TYPE OF RUN ON THE HEADING                             E42846
     C**                                                                  E42846
     C           RUNTYP    IFEQ '1'                                       E42846
     C                     SETON                     60                   E42846
     C                     ELSE                                           E42846
     C           RUNTYP    IFEQ '2'                                       E42846
     C                     SETON                     61                   E42846
     C                     ELSE                                           E42846
     C           RUNTYP    IFEQ '3'                                       E42846
     C                     SETON                     62                   E42846
     C                     ELSE                                           E42846
     C           RUNTYP    IFEQ '4'                                       E42846
     C                     SETON                     63                   E42846
     C                     ELSE                                           E42846
     C                     SETON                     64                   E42846
     C/COPY WNCPYSRC,GL0720C009
     C                     END                                            E42846
     C                     END                                            E42846
     C                     END                                            E42846
     C                     END                                            E42846
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,GL0720CCPG                                           S01408
     C*                                                                   S01408
     C**                                                                  E42846
0116 C*    BYPASS FIRST CYCLE CALS IF 50 ON
0117 C   50                GOTO NEXT1
     C                     MOVEACPY@      BIS@   80
0118 C   04                Z-ADD1         NRECS   50
     C***                                                                 S01117
     C*                                                                   S01117
     C*    SETON INDICATOR 20 FOR LEVEL BREAK ON FIRST RECORD READ ON     S01117
     C*    COMPANY AND BRANCH REPORTS                                     S01117
     C*                                                                   S01117
     C           *INU1     IFEQ '1'                                       S01117
     C           *INU2     OREQ '1'                                       S01117
     C                     MOVE '1'       *IN20                           S01117
     C                     END                                            S01117
     C***                                                                 S01117
0119 C*
0120 C*****SET*KEY TO CHAIN TO INSTALLATION CONTROL RECORD                S01194
0121 C***********          MOVEL'01'      TABKEY 12                       S01194
0122 C***********          MOVE '10'      TABKEY 12                       S01194
0123 C***********TABKEY    SETLLTABLE                                     S01194
0124 C***********          READ TABLE                    40               S01194
     C*                                                                   S01194
     C                     MOVEL'GL0720'  DBPGM  10                       S01194
     C*                                                                   S01194
     C** OBTAIN RUN DATE FROM RUNDAT                                      S01194
     C*                                                                   S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C                     IN   RUNDT                                     S01194
     C                     SETOF                     4948                 S01194
     C           MBIN      IFEQ 'Y'                                       S01194
     C                     SETON                     49                   S01194
     C           BRNCH     IFEQ 'ALL'                                     S01194
     C           *INU2     ANDEQ'1'                                       S01194
     C                     SETON                     48                   S01194
     C                     END                                            S01194
     C                     END                                            S01194
0085 C*                                                                   S01194
0086 C* ACCESS BANK DETAILS, DATABASE ERROR IF RETURN CODE NOT BLANK      S01194
0087 C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBANKPD'DBFILE             *************S01194
     C                     MOVEL'001'     DBASE              * DBERR 001 *S01194
     C                     MOVEL@OPTN     DBOPTN  7          *************S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     40                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO EOJ                                       S01194
     C                     ELSE                                           S01194
     C                     SETOF                     40                   S01194
     C                     END                                            S01194
0125 C*
0126 C*    GET DECIMAL PLACES AND BUILD ARRAY
0127 C                     EXSR CCYARR
0128 C*
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
     C                     Z-ADD0         ##PNDX  40                                          CSC042
     C           *LIKE     DEFN ##PNDX    P                                                   CSC042
     C           *LIKE     DEFN ##PNDX    ##PSV                                               CSC042
      *                                                                                       CSC042
      ** Obtain switchable feature CRE015 status before checking                              238461
      ** CSD005.                                                                              238461
      *                                                                                       238461
     C                     MOVE '0'       *IN73                                               238461
      *                                                                                       238461
     C                     CALL 'AOSARDR0'                                                    238461
     C                     PARM *BLANKS   @RTCD   7                                           238461
     C                     PARM '*VERIFY' @OPTN   7                                           238461
     C                     PARM 'CRE015'  @SARD   6                                           238461
     C           SCSARD    PARM SCSARD    DSFDY                                               238461
      *                                                                                       238461
     C                     SELEC                                                              238461
     C           @RTCD     WHEQ *BLANK                                                        238461
     C                     MOVE '1'       *IN74                                               238461
     C           @RTCD     WHEQ '*NRF'                                                        238461
     C                     MOVE '0'       *IN74                                               238461
     C                     OTHER                                                              238461
     C           *LOCK     IN   LDA                                                           238461
     C                     MOVEL'SCSARDPD'DBFILE                                              238461
     C                     MOVEL'008'     DBASE                                               238461
     C                     MOVEL@OPTN     DBKEY                                               238461
     C                     SETON                     U7U8LR                                   238461
     C                     OUT  LDA                                                           238461
     C                     EXSR *PSSR                                                         238461
     C                     ENDSL                                                              238461
      *                                                                   CSD005
      * Obtain switchable feature CSD005 status.                          CSD005
      *                                                                   CSD005
     C           *IN74     IFEQ '0'                                                           238461
     C                     CALL 'AOSARDR0'                                CSD005
     C                     PARM *BLANKS   @RTCD   7                       CSD005
     C                     PARM '*VERIFY' @OPTN   7                       CSD005
     C                     PARM 'CSD005'  @SARD   6                       CSD005
     C           SCSARD    PARM SCSARD    DSFDY                           CSD005
      *                                                                   CSD005
     C                     SELEC                                          CSD005
     C           @RTCD     WHEQ *BLANK                                    CSD005
     C                     MOVE *ON       *IN73                           CSD005
     C           @RTCD     WHEQ '*NRF'                                    CSD005
     C                     MOVE *OFF      *IN73                           CSD005
     C                     OTHER                                          CSD005
     C           *LOCK     IN   LDA                                       CSD005
     C                     MOVEL'SCSARDPD'DBFILE            ************* CSD005
     C                     MOVEL'005'     DBASE             *DBERROR 005* CSD005
     C                     MOVEL@OPTN     DBKEY             ************* CSD005
     C                     SETON                     U7U8LR               CSD005
     C                     OUT  LDA                                       CSD005
     C                     EXSR *PSSR                                     CSD005
     C                     ENDSL                                          CSD005
     C                     ENDIF                                                              238461
0129 C*
      ***Initialize line counter.                                                     191861 BUG3633
      **********                                                                      191861 BUG3633
     C**********           Z-ADD25        LNCTR   20                                  191861 BUG3633
      *                                                                                      BUG3633
      ** Initialize WBRCH working field.                                                     BUG3633
      *                                                                                      BUG3633
     C**********           MOVE *BLANKS   WBRCH                                       BUG3633 237955
      *                                                                                      BUG3633
     C                     EXSR SRINIT                                                      CGL127AO
     C*                                                                   191861
0130 C*    SETON 50 TO BYPASS FIRST CYCLE CALS.
0131 C                     SETON                     50
0132 C**COMPANY*ORDER                                                     S01194
0133 C***U1******          MOVEL'11'      TABKEY                          S01194
0134 C                     GOTO EOJ
0135 C           NEXT1     TAG                             ** NEXT1 TAG **
     C***01N21***          SETON                     21                   S01117
     C   05N21             SETON                     22
0136 C   05                SETON                     LR
0137 C/SPACE 3
0138 C***05******                                                         S01117
0139 C*R*01******NRECS     ADD  1         NRECS                           S01117
     C           *IN05     IFEQ '1'                                       S01117
     C                     ADD  1         NRECS                           S01117
     C                     END                                            S01117
0140 C  N01                GOTO EOJ
0141 C*
0142 C*    IF NEW CURRENCY DETERMINE DECIMALS
0143 C  NL4                GOTO DECEND
0144 C                     MOVE CCYCOD    XCCY    3
0145 C                     EXSR CCYDEP
0146 C   99                SETON                     40LR
0147 C   99                GOTO EOJ
0148 C           XDECP     COMP 1                      3031
0149 C           XDECP     COMP 2                    33  32
0150 C           DECEND    TAG                             ** DECEND TAG *
0151 C*
     C/COPY WNCPYSRC,GL0720C001
0152 C*    SAVE BALANCE FOR OUTPUT
0153 C**********           Z-ADDBALANC    NEWBAL 150                                          262907
     C                     Z-ADDBALANC    NEWBAL 180   80                                     262907
0154 C*
0155 C*    CHECK ACCOUNT SECTION TYPE
0156 C   L3                SETOF                     4546
0157 C   L3      ACCSEC    COMP 2                    444243
0158 C   L3 44   ACCSEC    COMP 4                    464445
0159 C*
0160 C*****IF*U1*ON CHAIN TO TABLE FILE TO OBTAIN COMPANY NAME            S01194
0160 C*    IF U1 ON, OBTAIN COMPANY NAME VIA COMPANY CODE                 S01194
0161 C  NU1                GOTO CMNEND
0162 C                     SETOF                     3940
0163 C***********          MOVE COMCOD    TABKEY                          S01194
0164 C***********TABKEY    SETLLTABLE                                     E10939
0165 C***********          READ TABLE                    40               E10939
     C***********TABKEY    CHAINTABLE                39            E10939 S01194
0166 C**N03******          SETON                     39                   S01194
     C*                                                                   S01194
     C                     MOVELCOMCOD    ##KP                                                CSC042
     C                     EXSR ##CHKP                                                        CSC042
      * If company is in the array then use the details                                       CSC042
     C           *IN86     IFEQ *ON                        *** B10                            CSC042
     C                     EXSR ##SETP                                                        CSC042
     C                     ELSE                                                               CSC042
     C                     CALL 'AOCOMPR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM COMCOD    @CENB   3                       S01194
     C           SDCOMP    PARM SDCOMP    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     39                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     39                   S01194
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDP                                                        CSC042
     C                     END                                            S01194
     C                     END                                                                CSC042
0167 C*
0168 C           CMNEND    TAG                             ** CMNEND TAG *
0169 C*
0170 C   20                SETON                     L1L2L3
0171 C   20                SETON                     L4
      *                                                                   CSD005
      * Find the account narrative for the account code and the           CSD005
      *  account narrative for the account title if the feature           CSD005
      *  CSD005 is active.                                                CSD005
      *  The account code field is 'ACCCOD' and the account title         CSD005
      *  account code is 'TITCOD'                                         CSD005
      *                                                                   CSD005
     C           *IN73     IFEQ *ON                                       CSD005
      *                                                                   CSD005
     C********** *LIKE     DEFN A5NARR    ACCNAR                                       CSD005 262907
     C********** *LIKE     DEFN A5NARR    TITNAR                                       CSD005 262907
      *                                                                   CSD005
     C           ACCNAM    IFNE *BLANKS                                   CSD005
     C                     MOVELACCCOD    @ACCD                           CSD005
      *                                                                                     CGL127AO
      ** Begin LRU cache processing for Account Code                                        CGL127AO
      *                                                                                     CGL127AO
     C                     ADD  1         RCSQ                                              CGL127AO
     C                     MOVELACCCOD    KEYACD                                            CGL127AO
     C                     EXSR CHKACD                                                      CGL127AO
      *                                                                                     CGL127AO
      ** Use details from array if ACOD is found, otherwise,                                CGL127AO
      ** retrieve details from program call                                                 CGL127AO
      *                                                                                     CGL127AO
     C           ACFIC     IFEQ 'Y'                                                         CGL127AO
      *                                                                                     CGL127AO
      ** Set occurence to index found from CDAC array                                       CGL127AO
      *                                                                                     CGL127AO
     C           C         OCUR SDACOD                                                      CGL127AO
     C                     MOVELA5NARR    ACCNAR                                            CGL127AO
     C                     ELSE                                                             CGL127AO
      *                                                                                     CGL127AO
     C           TIDX      IFNE 0                                                           CGL127AO
     C                     Z-ADDTIDX      C                                                 CGL127AO
     C                     ELSE                                                             CGL127AO
     C                     Z-ADD1         C                                                 CGL127AO
     C                     MOVEALRUA      LRUS                                              CGL127AO
     C                     SORTALRUS                                                        CGL127AO
     C                     Z-ADDLRUS,1    LEASTE                                            CGL127AO
     C           LEASTE    LOKUPLRUA,C                   47                                 CGL127AO
     C                     ENDIF                                                            CGL127AO
      *                                                                                     CGL127AO
     C                     CALL 'AOACODR0'                                CSD005
     C                     PARM '*BLANK ' @RTCD   7                       CSD005
     C                     PARM '*KEY   ' @OPTN   7                       CSD005
     C**********           PARM           @ACCD   4                                    CSD005 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        CSD005 CGL029
     C                     PARM           @ACCD  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                   CSD005
     C                     SELEC                                          CSD005
      *                                                                   CSD005
     C           @RTCD     WHEQ *BLANKS                                   CSD005
     C**********           MOVE A5NARR    ACCNAR                                       CSD005 262907
     C                     MOVELA5NARR    ACCNAR 40                                           262907
     C                     EXSR ADDACD                                                      CGL127AO
      *                                                                   CSD005
     C                     OTHER                                          CSD005
     C           *LOCK     IN   LDA                                       CSD005
     C                     MOVEL'SDACODPD'DBFILE            ************* CSD005
     C                     MOVEL'006'     DBASE             *DBERROR 006* CSD005
     C                     MOVEL@OPTN     DBKEY             ************* CSD005
     C                     SETON                     U7U8LR               CSD005
     C                     OUT  LDA                                       CSD005
     C                     EXSR *PSSR                                     CSD005
     C                     ENDSL                                          CSD005
     C                     ENDIF                                                            CGL127AO
     C                     ENDIF                                          CSD005
      *                                                                   CSD005
     C           TITNAM    IFNE *BLANKS                                   CSD005
     C                     MOVELTITCOD    @ACCD                           CSD005
      *                                                                                     CGL127AO
      ** Begin LRU cache processing for Account Code                                        CGL127AO
      *                                                                                     CGL127AO
     C                     ADD  1         RCSQ                                              CGL127AO
     C                     MOVELTITCOD    KEYACD                                            CGL127AO
     C                     EXSR CHKACD                                                      CGL127AO
      *                                                                                     CGL127AO
      ** Use details from array if ACOD is found, otherwise,                                CGL127AO
      ** retrieve details from program call                                                 CGL127AO
      *                                                                                     CGL127AO
     C           ACFIC     IFEQ 'Y'                                                         CGL127AO
      *                                                                                     CGL127AO
      ** Set occurence to index found from CDAC array                                       CGL127AO
      *                                                                                     CGL127AO
     C           C         OCUR SDACOD                                                      CGL127AO
     C                     MOVELA5NARR    TITNAR                                            CGL127AO
     C                     ELSE                                                             CGL127AO
      *                                                                                     CGL127AO
     C           TIDX      IFNE 0                                                           CGL127AO
     C                     Z-ADDTIDX      C                                                 CGL127AO
     C                     ELSE                                                             CGL127AO
     C                     Z-ADD1         C                                                 CGL127AO
     C                     MOVEALRUA      LRUS                                              CGL127AO
     C                     SORTALRUS                                                        CGL127AO
     C                     Z-ADDLRUS,1    LEASTE                                            CGL127AO
     C           LEASTE    LOKUPLRUA,C                   47                                 CGL127AO
     C                     ENDIF                                                            CGL127AO
      *                                                                                     CGL127AO
     C                     CALL 'AOACODR0'                                CSD005
     C                     PARM '*BLANK ' @RTCD   7                       CSD005
     C                     PARM '*KEY   ' @OPTN   7                       CSD005
     C**********           PARM           @ACCD   4                                    CSD005 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        CSD005 CGL029
     C                     PARM           @ACCD                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                   CSD005
     C                     SELEC                                          CSD005
      *                                                                   CSD005
     C           @RTCD     WHEQ *BLANKS                                   CSD005
     C**********           MOVE A5NARR    TITNAR                                      CSD005 262907
     C                     MOVELA5NARR    TITNAR 40                                           262907
     C                     EXSR ADDACD                                                      CGL127AO
      *                                                                   CSD005
     C                     OTHER                                          CSD005
     C           *LOCK     IN   LDA                                       CSD005
     C                     MOVEL'SDACODPD'DBFILE            ************* CSD005
     C                     MOVEL'007'     DBASE             *DBERROR 007* CSD005
     C                     MOVEL@OPTN     DBKEY             ************* CSD005
     C                     SETON                     U7U8LR               CSD005
     C                     OUT  LDA                                       CSD005
     C                     EXSR *PSSR                                     CSD005
     C                     ENDSL                                          CSD005
     C                     ENDIF                                                            CGL127AO
     C                     ENDIF                                          CSD005
      *                                                                   CSD005
     C                     ENDIF                                          CSD005
      *                                                                   CSD005
     C*                                                                   S01117
     C* IF U1 AND U2 ARE OFF OPEN PRINTER FILE FOR CONSOLIDATED REPORT    S01117
     C*                                                                   S01117
     C           *IN75     IFEQ '0'                                       S01117
     C           *INU1     ANDEQ'0'                                       S01117
     C           *INU2     ANDEQ'0'                                       S01117
     C                     OPEN GL0720P1               77                 S01117
      *                                                                   S01117
      **  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01117
     C           *LOCK     IN   LDA                                       CSD005
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     SETON                     75                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CHECK TO SEE IF U1 OR U2 ARE ON BEFORE DOING CLOSE & OPEN FOR     S01117
     C* COMPANY AND BRANCH REPORTS                                        S01117
     C*                                                                   S01117
     C*                                                                   S01117
     C           *INU1     IFEQ '1'                                       S01117
     C           *INU2     OREQ '1'                                       S01117
     C**                                                                  S01117
     C           *IN20     IFEQ '1'                                       S01117
     C                     CLOSEGL0720P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           *INU2     ANDEQ'1'                                       S01117
     C           BRNCH     OREQ 'ALL'                                     LN0529
     C           *INU1     ANDEQ'1'                                       LN0529
     C           BRNCH     OREQ BRCHNO                                    S01117
     C           *INU2     ANDEQ'1'                                       S01117
     C           BRNCH     OREQ COMCOD                                    S01117
     C           *INU1     ANDEQ'1'                                       S01117
     C                     SETON                     75                   S01117
     C           *INU2     IFEQ '1'                        IF             S01117
     C           *IN49     ANDEQ'1'                                       S01117
     C*                                                                   S01194
     C** OBTAIN BRANCH NAME VIA BRANCH DETAILS                            S01194
     C                     MOVELBRCHNO    ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRCHNO    @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBRCHPD'DBFILE             *************S01194
     C                     MOVEL'002'     DBASE              * DBERR 002 *S01194
     C                     MOVEL@OPTN     DBOPTN  7          *************S01194
     C                     MOVELBRCHNO    DBKEY  29                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     LRU7U8               S01194
     C                     SETOF                     75                   S01194
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01194
     C                     END                             *** E10                            CSC042
     C*                                                                   S01194
     C   U8                GOTO END                                       S01117
     C                     END                             FI             S01117
     C                     OPEN GL0720P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
      *                                                                   S01117
     C************IN48     IFEQ '1'                                 S01117067360
     C************         MOVE BRCHNO    SENTY   3                 S01117113024
     C   U1                MOVE COMCOD    SENTY   3                       113024
     C  NU1                MOVE BRCHNO    SENTY   3                       113024
     C************         ELSE                                     S01117067360
     C************         MOVE BRNCH     SENTY                     S01117067360
     C************         END                                      S01117067360
      *                                                                   S01117
      **  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01117
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
     C                     SETOF                     75                   S01117
     C                     SETON                     LR                   S01117
     C                     GOTO EOJ                                       S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     ADD  1         NRECS                           S01117
     C           *IN21     IFEQ '0'                                       S01117
     C                     SETON                     21                   S01117
     C                     END                                            S01117
0172 C*
0173 C*    DETERMINE LEVEL BREAK ON BRANCH OR COMPANY UNLESS TRAILER
0174 C   U1
0175 COR U2      LRECI     COMP '9'                  2020
0176 C   U1 20   COMCOD    COMP LCMCD                2020
0177 C   U2 20   BRCHNO    COMP LBRNO                2020
      *                                                                                      BUG3633
      * * RESET LEVEL BREAK WHEN NO CHANGE IN BRANCH                                         BUG3633
      *                                                                                      BUG3633
     C********** *INU2     IFEQ '1'                                                   BUG3633 237955
     C********** BRCHNO    ANDEQWBRCH                                                 BUG3633 237955
     C**********           MOVE '0'       *IN20                                       BUG3633 237955
     C**********           END                                                        BUG3633 237955
      *                                                                                      BUG3633
     C**********           MOVE BRCHNO    WBRCH   3                                   BUG3633 237955
      *
0178 C*
     C/COPY WNCPYSRC,GL0720C002
0179 C*    ACCUMULATE RETAIL BALANCES
0180 C           RETIND    COMP 1                        41
0181 C  N41                GOTO RETEND
     C/COPY WNCPYSRC,GLH00349
0182 C***11***** RETBCR    ADD  BALANC    RETBCR 150                                          262907
0183 C***10***** RETBDR    ADD  BALANC    RETBDR 150                                          262907
     C   11      RETBCR    ADD  BALANC    RETBCR 180                                          262907
     C   10      RETBDR    ADD  BALANC    RETBDR 180                                          262907
     C/COPY WNCPYSRC,GLH00350
0184 C           RETEND    TAG                             ** RETEND TAG *
     C/COPY WNCPYSRC,GL0720C003
0185 C*
0186 C*    ACCUMULATE ACCOUNT CODE BALANCES
0187 C***11***** ACCBCR    ADD  BALANC    ACCBCR 150                                          262907
0188 C***10***** ACCBDR    ADD  BALANC    ACCBDR 150                                          262907
     C   11      ACCBCR    ADD  BALANC    ACCBCR 180                                          262907
     C   10      ACCBDR    ADD  BALANC    ACCBDR 180                                          262907
     C/COPY WNCPYSRC,GLH00351
0189 C**
0190 C**   ACCUMULATE DEBIT & CREDIT HASH TOTALS
0191 C   09                GOTO EOJ
0192 C   10                Z-ADDDHASHI    ZZTOTI
0193 C   10                Z-ADDDHASHD    ZZTOTD
0194 C   11                Z-ADDCHASHI    ZZTOTI
0195 C   11                Z-ADDCHASHD    ZZTOTD
0196 C           BALANC    DIV  1000      ZZAMT
0197 C   11                Z-SUBZZAMT     ZZAMT
0198 C                     EXSR GLZADD
0199 C   10                Z-ADDZZTOTI    DHASHI 150
0200 C   10                Z-ADDZZTOTD    DHASHD  30
0201 C   11                Z-ADDZZTOTI    CHASHI 150
0202 C   11                Z-ADDZZTOTD    CHASHD  30
      **********                                                                      191861 BUG3633
      ***Update*line counter.                                                         191861 BUG3633
      ***If**INL1 = ON (Account code changed).                                        191861 BUG3633
      ***If**INL2 = ON (Title code changed).                                          191861 BUG3633
      **********                                                                      191861 BUG3633
     C********** *INL2     IFEQ '1'                                                   191861 BUG3633
     C**********           ADD  10        LNCTR                                       191861 BUG3633
     C**********           ENDIF                                                      191861 BUG3633
      **********                                                                      191861 BUG3633
     C********** *INL1     IFEQ '1'                                                   191861 BUG3633
     C**********           ADD  6         LNCTR                                       191861 BUG3633
     C**********           ENDIF                                                      191861 BUG3633
     C/COPY WNCPYSRC,GL0720C010
      **********                                                                      191861 BUG3633
      ***Increment by one if account is not Retail.                                   191861 BUG3633
      **********                                                                      191861 BUG3633
     C********** *IN41     IFEQ '0'                                                   191861 BUG3633
     C**********           ADD  1         LNCTR                                       191861 BUG3633
     C**********           ELSE                                                       191861 BUG3633
      **********                                                                      191861 BUG3633
      ***If*Retail account and Account Code has changed, increment by 2.              191861 BUG3633
      **********                                                                      191861 BUG3633
     C********** *INL1     IFEQ '1'                                                   191861 BUG3633
     C**********           ADD  2         LNCTR                                       191861 BUG3633
     C**********           ENDIF                                                      191861 BUG3633
     C**********           ENDIF                                                      191861 BUG3633
      **********                                                                      191861 BUG3633
     C/COPY WNCPYSRC,GL0720C011
      ***Reset*dummy overflow indicator.                                              191861 BUG3633
      **********                                                                      191861 BUG3633
     C**********           MOVE '0'       *IN65                                       191861 BUG3633
      **********                                                                      191861 BUG3633
      ***If*the next line is greater than 57 or Account Section changed               191861 BUG3633
      ***or*Currency changed, load next page then reset line counter                  191861 BUG3633
      ***to*avoid overflow in case a total line has to be written at                  191861 BUG3633
      ***the*bottom.                                                                  191861 BUG3633
      **********                                                                      191861 BUG3633
     C********** LNCTR     IFGT 57                                                    191861 BUG3633
     C********** *INL3     OREQ '1'                                                   191861 BUG3633
     C********** *INL4     OREQ '1'                                                   191861 BUG3633
     C**********           MOVE '1'       *IN65                                       191861 BUG3633
     C**********           Z-ADD16        LNCTR                                       191861 BUG3633
     C**********           ENDIF                                                      191861 BUG3633
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,GL0720CPLH                                           S01408
     C*                                                                   S01408
0203 C           EOJ       TAG                             ** EOJ TAG **
0204 C*
0205 C*    SKIP L0 CALCS IF NO CONTROL BREAK ON BRANCH OR COMPANY
0206 CL0N20                GOTO NEXT2
0207 C*
     C/COPY WNCPYSRC,GL0720C004
0208 C*    NET RETAIL BALANCE
0209 C***L0*****    RETBCR    ADD  RETBDR    RETBAL                                           262907
     CL0         RETBCR    ADD  RETBDR    RETBAL       81                                     262907
     C/COPY WNCPYSRC,GL0720C005
0210 C*
0211 C*    NET ACCOUNT CODE BALANCE
0212 C***L0*****    ACCBCR    ADD  ACCBDR    ACCBAL                                           262907
     CL0         ACCBCR    ADD  ACCBDR    ACCBAL       82                                     262907
0213 C*
0214 C*    ACCUMULATE TITLE CODE BALANCES
0215 CL0         TITBCR    ADD  ACCBCR    TITBCR
0216 CL0         TITBDR    ADD  ACCBDR    TITBDR
0217 C*
0218 C*    NET TITLE CODE BALANCE
0219 C***L0*****    TITBDR    ADD  TITBCR    TITBAL                                           262907
     CL0         TITBDR    ADD  TITBCR    TITBAL       83                                     262907
0220 C*
0221 C*    ACCUMULATE ACCOUNT SECTION BALANCE
0222 CL0         SECBDR    ADD  TITBDR    SECBDR
0223 CL0         SECBCR    ADD  TITBCR    SECBCR
0224 C*
0225 C*    NET ACCOUNT SECTION BALANCE
0226 C***L0*****    SECBDR    ADD  SECBCR    SECBAL                                           262907
     CL0         SECBDR    ADD  SECBCR    SECBAL       84                                     262907
0227 C*
0228 C*    ACCUMULATE REPORT BALANCES
0229 CL0         CCYBDR    ADD  SECBDR    CCYBDR
0230 CL0         CCYBCR    ADD  SECBCR    CCYBCR
0231 C*
0232 C*    NET CURRENCY BALANCE
0233 C***L0*****    CCYBCR    ADD  CCYBDR    CCYBAL                                           262907
     CL0         CCYBCR    ADD  CCYBDR    CCYBAL       85                                     262907
0234 CL0 20                GOTO END
0235 CL0         NEXT2     TAG                             ** NEXT2 TAG **
0236 C*
     C/COPY WNCPYSRC,GL0720C006
0237 C*    NET RETAIL BALANCE
0238 C***L1*****    RETBCR    ADD  RETBDR    RETBAL 150                                       262907
     CL1         RETBCR    ADD  RETBDR    RETBAL 180   81                                     262907
     C/COPY WNCPYSRC,GL0720C007
0239 C*
0240 C*    NET ACCOUNT CODE BALANCE
0241 C***L1*****    ACCBCR    ADD  ACCBDR    ACCBAL 150                                       262907
     CL1         ACCBCR    ADD  ACCBDR    ACCBAL 180   82                                     262907
0242 C*
0243 C*    ACCUMULATE TITLE CODE BALANCES
0244 C***L1*****    TITBCR    ADD  ACCBCR    TITBCR 150                                       262907
     CL1         TITBCR    ADD  ACCBCR    TITBCR 180                                          262907
0245 C*
0246 C***L1*****    TITBDR    ADD  ACCBDR    TITBDR 150                                       262907
     CL1         TITBDR    ADD  ACCBDR    TITBDR 180                                          262907
0247 C*
0248 C*    NET TITLE CODE BALANCE
0249 C***L2*****    TITBDR    ADD  TITBCR    TITBAL 150                                       262907
     CL2         TITBDR    ADD  TITBCR    TITBAL 180   83                                     262907
0250 C*
0251 C*    ACCUMULATE ACCOUNT SECTION BALANCES
0252 C***L2*****    SECBCR    ADD  TITBCR    SECBCR 150                                       262907
     CL2         SECBCR    ADD  TITBCR    SECBCR 180                                          262907
0253 C*
0254 C***L2*****    SECBDR    ADD  TITBDR    SECBDR 150                                       262907
     CL2         SECBDR    ADD  TITBDR    SECBDR 180                                          262907
0255 C*
0256 C*    NET ACCOUNT SECTION BALANCE
0257 C***L3*****    SECBDR    ADD  SECBCR    SECBAL 150                                       262907
     CL3         SECBDR    ADD  SECBCR    SECBAL 180   84                                     262907
0258 C*
0259 C*    ACCUMULATE CURRENCY BALANCES
0260 C***L3*****    CCYBCR    ADD  SECBCR    CCYBCR 150                                       262907
0261 C***L3*****    CCYBDR    ADD  SECBDR    CCYBDR 150                                       262907
     CL3         CCYBCR    ADD  SECBCR    CCYBCR 180                                          262907
     CL3         CCYBDR    ADD  SECBDR    CCYBDR 180                                          262907
0262 C*
0263 C*    NET CURRENCY BALANCE
0264 C***L4*****    CCYBCR    ADD  CCYBDR    CCYBAL 150                                       262907
     CL4         CCYBCR    ADD  CCYBDR    CCYBAL 180   85                                     262907
0265 CL0         END       TAG                             ** END TAG **
      *                                                                   S01117
      ** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUMU    SFNUM2  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           SFNUM2                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0266 C**
     CLR         *INU7     CABEQ'1'       LREND                           S01194
0267 C**
     CLRN21                SETON                     22                   E10014
0120 C*****SET*KEY*TO*CHAIN*TO INSTALLATION CONTROL RECORD         E10014 S01194
0121 C*R*22******          MOVEL'01'      TABKEY 12                E10014 S01194
0122 C*R*22******          MOVE '10'      TABKEY 12                E10014 S01194
0123 C*R*22******TABKEY    SETLLTABLE                              E10014 S01194
0124 C*R*22******          READ TABLE                    40        E10014 S01194
     C*                                                                   S01194
     CLR         *IN22     IFEQ '1'                        IF             S01194
     CLR                   CALL 'AOBANKR0'                                S01194
     CLR                   PARM '*MSG   ' @RTCD   7                       S01194
     CLR                   PARM '*FIRST ' @OPTN   7                       S01194
     CLR         SDBANK    PARM SDBANK    DSFDY                           S01194
     CLR         @RTCD     IFNE *BLANKS                    IF 2           S01194
     CLR                   MOVEL'SDBANKPD'DBFILE             *************S01194
     CLR                   MOVEL'003'     DBASE              * DBERR 003 *S01194
     CLR                   MOVEL@OPTN     DBOPTN  7          *************S01194
     CLR                   MOVEL@OPTN     DBKEY  29                       S01194
     CLR                   EXSR *PSSR                                     S01194
     CLR                   SETON                     40                   S01194
     CLR                   SETON                     U7U8                 S01194
     CLR                   GOTO LREND                                     S01194
     CLR                   ELSE                                           S01194
     CLR                   SETOF                     40                   S01194
      *                                                                   S01117
     CLR         *IN49     IFEQ '1'                        IF 3           S01117
      *                                                                   S01117
     CLR         *INU2     IFEQ '1'                        IF 4           S01117
     CLR         BRNCH     ANDNE'ALL'                                     S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     CLR                   CALL 'AOBRCHR1'                                                    CGL029
     CLR                   PARM '*MSG   ' @RTCD   7                       S01117
     CLR                   PARM '*KEY   ' @OPTN   7                       S01117
     CLR                   PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     CLR         @RTCD     IFNE *BLANKS                    IF 5           S01117
     CLR                   MOVEL'SDBRCHPD'DBFILE             *************S01117
     CLR                   MOVEL'004'     DBASE              * DBERR 004 *S01117
     CLR                   MOVEL@OPTN     DBOPTN  7          *************S01117
     CLR                   MOVELBRNCH     DBKEY                           S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   SETON                     U7U840               S01117
     CLR                   GOTO LREND                                     S01117
     CLR                   ELSE                                           S01117
     CLR                   SETOF                     40                   S01117
     CLR                   END                             FI 5           S01117
     CLR                   END                             FI 4           S01117
      *                                                                   S01117
     CLR         *INU1     IFEQ '1'                                       S01117
     CLR                   CALL 'AOCOMPR0'                                S01117
     CLR                   PARM *BLANKS   @RTCD   7                       S01117
     CLR                   PARM '*KEY   ' @OPTN   7                       S01117
     C*LR********          PARM BRNCH     @CENB   3                 S01117050005
     CLR                   PARM COMCOD    @CENB   3                       050005
     CLR         SDCOMP    PARM SDCOMP    DSFDY                           S01194
     CLR         @RTCD     IFNE *BLANKS                                   S01117
     CLR                   SETON                     39                   S01117
     CLR                   ELSE                                           S01117
     CLR                   SETOF                     39                   S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
      *                                                                   S01117
     CLR                   END                             FI 3           S01117
     C*                                                                   S01117
     C** OUTPUT GL0720P1 HERE IF A SINGLE BRANCH/COMPANY REQUEST HAS      S01117
     C** NO DETAILS TO REPORT                                             S01117
     CLR         *INU2     IFEQ '1'                                       S01117
     CLR         BRNCH     ANDNE'ALL'                                     S01117
     CLR         *INU1     OREQ '1'                                       S01117
     CLR         *IN49     OREQ '0'                                       S01117
     CLR                   OPEN GL0720P1                                  S01117
     CLR                   Z-ADD*ZEROS    PAGE                            S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUM     SFNUM1  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM BRNCH     SENTY                           S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           SFNUM1                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     CLR                   END                             FI 2           S01194
     CLR                   END                             FI 1           S01194
0125 C*
0268 CLR                   SETOF                     20
0269 CLRNU1NU2             SETON                     20
     C*                                                                   S01117
     C** SUPPRESS RUN CONTROL CHECK WHEN ONLY A BRANCH/COMPANY            S01117
     C** IS REQUESTED                                                     S01117
     CLR                   SETOF                     U8                   S01117
     CLR         *IN48     IFEQ '1'                                       S01117
     CLR         *IN49     OREQ '0'                                       S01117
     CLR         *INU1     OREQ '0'                                       S01117
     CLR         *INU2     ANDEQ'0'                                       S01117
0270 CLR         NORE      COMP NRECS                5555
0271 CLR         DHWN      COMP DHASHI               5656
0272 CLRN56      DHDC      COMP DHASHD               5656
0273 CLR         CHWN      COMP CHASHI               5757
0274 CLRN57      CHDC      COMP CHASHD               5757
0275 CLR 55
0276 COR 56
0277 COR 57                SETON                     U8
     CLR                   END                                            S01117
     CLR         LREND     TAG                             ** LREND  **   S01117
0278 C*
0279 C*
0169 C********************************************************************S01194
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C/COPY WNCPYSRC,GLH00352
     C**                                                                  S01194
      *****************************************************************                     CGL127AO
      *                                                               *                     CGL127AO
      * SRINIT - Initial Subroutine                                   *                     CGL127AO
      *                                                               *                     CGL127AO
      *****************************************************************                     CGL127AO
     C           SRINIT    BEGSR                                                            CGL127AO
      *                                                                                     CGL127AO
      ** Array Size used by multi-occurence data structure and                              CGL127AO
      ** LRU arrays                                                                         CGL127AO
      *                                                                                     CGL127AO
     C                     Z-ADD300       ARRSZ   30                                        CGL127AO
      *                                                                                     CGL127AO
      ** LRU element key and record arrival sequence                                        CGL127AO
      *                                                                                     CGL127AO
     C                     Z-ADD0         LEASTE 130                                        CGL127AO
     C           *LIKE     DEFN LEASTE    RCSQ                                              CGL127AO
      *                                                                                     CGL127AO
      ** Set start index to upper limit of account code arrays                              CGL127AO
      ** Define current index and previous index as same with TIDX                          CGL127AO
      ** Define KEYACD to be the same with ACOD                                             CGL127AO
      *                                                                                     CGL127AO
     C                     Z-ADDARRSZ     TIDX    40                                        CGL127AO
     C           *LIKE     DEFN TIDX      PIDX                                              CGL127AO
     C           *LIKE     DEFN TIDX      C                                                 CGL127AO
     C           *LIKE     DEFN A5ACCD    KEYACD                                            CGL127AO
      *                                                                                     CGL127AO
      ** Initialize work fields of account code arrays routines                             CGL127AO
      *                                                                                     CGL127AO
     C                     MOVE *BLANK    ACFIC   1                                         CGL127AO
     C                     MOVE *BLANKS   KEYACD                                            CGL127AO
     C                     Z-ADDARRSZ     PIDX                                              CGL127AO
     C                     Z-ADDARRSZ     C                                                 CGL127AO
      *                                                                                     CGL127AO
     C                     ENDSR                                                            CGL127AO
      *****************************************************************                     CGL127AO
      *                                                               *                     CGL127AO
      *  CHKACD - Check Account Code details in array                 *                     CGL127AO
      *                                                               *                     CGL127AO
      *****************************************************************                     CGL127AO
     C           CHKACD    BEGSR                                                            CGL127AO
      *                                                                                     CGL127AO
      ** Reinitialize work fields                                                           CGL127AO
      *                                                                                     CGL127AO
     C                     MOVEL*BLANK    ACFIC                                             CGL127AO
     C                     SETOF                         47                                 CGL127AO
      *                                                                                     CGL127AO
      ** Only check cache if not empty and account code not blank                           CGL127AO
      *                                                                                     CGL127AO
     C           TIDX      IFNE ARRSZ                                                       CGL127AO
     C           KEYACD    ANDNE*BLANKS                                                     CGL127AO
      *                                                                                     CGL127AO
      ** Check previous account code details if                                             CGL127AO
      ** same with current details                                                          CGL127AO
      *                                                                                     CGL127AO
     C                     Z-ADDPIDX      C                                                 CGL127AO
      *                                                                                     CGL127AO
      ** Defend against index being 0                                                       CGL127AO
      ** Set current index to starting index                                                CGL127AO
      *                                                                                     CGL127AO
     C           C         IFEQ 0                                                           CGL127AO
     C                     Z-ADDTIDX      C                                                 CGL127AO
     C                     ENDIF                                                            CGL127AO
      *                                                                                     CGL127AO
      ** If the ACOD being checked is the same then use the index                           CGL127AO
      ** of the current detail rather than doing a LOKUP                                    CGL127AO
      *                                                                                     CGL127AO
     C           KEYACD    IFEQ CDAC,C                                                      CGL127AO
     C                     SETON                         47                                 CGL127AO
     C                     ELSE                                                             CGL127AO
      *                                                                                     CGL127AO
     C           TIDX      IFEQ 0                                                           CGL127AO
     C                     Z-ADD1         C                                                 CGL127AO
     C                     ELSE                                                             CGL127AO
     C                     Z-ADDTIDX      C                                                 CGL127AO
     C                     ENDIF                                                            CGL127AO
      *                                                                                     CGL127AO
     C           KEYACD    LOKUPCDAC,C                   47                                 CGL127AO
     C                     ENDIF                                                            CGL127AO
      *                                                                                     CGL127AO
      ** Save the last accessed detail to PIDX                                              CGL127AO
      ** Set the indicator to show the data was found                                       CGL127AO
      *                                                                                     CGL127AO
     C           *IN47     IFEQ *ON                                                         CGL127AO
     C                     MOVE RCSQ      LRUA,C                                            CGL127AO
     C                     Z-ADDC         PIDX                                              CGL127AO
     C                     MOVEL'Y'       ACFIC                                             CGL127AO
     C                     ENDIF                                                            CGL127AO
      *                                                                                     CGL127AO
     C                     ENDIF                                                            CGL127AO
     C                     ENDSR                                                            CGL127AO
      *****************************************************************                     CGL127AO
      *                                                               *                     CGL127AO
      *  ADDACD - Add Account Code details to array                   *                     CGL127AO
      *                                                               *                     CGL127AO
      *****************************************************************                     CGL127AO
     C           ADDACD    BEGSR                                                            CGL127AO
      *                                                                                     CGL127AO
      ** If there is still room in the array then add the details                           CGL127AO
      *                                                                                     CGL127AO
     C           TIDX      IFNE 0                                                           CGL127AO
     C                     SUB  1         TIDX                                              CGL127AO
     C                     ENDIF                                                            CGL127AO
      *                                                                                     CGL127AO
     C                     MOVELA5ACCD    CDAC,C                                            CGL127AO
     C                     MOVE RCSQ      LRUA,C                                            CGL127AO
      *                                                                                     CGL127AO
      ** Set last accessed detail to PIDX so that CHKACD checks this                        CGL127AO
      ** latest detail first                                                                CGL127AO
      *                                                                                     CGL127AO
     C                     Z-ADDC         PIDX                                              CGL127AO
      *                                                                                     CGL127AO
     C                     ENDSR                                                            CGL127AO
0280 C********************************************************************
0281 C**
0282 C**   SR. TO SET UP ANARRAY OF CURRENCIES AND AN ARRAY OF
0283 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0284 C**
0285 C           CCYARR    BEGSR                           *** CCYARR  ***
0286 C**
0287 C**   SET ARRAY INDEX TO ZERO.
0288 C                     Z-ADD0         X       30
0289 C**
0290 C**   SET UP KEY FOR CURRENCY TABLE.
0291 C***********          MOVEL'20      'XCYKEY 12                       S01194
0292 C***********          MOVE '    '    XCYKEY                          S01194
     C                     MOVE *BLANKS   W@CKEY  3                       S01194
0293 C**
0294 C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
0295 C***********XCYKEY    SETLLTABLE                                     S01194
0205 C           W@CKEY    SETLLSDCURRL0                                  S01194
0296 C**
0297 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0298 C*
0299 C*
0300 C           XLOOP     TAG                             ** XLOOP TAG **
0301 C***********          READ TABLE                    99               S01194
0209 C                     READ SDCURRL0                 99               S01194
0302 C**N99******RECTX     COMP 20                   9999                 S01194
0303 C**
0304 C**   END IF ALL CURRENCY RECORDS PROCESSED
0305 C   99                GOTO XEND
0306 C**
0307 C*****IGNOR*DELETED RECORDS AND NON-SUB-RECORD ONE.                  S01194
0308 C***********RECIX     COMP 'D'                  9797                 S01194
0309 C***97******          GOTO XLOOP                                     S01194
0310 C***********SRECX     COMP 1                    9797                 S01194
0311 C***97******          GOTO XLOOP                                     S01194
0312 C**
0313 C**   INCREMENT ARRAY INDEX.
0314 C           X         ADD  1         X
0315 C**
0316 C**   MOVE DATA INTO ARRAYS.
0317 C***********          MOVE CCYX      CCYA,X                          S01194
0225 C                     MOVE A6CYCD    CCYA,X                          S01194
0318 C***********          MOVE CDPX      DPA,X                           S01194
0226 C                     MOVE A6NBDP    DPA,X                           S01194
0319 C**
0320 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0321 C           X         COMP 150                      96
0322 C**
0323 C**   GO TO READ NEXT RECORD.
0324 C  N96                GOTO XLOOP
0325 C**
0326 C           XEND      TAG                             ** XEND TAG  **
0327 C                     ENDSR
0328 C**
0329 C********************************************************************
0330 C**
0331 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0332 C**
0333 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0334 C**
0335 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0336 C                     Z-ADD1         X            99
0337 C**
0338 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0339 C                     Z-ADD0         XDECP   10
0340 C                     MOVE XCCY      XCCY    3
0341 C**
0342 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0343 C**   99 SETON FOR INVALID CURRENCY.
0344 C           XCCY      LOKUPCCYA,X                   97
0345 C   97                MOVE DPA,X     XDECP
0346 C  N97                SETON                     99
0347 C**
0348 C                     ENDSR
0349 C**
0350 C********************************************************************
0351 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0352 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0353 C*
0354 CSR         GLZADD    BEGSR                           *** GLZADD ****
0355 C*
0356 C***SR*****              Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT                   262907
     CSR                   Z-ADDZZAMT     ZZAMT  183     91-DEFINE ZZAMT                      262907
0357 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0358 C*
0359 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0360 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0361 CSR                   Z-ADDZZAMT     ZZWK1   33
0362 CSR                   MOVE ZZWK1     ZZAMTD  30       DECIMAL FIELD
0363 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0364 C*
0365 CSR                   EXSR GLZSUM
0366 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0367 C*
0368 C********************************************************************
0369 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0370 C*                        GLZADD, GLZSUB, GLZCMP.
0371 C*          PARAMETERS PASSED -
0372 C*                     I/P ZZAMTI ZZAMTD
0373 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0374 C*
0375 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0376 C*
0377 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0378 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0379 CSR                   SETOF                     919293
0380 CSR                   SETOF                     949599
0381 C*
0382 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0383 CSR         ZZAMTI    COMP 0                      9293
0384 CSR 93      ZZAMTD    COMP 0                      9293
0385 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0386 C*
0387 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0388 CSR         ZZTOTI    COMP 0                      9193
0389 CSR 93      ZZTOTD    COMP 0                      9193
0390 C*
0391 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0392 CSR 93                Z-ADDZZAMTI    ZZTOTI
0393 CSR 93                Z-ADDZZAMTD    ZZTOTD
0394 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0395 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0396 CSR 91N92
0397 CORN91 92             GOTO ZZOFPS
0398 C*
0399 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0400 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0401 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0402 C*
0403 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0404 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0405 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0406 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0407 C*
0408 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0409 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0410 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0411 CSRN99                Z-ADDZZWK2     ZZTOTD
0412 CSRN99                Z-ADDZZWK3     ZZTOTI
0413 C*
0414 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0415 C***SR*99**              Z-ADD0         ZZAMT  153                                       262907
     CSR 99                Z-ADD0         ZZAMT  183                                          262907
0416 CSR                   GOTO ZZSEND
0417 C*
0418 C* THE 'SIGNS' ARE DIFFERENT
0419 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0420 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0421 C*
0422 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0423 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0424 C*
0425 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0426 C*
0427 CSR 91                Z-SUBZZTOTI    ZZTOTI
0428 CSR 91                Z-SUBZZTOTD    ZZTOTD
0429 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0430 C*
0431 CSR         ZZTOTI    COMP ZZAMTI               93  95
0432 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0433 C*
0434 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0435 CSR 95                Z-ADD0         ZZTOTI
0436 CSR 95                Z-ADD0         ZZTOTD
0437 CSR 95                GOTO ZZSEND
0438 C*
0439 C* IF ZZTOT GT. ZZAMT.
0440 CSR 93      ZZAMTD    COMP ZZTOTD               94
0441 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0442 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0443 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0444 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0445 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0446 C*
0447 C*
0448 C* IF ZZAMT GT. ZZTOT.
0449 CSRN93      ZZTOTD    COMP ZZAMTD               94
0450 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0451 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0452 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0453 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0454 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0455 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0456 C*
0457 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0458 CSR                   SETOF                     94
0459 CSR 93 91
0460 CORN93 92             SETON                     94
0461 CSR 94                Z-SUBZZTOTI    ZZTOTI
0462 CSR 94                Z-SUBZZTOTD    ZZTOTD
0463 C**
0464 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0465 CSR 92                Z-SUBZZAMTI    ZZAMTI
0466 CSR 92                Z-SUBZZAMTD    ZZAMTD
0467 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0468 C**
0469 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0470 CSR                   SETOF                     96
0471 CSR         ZZTOTD    COMP 0                        91
0472 CSR 91      ZZTOTI    COMP 0                      96
0473 CSR 96                MOVE '.000-'   ZZNEGD  5
0474 CSR                   ENDSR                             ** ENDSR **
0475 C********************************************************************
     C/EJECT                                                              S01117
2431 C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BN,B    A8BRNM                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELA8BRNM    ##BN,B                                              CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array first                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKP - Subroutine to check the Company in the arrays                                CSC042
      *                                                                                       CSC042
     C           ##CHKP    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * Restore the saved Value of P                                                          CSC042
     C                     Z-ADD##PSV     P                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Company already in array                                    CSC042
     C           *LIKE     DEFN APCMCD    ##KP                                                CSC042
     C                     SETOF                         86                                   CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against P being 0                                                              CSC042
     C           P         IFEQ 0                                                             CSC042
     C                     Z-ADD1         P                                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * If the company being checked is the same then use these                               CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KP      IFEQ ##PC,P                                                        CSC042
      * Found so seton 86                                                                     CSC042
     C                     SETON                         86                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         P                                                   CSC042
     C           ##KP      LOKUP##PC,P                   86                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save the last update to P                                                             CSC042
     C           *IN86     IFEQ *ON                                                           CSC042
     C                     Z-ADDP         ##PSV                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETP - Sets up the SDCOMPPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETP    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##PC,P    APCMCD                                              CSC042
     C                     MOVEL##PN,P    APCMNM                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDP - Adds the SDCOMPPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDP    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##PNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##PNDX                                              CSC042
     C                     Z-ADD##PNDX    P                                                   CSC042
     C                     MOVELAPCMCD    ##PC,P                                              CSC042
     C                     MOVELAPCMNM    ##PN,P                                              CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Update ##PSV  so next call to ##CHKP checks this latest adddition                     CSC042
      * to the array first                                                                    CSC042
     C                     Z-ADDP         ##PSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
0476 O*L0720P1D**203   L3NLR                                              S01117
0476 OGL0720P1D  203   L3NLR 75                                           S01117
     O       AND      N40                                                 S01117
0477 O*******OR**203   OFNL3                                              S01117
0477 O       OR  203   OFNL3 75                                           S01117
     O       AND      N40                                                 S01117
     O/COPY WNCPYSRC,GL0720O008
0478 O*****                              22 'REFERENCE GL0720'            S01117
0478 O                                   24 'REFERENCE GL0720P1'          S01117
0479 O***********              TITL      89                               S01194
0454 O                         BJURPT    89                               S01194
0480 O                                  104 'DATE'
0481 O                         RUNA     113
0482 O                                  122 'PAGE'
0483 O                         PAGE  Z  127
0484 O        D  1     L3N40NLR
     O       AND       75                                                 S01117
0485 O       OR        OFN40NL3
     O       AND       75                                                 S01117
0486 O***********     NU1NU2             14 'CONSOLIDATED'                S01117
0487 O***********      U1                 9 'COMPANY'                     S01117
0488 O***********      U1      CMNM      41                               S01117
0489 O***********      U1 39             26 '***************'             S01117
0490 O***********      U1 39             41 '***************'             S01117
0491 O***********      U2                 8 'BRANCH'                      S01117
0492 O***********      U2      BRCHNO    12                               S01117
0493 O                                   74 'GENERAL LEDGER BALANCES'
     O***********      U2 49             83 'BRANCH'                S01117066997
0492 O***********      U2 49   BRCHNO    87                         S01117066997
     O***********      U2 49             88 '-'                     S01117066997
     O***********      U2 49   A8BRNM   118                         S01117066997
     O                 U2 49             84 'BRANCH'                      066997
0492 O                 U2 49   BRCHNO    88                               066997
     O                 U2 49             89 '-'                           066997
     O                 U2 49   A8BRNM   119                               066997
     O                 U1                84 'COMPANY'                     S01117
0492 O                 U1      COMCOD    88                               S01117
     O                 U1                89 '-'                           S01117
0488 O                 U1N39   APCMNM   119                               S01117
0488 O                 U1 39            112 '*** UNKNOWN COMPANY ***'     S01117
     O                NU1NU2             89 'CONSOLIDATED'                S01117
     O/COPY WNCPYSRC,GL0720O005
0494 O***********                        76 '-'                           S01117
0495 O***********              CCYCOD    80                               S01117
0496 O        D  2     L3N40NLR
     O       AND       75                                                 S01117
0497 O       OR        OFN40NL3
     O       AND       75                                                 S01117
0498 O                                   74 '-----------------------'
     O*  TO SPECIFY REPORT TYPE                                           E42846
0484 O        D  2     L3N40NLR                                           E42846
     O       AND       75                                                 E42846
0485 O       OR        OFN40NL3                                           E42846
     O       AND       75                                                 E42846
0493 O                 60                72 'AFTER FINAL POST'            E42846
0493 O                 61                72 'AFTER DAILY POST'            E42846
0493 O                 62                74 'AFTER SPOT REVALUATION'      E42846
0493 O                 63                73 'AFTER B/CCY TRANSFER'        E42846
0493 O                 64                73 'AFTER F/CCY TRANSFER'        E42846
     O/COPY WNCPYSRC,GL0720O006
0496 O        D  2     L3N40NLR                                           E42846
     O       AND       75                                                 E42846
0497 O       OR        OFN40NL3                                           E42846
     O       AND       75                                                 E42846
0493 O                 60                72 '----------------'            E42846
0493 O                 61                72 '----------------'            E42846
0493 O                 62                74 '----------------------'      E42846
0493 O                 63                73 '--------------------'        E42846
0493 O                 64                73 '--------------------'        E42846
     O/COPY WNCPYSRC,GL0720O007
     O*                                                                   E42846
0484 O        D  2     L3N40NLR                                           S01117
     O       AND       75                                                 S01117
0485 O       OR        OFN40NL3                                           S01117
     O       AND       75                                                 S01117
0494 O                                   67 'CURRENCY'                    S01117
0494 O                                   69 '-'                           S01117
0495 O                         CCYCOD    73                               S01117
0499 O********D**2     L3N40                                              S01117
0499 O        D  2     L3N40 75                                           S01117
0500 O       OR        OFN40NL3
     O       AND       75                                                 S01117
0501 O                                   19 'GENERAL LEDGER'
0502 O                                   50 'CUSTOMER'
     O*                                                                   S01408
     O** Core hook for externalisation.                                   S01408
     O/COPY WNCPYSRC,GL0720OOP1                                           S01408
     O*                                                                   S01408
0503 O**********                         83 'DEBIT'                                           262907
0504 O**********                        103 'CREDIT'                                          262907
0505 O**********                        123 'NET'                                             262907
     O                                   70 'DEBIT'                                           262907
     O                                   95 'CREDIT'                                          262907
     O                                  117 'NET'                                             262907
0506 O        D  1     L3N40NLR
     O       AND       75                                                 S01117
0507 O                    42              6 'ASSETS'
0508 O                    43             11 'LIABILITIES'
0509 O                    44              6 'INCOME'
0510 O                    45              7 'EXPENSE'
0511 O                    46             10 'CONTINGENT'
0512 O        D  2     L3N40NLR
     O       AND       75                                                 S01117
0513 O                                    6 '------'
0514 O                    43             11 '-----'
0515 O                    45              7 '-'
0516 O                    46             10 '----'
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OOP3                                           S01408
     O*                                                                   S01408
     O        D  2     L3N40NLR                                           S01290
     O       AND       75                                                 S01290
     O                                   24 '========================'    S01290
     O                                   48 '========================'    S01290
     O                                   72 '========================'    S01290
     O                                   96 '========================'    S01290
     O                                  120 '========================'    S01290
     O                                  132 '============'                S01290
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OOP4                                           S01408
     O*                                                                   S01408
0517 O        D  1     L2N40NLR
     O       AND       75                                                 S01117
0518 O       OR        OFN40NL2
     O       AND       75                                                 S01117
0519 O**********               TITCOD     4                                                   CGL029
0519 O                         TITCOD    10                                                   CGL029
     O*******                  TITNAM    30                               CSD005
     O**********      N73      TITNAM    30                                            CSD005 CGL029
     O                N73      TITNAM    36                                                   CGL029
     O**********       73      TITNAR    55                                            CSD005 CGL029
     O**********       73      TITNAR    61                                            CGL029 262907
     O                 73      TITNAR    51                                                   262907
0521 O        D  2     L2N40NLR
     O       AND       75                                                 S01117
0522 O       OR        OFN40NL2
     O       AND       75                                                 S01117
0523 O************                       19 '-------------------'         S01290
0524 O************                       30 '-----------'                 S01290
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OOP5                                           S01408
     O*                                                                   S01408
     O                                   24 '------------------------'    S01290
     O                                   48 '------------------------'    S01290
     O                                   72 '------------------------'    S01290
     O                                   96 '------------------------'    S01290
     O                                  120 '------------------------'    S01290
     O                                  132 '------------'                S01290
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OOP6                                           S01408
     O*                                                                   S01408
0525 O        D  1     L1N40NLR
     O       AND       75                                                 S01117
     O/COPY WNCPYSRC,GLH00353
0526 O       OR        OFN40NL1
     O       AND       75                                                 S01117
     O/COPY WNCPYSRC,GLH00354
0527 O**********               ACCCOD     4                                                   CGL029
0527 O                         ACCCOD    10                                                   CGL029
     O*******                  ACCNAM    30                               CSD005
     O**********      N73      ACCNAM    30                                            CSD005 CGL029
     O                N73      ACCNAM    36                                                   CGL029
     O**********       73      ACCNAR    55                                            CSD005 CGL029
     O**********       73      ACCNAR    61                                            CGL029 262907
     O                 73      ACCNAR    51                                                   262907
     O/COPY WNCPYSRC,GL0720O001
0529 O        D  1     01N41N40
     O/COPY WNCPYSRC,GL0720O002
     O       AND       75                                                 S01117
     O/COPY WNCPYSRC,GLH00355
0530 O**********       49      BRCHNO    19                                            S01117 262907
0531 O**********       49                20 '-'                                        S01117 262907
0530 O**********               CUSTNO    26                                                   262907
0531 O**********                         27 '-'                                               262907
0532 O**********               ACCSEQ    29                                                   262907
0533 O**********               NAME      50                                                   262907
0534 O**********               TOWN      61                                                   262907
     O                 49      BRCHNO     7                                                   262907
     O                 49                 8 '-'                                               262907
     O                         CUSTNO    14                                                   262907
     O                                   15 '-'                                               262907
     O                         ACCSEQ    17                                                   262907
     O                         NAME      38                                                   262907
     O                         TOWN      49                                                   262907
     O*                                                                   S01408
     O** Core hook for externalisation.                                   S01408
     O/COPY WNCPYSRC,GL0720OOP2                                           S01408
     O*                                                                   S01408
0535 O*
0536 O*
0537 O**********       11 30             86 '0'                                               262907
0538 O**********       11 31             86 '0.0'                                             262907
0539 O**********       11 32             86 '0.00'                                            262907
0540 O**********       11 33             86 '0.000'                                           262907
     O                 11 30             79 '0'                                               262907
     O                 11 31             79 '0.0'                                             262907
     O                 11 32             79 '0.00'                                            262907
     O                 11 33             79 '0.000'                                           262907
0541 O*
0542 O**********         N11 30NEWBAL    86 '   ,   ,   ,   , 0 '                             262907
0543 O**********         N11 31NEWBAL    86 '  ,   ,   ,   , 0 . '                            262907
0544 O**********         N11 32NEWBAL    86 ' ,   ,   ,   , 0 .  '                            262907
0545 O**********         N11 33NEWBAL    86 '   ,   ,   , 0 .   '                             262907
     O                   N11 30NEWBAL    79 '   ,   ,   ,   ,   , 0 '                         262907
     O                   N11 31NEWBAL    79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                   N11 32NEWBAL    79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                   N11 33NEWBAL    79 '   ,   ,   ,   , 0 .   '                         262907
0546 O*
0547 O**********       10 30            106 '0'                                               262907
0548 O**********       10 31            106 '0.0'                                             262907
0549 O**********       10 32            106 '0.00'                                            262907
0550 O**********       10 33            106 '0.000'                                           262907
0551 O**********         N10 30NEWBAL   106 '   ,   ,   ,   , 0 '                             262907
0552 O**********         N10 31NEWBAL   106 '  ,   ,   ,   , 0 . '                            262907
0553 O**********         N10 32NEWBAL   106 ' ,   ,   ,   , 0 .  '                            262907
0554 O**********         N10 33NEWBAL   106 '   ,   ,   , 0 .   '                             262907
     O                 10 30            104 '0'                                               262907
     O                 10 31            104 '0.0'                                             262907
     O                 10 32            104 '0.00'                                            262907
     O                 10 33            104 '0.000'                                           262907
     O                   N10 30NEWBAL   104 '   ,   ,   ,   ,   , 0 '                         262907
     O                   N10 31NEWBAL   104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                   N10 32NEWBAL   104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                   N10 33NEWBAL   104 '   ,   ,   ,   , 0 .   '                         262907
0555 O*
0556 O**********             30NEWBAL   128 '   ,   ,   ,   , 0 CR'                           262907
0557 O**********             31NEWBAL   128 '  ,   ,   ,   , 0 . CR'                          262907
0558 O**********             32NEWBAL   128 ' ,   ,   ,   , 0 .  CR'                          262907
0559 O**********             33NEWBAL   128 '   ,   ,   , 0 .   CR'                           262907
     O                       30NEWBAL   129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31NEWBAL   129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32NEWBAL   129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33NEWBAL   129 '   ,   ,   ,   , 0 .   '                         262907
     O                 80               131 'CR'                                              262907
0560 O*
0561 O********TF 2     L1 41N40                                           E15058
     O/COPY WNCPYSRC,GL0720O003
     O        T  2     L1 41N40                                           E15058
0562 O*******AND*     NLR                                                 S01117
0562 O       AND      NLR 75                                              S01117
     O/COPY WNCPYSRC,GLH00356
     O*******ORF       20 41N40                                           E15058
     O       OR        20 41N40                                           E15058
     O       AND       75                                                 S01117
     O/COPY WNCPYSRC,GLH00357
0564 O**********                         45 'RETAIL ACCOUNTS'                                 262907
0565 O**********             30RETBDR B  86 '   ,   ,   ,   , 0 '                             262907
0566 O**********             31RETBDR B  86 '  ,   ,   ,   , 0 . '                            262907
0567 O**********             32RETBDR B  86 ' ,   ,   ,   , 0 .  '                            262907
0568 O**********             33RETBDR B  86 '   ,   ,   , 0 .   '                             262907
0569 O*
0570 O**********             30RETBCR B 106 '   ,   ,   ,   , 0 '                             262907
0571 O**********             31RETBCR B 106 '  ,   ,   ,   , 0 . '                            262907
0572 O**********             32RETBCR B 106 ' ,   ,   ,   , 0 .  '                            262907
0573 O**********             33RETBCR B 106 '   ,   ,   , 0 .   '                             262907
0574 O*
0575 O**********             30RETBAL B 128 '   ,   ,   ,   , 0 CR'                           262907
0576 O**********             31RETBAL B 128 '  ,   ,   ,   , 0 . CR'                          262907
0577 O**********             32RETBAL B 128 ' ,   ,   ,   , 0 .  CR'                          262907
0578 O**********             33RETBAL B 128 '   ,   ,   , 0 .   CR'                           262907
      *                                                                                       262907
     O                                   33 'RETAIL ACCOUNTS'                                 262907
     O                       30RETBDR B  79 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31RETBDR B  79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32RETBDR B  79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33RETBDR B  79 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30RETBCR B 104 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31RETBCR B 104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32RETBCR B 104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33RETBCR B 104 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30RETBAL B 129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31RETBAL B 129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32RETBAL B 129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33RETBAL B 129 '   ,   ,   ,   , 0 .   '                         262907
     O                 81               131 'CR'                                              262907
     O/COPY WNCPYSRC,GL0720O004
0579 O*
     O******* TF12     L1N40N22                                           E15058
     O*******ORF       20N40N22                                           E15058
     O        T 12     L1N40N22                                           E15058
     O*******AND       75                                           S01117CSD005
     O       AND       75N73                                              S01117
     O/COPY WNCPYSRC,GLH00358
     O       OR        20N40N22                                           E15058
     O*******AND       75                                           S01117CSD005
     O       AND       75N73                                              CSD005
     O/COPY WNCPYSRC,GLH00359
0582 O***********                        65 'A/C CODE TOTAL'              S01290
0582 O**********               ACCNAM    59                                            S01290 262907
0582 O**********                         65 'TOTAL'                                    S01290 262907
0583 O**********             30ACCBDR B  86 '   ,   ,   ,   , 0 '                             262907
0584 O**********             31ACCBDR B  86 '  ,   ,   ,   , 0 . '                            262907
0585 O**********             32ACCBDR B  86 ' ,   ,   ,   , 0 .  '                            262907
0586 O**********             33ACCBDR B  86 '   ,   ,   , 0 .   '                             262907
0587 O*
0588 O**********             30ACCBCR B 106 '   ,   ,   ,   , 0 '                             262907
0589 O**********             31ACCBCR B 106 '  ,   ,   ,   , 0 . '                            262907
0590 O**********             32ACCBCR B 106 ' ,   ,   ,   , 0 .  '                            262907
0591 O**********             33ACCBCR B 106 '   ,   ,   , 0 .   '                             262907
0592 O*
0593 O**********             30ACCBAL B 128 '   ,   ,   ,   , 0 CR'                           262907
0594 O**********             31ACCBAL B 128 '  ,   ,   ,   , 0 . CR'                          262907
0595 O**********             32ACCBAL B 128 ' ,   ,   ,   , 0 .  CR'                          262907
0596 O**********             33ACCBAL B 128 '   ,   ,   , 0 .   CR'                           262907
     O                         ACCNAM    47                                                   262907
     O                                   53 'TOTAL'                                           262907
     O                       30ACCBDR B  79 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31ACCBDR B  79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32ACCBDR B  79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33ACCBDR B  79 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30ACCBCR B 104 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31ACCBCR B 104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32ACCBCR B 104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33ACCBCR B 104 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30ACCBAL B 129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31ACCBAL B 129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32ACCBAL B 129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33ACCBAL B 129 '   ,   ,   ,   , 0 .   '                         262907
     O                 82               131 'CR'                                              262907
     O* New output format for Account Narrative                           CSD005
     O        T 12     L1N40N22                                           CSD005
     O       AND       75 73                                              CSD005
     O/COPY WNCPYSRC,GLH00360
     O       OR        20N40N22                                           CSD005
     O       AND       75 73                                              CSD005
     O/COPY WNCPYSRC,GLH00361
     O**********               ACCNAR    59                                            CSD005 262907
     O**********                         65 'TOTAL'                                    CSD005 262907
     O**********             30ACCBDR B  86 '   ,   ,   ,   , 0 '                      CSD005 262907
     O**********             31ACCBDR B  86 '  ,   ,   ,   , 0 . '                     CSD005 262907
     O**********             32ACCBDR B  86 ' ,   ,   ,   , 0 .  '                     CSD005 262907
     O**********             33ACCBDR B  86 '   ,   ,   , 0 .   '                      CSD005 262907
     O*                                                                                CSD005 262907
     O**********             30ACCBCR B 106 '   ,   ,   ,   , 0 '                      CSD005 262907
     O**********             31ACCBCR B 106 '  ,   ,   ,   , 0 . '                     CSD005 262907
     O**********             32ACCBCR B 106 ' ,   ,   ,   , 0 .  '                     CSD005 262907
     O**********             33ACCBCR B 106 '   ,   ,   , 0 .   '                      CSD005 262907
     O*                                                                                CSD005 262907
     O**********             30ACCBAL B 128 '   ,   ,   ,   , 0 CR'                    CSD005 262907
     O**********             31ACCBAL B 128 '  ,   ,   ,   , 0 . CR'                   CSD005 262907
     O**********             32ACCBAL B 128 ' ,   ,   ,   , 0 .  CR'                   CSD005 262907
     O**********             33ACCBAL B 128 '   ,   ,   , 0 .   CR'                    CSD005 262907
     O                         ACCNAR    47                                                   262907
     O                                   53 'TOTAL'                                           262907
     O                       30ACCBDR B  79 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31ACCBDR B  79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32ACCBDR B  79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33ACCBDR B  79 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30ACCBCR B 104 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31ACCBCR B 104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32ACCBCR B 104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33ACCBCR B 104 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30ACCBAL B 129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31ACCBAL B 129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32ACCBAL B 129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33ACCBAL B 129 '   ,   ,   ,   , 0 .   '                         262907
     O                 82               131 'CR'                                              262907
     O*
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OOP7                                           S01408
     O*                                                                   S01408
     O        T  1     L1N40N22                                           S01290
     O       AND       75                                                 S01290
     O/COPY WNCPYSRC,GLH00362
     O       OR        20N40N22                                           S01290
     O       AND       75                                                 S01290
     O/COPY WNCPYSRC,GLH00363
     O                                   24 '------------------------'    S01290
     O                                   48 '------------------------'    S01290
     O                                   72 '------------------------'    S01290
     O                                   96 '------------------------'    S01290
     O                                  120 '------------------------'    S01290
     O                                  132 '------------'                S01290
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OOP8                                           S01408
     O*                                                                   S01408
0597 O*
     O******* TF 2     L2N40N22                                           E15058
     O*******ORF       20N40N22                                           E15058
     O        T  2     L2N40N22                                           E15058
     O*******AND       75                                           S01117CSD005
     O       AND       75N73                                              CSD008
     O       OR        20N40N22                                           E15058
     O*******AND       75                                           S01117CSD005
     O       AND       75N73                                              CSD005
0600 O***********                        65 'SECTION TOTAL'               S01290
0600 O**********               TITNAM    59                                            S01290 262907
0600 O**********                         65 'TOTAL'                                    S01290 262907
0601 O**********             30TITBDR B  86 '   ,   ,   ,   , 0 '                             262907
0602 O**********             31TITBDR B  86 '  ,   ,   ,   , 0 . '                            262907
0603 O**********             32TITBDR B  86 ' ,   ,   ,   , 0 .  '                            262907
0604 O**********             33TITBDR B  86 '   ,   ,   , 0 .   '                             262907
0605 O*
0606 O**********             30TITBCR B 106 '   ,   ,   ,   , 0 '                             262907
0607 O**********             31TITBCR B 106 '  ,   ,   ,   , 0 . '                            262907
0608 O**********             32TITBCR B 106 ' ,   ,   ,   , 0 .  '                            262907
0609 O**********             33TITBCR B 106 '   ,   ,   , 0 .   '                             262907
0610 O*
0611 O**********             30TITBAL B 128 '   ,   ,   ,   , 0 CR'                           262907
0612 O**********             31TITBAL B 128 '  ,   ,   ,   , 0 . CR'                          262907
0613 O**********             32TITBAL B 128 ' ,   ,   ,   , 0 .  CR'                          262907
0614 O**********             33TITBAL B 128 '   ,   ,   , 0 .   CR'                           262907
     O                         TITNAM    47                                                   262907
     O                                   53 'TOTAL'                                           262907
     O                       30TITBDR B  79 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31TITBDR B  79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32TITBDR B  79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33TITBDR B  79 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30TITBCR B 104 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31TITBCR B 104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32TITBCR B 104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33TITBCR B 104 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30TITBAL B 129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31TITBAL B 129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32TITBAL B 129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33TITBAL B 129 '   ,   ,   ,   , 0 .   '                         262907
     O                 83               131 'CR'                                              262907
      *                                                                   CSD005
     O        T  2     L2N40N22                                           CSD005
     O       AND       75 73                                              CSD005
     O       OR        20N40N22                                           CSD005
     O       AND       75 73                                              CSD005
     O**********               TITNAR    59                                            CSD005 262907
     O**********                         65 'TOTAL'                                    CSD005 262907
     O**********             30TITBDR B  86 '   ,   ,   ,   , 0 '                      CSD005 262907
     O**********             31TITBDR B  86 '  ,   ,   ,   , 0 . '                     CSD005 262907
     O**********             32TITBDR B  86 ' ,   ,   ,   , 0 .  '                     CSD005 262907
     O**********             33TITBDR B  86 '   ,   ,   , 0 .   '                      CSD005 262907
     O*                                                                   CSD005
     O**********             30TITBCR B 106 '   ,   ,   ,   , 0 '                      CSD005 262907
     O**********             31TITBCR B 106 '  ,   ,   ,   , 0 . '                     CSD005 262907
     O**********             32TITBCR B 106 ' ,   ,   ,   , 0 .  '                     CSD005 262907
     O**********             33TITBCR B 106 '   ,   ,   , 0 .   '                      CSD005 262907
     O*                                                                   CSD005
     O**********             30TITBAL B 128 '   ,   ,   ,   , 0 CR'                    CSD005 262907
     O**********             31TITBAL B 128 '  ,   ,   ,   , 0 . CR'                   CSD005 262907
     O**********             32TITBAL B 128 ' ,   ,   ,   , 0 .  CR'                   CSD005 262907
     O**********             33TITBAL B 128 '   ,   ,   , 0 .   CR'                    CSD005 262907
     O                         TITNAR    47                                                   262907
     O                                   53 'TOTAL'                                           262907
     O                       30TITBDR B  79 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31TITBDR B  79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32TITBDR B  79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33TITBDR B  79 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30TITBCR B 104 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31TITBCR B 104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32TITBCR B 104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33TITBCR B 104 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30TITBAL B 129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31TITBAL B 129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32TITBAL B 129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33TITBAL B 129 '   ,   ,   ,   , 0 .   '                         262907
     O**********      N83               131 'CR'                                     262907 MD054509
     O                 83               131 'CR'                                            MD054509
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OOP9                                           S01408
     O*                                                                   S01408
     O*                                                                   S01290
     O        T  2     L2N40N22                                           S01290
     O       AND       75                                                 S01290
     O       OR        20N40N22                                           S01290
     O       AND       75                                                 S01290
     O                                   24 '========================'    S01290
     O                                   48 '========================'    S01290
     O                                   72 '========================'    S01290
     O                                   96 '========================'    S01290
     O                                  120 '========================'    S01290
     O                                  132 '============'                S01290
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OP10                                           S01408
     O*                                                                   S01408
0615 O*
     O******* TF 1     L3N40N22                                           E15058
     O*******ORF       20N40N22                                           E15058
     O        T  1     L3N40N22                                           E15058
     O       AND       75                                                 S01117
     O       OR        20N40N22                                           E15058
     O       AND       75                                                 S01117
0618 O**********             42          59 'ASSETS'                                   S01290 262907
0618 O**********             43          59 'LIABILITIES'                              S01290 262907
0618 O**********             44          59 'INCOME'                                   S01290 262907
0618 O**********             45          59 'EXPENSE'                                  S01290 262907
0618 O**********             46          59 'CONTINGENT'                               S01290 262907
0618 O**********                         65 'TOTAL'                                           262907
0619 O**********             30SECBDR B  86 '   ,   ,   ,   , 0 '                             262907
0620 O**********             31SECBDR B  86 '  ,   ,   ,   , 0 . '                            262907
0621 O**********             32SECBDR B  86 ' ,   ,   ,   , 0 .  '                            262907
0622 O**********             33SECBDR B  86 '   ,   ,   , 0 .   '                             262907
0623 O*
0624 O**********             30SECBCR B 106 '   ,   ,   ,   , 0 '                             262907
0625 O**********             31SECBCR B 106 '  ,   ,   ,   , 0 . '                            262907
0626 O**********             32SECBCR B 106 ' ,   ,   ,   , 0 .  '                            262907
0627 O**********             33SECBCR B 106 '   ,   ,   , 0 .   '                             262907
0628 O*
0629 O**********             30SECBAL B 128 '   ,   ,   ,   , 0 CR'                           262907
0630 O**********             31SECBAL B 128 '  ,   ,   ,   , 0 . CR'                          262907
0631 O**********             32SECBAL B 128 ' ,   ,   ,   , 0 .  CR'                          262907
0632 O**********             33SECBAL B 128 '   ,   ,   , 0 .   CR'                           262907
     O                       42          47 'ASSETS'                                          262907
     O                       43          47 'LIABILITIES'                                     262907
     O                       44          47 'INCOME'                                          262907
     O                       45          47 'EXPENSE'                                         262907
     O                       46          47 'CONTINGENT'                                      262907
     O                                   53 'TOTAL'                                           262907
     O                       30SECBDR B  79 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31SECBDR B  79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32SECBDR B  79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33SECBDR B  79 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30SECBCR B 104 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31SECBCR B 104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32SECBCR B 104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33SECBCR B 104 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30SECBAL B 129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31SECBAL B 129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32SECBAL B 129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33SECBAL B 129 '   ,   ,   ,   , 0 .   '                         262907
     O                 84               131 'CR'                                              262907
     O/COPY WNCPYSRC,GL0720O010
     O        T  2     L3N40N22
     O       AND       75                                                 S01117
     O       OR        20N40N22                                           E15058
     O       AND       75                                                 S01117
     O*******ORF       20N40N22                                           E15058
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OP11                                           S01408
     O*                                                                   S01408
0618 O**********             42          60 '-------'                                  S01290 262907
0618 O**********             43          60 '------------'                             S01290 262907
0618 O**********             44          60 '-------'                                  S01290 262907
0618 O**********             45          60 '--------'                                 S01290 262907
0618 O**********             46          60 '-----------'                              S01290 262907
0635 O**********                         65 '-----'                                           262907
     O                       42          48 '-------'                                         262907
     O                       43          48 '------------'                                    262907
     O                       44          48 '-------'                                         262907
     O                       45          48 '--------'                                        262907
     O                       46          48 '-----------'                                     262907
     O                                   53 '-----'                                           262907
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OP12                                           S01408
     O*                                                                   S01408
0636 O************                      126 '--------------------'        S01290
0637 O*
     O******* TF 2     L4N40N22                                           E15058
     O*******ORF 2     20N40N22                                           E15058
     O        T  2     L4N40N22                                           E15058
     O       AND       75                                                 S01117
     O       OR  2     20N40N22                                           E15058
     O       AND       75                                                 S01117
0640 O**********                         65 'CURRENCY TOTAL'                                  262907
0641 O**********             30CCYBDR B  86 '   ,   ,   ,   , 0 '                             262907
0642 O**********             31CCYBDR B  86 '  ,   ,   ,   , 0 . '                            262907
0643 O**********             32CCYBDR B  86 ' ,   ,   ,   , 0 .  '                            262907
0644 O**********             33CCYBDR B  86 '   ,   ,   , 0 .   '                             262907
0645 O*
0646 O**********             30CCYBCR B 106 '   ,   ,   ,   , 0 '                             262907
0647 O**********             31CCYBCR B 106 '  ,   ,   ,   , 0 . '                            262907
0648 O**********             32CCYBCR B 106 ' ,   ,   ,   , 0 .  '                            262907
0649 O**********             33CCYBCR B 106 '   ,   ,   , 0 .   '                             262907
0650 O*
0651 O**********             30CCYBAL B 128 '   ,   ,   ,   , 0 CR'                           262907
0652 O**********             31CCYBAL B 128 '  ,   ,   ,   , 0 . CR'                          262907
0653 O**********             32CCYBAL B 128 ' ,   ,   ,   , 0 .  CR'                          262907
0654 O**********             33CCYBAL B 128 '   ,   ,   , 0 .   CR'                           262907
     O                                   53 'CURRENCY TOTAL'                                  262907
     O                       30CCYBDR B  79 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31CCYBDR B  79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32CCYBDR B  79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33CCYBDR B  79 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30CCYBCR B 104 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31CCYBCR B 104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32CCYBCR B 104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33CCYBCR B 104 '   ,   ,   ,   , 0 .   '                         262907
      *                                                                                       262907
     O                       30CCYBAL B 129 '   ,   ,   ,   ,   , 0 '                         262907
     O                       31CCYBAL B 129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                       32CCYBAL B 129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                       33CCYBAL B 129 '   ,   ,   ,   , 0 .   '                         262907
     O                 85               131 'CR'                                              262907
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OP13                                           S01408
     O*                                                                   S01408
     O        T  2     L4N40N22                                           S01290
     O       AND       75                                                 S01290
     O       OR  2     20N40N22                                           S01290
     O       AND       75                                                 S01290
     O                                   65 '--------------'              S01290
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL0720OP14                                           S01408
     O*                                                                   S01408
0655 O********T**      LR 40                                              S01117
0655 O        T        LR 40 75                                           S01117
0656 O                                   62 'PRINT TERMINATED, '
0657 O                                   80 'DATABASE IN ERROR'
     OGL0720P1T  2     75 U2 20                                           S01117
     O       AND       49                                                 S01117
     O       OR  2     75 U2 LR                                           S01117
     O       AND       49                                                 S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCHNO    77                               S01117
     O                                   81 ' ***'                        S01117
     OGL0720P1T  2     75 U1 20                                           S01117
     O       OR  2     75 U1 LR                                           S01117
     O                                   62 '*** END OF REPORT FOR'       S01117
     O                                   79 'BANK AND COMPANY'            S01117
     O                                   89 'LEVEL ***'                   S01117
     OGL0720P1T 22     75 LRNU1                                           S01117
     O       AND      NU2                                                 S01117
     O       OR        75 LR U2                                           S01117
     O       AND      N49                                                 S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0471 OGL0720P1E  203           NODTL                                      S01117
0473 O                                   24 'REFERENCE GL0720P1'          S01117
0474 O                         BJURPT    89                               S01117
0475 O                                  104 'DATE'                        S01117
0476 O                         RUNA     113                               S01117
0477 O                                  122 'PAGE'                        S01117
0478 O                         PAGE  Z  127                               S01117
0479 O        E  1             NODTL                                      S01117
0493 O                                   74 'GENERAL LEDGER BALANCES'     S01117
     O***********      U2 49             83 'BRANCH'                S01117066997
0492 O***********      U2 49   BRNCH     87                         S01117066997
     O***********      U2 49             88 '-'                     S01117066997
     O***********      U2 49   A8BRNM   118                         S01117066997
     O                 U2 49             84 'BRANCH'                      066997
0492 O                 U2 49   BRNCH     88                               066997
     O                 U2 49             89 '-'                           066997
     O                 U2 49   A8BRNM   119                               066997
0649 O                 U1                84 'COMPANY'                     S01117
     O                 U1      BRNCH     88                               S01117
     O                 U1                89 '-'                           S01117
     O                 U1N39   APCMNM   119                               S01117
0488 O                 U1 39            112 '*** UNKNOWN COMPANY ***'     S01117
     O        E                NODTL                                      S01117
0498 O                                   74 '-----------------------'     S01117
     O        E   26           NODTL                                      S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
     O        E   48           NODTL                                      S01117
     O                 49 U2             69 '*** END OF REPORT FOR'       S01117
     O                 49 U2             76 'BRANCH'                      S01117
     O                 49 U2   BRNCH     80                               S01117
     O                 49 U2             84 '***'                         S01117
     O                 U1                62 '*** END OF REPORT FOR'       S01117
     O                 U1                79 'BANK AND COMPANY'            S01117
     O                 U1                89 'LEVEL ***'                   S01117
     O                N49                76 '*** END OF REPORT ***'       S01117
     O*****   T  203      LR 22                                           S01117
     O*GL0720AUT**203      LR 22                                    S01117LN0529
     O/COPY WNCPYSRC,GL0720O009
     OGL0720AUT  203      LR                                              LN0529
     O*****                              22 'REFERENCE GL0720'            S01117
     O**********                         24 'REFERENCE GL0720AU'    S01117LN0529
0660 O***********              TITL      89                               S01194
     O**********               BJURPT    89                         S01194LN0529
0661 O**********                        104 'DATE'                        LN0529
0662 O**********               RUNA     113                               LN0529
0663 O**********                        122 'PAGE'                        LN0529
0664 O***********              PAGE  Z  127                               S01117
0664 O**********               PAGE1 Z  127                         S01117LN0529
0665 O********T* 1        LR 22                                           LN0529
0666 O**********                         65 'GENERAL LEDGER BALANCES'     LN0529
     O**********                         80 'RUN CONTROLS'          S01117LN0529
0668 O********T* 2        LR 22                                           LN0529
0669 O**********                         65 '-----------------------'     LN0529
0668 O********T*  20      LR 22                                           LN0529
0669 O********                           76 '* NO DETAILS TO REPORT'E10014LN0529
     O**********                         55 '***'                   E10014LN0529
0669 O**********                         76 'NO DETAILS TO REPORT'  E10014LN0529
     O**********                         80 '***'                   E10014LN0529
0658 O********T**203      LRN40                                           S01117
0658 O********T**203      LR                                        S01117LN0529
0659 O***********                        22 'REFERENCE GL0720'            S01117
0659 O                                   24 'REFERENCE GL0720AU'          S01117
0660 O***********              TITL      89                               S01194
     O                         BJURPT    89                               S01194
0661 O                                  104 'DATE'
0662 O                         RUNA     113
0663 O                                  122 'PAGE'
0664 O***********              PAGE  Z  127                               S01117
0664 O                         PAGE1 Z  127                               S01117
0665 O********T**1        LRN40                                           S01117
0665 O        T  1        LR                                              S01117
0666 O                                   65 'GENERAL LEDGER BALANCES'
0667 O***********                        87 ' - FILE CONTROL TOTALS'      S01117
0667 O                                   80 'RUN CONTROLS'                S01117
0665 O********T**1        LRN40                                           S01117
0665 O        T  1        LR                                              S01117
0669 O                                   65 '-----------------------'
0670 O***********                        87 '-----------------------'
0671 O        T  2        LRN40
0672 O***********                        52 'INPUT'                       S01117
0672 O                 48                52 'INPUT'                       S01117
0672 O                NU1NU2             52 'INPUT'                       S01117
0672 O                N49                52 'INPUT'                       S01117
0673 O                                   85 'CALCULATED'
0674 O        T  2        LRN40
0675 O                                   28 'NO. OF RECORDS -'
0676 O***********              NORE  3   52                               S01117
0676 O                 48      NORE  3   52                               S01117
0676 O                NU1NU2   NORE  3   52                               S01117
0676 O                N49      NORE  3   52                               S01117
0677 O                         NRECS 3   85
0678 O                       55         115 '*** OUT OF BALANCE ***'
0679 O        T  2        LRN40
0680 O                                   28 'DEBIT TOTALS   -'
0681 O***********              DHWN  4   49                               S01117
0682 O***********              DHDC      52                               S01117
0681 O                 48      DHWN  4   49                               S01117
0681 O                NU1NU2   DHWN  4   49                               S01117
0681 O                N49      DHWN  4   49                               S01117
0682 O                 48      DHDC      52                               S01117
0682 O                NU1NU2   DHDC      52                               S01117
0682 O                N49      DHDC      52                               S01117
0683 O                         DHASHI4   82
0684 O                         DHASHD    85
0685 O                       56         115 '*** OUT OF BALANCE ***'
0686 O        T  2        LRN40
0687 O                                   28 'CREDIT TOTALS  -'
0688 O***********              CHWN  4   49                               S01117
0689 O***********              CHDC      52                               S01117
0688 O                 48      CHWN  4   49                               S01117
0688 O                NU1NU2   CHWN  4   49                               S01117
0688 O                N49      CHWN  4   49                               S01117
0689 O                 48      CHDC      52                               S01117
0689 O                NU1NU2   CHDC      52                               S01117
0689 O                N49      CHDC      52                               S01117
0690 O                         CHASHI4   82
0691 O                         CHASHD    85
0692 O                       57         115 '*** OUT OF BALANCE ***'
0677 O        T 3      LR U7 U8                                           S01194
0376 O                                   42 '*** REFERENCE'               S01194
0377 O                         DBPGM     53                               S01194
0378 O                                   71 '-DATABASE ERROR AT'          S01194
0379 O                         DBASE     75                               S01194
0682 O        T 1      LR U7 U8                                           S01194
0381 O                                   37 'FILE NAME'                   S01194
0382 O                         DBFILE    48                               S01194
0383 O                                   52 'KEY'                         S01194
0384 O                         DBKEY     82                               S01194
0693 O********T*3      LRN40                                              S01117
0694 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,GLH00364
