0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Balances Report by Account Code')             *
0001 H***********                                                         S01194
0002 F********************************************************************
     F*                                                                  *
     F*  Midas - GENERAL LEDGER MODULE
0004 F*                                                                  *
0005 F*  GL0750 - GENERAL LEDGER BALANCE REPORT 4                        *
0006 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *
      *  Last Amend No. 262907             Date 03Aug12               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CEU011             Date 11Mar98               *
     F*                 S01408             DATE 25NOV96               *
     F*                 067360             DATE 22FEB94               *
     F*                 050005             DATE 28MAY93               *
0010 F*                 E42846             DATE 16JUL92               *
     F*                 E33282             DATE 08JUL92               *
     F*                 BHF808             DATE 25APR91                  *
     F*                    S01314            DATE 06MAR91                *
     F*                    BHF373            DATE 21SEP90                *
     F*                    BHF683            DATE 20SEP90                *
     F*                    LN0529            DATE 13AUG90                *
     F*                    S01290            DATE 09JUL90                *
     F*                    E22369            DATE 06JUN90                *
     F*                    S01117            DATE 15/03/89               *
     F*                    S01194            DATE 15/03/89               *
0009 F*                    E16274            DATE 09/01/89               *
0009 F*                    E15057            DATE 04/10/88               *
0009 F*                    E11615            DATE 21/09/87               *
0009 F*                    E11617            DATE 21/09/87               *
0009 F*                    E10550            DATE 02/04/87               *
     F*                                                                  *
     F********************************************************************
      *  262907 - FOOB GLC0730 and GLC0750 due to truncated balance   *
      *         - Increase the length of the LDBL from 15,0 to 18,0 to*
      *           make sure that balance will not be truncated.       *
      *         - Reformat the printer file to accommodate the length *
      *           of the balance.                                     *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *          (recompiled)                                            *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CEU011 - EMU Position/Risk Reproting.                        *
     F*  S01408 - Addition of Core Hook GL0750OOP6                       *
     F*           Addition of Core Hook GL0750OOP5                       *
     F*           Addition of Core Hook GL0750OOP4                       *
     F*           Addition of Core Hook GL0750OOP3                       *
     F*           Addition of Core Hook GL0750OOP2                       *
     F*           Addition of Core Hook GL0750OOP1                       *
     F*     067360 - Output correct Branch No for each individual spool  *
     F*              file, instead of 'ALL',  to ensure that all spool   *
     F*              files for a multibranched report are distributed by *
     F*              RCF, not just the spool file for the last entity.   *
     F*  050005 - 'UNKNOWN COMPANY' being printed                     *
     F*     E42846 -   ADD ADDITIONAL INFO FOR RUN TYPE                  *
     F*  E33282 - Currency conversion now correctly uses M/D indicator   *
     F*           to determine  whether to multiply or divide            *
     F*     BHF808 -   SET UP M/D FOR REQUESTED CURRENCY                 *
     F*     S01314 -   CHANGES FOR PTF INCORPORATION (MERGING CHANGES    *S01314
     F*                E22369 AND S01117)                                *S01314
     F*     BHF373  -  CORRECT M/D INDICATOR                             *
     F*     BHF683  -  MDIN NOW M OR D NOT 1 OR 0                        *
     F*     LN0529  -  PROGRAM DID NOT PRODUCE ANY DETAILS WHEN          *
     F*                'ALL' COMPANIES REQUESTED.                        *
     F*     S01290  -  MIS GL REPORTING CHANGES                          *
     F*     E22369 -   PROGRAM HAS BEEN MODIFIED ACCUMULATE REPORT       *E22369
     F*                TOTALS WITHIN  CURRENCY AND CONVERT TO HEAD       *E22369
     F*                OFFICE CURRENCY ON CONTROL BREAK. (L1).           *E22369
     F*     S01117  -  MULTIBRANCHING                                    *
     F*     S01194  -  NEW STANDING DATA                                 *
     F*     E16274  -  PRINT HEADINGS AND 'NO DETAILS TO REPORT' IF      *
     F*                NO DETAIL RECORD                                  *
     F*     E15057  -  NUMBER OF RECORDS IS REPORTED INCORRECTLY.        *
     F*     E11615  -  HASH TOTALS ARE REPORTED INCORRECTLY              *
     F*     E11617  -  NO OF RECORDS INPUT IS NOT BEING REPORTED IN      *
     F*             -  FILE CONTROLS                                     *
     F*     E10550  -  LEVEL BREAK INDICATOR HAS BEEN SET OFF WHEN       *
     F*                TRAILER IS READ TO STOP THE LAST DETAIL RECORD    *
     F*                BEING REPEATED BEFORE PRINTING THE REPORT TOTAL   *
     F*                AS THIS CAUSES AN INCORRECT REPORT TOTAL.         *
     F*                                                                  *
     F*****************************************************************
0011 F*
0012 FGLEXHH  IP  E                    DISK
     F***SGLEX** IS  F     128            DISK                                                CGL029
     F***SGLEX** IS  F     148            DISK                                         CGL029 262907
     FSGLEX   IS  F     150            DISK                                                   262907
     FGLEXZY  IS  E                    DISK
0013 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0014 F*ABCHN**IF* F      96 12AI     2 DISK                               S01194
     FSDCURRL0IF  E           K        DISK                               S01194
0015 F*PRINT* O   F     132     OF     PRINTER                            S01117
0015 F*L0750P1O** F     132     OF     PRINTER                            S01117
0015 FGL0750P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0015 FGL0750AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F/COPY WNCPYSRC,GL0750F001
0016 F*
0017 F*    FUNCTION OF INDICATORS.
0018 F* ID F  C  H  L
0019 F* 01            SGLEX - HEADER
0020 F* 02                  - LIVE RECORD.
0021 F* 03                  - TRAILER
0022 F**04*******     TABCHN - INSTALLATION CONTROL DATA RECORD 1.        S01194
0023 F**05*******     TABLE - NEXT HEADER RECORD.                         S01194
0024 F**06*******           - CATCHALL FOR DELETED RECORDS.               S01194
0025 F**07*******           - COMPANIES RECORD                            S01194
     F**08*******           - I.C.D RECORD 1                              S01194
     F**09*******           - I.C.D RECORD 2                              S01194
     F**10*******           - CURRENCIES RECORD                           S01194
     F**11*******           - CATCHALL                                    S01194
     F**12*******           - CURRENCIES RECORD                           S01194
0026 F*    26         LEDGER BALANCE POSITIVE - DEBIT.
0027 F*    27         LEDGER BALANCE NEGATIVE - CREDIT.
0028 F*       21      ACCOUNT SECTION 1 - ASSETS.
0029 F*       22      ACCOUNT SECTION 2 - LIABILITIES.
0030 F*       23      ACCOUNT SECTION 3 - INCOME.
0031 F*       24      ACCOUNT SECTION 4 - EXPENSE.
0032 F*       19      ACCOUNT SECTION 5 - CONTINGENT.
0033 F*       25      REQUIRED CURRENCY EXISTS ON CURRENCIES FILE.
0034 F*       28      CHANGE IN COMPANY CODE OR BRANCH NUMBER.
0035 F*       29      LEDGER BALANCE ZERO
0036 F********30*     CHAIN TO TABCHN FILE UNSUCCESSFUL.                  S01194
0037 F*       31      COMPANY RECORD PRESENT
     F*       32      MULTIBRANCH INDICATOR = 'Y'                         S01117
     F*       33      CONSOLIDATED REPORT REQUESTED                       S01117
     F*       34      REPORT ON ALL BRANCHES REQUESTED                    S01117
     F*       38      BRANCH CODE NOT ON BRANCH CODE FILE                 S01117
0038 F*       40      NEW PAGE INDICATOR.
0039 F*       41-42   OUT OF BALANCE
0040 F*       43      SETON IF NLR.02
      *       44      Position/Risk Enquiries & Reports feature indicator CEU011
0041 F*       45      OUTPUT ACCOUNT CODE BALANCE
     F*       48      DETAIL RECORD PRESENT                               E16274
0042 F*       51      EXCPT OUTPUT - SECTION TOTALS
0043 F*       52                   - ACCOUNT SECTION TOTALS
0044 F*       53                   - REPORT TOTALS
     F*       55      RUN TYPE AFTER FINAL POST                           E42846
     F*       56      RUN TYPE AFTER DAILY POST                           E42846
     F*       57      RUN TYPE AFTER SPOT REVALS                          E42846
     F*       58      RUN TYPE AFTER B/CCY TFR                            E42846
     F*       59      RUN TYPE AFTER F/CCY TFR                            E42846
0045 F*       60      REQUIRED CURRENCY HAS 0 DECIMAL PLACES.
0046 F*       61      REQUIRED CURRENCY HAS 1 DECIMAL PLACE.
0047 F*       62      REQUIRED CURRENCY HAS 2 DECIMAL PLACES.
0048 F*       63      REQUIRED CURRENCY HAS 3 DECIMAL PLACES.
0049 F*       70      SVCDP EQUALS CDP.
0050 F*       71      SVCDP IS LESS THAN CDP.
0051 F*       72      SVCDP IS GREATER THAN CDP.
     F*       75      PRINTER FILE GL0750P1 OPEN                          S01117
0052 F*       81      CONVERSION FACTOR NEEDS ADJUSTMENT BY FACTOR OF 10.
0053 F*       82      CONVERSION FACTOR NEEDS ADJUSTMENT BY FACTOR OF 100.
0054 F*       83      CONVERSION FACTOR NEEDS ADJUSTMENT BY FACTOR OF 1000
0055 F*       84      RATE POINT REALLIGNMENT INDS.
0056 F*       85      RATE POINT REALLIGNMENT INDS.
0057 F*       87      LEDGER BALANCE RATE IS A DIVIDE
0058 F*       88      RATE OF CURRENCY TO BE CONVERTED TO IS A DIVIDE
0059 F*          U1   SORT IN COMPANY CODE ORDER.
0060 F*          U2   SORT IN BRANCH NUMBER ORDER.
0061 F*          U3   REPORT PRINTED IN LOCAL CURRENCY.
0062 F*          U4   REPORT PRINTED IN BASE CURRENCY.
0063 F*          U8   CONTROL TOTALS DISAGREE
     F*          U7U8 DATABASE ERROR                                      S01194
0064 F**************L1ACCOUNT CODE CONTROL LEVEL BREAK                   *E22369
0066 F**************L2TITLE ACCOUNT CODE CONTROL LEVEL BREAK.            *E22369
0068 F**************L3ACCOUNT SECTION CODE CONTROL LEVEL BREAK.          *E22369
0064 F*             L1CONTROL BREAK ON CURRENCY CODE.                    *E22369
0064 F*             L2ACCOUNT CODE CONTROL LEVEL BREAK                   *E22369
0066 F*             L3TITLE ACCOUNT CODE CONTROL LEVEL BREAK.            *E22369
0068 F*             L4ACCOUNT SECTION CODE CONTROL LEVEL BREAK.          *E22369
0069 F*             LRSGLEX - LAST RECORD INDICATOR.
0070 F*             OFOVERFLOW INDICATOR.
     E                    CPY@    1   1 80
0071 E                    CUR       150  3
     E/COPY WNCPYSRC,GL0750E001
     E                    CONV      150 15 8
     E/COPY WNCPYSRC,GL0750E002
0073 E*********           MD        150  1 0                              BHF373
0073 E                    MD        150  1                                BHF373
     E                    INC       150  1                                CEU011
      *                                                                   CEU011
      ** Array to store 'In' ccy indicator                                CEU011
      *                                                                   CEU011
0074 I**
0075 I*    HEADER RECORD
0076 IGLEXHHF     01
     I*
0077 I*    G/L BALANCE EXTRACT DETAIL RECORD
     I*
0079 ISGLEX   NS  02
     I                                        1   1 RECI
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I****************************************8  10 CCYD                  E22369
     I***************************************11  140ACOD  L1              E22369
     I                                        8  10 CCYD  L1              E22369
     I**********                             11  140ACOD  L2                           E22369 CGL029
     I                                       11  140ACODQQ                                    CGL029
     I                                       15  160ACSQ
     I                                       17  170RIND
     I***********                            18  200BRNO                  S01117
     I                                       18  20 BRNO                  S01117
     I*****                                  21  22 CMPY                  S01117
     I*****                                  23  42 CNAM                  S01117
     I*****                                  43  52 CTOW                  S01117
     I*****                                  53  77 ANAM                  S01117
     I*****                                  78  780ASEC  L3              S01117
     I*****                                  79  820TACD  L2              S01117
     I*****                                  83 107 TANM                  S01117
     I*****                               P 108 1150LDBL        262729    S01117
     I*****                                 116 127 ZZ0116                S01117
     I***********                            21  23 CMPY                  S01117
     I                                       21  23 CMPYM                 S01117
     I                                       24  43 CNAM                  S01117
     I                                       44  53 CTOW                  S01117
     I                                       54  78 ANAM                  S01117
     I***************************************79  790ASEC  L3        S01117S01314
     I***************************************80  830TACD  L2        S01117S01314
     I                                       79  790ASEC  L4              S01314
     I**********                             80  830TACD  L3                           S01314 CGL029
     I                                       80  830TACDQQ                                    CGL029
     I                                       84 108 TANM                  S01117
     I**********                          P 109 1160LDBL        262729                 S01117 262907
     I**********                            117 127 ZZ0117                             S01117 262907
     I**********                            128 128 DCIN                               S01117 262907
     I**********                            129 1380ACOD  L2                           CGL029 262907
     I**********                            139 1480TACD  L3                           CGL029 262907
     I                                    P 109 1180LDBL        262729                        262907
     I                                      119 129 ZZ0117                                    262907
     I                                      130 130 DCIN                                      262907
     I                                      131 1400ACOD  L2                                  262907
     I                                      141 1500TACD  L3                                  262907
0095 I**
0096 I**   LOOK-AHEAD FIELDS.
0097 I*       NS  **
0097 I        NS  **
0098 I                                        1   1 RECID
0099 I***********                            18  200BNCH                  S01117
0099 I                                       18  20 BNCH                  S01117
0100 I*****                                  21  22 COMP                  S01117
0100 I                                       21  23 COMP                  S01117
0101 I*    TRAILER
0102 IGLEXZYF     03
0108 I*****TABLE*FILE - INSTALLATION CONTROL RECORD 1                     S01194
0109 I***********                                                         S01194
0110 I*ABCHN**NS* 08   2 C0   3 C1  12 C1                                 S01194
0111 I*******AND*     13 C0                                               S01194
0112 I***********                             1   1 RECI                  S01194
0113 I***********                             2   30RECT                  S01194
0114 I***********                            12  13 RCDE                  S01194
0115 I***********                            14  66 TITL                  S01194
0116 I***********                            67  67 DATF                  S01194
0117 I***********                            68  700DFBR                  S01194
0118 I***********                            74  74 MODI1                 S01194
0119 I***********                            75  75 MODI2                 S01194
0120 I***********                            76  76 MODI3                 S01194
0121 I***********                         P  77  790RUND                  S01194
0122 I***********                            80  86 RUNA                  S01194
0123 I***********                            87  870SFLG                  S01194
0124 I***********                         P  90  920LCD                   S01194
0125 I***********                            93  93 CHTP                  S01194
0126 I***********                         P  94  960TNLU                  S01194
0127 I***********                             1  96 LOT                   S01194
0128 I*****TABLE*FILE - INSTALLATION CONTROL RECORD 2                     S01194
0129 I***********                                                         S01194
0130 I********NS* 09   1 CD   2 C0   3 C1                                 S01194
0131 I*******AND*     12 C1  13 C1                                        S01194
0132 I***********                             1   1 RECI                  S01194
0133 I***********                             2   30RECT                  S01194
0134 I***********                            12  13 RCDE                  S01194
0135 I***********                            14  16 BCCY                  S01194
0136 I***********                            17  19 BCYL                  S01194
0137 I***********                            20  22 HOCY                  S01194
0138 I***********                            23  280HEAD                  S01194
0139 I***********                            29  340APDA                  S01194
0140 I***********                            35  35 APFQ                  S01194
0141 I***********                         P  36  380LOGS                  S01194
0142 I***********                            39  40 CUZR                  S01194
0143 I***********                         P  41  430DNWD                  S01194
0144 I***********                            44  460BVLP                  S01194
0145 I***********                            47  49 LOCY                  S01194
0146 I***********                            50  510FDAY                  S01194
0147 I***********                            86  86 ISAV                  S01194
0148 I***********                         P  87  890LLOG                  S01194
0149 I***********                         P  90  920LCD                   S01194
0150 I***********                            93  93 CHTP                  S01194
0151 I***********                         P  94  960TNLU                  S01194
0152 I***********                             1  96 LOT                   S01194
0153 I*****TABLE*FILE - COMPANY CODES                                     S01194
0154 I***********                                                         S01194
0155 I********NS* 07   1 CD   2 C1   3 C1                                 S01194
0156 I***********                             1   1 RECI                  S01194
0157 I***********                             2   30RECT                  S01194
0158 I***********                            12  13 CMPY                  S01194
0159 I***********                            14  43 CMNM                  S01194
0160 I***********                         P  90  920LCD                   S01194
0161 I***********                            93  93 CHTP                  S01194
0162 I***********                         P  94  960TNLU                  S01194
0163 I***********                             1  96 LOT                   S01194
0164 I***********                                                         S01194
0165 I*****TABLE*FILE - CURRENCIES.                                       S01194
0166 I********NS* 10   1 CD   2 C2   3 C0                                 S01194
0167 I*******AND*     13 C1                                               S01194
0168 I***********                             1   1 RECI                  S01194
0169 I***********                             2   30RECT                  S01194
0170 I***********                            10  12 CCY                   S01194
0171 I***********                            13  130SREC                  S01194
     I***********                         P  28  348SPOTIN                S01194
0173 I***********                            38  380CDP                   S01194
0174 I***********                            86  860MDIN                  S01194
0175 I***********                             1  96 LOT                   S01194
0176 I***********                                                         S01194
0177 I*****CATCHALL FOR DELETED RECORDS.                                  S01194
0178 I********NS* 11                                                      S01194
0179 I***********                                                         S01194
0180 I*****TABLE*FILE - CURRENCIES                                        S01194
0181 I*ABLE***NS* 12   1 CD   2 C2   3 C0                                 S01194
0182 I*******AND*     13 C1                                               S01194
0183 I***********                             1   1 RECI                  S01194
0184 I***********                             2   30RECT                  S01194
0185 I***********                            10  12 CCY                   S01194
0186 I***********                            13  130SREC                  S01194
     I***********                         P  28  348SPOTIN                S01194
0188 I***********                            38  380CDP                   S01194
0189 I***********                            86  860MDIN            87    S01194
0190 I***********                             1  96 LOT                   S01194
0191 I***********                                                         S01194
0192 I*****NEXT*HEADER RECORD.                                            S01194
0193 I********NS* 05   1 CH                                               S01194
0194 I***********                                                         S01194
0195 I*****CATCHALL FOR DELETED RECORDS.                                  S01194
0196 I********NS* 06                                                      S01194
     I*     LOCAL DATA AREA                                               S01194
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     ILDA        UDS                            256                       S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  90 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  90 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0132 I**                                                                  S01194
     I** DATA AREA RUNDAT                                                 S01194
     I**                                                                  S01194
     IRUNDT       DS                             13                       S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
     I**                                                                  S01194
     I**   DEFINE EXTERNAL DS OVER DUMMY PHYSICAL FILES                   S01194
     I**                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*    BANK DETAILS                                                   S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I*    CURRENCY CODE                                                  S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I*    BRANCH CODE DETAILS                                            S01194
     I*                                                                   S01194
     ISDCOMP    E DSSDCOMPPD                                              S01194
     I*    COMPANY CODE DETAILS                                           S01194
      *                                                                   CEU011
     ISCSARD    E DSSCSARDPD                                              CEU011
      ** Switchable Features File                                         CEU011
      *                                                                   CEU011
     ISDGELR    E DSSDGELRPD                                              CEU011
      ** General ledger details                                           CEU011
      *                                                                   CEU011
0115 I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     C/EJECT                                                              S01117
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           RUNTYP  1                       E42846
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C/COPY WNCPYSRC,GL0750C010
     C**                                                                  E42846
     C** WRITE THE TYPE OF RUN ON THE HEADING                             E42846
     C**                                                                  E42846
     C           RUNTYP    IFEQ '1'                                       E42846
     C                     SETON                     55                   E42846
     C                     ELSE                                           E42846
     C           RUNTYP    IFEQ '2'                                       E42846
     C                     SETON                     56                   E42846
     C                     ELSE                                           E42846
     C           RUNTYP    IFEQ '3'                                       E42846
     C                     SETON                     57                   E42846
     C                     ELSE                                           E42846
     C           RUNTYP    IFEQ '4'                                       E42846
     C                     SETON                     58                   E42846
     C                     ELSE                                           E42846
     C                     SETON                     59                   E42846
     C/COPY WNCPYSRC,GL0750C011
     C                     END                                            E42846
     C                     END                                            E42846
     C                     END                                            E42846
     C                     END                                            E42846
     C**                                                                  E42846
     C**                                                                  S01117
0197 C**
0198 C*    PERFORM FIRST CYCLE OPERATIONS.
0199 C  N01                GOTO DOOBRY
     C                     MOVEACPY@      BIS@   80
     C*                                                                   S01194
     C**   CHECK MULTIBRANCHING INDICATOR AND TYPE OF REPORT REQUESTED    S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C                     IN   RUNDT                                     S01194
     C*                                                                   S01194
     C                     SETOF                     323334               S01194
     C*                                                                   S01194
     C           MBIN      IFEQ 'Y'                        B1             S01194
     C                     SETON                     32                   S01194
     C           BRNCH     IFEQ 'ALL'                      B2             S01194
     C           *INU2     ANDEQ'1'                                       S01194
     C                     SETON                     34                   S01194
     C                     END                             E2             S01194
     C                     END                             E1             S01194
0200 C*
0201 C*    ZEROISE CREDIT/DEBIT/SECTION TOTAL FIELD.
0202 C                     Z-ADD0         ZERO4   40
     C**                                                                  S01117
     C**  CHECK IF CONSOLIDATED REPORT REQUESTED                          S01117
     C           *INU1     IFEQ '0'                                       S01117
     C           *INU2     ANDEQ'0'                                       S01117
     C                     SETON                     33                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C*    SETON INDICATOR 28 FOR LEVEL BREAK ON FIRST RECORD READ ON     S01117
     C*    COMPANY AND BRANCH REPORTS                                     S01117
     C*                                                                   S01117
     C                     MOVE '1'       *IN28                           S01117
     C***                                                                 S01117
     C                     END                                            S01117
     C***                                                                 S01117
0203 C*
     C**                                                                  S01194
     C**  INITIALIZE PROGRAM REFERENCE                                    S01194
     C                     MOVEL'GL0750  'DBPGM  10                       S01194
     C*                                                                   S01194
0204 C*****CHAIN*TO INSTALLATION CONTROL DATA RECORDS.                    S01194
0205 C***********          MOVEL'01'      TABKEY 12                       S01194
0206 C***********          MOVE '10'      TABKEY                          S01194
0207 C***********          EXSR QABCHN                                    S01194
0208 C***********          MOVE '11'      TABKEY                          S01194
0209 C***********          EXSR QABCHN                                    S01194
     C**                                                                  S01194
     C**  CALL ACCESS PROGRAM TO READ BANK DETAIL FILE                    S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'001'     DBASE            * DBERR 001 *  S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     MOVEL@OPTN     DBOPTN  7                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CEU011
      ** Retrieve general ledger details                                  CEU011
      *                                                                   CEU011
     C**********           CALL 'AOGELRR0'                                CEU011              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*FIRST ' @OPTN                           CEU011
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU011              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF   '                                 CEU011
     C                     MOVEL'SDGELRPD'DBFILE           ************   CEU011
     C                     MOVEL'002'     DBASE            * DBERR 002*   CEU011
     C                     MOVEL'*FIRST'  DBKEY            ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** Check if Position/Risk Enquiries & Reports feature (CEU011)      CEU011
      ** is on.                                                           CEU011
      *                                                                   CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*VERIFY' @OPTN                           CEU011
     C                     PARM 'CEU011'  @KEY    6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFEQ *BLANKS                                   CEU011
     C                     MOVE 'Y'       CEU011  1                       CEU011
     C                     MOVE *ON       *IN44                           CEU011
     C                     ELSE                                           CEU011
     C                     MOVE 'N'       CEU011                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF  '                                  CEU011
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU011
     C                     MOVEL'004'     DBASE            * DBERR 004*   CEU011
     C                     MOVEL'CEU011  'DBKEY            ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
0210 C*
0211 C*    DETERMINE SPOT RATE FOR REQUIRED CURRENCY.
0212 C***********          MOVEL'20'      TABKEY                          S01194
0213 C***********          MOVE '1'       CCYWRK  4                       S01194
0214 C***********          MOVELHOCY      CCYWRK           HEAD OFFICE    S01194
0215 C***U3******          MOVELLOCY      CCYWRK           LOCAL          S01194
0216 C***U4******          MOVELBCCY      CCYWRK           BASE           S01194
0214 C                     MOVELBJHOCY    CCYWRK  3        HEAD OFFICE    S01194
0215 C   U3                MOVELBJLCCY    CCYWRK           LOCAL          S01194
0216 C   U4                MOVELBJCYCD    CCYWRK           BASE           S01194
     C/COPY WNCPYSRC,GL0750C001
0217 C***********          MOVE CCYWRK    TABKEY                          S01194
0218 C***********          EXSR QABCHN                                    S01194
     C**                                                                  S01194
     C**  CALL ACCESS PROGRAM TO READ CURRENCY FILE                       S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYWRK    @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'003'     DBASE            * DBERR 003 *  S01194
     C                     MOVEL'SDCURRPD'DBFILE                          S01194
     C                     MOVELCCYWRK    DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0219 C*
0220 C*    CHECK NO. OF DECIMAL PLACES FOR REQUIRED CURRENCY.
0221 C***********CDP       COMP 1                      6061               S01194
0222 C***********CDP       COMP 2                    63  62               S01194
0221 C           A6NBDP    COMP 1                      6061               S01194
0222 C           A6NBDP    COMP 2                    63  62               S01194
0223 C* SETUP KEY FOR ACCESSING COMPANIES FILE
0224 C***U1******          MOVEL'11'      TABKEY                          S01194
0225 C***U1******          MOVE '        'TABKEY                          S01194
0226 C*
0227 C*    SAVE SPOT RATE AND NUMBER OF DECIMAL PLACES.
     C***********          MOVE SPOTIN    SVSPOT 138                      S01194
0229 C***********          MOVE CDP       SVCDP   10                      S01194
0230 C***********MDIN      COMP 0                        88               S01194
     C                     MOVE A6SPRT    SVSPOT 138                      S01194
0229 C                     MOVE A6NBDP    SVCDP   10                      S01194
0230 C********   A6MDIN    COMP '0'                      88         S01194BHF683
0230 C           A6MDIN    COMP 'D'                      88               BHF683
0230 C********   A6MDIN    COMP ' '                      87         S01314BHF808
0231 C*
0232 C*    SET LOWER LIMITS AND READ STABLE FILE - CURRENCIES.
0233 C***********          MOVE '   1'    TABK2  12                       S01194
0234 C***********          MOVEL'20'      TABK2                           S01194
0235 C***********TABK2     SETLLTABLE                                     S01194
     C                     MOVE *BLANKS   CCYWRK                          S01194
     C           CCYWRK    SETLLSDCURRL0                                  S01194
0236 C           RDCCY     TAG                             ** RDCCY TAG **
0237 C***********          SETOF                     0506                 S01194
0238 C***********          READ TABLE                    20               S01194
0238 C                     READ SDCURRL0                 20               S01194
0239 C***05******                                                         S01194
0240 C*R*20******          GOTO DOOBRY                                    S01194
     C   20                GOTO DOOBRY                                    S01194
0241 C***06******          GOTO RDCCY                                     S01194
     C*
     C* SET UP MULTIPLY/DIVIDE INDICATOR FOR REQUESTED CURRENCY           BHF808
     C*                                                                   BHF808
     C                     SETOF                     87                   BHF808
     C           A6MDIN    IFEQ 'D'                                       BHF808
     C                     SETON                     87                   BHF808
     C                     END                                            BHF808
     C*                                                                   BHF808
     C***********          Z-ADDSPOTIN    SPOT   158                      S01194
     C/COPY WNCPYSRC,GL0750C002
     C                     Z-ADDA6SPRT    SPOT   158                      S01194
     C/COPY WNCPYSRC,GL0750C003
0242 C*
0243 C*    LOAD ARRAYS WITH CURRENCY CODES AND CONVERSION FACTORS.
0244 C           X         ADD  1         X       30
0245 C***********          MOVE CCY       CUR,X                           S01194
0245 C                     MOVE A6CYCD    CUR,X                           S01194
0246 C*
0247 C*    CALCULATE CONVERSION FACTORS.
0248 C   88 87
0249 CORN87N88   SPOT      DIV  SVSPOT    SPOT      H
0250 C   87N88
0251 CORN87 88   SPOT      MULT SVSPOT    SPOT      H
0252 C*
0253 C*    ADJUST CONVERSION FACTOR TO CORRECT NUMBER OF DECIMAL PLACES.
0254 C***********CDP       SUB  SVCDP     CDP        717270               S01194
0255 C***72******          Z-SUBCDP       CDP                             S01194
0256 C***********CDP       COMP 2                    838182               S01194
0254 C           A6NBDP    SUB  SVCDP     A6NBDP     717270               S01194
0255 C   72                Z-SUBA6NBDP    A6NBDP                          S01194
0256 C           A6NBDP    COMP 2                    838182               S01194
0257 C   87 71             SETON                     84
0258 C   87 84             SETOF                     71
0259 C   87 72             SETON                     85
0260 C   87 85             SETOF                     72
0261 C   87 84             SETON                     72
0262 C   87 85             SETON                     71
0263 C                     SETOF                     8485
0264 C   72 81   SPOT      MULT 10        SPOT
0265 C   72 82   SPOT      MULT 100       SPOT
0266 C   72 83   SPOT      MULT 1000      SPOT
0267 C   71 81   SPOT      DIV  10        SPOT      H
0268 C   71 82   SPOT      DIV  100       SPOT      H
0269 C   71 83   SPOT      DIV  1000      SPOT      H
0270 C                     Z-ADDSPOT      CONV,X
0271 C***********          Z-ADDMDIN      MD,X                            S01194
0271 C                     MOVE A6MDIN    MD,X                            S01194
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C                     MOVE A6INCY    INC,X                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
0272 C                     GOTO RDCCY
0273 C           DOOBRY    TAG                             ** DOOBRY TAG *
0274 C**
0275 C*
0276 C*    SET NEW PAGE INDICATORS.
0277 C                     SETOF                     40
     C***03******          SETOF                     28L2           S01117S01314
     C   03                SETOF                     28L3                 S01314
0278 C***28******          SETON                     40                   E10550
     C   28N03             SETON                     40                   E10550
0279 C***01NU1NU2          SETON                     40                   E10550
0280 C*
0281 C*    ZEROISE SECTION TOTALS AFTER LEVEL BREAK.
0282 C***L2****************Z-ADD0         SDTOT  150                      E22369
0283 C***L2****************Z-ADD0         SCTOT  150                      E22369
0284 C***L2****************Z-ADD0         SNTOT  150                      E22369
     C***L3*****           Z-ADD0         SDTOT  150                                   E22369 262907
     C***L3*****           Z-ADD0         SCTOT  150                                   E22369 262907
     C***L3*****           Z-ADD0         SNTOT  150                                   E22369 262907
     C   L3                Z-ADD0         SDTOT  180                                          262907
     C   L3                Z-ADD0         SCTOT  180                                          262907
     C   L3                Z-ADD0         SNTOT  180                                          262907
0285 C*
0286 C*    ZEROISE A/C SECTION TOTALS AFTER LEVEL BREAK.
0287 C***L3****************Z-ADD0         ACDTOT 150                      E22369
0288 C***L3****************Z-ADD0         ACCTOT 150                      E22369
0289 C***L3****************Z-ADD0         ACNTOT 150                      E22369
     C***L4*****           Z-ADD0         ACDTOT 150                                   E22369 262907
     C***L4*****           Z-ADD0         ACCTOT 150                                   E22369 262907
     C***L4*****           Z-ADD0         ACNTOT 150                                   E22369 262907
     C   L4                Z-ADD0         ACDTOT 180                                          262907
     C   L4                Z-ADD0         ACCTOT 180                                          262907
     C   L4                Z-ADD0         ACNTOT 180                                          262907
0313 C*                                                                   S01117
0314 C***********COUNT     ADD  1         COUNT   50                      S01117
0315 C   03                GOTO TRAIL                                     S01117
0316 C  N02                GOTO END                                       S01117
0317 C*                                                                   S01117
0291 C*    DETERMINE COMPANY NAME IF REQUIRED.
0290 C*
0292 C   U1 40             SETOF                     31
0293 C***U1*40***          MOVE CMPY      TABKEY                          S01117
0294 C***U1*40***          EXSR QABCHN                                    S01194
0295 C***07******          SETON                     31    COMPANY FOUND  S01194
     C           *INU1     IFEQ '1'                                       S01194
     C           BRNCH     ANDEQCMPYM                                     S01117
     C           *IN40     ANDEQ'1'                                       S01194
     C                     CALL 'AOCOMPR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CMPYM     @CENB   3                       S01194
     C           SDCOMP    PARM SDCOMP    DSFDY                           S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVE '1'       *IN31                           S01194
     C                     ELSE                                           S01194
     C                     MOVE '0'       *IN31                           S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C*                                                                   S01117
     C* IF U1 AND U2 ARE OFF OPEN PRINTER FILE FOR CONSOLIDATED REPORT    S01117
     C*                                                                   S01117
     C           *INU1     IFEQ '0'                                       S01117
     C           *INU2     ANDEQ'0'                                       S01117
     C           *IN75     ANDEQ'0'                                       S01117
     C                     OPEN GL0750P1                                  S01117
     C*                                                                   S01117
     C* ENSURE REPORT SPOOL FILE RECORDED BY RCF                          S01117
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     SETON                     75                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           *INU1     IFEQ '1'                                       S01117
     C           *INU2     OREQ '1'                                       S01117
     C**                                                                  S01117
     C           *IN28     IFEQ '1'                                       S01117
0394 C*    ZERO TOTALS FOR COMPANY AND BRANCH                             S01117
0395 C                     Z-ADD0         RCTOT                           S01117
0396 C                     Z-ADD0         RDTOT                           S01117
0397 C                     Z-ADD0         RNTOT                           S01117
     C                     CLOSEGL0750P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           *INU2     ANDEQ'1'                                       S01117
     C           BRNCH     OREQ 'ALL'                                     LN0529
     C           *INU1     ANDEQ'1'                                       LN0529
     C           BRNCH     OREQ BRNO                                      S01117
     C           *INU2     ANDEQ'1'                                       S01117
     C           BRNCH     OREQ CMPYM                                     S01117
     C           *INU1     ANDEQ'1'                                       S01117
     C                     SETON                     75                   S01117
     C                     OPEN GL0750P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C*                                                                   S01117
     C* ENSURE REPORT SPOOL FILE RECORDED BY RCF                          S01117
     C************IN34     IFEQ '1'                                 S01117067360
     C                     MOVE BRNO      SENTY                           S01117
     C************         ELSE                                     S01117067360
     C************         MOVE BRNCH     SENTY                     S01117067360
     C************         END                                      S01117067360
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,GL0750C014
     C*                                                                   S01117
     C           *INU2     IFEQ '1'                                       S01117
     C           *IN32     ANDEQ'1'                                       S01117
     C**                                                                  S01194
     C**  CALL ACCESS PROGRAM TO READ BRANCH CODE FILE                    S01194
     C                     MOVE *BLANKS   @DSNB                           S01194
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRNO      @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETOF                     75                   S01117
     C                     MOVEL'005'     DBASE            * DBERR 005 *  S01194
     C                     MOVEL'SDBRCHPD'DBFILE                          S01194
     C                     MOVELBRNO      DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,GL0750C004
     C                     END                                            S01117
     C   U8                GOTO END                                       S01117
     C                     ELSE                                           S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     75                   S01117
     C                     GOTO END                                       S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C           *INU1     IFEQ '1'                                       LN0529
     C           *IN31     ANDNE'1'                                       LN0529
     C                     CALL 'AOCOMPR0'                                LN0529
     C                     PARM *BLANKS   @RTCD   7                       LN0529
     C                     PARM '*KEY   ' @OPTN   7                       LN0529
     C                     PARM CMPYM     @CENB   3                       LN0529
     C           SDCOMP    PARM SDCOMP    DSFDY                           LN0529
     C           @RTCD     IFEQ *BLANKS                                   LN0529
     C                     SETON                     31                   LN0529
     C                     END                                            LN0529
     C                     END                                            LN0529
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**  COUNT NO. OF DETAIL RECORDS PROCESSED                           S01117
     C                     ADD  1         COUNT   50                      S01117
0296 C*
0297 C*    CHECK FOR CHANGE IN COMPANY CODE OR BRANCH NUMBER.
0298 C***U1******COMP      COMP CMPY                 28                   S01117
0298 C   U1      COMP      COMP CMPYM                28                   S01117
0299 C   U2      BNCH      COMP BRNO                 28
0300 C   U1 28
0301 COR U2 28   RECID     COMP 'T'                  2828
0302 C*
0303 C*    CHECK ACCOUNT SECTION CODE.
0304 C*
0305 C***L3****************                                               E22369
     C/COPY WNCPYSRC,GL0750C012
0305 C   L4                                                               E22369
0306 COR 28                SETOF                     2419
0307 C*
0308 C***L3****************                                               E22369
0308 C   L4                                                               E22369
0309 COR 28      ASEC      COMP 2                    232122
0310 C*
0311 C***L3*23*************                                               E22369
0311 C   L4 23                                                            E22369
0312 COR 28 23   ASEC      COMP 4                    192324
     C/COPY WNCPYSRC,GL0750C013
0313 C*
0314 C***********COUNT     ADD  1         COUNT   50                      S01117
0315 C***03******          GOTO TRAIL                                     S01117
0316 C**N02******          GOTO END                                       S01117
     C* SET ON INDICATOR IF THERE ARE DETAILS TO REPORT
     C  N48                SETON                         48               E16274
0317 C*
0318 C*    KEEP HASH TOTAL
0319 C                     MOVE LDBL      ZZAMT
0320 C   27                Z-SUBZZAMT     ZZAMT
0321 C   26                Z-ADDHASHDW    ZZTOTI
0322 C   26                Z-ADDHASHDD    ZZTOTD
0323 C   27                Z-ADDHASHCW    ZZTOTI
0324 C   27                Z-ADDHASHCD    ZZTOTD
0325 C  N29                EXSR GLZADD
0326 C   26                Z-ADDZZTOTI    HASHDW 150
0327 C   26                Z-ADDZZTOTD    HASHDD  30
0328 C   27                Z-ADDZZTOTI    HASHCW 150
0329 C   27                Z-ADDZZTOTD    HASHCD  30
0330 C*
0331 C*    CONVERT BALANCE TO REQUIRED CURRENCY.            REMOVE OLD    E22369
0332 C*********************Z-ADD1         X                 CURRENCY      E22369
0333 C***********CCYD      LOKUPCUR,X                    25 CONV.CODE.    E22369
0334 C***25******MD,X      COMP 0                        87               BHF373
     C***25******MD,X      COMP 'D'                      87         BHF373E22369
0335 C***25*87***LDBL      DIV  CONV,X    LDBLC  150H                     E22369
0336 C***25N87***LDBL      MULT CONV,X    LDBLC     H                     E22369
     C*                                                                   E22369
     C**         INITIALISE TOTALS AT DETAIL TIME CONTROL BREAK.          E22369
     C*                                                                   E22369
     C***L2*****           Z-ADD*ZERO     CRBL   150                                   E22369 262907
     C***L2*****           Z-ADD*ZERO     DRBL   150                                   E22369 262907
     C***L1*****           Z-ADD*ZERO     TMPBLC 150                                   E22369 262907
     C***L1*****           Z-ADD*ZERO     TMPBLD 150                                   E22369 262907
     C   L2                Z-ADD*ZERO     CRBL   180                                          262907
     C   L2                Z-ADD*ZERO     DRBL   180                                          262907
     C   L1                Z-ADD*ZERO     TMPBLC 180                                          262907
     C   L1                Z-ADD*ZERO     TMPBLD 180                                          262907
     C*                                                                   E22369
     C*                                                                   E22369
     C***        ACCUMULATE VALUES BEFORE CURRENCY CONVERSION.            E22369
     C*                                                                   E22369
     C           *IN27     IFEQ '1'                         IF CREDIT.    E22369
     C                     ADD  LDBL      TMPBLC                          E22369
     C                     END                                            E22369
     C*                                                                   E22369
     C           *IN26     IFEQ '1'                         IF DEBIT.     E22369
     C                     ADD  LDBL      TMPBLD                          E22369
     C                     END                                            E22369
     C*                                                                   E22369
0337 C**   PRODUCE BALANCES FOR EACH ACCOUNT COD                          E22369
0338 C***L1****************Z-ADD0         CRBL   150        REMOVE OLD    E22369
0339 C***L1****************Z-ADD0         DRBL   150        INIT. CODE.   E22369
0340 C***27******CRBL      ADD  LDBLC     CRBL                            E22369
0341 C***26******DRBL      ADD  LDBLC     DRBL                            E22369
0342 C*
0343 C*****ACCUMULATE SECTION TOTALS.
0344 C                     GOTO END
0345 C*
0346 C*
0347 C*    C O N T R O L   T O T A L S
0348 C           TRAIL     TAG                             ** TRAIL TAG **
0349 C***********          SETOF                     L1L2                 S01117
0349 C*********************SETOF                     L1L2L3         S01117S01314
     C                     SETOF                     L2L3L4               S01314
     C****                                                                S01117
     C**                                                                  S01117
     C**  SUPPRESS RUN CONTROL CHECK IF MULTIBRANCHING AND A SINGLE       S01117
     C**  BRANCH/COMPANY IS REQUESTED                                     S01117
     C           *IN32     IFEQ '0'                                       S01117
     C           *IN34     OREQ '1'                                       S01117
     C           *INU1     OREQ '0'                                       S01117
     C           *INU2     ANDEQ'0'                                       S01117
     C**                                                                  S01117
     C**  COUNT HEADER & TRAILER                                          S01117
     C                     ADD  2         COUNT                           S01117
0350 C*
0351 C*    COMPARE HASH TOTALS
0352 C                     Z-ADDHASHDW    ZZINT
0353 C                     Z-ADDHASHDD    ZZDEC
0354 C                     Z-ADDDHWN      ZZTOTI
0355 C                     Z-ADDDHDC      ZZTOTD
0356 C                     EXSR GLZCMP
0357 C           ZZDIFI    COMP 0                    4141
0358 C  N41      ZZDIFD    COMP 0                    4141
0359 C                     Z-ADDHASHCW    ZZINT
0360 C                     Z-ADDHASHCD    ZZDEC
0361 C                     Z-ADDCHWN      ZZTOTI
0362 C                     Z-ADDCHDC      ZZTOTD
0363 C                     EXSR GLZCMP
0364 C           ZZDIFI    COMP 0                    4242
0365 C  N42      ZZDIFD    COMP 0                    4242
     C                     END                                            S01117
0366 C*
0367 C*  41
0368 C*R 42                SETON                     U8
     C   41                                                               S01117
     COR 42                SETON                     U8                   S01117
0369 C                     SETOF                     43
0370 C           END       TAG                             ** END TAG **
0371 C*
0372 C  NLR 02             SETON                     43
0373 C*
0374 C*    ACCUMULATE A/C SECTION TOTALS.
0375 C*0*28****************SETON                     L1L2L3               E22369
     C*0*03****************SETOF                     L1L2L3         E10550E22369
0375 CL0 28                SETON                     L2L3L4               E22369
     CL0 03                SETOF                     L2L3L4               E22369
     C*                                                                   E22369
     C**   CONVERT THROUGH SPOT RATE.                                     E22369
     C*                                                                   E22369
     CL1                   EXSR CONVRT                                    E22369
     C*                                                                   E22369
0376 C**   CALCULATE ACCOUNT CODE BALANCE
0377 C*1*********DRBL******ADD  CRBL      CLDBL  150                      E22369
0378 C*1*******************SETON                     45                   E22369
0379 C******L1                   EXCPT                                   E16274
0379 C*1*48****************EXCPT                                    E16274E22369
0380 C*1*******************SETOF                     45                   E22369
0377 C***L2*****    DRBL      ADD  CRBL      CLDBL  150                                E22369 262907
     CL2         DRBL      ADD  CRBL      CLDBL  180   05                                     262907
0378 CL2                   SETON                     45                   E22369
0379 CL2 48                EXCPT                                          E22369
0380 CL2                   SETOF                     45                   E22369
0381 C*    ACCUMULATE SECTION TOTALS.
     C*1*03******          GOTO LRON                                S01117S01314
     CL2 03                GOTO LRON                                      S01314
0382 C*1*********DRBL      ADD  SDTOT     SDTOT                           E22369
0383 C*1*********CRBL      ADD  SCTOT     SCTOT                           E22369
0384 C*1*********CLDBL     ADD  SNTOT     SNTOT                           E22369
0382 CL2         DRBL      ADD  SDTOT     SDTOT                           E22369
0383 CL2         CRBL      ADD  SCTOT     SCTOT                           E22369
0384 CL2         CLDBL     ADD  SNTOT     SNTOT                           E22369
     C           LRON      TAG                                            S01117
0385 C*2*******************Z-ADDSDTOT     DEBIT  150                      E22369
0386 C*2*******************Z-ADDSCTOT     CREDIT 150                      E22369
0387 C*2*******************Z-ADDSNTOT     NET    150                      E22369
0388 C*2*******************SETON                     51                   E22369
0385 C***L3*****              Z-ADDSDTOT     DEBIT  150                                E22369 262907
0386 C***L3*****              Z-ADDSCTOT     CREDIT 150                                E22369 262907
0387 C***L3*****              Z-ADDSNTOT     NET    150                                E22369 262907
     CL3                   Z-ADDSDTOT     DEBIT  180                                          262907
     CL3                   Z-ADDSCTOT     CREDIT 180                                          262907
     CL3                   Z-ADDSNTOT     NET    180   06                                     262907
0388 CL3                   SETON                     51                   E22369
     CLR                   SETOF                     5253                 S01117
     CLR                   SETON                     51                   S01117
0389 C*2*********          EXSR EXCPT                                     E16274
0389 C*2*48******          EXSR EXCPT                               E16274S01117
0389 C*2N03*48*************EXSR EXCPT                               S01117S01314
0389 CL3N03 48             EXSR EXCPT                                     S01314
0390 C*2*********SDTOT     ADD  ACDTOT    ACDTOT                          S01117
0390 C*2N03******SDTOT     ADD  ACDTOT    ACDTOT                    S01117S01314
0390 CL3N03      SDTOT     ADD  ACDTOT    ACDTOT                          S01314
0391 C*2*********SCTOT     ADD  ACCTOT    ACCTOT                          S01117
0391 C*2N03******SCTOT     ADD  ACCTOT    ACCTOT                    S01117S01314
0391 CL3N03      SCTOT     ADD  ACCTOT    ACCTOT                          S01314
0392 C*2*********SNTOT     ADD  ACNTOT    ACNTOT                          S01117
0392 C*2N03******SNTOT     ADD  ACNTOT    ACNTOT                    S01117S01314
0392 CL3N03      SNTOT     ADD  ACNTOT    ACNTOT                          S01314
0393 C*
0394 C*    ACCUMULATE REPORT TOTALS.
0395 C*3*******************Z-ADDACDTOT    DEBIT                           E22369
0396 C*3*******************Z-ADDACCTOT    CREDIT                          E22369
0397 C*3*******************Z-ADDACNTOT    NET                             E22369
0398 C*3*******************SETON                     52                   E22369
0395 CL4                   Z-ADDACDTOT    DEBIT                           E22369
0396 CL4                   Z-ADDACCTOT    CREDIT                          E22369
0397 C***L4*****              Z-ADDACNTOT    NET                                       E22369 262907
     CL4                   Z-ADDACNTOT    NET          06                                     262907
0398 CL4                   SETON                     52                   E22369
     CLR                   SETOF                     5153                 S01117
     CLR                   SETON                     52                   S01117
0399 C*3*********          EXSR EXCPT                                     E16274
0399 C*3*48******          EXSR EXCPT                               E16274S01117
0399 C*3N03*48*************EXSR EXCPT                               S01117S01314
0399 CL4N03 48             EXSR EXCPT                                     S01314
0400 C*3*******************SETOF                     OF                   E22369
0401 C*3*********ACDTOT    ADD  RDTOT     RDTOT  150                      E22369
0402 C*3*********ACCTOT    ADD  RCTOT     RCTOT  150                      E22369
0403 C*3*********ACNTOT    ADD  RNTOT     RNTOT  150                      E22369
0400 CL4                   SETOF                     OF                   E22369
0401 C***L4*****    ACDTOT    ADD  RDTOT     RDTOT  150                                E22369 262907
0402 C***L4*****    ACCTOT    ADD  RCTOT     RCTOT  150                                E22369 262907
0403 C***L4*****    ACNTOT    ADD  RNTOT     RNTOT  150                                E22369 262907
     CL4         ACDTOT    ADD  RDTOT     RDTOT  180                                          262907
     CL4         ACCTOT    ADD  RCTOT     RCTOT  180                                          262907
     CL4         ACNTOT    ADD  RNTOT     RNTOT  180                                          262907
0405 C*    PRINT TOTALS FOR BRANCH AND COMPANY                            S01117
0406 C*3*28****************Z-ADDRDTOT     DEBIT                     S01117S01314
0407 C*3*28****************Z-ADDRCTOT     CREDIT                    S01117S01314
0408 C*3*28****************Z-ADDRNTOT     NET                       S01117S01314
0409 C*3*28****************SETON                     53             S01117S01314
0410 C*3*28N03*************EXSR EXCPT                               S01117S01314
     CL4 28                Z-ADDRDTOT     DEBIT                           S01314
     CL4 28                Z-ADDRCTOT     CREDIT                          S01314
     C***L4*28**              Z-ADDRNTOT     NET                                       S01314 262907
     CL4 28                Z-ADDRNTOT     NET          06                                     262907
0409 CL4 28                SETON                     53                   S01314
0410 CL4 28N03             EXSR EXCPT                                     S01314
0404 C*
0405 C*    PRINT CONSOLIDATED REPORT TOTALS                               S01117
     CLR         *IN03     IFEQ '0'                                       S01117
0406 CLR                   Z-ADDRDTOT     DEBIT
0407 CLR                   Z-ADDRCTOT     CREDIT
0408 C***LR*****              Z-ADDRNTOT     NET                                              262907
     CLR                   Z-ADDRNTOT     NET          06                                     262907
0409 CLR                   SETON                     53
0410 C*R*********          EXSR EXCPT                                     E16274
0410 C*R*48******          EXSR EXCPT                               E16274S01117
0410 CLRN03 48             EXSR EXCPT                                     S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C** COUNT HEADER & TRAILER                                           S01117
     CLR         *INU2     IFEQ '1'                                       S01117
     CLR         BRNCH     ANDNE'ALL'                                     S01117
     CLR         MBIN      ANDEQ'Y'                                       S01117
     CLR         *INU1     OREQ '1'                                       S01117
     CLR                   ADD  2         COUNT                           S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C** OUTPUT GL0750P1 HERE IF A SINGLE BRANCH/COMPANY REQUEST HAS      S01117
     C** NO DETAILS TO REPORT                                             S01117
     CLR         *IN48     IFEQ '0'                                       S01117
     CLR         *INU7     ANDNE'1'                                       S01117
     CLR         *INU2     IFEQ '1'                                       S01117
     CLR         BRNCH     ANDNE'ALL'                                     S01117
     CLR         *INU1     OREQ '1'                                       S01117
     CLR         *IN32     OREQ '0'                                       S01117
     CLR         *INU2     IFEQ '1'                                       S01117
     CLR         *IN32     ANDEQ'1'                                       S01117
     CLR                   EXSR ACBRCH                                    S01117
     CLR U7                GOTO LREND                                     S01117
     CLR                   ELSE                                           S01117
     CLR         *INU1     IFEQ '1'                                       S01117
     CLR                   EXSR ACCOMP                                    S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     CLR                   OPEN GL0750P1                                  S01117
     CLR                   Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01117
     CLR                   Z-ADDSFNUM     SFNUM1  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM BRNCH     SENTY                           S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           SFNUM1                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C**  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     CLR                   Z-ADDSFNUMU    SFNUM2  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           SFNUM2                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR         LREND     TAG                             ** LREND TAG **S01117
0411 C*
0412 C********************************************************************
     C*                                                                   E22369
     C***  CONVERT THROUGH SPOT RATE.                                     E22369
     C*                                                                   E22369
     C           CONVRT    BEGSR                                          E22369
     C*                                                                   E22369
     C*                    L1 - CONTROL BREAK ON CURRENCY.                E22369
     C*                    25 - WORK INDICATOR - CURRENCY FOUND IN LOKUP. E22369
     C*                                                                   E22369
     C                     Z-ADD1         X                               E22369
     C           CCYD      LOKUPCUR,X                    25               E22369
     C*                                                                   E22369
     C           *IN25     IFEQ '1'                         CRNCY FND.    E22369
     C*                                                                   E22369
      *                                                                   CEU011
      ** Convert 'In' ccy amounts to Euro equivalent when                 CEU011
      ** Position/Risk Enquiries & Reports feature is on                  CEU011
      ** and *INU5 is on.                                                 CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           *INU5     ANDEQ*ON                                       CEU011
      *                                                                   CEU011
     C           INC,X     IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
     C           TMPBLC    IFNE *ZERO                                     CEU011
     C                     Z-ADDTMPBLC    PFRAM                           CEU011
     C                     Z-ADD6         WDBASE  30                      CEU011
     C                     EXSR SREURO                                    CEU011
     C                     ADD  POUTA     CRBL                            CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           TMPBLD    IFNE *ZERO                                     CEU011
     C                     Z-ADDTMPBLD    PFRAM                           CEU011
     C                     Z-ADD8         WDBASE                          CEU011
     C                     EXSR SREURO                                    CEU011
     C                     ADD  POUTA     DRBL                            CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
     C           CCYD      IFEQ BKEURO                                    CEU011
      *                                                                   CEU011
     C           TMPBLC    IFNE *ZERO                                     CEU011
     C                     ADD  TMPBLC    CRBL                            CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           TMPBLD    IFNE *ZERO                                     CEU011
     C                     ADD  TMPBLD    DRBL                            CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
     C           CONV,X    IFNE *ZERO                       AVOID DIV BY 0E22369
     C*                                                                   E22369
     C**         CREDIT VALUES CONVERSIONS.                               E22369
     C*                                                                   E22369
     C           TMPBLC    IFNE *ZERO                       CR TOTL NOT 0.E22369
     C*                                                                   E22369
     C***********MD,X      IFEQ *ZERO                       DIVISIO E22369E33282
     C/COPY WNCPYSRC,GL0750C005
     C           MD,X      IFEQ 'D'                         DIVISION.     E33282
     C********** TMPBLC    DIV  CONV,X    LDBLC  150H                                  E22369 262907
     C           TMPBLC    DIV  CONV,X    LDBLC  180H                                         262907
     C                     ELSE                             ELSE MULT.    E22369
     C           TMPBLC    MULT CONV,X    LDBLC     H                     E22369
     C                     END                                            E22369
     C/COPY WNCPYSRC,GL0750C006
     C*                                                                   E22369
     C                     ADD  LDBLC     CRBL              ACCUME BALC   E22369
     C                     END                                            E22369
     C*                                                                   E22369
     C*          DEBIT VALUE CONVERSIONS.                                 E22369
     C*                                                                   E22369
     C           TMPBLD    IFNE *ZERO                       DB TOTL NOT 0.E22369
     C*                                                                   E22369
     C***********MD,X      IFEQ *ZERO                       DIVISIO E22369E33282
     C/COPY WNCPYSRC,GL0750C007
     C           MD,X      IFEQ 'D'                         DIVISION.     E33282
     C********** TMPBLD    DIV  CONV,X    LDBLD  150H                                  E22369 262907
     C           TMPBLD    DIV  CONV,X    LDBLD  180H                                         262907
     C                     ELSE                             ELSE MULT.    E22369
     C           TMPBLD    MULT CONV,X    LDBLD     H                     E22369
     C                     END                                            E22369
     C/COPY WNCPYSRC,GL0750C008
     C*                                                                   E22369
     C                     ADD  LDBLD     DRBL              ACCUME BALC   E22369
     C                     END                                            E22369
     C*                                                                   E22369
     C                     END                                            E22369
     C*                                                                   E22369
     C                     ENDIF                                          CEU011
     C                     END                                            E22369
     C*                                                                   E22369
     C                     ENDSR                                          E22369
     C*                                                                   E22369
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *  SR/SREURO - Call program to convert amount to Euro           *   CEU011
      *              Equivalent.                                      *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           SREURO    BEGSR                                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   PRTCD                           CEU011
     C                     MOVE CCYD      PFRCY                           CEU011
     C                     MOVE BKEURO    PTOCY                           CEU011
     C                     Z-ADD0         POUTA                           CEU011
     C                     Z-ADD0         PINTA                           CEU011
     C                     Z-ADD0         PEXRT                           CEU011
     C                     MOVE *BLANKS   PMDIN                           CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'               8383               CEU011
     C                     PARM           PRTCD   7                       CEU011
     C                     PARM           PFRAM  183                      CEU011
     C                     PARM           PFRCY   3                       CEU011
     C                     PARM           PTOCY   3                       CEU011
     C                     PARM           POUTA  150                      CEU011
     C                     PARM           PINTA  183                      CEU011
     C                     PARM           PEXRT  159                      CEU011
     C                     PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     C           PRTCD     IFNE *BLANKS                                   CEU011
     C                     MOVEL'*CALL   'DBFILE                          CEU011
     C                     MOVEL'EU0200  'DBKEY             ************  CEU011
     C                     MOVELWDBASE    DBASE             * DBERR nn *  CEU011
     C                     SETON                     U7U8LR ************  CEU011
     C                     EXSR *PSSR                                     CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
     C*****************************************************************   E22369
0413 C***********                                                         S01194
0414 C*****SR.*-*TO CHAIN TO THE TABLE FILE.                              S01194
0415 C***********QABCHN    BEGSR                                          S01194
0416 C***********TABKEY    CHAINTABCHN               30                   S01194
0417 C***********          ENDSR                                          S01194
     C********************************************************************S01117
     C**                                                                  S01117
     C**   SUBR. ACBRCH - TO ACCESS BRANCH DETAILS                        S01117
     C**                                                                  S01117
     C           ACBRCH    BEGSR                                          S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     38                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'007'     DBASE            * DBERR 007 *  S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVELBRNCH     DBKEY                           S01117
     C                     MOVEL@OPTN     DBOPTN                          S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
0418 C********************************************************************S01117
     C**                                                                  S01117
     C**   SUBR. ACCOMP - TO ACCESS COMPANY DETAILS                       S01117
     C**                                                                  S01117
     C           ACCOMP    BEGSR                                          S01117
     C                     SETON                     31                   S01117
     C                     CALL 'AOCOMPR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C***********          PARM BRNCH     @CENB   3                 S01117050005
     C                     PARM CMPYM     @CENB   3                       050005
     C           SDCOMP    PARM SDCOMP    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETOF                     31                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
0418 C********************************************************************S01117
0419 C*    EXCPT OUTPUT SUBROUTINE
0420 C           EXCPT     BEGSR                           *** EXCPT ***
0421 C                     EXCPT
0422 C***********          SETOF                     5152                 S01117
0422 C                     SETOF                     515253               S01117
0423 C                     ENDSR
0424 C********************************************************************
0425 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0426 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0427 C*
0428 CSR         GLZADD    BEGSR                           *** GLZADD ****
0429 C*
0430 C***SR*****              Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT                   262907
     CSR                   Z-ADDZZAMT     ZZAMT  183     91-DEFINE ZZAMT                      262907
0431 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0432 C*
0433 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0434 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0435 CSR                   Z-ADDZZAMT     ZZWK1   33
0436 CSR                   MOVE ZZWK1     ZZAMTD  30       DECIMAL FIELD
0437 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0438 C*
0439 CSR                   EXSR GLZSUM
0440 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0441 C*
0442 C********************************************************************
0443 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0444 C*                        GLZADD, GLZSUB, GLZCMP.
0445 C*          PARAMETERS PASSED -
0446 C*                     I/P ZZAMTI ZZAMTD
0447 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0448 C*
0449 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0450 C*
0451 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0452 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0453 CSR                   SETOF                     919293
0454 CSR                   SETOF                     949599
0455 C*
0456 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0457 CSR         ZZAMTI    COMP 0                      9293
0458 CSR 93      ZZAMTD    COMP 0                      9293
0459 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0460 C*
0461 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0462 CSR         ZZTOTI    COMP 0                      9193
0463 CSR 93      ZZTOTD    COMP 0                      9193
0464 C*
0465 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0466 CSR 93                Z-ADDZZAMTI    ZZTOTI
0467 CSR 93                Z-ADDZZAMTD    ZZTOTD
0468 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0469 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0470 CSR 91N92
0471 CORN91 92             GOTO ZZOFPS
0472 C*
0473 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0474 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0475 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0476 C*
0477 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0478 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0479 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0480 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0481 C*
0482 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0483 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0484 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0485 CSRN99                Z-ADDZZWK2     ZZTOTD
0486 CSRN99                Z-ADDZZWK3     ZZTOTI
0487 C*
0488 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0489 C***SR*99**              Z-ADD0         ZZAMT  153                                       262907
     CSR 99                Z-ADD0         ZZAMT  183                                          262907
0490 CSR                   GOTO ZZSEND
0491 C*
0492 C* THE 'SIGNS' ARE DIFFERENT
0493 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0494 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0495 C*
0496 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0497 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0498 C*
0499 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0500 C*
0501 CSR 91                Z-SUBZZTOTI    ZZTOTI
0502 CSR 91                Z-SUBZZTOTD    ZZTOTD
0503 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0504 C*
0505 CSR         ZZTOTI    COMP ZZAMTI               93  95
0506 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0507 C*
0508 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0509 CSR 95                Z-ADD0         ZZTOTI
0510 CSR 95                Z-ADD0         ZZTOTD
0511 CSR 95                GOTO ZZSEND
0512 C*
0513 C* IF ZZTOT GT. ZZAMT.
0514 CSR 93      ZZAMTD    COMP ZZTOTD               94
0515 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0516 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0517 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0518 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0519 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0520 C*
0521 C*
0522 C* IF ZZAMT GT. ZZTOT.
0523 CSRN93      ZZTOTD    COMP ZZAMTD               94
0524 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0525 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0526 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0527 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0528 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0529 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0530 C*
0531 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0532 CSR                   SETOF                     94
0533 CSR 93 91
0534 CORN93 92             SETON                     94
0535 CSR 94                Z-SUBZZTOTI    ZZTOTI
0536 CSR 94                Z-SUBZZTOTD    ZZTOTD
0537 C**
0538 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0539 CSR 92                Z-SUBZZAMTI    ZZAMTI
0540 CSR 92                Z-SUBZZAMTD    ZZAMTD
0541 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0542 C**
0543 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0544 CSR                   SETOF                     96
0545 CSR         ZZTOTD    COMP 0                        91
0546 CSR 91      ZZTOTI    COMP 0                      96
0547 CSR 96                MOVE '.000-'   ZZNEGD  5
0548 CSR                   ENDSR                             ** ENDSR **
0549 C********************************************************************
0550 C* SUBROUTINE TO COMPARE AN AMOUNT TO THE TOTAL.
0551 C*      PARAMETERS. I/P - ZZINT - THE INTEGER PORTION OF THE NUMBER.
0552 C*                  I/P - ZZDEC - THE DECIMAL PORTION OF THE NUMBER.
0553 C*                  O/P - ZZDIFI - IS THE INTEGER DIFFERENCE.
0554 C*                  O/P - ZZDIFD - IS THE DECIMAL DIFFERENCE.
0555 C*                  O/P - ZZNEGD - FOR IMMEDIATE PRINTING ONLY.
0556 C*                  O/P - 96 IS SET IF DIFFERENCE IS NEGATIVE.
0557 C*
0558 C*    IF AN ERROR HAS OCCURED ZZDIFI AND ZZDIFD WILL BE ZERO.
0559 C*        '99' - OVERFLOW ERROR
0560 C*        '97' - THE 'SIGN' ZONES OF ZZINT AND ZZDEC ARE DIFFERENT
0561 C*
0562 CSR         GLZCMP    BEGSR                           *** GLZCMP ****
0563 CSR                   SETOF                     9799
0564 CSR                   Z-ADDZZDEC     ZZDEC   30 919293DEFINE ZZDEC
0565 CSR                   Z-ADDZZINT     ZZINT  150 949596DEFINE ZZINT
0566 C* IF SIGN ZONES DIFFER, SET 97, & RETURN ZERO.
0567 CSR 91 95
0568 COR 92 94             SETON                     97    ERROR -MIXED
0569 C*                                                           STATUS
0570 CSR 97                GOTO ZZQUIT                     BRANCH TO ADMIT
0571 C*
0572 C*  SPECIAL CASES DEALT WITH FIRST
0573 C*      EITHER AMOUNTS EQ '0' OR BOTH AMOUNTS 'EQ'
0574 CSR                   SETOF                     9192
0575 CSR                   SETOF                     9495
0576 CSR 93 96             SETON                     91    * IF I/P FIELD
0577 CSR 91                Z-ADDZZTOTI    ZZDIFI 150       *    ZERO
0578 CSR 91                Z-ADDZZTOTD    ZZDIFD  30       *
0579 CSR 91                GOTO ZZSIGN
0580 C*
0581 CSR         ZZTOTI    COMP ZZINT                    91* IF FIELDS EQ
0582 CSR 91      ZZTOTD    COMP ZZDEC                    91*
0583 CSR 91                Z-ADD0         ZZDIFI           *
0584 CSR 91                Z-ADD0         ZZDIFD           *
0585 CSR 91                GOTO ZZCEND
0586 C*
0587 CSR         ZZTOTI    COMP 0                        91* IF TOTAL
0588 CSR 91      ZZTOTD    COMP 0                        91*    ZERO
0589 CSR 91                Z-SUBZZINT     ZZDIFI           *
0590 CSR 91                Z-SUBZZDEC     ZZDIFD           *
0591 C**
0592 CSR         ZZSIGN    TAG                             *** ZZSIGN ****
0593 C*
0594 C**   IF ZZDIFD IS ZERO, AND ZZDIFI IS NEG. SET UP ZZNEGD.
0595 CSR                   SETOF                     96
0596 CSR 91      ZZDIFD    COMP 0                        94
0597 CSR 94      ZZDIFI    COMP 0                      96
0598 CSR 96                MOVE '.000-'   ZZNEGD  5
0599 CSR 91                GOTO ZZCEND
0600 C*      END OF SPECIAL CASES
0601 C*
0602 C* IF ZZTOTALS EQ 'B' AND ZZINT,ZZDEC EQ 'A'   THEN -
0603 C*  TO COMPARE 'A' WITH 'B'
0604 C*     1. STORE ORIGINAL VALUE OF 'B'.
0605 C*     2. NEGATE 'A'.
0606 C*     3. ADD 'A' TO 'B'.
0607 C*     4. 'B' IS NOW THE DIFFERENCE. STORE 'B' IN FIELD 'C'.
0608 C*     5. RESTORE 'B'.
0609 C*            N.B. 'A' EQ ZZINT AND ZZDEC
0610 C*                 'B' EQ ZZTOTI AND ZZTOTD
0611 C*                 'C' EQ ZZDIFI AND ZZDIFD
0612 C*
0613 C*    STEP #1
0614 CSR                   Z-ADDZZTOTI    ZZSTRI 150
0615 CSR                   Z-ADDZZTOTD    ZZSTRD  30
0616 C*    STEP #2
0617 CSR                   Z-SUBZZINT     ZZAMTI 150
0618 CSR                   Z-SUBZZDEC     ZZAMTD  30
0619 C*    STEP #3
0620 CSR                   EXSR GLZSUM
0621 CSR 99                GOTO ZZQUIT
0622 C*    STEP #4
0623 CSR                   Z-ADDZZTOTI    ZZDIFI
0624 CSR                   MOVE ZZTOTD    ZZDIFD
0625 C*    STEP #5
0626 CSR                   Z-ADDZZSTRI    ZZTOTI 150
0627 CSR                   Z-ADDZZSTRD    ZZTOTD  30
0628 CSR                   GOTO ZZCEND                     BYPASS ADMIT
0629 CSR         ZZQUIT    TAG                             ** ZZQUIT TAG**
0630 CSR                   Z-ADD0         ZZDIFI
0631 CSR                   Z-ADD0         ZZDIFD
0632 CSR         ZZCEND    ENDSR                           ** ZZCEND TAG**
0633 C*
0634 C********************************************************************
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C**                                                                  S01194
     C/COPY WNCPYSRC,GL0750C009
     C*****************************************************************   S01194
     C/EJECT                                                              S01117
0635 O*PRINT* H  203   40                                                 S01117
0635 O*L0750P1H**203   40                                                 S01117
0635 OGL0750P1H  203   40 75                                              S01117
0636 O       OR        OFN28 02
     O       AND       75                                                 S01117
0637 O*******OR**      OF LR                                              S01117
0637 O       OR        OF LR 75                                           S01117
0638 O*******OR**      L3NLR                                              S01117
0638 O*******OR**      L3NLR 75                                     S01117S01314
     O       OR        L4NLR 75                                           S01314
0638 O*******OR**      03N48                                        E16274S01117
0638 O       OR        03N48 75                                           S01117
0639 O*****                              22 'REFERENCE GL0750'            S01117
0639 O                                   24 'REFERENCE GL0750P1'          S01117
0640 O***********              TITL      89                               S01194
0640 O                         BJURPT    89                               S01194
0641 O                                  104 'DATE'
0642 O                         RUNA     112
0643 O                                  122 'PAGE'
0644 O                         PAGE  Z  127
0645 O********H**1     40                                                 S01117
0645 O        H  1     40 75                                              S01117
0646 O       OR        OFN28 02
     O       AND       75                                                 S01117
0647 O*******OR**      OF LR                                              S01117
0647 O       OR        OF LR 75                                           S01117
0648 O*******OR**      L3NLR                                              S01117
0648 O*******OR**      L3NLR 75                                     S01117S01314
     O       OR        L4NLR 75                                           S01314
0648 O*******OR**      03N48                                        E16274S01117
0648 O       OR        03N48 75                                           S01117
0649 O***********      U1   NLR           9 'COMPANY'                     S01117
*    O***********      U1   NLRCMPYM     13                               S01117
*    O***********      U1   NLRCMNM      45                               S01117
0650 O***********      U2   NLR           9 'BRANCH'                      S01117
*    O***********      U2   NLRBRNO      13                               S01117
*    O***********      U2   NLRBRNM      45                               S01117
0651 O***********     NU1NU2             14 'CONSOLIDATED'                S01117
0652 O***********      U1   NLRCMNM      41                               S01117
0653 O***********      U1NLRN31          26 '***************'             S01117
0654 O***********      U1NLRN31          41 '***************'             S01117
0655 O***********      U2   NLRBRNO      13                               S01117
0656 O***********                        66 'GENERAL LEDGER BALANCES '    S01117
0657 O***********                        67 '-'                           S01117
0658 O***********                        88 'HEAD OFFICE CURRENCY'        S01117
0659 O***********      U3                88 'LOCAL CURRENCY      '        S01117
0660 O***********      U4                88 'BASE CURRENCY       '        S01117
0656 O                                   50 'GENERAL LEDGER BALANCES '    S01117
0657 O                                   51 '-'                           S01117
0658 O                                   72 'HEAD OFFICE CURRENCY'        S01117
0659 O                 U3                72 'LOCAL CURRENCY      '        S01117
0660 O                 U4                72 'BASE CURRENCY       '        S01117
      *                                                                   CEU011
     O                 U5 44             72 'CONS. EURO POSITION '        CEU011
     O/COPY WNCPYSRC,GL0750O001
0649 O                 U1   NLR          83 'COMPANY'                     S01117
     O                 U1   NLRCMPYM     87                               S01117
     O                 U1   NLR          88 '-'                           S01117
     O                 U1 31NLRAPCMNM   118                               S01117
     O                 U1N31NLR         111 '*** UNKNOWN COMPANY ***'     S01117
0650 O                 U2 32NLR          82 'BRANCH'                      S01117
     O                 U2 32NLRBRNO      86                               S01117
     O                 U2 32NLR          87 '-'                           S01117
     O                 U2 32NLRA8BRNM   117                               S01117
0651 O                NU1NU2             88 'CONSOLIDATED'                S01117
     O/COPY WNCPYSRC,GL0750O003
0661 O********H**2     40                                                 S01117
0661 O        H  2     40 75                                              S01117
0662 O       OR        OFN28 02
     O       AND       75                                                 S01117
0663 O*******OR**      OF LR                                              S01117
0663 O       OR        OF LR 75                                           S01117
0664 O*******OR**      L3NLR                                              S01117
0664 O*******OR**      L3NLR 75                                     S01117S01314
     O       OR        L4NLR 75                                           S01314
0664 O*******OR**      03N48                                        E16274S01117
0664 O       OR        03N48 75                                           S01117
0665 O***********                        65 '-----------------------'     S01117
0665 O                                   49 '-----------------------'     S01117
0645 O        H  2     40 75                                              E42846
0646 O       OR        OFN28 02                                           E42846
     O       AND       75                                                 E42846
0647 O       OR        OF LR 75                                           E42846
     O       OR        L4NLR 75                                           E42846
0648 O       OR        03N48 75                                           E42846
0493 O                 55                72 'AFTER FINAL POST'            E42846
0493 O                 56                72 'AFTER DAILY POST'            E42846
0493 O                 57                74 'AFTER SPOT REVALUATION'      E42846
0493 O                 58                73 'AFTER B/CCY TRANSFER'        E42846
0493 O                 59                73 'AFTER F/CCY TRANSFER'        E42846
     O/COPY WNCPYSRC,GL0750O004
0645 O        H  2     40 75                                              E42846
0646 O       OR        OFN28 02                                           E42846
     O       AND       75                                                 E42846
0647 O       OR        OF LR 75                                           E42846
     O       OR        L4NLR 75                                           E42846
0648 O       OR        03N48 75                                           E42846
0493 O                 55                72 '----------------'            E42846
0493 O                 56                72 '----------------'            E42846
0493 O                 57                74 '----------------------'      E42846
0493 O                 58                73 '--------------------'        E42846
0493 O                 59                73 '--------------------'        E42846
     O/COPY WNCPYSRC,GL0750O005
0666 O********H**2     40                                                 S01117
0666 O        H  2     40 75                                              S01117
0667 O       OR        OFN28 43
     O       AND       75                                                 S01117
0668 O*******OR**      L3NLR                                              S01117
0668 O*******OR**      L3NLR 75                                     S01117S01314
     O       OR        L4NLR 75                                           S01314
     O*******OR**      03N48                                        E16274S01117
0668 O       OR        03N48 75                                           S01117
0669 O                                   39 'GENERAL LEDGER'
0670 O**********                         66 'DEBIT'                                           262907
0671 O**********                         88 'CREDIT'                                          262907
0672 O**********                        110 'NET'                                             262907
0670 O                                   70 'DEBIT'                                           262907
0671 O                                   95 'CREDIT'                                          262907
0672 O                                  117 'NET'                                             262907
0673 O********H**1     L3NLR                                              S01117
0673 O********H**1     L3NLR 75                                     S01117S01314
     O        H  1     L4NLR 75                                           S01314
0674 O************        21             23 'ASSETS'                      S01290
0675 O************        22             28 'LIABILITIES'                 S01290
0676 O************        23             23 'INCOME'                      S01290
0677 O************        24             24 'EXPENSE'                     S01290
0678 O************        19             27 'CONTINGENT'                  S01290
0674 O                    21             13 'ASSETS'                      S01290
0675 O                    22             18 'LIABILITIES'                 S01290
0676 O                    23             13 'INCOME'                      S01290
0677 O                    24             14 'EXPENSE'                     S01290
0678 O                    19             17 'CONTINGENT'                  S01290
     O/COPY WNCPYSRC,GL0750O006
0679 O********H**1     L3NLR                                              S01117
0679 O********H**1     L3NLR 75                                     S01117S01314
     O        H  1     L4NLR 75                                           S01314
0680 O************                       23 '------'                      S01290
0681 O************        22             28 '-----'                       S01290
0682 O************        24             24 '-'                           S01290
0683 O************        19             27 '----'                        S01290
0680 O                                   13 '------'                      S01290
0681 O                    22             18 '-----'                       S01290
0682 O                    24             14 '-'                           S01290
0683 O                    19             17 '----'                        S01290
     O*
     O/COPY WNCPYSRC,GL0750OOP1
     O*
0679 O        H  1     L4NLR 75                                           S01290
     O                                   24 '------------------------'    S01290
     O                                   48 '------------------------'    S01290
     O                                   72 '------------------------'    S01290
     O                                   96 '------------------------'    S01290
     O                                  120 '------------------------'    S01290
     O                                  132 '------------'                S01290
     O*
     O/COPY WNCPYSRC,GL0750OOP2
     O*
     O**PRINT 'NO DETAILS TO REPORT' IF DETAIL RECORD INDICATOR NOT ON    E16274
     O********D*2      03N48                                        E16274S01117
     O        D 2      03N48 75                                           S01117
     O                                   71 '***  NO DETAILS TO  '        E16274
     O                                   82 'REPORT  ***'                 E16274
0684 O********D*11     L2                                                 S01117
0684 O********D*11     L2 75                                        S01117S01314
     O        D 11     L3 75                                              S01314
0685 O************             TACD      21                               S01290
0686 O************             TANM      47                               S01290
0685 O**********               TACD      11                                            S01290 CGL029
0686 O**********               TANM      37                                            S01290 CGL029
0685 O                         TACD      17                                                   CGL029
0686 O                         TANM      43                                                   CGL029
0687 O********D**2     L2                                                 S01117
0687 O********D**2     L3 75                                        S01117S01314
0687 O********D**2     L2 75                                        S01314S01290
0688 O************                       41 '------------------------'    S01290
0689 O************                       47 '------'                      S01290
0690 O********EF*1     45                                                 S01117
0690 O        EF 1     45 75                                              S01117
0691 O**********               ACOD      21                                                   CGL029
0692 O**********               ANAM      47                                                   CGL029
0691 O                         ACOD      27                                                   CGL029
0692 O                         ANAM      53                                                   CGL029
0693 O*
0694 O*    0 DECIMAL PLACES.
0695 O**********       60      DRBL      69 '   ,   ,   ,   , 0 '                             CGL029
0696 O**********       60      CRBL      91 '   ,   ,   ,   , 0 '                             CGL029
0697 O**********       60      CLDBL    115 '   ,   ,   ,   , 0 CR'                           CGL029
0695 O**********       60      DRBL      75 '   ,   ,   ,   , 0 '                      CGL029 262907
0696 O**********       60      CRBL      97 '   ,   ,   ,   , 0 '                      CGL029 262907
0697 O**********       60      CLDBL    121 '   ,   ,   ,   , 0 CR'                    CGL029 262907
     O                 60      DRBL      79 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60      CRBL     104 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60      CLDBL    129 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60 05            131 'CR'                                              262907
0698 O*
0699 O*    1 DECIMAL PLACE.
0700 O**********       61      DRBL      69 '  ,   ,   ,   , 0 . '                            CGL029
0701 O**********       61      CRBL      91 '  ,   ,   ,   , 0 . '                            CGL029
0702 O**********       61      CLDBL    115 '  ,   ,   ,   , 0 . CR'                          CGL029
0700 O**********       61      DRBL      75 '  ,   ,   ,   , 0 . '                     CGL029 262907
0701 O**********       61      CRBL      97 '  ,   ,   ,   , 0 . '                     CGL029 262907
0702 O**********       61      CLDBL    121 '  ,   ,   ,   , 0 . CR'                   CGL029 262907
     O                 61      DRBL      79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61      CRBL     104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61      CLDBL    129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61 05            131 'CR'                                              262907
0703 O*
0704 O*    2 DECIMAL PLACES.
0705 O**********       62      DRBL      69 ' ,   ,   ,   , 0 .  '                            CGL029
0706 O**********       62      CRBL      91 ' ,   ,   ,   , 0 .  '                            CGL029
0707 O**********       62      CLDBL    115 ' ,   ,   ,   , 0 .  CR'                          CGL029
0705 O**********       62      DRBL      75 ' ,   ,   ,   , 0 .  '                     CGL029 262907
0706 O**********       62      CRBL      97 ' ,   ,   ,   , 0 .  '                     CGL029 262907
0707 O**********       62      CLDBL    121 ' ,   ,   ,   , 0 .  CR'                   CGL029 262907
     O                 62      DRBL      79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62      CRBL     104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62      CLDBL    129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62 05            131 'CR'                                              262907
0708 O*
0709 O*    3 DECIMAL PLACES.
0710 O**********       63      DRBL      69 '   ,   ,   , 0 .   '                             CGL029
0711 O**********       63      CRBL      91 '   ,   ,   , 0 .   '                             CGL029
0712 O**********       63      CLDBL    115 '   ,   ,   , 0 .   CR'                           CGL029
0710 O**********       63      DRBL      75 '   ,   ,   , 0 .   '                      CGL029 262907
0711 O**********       63      CRBL      97 '   ,   ,   , 0 .   '                      CGL029 262907
0712 O**********       63      CLDBL    121 '   ,   ,   , 0 .   CR'                    CGL029 262907
     O                 63      DRBL      79 '   ,   ,   ,   , 0 .   '                         262907
     O                 63      CRBL     104 '   ,   ,   ,   , 0 .   '                         262907
     O                 63      CLDBL    129 '   ,   ,   ,   , 0 .   '                         262907
     O                 63 05            131 'CR'                                              262907
0713 O*
0714 O********EF20     51                                                 S01117
0714 O        EF20     51 75                                              S01117
0715 O***********                        47 'SECTION TOTAL'               S01290
     O                         TANM      42                               S01290
     O                                   48 'TOTAL'                       S01290
     O*                                                                   S01290
     O        E        51 75                                              S01290
     O*    0 DECIMAL PLACES.                                              S01290
     O**********       60      DEBIT     69 '   ,   ,   ,   , 0 '                      S01290 CGL029
     O**********       60      CREDIT    91 '   ,   ,   ,   , 0 '                      S01290 CGL029
     O**********       60      NET      115 '   ,   ,   ,   , 0 CR'                    S01290 CGL029
     O**********       60      DEBIT     75 '   ,   ,   ,   , 0 '                      CGL029 262907
     O**********       60      CREDIT    97 '   ,   ,   ,   , 0 '                      CGL029 262907
     O**********       60      NET      121 '   ,   ,   ,   , 0 CR'                    CGL029 262907
     O                 60      DEBIT     79 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60      CREDIT   104 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60      NET      129 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60 06            131 'CR'                                              262907
     O*                                                                   S01290
     O*    1 DECIMAL PLACE.                                               S01290
     O**********       61      DEBIT     69 '  ,   ,   ,   , 0 . '                     S01290 CGL029
     O**********       61      CREDIT    91 '  ,   ,   ,   , 0 . '                     S01290 CGL029
     O**********       61      NET      115 '  ,   ,   ,   , 0 . CR'                   S01290 CGL029
     O**********       61      DEBIT     75 '  ,   ,   ,   , 0 . '                     CGL029 262907
     O**********       61      CREDIT    97 '  ,   ,   ,   , 0 . '                     CGL029 262907
     O**********       61      NET      121 '  ,   ,   ,   , 0 . CR'                   CGL029 262907
     O                 61      DEBIT     79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61      CREDIT   104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61      NET      129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61 06            131 'CR'                                              262907
     O*                                                                   S01290
     O*    2 DECIMAL PLACES.                                              S01290
     O**********       62      DEBIT     69 ' ,   ,   ,   , 0 .  '                     S01290 CGL029
     O**********       62      CREDIT    91 ' ,   ,   ,   , 0 .  '                     S01290 CGL029
     O**********       62      NET      115 ' ,   ,   ,   , 0 .  CR'                   S01290 CGL029
     O**********       62      DEBIT     75 ' ,   ,   ,   , 0 .  '                     CGL029 262907
     O**********       62      CREDIT    97 ' ,   ,   ,   , 0 .  '                     CGL029 262907
     O**********       62      NET      121 ' ,   ,   ,   , 0 .  CR'                   CGL029 262907
     O                 62      DEBIT     79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62      CREDIT   104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62      NET      129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62 06            131 'CR'                                              262907
     O*                                                                   S01290
     O*    3 DECIMAL PLACES.                                              S01290
     O**********       63      DEBIT     69 '   ,   ,   , 0 .   '                      S01290 CGL029
     O**********       63      CREDIT    91 '   ,   ,   , 0 .   '                      S01290 CGL029
     O**********       63      NET      115 '   ,   ,   , 0 .   CR'                    S01290 CGL029
     O**********       63      DEBIT     75 '   ,   ,   , 0 .   '                      CGL029 262907
     O**********       63      CREDIT    97 '   ,   ,   , 0 .   '                      CGL029 262907
     O**********       63      NET      121 '   ,   ,   , 0 .   CR'                    CGL029 262907
     O                 63      DEBIT     79 '   ,   ,   ,   , 0 .   '                         262907
     O                 63      CREDIT   104 '   ,   ,   ,   , 0 .   '                         262907
     O                 63      NET      129 '   ,   ,   ,   , 0 .   '                         262907
     O                 63 06            131 'CR'                                              262907
     O*                                                                   S01290
     O*
     O/COPY WNCPYSRC,GL0750OOP3
     O*
     O        E 12     51 75                                              S01290
     O                                   24 '------------------------'    S01290
     O                                   48 '------------------------'    S01290
     O                                   72 '------------------------'    S01290
     O                                   96 '------------------------'    S01290
     O                                  120 '------------------------'    S01290
     O                                  132 '------------'                S01290
     O*
     O/COPY WNCPYSRC,GL0750OOP4
     O*
0716 O*
0717 O********EF20     52                                                 S01117
0717 O        EF20     52 75                                              S01117
     O                       21          42 'ASSETS'                      S01290
     O                       22          42 'LIABILITIES'                 S01290
     O                       23          42 'INCOME'                      S01290
     O                       24          42 'EXPENSE'                     S01290
     O                       19          42 'CONTINGENT'                  S01290
     O/COPY WNCPYSRC,GL0750O007
0718 O***********                        47 'TOTAL'                       S01290
     O                                   48 'TOTAL'                       S01290
0719 O*
0720 O*
0721 O********EF20     53                                                 S01117
0721 O        EF20     53 75                                              S01117
0722 O***********                        47 'REPORT TOTAL'                S01117
     O***********     NU1NU2             47 'REPORT TOTAL'          S01117S01290
     O                NU1NU2             48 'REPORT TOTAL'                S01290
0722 O***********      U1                47 'COMPANY TOTAL'         S01117S01290
     O                 U1                48 'COMPANY TOTAL'               S01290
0722 O***********      U2                47 'BRANCH TOTAL'          S01117S01290
     O                 U2                48 'BRANCH TOTAL'                S01290
0723 O********E**      51                                                 S01117
0723 O********E**      51 75                                        S01117S01290
0724 O*******OR**      52                                                 S01117
0724 O*******OR**      52 75                                        S01117S01290
0725 O*******OR**      53                                                 S01117
0723 O        E        52 75                                              S01290
0725 O       OR        53 75                                              S01117
0726 O*    0 DECIMAL PLACES.
0727 O**********       60      DEBIT     69 '   ,   ,   ,   , 0 '                             CGL029
0728 O**********       60      CREDIT    91 '   ,   ,   ,   , 0 '                             CGL029
0729 O**********       60      NET      115 '   ,   ,   ,   , 0 CR'                           CGL029
     O**********       60      DEBIT     75 '   ,   ,   ,   , 0 '                      CGL029 262907
     O**********       60      CREDIT    97 '   ,   ,   ,   , 0 '                      CGL029 262907
     O**********       60      NET      121 '   ,   ,   ,   , 0 CR'                    CGL029 262907
     O                 60      DEBIT     79 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60      CREDIT   104 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60      NET      129 '   ,   ,   ,   ,   , 0 '                         262907
     O                 60 06            131 'CR'                                              262907
0730 O*
0731 O*    1 DECIMAL PLACE.
0732 O**********       61      DEBIT     69 '  ,   ,   ,   , 0 . '                            CGL029
0733 O**********       61      CREDIT    91 '  ,   ,   ,   , 0 . '                            CGL029
0734 O**********       61      NET      115 '  ,   ,   ,   , 0 . CR'                          CGL029
     O**********       61      DEBIT     75 '  ,   ,   ,   , 0 . '                     CGL029 262907
     O**********       61      CREDIT    97 '  ,   ,   ,   , 0 . '                     CGL029 262907
     O**********       61      NET      121 '  ,   ,   ,   , 0 . CR'                   CGL029 262907
     O                 61      DEBIT     79 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61      CREDIT   104 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61      NET      129 '  ,   ,   ,   ,   , 0 . '                        262907
     O                 61 06            131 'CR'                                              262907
0735 O*
0736 O*    2 DECIMAL PLACES.
0737 O**********       62      DEBIT     69 ' ,   ,   ,   , 0 .  '                            CGL029
0738 O**********       62      CREDIT    91 ' ,   ,   ,   , 0 .  '                            CGL029
0739 O**********       62      NET      115 ' ,   ,   ,   , 0 .  CR'                          CGL029
     O**********       62      DEBIT     75 ' ,   ,   ,   , 0 .  '                     CGL029 262907
     O**********       62      CREDIT    97 ' ,   ,   ,   , 0 .  '                     CGL029 262907
     O**********       62      NET      121 ' ,   ,   ,   , 0 .  CR'                   CGL029 262907
     O                 62      DEBIT     79 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62      CREDIT   104 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62      NET      129 ' ,   ,   ,   ,   , 0 .  '                        262907
     O                 62 06            131 'CR'                                              262907
0740 O*
0741 O*    3 DECIMAL PLACES.
0742 O**********       63      DEBIT     69 '   ,   ,   , 0 .   '                             CGL029
0743 O**********       63      CREDIT    91 '   ,   ,   , 0 .   '                             CGL029
0744 O**********       63      NET      115 '   ,   ,   , 0 .   CR'                           CGL029
     O**********       63      DEBIT     75 '   ,   ,   , 0 .   '                      CGL029 262907
     O**********       63      CREDIT    97 '   ,   ,   , 0 .   '                      CGL029 262907
     O**********       63      NET      121 '   ,   ,   , 0 .   CR'                    CGL029 262907
     O                 63      DEBIT     79 '   ,   ,   ,   , 0 .   '                         262907
     O                 63      CREDIT   104 '   ,   ,   ,   , 0 .   '                         262907
     O                 63      NET      129 '   ,   ,   ,   , 0 .   '                         262907
     O                 63 06            131 'CR'                                              262907
0745 O*
0746 O********E**      52                                                 S01117
     O/COPY WNCPYSRC,GL0750O009
0746 O        E        52 75                                              S01117
     O*
     O/COPY WNCPYSRC,GL0750OOP5
     O*
     O                       21          43 '-------'                     S01290
     O                       22          43 '------------'                S01290
     O                       23          43 '-------'                     S01290
     O                       24          43 '--------'                    S01290
     O                       19          43 '-----------'                 S01290
0747 O***********                        47 '-----'                       S01290
     O                                   48 '-----'                       S01290
     O*
     O/COPY WNCPYSRC,GL0750OOP6
     O*
0748 O************                      113 '--------------------'        S01290
     O*
     O*
0784 O        T 3      28 U1 75                                           S01117
0784 O       AND      N03                                                 S01117
0784 O       OR        LR 75 U1                                           S01117
     O                                   63 '*** END OF REPORT FOR'       S01117
     O                                   86 'BANK AND COMPANY LEVEL'      S01117
     O                                   90 '***'                         S01117
0784 O        T 3      28 U2 75                                           S01117
0784 O       AND      N03 32                                              S01117
0784 O       OR        LR 75 U2                                           S01117
     O       AND       32                                                 S01117
     O                                   69 '*** END OF REPORT FOR'       S01117
     O                                   84 'BRANCH     ***'              S01117
     O                         BRNO      80                               S01117
0784 O        T 3     NU1NU2 75                                           S01117
     O       AND       LR                                                 S01117
     O       OR        75 U2N32                                           S01117
     O       AND       LRN03                                              S01117
0785 O                                   76 '*** END OF REPORT ***'       S01117
     O*                                                                   S01117
0635 OGL0750P1E  203           NODTL                                      S01117
0639 O                                   24 'REFERENCE GL0750P1'          S01117
0640 O                         BJURPT    89                               S01117
0641 O                                  104 'DATE'                        S01117
0642 O                         RUNA     112                               S01117
0643 O                                  122 'PAGE'                        S01117
0644 O                         PAGE  Z  127                               S01117
     O        E  1             NODTL                                      S01117
0656 O                                   50 'GENERAL LEDGER BALANCES '    S01117
0657 O                                   51 '-'                           S01117
0658 O                                   72 'HEAD OFFICE CURRENCY'        S01117
0659 O                 U3                72 'LOCAL CURRENCY      '        S01117
0660 O                 U4                72 'BASE CURRENCY       '        S01117
      *                                                                   CEU011
     O                 U5 44             72 'CONS. EURO POSITION '        CEU011
     O/COPY WNCPYSRC,GL0750O002
0649 O                 U1                83 'COMPANY'                     S01117
     O                 U1      BRNCH     87                               S01117
     O                 U1                88 '-'                           S01117
     O                 U1 31   APCMNM   118                               S01117
     O                 U1N31            111 '*** UNKNOWN COMPANY ***'     S01117
0650 O                 U2 32             82 'BRANCH'                      S01117
     O                 U2 32   BRNCH     86                               S01117
     O                 U2 32N38          87 '-'                           S01117
     O                 U2 32N38A8BRNM   117                               S01117
0651 O                NU1NU2             88 'CONSOLIDATED'                S01117
     O/COPY WNCPYSRC,GL0750O008
     O        E  2             NODTL                                      S01117
     O                                   49 '-----------------------'     S01117
     O        E   26           NODTL                                      S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
     O        E   48           NODTL                                      S01117
     O                 U2 32             69 '*** END OF REPORT FOR'       S01117
     O                 U2 32             76 'BRANCH'                      S01117
     O                 U2 32   BRNCH     80                               S01117
     O                 U2 32             84 '***'                         S01117
     O                 U1                63 '*** END OF REPORT FOR'       S01117
     O                 U1                86 'BANK AND COMPANY LEVEL'      S01117
     O                 U1                90 '***'                         S01117
     O                   N32             76 '*** END OF REPORT ***'       S01117
0749 O**
0750 O**      BALANCE AFTER A SUMMARY SORT.
     O*****   T  203      LR                                              S01117
     OGL0750AUT  203      LR                                              S01117
0752 O*****                              22 'REFERENCE GL0750'            S01117
0752 O                                   24 'REFERENCE GL0750AU'          S01117
0753 O***********              TITL      89                               S01194
0753 O                         BJURPT    89                               S01194
0754 O                                  104 'DATE'
0755 O                         RUNA     112
0756 O                                  122 'PAGE'
0757 O***********              PAGE  Z  127                               S01117
0757 O                         PAGE1 Z  127                               S01117
     O        T  1     LR
0759 O***********                        65 'GENERAL LEDGER BALANCES '    S01117
0760 O***********                        84 'FILE CONTROL TOTALS'         S01117
0759 O                                   69 'GENERAL LEDGER BALANCES'     S01117
0760 O                                   85 '    RUN CONTROLS'            S01117
     O        T  3     LR
0762 O***********                        65 '------------------------'    S01117
0763 O***********                        84 '-------------------'         S01117
0762 O                                   69 '-----------------------'     S01117
     O        T  2     LR                                                 E15057
     O                                   26 'NUMBER OF RECORDS'           E15057
     O                                   36 'PROCESSED'                   E15057
     O                         COUNT 1   46                               E15057
     O        T  2     LR                                                 E15057
     O********T 31     LR                                                 E15057
0765 O***********                        66 'INPUT'                       S01117
0765 O                    32 33          66 'INPUT'                       S01117
0765 O                    32 34          66 'INPUT'                       S01117
0765 O                   N32             66 'INPUT'                       S01117
0766 O                                   90 'CALCULATED'
     O********T  2     LR                                                 E15057
0768 O********                           26 'NUMBER OF RECORDS'           E15057
     O********                 NORE  1   66                         E11617E15057
0769 O********                 COUNT 1   90                               E15057
     O        T  2     LR
0771 O                                   29 'TOTAL VALUE - DEBITS'
0772 O***********              DHWN  4   64                               S01117
0772 O                    32 33DHWN  4   64                               S01117
0772 O                    32 34DHWN  4   64                               S01117
0772 O                   N32   DHWN  4   64                               S01117
0773 O****                     DHDC      66                               E11615
0780 O***********              DHDC      67                         E11615S01117
0780 O                    32 33DHDC      67                               S01117
0780 O                    32 34DHDC      67                               S01117
0780 O                   N32   DHDC      67                               S01117
0774 O                         HASHDW4   88
0775 O****                     HASHDD    90                               E11615
0782 O                         HASHDD    91                               E11615
0776 O                       41         115 '*** OUT OF BALANCE ***'
     O        T  2     LR
0778 O                                   30 'TOTAL VALUE - CREDITS'
0779 O***********              CHWN  4   64                               S01117
0779 O                    32 33CHWN  4   64                               S01117
0779 O                    32 34CHWN  4   64                               S01117
0779 O                   N32   CHWN  4   64                               S01117
0780 O****                     CHDC      66                               E11615
0780 O***********              CHDC      67                         E11615S01117
0780 O                    32 33CHDC      67                               S01117
0780 O                    32 34CHDC      67                               S01117
0780 O                   N32   CHDC      67                               S01117
0781 O                         HASHCW4   88
0782 O****                     HASHCD    90                               E11615
0782 O                         HASHCD    91                               E11615
0783 O                       42         115 '*** OUT OF BALANCE ***'
     O        T  2     LRN48                                              S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
0375 O        T 21     U7 U8 LR                                           S01194
0376 O                                   42 '*** REFERENCE'               S01194
0377 O                         DBPGM     53                               S01194
0378 O                                   73 '-DATABASE ERROR AT'          S01194
0379 O                         DBASE     77                               S01194
0380 O        T  1     U7 U8 LR                                           S01194
0381 O                                   37 'FILE NAME'                   S01194
0382 O                         DBFILE    48                               S01194
0383 O                                   53 'KEY'                         S01194
0384 O                         DBKEY     83                               S01194
0784 O********T*3      LR                                                 S01117
0785 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
