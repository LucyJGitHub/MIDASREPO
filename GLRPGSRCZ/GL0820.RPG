0001 H                                                                    GL0820
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas End of Calendar Year Update')                    *
0002 F********************************************************************GL0820
0010 F*                                                                  *GL0820
     F*  Midas - General Ledger Module
0004 F*                                                                  *GL0820
0005 F*       GL0820 - END OF CALENDER YEAR UPDATE                       *GL0820
0006 F*                                                                  *GL0820
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *GL0820
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CRE073             Date 06Dec10               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CLE025             Date 20Oct03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 091582             Date 14Aug95               *
      *                 S01117             Date 15/03/89              *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  MD046248 - Finastra Rebranding                               *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CLE025 - Credit Lines (Recompile)                            *
     F*       091582  -  STATEMENT PAGE NUMBER NOT RESET AT END OF       *
     F*                  CALENDAR YEAR.                                  *
     F*       S01117  -  MULTIBRANCHING                                  *
0010 F*                                                                  *GL0820
0011 F********************************************************************GL0820
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F*CCNT***UP* F     400 15AI     2 DISK                               S01117
0012 FACCNT   UP  F     400 18AI     2 DISK                               S01117
0012 FSDBANKPDIF  E                    DISK                               091582
0013 F* ID F  C  H  L    FUNCTION OF INDICATORS                           GL0820
0014 F* 01            DETAIL RECORD                                       GL0820
0015 F* 02            CATCH ALL                                           GL0820
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1                                               091582
     E*                                                                   091582
0016 IACCNT   NS  01   1 CD                                               GL0820
0017 I       OR        1 CC                                               GL0820
0018 I*                                                                   GL0820
0019 I*    CATCH ALL                                                      GL0820
0020 I        NS                                                          GL0820
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C           FIRST     IFNE 'Y'                                       091582
     C                     MOVE 'Y'       FIRST   1                       091582
     C                     MOVEACPY@      BIS@   80
     C*                                                                   091582
     C                     READ SDBANKPD                 50               091582
     C                     MOVE '0'       *IN98                           091582
     C                     Z-ADDBJRDNB    ZDAYNO                          091582
     C                     EXSR ZDATE2                                    091582
     C                     MOVE ZDATE     RDNBYR  20                      091582
     C                     Z-ADDBJDNWD    ZDAYNO                          091582
     C                     EXSR ZDATE2                                    091582
     C                     MOVE ZDATE     DNWDYR  20                      091582
     C*                                                                   091582
     C** IF THE DATE NEXT WORKING DAY AND RUN DATE YEARS ARE THE SAME     091582
     C** EXIT THE PROGRAM ELSE DO END OF CALENDAR YEAR PROCESSING.        091582
     C*                                                                   091582
     C           RDNBYR    IFEQ DNWDYR                                    091582
     C                     MOVE '1'       *INLR                           091582
     C                     RETRN                                          091582
     C                     END                                            091582
     C*                                                                   091582
     C                     END                                            091582
     C*                                                                   091582
0021 C*    ZEROISE LAST STATEMENT PAGE NUMBER &                           GL0820
0022 C*    LAST INTEREST STATEMENT PAGE NUMBER                            GL0820
0023 C                     Z-ADD0         LSPN    30                      GL0820
     C*                                                                   091582
     C/COPY ZSRSRC,ZDATE2Z2                                               091582
     C*                                                                   091582
0024 OACCNT   D        01                                                 GL0820
0025 O                         LSPN      82P                              GL0820
0026 O                         LSPN     238P                              GL0820
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
