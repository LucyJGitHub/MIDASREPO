0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Check for end of year')                          *
0001 H***********                                                         S01194
0002 F********************************************************************
     F*  Midas   GENERAL LEDGER MODULE                                GL1121
0004 F*                                                                  *
0005 F*                  GL0830 - CHECK FOR END OF YEAR                  *
0006 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                                  *
      *  Last Amend No. CER059             Date 24Sep10               *
      *  Prev Amend No. BUG28116           Date 08Sep10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
0009 F*                 S01194             Date 08/03/89              *
0012 F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *     CER059 -   Data area LDA length does not match program       *
      *                data area.                                        *
      *     BUG28116 -  The market centre entered is not currently       *
      *                 available transaction maintenance                *
     F*     S01194  -  NEW STANDING DATA                                 *
     F*                                                                  *
0013 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0014 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
     F/COPY WNCPYSRC,GL0830F001
     E                    CPY@    1   1 80
0015 I*ABLE***NS* 01   1 CD   2 C0   3 C1                                 S01194
0016 I*******AND*     12 C1  13 C0                                        S01194
0017 I***********                             1   1 RECI                  S01194
0018 I***********                             2   30RECT                  S01194
0019 I***********                            12  130RCDE                  S01194
0020 I***********                            14  66 TITL                  S01194
0021 I***********                            67  67 DATF                  S01194
0022 I***********                            68  700DFBR                  S01194
0023 I***********                            73  73 SWIM                  S01194
0024 I***********                            74  74 MODI1                 S01194
0025 I***********                            75  75 MODI2                 S01194
0026 I***********                            76  76 MODI3                 S01194
0027 I***********                         P  77  790RUND                  S01194
0028 I***********                            80  86 RUNA                  S01194
0029 I***********                            87  870SFLG                  S01194
0030 I***********                         P  90  920LCD                   S01194
0031 I***********                            93  93 CHTP                  S01194
0032 I***********                         P  94  960TNLU                  S01194
0033 I***********                                                         S01194
0034 I***********                                                         S01194
0035 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
     I***********                                                         S01194
     I********NS* 02   1 CD   2 C0   3 C1                                 S01194
     I*******AND*     12 C1  13 C1                                        S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            12  130RCDE                  S01194
     I***********                            14  16 BCCY                  S01194
     I***********                            17  19 BCYL                  S01194
     I***********                            20  22 HOCY                  S01194
     I***********                            23  280HEAD                  S01194
     I***********                         P  29  310APDA                  S01194
     I***********                            35  35 APFQ                  S01194
     I***********                         P  36  380LOGS                  S01194
     I***********                            39  40 CUZR                  S01194
     I***********                         P  41  430DNWD                  S01194
     I***********                            44  460BVLP                  S01194
     I***********                            47  49 LOCY                  S01194
     I***********                            50  510FDAY                  S01194
     I***********                            52  52 ACLD                  S01194
     I***********                         P  54  560EOYD                  S01194
     I***********                            86  86 ISAV                  S01194
     I***********                         P  87  890LLOG                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I********NS*                                                         S01194
     I***********                             1   1 RECI                  S01194
     I*
     I*   LOCAL DATA AREA - DATABASE ERRORS
     I*
     I***DS         UDS                                                                     BUG28116
     I*DA        UDS                                                                BUG28116  CER059
     ILDA        UDS                            256                                           CER059
     I***********                           134 138 DBFILE                S01194
     I***********                           139 167 DBKEY                 S01194
     I***********                           168 175 DBPGM                 S01194
     I***********                           176 1770DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I**                                                                  S01194
     I**   DEFINE EXTERNAL DS OVER DUMMY PHYSICAL FILES                   S01194
     I**                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*    BANK DETAILS                                                   S01194
     I*
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C                     MOVEACPY@      BIS@   80
     C*
     C***ACCESS*ICD1                                                      S01194
     C*  ACCESS BANK DETAILS                                              S01194
     C*
     C                     MOVEL'GL0830  'DBPGM                           S01194
     C***********          EXSR ZSYSTM                                    S01194
     C***99******          SETON                     U7U8LR               S01194
     C***99******          Z-ADD1         DBASE            * DB ERROR 01 *S01194
     C***********          MOVEL'GL0830  'DBPGM                           S01194
     C***********          MOVEL'TABLE'   DBFILE                          S01194
     C***99******          MOVELZTABKY    DBKEY                           S01194
     C***99******          GOTO END                                       S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'001'     DBASE            * DBERR 001 *  S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN  7                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*
     C***ACCESS*ICD2                                                      S01194
     C***********                                                         S01194
     C***********          MOVE '11'      ZTABKY                          S01194
     C***********ZTABKY    CHAINTABLE                99                   S01194
     C**N02******                                                         S01194
     C*R*99******          SETON                     U7U8LR               S01194
     C***U8******          MOVELZTABKY    DBKEY                           S01194
     C***U8******          Z-ADD02        DBASE            * DB ERROR 02 *S01194
     C***U8******          GOTO END                                       S01194
     C**
     C/COPY WNCPYSRC,GL0830C001
     C***********DNWD      COMP EOYD                 U6                   S01194
     C           BJDNWD    IFGT BJEYD                                     S01194
     C                     MOVE '1'       *INU6                           S01194
     C                     ELSE                                           S01194
     C                     MOVE '0'       *INU6                           S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,GL0830C002
     C**
     C           END       TAG                             *** END TAG ***
     C                     SETON                     LR
     C**
     C********************************************************************
     C***********                                                         S01194
     C*****ZSYSTM*SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
     C***********                                                         S01194
     C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
     C***********                                                         S01194
     C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD                     S01194
     C***********          MOVEL'01      'ZTABKY 12                       S01194
     C***********          MOVE '  10'    ZTABKY                          S01194
     C***********                                                         S01194
     C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C***********                                                         S01194
     C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C***********                                                         S01194
     C***********          ENDSR                                          S01194
     C***********                                                         S01194
     C***********                                                         S01194
     C********************************************************************S01194
0421 C********************************************************************S01194
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C**                                                                  S01194
     C*****************************************************************   S01194
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
