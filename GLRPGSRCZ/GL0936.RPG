0001002005280001 H
000200200528      *****************************************************************
000300200528/*STD *  RPGBASE                                                      *
000400200528/*EXI *  TEXT('Midas Increase File Size - STRAN')
0005002005280002 F********************************************************************
0006002005280010 F*                                                                  *
000700200528     F*  Midas - General Ledger Module
0008002005280004 F*                                                                  *
0009002005280005 F*       GL0936 - STRAN FILE SIZE INCREASE                          *
0010002005280006 F*                                                                  *
001100200528     F*  (c) Finastra International Limited 2001                         *
0012002005280008 F*                                                                  *
001300200604     F*  Last Amend No. 253731             Date 22May20               *
001400200528      *  Prev Amend No. MD046248           Date 27Oct17               *
001500200528      * Bank Fusion Midas 1.4 Base -----------------------------------*
001600200528      * Midas Plus 1.4 Base 04 ---------------------------------------*
001700200528      * Midas Plus 1.4 Base ------------------------------------------*
001800200528      * Midas Plus 1.3 ----------- Base ------------------------------*
001900200528      * Midas Release 4 --------------- Base -------------------------*
002000200528      * Midas DBA 3.00 ---------------- Base -------------------------*
0021002005280009 F*                  DT0072               DATE 02MAY91               *
0022002005280010 F*                                                                  *
002300200528     F*----------------------------------------------------------------
002400200528      *  253731 - Update GLTEMP when change in size is permanent.     *
002500200528     F*   MD046248 - Finastra Rebranding
002600200528     F*   DT0072   Add processing for STRANH
0027002005280011 F********************************************************************
0028002005280010 F*                                                                  *
002900200528     F*  C R E A T I O N     P A R A M E T E R S                      *
003000200528     F*                                                               *
003100200528     F*                                                               *
003200200528     F*****************************************************************
003300200528     FSTRAN   UF  F     200            DISK
003400200528     FSTRANH  UF  E                    DISK                               DT0072
003500200528     FMFLSZFM CF  E                    WORKSTN
003600200528     F*
003700200528     F**  FUNCTION OF INDICATORS
003800200528     F* 01       STRAN FILE
003900200528     F* 03       INCREMENT FILE SIZE BY 100 RECORDS
004000200528     F* 11       ERROR IN SCREEN INPUT - TWO INPUTS,ONLY ONE ALLOWED
004100200528     F* 13       ERROR IN SCREEN INPUT - NON NUMERIC FILE SIZE
004200200528     F* 14       ERROR IN SCREEN INPUT - NO INPUT TO SCREEN
004300200528     F* 21       EXCEPTION OUTPUT TO STRAN
004400200528     F* 38       SCREEN INPUT ERROR
004500200528     F* 39       FAILED CHAIN TO STRAN
004600200528     F*
004700200528     F*    U7    SET ON BY CMD/3 NO INCREASE
004800200528     F*    U8    DATABASE ERROR - STRAN HEADER NOT FOUND
004900200528     F/SPACE 5
005000200528     E                    CPY@    1   1 80
0051002005280188 E                    ZA1        16  1               ZALIGN SR. ARRAY
0052002005280189 E                    ZA2        16  1               ZALIGN SR. ARRAY
005300200528     F/SPACE 5
005400200528     I**
005500200528     I**  STRAN FILE
005600200528     I**
005700200528     ISTRAN   NS  01
005800200528     I                                        1   1 RECI
005900200528     I                                        2   60NAVT
006000200528     I                                        7  110MNT
006100200528     I                                       12  160NORC
006200200528     I                                       17  210NOMA
006300200528     I**
006400200528     I** STATUS DATA STRUCTURE
006500200528     I**
006600200528     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
006700200528     ICPYR@#      DS
006800200528     I                                        1  80 CPY@
006900200528     I                                        1  20 CPY@##
007000200528     IGLSTAT     UDS                            256
007100200528     I                                       16  200STAN90
007200200528     I                                       21  250STAN95
007300200528     I                                       26  300NSTRAN
007400200528     IGLTEMP     UDS                            256                                           253731
007500200528     I                                       16  200TSTN90                                    253731
007600200528     I                                       21  250TSTN95                                    253731
007700200528     I                                       26  300TSTRAN                                    253731
007800200528     I/EJECT
007900200528     C                     MOVEACPY@      BIS@   80
008000200528     C           *ENTRY    PLIST
008100200528     C                     PARM           INCR    1
008200200528     C                     PARM           MNT     50
008300200528     C*
008400200528     C                     MOVE 'STRAN'   FLNAM   5
008500200528     C*
008600200528     C           1         CHAINSTRAN                39
008700200528     C*
008800200528     C           *IN39     IFEQ '1'
008900200528     C                     SETON                     LRU8
009000200528     C                     RETRN
009100200528     C                     END
009200200528     C*
009300200528     C           1         CHAINSTRANHF              39                   DT0072
009400200528     C*                                                                   DT0072
009500200528     C           *IN39     IFEQ '1'                                       DT0072
009600200528     C                     MOVEL'STRANF  'DBFILE 10         ************* DT0072
009700200528     C                     MOVEL'01'      DBASE   3         *DBERROR 001* DT0072
009800200528     C                     SETON                     LRU8   ************* DT0072
009900200528     C                     EXSR *PSSR                                     DT0072
010000200528     C                     RETRN                                          DT0072
010100200528     C                     END                                            DT0072
010200200528     C*
010300200528     C                     Z-ADDMNT       FLSIZ   50
010400200528     C*
010500200528     C           *IN38     DOUEQ'0'
010600200528     C                     EXFMTMFLSZF1
010700200528     C                     SETOF                     031138
010800200528     C                     SETOF                     13
010900200528     C*
011000200528     C   KC                SETON                     LRU7
011100200528     C   KC                RETRN
011200200528     C*
011300200528     C** NUMERIC CHECK FOR FILE SIZE ENTRY
011400200528     C                     MOVEL*BLANK    ZFIELD 16
011500200528     C                     MOVELNEWSIZ    ZFIELD
011600200528     C                     Z-ADD0         ZADEC   10
011700200528     C                     Z-ADD5         ZADIG   20
011800200528     C                     EXSR ZALIGN
011900200528     C   99                SETON                     3813
012000200528     C                     MOVE ZFIELD    WORKN   50
012100200528     C*
012200200528     C* CHECK FOR SCREEN INPUT
012300200528     C           INCMT     COMP 'Y'                      03
012400200528     C           *IN03     IFEQ '0'
012500200528     C           NEWSIZ    IFEQ '     '
012600200528     C                     SETON                     1438
012700200528     C                     END
012800200528     C                     ELSE
012900200528     C*
013000200528     C* CHECK ONLY ONE SCREEN INPUT
013100200528     C           WORKN     IFGT 0
013200200528     C                     SETON                     3811
013300200528     C                     END
013400200528     C                     END
013500200528     C                     END
013600200528     C*
013700200528     C** INCREMENT FILE SIZE BY 100 RECORDS
013800200528     C           *IN03     IFEQ '1'
013900200528     C           MNT       ADD  100       MNT     50
014000200528     C                     MOVE 'Y'       INCR    1
014100200528     C                     ELSE
014200200528     C*
014300200528     C** UPDATE GLSTAT & HEADER WITH NEW SIZE
014400200528     C           WORKN     IFGT NSTRAN
014500200528     C                     MOVE 'Y'       INCR    1
014600200528     C                     END
014700200528     C*
014800200528     C                     Z-ADDWORKN     NSTRAN
014900200528     C           NSTRAN    MULT .95       STAN95
015000200528     C           NSTRAN    MULT .90       STAN90
015100200528     C                     Z-ADDNSTRAN    TSTRAN                                              253731
015200200528     C                     Z-ADDSTAN95    TSTN95                                              253731
015300200528     C                     Z-ADDSTAN90    TSTN90                                              253731
015400200528      *                                                                                       253731
015500200528     C*
015600200528     C                     Z-ADDWORKN     MNT
015700200528     C                     END
015800200528     C*
015900200528     C                     SETON                     21
016000200528     C                     EXCPT
016100200528     C                     SETOF                     21
016200200528     C*
016300200528     C                     SETON                     LR
016400200528     C                     RETRN
016500200528     C*
016600200528     C********************************************************************
016700200528     C**
016800200528     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
016900200528     C**
017000200528     C           ZALIGN    BEGSR                           *** ZALIGN ***
017100200528     C**
017200200528     C                     SETOF                     929399
017300200528     C**
017400200528     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
017500200528     C                     MOVEAZFIELD    ZA1
017600200528     C**
017700200528     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
017800200528     C                     Z-ADDZADIG     ZADIG   20
017900200528     C                     Z-ADDZADEC     ZADEC   10
018000200528     C**
018100200528     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
018200200528     C                     MOVE ' '       ZA2
018300200528     C                     MOVEAZA2       ZFIELD 16
018400200528     C                     Z-ADD0         ZX      20
018500200528     C                     Z-ADD0         ZY      20
018600200528     C**
018700200528     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
018800200528     C           ZADIG     ADD  ZADEC     ZZ      20
018900200528     C           ZZ        COMP 15                   99
019000200528     C   99                GOTO ZAEND
019100200528     C**
019200200528     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
019300200528     C           ZATAG1    TAG                             ** ZATAG1 TAG *
019400200528     C           ZX        ADD  1         ZX
019500200528     C**
019600200528     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
019700200528     C           ZA1,ZX    COMP '.'                      90
019800200528     C   90 93             SETON                     99
019900200528     C   99                GOTO ZAEND
020000200528     C**
020100200528     C**
020200200528     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
020300200528     C           ZA1,ZX    COMP 'M'                      96
020400200528     C   96                DO
020500200528     C           ZX        ADD  1         ZX
020600200528     C           ZA1,ZX    COMP ' '                  9999
020700200528     C   99                GOTO ZAEND
020800200528     C           ZX        SUB  1         ZX
020900200528     C           ZX        COMP 9                    99
021000200528     C   99                GOTO ZAEND
021100200528     C                     END
021200200528     C**
021300200528     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
021400200528     C           ZA1,ZX    COMP 'T'                      97
021500200528     C   97                DO
021600200528     C           ZX        ADD  1         ZX
021700200528     C           ZA1,ZX    COMP ' '                  9999
021800200528     C   99                GOTO ZAEND
021900200528     C           ZX        SUB  1         ZX
022000200528     C           ZX        COMP 12                   99
022100200528     C   99                GOTO ZAEND
022200200528     C                     END
022300200528     C**
022400200528     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
022500200528     C   96
022600200528     COR 97                MOVE ' '       ZA1,ZX
022700200528     C**
022800200528     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
022900200528     C           ZA1,ZX    COMP ' '                      91
023000200528     C   91 92             GOTO ZATAG2
023100200528     C**
023200200528     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
023300200528     C  N90N91   ZA1,ZX    COMP '0'                    99
023400200528     C  N90N91N99ZA1,ZX    COMP '9'                  99
023500200528     C   99                GOTO ZAEND                      NOT NUMERIC
023600200528     C**
023700200528     C**   STORE DIGITS IN ARRAY AND HOW MANY.
023800200528     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
023900200528     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
024000200528     C  N90N91   ZY        ADD  1         ZY         92
024100200528     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
024200200528     C   90                Z-ADDZY        ZZ         93  93
024300200528     C**
024400200528     C           ZX        COMP 16                     94  CHECK IF ALL
024500200528     C   94                GOTO ZATAG1
024600200528     C**
024700200528     C           ZATAG2    TAG                             ** ZATAG2 TAG *
024800200528     C**
024900200528     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
025000200528     C   96      ZZ        ADD  6         ZZ
025100200528     C**
025200200528     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
025300200528     C   97      ZZ        ADD  3         ZZ
025400200528     C**
025500200528     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
025600200528     C   96 93
025700200528     COR 97 93   ZZ        DOWGTZY
025800200528     C           ZY        ADD  1         ZY
025900200528     C                     MOVE '0'       ZA2,ZY
026000200528     C                     END
026100200528     C**
026200200528     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
026300200528     C   96N93             DO   6
026400200528     C           ZY        ADD  1         ZY
026500200528     C                     MOVE '0'       ZA2,ZY
026600200528     C                     END
026700200528     C**
026800200528     C   97N93             DO   3
026900200528     C           ZY        ADD  1         ZY
027000200528     C                     MOVE '0'       ZA2,ZY
027100200528     C                     END
027200200528     C**
027300200528     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
027400200528     C  N93                Z-ADDZY        ZZ
027500200528     C**
027600200528     C**   CHECK FOR EMBEDDED BLANKS.
027700200528     C   91 92             MOVEAZA1,ZX    ZFIELD
027800200528     C   91 92   ZFIELD    COMP ' '                  9999
027900200528     C   99                GOTO ZAEND                      EMBEDDED BLANK
028000200528     C**
028100200528     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
028200200528     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
028300200528     C           ZZ        COMP ZADIG                99
028400200528     C           ZY        SUB  ZZ        ZX
028500200528     C  N99      ZADEC     SUB  ZX        ZX           9995
028600200528     C   99                GOTO ZAEND
028700200528     C   95                GOTO ZATAG4                     NO TRAILING
028800200528     C**                                                   BLANKS.
028900200528     C**   FILL THE TRAILING BLANKS WITH ZEROS.
029000200528     C           ZY        ADD  ZX        ZZ
029100200528     C           ZATAG3    TAG                             ** ZATAG3 TAG *
029200200528     C           ZY        ADD  1         ZY
029300200528     C                     MOVE '0'       ZA2,ZY
029400200528     C           ZY        COMP ZZ                     94
029500200528     C   94                GOTO ZATAG3
029600200528     C**
029700200528     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
029800200528     C           ZATAG4    TAG                             ** ZATAG4 TAG *
029900200528     C                     MOVE '0'       ZA1
030000200528     C                     Z-ADD16        ZX
030100200528     C           ZATAG5    TAG                             ** ZATAG5 TAG *
030200200528     C           ZY        COMP 0                        94
030300200528     C   94                GOTO ZATAG6
030400200528     C                     MOVE ZA2,ZY    ZA1,ZX
030500200528     C           ZY        SUB  1         ZY
030600200528     C           ZX        SUB  1         ZX
030700200528     C                     GOTO ZATAG5
030800200528     C           ZATAG6    TAG                             ** ZATAG6 TAG *
030900200528     C**
031000200528     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
031100200528     C                     MOVEAZA1       ZFIELD
031200200528     C**
031300200528     C                     SETOF                     9697
031400200528     C**
031500200528     C           ZAEND     ENDSR                           * ZAEND ENDSR *
031600200528     C**
031700200528     C**
031800200528     C********************************************************************
031900200528     C*                                                                   DT0072
032000200528     C           *PSSR     BEGSR                                          DT0072
032100200528     C*                                                                   DT0072
032200200528     C           @RUN      IFEQ *BLANK                                    DT0072
032300200528     C                     MOVE 'Y'       @RUN    1                       DT0072
032400200528     C                     DUMP                                           DT0072
032500200528     C                     END                                            DT0072
032600200528     C*                                                                   DT0072
032700200528     C                     ENDSR                                          DT0072
032800200528     C********************************************************************
032900200528     O/SPACE 10
033000200528     O**
033100200528     O** STRAN FILE
033200200528     O**
033300200528     OSTRAN   E        21
033400200528     O                         MNT       11
033500200528     OSTRANHF E        21                                                 DT0072
033600200528     O                         MNT                                        DT0072
033700200528** CPY@   **      OBJECT COPYRIGHT
033800200528(c) Finastra International Limited 2001
