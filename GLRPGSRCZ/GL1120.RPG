0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Amount accrual input-Init scrn setup')           *
0001 H***********                                                         S01194
0002 F********************************************************************GL1120
0003 F*                                                                  *GL1120
     F*  Midas - General Ledger Module
0005 F*                                                                  *GL1120
0006 F*     GL1120 - AMOUNT ACCRUAL INPUT - S/AMACC                      *GL1120
0007 F*              INITIAL SCREEN SET-UP                               *GL1120
0008 F*                                                                  *GL1120
      *  (c) Finastra International Limited 2001                      *
0010 F*                                                                  *GL1120
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD029265           Date 15Aug14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CAAA03             Date 16Apr04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CGL003             Date 11Dec96               *
0011 F*                 S01194             Date 16Mar89               *  *GL1120
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  MD029265 - Cannot complete accrual input insert due to       *
      *             missing narrative upon 'Enter' (Recompile)        *
      *  CAAA03 - Webfacing Changes (Recompile)                       *
     F*     CGL003  -  Recompile for changes to DSPF/GL1120FM            *
     F*     S01194  -  NEW STANDING DATA                                 *
0012 F*                                                                  *GL1120
0013 F********************************************************************GL1120
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0018 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0016 FGL1120FMCF  E                    WORKSTN                            GL1120
0019 F*                                                                   GL1120
0020 F*       FUNCTION OF INDICATORS                                      GL1120
0021 F*       STANDARD INPUT PROGRAM INDICATORS                           GL1120
0022 F*       U7 U8   DATABASE ERROR                                      GL1120
0023 F*       89      BLINK ACTION CODE LABEL                             GL1120
0024 F*       88      NON-DISPLAY ERROR MESSAGE/CODES                     GL1120
0025 F*       87      NON-DISPLAY CHANGE DETAILS                          GL1120
0026 F*       86      NON-DISPLAY USEFUL DATA                             GL1120
0027 F*       85      OUTPUT ENQUIRE - SE - SCREEN                        GL1120
0028 F*       84      OUTPUT DELETE - SD - SCREEN                         GL1120
0029 F*       83      OUTPUT AMEND - SA - SCREEN                          GL1120
0030 F*       82      OUTPUT INSERT - SI - SCREEN                         GL1120
0031 F*       81      OUTPUT INITIAL - SF - SCREEN                        GL1120
0032 F*       80      BLINK DELETE CHECK FIELD LABEL                      GL1120
0033 F*       79      SYSTEM SET-UP FLAG ON                               GL1120
0034 F*       78      SCREENS READ IN                                     GL1120
0035 F*       77      SCREENS READ IN                                     GL1120
0036 F*       76      SPARE                                               GL1120
0037 F*       NON-STANDARD INPUT PROGRAM INDICATORS                       GL1120
     E                    CPY@    1   1 80
0041 I***********                                                         S01194
0042 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0043 I***********                                                         S01194
0044 I*ABLE***NS*      2 C0   3 C1  12 C1                                 S01194
0045 I*******AND*     13 C0                                               S01194
0046 I***********                             1   1 RECI                  S01194
0047 I***********                             2   30RECT                  S01194
0048 I***********                            12  130RCDE                  S01194
0049 I***********                            14  66 TITL                  S01194
0050 I***********                            67  67 DATF                  S01194
0051 I***********                            68  700DFBR                  S01194
0052 I***********                            74  74 MODI1                 S01194
0053 I***********                            75  75 MODI2                 S01194
0054 I***********                            76  76 MODI3                 S01194
0055 I***********                         P  77  790RUND                  S01194
0056 I***********                            80  86 RUNA                  S01194
0057 I***********                            87  870SFLG                  S01194
0058 I***********                         P  90  920LCD                   S01194
0059 I***********                            93  93 CHTP                  S01194
0060 I***********                         P  94  960TNLU                  S01194
0061 I***********                                                         S01194
0062 I*****CATCHALL                                                       S01194
0063 I********NS*                                                         S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*                                                                   S01194
     I**   BANK DETAILS                                                   S01194
     I*                                                                   S01194
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     IRUNDT       DS                                                      S01194
     I*                                                                   S01194
     I* External DTAARA for run-date                                      S01194
     I*                                                                   S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
0064 I*                                                                   GL1120
0065 I*    STANDARD LOCAL DATA AREA FIELDS                                GL1120
0066 I*                                                                   GL1120
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
0067 ILDA        UDS                            256                       GL1120
0068 I                                        1   8 LPROC                 GL1120
     I***********                           134 138 LFILE                 S01194
     I***********                           139 167 LKEY                  S01194
     I***********                           168 175 LPROG                 S01194
     I***********                           176 1770LDBNO                 S01194
0073 I**********                            181 1850LRUND                 S01194
0074 I**********                            186 192 LRUNA                 S01194
0075 I**********                            193 193 LDATF                 S01194
0076 I***********                           194 1940LSFLG                 S01194
0077 I**********                            195 1960LKEYL                 S01194
0078 I**********                            197 202 LISP                  S01194
0079 I**********                            203 203 LTWOL                 S01194
0080 I**********                            204 2040LLDLP                 S01194
0081 I**********                            205 2090LTNLU                 S01194
0082 I**********                            210 210 LDELM                 S01194
0083 I**********                            211 211 LDUD                  S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
0073 I                                      184 1880LRUND                 S01194
0074 I                                      189 195 LRUNA                 S01194
0075 I                                      196 196 LDATF                 S01194
0076 I                                      197 197 LSFLG                 S01194
0077 I                                      198 1990LKEYL                 S01194
0078 I                                      200 205 LISP                  S01194
0079 I                                      206 206 LTWOL                 S01194
0080 I                                      207 2070LLDLP                 S01194
0081 I                                      208 2120LTNLU                 S01194
0082 I                                      213 213 LDELM                 S01194
0083 I                                      214 214 LDUD                  S01194
     I*
     IPSDS       SDS
     I                                      244 246 SWID
     C                     MOVEACPY@      BIS@   80
     C*
     C           *NAMVAR   DEFN           LDA
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C           *LOCK     IN   LDA
     C                     IN   RUNDT                                     S01194
     C**
     C                     SETOF                     01
     C   01                READ GL1120FM                 02
0085 C*  WPROG IS THIS PROGRAM NAME                                       GL1120
0086 C*                                                                   GL1120
0090 C                     MOVE 'GL1120  'WPROG   8                       GL1120
0091 C*                                                                   GL1120
0092 C*  SET-UP STANDARD LDA                                              GL1120
0093 C*                                                                   GL1120
0094 C                     MOVE ' '       BLK29  29                       GL1120
0095 C                     MOVE '1  '     LPROC                           GL1120
0096 C**********           MOVE BLK29     LKEY                            S01117
0096 C                     MOVE BLK29     DBKEY                           S01117
0097 C**********           MOVE WPROG     LPROG                           S01117
0097 C                     MOVE WPROG     DBPGM                           S01117
0098 C**********           Z-ADD0         LDBNO                           S01117
0098 C                     Z-ADD0         DBASE                           S01117
0099 C                     MOVELWPROG     LISP                            GL1120
0100 C                     MOVE 'N'       LTWOL                           GL1120
0101 C                     Z-ADD0         LLDLP                           GL1120
0102 C                     Z-ADD0         LTNLU                           GL1120
0107 C*                                                                   GL1120
0108 C***EXECUTE*SYSTEM*SUBR.*ZSYSTM.**                                   S01194
0109 C***********                                                         S01194
0110 C***********          EXSR ZSYSTM                                    S01194
     C                     EXSR SYSTM                                     S01194
     C           *INU8     IFEQ '1'                                       S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0111 C*                                                                   GL1120
0112 C**N99******          GOTO NERR1                                     S01194
0113 C***********          SETON                     U7                   S01194
0114 C***********          MOVE 'TABLE'   LFILE                           S01194
0115 C***********          MOVELZTABKY    LKEY                            S01194
0116 C***********          MOVE '90'      LDBNO            ** DB ERROR 90 S01194
0117 C***********          GOTO END                                       S01194
0118 C*                                                                   GL1120
0119 C***********NERR1     TAG                             ** NERR1 TAG   S01194
0120 C*                                                                   GL1120
0121 C                     MOVE RUND      LRUND                           GL1120
0122 C                     MOVE RUNA      LRUNA                           GL1120
0123 C                     MOVE DATF      LDATF                           GL1120
0124 C***********          MOVE SFLG      LSFLG                           S01194
     C                     MOVE SSF       LSFLG                           S01194
0125 C*                                                                   GL1120
0126 C*    SET INDICATORS AND O/P INITIAL SCREEN.                         GL1120
0127 C*                                                                   GL1120
0128 C                     SETON                     8881                 GL1120
0129 C                     MOVE 'SF'      SID                             GL1120
0130 C                     MOVELWPROG     SPID                            GL1120
0131 C*                                                                   GL1120
     C                     WRITEGL1120F1
     C**
0132 C           END       TAG                             ** END TAG     GL1120
     C**
     C                     OUT  LDA
     C*
     C                     RETRN
0135 C*                                                                   GL1120
0315 C********************************************************************S01194
0316 C**                                                                  S01194
     C**   SYSTM - SUBROUTINE TO OBTAIN THE BANK DETAILS VIA THE ACCESS   S01194
     C**           OBJECT 'AOBANKR0'                                      S01194
     C**                                                                  S01194
     C**   CALLED BY - MAIN PROGRAM                                       S01194
     C**                                                                  S01194
     C**   CALLS     - ACCESS OBJECT 'AOBANKR0'                           S01194
0318 C**                                                                  S01194
     C********************************************************************S01194
0319 C           SYSTM     BEGSR                           **SYSTM SR. ** S01194
0320 C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL'001'     DBASE            * DB ERROR 001 S01194
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
0330 C**                                                                  S01194
0331 C                     ENDSR                           **  SYSTM  **  S01194
0333 C**                                                                  S01194
0136 C********************************************************************GL1120
0137 C***********                                                         S01194
0138 C*****ZSYSTM*SR.*TO*CHAIN*TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0139 C***********                                                         S01194
0140 C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0141 C***********                                                         S01194
0142 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0143 C***********          MOVEL'01      'ZTABKY 12                       S01194
0144 C***********          MOVE '  10'    ZTABKY                          S01194
0145 C***********                                                         S01194
0146 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0147 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0148 C***********                                                         S01194
0149 C*****CHECK*SYSTEM*DATE*FORMAT, DDMMYY OR MMDDYY.                    S01194
0150 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0151 C***********                                                         S01194
0152 C***********          ENDSR                                          S01194
0153 C***********                                                         S01194
0154 C***********                                                         S01194
0155 C********************************************************************GL1120
     C*                                                                   S01194
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01194
     C*                                                                   S01194
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01194
     C*                                                                   S01194
     C* CALLS: NOTHING                                                    S01194
     C*                                                                   S01194
     C*****************************************************************   S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                           ** *PSSR **    S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C*                                                                   S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                           ** *PSSR **    S01194
     C********************************************************************S01194
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
