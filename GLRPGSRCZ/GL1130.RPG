0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Amount accrual audit and list')               *
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas GENERAL LEDGER MODULE
0005 F*                                                               *
0006 F*  GL1130 - AMOUNT ACCRUALS AUDIT AND LIST - S/AMACC            *
0007 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0009 F*                                                               *
      *  Last Amend No. MD039015           Date 02Feb14               *
      *  Prev Amend No. CGL141             Date 12Dec12               *
      *                 AR787620           Date 10Jun11               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CGL064             Date 10Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CGL003             Date 13Dec96               *
      *                 063151             Date 07Feb94               *
     F*                 RT0088             DATE 14MAY91               *
     F*                 BHF077             DATE 17MAY90               *
     F*                 S01117             DATE 13/03/89              *
     F*                 S01194             DATE 13/03/89              *
0010 F*                 E13623             DATE 13/06/88              *
0011 F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD039015 - Report GL1130P1 incorrectly showing matured       *
      *             accrual journals. Check for matured records only  *
      *             when CGL141 is switched on. (Recompile)           *
      *  CGL141 - Amount Accruals Extended Narrative.                 *
      *           Added Hooks: CGL141_023 to CGL141_030               *
      *         - Applied fix AR747984:                               *
      *            FOOB in component GLC1130 (Child: AR747985)        *
      *           Amended Hooks: CGL141_026                           *
      *           Added Hooks:   CGL141_031                           *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,GLH00074                                 *
      *             WNCPYSRC,GLH00077                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *  CGL064 - Associated Customer / Cost Centre Validation        *
      *           Changes                                             *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  CGL003 - Add fields for Accrual Frequency on Amount          *
     F*           Accruals                                            *
     F*  063151 - Incorrect Profit Centre Definition                  *
     F*  RT0088 - WRITE 'NO LIVE DETAILS TO REPORT' IF ONLY MATURED   *
     F*           ACCRUAL RECORDS EXIST                               *
     F*  BHF077 - HEADER IN CONSOLIDATED REPORT PRINTING FOR EACH     *
     F*           BRANCH CODE                                         *
0011 F*  S01117 - MULTIBRANCHING                                      *
     F*  S01194 - NEW STANDING DATA                                   *
0011 F*  E13623 - CCY CODE & CDP ARRAYS EACH INCREASED TO ACCEPT      *
0011 F*           A MAXIMUM OF 150 ENTRIES.                           *
0011 F*                                                               *
0012 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*MACC***IP* F     128  7AI     2 DISK                               S01117
0013 F**AMACCL1 IP  F     128  7AI     2 DISK                       S01117CGL003
0013 F***AMACCL1 IP  F     134  7AI     2 DISK                                         CGL003 CGL029
     F***AMACCL1 IP  F     154  7AI     2 DISK                                         CGL029 CGL064
     FAMACCL1 IP  F     160  7AI     2 DISK                                                   CGL064
0014 F**MASTU   UF  F     128  7AI     2 DISK                       GL1130CGL003
0014 FMASTU   UF  F     134  7AI     2 DISK                               CGL003
0015 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0016 F*ABLED**IF* F      96 12AI     2 DISK                               S01194
     FSDCURRL0IF  E           K        DISK                               S01194
     F/COPY WNCPYSRC,GL1130F001
     F/COPY OFCPYSRCZ,CGL141_023                                                              CGL141
0017 F*L1130P1O** F     132     OF     PRINTER                  S01124    S01117
     FGL1130P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0016 FGL1130AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0018 F*                                                                   GL1130
0019 F*       U8      FILE OUT OF BALANCE                                 GL1130
0020 F*       U7      DATABASE ERROR                                      GL1130
     F*       46      Accrual Frequency on Amount Accrual Switch          CGL003
     F*       40      ALLOW OUTPUT ON CHANGE OF BRANCH                    S01117
0021 F*       89      MASTER FILE - HEADER                                GL1130
0022 F*       88      MASTER FILE - TRAILER -ANY TRAILER-                 GL1130
0023 F*       87      MASTER FILE - DETAIL RECORD -CORRECT RECORD TYPE-   GL1130
0024 F*       86      MASTER FILE - CORRECT TRAILER FOUND ON CHAIN        GL1130
0025 F*       85      FIRST CYCLE IND.                                    GL1130
0026 F*       84      PRINT THIS DETAIL RECORD                            GL1130
0027 F*       83      PRINT HEADINGS                                      GL1130
0028 F*       82      NO INPUT TODAY                                      GL1130
0029 F*       81      AUDIT REPORT WITH NO INPUT TODAY -U1 AND 82-        GL1130
0030 F*       80      UPDATE TRAILER BY EXCEPTION OUTPUT                  GL1130
0031 F*       79      FILE OUT OF BALANCE - NUMBER OF ACTIVE RECORDS      GL1130
0032 F*       78      FILE OUT OF BALANCE - LIVE RECORDS AFTER INPUT      GL1130
0033 F*       77      LISTING REPORT WITH NO DETAILS TO REPORT            GL1130
0034 F*       76      SPARE                                               GL1130
0035 F*       75      ACTIVE DETAIL RECORD READ - RECI NOT *              GL1130
0036 F*       74      LIVE DETAIL RECORD READ - RECI IS D AND CHTP NOT D  GL1130
0037 F*       73      DETAIL RECORD UPDATED TODAY - LCD EQUALS RUN DATE   GL1130
0038 F********72*     CURRENCY RECORD ON TABLED FILE                      S01194
0039 F********71*     TABLED CATCHALL                                     S01194
0040 F*       63      CURRENCY HAS 3 DECIMAL PLACES                       GL1130
0041 F*       62      CURRENCY HAS 2 DECIMAL PLACES                       GL1130
0042 F*       61      CURRENCY HAS 1 DECIMAL PLACE                        GL1130
0043 F*       60      CURRENCY HAS 0 DECIMAL PLACES                       GL1130
0044 F*       59      DELETE RECORD                                       GL1130
     F*                                                                   S01117
     F*       50      LIVE ACCRUALS EXIST FOR A BRANCH FOR A LISTING      RT0088
     F*       39      DETAIL RECORD PRESENT                               S01117
     F*       38      CONTROL CHECK DONE & O/P TRAILER PART ON AU REPORT  S01117
     F*       37      BRANCH CODE NOT ON BRANCH CODE FILE                 S01117
     F*       35      REPORT ON ONE BRANCH ONLY REQUESTED                 S01117
     F*       34      REPORT ON ALL BRANCHES REQUESTED                    S01117
     F*       33      CONSOLIDATED REPORT REQUESTED                       S01117
     F*       32      MULTIBRANCHING INDICATOR = 'Y'                      S01117
     F*       31      PROFIT CENTER USED = 'Y'                            S01117
     F*                                                                   S01117
     E                    CPY@    1   1 80
0045 E*    STANDARD TABLES/ARRAYS                                         GL1130
0046 E*                                                                   GL1130
0047 E*    RN/RW/RD,1 ARE COUNT/HASH OF ACTIVE RECORDS                    GL1130
0048 E*    RN/RW/RD,2 ARE COUNT/HASH OF LIVE RECORDS                      GL1130
0049 E*    RN,3 IS COUNT OF RECORDS UPDATED TODAY. RW/RD,3 ARE NOT USED   GL1130
0050 E*    RN/RW/RD,4 ARE COUNT/HASH OF LIVE RECORDS CALCULATED FROM TRLR GL1130
0051 E                    RN          4  5 0                              GL1130
0052 E                    RW          4 15 0                              GL1130
0053 E                    RD          4  3 0                              GL1130
0054 E*    ARRAYS OF CURRENCY CODES, NAMES AND DECIMAL PLACES.            GL1130
0055 E*    NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.                  GL1130
0056 E***********         ACCY       99  3                                E13623
0056 E                    ACCY      150  3                                E13623
0057 E******************  ACNM       99 14                                GL1130
0058 E***********         ACDP       99  1 0                              E13623
0058 E                    ACDP      150  1 0                              E13623
0059 E*    ARRAYS OF COUNTS AND HASH TOTALS IN THE MASTER FILE TRAILER    GL1130
0060 E                    NR          5  5 0                              GL1130
0061 E                    WN          5 15 0                              GL1130
0062 E                    DC          5  3 0                              GL1130
0063 E*                                                                   GL1130
0064 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYGL1130
0065 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYGL1130
0066 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY GL1130
0067 E*    NON-STANDARD TABLES/ARRAYS                                     GL1130
     E/COPY WNCPYSRC,GLH00546
     F/COPY OFCPYSRCZ,CGL141_024                                                              CGL141
0068 I*    STANDARD FILES                                                 GL1130
0069 I*                                                                   GL1130
0070 I*    MASTER FILE - HEADER                                           GL1130
0071 I*                                                                   GL1130
0072 I*MACC***NS* 89   1 CA                                               S01117
0072 IAMACCL1 NS  89   1 CA                                               S01117
0073 I*                                                                   GL1130
0074 I*    MASTER FILE - TRAILER                                          GL1130
0075 I*                                                                   GL1130
0076 I        NS  88   1 CZ                                               GL1130
0077 I*                                                                   GL1130
0078 I*    MASTER FILE - DETAIL                                           GL1130
0079 I*                                                                   GL1130
0080 I        NS  87   8 CA                                               GL1130
0081 I                                        1   1 MRECI                 GL1130
0082 I                                        2   70MREFN                 GL1130
0083 I                                        8   8 MREFT                 GL1130
0084 I                                    P  31  330MTNLU                 GL1130
0085 I                                    P  34  360MORED                 GL1130
0086 I                                    P  37  390MLCD                  GL1130
0087 I                                       40  40 MCHTP                 GL1130
0088 I                                    P  41  470MHASH                 GL1130
0089 I                                    P  41  470MAMNT                 GL1130
0090 I                                       48  50 MCCY                  GL1130
0091 I                                    P  51  530MSDAT                 GL1130
0092 I                                    P  54  560MMDAT                 GL1130
0093 I**********                             57  600MDRAC                              GL1130 CGL029
     I                                       57  600QQDRAC                                    CGL029
0094 I**********                             61  660MDRCN                 GL1130              CSD027
0094 I                                       61  66 MDRCN                 GL1130              CSD027
0095 I**********                             67  700MCRAC                              GL1130 CGL029
     I                                       67  700QQCRAC                                    CGL029
0096 I**********                             71  760MCRCN                 GL1130              CSD027
0096 I                                       71  76 MCRCN                 GL1130              CSD027
0097 I                                       77 106 MNARR                 GL1130
0098 I                                    P 107 1130MAMPD                 GL1130
0099 I                                      114 1150MDRSQ                 GL1130
0100 I                                      116 1170MCRSQ                 GL1130
     I**************************************122 1250MPRFC          S01117 063151
     I                                      122 125 MPRFC                 063151
     I                                      126 128 BRCA  L1              S01117
     I                                      129 129 MAPFQ                 CGL003
     I                                      130 1310MFDAY                 CGL003
     I                                    P 132 1340MAPDA                 CGL003
     I                                      135 1440MDRAC                                     CGL029
     I                                      145 1540MCRAC                                     CGL029
     I                                      155 1600MASOC                                     CGL064
0101 I*                                                                   GL1130
0102 I*    CATCHALL                                                       GL1130
0103 I        NS  05                                                      GL1130
0104 I*                                                                   GL1130
0105 I*    MASTER FILE - TRAILER                                          GL1130
0106 I*                                                                   GL1130
0107 IMASTU   NS  86   1 CZ                                               GL1130
0108 I                                        1   1 RECI                  GL1130
0109 I                                    P  31  330TNLU                  GL1130
0110 I                                       34  34 IRRI            82    GL1130
0111 I                                    P  35  49 NR                    GL1130
0112 I                                    P  50  89 WN                    GL1130
0113 I                                    P  90  99 DC                    GL1130
0114 I*                                                                   GL1130
0115 I*    CATCHALL                                                       GL1130
0116 I        NS  05                                                      GL1130
0117 I***********                                                         S01194
0118 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0119 I***********                                                         S01194
0120 I*ABLE***NS* 01                                                      S01194
0121 I***********                             1   1 RECI                  S01194
0122 I***********                             2   30RECT                  S01194
0123 I***********                            12  130RCDE                  S01194
0124 I***********                            14  66 TITL                  S01194
0125 I***********                            67  67 DATF                  S01194
0126 I***********                            68  700DFBR                  S01117
0127 I***********                            74  74 MODI1                 S01194
0128 I***********                            75  75 MODI2                 S01194
0129 I***********                            76  76 MODI3                 S01194
0130 I***********                         P  77  790RUND                  S01194
0131 I***********                            80  86 RUNA                  S01194
0132 I***********                            87  870SFLG                  S01194
0133 I***********                         P  90  920LCD                   S01194
0134 I***********                            93  93 CHTP                  S01194
0135 I***********                         P  94  960TNLU                  S01194
0136 I***********                                                         S01194
0137 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0138 I***********                                                         S01194
0139 I*ABLED**NS* 72   2 C2   3 C0                                        S01194
0140 I***********                             1   1 RECI                  S01194
0141 I***********                             2   30RECT                  S01194
0142 I***********                            10  12 CCY                   S01194
0143 I***********                            13  130SREC                  S01194
0144 I***********                            14  27 CCNM                  S01194
0145 I***********                         P  28  348SPOT                  S01194
0146 I***********                            35  37 CCYS                  S01194
0147 I***********                            38  380CDP                   S01194
0148 I***********                            39  390TNOT                  S01194
0149 I***********                            40  40 DCCY                  S01194
0150 I***********                            41  44 SRC1                  S01194
0151 I***********                            45  48 SRC2                  S01194
0152 I***********                            49  520TACC                  S01194
0153 I***********                            53  560TEQV                  S01194
0154 I***********                            57  600SWQV                  S01194
0155 I***********                            61  640TAC4                  S01194
0156 I***********                            65  680TAC5                  S01194
0157 I***********                            69  69 HIND                  S01194
0158 I***********                         P  70  768PART                  S01194
0159 I***********                            77  780SSNO                  S01194
0160 I***********                         P  79  858ERLC                  S01194
0161 I***********                            86  860MDIN                  S01194
0162 I***********                            87  870MDIA                  S01194
0163 I***********                            88  880MDIB                  S01194
0164 I***********                         P  90  920LCD                   S01194
0165 I***********                            93  93 CHTP                  S01194
0166 I***********                         P  94  960TNLU                  S01194
0167 I***********                                                         S01194
0168 I*****CATCHALL                                                       S01194
0169 I********NS* 71                                                      S01194
0170 I*                                                                   GL1130
0171 I*    DATA STRUCTURE FOR TABLE FILE KEY                              GL1130
0172 I*                                                                   GL1130
0173 I            DS                                                      GL1130
0174 I                                        1  12 TABKEY                GL1130
0175 I                                        1   2 TAB2                  GL1130
0176 I                                        9  11 TAB3A                 GL1130
0177 I                                       10  12 TAB3B                 GL1130
0178 I                                        9  12 TAB4                  GL1130
0179 I                                       12  12 TAB1                  GL1130
0180 I                                        6  11 TAB6                  GL1130
0181 I*                                                                   GL1130
0182 I*    STANDARD LOCAL DATA AREA FIELDS                                GL1130
0183 I*                                                                   GL1130
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
0184 ILDA        UDS                            256                       GL1130
0185 I***********                           134 138 LFILE                 S01194
0186 I***********                           139 167 LKEY                  S01194
0187 I***********                           168 175 LPROG                 S01194
0188 I***********                           176 1770LDBNO                 S01194
0185 I                                      134 141 LFILE                 S01194
0186 I                                      142 170 LKEY                  S01194
0187 I                                      171 180 LPROG                 S01194
0188 I                                      181 1830LDBNO                 S01194
     I**   RENAME FIELDS FOR EASY REFERENCE WHEN PROGRAM DUMP             S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  90 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE (FOR RUN CONTROL REPORT)       S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  90 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01194
     I**   EXTERNAL DTAARA FOR RUN-DATE                                   S01194
     I**                                                                  S01194
     IRUNDT       DS                                                      S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
     I**                                                                  S01194
     I**   DEFINE EXTERNAL DS OVER DUMMY PHYSICAL FILES                   S01194
     I**                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*    BANK DETAILS                                                   S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I*    BRANCH DETAILS                                                 S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01117
     I*    GENERAL LEDGER DETAILS                                         S01117
0195 I*                                                                   S01117
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I/COPY WNCPYSRC,GL1130I001
     I/COPY OFCPYSRCZ,CGL141_025                                                              CGL141
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     ISDCUST    E DSSDCUSTPD                                                                  CGL064
     I              QQDFAC                          QQDFC1                                    CGL064
      * Customer details data structure                                                       CGL064
      *                                                                                       CGL064
0196 I********************************************************************S01117
0200 C*                                                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3                       S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
0189 C*  INITIALISE TO -PRINT NO HEADINGS- AND -PRINT NO DETAILS-         GL1130
0190 C*                                                                   GL1130
0191 C                     SETOF                     8384                 GL1130
0192 C*                                                                   GL1130
0193 C  N85                EXSR FIRSTC                                    GL1130
0194 C                     SETON                     85                   GL1130
0195 C*                                                                   GL1130
0196 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR                          GL1130
0197 C*  AN AUDIT REPORT, GOTO LR PROCESSING.                             GL1130
0198 C*                                                                   GL1130
0199 C   U7                                                               GL1130
0200 COR U1 82             GOTO LASTR                                     GL1130
0201 C*                                                                   GL1130
0202 C*  IF HEADER OR TRAILER READ, GOTO LR PROCESSING                    GL1130
0203 C*                                                                   GL1130
0204 C   89                                                               GL1130
0205 COR 88                GOTO LASTR                                     GL1130
0206 C*                                                                   GL1130
0207 C*  IF INCORRECT - WRONG RECORD TYPE - DETAIL                        GL1130
0208 C*  RECORD READ, GOTO LR PROCESSING                                  GL1130
0209 C*                                                                   GL1130
0210 C  N87                GOTO LASTR                                     GL1130
0211 C*                                                                   GL1130
0212 C*  PROCESSING NOW CONSISTS OF RUN CONTROLS, RECORD FORMATTING       GL1130
0213 C*  FOR OUTPUT AND PRINTING THE RECORD.                              GL1130
0214 C*                                                                   GL1130
0215 C*                                                                   GL1130
0216 C*  RUN CONTROLS - AUDIT AND LIST CONTROLS ARE                       GL1130
0217 C*  MAINTAINED UNCONDITIONALLY                                       GL1130
0218 C*                                                                   GL1130
0219 C*  IF THERE IS NO HASH TOTAL FIELD ON THE MASTER FILE DETAIL RECORD,GL1130
0220 C*  THEN ZEROISE AND CONTINUE AS IF THERE IS.                        GL1130
0221 C*                                                                   GL1130
0222 C*******************  Z-ADD0         MHASH  130                      GL1130
     C*                                                                   S01117
     C**  IF CONSOLIDATED REPORT, OPEN OUTPUT DETAIL FILE ONCE            S01117
     C           BRNCH     IFEQ *BLANKS                                   S01117
     C           *IN40     IFNE '1'                                       S01117
     C                     SETON                     4083                 S01117
     C                     MOVE *BLANKS   SENTY                           S01117
     C                     EXSR OPENP1                                    S01117
     C                     ELSE                                           S01117
     C           *INL1     IFEQ '1'                                       S01117
     C           *INU1     ANDNE'1'                                       BHF077
     C                     SETON                     83                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*    AT CHANGE OF BRANCH CODE EXECUTE PRINT                         S01117
     C           *INL1     IFEQ '1'                                       S01117
     C           BRNCH     ANDNE*BLANKS                                   S01117
     C                     CLOSEGL1130P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     4083  ALLOW OUTPUT   S01117
     C                     SETOF                     50                   RT0088
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C                     MOVE BRCA      SENTY                           S01117
     C                     ELSE                                           S01117
     C                     MOVE BRNCH     SENTY                           S01117
     C                     END                                            S01117
     C                     EXSR OPENP1                                    S01117
     C*                                                                   S01117
     C           *IN32     IFEQ '1'                                       S01117
     C**                                                                  S01117
     C**  USE ACCESS PROGRAM TO READ BRANCH DETAILS                       S01117
     C                     MOVE *BLANKS   @DSNB                           S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL'093'     LDBNO            * DB ERROR 93 *S01117
     C                     MOVELBRCA      LKEY                            S01117
     C                     MOVEL'SDBRCHPD'LFILE                           S01117
     C                     MOVEL@OPTN     DBOPTN  7                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     SETON                     U7LR                 S01117
     C                     SETOF                     40                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C   U8                                                               S01194
     COR U7                GOTO END                                       S01194
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C**  IF SINGLE BRANCH REPORT REQUEST AND NO MORE DETAILS FOR         S01117
     C**  THAT BRANCH, END PROGRAM IMMEDIATELY                            S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     40                   S01117
     C                     GOTO LASTR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**  SET ON INDICATOR IF THERE ARE DETAILS TO REPORT                 S01117
     C  N39                SETON                         39               S01117
0223 C*                                                                   GL1130
0224 C*  COUNT ACTIVE RECORDS READ - RECI NOT *                           GL1130
0225 C*  MOVE HASH AMOUNT INTO ZZAMT FIRST.                               GL1130
0226 C*                                                                   GL1130
0227 C                     MOVE MHASH     ZZAMT                           GL1130
0228 C*                                                                   GL1130
0229 C           MRECI     COMP '*'                  7575                 GL1130
0230 C   75                Z-ADD1         H                               GL1130
0231 C   75                EXSR NPZTOT                                    GL1130
0232 C*                                                                   GL1130
0233 C*  COUNT LIVE RECORDS READ - RECI IS D AND CHTP IS NOT D            GL1130
0234 C*                                                                   GL1130
0235 C           MRECI     COMP 'D'                      74               GL1130
0236 C   74      MCHTP     COMP 'D'                  7474                 GL1130
     C/COPY WNCPYSRC,GLH00074
     C/COPY OFCPYSRCZ,CGL141_026                                                              CGL141
0237 C   74                Z-ADD2         H                               GL1130
0237 C   74N50             SETON                     50                   RT0088
0238 C   74                EXSR NPZTOT                                    GL1130
0239 C*                                                                   GL1130
0240 C*  COUNT RECORDS UPDATED TODAY - LCD IS RUN DATE                    GL1130
0241 C*                                                                   GL1130
0242 C           MLCD      COMP RUND                     73               GL1130
0243 C   73      RN,3      ADD  1         RN,3                            GL1130
0244 C*                                                                   GL1130
0245 C*   DETERMINE WHETHER RECORD IS TO BE OUTPUT AS INSERTED OR DELETED GL1130
0246 C*                                                                   GL1130
0247 C           MCHTP     COMP 'D'                      59               GL1130
     C/COPY WNCPYSRC,GLH00077
     C/COPY OFCPYSRCZ,CGL141_031                                                            AR747984
0248 C*                                                                   GL1130
0249 C*  IF AUDIT REPORT, RECORDS UPDATED TODAY ARE PRINTED.              GL1130
0250 C*  IF LISTING, LIVE RECORDS ARE PRINTED.                            GL1130
0251 C*  SET ON 84 IF THE RECORD IS TO BE PRINTED.                        GL1130
0252 C*                                                                   GL1130
0253 C   U1 73                                                            GL1130
0254 CORNU1 74             SETON                       84                 GL1130
0255 C*                                                                   GL1130
0256 C*  FORMAT THE RECORD IF IT IS TO BE PRINTED                         GL1130
0257 C*                                                                   GL1130
0258 C   84                EXSR FORMT                                     GL1130
0259 C*                                                                   GL1130
0260 C   84 U7             GOTO LASTR                                     GL1130
0261 C*                                                                   GL1130
0262 C*                                                                   GL1130
0263 C           LASTR     TAG                             ** LASTR TAG   GL1130
0264 C*                                                                   GL1130
0266 C*                                                                   GL1130
0267 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR                          GL1130
0268 C*  AN AUDIT REPORT, NO FILE CONTROL CHECK DONE.                     GL1130
0269 C*                                                                   GL1130
0270 CLR U7                                                               GL1130
0271 COR U1 82             GOTO END                                       GL1130
0272 C*                                                                   GL1130
0273 C*  FOR LIST, TEST FOR NO DETAILS TO REPORT                          GL1130
0274 C*                                                                   GL1130
0275 CLRNU1      RN,2      COMP 0                        77               GL1130
0276 C*                                                                   GL1130
0277 C*  TEST FOR ALL ACTIVE RECORDS READ - COUNT AND HASH                GL1130
     C*  SUPPRESS CHECK IF MBIN = 'Y' AND SINGLE BRANCH REQUESTED         S01117
     C*  IF CONTROL CHECK DONE SETON 38 TO OUTPUT FILE TRAILER            S01117
     C*  PART ON GL1130AU.                                                S01117
0278 C*                                                                   GL1130
     CLR         *IN32     IFEQ '1'                                       S01117
     CLR         *IN35     ANDEQ'0'                                       S01117
     CLR         *IN32     OREQ '0'                                       S01117
     CLR                   SETON                     38                   S01117
0279 CLR         RN,1      COMP NR,1                 7979                 GL1130
0280 CLRN79      RW,1      COMP WN,1                 7979                 GL1130
0281 CLRN79      RD,1      COMP DC,1                 7979                 GL1130
0282 CLR 79                SETON                     U8                   GL1130
     CLR                   END                                            S01117
0283 C*                                                                   GL1130
0284 C*  IF LISTING REPORT, GOTO END                                      GL1130
0285 C*                                                                   GL1130
0286 CLRNU1                GOTO END                                       GL1130
0287 C*                                                                   GL1130
0288 C*  CALCULATE NUMBER OF LIVE RECORDS FROM TRAILER                    GL1130
0289 C*                                                                   GL1130
0290 CLR         NR,2      ADD  NR,3      RN,4                            GL1130
0291 CLR         RN,4      SUB  NR,5      RN,4             ** TOTAL       GL1130
0292 C*                                                                   GL1130
0293 C*  CALCULATE HASH TOTAL OF LIVE RECORDS AFTER INPUT FROM TRAILER    GL1130
0294 C*                                                                   GL1130
0295 C*  PUT HASH OF LIVE RECORDS BEFORE INPUT INTO ZZ FIELDS             GL1130
0296 C*                                                                   GL1130
0297 CLR                   Z-ADDWN,2      ZZTOTI                          GL1130
0298 CLR                   Z-ADDDC,2      ZZTOTD                          GL1130
0299 C*                                                                   GL1130
0300 C*  ADD HASH OF INSERTED RECORDS                                     GL1130
0301 C*                                                                   GL1130
0302 CLR                   Z-ADDWN,3      ZZAMTI                          GL1130
0303 CLR                   Z-ADDDC,3      ZZAMTD                          GL1130
0304 CLR                   EXSR GLZSUM                                    GL1130
0305 C*                                                                   GL1130
0306 C*  ADD HASH OF AMENDMENTS                                           GL1130
0307 C*                                                                   GL1130
0308 CLR                   Z-ADDWN,4      ZZAMTI                          GL1130
0309 CLR                   Z-ADDDC,4      ZZAMTD                          GL1130
0310 CLR                   EXSR GLZSUM                                    GL1130
0311 C*                                                                   GL1130
0312 C*  SUBTRACT HASH OF DELETIONS                                       GL1130
0313 C*                                                                   GL1130
0314 CLR                   Z-SUBWN,5      ZZAMTI                          GL1130
0315 CLR                   Z-SUBDC,5      ZZAMTD                          GL1130
0316 CLR                   EXSR GLZSUM                                    GL1130
0317 C*                                                                   GL1130
0318 CLR                   MOVE ZZTOTI    RW,4                            GL1130
0319 CLR                   MOVE ZZTOTD    RD,4                            GL1130
0320 C*                                                                   GL1130
0321 C*  COMPARE PROGRAM'S COUNT AND HASH OF LIVE RECORDS                 GL1130
0322 C*  READ WITH THOSE JUST CALCULATED.                                 GL1130
     C*  SUPPRESS CHECK IF MBIN = 'Y' AND SINGLE BRANCH REQUESTED         S01117
0323 C*                                                                   GL1130
     CLR         *IN32     IFEQ '1'                                       S01117
     CLR         *IN35     ANDEQ'0'                                       S01117
     CLR         *IN32     OREQ '0'                                       S01117
0324 CLR         RN,2      COMP RN,4                 7878                 GL1130
0325 CLRN78      RW,2      COMP RW,4                 7878                 GL1130
0326 CLRN78      RD,2      COMP RD,4                 7878                 GL1130
0327 CLR 78                SETON                     U8                   GL1130
     CLR                   END                                            S01117
0328 C*                                                                   GL1130
0329 C*  IF DATABASE ERROR, GOTO END                                      GL1130
0330 C*                                                                   GL1130
0331 CLR U8                GOTO END                                       GL1130
     C*                                                                   S01117
     C*  IF CONTROL CHECK NOT DONE, SKIP TRAILER UPDATE                   S01117
     C*                                                                   S01117
     CLRN38                GOTO END                                       S01117
     C*                                                                   S01117
     C*  IF NO DETAIL RECORDS ON FILE, SKIP TRAILER UPDATE & OUTPUT       S01117
     C*  GL1130P1 WITH NO DETAILS MESSAGE                                 S01117
     C*                                                                   S01117
     CLRN39                GOTO END                                       S01117
0332 C*                                                                   GL1130
0333 C*  UPDATE CHAIN TO THE TRAILER                                      GL1130
0334 C*                                                                   GL1130
0335 CLR                   SETOF                     9986                 GL1130
0336 CLR         TRLRKY    CHAINMASTU                99                   GL1130
0337 CLRN99                                                               GL1130
0338 CAN 86                GOTO END01                                     GL1130
0339 CLR                   SETON                     U7    ** DB ERROR 92 GL1130
0340 CLR                   MOVELTRLRKY    LKEY                            GL1130
0341 CLR                   Z-ADD92        LDBNO                           GL1130
0342 CLR                   GOTO END                                       GL1130
0343 C*                                                                   GL1130
0344 CLR         END01     TAG                             ** END01 TAG   GL1130
0345 C*                                                                   GL1130
0346 C*  UPDATE THE TRAILER - IND 86 PERFORMS OUTPUT                      GL1130
0347 C*                                                                   GL1130
0348 CLR                   EXCPT                                          GL1130
0349 C*                                                                   GL1130
0350 CLR         END       TAG                             ** END TAG     GL1130
     C*                                                                   S01117
     C*  OUTPUT GL1130P1 HERE IF A SINGLE BRANCH REQUEST HAS NO           S01117
     C*  DETAILS TO REPORT                                                S01117
     CLR         *IN39     IFEQ '0'                                       S01117
     CLR         *INU7     ANDNE'1'                                       S01117
     CLR         *IN35     IFEQ '1'                                       S01117
     CLR         *IN32     OREQ '0'                                       S01117
     CLR         *IN35     IFEQ '1'                                       S01117
     CLR                   EXSR ACBRCH                                    S01117
     CLR         *IN37     IFEQ '1'                                       S01117
     CLR                   GOTO SKIP                                      S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     CLR                   OPEN GL1130P1                                  S01117
     CLR                   Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C*  ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUM     SFNUM1  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM BRNCH     SENTY   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           SFNUM1                          S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR         SKIP      TAG                             ** SKIP TAG ** S01117
     C*                                                                   S01117
     C*  ENSURE TOTAL SPOOL FILE RECORDED BY RCF                          S01117
     CLR                   Z-ADDSFNUMU    SFNUM2  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           SFNUM2                          S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0351 C*                                                                   GL1130
0352 C********************************************************************GL1130
0353 C**                                                                  GL1130
0354 C**   SUBR. - TO PERFORM FIRST CYCLE PROCESSING.                     GL1130
0355 C**                                                                  GL1130
0356 C           FIRSTC    BEGSR                           ***  FIRSTC ***GL1130
     C                     MOVEACPY@      BIS@   80
     C           *LOCK     IN   LDA                                       S01117
0357 C*                                                                   GL1130
0358 C*  SET-UP LDA FIELDS                                                GL1130
0359 C*                                                                   GL1130
0360 C***********          MOVE 'AMACC'   LFILE                           S01194
0361 C***********          MOVE 'GL1130  'LPROG                           S01194
     C                     MOVEL'AMACC'   LFILE                           S01194
     C                     MOVEL'GL1130  'LPROG                           S01194
0362 C*                                                                   GL1130
0363 C*  SET-UP BLANK LKEY                                                GL1130
0364 C*                                                                   GL1130
0365 C                     MOVE ' '       BLK200200                       GL1130
0366 C                     MOVE BLK200    LKEY                            GL1130
0367 C*                                                                   GL1130
0368 C*  SET-UP ZEROES                                                    GL1130
0369 C                     Z-ADD0         ZERO03  30                      GL1130
0370 C                     Z-ADD0         ZERO05  50                      GL1130
0371 C                     Z-ADD0         ZERO15 150                      GL1130
0372 C*                                                                   GL1130
0373 C*  SET-UP TRAILER KEY                                               GL1130
0374 C*                                                                   GL1130
0375 C                     MOVEL'999999A' TRLRKY  7                       GL1130
0205 C*                                                                   S01194
     C*  ACCESS DTAARA 'RUNDAT'                                           S01194
     C*                                                                   S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C                     IN   RUNDT                                     S01194
0511 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01194
     C**   CHECK MULTIBRANCHING INDICATOR AND TYPE OF REPORT REQUESTED    S01194
     C*                                                                   S01194
     C                     SETOF                     323334               S01194
     C                     SETOF                     35                   S01194
     C*                                                                   S01194
     C           MBIN      IFEQ 'Y'                        B1             S01194
     C                     SETON                     32     1             S01194
     C           BRNCH     IFEQ 'ALL'                      B2             S01194
     C                     SETON                     34     2             S01194
     C                     ELSE                            X2             S01194
     C           BRNCH     IFEQ *BLANKS                    B3             S01194
     C                     SETON                     33     3             S01194
     C                     ELSE                            X3             S01194
     C                     SETON                     35                   S01194
     C                     END                             E3             S01194
     C                     END                             E2             S01194
     C                     END                             E1             S01194
0376 C***********                                                         GL1130
0377 C***EXECUTE*ZSYSTM                                                   GL1130
0378 C***********                                                         GL1130
0379 C***********          EXSR ZSYSTM                                    S01194
0380 C**N99******          GOTO TAG01                                     S01194
     C*                                                                   S01194
     C*  ACCESS BANK DETAILS                                              S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0381 C                     SETON                     U7LR  ** DB ERROR 90 GL1130
0382 C***********          MOVE 'TABLE'   LFILE                           S01194
0383 C***********          MOVELZTABKY    LKEY                            S01194
0384 C***********          Z-ADD90        LDBNO                           S01194
     C                     MOVEL'SDBANKPD'LFILE                           S01194
     C                     MOVEL'*FIRST'  LKEY                            S01194
     C                     MOVEL'090'     LDBNO                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
0385 C                     GOTO ENDFC                                     GL1130
     C                     END                                            S01194
     C*                                                                   S01117
     C*  ACCESS GENERAL LEDGER DETAILS                                    S01117
     C*                                                                   S01117
     C**********           CALL 'AOGELRR0'                                             S01117 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7LR  ** DB ERROR 94 S01117
     C                     MOVEL'SDGELRPD'LFILE                           S01117
     C                     MOVEL'*FIRST'  LKEY                            S01117
     C                     MOVEL'094'     LDBNO                           S01117
     C                     MOVEL@OPTN     DBOPTN                          S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO ENDFC                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*  CHECK IF PROFIT CENTRE IS USED                                   S01117
     C*                                                                   S01117
     C           BKPRCU    IFEQ 'Y'                                       S01117
     C                     SETON                     31                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     31                   S01117
     C                     END                                            S01117
      *                                                                   CGL003
      **  Access Switchable features file for                             CGL003
      **  Accrual Frequency on Amount Accruals Processing - CGL003        CGL003
     C                     CALL 'AOSARDR0'                                CGL003
     C                     PARM *BLANKS   @RTCD                           CGL003
     C                     PARM '*VERIFY' @OPTN                           CGL003
     C                     PARM 'CGL003'  WSARD   6                       CGL003
     C           @RTCD     IFNE *BLANK                                    CGL003
     C           @RTCD     ANDNE'*NRF   '                                 CGL003
     C                     MOVEL'AOSARDR0'DBFILE            ************* CGL003
     C                     Z-ADD3         DBASE             *DBERROR 003* CGL003
     C                     MOVELWSARD     DBKEY             ************* CGL003
     C                     MOVEL@OPTN     DBOPTN                          CGL003
     C                     SETON                     U7U8LR               CGL003
     C                     EXSR *PSSR                                     CGL003
     C                     GOTO ENDFC                                     CGL003
     C                     ENDIF                                          CGL003
      *                                                                   CGL003
     C           @RTCD     IFEQ *BLANK                                    CGL003
     C                     MOVE 'Y'       CGL003  1                       CGL003
     C                     MOVE *ON       *IN46                           CGL003
     C                     END                                            CGL003
      *                                                                   CGL064
     C                     CALL 'AOSARDR0'                                CGL064
     C                     PARM *BLANKS   @RTCD                           CGL064
     C                     PARM '*VERIFY' @OPTN                           CGL064
     C                     PARM 'CGL064'  WSARD                           CGL064
      *                                                                   CGL064
     C           @RTCD     IFEQ *BLANK                                    CGL064
     C                     MOVE 'Y'       CGL064  1                       CGL064
     C                     MOVE *ON       *IN47                           CGL064
     C                     ELSE                                           CGL064
     C                     MOVE 'N'       CGL064                          CGL064
     C                     ENDIF                                          CGL064
     C/COPY WNCPYSRC,GL1130C001
     C/COPY OFCPYSRCZ,CGL141_027                                                              CGL141
0386 C*                                                                   GL1130
0387 C           TAG01     TAG                             ** TAG01 TAG   GL1130
0388 C*                                                                   GL1130
0389 C*  CHAIN TO THE TRAILER                                             GL1130
0390 C*                                                                   GL1130
0391 C                     SETOF                     9986                 GL1130
0392 C           TRLRKY    CHAINMASTU                99                   GL1130
0393 C  N99                                                               GL1130
0394 CAN 86                GOTO TAG02                                     GL1130
0395 C                     SETON                     U7LR  ** DB ERROR 91 GL1130
0396 C                     MOVELTRLRKY    LKEY                            GL1130
0397 C                     Z-ADD91        LDBNO                           GL1130
0398 C                     GOTO ENDFC                                     GL1130
0399 C*                                                                   GL1130
0400 C           TAG02     TAG                             ** TAG02 TAG   GL1130
0401 C*                                                                   GL1130
0402 C*  IF AUDIT REPORT AND NO INPUT TODAY, GOTO ENDFC                   GL1130
0403 C*                                                                   GL1130
0404 C   U1 82             SETON                     LR81                 GL1130
0405 C   U1 82             GOTO ENDFC                                     GL1130
0406 C*                                                                   GL1130
0407 C*  OUTPUT HEADINGS                                                  GL1130
0408 C***********          SETON                     83                   S01117
0409 C*                                                                   GL1130
0410 C*  BUILD TABLE OF CURRENCY NAMES AND DECIMAL PLACES.                GL1130
0411 C*  CCY NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.                GL1130
0412 C*                                                                   GL1130
0413 C***********          MOVE BLK200    TABKEY                          S01194
0414 C***********          MOVE '20'      TAB2                            S01194
0415 C***********TABKEY    SETLLTABLED                                    S01194
0416 C***********          Z-ADD0         J       30                      S01194
0417 C***********ARC       TAG                             ** ARC TAG     S01194
0418 C***********          SETOF                     727192               S01194
0419 C***********          READ TABLED                   91               S01194
0420 C***71******                                                         S01194
0421 C*R*91******          GOTO ENDFC                                     S01194
0422 C***********RECI      COMP 'D'                  9292                 S01194
0423 C**N92******SREC      COMP 1                    9292                 S01194
0424 C***92******          GOTO ARC                                       S01194
0425 C***********J         ADD  1         J                               S01194
0426 C***********          MOVE CCY       ACCY,J                          S01194
0427 C*******************  MOVE CCNM      ACNM,J                          GL1130
0428 C***********          MOVE CDP       ACDP,J                          S01194
0429 C***********          GOTO ARC                                       S01194
     C                     MOVE *BLANKS   CCYKEY  3                       S01194
     C           CCYKEY    SETLLSDCURRL0                                  S01194
     C                     Z-ADD0         J       30                      S01194
     C           ARC       TAG                             ** ARC TAG     S01194
     C                     READ SDCURRL0                 91               S01194
     C  N91      J         COMP 150                  91  91               S01194
     C   91                GOTO ENDFC                                     S01194
     C           J         ADD  1         J                               S01194
     C                     MOVE A6CYCD    ACCY,J                          S01194
     C                     MOVE A6NBDP    ACDP,J                          S01194
     C                     GOTO ARC                                       S01194
0430 C*                                                                   GL1130
0431 C           ENDFC     TAG                             ** ENDFC TAG   GL1130
0432 C*                                                                   GL1130
0434 C*                                                                   GL1130
0435 C                     ENDSR                                          GL1130
0436 C*                                                                   GL1130
     C********************************************************************S01117
     C**                                                                  S01117
     C**   SUBR. OPENP1 - TO OPEN PRINTER FILE AND CALL ZSFILE            S01117
     C**                                                                  S01117
     C           OPENP1    BEGSR                                          S01117
     C*                                                                   S01117
     C                     OPEN GL1130P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C**   SUBR. ACBRCH - TO ACCESS BRANCH DETAILS                        S01117
     C**                                                                  S01117
     C           ACBRCH    BEGSR                                          S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7LR37               S01117
     C                     SETOF                     40                   S01117
     C                     MOVEL'002'     LDBNO            * DBERR 002 *  S01117
     C                     MOVEL'SDBRCHPD'LFILE                           S01117
     C                     MOVELBRNCH     LKEY                            S01117
     C                     MOVEL@OPTN     DBOPTN                          S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
0437 C********************************************************************GL1130
0438 C**                                                                  GL1130
0439 C**   SUBR. - TO FORMAT RECORD DETAILS PRIOR TO PRINTING             GL1130
0440 C**                                                                  GL1130
0441 C           FORMT     BEGSR                           ***  FORMT  ***GL1130
0442 C*                                                                   GL1130
0443 C*  CHECK CURRENCY DECIMAL PLACES                                    GL1130
0444 C*                                                                   GL1130
0445 C                     SETOF                     606162               GL1130
0446 C                     SETOF                     63                   GL1130
0447 C                     Z-ADD1         J       30                      GL1130
0448 C           MCCY      LOKUPACCY,J                   91               GL1130
0449 C   91                GOTO FORMT1                                    GL1130
0450 C                     SETON                     U7LR  ** DB ERROR 01 GL1130
0451 C***********          MOVE 'TABLE'   LFILE                           S01194
0451 C                     MOVEL'SDCURRL0'LFILE                           S01194
0452 C                     MOVELMCCY      LKEY                            GL1130
0453 C                     Z-ADD1         LDBNO                           GL1130
0454 C                     GOTO FORMTE                                    GL1130
0455 C*                                                                   GL1130
0456 C           FORMT1    TAG                             ** FORMT1 TAG  GL1130
0457 C*                                                                   GL1130
0458 C           ACDP,J    COMP 1                    626061               GL1130
0459 C   62      ACDP,J    COMP 2                    63  62               GL1130
0460 C*                                                                   GL1130
0461 C*  FORMAT START DATE                                                GL1130
0462 C*                                                                   GL1130
0463 C                     Z-ADDMSDAT     ZDAYNO                          GL1130
0464 C                     EXSR ZDATE2                                    GL1130
0465 C                     MOVE ZADATE    WSDAT   7                       GL1130
0466 C*                                                                   GL1130
0467 C*  FORMAT MATURITY DATE                                             GL1130
0468 C*                                                                   GL1130
0469 C                     Z-ADDMMDAT     ZDAYNO                          GL1130
0470 C                     EXSR ZDATE2                                    GL1130
0471 C                     MOVE ZADATE    WMDAT   7                       GL1130
      *                                                                   CGL064
     C           CGL064    IFEQ 'Y'                                       CGL064
      *                                                                   CGL064
     C                     MOVE *BLANKS   RASOC   6                       CGL064
     C                     MOVE *BLANKS   RCSSN  10                       CGL064
     C                     MOVELMASOC     WKEY1                           CGL064
     C                     CALL 'AOCUSTR0'                                CGL064
     C                     PARM *BLANKS   @RTCD                           CGL064
     C                     PARM '*KEY   ' @OPTN                           CGL064
     C                     PARM           WKEY1  10                       CGL064
     C                     PARM *BLANKS   WKYST   7                       CGL064
     C           SDCUST    PARM SDCUST    DSSDY                           CGL064
      *                                                                   CGL064
     C           @RTCD     IFEQ *BLANKS                                   CGL064
     C                     MOVELBBCUST    RASOC                           CGL064
     C                     MOVELBBCSSN    RCSSN                           CGL064
     C                     ENDIF                                          CGL064
      *                                                                   CGL064
     C                     ENDIF                                          CGL064
     C/COPY WNCPYSRC,GL1130C002
     C/COPY OFCPYSRCZ,CGL141_028                                                              CGL141
     C*                                                                   CGL003
     C*  Is Accrual Frequency Switchable Feature Available?               CGL003
     C           CGL003    IFEQ 'Y'                                       CGL003
     C*                                                                   CGL003
     C*  FORMAT MATURITY DATE                                             CGL003
     C                     Z-ADDMAPDA     ZDAYNO                          CGL003
     C                     EXSR ZDATE2                                    CGL003
     C                     MOVE ZADATE    WAPDA   7                       CGL003
     C*                                                                   CGL003
     C                     ENDIF                                          CGL003
0472 C*                                                                   GL1130
0473 C*  STANDARD FORMATTING - FORMAT LAST CHANGE DATE                    GL1130
0474 C*                                                                   GL1130
0475 C                     Z-ADDMLCD      ZDAYNO                          GL1130
0476 C                     EXSR ZDATE2                                    GL1130
0477 C                     MOVE ZADATE    WLCD    7                       GL1130
0478 C*                                                                   GL1130
0479 C           FORMTE    ENDSR                           ** FORMTE TAG  GL1130
0480 C*                                                                   GL1130
0481 C********************************************************************GL1130
0482 C**                                                                  GL1130
0483 C**   SUBR. - TO ADD 1 TO RN,H AND TO ADD ZZAMT TO RW/RD,H           GL1130
0484 C**                                                                  GL1130
0485 C           NPZTOT    BEGSR                           ***  NPZTOT ***GL1130
0486 C                     Z-ADDH         H       10                      GL1130
0487 C*                                                                   GL1130
0488 C           RN,H      ADD  1         RN,H                            GL1130
0489 C*                                                                   GL1130
0490 C                     Z-ADDRW,H      ZZTOTI                          GL1130
0491 C                     Z-ADDRD,H      ZZTOTD                          GL1130
0492 C                     EXSR GLZADD                                    GL1130
0493 C                     Z-ADDZZTOTI    RW,H                            GL1130
0494 C                     Z-ADDZZTOTD    RD,H                            GL1130
0495 C*                                                                   GL1130
0496 C                     ENDSR                                          GL1130
0497 C********************************************************************S01194
0498 C***********                                                         S01194
0499 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0500 C***********                                                         S01194
0501 C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0502 C***********                                                         S01194
0503 C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0504 C***********          MOVEL'01      'ZTABKY 12                       S01194
0505 C***********          MOVE '  10'    ZTABKY                          S01194
0506 C***********                                                         S01194
0507 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0508 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0509 C***********                                                         S01194
0510 C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0511 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0512 C***********                                                         S01194
0513 C***********          ENDSR                                          S01194
0514 C***********                                                         S01194
0515 C***********                                                         S01194
0516 C********************************************************************GL1130
0517 C**                                                                  GL1130
0518 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            GL1130
0519 C**                                                                  GL1130
0520 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         GL1130
0521 C**                                                                  GL1130
0522 C           ZDATE2    BEGSR                           *** ZDATE2 *** GL1130
0523 C**                                                                  GL1130
0524 C**   CLEAR DATE FIELDS.                                             GL1130
0525 C                     Z-ADD0         ZDATE   60                      GL1130
0526 C                     MOVEL'       ' ZADATE  7                       GL1130
0527 C**                                                                  GL1130
0528 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        GL1130
0529 C                     Z-ADDZDAYNO    ZDAYNO  50                      GL1130
0530 C**                                                                  GL1130
0531 C**   DETERMINE YEAR NUMBER.                                         GL1130
0532 C**                                                                  GL1130
0533 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    GL1130
0534 C           ZDAYNO    SUB  1         ZDAYN1  50   99                 GL1130
0535 C   99                GOTO ZDEND2                                    GL1130
0536 C**                                                                  GL1130
0537 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             GL1130
0538 C           ZDAYN1    DIV  1461      ZLYR    20                      GL1130
0539 C                     MVR            ZDAYN1           SAVE REMAINING GL1130
0540 C**                                                   DAYS           GL1130
0541 C**   CALCULATE NUMBER OF REMAINING YEARS.                           GL1130
0542 C                     Z-ADD1         ZWRK2   20                      GL1130
0543 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *GL1130
0544 C           ZDAYN1    COMP ZYDY,ZWRK2             90                 GL1130
0545 C  N90      ZWRK2     ADD  1         ZWRK2                           GL1130
0546 C  N90                GOTO ZDTAG1                                    GL1130
0547 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON GL1130
0548 C**                                                                  GL1130
0549 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  GL1130
0550 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          GL1130
0551 C**                                                                  GL1130
0552 C**   CALCULATE ACTUAL YEAR NUMBER.                                  GL1130
0553 C           ZLYR      MULT 4         ZWRK3   30                      GL1130
0554 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   GL1130
0555 C                     Z-ADDZWRK3     ZYEAR   20                      GL1130
0556 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           GL1130
0557 C**                                                                  GL1130
0558 C**   DETERMINE MONTH NUMBER.                                        GL1130
0559 C**                                                                  GL1130
0560 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         GL1130
0561 C                     SETOF                     9293                 GL1130
0562 C   91      ZDAYN1    COMP 59                     9293               GL1130
0563 C   91N92   ZDAYN1    SUB  1         ZDAYN1                          GL1130
0564 C**                                                                  GL1130
0565 C**   CALCULATE MONTH NUMBER.                                        GL1130
0566 C                     Z-ADD2         ZWRK2                           GL1130
0567 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *GL1130
0568 C           ZDAYN1    COMP ZMDY,ZWRK2             94                 GL1130
0569 C  N94      ZWRK2     ADD  1         ZWRK2                           GL1130
0570 C  N94                GOTO ZDTAG2                                    GL1130
0571 C           ZWRK2     SUB  1         ZWRK2                           GL1130
0572 C**                                                                  GL1130
0573 C                     Z-ADDZWRK2     ZMTH    20       MONTH          GL1130
0574 C**                                                                  GL1130
0575 C**   DETERMINE DAY OF MONTH.                                        GL1130
0576 C**                                                                  GL1130
0577 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          GL1130
0578 C           ZDAYN1    ADD  1         ZDAYN1                          GL1130
0579 C**                                                                  GL1130
0580 C**   CALCULATE DAY OF MONTH.                                        GL1130
0581 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            GL1130
0582 C**                                                                  GL1130
0583 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       GL1130
0584 C   93      ZDAY      ADD  1         ZDAY                            GL1130
0585 C**                                                                  GL1130
0586 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 GL1130
0587 C  N98                MOVELZDAY      ZWRK4   40                      GL1130
0588 C   98                MOVE ZDAY      ZWRK4                           GL1130
0589 C  N98                MOVE ZMTH      ZWRK4                           GL1130
0590 C   98                MOVELZMTH      ZWRK4                           GL1130
0591 C                     MOVELZWRK4     ZDATE                           GL1130
0592 C                     MOVE ZYEAR     ZDATE                           GL1130
0593 C**                                                                  GL1130
0594 C**   FORMAT ALPHA DATE, DDMMMYY.                                    GL1130
0595 C           ZDAY      COMP 10                     95                 GL1130
0596 C                     MOVELZDAY      ZWRK5   5                       GL1130
0597 C   95                MOVEL' '       ZWRK5                           GL1130
0598 C                     MOVE ZMNM,ZMTH ZWRK5                           GL1130
0599 C                     MOVELZWRK5     ZADATE                          GL1130
0600 C                     MOVE ZYEAR     ZADATE                          GL1130
0601 C**                                                                  GL1130
0602 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*GL1130
0603 C**                                                                  GL1130
0604 C**                                                                  GL1130
0605 C********************************************************************GL1130
0606 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  GL1130
0607 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            GL1130
0608 C*                                                                   GL1130
0609 CSR         GLZADD    BEGSR                           *** GLZADD ****GL1130
0610 C*                                                                   GL1130
0611 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  GL1130
0612 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS GL1130
0613 C*                                                                   GL1130
0614 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       GL1130
0615 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  GL1130
0616 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  GL1130
0617 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  GL1130
0618 C*                                                                   GL1130
0619 CSR                   EXSR GLZSUM                                    GL1130
0620 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *GL1130
0621 C*                                                                   GL1130
0622 C********************************************************************GL1130
0623 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            GL1130
0624 C*                        GLZADD, GLZSUB, GLZCMP.                    GL1130
0625 C*          PARAMETERS PASSED -                                      GL1130
0626 C*                     I/P ZZAMTI ZZAMTD                             GL1130
0627 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       GL1130
0628 C*                                                                   GL1130
0629 CSR         GLZSUM    BEGSR                           *** GLZSUM ****GL1130
0630 C*                                                                   GL1130
0631 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  GL1130
0632 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  GL1130
0633 CSR                   SETOF                     919293               GL1130
0634 CSR                   SETOF                     949599               GL1130
0635 C*                                                                   GL1130
0636 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      GL1130
0637 CSR         ZZAMTI    COMP 0                      9293               GL1130
0638 CSR 93      ZZAMTD    COMP 0                      9293               GL1130
0639 CSR 93                GOTO ZZSEND                     ZERO BYPASS    GL1130
0640 C*                                                                   GL1130
0641 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       GL1130
0642 CSR         ZZTOTI    COMP 0                      9193               GL1130
0643 CSR 93      ZZTOTD    COMP 0                      9193               GL1130
0644 C*                                                                   GL1130
0645 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           GL1130
0646 CSR 93                Z-ADDZZAMTI    ZZTOTI                          GL1130
0647 CSR 93                Z-ADDZZAMTD    ZZTOTD                          GL1130
0648 CSR 93                GOTO ZZSEND                     ZERO BYPASS    GL1130
0649 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        GL1130
0650 CSR 91N92                                                            GL1130
0651 CORN91 92             GOTO ZZOFPS                                    GL1130
0652 C*                                                                   GL1130
0653 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      GL1130
0654 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   GL1130
0655 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.GL1130
0656 C*                                                                   GL1130
0657 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VEGL1130
0658 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VEGL1130
0659 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           GL1130
0660 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           GL1130
0661 C*                                                                   GL1130
0662 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    GL1130
0663 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. GL1130
0664 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      GL1130
0665 CSRN99                Z-ADDZZWK2     ZZTOTD                          GL1130
0666 CSRN99                Z-ADDZZWK3     ZZTOTI                          GL1130
0667 C*                                                                   GL1130
0668 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. GL1130
0669 CSR 99                Z-ADD0         ZZAMT  153                      GL1130
0670 CSR                   GOTO ZZSEND                                    GL1130
0671 C*                                                                   GL1130
0672 C* THE 'SIGNS' ARE DIFFERENT                                         GL1130
0673 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**GL1130
0674 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            GL1130
0675 C*                                                                   GL1130
0676 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      GL1130
0677 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      GL1130
0678 C*                                                                   GL1130
0679 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           GL1130
0680 C*                                                                   GL1130
0681 CSR 91                Z-SUBZZTOTI    ZZTOTI                          GL1130
0682 CSR 91                Z-SUBZZTOTD    ZZTOTD                          GL1130
0683 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            GL1130
0684 C*                                                                   GL1130
0685 CSR         ZZTOTI    COMP ZZAMTI               93  95               GL1130
0686 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               GL1130
0687 C*                                                                   GL1130
0688 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   GL1130
0689 CSR 95                Z-ADD0         ZZTOTI                          GL1130
0690 CSR 95                Z-ADD0         ZZTOTD                          GL1130
0691 CSR 95                GOTO ZZSEND                                    GL1130
0692 C*                                                                   GL1130
0693 C* IF ZZTOT GT. ZZAMT.                                               GL1130
0694 CSR 93      ZZAMTD    COMP ZZTOTD               94                   GL1130
0695 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          GL1130
0696 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           GL1130
0697 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          GL1130
0698 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          GL1130
0699 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          GL1130
0700 C*                                                                   GL1130
0701 C*                                                                   GL1130
0702 C* IF ZZAMT GT. ZZTOT.                                               GL1130
0703 CSRN93      ZZTOTD    COMP ZZAMTD               94                   GL1130
0704 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      GL1130
0705 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           GL1130
0706 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          GL1130
0707 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          GL1130
0708 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          GL1130
0709 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          GL1130
0710 C*                                                                   GL1130
0711 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          GL1130
0712 CSR                   SETOF                     94                   GL1130
0713 CSR 93 91                                                            GL1130
0714 CORN93 92             SETON                     94                   GL1130
0715 CSR 94                Z-SUBZZTOTI    ZZTOTI                          GL1130
0716 CSR 94                Z-SUBZZTOTD    ZZTOTD                          GL1130
0717 C**                                                                  GL1130
0718 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            GL1130
0719 CSR 92                Z-SUBZZAMTI    ZZAMTI                          GL1130
0720 CSR 92                Z-SUBZZAMTD    ZZAMTD                          GL1130
0721 CSR         ZZSEND    TAG                             ** ZZSEND TAG *GL1130
0722 C**                                                                  GL1130
0723 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           GL1130
0724 CSR                   SETOF                     96                   GL1130
0725 CSR         ZZTOTD    COMP 0                        91               GL1130
0726 CSR 91      ZZTOTI    COMP 0                      96                 GL1130
0727 CSR 96                MOVE '.000-'   ZZNEGD  5                       GL1130
0728 CSR                   ENDSR                             ** ENDSR **  GL1130
0729 C********************************************************************GL1130
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C**                                                                  S01194
     C/COPY WNCPYSRC,GLH00547
     C/COPY OFCPYSRCZ,CGL141_029                                                              CGL141
     C********************************************************************S01194
0730 O*  STANDARD OUTPUT                                                  GL1130
0731 O*                                                                   GL1130
0732 O*L1130P1H**203   83                                       S01124    S01117
0733 O*******OR**      OF                                                 S01117
0732 OGL1130P1H  203   83 40                                              S01117
0733 O       OR        OF 40                                              S01117
0734 O*                                                                   GL1130
0735 O*  STANDARD HEADINGS                                                GL1130
0736 O*                                                                   GL1130
0737 O***********                        22 'REFERENCE GL1130'            S01117
0737 O                                   24 'REFERENCE GL1130P1'          S01117
0738 O***********              TITL      89                               S01194
0738 O                         BJURPT    89                               S01194
0739 O                                  104 'DATE'                        GL1130
0740 O                         RUNA     112                               GL1130
0741 O                                  122 'PAGE'                        GL1130
0742 O                         PAGE  Z  126                               GL1130
0743 O********H**1     83                                                 S01117
0744 O*******OR**      OF                                                 S01117
0743 O        H  1     83 40                                              S01117
0744 O       OR        OF 40                                              S01117
0745 O                       U1          16 'AUDIT REPORT'                GL1130
0746 O                      NU1          18 'LISTING REPORT'              GL1130
0747 O*                                                                   GL1130
0748 O*  NAME OF FILE OR RECORD                                           GL1130
0749 O*                                                                   GL1130
0750 O***********                        66 'AMOUNT ACCRUALS'             S01117
0750 O                                   53 'AMOUNT ACCRUALS'             S01117
     O                    32N33          63 'BRANCH'                      S01117
     O                    32N33BRCA      67                               S01117
     O                    32N33          68 '-'                           S01117
     O                    32N33A8BRNM    98                               S01117
     O                       33          69 'CONSOLIDATED'                S01117
0751 O*                                                                   GL1130
0752 O*  STANDARD OUTPUT                                                  GL1130
0753 O*                                                                   GL1130
0755 O********H**2     83                                                 S01117
0756 O*******OR**      OF                                                 S01117
0755 O        H  2     83 40                                              S01117
0756 O       OR        OF 40                                              S01117
0757 O                       U1          16 '------------'                GL1130
0758 O                      NU1          18 '--------------'              GL1130
0759 O*                                                                   GL1130
0760 O*  UNDERLINE NAME OF FILE OR RECORD                                 GL1130
0761 O*                                                                   GL1130
0762 O***********                        66 '---------------'             S01117
0762 O                                   53 '---------------'             S01117
0763 O*                                                                   GL1130
0764 O*  NON-STANDARD DETAILS                                             GL1130
     O*                                                                   CGL003
     O        H  1     83 40                                              CGL003
     O       AND       46                                                 CGL003
     O       OR        OF 40                                              CGL003
     O       AND       46                                                 CGL003
     O                                   57 'START  MATURITY'             CGL003
0765 O*                                                                   GL1130
0766 O********H**1     83                                                 S01117
0767 O*******OR**      OF                                                 S01117
0766 O        H  1     83 40                                              S01117
0767 O       OR        OF 40                                              S01117
0768 O***********                        53 'START   MATURITY'            S01117
0769 O***********                        63 'DEBIT'                       S01117
0770 O***********                        80 'CREDIT'                      S01117
0771 O***********                       129 'ACTION'                      S01117
     O                       31          22 'PROFIT'                      S01117
     O***********                        57 'START  MATURITY'       S01117CGL003
     O                N46                57 'START  MATURITY'             CGL003
     O                 46                53 'DATE   DATE'                 CGL003
     O**********                         66 'DEBIT'                                    S01117 CGL029
     O**********                         82 'CREDIT'                                   S01117 CGL029
     O**********                        130 'ACTION'                                   S01117 CGL029
     O                                   98 'ACTION'                                          CGL029
0772 O********H**3     83                                                 S01117
0773 O*******OR**      OF                                                 S01117
0772 O********H* 3     83 40                                                           S01117 CGL029
     O        H  1     83 40                                                                  CGL029
0773 O       OR        OF 40                                              S01117
0774 O***********                        13 'REFERENCE CCY'               S01117
0775 O***********                        26 'AMOUNT'                      S01117
0776 O***********                        49 'DATE    DATE'                S01117
0777 O***********                        62 'A/C'                         S01117
0778 O***********                        78 'A/C'                         S01117
0779 O***********                       107 'NARRATIVE'                   S01117
0780 O***********                       131 'DATE / TYPE'                 S01117
     O                                   10 'REF.  CCY'                   S01117
     O                       32          15 'BCH'                         S01117
     O                       31          22 'CENTRE'                      S01117
     O                                   34 'AMOUNT'                      S01117
     O************                       53 'DATE   DATE'           S01117CGL003
     O                N46                53 'DATE   DATE'                 CGL003
     O                 46                58 'ACCRUAL FREQ/DATE'           CGL003
     O**********                         65 'A/C'                                      S01117 CGL029
     O**********                         80 'A/C'                                      S01117 CGL029
     O**********                        109 'NARRATIVE'                                S01117 CGL029
0780 O**********                        132 'DATE / TYPE'                              S01117 CGL029
     O                                   77 'NARRATIVE'                                       CGL029
     O                                  100 'DATE / TYPE'                                     CGL029
     O        H  3     83 40                                                                  CGL029
     O       OR        OF 40                                                                  CGL029
     O                                   67 'DEBIT A/C'                                       CGL029
     O                                   90 'CREDIT A/C'                                      CGL029
0781 O********D**2     84                                                 S01117
     O********D**2     84 40                                        S01117CGL003
     O        D  1     84 40                                              CGL003
0782 O***********              MREFN      7                               S01117
0783 O***********              MCCY      13                               S01117
0784 O***********            60MAMNT     33 ' ,   ,   ,   , 0 -'          S01117
0785 O***********            61MAMNT     33 '   ,   ,   , 0 . -'          S01117
0786 O***********            62MAMNT     33 '  ,   ,   , 0 .  -'          S01117
0787 O***********            63MAMNT     33 ' ,   ,   , 0 .   -'          S01117
0788 O***********              WSDAT     43                               S01117
0789 O***********              WMDAT     52                               S01117
0790 O***********              MDRCN     61                               S01117
0791 O***********                        62 '-'                           S01117
0792 O***********              MDRAC     66                               S01117
0793 O***********                        67 '-'                           S01117
0794 O***********              MDRSQ     69                               S01117
0795 O***********              MCRCN     78                               S01117
0796 O***********                        79 '-'                           S01117
0797 O***********              MCRAC     83                               S01117
0798 O***********                        84 '-'                           S01117
0799 O***********              MCRSQ     86                               S01117
0800 O***********              MNARR    118                               S01117
0801 O***********              WLCD     127                               S01117
     O                         MREFN      6                               S01117
     O                         MCCY      10                               S01117
     O                       32BRCA      15                               S01117
     O                       31MPRFC     21                               S01117
     O                       60MAMNT     40 ' ,   ,   ,   , 0 -'          S01117
     O                       61MAMNT     40 '   ,   ,   , 0 . -'          S01117
     O                       62MAMNT     40 '  ,   ,   , 0 .  -'          S01117
     O                       63MAMNT     40 ' ,   ,   , 0 .   -'          S01117
     O                         WSDAT     48                               S01117
     O                         WMDAT     56                               S01117
     O                         MNARR     88                                                   CGL029
     O                         WLCD      96                                                   CGL029
     O                      N59         100 'INS'                                             CGL029
     O                       59         100 'DEL'                                             CGL029
     O**********               MDRCN     64                                            S01117 CGL029
     O**********                         65 '-'                                        S01117 CGL029
     O**********               MDRAC     69                                            S01117 CGL029
     O**********                         70 '-'                                        S01117 CGL029
     O**********               MDRSQ     72                                            S01117 CGL029
     O**********               MCRCN     80                                            S01117 CGL029
     O**********                         81 '-'                                        S01117 CGL029
     O**********               MCRAC     85                                            S01117 CGL029
     O**********                         86 '-'                                        S01117 CGL029
     O**********               MCRSQ     88                                            S01117 CGL029
     O**********               MNARR    120                                            S01117 CGL029
   1 O**********               WLCD     128                                            S01117 CGL029
0802 O**********            N59         132 'INS'                                      GL1130 CGL029
0803 O**********             59         132 'DEL'                                      GL1130 CGL029
     O        D  1     84 40                                                                  CGL029
     O                         MDRCN     64                                                   CGL029
     O                                   65 '-'                                               CGL029
     O                         MDRAC     75                                                   CGL029
     O                                   76 '-'                                               CGL029
     O                         MDRSQ     78                                                   CGL029
     O                         MCRCN     86                                                   CGL029
     O                                   87 '-'                                               CGL029
     O                         MCRAC     97                                                   CGL029
     O                                   98 '-'                                               CGL029
     O                         MCRSQ    100                                                   CGL029
     O/COPY WNCPYSRC,GL1130O001
     C/COPY OFCPYSRCZ,CGL141_030                                                              CGL141
     O        D  1     84 40 47                                           CGL064
     O                                   21 'ASSOCIATED CUSTOMER :'       CGL064
     O                         RASOC     28                               CGL064
     O                         RCSSN     39                               CGL064
      *                                                                   CGL003
     O        D  2     84 40                                              CGL003
     O                 46      MAPFQ     43                               CGL003
     O                 46      MFDAY     47                               CGL003
     O                 46      WAPDA     56                               CGL003
0804 O***********                                                         S01117
0805 O***NO*DETAILS TO REPORT MESSAGE                                     S01117
0806 O***********                                                         S01117
0807 O********T** 40   LRNU1 77                                           S01117
0808 O***********                        72 '*** NO DETAILS TO REPORT'    S01117
0809 O***********                        76 ' ***'                        S01117
0810 O***********                                                         S01117
0811 O***DATABASE ERROR OUTPUT                                            S01117
0812 O***********                                                         S01117
0813 O********T*3      LR U7                                              S01117
0814 O***********                        38 'DATABASE ERROR NO.-'         S01117
0815 O***********              LDBNO     40                               S01117
0816 O***********                        48 'FILE-'                       S01117
0817 O***********              LFILE     53                               S01117
0818 O***********                        60 'KEY-'                        S01117
0819 O***********              LKEY      89                               S01117
0440 O***********                        72 '*DATABASE ERROR*'            S01117
0928 O*  OUTPUT DETAILS COMMON TO AUDIT AND LIST                          S01117
0929 O*                                                                   S01117
0932 O        T   40   L1 40N50                                           RT0088
     O       AND      NU1                                                 RT0088
     O                                   69 '*** NO LIVE DETAILS '        RT0088
     O                                   82 'TO REPORT ***'               RT0088
0932 O********T** 50   LR                                                 S01117
0932 O        T   50   L1 40 32                                           S01117
     O       AND      N33                                                 S01117
     O                                   69 '*** END OF REPORT FOR'       S01117
     O                                   84 'BRANCH     ***'              S01117
     O                         BRCA      80                               S01117
     O        T   50   L1 40N32                                           S01117
     O       OR        LR 40 33                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
     O*                                                                   S01117
     O*  NO DETAILS TO REPORT OUTPUT                                      S01117
     O*                                                                   S01117
0732 OGL1130P1E  203           NODTL                                      S01117
0734 O*                                                                   S01117
0735 O*  STANDARD HEADINGS                                                S01117
0736 O*                                                                   S01117
0737 O                                   24 'REFERENCE GL1130P1'          S01117
0738 O                         BJURPT    89                               S01117
0739 O                                  104 'DATE'                        S01117
0740 O                         RUNA     112                               S01117
0741 O                                  122 'PAGE'                        S01117
0742 O                         PAGE  Z  126                               S01117
0743 O        E  1             NODTL                                      S01117
0745 O                       U1          16 'AUDIT REPORT'                S01117
0746 O                      NU1          18 'LISTING REPORT'              S01117
0750 O                                   53 'AMOUNT ACCRUALS'             S01117
     O                       35          63 'BRANCH'                      S01117
     O                       35BRNCH     67                               S01117
     O                   N37 35          68 '-'                           S01117
     O                   N37 35A8BRNM    98                               S01117
0755 O        E  2             NODTL                                      S01117
0757 O                       U1          16 '------------'                S01117
0758 O                      NU1          18 '--------------'              S01117
0762 O                                   53 '---------------'             S01117
     O        E   26           NODTL                                      S01117
     O                      NU1          76 '*** NO DETAILS TO REPORT'    S01117
     O                      NU1          80 '***'                         S01117
     O                   N82 U1          76 '*** NO DETAILS TO REPORT'    S01117
     O                   N82 U1          80 '***'                         S01117
     O                    82 U1          77 '*** NO INPUT TODAY ***'      S01117
     O        E   50           NODTL                                      S01117
     O                       35          69 '*** END OF REPORT FOR'       S01117
     O                       35          76 'BRANCH'                      S01117
     O                       35BRNCH     80                               S01117
     O                       35          84 '***'                         S01117
     O                      N32          76 '*** END OF REPORT ***'       S01117
0820 O*                                                                   GL1130
0821 O*  STANDARD FILE CONTROLS                                           GL1130
0822 O*                                                                   GL1130
0823 O*  STANDARD HEADINGS                                                GL1130
0824 O*                                                                   GL1130
0825 O********T**203   LR                                                 S01117
0826 O***********                        22 'REFERENCE GL1130'            S01117
0825 OGL1130AUT  203   LR                                                 S01117
0826 O                                   24 'REFERENCE GL1130AU'          S01117
0827 O***********              TITL      89                               S01194
0827 O                         BJURPT    89                               S01194
0828 O                                  104 'DATE'                        GL1130
0829 O                         RUNA     112                               GL1130
0830 O                                  122 'PAGE'                        GL1130
0831 O***********              PAGE  Z  126                               S01117
0831 O                         PAGE1 Z  126                               S01117
0832 O        T  1     LR                                                 GL1130
0833 O                       U1          16 'AUDIT REPORT'                GL1130
0834 O                      NU1          18 'LISTING REPORT'              GL1130
0835 O*                                                                   GL1130
0836 O*  NAME OF FILE OR RECORD                                           GL1130
0837 O*                                                                   GL1130
0838 O                                   66 'AMOUNT ACCRUALS'             GL1130
     O                                   82 'RUN CONTROLS'                S01117
0839 O*                                                                   GL1130
0840 O*  STANDARD OUTPUT                                                  GL1130
0841 O*                                                                   GL1130
0843 O        T  1     LR                                                 GL1130
0844 O                       U1          16 '------------'                GL1130
0845 O                      NU1          18 '--------------'              GL1130
0846 O*                                                                   GL1130
0847 O*  UNDERLINE NAME OF FILE OR RECORD                                 GL1130
0848 O*                                                                   GL1130
0849 O                                   66 '---------------'             GL1130
0850 O*                                                                   GL1130
0851 O*  NO INPUT TODAY MESSAGE                                           GL1130
0852 O*                                                                   GL1130
0853 O        T   40   LR U1 82                                           GL1130
0854 O***********                        73 '*** NO INPUT TODAY ***'      S01117
0854 O                                   77 '*** NO INPUT TODAY ***'      S01117
0855 O*                                                                   GL1130
0856 O*  HEADINGS AND RUN CONTROLS COMMON TO AUDIT AND LIST               GL1130
0857 O*                                                                   GL1130
0858 O        T  220   LRN81                                              GL1130
0859 O                                   21 'RUN CONTROLS - '             GL1130
0860 O                                   77 '----------- PROGRAM ----'    GL1130
0861 O                                   84 '-------'                     GL1130
0862 O***********                       116 '--------- FILE TRAILER '     S01117
0863 O***********                       124 '--------'                    S01117
0862 O                       38         116 '--------- FILE TRAILER '     S01117
0863 O                       38         124 '--------'                    S01117
0864 O        T  1     LRN81                                              GL1130
0865 O                                   59 'NUMBER'                      GL1130
0866 O                                   84 'VALUE'                       GL1130
0867 O***********                        99 'NUMBER'                      S01117
0868 O***********                       124 'VALUE'                       S01117
0867 O                       38          99 'NUMBER'                      S01117
0868 O                       38         124 'VALUE'                       S01117
0869 O        T  2     LRN81                                              GL1130
0870 O***********                        13 'S/'                          S01194
0871 O***********              LFILE     18                               S01194
     O                                   18 'S/AMACCL1'                   S01194
0872 O        T  2     LRN81                                              GL1130
0873 O                                   32 'NUMBER OF ACTIVE RECORDS'    GL1130
0874 O                                   40 'ON FILE'                     GL1130
0875 O                         RN,1  3   59                               GL1130
0876 O                         RW,1  Z   80                               GL1130
0877 O                         RD,1      83                               GL1130
0878 O***********              NR,1  3   99                               S01117
0879 O***********              WN,1  Z  120                               S01117
0880 O***********              DC,1     123                               S01117
0878 O                       38NR,1  3   99                               S01117
0879 O                       38WN,1  Z  120                               S01117
0880 O                       38DC,1     123                               S01117
0881 O                       79         130 '***'                         GL1130
0882 O*                                                                   GL1130
0883 O*  AUDIT REPORT ONLY RUN CONTROLS                                   GL1130
0884 O*                                                                   GL1130
0885 O        T  3     LR U1N82                                           GL1130
0886 O                                   29 'NUMBER OF RECORDS UPD'       GL1130
0887 O                                   39 'ATED TODAY'                  GL1130
0888 O                         RN,3  3   59                               GL1130
0889 O        T  2     LR U1N82                                           GL1130
     O       AND       38                                                 S01117
0890 O                                   27 'LIVE RECORDS BEFORE'         GL1130
0891 O                                   39 'INPUT CYCLE'                 GL1130
0892 O                         NR,2  3   99                               GL1130
0893 O                         WN,2  Z  120                               GL1130
0894 O                         DC,2     123                               GL1130
0895 O        T  2     LR U1N82                                           GL1130
     O       AND       38                                                 S01117
0896 O                                   26 'RECORDS INSERTED'            GL1130
0897 O                         NR,3  3   99                               GL1130
0898 O                         WN,3  Z  120                               GL1130
0899 O                         DC,3     123                               GL1130
0900 O        T  2     LR U1N82                                           GL1130
     O       AND       38                                                 S01117
0901 O                                   25 'RECORDS AMENDED'             GL1130
0902 O                         NR,4  3   99                               GL1130
0903 O                         WN,4  Z  120                               GL1130
0904 O                         DC,4     123                               GL1130
0905 O        T  2     LR U1N82                                           GL1130
     O       AND       38                                                 S01117
0906 O                                   25 'RECORDS DELETED'             GL1130
0907 O                         NR,5  3   99                               GL1130
0908 O                         WN,5  Z  120                               GL1130
0909 O                         DC,5     123                               GL1130
0910 O        T  1     LR U1N82                                           GL1130
0911 O                                   32 'LIVE RECORDS AFTER INPUT'    GL1130
0912 O                                   38 'CYCLE'                       GL1130
0913 O                         RN,2  3   59                               GL1130
0914 O                         RW,2  Z   80                               GL1130
0915 O                         RD,2      83                               GL1130
0916 O***********              RN,4  3   99                               S01117
0917 O***********              RW,4  Z  120                               S01117
0918 O***********              RD,4     123                               S01117
0916 O                       38RN,4  3   99                               S01117
0917 O                       38RW,4  Z  120                               S01117
0918 O                       38RD,4     123                               S01117
0919 O                       78         129 '***'                         GL1130
0920 O*                                                                   GL1130
0921 O*  LISTING REPORT ONLY RUN CONTROLS                                 GL1130
0922 O*                                                                   GL1130
0923 O        T  1     LRNU1                                              GL1130
0924 O                                   29 'NUMBER OF LIVE RECORD'       GL1130
0925 O                                   38 'S ON FILE'                   GL1130
0926 O                         RN,2  3   59                               GL1130
0927 O*                                                                   GL1130
0928 O*  OUTPUT DETAILS COMMON TO AUDIT AND LIST                          GL1130
0929 O*                                                                   GL1130
0930 O        T   45   LR U8                                              GL1130
0931 O                                  100 '*** DIFFERENCE ***'          GL1130
     O*                                                                   S01117
     O*  NO DETAILS TO REPORT MESSAGE                                     S01117
     O*                                                                   S01117
     O        T   46   LRNU1N39                                           S01117
     O       AND      NU7NU8                                              S01117
     O       OR   46   LR U1N39                                           S01117
     O       AND      N82NU7NU8                                           S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
0932 O********T** 50   LR                                                 S01117
0933 O***********                        73 '*** END OF REPORT ***'       S01117
0813 O        T 3      LR U7                                              S01117
0814 O                                   38 'DATABASE ERROR NO.-'         S01117
0815 O                         DBASE     41                               S01117
0816 O                                   48 'FILE-'                       S01117
0817 O                         DBFILE    56                               S01117
0818 O                                   62 'KEY-'                        S01117
0819 O                         DBKEY     91                               S01117
0934 OMASTU   E        86                                                 GL1130
0935 O                                   34 ' '                           GL1130
0936 O                         RN,1      37P                              GL1130
0937 O                         RN,2      40P                              GL1130
0938 O                         ZERO05    43P                              GL1130
0939 O                         ZERO05    46P                              GL1130
0940 O                         ZERO05    49P                              GL1130
0941 O                         RW,1      57P                              GL1130
0942 O                         RW,2      65P                              GL1130
0943 O                         ZERO15    73P                              GL1130
0944 O                         ZERO15    81P                              GL1130
0945 O                         ZERO15    89P                              GL1130
0946 O                         RD,1      91P                              GL1130
0947 O                         RD,2      93P                              GL1130
0948 O                         ZERO03    95P                              GL1130
0949 O                         ZERO03    97P                              GL1130
0950 O                         ZERO03    99P                              GL1130
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
