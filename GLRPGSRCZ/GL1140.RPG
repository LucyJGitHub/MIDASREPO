0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Account accrual update & entry generation')   *
0001 H***********                                                         S01194
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - General Ledger Module
0005 F*                                                               *
0006 F*  GL1140 - AMOUNT ACCRUAL UPDATE AND ENTRY GENERATION          *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 161789             DATE 26May20               *
      *  Prev Amend No. MD052272           Date 12May20               *
      *                 MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL184             Date 07Dec16               *
      *                 MD035042           Date 15Jul15               *
      *                 AR813983A          Date 16Aug11               *
      *                 AR813983           Date 11Aug11               *
      *                 MD019831           Date 01Apr13               *
      *                 AR813358           Date 11Feb13               *
      *                 AR894864           Date 11Feb13               *
      *                 CGL141             Date 12Dec12               *
      *                 CLE064             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CPK028             Date 24Jan08               *
      *                 244883A            Date 17May07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 245841             Date 20Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 215616             Date 16Oct06               *
      *                 190679             Date 16Oct06               *
      *                 228837             Date 16Oct06               *
      *                 CGL064             Date 10Jul06               *
      *                 239929             Date 23May06               *
      *                 237361             Date 05Apr06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL020             Date 12Dec02               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 133956             Date 28Feb00               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01Mar99               *        *
      *                 CTI002             Date 23Sep98               *
     F*                 CGL003             DATE 09JAN97               *        *
     F*                 086125             DATE 16MAR95               *
     F*                 S01522             DATE 25JAN95               *
     F*                 063472             DATE 08FEB94               *
     F*                 S10736             DATE 28OCT92               *
     F*                 S01182             DATE 18NOV88               *
     F*                 E15123             DATE 10MAR89               *
     F*                 S01194             DATE 10/03/89              *
0010 F*                 S01117             DATE 10/03/89              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  161789 - Reverse 086125 AND S01522 because user is forced to *
      *           enter narrative at AMAC input option, this will then*
      *           have to be part of the generated entry posting in   *
      *           GEAAPD whether UDC module is present with feature   *
      *           GLPNAR switched ON or not .                         *
      *         - Applied for MD-55825                                *
      *  MD052272 - Component GLC1140 failed during COB due to close  *
      *             GLAMACL0, GLNAMA1D file.                          *
      *           - Applied for MD-55790                              *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  MD035042 - Component GLC1140 failed during COB (Recompile)   *
      *  AR813983A - Associated customer is not updated in postings   *
      *              file GEAAPD. Added in initial fix to set-on      *
      *              *IN47 to make sure that associated customer of   *
      *              the posting will be written in GEAAPD.           *
      *              (Child: AR813984A)                               *
      *  AR813983 - When CGL064 is off, associated customer is blank  *
      *             resulting to error when account code analyse by   *
      *             associated customer. Set associated customer equal*
      *             to customer when CGL064 is off and ACOD analyse   *
      *             by associated customer. (Child: AR813984)         *
      *  MD019831 - GLC1140 00001 Indicator 47 is being used by both  *
      *             CGL064 and CGL141. Amend the indicator for CGL064 *
      *             to *IN48                                          *
      *  AR813358 - Data mapping error on member EODPOPD              *
      *             Apply fix AR894864 (Child: AR813359)              *
      *  AR894864 - Blanks in EODPOPD fields for GEAAPD.              *
      *             Initialize fields NITM CHGA ORAMT LTAI XRFN and   *
      *             TRAT. Applied fix 249489. (Child: AR894865)       *
      *  CGL141 - Amount Accruals Extended Narrative.                 *
      *           Added Hooks: CGL141_032 to CGL141_036               *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  CPK028 - Customer numbers should be alphanumeric.            *
      *  244883A- One transfer of foreign ccy posting generated for   *
      *           for two accruals with different value date.         *
      *  245841 - Amount accruals not maturing on maturity date       *
      *           Due to wrong integration of fix 228837              *
      *  215616 - 'Accrual Date' value is behind by 1 day. Use the    *
      *           system's location code to determine if the next     *
      *           working day is a holiday.                           *
      *  190679 - Accrue up to monthend date when accrual frequency   *
      *           is 'D' and monthend date is a holiday. Apply part   *
      *           of 165536.                                          *
      *  228837 - Used the event control date in GLSTAT instead of    *
      *            the next working date to control monthend accruals.*
      *            If last day of the month falls on a holiday,       *
      *            accrual for this day should still be included in   *
      *            the current month's total accruals regardless of   *
      *            frequency. Coded missing bits of 223969.           *
      *  CGL064 - Associated Customer / Cost Centre Validation        *
      *           Changes                                             *
      *  239929 - Change BKACCD to WCODA on the O specs as introduced *
      *           by 237361 so that the values of the customer number *
      *           and currency will not be overwritten by the account *
      *           code.                                               *
      *  237361 - Entries posting to account with blocked debit and   *
      *           credit. If an account is blocked, direct all        *
      *           postings to suspense account. Pattern to fix 232037.*
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL020 - Midas Compliance Watch - Additional A/C Postings    *
      *           Information.                                        *
     F*  133956 - CGL003 causes system to generate accruals for deals *
     F*           which have not reached start date.                  *
      *  CGL007 - Account Postings Enquiry                            *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  CGL003 - Add Processing for Accrual Specific frequency on    *
     F*           Amount Accruals                                     *
     F*  086125 - Add new parameter to AOPNARR0                       *
     F*  S01522 - Call to AOPNARR0 if switchable feature installed    *
     F*           and UDC present                                     *
     F*  063472 - Accrual amount posted is incorrect.                 *
     F*  S10736 - MANAGEMENT ACCOUNTS                                 *
     F*  S01182 - WRITES NEW ACCOUNT POSTING FIELDS TO THE            *
     F*           GENERATED ENTRIES FILE LF/GEAAPD FOR MIS.           *
     F*  E15123 - IF CREDIT AND DEBIT ACCOUNT BRANCHES ARE            *
     F*           DIFFERENT THEN OUTPUT TWO EXTRA RECORDS.            *
     F*           (THIS FIX NOT APPLIED AS R10 VERSION OF AMOUNT      *
     F*           ACCRUALS ONLY USES ONE BRANCH.                      *
     F*           LN1095 WILL MULTIBRANCH AMOUNT ACCRUALS INPUT       *
     F*           AND ENTRY GENERATION.)                              *
     F*  S01194 - NEW STANDING DATA                                   *
     F*  S01117 - MULTIBRANCHING                                      *
     F*                                                               *
0011 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0013 F*CCNT***IF* F     400 15AI     2 DISK                               S01117
0013 F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     FACCNT   IF  F     400 24AI     2 DISK                                                   CGL029
0014 F**AMACC   IP  F     128  1AI     1 DISK                       GL1140CGL003
0014 F***AMACC** IP  F     134  1AI     1 DISK                                         CGL003 CGL029
     F***AMACC** IP  F     154  1AI     1 DISK                                         CGL029 CGL064
     FAMACC   IP  F     160  1AI     1 DISK                                                   CGL064
0015 F**NAMACA  O   F     128            DISK                             CGL003
0015 F**NAMACD  O   F     128            DISK                             CGL003
0015 F**NAMACZ  O   F     128            DISK                             CGL003
0015 FNAMACA  O   F     134            DISK                               CGL003
0015 F***NAMACD* O   F     134            DISK                                         CGL003 CGL029
     F***NAMACD* O   F     154            DISK                                         CGL029 CGL064
     FNAMACD  O   F     160            DISK                                                   CGL064
0015 F***NAMACZ* O   F     134            DISK                                         CGL003 CGL029
     F***NAMACZ* O   F     154            DISK                                         CGL029 CGL064
     FNAMACZ  O   F     160            DISK                                                   CGL064
0016 F***GEAAPD  O   F     160            DISK                      GL1140S01182
0016 F***GEAAPD**O   F     268            DISK                     S01182 CGL007
0016 F***GEAAPD* O   F     331            DISK                            CGL007              CGL020
0016 F***GEAAPD* O   F     589            DISK                               CGL007    CGL020 CGL029
     FGEAAPD  O   F     620            DISK                                            CGL020 CGL029
0016 FGEAAZZ  O   F     160            DISK                               GL1140
0017 F*L1140P1O** F     132     OF     PRINTER                            S01117
0017 FGL1140AUO   F     132     OF     PRINTER                            S01117
     F/COPY WNCPYSRC,GL1140F001
     F/COPY OFCPYSRCZ,CGL141_032                                                              CGL141
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS                           GL1140
0019 F* 01            S/AMACC - HEADER RECORD                             GL1140
0020 F* 02                    - LIVE DETAIL RECORD                        GL1140
0021 F* 03                    MATURED RECORD                              GL1140
0022 F* 04                    - REVERSED RECORD                           GL1140
0023 F* 05                    - TRAILER RECORD                            GL1140
0024 F* 06                    - CATCHALL                                  GL1140
0025 F* 07            S/ACCNT - ACCOUNT MASTER FILE DETAIL RECORD         GL1140
0026 F* 08                    - CATCHALL                                  GL1140
0027 F**09*******     S/TABLE - ICDR 1                                    S01194
0028 F**10*******             - ICDR 2                                    S01194
0029 F**11*******             - CATCHALL                                  S01194
0030 F*       40      NOT FIRST CYCLE                                     GL1140
0031 F*       41      WORK INDICATOR                                      GL1140
0032 F*       42      ACCRUE ON LAST DAY                                  GL1140
0033 F*       43      ACCRUAL PROCESSING REQUIRED                         GL1140
     F*       46      Accrual Frequency on Amount Accrual Switch          CGL003
0034 F*       50      SUPRESS OUTPUT OF AMOUNT ACCRUAL MASTER RECORD      GL1140
0035 F*       51      LIVE RECORD TO BE OUTPUT                            GL1140
0036 F*       52      POSTING AMOUNT IS ZERO                              GL1140
0037 F*       53      POSTING IS TO BE GENERATED                          GL1140
0038 F*       54      POSTING TO BE GENERATED IS NEGATIVE                 GL1140
0039 F*       60      REVERSAL PROCESSING PERFORMED                       GL1140
0040 F*       61      MATURITY PROCESSING PERFORMED                       GL1140
0041 F*       62      ACCRUAL PROCESSING PERFORMED                        GL1140
0042 F*       63      PROCESSSING PERFORMED                               GL1140
0043 F*       64      DEBIT ACCOUNT IS RETAIL                             GL1140
0044 F*       65      CREDIT ACCOUNT IS RETAIL                            GL1140
0045 F*       70      ACTIVE RECORDS COUNT OR HASH TOTALS OUT OF BALANCE  GL1140
0046 F*       71      LIVE RECORDS COUNT OR HASH TOTALS OUT OF BALANCE    GL1140
      *       81      Account is blocked (DR)                                                 237361
      *       82      Account is blocked (CR)                                                 237361
0047 F***********U7   DATABASE ERROR                                      S01194
0047 F*       U7 U8   DATABASE ERROR                                      S01194
0048 F*          U8   FILE CONTROLS OUT OF BALANCE                        GL1140
     E                    CPY@    1   1 80
0049 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYGL1140
0050 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYGL1140
0051 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY GL1140
     E*                                                                   CGL003
     E/COPY ZSRSRC,ZHOLE                                                  CGL003
     E/COPY ZSRSRC,ZFREQBZ1                                               CGL003
     E*                                                                   CGL003
0052 E**                                                                  GL1140
0053 I* AMACC HEADER                                                      GL1140
0054 IAMACC   NS  01   1 CA                                               GL1140
0055 I                                        1   1 RECI                  GL1140
0056 I* DETAIL RECORD                                                     GL1140
0057 I        NS  02   1 CD  40NCD                                        GL1140
0058 I       OR   03   1 CM                                               GL1140
0059 I       OR   04   1 CD  40 CD                                        GL1140
0060 I                                        1   1 RECI                  GL1140
0061 I                                        2   70REFN                  GL1140
0062 I                                        8   8 REFT                  GL1140
0063 I                                    P  31  330TNLU                  GL1140
0064 I                                    P  34  360ORED                  GL1140
0065 I                                    P  37  390LCD                   GL1140
0066 I                                       40  40 CHTP                  GL1140
0067 I                                    P  41  470AMNT                  GL1140
0068 I                                       48  50 CCY                   GL1140
0069 I                                    P  51  530SDAT                  GL1140
0070 I                                    P  54  560MDAT                  GL1140
0071 I**********                             57  600DRAC                               GL1140 CGL029
     I                                       57  600DRACQQ                                    CGL029
0072 I**********                             61  660DRCN                               GL1140 CSD027
0072 I                                       61  66 DRCN                                      CSD027
0073 I**********                             67  700CRAC                               GL1140 CGL029
     I                                       67  700CRACQQ                                    CGL029
0074 I**********                             71  760CRCN                               GL1140 CSD027
0074 I                                       71  76 CRCN                                      CSD027
0075 I                                       77 106 NARR                  GL1140
0076 I                                    P 107 1130AMPD                  GL1140
0077 I                                      114 1150DRSQ                  GL1140
0078 I                                      116 1170CRSQ                  GL1140
     I                                      122 125 PRFC                  S01117
     I                                      126 128 BRCA                  S01117
0079 I****************************************1 128 LOTA            GL1140CGL003
     I                                      129 129 AMAPFQ                CGL003
     I                                      130 1310AMFDAY                CGL003
     I                                    P 132 1340AMAPDA                CGL003
     I                                      135 1440DRAC                                      CGL029
     I                                      145 1540CRAC                                      CGL029
     I**********                            155 1600AMASOC                             CGL064 CPK028
     I                                      155 160 AMASOC                                    CPK028
     I**********                              1 134 LOTA                               CGL003 CGL029
     I**********                              1 154 LOTA                               CGL029 CGL064
     I                                        1 160 LOTA                                      CGL064
0080 I*                                                                   GL1140
0081 I** S/AMACC TRAILER RECORD                                           GL1140
0082 I        NS  05   1 CZ                                               GL1140
0083 I                                        1   1 RECI                  GL1140
0084 I                                    P  35  370NR1                   GL1140
0085 I                                    P  38  400NR2                   GL1140
0086 I                                    P  50  570WN1                   GL1140
0087 I                                    P  58  650WN2                   GL1140
0088 I                                    P  90  910DC1                   GL1140
0089 I                                    P  92  930DC2                   GL1140
0090 I****************************************1 128 LOTT            GL1140CGL003
0090 I**********                              1 134 LOTT                               CGL003 CGL029
     I**********                              1 154 LOTT                               CGL029 CGL064
     I                                        1 160 LOTT                                      CGL064
0091 I        NS  06                                                      GL1140
0092 I** ACCOUNTS MASTER FILE                                             GL1140
0093 IACCNT   NS  07   1 CD                                               GL1140
0094 I       OR        1 CC                                               GL1140
0095 I***********                            23  250BRCD                  S01117
0096 I                                       26  26 ATYP                  GL1140
0097 I                                      190 1990ACNO                  GL1140
     I                                      200 200 RETB                                      237361
0098 I        NS  08                                                      GL1140
0099 I*****TABLE*FILE*-*INSTALLATION CONTROL DATA RECORD 1.               S01194
0100 I*                                                                   GL1140
0101 I*ABLE***NS* 09   2 C0   3 C1  12 C1                                 S01194
0102 I*******AND*     13 C0                                               S01194
0103 I***********                             1   1 RECI                  S01194
0104 I***********                             2   30RECT                  S01194
0105 I***********                            12  130RCDE                  S01194
0106 I***********                            14  66 TITL                  S01194
0107 I***********                            67  67 DATF                  S01194
0108 I***********                            68  700DFBR                  S01194
0109 I***********                            74  74 MODI1                 S01194
0110 I***********                            75  75 MODI2                 S01194
0111 I***********                            76  76 MODI3                 S01194
0112 I***********                         P  77  790RUND                  S01194
0113 I***********                            80  86 RUNA                  S01194
0114 I***********                            87  870SFLG                  S01194
0115 I***********                         P  90  920LCD                   S01194
0116 I***********                            93  93 CHTP                  S01194
0117 I***********                         P  94  960TNLU                  S01194
0118 I*                                                                   GL1140
0119 I*                                                                   GL1140
0120 I*****TABLE*FILE*-*INSTALLATION CONTROL DATA RECORD 2.               S01194
0121 I*                                                                   GL1140
0122 I*ABLE***NS* 10   1 CD   2 C0   3 C1                                 S01194
0123 I*******AND*     12 C1  13 C1                                        S01194
0124 I***********                             1   1 RECI                  S01194
0125 I***********                             2   30RECT                  S01194
0126 I***********                            12  130RCDE                  S01194
0127 I***********                            14  16 BCCY                  S01194
0128 I***********                            17  19 BCYL                  S01194
0129 I***********                            20  22 HOCY                  S01194
0130 I***********                            23  280HEAD                  S01194
0131 I***********                         P  29  310APDA                  S01194
0132 I***********                            35  35 APFQ                  S01194
0133 I***********                         P  36  380LOGS                  S01194
0134 I***********                            39  40 CUZR                  S01194
0135 I***********                         P  41  430DNWD                  S01194
0136 I***********                            44  460BVLP                  S01194
0137 I***********                            47  49 LOCY                  S01194
0138 I***********                            50  510FDAY                  S01194
0139 I***********                            52  52 ACLD                  S01194
0140 I***********                            53  53 MBIN                  S01194
0141 I***********                            54  54 EOMS                  S01194
0142 I***********                            55  57 HDNWD                 S01194
0143 I***********                            58  60 POSN                  S01194
0144 I***********                            86  86 ISAV                  S01194
0145 I***********                         P  87  890LLOG                  S01194
0146 I***********                         P  90  920LCD                   S01194
0147 I***********                            93  93 CHTP                  S01194
0148 I***********                         P  94  960TNLU                  S01194
0149 I********NS* 11                                                      S01194
0150 ILDA        UDS                            256                       GL1140
0075 I***********                           134 138 DBFILE                S01194
0076 I***********                           139 167 DBKEY                 S01194
0077 I***********                           168 175 DBPGM                 S01194
0078 I***********                           176 1770DBASE                 S01194
0075 I                                      134 141 DBFILE                S01194
0076 I                                      142 170 DBKEY                 S01194
0077 I                                      171 180 DBPGM                 S01194
0078 I                                      181 1830DBASE                 S01194
0155 I            DS                                                      GL1140
0156 I***********                             1  15 ACCKY                 S01117
0156 I**********                              1  18 ACCKY                              S01117 CGL029
0156 I                                        1  24 ACCKY
0157 I**********                              1   60CUSTNO                             GL1140 CSD027
0157 I                                        1   6 CUSTNO                                    CSD027
0158 I                                        7   9 CCY                   GL1140
0159 I**********                             10  130ACCOD                              GL1140 CGL029
0160 I**********                             14  150ACSEQ                              GL1140 CGL029
0160 I**********                             16  18 BRCA                               S01117 CGL029
     I                                       10  190ACCOD
     I                                       20  210ACSEQ
     I                                       22  24 BRCA
     I/COPY WNCPYSRC,GL1140I001
     I*                                                                   S01194
     IRUNDT       DS                                                      S01194
     I** DATA AREA RUNDAT                                                 S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
      *                                                                                       228837
      ** GLSTAT Data area.                                                                    228837
      *                                                                                       228837
     IGLSTAT      DS                            256                                           228837
     I                                       74  78 EVCD0                                     228837
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01522
     I* Module Details accessed via access program                        S01522
     I*                                                                   S01522
     ISCSARD    E DSSCSARDPD                                              S01522
     I* SAR File Details accessed via access program AOSARDR0             S01522
     I*                                                                   S01522
     ICGPNAR    E DSCGPNARPD                                              S01522
     I* UDC Multi-Language Narrative Data Structure                       S01522
     I*                                                                   S01522
     I##PRM1      DS                                                      086125
      **  Data Structure for Customer and Branch                          086125
      *                                                                   086125
     I                                        1   6 A#CUST                086125
     I                                        7   9 A#BRCA                086125
      *                                                                   086125
     ISDCUST    E DSSDCUSTPD                                              S01522
     I**  Customer Details                                                S01522
     I*                                                                   S01522
     IDSSDY     E DSDSSDY                                                 S01522
     I* Access programs data structure                                    S01522
     I*                                                                   S01522
     ISDGELR    E DSSDGELRPD                                              S01194
     I**   GENERAL LEDGER DETAILS                                         S01194
     I              QQACCD                          QQACCX                                    CGL029
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I**   BANK DETAILS                                                   S01194
     I*
     ISDACOD    E DSSDACODPD                                              S10736
     I**   ACCOUNT CODE DETAILS                                           S10736
     I              QQACCD                          QQACCY                                    CGL029
     ISDBRCH    E DSSDBRCHPD                                                                  237361
     I              QQDFAC                          WQDFAC                                    237361
      **   Branch Details                                                                     237361
     I*                                                                   S10736
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I/EJECT                                                              S01194
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*                                                                   CGL003
     I/COPY ZSRSRC,ZHOLI                                                  CGL003
     I*                                                                   CGL003
0073 I*                                                                   GL1160
     C*                                                                   CGL003
     C           *LIKE     DEFN AMAPDA    WAPDA                           CGL003
0161 C*                                                                   GL1140
0162 C** FIRST CYCLE PROCESSING                                           GL1140
0163 C   40                GOTO DT0010                                    GL1140
     C                     MOVEACPY@      BIS@   80
0164 C                     SETON                     40                   GL1140
0165 C***********          MOVE 'GL1140'  DBPGM                           S01194
0165 C                     MOVEL'GL1140'  DBPGM                           S01194
0166 C*                                                                   GL1140
0167 C***OBTAIN*DETAILS*FROM ICDR 1                                       S01194
0168 C***********          EXSR ZSYSTM                                    S01194
0169 C***99******          SETON                     U7LR                 S01194
0170 C***99******          MOVE 'TABLE'   DBFILE                          S01194
0171 C***99******          MOVE ZTABKY    DBKEY                           S01194
0172 C***99******          Z-ADD1         DBASE                           S01194
0173 C***99******          GOTO DEND                                      S01194
0174 C*                                                                   GL1140
      ** Define GLSTAT.                                                                       228837
      *                                                                                       228837
     C           *NAMVAR   DEFN           GLSTAT                                              228837
     C                     IN   GLSTAT                                                        228837
     C                     MOVE EVCD0     EVCDX   50                                          228837
      *                                                                                       228837
     C** OBTAIN RUN DATE FROM RUNDAT                                      S01194
     C*                                                                   S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C                     IN   RUNDT                                     S01194
0681 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           DATF      IFEQ 'M'                                       S01194
     C                     SETON                     98                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     98                   S01194
     C                     END                                            S01194
0085 C*                                                                   S01194
0086 C* ACCESS BANK DETAILS, DATABASE ERROR IF RETURN CODE NOT BLANK      S01194
0087 C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBANKPD'DBFILE             *************S01194
     C                     MOVEL'001'     DBASE              * DBERR 001 *S01194
     C                     MOVEL@OPTN     DBOPTN  7          *************S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     U7LRU8               S01194
     C                     GOTO DEND                                      S01194
     C                     END                                            S01194
0158 C*                                                                   GL1170
0175 C***OBTAIN*DETAILS*FROM ICDR 2                                       S01194
0176 C***********          MOVE '1'       ZTABKY                          S01194
0177 C***********ZTABKY    CHAINTABLE                41                   S01194
0178 C***41******                                                         S01194
0179 C*RN10******          SETON                     U7LR                 S01194
0180 C***U7******          MOVE 'TABLE'   DBFILE                          S01194
0181 C***U7******          MOVE ZTABKY    DBKEY                           S01194
0182 C***U7******          Z-ADD2         DBASE                           S01194
0183 C***U7******          GOTO DEND                                      S01194
     C*                                                                   S01194
     C** OBTAIN GENERAL LEDGER DETAILS                                    S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDGELRPD'DBFILE             *************S01194
     C                     MOVEL'002'     DBASE              * DBERR 002 *S01194
     C                     MOVEL@OPTN     DBOPTN  7          *************S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     U7LRU8               S01194
     C                     GOTO DEND                                      S01194
     C                     END                                            S01194
      *                                                                                       237361
     C                     MOVELBKACCD    ACODA                                               237361
     C**********           MOVE BKACCD    WCODA   40                                   237361 239929
     C                     Z-ADD0         WCODA   40                                          239929
     C                     MOVE BKACCD    @CODA  10                                           237361
      *                                                                                       237361
     C                     EXSR ACDCHN                                                        237361
     C           *INU7     IFEQ '0'                                                           237361
     C                     MOVE A5ACTY    CSTYP   1                                           237361
     C                     ENDIF                                                              237361
0184 C*                                                                   GL1140
0185 C** DETERMINE IF LAST/FIRST DAY ACCRUALS                             GL1140
0186 C***********ACLD      COMP 'Y'                      42 LAST DAY ACC. S01194
     C           BKALDI    IFEQ 'Y'                         LAST DAY ACC. S01194
     C                     SETON                     42                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     42                   S01194
     C                     END                                            S01194
0187 C*                                                                   GL1140
0188 C** DETERMINE IF AN ACCRUAL DAY                                      GL1140
0189 C***********DNWD      SUB  1         DNWDM1  50                      S01194
0190 C***********APDA      COMP DNWDM1                 434343, ACCRUAL DAYS01194
     C*                                                                   S01194
0189 C           BJDNWD    SUB  1         DNWDM1  50                      S01194
     C           BKAPDT    IFLE DNWDM1                     43, ACCRUAL DAYS01194
     C                     SETON                     43                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     43                   S01194
     C                     END                                            S01194
      *                                                                                       228837
      ** Determine Event Control Date (For Maturity Processing)                               228837
      *                                                                                       228837
     C           BJDNWD    SUB  1         EVCD    50                                          228837
     C           EVCD      COMP BKAPDT               41  41                                   228837
     C           *IN41     IFEQ '1'                                                           228837
     C                     Z-ADDBKAPDT    EVCD                                                228837
     C                     ENDIF                                                              228837
0191 C*                                                                   GL1140
0192 C** SETUP ALPHA MONTH AND YEAR OF RUN DATE                           GL1140
0193 C                     MOVE RUNA      RUNMY   5                       GL1140
     C/COPY WNCPYSRC,GL1140C003
0194 C*                                                                   GL1140
0195 C                     Z-ADD0         ZERO3   30                      GL1140
0196 C                     Z-ADD0         ZERO5   50                      GL1140
0197 C                     BITOF'1'       BITS    1                       GL1140
     C*                                                                   S01182
     C**  INITIALISE ACCOUNT POSTING FIELDS FOR PF/CLEARPD.               S01182
     C                     Z-ADD*ZEROS    SDLB   150                      S01182
     C                     Z-ADD*ZEROS    SDCB   150                      S01182
     C                     MOVE *BLANKS   PRFC    4                       S01182
     C**********           MOVE *BLANKS   OTRF   15                                    S01182 CGL029
     C                     MOVE *BLANKS   OTRFQQ 15                                           CGL029
     C                     MOVE *BLANKS   OTRF   21                                           CGL029
     C                     MOVE *BLANKS   OTTP   10                       S01182
     C                     MOVE *BLANKS   OTST   10                       S01182
     C                     MOVE *BLANKS   BOKC    2                       S01182
     C                     Z-ADD0         ORAMT  130                                        AR894864
     C                     Z-ADD0         NITMS   50                                        AR894864
     C                     Z-ADD0         CHGA   130                                        AR894864
     C                     Z-ADD0         SETDAT  50                                        AR894864
     C                     Z-ADD0         LTAI    10                                        AR894864
     C                     Z-ADD0         XRFN   100                                        AR894864
     C                     Z-ADD0         TRAT    50                                        AR894864
      *                                                                   S01522
      **  Call Module Prog. for Module Details.                           S01522
     C                     CALL 'AOMMODR0'                                S01522
     C                     PARM '*MSG   ' @RTCD                           S01522
     C                     PARM '*FIRST ' @OPTN                           S01522
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01522
      *                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B1             S01522
     C                     MOVEL'SDMMODPD'DBFILE           * * * * * * *  S01522
     C                     MOVEL'006'     DBASE            * DBERR 006 *  S01522
     C                     MOVEL@OPTN     DBOPTN           * * * * * * *  S01522
     C                     MOVEL@OPTN     DBKEY             1             S01522
     C                     EXSR *PSSR                       1             S01522
     C                     SETON                     U7U8LR 1             S01522
     C                     GOTO DEND                        1             S01522
     C                     ELSE                            X1             S01522
     C/COPY WNCPYSRC,GLH00755
      *                                                                   S01522
      **  Call SAR Prog. for Switchable Feature                           S01522
     C           BGN1ST    IFEQ 'Y'                        B2             S01522
     C/COPY WNCPYSRC,GLH00756
     C*                                                                   S01522
     C                     CALL 'AOSARDR0'                  2             S01522
     C                     PARM '       ' @RTCD             2             S01522
     C                     PARM '*VERIFY' @OPTN             2             S01522
     C                     PARM 'GLPNAR'  @SARD   6         2             S01522
     C           SCSARD    PARM SCSARD    DSFDY             2             S01522
     C*                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B3             S01522
     C           @RTCD     ANDNE'*NRF   '                   3             S01522
     C                     MOVEL'SCSARDPD'DBFILE            ************* S01522
     C                     MOVEL'007'     DBASE             *DBERROR 007* S01522
     C                     MOVEL@SARD     DBKEY             ************* S01522
     C                     EXSR *PSSR                       3             S01522
     C                     SETON                     U7U8LR 3             S01522
     C                     GOTO DEND                        3             S01522
     C                     END                             E3             S01522
     C*                                                                   S01522
     C           @RTCD     IFEQ *BLANK                     B3             S01522
     C                     MOVEL'Y'       GLPNAR  1         3             S01522
     C                     END                             E3             S01522
     C                     END                             E2             S01522
     C                     END                             E1             S01522
     C/COPY WNCPYSRC,GL1140C005
      *                                                                   CGL003
      **  Access Switchable features file for                             CGL003
      **  Accrual Frequency on Amount Accruals Processing - CGL003        CGL003
     C                     CALL 'AOSARDR0'                                CGL003
     C                     PARM *BLANKS   @RTCD                           CGL003
     C                     PARM '*VERIFY' @OPTN                           CGL003
     C                     PARM 'CGL003'  WSARD   6                       CGL003
     C           @RTCD     IFNE *BLANK                                    CGL003
     C           @RTCD     ANDNE'*NRF   '                                 CGL003
     C                     MOVEL'AOSARDR0'DBFILE            ************* CGL003
     C                     Z-ADD8         DBASE             *DBERROR 008* CGL003
     C                     MOVELWSARD     DBKEY             ************* CGL003
     C                     MOVE @OPTN     DBOPTN                          CGL003
     C                     SETON                     U7U8LR               CGL003
     C                     EXSR *PSSR                                     CGL003
     C                     GOTO DEND                                      CGL003
     C                     ENDIF                                          CGL003
      *                                                                   CGL003
     C           @RTCD     IFEQ *BLANK                                    CGL003
     C                     MOVE 'Y'       CGL003  1                       CGL003
     C                     MOVE *ON       *IN46                           CGL003
     C                     END                                            CGL003
      *                                                                                       CGL020
      **  Access Switchable features file for                                                 CGL020
      **  Midas Compliance Watch - Anti-Money Laundering  - CGL020                            CGL020
     C                     CALL 'AOSARDR0'                                                    CGL020
     C                     PARM *BLANKS   @RTCD                                               CGL020
     C                     PARM '*VERIFY' @OPTN                                               CGL020
     C                     PARM 'CGL020'  WSARD                                               CGL020
      *                                                                                       CGL020
      **  Database Error                                                                      CGL020
     C           @RTCD     IFNE *BLANK                                                        CGL020
     C           @RTCD     ANDNE'*NRF   '                                                     CGL020
     C                     MOVEL'AOSARDR0'DBFILE                                              CGL020
     C                     Z-ADD21        DBASE                                               CGL020
     C                     MOVELWSARD     DBKEY                                               CGL020
     C                     MOVE @OPTN     DBOPTN                                              CGL020
     C                     SETON                     U7U8LR                                   CGL020
     C                     EXSR *PSSR                                                         CGL020
     C                     GOTO DEND                                                          CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CGL020
     C           @RTCD     IFEQ *BLANK                                                        CGL020
     C                     MOVE 'Y'       CGL020  1                                           CGL020
     C                     END                                                                CGL020
      *                                                                                       CGL020
     C/COPY WNCPYSRC,GL1140C002
     C/COPY OFCPYSRCZ,CGL141_033                                                              CGL141
     C                     CALL 'AOSARDR0'                                CGL064
     C                     PARM *BLANKS   @RTCD                           CGL064
     C                     PARM '*VERIFY' @OPTN                           CGL064
     C                     PARM 'CGL064'  @SARD                           CGL064
      *                                                                   CGL064
     C           @RTCD     IFNE *BLANK                                    CGL064
     C           @RTCD     ANDNE'*NRF   '                                 CGL064
     C                     MOVEL'SDSARDPD'DBFILE           ************   CGL064
     C                     Z-ADD9         DBASE            * DBERR009 *   CGL064
     C                     MOVEL@SARD     DBKEY            ************   CGL064
     C                     MOVEL@OPTN     DBOPTN                          CGL064
     C                     SETON                     U7U8LR               CGL064
     C                     EXSR *PSSR                                     CGL064
     C                     GOTO DEND                                      CGL064
     C                     ENDIF                                          CGL064
      *                                                                   CGL064
     C                     MOVE 'N'       CGL064  1                       CGL064
     C           @RTCD     IFEQ *BLANK                                    CGL064
     C                     MOVE 'Y'       CGL064                          CGL064
     C**********           MOVE *ON       *IN47                                      CGL064 MD019831
     C                     MOVE *ON       *IN48                                             MD019831
     C                     ENDIF                                          CGL064
0198 C*                                                                   GL1140
0199 C** END OF FIRST CYCLE                                               GL1140
0198 C*                                                                   GL1140
     C           CGL020    IFEQ 'Y'                                                           CGL020
     C                     MOVE *BLANK    WBLK01  1                                           CGL020
     C                     Z-ADD0         WZE130 130                                          CGL020
     C                     Z-ADD0         WZER05  52                                          CGL020
     C                     MOVE *BLANK    WBLK10 10                                           CGL020
     C                     MOVE *BLANK    WBLK20 20                                           CGL020
     C                     Z-ADD0         WZE132 132                                          CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CGL020
0200 C           DT0010    TAG                             ** DT0010 TAG**GL1140
     C                     MOVE '0'       *IN81                                               237361
     C                     MOVE '0'       *IN82                                               237361
0201 C                     SETOF                     505152               GL1140
0202 C                     SETOF                     536061               GL1140
0203 C                     SETOF                     626354               GL1140
     C*                                                                   S01182
     C** SETUP ACCOUNT POSTING FIELD WITH REFERENCE NO.FROM LF/AMACC.     S01182
     C                     MOVELREFN      OTRF                            S01182
0204 C*                                                                   GL1140
0205 C** SKIP PROCESSING IF NOT A DETAIL RECORD                           GL1140
0206 C   01                                                               GL1140
0207 COR 05                                                               GL1140
0208 COR 06                GOTO DEND                                      GL1140
     C/COPY WNCPYSRC,GL1140C001
     C/COPY OFCPYSRCZ,CGL141_034                                                              CGL141
     C           CGL064    IFEQ 'Y'                                       CGL064
      *                                                                   CGL064
     C**********           Z-ADD*ZEROS    WASOC   60                                   CGL064 CPK028
     C                     MOVE *BLANKS   WASOC   6                                           CPK028
     C           *IN02     IFEQ *ON                                       CGL064
     C           *IN03     OREQ *ON                                       CGL064
     C           *IN04     OREQ *ON                                       CGL064
     C**********           Z-ADDAMASOC    WASOC                                        CGL064 CPK028
     C                     MOVE AMASOC    WASOC                                               CPK028
     C                     ENDIF                                          CGL064
      *                                                                   CGL064
      ** Else if CGL064 is OFF but Mgmt Ac is ON, set associated                            AR813983
      ** customer equal to customer when account code analyses by                           AR813983
      ** associated customer                                                                AR813983
      *                                                                                     AR813983
     C                     ELSE                                                             AR813983
     C           A5MAAC    IFEQ 'Y'                                                         AR813983
     C**********           MOVE *ON       *IN47                                   AR813983A MD052272
     C                     MOVE *ON       *IN48                                             MD052272
     C                     MOVE CRCN      WASOC                                             AR813983
     C                     ENDIF                                                            AR813983
      *                                                                                     AR813983
     C                     ENDIF                                          CGL064
0209 C*                                                                   GL1140
0210 C** RECORD COUNT AND HASH TOTALLING                                  GL1140
0211 C*                                                                   GL1140
0212 C** ACTIVE RECORDS                                                   GL1140
0213 C                     ADD  1         NOREA   50                      GL1140
0214 C                     Z-ADDTOTAW     ZZTOTI                          GL1140
0215 C                     Z-ADDTOTAD     ZZTOTD                          GL1140
0216 C                     Z-ADD0         ZZAMT                           GL1140
0217 C                     MOVE AMNT      ZZAMT                           GL1140
0218 C                     EXSR GLZADD                                    GL1140
0219 C                     Z-ADDZZTOTI    TOTAW  150                      GL1140
0220 C                     Z-ADDZZTOTD    TOTAD   30                      GL1140
0221 C*                                                                   GL1140
0222 C** LIVE RECORDS - RECORD ID 'D' ONLY                                GL1140
0223 C   04                                                               GL1140
0224 COR 03                GOTO DT0020                                    GL1140
0225 C                     ADD  1         NOREL   50                      GL1140
0226 C                     Z-ADDTOTLW     ZZTOTI                          GL1140
0227 C                     Z-ADDTOTLD     ZZTOTD                          GL1140
0228 C                     Z-ADD0         ZZAMT                           GL1140
0229 C                     MOVE AMNT      ZZAMT                           GL1140
0230 C                     EXSR GLZADD                                    GL1140
0231 C                     Z-ADDZZTOTI    TOTLW  150                      GL1140
0232 C                     Z-ADDZZTOTD    TOTLD   30                      GL1140
0233 C*                                                                   GL1140
0234 C           DT0020    TAG                             ** DT0020 TAG**GL1140
0235 C/SPACE 3                                                            GL1140
0236 C*                                                                   GL1140
0237 C** DROP ANY RECORD THAT MATURED IN A PREVIOUS MONTH                 GL1140
0238 C  N03                GOTO DT0030                                    GL1140
0239 C                     Z-ADDMDAT      ZDAYNO                          GL1140
0240 C                     EXSR ZDATE2                                    GL1140
0241 C                     MOVE ZADATE    MATMY   5                       GL1140
0242 C           RUNMY     COMP MATMY                5050                 GL1140
     C/COPY WNCPYSRC,GL1140C004
     C/COPY OFCPYSRCZ,CGL141_035                                                              CGL141
0243 C   50                GOTO DT0100                                    GL1140
0244 C*                                                                   GL1140
0245 C           DT0030    TAG                             **DT0030 TAG **GL1140
0246 C*                                                                   GL1140
0247 C** GENERATE ENTRIES FOR AND DROP REVERSALS                          GL1140
0248 C  N04                GOTO DT0040                                    GL1140
0249 C                     SETON                     506063               GL1140
0250 C*                                                                   GL1140
0251 C** SETUP FIELDS FOR GENERATED ENTRIES                               GL1140
0252 C                     EXSR REVRSE                                    GL1140
0253 C                     GOTO DT0100                                    GL1140
0254 C*                                                                   GL1140
0255 C           DT0040    TAG                             **DT0040 TAG **GL1140
0256 C*                                                                   GL1140
0257 C** PROCESS MATURING RECORDS                                         GL1140
0258 C  N02                GOTO DT0050                                    GL1140
0259 C*                                                                   GL1140
0260 C** CHECK IF RECORD MATURES BEFORE NEXT WORKING DAY                  GL1140
0261 C***********MDAT      COMP DNWD                   41                 S01194
     C*                                                                   S01194
     C********** MDAT      IFLT BJDNWD                                                 S01194 228837
     C********** MDAT      IFLT EVCD                                                   228837 245841
     C           MDAT      IFLE EVCD                                                          245841
     C                     SETON                     41                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     41                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
0262 C  N41                GOTO DT0050                                    GL1140
0263 C                     SETON                     6163                 GL1140
0264 C*                                                                   GL1140
0265 C** SETUP FIELDS FOR UPDATED MASTER RECORD AND GENERATED ENTRIES     GL1140
0266 C                     EXSR MATRTY                                    GL1140
0267 C                     GOTO DT0100                                    GL1140
0268 C           DT0050    TAG                             ** DT0050 TAG**GL1140
0269 C*                                                                   GL1140
0270 C** DO ACCRUAL PROCESSING IF REQUIRED                                GL1140
0271 C**N43******                                                         CGL003
0272 C*ORN02******          GOTO DT0100                                   CGL003
     C           *IN02     IFEQ *OFF                                      CGL003
     C                     GOTO DT0100                                    CGL003
     C                     ENDIF                                          CGL003
     C           CGL003    IFNE 'Y'                                       CGL003
     C           *IN43     IFEQ *OFF                                      CGL003
     C                     GOTO DT0100                                    CGL003
     C                     ENDIF                                          CGL003
     C                     ENDIF                                          CGL003
     C*                                                                   S01194
     C* Is Accrual Frequency available?                                   CGL003
     C           CGL003    IFEQ 'Y'                                       CGL003
     C*                                                                   CGL003
     C           AMAPDA    IFLT EVCDX                                                         228837
     C                     Z-ADDEVCDX     AMAPDA                                              228837
     C                     ENDIF                                                              228837
      *                                                                                       228837
     C**Next*Accrual*Date*for*amount*accrual*LE*next*working*day*-*1CGL003133956
     C* If Accrual Date for Amount Accrual is not before next working day 133956
     C* or it is before the Start Date of the deal, bypass accrual calc.  133956
     C           AMAPDA    IFGT DNWDM1                                    CGL003
     C           AMAPDA    ORLT SDAT                                      133956
     C           BKAPDT    ORLT SDAT                                                         244883A
     C                     GOTO DT0100                                    CGL003
     C                     ENDIF                                          CGL003
     C*                                                                   CGL003
     C                     ELSE                                           CGL003
     C* No                                                                CGL003
0273 C*                                                                   GL1140
0274 C** CHECK IF START DATE HAS BEEN REACHED                             GL1140
0275 C***********APDA      COMP SDAT                   41                 S01194
     C           BKAPDT    IFLT SDAT                                      S01194
     C                     SETON                     41                   S01194
     C                     ELSE                                           S01194
     C                     SETOF                     41                   S01194
     C                     END                                            S01194
     C*                                                                   CGL003
     C                     ENDIF                                          CGL003
     C*                                                                   S01194
0276 C   41                GOTO DT0100                                    GL1140
0277 C*                                                                   GL1140
0278 C***********APDA      SUB  SDAT      ACDAYS  50       ACCRUAL DAYS   S01194
     C* Is Accrual Frequency available?                                   CGL003
     C           CGL003    IFEQ 'Y'                                       CGL003
     C           AMAPDA    SUB  SDAT      ACDAYS  50       ACCRUAL DAYS   CGL003
     C                     ELSE                                           CGL003
     C* No                                                                CGL003
0278 C           BKAPDT    SUB  SDAT      ACDAYS  50       ACCRUAL DAYS   S01194
     C                     ENDIF                                          CGL003
0279 C  N42                ADD  1         ACDAYS           ADJ. 1ST DAY ACGL1140
0280 C           MDAT      SUB  SDAT      TOTDAY  50       TOTAL DAYS     GL1140
0281 C***********ACDAYS    DIV  TOTDAY    ACCFRC 109H     ACCRUAL FRACT'N 063472
0282 C***********AMNT      MULT ACCFRC    AMACTD 130H     ACCRUED TO DATE 063472
     C           AMNT      MULT ACDAYS    ATEMP  210H                     063472
     C           ATEMP     DIV  TOTDAY    AMACTD 130H                     063472
0283 C*                                                                   GL1140
0284 C** CALCULATE AMOUNT TO BE POSTED                                    GL1140
0285 C           AMACTD    SUB  AMPD      AMTP   130                      GL1140
0286 C                     SETON                     6263                 GL1140
0287 C*                                                                   GL1140
0288 C** SETUP FIELDS FOR UPDATED MASTER RECORD AND GENERATED ENTRIES     GL1140
0289 C                     EXSR ACCRUE                                    GL1140
     C*                                                                   CGL003
     C* Is Accrual Frequency available?                                   CGL003
     C           CGL003    IFEQ 'Y'                                       CGL003
      *                                                                                       190679
      ** Calculate the End-of-Month-Date.                                                     190679
      *                                                                                       190679
     C                     Z-ADDAMAPDA    ZDAYNO                                              190679
     C                     EXSR CALEOM                                                        190679
     C*                                                                   CGL003
     C** Calculate the accrual date                                       CGL003
     C                     Z-ADDAMAPDA    ZDAYNO                          CGL003
     C                     MOVE AMAPFQ    ZFREQ                           CGL003
     C                     Z-ADDAMFDAY    ZMDAY                           CGL003
     C                     MOVE BJLCCY    ZCCY                            CGL003
     C                     MOVE BJSLCD    ZLOC                                                215616
     C                     EXSR ZFREQB                                    CGL003
     C           ZDAYNO    SUB  1         WNADM1  50                                          190679
     C                     Z-ADDZDAYNO    WNXTWD  50                                          190679
     C                     MOVE AMAPFQ    ZFREQ                                               190679
     C                     MOVE BJLCCY    ZCCY                                                190679
     C                     MOVE BJSLCD    ZLOC                                                215616
     C                     EXSR ZFREQB                                                        190679
     C           ZDAYNO    SUB  1         WNWDS1  50                                          190679
     C                     Z-ADDWNXTWD    ZDAYNO                                              190679
     C** Update the Accrual Date on the New Amount Accruals Detail        CGL003
     C** with the earliest of the accrual date or the maturity date.      CGL003
     C                     SELEC                                          CGL003
     C           ZDAYNO    WHGT MDAT                                      CGL003
     C                     Z-ADDMDAT      WAPDA                           CGL003
     C                     OTHER                                          CGL003
     C                     Z-ADDZDAYNO    WAPDA                           CGL003
     C           AMAPFQ    IFEQ 'D'                                                           190679
     C                     EXSR DLYACC                                                        190679
     C                     ENDIF                                                              190679
     C                     ENDSL                                          CGL003
     C*                                                                   CGL003
     C                     ENDIF                                          CGL003
0290 C*                                                                   GL1140
0291 C           DT0100    TAG                             ** DT0100 TAG**GL1140
     C***********                                                                      S01522 161789
     C**Determine*narratives:                                                          S01522 161789
     C***********          EXSR SRPNAR                                                 S01522 161789
0292 C*                                                                   GL1140
0293 C** SKIP OUTPUT HASHING IF NO RECORD TO BE OUTPUT                    GL1140
0294 C   50                GOTO DT0120                                    GL1140
0295 C*                                                                   GL1140
0296 C** SETON INDICATOR FOR LIVE RECORD TO BE                            GL1140
0297 C** OUTPUT                                                           GL1140
0298 C   02N53N61                                                         GL1140
0299 COR 62                SETON                     51                   GL1140
0300 C*                                                                   GL1140
0301 C** CALCULATE RECORD COUNT AND HASH TOTALS FOR RECORD OUTPUT         GL1140
0302 C*                                                                   GL1140
0303 C** ACTIVE RECORDS                                                   GL1140
0304 C                     ADD  1         NOREAO  50                      GL1140
0305 C                     Z-ADDTOTAWO    ZZTOTI                          GL1140
0306 C                     Z-ADDTOTADO    ZZTOTD                          GL1140
0307 C                     Z-ADD0         ZZAMT                           GL1140
0308 C                     MOVE AMNT      ZZAMT                           GL1140
0309 C                     EXSR GLZADD                                    GL1140
0310 C                     Z-ADDZZTOTI    TOTAWO 150                      GL1140
0311 C                     Z-ADDZZTOTD    TOTADO  30                      GL1140
0312 C*                                                                   GL1140
0313 C           DT0110    TAG                             ** DT0110 TAG**GL1140
0314 C*                                                                   GL1140
0315 C** LIVE RECORDS                                                     GL1140
0316 C  N51                GOTO DT0120                                    GL1140
0317 C                     ADD  1         NORELO  50                      GL1140
0318 C                     Z-ADDTOTLWO    ZZTOTI                          GL1140
0319 C                     Z-ADDTOTLDO    ZZTOTD                          GL1140
0320 C                     Z-ADD0         ZZAMT                           GL1140
0321 C                     MOVE AMNT      ZZAMT                           GL1140
0322 C                     EXSR GLZADD                                    GL1140
0323 C                     Z-ADDZZTOTI    TOTLWO 150                      GL1140
0324 C                     Z-ADDZZTOTD    TOTLDO  30                      GL1140
0325 C*                                                                   GL1140
0326 C           DT0120    TAG                             **DT0120 TAG **GL1140
0327 C*                                                                   GL1140
0328 C** HASH TOTAL AND RECORD COUNT OF GENERATED ENTRIES                 GL1140
0329 C  N53N54             GOTO DEND                                      GL1140
0330 C                     ADD  2         NOREG   50                      GL1140
0331 C                     Z-ADDTOTGW     ZZTOTI                          GL1140
0332 C                     Z-ADDTOTGD     ZZTOTD                          GL1140
0333 C           PAMT      ADD  PAMT      PAMT2  150                      GL1140
0334 C           PAMT2     DIV  1000      ZZAMT                           GL1140
0335 C                     EXSR GLZADD                                    GL1140
0336 C                     Z-ADDZZTOTI    TOTGW  150                      GL1140
0337 C                     Z-ADDZZTOTD    TOTGD   30                      GL1140
0338 C*                                                                   GL1140
0339 C           DEND      TAG                             **  DEND TAG **GL1140
0340 C/SPACE 3                                                            GL1140
      *                                                                   S01117
      ** SKIP CONTROLS CHECK WHEN DATABASE ERROR                          S01117
     CLR         *INU7     CABEQ'1'       LREND                           S01117
0341 C*                                                                   GL1140
0342 C** LAST RECORD CALCULATIONS                                         GL1140
0343 C** COMPARE RECORD COUNTS AND HASH TOTALS OF ACTIVE AND LIVE RECORDS GL1140
0344 CLR         NOREA     COMP NR1                  7070                 GL1140
0345 CLRN70      TOTAW     COMP WN1                  7070                 GL1140
0346 CLRN70      TOTAD     COMP DC1                  7070                 GL1140
0347 CLR         NOREL     COMP NR2                  7171                 GL1140
0348 CLRN71      TOTLW     COMP WN2                  7171                 GL1140
0349 CLRN71      TOTLD     COMP DC2                  7171                 GL1140
0350 CLR 70                                                               GL1140
0351 COR 71                SETON                     U8                   GL1140
0352 CLR U8                MOVE 'AMACC'   DBFILE                          GL1140
0353 CLR                   ADD  2         NOREG                           GL1140
     CLR         LREND     TAG                                            S01117
0355 C/SPACE 3                                                            GL1140
0356 C********************************************************************GL1140
0357 C*                                                                   GL1140
0358 C*                  REVRSE SUBROUTINE                                GL1140
0359 C*                                                                   GL1140
0360 C*   SUBR TO PRODUCE GENERATED ENTRY DTAILS FOR REVERSALS            GL1140
0361 C           REVRSE    BEGSR                           * REVRSE BEGSR*GL1140
0362 C** PICK UP ACCOUNT MASTER DETAILS FOR DEBIT AND CREDIT ACCOUNT      GL1140
0363 C                     EXSR ACCHN                                     GL1140
0364 C*                                                                   GL1140
0365 C** GENERATE POSTING AMOUNT                                          GL1140
0366 C                     Z-ADDAMPD      PAMT   130 535452               GL1140
0367 C   54                Z-SUBPAMT      PAMT                            GL1140
0368 C*                                                                   GL1140
0369 C                     ENDSR                                          GL1140
0370 C********************************************************************GL1140
0371 C/SPACE 3                                                            GL1140
0372 C********************************************************************GL1140
0373 C*                                                                   GL1140
0374 C*                 MATRTY SUBROUTINE                                 GL1140
0375 C*                                                                   GL1140
0376 C*   SUBR TO PRODUCE GENERATED ENTRY AND UPDATE DETAILS FOR MATURITY GL1140
0377 C           MATRTY    BEGSR                           * MATRTY BEGSR*GL1140
0378 C** PICK UP ACCOUNT MASTER DETAILS FOR DEBIT AND CREDIT ACCOUNT      GL1140
0379 C                     EXSR ACCHN                                     GL1140
0380 C*                                                                   GL1140
0381 C** GENERATE POSTING AMOUNT                                          GL1140
0382 C           AMNT      SUB  AMPD      PAMT       535452               GL1140
0383 C   54                Z-SUBPAMT      PAMT                            GL1140
0384 C*                                                                   GL1140
0385 C** UPDATE MASTER FILE FIELDS                                        GL1140
0386 C                     Z-ADDAMNT      AMPD                            GL1140
0387 C*                                                                   GL1140
0388 C                     ENDSR                                          GL1140
0389 C*                                                                   GL1140
0390 C******************************************************************* GL1140
0391 C/SPACE 3                                                            GL1140
0392 C********************************************************************GL1140
0393 C*                                                                   GL1140
0394 C*                 ACCRUE SUBROUTINE                                 GL1140
0395 C*                                                                   GL1140
0396 C*  SUBR TO PRODUCE GENERATED ENTRY AND UPDATE DETAILS FOR ACCRUAL   GL1140
0397 C           ACCRUE    BEGSR                           * ACCRUE BEGSR*GL1140
0398 C** PICK UP ACCOUNT MASTER DETAILS FOR DEBIT AND CREDIT ACCOUNT      GL1140
0399 C                     EXSR ACCHN                                     GL1140
0400 C*                                                                   GL1140
0401 C** GENERATE POSTING AMOUNT                                          GL1140
0402 C                     Z-ADDAMTP      PAMT       535452               GL1140
0403 C   54                Z-SUBPAMT      PAMT                            GL1140
0404 C** UPDATE MASTER FILE FIELDS                                        GL1140
0405 C                     Z-ADDAMACTD    AMPD                            GL1140
0406 C                     SETON                     51                   GL1140
0407 C*                                                                   GL1140
0408 C                     ENDSR                                          GL1140
0409 C*                                                                   GL1140
0410 C********************************************************************GL1140
0411 C/SPACE 3                                                            GL1140
0412 C********************************************************************GL1140
0413 C*                                                                   GL1140
0414 C*                 ACCHN SUBROUTINE                                  GL1140
0415 C*                                                                   GL1140
0416 C*  SUBR TO PICK UP ACCOUNT MASTER DETAILS FOR POSTINGS              GL1140
0417 C           ACCHN     BEGSR                           ** ACCHN BEGSR*GL1140
0418 C                     MOVE DRCN      CUSTNO           DEBIT          GL1140
0419 C                     MOVE DRAC      ACCOD                           GL1140
0419 C**********           MOVE ACCOD     ACODA   4                                    S10736 CGL029
     C                     MOVE ACCOD     ACODA  10                                           CGL029
0420 C                     MOVE DRSQ      ACSEQ                           GL1140
0421 C           ACCKY     CHAINACCNT                41                   GL1140
0422 C   41                                                               GL1140
0423 C*R*08******          SETON                     U7LR                 S01194
0423 COR 08                SETON                     U7LRU8               S01194
0424 C   U7                MOVE 'ACCNT'   DBFILE                          GL1140
0425 C   U7                MOVE ACCKY     DBKEY                           GL1140
0426 C   U7                Z-ADD3         DBASE                           GL1140
0427 C   U7                GOTO ACEND                                     GL1140
0428 C                     MOVE ATYP      DRATYP  1                       GL1140
0429 C***********          MOVE BRCD      DRBRCD  30                      S01117
0430 C                     Z-ADDACNO      DRACNO 100                      GL1140
0431 C           ATYP      COMP 'R'                      64               GL1140
0431 C                     EXSR ACDCHN                                    S10736
0443 C   U7                GOTO ACEND                                     S10736
0428 C                     MOVE A5ACSC    DRACSC  2                       S10736
      *                                                                                       237361
      ** If account blocked, send entry to suspense account                                   237361
      *                                                                                       237361
     C                     TESTB'2'       RETB           81                                   237361
      *                                                                                       237361
      ** Setup the key for the debit branch                                                   237361
      *                                                                                       237361
     C           *IN81     IFEQ '1'                                                           237361
      *                                                                                       237361
      ** Access Branch Details                                                                237361
      *                                                                                       237361
     C                     CALL 'AOBRCHR0'                                                    237361
     C                     PARM *BLANKS   @RTCD                                               237361
     C                     PARM '*KEY   ' @OPTN                                               237361
     C                     PARM BRCA      @BRKEY  3                                           237361
     C           SDBRCH    PARM SDBRCH    DSSDY                                               237361
      *                                                                                       237361
0433 C           @RTCD     IFNE *BLANKS                                                       237361
0434 C                     MOVE 'SDBRCHPD'DBFILE           ************                       237361
     C                     MOVE BRCA      DBKEY            * DBERR 14 *                       237361
     C                     Z-ADD14        DBASE            ************                       237361
     C                     MOVEL'GL1140  'DBPGM                                               237361
     C                     MOVE '1'       *INU7                                               237361
     C                     MOVE '1'       *INU8                                               237361
     C                     MOVE '1'       *INLR                                               237361
     C                     EXSR *PSSR                                                         237361
     C                     GOTO DEND                                                          237361
     C                     ENDIF                                                              237361
      *                                                                                       237361
     C                     MOVE BRCA      DRBRCD  3                                           237361
     C**********           MOVE A8BICN    DRBICN  60                                  237361  CPK028
     C                     MOVE A8BICN    DRBICN  6                                           CPK028
      *                                                                                       237361
     C                     ENDIF                                                              237361
0432 C***********                                                         GL1140
0433 C***********                                                         GL1140
0434 C                     MOVE CRCN      CUSTNO           CREDIT         GL1140
0435 C                     MOVE CRAC      ACCOD                           GL1140
0419 C                     MOVE ACCOD     ACODA                           S10736
0436 C                     MOVE CRSQ      ACSEQ                           GL1140
0437 C           ACCKY     CHAINACCNT                41                   GL1140
0438 C   41                                                               GL1140
0439 C*R*08******          SETON                     U7LR                 S01194
0439 COR 08                SETON                     U7LRU8               S01194
0440 C   U7                MOVE 'ACCNT'   DBFILE                          GL1140
0441 C   U7                MOVE ACCKY     DBKEY                           GL1140
0442 C   U7                Z-ADD4         DBASE                           GL1140
0443 C   U7                GOTO ACEND                                     GL1140
0444 C                     MOVE ATYP      CRATYP  1                       GL1140
0445 C***********          MOVE BRCD      CRBRCD  30                      S01117
0446 C                     Z-ADDACNO      CRACNO 100                      GL1140
0447 C           ATYP      COMP 'R'                      65               GL1140
0431 C                     EXSR ACDCHN                                    S10736
0443 C   U7                GOTO ACEND                                     S10736
0428 C                     MOVE A5ACSC    CRACSC  2                       S10736
      *                                                                                       237361
      ** If account blocked, send entry to suspense account                                   237361
      *                                                                                       237361
     C                     TESTB'3'       RETB           82                                   237361
      *                                                                                       237361
      ** Setup the key for the debit branch                                                   237361
      *                                                                                       237361
     C           *IN82     IFEQ '1'                                                           237361
      *                                                                                       237361
      ** Access Branch Details                                                                237361
      *                                                                                       237361
     C                     CALL 'AOBRCHR0'                                                    237361
     C                     PARM *BLANKS   @RTCD                                               237361
     C                     PARM '*KEY   ' @OPTN                                               237361
     C                     PARM BRCA      @BRKEY  3                                           237361
     C           SDBRCH    PARM SDBRCH    DSSDY                                               237361
      *                                                                                       237361
0433 C           @RTCD     IFNE *BLANKS                                                       237361
0434 C                     MOVE 'SDBRCHPD'DBFILE           ************                       237361
     C                     MOVE BRCA      DBKEY            * DBERR 14 *                       237361
     C                     Z-ADD14        DBASE            ************                       237361
     C                     MOVEL'GL1140  'DBPGM                                               237361
     C                     MOVE '1'       *INU7                                               237361
     C                     MOVE '1'       *INU8                                               237361
     C                     MOVE '1'       *INLR                                               237361
     C                     EXSR *PSSR                                                         237361
     C                     GOTO DEND                                                          237361
     C                     ENDIF                                                              237361
      *                                                                                       237361
     C                     MOVE BRCA      CRBRCD  3                                           237361
     C**********           MOVE A8BICN    CRBICN  60                                  237361  CPK028
     C                     MOVE A8BICN    CRBICN  6                                           CPK028
      *                                                                                       237361
     C                     ENDIF                                                              237361
      *                                                                                       237361
0448 C           ACEND     TAG                                            GL1140
0449 C                     ENDSR                                          GL1140
0450 C*                                                                   GL1140
0451 C********************************************************************GL1140
0411 C/SPACE 3                                                            S10736
0412 C********************************************************************S10736
0413 C*                                                                   S10736
0414 C*                 ACDCHN SUBROUTINE                                 S10736
0415 C*                                                                   S10736
0416 C*  SUBR TO PICK UP ACCOUNT CODE DETAILS FOR POSTINGS                S10736
0415 C*                                                                   S10736
0415 C           ACDCHN    BEGSR                                          S10736
     C*                                                                   S10736
     C*  ACCESS SDACODPD USING PASSED ACCOUNT CODE                        S10736
     C*                                                                   S10736
     C                     CALL 'AOACODR0'                                S10736
     C                     PARM '*MSG   ' @RTCD   7                       S10736
     C                     PARM '*KEY   ' @OPTN   7                       S10736
     C**********           PARM ACODA     @AFNB   4                                    S10736 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S10736 CGL029
     C                     PARM ACODA     @AFNB  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   S10736
     C**   IF - NOT A VALID RECORD                                        S10736
     C*                                                                   S10736
     C           @RTCD     IFNE *BLANK                                    S10736
     C                     Z-ADD5         DBASE                           S10736
     C                     MOVEL'SDACODPD'DBFILE                          S10736
     C                     MOVEL@AFNB     DBKEY                           S10736
     C                     SETON                     U7U8LR               S10736
     C                     END                                            S10736
     C*                                                                   S10736
0415 C                     ENDSR                                          S10736
0452 C********************************************************************S10736
0411 C/SPACE 3                                                            S10736
0452 C********************************************************************GL1140
0453 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  GL1140
0454 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            GL1140
0455 C*                                                                   GL1140
0456 CSR         GLZADD    BEGSR                           *** GLZADD ****GL1140
0457 C*                                                                   GL1140
0458 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  GL1140
0459 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS GL1140
0460 C*                                                                   GL1140
0461 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       GL1140
0462 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  GL1140
0463 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  GL1140
0464 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  GL1140
0465 C*                                                                   GL1140
0466 CSR                   EXSR GLZSUM                                    GL1140
0467 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *GL1140
0468 C*                                                                   GL1140
0469 C********************************************************************GL1140
0470 C********************************************************************GL1140
0471 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            GL1140
0472 C*                        GLZADD, GLZSUB, GLZCMP.                    GL1140
0473 C*          PARAMETERS PASSED -                                      GL1140
0474 C*                     I/P ZZAMTI ZZAMTD                             GL1140
0475 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       GL1140
0476 C*                                                                   GL1140
0477 CSR         GLZSUM    BEGSR                           *** GLZSUM ****GL1140
0478 C*                                                                   GL1140
0479 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  GL1140
0480 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  GL1140
0481 CSR                   SETOF                     919293               GL1140
0482 CSR                   SETOF                     949599               GL1140
0483 C*                                                                   GL1140
0484 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      GL1140
0485 CSR         ZZAMTI    COMP 0                      9293               GL1140
0486 CSR 93      ZZAMTD    COMP 0                      9293               GL1140
0487 CSR 93                GOTO ZZSEND                     ZERO BYPASS    GL1140
0488 C*                                                                   GL1140
0489 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       GL1140
0490 CSR         ZZTOTI    COMP 0                      9193               GL1140
0491 CSR 93      ZZTOTD    COMP 0                      9193               GL1140
0492 C*                                                                   GL1140
0493 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           GL1140
0494 CSR 93                Z-ADDZZAMTI    ZZTOTI                          GL1140
0495 CSR 93                Z-ADDZZAMTD    ZZTOTD                          GL1140
0496 CSR 93                GOTO ZZSEND                     ZERO BYPASS    GL1140
0497 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        GL1140
0498 CSR 91N92                                                            GL1140
0499 CORN91 92             GOTO ZZOFPS                                    GL1140
0500 C*                                                                   GL1140
0501 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      GL1140
0502 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   GL1140
0503 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.GL1140
0504 C*                                                                   GL1140
0505 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VEGL1140
0506 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VEGL1140
0507 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           GL1140
0508 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           GL1140
0509 C*                                                                   GL1140
0510 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    GL1140
0511 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. GL1140
0512 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      GL1140
0513 CSRN99                Z-ADDZZWK2     ZZTOTD                          GL1140
0514 CSRN99                Z-ADDZZWK3     ZZTOTI                          GL1140
0515 C*                                                                   GL1140
0516 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. GL1140
0517 CSR 99                Z-ADD0         ZZAMT  153                      GL1140
0518 CSR                   GOTO ZZSEND                                    GL1140
0519 C*                                                                   GL1140
0520 C* THE 'SIGNS' ARE DIFFERENT                                         GL1140
0521 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**GL1140
0522 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            GL1140
0523 C*                                                                   GL1140
0524 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      GL1140
0525 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      GL1140
0526 C*                                                                   GL1140
0527 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           GL1140
0528 C*                                                                   GL1140
0529 CSR 91                Z-SUBZZTOTI    ZZTOTI                          GL1140
0530 CSR 91                Z-SUBZZTOTD    ZZTOTD                          GL1140
0531 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            GL1140
0532 C*                                                                   GL1140
0533 CSR         ZZTOTI    COMP ZZAMTI               93  95               GL1140
0534 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               GL1140
0535 C*                                                                   GL1140
0536 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   GL1140
0537 CSR 95                Z-ADD0         ZZTOTI                          GL1140
0538 CSR 95                Z-ADD0         ZZTOTD                          GL1140
0539 CSR 95                GOTO ZZSEND                                    GL1140
0540 C*                                                                   GL1140
0541 C* IF ZZTOT GT. ZZAMT.                                               GL1140
0542 CSR 93      ZZAMTD    COMP ZZTOTD               94                   GL1140
0543 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          GL1140
0544 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           GL1140
0545 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          GL1140
0546 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          GL1140
0547 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          GL1140
0548 C*                                                                   GL1140
0549 C*                                                                   GL1140
0550 C* IF ZZAMT GT. ZZTOT.                                               GL1140
0551 CSRN93      ZZTOTD    COMP ZZAMTD               94                   GL1140
0552 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      GL1140
0553 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           GL1140
0554 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          GL1140
0555 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          GL1140
0556 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          GL1140
0557 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          GL1140
0558 C*                                                                   GL1140
0559 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          GL1140
0560 CSR                   SETOF                     94                   GL1140
0561 CSR 93 91                                                            GL1140
0562 CORN93 92             SETON                     94                   GL1140
0563 CSR 94                Z-SUBZZTOTI    ZZTOTI                          GL1140
0564 CSR 94                Z-SUBZZTOTD    ZZTOTD                          GL1140
0565 C**                                                                  GL1140
0566 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            GL1140
0567 CSR 92                Z-SUBZZAMTI    ZZAMTI                          GL1140
0568 CSR 92                Z-SUBZZAMTD    ZZAMTD                          GL1140
0569 CSR         ZZSEND    TAG                             ** ZZSEND TAG *GL1140
0570 C**                                                                  GL1140
0571 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           GL1140
0572 CSR                   SETOF                     96                   GL1140
0573 CSR         ZZTOTD    COMP 0                        91               GL1140
0574 CSR 91      ZZTOTI    COMP 0                      96                 GL1140
0575 CSR 96                MOVE '.000-'   ZZNEGD  5                       GL1140
0576 CSR                   ENDSR                             ** ENDSR **  GL1140
0577 C********************************************************************GL1140
     C/EJECT
     C******************************************************************               S01522 161789
     C****Subroutine*SRPNAR*determines*the*required*narratives.*********               S01522 161789
     C******************************************************************               S01522 161789
     C***********SRPNAR    BEGSR                    * S R P N A R *                    S01522 161789
     C***********                                                                      S01522 161789
     C**Define*the*destination*narrative*fields:                                       S01522 161789
     C***********                                                                      S01522 161789
     C************LIKE     DEFN NARR      O#NAR1                                       S01522 161789
     C************LIKE     DEFN NARR      O#NAR2                                       S01522 161789
     C***********                                                                      S01522 161789
     C**Define*the*data*structure*parameter:                                           S01522 161789
     C***********                                                                      S01522 161789
     C************LIKE     DEFN CGPNAR    ##PNAR                                       S01522 161789
     C***********                                                                      S01522 161789
     C**Fill*the*narrative*fields*with*the*existing*value:                             S01522 161789
     C***********                                                                      S01522 161789
     C************         MOVE NARR      O#NAR1                                       S01522 161789
     C************         MOVE NARR      O#NAR2                                       S01522 161789
     C***/COPY WNCPYSRC,GL1140C006                                                            161789
     C***********                                                                      S01522 161789
     C**If*the*facility*is*switched*off*or*unavailable,                                S01522 161789
     C***or*UDC*is*not*installed,*exit*this*subroutine:                                S01522 161789
     C***********                                                                      S01522 161789
     C***********GLPNAR    IFNE 'Y'                                                    S01522 161789
     C***********          GOTO EXPNAR                                                 S01522 161789
     C***********          ENDIF                                                       S01522 161789
     C**...........................................................                    S01522 161789
     C***/EJECT*                                                                       S01522 161789
     C*............................................................                    S01522 161789
     C**Determine*the*debit*customer's*name:***************************                S01522 161789
     C***********                                                                      S01522 161789
     C***********          MOVELDRCN      ##KEY     P                                  S01522 161789
     C***********                                                                      S01522 161789
     C***********          CALL 'AOCUSTR0'                                             S01522 161789
     C***********          PARM           ##RTN   7                                    S01522 161789
     C***********          PARM '*KEY   ' ##OPT   7                                    S01522 161789
     C***********          PARM           ##KEY  10                                    S01522 161789
     C***********          PARM           ##STS   7                                    S01522 161789
     C***********SDCUST    PARM SDCUST    DSSDY                                        S01522 161789
     C***********                                                                      S01522 161789
     C***********##RTN     IFNE *BLANKS                                                S01522 161789
     C***********          MOVEL'SDCUSTPD'DBFILE      *************                    S01522 161789
     C***********          MOVEL'101'     DBASE       * DBERR 101 *                    S01522 161789
     C***********          MOVEL##OPT     DBOPTN      *************                    S01522 161789
     C***********          MOVELDRCN      DBKEY                                        S01522 161789
     C***********          EXSR *PSSR                                                  S01522 161789
     C***********          SETON                     U7U8LR                            S01522 161789
     C***********          GOTO DEND                                                   S01522 161789
     C***********          ENDIF                                                       S01522 161789
     C***********                                                                      S01522 161789
     C**Determine*the*value*for*the*first*narrative*using*AOPNARR0:****                S01522 161789
     C***********                                                                      S01522 161789
     C***********          CLEARCGPNAR                                                 S01522 161789
     C***********          CLEAR##PRM1                                                 S01522 161789
     C***********          MOVELREFN      MNTRNO    P                                  S01522 161789
     C***********          MOVE 'GL'      MNMODI                                       S01522 161789
     C***********          MOVE DRCN      MNCUST                                       S01522 161789
     C***********          MOVE BRCA      MNBRCA                                       S01522 161789
     C***********          MOVE CCY       MNCYCD                                       S01522 161789
     C***********          MOVE DRAC      MNACCD                                       S01522 161789
     C***********          MOVE DRSQ      MNACSQ                                       S01522 161789
     C***********          MOVE BBCRNM    MNCRNM                                       S01522 161789
     C***********          MOVE BOKC      MNBOKC                                       S01522 161789
     C***********          MOVE DRACNO    MNRACN                                       S01522 161789
     C***********          MOVELNARR      MNNARR    P                                  S01522 161789
     C***/COPY WNCPYSRC,GLH00757                                                              161789
     C***********                                                                      S01522 161789
     C***********          CALL 'AOPNARR0'                                             S01522 161789
     C***********          PARM           ##RTN                                        S01522 161789
     C***********          PARM 'GB00450' ##MGID  7                                    S01522 161789
     C***********          PARM           ##PRM1                                       S01522 161789
     C***********CGPNAR    PARM CGPNAR    ##PNAR                                       S01522 161789
     C***********          PARM           ##NARR 50                                    S01522 161789
     C***/COPY WNCPYSRC,GLH00758                                                              161789
     C**...........................................................                    S01522 161789
     C***/EJECT**                                                                      S01522 161789
     C**...........................................................                    S01522 161789
     C***********##RTN     IFNE *BLANKS                                                S01522 161789
     C***********          MOVEL'CGPNARPD'DBFILE      *************                    S01522 161789
     C***********          MOVEL'102'     DBASE       * DBERR 102 *                    S01522 161789
     C***********          MOVELMNCUST    DBKEY       *************                    S01522 161789
     C***********          EXSR *PSSR                                                  S01522 161789
     C***********          SETON                     U7U8LR                            S01522 161789
     C***********          GOTO DEND                                                   S01522 161789
     C***********          ENDIF                                                       S01522 161789
     C***********                                                                      S01522 161789
     C***********          MOVEL##NARR    O#NAR1    P                                  S01522 161789
     C***********                                                                      S01522 161789
     C**Determine*the*credit*customer's*name:                                          S01522 161789
     C***********                                                                      S01522 161789
     C***********          MOVELCRCN      ##KEY     P                                  S01522 161789
     C***********                                                                      S01522 161789
     C***********          CALL 'AOCUSTR0'                                             S01522 161789
     C***********          PARM           ##RTN                                        S01522 161789
     C***********          PARM '*KEY   ' ##OPT                                        S01522 161789
     C***********          PARM           ##KEY                                        S01522 161789
     C***********          PARM           ##STS                                        S01522 161789
     C***********SDCUST    PARM SDCUST    DSSDY                                        S01522 161789
     C***********                                                                      S01522 161789
     C***********##RTN     IFNE *BLANKS                                                S01522 161789
     C***********          MOVEL'SDCUSTPD'DBFILE    *************                      S01522 161789
     C***********          MOVEL'103'     DBASE     * DBERR 103 *                      S01522 161789
     C***********          MOVEL##OPT     DBOPTN    *************                      S01522 161789
     C***********          MOVELCRCN      DBKEY                                        S01522 161789
     C***********          EXSR *PSSR                                                  S01522 161789
     C***********          SETON                     U7U8LR                            S01522 161789
     C***********          GOTO DEND                                                   S01522 161789
     C***********          ENDIF                                                       S01522 161789
     C**...........................................................                    S01522 161789
     C***/EJECT**                                                                      S01522 161789
     C**...........................................................                    S01522 161789
     C**Determine*the*value*for*the*second*narrative*usingAOPNARR0******               S01522 161789
     C***********                                                                      S01522 161789
     C***********          CLEARCGPNAR                                                 S01522 161789
     C***********          CLEAR##PRM1                                                 086125 161789
     C***********          MOVELREFN      MNTRNO    P                                  S01522 161789
     C***********          MOVE 'GL'      MNMODI                                       S01522 161789
     C***********          MOVE CRCN      MNCUST                                       S01522 161789
     C***********          MOVE BRCA      MNBRCA                                       S01522 161789
     C***********          MOVE CCY       MNCYCD                                       S01522 161789
     C***********          MOVE CRAC      MNACCD                                       S01522 161789
     C***********          MOVE CRSQ      MNACSQ                                       S01522 161789
     C***********          MOVE BBCRNM    MNCRNM                                       S01522 161789
     C***********          MOVE BOKC      MNBOKC                                       S01522 161789
     C***********          MOVE CRACNO    MNRACN                                       S01522 161789
     C***********          MOVELNARR      MNNARR    P                                  S01522 161789
     C***/COPY WNCPYSRC,GLH00759                                                              161789
     C***********                                                                      S01522 161789
     C***********          CALL 'AOPNARR0'                                             S01522 161789
     C***********          PARM           ##RTN                                        S01522 161789
     C***********          PARM 'GB00460' ##MGID                                       S01522 161789
     C***********          PARM           ##PRM1                                       086125 161789
     C***********CGPNAR    PARM CGPNAR    ##PNAR                                       S01522 161789
     C***********          PARM           ##NARR                                       S01522 161789
     C***/COPY WNCPYSRC,GLH00760                                                              161789
     C***********                                                                      S01522 161789
     C***********##RTN     IFNE *BLANKS                                                S01522 161789
     C***********          MOVEL'CGPNARPD'DBFILE      *************                    S01522 161789
     C***********          MOVEL'104'     DBASE       * DBERR 104 *                    S01522 161789
     C***********          MOVELMNCUST    DBKEY       *************                    S01522 161789
     C***********          EXSR *PSSR                                                  S01522 161789
     C***********          SETON                     U7U8LR                            S01522 161789
     C***********          GOTO DEND                                                   S01522 161789
     C***********          ENDIF                                                       S01522 161789
     C***********                                                                      S01522 161789
     C***********          MOVEL##NARR    O#NAR2    P                                  S01522 161789
     C***********                                                                      S01522 161789
     C***********EXPNAR    TAG                         < EXPNARS                       S01522 161789
     C***********                                                                      S01522 161789
     C***********          ENDSR                                                       S01522 161789
     C******************************************************************               S01522 161789
     C/EJECT
      *                                                                                       190679
      **  CALEOM - Calculates the End of Month Date.                                          190679
      *                                                                                       190679
     C           CALEOM    BEGSR                                                              190679
     C                     EXSR ZDATE2                                                        190679
     C                     MOVELZDATE     WDDMM   4                                           190679
     C                     Z-ADD32        WDD     20                                          190679
     C                     MOVE '1'       *IN99                                               190679
     C           *IN99     DOWEQ'1'                                                           190679
     C                     SUB  1         WDD                                                 190679
     C           *IN98     IFEQ '1'                                                           190679
     C                     MOVE WDD       WDDMM                                               190679
     C                     ELSE                                                               190679
     C                     MOVELWDD       WDDMM                                               190679
     C                     ENDIF                                                              190679
     C                     MOVELWDDMM     ZDATE                                               190679
     C                     EXSR ZDATE1                                                        190679
     C                     ENDDO                                                              190679
     C                     Z-ADDZDAYNO    WEOMDT  50                                          190679
     C                     ENDSR                                                              190679
      *                                                                                       190679
      /EJECT                                                                                  190679
      *                                                                                       190679
      **  DLYACC - Computes the next Accrual Day for Daily Accrual.                           190679
      *                                                                                       190679
     C           DLYACC    BEGSR                                                              190679
      *                                                                                       190679
      ** Check if ANWD processing is necessary.                                               190679
      *                                                                                       190679
     C           BKANWD    IFEQ '0'                                                           190679
     C           AMAPDA    ANDLTWNADM1                                                        190679
     C           BKANWD    OREQ '1'                                                           190679
     C           WEOMDT    ANDLTWNADM1                                                        190679
     C                     MOVE 'Y'       WANWD   1                                           190679
     C                     ELSE                                                               190679
     C                     MOVE 'N'       WANWD                                               190679
     C                     ENDIF                                                              190679
     C           WANWD     IFEQ 'Y'                                                           190679
     C                     Z-ADDWNADM1    WAPDA                                               190679
     C                     ELSE                                                               190679
     C                     SELEC                                                              190679
     C           BKANWD    WHEQ '0'                                                           190679
     C           WEOMDT    IFLT WNWDS1                                                        190679
     C                     Z-ADDWEOMDT    WAPDA                                               190679
     C                     ELSE                                                               190679
     C                     Z-ADDWNXTWD    WAPDA                                               190679
     C                     ENDIF                                                              190679
     C           BKANWD    WHEQ '1'                                                           190679
     C           WEOMDT    IFLT WNWDS1                                                        190679
     C           AMAPDA    ANDNEWEOMDT                                                        190679
     C                     Z-ADDWEOMDT    WAPDA                                               190679
     C                     ELSE                                                               190679
     C                     Z-ADDWNWDS1    WAPDA                                               190679
     C                     ENDIF                                                              190679
     C           BKANWD    WHEQ '2'                                                           190679
     C           WEOMDT    IFLE WNWDS1                                                        190679
     C                     Z-ADDWEOMDT    WAPDA                                               190679
     C                     ELSE                                                               190679
     C                     Z-ADDWNXTWD    WAPDA                                               190679
     C                     ENDIF                                                              190679
     C                     ENDSL                                                              190679
     C                     ENDIF                                                              190679
     C                     ENDSR                                                              190679
      *                                                                                       190679
     C/EJECT                                                                                  190679
0578 C********************************************************************GL1140
0579 C**                                                                  GL1140
0580 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            GL1140
0581 C**                                                                  GL1140
0582 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         GL1140
0583 C**                                                                  GL1140
0584 C           ZDATE2    BEGSR                           *** ZDATE2 *** GL1140
0585 C**                                                                  GL1140
0586 C**   CLEAR DATE FIELDS.                                             GL1140
0587 C                     Z-ADD0         ZDATE   60                      GL1140
0588 C                     MOVEL'       ' ZADATE  7                       GL1140
0589 C**                                                                  GL1140
0590 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        GL1140
0591 C                     Z-ADDZDAYNO    ZDAYNO  50                      GL1140
0592 C**                                                                  GL1140
0593 C**   DETERMINE YEAR NUMBER.                                         GL1140
0594 C**                                                                  GL1140
0595 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    GL1140
0596 C           ZDAYNO    SUB  1         ZDAYN1  50   99                 GL1140
0597 C   99                GOTO ZDEND2                                    GL1140
0598 C**                                                                  GL1140
0599 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             GL1140
0600 C           ZDAYN1    DIV  1461      ZLYR    20                      GL1140
0601 C                     MVR            ZDAYN1           SAVE REMAINING GL1140
0602 C**                                                   DAYS           GL1140
0603 C**   CALCULATE NUMBER OF REMAINING YEARS.                           GL1140
0604 C                     Z-ADD1         ZWRK2   20                      GL1140
0605 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *GL1140
0606 C           ZDAYN1    COMP ZYDY,ZWRK2             90                 GL1140
0607 C  N90      ZWRK2     ADD  1         ZWRK2                           GL1140
0608 C  N90                GOTO ZDTAG1                                    GL1140
0609 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON GL1140
0610 C**                                                                  GL1140
0611 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  GL1140
0612 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          GL1140
0613 C**                                                                  GL1140
0614 C**   CALCULATE ACTUAL YEAR NUMBER.                                  GL1140
0615 C           ZLYR      MULT 4         ZWRK3   30                      GL1140
0616 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   GL1140
0617 C                     Z-ADDZWRK3     ZYEAR   20                      GL1140
0618 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           GL1140
0619 C**                                                                  GL1140
0620 C**   DETERMINE MONTH NUMBER.                                        GL1140
0621 C**                                                                  GL1140
0622 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         GL1140
0623 C                     SETOF                     9293                 GL1140
0624 C   91      ZDAYN1    COMP 59                     9293               GL1140
0625 C   91N92   ZDAYN1    SUB  1         ZDAYN1                          GL1140
0626 C**                                                                  GL1140
0627 C**   CALCULATE MONTH NUMBER.                                        GL1140
0628 C                     Z-ADD2         ZWRK2                           GL1140
0629 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *GL1140
0630 C           ZDAYN1    COMP ZMDY,ZWRK2             94                 GL1140
0631 C  N94      ZWRK2     ADD  1         ZWRK2                           GL1140
0632 C  N94                GOTO ZDTAG2                                    GL1140
0633 C           ZWRK2     SUB  1         ZWRK2                           GL1140
0634 C**                                                                  GL1140
0635 C                     Z-ADDZWRK2     ZMTH    20       MONTH          GL1140
0636 C**                                                                  GL1140
0637 C**   DETERMINE DAY OF MONTH.                                        GL1140
0638 C**                                                                  GL1140
0639 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          GL1140
0640 C           ZDAYN1    ADD  1         ZDAYN1                          GL1140
0641 C**                                                                  GL1140
0642 C**   CALCULATE DAY OF MONTH.                                        GL1140
0643 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            GL1140
0644 C**                                                                  GL1140
0645 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       GL1140
0646 C   93      ZDAY      ADD  1         ZDAY                            GL1140
0647 C**                                                                  GL1140
0648 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 GL1140
0649 C  N98                MOVELZDAY      ZWRK4   40                      GL1140
0650 C   98                MOVE ZDAY      ZWRK4                           GL1140
0651 C  N98                MOVE ZMTH      ZWRK4                           GL1140
0652 C   98                MOVELZMTH      ZWRK4                           GL1140
0653 C                     MOVELZWRK4     ZDATE                           GL1140
0654 C                     MOVE ZYEAR     ZDATE                           GL1140
0655 C**                                                                  GL1140
0656 C**   FORMAT ALPHA DATE, DDMMMYY.                                    GL1140
0657 C           ZDAY      COMP 10                     95                 GL1140
0658 C                     MOVELZDAY      ZWRK5   5                       GL1140
0659 C   95                MOVEL' '       ZWRK5                           GL1140
0660 C                     MOVE ZMNM,ZMTH ZWRK5                           GL1140
0661 C                     MOVELZWRK5     ZADATE                          GL1140
0662 C                     MOVE ZYEAR     ZADATE                          GL1140
0663 C**                                                                  GL1140
0664 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*GL1140
0665 C**                                                                  GL1140
0666 C**                                                                  GL1140
0667 C********************************************************************GL1140
     C*                                                                   CGL003
     C/COPY ZSRSRC,ZDATE1Z2                                               CGL003
     C/COPY ZSRSRC,ZACCH                                                  CGL003
     C/COPY ZSRSRC,ZCHKH                                                  CGL003
     C/COPY ZSRSRC,ZFREQBZ2                                               CGL003
     C*                                                                   CGL003
0169 C********************************************************************S01194
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C**                                                                  S01194
0668 C********************************************************************GL1140
0669 C**                                                                  GL1140
0670 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0671 C**                                                                  GL1140
0672 C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0673 C**                                                                  GL1140
0674 C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0675 C***********          MOVEL'01      'ZTABKY 12                       S01194
0676 C***********          MOVE '  10'    ZTABKY                          S01194
0677 C**                                                                  GL1140
0678 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0679 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0680 C**                                                                  GL1140
0681 C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0682 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0683 C**                                                                  GL1140
0684 C***********          ENDSR                                          S01194
0685 C**                                                                  GL1140
0686 C**                                                                  GL1140
0687 C********************************************************************GL1140
0688 C/SPACE 3                                                            GL1140
0689 O*                                                                   GL1140
0690 O** OUTPUT TO NEW AMOUNT ACCRUAL MASTER FILE                         GL1140
0691 ONAMACA  H        1P                                                 GL1140
0692 O                                    1 'A'                           GL1140
0693 ONAMACD  D        02N50                                              GL1140
0694 O       OR        03N50                                              GL1140
0695 O*****************        LOTA     128                               CGL003
0695 O**********               LOTA     134                                            CGL003 CGL029
     O**********               LOTA     154                                            CGL029 CGL064
     O                         LOTA     160                                                   CGL064
0696 O                       61           1 'M'                           GL1140
0697 O                       61AMPD     113P                              GL1140
0698 O                       62AMPD     113P                              GL1140
0698 O                 46    62AMAPFQ   129                               CGL003
0698 O                 46    62AMFDAY   131                               CGL003
0698 O                 46    62WAPDA    134P                              CGL003
     O*                                                                   CGL003
     O/COPY WNCPYSRC,GLH00548
     O/COPY OFCPYSRCZ,CGL141_036                                                              CGL141
0699 ONAMACZ  T        LR                                                 GL1140
0700 O*****************        LOTT     128                               CGL003
0700 O**********               LOTT     134                                            CGL003 CGL029
     O**********               LOTT     154                                            CGL029 CGL064
     O                         LOTT     160                                                   CGL064
0701 O                         NOREAO    37P                              GL1140
0702 O                         NORELO    40P                              GL1140
0703 O                         TOTAWO    57P                              GL1140
0704 O                         TOTLWO    65P                              GL1140
0705 O                         TOTADO    91P                              GL1140
0706 O                         TOTLDO    93P                              GL1140
0707 O*                                                                   GL1140
0708 O** GENERATED ENTRIES                                                GL1140
0711 O*GEAAPD**D        53                                                             GL1140 237361
0712 O*******OR*       54                                                              GL1140 237361
     OGEAAPD  D        53N81                                                                  237361
     O       OR        54N81                                                                  237361
0713 O                                    1 'P'                           GL1140
0714 O                         DRCN       7                               GL1140
0715 O                         CCY       10                               GL1140
0716 O**********               DRAC      14                                            GL1140 CGL029
     O                         DRACQQ    14                                                   CGL029
0717 O                         DRSQ      16                               GL1140
0718 O                         DRACNO    32                               GL1140
0719 O                         RUND      35P                              GL1140
0720 O                       60RUND      38P                              GL1140
0721 O                       61MDAT      38P                              GL1140
0722 O***********            62APDA      38P                              S01194
0722 O***********            62BKAPDT    38P                        S01194CGL003
0722 O                N46    62BKAPDT    38P                              CGL003
0722 O                 46    62AMAPDA    38P                              CGL003
0723 O*********** S01522       NARR      73                               S01522
     O***********              O#NAR1    73                                            S01522 161789
     O                         NARR      73                                                   161789
0724 O                         PAMT      80P                              GL1140
0725 O                                   81 '0'                           GL1140
0726 O                       60          81 '1'                           GL1140
0727 O                    54 60          81 '0'                           GL1140
0728 O                    54N60          81 '1'                           GL1140
     O/COPY WNCPYSRC,GL1140O001
0729 O                                   95 '00000000000000'              GL1140
     O/COPY WNCPYSRC,GL1140O003
     O**********       47      WASOC     87                                          CGL064 MD019831
     O                 48      WASOC     87                                                 MD019831
0730 O                                  102 'GE-AA'                       GL1140
0731 O***********              DRBRCD   105                               S01117
0731 O                         BRCA     105                               S01117
0732 O                                  106 '0'                           GL1140
0733 O                       64         106 '1'                           GL1140
0734 O                         ZERO3    108P                              GL1140
0735 O                         ZERO5    114P                              GL1140
0736 O                         DRATYP   124                               GL1140
0737 O                         BITS     128                               GL1140
     O                                  129 'M'
0738 O                                  130 '0'                           GL1140
0738 O                         PRFC     134                               S01117
     O                                  140 '235959'                      S10736
     O                                  141 '0'                           S10736
     O                         DRACSC   146                               S10736
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         WBLK01   352                                                   CGL020
     O                         WZE130   359P                                                  CGL020
     O                         WZER05   364                                                   CGL020
     O                         WBLK10   540                                                   CGL020
     O                         WBLK20   560                                                   CGL020
     O                         WZE132   573                                                   CGL020
     O                         DRAC     599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O                         TRAT      43                                                 AR894864
     O                         LTAI     147                                                 AR894864
     O                         NITMS    271P                                                AR894864
     O                         CHGA     279P                                                AR894864
     O                         ORAMT    316P                                                AR894864
     O                         XRFN     329                                                 AR894864
     O                         SETDAT   530P                                                AR894864
      *                                                                                       237361
      ** Output Debit Suspense Posting Record                                                 237361
      *                                                                                       237361
     O        D        53 81                                                                  237361
     O       OR        54 81                                                                  237361
     O                                    1 'P'                                               237361
     O                         DRBICN     7                                                   237361
     O                         CCY       10                                                   237361
     O**********               BKACCD    14                                            237361 239929
     O                         WCODA     14                                                   239929
     O                                   16 '01'                                              237361
     O                                   32 '0000000000'                                      237361
     O                         RUND      35P                                                  237361
     O                       60RUND      38P                                                  237361
     O                       61MDAT      38P                                                  237361
     O                       62BKAPDT    38P                                                  237361
     O                         NARR      73                                                   237361
     O                         PAMT      80P                                                  237361
     O                                   81 '0'                                               237361
     O                       60          81 '1'                                               237361
     O                    54 60          81 '0'                                               237361
     O                    54N60          81 '1'                                               237361
     O                                   95 '00000000000000'                                  237361
     O                                  102 'GE-AA'                                           237361
     O                         DRBRCD   105                                                   237361
     O                                  106 '0'                                               237361
     O                         ZERO3    108P                                                  237361
     O                         ZERO5    114P                                                  237361
     O                         CSTYP    124                                                   237361
     O                         BITS     128                                                   237361
     O                                  129 'M'                                               237361
     O                                  130 '0'                                               237361
     O                         PRFC     134                                                   237361
     O                                  140 '235959'                                          239929
     O                                  141 '0'                                               239929
     O                         DRACSC   146                                                   239929
     O**********               OTRF     230                                            237361 239929
     O                         OTRFQQ   230                                                   239929
     O                         OTST     240                                                   237361
     O                         OTTP     250                                                   237361
     O                         SDCB     258P                                                  237361
     O                         SDLB     266P                                                  237361
     O                         BOKC     268                                                   237361
     O                         WBLK01   352                                                   237361
     O                         WZE130   359P                                                  237361
     O                         WZER05   364                                                   237361
     O                         WBLK10   540                                                   237361
     O                         WBLK20   560                                                   237361
     O                         WZE132   573                                                   237361
     O                         @CODA    599                                                   237361
     O                         OTRF     620                                                   237361
     O                         TRAT      43                                                 AR894864
     O                         LTAI     147                                                 AR894864
     O                         NITMS    271P                                                AR894864
     O                         CHGA     279P                                                AR894864
     O                         ORAMT    316P                                                AR894864
     O                         XRFN     329                                                 AR894864
     O                         SETDAT   530P                                                AR894864
0739 O********D*       53                                                              GL1140 237361
0740 O*******OR*       54                                                              GL1140 237361
     O        D        53N82                                                                  237361
     O       OR        54N82                                                                  237361
0741 O                                    1 'P'                           GL1140
0742 O                         CRCN       7                               GL1140
0743 O                         CCY       10                               GL1140
0744 O**********               CRAC      14                                            GL1140 CGL029
     O                         CRACQQ    14                                                   CGL029
0745 O                         CRSQ      16                               GL1140
0746 O                         CRACNO    32                               GL1140
0747 O                         RUND      35P                              GL1140
0748 O                       60RUND      38P                              GL1140
0749 O                       61MDAT      38P                              GL1140
0750 O***********            62APDA      38P                              S01194
0750 O***********            62BKAPDT    38P                        S01194CGL003
0722 O                N46    62BKAPDT    38P                              CGL003
0722 O                 46    62AMAPDA    38P                              CGL003
0751 O*********** S01522       NARR      73                               S01522
     O***********              O#NAR2    73                                            S01522 161789
     O                         NARR      73                                                   161789
0752 O                         PAMT      80P                              GL1140
0753 O                                   81 '1'                           GL1140
0754 O                       60          81 '0'                           GL1140
0755 O                    54 60          81 '1'                           GL1140
0756 O                    54N60          81 '0'                           GL1140
     O/COPY WNCPYSRC,GL1140O002
0757 O                                   95 '00000000000000'              GL1140
     O/COPY WNCPYSRC,GL1140O004
     O**********       47      WASOC     87                                          CGL064 MD019831
     O                 48      WASOC     87                                                 MD019831
0758 O                                  102 'GE-AA'                       GL1140
0759 O***********              CRBRCD   105                               S01117
0759 O                         BRCA     105                               S01117
0760 O                                  106 '0'                           GL1140
0761 O                       65         106 '1'                           GL1140
0762 O                         ZERO3    108P                              GL1140
0763 O                         ZERO5    114P                              GL1140
0764 O                         CRATYP   124                               GL1140
0765 O                         BITS     128                               GL1140
     O                                  129 'M'
0766 O                                  130 '0'                           GL1140
0738 O                         PRFC     134                               S01117
     O                                  140 '235959'                      S10736
     O                                  141 '0'                           S10736
     O                         CRACSC   146                               S10736
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         WBLK01   352                                                   CGL020
     O                         WZE130   359P                                                  CGL020
     O                         WZER05   364                                                   CGL020
     O                         WBLK10   540                                                   CGL020
     O                         WBLK20   560                                                   CGL020
     O                         WZE132   573                                                   CGL020
     O                         CRAC     599                                                   CGL029
     O                         OTRF     620                               S01182              CGL029
     O                         TRAT      43                                                 AR894864
     O                         LTAI     147                                                 AR894864
     O                         NITMS    271P                                                AR894864
     O                         CHGA     279P                                                AR894864
     O                         ORAMT    316P                                                AR894864
     O                         XRFN     329                                                 AR894864
     O                         SETDAT   530P                                                AR894864
      *                                                                                       237361
      ** Output Credit Suspense Posting Record                                                237361
      *                                                                                       237361
     O        D        53 82                                                                  237361
     O       OR        54 82                                                                  237361
     O                                    1 'P'                                               237361
     O                         CRBICN     7                                                   237361
     O                         CCY       10                                                   237361
     O**********               BKACCD    14                                            237361 239929
     O                         WCODA     14                                                   239929
     O                                   16 '01'                                              237361
     O                                   32 '0000000000'                                      237361
     O                         RUND      35P                                                  237361
     O                       60RUND      38P                                                  237361
     O                       61MDAT      38P                                                  237361
     O                       62BKAPDT    38P                                                  237361
     O                         NARR      73                                                   237361
     O                         PAMT      80P                                                  237361
     O                                   81 '1'                                               237361
     O                       60          81 '0'                                               237361
     O                    54 60          81 '1'                                               237361
     O                    54N60          81 '0'                                               237361
     O                                   95 '00000000000000'                                  237361
     O                                  102 'GE-AA'                                           237361
     O                         CRBRCD   105                                                   237361
     O                                  106 '0'                                               237361
     O                         ZERO3    108P                                                  237361
     O                         ZERO5    114P                                                  237361
     O                         CSTYP    124                                                   237361
     O                         BITS     128                                                   237361
     O                                  129 'M'                                               237361
     O                                  130 '0'                                               237361
     O                         PRFC     134                                                   237361
     O                                  140 '235959'                                          239929
     O                                  141 '0'                                               239929
     O                         CRACSC   146                                                   239929
     O**********               OTRF     230                                            237361 239929
     O                         OTRF     230                                                   239929
     O                         OTST     240                                                   237361
     O                         OTTP     250                                                   237361
     O                         SDCB     258P                                                  237361
     O                         SDLB     266P                                                  237361
     O                         BOKC     268                                                   237361
     O                         WBLK01   352                                                   237361
     O                         WZE130   359P                                                  237361
     O                         WZER05   364                                                   237361
     O                         WBLK10   540                                                   237361
     O                         WBLK20   560                                                   237361
     O                         WZE132   573                                                   237361
     O                         @CODA    599                                                   237361
     O                         OTRF     620                                                   237361
     O                         TRAT      43                                                 AR894864
     O                         LTAI     147                                                 AR894864
     O                         NITMS    271P                                                AR894864
     O                         CHGA     279P                                                AR894864
     O                         ORAMT    316P                                                AR894864
     O                         XRFN     329                                                 AR894864
     O                         SETDAT   530P                                                AR894864
0767 OGEAAZZ  T        LR                                                 GL1140
0768 O                                    1 'T'                           GL1140
0769 O                         NOREG      6                               GL1140
0770 O                         TOTGW     14P                              GL1140
0771 O                         TOTGD     16P                              GL1140
0772 O*                                                                   GL1140
0773 O** RUN CONTROL REPORT                                               GL1140
0774 O*L1140P1T** 03   LR                                                 S01117
0774 OGL1140AUT   03   LR                                                 S01117
0775 O***********                        22 'REFERENCE GL1140'            S01117
0775 O                                   24 'REFERENCE GL1140AU'          S01117
0776 O***********              TITL      89                               S01194
0454 O                         BJURPT    89                               S01194
0777 O                                  104 'DATE'                        GL1140
0778 O                         RUNA     112                               GL1140
0779 O                                  127 'PAGE    1'                   GL1140
0780 O        T   05   LR                                                 GL1140
0781 O                                   62 'AMOUNT ACCRUAL UPDATE'       GL1140
0782 O                                   83 'AND ENTRY GENERATION'        GL1140
     O                                   98 'RUN CONTROLS'                S01117
0784 O        T   06   LR                                                 GL1140
0785 O                                   63 '----------------------'      GL1140
0786 O                                   83 '--------------------'        GL1140
0787 O        T   20   LR                                                 GL1140
0788 O***********                        19 'RUN CONTROLS -'              S01117
0789 O                                   72 '------------ PROGRAM'        GL1140
0790 O                                   84 '-----------'                 GL1140
0791 O                                  115 '--------- FILE TRAILER'      GL1140
0792 O                                  124 '--------'                    GL1140
0793 O        T   22   LR                                                 GL1140
0794 O                                   58 'NUMBER'                      GL1140
0795 O                                   84 'VALUE'                       GL1140
0796 O                                   99 'NUMBER'                      GL1140
0797 O                                  124 'VALUE'                       GL1140
0798 O        T   23   LR                                                 GL1140
0799 O                                   35 'S/AMACC - AMOUNT ACCRUAL'    GL1140
0800 O                                   42 'MASTER'                      GL1140
0801 O        T   25   LR                                                 GL1140
0802 O                                   30 'NUMBER OF LIVE RECORDS'      GL1140
0803 O                                   38 'ON FILE'                     GL1140
0804 O                         NOREL 3   58                               GL1140
0805 O                         TOTLW Z   80                               GL1140
0806 O                         TOTLD     83                               GL1140
0807 O                         NR2   3   99                               GL1140
0808 O                         WN2   Z  120                               GL1140
0809 O                         DC2      123                               GL1140
0810 O                       71         130 '***'                         GL1140
0811 O        T   27   LR                                                 GL1140
0812 O                                   32 'NUMBER OF ACTIVE RECORDS'    GL1140
0813 O                                   40 'ON FILE'                     GL1140
0814 O                         NOREA 3   58                               GL1140
0815 O                         TOTAW Z   80                               GL1140
0816 O                         TOTAD     83                               GL1140
0817 O                         NR1   3   99                               GL1140
0818 O                         WN1   Z  120                               GL1140
0819 O                         DC1      123                               GL1140
0820 O                       70         130 '***'                         GL1140
0821 O        T   29   LR                                                 GL1140
0822 O                                   31 'S/NAMAC - NEW AMOUNT'        GL1140
0823 O                                   46 'ACCRUAL MASTER'              GL1140
0824 O        T   31   LR                                                 GL1140
0825 O                                   30 'NUMBER OF LIVE RECORDS'      GL1140
0826 O                                   38 'ON FILE'                     GL1140
0827 O                         NORELO3   58                               GL1140
0828 O                         TOTLWOZ   80                               GL1140
0829 O                         TOTLDO    83                               GL1140
0830 O        T   33   LR                                                 GL1140
0831 O                                   32 'NUMBER OF ACTIVE RECORDS'    GL1140
0832 O                                   40 'ON FILE'                     GL1140
0833 O                         NOREAO3   58                               GL1140
0834 O                         TOTAWOZ   80                               GL1140
0835 O                         TOTADO    83                               GL1140
0836 O        T   35   LR                                                 GL1140
0837 O                                   31 'S/AMACPD - GENERATED'        GL1140
0838 O                                   39 'ENTRIES'                     GL1140
0839 O        T   37   LR                                                 GL1140
0840 O                                   28 'NUMBER OF RECORDS ON'        GL1140
0841 O                                   33 'FILE'                        GL1140
0842 O                         NOREG 3   58                               GL1140
0843 O                         TOTGW Z   80                               GL1140
0844 O                         TOTGD     83                               GL1140
0845 O********T** 39   LR U7                                              S01194
0845 O        T   39   LR U7 U8                                           S01194
0846 O                                   42 '*** REFERENCE'               GL1140
0377 O***********              DBPGM     51                               S01194
0377 O                         DBPGM     53                               S01194
0848 O                                   71 '-DATABASE ERROR AT'          GL1140
0379 O***********              DBASE     74                               S01194
0379 O                         DBASE     75                               S01194
0850 O********T** 40   LR U7                                              S01194
0850 O        T   40   LR U7 U8                                           S01194
0851 O                                   37 'FILE NAME'                   GL1140
0382 O***********              DBFILE    43                               S01194
0383 O***********                        48 'KEY'                         S01194
0384 O***********              DBKEY     78                               S01194
0382 O                         DBFILE    46                               S01194
0383 O                                   51 'KEY'                         S01194
0384 O                         DBKEY     81                               S01194
0855 O********T** 45   LR U8                                              S01194
0855 O        T   45   LR U8NU7                                           S01194
0856 O                                  100 '*** DIFFERENCE ***'          GL1140
0857 O********T** 50   LR                                                 S01117
0858 O***********                        73 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                                 CGL003
312831303130313130313031                                                  CGL003
