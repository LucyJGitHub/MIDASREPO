     H*                                                                   E13081
     H***********                         F                         E13081S01194
     H        1                           F                               S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Generate statement SWIFT msgs in COB')        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - General Ledger Module                                *
     F*                                                               *
     F*  GL1300 - SWIFT STATEMENTS MESSAGES                           *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. LUC111             Date 24Jan19               *
      *  Prev Amend No. MD023587           Date 30Apr14               *
      *                 CGL136             Date 25Jan13               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR577133           Date 27Jul12               *
      *                 AR787620           Date 10Jun11               *
      *                 CLE064             Date 06Dec10               *
      *                 223548             Date 25Jan04               *
      *                 CER059             Date 19Jul10               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 248625             Date 21Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 159993             Date 06Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG5978            Date 11Jan05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222385             Date 23Oct03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 CSD015             Date 03Mar03               *
      *                 CGL020             Date 12Dec02               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      *                 081690             Date 04Apr01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      *                 CSW022             Date 06Dec00               *
      *                 CSW021             Date 06Dec00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSW020             Date 04JAN00               *
     F*                 166138             Date 06Oct99               *
      * Midas DBA 3.01 -----------------------------------------------*
     F*                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 141572             Date 21Sep98               *
     F*                 S01408             Date 27Oct98               *
      *                 136665             DATE 04JUN98               *
      *                 CEU013             DATE 03APR98               *
      *                 113352             DATE 29JAN97               *
     F*                 092062             DATE 03MAR98               *
     F*                 130832             DATE 19FEB98               *
     F*                 121741             DATE 19SEP97               *
     F*                 130177             DATE 06FEB98               *
     F*                 121652             DATE 15AUG97               *
     F*                 101867             DATE 10MAR97               *
     F*                 S01408             DATE 20NOV96               *
     F*                 S01408             DATE 18OCT96               *
     F*                 S01408             DATE 07OCT96               *
     F*                 S01408             DATE 26SEP96               *
     F*                 S01408             DATE 03SEP96               *
     F*                 CSW096             DATE  3JUN96               *
     F*                 S01408             DATE 29JUL96               *
     F*                 092642             DATE 01JUL96               *
     F*                 S01408             DATE 12APR96               *
     F*                 079167             DATE  2APR96               *
     F*                 082830             DATE  2APR96               *
     F*                 CSW004             DATE 20NOV95               *
     F*                 065654             DATE 25OCT95               *
     F*                 051657             DATE 26OCT95               *
     F*                 064107             DATE 26OCT95               *
     F*                 056763             DATE 13OCT95               *
     F*                 S01408             DATE 06JUN95               *
     F*                 CRT001             DATE 28FEB95               *
     F*                 080808             DATE 05JAN95               *
     F*                 063303             DATE 24AUG94               *
     F*                 054721             DATE 24AUG94               *
     F*                 S01408             DATE 19MAY94               *
     F*                 S01413             DATE 13APR93               *
     F*                 065886             DATE 16JAN94               *
     F*                 046303             DATE 16JAN94               *
     F*                 S01408             DATE 01OCT93               *
     F*                 S01427             DATE 12JUL93               *
     F*                 E42857             DATE 24OCT92               *
     F*                 E38323             DATE 31JUL92               *
     F*                 E40283             DATE 23JUN92               *
     F*                 S01389             DATE 22JUN92               *
     F*                 E32342             DATE 22NOV91               *
     F*                 E32488             DATE 25NOV91               *
     F*                 E32485             DATE 25NOV91               *
     F*                 E32329             DATE 21OCT91               *
     F*                 E32328             DATE 21OCT91               *
     F*                 E32327             DATE 21OCT91               *
     F*                 E29588             DATE 14OCT91               *
     F*                 S01310             DATE 08AUG91               *
     F*                 RT0086             DATE 31MAY91               *
     F*                 BHF456             DATE 25APR91               *
     F*                 BHF138             DATE  9DEC90               *
     F*                 BHF054             DATE  9DEC90               *
     F*                 E22406 (LN0665)    DATE 22AUG90               *
     F*                 LN0074             DATE 01/05/90              *
     F*                 LN0012             DATE 27/04/90              *
     F*                 E14686             DATE 25/01/89              *
     F*                 S01195             DATE 05/05/89              *
     F*                 S01194             DATE 24/02/89              *
     F*                 S01117             DATE 24/02/89              *
     F*                 E15758             DATE 02/12/88              *
     F*                 E15502             DATE 02/12/88              *
     F*                 E15660             DATE 25/10/88              *
     F*                 E13697             DATE 18/08/88              *
     F*                 E13086             DATE 20/07/88              *
     F*                 E13826             DATE 29/06/88              *
     F*                 E13081             DATE 24/06/88              *
     F*                 S03220             DATE 10/05/88              *
     F*                 S01135             DATE 07/12/87              *
     F*                 E11363                                        *
     F*                 S05452             DATE 20/08/87              *
     F*                 S01140             DATE 16/07/87              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  LUC111  - Upgrade of R4/NUC003 & fix/es as FB 2.1 LUC111     *
      *  A67971 - Omit NUC003 ext narr 1 in field 86 (GL1300C085).    *
      *           Fix bad "w" to "?" character conversion.            *
      *  NUC003 - Output EXTENDED NARRATIVES for GL, DL and RE        *
      *           Modules to SWIFT MT940 statements field 86.         *
      *           Amend core hook  GL1300FFP1                         *
      *           Amend core hook  GL1300EEP1                         *
      *           Amend core hook  GL1300I003                         *
      *           Amend core hook  GL1300C082                         *
      *           Amend core hook  GL1300C084                         *
      *           Amend core hook  GL1300C085                         *
      *           Amend core hook  GL1300C127                         *
      *           Add local hook   LUC111_001                         *
      *  MD023587 - 'w' incorrectly replace with '?'                  *
      *             Update *EQUATE table from 6FA6 to 6F6A            *
      *  CGL136 - Use Sender's SWIFT Address for MT940 Field 25       *
      *           Added copysources: CGL136_001, CGL136_002,          *
      *           CGL136_003, CGL136_004 and CGL136_005.              *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR577133 - Component MEC105 failed due to branches GT 200.   *
      *             Increase array size to 500. Apply fix 256122.     *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,GLH00075                                 *
      *             WNCPYSRC,GLH00076                                 *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  223548 - Problem in MMM because the host reference is not    *
      *           unique. field MREF should be the same as TRNO.      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER030 - Multicash German Feature (Recompile)                *
      *  248625 - A colon ':' must never be used as the first         *
      *           character of a line. Replace it by '?'.             *
      *  159993 - Apply fix 159993.                                   *
      *           Check field BBDSxx to decide whether MT940/MT950    *
      *           Statement should have message status 'RSND'.        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG5978- Due to CGL029, increase length of ACOUNT field.     *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222385 - SWIFT msgs are Watch List checked regardless of     *
      *           configuration file setting                          *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  CGL020 - Midas Compliance Watch - Additional A/C Postings    *
      *           Information                                         *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  081690 - Account Owner's Reference is output in subfield 7   *
      *           for all postings except journal entries, where SPOS *
      *           is output - remove this processing to make journal  *
      *           postings consistent with other postings - this is   *
      *           an amendment to fix 079167.                         *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CSW022 - Suppress generation of SWIFT Statement messages     *
      *           if account has no movements.                        *
      *  CSW021 - Suppress generation of SWIFT Statement messages     *
      *           if carried-forward balance (CFSB) of account is     *
      *           zero and it has no movements.                       *
      *   CDL008 - Continuous Linked Settlement (Recompiled MGOREFPD) *
     F*  CSW020 - SWIFT Decimal Places                                *
     F*           Use standard program ZM0040 to format amounts       *
     F*  166138 - Set up correct module id for customer exchange      *
     F*           transaction.                                        *
      *  CGL007 - Account Postings Enquiry.                           *
     F*  141572 - Recompiled over MGOREFPD                            *
     F*  S01408 - Addition of core hook GL1300CES1 - CORE MGMT        *
     F*           Addition of core hook GL1300CES2 - CORE MGMT        *
     F*  136665 - SCCY being overwritten by field SCCY in CLOAN       *
     F*           re-name field in CLOAN.                             *
     F*  CEU013 - EMU Account Postings Narrative.                     *
     F*  113352 - Set-up CIND (Century flag)  to correct year2000     *
     F*           display problem.                                    *
     F*  092062 - SWIFT statements being printed with statement date  *
     F*           less than run date. Amended program to use run date *
     F*           as base date instead of previous field date when    *
     F*           calculating next statement date.                    *
     F*  130832 - Condition Fix 121652 should apply to non internal   *
     F*           only.                                               *
     F*  121741 - Avoid Database error 14 on access to SDCUSTPD with  *
     F*           a zero customer number.                             *
     F*  121652 - Check field ENTSDC on file SDMGMEPD to decide       *
     F*           message status.                                     *
     F*  130177 - New field NLRA on CLOANCK conflicts with the same
     F*           field in CLOANZ1
     F*  101867 - Statement frequency of ' ' => statement on movement *
     F*           Print statement on Freq of 'D' regardless of        *
     F*           matching account record.                            *
     F*           Also, don't count deleted records to towards total  *
     F*           number of records. SWACNSC NORE should not include  *
     F*           deleted & closed records. Applied 068212.           *
     F*  S01408 - Addition of core hook GL1300CP26                    *
     F*           Addition of core hook GL1300CP25                    *
     F*  S01408 - Addition of core hook Gl1300CP24                    *
     F*           Addition of core hook Gl1300CP23                    *
     F*           Addition of core hook Gl1300CP22                    *
     F*           Addition of core hook Gl1300CP21                    *
     F*           Addition of core hook Gl1300IIP4                    *
     F*           Addition of core hook Gl1300IIP5                    *
     F*  S01408 - Addition of core hook GL1300OOP2                    *
     F*           Addition of core hook GL1300CP20                    *
     F*           Addition of core hook GL1300CP19                    *
     F*  S01408 - Addition of core hook GL1300OOP1                    *
     F*  S01408 - Addition of core hook GL1300CP18                    *
     F*           Addition of core hook GL1300CP17                    *
     F*           Addition of core hook GL1300CP16                    *
     F*           Addition of core hook GL1300CP15                    *
     F*           Addition of core hook GL1300CP14                    *
     F*  CSW096 - SWIFT Changes November 1996.                        *
     F*  S01408 - Addition of core hook GL1300FFP1                    *
     F*           Addition of core hook GL1300EEP1                    *
     F*           Addition of core hook GL1300IIP2                    *
     F*           Addition of core hook GL1300IIP3                    *
     F*           Addition of core hook GL1300CCP7                    *
     F*           Addition of core hook GL1300CCP8                    *
     F*           Addition of core hook GL1300CCP9                    *
     F*           Addition of core hook GL1300CP10                    *
     F*           Addition of core hook GL1300CP11                    *
     F*           Addition of core hook GL1300CP12                    *
     F*           Addition of core hook GL1300CP13                    *
     F*  092642 - Add 1 to statement number and reset page to 01 if   *
     F*           100 is reached.                                     *
     F*  S01408 - Addition of core hook GL1300IIP1                    *
     F*           Addition of core hook GL1300CCP2                    *
     F*           Addition of core hook GL1300CCP3                    *
     F*           Addition of core hook GL1300CCP4                    *
     F*           Addition of core hook GL1300CCP5                    *
     F*           Addition of core hook GL1300CCP6                    *
     F*  079167 - Field 61, subfield 8 is not populated with Branch,  *
     F*           Department, Batch & Item Nos because check on SPOS  *
     F*           field does not identify journal entries as journal  *
     F*           entries.                                            *
     F*  082830 - Set up FFEX narrative correctly                     *
     F*           Update account number correctly                     *
     F*           Amend Subfield 8 to have one character Module ID    *
     F*  CSW004 - MT940 SWIFT Message Generation - Switchable Feature.*
     F*  065654 - If Statement required and movement frequency, there    *
     F*           must be postings to print. Should be part 0f 063303.   *
     F*  051657 - ':', '-' or ' ' should not be allowed as first      *
     F*           character of field 61                               *
     F*  064107 - Do not process deleted SWACSSB records              *
     F*  056763 - A MT950 with NIL balance was 'NAK' in SWIFT network *
     F*           because there was no DB/CR indicator for field      *
     F*           62. Similar statements with NIL balance were        *
     F*           acknowledged but D/C indicators are wrong.          *
     F*  S01408 - Addition of core hook GL1300CCPG                    *
     F*                                 GL1300CCP1                    *
     F*  CRT001 - Retail Teller System.                               *
     F*                                                               *
     F*  080808 - Remove fix 054721, this fix is not needed when a    *
     F*           system has been correctly set up using SCBEGIN.     *
     F*           Also file controls out of balance should not cause  *
     F*           componant to fail.                                  *
     F*                                                               *
     F*  063303 - Record processing should continue if the statement  *
     F*           frequency is 'D' (daily) regardless of a matching   *
     F*           posting record.  Also if the statement frequency    *
     F*           is ' ' for on movement with a matching posting      *
     F*           record.                                             *
     F*  054721 - File Controls Out Of Balance.  Difference of 2      *
     F*           between POSTOT and TPNORE.  Input control total     *
     F*           should be adjusted by 2 only when SWIFT posting     *
     F*           file exists.                                        *
     F*  S01408 - Core hook GL1300CMT1 added                          *
     F*           Core hook GL1300CMT2 added                          *
     F*           Core hook GL1300CMT3 added                          *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  065886 - Correction to FT SWIFT statement formating          *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  S01408 - Core hook GL1300CEIP added                          *
     F*         - Core hook FX0820CPLT added                          *
     F*  S01427 - R10 CHIPS INCORPORATION                             *
     F*  E42857 - Processing for field :64: (funds available)         *
     F*           should be conditioned on RE a/c (*IN35), rather     *
     F*           than RE a/c with non-zero RE a/c no. (*IN88)        *
     F*  E38323 - Recompiled due to a change in copy source ZFWDT subr*
     F*  E40283 - USE MSSTAT IN PLACE OF SWSTAT, WHICH IS NOW         *
     F*           REDUNDANT                                           *
     F*  S01389 - Check internal only indicator to determine          *
     F*           msg status (ORIGINAL SAR NO. S89050)                *
     F*  E29588 - POST COLLECTION SWIFT RATIONALISATION AMENDMENTS    *
     F*            o incl. change translation table to change         *
     F*              '#' to 'N', not '?'                              *
     F*  E32342 - TIDY UP FORMAT OF :61: FOR DISPLAY                  *
     F*  E32488 - BRANCH CODE OVERWRITTEN BY CHAIN TO CLOAN           *
     F*  E32485 - SOURCE OF POSTING SHOWS FCHK WHEN NOT A CHEQUE.     *
     F*           '#' IS TRANSLATED TO '?', SHOULD BE 'N'.            *
     F*           BATCH INPUT REFERENCE NOT OUTPUT.                   *
     F*  E32329 - ACCESS LOANS FILE FOR LOAN INFORMATION.             *
     F*           SET UP SUBFIELDS 7 & 8 FOR FIELD 61.                *
     F*  E32328 - THE ACCOUNT ID CARRIES OVER DIGITS FROM PRIOR       *
     F*           ACCOUNT.                                            *
     F*  E32327 - ONLY 8 MOVEMENTS FOR EACH STATEMENT; THERE          *
     F*           SHOULD BE 16.                                       *
     F*  S01310 - RELEASE 10 SWIFT RATIONALISATION CHANGES            *
     F*  RT0086 - DO NOT PRINT 'END OF REPORT' ON AU REPORT.          *
     F*  BHF456 - POSTING NARRATIVE IN FORMATING SUB-FIELDS FOR       *
     F*           BATCH ENTRIES ARE WRONG                             *
     F*  BHF138 - BHF054 AND LN0074 INCOMPLETE IN RESOLVING ERROR     *
     F*  BHF054 - TRIES TO WRITE TO CLOSED FILE IF NO DETAILS         *
     F*  E22406 - TERMINAL IDENTIFICATION REMOVAL.                    *
     F*  LN0074 - WRITE TO CLOSED FILE IF NO DETAILS, + OTHERS        *
     F*  LN0012 - INCORRECT HANDLING OF ALTERNATE NAME & ADDRESS      *
     F*  S17216 - NOT APPLIED AS COB2 CAN DEFINE THESE COMPONENTS     *
     F*           AS MUTUALLY EXCLUSIVE                               *
     F*  E14686 - REWRITE OF COMPRO SUBROUTINE                        *
     F*  S01195 - HOLIDAY AMENDMENT                                   *
     F*  S01194 - NEW STANDING DATA                                   *
     F*  S01117 - SET UP BRANCH CODE FOR THE MULTIBRANCHED PROCESS    *
     F*           ( F & I SPEC. OF F/SMPBR WAS CHANGED BECAUSE THE    *
     F*           EXTERNAL DESCRIPTION APOSTPD IS USED FOR DETAIL     *
     F*           F/SMPBR LAYOUT, AND THE RECORD LENGTH OF APOSTPD    *
     F*           WAS CHANGED TO 268 CHARS BY S01182. IN ORDER FOR    *
     F*           THIS PGM TO COMPILE SUCCESSFUL, THE CHANGE IS       *
     F*           NEEDED. )                                           *
     F*  E15758 - ':' '-' OR ' ' NOT ALLOWED AS FIRST CHARACTER       *
     F*           OF SUBFIELD 9                                       *
     F*  E15502 - '?' OUTPUT NOT '*' DUE TO TRANSLATION TABLE         *
     F*  E15660 - STANDARDISE HEADERS ON REPORT                       *
     F*  E13697 - RETAIL NUMBER IS OUTPUT ONLY ON FIRST PAGE OF       *
     F*           REPORT FOR A RETAIL SWIFT ACCOUNT. OTHER PAGES      *
     F*           SHOW GL ACCOUNT NUMBER.                             *
     F*  E13086 - SWPOS RECORDS INCLUDED IN PGM CALCULATED NO OF REC. *
     F*           BUT NOT INCLUDED IN TRAILER COUNT FOR COMPARISON,   *
     F*           CAUSING FILE CONTROL OUT OF BALANCE.                *
     F*  E13826 - SHOULD OUTPUT '00001' TO THE SEQUENCE NUMBER        *
     F*           IN THE HEADER RATHER THAN '     '. THIS PREVENTS    *
     F*           ANY MTn92 MESSAGES FOR THIS MESSAGE FROM BEING      *
     F*           NAK'ED. (APPLICATION OF E11653)                     *
     F*  E13081 - ILLEGAL CHARACTERS NOT ACCEPTED BY SWIFT ARE        *
     F*           BEING SENT TO THE SWIFT TERMINAL.                   *
     F*  S03220 - FUNDS TRANSFER INCORPORATION                        *
     F*  S01135 - BRANCH CODE SHOULD TAKE INTO CONSIDERATION WHICH    *
     F*           TYPE OF MESSAGE IS CREATED AND OUTPUT EITHER        *
     F*           SWIFT OR TELEX ADDRESS ACCORDINGLY                  *
     F*  S05452 - INCLUSION OF AUTO RECONCILIATIONS.                  *
     F*  S01140 - MSDL STTX AMENDMENT                                 *
     F*                                                               *
     F*****************************************************************
     F*SWACS***IP*AF******64*15AI*****2 DISK                              S01117
     F*WACB***IP*AF******64**3AI****48 DISK                         S01117CSW004
     F***SWACB** IP AF      75  3AI    48 DISK                                         CSW004 CGL029
     FSWACB   IP AF      85  3AI    48 DISK                                                   CGL029
     F*OST****IS*AF*****160**1AI*****1*DISK                               S05452
     F*OST****IS*AF     200  1AI     1 DISK                        S05452 S03220
     F*OST****IS*AF     215  1AI     1 DISK                         S03220S01117
     F**SMPBR*IS*AF     268  1AI     1 DISK                        S01117 S01413
     F***SMPBR***IS*AF     279  1AI     1 DISK                      S01413CRT001
     F***SMPBR   IS AF     316  1AI     1 DISK                      CRT001CEU013
     F***SMPBR***IS AF     329  1AI     1 DISK                     CEU013 CGL007
     F***SMPBR** IS AF     331  1AI     1 DISK                                         CGL007 CGL020
     F***SMPBR** IS AF     589  1AI     1 DISK                                         CGL020 CGL029
     FSMPBR   IS AF     620  1AI     1 DISK                                                   CGL029
     F*ACCNT***IF**F*****400*15AI*****2 DISK                              S01117
     F***ACCBR** IF  F     400 18AI    23 DISK                                         S01117 CGL029
     FACCBR   IF  F     573 24AI    23 DISK                                                   CGL029
     F*ABMS***IF* F      96 12AI     2 DISK                               S01194
     FSDBRCHL1IF  E           K        DISK                               S01194
     FCLOAN   IF  E           K        DISK                               E32329
     F*CLINT***IF**F*****256  7AI     2 DISK                              S01194
     F/COPY WNCPYSRC,GL1300F001
     F*SMSOPF*O***F*****273************DISK
     FSWPOSHH O   F     160            DISK                           U1
     F*WPOSPD*O***F*****160************DISK                           U1  S05452
     F*WPOSPD*O** F     200            DISK                    U1  S05452 S03220
     F*WPOSPD*O** F     215            DISK                    U1  S03220 S01117
     F*WPOSPD*O** F     268            DISK                    U1  S01117 S01413
     F***SWPOSPD O   F     279            DISK                    U1S01413CRT001
     F***SWPOSPD O   F     316            DISK                    U1CRT001CEU013
     F***SWPOSPD*O   F     329            DISK                 U1  CEU013 CGL007
     F***SWPOSPD O   F     331            DISK                           U1            CGL007 CGL020
     F***SWPOSPD O   F     589            DISK                           U1            CGL020 CGL029
     FSWPOSPD O   F     620            DISK                           U1                      CGL029
     F***SWPOSRA O   F     160            DISK                           U1                   CGL029
     FSWPOSRA O   F     170            DISK                           U1                      CGL029
     FSWPOSZZ O   F     160            DISK                           U1
     FSWACNSA O   F      64            DISK
     F*WACNSB*O***F******64            DISK                               CSW004
     F***SWACNSB*O   F      75            DISK                                         CSW004 CGL029
     FSWACNSB O   F      85            DISK                                                   CGL029
     FSWACNSC O   F      64            DISK
     FSWPOOAPDO   E           K        DISK                               CEU013
     FSWPOSAPDIF  E           K        DISK                               CEU013
     FEODPOPPDIF  E           K        DISK                               CEU013
     FMSPOSTL0IF  E           K        DISK                           UC                      CSW022
     F            APOSTPDF                          KRENAMEASWPOSTF                           CSW022
     FMSPOSTL1IF  E           K        DISK                           UC                      CSW022
     F            APOSTPDF                          KRENAMEAEODPOPF                           CSW022
     F*L1300AUO** F     132            PRINTER                            S01117
     FGL1300AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F*GL1300P1O**F*****132*****OF*****PRINTER                            S01117
     FGL1300P1O   F     132            PRINTER      KINFDS SPOOL      UC  S01117
     F*SIXOPF*O***E********************DISK                      A  \     S01310
     FMGOREFPDO   E                    DISK                               S01310
     FMGOMSGPDO   E                    DISK                               S01310
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL1300FFP1                                           S01408
     F*                                                                   S01408
     F********************************************************************
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F* 01            SWACS FILE - HEADER RECORD                         *
     F* 02                       - DETAIL RECORD                         *
     F* 03                       - TRAILER RECORD                        *
     F* 04                       - CATCH-ALL                             *
     F* 05            POSTINGS FILE - HEADER RECORD                      *
     F* 06                          - DETAIL (POSTINGS) RECORD           *
     F* 07                          - DETAIL (RATE CHANGE) RECORD        *
     F* 08                          - TRAILER RECORD                     *
     F* 09                          - CATCH-ALL                          *
     F* 10            ACCOUNTS MASTER FILE - DETAIL RECORD               *
     F* 11                                 - CATCH-ALL                   *
     F* 12            Chain indicator for MSPOSTL0/L1                    *                    CSW022
     F**12*******     TABLE FILE - I.C.D.RECORD 1                        *S01194
     F**12*******                - I.C.D.RECORD 2                        *S01194
     F**17*******                - I.C.D.RECORD 3                        *S01194
     F**12*******                - CURRENCIES RECORD 1                   *S01194
     F**12*******                - BRANCH CODES RECORD                   *S01194
     F**12*******                - HOLIDAY RECORD                        *S01194
     F**13*******                - CATCH-ALL                             *S01194
     F**14*******     CLIENT FILE - CUSTOMER STANDING DATA RECORD        *S01194
     F**15*******                 - CUSTOMER NAME AND ADDRESS RECORD     *S01194
     F**16*******                 - CATCH-ALL                            *S01194
     F*       18      1ST SPOOL FILE OPEN                                 S01117
     F*       19      MULTIBRANCHING INDICATOR
     F*       20      FIRST CYCLE INDICATOR                              *S01117
     F*       22                     -- CLIENT FILE - CUSTOMER STANDING  *
     F*                                               DATA RECORD        *
     F*       24,25                  -- ACCOUNTS MASTER FILE             *
     F*       31      WORK INDICATOR                                     *
     F*       32      CHAIN TO CLIENT FILE FAILS                         *
     F*       33      POSTING RECORD TO BE OUTPUT TO S/SMPOS             *
     F*       34      PREVIOUS S/SWACS RECORD WAS LIVE                   *
     F*       35      ACCOUNT IS RETAIL                                  *
     F*       36      CARRIED FORWARD BALANCE IS NON-NEGATIVE            *
     F*       38      CHEQUE NUMBER IS NON-ZERO                          *
     F*       39      GENERATED ENTRY TYPE IS O                          *
     F*       40      FURTHER PROCESSING REQUIRED FOR THIS SWACS RECORD  *
     F*       41      FREQ = 'A' AND ACCRUALS PROFIT DATE REACHED        *
     F*       42      BALANCE IS POSITIVE                                *
     F*       43      CLEARED BALANCE IS POSITIVE                        *
     F*       44      DEMAND STATEMENT FOR FREQUENCY OTHER THAN Z        *
     F*       45      FREQUENCY IS 'Z'                                   *
     F*       46      SWACN RECORD TO BE DELETED                         *
     F********47******DEMAND*STATEMENT************************************                    CSW022
     F*       47      Today is the normal 'NEXT STATEMENT DATE'          *                    CSW022
     F*               of the SWIFT account                               *                    CSW022
     F*       48      CSID, POS 10-12 BLANK AND POS 9 NOT BLANK           S01140
     F*       49      CSID, POS 12 NOT BLANK                              S01140
     F*       50      SWACS RECORD READ                                  *
     F*       51      REPORTING INDICATOR                                *
     F*       52      SPOSY IS NUMERIC                                   *079167
     F********60**    S/POST RECORD COUNT OUT OF BALANCE                 *LN0074
     F*       60      LF/SMPBR RECORD COUNT OUT OF BALANCE               *LN0074
     F*       61      S/SWACS RECORD COUNT OUT OF BALANCE                *
     F*       62      S/SWACS DELETED RECORDS COUNT IS OUT OF BALANCE    *
     F*       66      POSTINGS NARRATIVE FROM POSTINGS FILE BLANK        *
     F*       69      OUTPUT HEADER AND OPENING BALANCE RECORDS          *
     F*       70      OUTPUT MOVEMENTS RECORD                            *
     F*       71      OUTPUT MOVEMENT RECORD YET TO BE OUTPUT            *
     F*       75      LOAN RECORD FOUND NOT CLOAN FILE                   *E32329
     F*       80      CONDITIONS OUTPUT DURING FIRST CYCLE               *
     F*       81      INTERMEDIATE BALANCE REQUIRED                      *
     F*       82      OUTPUT CLOSING BALANCE                             *
     F*$$     88      RETAIL ACCOUNT WITH NON-ZERO ACCOUNT NO.           *
     F*          U1   POSTINGS FILE IS SWIFT POSTINGS FILE               *
     F*       U7 U8   DATABASE ERROR                                     *
     F*          U8   FILE CONTROLS OUT OF BALANCE                       *
     F*            L1 LEVEL BREAK ON MATCHED FIELDS                      *
     F*            M1 MATCH ON 'KEY' FIELDS OF THE PRIMARY AND SECONDARY *
     F*               FILES                                              *
     F*                                                                  *
     F********************************************************************
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,GL1300E001
     E                    ZAA        15  1               ** SWAMFM SR **
     E/COPY WNCPYSRC,GL1300E002
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E**
     E***********         ZHC        50  3               ZFREQ SR. ARRAY  S01195
     E                    ZFMD   12  12  2               ZFREQ SR. ARRAY
     E***********         HCCY       25  3               HOLIDAY CCYS     S01195
     E***********         ZBRD      200  3 0                              S01194
     E**********          ZBRD      200  3                                           S01194 AR577133
     E                    ZBRD      500  3                                                  AR577133
     E**********          ZCSD      200 12                                                  AR577133
     E                    ZCSD      500 12                                                  AR577133
     E**********          SB8        16  1                          S05452S01310
     E**********          RMV        72  1                                S01310
     E**********          RMVD      108  1                                S01310
     E********************SB7        18  1                          S01310E29588
     E********************SB8        18  1                          S01310E29588
     E                    SB7        16  1                                E29588
     E                    SB8        16  1                                E29588
     E/COPY WNCPYSRC,GL1300E003
     E                    RMV        72  1                                S01310
     E/COPY WNCPYSRC,GL1300E004
     E                    RMVD       83  1                                S01310
     E                    @WRK       50  1                                E32342
     E***********         ZTLX      200 12                        S01135  LN0012
     E**********          ZTLX      200 10                                    S01135 LN0012 AR577133
     E                    ZTLX      500 10                                                  AR577133
     E                    MPNARA     30  1                                E15758
     E                    MPNMIA     14  1                                E15758
     E                    DSR        15  3               Msg types rel    159993
     E*                                                                   S01408
     E/COPY WNCPYSRC,GL1300EEP1                                           S01408
     E*                                                                   S01408
     E*
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     I**
     I*****SWACS*FILE*-*HEADER*RECORD*                                    S01117
     I**   SWACB FILE - HEADER RECORD                                     S01117
     I**
     I*SWACS***NS**01***1*CH**                                            S01117
     ISWACB   NS  01   1 CH                                               S01117
     I                                        1   1 RECI
     I                                        2   2 KEYID
     I                                        1  64 SWACSH
     I                                    P  17  190FSIZE
     I**
     I*****SWACS*FILE*-*DETAIL*RECORD*                                    S01117
     I**   SWACB FILE - DETAIL RECORD                                     S01117
     I**
     I*SWACS***NS**02***1*CD**                                            S01117
     ISWACB   NS  02   1 CD                                               S01117
     I       OR        1 CC
     I       OR        1 C*
     I                                        1   1 RECI
     I                                        1   1 SWRID
     I**********                              2   70SCNUM                                     CGL029
     I**********                              8  10 SCCY                                      CGL029
     I**********                             11  14 SACOD                                     CGL029
     I**********                             15  16 SACSQ                                     CGL029
     I**********                              2  16 SWACKYL1M1                                CGL029
     I**********                              2   70SCNUM L1M4                         CGL029 CSD027
     I                                        2   7 SCNUM L1M4                                CSD027
     I                                        8  10 SCCY  L1M3                                CGL029
     I                                       11  14 QQACOD                                    CGL029
     I                                       15  16 SACSQ L1M1                                CGL029
     I                                    P  17  230CFBAL
     I                                    P  24  260LSDAT
     I                                    P  27  290NSDAT
     I                                       30  390RACN
     I                                       40  40 SFREQ
     I                                       41  420SDAY
     I                                    P  43  450LSNO
     I                                       46  460UPREP
     I                                       47  47 DEST
     I***********                            48  50 BRCA  L1M2      S01117S01194
     I************************               48  50 SBRCA L1M2      S01117S01194
     I**********                             48  50 SBRCA L2M2                         S01117 CGL029
     I                                       48  50 SBRCA L2M5                                CGL029
     I                                       48  50 OSBR                  S01117
     I*                                                                   S01389
     I** Field SINTE was incorporated as part of error fix E32329         S01389
     I** but SINTE is actually used to identify internal MT950            S01389
     I** message. The MT950 function has been incorporated under          S01389
     I** S01389.                                                          S01389
     I*                                                                   S01389
     I                                       51  51 SINTE                 E32329
     I                                    P  58  600DTLC
     I                                       61  61 CHTP
     I                                    P  62  640TNLC
     I                                       65  75 MT94                  CSW004
     I                                       76  85 SACOD L1M2                                CGL029
     I*****                                   1  64 PSWACS                CSW004
     I**********                              1  75 PSWACS                             CSW004 CGL029
     I                                        1  85 PSWACS                                    CGL029
     I**
     I*****SWACS*FILE*-*TRAILER*RECORD*                                   S01117
     I**   SWACB FILE - TRAILER RECORD                                    S01117
     I**
     I*SWACS***NS**03***1*CT*                                             S01117
     ISWACB   NS  03   1 CT                                               S01117
     I                                        1   1 RECI
     I                                    P  17  190SNORE
     I                                    P  20  220SNORD
     I                                    P  59  610DTLC
     I                                    P  62  640TNLC
     I                                        1  64 SWACST
     I**
     I*****SWACS*FILE*-*CATCH-ALL**                                       S01117
     I**   SWACB FILE - CATCH-ALL                                         S01117
     I**
     I*SWACS***NS**04*                                                    S01117
     ISWACB   NS  04                                                      S01117
     I*
     I*
     I*    ACCOUNTS POSTING FILE - HEADER RECORD.
     I*
     I*POST****NS**05***1*CH**                                            S01117
     ISMPBR   NS  05   1 CH                                               S01117
     I                                        1   1 RECI
     I                                    P   2   40FLSZ
     I                                        1 160 POSTH
     I*
     I*
     I*    ACCOUNTS POSTING FILE - ACCOUNT POSTING RECORD.
     I*
     I*POST****NS**06***1*CP*                                             S01117
     ISMPBR   NS  06   1 CP                                               S01117
      *    Fields defined by external data structure APOSTPD.             S03220
     I*                                       1   1 RECI                  S03220
     I*                                       2   70CNUM                  S03220
     I*                                       8  10 CCY                   S03220
     I*                                      11  140ACOD                  S03220
     I*                                      15  160ACSQ                  S03220
     I*    USED TO HOLD CONTENTS OF KEY
     I**********                              2   70CNUM  L1M4                         CGL029 CSD027
     I                                        2   7 CNUM  L1M4                                CSD027
     I                                        8  10 CCY   L1M3                                CGL029
     I                                       15  160ACSQ  L1M1                                CGL029
     I**********                              2  16 PACKY L1M1                                CGL029
     I*                                      23  320ACNO                  S03220
     I*                                   P  33  350PSTD                  S03220
     I*                                   P  36  380VALD                  S03220
     I*                                      39  43 TRAT                  S03220
     I                                       44  480MPN5                  E32329
     I/COPY WNCPYSRC,GL1300I001
     I*                                      44  73 PNAR                  S03220
     I*    NAME CHANGED TO ENSURE NARRATIVE DOESNT COME FROM RATE CHANGE
     I*    RECORD
     I                                       44  73 MPNAR
     I                                       44  73 MPNARA                E15758
     I                                       44  59 MPN16                 S05452
     I                                       60  73 MPNMID                S05452
     I                                       60  73 MPNMIA                E15758
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL1300IIP5                                           S01408
     I*                                                                   S01408
     I*                                   P  74  800PSTA                  S03220
     I*                                      81  810DRCR                  S03220
     I*    NAME CHANGED TO ENSURE INDICATOR DOESNT COME FROM RATE CHANGE
     I*    RECORD
     I                                       81  810MDRCR
     I*                                      82  870ASOC                  S03220
     I*                                      88  950CHQN                  S03220
     I*                                      96 102 SPOS                  S03220
     I                                       96 101 SPOSY                 E32329
     I                                       97 102 SPOS27                S05452
     I                                       97  99 SPOS24                S05452
     I/COPY WNCPYSRC,GL1300I002
     I                                      100 102 SPOS57                S05452
     I/COPY WNCPYSRC,GL1300I007
     I*                                     103 1050BRCD                  S03220
     I***********                           103 105 BRCA  L1M2      S01117S01194
     I********************                  103 105 PBRCA L1M2      S01117S01194
     I**********                            103 105 PBRCA L2M2                         S01117 CGL029
     I                                      103 105 PBRCA L2M5                                CGL029
     I                                      103 105 OSBR                  S01117
     I*                                     106 1060RIND                  S03220
     I*                                   P 107 1080REJC                  S03220
     I*                                     109 111 DPMT                  S03220
     I*                                   P 112 1140RRNM                  S03220
     I*                                     124 124 ATYP                  S03220
     I*                                     128 128 PRIN                  S03220
     I*                                     129 129 GETP                  S03220
     I*                                     130 1300ACUM                  S03220
     I********                                1 160 LOT                   S05452
     I                                      161 176 SWCR                  S05452
     I                                      177 184 DLREF                 S05452
     I                                      177 177 LNCHK                 E32329
     I                                      178 183 LNNO                  E32329
     I                                      185 194 FACO                  S05452
     I                                      185 190 FACO16                S05452
     I                                      185 192 FACO18                S05452
     I**********                            195 2000DBCNUM                             S05452 CSD027
     I                                      195 200 DBCNUM                                    CSD027
     I                                      216 217 OTRF2                 S01310
     I                                      216 220 OTRF5                 S01310
     I                                      590 5990ACOD  L1M2                                CGL029
     I********                                1 160 POSTD                 S05452
     I***********                             1 200 POSTD          S05452 S03220
     I***********                             1 215 POSTD          S03220 S01117
     I***********                             1 268 POSTD          S01117 S01413
     I****************************************1 279 POSTD           S01413CRT001
     I***********                             1 316 POSTD           CRT001CEU013
     I***********                             1 329 POSTD          CEU013 CGL007
     I**********                              1 331 POSTD                              CGL007 CGL020
     I**********                              1 589 POSTD                              CGL020 CGL029
     I                                        1 620 POSTD                                     CGL029
     I*
     I*
     I*    ACCOUNTS POSTING FILE - RATE CHANGE POSTING RECORD.
     I*
     I*POST****NS**07***1*CR*                                             S01117
     ISMPBR   NS  07   1 CR                                               S01117
     I                                        1   1 RECI
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCY
     I**********                             11  140ACOD                                      CGL029
     I                                       11  140ACODQQ                                    CGL029
     I                                       15  160ACSQ
     I                                       23  320ACNO
     I                                    P  33  350PSTD
     I                                    P  36  380VALD
      *    Field defined as numeric on APOSTD but not used anyway.        S03220
     I*                                      39  43 TRAT                  S03220
     I                                       44  480MPN5                  E32329
     I                                       44  73 PNAR
     I                                       96 102 SPOS
     I***********                           103 1050BRCD                  S01194
     I                                      103 105 BRCD                  S01194
     I                                      124 124 ATYP
     I                                      128 128 PRIN
     I                                    P 147 1527INRT
     I                                      153 1540BRT
     I                                       81  810DRCR
     I                                    P 155 1607RTSP
     I                                      161 1700ACOD                                      CGL029
     I**********                              1 160 LOT                                S05452 CGL029
     I                                        1 170 LOT                                       CGL029
     I*
     I/COPY WNCPYSRC,GL1300I009
     I*
     I*    ACCOUNTS POSTING FILE - TRAILER RECORD.
     I*
     I*POST****NS**08***1*CT*                                             S01117
     ISMPBR   NS  08   1 CT                                               S01117
     I                                        1   1 RECI
     I                                        2   60PNORE
     I                                    P   7  140HRWN
     I                                    P  15  160HRDC
     I**
     I**
     I**   ACCOUNTS POSTINGS FILE - CATCH-ALL
     I**
     I*POST****NS**09*                                                    S01117
     ISMPBR   NS  09                                                      S01117
     I*
     I*
     I*    ACCOUNTS MASTER FILE - DETAIL RECORD.
     I*
     I*ACCNT***NS**10***1*CD*                                             S01117
     IACCBR   NS  10   1 CD                                               S01117
     I       OR        1 CC
     I                                        1   1 RECI
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCY
     I**********                             11  140ACOD                                      CGL029
     I                                       11  140ACODQQ                                    CGL029
     I                                       15  160ACSQ
     I***********                            23  250BRCD                  S01194
     I                                       23  25 BRCD                  S01194
     I                                       23  25 BRCA                  S01117
     I                                       23  25 OSBR                  S01117
     I                                       26  26 ATYP
     I                                       27  27 STYP
     I                                       29  29 ACST
     I                                    P  30  320DACO
     I                                    P  33  350DACC
     I                                       36  55 ANAM
     I                                    P  56  630LDBL
     I                                    P  64  710CLBL
     I                                       72  72 STFQ
     I                                       73  740STDY
     I                                    P  75  770LSTD
     I                                    P  78  800NSTD
     I                                    P  81  820LSTP
     I                                    P  83  900CFSB
     I                                    P  91  930LMVD
     I                                    P  94 1010EPLB
     I                                    P 102 1090EPCB
     I                                    P 110 1170YTDB
     I                                    P 110 1170CFCB
     I                                      118 118 GLBT
     I                                    P 138 1400DLIM
     I                                    P 141 1430LRCR
     I                                    P 144 1510RTCB
     I                                    P 152 1590RTLB
     I                                    P 160 1660DITM
     I                                    P 167 1730CITM
     I                                    P 178 1837CDIR
     I                                    P 184 1897CCIR
     I                                    P 178 1837CDIR
     I                                    P 184 1897CCIR
     I                                      190 1990ACNO
     I                                      200 200 RETB
     I                                      201 201 ODSC
     I                                    P 202 2070ODLN
     I                                    P 208 2100ODED
     I                                    P 211 2120DIOD
     I                                      213 2150FACT
     I                                      216 2170FCNO
     I                                      218 219 EFAC
     I                                    P 220 2270HELD
     I                                    P 228 2330MINB
     I                                    P 234 2360LACD
     I                                    P 237 2380LISP
     I                                    P 239 2410RRNM
     I                                      242 2430DRIB
     I                                    P 244 2497DRIS
     I                                    P 250 2520DRCD
     I                                      253 2530DRIC
     I                                      254 254 DRIF
     I                                      255 2560DRDY
     I                                    P 257 2590NDID
     I                                    P 260 2620LDID
     I                                    P 263 2690LDIA
     I                                      270 270 SDAP
     I                                    P 271 2730LPAR
     I                                    P 274 2800DIIE
     I                                    P 281 2880DAIC
     I                                    P 289 2950MADI
     I                                    P 296 3020GADI
     I                                      303 303 DDIS
     I                                    P 304 3060DDIA
     I                                    P 307 3090OLDR
     I                                      310 3110OLDB
     I                                    P 312 3177OLDS
     I                                      318 3190CRIB
     I                                    P 320 3257CRIS
     I                                    P 326 3280CRCD
     I                                      329 3290CRIC
     I                                      330 330 CRIF
     I                                      331 3320CRDY
     I                                    P 333 3350NCID
     I                                    P 336 3380LCID
     I                                    P 339 3450LCIA
     I                                      346 346 SCAP
     I                                    P 347 3490LPAP
     I                                    P 350 3560CIIE
     I                                    P 357 3640CAIC
     I                                    P 365 3710MACI
     I                                    P 372 3780GACI
     I                                      379 379 CDIS
     I                                    P 380 3820DCIA
     I                                    P 383 3850OLCR
     I                                      386 3870OLCB
     I                                    P 388 3937OLCS
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      554 5630ACOD                                      CGL029
     I**
     I**
     I**   ACCOUNTS MASTER FILE - CATCH-ALL
     I**
     I*ACCNT***NS**11****                                                 S01117
     IACCBR   NS  11                                                      S01117
     I*
     I***********                                                         S01194
     I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
     I***********                                                         S01194
     I*TABMS***NS**12   2 C0   3 C1  12 C1                                S01194
     I*******AND*     13 C0                                               S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            12  130RCDE                  S01194
     I***********                            14  66 TITL                  S01194
     I***********                            67  67 DATF                  S01194
     I***********                            68  700DFBR                  S01194
     I***********                            74  74 MODI1                 S01194
     I***********                            75  75 MODI2                 S01194
     I***********                            76  76 MODI3                 S01194
     I***********                         P  77  790RUND                  S01194
     I***********                            80  86 RUNA                  S01194
     I***********                            87  870SFLG                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I***********                                                         S01194
     I***********                                                         S01194
     I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
     I***********                                                         S01194
     I*TABMS***NS**12   1 CD   2 C0   3 C1                                S01194
     I*******AND*     12 C1  13 C1                                        S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            12  130RCDE                  S01194
     I***********                            14  16 BCCY                  S01194
     I***********                            17  19 BCYL                  S01194
     I***********                            20  22 HOCY                  S01194
     I***********                            23  280HEAD                  S01194
     I***********                         P  29  310APDA                  S01194
     I***********                            35  35 APFQ                  S01194
     I***********                         P  36  380LOGS                  S01194
     I***********                            39  40 CUZR                  S01194
     I***********                         P  41  430DNWD                  S01194
     I***********                            44  460BVLP                  S01194
     I***********                            47  49 LOCY                  S01194
     I***********                            50  510FDAY                  S01194
     I***********                            52  52 ACLD                  S01194
     I***********                            53  53 MBIN                  S01194
     I***********                            86  86 ISAV                  S01194
     I***********                         P  87  890LLOG                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I***********                                                         S01194
     I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 5.         E14686S01194
     I***********                                                   E14686S01194
     I*ABMS***NS*      1 CD   2 C0   3 C1                           E14686S01194
     I*******AND*     12 C4  13 C0                                  E14686S01194
     I***********                            78  780PRSW            E14686S01194
     I***********                            81  810PRTX            E14686S01194
     I***********                                                         S01194
     I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
     I***********                                                         S01194
     I*TABMS***NS  12   1 CD   2 C2   3 C0                                S01194
     I*******AND*     13 C1                                               S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            10  12 CCY                   S01194
     I***********                            13  130SREC                  S01194
     I***********                            14  27 CCNM                  S01194
     I***********                         P  28  348SPOT                  S01194
     I***********                            35  37 CCYS                  S01194
     I***********                            38  380CDP                   S01194
     I***********                            39  390TNOT                  S01194
     I***********                            40  40 DCCY                  S01194
     I***********                            41  44 SRC1                  S01194
     I***********                            45  48 SRC2                  S01194
     I***********                            49  520TACC                  S01194
     I***********                            53  560TEQV                  S01194
     I***********                            57  600SWQV                  S01194
     I***********                            61  640TAC4                  S01194
     I***********                            65  680TAC5                  S01194
     I***********                            69  69 HIND                  S01194
     I***********                         P  70  768PART                  S01194
     I***********                            77  780SSNO                  S01194
     I***********                         P  79  858ERLC                  S01194
     I***********                            86  860MDIN                  S01194
     I***********                            87  870MDIA                  S01194
     I***********                            88  880MDIB                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I***********                                                         S01194
     I***********                                                         S01194
     I*****TABLE*FILE - BRANCH CODES RECORD.                              S01194
     I***********                                                         S01194
     I*TABMS***NS  12   1 CD   2 C1   3 C0                                S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            11  130BRCD                  S01194
     I***********                            11  130BBRCD                 S01194
     I***********                            14  43 BRNM                  S01194
     I***********                            44  490BICN                  S01194
     I***********                            50  51 LOCC                  S01194
     I***********                            52  53 CMPY                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I*****TABLE*FILE - HOLIDAY RECORD.                                   S01194
     I********E-EXCLUDE, I-INCLUDE.                                       S01194
     I***********                                                         S01194
     I*ABMS***NS* 12   1 CD   2 C2   3 C2                                 S01194
     I*******AND*     14 CE                                               S01194
     I*******OR**      1 CD   2 C2   3 C2                                 S01194
     I*******AND*     14 CI                                               S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                             8  120HOL                   S01194
     I***********                            13  130SREC                  S01194
     I***********                            14  14 INEX                  S01194
     I***********                            15  89 HCCY                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I***********                                                   S05452S01194
     I*****TABLE*FILE - COUNTERPARTY NOSTROS RECORD.                S05452S01194
     I***********                                                   S05452S01194
     I********NS* 17   1 CD   2 C7   3 C1                           S05452S01194
     I***********                             1   1 RECI            S05452S01194
     I***********                             6  13 CPSH            S05452S01194
     I***********                            49  68 CPTN            S05452S01194
     I***********                                                         S01194
     I***********                                                         S01194
     I*****TABLE*FILE - CATCH-ALL                                         S01194
     I*TABMS***NS  13                                                     S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                                                         S01194
     I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 3.               S01194
     I***********                                                         S01194
     I***********                                                         S01194
     I***********                                                         S01194
     I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
     I***********                                                         S01194
     I*CLINT***NS**14   1 CD   8 CA                                       S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   70CNUM                  S01194
     I***********                             8   8 RCDT                  S01194
     I***********                             9  28 CRNM                  S01194
     I***********                            29  38 CTWN                  S01194
     I***********                            39  48 CSNM                  S01194
     I***********                            49  56 CASK                  S01194
     I***********                            57  68 TELX                  S01194
     I***********                            69  80 CSID                  S01194
     I***********                            81  82 ACOC                  S01194
     I***********                            83  83 CBSI                  S01194
     I***********                            84  85 CCTZ                  S01194
     I***********                            86  87 CLOC                  S01194
     I***********                            88  930CPAR                  S01194
     I********                               94  960BRCD                  S01117
     I***********                            94  960XBRCD           S01117S01194
     I***********                            97  980LINS                  S01194
     I***********                            99 1010LIND                  S01194
     I***********                         P 102 1040DASU                  S01194
     I***********                         P 105 1070CDIC                  S01194
     I***********                         P 108 1100DADE                  S01194
     I***********                           111 111 CMIN                  S01194
     I***********                           112 112 CTYP                  S01194
     I***********                           113 124 TELF                  S01194
     I***********                           125 133 CHID                  S01194
     I***********                           134 136 CHAB                  S01194
     I***********                           161 161 SWTXC           S01140S01194
     I***********                           162 173 STTX            S01140S01194
     I***********                           195 195 GSFM            S01140S01194
     I***********                         P 250 2520LCD                   S01194
     I***********                           253 253 CHTP                  S01194
     I***********                         P 254 2560TNLU                  S01194
     I***********                                                         S01194
     I***********                                                         S01194
     I*****CLIENT*FILE - CUSTOMER NAME AND ADDRESS RECORD.                S01194
     I***********                                                         S01194
     I*CLINT***NS**15   1 CD   8 CB                                       S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   70CNUM                  S01194
     I***********                             8   8 RCDT                  S01194
     I***********                             9  43 CNA1                  S01194
     I***********                            44  78 CNA2                  S01194
     I***********                            79 113 CNA3                  S01194
     I***********                           114 148 CNA4                  S01194
     I***********                           240 249 CTWN                  S01194
     I***********                         P 250 2520LCD                   S01194
     I***********                           253 253 CHTP                  S01194
     I***********                         P 254 2560TNLU                  S01194
     I***********                                                         S01194
     I***********                                                         S01194
     I*****CLIENT*FILE CATCH-ALL                                          S01194
     I***********                                                         S01194
     I*CLINT***NS**16                                                     S01194
     I*
     I/COPY WNCPYSRC,GLH00075
     ICLOANCLF                                                            E32488
     I              BRCA                            LBRCA                 E32488
     I              SCCY                            LSCCY                 136665
     ICLOANCKF                                                            130177
     I              NLRA                            K#NLRA                130177
      *                                                                   130177
     IASWPOSTF                                                                                CSW022
     I              RECI                            RECIL0                                    CSW022
     IAEODPOPF                                                                                CSW022
     I              RECI                            RECIL1                                    CSW022
      *                                                                                       CSW022
     I/COPY WNCPYSRC,GL1300I005
     I**
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*****DATA*STRUCTURE*TO*HOLD*INFORMATION*USED*IN*S/MSMSO*MOVEMENTS   S01310
     I*****RECORD******************************************************   S01310
     I**
     I**********  DS                                                      S01310
     I**********                              1  72 RMV                   S01310
     I**********                              1   4 FT61                  S01310
     I**********                              5  10 MVDAT                 S01310
     I**********                             11  14 MPDAT                 S01310
     I**********                             15  16 DSDRCR                S01310
     I**********                             17  17 MCCY                  S01310
     I**********                             18  32 MAMNT                 S01310
     I**********                             33  36 MCODE                 S01310
     I********                               37  52 MPREF                 S05452
     I**********                             38  43 SPOSX           BHF456S01310
     I**********                             37  52 SB7             S05452S01310
     I**********                             53  54 SLASHS          S05452S01310
     I**********                             55  70 SB8             S05452S01310
     I**********                             71  71 CR                    S01310
     I**********                             72  72 LF                    S01310
     I**********                             73 108 REST61                S01310
     I********                               73 102 MPNAR                 S05452
     I**********                             73 106 SB9             S05452S01310
     I**********                            107 107 CR1                   S01310
     I**********                            108 108 LF1                   S01310
     I**********                              1 108 MFIELD                S01310
      *                                                                   S01310
      *    Field :28: data structure                                      S01310
      *                                                                   S01310
     I            DS                                                      S01310
     I                                        1   50LSST                  S01310
     I                                        6   6 SLASH                 S01310
     I                                        7   80LINO                  S01310
     I                                        7   90LINO6                 CSW096
     I                                        1   8 STNO                  S01310
     I                                        1   9 STNO6                 CSW096
     I                                        7  110WNO11                                     CSW201
     I                                        1  11 WSTR11                                    CSW201
      *                                                                   S01310
      *    Field :60: data structure                                      S01310
      *                                                                   S01310
     I            DS                                                      S01310
     I                                        1   1 DBCD                  S01310
     I                                        2   7 RUND60                S01310
     I                                        8  10 SWCY60                S01310
     I/COPY WNCPYSRC,GL1300I012
     I                                       11  25 CFBLED                S01310
     I                                        1  25 OPBAL                 S01310
     I/COPY WNCPYSRC,GL1300I013
      *                                                                   S01310
      *    Field :61: data structure                                      S01310
      *                                                                   S01310
     I            DS                                                      S01310
     I/COPY WNCPYSRC,GL1300I014
     I                                        1  72 RMV                   S01310
     I/COPY WNCPYSRC,GL1300I015
     I                                        1   6 MVDAT                 S01310
     I                                        7  10 MPDAT                 S01310
     I                                       11  12 DSDRCR                S01310
     I                                       13  13 MCCY                  S01310
     I/COPY WNCPYSRC,GL1300I016
     I                                       14  28 MAMNT                 S01310
     I                                       29  32 MCODE                 S01310
     I                                       33  48 SB7                   E29588
     I                                       49  50 SLASHS                E29588
     I                                       51  66 SB8                   E29588
     I                                       73 108 REST61                E32329
     I                                       73 106 SB9                   E29588
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL1300IIP2                                           S01408
     I*                                                                   S01408
     I*************                          33  50 SB7             S01310E29588
     I*************                          51  52 SLASHS          S01310E29588
     I*************                          53  70 SB8             S01310E29588
     I*************                          73  83 REST61          S01310E29588
     I*************                          73  82 SB9             S01310E29588
     I*                                                                   CEU013
     I*    Subfield 9 data structure                                      CEU013
     I*                                                                   CEU013
     I            DS                                                      CEU013
     I                                        1  25 @SBF9                 CEU013
     I                                        1   6 @OCMT                 CEU013
     I                                        7   9 @OCCY                 CEU013
     I                                       10  24 @OAMT                 CEU013
     I                                       25  25 @SLSH                 CEU013
      *                                                                   S01310
      *    Field :62A: data structure                                     S01310
      *                                                                   S01310
     I            DS                                                      S01310
     I                                        1   1 DBCR62                S01310
     I                                        2   7 RUND62                S01310
     I                                        8  10 SWCY62                S01310
     I/COPY WNCPYSRC,GL1300I017
     I                                       11  25 MBAL62                S01310
     I                                        1  25 CLBAL                 S01310
     I/COPY WNCPYSRC,GL1300I018
      *                                                                   S01310
      *    Field :64: data structure                                      S01310
      *                                                                   S01310
     I            DS                                                      S01310
     I                                        1   1 DBCR64                S01310
     I                                        2   7 RUND64                S01310
     I                                        8  10 SWCY64                S01310
     I/COPY WNCPYSRC,GL1300I019
     I                                       11  25 MBAL64                S01310
     I                                        1  25 CLRBL                 S01310
     I/COPY WNCPYSRC,GL1300I006
     I            DS
     I**
     I* MESSAGE REFERNECE FILE KEY
     I**********                              1  15 TNRF                  S01310
     I**********                              1   6 RUNDAT                S01310
     I**********                              7  100SCOUNT                S01310
     I                                        1  16 TRNO                  S01310
     I                                        1  15 MTRN                                      223548
     I                                        1   2 MODI                  S01310
     I                                        3   80RUNDAT                S01310
     I                                        9  120SCOUNT                S01310
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL1300IIP3                                           S01408
     I*                                                                   S01408
     I**
     I* ACCOUNT CODE KEY                                                  S01117
     I            DS                                                      S01117
     I**********                              1  18 ACCKEY                             S01117 CGL029
     I                                        1  24 ACCKEY                                    CGL029
     I***********                             1   3 BRCA            S01117S01194
     I                                        1   3 SBRCA                 S01194
     I**********                              4   90SCNUM                              S01117 CSD027
     I                                        4   9 SCNUM                                     CSD027
     I                                       10  12 SCCY                  S01117
     I**********                             13  16 SACOD                              S01117 CGL029
     I**********                             17  18 SACSQ                              S01117 CGL029
     I                                       13  22 SACOD                                     CGL029
     I                                       23  24 SACSQ                                     CGL029
     I/COPY WNCPYSRC,GL1300I008
     I****                                                                S01140
     I******  LOCAL DATA AREA FOR CSID ON S/CLINT,A                       S01140
     I****                                                                S01140
     I***            DS                                                   S01140
     I***                                       69  80 CSID               S01140
     I***                                       69  76 WCSID8             S01140
     I***                                       77  77 WCSID9             S01140
     I***                                       78  80 WCSID3             S01140
     I***                                       80  80 WCSID2             S01140
     IMSSTT       DS                            256                       E40283
     I                                       58  58 GLSNT                 E40283
     I*                                                                   E40283
     I*SWSTAT****UDS                             256                      E40283
     I************                           62  62 GLSNT                 E40283
     I**
     I**   FILE CONTROL DATA AREA FOR MESSAGE TOTALS
     IMSFCTL     UDS                            256
     I                                    P   1   30MT950
     I                                    P  94  960TOTMSG
     I**
     I**   LOCAL DATA AREA
     ILDA        UDS                            256
     I**
     I**
     I***********                           134 138 DBFILE                S01194
     I***********                           139 167 DBKEY                 S01194
     I***********                           168 175 DBPGM                 S01194
     I***********                           176 1770DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I                                      134 183 DBERR                 LN0074
      *                                                                                       248625
     I            DS                                                                          248625
     I                                        1  50 #MFLD                                     248625
     I                                        1   1 MFLD1                                     248625
     I*                                                                   S01310
     I**   Multiple occurence data structure for message                  S01310
     I*                                                                   S01310
     I/COPY WNCPYSRC,GL1300I010
     IMULT        DS                         12                           S01310
     I/COPY WNCPYSRC,GL1300I011
     I                                        1   5 @MTAG                 S01310
     I                                        6  55 @MFLD                 S01310
     I                                        1  55 @ALL                  S01310
     I                                       56  57 @CTRC                 S01310
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  90 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 367 3680LINE                  S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  90 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01194
     I**   EXTERNAL DTAARA FOR RUN-DATE                                   S01194
     I**                                                                  S01194
     IRUNDT       DS                                                      S01194
     I                                        1   7 RUNA                  S01194
     I                                    P   8  100RUND                  S01194
     I                                       11  11 SSF                   S01194
     I                                       12  12 DATF                  S01194
     I                                       13  13 MBIN                  S01194
      *                                                                                       CGL029
     ISWACKY      DS                                                                          CGL029
     I**********                              1   60WECNUM                             CGL029 CSD027
     I                                        1   6 WECNUM                                    CSD027
     I                                        7   9 WECCY                                     CGL029
     I                                       10  19 WEACOD                                    CGL029
     I                                       20  21 WEACSQ                                    CGL029
     I**
      ** Use external description APOSTPD for detail POST layout.         S03220
     IPOSTD     E DSAPOSTPD                                               S03220
      *
     IWLTDS     E DSSDWLTOPD                                                                  CSD015
      ** DS For Watch List Transaction Details File                                           CSD015
      *                                                                                       CSD015
     IPSTRNG      DS                           9999                                           CSD015
      *                                                                                       CSD015
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300IIP1                                           S01408
     C*                                                                   S01408
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I**   CUSTOMER DETAILS                                               S01194
     I*                                                                   S01194
     I*DALTN****E*DSSDALTNPD                                      S01194  LN0012
     I*    ALTERNATE NAME & ADDRESS                                       S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*    BANK DETAILS                                                   S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I*    TRADING DETAILS                                                S01194
     I              BLSWPY                          PRSW
     I              BLTXPY                          PRTX
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I*    CURRENCY CODE                                                  S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I*    BRANCH CODE DETAILS                                            S01194
     I              QQDFAC                          QQDFAX                                    CGL029
     I*                                                                   S01194
     ISDCNST    E DSSDCNSTPD                                              S01194
     I*    COUNTERPARTY NOSTROS DETAILS                                   S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I**    GENERAL LEDGER DETAILS                                        S01194
     I              QQACCD                          QQACCX                                    CGL029
     I**
     ISDMGME    E DSSDMGMEPD                                              S01310
      **  Data structure for MESSAGE MANAGEMENT file                      S01310
     I*                                                                   CSW004
     ISCSARD    E DSSCSARDPD                                              CSW004
     I* SAR FILE DETAILS                                                  CSW004
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL1300IIP4                                           S01408
     I*                                                                   S01408
      *                                                                   S01310
     I**
     I*
     ISDWLCC    E DSSDWLCCPD                                                                  222385
      ** Watch list checking details                                                          222385
      *                                                                                       222385
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
      *                                                                   065886
     IW1DATA      DS                            256                       065886
      *                                                                   065886
     I                                        1  15 W1PREF                065886
      *                                                                   065886
     I                                       16  19 W1SBF6                065886
      *                                                                   065886
     I                                       21  36 W1SBF7                065886
      *                                                                   065886
     I                                       37  52 W1SBF8                065886
      *                                                                   065886
     I                                       53  86 W1SBF9                065886
      *                                                                   065886
     I                                       87  88 W1DRCR                065886
      *                                                                   065886
     I                                       89  90 W1CQSQ                065886
     I/COPY WNCPYSRC,GL1300I004
      *                                                                   065886
      /EJECT                                                              065886
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I/COPY OFCPYSRCZ,CGL136_001                                                              CGL136
     I/COPY WNCPYSRC,GL1300I003
     I**
     C**
     C**
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C***80*******         SETOF                     80                   S01117
     C**
      *                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP16                                           S01408
      *                                                                   S01408
     C**   FIRST CYCLE PROCESSING
     C   20                GOTO ENDFC
     C                     MOVEACPY@      BIS@   80
     C*                                                                   S01117
     C* IND.80 NOT SET ON,REL.10 HAS CHANGED GL1300P1 TO USER CONTROL     S01117
     C*                                                                   S01117
     C*********************SETON                     2080                 S01117
     C                     SETON                     20                   S01117
     C**
     C*                                                                   S01117
     C* IF MULTIBRANCHING SETON INDICATOR.19                              S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     19                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**   SET UP FIELDS TO HANDLE DATABASE ERRORS
     C                     MOVE ' '       BLAN16 16
     C                     MOVE BLAN16    DBKEY
     C                     MOVELBLAN16    DBKEY
     C                     MOVE *BLANKS   DBERR                           LN0074
     C                     MOVE '     '   DBFILE
     C                     MOVEL'GL1300'  DBPGM
     C                     Z-ADD0         DBASE
0205 C**                                                                  S01194
     C**  ACCESS DTAARA 'RUNDAT' TO OBTAIN RUN DATE, DATE FORMAT          S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C                     IN   RUNDT                                     S01194
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON. S01194
     C**
     C*****ACCESS I.C.D.RECORD 1 TO OBTAIN RUN DATE, DATE FORMAT, BANKS   S01194
     C*****TITLE, DEFAULT BRANCH CODE VIA ZSYSTM                          S01194
     C***********          EXSR ZSYSTM                                    S01194
     C***99******          SETON                     U7U8LR               S01194
     C***99******          Z-ADD1         DBASE            * DB ERROR 01 *S01194
     C***99******          MOVE 'TABMS'   DBFILE                          S01194
     C***99******          MOVELZTABKY    DBKEY                           S01194
     C***99******          GOTO END                                       S01194
     C**                                                                  S01194
     C**  ACCESS BANK DETAILS TO OBTAIN BANK TITLE, DEFAULT BRANCH CODE   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C***********          PARM '*DBERR ' @RTCD   7                S01194 LN0074
     C                     PARM '*BLANKS' @RTCD   7                       LN0074
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   LN0074
     C           @RTCD     IFNE *BLANK                                    LN0074
     C                     SETON                     U7U8LR               LN0074
     C                     MOVEL'SDBANKPD'DBFILE                          LN0074
     C                     MOVEL@OPTN     DBKEY            ***************LN0074
     C                     MOVEL'001'     DBASE            * DBERROR 001 *LN0074
     C                     EXSR *PSSR                      ***************LN0074
     C                     GOTO END                                       LN0074
     C                     END                                            LN0074
      *                                                                   CSW096
      **  Check if SWIFT Changes 1996 (CSW096) is installed               CSW096
      *                                                                   CSW096
     C                     CALL 'SWIFT96'                                 CSW096
     C                     PARM *BLANKS   @RTCD   7                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFEQ 'CSW096'                                  CSW096
     C                     MOVE 'Y'       CSW096  1                       CSW096
     C                     ELSE                                           CSW096
     C                     MOVE 'N'       CSW096                          CSW096
     C                     ENDIF                                          CSW096
      *                                                                                       CSW201
      ** Check if SWIFT Changes 2001 (CSW201) is installed                                    CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM *BLANKS   PRTCD   7                                           CSW201
      *                                                                                       CSW201
     C           PRTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
     C/COPY WNCPYSRC,GLH00076
      *                                                                                       CSW201
      ** Check if CSD015 enhancement is on                                                    CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       CSD015  1                                           CSD015
     C                     MOVEL'N'       W1EWLC                                              222385
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSD015'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSD015                                              CSD015
      *                                                                                       222385
      ** Access AOWLCCR0 to check if function code MESSGENT is available                      222385
      *                                                                                       222385
     C                     CALL 'AOWLCCR0'                                                    222385
     C                     PARM *BLANKS   @RTCD                                               222385
     C                     PARM '*KEY'    @OPTN                                               222385
     C                     PARM 'MESSGENT'PFUNC   8                                           222385
     C           SDWLCC    PARM SDWLCC    DSFDY                                               222385
      *                                                                                       222385
     C           @RTCD     IFNE *BLANKS                                                       222385
     C           @RTCD     ANDNE'*NRF'                                                        222385
     C                     MOVEL'SDWLCCPD'DBFILE                                              222385
     C                     MOVELPFUNC     DBKEY                                               222385
     C                     Z-ADD32        DBASE                                               222385
     C                     EXSR *PSSR                                                         222385
     C                     ENDIF                                                              222385
      *                                                                                       222385
     C                     ELSE                                                               CSD015
     C           @RTCD     IFNE '*NRF   '                                                     CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     MOVE *BLANKS   DBKEY                                               CSD015
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD015
     C                     MOVEL'*VERIFY' DBKEY                                               CSD015
     C                     MOVEL'101'     DBASE                                               CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     GOTO END                                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if CSW025 enhancement is on                                                    CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       CSW025  1                                           CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSW025'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSW025                                              CSD015
     C                     ELSE                                                               CSD015
     C           @RTCD     IFNE '*NRF   '                                                     CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     MOVE *BLANKS   DBKEY                                               CSD015
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD015
     C                     MOVEL'*VERIFY' DBKEY                                               CSD015
     C                     MOVEL'102'     DBASE                                               CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     GOTO END                                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C**                                                                  LN0074
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP24                                           S01408
     C*                                                                   S01408
      *                                                                   E32329
      ** Key list for CHAIN to CLOAN                                      E32329
     C           CLNKEY    KLIST                                          E32329
     C**********           KFLD           CLNNO   60                                   E32329 CLE148
     C                     KFLD           CLNNO   6                                           CLE148
     C                     KFLD           CLNCD   1                       E32329
      ** Key list for CHAIN to EODPOPPD/SWPOSAPD                          CEU013
     C           REFKEY    KLIST                                          CEU013
     C                     KFLD           XRFI                            CEU013
     C                     KFLD           XRFN                            CEU013
      *                                                                                       CSW022
      ** Define Key list for MSPOSTL0/MSPOSTL1.                                               CSW022
      *                                                                                       CSW022
     C           KEY1      KLIST                                                              CSW022
     C                     KFLD           WKBRCA  3                                           CSW022
     C**********           KFLD           WKCNUM  60                                   CSW022 CSD027
     C                     KFLD           WKCNUM  6                                           CSD027
     C                     KFLD           WKCCY   3                                           CSW022
     C**********           KFLD           WKACOD  40                                   CSW022 CGL029
     C                     KFLD           WKACOD 100                                          CGL029
     C                     KFLD           WKACSQ  20                                          CSW022
     C**
      *                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP17                                           S01408
      *                                                                   S01408
     C**
     C**   SET UP BLANK FIELDS AND OTHER STANDARD FIELDS
     C                     MOVE ' '       BLAN52 52
     C                     MOVE ' '       BLA108108
     C                     MOVEL' '       FIELD1108
     C                     MOVEL' '       FIELD2108
     C                     MOVE ' '       BLNK15 15
     C                     MOVE ' '       BLNK14 14
     C                     MOVE '  '      BLANK2  2
     C**
     C                     Z-ADD0         ZERO5   50
     C                     Z-ADD0         NUM950  50
     C***********          Z-ADD0         MSGNO   50                      S01310
     C**
     C**********           MOVE ':61:'    FT61                            S01310
     C**********           MOVE ':'       OP      2                       S01310
     C**
     C                     MOVE RUND      ZDAYNO
     C                     EXSR ZDATES
     C**********           MOVE ZDATE     RUNDAT  6                       S01310
     C                     MOVE ZDATE     RUNDAT  60                      S01310
     C**
     C**   SET UP FIELDS WHICH ARE CONSTANT IN MESSAGE REFERENCE FILE
     C**********           MOVE 'S'       MSMI                            S01310
     C**********           MOVE 'C'       MSTS                            S01310
     C**********           MOVE RUNA      LADT                            S01310
     C**********           MOVE '950'     MTPY                            S01310
     C**********           MOVE '02'      MSGP                            S01310
     C**********           MOVE RUNA      MGDT                            S01310
     C**********           Z-ADD0         ISQN                            S01310
     C                     MOVE 'GL'      MODI                            S01310
     C                     MOVEL'SWIFT'   NWRK                            S01310
     C                     MOVE '950'     MTPY                            S01310
     C                     MOVE 'N'       MPRY                            S01310
     C                     MOVE '1'       MGSG                            S01310
     C/COPY WNCPYSRC,GL1300C004
     C                     MOVE 'CRTD'    MGST                            S01310
     C/COPY WNCPYSRC,GL1300C005
     C                     TIME           MGTM                            S01310
     C                     MOVE RUNA      LADT                            S01310
     C                     TIME           LATM                            S01310
     C                     MOVE ZDATE     MGDE                            S01310
     C                     MOVE *BLANKS   DELC                            S01310
     C/COPY WNCPYSRC,GL1300C002
      *                                                                   113352
      ** Set-up Message Generation  Century flag                          113352
      *                                                                   113352
     C                     MOVELMGDE      YY      20                      113352
     C           YY        IFLT 72                                        113352
     C                     MOVE '2'       CIND                            113352
     C                     ELSE                                           113352
     C                     MOVE '1'       CIND                            113352
     C                     ENDIF                                          113352
      *                                                                   S01310
      **  Access SDMGMEPD for drop SWIFT msg. no. days                    S01310
      *                                                                   S01310
     C                     CALL 'AOMGMER0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*FIRST ' @OPTN   7                       S01310
     C           SDMGME    PARM SDMGME    DSFDY                           S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '016'     DBASE            * * * * * * * *S01310
     C                     MOVEL'FIRST'   DBKEY            *  DBERR 016  *S01310
     C                     MOVEL'SDMGMEPD'DBFILE           * * * * * * * *S01310
     C                     EXSR *PSSR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Convert history retention date to YYMMDD                        S01310
      *                                                                   S01310
     C           BJRDNB    ADD  ENDSMN    ZDAYNO                          S01310
     C                     EXSR ZDATES                                    S01310
     C                     MOVE ZDATE     HRDT                            S01310
     C**
     C*****USE*DEALING*BRANCH*CODE TO CHAIN TO TABLE FILE TO OBTAIN       LN0012
     C*****BRANCH*INTERNAL*CUSTOMER*NUMBER (BICN)                         LN0012
     C**
     C***
     C***  SET UP ARRAYS OF BRANCH INTERNAL CUSTOMER AGAINST
     C*                     SWIFT ADDRESS FROM LF/CLINT
     C*
     C***********          MOVE '        'ZTABKY                          S01194
     C***********          MOVEL'10'      ZTABKY 12                       S01194
     C***********ZTABKY    SETLLTABMS                                     S01194
     C                     MOVE *BLANKS   BRCHKY  3                       S01194
     C           BRCHKY    SETLLSDBRCHL1                                  S01194
     C                     Z-ADD1         X       30     99 SETOF 99
     C*     READ FIRST BRANCH CODES RECORD
     C***********          READ TABMS                  9999               S01194
     C                     READ SDBRCHL1               9999               S01194
     C*     DATABASE ERROR IF RECORD NOT FOUND
     C           *IN99     IFEQ '1'
     C                     SETON                     U7U8LR***************
     C                     Z-ADD2         DBASE            * DB ERROR 02 *
     C***********          MOVE 'TABMS'   DBFILE           ***************S01194
     C                     MOVE 'SDBRCHL1'DBFILE           ***************S01194
     C***********          MOVELZTABKY    DBKEY                           S01194
     C                     MOVELBRCHKY    DBKEY                           S01194
     C                     ELSE
     C*
     C***********RECT      DOWEQ10                         B001           S01194
     C******GET*SWIFT ADDRESS OF BRANCH INTERNAL CUSTOMER FROM LF/CLINT   S01194
     C***********RECI      IFEQ 'D'                        B002           S01194
     C           *IN99     DOWEQ'0'                        B001           S01194
     C*     GET SWIFT ADDRESS OF BRANCH INTERNAL CUSTOMER FROM SDCUSTL1   S01194
     C*     IF LIVE BRANCH CODE RECORD FOUND GET SWIFT ADDRESS
     C***********          MOVELBICN      CLKEY   7                       S01194
     C***********          MOVE 'A'       CLKEY                           S01194
     C***********CLKEY     CHAINCLINT                99                   S01194
     C                     MOVE *BLANKS   @KEY1                           S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM A8BICN    @KEY1  10                       S01194
     C                     PARM           @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C**                                                                  S01194
     C****ACCESS*ALTERNATE*NAME*& ADDRESS TO OBTAIN TELEX ID IF   S01194  LN0012
     C****CUSTOMER*NO.*FOUND*IN CUSTOMER DETAILS                  S01194  LN0012
     C********** @RTCD     IFEQ *BLANKS                           S01194  LN0012
     C********** BBDTDL    ANDEQ*ZEROS                            S01194  LN0012
     C**********           MOVE A8BICN    @AENB                   S01194  LN0012
     C**********           EXSR ACALTN                            S01194  LN0012
     C********** @RTCD     IFNE *BLANKS                           S01194  LN0012
     C**********           SETON                     99           S01194  LN0012
     C**********           GOTO LEND                              S01194  LN0012
     C**********           END                                    S01194  LN0012
     C**********           END                                    S01194  LN0012
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                    B003           S01194
     C           BBDTDL    IFEQ 0                                         S01194
     C************IN99     IFEQ '0'                        B003           S01194
     C***********RECI      IFEQ 'D'                        B004           S01194
     C*     IF LIVE RECORD FOUND, ADD ELEMENTS TO THE ARRAYS
     C***********          MOVE CSID      ZCSD,X     FROM LF/CLINT        S01194
     C***********          MOVE TELX      ZTLX,X     FROM LF/CLINT  S01135S01194
     C***********          MOVE BBRCD     ZBRD,X     FROM LF/TABMS        S01194
     C*********************MOVE BBCSID    ZCSD,X                   S01194 E22406
     C                     MOVE A8BTID    ZCSD,X                          E22406
     C***********          MOVE BCTXNB    ZTLX,X                  S01194  LN0012
     C                     MOVE BBTXA1    ZTLX,X                  S01194  LN0012
     C                     MOVE A8BRCD    ZBRD,X                          S01194
     C                     ADD  1         X
     C                     ELSE                            X004           S01194
     C******RECORD IS FOUND BUT IT IS NOT LIVE (RECI NOT 'D')             S01194
     C*     RECORD IS FOUND BUT IT IS NOT LIVE (DATE DELETED = 0)         S01194
     C                     SETON                     99
     C                     SETON                     U7U8LR***************
     C***********          Z-ADD3         DBASE            * DB ERROR 03 *S01194
     C***********          MOVE 'CLINT'   DBFILE           ***************S01194
     C***********          MOVELCLKEY     DBKEY                           S01194
     C                     MOVEL'003'     DBASE            * DBERR 003 *  S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVELA8BICN    DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                             E004
     C                     ELSE                            X003
     C******RECORD NOT FOUND ON LF/CLINT                                  S01194
     C*     RECORD NOT FOUND ON SDCUSTL1                                  S01194
     C                     SETON                     99                   S01194
     C                     SETON                     U7U8LR***************
     C***********          Z-ADD3         DBASE            * DB ERROR 03 *S01194
     C***********          MOVE 'CLINT'   DBFILE           ***************S01194
     C***********          MOVELCLKEY     DBKEY                           S01194
     C                     MOVEL'003'     DBASE            * DBERR 003 *  S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVELA8BICN    DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                             E003
     C*                                                                   S01194
     C           LEND      TAG                                            S01194
     C***********          END                             E002           S01194
     C*****READ*NEXT RECORD FROM BRANCH CODES TABLE                       S01194
     C*****EXIT*FROM PROCESSING IF ERROR OCCURED IN SETTING UP ARRAY      S01194
     C***********    OR ERROR IN READING FROM LF/TABMS (*IN99 ON)         S01194
     C**   READ NEXT RECORD FROM BRANCH CODE FILE. EXIT FROM              S01194
     C**   PROCESSING IF ERROR OCCURRED IN SETTING UP ARRAY OR            S01194
     C**   ERROR IN READING FROM BRANCH CODE OR CUSTOMER FILE             S01194
     C**N99***** X         COMP 200                  99  99                                 AR577133
     C  N99      X         COMP 500                  99  99                                 AR577133
     C**N99******          READ TABMS                  9999               S01194
     C  N99                READ SDBRCHL1               9999               S01194
     C  N99                END                             E001
     C*
     C                     END
     C*
     C   U7 U8             GOTO END
     C*
     C**   SET UP SPECIAL MESSAGE CHARACTERS
     C                     BITOF'01234567'SOH     1
     C**********           BITOF'01234567'ETX     1                       S01310
     C                     BITOF'01234567'CR      1
     C                     BITOF'01234567'LF      1
     C**********           BITON'7'       SOH              START MESSAGE  S01310
     C**********           BITON'67'      ETX              END MESSAGE    S01310
     C                     BITON'457'     CR               CARRIAGE RETURN
     C                     BITON'257'     LF               LINE FEED
     C**
     C**********           MOVE CR        CR1     1                       S01310
     C**********           MOVE LF        LF1     1                       S01310
     C*                                                                   S01310
     C                     MOVELCR        CRLF    2                       S01310
     C                     MOVE LF        CRLF                            S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CCP7                                           S01408
     C*                                                                   S01408
     C**
     C*   SET UP STATEMENT COUNTS
     C*
     C                     Z-ADD0         SCOUNT
     C/COPY WNCPYSRC,GL1300C066
      *                                                                                       CSW201
      ** If CSW201 is installed, bypass checking of CSW096. Set                               CSW201
      ** WNO11 to 1.                                                                          CSW201
      *                                                                                       CSW201
     C           CSW201    IFNE 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           CSW096    IFEQ 'Y'                                       CSW096
     C                     Z-ADD1         LINO6                           CSW096
     C                     ELSE                                           CSW096
     C                     Z-ADD1         LINO
     C                     ENDIF                                          CSW096
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C                     Z-ADD1         WNO11                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C**   INITIALISE FIELDS USED IN HASH TOTALLING
     C                     Z-ADD0         OSWPOS  50
     C                     Z-ADD0         SWATOT  50
     C                     Z-ADD0         OSWACN  50
     C                     Z-ADD0         SWADEL  50
     C                     Z-ADD0         SWACLO  50
     C                     Z-ADD0         POSTOT  50
     C                     Z-ADD0         DSWACN  50
     C**
     C**   INCREMENT TOTAL RECORDS ON S/SWACS BY 1 AND OUTPUT HEADER TO
     C**   S/SWACN
     C           SWATOT    ADD  1         SWATOT
     C           OSWACN    ADD  1         OSWACN
     C**
     C*****CHAIN TO I.C.D.RECORD 2 FOR ACCRUALS PROFIT DATE AND DATE OF   S01194
     C*****NEXT WORKING DAY                                               S01194
     C***********          MOVEL'01'      ZTABKY 12                       S01194
     C***********          MOVE ' 11'     ZTABKY                          S01194
     C***********          EXSR TABCHN                                    S01194
     C***99******          SETON                     U7U8LR               S01194
     C***99******          Z-ADD4         DBASE            * DB ERROR 04 *S01194
     C***99******          MOVE 'TABMS'   DBFILE                          S01194
     C***99******          MOVELZTABKY    DBKEY                           S01194
     C***99******          GOTO END                                       S01194
     C**   OBTAIN ACCRUALS PROFIT DATE VIA GENERAL LEDGER DETAILS,        S01194
     C**   DATE OF NEXT WORKING DATE VIA BANK DETAILS                     S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C************         PARM '*DBERR ' @RTCD   7                S01194 LN0074
     C                     PARM *BLANKS   @RTCD   7                       LN0074
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   LN0074
     C           @RTCD     IFNE *BLANK                                    LN0074
     C                     SETON                     U7U8LR               LN0074
     C                     MOVEL'SDGELRPD'DBFILE                          LN0074
     C                     MOVEL@OPTN     DBKEY            ***************LN0074
     C                     MOVEL'004'     DBASE            * DBERROR 004 *LN0074
     C                     EXSR *PSSR                      ***************LN0074
     C                     GOTO END                                       LN0074
     C                     END                                            LN0074
     C**                                                                  LN0074
     C**
     C****CHECK*IF*GL*MESSAGES*ALREADY*SENT*TODAY*IN*EOD***               S01117
     C****SEE*SDC0502*SWC005GL*AND*SDC0702*FOR*INDICATOR*PROCESSING       S01117
     C***********GLSNT     IFEQ 'Y'                                       S01117
     C***********          EXCPTGLSNTH                                    S01117
     C***********                                                         S01117
     C***********          END                                            S01117
     C**********
     C****ACCESS ICDR5 ON LF/TABMS                                  E14386S01194
     C**********           MOVE '      40'ZTABKY                    E14686S01194
     C**********           EXSR TABCHN                              E14686S01194
     C***99*****           SETON                     U7U8LR         E14686S01194
     C***99*****           Z-ADD15        DBASE            * DB E5 *E14686S01194
     C***99*****           MOVE 'TABMS'   DBFILE                    E14686S01194
     C***99*****           MOVELZTABKY    DBKEY                     E14686S01194
     C***99*****           GOTO END                                 E14686S01194
     C**  ACCESS TRADING DETAILS TO OBTAIN SWIFT AND TELEX PRIORITY       S01194
     C                     CALL 'AOTRADR0'                                S01194
     C**************       PARM '*DBERR ' @RTCD   7                S01194 LN0074
     C                     PARM *BLANKS   @RTCD   7                       LN0074
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C*                                                                   LN0074
     C           @RTCD     IFNE *BLANK                                    LN0074
     C                     SETON                     U7U8LR               LN0074
     C                     MOVEL'SDTRADPD'DBFILE                          LN0074
     C                     MOVEL@OPTN     DBKEY            ***************LN0074
     C                     MOVEL'015'     DBASE            * DBERROR 015 *LN0074
     C                     EXSR *PSSR                      ***************LN0074
     C                     GOTO END                                       LN0074
     C                     END                                            LN0074
     C*                                                                   CSW004
     C** CHECK if MT940 SWIFT messages feature is switched on             CSW004
     C*                                                                   CSW004
     C                     MOVE ' '       MT94FG  1                       CSW004
     C                     CALL 'AOSARDR0'                                CSW004
     C                     PARM *BLANKS   @RTCD   7                       CSW004
     C                     PARM '*VERIFY' @OPTN   7                       CSW004
     C                     PARM 'CSW004'  @SARD   6                       CSW004
     C           SCSARD    PARM SCSARD    DSFDY                           CSW004
     C*                                                                   CSW004
     C           @RTCD     IFEQ *BLANKS                                   CSW004
     C                     MOVE 'Y'       MT94FG                          CSW004
     C                     ELSE                                           CSW004
     C           @RTCD     IFNE '*NRF   '                                 CSW004
     C                     SETON                     U7U8LR               CSW004
     C                     MOVE *BLANKS   DBKEY                           CSW004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CSW004
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 18 *   CSW004
     C                     MOVEL'018'     DBASE            ************   CSW004
     C                     EXSR *PSSR                                     CSW004
     C                     GOTO END                                       CSW004
     C                     END                                            CSW004
     C                     END                                            CSW004
     C/COPY WNCPYSRC,GL1300C084
     C*                                                                   CEU013
     C** CHECK if EMU Account Postings Narrative switched on              CEU013
     C*                                                                   CEU013
     C                     MOVE ' '       CEU013  1                       CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM *BLANKS   @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  @SARD   6                       CEU013
     C           SCSARD    PARM SCSARD    DSFDY                           CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANKS                                   CEU013
     C                     MOVE 'Y'       CEU013                          CEU013
     C                     ELSE                                           CEU013
     C           @RTCD     IFNE '*NRF   '                                 CEU013
     C                     SETON                     U7U8LR               CEU013
     C                     MOVE *BLANKS   DBKEY                           CEU013
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU013
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 19 *   CEU013
     C                     MOVEL'019'     DBASE            ************   CEU013
     C                     EXSR *PSSR                                     CEU013
     C                     GOTO END                                       CEU013
     C                     END                                            CEU013
     C                     END                                            CEU013
     C*                                                                   CSW020
     C** Check if SWIFT decimal place feature is switched on              CSW020
     C*                                                                   CSW020
     C                     MOVE ' '       CSW020  1                       CSW020
     C                     CALL 'AOSARDR0'                                CSW020
     C                     PARM *BLANKS   @RTCD   7                       CSW020
     C                     PARM '*VERIFY' @OPTN   7                       CSW020
     C                     PARM 'CSW020'  @SARD   6                       CSW020
     C           SCSARD    PARM SCSARD    DSFDY                           CSW020
     C*                                                                   CSW020
     C           @RTCD     IFEQ *BLANKS                                   CSW020
     C                     MOVE 'Y'       CSW020                          CSW020
     C                     ELSE                                           CSW020
     C           @RTCD     IFNE '*NRF   '                                 CSW020
     C                     SETON                     U7U8LR               CSW020
     C                     MOVE *BLANKS   DBKEY                           CSW020
     C                     MOVEL'SCSARDPD'DBFILE           ************   CSW020
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 25 *   CSW020
     C                     MOVEL'025'     DBASE            ************   CSW020
     C                     EXSR *PSSR                                     CSW020
     C                     GOTO END                                       CSW020
     C                     ENDIF                                          CSW020
     C                     ENDIF                                          CSW020
      *                                                                                       CSW022
      ** Check if switchable feature CSW021 is switched on.                                   CSW022
      *                                                                                       CSW022
     C                     CALL 'AOSARDR0'                                                    CSW022
     C                     PARM *BLANKS   @RTCD                                               CSW022
     C                     PARM '*VERIFY' @OPTN                                               CSW022
     C                     PARM 'CSW021'  @SARD                                               CSW022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW022
      *                                                                                       CSW022
     C           @RTCD     IFNE *BLANK                                                        CSW022
     C           @RTCD     ANDNE'*NRF   '                                                     CSW022
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW022
     C                     MOVEL'30'      DBASE                                               CSW022
     C                     MOVEL'CSW021'  DBKEY                                               CSW022
     C                     MOVE *ON       *INU7                                               CSW022
     C                     MOVE *ON       *INU8                                               CSW022
     C                     MOVE *ON       *INLR                                               CSW022
     C                     EXSR *PSSR                                                         CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
     C           @RTCD     IFEQ *BLANKS                                                       CSW022
     C                     MOVE 'Y'       CSW021  1                                           CSW022
     C                     ELSE                                                               CSW022
     C                     MOVE 'N'       CSW021                                              CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
      ** Check if switchable feature CSW022 is switched on.                                   CSW022
      *                                                                                       CSW022
     C                     CALL 'AOSARDR0'                                                    CSW022
     C                     PARM *BLANKS   @RTCD                                               CSW022
     C                     PARM '*VERIFY' @OPTN                                               CSW022
     C                     PARM 'CSW022'  @SARD                                               CSW022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW022
      *                                                                                       CSW022
     C           @RTCD     IFNE *BLANK                                                        CSW022
     C           @RTCD     ANDNE'*NRF   '                                                     CSW022
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW022
     C                     MOVEL'31'      DBASE                                               CSW022
     C                     MOVEL'CSW022'  DBKEY                                               CSW022
     C                     MOVE *ON       *INU7                                               CSW022
     C                     MOVE *ON       *INU8                                               CSW022
     C                     MOVE *ON       *INLR                                               CSW022
     C                     EXSR *PSSR                                                         CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
     C           @RTCD     IFEQ *BLANKS                                                       CSW022
     C                     MOVE 'Y'       CSW022  1                                           CSW022
     C                     ELSE                                                               CSW022
     C                     MOVE 'N'       CSW022                                              CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
      ** Open MSPOSTL0/L1 if CSW021 or CSW022 is installed.                                   CSW022
      *                                                                                       CSW022
     C           CSW021    IFEQ 'Y'                                                           CSW022
     C           CSW022    OREQ 'Y'                                                           CSW022
     C                     OPEN MSPOSTL0                                                      CSW022
     C                     OPEN MSPOSTL1                                                      CSW022
     C                     ENDIF                                                              CSW022
     C/COPY OFCPYSRCZ,CGL136_002                                                              CGL136
     C*
     C** END OF FIRST CYCLE PROCESSING                                    S01408
     C/COPY WNCPYSRC,GL1300CEIP                                           S01408
     C**                                                                  LN0074
     C           ENDFC     TAG                             ** ENDFC TAG **
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C**
     C**   RESET APPROPRIATE INDICATORS
     C                     SETOF                       3334
     C                     SETOF                     43
     C  N81                SETOF                     3642
     C                     SETOF                     46
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP19                                           S01408
     C*                                                                   S01408
      *                                                                   S01310
      **  Clear multiple occurrence data structure                        S01310
     C                     Z-ADD1         M       30                      S01310
     C           M         OCUR MULT                                      S01310
     C           M         DOWLE200                                       S01310
     C           @ALL      ANDNE*BLANKS                                   S01310
     C                     MOVE *BLANKS   @ALL                            S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     Z-ADD1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C**                                                                  E13697
     C**  AS *IN88 IS USED TO CONTROL THE OUTPUT OF RETAIL A/C NO. IN     E13697
     C**  TAG 25 OF MT950 AND THE PRINTING OF TAG 25 IN REPORT GL1300,    E13697
     C**  *IN88 SHOULD ONLY BE SET OFF WHEN A SWIFT A/C RECORD IS BEING   E13697
     C**  PROCESSED. THUS, ENSURES TAG 25 IS OUTPUT CONSISTENTLY WITH     E13697
     C**  RETAIL A/C NO. IF THE A/C IS A RETAIL A/C.                      E13697
     C******************** SETOF                     88                   E13697
     C   02                SETOF                     88                   E13697
     C**
     C**
     C**   TEST RECORD TYPE AND JUMP TO APPROPRIATE PIECE OF CODE
     C   02                GOTO SWACD
     C   06
     COR 07                GOTO QPOSTD
     C   03                GOTO SWACT
     C*    ACCUMULATE TRAILER RECORD COUNT FIELD OF SWPOS & EODPO         E13086
     C   08                ADD  PNORE     TPNORE  50                      E13086
     C  N05                GOTO END
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C**
     C*****S/POST*HEADER RECORD PROCESSING                                LN0074
     C**   LF/SMPBR HEADER RECORD PROCESSING                              LN0074
     C**
     C**   IF U1 IS ON A RECORD IS OUTPUT TO S/SWPOS SO INCREMENT
     C**   APPROPRIATE COUNT
     C   U1      OSWPOS    ADD  1         OSWPOS
     C           POSTOT    ADD  1         POSTOT
     C**
     C                     GOTO END
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C**
     C           SWACD     TAG                             ** SWACD TAG **
     C**
     C**   S/SWACS DETAIL RECORD PROCESSING
     C**
     C**   INITIAL PROCESSING
     C                     SETOF                     404435
     C                     SETOF                     47
     C                     SETON                     50    SWACS RCD READ
     C/COPY WNCPYSRC,GL1300C015
     C*                                                                   S01117
     C**  MULTIBRANCH TEST FOR OUTPUT                                     S01117
     C*                                                                   S01117
     C********** *INL1     IFEQ '1'                                       S01117
     C           *INL2     IFEQ '1'                                       S01117
     C*
     C**EXCPT*'END*OF*REPORT*FOR*BRANCH'*AND*CHECK*FOR*OVERFLOW     S01117S01310
     C*                                                                   S01117
     C***********LINE      IFGE 60                                  S01117S01310
     C************IN18     ANDEQ'1'                                 BHF054S01310
     C***********          EXCPTHEAD                                S01117S01310
     C***********          END                                      S01117S01310
     C***18******          EXCPTEND1                                S01117S01310
     C*                                                                   S01117
     C**********           CLOSEGL1300P1                            S01117S01310
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM SBRCA     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'100'     DBASE            * DBERR 100 *  S01117
     C***********          MOVEL'SDBANKPD'DBFILE                  S01117  LN0074
     C                     MOVEL'SDBRCHPD'DBFILE                          LN0074
     C                     MOVEL@OPTN     DBKEY                           S01117
     C                     MOVEL@OPTN     DBOPTN  7                       S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C************         OPEN GL1300P1                            S01117S01310
     C*                                                                   S01117
     C*   PUT PAGE COUNT TO ZERO                                          S01117
     C*                                                                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C*  FIRST SPOOL FILE OPENED                                          S01117
     C*                                                                   S01117
     C***********          SETON                       18           S01117S01310
     C*                                                                   S01117
     C**  ACCESS DTAARA 'MSSTAT' TO OBTAIN 'MESSAGES ALREADY SENT' FLAG   E40283
     C           *NAMVAR   DEFN MSSTAT    MSSTT                           E40283
     C                     IN   MSSTT                                     E40283
     C*                                                                   S01117
     C**  CHECK IF GL MESSAGES ALREADY SENT TODAY IN EOD                  S01117
     C**  SEE SDC0502 SWC005GL AND SDC0702 FOR INDICATOR PROCESSING       S01117
     C*                                                                   S01310
     C           GLSNT     IFEQ 'Y'                                       S01117
     C                     OPEN GL1300P1                                  S01310
     C                     EXCPTHEAD                                      S01310
     C                     EXCPTGLSNTH                                    S01117
     C                     EXCPTEND2                                S01117S01310
     C                     CLOSEGL1300P1                                  S01310
     C**                                                                  S01117
     C***********          END                                      S01117S01310
     C*                                                                   S01117
     C****EXCPT*HEADER*FOR*NEW*SPOOL*FILE********************       S01117S01310
     C*                                                                   S01117
     C************IN18     IFEQ '1'                                 BHF054S01310
     C************         EXCPTHEAD                                S01117S01310
     C************         END                                      BHF054S01310
     C*                                                                   S01117
     C**                                                                  S01117
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C************         PARM *BLANKS   SEQ     5                 S01117LN0074
     C                     PARM           SEQ     5                       LN0074
     C                     PARM           SBRCA                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01310
     C                     END                                            S01310
     C**                                                                  S01310
     C                     END                                            S01310
     C**                                                                  S01117
     C***********SWATOT****ADD**1*****    SWATOT                    E41393101687
     C           SWRID     COMP 'C'                      31
     C   31      SWACLO    ADD  1         SWACLO
     C           SWRID     COMP '*'                      31
     C   31      SWADEL    ADD  1         SWADEL
     C**
     C** ADD TO TOTAL RECORDS IF NOT DELETED                              101867
     C           SWRID     IFNE '*'                                       101867
     C           SWATOT    ADD  1         SWATOT                          101867
     C                     ENDIF                                          101867
     C/COPY WNCPYSRC,GL1300C067
     C**                                                                  101867
     C**   TEST FOR FURTHER PROCESSING
     C  N31      SWRID     COMP 'C'                      31
     C   31NU1             SETON                     40
     C  N40NU1 MR          SETON                     40
     C  N40 U1             EXSR STEST
     C**                                                                  101867
     C** IF RECORD IS DELETED, NO FURTHER PROCESSING IS REQUIRED.         101867
     C           *IN31     IFEQ *ON                                       101867
     C                     MOVE *OFF      *IN40                           101867
     C                     GOTO END                                       101867
     C                     ENDIF                                          101867
     C*                                                                   064107
     C** Do not process deleted SWACSSB records                           064107
     C*                                                                   064107
     C           SWRID     IFEQ '*'                                       064107
     C                     MOVE *ON       *IN31                           064107
     C                     MOVE *OFF      *IN40                           064107
     C                     END                                            064107
      *                                                                   CSW004
      ** If MT940 SWIFT messages feature is switched OFF                  CSW004
      ** AND 'MT940 Destination' on PF/SWACSSB is not = blank,            CSW004
      ** no further processing for this SWIFT account                     CSW004
     C           MT94FG    IFEQ ' '                                       CSW004
     C           MT94      ANDNE*BLANKS                                   CSW004
     C                     MOVE *OFF      *IN40                           CSW004
     C                     END                                            CSW004
      *                                                                                       CSW022
      ** If statement is not a Demand Statement and *IN40 is still on,                        CSW022
      ** do the processing below.                                                             CSW022
      *                                                                                       CSW022
     C           DEST      IFNE 'Y'                                                           CSW022
     C           *IN40     ANDEQ*ON                                                           CSW022
      *                                                                                       CSW022
      ** If CSW021 or CSW022 is installed, check if SWIFT account                             CSW022
      ** has movements.                                                                       CSW022
      *                                                                                       CSW022
     C           CSW021    IFEQ 'Y'                                                           CSW022
     C           CSW022    OREQ 'Y'                                                           CSW022
      *                                                                                       CSW022
     C                     MOVE SBRCA     WKBRCA                                              CSW022
     C                     MOVE SCNUM     WKCNUM                                              CSW022
     C                     MOVE SCCY      WKCCY                                               CSW022
     C                     MOVE SACOD     WKACOD                                              CSW022
     C                     MOVE SACSQ     WKACSQ                                              CSW022
      *                                                                                       CSW022
     C           KEY1      CHAINMSPOSTL0             12                                       CSW022
      *                                                                                       CSW022
     C           *IN12     IFEQ *ON                                                           CSW022
     C           KEY1      CHAINMSPOSTL1             12                                       CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
      ** If CSW021 is installed and carried-forward balance of account                        CSW022
      ** is zero and it has no movements, suppress the generation of                          CSW022
      ** SWIFT Statement messages.                                                            CSW022
      *                                                                                       CSW022
     C           CSW021    IFEQ 'Y'                                                           CSW022
     C           CFBAL     ANDEQ0                                                             CSW022
     C           *IN12     ANDEQ*ON                                                           CSW022
     C                     MOVE *OFF      *IN40                                               CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
      ** If CSW022 is installed and the account has no movements,                             CSW022
      ** suppress the generation of SWIFT Statement messages.                                 CSW022
      *                                                                                       CSW022
     C           CSW022    IFEQ 'Y'                                                           CSW022
     C           *IN12     ANDEQ*ON                                                           CSW022
     C                     MOVE *OFF      *IN40                                               CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
     C                     ENDIF                                                              CSW022
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP20                                           S01408
     C*                                                                   S01408
     C**
     C**   INCREMENT STATEMENT NUMBER
     C   40      LSNO      ADD  1         LSNO
     C/COPY WNCPYSRC,GL1300C033
     C**
     C**   IF IND.40 IS NOT ON, NO FURTHER PROCESSING IS REQUIRED FOR
     C**   THIS S/SWACS RECORD
     C  N40                GOTO END
     C**
     C**   FURTHER PROCESSING REQUIRED
     C**
     C*****CHAIN*TO CLIENT FILE USING CUSTOMER NUMBER TO OBTAIN THE       S01194
     C*****CLIENTS FULL NAME AND ADDRESS AND SWIFT ADDRESS                S01194
     C***********          MOVELSCNUM     CLINKY  7                       S01194
     C***********          MOVE 'A'       CLINKY                          S01194
     C***********CLINKY    CHAINCLINT                32                   S01194
     C**N32******RECI      COMP 'D'                  3232                 S01194
     C***32******          SETON                     U7U8LR               S01194
     C***32******          Z-ADD5         DBASE            * DB ERROR 05 *S01194
     C***32******          MOVE 'CLINT'   DBFILE                          S01194
     C***32******          MOVELCLINKY    DBKEY                           S01194
     C***32******          GOTO END                                       S01194
     C**                                                                  S01194
     C**  ACCESS CUSTOMER DETAIL FILE WITH CUSTOMER NUMBER TO OBTAIN      S01194
     C**  THE CLIENT'S FULL NAME AND ADDRESS AND SWIFT ADDRESS            S01194
     C                     MOVE *BLANKS   @KEY1                           S01194
     C                     MOVELSCNUM     @KEY1                           S01194
     C*
     C**                                                                  S01408
     C/COPY WNCPYSRC,GL1300CMT1                                           S01408
     C**                                                                  S01408
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C                     PARM           @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           BBDTDL    ORNE *ZEROS                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'005'     DBASE            * DBERR 005 *  S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVELSCNUM     DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*
     C** CHANGE OF CUSTOMER PROCESSING                                    S01408
     C/COPY WNCPYSRC,GL1300CPLT                                           S01408
     C**                                                                  LN0074
     C*                                                                   S01140
     C***  IF GENERATE SWIFT FORMAT MESSAGES INDICATOR IS NOT 'Y'         S01140
     C*    GO TO END                                                      S01140
     C*                                                                   S01140
     C***********GSFM      IFNE 'Y'                                 S01140S01194
     C***********BBGSFM    IFNE 'Y'                                 S01194S01310
     C***********          GOTO END                                 S01140S01310
     C***********          END                                      S01140S01310
     C*                                                                   S01140
     C********PROCESSING TO DETERMINE WHETHER THE MESSAGE DESTINATI S01140E14686
     C********IS SWIFT, MIDAS/TELEX OR STTX FOLLOWS                 S01140E14686
     C********                                                      S01140E14686
     C********THIS ALSO DETERMINES WHETHER THE MESSAGE REFERENCE FILS01140E14686
     C********ROUTE CODE SHOULD BE 'S', 'T', OR 'X'.                S01140E14686
     C********                                                      S01140E14686
     C********MESSAGE      |    |    |    |    |    |    |          S01140E14686
     C********ROUTE CODE   |  - |  T | ' '|  - |  - |  - |          S01140E14686
     C********--------------------------------------------          S01140E14686
     C********SWIFT ADDRESS|  Y |  N |  N |  N |  Y |  Y |          S01140E14686
     C********TELEX ADDRESS|  N |  Y |  Y |  N |  Y |  N |          S01140E14686
     C********STTX ADDRESS |  N |  N |  N |  Y |  N |  Y |          S01140E14686
     C********--------------------------------------------          S01140E14686
     C********GENERATE     |    |    |    |    |    |    |          S01140E14686
     C********SWIFT FORMAT |  X |  X |    |  X |  X |  X |          S01140E14686
     C********DESTN = CSID |  X |    |    |    |  X |  X |          S01140E14686
     C********DESTN = TELX       X                           S01140E14686
     C********DESTN = STTX |    |    |    |  X |    |    |          S01140E14686
     C********PRINTED TELEX|    |    |  X |    |    |    |          S01140E14686
     C********--------------------------------------------          S01140E14686
     C********MESSAGE      |    |    |    |    |    |    |          S01140E14686
     C********ROUTE CODE   |  S |  T |    |  X |  S |  S |          S01140E14686
     C***********                                                   S01140E14686
     C******     CSID      IFEQ *BLANKS                             S01140S01135
     C******     STTX      ANDEQ*BLANKS                             S01140S01135
     C******     SWTXC     ANDEQ'T'                                 S01140S01135
     C*                                                                   S01135
     C*      TELEX  ID AND DESTINATION                                    S01135
     C*                                                                   S01135
     C***********SWTXC     IFEQ 'T'                           S01140S01135E14686
     C***********          MOVE TELX      WCSID  12                 S01140E14686
     C***********          MOVE 'T'       SWTX    1                 S01140E14686
     C***********          END                                      S01140E14686
     C*                                                                   S01140
     C******     CSID      IFEQ *BLANKS                             S01140S01135
     C******     STTX      ANDNE*BLANKS                             S01140S01135
     C*                                                                   S01135
     C*      STTX  ID AND DESTINATION  IF NO SWIFT ID                     S01135
     C*                                                                   S01135
     C***********SWTXC     IFEQ ' '                           S01140S01135E14686
     C***********CSID      IFEQ *BLANKS                             S01135E14686
     C***********          MOVE STTX      WCSID                     S01140E14686
     C***********          MOVE 'X'       SWTX                      S01140E14686
     C***********          ELSE                            SWIFT ID S01135E14686
     C***********          MOVE CSID      WCSID               S01140S01135E14686
     C***********          MOVE 'S'       SWTX                S01140S01135E14686
     C***********          END                                      S01135E14686
     C***********          END                                      S01140E14686
     C***********                                                   S01140E14686
     C*******           CSID      IFNE *BLANKS                      S01140S01135
     C*                                                                   S01135
     C*      SWIFT ID  AND DESTINATION                                    S01135
     C*                                                                   S01135
     C***********SWTXC     IFEQ 'S'                                 S01135E14686
     C***********          MOVE CSID      WCSID                     S01140E14686
     C***********          MOVE 'S'       SWTX                      S01140E14686
     C***********          END                                      S01140E14686
     C*                                                                   E14686
     C**  PROCESSING TO DETERMINE WHETHER THE MESSAGE                     E14686
     C**  DESTINATION IS SWIFT, TELEX OR STTX                             E14686
     C**                                                                  E14686
     C**                 (1)  (2)  (3)  (4)  (5)  (6)  (7)                E14686
     C**  -------------------------------------------------               E14686
     C**  SWIFT ADDRESS|  Y |  N |  N |  Y |  Y |  Y |  Y |               E14686
     C**  TELEX ADDRESS|  N |  Y |  N |  Y |  Y |  N |  N |               E14686
     C**  STTX ADDRESS |  N |  N |  Y |  N |  N |  Y |  Y |               E14686
     C**  ICD PRIORITY |    |    |    | TX | SW | TX | SW |               E14686
     C**  -------------------------------------------------               E14686
     C**  DESTN = CSID |  X |    |    |    |  X |    |  X |               E14686
     C**  DESTN = TELX |    |  X |    |  X |    |    |    |               E14686
     C**  DESTN = STTX |    |    |  X |    |    |  X |    |               E14686
     C**  -------------------------------------------------               E14686
     C**  MESSAGE ROUTE|    |    |    |    |    |    |    |               E14686
     C**  CODE (SWTX)  |  S |  T |  X |  T |  S |  X |  S |               E14686
     C*                                                                   E14686
     C**  (1)                                                             E14686
     C***********CSID      IFNE *BLANKS                         E14686    S01194
     C           BBCSID    IFNE *BLANKS                                   S01194
     C***********TELX      ANDEQ*BLANKS                         E14686    S01194
     C********** BCTXNB    ANDEQ*BLANKS                           S01194  LN0012
     C           BBTXA1    ANDEQ*BLANKS                           S01194  LN0012
     C***********STTX      ANDEQ*BLANKS                         E14686    S01194
     C           BBSTAD    ANDEQ*BLANKS                                   S01194
     C**  (5)                                                             E14686
     C***********CSID      ORNE *BLANKS                         E14686    S01194
     C***********BBCSID    ANDNE*BLANKS                             S01194S01117
     C           BBCSID    ORNE *BLANKS                                   S01117
     C***********TELX      ANDNE*BLANKS                         E14686    S01194
     C********** BCTXNB    ANDNE*BLANKS                           S01194  LN0012
     C           BBTXA1    ANDNE*BLANKS                           S01194  LN0012
     C***********STTX      ANDEQ*BLANKS                         E14686    S01194
     C           BBSTAD    ANDEQ*BLANKS                                   S01194
     C           PRSW      ANDLTPRTX                                      E14686
     C**  (7)                                                             E14686
     C***********CSID      ORNE *BLANKS                         E14686    S01194
     C***********BBCSID    ANDEQ*BLANKS                             S01194S01117
     C           BBCSID    ORNE *BLANKS                                   S01117
     C***********TELX      ANDEQ*BLANKS                         E14686    S01194
     C********** BCTXNB    ANDEQ*BLANKS                           S01194  LN0012
     C           BBTXA1    ANDEQ*BLANKS                           S01194  LN0012
     C***********STTX      ANDNE*BLANKS                         E14686    S01194
     C           BBSTAD    ANDNE*BLANKS                                   S01194
     C           PRSW      ANDLTPRTX                                      E14686
     C*                                                                   E14686
     C**********           MOVE CSID      WCSID  12             E14686    S01194
     C                     MOVE BBCSID    WCSID  12                       S01194
     C                     MOVE 'S'       SWTX    1                       E14686
     C                     END                                            E14686
     C**  (2)                                                             E14686
     C***********CSID      IFEQ *BLANKS                         E14686    S01194
     C           BBCSID    IFEQ *BLANKS                                   S01194
     C***********TELX      ANDNE*BLANKS                         E14686    S01194
     C********** BCTXNB    ANDNE*BLANKS                           S01194  LN0012
     C           BBTXA1    ANDNE*BLANKS                           S01194  LN0012
     C***********STTX      ANDEQ*BLANKS                         E14686    S01194
     C           BBSTAD    ANDEQ*BLANKS                                   S01194
     C**  (4)                                                             E14686
     C***********CSID      ORNE *BLANKS                         E14686    S01194
     C           BBCSID    ORNE *BLANKS                                   S01194
     C***********TELX      ANDNE*BLANKS                         E14686    S01194
     C********** BCTXNB    ANDNE*BLANKS                           S01194  LN0012
     C           BBTXA1    ANDNE*BLANKS                           S01194  LN0012
     C***********STTX      ANDEQ*BLANKS                         E14686    S01194
     C           BBSTAD    ANDEQ*BLANKS                                   S01194
     C           PRTX      ANDLTPRSW                                      E14686
     C*                                                                   E14686
     C**********           MOVE TELX      WCSID                 E14686    S01194
     C**********           MOVE BCTXNB    WCSID                   S01194  LN0012
     C                     MOVE BBTXA1    WCSID                   S01194  LN0012
     C                     MOVE 'T'       SWTX                            E14686
     C                     END                                            E14686
     C**  (3)                                                             E14686
     C***********CSID      IFEQ *BLANKS                         E14686    S01194
     C           BBCSID    IFEQ *BLANKS                                   S01194
     C***********TELX      ANDEQ*BLANKS                         E14686    S01194
     C********** BCTXNB    ANDEQ*BLANKS                           S01194  LN0012
     C           BBTXA1    ANDNE*BLANKS                           S01194  LN0012
     C***********STTX      ANDNE*BLANKS                         E14686    S01194
     C           BBSTAD    ANDNE*BLANKS                                   S01194
     C**  (6)                                                             E14686
     C***********CSID      ORNE *BLANKS                         E14686    S01194
     C           BBCSID    ORNE *BLANKS                                   S01194
     C***********TELX      ANDEQ*BLANKS                         E14686    S01194
     C********** BCTXNB    ANDEQ*BLANKS                           S01194  LN0012
     C           BBTXA1    ANDNE*BLANKS                           S01194  LN0012
     C***********STTX      ANDNE*BLANKS                         E14686    S01194
     C           BBSTAD    ANDNE*BLANKS                                   S01194
     C           PRTX      ANDLTPRSW                                      E14686
     C*                                                                   E14686
     C***********          MOVE STTX      WCSID                 E14686    S01194
     C                     MOVE BBSTAD    WCSID                           S01194
     C                     MOVE 'X'       SWTX                            E14686
     C                     END                                            E14686
     C*                                                                   S01140
     C***           CSID      COMP ' '                  3131              S01140
     C***   31                MOVE CSID      WCSID  12                    S01140
     C****    IN CSID, IF (POS 10-12 BLANK & POS 9 NOT BLANK) OR          S01140
     C****                (POS 12 NOT BLANK)                              S01140
     C****    THEN REMOVE TERMINAL CODE IN POSITION 9 FOR SWIFT ADDRESS   S01140
     C****    I.E. SWIFT ADDRESS HAS BEEN SET UP AS 9 OR 12 CHARACTERS    S01140
     C***   31      WCSID3    COMP ' '                      48POS10-12 BLAS01140
     C***   31 48   WCSID9    COMP ' '                  4848  POS 9 NOT BLS01140
     C***   31      WCSID2    COMP ' '                  4949  POS12 NOT BLS01140
     C***   31 48                                                         S01140
     C***OR 31 49             MOVELBLNK14    WCSID                        S01140
     C***   31 48                                                         S01140
     C***OR 31 49             MOVELWCSID8    WCSID1 11                    S01140
     C***   31 48                                                         S01140
     C***OR 31 49             MOVE WCSID3    WCSID1                       S01140
     C***   31 48                                                         S01140
     C***OR 31 49             MOVELWCSID1    WCSID                        S01140
     C***********          MOVE 'B'       CLINKY                          S01194
     C***********CLINKY    CHAINCLINT                32                   S01194
     C**N32******RECI      COMP 'D'                  3232                 S01194
     C***32******          SETON                     U7U8LR               S01194
     C***32******          Z-ADD6         DBASE            * DB ERROR 06 *S01194
     C***32******          MOVE 'CLINT'   DBFILE                          S01194
     C***32******          MOVELCLINKY    DBKEY                           S01194
     C***32******          GOTO END                                       S01194
     C**                                                                  S01194
     C**  ACCESS CUSTOMER DETAIL FILE                                     S01194
     C                     MOVE *BLANKS   @KEY1                           S01194
     C                     MOVE SCNUM     @KEY1                           S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C                     PARM           @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           BBDTDL    ORNE *ZEROS                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'006'     DBASE            * DBERR 006 *  S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVELSCNUM     DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C**
     C***********SWACKY****CHAINACCNT****************25                   S01117
     C/COPY WNCPYSRC,GL1300C131
     C           ACCKEY    CHAINACCBR                25                   S01117
     C   25                SETON                     U7U8LR
     C   25                Z-ADD7         DBASE            * DB ERROR 07 *
     C   25                MOVE 'ACCNT'   DBFILE
     C***25****************MOVELSWACKY****DBKEY*******                    S01117
     C   25                MOVELACCKEY    DBKEY                           S01117
     C   25                GOTO END
     C*
     C*****FIND*SWIFT*ADDRESS*OF*BRANCH*INTERNAL*CUSTOMER*NO*OF*BRANCH    S01310
     C******OF ACCOUNT************************************************    S01310
     C*                                                                   S01310
     C**   Set up senders address (Network address of branch internal     S01310
     C**   customer of account)                                           S01310
     C*                                                                   S01310
     C                     Z-ADD1         X
     C           BRCD      LOKUPZBRD,X                   99
     C           *IN99     IFEQ '1'
     C**   FOUND
     C***********          MOVE ZCSD,X    OURSA  12                       S01310
     C                     MOVELZCSD,X    NWSN                            S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP13                                           S01408
     C*                                                                   S01408
     C*                                                                   S01135
     C***IF*TELEX,*TELEX*BRANCH*CODE*SHOULD*BE*USED**************** S01135S01310
     C*                                                                   S01135
     C***********SWTX      IFEQ 'T'                                 S01135S01310
     C***********          MOVE ZTLX,X    OURSA                     S01135S01310
     C***********          END                                      S01135S01310
     C*                                                                   S01135
     C                     ELSE
     C**   NOT FOUND
     C                     SETON                     U7U8LR***************
     C                     Z-ADD10        DBASE            * DB ERROR 10 *
     C                     MOVE 'ACCNT'   DBFILE           ***************
     C                     MOVELBRCD      DBKEY
     C                     GOTO END
     C                     END
     C**
     C**ACCES*BRANCH CODE TABLE FILE TO FIND SENDERS CUSTOMER NUMBER.     S01194
     C***********          MOVE *BLANKS   ZTABKY                          S01194
     C***********          MOVEL'10'      ZTABKY                          S01194
     C***********          MOVE BRCD      ZTABKY                          S01194
     C***********ZTABKY    CHAINTABMS                30                   S01194
     C************IN30     IFEQ '1'                                       S01194
     C**                                                                  S01194
     C**  ACCESS BRANCH CODE FILE TO FIND SENDER'S CUSTOMER NUMBER        S01194
     C                     MOVE *BLANKS   @DSNB                           S01194
     C                     MOVE BRCD      @DSNB                           S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C***********          SETON                     U7U8LR***************S01194
     C***********          Z-ADD11        DBASE            * DB ERROR 11 *S01194
     C***********          MOVE 'TABMS'   DBFILE           ***************S01194
     C***********          MOVELZTABKY    DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'011'     DBASE            * DBERR 011 *  S01194
     C                     MOVEL'SDBRCHPD'DBFILE                          S01194
     C                     MOVELBRCD      DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END
     C                     ELSE
     C***********          MOVE BICN      OURCN   60                      S01194
     C**********           MOVE A8BICN    OURCN   60                                   S01194 CSD027
     C                     MOVE A8BICN    OURCN   6                                           CSD027
     C                     END
     C**
     C**   IF THE ACCOUNT IS RETAIL THEN THE RETAIL ACCOUNT NUMBER IS
     C**   USED IN THE OPENING BALANCE RECORD
     C**
     C           ATYP      COMP 'R'                      35
     C   35      ACNO      COMP 0                    88
     C***88*****           MOVE ACNO      ACOUNT 10                       S01310
     C*                                                                   S01310
     C                     MOVE *BLANKS   ACOUNT                          E32328
     C           *IN88     IFEQ '1'                                       S01310
     C*********************MOVELACNO      ACOUNT 18                 S01310BUG5978
     C                     MOVELACNO      ACOUNT 24                       BUG5978
     C                     ELSE                                           S01310
     C                     MOVELACCKEY    ACOUNT                          S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,GL1300C034
     C**
     C*****CREATE*FIELDS*FOR*OPENING*BALANCE*RECORD**********             S01310
     C**
     C********** CFBAL     COMP 0                      3636               S01310
     C***36*****           Z-SUBCFBAL     BAL    150                      S01310
     C**N36*****           Z-ADDCFBAL     BAL                             S01310
     C**********           MOVE LSDAT     ZDAYNO                          S01310
     C**********           EXSR ZDATES                                    S01310
     C**********           MOVE ZDATE     LSDATE  6                       S01310
     C**
     C**********           MOVE BAL       ZSAMTI                          S01310
     C**********           MOVE SCCY      ZSACCY                          S01310
     C**********           EXSR SWAMFM                                    S01310
     C***U7*U8**           GOTO END                                       S01310
     C**********           MOVE ZSAMTO    CFBLED 15                       S01310
     C**********           MOVEL'F'       OP                              S01310
     C**
     C**   OUTPUT HEADER AND OPENING BALANCE RECORDS
     C                     SETON                     69
     C***69******MSGNO     ADD  2         MSGNO                           S01310
     C   69      NUM950    ADD  1         NUM950
     C/COPY WNCPYSRC,GL1300C068
     C   69      SCOUNT    ADD  1         SCOUNT  40
     C************IN18     IFEQ '1'                                 BHF054S01310
     C***********LINE      IFGE 55                                  S01117S01310
     C***********          EXCPTHEAD                                S01117S01310
     C***********          END                                      S01117S01310
     C***********          END                                      BHF138S01310
     C***********          EXCPT                                          S01310
     C****************     END                                      BHF054BHF138
     C*                                                                   S01310
     C/COPY WNCPYSRC,GL1300C064
     C**  Set up field 20 with transaction number                         S01310
     C*                                                                   S01310
     C                     MOVE ':20: '   @MTAG                           S01310
     C                     MOVELTRNO      @MFLD                           S01310
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C052
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C*                                                                   S01310
     C**  Set up field 25 with acount no. from SWACB                      S01310
     C*                                                                   S01310
     C                     MOVE ':25: '   @MTAG                           S01310
     C/COPY WNCPYSRC,GL1300CES1                                           S01408
     C                     MOVELACOUNT    @MFLD                           S01310
     C/COPY OFCPYSRCZ,CGL136_003                                                              CGL136
     C/COPY WNCPYSRC,GL1300C020
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C053
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C*                                                                   S01310
     C**  Set up field 28 with last statement no.from SWACB               S01310
     C**  and statement page count                                        S01310
     C*                                                                   S01310
     C***********          MOVE LSNO      LSST                            E29588
     C                     Z-ADDLSNO      LSST                            E29588
     C                     MOVE '/'       SLASH                           S01310
     C                     MOVE ':28: '   @MTAG                           S01310
     C                     MOVELSTNO      @MFLD                           S01310
      *                                                                                       CSW201
      ** If CSW201 is installed, bypass checking of CSW096.  Set                              CSW201
      ** @MFLD to WSTR11 and @MTAG to ':28C:'.                                                CSW201
      *                                                                                       CSW201
     C           CSW201    IFNE 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           CSW096    IFEQ 'Y'                                       CSW096
     C                     MOVE ':28C:'   @MTAG                           CSW096
     C                     MOVELSTNO6     @MFLD                           CSW096
     C                     ENDIF                                          CSW096
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE ':28C:'   @MTAG                                               CSW201
     C                     MOVELWSTR11    @MFLD                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C054
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C/COPY WNCPYSRC,GL1300C014
     C*                                                                   S01310
     C**   CREATE FIELDS FOR OPENING BALANCE RECORD                       S01310
     C*                                                                   S01310
     C           CFBAL     COMP 0                      3636               S01310
     C   36                Z-SUBCFBAL     BAL    150                      S01310
     C  N36                Z-ADDCFBAL     BAL                             S01310
     C/COPY WNCPYSRC,GL1300C035
     C                     MOVE LSDAT     ZDAYNO                          S01310
     C                     EXSR ZDATES                                    S01310
     C                     MOVE ZDATE     LSDATE  6                       S01310
     C**                                                                  S01310
     C                     MOVE BAL       ZSAMTI                          S01310
     C                     MOVE SCCY      ZSACCY                          S01310
     C                     EXSR SWAMFM                                    S01310
     C/COPY WNCPYSRC,GL1300C096
     C   U7 U8             GOTO END                                       S01310
     C                     MOVE ZSAMTO    CFBLED 15                       S01310
     C/COPY WNCPYSRC,GL1300C097
     C*                                                                   S01310
     C**  Set up debit/credit field for field 60                          S01310
     C*                                                                   S01310
     C           *IN36     IFEQ '1'                                       S01310
     C                     MOVE 'C'       DBCD    1                       S01310
     C                     ELSE                                           S01310
     C                     MOVE 'D'       DBCD                            S01310
     C                     END                                            S01310
     C*                                                                   S01310
     C**  Set up opening balance field                                    S01310
     C*                                                                   S01310
     C/COPY WNCPYSRC,GL1300C132
     C                     MOVE LSDATE    RUND60                          S01310
     C/COPY WNCPYSRC,GL1300C133
     C                     MOVE A6SWCY    SWCY60                          S01310
     C                     MOVE ':60F:'   @MTAG                           S01310
     C                     MOVELOPBAL     @MFLD                           S01310
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C055
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
      *                                                                   S01310
      **  Write to MGOMSGPD and clear data structure                      S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,GL1300C022
     C                     EXSR OUTSR                                     S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CCP8                                           S01408
     C*                                                                   S01408
     C**
     C**   SET UP MESSAGE REFERENCE FILE FIELDS
     C                     MOVE 'D'       RECI
     C                     TIME           MRTIME  60
     C                     MOVE MRTIME    LATM
     C*
     C/COPY WNCPYSRC,GL1300CMT2                                           S01408
     C**                                                                  S01408
      **  Load array DSR with all message types with default status       159993
      **  released for this customer                                      159993
      *                                                                   159993
     C                     MOVE BBDS01    DSR,1                           159993
     C                     MOVE BBDS02    DSR,2                           159993
     C                     MOVE BBDS03    DSR,3                           159993
     C                     MOVE BBDS04    DSR,4                           159993
     C                     MOVE BBDS05    DSR,5                           159993
     C                     MOVE BBDS06    DSR,6                           159993
     C                     MOVE BBDS07    DSR,7                           159993
     C                     MOVE BBDS08    DSR,8                           159993
     C                     MOVE BBDS09    DSR,9                           159993
     C                     MOVE BBDS10    DSR,10                          159993
     C                     MOVE BBDS11    DSR,11                          159993
     C                     MOVE BBDS12    DSR,12                          159993
     C                     MOVE BBDS13    DSR,13                          159993
     C                     MOVE BBDS14    DSR,14                          159993
     C                     MOVE BBDS15    DSR,15                          159993
      *                                                                   159993
     C                     MOVELSCNUM     DECN                            S01310
     C                     MOVELBBCSID    NWDS                            S01310
     C                     MOVE '950'     MTPY                            CSW004
      *                                                                   S01389
      ** If MT940 SWIFT messages feature is switched ON                   CSW004
     C           MT94FG    IFEQ 'Y'                                       CSW004
     C*                                                                   CSW004
      ** Generate MT940 message if 'MT940 Destination' on PF/SWACSSB      CSW004
      ** is not blank.                                                    CSW004
      ** Message Type = 940. Destination Address = 'MT940 Destination'    CSW004
     C           MT94      IFNE *BLANKS                                   CSW004
     C                     MOVE '940'     MTPY                            CSW004
     C                     MOVELMT94      NWDS                            CSW004
     C/COPY WNCPYSRC,GL1300C011
     C           MTPY      LOKUPDSR                      37               159993
     C           SINTE     IFNE 'Y'                                       159993
     C           *IN37     IFEQ '1'                                       159993
     C                     MOVE 'RSND'    MGST                            159993
     C                     MOVE '2'       MGSG                            159993
     C                     END                                            159993
     C                     ENDIF                                          159993
      *                                                                   159993
     C                     END                                            CSW004
     C*                                                                   CSW004
     C                     END                                            CSW004
     C*
     C/COPY WNCPYSRC,GL1300CMT3                                           S01408
     C**                                                                  S01408
     C           *IN35     IFEQ '1'
     C                     MOVE 'R'       AORR
     C                     MOVE *BLANKS   SACN
     C           *IN88     IFEQ '1'                                       082830
     C                     MOVELRACN      SACN
     C                     ELSE                                           082830
     C                     MOVELSCNUM     WECNUM                                              CGL029
     C                     MOVELSCCY      WECCY                                               CGL029
     C                     MOVELSACOD     WEACOD                                              CGL029
     C                     MOVELSACSQ     WEACSQ                                              CGL029
     C                     MOVE SWACKY    SACN                            082830
     C                     ENDIF                                          082830
     C                     ELSE
     C                     MOVE 'A'       AORR
     C                     MOVELSCNUM     WECNUM                                              CGL029
     C                     MOVELSCCY      WECCY                                               CGL029
     C                     MOVELSACOD     WEACOD                                              CGL029
     C                     MOVELSACSQ     WEACSQ                                              CGL029
     C                     MOVE SWACKY    SACN
     C                     END
     C                     MOVE SBRCA     BRCA                            S01194
     C**********           MOVE MRTIME    MGTM                            S01310
     C**********           MOVE OURSA     STID                            S01310
     C**********           MOVE WCSID     DTID                            S01310
     C                     MOVE OURCN     SECN
     C*                                                                   S01310
     C**********           MOVE SCNUM     DECN                            S01310
     C**********           MOVE CRNM      RPNM                            S01194
     C***********          MOVE CTWN      RPTN                            S01194
     C**********           MOVE BBCRNM    RPNM                      S01194S01310
     C**********           MOVE BBCRTN    RPTN                      S01194S01310
     C           DEST      IFEQ 'Y'
     C                     MOVE DEST      DESI
     C                     ELSE
     C                     MOVE 'N'       DESI
     C                     END
     C*
     C**********           WRITEMSIXOPFF                                  S01310
     C*                                                                   S01310
     C**  Output to reference file for first message (statement page)     S01310
     C*                                                                   S01310
     C**   INTERNAL ONLY INDICATOR DETERMINES MESSAGE STATUS              S01389
     C*                                                                   S01389
     C           SINTE     IFEQ 'Y'                                       S01389
     C/COPY WNCPYSRC,GL1300C069
     C                     MOVE 'DLTD'    MGST                            S01389
     C                     MOVE '4'       MGSG                            S01389
     C                     ELSE                                           S01389
     C/COPY WNCPYSRC,GL1300C006
     C           MTPY      LOKUPDSR                      37               159993
     C           *IN37     IFEQ '1'                                       159993
     C                     MOVE 'RSND'    MGST                            159993
     C                     MOVE '2'       MGSG                            159993
     C                     ELSE                                           159993
     C                     MOVE 'CRTD'    MGST                            S01389
     C/COPY WNCPYSRC,GL1300C007
     C                     MOVE '1'       MGSG                            S01389
     C                     END                                            159993
     C                     END                                            S01389
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CCP1                                           S01408
     C*                                                                   S01408
     C           SINTE     IFNE 'Y'                                       130832
     C           ENTSDC    IFEQ 'Y'                                       121652
     C                     MOVE 'RSND'    MGST                            121652
     C                     MOVE '2'       MGSG                            121652
     C                     END                                            121652
     C                     ENDIF                                          130832
     C/COPY WNCPYSRC,GL1300C087
      *                                                                                       CSD015
      ** Check if message type exists in the watch list                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           222385
     C           CSW025    ANDEQ'N'                                                           CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
     C*                                                                   S01310
     C                     WRITEMGOREFD0                                  S01310
     C/COPY WNCPYSRC,GL1300C023
     C*                                                                   S01310
     C                     SETOF                     69
     C**
     C**   SET ON THE REPORTING INDICATOR AND INITIALISE THE CURRENT
     C**   BALANCE FIELD
     C                     SETON                     51
     C                     Z-ADDCFBAL     BALNCE 130
     C**                                                                  CSW020
     C** Adjust the current balance if the swift decimal is less than     CSW020
     C** from the currency decimal places                                 CSW020
     C                     MOVE 'N'       WCHGRQ  1                       CSW020
     C/COPY WNCPYSRC,GL1300C089
     C           CSW020    IFEQ 'Y'                                       CSW020
     C                     CALL 'AOCURRR0'                                CSW020
     C                     PARM '*MSG   ' @RTCD   7                       CSW020
     C                     PARM '*KEY   ' @OPTN   7                       CSW020
     C                     PARM SCCY      @AJCD   3                       CSW020
     C           SDCURR    PARM SDCURR    DSSDY                           CSW020
     C           @RTCD     IFNE *BLANKS                                   CSW020
     C                     SETON                     U7U8LR*************  CSW020
     C                     MOVEL'026'     DBASE            * DBERR 026 *  CSW020
     C                     MOVEL'SDCURRPD'DBFILE           *************  CSW020
     C                     MOVELSCCY      DBKEY                           CSW020
     C                     MOVEL@OPTN     DBOPTN                          CSW020
     C                     EXSR *PSSR                                     CSW020
     C                     END                                            CSW020
      *                                                                   CSW020
     C           A6SWDP    IFLT A6NBDP                                    CSW020
     C           A6SWDT    ANDLERUND                                      CSW020
      *                                                                   CSW020
     C* CHECK THE DIFFERENCE OF DECIMAL TO HAVE THE CORRECT AMOUNT        CSW020
      *                                                                   CSW020
     C           A6NBDP    SUB  A6SWDP    WDIFF   10                      CSW020
      *                                                                   CSW020
     C           WDIFF     IFEQ 1                                         CSW020
     C                     Z-ADD10        WPOWER  40                      CSW020
     C                     ENDIF                                          CSW020
     C           WDIFF     IFEQ 2                                         CSW020
     C                     Z-ADD100       WPOWER                          CSW020
     C                     ENDIF                                          CSW020
     C           WDIFF     IFEQ 3                                         CSW020
     C                     Z-ADD1000      WPOWER                          CSW020
     C                     ENDIF                                          CSW020
      *                                                                   CSW020
      * Zeroise the extra decimal                                         CSW020
     C/COPY WNCPYSRC,GL1300C090
     C                     DIV  WPOWER    BALNCE                          CSW020
     C                     MULT WPOWER    BALNCE                          CSW020
     C/COPY WNCPYSRC,GL1300C091
      *                                                                   CSW020
      * Set Change required field to Yes                                  CSW020
     C                     MOVE 'Y'       WCHGRQ  1                       CSW020
     C                     ENDIF                                          CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C/COPY WNCPYSRC,GL1300C036
     C**
     C                     GOTO END
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C           QPOSTD    TAG                             **QPOSTD TAG **
     C/COPY WNCPYSRC,GL1300C010
     C**
     C*****S/POST*DETAIL RECORD PROCESSING                                LN0074
     C**   LF/SMPBR DETAIL RECORD PROCESSING                              LN0074
     C**
     C*****INCREMENT*RECORDS ON S/POST BY 1                               LN0074
     C**   INCREMENT RECORDS ON LF/SMPBR BY 1                             LN0074
     C           POSTOT    ADD  1         POSTOT
      *                                                                   CSW004
      ** If MT940 SWIFT messages feature is switched OFF                  CSW004
      ** AND 'MT940 Destination' on PF/SWACSSB is not = blank,            CSW004
      ** no further processing for this SWIFT account                     CSW004
     C           MT94FG    IFEQ ' '                                       CSW004
     C           MT94      ANDNE*BLANKS                                   CSW004
     C                     GOTO END                                       CSW004
     C                     END                                            CSW004
     C**
     C**   NO FURTHER PROCESSING IS REQUIRED FOR A RATE CHANGE RECORD
     C  NMR
     COR 07                GOTO END
     C/COPY WNCPYSRC,GL1300C070
     C**
     C**   DETERMINE IF THE RECORD IS TO BE OUTPUT TO S/SWPOS
     C   MR U1N51          SETON                     33
     C   33      OSWPOS    ADD  1         OSWPOS
     C/COPY WNCPYSRC,GL1300C071
     C*                                                                   CEU013
     C** If EMU enhancement present and record output to S/SWPOS          CEU013
     C** output record to PF/SWPOOAPD.                                    CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN33     ANDEQ'1'                                       CEU013
     C           *INU1     ANDEQ'1'                                       CEU013
     C           *IN06     ANDEQ'1'                                       CEU013
     C*                                                                   CEU013
     C           XRFI      IFNE *BLANKS                                   CEU013
     C           XRFN      ANDNE*ZERO                                     CEU013
     C           PSTD      IFEQ BJRDNB                                    CEU013
     C           REFKEY    CHAINEODPOPPF             53                   CEU013
     C                     ELSE                                           CEU013
     C           REFKEY    CHAINSWPOSAPF             53                   CEU013
     C                     ENDIF                                          CEU013
     C           *IN53     IFEQ '0'                                       CEU013
     C                     WRITESWPOOAPF                                  CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C/COPY WNCPYSRC,GL1300C082
     C*                                                                   CEU013
     C   33                GOTO END
     C**
     C**   CHECK IF MESSAGE IS REQUIRED
     C                     SETOF                     31
     C   MR 51             SETON                     31
     C  N31                GOTO END
     C**   ADJUST BALANCE BY POSTING AMOUNT
     C**   ACCORDING TO THE SWIFT DECIMAL PLACES                          CSW020
     C           MDRCR     COMP 0                        31
      *                                                                   CSW020
     C           WCHGRQ    IFEQ 'Y'                                       CSW020
     C/COPY WNCPYSRC,GL1300C092
     C           PSTA      DIV  WPOWER    NWPSTA 130                      CSW020
     C           NWPSTA    MULT WPOWER    NWPSTA                          CSW020
     C/COPY WNCPYSRC,GL1300C093
     C           *IN31     IFEQ *ON                                       CSW020
     C                     ADD  NWPSTA    BALNCE                          CSW020
     C                     ELSE                                           CSW020
     C                     SUB  NWPSTA    BALNCE                          CSW020
     C                     ENDIF                                          CSW020
     C                     ELSE                                           CSW020
      *                                                                   CSW020
     C  N31      BALNCE    SUB  PSTA      BALNCE
     C   31      BALNCE    ADD  PSTA      BALNCE
     C                     Z-ADDPSTA      NWPSTA                          CSW020
     C                     ENDIF                                          CSW020
     C/COPY WNCPYSRC,GL1300C037
     C**  FIELD :61: (statement line) PROCESSING                          S01310
     C*                                                                   S01310
     C                     EXSR F61SR                                     S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP12                                           S01408
     C*                                                                   S01408
     C**
     C*****FILL*THE*DATA*STRUCTURE*REFERENCED*BY*THE*FIELD*MFIELD*        S01310
     C***31*****           MOVEL'D'       DSDRCR                          S01310
     C**N31*****           MOVEL'C'       DSDRCR                          S01310
     C**********           MOVE VALD      ZDAYNO                          S01310
     C**********           EXSR ZDATES                                    S01310
     C**********           MOVE ZDATE     MVDAT                           S01310
     C********** PSTD      IFNE 0                                         S01310
     C**********           MOVE PSTD      ZDAYNO                          S01310
     C**********           EXSR ZDATES                                    S01310
     C**********           MOVE ZDATE     MPDAT                           S01310
     C**********           ELSE                                           S01310
     C**********           MOVE *BLANKS   MPDAT                           S01310
     C**********           END                                            S01310
     C**********           MOVE PSTA      ZSAMTI                          S01310
     C**********           MOVE SCCY      ZSACCY                          S01310
     C**                                                                  S05452
     C**   SETTING UP - SUBFIELD(7)                                       S05452
     C**********           MOVELSPOS27    CHKN07  70                BHF456S01310
     C**********           MOVELCHKN07    CHEK06  6                 BHF456S01310
     C**********           MOVE *BLANKS   SB7                       BHF456S01310
     C*                                                                   BHF456
     C****IF*THE*CHARACTERS*2-7*OF*SPOS*ARE*NUMERIC*THEN*IT*IS*A*BATBHF456S01310
     C****ENTRY,*MOVE*SPOS*TO*SUBFIELD 7.***************************BHF456S01310
     C*                                                                   BHF456
     C********** SPOS27    IFEQ CHEK06                              BHF456S01310
     C**********           MOVELSPOS27    SPOSX                     BHF456S01310
     C**********           ELSE                                     BHF456S01310
     C**                                                                  BHF456
     C*****SET*UP*SB7*AS*THE*FIRST*16*CHARACTERS*OF*MPNAR*IF*SWCR*ISS05452S01310
     C*****BLANK,IF*NOT*USE*SWCR.***********************************S05452S01310
     C**                                                                  S05452
     C********** SWCR      IFEQ *BLANKS                    ### B001 S05452S01310
     C**********           MOVE MPN16     SB7    16                 S05452S01310
     C**********           ELSE                            ### X001 S05452S01310
     C**********           MOVE SWCR      SB7                       S05452S01310
     C**********           END                             ### E001 S05452S01310
     C**********           END                                      BHF456S01310
     C**                                                                  S05452
     C*****SETTING*UP*-*SUBFIELD(8)*********************************S05452S01310
     C**                                                                  S05452
     C**********           MOVE *BLANKS   SLASHS                    S05452S01310
     C**********           MOVE *BLANKS   SB8                       S05452S01310
     C********** SPOS27    IFEQ CHEK06                              BHF456S01310
     C********** SWCR      IFEQ *BLANKS                             BHF456S01310
     C**********           MOVEAMPN16     SB8                       BHF456S01310
     C**********           ELSE                                     BHF456S01310
     C**********           MOVEASWCR      SB8                       BHF456S01310
     C**********           END                                      BHF456S01310
     C**********           MOVE '//'      SLASHS                    BHF456S01310
     C**********           END                                      BHF456S01310
     C*                                                                   S05452
     C*****DO*IF*DLREF*IS*NOT*BLANK*********************************S05452S01310
     C*                                                                   S05452
     C********** SPOS27    IFNE CHEK06                              BHF456S01310
     C********** DLREF     ANDNE*BLANKS                    ### B001 BHF456S01310
     C*******    DLREF     IFNE *BLANKS                    ### B001 S05452BHF456
     C**********           MOVEADLREF     SB8                       S05452S01310
     C**********           MOVE '//'      SLASHS                    S05452S01310
     C*                                                                   S05452
     C*****DO*IF*DLREF*IS*BLANK*                                    S05452BHF456
     C*                                                                   S05452
     C**********           ELSE                            ### X001S05452 BHF456
     C**********           MOVELSPOS27    CHKN07  70               S05452 BHF456
     C**********           MOVELCHKN07    CHEK06  6                S05452 BHF456
     C*                                                                   S05452
     C*****DO*IF*CHARACTERS*2-7*OF*SPOS*ARE*NUMERIC(AND DLREF IS BLAS05452BHF456
     C*****SB8*IS*LEFT*BLANK*IF*2-7*OF*SPOS*ARE*NON*NUMERIC.********S05452S01310
     C*                                                                   S05452
     C***        SPOS27    IFEQ CHEK06                     ### B002 S05452BHF456
     C***                  MOVEADPMT      SB8,1                     S05452BHF456
     C***                  MOVEASPOS24    SB8,5                     S05452BHF456
     C***                  MOVEASPOS57    SB8,9                     S05452BHF456
     C***                  MOVE '//'      SLASHS                    S05452BHF456
     C***                  END                             ### E002 S05452BHF456
     C***********          END                             ### E001 S05452S01310
     C**                                                                  S05452
     C*****SETTING*UP*-*SUBFIELD(9)*********************************S05452S01310
     C**                                                                  S05452
     C**********           MOVE *BLANKS   SB9    34                 S05452S01310
     C*                                                                   S05452
     C*****DO*IF*FACO*IS*NOT*BLANK**********************************S05452S01310
     C*                                                                   S05452
     C********** FACO      IFNE *BLANKS                    ### B001 S05452S01310
     C*                                                                   S05452
     C**********           MOVELFACO16    CHKN07                    S05452S01310
     C**********           MOVELCHKN07    CHEK06                    S05452S01310
     C*                                                                   S05452
     C**   DO IF CHARACTERS 1-6 OF FACO ARE NUMERIC (+ FACO NOT BLANK)    S05452
     C*                                                                   S05452
     C********** FACO16    IFEQ CHEK06                     ### B002 S05452S01310
     C***********          MOVELFACO16    CLKEY                     S05452S01194
     C**********           MOVELFACO16    @KEY1                     S01194S01310
     C**********           EXSR CLTCHN                              S05452S01310
     C************IN99     IFEQ '0'                        ### B003 S05452S01194
     C********** @RTCD     IFEQ *BLANKS                             S01194S01310
     C********** BBDTDL    ANDEQ0                                   S01194S01310
     C***********          MOVELCRNM      SB9                       S05452S01194
     C***********          MOVE CTWN      SB9                       S05452S01194
     C**                                                                  S01194
     C*****EXTRACT*CUSTOMER*REPORT*NAME*&*REPORT*TOWN*IF*RECORD*IS**S01194S01310
     C*****FOUND*AND*ACTIVE*****************************************S01194S01310
     C**********           MOVELBBCRNM    SB9                       S01194S01310
     C***********          MOVE BBCRTN    SB9                       S01194S01310
     C***********          ELSE                            ### X003 S05452S01310
     C***********          SETON               U7U8LR***************S05452S01194
     C***********          Z-ADD12        DBASE      * DB ERROR 12 *S05452S01194
     C***********          MOVE 'CLINT'   DBFILE     ***************S05452S01194
     C***********          MOVELCLKEY     DBKEY                     S05452S01194
     C***********          SETON                     U7U8LR         S01194S01310
     C***********          MOVEL'012'     DBASE            * DBERR 0S01194S01310
     C***********          MOVEL'SDCUSTPD'DBFILE                    S01194S01310
     C***********          MOVELFACO16    DBKEY                     S01194S01310
     C***********          MOVEL@OPTN     DBOPTN                    S01194S01310
     C***********          EXSR *PSSR                               S01194S01310
     C***********          GOTO END                                 S05452S01310
     C***********          END                             ### E003 S05452S01310
     C*                                                                   S05452
     C***DO*IF*CHARACTERS*1-6*OF*FACO*ARE*NON*NUMERIC(+*FACO*NOT*BLAS05452S01310
     C*                                                                   S05452
     C***********          ELSE                            ### X002 S05452S01310
     C**                                                                  S01194
     C****ACCESS*COUNTERPARTY*NOSTRO*FILE***************************S01194S01310
     C***********          MOVE *BLANKS   @ARCD                     S01194S01310
     C***********          CALL 'AOCNSTR0'                          S01194S01310
     C***********          PARM '*MSG   ' @RTCD   7                 S01194S01310
     C***********          PARM '*KEY   ' @OPTN   7                 S01194S01310
     C***********          PARM FACO18    @ARCD   8                 S01194S01310
     C***********SDCNST    PARM SDCNST    DSFDY                     S01194S01310
     C***********          MOVEL'71  '    ZTABKY                    S05452S01194
     C***********          MOVE FACO18    ZTABKY                    S05452S01194
     C***********          EXSR TABCHN                              S05452S01194
     C************IN99     IFEQ '0'                        ### B003 S05452S01194
     C***********@RTCD     IFEQ *BLANKS                             S01194S01310
     C**                                                                  S01194
     C****EXTRACT*COUNTERPARTY*SHORTNAME*&TOWN**********************S01194S01310
     C***********          MOVE *BLANKS   HOLD10 10                 S01194S01310
     C***********          MOVELAWCSN1    HOLD10                    S01194S01310
     C***********          MOVE AWCSN2    HOLD10                    S01194S01310
     C***********          MOVELHOLD10    SB9                       S01194S01310
     C***********          MOVE AWCNTN    SB9                       S01194S01310
     C***********          MOVELCPSH      SB9                       S05452S01194
     C***********          MOVE CPTN      SB9                       S05452S01194
     C***********          ELSE                            ### X003       S05452
     C***********          SETON               U7U8LR***************S05452S01194
     C***********          Z-ADD13        DBASE      * DB ERROR 13 *S05452S01194
     C***********          MOVE 'TABLE'   DBFILE     ***************S05452S01194
     C***********          MOVELZTABKY    DBKEY                     S05452S01194
     C***********          SETON                     U7U8LR         S01194S01310
     C***********          MOVEL'013'     DBASE            * DBERR 0S01194S01310
     C***********          MOVEL'SDCNSTPD'DBFILE                    S01194S01310
     C***********          MOVELFACO18    DBKEY                     S01194S01310
     C***********          MOVEL@OPTN     DBOPTN                    S01194S01310
     C***********          EXSR *PSSR                               S01194S01310
     C***********          GOTO END                                 S05452S01310
     C***********          END                             ### E003 S05452S01310
     C***********          END                             ### E002 S05452S01310
     C*                                                                   S05452
     C*****DO*IF*FACO*IS*BLANK**************************************S05452S01310
     C*                                                                   S05452
     C***********          ELSE                            ### X001 S05452S01310
     C*                                                                   S05452
     C*****DO*IF*DLREF*IS*NOT*BLANK*(+*FACO*IS*BLANK)***************S05452S01310
     C*                                                                   S05452
     C***********DLREF     IFNE *BLANKS                    ### B002 S05452S01310
     C***********          MOVELDBCNUM    CLKEY                     S05452S01194
     C***********          MOVELDBCNUM    @KEY1                     S01194S01310
     C***********          EXSR CLTCHN                              S05452S01310
     C************IN99     IFEQ '0'                        ### B003 S05452S01194
     C***********@RTCD     IFEQ *BLANKS                             S01194S01310
     C***********BBDTDL    ANDEQ0                                   S01194S01310
     C**                                                                  S01194
     C*****EXTRACT*CUSTOMER*REPORT*NAME*&*REPORT*TOWN***************S01194S01310
     C***********          MOVELBBCRNM    SB9                       S01194S01310
     C***********          MOVE BBCRTN    SB9                       S01194S01310
     C***********          MOVELCRNM      SB9                       S05452S01194
     C***********          MOVE CTWN      SB9                       S05452S01194
     C***********          ELSE                            ### X003 S05452S01310
     C***********          SETON               U7U8LR***************S05452S01194
     C***********          Z-ADD14        DBASE      * DB ERROR 14 *S05452S01194
     C***********          MOVE 'CLINT'   DBFILE     ***************S05452S01194
     C***********          MOVELCLKEY     DBKEY                     S05452S01194
     C***********          SETON                     U7U8LR         S01194S01310
     C***********          MOVEL'014'     DBASE            * DBERR 0S01194S01310
     C***********          MOVEL'SDCUSTPD'DBFILE                    S01194S01310
     C***********          MOVELDBCNUM    DBKEY                     S01194S01310
     C***********          MOVEL@OPTN     DBOPTN                    S01194S01310
     C***********          EXSR *PSSR                               S01194S01310
     C***********          GOTO END                                 S05452S01310
     C***********          END                             ### E003 S05452S01310
     C*                                                                   S05452
     C*****DO*IF*DLREF*IS*BLANK*(+*FACO*IS*BLANK)*******************S05452S01310
     C*                                                                   S05452
     C***********          ELSE                            ### X002 S05452S01310
     C*                                                                   S05452
     C*****DO*IF*SWCR*IS*BLANK*(+DLREF*AND*FACO*ARE*BLANK)**********S05452S01310
     C***********          MOVE '0'       OK      1                 E15758S01310
     C***********          Z-ADD1         Y       20                E15758S01310
     C*                                                                   S05452
     C***********SWCR      IFEQ *BLANKS                    ### B003 S05452S01310
     C*                                                                   E15758
     C***********Y         DOWLE14                                  E15758S01310
     C***********OK        ANDEQ'0'                                 E15758S01310
     C***********MPNMIA,Y  IFEQ ':'                                 E15758S01310
     C***********MPNMIA,Y  OREQ '-'                                 E15758S01310
     C***********MPNMIA,Y  OREQ ' '                                 E15758S01310
     C***********          ADD  1         Y                         E15758S01310
     C***********          ELSE                                     E15758S01310
     C***********          MOVE '1'       OK                        E15758S01310
     C***********          END                                      E15758S01310
     C***********          END                                      E15758S01310
     C*                                                                   E15758
     C***********OK        IFEQ '1'                                 E15758S01310
     C***********          MOVEAMPNMIA,Y  SB9                       E15758S01310
     C***********          END                                      E15758S01310
     C***********          MOVELMPNMID    SB9                      S05452 E15758
     C*                                                                   S05452
     C*****DO*IF*SWCR*IS*NOT*BLANK*(+DLREF*AND*FACO*ARE*BLANK)******S05452S01310
     C*                                                                   S05452
     C***********          ELSE                            ### X003 S05452S01310
     C***********Y         DOWLE30                                  E15758S01310
     C***********OK        ANDEQ'0'                                 E15758S01310
     C***********MPNARA,Y  IFEQ ':'                                 E15758S01310
     C***********MPNARA,Y  OREQ '-'                                 E15758S01310
     C***********MPNARA,Y  OREQ ' '                                 E15758S01310
     C***********          ADD  1         Y                         E15758S01310
     C***********          ELSE                                     E15758S01310
     C***********          MOVE '1'       OK                        E15758S01310
     C***********          END                                      E15758S01310
     C***********          END                                      E15758S01310
     C*                                                                   E15758
     C***********OK        IFEQ '1'                                 E15758S01310
     C***********          MOVEAMPNARA,Y  SB9                       E15758S01310
     C***********          END                                      E15758S01310
     C***********          MOVELMPNAR     SB9                      S05452 E15758
     C***********          END                             ### E003 S05452S01310
     C***********          END                             ### E002 S05452S01310
     C***********                                                   S05452S01310
     C***********          END                             ### E001 S05452S01310
     C*                                                                   S05452
     C***********          EXSR SWAMFM                                    S01310
     C***U7*U8***          GOTO END                                       S01310
     C***********          MOVE CCYS      MCCY                            S01194
     C***********          MOVE A6SWCY    MCCY                      S01194S01310
     C***********          MOVE ZSAMTO    MAMNT                           S01310
     C**
     C***********          MOVEL'F'       MCODE                           S01310
     C***********CHQN      COMP 0                    3838                 S01310
     C***38******          MOVE 'CHK'     MCODE                           S01310
     C***38******          GOTO CODEND                                    S01310
     C***********SPOS      COMP '  GE-IC'                31               S01310
     C**N31******GETP      COMP 'O'                      39               S01310
     C***31******          MOVE 'INT'     MCODE                           S01310
     C***39******          MOVE 'STO'     MCODE                           S01310
     C**N31N39***          MOVE 'MSC'     MCODE                           S01310
     C**
     C***********CODEND    TAG                             ** CODEND TAG *S01310
     C**                   MOVE BLAN16    MPREF                           S05452
     C**
     C**                   MOVELSPOS      MPREF                           S05452
     C** 38                MOVE CHQN      MPREF                           S05452
     C***********          MOVE CR        CR1                             S01310
     C***********          MOVE LF        LF1                             S01310
     C*
     C*****COMPRESS*MOVEMENT*OUTPUT*TO*REMOVE*BLANKS*******************   S01310
     C*
     C***********          MOVE *BLANKS   RMVD                            S01310
     C***********          Z-ADD0         J       30                      S01310
     C*
     C***********1         DO   72        I       20                      S01310
     C***********RMV,I     IFNE ' '                                       S01310
     C***********          ADD  1         J                               S01310
     C***********          MOVE RMV,I     RMVD,J                          S01310
     C***********          END                                            S01310
     C***********          END                                            S01310
     C**
     C***IF*MPNAR*NOT*EQUAL*BLANK*OUTPUT*REST*OF*FIELD*61*TO*THE*ARRAY.   S01310
     C**
     C***********MPNAR     IFNE *BLANKS                                   S01310
     C***********          ADD  1         J                               S01310
     C***********          MOVEAREST61    RMVD,J                          S01310
     C***********          END                                            S01310
     C**
     C*****RENAME*ARRAY*JUST*COMPRESSED*AND*OUTPUT*S/MSMSO*MOVEMENTS*RECORS01310
     C*****IF*NECCESSARY***********************************************   S01310
     C***********FIELD1    COMP BLA108               3131                 S01310
     C**N31******          MOVEARMVD      FIELD1                          S01310
     C**N31******          MOVELMFIELD    AT1A   52                       S01310
     C**N31***             MOVE MPNAR     AT1B   30                       S05452
     C**N31******          MOVEASB8       AT1B   52                 S05452S01310
     C**N31******          MOVE SB9       AT1B                      S05452S01310
     C**N31******          GOTO END                                       S01310
     C**
     C***31******          MOVEARMVD      FIELD2                          S01310
     C***31******          MOVELMFIELD    AT2A   52                       S01310
     C***31***             MOVELMPNAR     AT2B   30                       S05452
     C***31******          MOVEASB8       AT2B   52                 S05452S01310
     C***31******          MOVE SB9       AT2B                      S05452S01310
     C**
     C***MAX.*MESSAGE*SIZE*REACHED.*OUTPUT*INTERMEDIATE*CLOSING*BAL.,*    S01310
     C***HEADER*AND*OPENING*BAL.***************************************   S01310
     C************IN81     IFEQ '1'                                       S01310
     C***********MSGNO     ADD  3         MSGNO                           S01310
     C***********NUM950    ADD  1         NUM950                          S01310
     C***********          MOVE SCOUNT    PRVCNT  40                      S01310
     C***********SCOUNT    ADD  1         SCOUNT                          S01310
     C***********LINE      IFGE 55                                  S01117S01310
     C************IN18     ANDEQ'1'                                 BHF054S01310
     C***********          EXCPTHEAD                                S01117S01310
     C***********          END                                      S01117S01310
     C***********          EXCPT                                          S01310
     C*
     C* SET UP FIELDS WHICH CHANGE FOR INTERMEDIATE BALANCE MESSAGE
     C* REFERENCE RECORD AND WRITE RECORD TO FILE
     C***********          TIME           MRTIME                          S01310
     C***********          MOVE MRTIME    LATM                            S01310
     C***********          MOVE MRTIME    MGTM                            S01310
     C***********          WRITEMSIXOPFF                                  S01310
     C*                                                                   S01310
     C***********          Z-ADD0         MCNT    20                      S01310
     C***********          SETOF                     81                   S01310
     C***********          END                                            S01310
     C**
     C***31******          SETON                     70                   S01310
     C***70******MSGNO     ADD  1         MSGNO                           S01310
     C***********LINE      IFGE 55                                  S01117S01310
     C************IN18     ANDEQ'1'                                 BHF054S01310
     C***********          EXCPTHEAD                                S01117S01310
     C***********          END                                      S01117S01310
     C***********          EXCPT                                          S01310
     C***********          SETOF                     70                   S01310
     C**
     C***********          MOVE BLA108    FIELD1                          S01310
     C***31******          MOVE BLA108    FIELD2                          S01310
     C**
     C** IF MAXIMUM MESSAGE SIZE IS REACHED SET FIELDS AND INDICATORS
     C** TO OUTPUT INTERMEDIATE CLOSING BAL.,HEADER AND OPENING BAL. IF
     C** ANOTHER MOVEMENT IS ENCOUNTERED BEFORE 'REAL' CLOSING BAL.
     C           MCNT      ADD  1         MCNT
     C***********MCNT      COMP 8                        81               E32327
     C           MCNT      COMP 16                       81               E32327
     C/COPY WNCPYSRC,GL1300C003
     C******81***          MOVEL'M'       OP                              S01310
      *                                                                                       CSW201
      ** All processing made to LINO6 or LINO will be bypassed if                             CSW201
      ** CSW201 is installed.  WNO11 will instead be processed.                               CSW201
      *                                                                                       CSW201
     C           CSW201    IFNE 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           CSW096    IFEQ 'Y'                                       CSW096
     C           *IN81     ANDEQ'1'                                       CSW096
     C           LINO6     ADD  1         LINO6                           CSW096
     C           LINO6     IFEQ 0                                         CSW096
     C                     Z-ADD1         LINO6                           CSW096
     C                     ADD  1         LSNO                            CSW096
     C                     ADD  1         LSST                            CSW096
     C                     END                                            CSW096
     C                     ELSE                                           CSW096
     C      81   LINO      ADD  1         LINO
     C      81   LINO      IFEQ 0                                         092642
     C                     Z-ADD1         LINO                            092642
     C           LSNO      ADD  1         LSNO                            092642
     C                     ADD  1         LSST                            092642
     C                     END                                            092642
     C                     ENDIF                                          CSW096
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C           *IN81     IFEQ '1'                                                           CSW201
     C           WNO11     ADD  1         WNO11                                               CSW201
      *                                                                                       CSW201
     C           WNO11     IFEQ 0                                                             CSW201
     C                     Z-ADD1         WNO11                                               CSW201
     C                     ADD  1         LSNO                                                CSW201
     C                     ADD  1         LSST                                                CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C      81   BALNCE    COMP 0                      3636
     C      81   BALNCE    COMP 0                      4242
     C/COPY WNCPYSRC,GL1300C038
      *                                                                   S01310
     C           *IN42     IFEQ '1'                                       S01310
     C                     MOVE 'C'       DBCR62                          S01310
     C                     ELSE                                           S01310
     C                     MOVE 'D'       DBCR62                          S01310
     C                     END                                            S01310
      *                                                                   S01310
     C   81 36             Z-SUBBALNCE    BAL
     C   81N36             Z-ADDBALNCE    BAL
     C/COPY WNCPYSRC,GL1300C039
     C      81             MOVE BAL       ZSAMTI
     C      81             MOVE SCCY      ZSACCY
     C      81             EXSR SWAMFM
     C   U7 U8             GOTO END
     C/COPY WNCPYSRC,GL1300C098
     C      81             MOVE ZSAMTO    MBAL   15
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CCP9                                           S01408
     C*                                                                   S01408
     C**                                                                  S01310
     C**  If previous posting means message reaches maximum size -        S01310
     C**  output intermediate closing balance, next reference             S01310
     C**  record and header of next message for this statement.           S01310
     C**                                                                  S01310
     C           *IN81     IFEQ '1'                                       S01310
     C           *INL1     ANDEQ'0'                                       E32327
     C                     EXSR INTSR                                     S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,GL1300C088
     C**                                                                  S01310
     C           MSGEND    TAG                             ** MSGEND TAG *
     C/COPY WNCPYSRC,GL1300C040
     C**
     C                     GOTO END
     C**
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C           SWACT     TAG                             ** SWACT TAG **
     C**
     C**   S/SWACS TRAILER RECORD PROCESSING
     C**
     C**   INCREMENT RECORDS ON S/SWACS COUNT AND RECORDS OUTPUT TO
     C**   S/SWACN COUNT
     C           SWATOT    ADD  1         SWATOT
     C           OSWACN    ADD  1         OSWACN
     C**
     C**
     C           END       TAG                             *** END TAG ***
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C**
     C**   LEVEL BREAK PROCESSING
     C**
     C**   IF DATA-BASE ERROR GOTO LR PROCESSING                          S01117
     C**                                                                  S01117
     CL1 U7 U8             GOTO ENDL1                                     S01117
     C**                                                                  LN0074
     C**   IF NO DETAILS, PRINT FILE NOT OPENED, GOTO LR PROCESSING       LN0074
     C**                                                                  LN0074
     C*1N18******          GOTO ENDL1                               LN0074S01310
     C**
     C**    81 - SETOF INTERMEDIATE BALANCE INDICATOR AND RESET FINAL
     C**   BALANCE FIELDS.
     C**
     CL1                   SETOF                     81
     CL1                   Z-ADD0         MCNT
      *                                                                                       CSW201
      ** If CSW201 is installed, bypass checking of CSW096. Set                               CSW201
      ** WNO11 to 1.                                                                          CSW201
      *                                                                                       CSW201
     CL1         CSW201    IFNE 'Y'                                                           CSW201
      *                                                                                       CSW201
     CL1         CSW096    IFEQ 'Y'                                       CSW096
     CL1                   Z-ADD1         LINO6   30                      CSW096
     CL1                   ELSE                                           CSW096
     CL1                   Z-ADD1         LINO    20
     CL1                   ENDIF                                          CSW096
      *                                                                                       CSW201
     CL1                   ELSE                                                               CSW201
     CL1                   Z-ADD1         WNO11                                               CSW201
     CL1                   ENDIF                                                              CSW201
      *                                                                                       CSW201
     C**
     C**   IF A SWIFT MOVEMENT MESSAGE REMAINS THEN OUTPUT IT NOW
     C*1*********FIELD1    COMP BLA108               3131                 S01310
     C*1*31******          SETON                     71                   S01310
     C*1*31******          MOVELMFIELD    AT3A   52                       S01310
     C*1*31***             MOVELMPNAR     AT3B   30                       S05452
     C*1*31******          MOVEASB8       AT3B   52                 S05452S01310
     C*1*31******          MOVE SB9       AT3B                      S05452S01310
     C*1*31******          MOVE BLA108    FIELD2                          S01310
     C*1*71******MSGNO     ADD  1         MSGNO                           S01310
     C*1*********LINE      IFGE 55                                  S01117S01310
     C*1**********IN18     ANDEQ'1'                                 BHF054S01310
     C*1**********         EXCPTHEAD                                S01117S01310
     C*1**********         END                                      S01117S01310
     C*1**********         EXCPT                                          S01310
     C*1**********         SETOF                     71                   S01310
     C**
     C**   IF THE S/SWACS RECORD READ INDICATOR IS OFF THEN NO FURTHER
     C**   PROCESSING IS DONE
     CL1N50                GOTO ENDL1
     C**
     C**   IF THE PREVIOUS SWACS RECORD WAS LIVE THEN OUTPUT THE RECORD
     C**   TO S/SWACN
     CL1         SWRID     COMP 'D'                      34
     CL1 34      OSWACN    ADD  1         OSWACN
     C**
     C**   41 CALC NEXT ACCRUALS PROFIT DATE
     C*1*41******          MOVE APFQ      SFREQ                           S01194
     CL1 41                MOVE BKAPFQ    SFREQ                           S01194
     C**
     C**   WORK THE NEW NEXT STATEMENT DATE AND ADJUST LAST STATEMENT
     C**   NUMBER
     CL1                   Z-ADDLSNO      NEWLSN  50
     C/COPY WNCPYSRC,GL1300C016
     C*1*******************MOVE NSDAT     ZDAYNO                          092062
     CL1                   MOVE RUND      ZDAYNO                          092062
     CL1         SFREQ     IFEQ ' '                                       063303
     CL1                   MOVE 'D'       ZFREQ                           063303
     CL1                   ELSE                                           063303
     CL1                   MOVE SFREQ     ZFREQ
     CL1                   ENDIF                                          063303
     CL1                   MOVE SCCY      ZCCY
     CL1                   MOVE SDAY      ZMDAY
     CL1                   MOVE BJSLCD    ZLOC    3                       S01195
     CL1 45      RUND      ADD  183       NEWNSD
     C/COPY WNCPYSRC,GL1300C017
     CL1N45                EXSR ZFREQB
     C/COPY WNCPYSRC,GL1300C018
     CL1         *IN45     IFEQ '0'                                       S01194
     CL1         *INU7     IFEQ '1'                                       S01194
     CL1         *INU8     ANDEQ'1'                                       S01194
     CL1                   GOTO ENDL1                                     S01194
     CL1                   END                                            S01194
     CL1                   END                                            S01194
     CL1N45                MOVE ZDAYNO    NEWNSD  50
     C**
     C**   CLOSING BALANCE PROCESSING ONLY DONE IF REPORTING IND. IS ON
     CL1N51                GOTO RESET
     C/COPY WNCPYSRC,GL1300C041
     C**
     C**   TEST IF BALANCE IS POSITIVE OR NEGATIVE AND CONVERT IT TO
     C**   SWIFT FORMAT
     CL1         BALNCE    COMP 0                      4242
     CL1    42             Z-SUBBALNCE    BAL
     CL1   N42             Z-ADDBALNCE    BAL
     C/COPY WNCPYSRC,GL1300C042
     CL1                   MOVE BAL       ZSAMTI
     CL1                   MOVE SCCY      ZSACCY
     CL1                   EXSR SWAMFM
     CL1 U7 U8             GOTO ENDL1
     C/COPY WNCPYSRC,GL1300C099
     CL1                   MOVE ZSAMTO    BALF   15
     C/COPY WNCPYSRC,GL1300C100
     C**
     C**   FOR RETAIL ACCOUNTS CHAIN TO S/ACCNT TO GET THE CLEARED BALANCE
     C**   IN ORDER TO GENERATE A CLEARED BALANCE SWIFT MESSAGE
     CL1N35                GOTO CFOUT
     C**
     C*L1*********SWACKY****CHAINACCNT****************24                  S01117
     CL1         ACCKEY    CHAINACCBR                24                   S01117
     CL1 24                SETON                     U7U8LR
     CL1 24                Z-ADD8         DBASE            * DB ERROR 08 *
     CL1 24                MOVE 'ACCNT'   DBFILE
     C*L1*24****************MOVELSWACKY****DBKEY                          S01117
     CL1 24                MOVELACCKEY    DBKEY                           S01117
     CL1 24                GOTO ENDL1
     C**
     C**   FOR RETAIL ACCOUNTS GENERATE A CLEARED BALANCE SWIFT MESSAGE
     CL1         CLBL      COMP 0                      4343
     CL1 43                Z-SUBCLBL      BAL
     CL1N43                Z-ADDCLBL      BAL
     C/COPY WNCPYSRC,GL1300C043
     CL1                   MOVE BAL       ZSAMTI
     CL1                   MOVE SCCY      ZSACCY
     CL1                   EXSR SWAMFM
     CL1 U7 U8             GOTO ENDL1
     C/COPY WNCPYSRC,GL1300C101
     CL1                   MOVE ZSAMTO    CLBLF  15
     C/COPY WNCPYSRC,GL1300C102
     C**
     CL1         CFOUT     TAG                             ** CFOUT TAG **
     C**
     C**   CLEAR FIELDS USED TO OUTPUT MOVEMENT MESSAGES TO AUDIT TRAIL
     C*1*********          MOVE BLA108    FIELD1                          S01310
     C*1*********          MOVE BLA108    FIELD2                          S01310
     C*1*********          MOVE BLAN52    AT1A                            S01310
     C*1*********          MOVE BLAN52    AT1B                            S01310
     C*1*********          MOVE BLAN52    AT2A                            S01310
     C*1*********          MOVE BLAN52    AT2B                            S01310
     C*1*********          MOVE BLAN52    AT3A                            S01310
     C*1*********          MOVE BLAN52    AT3B                            S01310
     C*   OUTPUT CLOSING BALANCE
     C*
     CL1 51                SETON                     82
     CL1         BALNCE    IFLT 0                                         S01310
     CL1         BALNCE    OREQ 0                                         056763
     CL1 42                MOVE 'C'       DBCR62                          S01310
     CL1                   ELSE                                           S01310
     CL1N42                MOVE 'D'       DBCR62                          S01310
     CL1                   END                                            S01310
     C/COPY WNCPYSRC,GL1300C044
     C*                                                                   S01310
     CL1                   MOVE *BLANKS   MFLD                            S01310
     CL1                   MOVE RUNDAT    RUND62                          S01310
     CL1                   MOVE A6SWCY    SWCY62                          S01310
     CL1                   MOVELBALF      MBAL62                          S01310
     CL1                   MOVE ':62F:'   MTAG                            S01310
     CL1                   MOVELCLBAL     MFLD                            S01310
     CL1                   MOVE CRLF      @CTRC                           S01310
     CL1                   WRITEMGOMSGD0                                  S01310
     C/COPY WNCPYSRC,GL1300C024
     C*                                                                   S01310
     C*1*88******          MOVE *BLANKS   MFLD                            S01310
     C*1*88*43***          MOVE 'C'       DBCR64                    S01310E42857
     C*1*88N43***          MOVE 'D'       DBCR64                    S01310E42857
     C*1*88******          MOVE RUNDAT    RUND64                    S01310E42857
     C*1*88******          MOVE A6SWCY    SWCY64                    S01310E42857
     C*1*88******          MOVE CLBLF     MBAL64                    S01310E42857
     C*1*88******          MOVE ':64: '   MTAG                      S01310E42857
     C*1*88******          MOVELCLRBL     MFLD                      S01310E42857
     C*1*88******          MOVE CRLF      @CTRC                     S01310E42857
     C*1*88******          WRITEMGOMSGD0                            S01310E42857
     CL1 35 43             MOVE 'C'       DBCR64                          E42857
     CL1 35N43             MOVE 'D'       DBCR64                          E42857
     CL1 35                MOVE RUNDAT    RUND64                          E42857
     CL1 35                MOVE A6SWCY    SWCY64                          E42857
     CL1 35                MOVE CLBLF     MBAL64                          E42857
     CL1 35                MOVE ':64: '   MTAG                            E42857
     CL1 35                MOVELCLRBL     MFLD                            E42857
     CL1 35                MOVE CRLF      @CTRC                           E42857
     CL1 35                WRITEMGOMSGD0                                  E42857
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP10                                           S01408
     C*                                                                   S01408
     C*1*82******MSGNO     ADD  1         MSGNO                           S01310
     C*1*********LINE      IFGE 55                                  S01117S01310
     C*1**********IN18     ANDEQ'1'                                 BHF054S01310
     C*1*********          EXCPTHEAD                                S01117S01310
     C*1*********          END                                      S01117S01310
     C*1*51******          EXCPT                                    S01310S01310
     C*1*51******          SETOF                     82                   S01310
     C**
     CL1         RESET     TAG                             ** RESET TAG **
     C/COPY WNCPYSRC,GL1300C045
     C**
     C**   SET OFF BOTH INTERNAL INDICATORS - REPORTING INDICATOR AND
     C**   S/SWACS RECORD READ INDICATOR
     CL1                   SETOF                     5051
     C**
     C**   MAINTAIN COUNTS OF RECORDS TO BE DELETED
     CL1         SWRID     COMP '*'                      46
     CL1N46      SWRID     COMP 'C'                      46
     CL1 46      DSWACN    ADD  1         DSWACN
     C**
     CL1         ENDL1     TAG                             ** ENDL1 TAG **
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C**
     C**   LAST RECORD PROCESSING
     CLR U7 U8             GOTO ENDLR
     C/COPY WNCPYSRC,GL1300C046
     C**
     C*****IF*THERE*HAS*BEEN*DETAIL*OUTPUT*IE.*PRINT*FILE*OPEN,     LN0074S01310
     C*****PRINT*END*OF*REPORT*TEXT****************************     LN0074S01310
     C**                                                                  LN0074
     C*R**********IN18     IFEQ '1'                                 LN0074S01310
     C**                                                                  LN0074
     C*R*********MBIN      IFEQ 'Y'                                 S01117S01310
     C*R*********          EXCPTEND1                                S01117S01310
     C*R*********          ELSE                                     S01117S01310
     C*R*********          EXCPTEND2                                S01117S01310
     C*R*********          END                                      S01117S01310
     C**                                                                  LN0074
     C**    ELSE IF NO DETAIL OUTPUT, PRINT NO DETAILS ON P1              LN0074
     C**                                                                  LN0074
     C*R**********         ELSE                                     LN0074S01310
     C**                                                                  LN0074
     C*R**********         OPEN GL1300P1                            LN0074S01310
     C*R**********         Z-ADD*ZEROS    PAGE                      LN0074S01310
     C*R**********         Z-ADDSFNUM     SFNUM1                    LN0074S01310
     C*R**********         OUT  LDA                                 LN0074S01310
     C*R**********         CALL 'ZSFILE'                            LN0074S01310
     C*R**********         PARM           SEQ                       LN0074S01310
     C*R**********         PARM *BLANKS   SBRCA                     LN0074S01310
     C*R**********         PARM           SFILE                     LN0074S01310
     C*R**********         PARM           SFNUM1                    LN0074S01310
     C*R**********         PARM           ZSERR   1                 LN0074S01310
     C*R**********LOCK     IN   LDA                                 LN0074S01310
      *                                                             LN0074S01310
     C*R*********ZSERR     IFEQ 'Y'                                 LN0074S01310
      ****ERROR*DURING ZSFILEEPROCESSING, RETURN TO CALLING PROGRAM LN0074S01310
     C*R**********         SETON                     U7U8LR         LN0074S01310
     C*R**********         RETRN                                    LN0074S01310
     C*R**********         END                                      LN0074S01310
     C**                                                            LN0074S01310
     C*R**********         EXCPTNODTL                               LN0074S01310
     C*R**********         END                                      LN0074S01310
     C**
     C**   INCREMENT APPROPRIATE COUNTS
     CLR         POSTOT    ADD  1         POSTOT
     CLR U1      OSWPOS    ADD  1         OSWPOS
     C**
     C**   INCREMENT FIELD CONTAINING NUMBER OF MESSAGES OUTPUT
     C*R*********MSGNO     ADD  1         MSGNO                           S01310
     C**   ADJUST ACCUMULATED POST FILE TRAILER RECORD COUNT              E13086
     C*LR********TPNORE    SUB  2         TPNORE                   E13086 054721
     C*LR*U1*****TPNORE    SUB  2         TPNORE                   054721 080808
     CLR         TPNORE    SUB  2         TPNORE                          080808
     C**
     C**   COMPARE FILE CONTROLS
     C*R*********POSTOT    COMP PNORE                6060                 E13086
     CLR         POSTOT    COMP TPNORE               6060                 E13086
     CLR         SWATOT    COMP SNORE                6161
     CLR         SWADEL    COMP SNORD                6262
     C**
     C**   ADD TOTAL NUMBER OF MESSAGES CREATED TO FILE CONTROL DATA
     C**   AREA FIELDS.
     CLR                   ADD  NUM950    MT950
     CLR                   ADD  NUM950    TOTMSG
     C**
     C*LR*60***                                                           080808
     C*OR*61***                                                           080808
     C*OR*62***             SETON                     U8                  080808
     C**
     CLR         ENDLR     TAG                             ** ENDLR TAG **
     C/COPY WNCPYSRC,GL1300C086
     C**                                                                  S01117
     C**  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     CLR                   Z-ADDSFNUMU    SFNUM2  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C*************        PARM *BLANKS   SEQ     5                S01117 LN0074
     CLR                   PARM           SEQ     5                       LN0074
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           SFNUM2                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      *                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP15                                           S01408
      *                                                                   S01408
     C********************************************************************S01310
     C*  INTSR - SR                                                       S01310
     C*  SUBROUTINE TO OUTPUT INTERMEDIATE CLOSING BALANCE AND SET UP     S01310
     C*  NEXT MESSAGE                                                     S01310
     C*  CALLED BY MAIN PROCESSING           CALLS -                      S01310
     C********************************************************************S01310
     C*                                                                   S01310
     C           INTSR     BEGSR                                          S01310
     C*                                                                   S01310
      **  Clear multiple occurrence data structure                        S01310
      *                                                                   S01310
     C                     Z-ADD1         M       30                      S01310
     C           M         OCUR MULT                                      S01310
     C           M         DOWLE200                                       S01310
     C           @ALL      ANDNE*BLANKS                                   S01310
     C                     MOVE *BLANKS   @ALL                            S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     Z-ADD1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C*                                                                   S01310
     C**  Set up intermediate closing balance                             S01310
     C*                                                                   S01310
     C                     MOVE RUNDAT    RUND62                          S01310
     C                     MOVE A6SWCY    SWCY62                          S01310
     C                     MOVE MBAL      MBAL62                          S01310
     C                     MOVE ':62M:'   @MTAG                           S01310
     C                     MOVELCLBAL     @MFLD                           S01310
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C056
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
      *                                                                   S01310
      **  Write to MGOMSGPD and clear data structure                      S01310
      *                                                                   S01310
     C                     EXSR OUTSR                                     S01310
     C/COPY WNCPYSRC,GL1300C025
     C*                                                                   S01310
     C**  Add one to message count (and therefore TRNO)                   S01310
     C*                                                                   S01310
     C           SCOUNT    ADD  1         SCOUNT                          S01310
     C/COPY WNCPYSRC,GL1300C072
     C*                                                                   S01310
     C**  Set up and output next reference file record                    S01310
     C*                                                                   S01310
     C                     TIME           MRTIME                          S01310
     C                     MOVE MRTIME    LATM                            S01310
     C*                                                                   S01389
     C**   INTERNAL ONLY INDICATOR DETERMINES MESSAGE STATUS              S01389
     C*                                                                   S01389
     C           SINTE     IFEQ 'Y'                                       S01389
     C/COPY WNCPYSRC,GL1300C073
     C                     MOVE 'DLTD'    MGST                            S01389
     C                     MOVE '4'       MGSG                            S01389
     C                     ELSE                                           S01389
     C/COPY WNCPYSRC,GL1300C008
     C           MTPY      LOKUPDSR                      37               159993
     C           *IN37     IFEQ '1'                                       159993
     C                     MOVE 'RSND'    MGST                            159993
     C                     MOVE '2'       MGSG                            159993
     C                     ELSE                                           159993
     C                     MOVE 'CRTD'    MGST                            S01389
     C/COPY WNCPYSRC,GL1300C009
     C                     MOVE '1'       MGSG                            S01389
     C                     END                                            159993
     C                     END                                            S01389
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CCPG                                           S01408
     C*                                                                   S01408
     C           SINTE     IFNE 'Y'                                       130832
     C           ENTSDC    IFEQ 'Y'                                       121652
     C                     MOVE 'RSND'    MGST                            121652
     C                     MOVE '2'       MGSG                            121652
     C                     END                                            121652
     C                     ENDIF                                          130832
      *                                                                                       CSD015
      ** Check if message type exists in the watch list                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           222385
     C           CSW025    ANDEQ'N'                                                           CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
     C*                                                                   S01389
     C                     WRITEMGOREFD0                                  S01310
     C/COPY WNCPYSRC,GL1300C026
     C*                                                                   S01310
     C**  Set up fields :20: and :25: and :28: & :60m: for next           S01310
     C**  page of statement                                               S01310
     C*                                                                   S01310
     C                     MOVE ':20: '   @MTAG                           S01310
     C                     MOVELTRNO      @MFLD                           S01310
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C057
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C*                                                                   S01310
     C                     MOVE ':25: '   @MTAG                           S01310
     C/COPY WNCPYSRC,GL1300CES2                                           S01408
     C                     MOVELACOUNT    @MFLD                           S01310
     C/COPY OFCPYSRCZ,CGL136_004                                                              CGL136
     C/COPY WNCPYSRC,GL1300C021
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C058
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C*                                                                   S01310
     C***********          MOVE LSNO      LSST                      S01310E29588
     C                     Z-ADDLSNO      LSST                            E29588
     C                     MOVE '/'       SLASH                           S01310
     C                     MOVE ':28: '   @MTAG                           S01310
     C                     MOVELSTNO      @MFLD                           S01310
      *                                                                                       CSW201
      ** If CSW201 is installed, bypass checking of CSW096.  Set                              CSW201
      ** @MFLD to WSTR11 and @MTAG to ':28C:'.                                                CSW201
      *                                                                                       CSW201
     C           CSW201    IFNE 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           CSW096    IFEQ 'Y'                                       CSW096
     C                     MOVE ':28C:'   @MTAG                           CSW096
     C                     MOVELSTNO6     @MFLD                           CSW096
     C                     ENDIF                                          CSW096
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE ':28C:'   @MTAG                                               CSW201
     C                     MOVELWSTR11    @MFLD                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C059
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C*                                                                   S01310
     C**  Set up debit/credit field for field 60                          E29588
     C*                                                                   E29588
     C           *IN36     IFEQ '1'                                       E29588
     C                     MOVE 'C'       DBCD    1                       E29588
     C                     ELSE                                           E29588
     C                     MOVE 'D'       DBCD                            E29588
     C                     END                                            E29588
     C                     MOVE RUNDAT    RUND60                          S01310
     C                     MOVE A6SWCY    SWCY60                          S01310
     C                     MOVE MBAL      CFBLED                          S01310
     C*                                                                   S01310
     C                     MOVE ':60M:'   @MTAG                           S01310
     C                     MOVELOPBAL     @MFLD                           S01310
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C060
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
      *                                                                   S01310
      **  Write to MGMSOPD and clear data structure                       S01310
      *                                                                   S01310
     C                     EXSR OUTSR                                     S01310
     C/COPY WNCPYSRC,GL1300C027
      *                                                                   S01310
      **  Set up statement line count for next page                       E13697
      *                                                                   E13697
     C                     Z-ADD0         MCNT    20                      S01310
     C                     SETOF                     81                   S01310
     C*                                                                   S01310
     C                     ENDSR                                          S01310
     C*                                                                   S01310
     C********************************************************************S01310
     C/EJECT                                                              S01310
     C********************************************************************S01310
     C*  F61SR - SR                                                       S01310
     C*  SUBROUTINE TO SET UP FIELD :61:                                  S01310
     C*  CALLED BY MAIN PROCESSING   CALLS - MODSR SF6SR SF7SR SF8SR      S01310
     C********************************************************************S01310
      *                                                                   S01310
     C           F61SR     BEGSR                                          S01310
     C/COPY WNCPYSRC,GL1300C001
      *                                                                   S01310
      **   Set up posting module I/D                                      S01310
      *                                                                   S01310
     C                     EXSR MODSR                                     S01310
      *                                                                   S01310
      **   Set up field :61: common fields                                S01310
      *                                                                   S01310
     C   31                MOVEL'D'       DSDRCR                          S01310
     C  N31                MOVEL'C'       DSDRCR                          S01310
     C                     MOVE VALD      ZDAYNO                          S01310
     C                     EXSR ZDATES                                    S01310
     C                     MOVE ZDATE     MVDAT                           S01310
     C           PSTD      IFNE 0                                         S01310
     C                     MOVE PSTD      ZDAYNO                          S01310
     C                     EXSR ZDATES                                    S01310
     C                     MOVE ZDATE     MPDAT                           S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   MPDAT                           S01310
     C                     END                                            S01310
     C***********          MOVE PSTA      ZSAMTI                    S01310CSW020
     C                     MOVE NWPSTA    ZSAMTI                          CSW020
     C                     MOVE SCCY      ZSACCY                          S01310
     C/COPY WNCPYSRC,GL1300C065
      *                                                                   065886
      * Get extra information for formatting                              065886
      *                                                                   065886
     C                     EXSR SREXTR                                    065886
      *                                                                   S01310
      **  Set up subfield 6                                               S01310
      *                                                                   S01310
     C                     EXSR SF6SR                                     S01310
      *                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP14                                           S01408
      *                                                                   S01408
      *                                                                   S01310
      **  Set up subfield 7 - using MODID                                 S01310
      *                                                                   S01310
     C                     EXSR SF7SR                                     S01310
      *                                                                   S01310
      **   Set up subfield 8                                              S01310
      *                                                                   S01310
     C                     EXSR SF8SR                                     S01310
      *                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP18                                           S01408
      *                                                                   S01408
      *                                                                   S01310
      **   Load statement line                                            S01310
      *                                                                   S01310
     C***********          MOVE *BLANKS   SB9    10                 S01310E32329
      *                                                                   S01310
     C                     EXSR SWAMFM                                    S01310
     C   U7 U8             GOTO END                                       S01310
     C                     MOVE A6SWCY    MCCY                            S01310
     C                     MOVE ZSAMTO    MAMNT                           S01310
      *                                                                   S01310
      **  Compress to remove blanks                                       S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   RMVD                            S01310
     C                     Z-ADD0         J       30                      S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,GL1300C103
     C           1         DO   72        I       20                      S01310
     C/COPY WNCPYSRC,GL1300C104
     C           RMV,I     IFNE ' '                                       S01310
     C                     ADD  1         J                               S01310
     C                     MOVE RMV,I     RMVD,J                          S01310
     C                     END                                            S01310
     C                     END                                            S01310
      *                                                                   E32342
      **  Copy field to work on (if subfield 8 crosses over 50 chars.)    E32342
      **  Initialise W to start of new line (over the 50 chars. mark)     E32342
      *                                                                   E32342
     C                     MOVEARMVD      @WRK                            E32342
     C                     Z-ADD51        W       20                      E32342
      *                                                                   E29588
      **  Initialise CR/LF field                                          E29588
     C                     MOVE CRLF      @CTRC                           E29588
      *                                                                   S01310
      **  If message is longer than 50 characters,CRLF not needed;        E29588
      ** Also if subfield 8 should cross over the 50 character mark,      E29588
      ** write the whole of subfield 8 to the message file on a new       E29588
      ** line (previously it was being split between the two lines).      E29588
      *                                                                   S01310
     C           RMVD,51   IFNE *BLANKS                                   S01310
     C                     MOVE *BLANKS   @CTRC                           S01310
     C                     MOVEARMVD      WRK50  50                       E29588
     C           '//'      SCAN WRK50     W       20     80               E29588
     C           *IN80     IFEQ '1'                                       E29588
     C           W         ANDLE50                                        E29588
     C                     MOVEA*BLANKS   @WRK,W                          E29588
     C                     END                                            E29588
     C                     END                                            S01310
      *                                                                   S01310
      **  Move first 50 characters of array into @MFLD                    S01310
      *                                                                   S01310
     C                     MOVE ':61: '   @MTAG                           S01310
     C***********          MOVEARMVD,1    @MFLD                     S01310E32342
     C                     MOVEA@WRK,1    @MFLD                           E32342
     C/COPY WNCPYSRC,GL1300C061
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
      *                                                                   S01310
      **  If message greater than 50 characters long,output               S01310
      **  rest of array to next line                                      S01310
      ** Or output to a new line subfield 8  (positional value W)         E29588
      *                                                                   S01310
     C           RMVD,51   IFNE *BLANKS                                   S01310
     C*                                                                   051657
     C** The first character should not be ' ' or ':' or '-'              051657
     C*                                                                   051657
     C                     MOVE '0'       OKX     1                       051657
     C           OKX       DOUEQ'1'                                       051657
     C           RMVD,W    IFEQ ':'                                       051657
     C           RMVD,W    OREQ '-'                                       051657
     C           RMVD,W    OREQ ' '                                       051657
     C/COPY WNCPYSRC,GL1300C047
     C                     ADD  1         W                               051657
     C                     ELSE                                           051657
     C                     MOVE '1'       OKX                             051657
     C                     END                                            051657
     C                     END                                            051657
     C***********          MOVEARMVD,51   @MFLD                     S01310E32342
     C                     MOVEARMVD,W    @MFLD                           E32342
     C                     MOVE *BLANKS   @MTAG                           S01310
     C                     MOVE CRLF      @CTRC                           S01310
     C/COPY WNCPYSRC,GL1300C062
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   S01310
      **   Set up subfield 9 on seperate line                             S01310
      *                                                                   S01310
     C                     EXSR SF9SR                                     S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,GL1300C127
      **  Write to MGOMSGPD and clear data structure                      S01310
      *                                                                   S01310
     C                     EXSR OUTSR                                     S01310
      *                                                                   S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP21                                           S01408
     C*                                                                   S01408
     C                     ENDSR                                          S01310
      *                                                                   S01310
     C********************************************************************S01310
     C/EJECT                                                              S01310
     C********************************************************************S01310
     C*  MODSR - SR                                                       S01310
     C*  SUBROUTINE TO DERIVE MODULE ID CODE FOR FIELD :61: PROCESSING    S01310
     C*  CALLED BY MAIN PROCESSING        CALLS -                         S01310
     C********************************************************************S01310
      *                                                                   S01310
     C           MODSR     BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   MODID   2                       S01310
     C                     MOVE *BLANKS   MCODE                           082830
      *                                                                   S01310
     C                     MOVELDLREF     REF1    1                       S01310
      *                                                                   S01310
      **  If first character of DLREF is 'L'  must be Lending module      S01310
      *                                                                   S01310
     C           REF1      IFEQ 'L'                                       S01310
     C                     MOVE 'LE'      MODID                           S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  If first character of DLREF is 'D'  ....                        S01310
      *                                                                   S01310
     C           REF1      IFEQ 'D'                        ### B002       S01310
      *                                                                   S01310
      **  .... use Original Transaction Type to identify module           S01310
      *                                                                   S01310
     C                     MOVELOTTP      OTTP2   2                       S01310
     C           OTTP2     IFEQ 'FP'                                      S01310
     C           OTTP2     OREQ 'FS'                                      S01310
     C           OTTP2     OREQ 'OP'                                      S01310
     C           OTTP2     OREQ 'OT'                                      S01310
     C           OTTP2     OREQ 'CX'                                      S01310
     C           OTTP2     OREQ 'PI'                                      S01310
     C           OTTP2     OREQ 'SI'                                      S01310
     C                     MOVE 'FX'      MODID                           S01310
     C                     MOVE 'FEX'     MCODE                           S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OTTP2     IFEQ 'RF'                                      S01310
     C           OTTP2     OREQ 'RP'                                      S01310
     C           OTTP2     OREQ 'RR'                                      S01310
     C           OTTP2     OREQ 'RS'                                      S01310
     C           OTTP2     OREQ 'RX'                                      S01310
     C                     MOVE 'IR'      MODID                           S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OTTP2     IFEQ 'FR'                                      S01310
     C                     MOVE 'FR'      MODID                           S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     END                             ### E002       S01310
     C/COPY WNCPYSRC,LUC111_001                                                               LUC111
      *                                                                   S01310
      **  If Payment Reference field used, must be Funds Transfer         S01310
      *                                                                   S01310
     C           PREF      IFNE *BLANKS                                   S01310
     C                     MOVELPREF      PREF1   1                       S01310
     C           PREF1     IFEQ 'P'                                       S01310
     C                     MOVE 'FT'      MODID                           S01310
     C                     END                                            S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Check for numerics in OTRF                                      S01310
      *                                                                   S01310
     C                     MOVELOTRF5     CHKN06  60                      S01310
     C                     MOVELCHKN06    CHEK05  5                       S01310
      *                                                                   S01310
      **  Retail module ...                                               S01310
      *                                                                   S01310
     C           OTRF5     IFEQ CHEK05                                    S01310
     C           OTRF2     ANDEQ'91'                                      S01310
     C                     MOVE 'RE'      MODID                           S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Check for numerics in SPOS                                      S01310
      *                                                                   S01310
     C*********************MOVELSPOS57    CHKN04  40               S01310 079167
     C*********************MOVELCHKN04    CHEK03  3                S01310 079167
     C                     SETOF                     52                   079167
     C                     TESTN          SPOSY      52                   079167
     C/COPY WNCPYSRC,GLH00503
      *                                                                   S01310
      **  General Ledger module...                                        S01310
      *                                                                   S01310
     C           SPOS      IFEQ '  GE-XF'                                 S01310
     C           SPOS      OREQ '  GE-XB'                                 S01310
     C           *IN52     OREQ '1'                                       079167
     C***********SPOS57    OREQ CHEK03                             S01310 079167
     C                     MOVE 'GL'      MODID                           S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Securities Trading module...                                    S01310
      *                                                                   S01310
     C           SPOS      IFEQ '  GE-ST'                                 S01310
     C                     MOVE 'SE'      MODID                           S01310
     C                     END                                            S01310
      ** Customer Exchange transactions.                                  166138
     C           SPOS      IFEQ '  GE-CE'                                 166138
     C                     MOVE 'RE'      MODID                           166138
     C                     END                                            166138
      *                                                                   S01310
     C                     ENDSR                                          S01310
      *                                                                   S01310
     C********************************************************************S01310
      *                                                                   065886
     C/EJECT                                                              065886
      *****************************************************************   065886
      *                                                               *   065886
      *  SREXTR   : Get Extra information from transaction records    *   065886
      *                                                               *   065886
      *  CALLED BY: F61SR - Format :61: Subfields                     *   065886
      *                                                               *   065886
      *****************************************************************   065886
     CSR         SREXTR    BEGSR                                          065886
      *                                                                   065886
      * Clear data structure                                              065886
      *                                                                   065886
     C                     CLEARW1DATA                                    065886
     C/COPY WNCPYSRC,GL1300C125
      *                                                                   065886
      * If Funds Transfer call FT0325 for extra details                   065886
      *                                                                   065886
     C           MODID     IFEQ 'FT'                                      065886
     C/COPY WNCPYSRC,GL1300C126
      *                                                                   065886
      * Set up parameters                                                 065886
      *                                                                   065886
     C                     MOVELPREF      W1PREF                          065886
     C           2         SUBSTPNAR:16   W1CQSQ                          065886
     C                     MOVEL*BLANKS   W0ACT                           065886
     C                     MOVELOTTP      W0ACT                           065886
     C                     MOVEL'DR'      W1DRCR                          065886
     C           DRCR      IFEQ 1                                         065886
     C                     MOVEL'CR'      W1DRCR                          065886
     C                     END                                            065886
     C/COPY WNCPYSRC,GL1300C095
      *                                                                   065886
     C                     CALL 'FT0325'                                  065886
     C                     PARM *BLANKS   W0RTN   7                       065886
     C                     PARM           W0ACT   8                       065886
     C                     PARM           W1DATA                          065886
      *                                                                   065886
     C                     END                                            065886
      *                                                                   065886
     C           EXEXTR    TAG                                            065886
      *                                                                   065886
     CSR                   ENDSR                                          065886
     C/EJECT                                                              S01310
     C********************************************************************S01310
     C*  SF6SR - SR                                                       S01310
     C*  SUBROUTINE TO SET UP SUBFIELD 6 OF FIELD :61:                    S01310
     C*  CALLED BY F61SR                  CALLS -                         S01310
     C********************************************************************S01310
      *                                                                   S01310
     C           SF6SR     BEGSR                                          S01310
      *                                                                   S01310
     C*                                                                   S01427
     C/COPY WNCPYSRC,GL1300CCP2                                           S01408
     C*                                                                   S01310
      *                                                                   S01310
      **  Set up subfield 6 ... default code is 'MSC'                     S01310
      *                                                                   S01310
     C           MCODE     IFEQ *BLANKS                                   082830
     C/COPY WNCPYSRC,GL1300C128
     C                     MOVE 'MSC'     MCODE                           S01310
     C                     ENDIF                                          082830
     C/COPY WNCPYSRC,GL1300C129
      *                                                                   S01310
      ****Subfield*6*aLways*starts*with*'N'********************     S01310E29588
      *                                                                   S01310
     C****************     MOVEL'N'       MCODE                     S01310E32329
     C                     MOVEL'F'       MCODE                           E32329
      *                                                                   S01310
      **  Over-write 'MSC' with MG trans. type (SMPBR/LF)                 S01310
      *                                                             S01310E32485
     C***********          MOVE *BLANKS   MGTT    3                 REMOVEE32485
      **************************************************************REMOVEE32485
     C***********MGTT      IFNE *BLANKS                             S01310E32485
     C***********          MOVE MGTT      MCODE                     S01310E32485
     C***********          END                                      S01310E32485
      *                                                                   S01310
      **  Check FT Payment Reference for chq. clearance/collections       S01310
      *                                                                   S01310
     C           PREF      IFNE *BLANKS                    B001           S01310
     C                     MOVELPREF      PREF9   9                       S01310
     C                     MOVE PREF9     PREF2   2                       S01310
     C/COPY WNCPYSRC,GL1300C130
      *                                                                   S01310
     C           PREF2     IFEQ 'CP'                       B002           S01310
     C                     MOVE 'CLR'     MCODE                           S01310
     C                     ELSE                            X002           S01310
     C                     MOVE 'COL'     MCODE                           S01310
     C                     END                             E002           S01310
      *                                                                   S01310
     C                     END                             E001           S01310
      *                                                                   S01310
     C           SPOS      IFEQ 'GE-XF'                                   S01310
     C           SPOS      OREQ 'GE-XB'                                   S01310
     C                     MOVE 'FEX'     MCODE                           S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  If posting is cheque use 'CHK'                                  S01310
      *                                                                   S01310
     C***********CHQN      IFGE 0                                   S01310E32485
     C***********          MOVE CHQN      @CHQN   8                 S01310E32485
     C***********@CHQN     IFNE *BLANKS                             S01310E32485
     C/COPY WNCPYSRC,GL1300C048
     C           CHQN      COMP 0                    3838                 E32485
     C           *IN38     IFEQ '1'                                       E32485
     C                     MOVE 'CHK'     MCODE                           S01310
     C                     END                                            S01310
     C***********          END                                      S01310E32485
      *                                                                   S01310
      **  If posting is standing-order use 'STO'                          S01310
      *                                                                   S01310
     C           SPOS      IFEQ '  GE-SO'                                 S01310
     C                     MOVE 'STO'     MCODE                           S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  If posting is interest use 'INT'                                S01310
      *                                                                   S01310
     C           SPOS      IFEQ '  GE-IC'                                 S01310
     C                     MOVE 'INT'     MCODE                           S01310
     C                     END                                            S01310
      *                                                                   065886
      * If W1SBF6 is not blank use it                                     065886
      *                                                                   065886
     C           W1SBF6    IFNE *BLANKS                                   065886
     C                     MOVELW1SBF6    MCODE                           065886
     C                     END                                            065886
      *                                                                   S01310
     C*                                                                   S01427
     C/COPY WNCPYSRC,GL1300CCP3                                           S01408
     C*                                                                   S01310
     C                     ENDSR                                          S01310
      *                                                                   S01310
     C********************************************************************S01310
     C/EJECT                                                              S01310
     C********************************************************************S01310
     C*  SF7SR - SR                                                       S01310
     C*  SUBROUTINE TO SET UP SUBFIELD 7 OF FIELD :61:                    S01310
     C*  CALLED BY F61SR                  CALLS -                         S01310
     C********************************************************************S01310
      *                                                                   S01310
     C           SF7SR     BEGSR                                          S01310
     C/COPY WNCPYSRC,GL1300C074
      *                                                                   E32329
     C                     MOVELSPOS27    CHKN07  70                      E32329
     C                     MOVELCHKN07    CHEK06  6                       E32329
     C                     MOVELSPOSY     CHKNX7  70                      E32329
     C                     MOVELCHKNX7    CHEKX6  6                       E32329
     C                     MOVE *BLANKS   SB7                             E32329
     C*                                                                   S01310
     C**  Use Swift Common Reference field if not blank                   S01310
     C           SWCR      IFNE *BLANKS                    ### B001       S01310
     C           SWCR      ANDNEDLREF                                     S01310
     C******************** MOVEASWCR      SB7                       S01310E29588
     C/COPY WNCPYSRC,GL1300C080
     C                     MOVEASWCR      SB7,1                           E29588
     C/COPY WNCPYSRC,GL1300C081
     C*                                                                   S01310
     C                     ELSE                            ### X001       S01310
     C                     MOVEAMPN16     SB7,1                           E32329
     C*                                                                   E32485
     C***If*the*SPOS*is*numeric*then*it*ia*a*Batch*Entry.**********E32485 081690
     C***Move*SPOS*to*subfield*7.**********************************E32485 081690
     C***********SWCR      IFEQ *BLANKS                            E32485 081690
     C***********SPOS27    IFEQ CHEK06                             E32485 081690
     C***********SPOSY     OREQ CHEKX6                             E32485 081690
     C***********          MOVE *BLANKS   SB7                      E32485 081690
     C***********          MOVEASPOS      SB7,1                    E32485 081690
     C***********          END                                     E32485 081690
     C***********          END                                     E32485 081690
     C*                                                                   S01310
     C                     END                                            E32329
     C*                                                                   S01427
     C                     MOVE SPOS      SPOS5   5                       S01427
     C           SPOS5     IFEQ 'GE-CM'                                   S01427
     C*                                                                   S01427
     C           MDRCR     IFEQ 0                                         S01427
     C           SWCR      ANDEQ*BLANKS                                   S01427
     C                     MOVE *BLANKS   SB7                             S01427
     C                     MOVEASPOS      SB7,1                           S01427
     C                     END                                            S01427
     C*                                                                   S01427
     C           MDRCR     IFEQ 1                                         S01427
     C                     MOVE *BLANKS   SB7                             S01427
     C                     MOVEASPOS      SB7,1                           S01427
     C                     END                                            S01427
     C                     END                                            S01427
     C*                                                                   S01310
     C***********MODID     IFEQ 'GL'                       ### B002 S01310E29588
     C***********MODID     OREQ 'RE'                                S01310E29588
     C*                                                                   S01310
     C**  Fill subfield 7 array with fields from postings file            S01310
     C*                                                                   S01310
     C************         MOVEAMODID     SB7,1                     S01310E29588
     C************         MOVEAPBRCA     SB7,3                     S01310E29588
     C************         MOVEADPMT      SB7,6                     S01310E29588
     C************         MOVEASPOS      SB7,9                     S01310E29588
     C************         ELSE                            # X002   S01310E29588
     C************         MOVEAMODID     SB7,1                     S01310E29588
     C************         MOVEAOTRF      SB7,3                     S01310E29588
     C************         END                             # E002   S01310E29588
      *                                                                   065886
      * If W1SBF7 is not blank use it                                     065886
      *                                                                   065886
     C           W1SBF7    IFNE *BLANKS                                   065886
     C                     MOVEAW1SBF7    SB7,1                           065886
     C                     END                                            065886
     C/COPY WNCPYSRC,GL1300C013
      *                                                                   S01310
     C                     ENDSR                                          S01310
     C*                                                                   S01310
     C********************************************************************S01310
     C/EJECT                                                              S01310
     C********************************************************************S01310
     C*  SF8SR - SR                                                       S01310
     C*  SUBROUTINE TO SET UP SUBFIELD 8 OF FIELD :61:                    S01310
     C*  CALLED BY F61SR                  CALLS -                         S01310
     C********************************************************************S01310
     C*                                                                   S01310
     C           SF8SR     BEGSR                                          S01310
     C/COPY WNCPYSRC,GL1300C075
     C*                                                                   S01310
     C                     MOVE *BLANKS   SLASHS                          S01310
     C                     MOVE *BLANKS   SB8                             S01310
     C/COPY WNCPYSRC,GL1300C049
     C*                                                                   S01310
     C** Fill subfield 8 array with fields from postings file             S01310
     C*                                                                   S01310
     C           MODID     IFEQ 'GL'                       ### B001       S01310
     C                     MOVE '//'      SLASHS                          S01310
     C                     MOVEAMODID     SB8,1                           S01310
     C***********          MOVEAPBRCA     SB8,3                    S01310 082830
     C***********          MOVEADPMT      SB8,6                    S01310 082830
     C***********          MOVEASPOS      SB8,10                   S01310 082830
     C                     MOVEASPOS      SB8,2                           082830
     C*                                                                   S01310
     C                     ELSE                            ### X001       S01310
     C*                                                                   S01310
     C           MODID     IFEQ 'FX'                       ### B002       S01310
     C           MODID     OREQ 'MM'                                      S01310
     C           MODID     OREQ 'IR'                                      S01310
     C           MODID     OREQ 'FR'                                      S01310
     C           MODID     OREQ 'RE'                                      S01310
     C           MODID     OREQ 'LE'                                      S01310
     C                     MOVE '//'      SLASHS                          S01310
     C                     MOVEAMODID     SB8,1                           S01310
     C***********          MOVEAOTRF      SB8,3                    S01310 082830
     C                     MOVEAOTRF      SB8,2                           082830
     C*                                                                   S01310
     C                     ELSE                            ### X001       S01310
     C                     MOVE *BLANKS   SB8                             S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP22                                           S01408
     C*                                                                   S01408
     C                     END                             ### E002       S01310
     C                     END                             ### E001       S01310
     C           SPOS27    IFNE CHEK06                                    E32329
     C           DLREF     ANDNE*BLANKS                    ### B001       E32329
     C           SPOSY     ORNE CHEKX6                                    E32329
     C           DLREF     ANDNE*BLANKS                    ### B001       E32329
     C                     MOVEADLREF     SB8,1                           E32329
     C                     MOVE '//'      SLASHS                          E32329
     C                     END                             ### E001       E32329
     C** CHIPS POSTINGS                                                   S01427
     C*                                                                   S01427
     C           SPOS5     IFEQ 'GE-CM'                                   S01427
     C                     MOVE *BLANKS   SB8                             S01427
     C                     MOVE *BLANKS   SLASHS                          S01427
     C*                                                                   S01427
     C           MDRCR     IFEQ 0                                         S01427
     C           SWCR      ANDNE*BLANKS                                   S01427
     C                     MOVE '//'      SLASHS                          S01427
     C                     MOVEASPOS5     SB8,1                           S01427
     C                     END                                            S01427
     C                     END                                            S01427
      *                                                                   065886
      * If W1SBF8 is not blank use it                                     065886
      *                                                                   065886
     C           W1SBF8    IFNE *BLANKS                                   065886
     C                     MOVEL'//'      SLASHS                          065886
     C                     MOVEAW1SBF8    SB8,1                           065886
     C                     END                                            065886
     C*                                                                   S01427
     C/COPY WNCPYSRC,GL1300CCP4                                           S01408
     C*                                                                   S01310
     C                     ENDSR                                          S01310
     C*                                                                   S01310
     C********************************************************************S01310
     C/EJECT                                                              S01310
     C********************************************************************S01310
     C*  SF9SR - SR                                                       S01310
     C*  SUBROUTINE TO SET UP SUBFIELD 9 OF FIELD :61:                    S01310
     C*  CALLED BY F61SR                  CALLS -                         S01310
     C********************************************************************S01310
     C*                                                                   S01310
     C           SF9SR     BEGSR                                          S01310
     C/COPY WNCPYSRC,GL1300C076
     C*                                                                   S01310
     C**  Set up  subfield 9 according to module I/D                      S01310
     C*                                                                   S01310
     C                     MOVE *BLANKS   SB9    34                       E32329
     C           MODID     IFEQ 'FX'                                      S01310
     C           MODID     OREQ 'MM'                                      S01310
     C           MODID     OREQ 'IR'                                      S01310
     C           MODID     OREQ 'FR'                                      S01310
     C           MODID     OREQ 'RE'                                      S01310
     C           MODID     OREQ 'LE'                                      S01310
     C                     MOVELFACO      @MFLD                           S01310
     C                     MOVE *BLANKS   @MTAG                           S01310
     C                     MOVE CRLF      @CTRC                           S01310
     C                     END                                            E32329
     C*                                                                   S01310
     C**  Subfield 9 , if used must be on a seperate line                 S01310
     C*                                                                   S01310
     C                     MOVE *BLANKS   SB9    34                       E32329
     C*                                                                   CEU013
     C** If EMU enhancement present set up subfield 9 with Original       CEU013
     C** Ccy and amount.                                                  CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           XRFI      ANDNE*BLANKS                                   CEU013
     C           XRFN      ANDNE*ZERO                                     CEU013
     C           PSTD      IFEQ BJRDNB                                    CEU013
     C           REFKEY    CHAINEODPOPPF             53                   CEU013
     C                     ELSE                                           CEU013
     C           REFKEY    CHAINSWPOSAPD             53                   CEU013
     C                     END                                            CEU013
     C*                                                                   CEU013
     C* Retrieve ISO currency code for Original currecny                  CEU013
     C*                                                                   CEU013
     C           *IN53     IFEQ '0'                                       CEU013
     C                     MOVE *BLANKS   @AJCD                           CEU013
     C                     CALL 'AOCURRR0'                                CEU013
     C                     PARM '*MSG   ' @RTCD   7                       CEU013
     C                     PARM '*KEY   ' @OPTN   7                       CEU013
     C                     PARM OCCY      @AJCD   3                       CEU013
     C           SDCURR    PARM SDCURR    DSSDY                           CEU013
     C           @RTCD     IFNE *BLANKS                                   CEU013
     C                     SETON                     U7U8LR*************  CEU013
     C                     MOVEL'022'     DBASE            * DBERR 022 *  CEU013
     C                     MOVEL'SDCURRPD'DBFILE           *************  CEU013
     C                     MOVELOCCY      DBKEY                           CEU013
     C                     MOVEL@OPTN     DBOPTN                          CEU013
     C                     EXSR *PSSR                                     CEU013
     C                     ELSE                                           CEU013
     C                     MOVELA6SWCY    @OCCY                           CEU013
     C                     END                                            CEU013
     C*                                                                   CEU013
     C** CALL ZM0040 TO CONVERT AMOUNT INTO SWIFT FORMAT.                 CEU013
     C                     Z-ADDOAMT      ZAMT   130                      CEU013
     C                     MOVE OCCY      ZCCY    3                       CEU013
     C                     MOVE *BLANKS   ZSAMT  17                       CEU013
     C                     MOVE *BLANKS   ZSCCY   3                       CEU013
     C                     MOVE *BLANKS   ZERR    1                       CEU013
     C*                                                                   CEU013
     C                     CALL 'ZM0040'               28                 CEU013
     C                     PARM           ZAMT                            CEU013
     C                     PARM           ZCCY                            CEU013
     C                     PARM           ZSAMT                           CEU013
     C                     PARM           ZSCCY                           CEU013
     C                     PARM           ZERR                            CEU013
     C*                                                                   CEU013
     C** IF PROGRAM NOT FOUND                                             CEU013
     C           *IN28     IFEQ '1'                                       CEU013
     C                     SETON                     U7U8LR               CEU013
     C                     MOVE '020'     DBASE            * * * * * * * *CEU013
     C                     MOVE *BLANKS   DBKEY            *  DBERR 020  *CEU013
     C                     MOVEL'ZM0040'  DBPGM            * * * * * * * *CEU013
     C                     EXSR *PSSR                                     CEU013
     C                     END                                            CEU013
     C*                                                                   CEU013
     C** IF ERROR DURING PROGRAM ZM0040                                   CEU013
     C           ZERR      IFEQ '1'                                       CEU013
     C                     SETON                     U7U8LR               CEU013
     C                     MOVE '021'     DBASE            * * * * * * * *CEU013
     C                     MOVE *BLANKS   DBKEY            *  DBERR 021  *CEU013
     C                     MOVEL'ZM0040'  DBPGM            * * * * * * * *CEU013
     C                     EXSR *PSSR                                     CEU013
     C                     END                                            CEU013
     C*                                                                   CEU013
     C                     MOVELZSAMT     @OAMT                           CEU013
     C                     MOVEL'/OCMT/'  @OCMT                           CEU013
     C                     MOVEL'/'       @SLSH                           CEU013
     C                     MOVEL@SBF9     SB9                             CEU013
     C                     END                                            CEU013
     C*                                                                   CEU013
     C** EMU enhancment not present. Set up subfield 9 with               CEU013
     C** narrative.                                                       CEU013
     C                     ELSE                                           CEU013
     C*                                                                   S01310
     C*                                                                   S01427
     C/COPY WNCPYSRC,GL1300CCP5                                           S01408
     C*                                                                   S01310
     C           SPOS27    IFEQ CHEK06                                    E32329
     C           SPOSY     OREQ CHEKX6                                    E32329
     C                     MOVELMPNAR     SB9                             E32329
     C*
     C                     ELSE                                           E32329
     C           DLREF     IFNE *BLANKS                    ### B002       E32329
     C*                                                                   E32329
     C                     MOVELDBCNUM    @KEY1                           E32329
     C*                                                                   E32329
     C**   IF THIS IS A LOAN, CHECK IF IT IS A PARTICIPATION PURCHASED    E32329
     C**   WITHOUT RECOURSE - IF IT IS, THEN OUTPUT ORIGINAL BORROWER     E32329
     C**   IN PLACE OF LOAN CUSTOMER.                                     E32329
     C           LNCHK     IFEQ 'L'                                       E32329
     C                     EXSR LNCHN                                     E32329
     C           PTYP      IFEQ 64                                        E32329
     C           PTYP      OREQ 65                                        E32329
     C           RCSI      IFNE 'Y'                                       E32329
     C                     MOVELOLNO      @KEY1                           E32329
     C                     END                                            E32329
     C                     END                                            E32329
     C                     END                                            E32329
     C*                                                                   121741
     C* If Customer Number is zero then use Customer Number from          121741
     C* EODPOPD.                                                          121741
     C                     MOVEL@KEY1     WK6     6                       121741
     C********** WK6       IFEQ '000000'                                               121741 CSD027
     C           WK6       IFEQ *BLANKS                                                       CSD027
     C                     MOVELCNUM      @KEY1                           121741
     C                     ENDIF                                          121741
     C*                                                                   E32329
     C                     EXSR CLTCHN                                    E32329
     C           @RTCD     IFEQ *BLANKS                                   E32329
     C           BBDTDL    ANDEQ0                                         E32329
     C**                                                                  E32329
     C**   EXTRACT CUSTOMER REPORT NAME & REPORT TOWN                     E32329
     C                     MOVELBBCRNM    SB9                             E32329
     C                     MOVE BBCRTN    SB9                             E32329
     C                     ELSE                            ### X003       E32329
     C/COPY WNCPYSRC,GL1300C050
     C                     SETON                     U7U8LR               E32329
     C                     MOVEL'014'     DBASE            * DBERR 014 *  E32329
     C                     MOVEL'SDCUSTPD'DBFILE                          E32329
     C                     MOVELDBCNUM    DBKEY                           E32329
     C                     MOVEL@OPTN     DBOPTN                          E32329
     C                     EXSR *PSSR                                     E32329
     C                     GOTO END                                       E32329
     C/COPY WNCPYSRC,GL1300C051
     C                     END                             ### E003       E32329
     C*                                                                   E32329
     C**   DO IF DLREF IS BLANK (+ FACO IS BLANK)                         E32329
     C*                                                                   E32329
     C                     ELSE                            ### X002       E32329
     C*                                                                   E32329
     C**   DO IF SWCR IS BLANK (+DLREF AND FACO ARE BLANK)                E32329
     C                     MOVE '0'       OK      1                       E32329
     C                     Z-ADD1         Y       20                      E32329
     C*                                                                   E32329
     C           SWCR      IFEQ *BLANKS                    ### B003       E32329
     C/COPY WNCPYSRC,GL1300C028
     C*                                                                   E32329
     C           Y         DOWLE14                                        E32329
     C           OK        ANDEQ'0'                                       E32329
     C           MPNMIA,Y  IFEQ ':'                                       E32329
     C           MPNMIA,Y  OREQ '-'                                       E32329
     C           MPNMIA,Y  OREQ ' '                                       E32329
     C                     ADD  1         Y                               E32329
     C                     ELSE                                           E32329
     C                     MOVE '1'       OK                              E32329
     C                     END                                            E32329
     C                     END                                            E32329
     C*                                                                   E32329
     C           OK        IFEQ '1'                                       E32329
     C                     MOVEAMPNMIA,Y  SB9                             E32329
     C                     END                                            E32329
     C*                                                                   E32329
     C**   DO IF SWCR IS NOT BLANK (+DLREF AND FACO ARE BLANK)            E32329
     C*                                                                   E32329
     C                     ELSE                            ### X003       E32329
     C           Y         DOWLE30                                        E32329
     C           OK        ANDEQ'0'                                       E32329
     C           MPNARA,Y  IFEQ ':'                                       E32329
     C           MPNARA,Y  OREQ '-'                                       E32329
     C           MPNARA,Y  OREQ ' '                                       E32329
     C                     ADD  1         Y                               E32329
     C                     ELSE                                           E32329
     C                     MOVE '1'       OK                              E32329
     C                     END                                            E32329
     C                     END                                            E32329
     C*                                                                   E32329
     C           OK        IFEQ '1'                                       E32329
     C                     MOVEAMPNARA,Y  SB9                             E32329
     C                     END                                            E32329
     C                     END                             ### E003       E32329
     C                     END                             ### E002       E32329
     C*                                                                   E32329
     C                     END                             ### E001       E32329
     C                     END                                            CEU013
     C/COPY WNCPYSRC,GL1300C083
      *                                                                   065886
      * If W1SBF9 is not blank use it                                     065886
      *                                                                   065886
     C           W1SBF9    IFNE *BLANKS                                   065886
     C                     MOVELW1SBF9    SB9                             065886
     C                     END                                            065886
     C*                                                                   E32329
     C*                                                                   S01427
     C/COPY WNCPYSRC,GL1300CCP6                                           S01408
     C*                                                                   S01310
     C                     MOVELSB9       @MFLD                           E32329
     C/COPY WNCPYSRC,GL1300C063
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C******************   ADD  1         J                         S01310E29588
     C******************   MOVEAREST61    RMVD,J                    S01310E29588
     C*******************  END                                      S01310E29588
     C*                                                                   S01310
     C                     ENDSR                                          S01310
     C*                                                                   S01310
     C********************************************************************S01310
     C/COPY WNCPYSRC,GL1300C085
     C/EJECT                                                              S01310
     C********************************************************************S01310
     C*  OUTSR - SR                                                       S01310
     C*  SUBROUTINE TO WRITE DATA STRUCTURE TO MGOMSGPD                   S01310
     C*  CALLED BY INTSR                  CALLS -                         S01310
     C********************************************************************S01310
     C*                                                                   S01310
     C           OUTSR     BEGSR                                          S01310
     C*                                                                   S01310
     C**  Write multiple occurrence data structure to MGOMSGPD            S01310
     C*                                                                   S01310
     C                     Z-ADD1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C           M         DOWLE200                                       S01310
     C           @MFLD     ANDNE*BLANKS                                   S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C                     MOVE @MFLD     MFLD                            S01310
     C                     MOVE @CTRC     CTRC                            S01310
     C/COPY WNCPYSRC,GL1300C030
      ** Repalce first character by '?' if ':'                                                248625
     C                     MOVELMFLD      #MFLD     P                                         248625
     C           MFLD1     IFEQ ':'                                                           248625
     C                     MOVEL'?'       MFLD1                                               248625
     C                     MOVEL#MFLD     MFLD      P                                         248625
     C                     ENDIF                                                              248625
      **                                                                                      248625
     C                     WRITEMGOMSGD0                                  S01310
     C/COPY WNCPYSRC,GL1300C029
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Clear multiple occurrence data structure                        S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,GL1300C031
     C                     Z-ADD1         M       30                      S01310
     C           M         OCUR MULT                                      S01310
     C           M         DOWLE200                                       S01310
     C           @ALL      ANDNE*BLANKS                                   S01310
     C                     MOVE *BLANKS   @ALL                            S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,GL1300C032
      *                                                                   S01310
     C                     Z-ADD1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C*                                                                   S01310
     C                     ENDSR                                          S01310
     C*                                                                   S01310
     C********************************************************************S01310
     C/EJECT                                                              S01310
     C********************************************************************
     C**                                                                  LN0074
     C/SPACE 3                                                            LN0074
     C**
     C**   SUBROUTINE TO TEST WHETHER A STATEMENT IS REQUIRED
     C**   IF REQUIRED IND.40 IS SET ON
     C**
     C**   THIS SUBROUTINE IS CALLED BY THE MAIN BODY OF THE PROGRAM
     C**
     C           STEST     BEGSR                           ***  STEST  ***
     C**
     C**   RECORD I.D. IS 'C' OR '*' (31 ON)
     C   31                SETON                     40
     C   40                GOTO TSTEND
     C**
     C**
     C**   FREQUENCY = END OF PERIOD AND ACCRUALS PROFIT DATE IS NOT LESS
     C**   THAN DATE OFNEXT WORKING DAY
     C           SFREQ     COMP 'A'                      41
     C***41******DNWD      COMP APDA                 40                   S01194
     C   41      BJDNWD    COMP BKAPDT               40                   S01194
     C   40                GOTO TSTEND
     C**
     C**   TEST FOR FREQ Z
     C                     SETOF                     41
     C           SFREQ     COMP 'Z'                      45
     C**
     C**   TEST IF NEXT STATEMENT DATE LESS THAN DATE OF NEXT WORKING DAY
     C***********NSDAT     COMP DNWD                   40                 S01194
     C           NSDAT     COMP BJDNWD                 40                 S01194
     C/COPY WNCPYSRC,GL1300C019
     C*                                                                   065654
     C      40   SFREQ     IFEQ ' '                                       065654
     C           *INMR     ANDEQ*OFF                                      065654
     C                     MOVE *OFF      *IN40                           065654
     C                     END                                            065654
     C      40             GOTO TSTEND
     C*                                                                   063303
     C** If statement frequency is 'D' (Daily) create statement           063303
     C*                                                                   063303
     C           SFREQ     IFEQ 'D'                                       063303
     C/COPY WNCPYSRC,GLH00814                                                                 CGL136
     C                     SETON                     40                   063303
     C                     GOTO TSTEND                                    063303
     C                     ENDIF                                          063303
     C*                                                                   063303
     C** If statement frequency is ' ' (On Movement), suppress            063303
     C** statement if no postings (MR off)                                063303
     C*                                                                   063303
     C           SFREQ     IFEQ ' '                                       063303
     C           *INMR     ANDEQ*ON                                       063303
     C                     SETON                     40                   063303
     C                     GOTO TSTEND                                    063303
     C                     ENDIF                                          063303
     C/COPY WNCPYSRC,GL1300C012
     C**
     C**   DEMAND STATEMENT INDICATOR = 'Y'
     C           DEST      COMP 'Y'                      40
     C***40*****           SETON                     47                                       CSW022
     C   40N45             SETON                     44
     C/COPY WNCPYSRC,GL1300C077
     C           TSTEND    TAG                             ** TSTEND TAG *
      *                                                                                       CSW022
     C           *IN31     IFEQ *OFF                                                          CSW022
     C           *IN40     ANDEQ*ON                                                           CSW022
     C           *IN44     ANDEQ*OFF                                                          CSW022
     C                     MOVE *ON       *IN47                                               CSW022
     C                     ENDIF                                                              CSW022
      *                                                                                       CSW022
     C/COPY WNCPYSRC,GL1300C078
     C**
     C                     ENDSR
     C/COPY WNCPYSRC,GL1300C079
     C**
     C********************************************************************
     C********************************************************************
     C*
     C***  SWAMFM SR TO CONVERT AMOUNTS TO OUTPUT FORMAT FOR SWIFT
     C**   THIS SUBROUTINE IS CALLED BY THE MAIN BODY OF THE PROCEDURE.
     C*****IT*CALLS*THE SUBROUTINE TABCHN.                                S01194
     C*
     C           SWAMFM    BEGSR                           ** SWAMFM SR **
     C*
     C                     SETOF                     909192
     C                     SETOF                     93
     C/COPY WNCPYSRC,GL1300C105
     C                     Z-ADDZSAMTI    ZSAMTI 150
     C/COPY WNCPYSRC,GL1300C106
     C                     MOVE ZSACCY    ZSACCY  3
     C/COPY WNCPYSRC,GL1300C107
     C                     MOVE BLNK15    ZSAMTO 15
     C/COPY WNCPYSRC,GL1300C108
     C                     MOVE BLNK14    HOLD14
     C*
     C*****DETERMINE NO. OF DECIMAL PLACES FROM CCY RECORDS-S/TABLE,TG    S01194
     C***********                                                         S01194
     C***********          MOVELZSACCY    HOLD4   4                       S01194
     C***********          MOVE '1'       HOLD4                           S01194
     C***********          MOVE HOLD4     ZTABKY 12                       S01194
     C***********          MOVEL'20      'ZTABKY                          S01194
     C***********          EXSR TABCHN                                    S01194
     C***********                                                         S01194
     C*****CHAIN*FAIL                                                     S01194
     C***99******          SETON                     U7U8LR               S01194
     C***99******          Z-ADD9         DBASE            * DB ERROR  9 *S01194
     C***99******          MOVELZTABKY    DBKEY                           S01194
     C***99******          MOVEL'TABMS'   DBFILE                          S01194
     C***99******          GOTO ENDAM                                     S01194
     C           CSW020    IFNE 'Y'                                       CSW020
     C**                                                                  S01194
     C**   DETERMINE NO. OF DECIMAL PLACES VIA CURRENCY CODES             S01194
     C                     MOVE *BLANKS   @AJCD                           S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM ZSACCY    @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'009'     DBASE            * DBERR 009 *  S01194
     C                     MOVEL'SDCURRPD'DBFILE                          S01194
     C                     MOVELZSACCY    DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDAM                                     S01194
     C                     END                                            S01194
     C*
     C***  NO. OF DECIMAL PLACES
     C*
     C***********CDP       COMP 1                      9091               S01194
     C***********CDP       COMP 2                    93  92               S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP25                                           S01408
     C*                                                                   S01408
     C           A6NBDP    COMP 1                      9091               S01194
     C           A6NBDP    COMP 2                    93  92               S01194
     C*
     C***  MOVE AMOUNT INTO A 15A FIELD INCLUDING DECIMAL COMMA
     C*
     C/COPY WNCPYSRC,GL1300C109
     C                     MOVE ZSAMTI    HOLD14 14
     C   90                MOVELHOLD14    ZAAL   15        NO DECIMAL PLAC
     C/COPY WNCPYSRC,GL1300C110
     C   90                MOVE ','       ZAAL
     C*
     C   91                MOVE HOLD14    HOLD01  1        ONE DECIMAL
     C   91                MOVE ','       HOLD14           PLACE
     C/COPY WNCPYSRC,GL1300C111
     C   91                MOVELHOLD14    ZAAL   15
     C/COPY WNCPYSRC,GL1300C112
     C   91                MOVE HOLD01    ZAAL
     C/COPY WNCPYSRC,GL1300C113
     C*
     C   92                MOVELHOLD14    HOLD12 12        TWO DECIMAL
     C/COPY WNCPYSRC,GL1300C114
     C   92                MOVE HOLD14    HOLD02  2        PLACES
     C   92                MOVE HOLD02    HOLD03  3
     C   92                MOVEL','       HOLD03
     C/COPY WNCPYSRC,GL1300C115
     C   92                MOVELHOLD12    ZAAL   15
     C/COPY WNCPYSRC,GL1300C116
     C   92                MOVE HOLD03    ZAAL
     C*
     C/COPY WNCPYSRC,GL1300C117
     C   93                MOVELHOLD14    HOLD11 11        THREE DECIMAL
     C/COPY WNCPYSRC,GL1300C118
     C   93                MOVE HOLD14    HOLD03  3        PLACES
     C   93                MOVE HOLD03    HOLD04  4
     C   93                MOVEL','       HOLD04
     C/COPY WNCPYSRC,GL1300C119
     C   93                MOVELHOLD11    ZAAL   15
     C/COPY WNCPYSRC,GL1300C120
     C   93                MOVE HOLD04    ZAAL
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C/COPY WNCPYSRC,GL1300C094
     C** CALL ZM0040 TO CONVERT AMOUNT INTO SWIFT FORMAT.                 CSW020
     C*                                                                   CSW020
     C                     Z-ADDZSAMTI    ZAMT                            CSW020
     C                     CALL 'ZM0040'               28                 CSW020
     C                     PARM           ZAMT                            CSW020
     C                     PARM ZSACCY    ZCCY                            CSW020
     C                     PARM *BLANKS   ZSAMT                           CSW020
     C                     PARM *BLANKS   ZSCCY                           CSW020
     C                     PARM *BLANKS   ZERR                            CSW020
     C*                                                                   CSW020
     C** IF PROGRAM NOT FOUND                                             CSW020
     C           *IN28     IFEQ '1'                                       CSW020
     C                     SETON                     U7U8LR               CSW020
     C                     MOVE '023'     DBASE            * * * * * * * *CSW020
     C                     MOVE *BLANKS   DBKEY            *  DBERR 023  *CSW020
     C                     MOVEL'ZM0040'  DBPGM            * * * * * * * *CSW020
     C                     EXSR *PSSR                                     CSW020
     C                     END                                            CSW020
     C*                                                                   CSW020
     C** IF ERROR DURING PROGRAM ZM0040                                   CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     SETON                     U7U8LR               CSW020
     C                     MOVE '024'     DBASE            * * * * * * * *CSW020
     C                     MOVE *BLANKS   DBKEY            *  DBERR 024  *CSW020
     C                     MOVEL'ZM0040'  DBPGM            * * * * * * * *CSW020
     C                     EXSR *PSSR                                     CSW020
     C                     END                                            CSW020
     C*                                                                   CSW020
     C                     MOVEAZSAMT     ZAA                             CSW020
     C                     MOVELZSCCY     A6SWCY                          CSW020
     C                     END                                            CSW020
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP26                                           S01408
     C*                                                                   S01408
     C*
     C***  DELETE LEADING ZEROS
     C*
     C           CSW020    IFNE 'Y'                                       CSW020
     C                     MOVEAZAAL      ZAA
     C                     END                                            CSW020
     C                     Z-ADD1         ZA      20
     C           AGAIN     TAG                             ** AGAIN TAG **
     C           ZAA,ZA    COMP '0'                      90
     C  N90      ZAA,ZA    COMP ' '                      90
     C  N90      ZAA,ZA    COMP ','                      91
     C   90                MOVE ' '       ZAA,ZA
     C   90      ZA        ADD  1         ZA
     C/COPY WNCPYSRC,GL1300C121
     C   90      ZA        COMP 16                     9091
     C/COPY WNCPYSRC,GL1300C122
     C   90                GOTO AGAIN
     C   91      ZA        SUB  1         ZA
     C   91                MOVEA'0'       ZAA,ZA
     C*
     C***  MOVE INTO A 15 DIGIT ALPHAMERIC FIELD (LEFT ADJUSTED FROM
     C*    THE FIRST SIGNIFICANT DIGIT)
     C/COPY WNCPYSRC,GL1300C123
     C                     MOVEAZAA,ZA    ZSAMTO 15
     C                     Z-ADD0         ZSAMTI 150
     C/COPY WNCPYSRC,GL1300C124
     C*
     C           ENDAM     ENDSR                           * ENDAM ENDSR *
     C*
     C********************************************************************S01194
     C********************************************************************S01194
     C***********                                                         S01194
     C*****TABCHN SR. TO RANDOM ACCESS TABLE FILE.                        S01194
     C***********                                                         S01194
     C*****THIS*SUBROUTINE IS CALLED BY THE MAIN BODY OF THE PROGRAM AND  S01194
     C*****BY*THE SUBROUTINE SWAMFM                                       S01194
     C***********                                                         S01194
     C***********TABCHN    BEGSR                           *** TABCHN *** S01194
     C***********                                                         S01194
     C*****RESET*INDICATORS.                                              S01194
     C***********                                                         S01194
     C***********          SETOF                     99                   S01194
     C***********                                                         S01194
     C*****RANDOM ACCESS TABLE FILE BY KEY.                               S01194
     C***********ZTABKY    CHAINTABMS                99    ON NOT THERE   S01194
     C**N99******RECI      COMP 'D'                  9999  ON IF INACTIVE S01194
     C***********                                                         S01194
     C***********          ENDSR                                          S01194
     C***********                                                         S01194
     C********************************************************************S01194
     C********************************************************************S05452
     C**                                                                  S05452
     C*****CLTCHN*SR. TO RANDOM ACCESS TABLE FILE.                  S05452S01194
     C**   CLTCHN SR. TO ACCESS CUSTOMER DETAILS                          S01194
     C**                                                                  S05452
     C**   THIS SUBROUTINE IS CALLED BY THE MAIN BODY OF THE PROGRAM      S05452
     C**                                                                  S05452
     C           CLTCHN    BEGSR                           *** TABCHN *** S05452
     C**                                                                  S05452
     C***********          MOVE 'A'       CLKEY                           S05452
     C***********                                                         S05452
     C***********CLKEY     CHAINCLINT                99    ON NOT THERE   S05452
     C***********                                                         S05452
     C************IN99     IFEQ '0'                                       S05452
     C***********RECI      COMP 'D'                  9999  ON IF INACTIVE S05452
     C***********          END                                            S05452
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C                     PARM           @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C**                                                                  S05452
     C                     ENDSR                                          S05452
     C**                                                                  S05452
     C********************************************************************S05452
     C********************************************************************E32329
     C*                                                                   E32329
     C**   LNCHN SR.  TO ACCESS LOAN DETAILS                              E32329
     C*                                                                   E32329
     C           LNCHN     BEGSR                                          E32329
     C*                                                                   E32329
     C                     MOVE *BLANKS   PTYP                            E32329
     C                     MOVE *BLANKS   RCSI                            E32329
     C                     MOVELLNNO      CLNNO                           E32329
     C                     MOVEL'A'       CLNCD                           E32329
     C           CLNKEY    CHAINCLOAN                75                   E32329
     C*                                                                   E32329
     C                     ENDSR                                          E32329
     C*                                                                   E32329
     C********************************************************************E32329
     C********************************************************************S01194
     C*************                                               S01194  LN0012
     C*****ACALTN*SR.*TO ACCESS ALTERNATE NAME & ADDRESS          S01194  LN0012
     C*************                                               S01194  LN0012
     C********** ACALTN    BEGSR                                  S01194  LN0012
     C**********           MOVE 'B'       W@AZCD  1               S01194  LN0012
     C**********           CALL 'AOALTNR0'                        S01194  LN0012
     C**********           PARM *BLANKS   @RTCD   7               S01194  LN0012
     C**********           PARM '*KEY   ' @OPTN   7               S01194  LN0012
     C**********           PARM           @AENB   6               S01194  LN0012
     C**********           PARM W@AZCD    @AZCD   1               S01194  LN0012
     C********** SDALTN    PARM SDALTN    DSFDY                   S01194  LN0012
     C********** @RTCD     IFNE *BLANKS                           S01194  LN0012
     C**********           SETON                     U7U8LR       S01194  LN0012
     C**********           MOVEL'016'     DBASE            * DBERRS01194  LN0012
     C**********           MOVEL'SDALTNPD'DBFILE                  S01194  LN0012
     C**********           MOVELA8BICN    W@ALKY  7               S01194  LN0012
     C**********           MOVE W@AZCD    W@ALKY                  S01194  LN0012
     C**********           MOVELW@ALKY    DBKEY                   S01194  LN0012
     C**********           MOVEL@OPTN     DBOPTN  7               S01194  LN0012
     C**********           EXSR *PSSR                             S01194  LN0012
     C**********           END                                    S01194  LN0012
     C**********           ENDSR                                  S01194  LN0012
     C**                                                                  S01194
     C********************************************************************S01194
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C**
     C**
     C********************************************************************
     C********************************************************************
     C**
     C**   ZDATES SR. TO CONVERT A DAY NUMBER TO SWIFT DATE FORMAT YYMMDD
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATES    BEGSR                           *** ZDATES ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZSEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZSTAG1    TAG                             ** ZSTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZSTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZSTAG2    TAG                             ** ZSTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZSTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE YYMMDD
     C*
     C                     MOVE ZDAY      ZWRK4   40
     C                     MOVELZMTH      ZWRK4
     C                     MOVE ZWRK4     ZDATE
     C                     MOVELZYEAR     ZDATE
     C**
     C**
     C           ZSEND2    ENDSR                           * ZSEND2 ENDSR*
     C**
     C**
     C********************************************************************
     C********************************************************************S01195
     C**************                                                      S01195
     C*****ZFREQB-SR. TO INCREMENT A DAY NUMBER DATE BY A                 S01195
     C************** PERIOD VALUE DETERMINED BY A CODE.                   S01195
     C**************                                                      S01195
     C***********ZFREQB    BEGSR                           *** ZFREQB *** S01195
     C**************                                                      S01195
     C****IF*SINGLE*BRANCH OR THE ACCOUNT CURRENCY EQUAL LOCAL CURRENCY,  S01195
     C****MOVE*THE*SYSTEM LOCATION TO THE ZLOC FIELD,                     S01195
     C****ELSE*MOVE*THE BRANCH LOCATION TO THE ZLOC FIELD.                S01195
     C*************                                                       S01195
     C***********MBIN      IFEQ 'N'                                       S01195
     C***********ZCCY      OREQ BJLCCY                                    S01195
     C************         MOVE BJSLCD    ZLOC    3                       S01195
     C************         ELSE                                           S01195
     C************                                                        S01195
     C****ACCESS*THE BRANCH CODE DETAILS FOR THE BRANCH LOCATION CODE     S01195
     C****IF*NECESSARY                                                    S01195
     C***********                                                         S01195
     C***********SBRCA     IFNE A8BRCD                                    S01195
     C************         CALL 'AOBRCHR0'                                S01195
     C************         PARM '*MSG   ' @RTCD   7                       S01195
     C************         PARM '*KEY   ' @OPTN   7                       S01195
     C************         PARM SBRCA     @DSNB   3                       S01195
     C***********SDBRCH    PARM SDBRCH    DSFDY                     S01194S01195
     C***********@RTCD     IFNE *BLANK                                    S01195
     C************         SETON                     U7U8LR               S01195
     C************         MOVEL'SDBRCHPD'DBFILE                          S01195
     C************         MOVEL@DSNB     DBKEY                           S01195
     C************         MOVEL@OPTN     DBOPTN  7                       S01195
     C************         MOVEL'017'     DBASE            * DBERR 017 *  S01195
     C************         EXSR *PSSR                                     S01195
     C************         GOTO ZFEND                                     S01195
     C************         END                                            S01195
     C************         END                                            S01195
     C************         MOVE A8LCCD    ZLOC                            S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************                                                        S01195
     C*****CALCULATIONS TO DEFINE/CLEAR FIELDS.                           S01195
     C************         MOVE ZFREQ     ZFREQ   1                       S01195
     C************         Z-ADDZDAYNO    ZDAYNO  50                      S01195
     C************         Z-ADDZMDAY     ZMDAY   20                      S01195
     C************         MOVE ZCCY      ZCCY    3                       S01195
     C************                                                        S01195
     C************         MOVE '   '     ZHC                             S01195
     C************         MOVE ' '       ZTABKY 12                       S01195
     C************                                                        S01195
     C************ FIELDS USED FOR PERIOD CODES M,T,Q,X,Y                 S01195
     C************                                                        S01195
     C************         MOVE '  '      ZINDE   2                       S01195
     C************         Z-ADD0         ZINTO   20                      S01195
     C************                                                        S01195
     C*****CONVERT DAY NUMBER TO DATE.                                    S01195
     C************         EXSR ZDATE2                                    S01195
     C************         SETOF                     90                   S01195
     C************                                                        S01195
     C*****CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.          S01195
     C************FREQ     COMP 'D'                      91               S01195
     C***91******ZDAYNO    ADD  1         ZDAYNO                          S01195
     C***91******          GOTO ZFHCHK                                    S01195
     C************                                                        S01195
     C*****CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.                     S01195
     C************FREQ     COMP 'W'                      91               S01195
     C***91******ZDAYNO    ADD  7         ZDAYNO                          S01195
     C***91******          GOTO ZFEND                                     S01195
     C************                                                        S01195
     C*****CHECK*FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.                S01195
     C************FREQ     COMP 'F'                      91               S01195
     C***91***** ZDAYNO    ADD  14        ZDAYNO                          S01195
     C***91*****           GOTO ZFEND                                     S01195
     C************                                                        S01195
     C*****CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.               S01195
     C************FREQ     COMP 'S'                      91               S01195
     C***91***** ZDAY      COMP 15                   939292               S01195
     C***91*92**           Z-ADD31        ZDAY                            S01195
     C***91*93**           Z-ADD15        ZDAY                            S01195
     C***91*93** ZMTH      ADD  1         ZMTH                            S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C************                                                        S01195
     C*****CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.                    S01195
     C************FREQ     COMP 'M'                      91               S01195
     C***91*****           MOVE 'IN'      ZINDE                           S01195
     C***91*****           Z-ADDZMDAY     ZDAY                            S01195
     C***91***** ZMTH      ADD  1         ZMTH                            S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C************                                                        S01195
     C*****CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTHS01195
     C************FREQ     COMP 'R'                      91               S01195
     C***91*****           Z-ADD31        ZDAY                            S01195
     C***91***** ZMTH      ADD  1         ZMTH                            S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C**********                                                          S01195
     C*****CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.                  S01195
     C************FREQ     COMP 'T'                      91               S01195
     C***91****            MOVE 'IN'      ZINDE                           S01195
     C***91****            Z-ADDZMDAY     ZDAY                            S01195
     C***91****  ZMTH      ADD  2         ZMTH                            S01195
     C***91****            GOTO ZFDATE                                    S01195
     C*********                                                           S01195
     C*****CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.                  S01195
     C*********  ZFREQ     COMP 'Q'                      91               S01195
     C***91****            MOVE 'IN'      ZINDE                           S01195
     C***91*****           Z-ADDZMDAY     ZDAY                            S01195
     C***91***** ZMTH      ADD  3         ZMTH                            S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C**********                                                          S01195
     C*****CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.                S01195
     C********** ZFREQ     COMP 'X'                      91               S01195
     C***91*****           MOVE 'IN'      ZINDE                           S01195
     C***91*****           Z-ADDZMDAY     ZDAY                            S01195
     C***91***** ZMTH      ADD  6         ZMTH                            S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C**********                                                          S01195
     C*****CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.                     S01195
     C********** ZFREQ     COMP 'Y'                      91               S01195
     C***91*****           MOVE 'IN'      ZINDE                           S01195
     C***91*****           Z-ADDZMDAY     ZDAY                            S01195
     C***91***** ZYEAR     ADD  1         ZYEAR                           S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C*********                                                           S01195
     C*****CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH. S01195
     C********** ZFREQ     COMP 'L'                      91               S01195
     C***91*****           Z-ADD31        ZDAY                            S01195
     C***91***** ZMTH      ADD  1         ZMTH                            S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C**********                                                          S01195
     C*****CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.  S01195
     C********** ZFREQ     COMP 'B'                      91               S01195
     C***91*****           Z-ADD31        ZDAY                            S01195
     C***91***** ZMTH      ADD  1         ZMTH                            S01195
     C***91*****           GOTO ZFDATE                                    S01195
     C**********                                                          S01195
     C*****CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.S01195
     C********** ZFREQ     COMP 'A'                      91               S01195
     C***91******          MOVEL'01    '  ZTABKY                    S01194S01195
     C***91******          MOVE '    11'  ZTABKY                    S01194S01195
     C***91******ZTABKY    CHAINTABMS                99 ON NOT THERES01194S01195
     C**N99******RECI      COMP '*'                      99         S01194S01195
     C***91N99****         Z-ADDAPDA      ZDAYNO                    S01194S01195
     C************                                                  S01194S01195
     C****ACCESS*GENERAL LEDGER DETAILS                             S01194S01195
     C********** *IN91     IFEQ '1'                                 S01194S01195
     C**********           CALL 'AOGELRR0'                          S01194S01195
     C**********           PARM '*MSG   ' @RTCD   7                 S01194S01195
     C**********           PARM '*FIRST ' @OPTN   7                 S01194S01195
     C********** SDGELR    PARM SDGELR    DSFDY                     S01194S01195
     C********** @RTCD     IFEQ *BLANKS                             S01194S01195
     C**********           Z-ADDBKAPDT    ZDAYNO                    S01194S01195
     C**********           ELSE                                     S01194S01195
     C**********           SETON                     99             S01194S01195
     C**********           END                                      S01194S01195
     C**********           END                                      S01194S01195
     C**********                                                          S01195
     C*****BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE                      S01195
     C**********           GOTO ZFEND                                     S01195
     C**********                                                          S01195
     C**********                                                          S01195
     C*****REFORMAT DATE AND ENSURE VALID.                                S01195
     C********** ZFDATE    TAG                             ** ZFDATE TAG* S01195
     C**********                                                          S01195
     C*****VALIDATE MONTH.                                                S01195
     C********** ZMTH      COMP 12                   91                   S01195
     C***91***** ZMTH      SUB  12        ZMTH                            S01195
     C***91***** ZYEAR     ADD  1         ZYEAR                           S01195
     C***********                                                         S01195
     C*****CHECK FOR LEAP YEAR.                                           S01195
     C********** ZYEAR     DIV  4         ZLYR    20                      S01195
     C**********           MVR            ZLY     10     92LEAP YEAR-92 ONS01195
     C**********                                                          S01195
     C*****VALIDATE DAY NUMBER.                                           S01195
     C************         MOVE ZFMD,ZMTH ZWRK2   20                      S01195
     C***********ZMTH      COMP 2                        93               S01195
     C***92*93***          Z-ADD29        ZWRK2                           S01195
     C***********                                                         S01195
     C***********ZDAY      COMP ZWRK2                94                   S01195
     C***94******          Z-ADDZWRK2     ZDAY                            S01195
     C***********                                                         S01195
     C*****CHECK*IF CODE R, TO SUBTRACT 6 DAYS.                           S01195
     C***********ZFREQ     COMP 'R'                      91               S01195
     C***91***** ZDAY      SUB  6         ZDAY                            S01195
     C***********                                                         S01195
     C*****REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.    S01195
     C********** *LIKE     DEFN ZMTH      W@ZMTH                          S01195
     C**********           MOVE ZMTH      W@ZMTH                          S01195
     C************LIKE     DEFN ZYEAR     W@ZYR                           S01195
     C************         MOVE ZYEAR     W@ZYR                           S01195
     C************         MOVELZDAY      ZWRK4   40                      S01195
     C************         MOVE ZMTH      ZWRK4                           S01195
     C***98*******         MOVELZMTH      ZWRK4                           S01195
     C***98*******         MOVE ZDAY      ZWRK4                           S01195
     C************         MOVELZWRK4     ZDATE                           S01195
     C************         MOVE ZYEAR     ZDATE                           S01195
     C************         EXSR ZDATE1                                    S01195
     C********** *LIKE     DEFN ZDAYNO    W@ZDAY                          S01195
     C************         Z-ADDZDAYNO    W@ZDAY                          S01195
     C************                                                        S01195
     C*****CHECK IF CODE B, OR M,T,Q,X,Y TO BE CHECKED FOR HOLIDAY.       S01195
     C***********ZFREQ     COMP 'B'                      91               S01195
     C***********ZINDE     COMP 'IN'                     92               S01195
     C***92N99***                                                         S01195
     C*OR*91N99**           GOTO ZFHCHK                                   S01195
     C************                                                        S01195
     C************         GOTO ZFEND                                     S01195
     C************                                                        S01195
     C*****CHECK IF DAY NUMBER IS A HOLIDAY.                              S01195
     C************                                                        S01195
     C***********ZFHCHK    TAG                             ** ZFHCHK TAG *S01195
     C************                                                        S01195
     C***********ZFREQ     IFNE 'B'                        *B1            S01195
     C************         Z-ADD0         ZNRDYS                          S01195
     C************         EXSR ZFWDT                                     S01195
     C************         Z-ADDZDYNBR    ZDAYNO                          S01195
     C************         EXSR ZDATE2                                    S01195
     C***********ZFREQ     IFEQ 'D'                        *B2            S01195
     C***********ZMTH      OREQ W@ZMTH                                    S01195
     C***********ZYEAR     ANDEQW@ZYR                                     S01195
     C************         GOTO ZFEND                                     S01195
     C************         END                             *E2            S01195
     C************         END                             *E1            S01195
     C************                                                        S01195
     C************         Z-ADDW@ZDAY    ZDAYNO                          S01195
     C************         Z-ADD0         ZNRDYS                          S01195
     C************         EXSR ZBKDT                                     S01195
     C************         Z-ADDZDYNBR    ZDAYNO                          S01195
     C************         GOTO ZFEND                                     S01195
     C***********          SETOF                     94                   S01195
     C***********ZFREQ     COMP 'D'                      91               S01195
     C***********ZFREQ     COMP 'B'                      92               S01195
     C***91******                                                         S01195
     C*R*92******          GOTO ZSETK                                     S01195
     C***********                                                         S01195
     C****FOR*CODES M,T,Q,X,Y, CHECK ZINDE - 'IN' TO INCREMENT,           S01195
     C***********                          - 'DE' TO DECREMENT            S01195
     C***********                                                         S01195
     C***********ZINDE     COMP 'IN'                     90               S01195
     C***********ZINDE     COMP 'IN'                     91               S01195
     C***********ZINDE     COMP 'DE'                     92               S01195
     C***********                                                         S01195
     C*****SET*KEY FOR FIRST HOLIDAY RECORD.                              S01195
     C***********ZSETK     TAG                             ** ZSETK TAG **S01195
     C***********          MOVEL'22    '  ZTABKY                          S01195
     C***********          MOVELZDAYNO    ZWRK6   6                       S01195
     C***********          MOVE 1         ZWRK6                           S01195
     C***********          MOVE ZWRK6     ZTABKY                          S01195
     C***********                                                         S01195
     C*****GET*HOLIDAY RECORD.                                            S01195
     C***********ZFHCHN    TAG                             ** ZFHCHN TAG* S01195
     C***********ZTABKY    CHAINTABMS                93    ON NOT THERE   S01195
     C**N93******RECI      COMP '*'                      93               S01195
     C**N94******          MOVE '   '     ZHC                             S01195
     C***********                                                         S01195
     C*****STORE*CURRENCIES IF RECORD FOUND.                              S01195
     C**N94N93***          MOVEAHCCY      ZHC,1                           S01195
     C***94N93***          MOVEAHCCY      ZHC,26                          S01195
     C***********                                                         S01195
     C*****GET*SECOND RECORD, IF NOT ALREADY DONE.                        S01195
     C***********          MOVE ZTABKY    ZWRK1N  10                      S01195
     C***********ZWRK1N    COMP 1                        94               S01195
     C***********          MOVE '2'       ZTABKY                          S01195
     C***94N93***          GOTO ZFHCHN                                    S01195
     C***********                                                         S01195
     C*****BYPASS TO END IF NO FIRST RECORD FOUND.                        S01195
     C***93*94***          GOTO ZFEND                                     S01195
     C***********                                                         S01195
     C*****DETERMINE HOLIDAY RECORD TYPE.                                 S01195
     C***********INEX      COMP 'E'                      95               S01195
     C***********INEX      COMP 'I'                      96               S01195
     C***********                                                         S01195
     C*****CHECK*IF CURRENCY ON HOLIDAY.                                  S01195
     C***********ZCCY      LOKUPZHC                      97               S01195
     C***********                                                         S01195
     C*****BYPASS IF NOT HOLIDAY FOR CURRENCY.                            S01195
     C***95*97***                                          EXCLUDE FOUND  S01195
     C*R*96N97***          GOTO ZFEND                      INCL. NOT FOUNDS01195
     C***********                                                         S01195
     C***********                                                         S01195
     C***92******          GOTO ZDECR                                     S01195
     C***********                                                         S01195
     C*****INCREMENT OR DECREMENT DAY NUMBER AS REQUIRED.                 S01195
     C***91******ZDAYNO    ADD  1         ZDAYNO                          S01195
     C***********                                                         S01195
     C*****ONLY*FOR PERIOD CODE = M,T,Q,X OR Y, IF INCREMENTATION         S01195
     C*****TAKES*THE OUTPUT DATE INTO THE FOLLOWING MONTH, RETURN TO      S01195
     C*****THE*INPUT DATE AND DECREMENT - 92 ON.                          S01195
     C***********                                                         S01195
     C***90*91***ZINTO     ADD  1         ZINTO                           S01195
     C***90*91***ZINTO     ADD  ZDAY      ZINTOT  20                      S01195
     C***90*91***          MOVE ZINTOT    ZINTOA  2                       S01195
     C**TO*ALLOW*29 FEB ON LEAP YEARS TO PASS                             S01195
     C***********          SETOF                     93                   S01195
     C***90*91***ZYEAR     DIV  4         ZLYR                            S01195
     C***90*91***          MVR            ZLY            92               S01195
     C***90*91*92ZMTH      COMP 2                        93               S01195
     C***93******ZINTOA    COMP '29'                 92                   S01195
     C***90*91N93ZINTOA    COMP ZFMD,ZMTH            92                   S01195
     C***90*91*92ZDAYNO    SUB  ZINTO     ZDAYNO                          S01195
     C***90*91*92          MOVE 'DE'      ZINDE                           S01195
     C***********                                                         S01195
     C***********ZDECR     TAG                             ** ZDECR TAG **S01195
     C***92*95N97                                          EXCL. NOT FOUNDS01195
     C*R*92*96*97ZDAYNO    SUB  1         ZDAYNO           INCLUDE FOUND  S01195
     C***********          GOTO ZFHCHK                                    S01195
     C***********                                                         S01195
     C**********                                                          S01195
     C********** ZFEND     ENDSR                           * ZFEND ENDSR *S01195
     C***********                                                         S01195
     C********************************************************************S01195
     C********************************************************************
     C**
     C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
     C**              CONVERT TO A NUMBER OF DAYS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE1    BEGSR                           *** ZDATE1 ***
     C**
     C**   CLEAR DAY NUMBER.
     C                     Z-ADD0         ZDAYNO  50
     C**
     C**   CALCULATION TO DEFINE INPUT DATE FIELD.
     C                     Z-ADDZDATE     ZDATE   60
     C**
     C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
     C                     MOVE ZDATE     ZYEAR   20
     C  N98                MOVELZDATE     ZDAY    20
     C   98                MOVELZDATE     ZMTH    20
     C                     MOVE ZDATE     ZWRK4   40
     C  N98                MOVELZWRK4     ZMTH
     C   98                MOVELZWRK4     ZDAY
     C**
     C**   ENSURE MONTH IS VALID.
     C           ZMTH      COMP 0                      9999
     C  N99      ZMTH      COMP 12                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR 30 DAY MONTHS.
     C           ZMTH      COMP 4                        90IF 90 ON, 30
     C  N90      ZMTH      COMP 6                        90DAY MONTH.
     C  N90      ZMTH      COMP 9                        90
     C  N90      ZMTH      COMP 11                       90
     C**
     C**   ENSURE DAY IS VALID.
     C           ZDAY      COMP 0                      9999
     C   90N99   ZDAY      COMP 30                   99
     C  N90N99   ZDAY      COMP 31                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR LEAP YEAR AND FEBRUARY.
     C           ZYEAR     ADD  28        ZYEAR
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     91LEAP YR, 91 ON
     C           ZMTH      COMP 2                    93  92FEB., 92 ON
     C**                                                   PAST FEB, 93 ON
     C**   IF FEBUARY FURTHER VALIDATE DAY.
     C  N91 92   ZDAY      COMP 28                   99
     C   91 92   ZDAY      COMP 29                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
     C**
     C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
     C**
     C**
     C********************************************************************
     C********************************************************************S01194
     C***********                                                         S01194
     C*****ZSYSTM*SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
     C***********                                                         S01194
     C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
     C***********                                                         S01194
     C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
     C***********          MOVEL'01      'ZTABKY 12                       S01194
     C***********          MOVE '  10'    ZTABKY                          S01194
     C***********                                                         S01194
     C***********ZTABKY    CHAINTABMS                99    ON NOT THERE   S01194
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C***********                                                         S01194
     C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C***********                                                         S01194
     C***********          ENDSR                                          S01194
     C***********                                                         S01194
     C***********                                                         S01194
     C********************************************************************S01194
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRWTCH - Watch Processing                                    *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRWTCH    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Check if message is for automatic release.                                           CSD015
      ** If yes, default to CRTD status and set Automatic Release Flag to 'Y'                 CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       PARLS   1                                           CSD015
     C           MGST      IFEQ 'RSND'                                                        CSD015
     C           NWRK      IFEQ 'SWIFT '                                                      CSD015
     C           NWRK      OREQ 'TELEX '                                                      CSD015
     C           NWRK      OREQ 'STTX  '                                                      CSD015
     C                     MOVE 'CRTD'    MGST                                                CSD015
     C                     MOVE '1'       MGSG                                                CSD015
     C                     MOVE 'Y'       PARLS                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Setup parameters for Compliance engine program                                       CSD015
      *                                                                                       CSD015
     C                     CLEARWLTDS                                                         CSD015
     C                     Z-ADD*ZERO     W4VDAT                                              CSD015
     C                     Z-ADD*ZERO     W4MDAT                                              CSD015
     C                     Z-ADD*ZERO     W4AMT1                                              CSD015
     C                     Z-ADD*ZERO     W4AMT2                                              CSD015
      *                                                                                       CSD015
     C                     MOVELTRNO      W4IDEN                                              CSD015
     C                     MOVELMTPY      W4ITEM                                              CSD015
     C                     MOVELBRCA      W4BRCH                                              CSD015
     C                     MOVEL'MGOREF'  W4FUNT                                              CSD015
     C                     MOVELDECN      W4CNUM                                              CSD015
     C                     Z-ADDRUND      W4DDAT                                              CSD015
     C                     MOVELPARLS     W4ARLS                                              CSD015
      *                                                                                       CSD015
      ** Send transaction to compliance engine program                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           WLTDS                                               CSD015
     C                     PARM *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
     C           EWATCH    ENDSR                                                              CSD015
      *****************************************************************                       CSD015
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZACCH  --- SUBROUTINE TO ACCESS A HOLIDAY RECORD FOR A            S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: ZFWDT, ZBKDT                                         S01195
     C*                                                                   S01195
     C* CALLS: NOTHING                                                    S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZFWDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            FORWARD FROM A GIVEN START DATE FOR ANY                S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: ZFREQS                                               S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZBKDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            BACKWARD FROM A GIVEN START DATE FOR ANY               S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: ZFREQS                                               S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/EJECT                                                              S01194
0639 C********************************************************************S01194
     C********************************************************************S01195
     C/COPY ZSRSRC,ZFREQBZ2                                               S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZCHKH                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01408
     C/COPY OFCPYSRCZ,CGL136_005                                                              CGL136
     C/COPY WNCPYSRC,GL1300CP11                                           S01408
     C*                                                                   S01408
     C********************************************************************S01408
     C**                                                                  S01194
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01194
     C**                                                                  S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C**                                                                  S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL1300CP23                                           S01408
     C*                                                                   S01408
     C********************************************************************S01194
     O**
     O*
     O**
     O*****SWIFT*MESSAGES*FILE*-*INTERMEDIATE**CLOSING*BALANCE*********   S01310
     O*MSMSOPF*E*       81                                                S01310
     O***********                         5 ':62M:'                       S01310
     O***********            42           6 'C'                           S01310
     O***********           N42           6 'D'                           S01310
     O***********              RUNDAT    12                               S01310
     O***********              CCYS      15                               S01194
     O***********              A6SWCY    15                         S01194S01310
     O***********              BALF      30                               S01310
     O***********         81   MBAL      30                               S01310
     O***********              CR        31                               S01310
     O***********              LF        32                               S01310
     O***********                        64 '-'                           S01310
     O***********              ETX       65                               S01310
     O***********                       257 'S'                           S01310
     O***********              RUNDAT   263                               S01310
     O***********              PRVCNT   267                               S01310
     O*****SWIFT*MESSAGES*FILE*-*HEADER*RECORD**(81*-*INTERMEDIATE)****   S01310
     O**
     O*MSMSOPF*E*       69                                                S01310
     O*******OR**      81                                                 S01310
     O***********              SOH        1                               S01310
     O***********              CR         2                               S01310
     O***********              LF         3                               S01310
     O***********              OURSA     15                               S01310
     O*******                            21 ' 00000'                      E13826
     O***********                        21 ' 00001'                E13826S01310
     O***********              CR        22                               S01310
     O***********              LF        23                               S01310
     O***********                        29 '950 02'                      S01310
     O***********              CR        30                               S01310
     O***********              LF        31                               S01310
     O***********              WCSID     43                               S01310
     O***********              CR        44                               S01310
     O***********              LF        45                               S01310
     O**
     O****SWIFT*MESSAGES*FILE*-*DETAIL*OPENING*BALANCE*(81*-*INTERMEDIATE)S01310
     O**
     O***********                        49 ':20:'                        S01310
     O***********                        50 'S'                           S01310
     O***********              RUNDAT    56                               S01310
     O***********              SCOUNT    60                               S01310
     O***********              CR        66                               S01310
     O***********              LF        67                               S01310
     O***********                        71 ':25:'                        S01310
     O***********            88ACOUNT    81                               S01310
     O***********           N88SCNUM     77                               S01310
     O***********           N88CCYS      81                               S01194
     O***********           N88A6SWCY    81                         S01194S01310
     O***********           N88SACOD     86                               S01310
     O***********           N88SACSQ     89                               S01310
     O***********              CR       107                               S01310
     O***********              LF       108                               S01310
     O***********                       112 ':28:'                        S01310
     O***********              LSNO     117                               S01310
     O***********                       118 '/'                           S01310
     O***********              LINO     120                               S01310
     O***********              CR       121                               S01310
     O***********              LF       122                               S01310
     O***********                       125 ':60'                         S01310
     O***********              OP       127                               S01310
     O***********            36         128 'C'                           S01310
     O***********           N36         128 'D'                           S01310
     O***********              LSDATE   134                               S01310
     O***********         81   RUNDAT   134                               S01310
     O***********              CCYS     137                               S01194
     O***********              A6SWCY   137                         S01194S01310
     O***********              CFBLED   152                               S01310
     O***********         81   MBAL     152                               S01310
     O***********              CR       153                               S01310
     O***********              LF       154                               S01310
     O***********                       257 'S'                           S01310
     O***********              TNRF     272                               S01310
     O**
     O*****SWIFT*MESSAGES*FILE*-*DETAIL*MOVEMENTS**********************   S01310
     O**
     O********E**      70                                                 S01310
     O*******OR**      71                                                 S01310
     O***********              FIELD1   108                               S01310
     O***********              FIELD2   216                               S01310
     O***********                       257 'S'                           S01310
     O***********              TNRF     272                               S01310
     O**
     O*****SWIFT*MESSAGES*FILE*-*CLOSING*BALANCE***********************   S01310
     O********E**      82                                                 S01310
     O***********                         5 ':62F:'                       S01310
     O***********            42           6 'C'                           S01310
     O***********           N42           6 'D'                           S01310
     O***********              RUNDAT    12                               S01310
     O***********              CCYS      15                               S01194
     O***********              A6SWCY    15                         S01194S01310
     O***********              BALF      30                               S01310
     O***********              CR        31                               S01310
     O***********              LF        32                               S01310
     O***********            35          36 ':64:'                        S01310
     O***********         43 35          37 'C'                           S01310
     O***********        N43 35          37 'D'                           S01310
     O***********            35RUNDAT    43                               S01310
     O***********            35CCYS      46                               S01194
     O***********            35A6SWCY    46                         S01194S01310
     O***********            35CLBLF     61                               S01310
     O***********            35CR        62                               S01310
     O***********            35LF        63                               S01310
     O***********                        64 '-'                           S01310
     O***********              ETX       65                               S01310
     O***********                       257 'S'                           S01310
     O***********              TNRF     272                               S01310
     O***********                                                   S01117S01310
     O* GL1300P1 CHANGED,REL.10 CHANGED GL1300P1 TO 'UC'                  S01117
     O*                                                                   S01117
     O*GL1300P1D***0305*OF*****                                           S01117
     O*******OR********80                                                 S01117
     O***************************        35 'REF GL1300'            E15660S01117
     O****************                   15 'REF GL1300'            E15660S01117
     O************                       24 'REFERENCE GL1300P1'          S01117
     O************             TITL      88                         S01194S01117
     O************             BJURPT    88                         S01194S01117
     O**********************   RUNA      94                         E15660S01117
     O**********************             99 'PAGE'                  E15660S01117
     O**********************   PAGE     104                         E15660S01117
     O************             RUNA     113                         E15660S01117
     O************                      122 'PAGE'                  E15660S01117
     O************             PAGE     127                         E15660S01117
     O********D**   06 OF                                                 S01117
     O*******OR**      80                                                 S01117
     O************                       67 'SWIFT STATEMENT MESSAGES'    S01117
     O************                       79 ' AUDIT TRAIL'                S01117
     O********D**2*    OF                                                 S01117
     O*******OR****    80                                                 S01117
     O************                       67 '------------------------'    S01117
     O************                       79 '------------'                S01117
     O********D**2     OF                                                 S01117
     O*******OR***     80                                                 S01117
     O************                       20 'BRANCH:'                     S01117
     O************             SBRCA     28                               S01117
     O************             A8BRNM    32                               S01117
     O********E**1*       81                                              S01117
     O*GL1300P1E**1********81                                       S01117S01310
     O***********                        30 ':62M:'                       S01310
     O***********            42          31 'C'2M:'                       S01310
     O***********           N42          31 'D'2M:'                       S01310
     O***********              RUNDAT    37 ':62M:'                       S01310
     O***********              CCYS      40 ':62M:'                 S01194S01310
     O***********            42A6SWCY    40 ':62M:'                 S01194S01310
     O***********            42MBAL      55 'C'2M:'                       S01310
     O********E** 0305 81    42          31 'C'2M:'                       S01310
     O*
     O*************************          35 'REF GL1300'                  E15660
     O***********                        15 'REF GL1300'            E15660S01117
     O***********                        24 'REFERENCE GL1300P1'    S01117S01310
     O***********              TITL      88                               S01194
     O***********              BJURPT    88                         S01194S01310
     O************************ RUNA      94                               E15660
     O************************           99 'PAGE'                        E15660
     O************************ PAGE     104                               E15660
     O***********              RUNA     113                         E15660S01310
     O***********                       122 'PAGE'                  E15660S01310
     O***********              PAGE     127                         E15660S01310
     O******* E  1  06 81                                                 E15660
     O********E**   06 81                                           E15660S01310
     O*
     O***********                        67 'SWIFT STATEMENT MESSAGES'    S01310
     O***********                        79 ' AUDIT TRAIL'                S01310
     O********E**2     81                                                 S01310
     O*
     O***********                        67 '------------------------'    S01310
     O***********                        79 '------------'                S01310
     O********E**2     81                                           S01117S01310
     O***********                        20 'BRANCH:'               S01117S01310
     O***********              SBRCA     28                         S01117S01310
     O***********              A8BRNM    32                         S01117S01310
     O********E**1     69                                           S01117S01310
     O********E*21     69                                           S01117S01310
     O***********              CNA1      60                         S01194S01310
     O***********              BBCNA1    60                         S01194S01310
     O********E**1     69                                                 S01310
     O***********              CNA2      60                               S01194
     O***********              BBCNA2    60                         S01194S01310
     O***********            47         104 'DEMAND'                      S01310
     O********E**1     69                                                 S01310
     O***********              CNA3      60                               S01194
     O***********              BBCNA3    60                         S01194S01310
     O********E**1     69                                                 S01310
     O***********              CNA4      60                               S01194
     O***********              BBCNA4    60                         S01194S01310
     O********E**1     69                                                 S01310
     O*******OR**      81                                                 S01310
     O***********              OURSA     37                               S01310
     O********E**1     69                                                 S01310
     O*******OR**      81                                                 S01310
     O***********                        31 '950 02'                      S01310
     O********E**1     69                                                 S01310
     O*******OR**      81                                                 S01310
     O***********              WCSID     37                               S01310
     O********E**1     69                                                 S01310
     O*******OR**      81                                                 S01310
     O***********                        29 ':20:'                        S01310
     O***********                        30 'S'                           S01310
     O***                      SCOUNT    39
     O***********              RUNDAT    36                               S01310
     O***********              SCOUNT    40                               S01310
     O********E**1     69                                                 S01310
     O*******OR**      81                                                 S01310
     O***********                        29 ':25:'                        S01310
     O***********            88ACOUNT    39                               S01310
     O***********           N88SCNUM     35                               S01310
     O***********           N88CCYS      39                               S01194
     O***********           N88A6SWCY    39                         S01194S01310
     O***********           N88SACOD     44                               S01310
     O***********           N88SACSQ     47                               S01310
     O********E**1     69                                                 S01310
     O*******OR**      81                                                 S01310
     O***********                        29 ':28:'                        S01310
     O***********              LSNO      34                               S01310
     O***********              LINO      36                               S01310
     O********E**1     69                                                 S01310
     O*******OR**      81                                                 S01310
     O***********                        28 ':60'                         S01310
     O***********              OP        30                               S01310
     O***********            36          31 'C'                           S01310
     O***********           N36          31 'D'                           S01310
     O***********              LSDATE    37                               S01310
     O***********         81   RUNDAT    37                               S01310
     O***********              CCYS      40                               S01194
     O***********              A6SWCY    40                         S01194S01310
     O***********              CFBLED    55                               S01310
     O***********         81   MBAL      55                               S01310
     O********E**1     70                                                 S01310
     O***********                        29 ':61:'                        S01310
     O***********              AT1A      77                               S01310
     O********E**1     70                                                 S01310
     O******                   AT1B      59                               S05452
     O***********              AT1B      81                         S05452S01310
     O********E**1     70                                                 S01310
     O***********                        29 ':61:'                        S01310
     O***********              AT2A      77                               S01310
     O********E**1     70                                                 S01310
     O******                   AT2B      59                               S05452
     O***********              AT2B      81                         S05452S01310
     O********E**1     71                                                 S01310
     O***********                        29 ':61:'                        S01310
     O***********              AT3A      77                               S01310
     O********E**1     71                                                 S01310
     O******                   AT3B      59                               S05452
     O***********              AT3B      81                         S05452S01310
     O********E**1     82                                                 S01310
     O***********                        30 ':62F:'                       S01310
     O***********            42          31 'C'                           S01310
     O***********           N42          31 'D'                           S01310
     O***********              RUNDAT    37                               S01310
     O***********              CCYS      40                               S01194
     O***********              A6SWCY    40                         S01194S01310
     O***********              BALF      55                               S01310
     O********E**1     82 35                                              S01310
     O***********                        29 ':64:'                        S01310
     O***********            43          30 'C'                           S01310
     O***********           N43          30 'D'                           S01310
     O***********              RUNDAT    36                               S01310
     O***********              CCYS      39                               S01194
     O***********              A6SWCY    39                         S01194S01310
     O***********              CLBLF     54                               S01310
     O********E***0305 82NLR
     O****
     O***************************        35 'REF GL1300'                  E15660
     O***********                        15 'REF GL1300'            E15660S01117
     O****                               24 'REFERENCE GL1300P1'          S01117
     O***********              TITL      88                               S01194
     O****                     BJURPT    88                               S01194
     O*********************    RUNA      94                               E15660
     O*********************              99 'PAGE'                        E15660
     O*********************    PAGE     104                               E15660
     O****                     RUNA     113                               E15660
     O****                              122 'PAGE'                        E15660
     O****                     PAGE     127                               E15660
     O******* E  1  06 82NLR                                              E15660
     O****    E     06 82NLR                                              E15660
     O****
     O****                               67 'SWIFT STATEMENT MESSAGES'
     O*********                          79 ' AUDIT TRAIL'
     O********E* 2     82NLR
     O*********
     O**********                         67 '------------------------'
     O**********                         79 '------------'
     O********T** 40   LR U7 U8
     O***********                        69 '--- ERROR IN DATABASE '      S01194
     O***********                        72 '---'                         S01194
     O***********                        42 '--- REFERENCE'         E15502S01194
     O************                       42 '*** REFERENCE'               E15502
     O***********              DBPGM     51                               S01194
     O***********                        71 '-DATABASE ERROR AT'          S01194
     O***********              DBASE     74                               S01194
     O********T** 41   LR U7 U8                                           S01194
     O***********                        37 'FILE NAME'                   S01194
     O***********              DBFILE    43                               S01194
     O***********                        48 'KEY'                         S01194
     O***********              DBKEY     78                               S01194
     O********T*2      LR
     O**********                         70 '--- END OF REPORT ---' E15502S01117
     O***********                        70 '*** END OF REPORT ***' E15502S01117
     O*
     O** FILE CONTROL REPORT
     O*
     OGL1300AUT   0305 LR
     O*
     O************************           35 'REF GL1300'                  E15660
     O***********                        15 'REF GL1300'            E15660S01117
     O                                   24 'REFERENCE GL1300AU'          S01117
     O***********              TITL      88                               S01194
     O                         BJURPT    88                               S01194
     O***********************  RUNA      94                               E15660
     O***********************            99 'PAGE'                        E15660
     O***********************  PAGE1    104                               E15660
     O                         RUNA     113                               E15660
     O                                  122 'PAGE'                        E15660
     O                         PAGE1    127                               E15660
     O******* T  1  06 LR                                                 E15660
     O        T     06 LR                                                 E15660
     O*
     O***********                        67 'SWIFT STATEMENT MESSAGES'    S01117
     O***********                        79 ' AUDIT TRAIL'                S01117
     O                                   64 'SWIFT STATEMENT MESSAGES'    S01117
     O                                   76 ' AUDIT TRAIL'                S01117
     O                                   92 '    RUN CONTROLS'            S01117
     O        T  2     LR
     O*
     O***********                        67 '------------------------'    S01117
     O***********                        79 '------------'                S01117
     O                                   64 '------------------------'    S01117
     O                                   76 '------------'                S01117
     O        T   1516 LR
     O                                   33 'FILE CONTROLS-'
     O                                   54 'INPUT'
     O                                   79 'CALCULATED'
     O        T     18 LR
     O                                   33 '--------------'
     O        T     20 LR
     O                                   27 'POSTINGS'
     O        T     27 LR
     O                                   42 'TOTAL NUMBER OF RECORDS'
     O                                   46 '-'
     O***********              PNORE 3   54                               E13086
     O                         TPNORE3   54                               E13086
     O                         POSTOT3   79
     O                       60         104 '*** OUT OF BALANCE ***'
     O        T     29 LR
     O                                   26 'S/SWACS'
     O        T     30 LR
     O                                   42 'TOTAL NUMBER OF RECORDS'
     O                                   46 '   -'
     O                         SNORE 3   54
     O                         SWATOT3   79
     O                       61         104 '*** OUT OF BALANCE ***'
     O        T  1     LR
     O                                   43 'NUMBER OF DELETED RECORD'
     O                                   46 'S -'
     O                         SNORD 3   54
     O                         SWADEL3   79
     O                       62         104 '*** OUT OF BALANCE ***'
     O        T  1     LR
     O                                   43 'NUMBER OF CLOSED RECORDS'
     O                                   46 '  -'
     O                         SWACLO3   79
     O        T   40   LRNU7 U8
     O                                   65 '*** FILE CONTROLS OUT OF'
     O                                   77 'BALANCE ***'
0375 O        T 21     U7 U8 LR                                           S01194
0376 O                                   42 '*** REFERENCE'               S01194
0377 O                         DBPGM     53                               S01194
0378 O                                   73 '-DATABASE ERROR AT'          S01194
0379 O                         DBASE     77                               S01194
0380 O        T  1     U7 U8 LR                                           S01194
0381 O                                   37 'FILE NAME'                   S01194
0382 O                         DBFILE    46                               S01194
0383 O                                   53 'KEY'                         S01194
0384 O                         DBKEY     83                               S01194
     O*****   T   43   LR                                          S01117 RT0086
     O*****                              70 '*** END OF REPORT ***'S01117 RT0086
     O********************************************************************
     OGL1300P1E   0305         GLSNTH
     O*********************              35 'REF GL1300'                  E15660
     O***********                        15 'REF GL1300'            E15660S01117
     O                                   24 'REFERENCE GL1300P1'          S01117
     O***********              TITL      88                               S01194
     O                         BJURPT    88                               S01194
     O*********************    RUNA      94                               E15660
     O*********************              99 'PAGE'                        E15660
     O*********************    PAGE     104                               E15660
     O                         RUNA     113                               E15660
     O                                  122 'PAGE'                        E15660
     O                         PAGE     127                               E15660
     O        E     06         GLSNTH
     O                                   67 'SWIFT STATEMENT MESSAGES'
     O                                   79 ' AUDIT TRAIL'
     O        E                GLSNTH
     O                                   67 '------------------------'
     O                                   79 '------------'
     O/COPY WNCPYSRC,GL1300O001
     O        E  130           GLSNTH
     O                                   73 '--- WARNING ---         '    E15502
     O************                       73 '*** WARNING ***         '    E15502
     O        E  1             GLSNTH
     O                                   73 'SWIFT STATEMENTS HAVE AL'
     O                                   83 'READY BEEN'
     O        E  1             GLSNTH
     O                                   73 'SENT TODAY. BUT INPUT CY'
     O                                   83 'CLE WAS   '
     O        E  1             GLSNTH
     O                                   73 'REOPENED. CHANGES COULD '
     O                                   83 'HAVE BEEN '
     O        E  1             GLSNTH
     O                                   73 'MADE THAT AFFECT STATEME'
     O                                   84 'NT CONTENT.'
     O        E  1             GLSNTH
     O                                   73 'THEY HAVE THEREFORE BEEN'
     O                                   84 ' REPRODUCED'
     O        E  1             GLSNTH
     O                                   73 'HERE WITH LATEST DATA IN'
     O                                   84 'CLUDED.    '
     O********************************************************************
     O* EXCPT FOR MULTIBRANCHING HEADER ,CONDITIONED ON L2.               S01117
     O*  AND END OF BRANCH REPORT , END OF REPORT                         S01117
     O********************************************************************S01117
     OGL1300P1E   0305         HEAD                                       S01117
     O                                   24 'REFERENCE GL1300P1'          S01117
     O                         BJURPT    88                               S01117
     O                         RUNA     113                               S01117
     O                                  122 'PAGE'                        S01117
     O                         PAGE     127                               S01117
     O        E     06         HEAD                                       S01117
     O                                   67 'SWIFT STATEMENT MESSAGES'    S01117
     O                                   79 ' AUDIT TRAIL'                S01117
     O        E  2             HEAD                                       S01117
     O                                   67 '------------------------'    S01117
     O                                   79 '------------'                S01117
     O        E  2     19      HEAD                                       S01117
     O                                   20 'BRANCH:'                     S01117
     O                         SBRCA     28                               S01117
     O                         A8BRNM    32                               S01117
     O*                                                                   S01117
     O*GL1300P1E*2              END1                                S01117S01310
     O************                       70 '--- END OF REPORT FOR 'S01117S01310
     O************                       80 'BRANCH ---'            S01117S01310
     O*                                                                   S01117
     OGL1300P1E 2              END2                                       S01117
     O                                   70 '--- END OF REPORT ---'       S01310
     O***                                70 '--- END OF REPORT ---'       S01310
     O********************************************************************LN0074
     O* EXCPT FOR NO DETAILS PRINT TO P1                                  LN0074
     O********************************************************************LN0074
     O*GL1300P1E***03***********NODTL                               LN0074S01310
0476 O***********                        24 'REFERENCE GL1300P1'    LN0074S01310
0477 O***********              BJURPT    88                         LN0074S01310
0478 O***********                       104 'DATE'                  LN0074S01310
0479 O***********              RUNA     113                         LN0074S01310
0480 O***********                       122 'PAGE'                  LN0074S01310
0481 O***********              PAGE  3  127                         LN0074S01310
     O********E** 05           NODTL                                LN0074S01310
     O***********                        67 'SWIFT STATEMENT MESSAGELN0074S01310
     O***********                        79 ' AUDIT TRAIL'          LN0074S01310
     O********E** 06           NODTL                                LN0074S01310
     O***********                        67 '-----------------------LN0074S01310
     O***********                        79 '------------'          LN0074S01310
     O********E*3        NU7   NODTL                                LN0074S01310
     O***********                        74 '---   NO DETAILS TO REPLN0074S01310
     O***********                        82 'RT   ---'              LN0074S01310
     O********E*3      U8 U7   NODTL                                LN0074S01310
     O***********                        74 '-- DATABASE IN ERROR --LN0074S01310
     O********E*3              NODTL                                LN0074S01310
0518 O***********                        76 '--- END OF REPORT ---' LN0074S01310
     O********************************************************************LN0074
     O**
     O***  S/SWACN - NEW SWIFT ACCOUNTS FILE
     O**
     OSWACNSA D        01
     O                         SWACSH    64
     OSWACNSB T        34 L1
     O**********************   PSWACS    64                               CSW004
     O**********               PSWACS    75                                            CSW004 CGL029
     O                         PSWACS    85                                                   CGL029
     O                       40BALNCE    23P
     O**********         N44 40RUND      26P                                                  CSW022
     O                       40RUND      26P                                                  CSW022
     O                   N44 40NEWNSD    29P
     O                       47NEWNSD    29P                                                  CSW022
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL1300OOP2                                           S01408
     O*                                                                   S01408
     O                       40NEWLSN    45P
     O                                   47 ' '
     O        T        46 L1
     O**********************   PSWACS    64                               CSW004
     O**********               PSWACS    75                                            CSW004 CGL029
     O                         PSWACS    85                                                   CGL029
     O                                    1 '*'
     OSWACNSC T        LRNU8
     O                         SWACST    64
     O                         OSWACN    19P                              101867
     O                         DSWACN    22P
     O**
     O**   S/SWPOS - NEW SWIFT POSTINGS FILE
     O**
     OSWPOSHH D        U1 05
     O                         POSTH    160
     OSWPOSPD D        U1 33 06
     O***                      POSTD    160                               S05452
     O***********              POSTD    200                        S05452 S03220
     O***********              POSTD    215                        S03220 S01117
     O***********              POSTD    268                        S01117 S01413
     O*************************POSTD    279                         S01413CRT001
     O*************************POSTD    316                         CRT001CEU013
     O***********              POSTD    329                        CEU013 CGL007
     O**********               POSTD    331                                            CGL007 CGL020
     O**********               POSTD    589                                            CGL020 CGL029
     O                         POSTD    620                                                   CGL029
     OSWPOSRA D        U1 33 07
     O***                      POSTD    160                               S05452
     O**********               LOT      160                                            S05452 CGL029
     O                         LOT      170                                                   CGL029
     OSWPOSZZ T        U1 LR
     O                                    1 'T'
     O                         OSWPOS     6
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL1300OOP1                                           S01408
      *                                                                                     MD023587
      ** Translation table updated to change 6FA6 to 6F6A                                   MD023587
      ** (Last 4 chars in the line)                                                         MD023587
      *                                                                                     MD023587
** File translation table to prevent use of invalid ISO characters (+E29588)
*EQUATE MGOMSGPD,GL1300P1
*EQUATE 4E504B5E7D7F4DC05DD060CD6F5A6F5B6F4A6F6C6F5C6F4C6F7E6F6E6F7C61E0D57B6F6A            MD023587
*EQUATE 6F4F6F5F7D7960A1606D
     X/COPY WNCPYSRC,GL1300X001
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
     X/COPY WNCPYSRC,GL1300X002
