     H        1
      *****************************************************************
/*XBIA*: OVRDBF FILE(ACCNTLXX) TOFILE(ACCBR) SHARE(*NO)             : *
/*XBIB*: OVRDBF FILE(REIACXX) TOFILE(REIAC) SHARE(*NO)              : *
/*XBIC*: OVRDBF FILE(RECOMXX) TOFILE(RECOM) SHARE(*NO)              : *
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Account maintenance/enquiry')                 *
      *****************************************************************
      *                                                               *
      *  Midas - General Ledger Module                                *
      *                                                               *
      *  GL3271  - ACCOUNT MAINTENANCE/ENQUIRY                        *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. AR703901           Date 01Jun20               *      
      *  Prev Amend No. CER050             Date 16Jun19               *
      *                 CSD101             Date 07Dec18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD034366           Date 09Sep15               *
      *                 MD034451C          Date 02Mar16               *
      *                 MD030959           Date 17Jun15               *
      *                 CRE101             Date 29Oct14               *
      *                 CRE095             Date 25Apr14               *
      *                 CGL165             Date 17Feb15               *
      *                 226364             Date 19Aug14               *
      *                 CRE090             Date 14Feb14               *
      *                 AR1095876          Date 30Sep13               *
      *                 CGL001             Date 06Aug12               *
      *                 CLE134             Date 01Aug12               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      *                 CER055             Date 06Dec10               *
      *                 CRE075             Date 06Dec10               *
      *                 AR582286           Date 26Jul10               *
      *                 CER059             Date 19Jul10               *
      *                 CER045             Date 20Jul09               *
      *                 BUG23055           Date 19May09               *
      *                 BUG23348           Date 12Mar09               *
      *                 BUG23024           Date 19Feb09               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG27532           Date 26Apr10               *
      *                 BUG27045A          Date 13Apr10               *
      *                 BUG27045           Date 18Feb10               *
      *                 CRE005             Date 18Jan10               *
      *                 CAP205             Date 26Jan10               *
      *                 CRE401             Date 26Nov09               *
      *                 242011             Date 05Sep06               *
      *                 CGL062             Date 21Jul06               *
      *                 CRE030             Date 10Jul06               *
      *                 260327             Date 31May09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 255412             Date 19Aug08               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 07Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG5948            Date 28Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3584            Date 28Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2109            Date 04May04               *
      *                 BUG2304            Date 30Apr04               *
      *                 TDA092             Date 29Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 CDE005             Date 19Aug03               *
      *                 CSF002             Date 11Aug03               *
      *                 208221             Date 11Dec02               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      *                 CPK015             Date 28Jun02               *
      *                 198593             Date 13Dec01               *
      *                 160552             Date 28Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 193178             Date 11May01               *
      *                 193106             Date 29Jan01               *
      *                 CDE002             Date 03Apr00               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 23May01               *
      *                 CRE007             Date 01Mar01               *
      *                 183656             Date 31Jan01               *
      *                 178695             Date 29Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 178464             Date 27Oct00               *
      *                 183052             Date 18Oct00               *
      *                 182760             Date 18Sep00               *
      *                 145808             Date 18Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 172230             Date 19May00               *
      *                 164492             DATE 19May00               *
      *                 173634             DATE 12May00               *
      *                 CDE001             Date 12Apr00               *
      *                 154206             DATE 09FEB99               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 174144             DATE 10Feb00               *
      *                 CPB001             DATE 25Jun99               *
      *                 CAP035             DATE 24Aug99               *
      *                 145453             Date 22Oct99               *
      *                 155510             DATE 14OCT99               *
      *                 143064             DATE 13OCT99               *
      *                 160474             Date 07JUL99               *
      *                 160473             Date 07JUL99               *
      *                 160472             Date 07JUL99               *
      *                 160471             Date 07JUL99               *
      *                 160469             Date 07JUL99               *
      *                 160468             Date 07JUL99               *
      *                 160467             Date 07JUL99               *
      *                 160465             Date 07JUL99               *
      *                 160464             Date 07JUL99               *
      *                 160463             DATE 07JUL99               *
      *                 106799             DATE 07JUL99               *
      *                 155863             DATE 06JUL99               *
      *                 CFT004             Date 28Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157284             DATE 18MAY99               *
      *                 155245             DATE 11May99               *
      *                 CSD005             Date 01MAR99               *
      *                 129788             DATE 30APR99               *
      *                 134747             DATE 18MAY98               *
      *                 CTI002             DATE 23Sep98               *
      *                 147954             Date 25NOV98               *
      *                 154539             DATE 01Feb99               *
      *                 153092             DATE 22Jan99               *
      *                 143204             DATE 22Sep98               *
      *                 138518             DATE 23JUL98               *
      *                 086558             DATE 02Jun98               *
      *                 123585             DATE 26May98               *
      *                 079895             DATE 23May98               *
      *                 094336             DATE 20JAN98               *
      *                 CEU013             DATE 27FEB98               *
      *                 075931             DATE 24FEB98               *
      *                 114243             DATE 20FEB98               *
      *                 119826             DATE 20FEB98               *
      *                 114907             DATE 20FEB98               *
      *                 119589             DATE 20FEB98               *
      *                 117722             DATE 20FEB98               *
      *                 115860             DATE 20FEB98               *
      *                 119285             DATE 18FEB98               *
      *                 119479             DATE 18FEB98               *
      *                 120076             DATE 18FEB98               *
      *                 111124             DATE 18FEB98               *
      *                 103352             DATE 18FEB98               *
      *                 100296             DATE 22JAN98               *
      *                 104313             DATE 22JAN98               *
      *                 106784             Date 22JAN98               *
      *                 110010             DATE 30JAN98               *
      *                 084429             DATE 14JAN98               *
      *                 116492             DATE 13JAN98               *
      *                 126302             DATE 20Nov97               *
      *                 110515             DATE 20Nov97
      *                 CTI001             DATE 04JUL97               *
      *                 CGL004             DATE 04NOV97               *
      *                 124824             DATE 29OCT97               *
      *                 110695             DATE 10APR97               *
      *                 116760             Date 11Apr97               *
      *                 CRE001             Date 18Feb97               *
      *                 113843             Date 18Feb97               *
      *                 097616             DATE 07APR97               *
      *                 CRT002             DATE 01DEC95               *
      *                 107478             Date 28AUG96               *
      *                 108360             DATE 11OCT96               *
      *                 CCB002             DATE 21AUG96               *
      *                 104058             DATE 01NOV96               *
      *                 S01408             DATE 11OCT96               *
      *                 S01408             DATE 13SEP96               *
      *                 S01408             DATE 02SEP96               *
      *                 S01408             DATE 02AUG96               *
      *                 CAC001             DATE 01FEB96               *
      *                 103444             DATE 21MAY96               *
      *                 094409             DATE 05JUL96               *
      *                 099613             DATE 11JUN96               *
      *                 S01408             DATE 25APR96               *
      *                 098400             DATE 23APR96               *
      *                 S01408             DATE 17APR96               *
      *                 CPM004             DATE 07FEB96               *
      *                 S01408             DATE 21FEB96               *
      *                 S01408             DATE 10JAN96               *
      *                 095242             DATE 01NOV95               *
      *                 S01408             DATE 13NOV95               *
      *                 S01408             DATE 06NOV95               *
      *                 091796             DATE 24OCT95               *
      *                 093216             DATE 21SEP95               *
      *                 092290             DATE 11SEP95               *
      *                 S01408             DATE 16OCT95               *
      *                 S01408             DATE 24JUL95               *
      *                 S01408             DATE 02JUN95               *
      *                 087222             DATE 23MAY95               *
      *                 084065             DATE 20APR95               *
      *                 079126             DATE 19APR95               *
      *                 083651             DATE 12APR95               *
      *                 S01408             DATE 10APR95               *
      *                 CRT001             DATE 28FEB95               *
      *                 S01408             DATE 13MAR95               *
      *                 080620             DATE 01MAR95               *
      *                 S01408             DATE 03FEB95               *
      *                 078168             DATE 17NOV94               *
      *                 080038             DATE 20DEC94               *
      *                 075129             DATE 12DEC94               *
      *                 S01486             DATE 04NOV94               *
      *                 S01522             DATE 22NOV94               *
      *                 077012             DATE 06OCT94               *
      *                 077017             DATE 06OCT94               *
      *                 075510             DATE 22SEP94               *
      *                 S01408             DATE 21SEP94               *
      *                 075129             DATE 08SEP94               *
      *                 074979             DATE 08SEP94               *
      *                 074588             DATE 18AUG94               *
      *                 074586             DATE 18AUG94               *
      *                 074576             DATE 18AUG94               *
      *                 074585             DATE 18AUG94               *
      *                 073234             DATE 18AUG94               *
      *                 072879             DATE 18AUG94               *
      *                 072541             DATE 21JUN94               *
      *                 030310             DATE 07MAR94               *
      *                 064592             DATE 07MAR94               *
      *                 064590             DATE 07MAR94               *
      *                 060902             DATE 07MAR94               *
      *                 060509             DATE 07MAR94               *
      *                 057921             DATE 07MAR94               *
      *                 055357             DATE 07MAR94               *
      *                 053943             DATE 07MAR94               *
      *                 053200             DATE 07MAR94               *
      *                 044443             DATE 28SEP93               *
      *                 058065             DATE 28SEP93               *
      *                 048251             DATE 28SEP93               *
      *                 056983             DATE 28SEP93               *
      *                 47641              DATE 28SEP93               *
      *                 S01421             DATE 09AUG93               *
      *                 S01413 *CREATE     DATE 13APR93               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  AR703901 - User is able to see list of accounts that it's not*
      *             authorised to. Check if user has authority to its *
      *             branch before loading to subfile.(Child: AR703902)*      
      *  CER050 - Annualised Percentage Rate                          *
      *  CSD101 - Password Encryption                                 *
      *  MD046248 - Finastra Rebranding                               *
      *  MD034366 - CRE005 failuers in COB. (Recompile)               *
      *  MD034451C - Recompiled due to changed PF/HELDIHB.            *
      *  MD030959 - Recompiled due to changed PF/HELDIHC.             *
      *  CRE101 - Management Interest Statements on a frequency       *
      *           Addition of hook CRE101_074, CRE101_075, CRE101_076 *
      *  CRE095 - Fixing Rate for RE Accounts                         *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  226364 - Allow accounts to have parent customers. Applied    *
      *           fix 213782.                                         *
      *           Applied for MD021329.                               *
      *  CRE090 - Delay Capitalisation of Interest                    *
      *  AR1095876- ABC - Forward Days 1 should = DNWD-1, not just    *
      *             RUND (Child: AR1095877) (Recompile)               *
      *  CGL001 - Introduction of New statement frequency 'N' (NEVER) *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CER049 - Stamp Tax (Recompile)                               *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CER055 - Penalty Interest on Exceeding Overdraft Limit       *
      *           (Recompile)                                         *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  AR582286 - The system was not able to generate IBAN for      *
      *             the customer. Applied fix 206824.                 *
      *  206824 - IBAN field not displayed and updated correctly      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER045 - German Features - Reporting Bundesbank (Recompile)  *
      *  BUG23055 - Display §24c KWG field correctly                  *
      *  BUG23348 - Calculation basis when 0 is defaulted to blanks   *
      *           in Credit Interest screen should be 0               *
      *  BUG23024 - Calculation Basis field when 0 is defaulted to    *
      *           blank it should be 0                                *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  BUG27532 - Several fields are blank in the confirmation page *
      *             (Recompile)                                       *
      *  BUG27045A - Override the fix of Bug 27045 (Recompile)        *
      *  BUG27045 - Amend via SOAP removes Document Linkage           *
      *             (Recompile)                                       *
      *  CRE005 - Changes to STRAN                                    *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CRE401 - 4-Eyes Checking Gaps - Sweeps (Recompile)           *
      *  242011 - Moduls 11 Check only applies for Insert action      *
      *  CGL062 - Moduls 11 Check on Retail Account Number            *
      *  CRE030 - Default RE Accounts by Currency                     *
      *  260327 - Debit Alternate Account truncated in Accounts       *
      *           Maintenance Screen. Increase the SWDACP field to 21.*
      *           Also include CHCP and CHST fields and their         *
      *           corresponding working variables.                    *
      *           Applied core fix 242183 and 244611.                 *
      *  244611 - The Charges Calculation sub-type field should only  *
      *           have a length of 5.                                 *
      *  242183 - SWMRT3, SWDACP & SWCHCP not adjusted which shows    *
      *           truncated value on Accounts Master Enquiry Screen.  *
      *  255412 - GL Extra action button in Account Master Details    *
      *           Enquiry (Recompile).                                *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data                    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG5948 - Include Aggregate Facility file in checking for    *
      *            live facility.                                     *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3584 - Increase the size of the file control fields       *
      *            (recompile).                                       *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2109- Webfacing changes (recompile)                       *
      *  BUG2304 - Various file layout changes. Recompile.            *
      *  TDA092 - Correct the position of the fields that overlap     *
      *           SEFAC field.                                        *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CDE005 - Data Export - Reservation ID                        *
      *  CSF002 - Global layer.                                       *
      *           - Change definition of ZMITEM.                      *
      *  208221 - Changes identified during alpha site                *
      *           Default Margin from Rate/Spread changes             *
      *  CPK015 - Release 4.01 Packaging:                             *
      *           - A default timestamp string is required for WRITE. *
      *  198593 - IBAN deformatting prevents updates.                 *
      *  160552 - If account not found or already closed, initialise  *
      *           field ERR to avoid updat of NOCL.                   *
      *  193178 - For generation method 1 (do not generate as user    *
      *           will input the IBAN), make the IBAN field not       *
      *           mandatory. This is so that for internal accounts    *
      *           IBAN do not have to be input.                       *
      *           For retail accounts, a warning message will be      *
      *           given if the IBAN is not input.                     *
      *  193106 - Message data for RE72031 is now character           *
      *  CDE002 - Revenue Analysis - New fields added on screen 4.    *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
      *  CRE007 - Base Rate Tax 2001.                                 *
      *  183656 - Validate Portfolio Reference only if Portfolio      *
      *           Management installed and this is a Portfolio cust.  *
      *  178695 - Review some validation with 'PB' Module             *
      *           in Account Maintenance Processing                   *
      *  178464 - Fix to ensure that blanked out credit next interest *
      *           capitalisation field is actually set to be blank    *
      *           on file.                                            *
      *  183052 - Allow update of account details even though account *
      *           has incoming funds transfer records, though do not  *
      *           allow update of IBAN number.                        *
      *  182760 - Before writting a record in file REIACD and RECOMD  *
      *           move 'D' into the output field RECIRC and RECIRE to *
      *           ensure that the RECI of the new records are 'D'.    *
      *  145808 - RENAME SCCY FROM FACILITIES FILE TO AVOID DB ERROR  *
      *           ON ACCESS TO SDBSRTPD                               *
      *  CDE001 - Data Export - CCRM Limits                           *
      *  172230 - Prevent locking of record when accessed at the same *
      *           time by two users                                   *
      *  164492 - Initialize EUSB field before moving screen field    *
      *           just before the write during the input of a new acc.*
      *  173634 - If the default retail account has an overdraft      *
      *           limit set, and a new account is inserted using      *
      *           a different ccy the O/D line should be blank.       *
      *           When comparing the screen value (zero) with the     *
      *           file value, if the ccy is different it should only  *
      *           check that the O/D line is still zero, not that it  *
      *           matches the value on file.                          *
      *  154206 - User allowed to close a primary account which was   *
      *           linked to a secondary account because pgm was using *
      *           a LF keyed on the secondary account, not the prime  *
      *           account - fix is to chain using RELINKJ2.           *
      *         - Allow user to close a linked primary account if all *
      *           linked secondary accounts have been closed.         *
      *         - Created new AO program to access account status     *
      *           details, instead of access to ACCBR which corrupts  *
      *           secondary account details and prevents primary      *
      *           account being closed when secondary account already *
      *           closed.                                             *
      *  174144 - Changed program to check to see if alt a/c to post  *
      *           charges is closed or is going to close in COB. If   *
      *           so, reject this as a valid alternate.               *
      *           Also prevent RECI on account being changed to 'C'   *
      *           by overwrite when changing an alternate a/c from    *
      *           a closed account to a live account.                 *
      *           Renamed RECI from RECOM and RECOMXX to prevent      *
      *           overwrite of RECI. Also renamed RECI from REIAC     *
      *           and REIACXX.                                        *
      *  CPB001 - 'Private Banking' Module                            *
      *  CAP035 - Account maintenance API; recompiled over changed    *
      *           ACCBR.                                              *
      *  145453 - Recompile due to changes in display file GL3271DF.  *
      *  155510 - Customer retail a/c was opened with sequence '  '   *
      *  143064 - All account maintenance is rejected if Overdraft    *
      *           limit has expired.  Applied fix 088789.             *
      *  160474 - Make TI Account details available when switching    *
      *           from Enquiry to Amend Mode (F8 - pressed).          *
      *  160473 - Add TI defaults only if it is needed. It means only *
      *           in Input or Amend mode when TI account flag (STIAC) *
      *           on the screen has been changed from 'N' to 'Y'.     *
      *  160472 - Refresh screen with proper TI account details.      *
      *  160471 - TI Account Number Suffix must be not equal 000 and  *
      *           must be numeric.                                    *
      *  160469 - TI Account details available only if in insert or   *
      *           amend mode.                                         *
      *  160468 - Check if TI account number is not duplicated only   *
      *           when account is flagged as a TI account and TI      *
      *           details different than previously defined.          *
      *  160467 - Use TI defaults in insert mode only, or TI account  *
      *           has been changed to 'Y'.                            *
      *  160465 - Improved validation of TI Account Number            *
      *  160464 - Default TI account number to Customer Number and    *
      *           next available sequence number.                     *
      *  160463 - Make TI account details available when TI is        *
      *           switched on.                                        *
      *  106799 - If alternative a/c to post Dr interest exist, the   *
      *           Overfraft line is wrong for the master account.     *
      *  155863 - Do not allow input of different accounts with       *
      *           duplicate TI key fields.
      *           Rework 157284 to condition on BICN.                 *
      *  CFT004 - Straight Through Processing Phase 2                 *
      *           International Bank Account Numbers                  *
      *  157284 - Program allows an account to be specified as a      *
      *           TI Account, even if the customer is not a           *
      *           designated TI Customer.                             *
      *  155245 - Delete Mode should only check if Acno is actually   *
      *           equal to the one in the acc file ACCNTAB rather     *
      *           than check if it is valid or not .                  *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
     F*  129788 - Clear program message queue right at the very       *
     F*           begining of the initialization process .            *
      *  134747 - To avoid a wrong Overdraft rate value date :        *
      *            - remove fix 119479 because if the aodr was changed*
      *              to zero the value date must be input             *
      *            - to solve the problem of rate change value date   *
      *              equal to zero.                                   *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
      *  147954 - Removal of fix number 094336.                       *
      *  154539 - Use a different key field to chain to RESWEPL4, key *
      *           was not built yet at this stage, use screen fields  *
      *           to built key .                                      *
      *  153092 - Prevent record being deleted if sweep is scheduled  *
      *           for this Euro acc (Credit acc of the sweep) .       *
      *  143204 - Error message should occur when mapping record      *
      *           found. Change conditioning after chain to give      *
      *           error when no record indicator *IN80 off.           *
      *  138518 - prevent record being deleted if part of a EURO      *
      *         - mapping.                                            *
      *  086558 - Base rate type must be entered if rate/spread is    *
      *           -ve (negative).                                     *
      *  123585 - Accounts allowed to be opened with sequence 00.     *
      *           Starting sequence should be 01.                     *
      *  079895 - PRINT ADDRESS FLAG SHOULD DEFAULT TO 'Y' NOT 'N'.   *
      *  094336 - WHENEVER CAPITALISATION FREQUENCY IS CHANGED TO     *
      *           'Z' CHECK TO ENSURE THAT THE NEXT CAPITALISATION    *
      *           DATE IS SET TO BLANKS.                              *
      *  CEU013 - EMU Account Postings Narrative                      *
      *  CTI001 - Midas / Trade Innovation Interface Phase 1          *
      *  075931 - On refresh or F12 a ROLBK should be issued to       *
      *           allow for update in window program.                 *
      *  114243 - When trying to insert a RE a/c after amending       *
      *           another RE a/c with 'O/D line' not zero or if the   *
      *           'O/D line' of the default RE a/c is not zero and    *
      *           it has a diff ccy, system prompts the user for an   *
      *           input in 'O/D Change Value Date' even if no 'O/D    *
      *           line' is entered.                                   *
      *  119826 - If default retail account is found and commissions  *
      *           are set to 'E' (Exempt), default the commission     *
      *           fields to 'E' as well during Insert even if the     *
      *           currencies are different.                           *
      *  114907 - In insert mode, display default values for the      *
      *           Transaction Charge Override fld on CR Int and       *
      *           Charges screen and for the fields on the            *
      *           Commissions and Override screen if a default a/c    *
      *           was defined for the a/c code and its ccy is the     *
      *           same as the ccy of the a/c to be inserted.          *
      *  119589 - Correct editing of Extra Daily Statement Commission *
      *           if field is zero.                                   *
      *  117722 - If a/c is a secondary a/c , show the RE number, if  *
      *           being used, of the prime a/c instead of the 18-char *
      *           GL a/c.                                             *
      *  115860 - If Next statement date equal '?', no error msg      *
      *  119285 - Field 'Number of copies chargeable' not updated     *
      *           when setting the account charge-free                *
      *  119479 - Blanking overdraft value date causes rate change    *
      *           value date to be zero on file. 085060 uses overdraft*
      *           rate date whenever rate is changed, but it is not   *
      *           set up if both fields details are being blanked out.*
      *  120076 - RENAME FREQUENCY FIELDS DRIF/CRIF FROM ACNUM        *
      *  111124 - WHEN INPUTTING AN OVERDRAFT THE CHANGE SEEMS TO BE  *
      *           NOT UPDATED WHEN IT IS A SECONDARY ALTHOUGH IT IS.  *
      *           FIELDS RENAMED.                                     *
      *  103352 - CPF5035 ON FILE ACCNTAB BECAUSE THERE IS A DATA IN  *
      *           A DECIMAL FIELD THAT IS NOT VALID                   *
      *  100296 - Check if Nostro details exist before deleting the   *
      *           account.                                            *
      *  104313 - Update of Overdraft Line field does not update Date *
      *           Limit Last Changed (DLIM) field in ACCNTAB          *
      *  106784 - Password fields not showing up after entry of       *
      *           new account. Fields may not be initialised          *
      *           at right time. Fix moves screen field to password   *
      *           field for Insert mode items and allows normal       *
      *           processing for amended items.                       *
      *  110010  -  If base rate or interest type/sub-type linked to a*
      *             rate is changed and 'This Change Value Date'      *
      *             is less than this date.  Output new error message.*
      *  084429 - Non-existant Alternate Address selected from '?'    *
      *           screen. Fix is to check that the alternate address  *
      *           selected is for the same customer.                  *
      *  116492 - Recompile for change to display file rollup/down.   *
      *  126302 - Fix 097616 not incorporated correctly in DBAR2.     *
      *           Moved one ELSE statement to match equivalent        *
      *           position in R10.6                                   *
      *  110515 - Ensure Withholding Tax window can be displayed if   *
      *           required despite BOE being switched on - reset      *
      *           parameter FKEY before calling WHT window.           *
      *  CGL004 - Addition of Midas-Fontis Interface                  *
      *           account details.                                    *
      *  124824 - During initial screen, the branch authority check   *
      *           should be done after the chain to ACNUM file        *
      *           because it will refuse the authority (Branch is     *
      *           blank before the chain operation). 097616 did not   *
      *           work properly, a new fix is implemented.            *
      *  110695 - The Minimum balance is blank on the screen, but     *
      *           not on the ACCNTAB file.                            *
      *  116760 - Overdraft Line and O/D Line Expiry Date shown are   *
      *           incorrect.                                          *
      *  CRE001 - Overdraft Interest Calculations:                    *
      *           Amend 'Debit and Overdraft Details' maintenance     *
      *           function to include the new Overdraft fields.       *
      *           Also applied fix 084425.                            *
      *  113843 - Show Default Charges/Commissions at Account Level   *
      *  097616 - Complete review of SPF functions to allow action    *
      *           code control on branch input and not user default   *
      *  CRT002 - Retail Branch Access.                               *
      *  107478 - Problems entering 'Passbooks used on savings a/c' & *
      *           'Savings a/c password'. Review both fields.         *
      *  108360 - User could not access Correspondent enquiry through *
      *           Account Master details enquiry, because ZMITEM      *
      *           has the wrong data in it.                           *
      *           Use  hooks GL3271C116, GL3271C117, GL3271C118,      *
      *           GL3271C119, GL3271C120, GL3271C121, GL3271C122,     *
      *           GL3271C123 and GL3271C124 to update ZMITEM via      *
      *           hook GL3271CORM.                                    *
      *  CCB002 - COB Performance Enhancements                        *
      *           Access now via access object                        *
      *           Change MEMOS processing to use access objects.      *
      *  104058 - Set PTFR to blanks if Bank Ports and screen is blank*
      *  S01408 - Addition of core hook GL3271C124                    *
      *           Addition of core hook GL3271C123                    *
      *           Addition of core hook GL3271C122                    *
      *           Addition of core hook GL3271C121                    *
      *           Addition of core hook GL3271C120                    *
      *           Addition of core hook GL3271C119                    *
      *           Addition of core hook GL3271C118                    *
      *           Addition of core hook GL3271C117                    *
      *           Addition of core hook GL3271C116                    *
      *  S01408 - Addition of core hook GL3271IIP9                    *
      *         - Addition of core hook GL3271C115                    *
      *         - Addition of core hook GL3271C114                    *
      *         - Addition of core hook GL3271C113                    *
      *         - Addition of core hook GL3271C112                    *
      *         - Addition of core hook GL3271C111                    *
      *  S01408 - Addition of core hook GL3271C110                    *
      *  S01408 - Addition of core hook GL3271C109                    *
      *         - Addition of core hook GL3271C108                    *
      *         - Addition of core hook GL3271C107                    *
      *         - Addition of core hook GL3271C106                    *
      *         - Addition of core hook GL3271C105                    *
      *         - Addition of core hook GL3271C104                    *
      *         - Addition of core hook GL3271C103                    *
      *         - Addition of core hook GL3271C102                    *
      *         - Addition of core hook GL3271C101                    *
      *         - Addition of core hook GL3271C100                    *
      *         - Addition of core hook GL3271CP99                    *
      *         - Addition of core hook GL3271CP98                    *
      *         - Addition of core hook GL3271CP97                    *
      *         - Addition of core hook GL3271CP96                    *
      *         - Addition of core hook GL3271CP95                    *
      *         - Addition of core hook GL3271CP94                    *
      *         - Addition of core hook GL3271CP93                    *
      *         - Addition of core hook GL3271CP92                    *
      *         - Addition of core hook GL3271CP91                    *
      *         - Addition of core hook GL3271CP90                    *
      *         - Addition of core hook GL3271CP89                    *
      *         - Addition of core hook GL3271CP88                    *
      *         - Addition of core hook GL3271CP87                    *
      *         - Addition of core hook GL3271CP86                    *
      *         - Addition of core hook GL3271CP85                    *
      *         - Addition of core hook GL3271CP84                    *
      *         - Addition of core hook GL3271CP83                    *
      *         - Addition of core hook GL3271CP82                    *
      *         - Addition of core hook GL3271CP81                    *
      *         - Addition of core hook GL3271EEP1                    *
      *         - Addition of core hook GL3271FFP2                    *
      *         - Addition of core hook GL3271FFP1                    *
      *         - Addition of core hook GL3271IIP8                    *
      *         - Addition of core hook GL3271IIP7                    *
      *         - Addition of core hook GL3271IIP6                    *
      *         - Addition of core hook GL3271IIP5                    *
      *         - Addition of core hook GL3271IIP4                    *
      *         - Addition of core hook GL3271IIP3                    *
      *         - Addition of core hook GL3271IIP2                    *
      *         - Addition of core hook GL3271OOP1                    *
      *  CAC001 - Profit Centre Accounting Development:               *
      *           Allow profit centres for retail and nostro          *
      *           accounts only.                                      *
      *  103444 - When account details called via linked enquiry from *
      *           EM, do not load all accounts starting from selected *
      *           account into subfile.                               *
      *  094409 - Do not allow 'E' for statement Frequency if Turnover*
      *           Statements from Retail Features ICD is 'N'.         *
      *  099613 - When an error message is sent (e.g. if a user tries *
      *           to amend a closed account), field ERR is set to 'E'.*
      *           This needs to be reset after the message is sent,   *
      *           else the pgm locks up if Rollup/Rolldown is pressed.*
      *  S01408 - Addition of core hook GL3271CP77                    *
      *                                 GL3271CP78                    *
      *                                 GL3271CP79                    *
      *                                 GL3271CP80                    *
      *  098400 - Convert a/c name to upper case if neccesary before  *
      *           comparing to name input on screen.                  *
      *                                                               *
      *  S01408 - Addition of core hook GL3271CP68                    *
      *                                 GL3271CP69                    *
      *                                 GL3271CP70                    *
      *                                 GL3271CP71                    *
      *                                 GL3271CP72                    *
      *                                 GL3271CP73                    *
      *                                 GL3271CP74                    *
      *                                 GL3271CP75                    *
      *                                 GL3271CP76                    *
      *  CPM004 - Bank Portfolios                                     *
      *  S01408 - Addition of core hook GL3271CP62                    *
      *                                 GL3271CP63                    *
      *                                 GL3271CP64                    *
      *                                 GL3271CP65                    *
      *                                 GL3271CP66                    *
      *                                 GL3271CP67                    *
      *  S01408 - Addition of core hook GL3271IIP1                    *
      *                                 GL3271CP56                    *
      *                                 GL3271CP57                    *
      *                                 GL3271CP58                    *
      *                                 GL3271CP59                    *
      *                                 GL3271CP60                    *
      *                                 GL3271CP61                    *
      *  095242 - Retail accounts for Portfolio Lending customers     *
      *           should use account codes with valid instrument types*
      *  S01408 - Addition of core hook GL3271CP50                    *
      *                                 GL3271CP51                    *
      *                                 GL3271CP52                    *
      *                                 GL3271CP53                    *
      *                                 GL3271CP54                    *
      *                                 GL3271CP55                    *
      *  S01408 - Addition of core hook GL3271CP36                    *
      *                                 GL3271CP37                    *
      *                                 GL3271CP38                    *
      *                                 GL3271CP39                    *
      *                                 GL3271CP40                    *
      *                                 GL3271CP41                    *
      *                                 GL3271CP42                    *
      *                                 GL3271CP43                    *
      *                                 GL3271CP44                    *
      *                                 GL3271CP45                    *
      *                                 GL3271CP46                    *
      *                                 GL3271CP47                    *
      *                                 GL3271CP48                    *
      *                                 GL3271CP49                    *
      *  091796 - DECIMAL DATA ERROR OCCURS AFTER READING TABTBRE.    *
      *           THIS SHOULD ONLY BE READ IF RETAIL III IS ON.       *
      *  093216 - CALL SUBR #AUTH BEFORE CHECK ACTION CODE 'A' AND 'D'*
      *  092290 - If customer is a PM customer and the account retail,*
      *           the account code must be defined with a valid PM    *
      *           instrument type before definition of a portfolio    *
      *           ref. for the account.                               *
      *         - Use *IN74 for Profit Centres Used flag as *IN45 is  *
      *           used by Portfolio Management                        *
      *         - Complete 080620 - display profit centre only if     *
      *           Profit Centres Used flag is 'Y'                     *
      *  S01408 - Addition of core hook GL3271CP35                    *
      *  S01408 - Addition of core hook GL3271CP34                    *
      *  S01408 - Addition of core hook GL3271CP27                    *
      *           Addition of core hook GL3271CP28                    *
      *           Addition of core hook GL3271CP29                    *
      *           Addition of core hook GL3271CP30                    *
      *           Addition of core hook GL3271CP31                    *
      *           Addition of core hook GL3271CP32                    *
      *           Addition of core hook GL3271CP33                    *
      *  087222 - IF AN ACCOUNT IS OPENED AND CLOSED ON SAME DAY,     *
      *           SHOULD ADD 1 TO NORE RATHER THAN SUB 1              *
      *  084065 - The default Statement Frequency from the GL ICD     *
      *           record SdGelrPd is not being used as the default    *
      *           in the creation of new accounts.                    *
      *  079126 - Address Reference 'B' not accepted after incorrect  *
      *           Address Reference entered.                          *
      *  083651 - Condition the use of RE update files only if the    *
      *           RE and/or IOA modules are available (U1).           *
      *  S01408 - Addition of core hook GL3271CP26                    *
      *           Addition of core hook GL3271CP25                    *
      *           Addition of core hook GL3271CP24                    *
      *  CRT001 - Retail Teller System.                               *
      *  S01408 - Addition of core hook GL3271IIPG                    *
      *           Addition of core hook GL3271CP18                    *
      *           Addition of core hook GL3271CP19                    *
      *           Addition of core hook GL3271CP20                    *
      *           Addition of core hook GL3271CP21                    *
      *           Addition of core hook GL3271CP22                    *
      *           Addition of core hook GL3271CP23                    *
      *  080620 - Do not display the 'Profit Centre' text if the ICD  *
      *           has been set up with 'Profit Centres Used' flag     *
      *           (BKPRCU) set to 'N'.                                *
      *  S01408 - Addition of core hook GL3271FFPG                    *
      *           Addition of core hook GL3271CCP1                    *
      *           Addition of core hook GL3271CCP2                    *
      *           Addition of core hook GL3271CCP3                    *
      *           Addition of core hook GL3271CCP4                    *
      *           Addition of core hook GL3271CCP5                    *
      *           Addition of core hook GL3271CCP6                    *
      *           Addition of core hook GL3271CCP7                    *
      *           Addition of core hook GL3271CCP8                    *
      *           Addition of core hook GL3271CCP9                    *
      *           Addition of core hook GL3271CP10                    *
      *           Addition of core hook GL3271CP11                    *
      *           Addition of core hook GL3271CP12                    *
      *           Addition of core hook GL3271CP13                    *
      *           Addition of core hook GL3271CP14                    *
      *           Addition of core hook GL3271CP15                    *
      *           Addition of core hook GL3271CP16                    *
      *           Addition of core hook GL3271CP17                    *
      *  078168 - Specify correct facility parameter when calling     *
      *           AOFACTR0                                            *
      *         - Display selected Facility Type on screen            *
      *         - Do not check if facility is on file until user      *
      *           has input/selected facility type and number.        *
      *         - Do not default Facility Number to '01' when         *
      *           displaying error message saying it is non-numeric   *
      *  080038 - Address reference field always in error. Initialise *
      *           error indicator before validation (additional line  *
      *           for fix 075129).                                    *
      *  S01486 - Portfolio Management Upgrade to Release 10.         *
      *  S01522 - User Defined Correspondence                         *
      *  077012 - A) If DR tier/thresh has no base rate but CR does,  *
      *           then CR base rate is added to DR rates 7-11.(BANBRT)*
      *           B) WWDBRT/WWCBRT not initialised for each insertion *
      *           of a new account so DR or CR base for last account  *
      *           will be used if next account only uses spreads.     *
      *  077017 - Now that tiers/threshs allow spreads of 0%, find    *
      *           that the base rate is not added in this case.       *
      *  075510 - Update base rate on STRAN if tiered interest        *
      *  S01408 - Addition of core hook GL3271CCPG                    *
      *  075129 - Cannot amend alternate Name and Address field,      *
      *           always get error message on any entry.              *
      *  074979 - History corruption of REHPOSR3 due to error on      *
      *           STRAN record. CR tiers 7-11 not including base rate.*
      *  074588 - Account sequence is not validated under MBIN=Y.     *
      *  074586 - If take '?' for Cust. Ccy and/or Acod order of      *
      *           validation is unhelpful.                            *
      *  074576 - Screen locks on detail screen from Cust A/C         *
      *           balances linked enquiry. Screen format not set up.  *
      *  074585 - Default Profit Centre processing not working        *
      *           correctly. Account officer parameter needs setting  *
      *           up for profit centre defaulting from matrix.        *
      *  073234 - a) Base rate code selection does not return value   *
      *           to screen and does not check currency.              *
      *           b) Calc. basis & cap. frequency mandatory even if   *
      *           no interest details entered; default to calc. basis *
      *           from SDCURRPD and cap. freq. 'Z'.                   *
      *  072879 - Customer, ccy, & a/c code selection does not return *
      *           value to screen.                                    *
      *  072541 - Should not update MEMOS for non-retail account.     *
      *  030310 - Alternate account fields corrupted because chain is *
      *           executed even if the key for ACNUM is blank.        *
      *           This means that the field NOALT is updated          *
      *           incorrectly.                                        *
      *  064592 - For non retail account 0 are displayed              *
      *           if action code is 'D'                               *
      *  064590 - Field TNLU was being modified due to CHAIN          *
      *           to ACNUM, causing message RE71810 being issued      *
      *           (Record updated by another workstation).            *
      *  060902 - Do not allow opening account over a deleted customer*
      *  060509 - A/C details doesn't show zero amount for fixed com. *
      *  057921 - Next statement date from previous account taken     *
      *           when the field is blank (for freq. Z)               *
      *  055357 - A/C sequence 00 should not be accepted              *
      *  053943 - SCRCD and SDRCD should default to DACO if insert    *
      *           or to RUND if amend.                                *
      *  053200 - 'Encashment facility' field not displayed           *
      *  044443 - Interest details from wrongly defined default to    *
      *           '1' when CCY is not the same.                       *
      *  058065 - Complete fix 41702                                  *
      *  048251 - MSG RE71605 appears when amending calc basis        *
      *  056983 - Incorrect message on last day in month validation   *
      *  47641  - When you try to close an account, it does not       *
      *           check if there is a stopped cheque or a held item   *
      *           in the system                                       *
      *  S01421 - BLI development phase one.                          *
      *           - Amend program to check that any account being     *
      *             closed does not exist on the standing orders file.*
      *  S01413 - Retail 3 Incorporation                              *
      *                                                               *
      *****************************************************************
     FRECCY   IF  E           K        DISK                               113843
      *                                Retail ICD by currency             113843
     F            RECCYAF                           KIGNORE               113843
     F            RECCYZF                           KIGNORE               113843
     F                                              KINFSR *PSSR          113843
     FTABLEV4 IF  E                    DISK
     F                                              KINFSR *PSSR
     FTABTBRE IF  E                    DISK
     F                                              KINFSR *PSSR
     FSDCBRTL1IF  E           K        DISK                           U3
     F                                              KINFSR *PSSR
     FSDACODL1IF  E           K        DISK                               CTI001
     F                                              KINFSR *PSSR          CTI001
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL3271FFP1                                           S01408
     F*                                                                   S01408
     FACNUM   IF  E           K        DISK
     F            ACCNTABF                          KRENAMEACNUMTBF
     F                                              KINFSR *PSSR
     F*                                                                   S01408
     FACCNTTI IF  E           K        DISK                               CTI001
     F            ACCNTABF                          KRENAMEACCNTTBF       CTI001
     F                                              KINFSR *PSSR          CTI001
     F*                                                                   CTI001
     F/COPY WNCPYSRC,GL3271FFP2                                           S01408
     F*                                                                   S01408
     FRELINKL1IF  E           K        DISK
     F                                              KINFSR *PSSR
     FSTOPC   IF  E           K        DISK
     F                                              KINFSR *PSSR
     FHELDIL1 IF  E           K        DISK
     F            HELDIHCF                          KIGNORE
     F                                              KINFSR *PSSR
     FREINT   IF  E           K        DISK
     F                                              KINFSR *PSSR
     FRECRG   IF  E           K        DISK
     F            RECRGAF                           KIGNORE
     F            RECRGZF                           KIGNORE
     F                                              KINFSR *PSSR
     FREDEF   IF  E           K        DISK
     F            REDEFAF                           KIGNORE
     F            REDEFZF                           KIGNORE
     F                                              KINFSR *PSSR
     F**
     FACCBR   UF  E           K        DISK                      A
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     FACCNTLXXIF  E           K        DISK
     F            ACCNTABF                          KRENAMEACCNTLXF
     F                                              KINFSR *PSSR
     F*REIAC***UF  E           K        DISK                      A       083561
     FREIAC   UF  E           K        DISK                      A    U1  083651
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     FREIACXX IF  E           K        DISK
     F            REIACAF                           KRENAMEREIACAXF
     F            REIACDF                           KRENAMEREIACDXF
     F            REIACZF                           KRENAMEREIACZXF
     F                                              KINFSR *PSSR
     FRECOMXX IF  E           K        DISK
     F            RECOMDF                           KRENAMERECOMXF
     F                                              KINFSR *PSSR
     FSTANDL2 IF  E           K        DISK                               S01421
     F            STANDSBF                          KRENAMESTAND2         S01421
     F                                              KINFSR *PSSR          S01421
     FSTANDL3 IF  E           K        DISK                               S01421
     F            STANDSBF                          KRENAMESTAND3         S01421
     F                                              KINFSR *PSSR          S01421
     F*RECOM***UF  E           K        DISK                      A       083561
     FRECOM   UF  E           K        DISK                      A    U1  083651
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     F*MEMOS***UF  F      40            DISK                           U1 CCB002
     F*********                                     KCOMIT                CCB002
     F*********                                     KINFSR *PSSR          CCB002
     FMEMOSL2 O   E           K        DISK                      A    U1  CCB002
     F                                              KCOMIT                CCB002
     F                                              KINFSR *PSSR          CCB002
     F***STRTAN*UF  E                    DISK                                                 CRE005
     F**********                                    KCOMIT                                    CRE005
     F**********                                    KINFSR *PSSR                              CRE005
     F*REACR***UF  E           K        DISK                      A       083561
     FREACR   UF  E           K        DISK                      A    U1  083651
     F            REACRZF                           KIGNORE
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     F*REACRZ**UF  E                    DISK                              083561
     FREACRZ  UF  E                    DISK                           U1  083651
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     F*REHISBL*UF**E           K        DISK                      A       083561
     FREHISBL UF  E           K        DISK                      A    U1  083651
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     F*REHISLS*UF**E           K        DISK                              083561
     FREHISLS UF  E           K        DISK                           U1  083651
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     FACCNTAC UF  E                    DISK
     F            ACCNTACF                          KRENAMEACCNTCXF
     F                                              KCOMIT
     F                                              KINFSR *PSSR
     F*                                                                   CRT001
     F***REAPWDL0UF  E           K        DISK                      A                  CRT001 CSD101
     F*                                             KCOMIT                CRT001
     F**********                                    KINFSR *PSSR                       CRT001 CSD101
     F*                                                                   CRT001
     FACCNTBXCUF  E           K        DISK                      A        CRE001
     F                                              KCOMIT                CRE001
     F                                              KINFSR *PSSR          CRE001
     FREODHSL0UF  E           K        DISK                      A        CRE001
     F                                              KCOMIT                CRE001
     F                                              KINFSR *PSSR          CRE001
     F/COPY WNCPYSRC,GL3271F001
     FFCLTY   IF  E           K        DISK
     F            FCLTYHHF                          KIGNORE
     F            FCLTYFNF                          KIGNORE
     F            FCLTYZZF                          KIGNORE
     F                                              KINFSR *PSSR
     FLEAGFCL0IF  E           K        DISK                                             BUG5948
     F            FCLTYHHF                          KIGNORE                             BUG5948
     F            FCLTYFNF                          KIGNORE                             BUG5948
     F            FCLTYZZF                          KIGNORE                             BUG5948
     F            FCLTYFMF                          KRENAMELEAGFMD0                     BUG5948
     F                                              KINFSR *PSSR                        BUG5948
     FPMPORTLLIF  E           K        DISK                           UC  S01486
     F                                              KINFSR *PSSR          S01486
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL3271FFPG                                           S01408
     F*                                                                   S01408
     FRERCHHPAUF  E                    DISK                                                   CRE005
     F                                              KCOMIT                                    CRE005
     F                                              KINFSR *PSSR                              CRE005
     FRERCH1PDUF  E                    DISK                      A                            CRE005
     F                                              KCOMIT                                    CRE005
     F                                              KINFSR *PSSR                              CRE005
     FRERCH2PDUF  E                    DISK                      A                            CRE005
     F                                              KCOMIT                                    CRE005
     F                                              KINFSR *PSSR                              CRE005
     FRERCH3PDUF  E                    DISK                      A                            CRE005
     F                                              KCOMIT                                    CRE005
     F                                              KINFSR *PSSR                              CRE005
     FACCPTFR IF  E           K        DISK                               178695
     F            ACCNTABF                          KRENAMEACCPTFRF       178695
     F                                              KINFSR *PSSR          178695
     FSDNOSTL2IF  E           K        DISK                               100296
     FGL3271DFCF  E                    WORKSTN
     F                                        RRN   KSFILE GL3271S0
     FGL3271AUO   E                    PRINTER                        UC
     F*EUACMLL6IF*E********** K        DISK                        138518 153092
     FRESWEPL4IF  E           K        DISK                               153092
     F** LF to allow a chain on prime linked account.                     154206
     FRELINKJ2IF  E           K        DISK                               154206
     F                                              KINFSR *PSSR          154206
     FSDCTRYL2IF  E           K        DISK                               CFT004
     F                                              KINFSR *PSSR          CFT004
     FINPAYIB IF  E           K        DISK                               CFT004
     F                                              KINFSR *PSSR          CFT004
     FACCNTL6 IF  E           K        DISK                               CFT004
     F            ACCNTABF                          KRENAMEACCNT6         CFT004
     F                                              KINFSR *PSSR          CFT004
     FMBRBS   IF  E           K        DISK         KINFSR *PSSR                            AR703901
      ** Valid Booking Branches by User.                                                    AR703901
      *                                                                                     AR703901
     FGLACNTL3IF  E           K        DISK         KINFSR *PSSR                              CAP205
     F*                                                                                       CRE101
     F/COPY OFCPYSRCZ,CRE101_074                                                              CRE101
     FREAPRHI0IF  E           K        DISK                                                   CER050
     FREAPRHI1IF  E           K        DISK                                                   CER050
     F            REAPRHD0                          KRENAMEREAPRHD1                           CER050
     F/EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   01   - CFT004 switched on                                   *   CFT004
     F*   02   - Error in IBAN field                                  *   CFT004
     F*   03   - Retail Teller System (CRT001) SAR is switched ON     *   CRT001
     F*   04   - Password on Savings Account (CRT101) SAR is ON       *   CRT001
     F*   05   - Linked Enquiry                                       *
     F****06***-*Passbok*used*flag*is*not*amendable**              CRT001 107478
     F*   06   - Passbooks used by system & a/c is savings a/c        *   107478
     F*   07   - Error in Passbook Used flag field                    *   CRT001
     F****08***-*Error*in*Password**                               CRT001 107478
     F*   08   - Password SAR installed & a/c is savings a/c          *   107478
     F*   09   - Switchable feature CRE001 is ON                      *   CRE001
     F*   10   - Used by TABLEV4                                      *
     F*   10   - Indicator re-used when Feature CAP205 is ON          *                       CAP205
     F*  11-18 - Commision indicators                                 *
     F*   19   - Protect/Non Display BRT Category                     *
     F*   20   - SFLEND                                               *   094409
     F*   21   - SFLDSP                                               *   094409
     F*   22   - SFLDSPCTL                                            *   094409
     F*   23   - EOF for ACCNTLX                                      *
     F*   24   - SFLMSGRCD                                            *   094409
     F*   25   - Rollup pressed                                       *
     F*   26   - Rolldown pressed                                     *
     F*   27   - Statement balances in Euros available                *   CEU013
     F*   28   - Portfolio Management is switched on.                 *   S01486
     F*   29   - Retail Number is used                                *
     F*   30   - Insert Mode                                          *
     F*   31   - Amend Mode                                           *
     F*   32   - Enquiry Mode                                         *
     F*   33   - Delete Mode
     F*   34   - No Commissions                                       *
     F*   35   - Archiving frequency used                             *
     F*   36   - Test for first output of access object fail message. *
     F*   37   - Base rate category in error                          *
     F*   37   - Error in TI Account                                  *   CTI001
     F*   38   - Customer not Portfolio Customer                      *   S01486
     F*   39   - Amendment not allowed                                *
     F*   40   - Insert Authorisation                                 *
     F*   41   - Amend Authorisation                                  *
     F*   42   - Confirmation indicator                               *
     F*   45   - Invalid Portfolio Management customer                *   094409
     F*   46   - Secondary account                                    *   094409
     F*   47   - Prime account                                        *   094409
     F*   48   - Retail Number is used                                *
     F*   49   - Review from or Subfile Entry                         *
     F*   50   - Error in Action Code                                 *
     F*        - Chain failed                                         *
     F*   51   - Error in KEY(SKEY)                                   *
     F*   52   - Error in Review From                                 *
     F*   52   - Error on statement balances in Euros field.          *   CEU013
     F*   53   - Error in customer                                    *
     F*        - Error in Cr. Interest Margin Override (screen 4)     *   CDE002
     F*   54   - Error in currency                                    *
     F*        - Error in Cr. Interest Margin (screen 4)              *   CDE002
     F*   55   - Error in account code                                *
     F*        - Error in Dr. Interest Margin Override (screen 4)     *   CDE002
     F*   56   - Error in account sequence                            *
     F*        - Error in Dr. Interest Margin (screen 4)              *   CDE002
     F*   57   - Error in branch                                      *
     F*   58   - Error in retail number                               *
     F*   59   - Error in account name(F1)                            *
     F*  60-74 - Common error at validation field indicator           *
     F*   74   - Profit centres used flag on GL ICD is 'Y'            *
     F*   75   - Display date account closed                          *
     F*   76   - Record key not unique in ACCNTTI                     *   CTI001
     F*   78   - Screen E,I,D,A                                       *
     F*   79   - Screen I,A,D,E                                       *
     F*  80-81 - Chain failed                                         *
     F*   84   - EOF for ACNUM                                        *
     F*   85   - Testbit Indicator                                    *
     F*   86   - Error in Additional Overdraft Rate                   *   CRE001
     F****87***-*MEMOS*Header                                         *   CCB002
     F*   87   - Trade Innovation is switched on                      *   CTI001
     F*   88   - Error in TI Account Number                           *   CTI001
     F****88***-*MEMOS*Detail                                         *   CCB002
     F*   89   - I/O indicator                                        *
     F*   89   - On when user can enter TI Account No. & Suffix       *   CTI001
     F*   91   - TI account not found                                 *   160464
     F*   92   - CER050 switched on                                   *                       CER050
     F*   98   - Date format                                          *
     F*   U1   - Retail 3 or Interest on Accounts installed           *
     F*   U3   - Base Rate Category                                   *
     F*  U7-U8 - Database Error                                       *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  MAIN     - MAIN PROCESSING                                   *
     F*  #P10F0   - PROCESS START SCREEN                              *
     F*  #V10F0   - PROCESS VALIDATION OF START SCREEN                *
     F*  #P10S0   - PROCESS REVIEW FROM SUBFILE                       *
     F*  #V10S0   - PROCESS VALIDATION OF SUBFILE                     *
     F*  #P10FK   - INSERT AND DELETE MODE                            *
     F*  #V10FK   - PROCESS VALIDATION OF 'FK' FORMAT                 *
     F*  #P10F1   - PROCESS ACCOUNT MASTER DETAILS                    *
     F*  #DEFT    - TO PROCESS DEFAULT VALUES IN INSERT MODE          *
     F*  #DEFT2   - TO PROCESS DEFAULT VALUES IN INSERT MODE FOR      *   CRE007
     F*             ACCOUNT OTHER DETAILS SCREEN.                     *   CRE007
     F*  #V10F1   - PROCESS VALIDATION OF 'F1' FORMAT                 *
     F*  #P10F2   - PROCESS DEBIT INTEREST DETAILS                    *
     F*  #V10F2   - PROCESS VALIDATION OF 'F2' FORMAT                 *
     F*  #P10F3   - PROCESS CREDIT INTEREST DETAILS                   *
     F*  #V10F3   - PROCESS VALIDATION OF 'F3' FORMAT                 *
     F*  #P10F4   - PROCESS COMMISSIONS DETAILS                       *
     F*  #V10F4   - PROCESS VALIDATION OF 'F4' FORMAT                 *
     F*  #P10F5   - PROCESS OTHER DETAILS                             *
     F*  #V10F5   - PROCESS VALIDATION OF 'F5' FORMAT                 *
     F*  #VLBRT   - VALIDTAE BASE RATE CODE                           *
     F*  #CMDSR   - LINKED ENQUIRY FUNCTION CHECK                     *
     F*  #RETSR   - LINKED ENQUIRY TERMINATION                        *
     F*  #AUTH    - CHECK ACTION CODE AND BRANCH AUTHORITY            *
     F*  #DIR     - TO PROCESS FORMAT AND MODE                        *
     F*  #P1001   - PROCESS INITIALIZATION                            *
     F*  #P1005   - SET WORK FIELDS TO BLANK                          *
     F*  #P1006   - SET SCREEN FIELDS TO BLANK                        *
     F*  #RETTS   - PROCESS VALIDATION OF RETAIL NUMBER               *
     F*  #P1020   - TRANSFER FILE FIELDS IN WORK FIELDS               *
     F*  #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)*
     F*  #P1031   - TRANSFER WORK FIELDS IN SCREEN FIELDS(1ST FORMAT) *
     F*  #P1032   - TRANSFER WORK FIELDS IN SCREEN FIELDS(2ND FORMAT) *
     F*  #P1033   - TRANSFER WORK FIELDS IN SCREEN FIELDS(3RD FORMAT) *
     F*  #P1034   - TRANSFER WORK FIELDS IN SCREEN FIELDS(4TH FORMAT) *
     F*  #P1035   - TRANSFER WORK FIELDS IN SCREEN FIELDS(5TH FORMAT) *
     F*  #P1002   - WRITE PROCESSING                                  *
     F*  #P1003   - UPDATE PROCESSING                                 *
     F*  #P1004   - DELETE PROCESSING                                 *
     F*  #VMD11   - MODULUS 11 VALIDATION                             *                       CGL062
     F*  *PSSR    - TO PROCESS DATA BASE ERRORS                       *
     F*                                                               *
     F*  STANDARD SUBROUTINES                                         *
     F*  ZDATE1   - TO FORMAT AN ALPHA DATE IN MIDAS NUMBER           *
     F*  ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE            *
     F*  ZEDIT    - TO FORMAT A NUMERIC FIELD WITH DECIMAL POINT      *
     F*  ZALIGN   - TO VALIDATE A NUMERIC FIELD                       *
     F*  ZTNLU1   - TO RETRIEVE THE NEXT TRANSACTION NUMBER           *
     F*                                                               *
     F*  EXTERNAL ROUTINES CALLED                                     *
     F*  ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE   *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E**
     E** ARRAY FOR ZDATE SUBROUTINE
     E*                                                                   S01408
     E/COPY WNCPYSRC,GL3271EEP1                                           S01408
     E*                                                                   S01408
     E                    WEOF    1   1 20               EMPTY FILE
     E                    STAMP   1   1 26                                                    CPK015
      ** Array containing dummy timestamp                                                     CPK015
     E                    CPY@    1   1 80               COPYRIGHT
     E                    ZMDY   13  13  3 0
     E                    ZYDY    4   4  4 0
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    NUM    10  10  1
     E/COPY WNCPYSRC,GL3271E003
     E                    FREQ   14  14  1
     E/COPY WNCPYSRC,GL3271E002
     E                    ERCD       19  4               ERROR CODES
     E*
     E                    SEQ         2  1
     E                    RETA       10  1
     E                    ZONE        2  1               TEST ARRAY
     E                    ARR        10  1               ADDRESS ARRAY
     E                    ADR        10  1               ADDRESS ARRAY
     E                    CEX        15  1
     E                    GRP         8  1               CLIENT GROUP CODE
     E                    IN1         8  1               FIXED COM.
     E                    IN2         8  1               DB. INTEREST COM.
     E                    IN3         8  1               INACT. ACC. COM.
     E                    IN4         8  1               MAX. DB. BAL. COM
     E                    IN5         8  1               MIN. CR. BAL. COM
     E                    IN6         8  1               ACC. COM BAL. COM
     E                    IN7         8  1               DAIL. STAT.   COM
     E** ARRAY FOR ZALIGN
     E                    ZA1        16  1               ZALIGN/ZEDIT ARRAY
     E**
     E                    ZA2        16  1               ZALIGN/ZEDIT ARRAY
     E** ARRAY FOR RATE AND BALANCE
     E                    RATN        6 11 0 BALN   15 0
     E                    WWVBRX    900  3                                                  AR703901     
      ** Sum of weightings array                                                              CGL062
     E                    SUM        10  3 0                                                  CGL062
      ** Check Digit array                                                                    CGL062
     E                    CHECKD 11  11  1 0                                                  CGL062
      *                                                                   208221
     E/COPY ZSRSRC,ZASIGNZ1                                               208221
      *                                                                   208221
     E/COPY ZSRSRC,ZFRPEDZ1                                               208221
     E/COPY WNCPYSRC,GL3271E001
     I********************************************************************
     I**
     I/COPY WNCPYSRC,GL3271I004
      *                                                                   107478
     ITABTBREF                                                            107478
      ** Rename ICD Passbooks Used on Savings A/c flag                    107478
      *                                                                   107478
     I              PBKU                            ICPBKU                107478
     ITABLEV4F                                                                                CSD031
      ** Rename ICD zone                                                                      CSD031
      *                                                                                       CSD031
     I              ZONE                            ICZONE                                    CSD031
      *                                                                   107478
     I******                                                              CCB002
     I*****MEMO FILE HEADER                                               CCB002
     I******                                                              CCB002
     I******MEMOS   NS  87   1 CH                                         CCB002
     I******                                        1   1 RECI            CCB002
     I******                                        2   2 BUSY            CCB002
     I******                                        3   3 DUBI            CCB002
     I******                                    P   7  100FLSZM           CCB002
     I******                                    P  11  130NAMR            CCB002
     I******                                        1  40 MEMHED          CCB002
     I******                                                              CCB002
     I*****SHADOW BALANCE RECORD                                          CCB002
     I******                                                              CCB002
     I******        NS  88   1 CD                                         CCB002
     I******       OR        1 C*                                         CCB002
     I******       OR        1 C                                          CCB002
     I******                                        1   1 RECI            CCB002
     I******                                        2  160LDBLN           CCB002
     I******                                       17  310CLBLN           CCB002
     I******                                       32  36 ZZ005           CCB002
     I******                                    P  37  380INLU            CCB002
     I******                                    P  39  400BNLU            CCB002
     I******                                                              CCB002
     I*****CATCHALL FOR DELETED RECORDS                                   CCB002
     I******                                                              CCB002
     I******  NS                                                          CCB002
     I*                                                                   153092
     IACCNTABF                                                                                CPK015
     I              TMST                            ABTMST                                    CPK015
     IRESWEPD0                                                            153092
     I              RECI                            SWRECI                153092
     I              DRBR                            SWDRBR                153092
     I              DCUS                            SWDCUS                153092
     I              DACD                            SWDACD                153092
     I              DACS                            SWDACS                153092
     I              DRAN                            SWDRAN                153092
     I              CBRC                            SWCBRC                153092
     I              CCUS                            SWCCUS                153092
     I              CSCA                            SWCSCA                153092
     I              CACD                            SWCACD                153092
     I              CRAN                            SWCRAN                153092
     I              BRCA                            SWBRCA                153092
     I              MBSI                            SWMBSI                153092
     I              CCY                             SWCCY                 153092
     I              NXTP                            SWNXTP                153092
     I              DLPY                            SWDLPY                153092
     I              PAYF                            SWPAYF                153092
     I              DYTP                            SWDYTP                153092
     I              PNAR                            SWPNAR                153092
     I              PRFC                            SWPRFC                153092
     I              TRAT                            SWTRAT                153092
     I              LCD                             SWLCD                 153092
     I              CHTP                            SWCHTP                153092
     I              TNLU                            SWTNLU                153092
     I              CCYC                            SWCCYC                153092
     I*                                                                   153092
     IFUSIONF1
     I              BRCA                            FBRCA
     I              CNUM                            FCUST
     I/COPY WNCPYSRC,GL3271I006
     I              CCY                             LTCCY
     I/COPY WNCPYSRC,GL3271I007
     I              ACOD                            FACOD
     I              ACSQ                            FACSQ
     I              LTAB                            LTABD
     IFUSIONJF                                                            154206
     I              BRCA                            JBRCA                 154206
     I              CNUM                            JCUST                 154206
     I              CCY                             JTCCY                 154206
     I              ACOD                            JACOD                 154206
     I              ACSQ                            JACSQ                 154206
     I              LTAB                            JTABD                 154206
     I**
     I** RENAME REACR FIELDS
     I**
     IREACRAF
     I              RECI                            RARECI
     I              CUST                            RAPNP8
     I              ACCY                            RAACCY
     I              ACOD                            RAACOD
     I              ASEQ                            RAASEQ
     I              BRCA                            RABRCA
     I              ZZ109                           RAZ109
     IREACRDF
     I              RECI                            RDRECI
     I              CUST                            RDPNP8
     I              ACCY                            RDACCY
     I              ACOD                            RDACOD
     I              ASEQ                            RDASEQ
     I              BRCA                            RDSPTA
     I              ZZ011                           RDZ011
     I              TNLU                            RDTNLU
     I              ORED                            RDORED
     I              LCD                             RDLCD
     I              CHTP                            RDCHTP
     I              DAIC1                           RDDAIC
     I              MADI                            RDMADI
     I              GADI                            RDGADI
     I              CAIC1                           RDCAIC
     I              MACI                            RDMACI
     I              GACI                            RDGACI
     I              HISB                            RDHISB
     I              BFDR                            RDBFDR
     I              BFCR                            RDBFCR
     I              ZZ022                           RDZ022
     I              MNBL                            RDMNBL
     I              TDINT                           RDTDIN
     I              TCINT                           RDTCIN
     I              TEGLIS                          RDEGLI
     I              POSTI                           RDPOST
     I              CINW                            RDCINW
     I              DINW                            RDDINW
     IREACRZF
     I              RECI                            RZRECI
     I              CUST                            RZPNP8
     I              ACCY                            RZACCY
     I              ACOD                            RZACOD
     I              ASEQ                            RZASEQ
     I              BRCA                            RZBRCA
     I              ZZ011                           RZZ011
     I              TNLU                            RZTNLU
     I              IRRI                            RZIRRI
     I              NORE                            RZNORE
     I              ZZ091                           RZZ091
     I**
     I** RENAME FIELDS FROM REHISBL
     I**
     IREHISPPF
     I              RECI                            BRECI
     I              ZZ001                           BZZ001
     I              BRCA                            BBRCA
     I              CNUM                            BCNUM
     I              CCY                             BCCY
     I              ACOD                            BACOD
     I              ACSQ                            BACSQ
     I              HISD                            BHISD
     I              HISB                            BHISB
     I              MNBL                            BMNBL
     I              CHGAR                           BCHGAR
     I              TCHGAR                          BTCHGR
     I              CHGAN                           BCHGAN
     I              TCHGAN                          BTCHGN
     I              DMVT                            BDMVT
     I              DICT                            BDICT
     I              DRCB                            BDRCB
     I              DRIR                            BDRIR
     I              DRCD                            BDRCD
     I              DAID                            BDAID
     I              MADI                            BMADI
     I              TMADI                           BTMADI
     I              PDID                            BPDID
     I              DMINT                           BDMINT
     I              CMVT                            BCMVT
     I              CICT                            BCICT
     I              CRCB                            BCRCB
     I              CRIR                            BCRIR
     I              CRCD                            BCRCD
     I              CAID                            BCAID
     I              MACI                            BMACI
     I              TMACI                           BTMACI
     I              PCID                            BPCID
     I              CMINT                           BCMINT
     I              DICI                            BDICI
     I              CICI                            BCICI
     I              DRCI                            BDRCI
     I              CRCI                            BCRCI
     I              VDTC                            BVDTC
     I              ADTY                            BADTY
     I              ALTI                            BALTI
     I              MNBCP                           BMNBCP
     I              LGID                            BLGID
     I              VALL                            BVALL
     I              LINK                            BLINK
     I              ZZ008                           BZ008
     I*
     I** RENAME REHISPS FILE FIELDS
     I*
     IREHISPSF
     I              RECI                            PRECI
     I              ZZ001                           PZZ001
     I              BRCA                            PBRCA
     I              CNUM                            PCNUM
     I              CCY                             PCCY
     I              ACOD                            PACOD
     I              ACSQ                            PACSQ
     I              HISD                            PHISD
     I              HISB                            PHISB
     I              MNBL                            PMNBL
     I              PCHGAR                          PPCHGR
     I              TCHGAR                          PTCHGR
     I              PCHGAN                          PPCHGN
     I              TCHGAN                          PTCHGN
     I              DICT                            PDICT
     I              DRCB                            PDRCB
     I              DRIR                            PDRIR
     I              DRCD                            PDRCD
     I              DAIC                            PDAIC
     I              PMADI                           PPMADI
     I              TMADI                           PTMADI
     I              PDID                            PPDID
     I              DMINT                           PDMINT
     I              SGADI                           PSGADI
     I              DRIP                            PDRIP
     I              SDICI                           PSDICI
     I              DRIS                            PDRIS
     I              SDACP                           PSDACP
     I              SDCI                            PSDCI
     I              CICT                            PCICT
     I              CRCB                            PCRCB
     I              CRIR                            PCRIR
     I              CRCD                            PCRCD
     I              CAIC                            PCAIC
     I              PMACI                           PPMACI
     I              TMACI                           PTMACI
     I              PCID                            PPCID
     I              CMINT                           PCMINT
     I              SGACI                           PSGACI
     I              CRIP                            PCRIP
     I              SCICI                           PSCICI
     I              CRIS                            PCRIS
     I              SCACP                           PSCACP
     I              SCCI                            PSCCI
     I              STBL                            PSTBL
     I              CHGP                            PCHGP
     I              SCHAC                           PSCHAC
     I              MNBCP                           PMNBCP
     I              SCHGI                           PSCHGI
     I              TEGLIS                          PTGLIS
     I              ZZ025                           PZZ025
     I**                                                                                      CRE005
     I** Rename RERCHHPA file fields                                                          CRE005
     I**                                                                                      CRE005
     IRERCHHA0                                                                                CRE005
     I              RECI                            HHRECI                                    CRE005
     I**                                                                                      CRE005
     I** Rename RERCH1PD file fields                                                          CRE005
     I**                                                                                      CRE005
     IRERCH1D0                                                                                CRE005
     I              RECI                            S1RECI                                    CRE005
     I              CNUM                            S1CNUM                                    CRE005
     I              CCY                             S1CCY                                     CRE005
     I              ACOD                            S1ACOD                                    CRE005
     I              ACSQ                            S1ACSQ                                    CRE005
     I              RSEQ                            S1ONE                                     CRE005
     I              CONI                            S1X                                       CRE005
     I              ACNO                            S1ACNO                                    CRE005
     I              PSTD                            S1RUND                                    CRE005
     I              VALD                            S1WOLD                                    CRE005
     I              TRAT                            S1TRAT                                    CRE005
     I              PNAR                            S1NARR                                    CRE005
     I              INTP                            S1INTT                                    CRE005
     I              INST                            S1INTS                                    CRE005
     I              DRCR                            S1DRCR                                    CRE005
     I              TIME                            S1TIME                                    CRE005
     I              SPOS                            S1RECO                                    CRE005
     I              BRCA                            S1SPTA                                    CRE005
     I              ZZ001                           S1ATYP                                    CRE005
     I              RVLD                            S1RVLD                                    CRE005
     I              PRIN                            S1BITF                                    CRE005
     I              LRCD                            S1OLDR                                    CRE005
     I              ZZ006                           S1Z006                                    CRE005
     I              INRT                            S1INRT                                    CRE005
     I              BRT                             S1BRIS                                    CRE005
     I              RTSP                            S1WRIS                                    CRE005
     I**                                                                                      CRE005
     I** Rename RERCH2PD file fields                                                          CRE005
     I**                                                                                      CRE005
     IRERCH2D0                                                                                CRE005
     I              RECI                            S2RECI                                    CRE005
     I              CNUM                            S2CNUM                                    CRE005
     I              CCY                             S2CCY                                     CRE005
     I              ACOD                            S2ACOD                                    CRE005
     I              ACSQ                            S2ACSQ                                    CRE005
     I              RSEQ                            S2TWO                                     CRE005
     I              CONI                            S2X                                       CRE005
     I              INTH                            S2INTH                                    CRE005
     I              VALD                            S2WOLD                                    CRE005
     I              DRCR                            S2DRCR                                    CRE005
     I              TIME                            S2TIME                                    CRE005
     I              BRCA                            S2SPTA                                    CRE005
     I**                                                                                      CRE005
     I** Rename RERCH3PD file fields                                                          CRE005
     I**                                                                                      CRE005
     IRERCH3D0                                                                                CRE005
     I              RECI                            S3RECI                                    CRE005
     I              CNUM                            S3CNUM                                    CRE005
     I              CCY                             S3CCY                                     CRE005
     I              ACOD                            S3ACOD                                    CRE005
     I              ACSQ                            S3ACSQ                                    CRE005
     I              RSEQ                            S3THRE                                    CRE005
     I              VALD                            S3WOLD                                    CRE005
     I              RAT1                            RAT3                                      CRE005
     I              DRCR                            S3DRCR                                    CRE005
     I              TIME                            S3TIME                                    CRE005
     I              BRCA                            S3SPTA                                    CRE005
     I              BAL1                            BAL3                                      CRE005
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP2                                           S01408
     I*                                                                   S01408
     IACNUMTBF                                                            064590
      * File ACNUM                                  Format ACNUMTBF       064590
     I              TNLU                            WXTNLU                064590
     I              ODLN                            XXODLN                111124
     I              ODED                            XXODED                111124
     I              DRIF                            XXDRIF                120076
     I              CRIF                            XXCRIF                120076
     I*                                                                   145808
     IFCLTYFMF                                                            145808
     I              SCCY                            XXSCCY                145808
     IRECOMDF                                                             174144
      ** Rename RECI to prevent overwrite from pf/RECOMD, RPG RECOM       174144
      *                                                                   174144
     I              RECI                            RECIRE                174144
     IRECOMXF                                                             174144
      ** Rename RECI to prevent overwrite from pf/RECOMD, RPG RECOMXX     174144
      *                                                                   174144
     I              RECI                            RECIXX                174144
     IREIACDF                                                             174144
      ** Rename RECI to prevent overwrite from pf/REIACD, RPG REIAC       174144
      *                                                                   174144
     I              RECI                            RECIRC                174144
     IREIACDXF                                                            174144
      ** Rename RECI to prevent overwrite from pf/REIACD, RPG REIACXX     174144
      *                                                                   174144
     I              RECI                            RECIRX                174144
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP3                                           S01408
     I*                                                                   S01408
     I*
     I** KEY FIELDS (TAKEN FROM 'KEY' PORTION OF SCREEN)
     I*
     ISCRCTL      DS
     I                                        1   1 WWREVW
     I                                        2   2 DDACTN
     I**********                              3  20 SKEY                                      CGL029
     I**********                             21  38 DDPKEY                                    CGL029
     I**********                             39  40 WWPAG1                                    CGL029
     I**********                             41  42 WWPAG2                                    CGL029
     I                                        3  26 SKEY                                      CGL029
     I                                       27  50 DDPKEY                                    CGL029
     I                                       51  52 WWPAG1                                    CGL029
     I                                       53  54 WWPAG2                                    CGL029
     I**
     I** DATA STRUCTURE FOR SCREEN FIELDS FROM FORMAT F0 TO FK
     I**
     I            DS
     I                                        1   6 SCNUM
     I                                        7   9 SCCY
     I**********                             10  13 SACOD                                     CGL029
     I**********                             14  15 SACSQ                                     CGL029
     I**********                             16  18 SBRCA                                     CGL029
     I**********                             19  28 SACNO                                     CGL029
     I                                       10  19 SACOD                                     CGL029
     I                                       20  21 SACSQ                                     CGL029
     I                                       22  24 SBRCA                                     CGL029
     I                                       25  34 SACNO                                     CGL029
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP7                                           S01408
     I*                                                                   S01408
     I**
     I** DATA STRUCTURE FOR SCREEN FIELDS FROM FORMAT 1 TO 5
     I**
     I            DS
     I                                        1  20 SANAM
     I                                       21  26 SDACO
     I                                       27  32 SDACC
     I                                       33  38 SNSTD
     I                                       39  39 SSTFQ
     I                                       40  41 SENOC
     I                                       42  42 SPTAD
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP5                                           S01408
     I*                                                                   S01408
     I                                       43  52 SREF
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP6                                           S01408
     I*                                                                   S01408
     I                                       53  53 SRAD
     I                                       54  54 SRAC
     I                                       55  55 SBAD
     I                                       56  56 SBAC
     I                                       57  57 SMFFQ
     I                                       58  61 SPRFC
     I                                       77  78 SDRIB
     I                                       79  90 SDRIS
     I                                       91  91 SDSIG
     I                                       92  93 SDICT
     I                                       94  98 SDCST
     I                                       99 104 SDRCD
     I                                      105 110 ODRCD
     I                                      111 111 SDRIC
     I                                      112 117 SNDID
     I                                      118 118 SDRIF
     I**********                            120 134 SDACP                                     CGL029
     I**********                            135 146 SODLN                                     CGL029
     I**********                            147 152 SODED                                     CGL029
     I**********                            153 153 SODSC                                     CGL029
     I**********                            154 155 SCRIB                                     CGL029
     I**********                            156 167 SCRIS                                     CGL029
     I**********                            168 168 SCSIG                                     CGL029
     I**********                            169 170 SCICT                                     CGL029
     I**********                            171 175 SCCST                                     CGL029
     I**********                            176 181 SCRCD                                     CGL029
     I**********                            182 187 OCRCD                                     CGL029
     I**********                            188 188 SCRIC                                     CGL029
     I**********                            189 194 SNCID                                     CGL029
     I**********                            195 195 SCRIF                                     CGL029
     I**********                            197 211 SCACP                                     CGL029
     I**********                            212 213 SCHGT                                     CGL029
     I**********                            214 218 SCHST                                     CGL029
     I**********                            219 233 SCHCP                                     CGL029
     I**********                            234 240 STCHO                                     CGL029
     I**********                            241 251 SCEXA                                     CGL029
     I**********                            252 262 SCEXB                                     CGL029
     I**********                            263 273 SCEXC                                     CGL029
     I**********                            274 281 SCEXD                                     CGL029
     I**********                            288 295 SCEXE                                     CGL029
     I**********                            302 309 SCEXF                                     CGL029
     I**********                            316 317 SNOCC                                     CGL029
     I**********                            318 325 SCEXG                                     CGL029
     I**********                            332 343 SMINB                                     CGL029
     I**********                            344 346 SFACT                                     CGL029
     I**********                            344 3460WFACT                                     CGL029
     I**********                            347 348 SFCNO                                     CGL029
     I**********                            347 3480WFCNO                                     CGL029
     I**********                            349 350 SEFAC                                     CGL029
     I**********                            351 351 SINAI                                     CGL029
     I**********                            352 352 SBRLI                                     CGL029
     I**********                            353 353 SBADI                                     CGL029
     I**********                            354 354 SPTRA                                     CGL029
     I**********                            355 355 SPRCH                                     CGL029
     I**********                            356 356 BRTCA                                     CGL029
     I**********                            357 358 SNSDN                                     CGL029
     I**********                            363 364 SDNCD                                     CGL029
     I**********                            365 366 SCNCD                                     CGL029
     I**********                            367 369 SDRBR                                     CGL029
     I**********                            370 372 SCRBR                                     CGL029
     I**********                            373 375 SCHBR                                     CGL029
     I**********                            376 393 SLINK                                     CGL029
     I**********                            394 397 SPTFR                              S01486 CGL029
     I**********                            398 398 SPBKU                              CRT001 CGL029
     I**********                            399 413 SPSWD                              CRT001 CGL029
     I**********                            414 414 STIAC                              CTI001 CGL029
     I**********                            415 420 STIAN                              CTI001 CGL029
     I**********                            421 423 STIAS                              CTI001 CGL029
     I                                      120 140 SDACP                                     CGL029
     I                                      141 152 SODLN                                     CGL029
     I                                      153 158 SODED                                     CGL029
     I                                      159 159 SODSC                                     CGL029
     I                                      160 161 SCRIB                                     CGL029
     I                                      162 173 SCRIS                                     CGL029
     I                                      174 174 SCSIG                                     CGL029
     I                                      175 176 SCICT                                     CGL029
     I                                      177 181 SCCST                                     CGL029
     I                                      182 187 SCRCD                                     CGL029
     I                                      188 193 OCRCD                                     CGL029
     I                                      194 194 SCRIC                                     CGL029
     I                                      195 200 SNCID                                     CGL029
     I                                      201 201 SCRIF                                     CGL029
     I                                      203 223 SCACP                                     CGL029
     I                                      224 225 SCHGT                                     CGL029
     I**********                            225 234 SCHST                              CGL029 242183
     I**********                            235 255 SCHCP                              CGL029 242183
     I**********                            256 262 STCHO                              CGL029 242183
     I**********                            263 273 SCEXA                              CGL029 242183
     I**********                            274 284 SCEXB                              CGL029 242183
     I**********                            285 295 SCEXC                              CGL029 242183
     I**********                            296 303 SCEXD                              CGL029 242183
     I**********                            310 317 SCEXE                              CGL029 242183
     I**********                            324 331 SCEXF                              CGL029 242183
     I**********                            338 339 SNOCC                              CGL029 242183
     I**********                            340 347 SCEXG                              CGL029 242183
     I**********                            354 365 SMINB                              CGL029 242183
     I**********                            366 368 SFACT                              CGL029 242183
     I**********                            366 3680WFACT                              CGL029 242183
     I**********                            369 370 SFCNO                              CGL029 242183
     I**********                            369 3700WFCNO                              CGL029 242183
     I**********                            371 372 SEFAC                              CGL029 242183
     I                                      226 230 SCHST                                     244611
     I                                      231 251 SCHCP                                     244611
     I                                      252 258 STCHO                                     244611
     I                                      259 269 SCEXA                                     244611
     I                                      270 280 SCEXB                                     244611
     I                                      281 291 SCEXC                                     244611
     I                                      292 299 SCEXD                                     244611
     I                                      306 313 SCEXE                                     244611
     I                                      320 327 SCEXF                                     244611
     I                                      334 335 SNOCC                                     244611
     I                                      336 343 SCEXG                                     244611
     I                                      350 361 SMINB                                     244611
     I                                      362 364 SFACT                                     244611
     I                                      362 3640WFACT                                     244611
     I                                      365 366 SFCNO                                     244611
     I                                      365 3660WFCNO                                     244611
     I                                      367 368 SEFAC                                     244611
     I**********                            371 371 SINAI                              CGL029 TDA092
     I**********                            371 371 SBRLI                              CGL029 TDA092
     I**********                            372 372 SBADI                              CGL029 TDA092
     I**********                            373 373 SPTRA                              CGL029 TDA092
     I**********                            374 374 SPRCH                              CGL029 TDA092
     I**********                            375 375 BRTCA                              CGL029 TDA092
     I**********                            376 377 SNSDN                              CGL029 TDA092
     I**********                            373 373 SINAI                              TDA092 242183
     I**********                            374 374 SBRLI                              TDA092 242183
     I**********                            375 375 SBADI                              TDA092 242183
     I**********                            376 376 SPTRA                              TDA092 242183
     I**********                            377 377 SPRCH                              TDA092 242183
     I**********                            378 378 BRTCA                              TDA092 242183
     I**********                            379 380 SNSDN                              TDA092 242183
     I**********                            382 383 SDNCD                              CGL029 242183
     I**********                            384 385 SCNCD                              CGL029 242183
     I**********                            386 388 SDRBR                              CGL029 242183
     I**********                            389 391 SCRBR                              CGL029 242183
     I**********                            392 394 SCHBR                              CGL029 242183
     I**********                            395 418 SLINK                              CGL029 242183
     I**********                            419 422 SPTFR                              CGL029 242183
     I**********                            423 423 SPBKU                              CGL029 242183
     I**********                            424 438 SPSWD                              CGL029 242183
     I**********                            439 439 STIAC                              CGL029 242183
     I**********                            438 443 STIAN                              CGL029 242183
     I**********                            444 446 STIAS                              CGL029 242183
     I                                      369 369 SINAI                                     244611
     I                                      370 370 SBRLI                                     244611
     I                                      371 371 SBADI                                     244611
     I                                      372 372 SPTRA                                     244611
     I                                      373 373 SPRCH                                     244611
     I                                      374 374 BRTCA                                     244611
     I                                      375 376 SNSDN                                     244611
     I                                      378 379 SDNCD                                     244611
     I                                      380 381 SCNCD                                     244611
     I                                      382 384 SDRBR                                     244611
     I                                      385 387 SCRBR                                     244611
     I                                      388 390 SCHBR                                     244611
     I                                      391 414 SLINK                                     244611
     I                                      415 418 SPTFR                                     244611
     I                                      419 419 SPBKU                                     244611
     I**********                            420 434 SPSWD                              244611 CSD101
     I                                      435 435 STIAC                                     244611
     I                                      434 439 STIAN                                     244611
     I                                      440 442 STIAS                                     244611
     I**
     I** DATA STRUCTURE FOR WORK FIELDS (FIELDS CONTAIN FILE INFO)
     I**
     I            DS
     I**********                              1   60SWCNUM                                    CSD027
     I                                        1   6 SWCNUM                                    CSD027
     I                                        7   9 SWCCY
     I**********                             10  130SWACOD                                    CGL029
     I**********                             14  150SWACSQ                                    CGL029
     I**********                             16  18 SWSPTA                                    CGL029
     I**********                             19  280SWACNO                                    CGL029
     I**********                             29  48 SWANAM                                    CGL029
     I**********                             49  540SWDACO                                    CGL029
     I**********                             55  590SWDACC                                    CGL029
     I**********                             60  640SWNSTD                                    CGL029
     I**********                             65  65 SWSTFQ                                    CGL029
     I**********                             66  670SWENOC                                    CGL029
     I**********                             68  68 SWGLBT                                    CGL029
     I**********                             69  78 SWREF                                     CGL029
     I**********                             79  79 SWRETB                                    CGL029
     I**********                             80  80 SWMFFQ                                    CGL029
     I**********                             81  84 SWPRFC                                    CGL029
     I**********                             85  860SWDRIB                                    CGL029
     I**********                             87  977SWDRIS                                    CGL029
     I**********                             98  990SWDICT                                    CGL029
     I**********                            100 1040SWDCST                                    CGL029
     I**********                            105 1090SWDRCD                                    CGL029
     I**********                            110 1100SWDRIC                                    CGL029
     I**********                            111 1150SWNDID                                    CGL029
     I**********                            116 116 SWDRIF                                    CGL029
     I**********                            117 131 SWDACP                                    CGL029
     I**********                            132 1420SWODLN                                    CGL029
     I**********                            143 1470SWODED                                    CGL029
     I**********                            148 148 SWODSC                                    CGL029
     I**********                            149 1500SWCRIB                                    CGL029
     I**********                            151 1617SWCRIS                                    CGL029
     I**********                            162 1630SWCICT                                    CGL029
     I**********                            164 1680SWAMAL                                    CGL029
     I**********                            169 1730SWDR9                                     CGL029
     I**********                            174 1740SWCRIC                                    CGL029
     I**********                            175 1790SWNCID                                    CGL029
     I**********                            180 180 SWCRIF                                    CGL029
     I**********                            181 195 SWCACP                                    CGL029
     I**********                            196 1970SWCHGT                                    CGL029
     I**********                            198 2020SWMRT3                                    CGL029
     I**********                            203 217 SWCHCP                                    CGL029
     I**********                            218 2240SWTCHO                                    CGL029
     I**********                            225 234 SWCEXA                                    CGL029
     I**********                            235 244 SWCEXB                                    CGL029
     I**********                            245 254 SWCEXC                                    CGL029
     I**********                            255 261 SWCEXD                                    CGL029
     I**********                            262 268 SWCEXE                                    CGL029
     I**********                            269 275 SWCEXF                                    CGL029
     I**********                            276 2770SWNOCC                                    CGL029
     I**********                            278 284 SWCEXG                                    CGL029
     I**********                            285 2960SWMDTN                                    CGL029
     I**********                            297 2990SWFACT                                    CGL029
     I**********                            300 3010SWFCNO                                    CGL029
     I**********                            302 3030SWEFAC                                    CGL029
     I**********                            304 304 SWPTRA                                    CGL029
     I**********                            305 305 SWPRCH                                    CGL029
     I**********                            306 3070SWDRDY                                    CGL029
     I**********                            308 3090SWCRDY                                    CGL029
     I**********                            310 310 SWATYP                                    CGL029
     I**************************************311 312 SWSTYP                107478
     I**********                            311 311 SWSTYP                             107478 CGL029
     I**********                            313 3170SWLSTD                                    CGL029
     I**********                            318 3220SWDLIM                                    CGL029
     I**********                            323 3270SWLACD                                    CGL029
     I**********                            328 3320SWNAMR                                    CGL029
     I**********                            333 3370SWLDID                                    CGL029
     I**********                            338 338 SWSDAP                                    CGL029
     I**********                            339 3430SWLPAR                                    CGL029
     I**********                            344 3480SWDDIA                                    CGL029
     I**********                            349 3530SWOLDR                                    CGL029
     I**********                            354 3580SWLCID                                    CGL029
     I**********                            359 359 SWSCAP                                    CGL029
     I**********                            360 3640SWLPAP                                    CGL029
     I**********                            361 361 SWCDIS                                    CGL029
     I**********                            366 3800SWOLCR                                    CGL029
     I**********                            381 3820SWSTDY                                    CGL029
     I**********                            383 383 SWBRTC                                    CGL029
     I**********                            384 386 SWDRBR                                    CGL029
     I**********                            387 389 SWCRBR                                    CGL029
     I**********                            390 392 SWCHBR                                    CGL029
     I**********                            393 396 SWPTFR                             S01486 CGL029
     I**********                            397 397 SWPBKU                             CRT001 CGL029
     I**********                            398 412 SWPSWD                             CRT001 CGL029
     I**********                            413 4237SWAODR                             CRE001 CGL029
     I**********                            424 424 SWAODX                             CRE001 CGL029
     I**********                            425 4290SWITRD                             CRE001 CGL029
     I**********                            430 4340SWORTC                             CRE001 CGL029
     I**********                            435 4390SWOLVD                             CRE001 CGL029
     I**********                            440 4440SWPOLC                             CRE001 CGL029
     I**********                            445 4490SWPOLE                             CRE001 CGL029
     I**********                            450 4607SWDRMG                             CDE002 CGL029
     I**********                            461 4717SWCRMG                             CDE002 CGL029
     I**********                            472 472 SWOVRD                             CDE002 CGL029
     I**********                            473 473 SWOVRC                             CDE002 CGL029
     I**********                            474 478 SWDMBR                             208221 CGL029
     I**********                            479 483 SWCMBR                             208221 CGL029
     I                                       10  190SWACOD                                    CGL029
     I                                       20  210SWACSQ                                    CGL029
     I                                       22  24 SWSPTA                                    CGL029
     I                                       25  340SWACNO                                    CGL029
     I                                       35  54 SWANAM                                    CGL029
     I                                       55  600SWDACO                                    CGL029
     I                                       61  650SWDACC                                    CGL029
     I                                       66  700SWNSTD                                    CGL029
     I                                       71  71 SWSTFQ                                    CGL029
     I                                       72  730SWENOC                                    CGL029
     I                                       74  74 SWGLBT                                    CGL029
     I                                       75  84 SWREF                                     CGL029
     I                                       85  85 SWRETB                                    CGL029
     I                                       86  86 SWMFFQ                                    CGL029
     I                                       87  90 SWPRFC                                    CGL029
     I                                       91  920SWDRIB                                    CGL029
     I                                       93 1037SWDRIS                                    CGL029
     I                                      104 1050SWDICT                                    CGL029
     I                                      106 1100SWDCST                                    CGL029
     I                                      111 1150SWDRCD                                    CGL029
     I                                      116 1160SWDRIC                                    CGL029
     I                                      117 1210SWNDID                                    CGL029
     I                                      122 122 SWDRIF                                    CGL029
     I**********                            123 137 SWDACP                             CGL029 242183
     I**********                            138 1480SWODLN                             CGL029 242183
     I**********                            149 1530SWODED                             CGL029 242183
     I**********                            154 154 SWODSC                             CGL029 242183
     I**********                            155 1560SWCRIB                             CGL029 242183
     I**********                            157 1677SWCRIS                             CGL029 242183
     I**********                            168 1690SWCICT                             CGL029 242183
     I**********                            170 1740SWAMAL                             CGL029 242183
     I**********                            175 1790SWDR9                              CGL029 242183
     I**********                            180 1800SWCRIC                             CGL029 242183
     I**********                            181 1850SWNCID                             CGL029 242183
     I**********                            186 186 SWCRIF                             CGL029 242183
     I**********                            187 207 SWCACP                             CGL029 242183
     I**********                            208 2090SWCHGT                             CGL029 242183
     I**********                            210 2140SWMRT3                             CGL029 242183
     I**********                            215 229 SWCHCP                             CGL029 242183
     I**********                            230 2360SWTCHO                             CGL029 242183
     I**********                            237 246 SWCEXA                             CGL029 242183
     I**********                            247 256 SWCEXB                             CGL029 242183
     I**********                            257 266 SWCEXC                             CGL029 242183
     I**********                            267 273 SWCEXD                             CGL029 242183
     I**********                            274 280 SWCEXE                             CGL029 242183
     I**********                            281 287 SWCEXF                             CGL029 242183
     I**********                            288 2890SWNOCC                             CGL029 242183
     I**********                            290 296 SWCEXG                             CGL029 242183
     I**********                            297 3080SWMDTN                             CGL029 242183
     I**********                            309 3110SWFACT                             CGL029 242183
     I**********                            312 3130SWFCNO                             CGL029 242183
     I**********                            314 3150SWEFAC                             CGL029 242183
     I**********                            316 316 SWPTRA                             CGL029 242183
     I**********                            317 317 SWPRCH                             CGL029 242183
     I**********                            318 3190SWDRDY                             CGL029 242183
     I**********                            320 3210SWCRDY                             CGL029 242183
     I**********                            322 322 SWATYP                             CGL029 242183
     I**********                            323 323 SWSTYP                             CGL029 242183
     I**********                            324 3290SWLSTD                             CGL029 242183
     I**********                            330 3340SWDLIM                             CGL029 242183
     I**********                            335 3390SWLACD                             CGL029 242183
     I**********                            340 3440SWNAMR                             CGL029 242183
     I**********                            345 3490SWLDID                             CGL029 242183
     I**********                            350 350 SWSDAP                             CGL029 242183
     I**********                            351 3510SWLPAR                             CGL029 242183
     I**********                            356 3600SWDDIA                             CGL029 242183
     I**********                            361 3650SWOLDR                             CGL029 242183
     I**********                            366 3700SWLCID                             CGL029 242183
     I**********                            371 371 SWSCAP                             CGL029 242183
     I**********                            372 3760SWLPAP                             CGL029 242183
     I**********                            373 373 SWCDIS                             CGL029 242183
     I**********                            378 3920SWOLCR                             CGL029 242183
     I**********                            393 3940SWSTDY                             CGL029 242183
     I**********                            395 395 SWBRTC                             CGL029 242183
     I**********                            396 398 SWDRBR                             CGL029 242183
     I**********                            399 401 SWCRBR                             CGL029 242183
     I**********                            402 404 SWCHBR                             CGL029 242183
     I**********                            403 408 SWPTFR                             CGL029 242183
     I**********                            409 409 SWPBKU                             CGL029 242183
     I**********                            410 424 SWPSWD                             CGL029 242183
     I**********                            425 4357SWAODR                             CGL029 242183
     I**********                            436 436 SWAODX                             CGL029 242183
     I**********                            437 4410SWITRD                             CGL029 242183
     I**********                            442 4460SWORTC                             CGL029 242183
     I**********                            447 4510SWOLVD                             CGL029 242183
     I**********                            452 4560SWPOLC                             CGL029 242183
     I**********                            457 4610SWPOLE                             CGL029 242183
     I**********                            462 4727SWDRMG                             CGL029 242183
     I**********                            473 4837SWCRMG                             CGL029 242183
     I**********                            484 484 SWOVRD                             CGL029 242183
     I**********                            485 485 SWOVRC                             CGL029 242183
     I**********                            486 490 SWDMBR                             CGL029 242183
     I**********                            491 495 SWCMBR                             CGL029 242183
     I                                      123 143 SWDACP                                    242183
     I                                      144 1540SWODLN                                    242183
     I                                      155 1590SWODED                                    242183
     I                                      160 160 SWODSC                                    242183
     I                                      161 1620SWCRIB                                    242183
     I                                      163 1737SWCRIS                                    242183
     I                                      174 1750SWCICT                                    242183
     I                                      176 1800SWAMAL                                    242183
     I                                      181 1850SWDR9                                     242183
     I                                      186 1860SWCRIC                                    242183
     I                                      187 1910SWNCID                                    242183
     I                                      192 192 SWCRIF                                    242183
     I                                      193 213 SWCACP                                    242183
     I                                      214 2150SWCHGT                                    242183
     I                                      216 2200SWMRT3                                    244611
     I                                      221 241 SWCHCP                                    244611
     I                                      242 2480SWTCHO                                    244611
     I                                      249 258 SWCEXA                                    244611
     I                                      259 268 SWCEXB                                    244611
     I                                      269 278 SWCEXC                                    244611
     I                                      279 285 SWCEXD                                    244611
     I                                      286 292 SWCEXE                                    244611
     I                                      293 299 SWCEXF                                    244611
     I                                      300 3010SWNOCC                                    244611
     I                                      302 308 SWCEXG                                    244611
     I                                      309 3200SWMDTN                                    244611
     I                                      321 3230SWFACT                                    244611
     I                                      324 3250SWFCNO                                    244611
     I                                      326 3270SWEFAC                                    244611
     I                                      328 328 SWPTRA                                    244611
     I                                      329 329 SWPRCH                                    244611
     I                                      330 3310SWDRDY                                    244611
     I                                      332 3330SWCRDY                                    244611
     I                                      334 334 SWATYP                                    244611
     I                                      335 335 SWSTYP                                    244611
     I                                      336 3410SWLSTD                                    244611
     I                                      342 3460SWDLIM                                    244611
     I                                      347 3510SWLACD                                    244611
     I                                      352 3560SWNAMR                                    244611
     I                                      357 3610SWLDID                                    244611
     I                                      362 362 SWSDAP                                    244611
     I                                      363 3630SWLPAR                                    244611
     I                                      364 3720SWDDIA                                    244611
     I                                      373 3770SWOLDR                                    244611
     I                                      378 3820SWLCID                                    244611
     I                                      383 383 SWSCAP                                    244611
     I                                      384 3880SWLPAP                                    244611
     I                                      389 389 SWCDIS                                    244611
     I                                      390 4040SWOLCR                                    244611
     I                                      405 4060SWSTDY                                    244611
     I                                      407 407 SWBRTC                                    244611
     I                                      408 410 SWDRBR                                    244611
     I                                      411 413 SWCRBR                                    244611
     I                                      414 416 SWCHBR                                    244611
     I                                      417 420 SWPTFR                                    244611
     I                                      421 421 SWPBKU                                    244611
     I**********                            422 436 SWPSWD                             244611 CSD101
     I                                      437 4477SWAODR                                    244611
     I                                      448 448 SWAODX                                    244611
     I                                      449 4530SWITRD                                    244611
     I                                      454 4580SWORTC                                    244611
     I                                      459 4630SWOLVD                                    244611
     I                                      464 4680SWPOLC                                    244611
     I                                      469 4730SWPOLE                                    244611
     I                                      474 4847SWDRMG                                    244611
     I                                      485 4957SWCRMG                                    244611
     I                                      496 496 SWOVRD                                    244611
     I                                      497 497 SWOVRC                                    244611
     I                                      498 502 SWDMBR                                    244611
     I                                      503 507 SWCMBR                                    244611
     I/COPY WNCPYSRC,GL3271I012
     I**
     I** DATA STRUCTURE WITH ALPHANUMERIC COMPONENTS
     I**
     I            DS
     I                                        1   2 SADRIB
     I                                        3  14 SADRIS
     I                                       15  15 SADSIG
     I                                       16  17 SADICT
     I                                       18  22 SADCST
     I                                       23  24 SACRIB
     I                                       25  36 SACRIS
     I                                       37  37 SACSIG
     I                                       38  39 SACICT
     I                                       40  44 SAAMAL
     I**
     I** DATA STRUCTURE FOR WORK FIELDS (FIELDS CONTAIN SCREEN INFO)
     I**
     I            DS
     I**********                              1   60SSCNUM                                    CSD027
     I                                        1   6 SSCNUM                                    CSD027
     I                                        7   9 SSCCY
     I**********                             10  130SSACOD                                    CGL029
     I**********                             14  150SSACSQ                                    CGL029
     I**********                             16  18 SSSPTA                                    CGL029
     I**********                              1  18 W#ACID                             CDE001 CGL029
     I**********                             19  280SSACNO                                    CGL029
     I                                       10  190SSACOD                                    CGL029
     I                                       20  210SSACSQ                                    CGL029
     I                                       22  24 SSSPTA                                    CGL029
     I                                        1  24 W#ACID                                    CGL029
     I                                       25  340SSACNO                                    CGL029
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP8                                           S01408
     I*                                                                   S01408
     I**********                             29  48 SSANAM                                    CGL029
     I**********                             49  540SSDACO                                    CGL029
     I**********                             55  590SSDACC                                    CGL029
     I**********                             60  640SSNSTD                                    CGL029
     I**********                             65  65 SSSTFQ                                    CGL029
     I**********                             66  670SSENOC                                    CGL029
     I**********                             68  68 SSGLBT                                    CGL029
     I**********                             69  78 SSREF                                     CGL029
     I**********                             79  79 SSRETB                                    CGL029
     I**********                             80  80 SSMFFQ                                    CGL029
     I**********                             81  84 SSPRFC                                    CGL029
     I**********                             85  860SSDRIB                                    CGL029
     I**********                             87  977SSDRIS                                    CGL029
     I**********                             98  990SSDICT                                    CGL029
     I**********                            100 1040SSDCST                                    CGL029
     I**********                            105 1090SSDRCD                                    CGL029
     I**********                            110 1100SSDRIC                                    CGL029
     I**********                            111 1150SSNDID                                    CGL029
     I**********                            116 116 SSDRIF                                    CGL029
     I**********                            117 131 SSDACP                                    CGL029
     I**********                            132 1420SSODLN                                    CGL029
     I**********                            143 1470SSODED                                    CGL029
     I**********                            148 148 SSODSC                                    CGL029
     I**********                            149 1500SSCRIB                                    CGL029
     I**********                            151 1617SSCRIS                                    CGL029
     I**********                            162 1630SSCICT                                    CGL029
     I**********                            164 1680SSAMAL                                    CGL029
     I**********                            169 1730SSDR9                                     CGL029
     I**********                            174 1740SSCRIC                                    CGL029
     I**********                            175 1790SSNCID                                    CGL029
     I**********                            180 180 SSCRIF                                    CGL029
     I**********                            181 195 SSCACP                                    CGL029
     I**********                            196 1970SSCHGT                                    CGL029
     I**********                            198 2020SSMRT3                                    CGL029
     I**********                            203 217 SSCHCP                                    CGL029
     I**********                            218 2240SSTCHO                                    CGL029
     I**********                            225 234 SSCEXA                                    CGL029
     I**********                            235 244 SSCEXB                                    CGL029
     I**********                            245 254 SSCEXC                                    CGL029
     I**********                            255 261 SSCEXD                                    CGL029
     I**********                            262 268 SSCEXE                                    CGL029
     I**********                            269 275 SSCEXF                                    CGL029
     I**********                            276 2770SSNOCC                                    CGL029
     I**********                            278 284 SSCEXG                                    CGL029
     I**********                            285 2960SSMDTN                                    CGL029
     I**********                            297 2990SSFACT                                    CGL029
     I**********                            300 3010SSFCNO                                    CGL029
     I**********                            302 3030SSEFAC                                    CGL029
     I**********                            304 304 SSPTRA                                    CGL029
     I**********                            305 305 SSPRCH                                    CGL029
     I**********                            306 3070SSDRDY                                    CGL029
     I**********                            308 3090SSCRDY                                    CGL029
     I**********                            310 310 SSATYP                                    CGL029
     I**************************************311 312 SSSTYP                107478
     I**********                            311 311 SSSTYP                             107478 CGL029
     I**********                            313 3170SSLSTD                                    CGL029
     I**********                            318 3220SSDLIM                                    CGL029
     I**********                            323 3270SSLACD                                    CGL029
     I**********                            328 3320SSNAMR                                    CGL029
     I**********                            333 3370SSLDID                                    CGL029
     I**********                            338 338 SSSDAP                                    CGL029
     I**********                            339 3430SSLPAR                                    CGL029
     I**********                            344 3480SSDDIA                                    CGL029
     I**********                            349 3530SSOLDR                                    CGL029
     I**********                            354 3580SSLCID                                    CGL029
     I**********                            359 359 SSSCAP                                    CGL029
     I**********                            360 3640SSLPAP                                    CGL029
     I**********                            361 361 SSCDIS                                    CGL029
     I**********                            366 3800SSOLCR                                    CGL029
     I**********                            381 3820SSSTDY                                    CGL029
     I**********                            383 383 SSBRTC                                    CGL029
     I**********                            388 390 SSDRBR                                    CGL029
     I**********                            391 393 SSCRBR                                    CGL029
     I**********                            394 396 SSCHBR                                    CGL029
     I**********                            397 400 SSPTFR                             S01486 CGL029
     I**********                            401 401 SSPBKU                             CRT001 CGL029
     I**********                            402 416 SSPSWD                             CRT001 CGL029
     I**********                            417 4277SSAODR                             CRE001 CGL029
     I**********                            428 428 SSAODX                             CRE001 CGL029
     I**********                            429 4330SSITRD                             CRE001 CGL029
     I**********                            434 4380SSORTC                             CRE001 CGL029
     I**********                            439 4430SSOLVD                             CRE001 CGL029
     I**********                            444 4480SSPOLC                             CRE001 CGL029
     I**********                            449 4530SSPOLE                             CRE001 CGL029
     I**********                            454 454 SSTIAC                             CTI001 CGL029
     I**********                            455 460 SSTIAN                             CTI001 CGL029
     I**********                            461 463 SSTIAS                             CTI001 CGL029
     I**********                            464 4747SSDRMG                             CDE002 CGL029
     I**********                            475 4857SSCRMG                             CDE002 CGL029
     I**********                            486 486 SSOVRD                             CDE002 CGL029
     I**********                            487 487 SSOVRC                             CDE002 CGL029
     I**********                            488 492 SSDMBR                             208221 CGL029
     I**********                            493 497 SSCMBR                             208221 CGL029
     I                                       35  54 SSANAM                                    CGL029
     I                                       55  600SSDACO                                    CGL029
     I                                       61  650SSDACC                                    CGL029
     I                                       66  700SSNSTD                                    CGL029
     I                                       71  71 SSSTFQ                                    CGL029
     I                                       72  730SSENOC                                    CGL029
     I                                       74  74 SSGLBT                                    CGL029
     I                                       75  84 SSREF                                     CGL029
     I                                       85  85 SSRETB                                    CGL029
     I                                       86  86 SSMFFQ                                    CGL029
     I                                       87  90 SSPRFC                                    CGL029
     I                                       91  920SSDRIB                                    CGL029
     I                                       93 1037SSDRIS                                    CGL029
     I                                      104 1050SSDICT                                    CGL029
     I                                      106 1100SSDCST                                    CGL029
     I                                      111 1150SSDRCD                                    CGL029
     I                                      116 1160SSDRIC                                    CGL029
     I                                      117 1210SSNDID                                    CGL029
     I                                      122 122 SSDRIF                                    CGL029
     I                                      123 143 SSDACP                                    CGL029
     I                                      144 1540SSODLN                                    CGL029
     I                                      155 1590SSODED                                    CGL029
     I                                      160 160 SSODSC                                    CGL029
     I                                      161 1620SSCRIB                                    CGL029
     I                                      163 1737SSCRIS                                    CGL029
     I                                      174 1750SSCICT                                    CGL029
     I                                      176 1800SSAMAL                                    CGL029
     I                                      181 1850SSDR9                                     CGL029
     I                                      186 1860SSCRIC                                    CGL029
     I                                      187 1910SSNCID                                    CGL029
     I                                      192 192 SSCRIF                                    CGL029
     I                                      193 213 SSCACP                                    CGL029
     I                                      214 2150SSCHGT                                    CGL029
     I                                      216 2200SSMRT3                                    CGL029
     I                                      221 241 SSCHCP                                    CGL029
     I                                      242 2480SSTCHO                                    CGL029
     I                                      249 258 SSCEXA                                    CGL029
     I                                      259 268 SSCEXB                                    CGL029
     I                                      269 278 SSCEXC                                    CGL029
     I                                      279 285 SSCEXD                                    CGL029
     I                                      286 292 SSCEXE                                    CGL029
     I                                      293 299 SSCEXF                                    CGL029
     I                                      300 3010SSNOCC                                    CGL029
     I                                      302 308 SSCEXG                                    CGL029
     I                                      309 3200SSMDTN                                    CGL029
     I                                      321 3230SSFACT                                    CGL029
     I                                      324 3250SSFCNO                                    CGL029
     I                                      326 3270SSEFAC                                    CGL029
     I                                      328 328 SSPTRA                                    CGL029
     I                                      329 329 SSPRCH                                    CGL029
     I                                      330 3310SSDRDY                                    CGL029
     I                                      332 3330SSCRDY                                    CGL029
     I                                      334 334 SSATYP                                    CGL029
     I                                      335 335 SSSTYP                                    CGL029
     I                                      337 3410SSLSTD                                    CGL029
     I                                      342 3460SSDLIM                                    CGL029
     I                                      347 3510SSLACD                                    CGL029
     I                                      352 3560SSNAMR                                    CGL029
     I                                      357 3610SSLDID                                    CGL029
     I                                      362 362 SSSDAP                                    CGL029
     I                                      363 3670SSLPAR                                    CGL029
     I                                      368 3720SSDDIA                                    CGL029
     I                                      373 3770SSOLDR                                    CGL029
     I                                      378 3820SSLCID                                    CGL029
     I                                      383 383 SSSCAP                                    CGL029
     I                                      384 3880SSLPAP                                    CGL029
     I                                      385 385 SSCDIS                                    CGL029
     I                                      390 4040SSOLCR                                    CGL029
     I                                      405 4060SSSTDY                                    CGL029
     I                                      407 407 SSBRTC                                    CGL029
     I                                      412 414 SSDRBR                                    CGL029
     I                                      415 417 SSCRBR                                    CGL029
     I                                      418 420 SSCHBR                                    CGL029
     I                                      421 424 SSPTFR                                    CGL029
     I                                      425 425 SSPBKU                                    CGL029
     I**********                            426 440 SSPSWD                             CGL029 CSD101
     I                                      441 4517SSAODR                                    CGL029
     I                                      452 452 SSAODX                                    CGL029
     I                                      453 4570SSITRD                                    CGL029
     I                                      458 4620SSORTC                                    CGL029
     I                                      463 4670SSOLVD                                    CGL029
     I                                      468 4720SSPOLC                                    CGL029
     I                                      473 4770SSPOLE                                    CGL029
     I                                      478 478 SSTIAC                                    CGL029
     I                                      479 484 SSTIAN                                    CGL029
     I                                      485 487 SSTIAS                                    CGL029
     I                                      488 4987SSDRMG                                    CGL029
     I                                      499 5097SSCRMG                                    CGL029
     I                                      510 510 SSOVRD                                    CGL029
     I                                      511 511 SSOVRC                                    CGL029
     I                                      512 516 SSDMBR                                    CGL029
     I                                      517 521 SSCMBR                                    CGL029
     I                                      522 5327S1AODR                                    CRE005
     I/COPY WNCPYSRC,GL3271I011
     I            DS
     I                                        1  12 KEY
     I                                        1   1 BLANC
     I                                        2   3 TYPE
     I                                        4   8 SBTYPE
     I                                        9  11 CURR
     I                                       12  12 D
     I**
     I            DS
     I                                        1   7 WWNCID
     I                                        3   5 MNT1
     I**
     I            DS
     I                                        1  75 HOLC
     I                                        1  75 HCCY
     I* Data structure to load up holiday currency array
     I** DATA STRUCTURE FOR SLINK
     I**
     I            DS
     I**********                              1  18 WWLINK                                    CGL029
     I                                        1  24 WWLINK                                    CGL029
     I                                        1   3 LTAB
     I**********                              4   90LTCUST                                    CSD027
     I                                        4   9 LTCUST                                    CSD027
     I/COPY WNCPYSRC,GL3271I008
     I                                       10  12 LTCCY
     I/COPY WNCPYSRC,GL3271I009
     I**********                             13  160LTAC                                      CGL029
     I**********                             17  180LTAS                                      CGL029
     I                                       13  220LTAC                                      CGL029
     I                                       23  240LTAS                                      CGL029
     I            DS
     I                                        1  100WWRKEY
     I                                        1  10 AARKEY
     I**
     I** DATA STRUCTURE FOR PACKED FILE FIELDS
     I**
     I            DS
     I                                        1  10 WWCEXW
     I                                        1   1 WWCEXA
     I                                        1  100WWRATE
     I**
     I            DS
     I                                        1   7 WWCEXX
     I                                        1   1 WWCEXB
     I                                        1   70WWMONT
     C*                                                                   110010
     I            DS                                                      110010
     I                                        1 132 ZAMSDA                110010
      * Message data for 'Change Value date'                              110010
     I                                        1   6 ZA0001                110010
     I*
      * Message data for 'Sweep reference'                                153092
     I                                        1   6 ZA0002                153092
     I*                                                                   153092
      * Message data for 'CHECK DIGIT'                                    CFT004
     I****************                    P   1   20ZA0003                             CFT004 193106
     I                                        1   2 ZA0003                                    193106
     I*                                                                   CFT004
      * Message data for 'BRANCH ID'                                      CFT004
     I                                        1  10 ZA0004                CFT004
     I*                                                                   CFT004
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     ILDA         DS                            256
     I                                      134 183 DBLOT
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP4                                           S01408
     I*                                                                   S01408
     I*
     I** DATA STRUCTURE FOR ZTNLU1
     I*
     I*    MIDAS 'Next Available Relative rec No.' ACCNT/MEMOS
     IDNATN       DS                              5
     I                                        1   50FNATN
     I*
     I** DATA STRUCTURE FOR SETUP OF COMMIT TEXT
     I*
     ICMTTXT      DS
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTNX
     I*
     I** Data structure for DTAARA/ZMUSER
     I*
     IZMUSER      DS
     I                                       11  13 DBRN
     I                                       17  17 BANK
     I*
     I** Data structure for DTAARA/RUNDAT
     I*
     IRUNDAT      DS
     I                                        1   7 SRUNA
     I                                       13  13 MBIN
     I/COPY WNCPYSRC,GL3271I010
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I/COPY WNCPYSRC,GL3271I005
     I                                      244 253 SWSID
     I                                      254 263 SUSER
     I                                      247 249 WSID
     I*
     I** DATA STRUCTURE FOR LAST UPDATE
     I*
     I            DS
     I                                        1   20WWDLUP
     I                                        3   5 WWMLUP
     I                                        6   70WWYLUP
     I                                        1   7 WWHLUP
     I*
     I** DATA STRUCTURE FOR ACCOUNT KEY NUMBER
     I*  ACCOUNT MASTER KEY
     I            DS
     I**********                              1  18 ACKEY                                     CGL029
     I**********                              4  18 ACKEY1                                    CGL029
     I                                        1  24 ACKEY                                     CGL029
     I                                        4  24 ACKEY1                                    CGL029
     I                                        1   3 WWBRCA
     I**********                              4   90WWCNUM                                    CSD027
     I                                        4   9 WWCNUM                                    CSD027
     I                                       10  12 WWCCY
     I**********                             13  160WWACOD                                    CGL029
     I**********                             17  180WWACSQ                                    CGL029
     I                                       13  220WWACOD                                    CGL029
     I                                       23  240WWACSQ                                    CGL029
     I                                        1  10 RETKY
     I**********                             11  18 ACCKY                                     CGL029
     I                                       11  24 ACCKY                                     CGL029
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP1                                           S01408
     I*                                                                   S01408
     I*
     I** DATA STRUCTURE FOR ACCOUNT KEY NUMBER
     I*  ALTERNATE ACCOUNT KEY
     I            DS
     I**********                              1  18 ACKEYK                                    CGL029
     I                                        1  24 ACKEYK                                    CGL029
     I**********                              1   60WWCUSK                                    CSD027
     I                                        1   6 WWCUSK                                    CSD027
     I                                        7   9 WWCCYK
     I**********                             10  130WWACOK                                    CGL029
     I**********                             14  150WWACSK                                    CGL029
     I**********                             16  18 WWBRCK                                    CGL029
     I                                       10  190WWACOK                                    CGL029
     I                                       20  210WWACSK                                    CGL029
     I                                       22  24 WWBRCK                                    CGL029
     I                                        1  100RETKK
     I**********                             11  15 ACCKYK                                    CGL029
     I                                       11  21 ACCKYK                                    CGL029
     I**
     I** DATA STRUSTURE FOR SUBFILE (ROLL UP MODE)
     I**
     I            DS
     I**********                              1  18 ACKEY2                                    CGL029
     I                                        1  24 ACKEY2                                    CGL029
     I                                        1   3 WBRCA2
     I                                        4   9 WCNUM2
     I                                       10  12 WCCY2
     I**********                             13  16 WACOD2                                    CGL029
     I**********                             17  18 WACSQ2                                    CGL029
     I                                       13  22 WACOD2                                    CGL029
     I                                       23  24 WACSQ2                                    CGL029
     I**
     I** DATA STRUCTURE FOR SUBFILE (ROLL DOWN MODE)
     I**
     I            DS
     I                                        1   3 WBRCA3
     I**********                              4   90WCNUM3                                    CSD027
     I                                        4   9 WCNUM3                                    CSD027
     I                                       10  12 WCCY3
     I**********                             13  160WACOD3                                    CGL029
     I**********                             17  180WACSQ3                                    CGL029
     I                                       13  220WACOD3                                    CGL029
     I                                       23  240WACSQ3                                    CGL029
     I**
     I** DATA STRUCTURE TO OUTPUT ACCOUNT KEY TO SCREEN
     I**
     I            DS
     I**********                              1  22 ACNUMB                                    CGL029
     I                                        1  28 ACNUMB                                    CGL029
     I                                        1   3 ABRCA
     I                                        4   4 FLD0
     I                                        5  10 CNUMB
     I                                       11  11 FLD1
     I                                       12  14 CCYB
     I                                       15  15 FLD2
     I**********                             16  19 ACODB                                     CGL029
     I**********                             20  20 FLD3                                      CGL029
     I**********                             21  22 ACSQB                                     CGL029
     I                                       16  25 ACODB                                     CGL029
     I                                       26  26 FLD3                                      CGL029
     I                                       27  28 ACSQB                                     CGL029
     I**
     I** DATA STRUCTURE FOR RETAIL NUMBER
     I**
     I            DS
     I                                        1  100RETNR
     I                                        1   50RETN1
     I                                        6  100RETN2
     I**
     I** DATA STRUCTURE FOR RATE IF INTEREST TYPE IS BLANK
     I**
     I            DS
     I                                        1  36 RAT0
     I                                    P   1  360RATN
     I**
     I** DATA STRUCTURE FOR BALANCE IF INTEREST TYPE IS BLANK
     I**
     I            DS
     I                                        1  48 BAL0
     I                                    P   1  480BALN
     I************************************************************                            CRE005
     I***DATA*STRUCTURE*FOR*STRAN*HEADER**************************                            CRE005
     I************************************************************                            CRE005
     I**STHEAD**    DS                                                                        CRE005
     I**********                              2   60TRNO                                      CRE005
     I**********                          P  12  140NORC                                      CRE005
     I**********                          P 198 2000SATN                                      CRE005
     I**********                            201 210 FILLER                             CRE030 CRE005
     I************************************************************                            CRE005
     I***DATA*STRUCTURE*FOR*STRAN*RATE*1**************************                            CRE005
     I************************************************************                            CRE005
     I**ST1RAT**    DS                                                                        CRE005
     I**********                              1   60S1CNUM                             CSD027 CRE005
     I**********                              1   6 S1CNUM                             CSD027 CRE005
     I**********                              7   9 S1CCY                                     CRE005
     I**********                             10  130S1ACOD                                    CGL029
     I**********                             10  130ACD1QQ                             CGL029 CRE005
     I**********                             14  150S1ACSQ                                    CRE005
     I**********                             16  16 S1ONE                                     CRE005
     I**********                             17  17 S1X                                       CRE005
     I**********                             22  310S1ACNO                                    CRE005
     I**********                          P  32  340S1RUND                                    CRE005
     I**********                          P  35  370S1WOLD                                    CRE005
     I**********                             38  53 S1NARR                                    CRE005
     I**********                             73  740S1INTT                                    CRE005
     I**********                             75  790S1INTS                                    CRE005
     I**********                             80  80 S1DRCR                                    CRE005
     I**********                             81  860S1TIME                                    CRE005
     I**********                             95  99 S1RECO                                    CRE005
     I**********                            102 104 S1SPTA                                    CRE005
     I**********                            123 123 S1ATYP                                    CRE005
     I**********                          P 124 1260S1RVLD                                    CRE005
     I**********                            127 127 S1BITF                                    CRE005
     I**********                          P 137 1390S1OLDR                                    CRE005
     I**********                          P 146 1517S1INRT                                    CRE005
     I**********                            152 1530S1BRIS                                    CRE005
     I**********                          P 154 1597S1WRIS                                    CRE005
     I**********                          P 160 1657S1AODR                             CRE001 CRE005
     I**********                          P 191 1930S1WRUN                                    CRE005
     I**********                          P 194 1960S1TRNO                                    CRE005
     I**********                          P 197 1990S1NATN                                    CRE005
     I**********                            200 2090S1ACOD                             CGL029 CRE005
     I************************************************************                            CRE005
     I***DATA*STRUCTURE*FOR*STRAN*RATE*2**************************                            CRE005
     I************************************************************                            CRE005
     I**ST2RAT**    DS                                                                        CRE005
     I**********                              1   60S2CNUM                                    CSD027
     I**********                              1   6 S2CNUM                             CSD027 CRE005
     I**********                              7   9 S2CCY                                     CRE005
     I**********                             10  130S2ACOD                                    CGL029
     I**********                             10  130ACD2QQ                             CGL029 CRE005
     I**********                             14  150S2ACSQ                                    CRE005
     I**********                             16  16 S2TWO                                     CRE005
     I**********                             17  17 S2X                                       CRE005
     I**********                          P  18  250S2INTH                                    CRE005
     I**********                          P  35  370S2WOLD                                    CRE005
     I**********                             38  73 RAT1                                      CRE005
     I**********                          P  38  437RAT1A                                     CRE005
     I**********                          P  44  497RAT1B                                     CRE005
     I**********                          P  50  557RAT1C                                     CRE005
     I**********                          P  56  617RAT1D                                     CRE005
     I**********                          P  62  677RAT1E                                     CRE005
     I**********                          P  68  737RAT1F                                     CRE005
     I**********                             80  80 S2DRCR                                    CRE005
     I**********                             81  860S2TIME                                    CRE005
     I**********                            102 104 S2SPTA                                    CRE005
     I**********                            105 152 BAL1                                      CRE005
     I**********                          P 105 1120BAL1A                              077017 CRE005
     I**********                          P 113 1200BAL1B                              077017 CRE005
     I**********                          P 121 1280BAL1C                              077017 CRE005
     I**********                          P 129 1360BAL1D                              077017 CRE005
     I**********                          P 137 1440BAL1E                              077017 CRE005
     I**********                          P 145 1520BAL1F                              077017 CRE005
     I**********                          P 194 1960S2TRNO                                    CRE005
     I**********                          P 197 1990S2NATN                                    CRE005
     I**********                            200 2090S2ACOD                             CGL029 CRE005
     I************************************************************                            CRE005
     I***DATA*STRUCTURE*FOR*STRAN*RATE*3**************************                            CRE005
     I************************************************************                            CRE005
     I**ST3RAT**    DS                                                                        CRE005
     I**********                              1   60S3CNUM                                    CSD027
     I**********                              1   6 S3CNUM                             CSD027 CRE005
     I**********                              7   9 S3CCY                                     CRE005
     I**********                             10  130S3ACOD                                    CGL029
     I**********                             10  130ACD3QQ                             CGL029 CRE005
     I**********                             14  150S3ACSQ                                    CRE005
     I**********                             16  16 S3THRE                                    CRE005
     I**********                          P  35  370S3WOLD                                    CRE005
     I**********                             38  67 RAT3                                      CRE005
     I**********                          P  38  437RAT3A                                     CRE005
     I**********                          P  44  497RAT3B                                     CRE005
     I**********                          P  50  557RAT3C                                     CRE005
     I**********                          P  56  617RAT3D                                     CRE005
     I**********                          P  62  677RAT3E                                     CRE005
     I**********                             80  80 S3DRCR                                    CRE005
     I**********                             81  860S3TIME                                    CRE005
     I**********                            102 104 S3SPTA                                    CRE005
     I**********                            105 144 BAL3                                      CRE005
     I**********                          P 105 1120BAL3A                              077017 CRE005
     I**********                          P 113 1200BAL3B                              077017 CRE005
     I**********                          P 121 1280BAL3C                              077017 CRE005
     I**********                          P 129 1360BAL3D                              077017 CRE005
     I**********                          P 137 1440BAL3E                              077017 CRE005
     I**********                          P 194 1960S3TRNO                                    CRE005
     I**********                          P 197 1990S3NATN                                    CRE005
     I**********                            200 2090S3ACOD                             CGL029 CRE005
     I*                                                                                       CRE005
     I** Data Structure for Rate Spread in File ICHGR2                                        CRE005
     I*                                                                                       CRE005
     I            DS                                                                          CRE005
     I                                        1  36 @RAT1                                     CRE005
     I                                    P   1   67RAT1A                                     CRE005
     I                                    P   7  127RAT1B                                     CRE005
     I                                    P  13  187RAT1C                                     CRE005
     I                                    P  19  247RAT1D                                     CRE005
     I                                    P  25  307RAT1E                                     CRE005
     I                                    P  31  367RAT1F                                     CRE005
     I*                                                                                       CRE005
     I** Data Structure Balance in File ICHGR2                                                CRE005
     I*                                                                                       CRE005
     I            DS                                                                          CRE005
     I                                        1  48 @BAL1                                     CRE005
     I                                    P   1   80BAL1A                                     CRE005
     I                                    P   9  160BAL1B                                     CRE005
     I                                    P  17  240BAL1C                                     CRE005
     I                                    P  25  320BAL1D                                     CRE005
     I                                    P  33  400BAL1E                                     CRE005
     I                                    P  41  480BAL1F                                     CRE005
     I*                                                                                       CRE005
     I** Data Structure for Rate Spread in File ICHGR3                                        CRE005
     I*                                                                                       CRE005
     I            DS                                                                          CRE005
     I                                        1  36 @RAT3                                     CRE005
     I                                    P   1   67RAT3A                                     CRE005
     I                                    P   7  127RAT3B                                     CRE005
     I                                    P  13  187RAT3C                                     CRE005
     I                                    P  19  247RAT3D                                     CRE005
     I                                    P  25  307RAT3E                                     CRE005
     I                                    P  31  367RAT3F                                     CRE005
     I*                                                                                       CRE005
     I** Data Structure Balance in File ICHGR3                                                CRE005
     I*                                                                                       CRE005
     I            DS                                                                          CRE005
     I                                        1  48 @BAL3                                     CRE005
     I                                    P   1   80BAL3A                                     CRE005
     I                                    P   9  160BAL3B                                     CRE005
     I                                    P  17  240BAL3C                                     CRE005
     I                                    P  25  320BAL3D                                     CRE005
     I                                    P  33  400BAL3E                                     CRE005
     I                                    P  41  480BAL3F                                     CRE005
     I*
     I** DATA STRUCTURE TO GET THE RIGHT CUSTOMER GROUP
     I*
     I            DS
     I                                        1  10 ZZ010
     I                                       10  10 CGRP
     I* Insert DS to pass DATA parameter to the return program
     I*
     I/COPY QWINDSRC,GL3271DTA
      *                                                                   CPM004
      ** Input parameters on call to AOPLCSR1                             CPM004
     II@PARM      DS                            256                       CPM004
     I                                        1   1 I#PORS                CPM004
     I                                        2   5 I#R997                CPM004
     I                                        6  15 I#CUST                CPM004
     I                                       16  18 I#BRCA                CPM004
     I                                       19  20 I#BOOK                CPM004
     I                                       21  24 I#PTFR                CPM004
     I                                       25  34 I#CPGM                CPM004
     I*                                                                   CPM004
      ** Output parameters on call to AOPLCSR1                            CPM004
     IO@PARM      DS                            256                       CPM004
     I                                        1   2 O#BOOK                CPM004
     I                                        3   6 O#PTFR                CPM004
     I                                        7  12 O#BICN                CPM004
     I                                       13  22 O#CRNM                CPM004
     I                                       23  24 O#ACOF                CPM004
     I*
     I/COPY WNCPYSRC,GL3271I001
     ISDBANK    E DSSDBANKPD
     I*
     I** Bank Details
     I*
     I              BJURPT                          TITL
     I*
     ISDMMOD    E DSSDMMODPD
     I*
     I** Module Set up Details
     I*
     ISDGELR    E DSSDGELRPD
     I*
     I** General Ledger Details
     I*
     ISDRETL    E DSSDRETLPD
     I              QQACCD                          QQACD1                                    CGL029
     I*
     I** Retail Details
     I*
     ISDCUST    E DSSDCUSTPD
     I*
     I** Customer Details
     I*
     ISDCURR    E DSSDCURRPD
     I*
     I** Currency Details
     I*
     ISDACOD    E DSSDACODPD
     I              QQACCD                          QQACD2                                    CGL029
     I*
     I** Account Code Details
     I*
     ISDBRCH    E DSSDBRCHPD
     I              QQDFAC                          #DFAC1                                    CGL029
     I*
     I** Branch Code Details
     I*
     ISDBSRT    E DSSDBSRTPD
     I*
     I** Base Rate Code Details
     I*
     ISDALTN    E DSSDALTNPD
     I*
     I** Alternative Names & Addresses Details
     I*
     ISDFACT    E DSSDFACTPD
     I*
     I** Facility Details
     I*
     ISDPRFM    E DSSDPRFMPD                                              074585
     I*                                                                   074585
     I**  External DS for Profit Centre dft. Matrix retrieval index       074585
     I*                                                                   074585
     ISDPRFC    E DSSDPRFCPD
     I*
     I** Profit Centre Details
     ISDPLCS    E DSSDPLCSPD                                              S01486
     I** Portfolio Customer Details                                       S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I** Portfolio Management ICD Details                                 S01486
     I*                                                                   S01486
     ISDLBCS    E DSSDLBCSPD                                              095242
     I** Portfolio Lending Customer Details                               095242
     I*                                                                   095242
     I/COPY WNCPYSRC,GL3271I013
     I*
     I**                                                                  108360
     IZMITEM      DS                                                      108360
     I**********                              1   1 ZID                                108360 CSF002
     I**********                              2   50ZMGRP                              108360 CSF002
     I**********                              6   9 ZICDE                              108360 CSF002
     I                                        1  10 UNQCDE                                    CSF002
     I/COPY WNCPYSRC,GL3271I002
     IDSFDY     E DSDSFDY
     I*
     I** First DS for access programs, short data structure
     I*
     I/COPY WNCPYSRC,GL3271I003
     IDSSDY     E DSDSSDY
     I*
     I** Second DS for access programs, long data structure
     I*
     IDSLDY     E DSDSLDY                                                 CPB001
     I*                                                                   CPB001
     I** Third DS for access programs, very long data structure           CPB001
     I*                                                                   CPB001
     IEMSDS     E DSEMDTA
     I* LINK ENQUIRY DATA AREA
     I                                      141 146 CUSTNO
     I**********                            141 1460CUSTN                                     CSD027
     I                                      141 146 CUSTN                                     CSD027
     I                                      147 149 CURRCY
     I**********                            150 153 ACCODE                                    CGL029
     I**********                            150 1530ACCDN                                     CGL029
     I**********                            154 155 ACCSEQ                                    CGL029
     I**********                            154 1550ACSQN                                     CGL029
     I**********                            156 158 BRANCH                                    CGL029
     I**********                            141 155 AREF15                             074576 CGL029
     I                                      150 159 ACCODE                                    CGL029
     I                                      150 1590ACCDN                                     CGL029
     I                                      160 161 ACCSEQ                                    CGL029
     I                                      160 1610ACSQN                                     CGL029
     I                                      162 164 BRANCH                                    CGL029
     I                                      141 161 AREF15                                    CGL029
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIPG                                           S01408
     I*                                                                   S01408
     I** Data structure for AOIBANR6                                      CFT004
     I*                                                                   CFT004
     I***ACNT***     DS                            485                                 CFT004 CGL029
     IACNT        DS                            563                                           CGL029
     I                                        2   7 S4CNUM                CFT004
     I                                        8  10 S4CCY                 CFT004
     I**********                             11  14 S4ACOD                             CFT004 CGL029
     I                                       11  14 ACD4QQ                                    CGL029
     I                                       15  16 S4ACSQ                CFT004
     I                                       23  25 S4BRCA                CFT004
     I                                       26  26 S4ATYP                CFT004
     I                                      190 199 S4ACNO                CFT004
     I                                      449 482 S4IBAN                CFT004
     I                                      483 485 S4IBSQ                CFT004
     I                                      554 563 S4ACOD                                    CGL029
     I*                                                                   208221
     I** Data structure for Margin Base Rate                              208221
     I*                                                                   208221
     I            DS                                                      208221
     I                                        1  12 WWMG                  208221
     I                                        1   3 WWMCCY                208221
     I                                        4   5 WWMBR                 208221
     I                                        6  12 WWMBLK                208221
     I                                        1   1 WWMQ1                 208221
     I                                        2   2 WWMQ2                 208221
     I                                        3   3 WWMQ3                 208221
     I                                        4   4 WWMQ4                 208221
     I                                        5   5 WWMQ5                 208221
      *                                                                   208221
      **  DS for check digit processing on retail a/c number                                  CGL062
      *                                                                                       CGL062
     ISRTNO       DS                                                                          CGL062
     I                                        1   10SRTNO1                                    CGL062
     I                                        2   20SRTNO2                                    CGL062
     I                                        3   30SRTNO3                                    CGL062
     I                                        4   40SRTNO4                                    CGL062
     I                                        5   50SRTNO5                                    CGL062
     I                                        6   60SRTNO6                                    CGL062
     I                                        7   70SRTNO7                                    CGL062
     I                                        8   80SRTNO8                                    CGL062
     I                                        9   90SRTNO9                                    CGL062
     I                                       10  100SRTNO0                                    CGL062
      *                                                                                       CGL062
     I/COPY ZSRSRC,ZFRPEDZ2                                               208221
      *
     I              '0123456789'          C         @NDIGT
     I*                                                                   098400
     I** Constants for Translating Lower to Upper Case                    098400
     I*                                                                   098400
     I              'abcdefghijklmnopqrst-C         LO                    098400
     I              'uvwxyz'                                              098400
     I              'ABCDEFGHIJKLMNOPQRST-C         UP                    098400
     I              'UVWXYZ'                                              098400
     I** Constant for obtaining Modulus 11 Check System Value                                 CGL062
     I*                                                                                       CGL062
     I              'Modulus11Chk'        C         C#MD11                                    CGL062
      *                                                                   S01408
     I/COPY WNCPYSRC,GL3271IIP9                                           S01408
      *                                                                   S01408
     C/EJECT
     C************************************************************
     C*
     C** Copyright Statement
     C*
     C                     MOVEACPY@      CPY2@  80
     C** Dataarea ZMITEM                                                  108360
     C           *NAMVAR   DEFN           ZMITEM                          108360
     C*
     C** Dataarea RUNDAT/ZMUSER/LDA
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C           *NAMVAR   DEFN           ZMUSER
     C                     IN   ZMUSER
     C           *NAMVAR   DEFN           LDA
     C**
     C** KEY LIST TO ACCESS MAIN ACCOUNT ENTERED
     C** ON REIACD
     C**
     C           WWACKY    KLIST
     C                     KFLD           WWCNUM
     C                     KFLD           WWCCY
     C                     KFLD           WWACOD
     C                     KFLD           WWACSQ
     C                     KFLD           WWBRCA
      *                                                                   CRE001
     C**  DEFINE KEY LIST TO ACCESS ACCNTBXC                              CRE001
     C           ACNTBX    KLIST                                          CRE001
     C                     KFLD           WWCNUM                          CRE001
     C                     KFLD           WWCCY                           CRE001
     C                     KFLD           WWACOD                          CRE001
     C                     KFLD           WWACSQ                          CRE001
     C                     KFLD           WWBRCA                          CRE001
      *                                                                   CRE001
     C**  DEFINE KEY LIST TO ACCESS REODHSL0                              CRE001
     C           REODHS    KLIST                                          CRE001
     C                     KFLD           WWBRCA                          CRE001
     C                     KFLD           WWCNUM                          CRE001
     C                     KFLD           WWCCY                           CRE001
     C                     KFLD           WWACOD                          CRE001
     C                     KFLD           WWACSQ                          CRE001
     C                     KFLD           WWHISD                          CRE001
     C**
     C** KEY LIST TO ACCESS STOPC AND RECOM
     C** AND ACCBR
     C**
     C           WWACKB    KLIST
     C                     KFLD           WWBRCA
     C                     KFLD           WWCNUM
     C                     KFLD           WWCCY
     C                     KFLD           WWACOD
     C                     KFLD           WWACSQ
     C**
     C** KEY LIST TO ACCESS RESWEPL4                                      154539
     C**                                                                  154539
     C           SWACC     KLIST                                          154539
     C                     KFLD           SBRCA                           154539
     C                     KFLD           #SCNUM                          154539
     C                     KFLD           SCCY                            154539
     C                     KFLD           #SACOD                          154539
     C                     KFLD           #SACSQ                          154539
     C**                                                                  154539
     C** KEY LIST TO ACCESS HELD ITEMS
     C**
     C           WWACKC    KLIST
     C                     KFLD           WWBRCA
     C                     KFLD           WWCNUM
     C                     KFLD           WWCCY
     C                     KFLD           WWACOD
     C                     KFLD           WWACSQ
     C**
     C** KEY LIST TO ACCESS ALTERNATIVE ACCOUNTS
     C**
     C           WWACK2    KLIST
     C                     KFLD           WWCUSK
     C                     KFLD           WWCCYK
     C                     KFLD           WWACOK
     C                     KFLD           WWACSK
     C                     KFLD           WWBRCK
     C**
     C** KEY LIST TO ACCESS ALTERNATIVE ACCOUNTS ON ACCBR
     C**
     C           WWACK3    KLIST
     C                     KFLD           WWBRCK
     C                     KFLD           WWCUSK
     C                     KFLD           WWCCYK
     C                     KFLD           WWACOK
     C                     KFLD           WWACSK
     C**                                                                  CTI001
     C** KEY LIST TO ACCESS ACCOUNTS ON ACCNTTI                           CTI001
     C**                                                                  CTI001
     C           WACCNT    KLIST                                          CTI001
     C                     KFLD           SBRCA                           CTI001
     C                     KFLD           STIAN                           CTI001
     C                     KFLD           STIAS                           CTI001
     C**
     C** KEY LIST TO ACCESS ALTERNATIVE ACCOUNTS ON REHISBL
     C**
     C           REHIS     KLIST
     C                     KFLD           WWBRCK
     C                     KFLD           WWCUSK
     C                     KFLD           WWCCYK
     C                     KFLD           WWACOK
     C                     KFLD           WWACSK
     C**
     C** KEY LIST TO ACCESS LINKED ACCOUNTS
     C           RELINK    KLIST
     C                     KFLD           WWSPTA  3
     C                     KFLD           WWCNUM
     C                     KFLD           WWCCY
     C                     KFLD           WWACOD
     C                     KFLD           WWACSQ
     C**
     C** KEY LIST TO ACCESS S RECORD
     C           RESKEY    KLIST
     C                     KFLD           WWSPTA
     C                     KFLD           WWCNUM
     C                     KFLD           WWCCY
     C                     KFLD           WWACOD
     C                     KFLD           WWACSQ
     C                     KFLD           WWDATE
     C*
     C**  DEFINE KEY LIST TO ACCESS SDALTNL0
     C           ADKEY     KLIST
     C                     KFLD           AENB
     C                     KFLD           AZCD
     C           KBSRT     KLIST
     C                     KFLD           WWCCY
     C                     KFLD           WWRIB   2
     C/COPY WNCPYSRC,GL3271C254
     C           ACODK     KLIST
     C                     KFLD           WWACOD
     C                     KFLD           WWD
     C           ACODK2    KLIST                                                              CRE030
     C                     KFLD           WWACOD                                              CRE030
     C                     KFLD           WWD                                                 CRE030
     C                     KFLD           WWCCY                                               CRE030
     C/COPY WNCPYSRC,GL3271C070
     C**                                                                  178695
     C** KEY LIST TO ACCESS ACCPTFR                                       178695
     C**                                                                  178695
     C           PTFRK     KLIST                                          178695
     C                     KFLD           WWPTFR                          178695
     C                     KFLD           WWCNUM                          178695
     C                     KFLD           WWCCY                           178695
     C                     KFLD           WWACOD                          178695
     C                     KFLD           WWACSQ                          178695
     C*                                                                   S01486
     C**  DEFINE KEY LIST TO ACCESS PMPORTLL                              S01486
     C           POKEY     KLIST                                          S01486
     C                     KFLD           CUST                            S01486
     C                     KFLD           PREF                            S01486
     C*
     C**  DEFINE KEY LIST TO ACCESS FCLTY
     C           FACTK     KLIST
     C                     KFLD           WWCNUM
     C                     KFLD           WFACT
     C                     KFLD           WFCNO
     C                     KFLD           WRCTP
     C*                                                                   S01421
     C**  DEFINE KEY LIST TO ACCESS STANDL2 AND STANDL3                   S01421
     C           STAND     KLIST                                          S01421
     C                     KFLD           WWCNUM                          S01421
     C                     KFLD           WWCCY                           S01421
     C                     KFLD           WWACOD                          S01421
     C                     KFLD           WWACSQ                          S01421
     C                     KFLD           WWBRCA                          S01421
     C*                                                                   100296
     C**  Define key list to access SDNOSTL2                              100296
     C*                                                                   100296
     C           NOSKEY    KLIST                                          100296
     C                     KFLD           WWCNBR  6                       100296
     C                     KFLD           WWCCY                           100296
     C**********           KFLD           WWACDE  4                                    100296 CGL029
     C                     KFLD           WWACDE 10                                           CGL029
     C                     KFLD           WWACSQ                          100296
     C                     KFLD           WWBRCA                          100296
     C**  Define key list for Trade Innovation account access             160464
     C           TIAKEY    KLIST                                          160464
     C                     KFLD           WWTIBR  3                       160464
     C                     KFLD           WWTIAC  6                       160464
     C                     KFLD           WWTISF  3                       160464
      *                                                                                       CAP205
     C           KEYAC     KLIST                                                              CAP205
     C                     KFLD           SWCNUM                                              CAP205
     C                     KFLD           SWCCY                                               CAP205
     C                     KFLD           SWACOD                                              CAP205
     C                     KFLD           SWACSQ                                              CAP205
     C                     KFLD           SWSPTA                                              CAP205
     C*
     C** WORK FIELDS DEFINITION
     C*
     C           *LIKE     DEFN HISD      WWHISD                          CRE001
     C           *LIKE     DEFN LDID      WWDATE
     C           *LIKE     DEFN ECFB      SSECFB
     C           *LIKE     DEFN ECFB      SWECFB
     C           *LIKE     DEFN BBACOC    WUACOC                          074585
     C           *LIKE     DEFN ANAM      @ANAM                           098400
     C           *LIKE     DEFN SANAM     @SNAM                           098400
     C           *LIKE     DEFN SEUSB     SWEUSB                          CEU013
     C*
     C**  DEFINE PARAMETERS LIST FOR entry  PROGRAMS
     C*
     C           *ENTRY    PLIST                                          058065
     C                     PARM           NBRAL  10                       058065
     C                     PARM           ENQY    1
     C/COPY WNCPYSRC,GL3271C150
     C*                                                                   S01408
      ** Non-executable WRITE statement for ACCNTBXC                      CRE001
      ** (Required to enable correct OPEN options for GL3271WC)           CRE001
     C           1         IFEQ 2                                         CRE001
     C                     WRITEACCNTBD0                                  CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C/COPY WNCPYSRC,GL3271CP16                                           S01408
     C*                                                                   S01408
     C*================================================================
     C*================================================================
     C*  P R O G R A M     S T A R T
     C*================================================================
     C*
     C** PERFORM SETUP OF STANDARD FIELDS
     C*
     C                     EXSR #P1001                     INITIALIZE
     C/COPY WNCPYSRC,GL3271C017
     C*
     C** D O    U N T I L   C K 3   O R   E R R O R
     C*
     C           *INKC     DOUEQ'1'
     C*
     C/COPY WNCPYSRC,GL3271C006
     C           WFMT      CASEQ'F0'      #P10F0           START SCREEN
     C           WFMT      CASEQ'S0'      #P10S0           REVIEW SCREEN
     C           WFMT      CASEQ'FK'      #P10FK           DETAIL SCREEN
     C           WFMT      CASEQ'F1'      #P10F1           DETAIL SCREEN
     C           WFMT      CASEQ'F2'      #P10F2           DR INT SCREEN
     C           WFMT      CASEQ'F3'      #P10F3           CR INT SCREEN
     C           WFMT      CASEQ'F4'      #P10F4           COMMISSION SCREEN
     C           WFMT      CASEQ'F5'      #P10F5           OTHER DET. SCREEN
     C           WFMT      CASEQ'IN'      #P1002           WRITE FILE
     C           WFMT      CASEQ'UP'      #P1003           UPDATE FILE
     C                     END
     C*
     C           *INKI     IFEQ *ON                                       075931
     C           *INKL     OREQ *ON                                       075931
     C                     ROLBK                                          075931
     C                     ENDIF                                          075931
     C                     END
     C*
     C** ON F3 REMOVE ANY UNCOMMITED CHANGES
     C*
     C           *INKC     IFEQ '1'
     C                     ROLBK
     C/COPY WNCPYSRC,GL3271C018
     C                     END
     C/COPY WNCPYSRC,GL3271C229
     C*
     C** TERMINATE PROGRAM
     C*
     C                     SETON                         LR
     C*================================================================
     C*  P R O G R A M     E N D
     C*================================================================
     C**************************************************************************
     C**
     C/COPY WNCPYSRC,GL3271C019
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10F0   - PROCESS START SCREEN                                  *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1006   - SET SCREEN FIELDS TO BLANK                            *
      * #P1005   - SET WORK FIELDS TO BLANK                              *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #V10F0   - PROCESS VALIDATION OF START SCREEN                    *
      * #DIR     - TO PROCESS FORMAT AND MODE                            *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      * WWACTN   - ACTION CODE                                           *
      *                                                                  *
      ********************************************************************
     C           #P10F0    BEGSR                           ** #P10F0 BSR *
     C*
     C** INITIALISE SCREEN DATA
     C*
     C                     EXSR #P1006
     C*
     C** INITIALISE work field
     C*
     C                     EXSR #P1005
     C                     MOVE 'F0'      WWRTRN  2
     C/COPY WNCPYSRC,GL3271C143
     C*
     C*  Set start screen indicator
     C*
     C                     MOVEA'00000'   *IN,29
     C                     MOVEA'000'     *IN,50
     C                     MOVE '0'       *IN39
     C                     MOVE '0'       *IN44
     C                     MOVE '0'       *IN45                           092290
     C                     MOVE '0'       *IN46
     C                     MOVE '0'       *IN47
     C                     MOVE '0'       *IN72            DATE CLOSED
     C                     MOVE '1'       *IN78
     C                     MOVEL*BLANK    ERR     1
     C                     MOVEL*BLANK    DDACTN
     C                     MOVEL*BLANK    WWACTN
     C*
     C** CLEAR WHOLE SCREEN
     C*
     C                     WRITEGL3271FC
     C/COPY WNCPYSRC,GL3271C020
     C*
     C*  Output format
     C*
     C           MODID     IFEQ 'GL'                                      074576
     C                     MOVE 'E'       DDACTN                          074576
     C                     MOVE AREF15    SKEY                            074576
     C                     MOVELBRANCH    SKEY                            074576
     C                     END                                            074576
     C*                                                                   074576
     C           WFMT      DOUNE'F0'
     C                     MOVE *BLANKS   ZAMSID                                            AR703901
     C                     WRITEGL3271C1
     C/COPY WNCPYSRC,GL3271C230
     C*                                                                   074576
     C*  If enquiry mode process start screen and first screen together.  074576
     C*  Bypass if this is called from Linked Enquiry                     103444
     C*                                                                   074576
     C           MODID     IFEQ 'GL'                                      074576
     C           *IN05     ANDEQ'0'                                       103444
     C                     WRITEGL3271F0                                  074576
     C                     ELSE                                           074576
     C                     EXFMTGL3271F0
     C                     END                                            074576
     C/COPY WNCPYSRC,GL3271C231
     C                     MOVEA'0000'    *IN,30           MODE OFF
     C                     MOVEA'000'     *IN,50           ERROR OFF
     C                     MOVEL'0'       *IN81            ERROR OFF
     C                     MOVE ' '       ERR              ERROR INDICATOR
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C                     END
     C** F3 PRESSED
     C**
     C           *INKC     IFEQ '1'
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C232
     C                     END
     C*
     C** ENTER PRESSED
     C*
     C           *IN49     IFEQ '0'
     C*
     C** Validate entry
     C*
     C                     EXSR #V10F0
     C*
     C           ERR       IFEQ ' '
     C** RESET SCREEN INDICATOR
     C                     MOVE '0'       *IN78
     C                     MOVEA'00000'   *IN,65
     C**
     C** IF NO ERRORS AND ACTION CODE NOT BLANK SEND FIRST FORMAT
     C** OTHERWISE SEND SUBFILE
     C**
     C           DDACTN    IFNE *BLANK
     C** SEND CORRECT FORMAT FOLLOWING MODE
     C                     EXSR #DIR
     C                     ELSE
     C                     MOVEL'S0'      WFMT
     C                     END
     C                     ELSE
     C                     MOVEA'0010'    *IN,30
     C                     END
     C                     END
     C                     END
     C                     ENDSR                           ** #P10F0 ESR *
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10F0   - PROCESS VALIDATION OF START SCREEN                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F0   - PROCESS START SCREEN                                  *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWRKEY   - RETAIL NUMBER KEY                                     *
      * WWCNUM   - CUSTOMER NUMBER                                       *
      * WWCCY    - CURRENCY CODE                                         *
      * WWACOD   - ACCOUNT CODE                                          *
      * WWACSQ   - ACCOUNT SEQUENCE                                      *
      * WWKEY    - KEY LIST                                              *
      * WWDSPY   - DISPLAY CODE                                          *
      *                                                                  *
      ********************************************************************
     C           #V10F0    BEGSR
     C*
     C** Check if Action Code entered is valid - Must be I, A, D or E
     C*
     C           DDACTN    IFNE 'I'
     C           DDACTN    ANDNE'A'
     C           DDACTN    ANDNE'D'
     C           DDACTN    ANDNE'E'
     C           DDACTN    ANDNE'1'
     C           DDACTN    ANDNE'2'
     C           DDACTN    ANDNE'3'
     C           DDACTN    ANDNE'4'
     C           DDACTN    ANDNE'5'
     C           DDACTN    ANDNE*BLANK
     C                     MOVEL'RE71001' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN50            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C**
     C** IF ACTION CODE ENTERED IS I, A, OR D, USER MUST BE
     C** AUTHORISED TO GO ON
     C*
     C** TEST IF AUTHORISED TO INSERT
     C*
     C           DDACTN    IFEQ 'I'
     C           *IN40     ANDNE'1'
     C           ENQY      IFEQ *BLANK
     C                     MOVEL'RE71002' ZAMSID           NO INSERT AUT.
     C                     ELSE
     C                     MOVEL'RE71017' ZAMSID           NO INSERT AUT.
     C                     END
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN50            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C*
     C** TEST IF AUTHORISED TO AMEND
     C*
     C           DDACTN    IFEQ 'A'
     C           *IN41     ANDNE'1'
     C           ENQY      IFEQ *BLANK
     C                     MOVEL'RE71003' ZAMSID           NO AMEND  AUT.
     C                     ELSE
     C                     MOVEL'RE71017' ZAMSID           NO AMEND AUT.
     C                     END
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN50            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C*
     C** TEST IF AUTHORISED TO DELETE
     C*
     C           DDACTN    IFEQ 'D'
     C           *IN43     ANDNE'1'
     C           ENQY      IFEQ *BLANK
     C                     MOVEL'RE71004' ZAMSID           NO DELETE AUT.
     C                     ELSE
     C                     MOVEL'RE71017' ZAMSID           NO DELETE AUT.
     C                     END
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN50            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C**
     C** IF ACTION CODE NOT I OR D ENTERED, ACCOUNT NUMBER CANNOT BE BLANK
     C**
     C           DDACTN    IFEQ 'A'
     C           SKEY      ANDEQ*BLANKS
     C           *IN41     ANDEQ'1'
     C           DDACTN    OREQ 'E'
     C           SKEY      ANDEQ*BLANKS
     C           DDACTN    OREQ '1'
     C           SKEY      ANDEQ*BLANKS
     C           DDACTN    OREQ '2'
     C           SKEY      ANDEQ*BLANKS
     C           DDACTN    OREQ '3'
     C           SKEY      ANDEQ*BLANKS
     C           DDACTN    OREQ '4'
     C           SKEY      ANDEQ*BLANKS
     C           DDACTN    OREQ '5'
     C           SKEY      ANDEQ*BLANKS
     C                     MOVEL'RE71005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C*
     C** TEST IF AT LEAST ONE COMMISSION INSTALED
     C*
     C           DDACTN    IFEQ '4'
     C           *IN34     ANDNE'1'
     C                     MOVEL'RE71016' ZAMSID                 MISSIOT.
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN50                    MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C**
     C** IF ACTION CODE I OR D, ACCOUNT NUMBER MUST BE BLANK
     C**
     C           DDACTN    IFEQ 'I'
     C           SKEY      ANDNE*BLANKS
     C           DDACTN    OREQ 'D'
     C           SKEY      ANDNE*BLANKS
     C                     MOVEL'RE71012' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C** IF ACCOUNT NUMBER ENTERED, ACTION CODE CANNOT BE BLANK
     C**
     C           DDACTN    IFEQ *BLANK
     C           SKEY      ANDNE*BLANKS
     C                     MOVEL'RE71006' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN50            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C**
     C** IF REVIEW FROM ENTERED, ACTION CODE AND ACCOUNT NUMBER
     C** MUST BE BLANKS
     C**
     C           DDPKEY    IFNE *BLANKS
     C           DDACTN    ANDNE*BLANK
     C           DDPKEY    ORNE *BLANKS
     C           SKEY      ANDNE*BLANKS
     C                     MOVEL'RE71007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN52            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP9                                           S01408
     C*                                                                   S01408
     C** DO VALIDATION ON BRANCH INPUT IF MULTIBRANCH              097616 124824
     C***********BJSBRC    IFEQ *BLANKS                            097616 124824
     C***********DDACTN    ANDNE*BLANKS                            097616 124824
     C***********SKEY      ANDNE*BLANKS                            097616 124824
     C***********          MOVELSKEY      ACKEY                    097616 124824
     C***********          MOVELWWBRCA    @BRCA                    097616 124824
     C***********DDACTN    IFEQ '1'                                097616 124824
     C***********DDACTN    OREQ '2'                                097616 124824
     C***********DDACTN    OREQ '3'                                097616 124824
     C***********DDACTN    OREQ '4'                                097616 124824
     C***********DDACTN    OREQ '5'                                097616 124824
     C***********          MOVEL'E'       @ZACTN                   097616 124824
     C***********          ELSE                                    097616 124824
     C***********          MOVELDDACTN    @ZACTN                   097616 124824
     C***********          END                                     097616 124824
     C***********          EXSR #AUTH                              097616 124824
     C***********@ERR      IFNE 0                                  097616 124824
     C***********          SELEC                                   097616 124824
     C***********@ZACTN    WHEQ 'I'                                097616 124824
     C***********          MOVEL'RE7102B' ZAMSID                   097616 124824
     C***********@ZACTN    WHEQ 'A'                                097616 124824
     C***********          MOVEL'RE7103B' ZAMSID                   097616 124824
     C***********@ZACTN    WHEQ 'D'                                097616 124824
     C***********          MOVEL'RE7104B' ZAMSID                   097616 124824
     C***********@ZACTN    WHEQ 'E'                                097616 124824
     C***********          MOVEL'RE7105B' ZAMSID                   097616 124824
     C***********          ENDSL                                   097616 124824
     C***********          EXSR ZASNMS                             097616 124824
     C***********          MOVEL'E'       ERR                      097616 124824
     C***********          MOVE '1'       *IN50                    097616 124824
     C***********          END                                     097616 124824
     C***********          END                                     097616 124824
     C**
     C** IF ACTION CODE ENTERED AND ACCOUNT NUMBER ENTERED AND REVIEW FROM
     C** NOT REQUESTED THEN CHECK ON FILE FOR VALID ACCOUNT NUMBER
     C**
     C           DDACTN    IFNE *BLANK
     C           SKEY      ANDNE*BLANKS
     C           DDPKEY    ANDEQ*BLANKS
     C           ERR       ANDEQ*BLANK
     C**
     C** TEST IF RETAIL NUMBER OR ACCOUNT NUMBER ENTERED
     C**
     C                     MOVEL*BLANKS   ACKEY
     C                     MOVELSKEY      ACKEY
     C/COPY WNCPYSRC,GL3271C187
     C**
     C** IF POSITIONS 11 TO 15 BLANK THEN IT IS A RETAIL NUMBER
     C** OTHERWISE IT IS A MIDAS NUMBER
     C**
     C* RESET CHECK FIELD TO PROCESS IN CASE OF NOT FOUND
     C*
     C                     MOVE *BLANK    ACST
     C                     MOVE *BLANK    RECI
     C*
     C           ACCKY     IFNE *BLANKS
     C           WWACKB    CHAINACCNTLXX             81
     C                     ELSE
     C                     MOVE RETKY     WWRKEY
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP89                                           S01408
     C*                                                                   S01408
     C           WWRKEY    CHAINACNUM                81
     C                     MOVE CNUM      WWCNUM
     C                     MOVE CCY       WWCCY
     C                     MOVE ACOD      WWACOD
     C                     MOVE ACSQ      WWACSQ
     C                     MOVE BRCA      WWBRCA
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP90                                           S01408
     C*                                                                   S01408
     C                     END
     C**
     C/COPY WNCPYSRC,GL3271C188
     C*                                                                   124824
     C** DO VALIDATION ON BRANCH INPUT IF MULTIBRANCH                     124824
     C           *IN81     IFEQ *OFF                                      124824
     C           ZAMSID    ANDNE'RE71017'                                 124824
     C*                                                                   124824
     C           BJSBRC    IFEQ *BLANKS                                   124824
     C           DDACTN    ANDNE*BLANKS                                   124824
     C           SKEY      ANDNE*BLANKS                                   124824
     C                     MOVELWWBRCA    @BRCA                           124824
     C*                                                                   124824
     C           DDACTN    IFEQ '1'                                       124824
     C           DDACTN    OREQ '2'                                       124824
     C           DDACTN    OREQ '3'                                       124824
     C           DDACTN    OREQ '4'                                       124824
     C           DDACTN    OREQ '5'                                       124824
     C                     MOVEL'E'       @ZACTN                          124824
     C                     ELSE                                           124824
     C                     MOVELDDACTN    @ZACTN                          124824
     C                     END                                            124824
     C*                                                                   124824
     C                     EXSR #AUTH                                     124824
     C*                                                                   124824
     C           @ERR      IFNE 0                                         124824
     C                     SELEC                                          124824
     C           @ZACTN    WHEQ 'I'                                       124824
     C                     MOVEL'RE7102B' ZAMSID                          124824
     C           @ZACTN    WHEQ 'A'                                       124824
     C                     MOVEL'RE7103B' ZAMSID                          124824
     C           @ZACTN    WHEQ 'D'                                       124824
     C                     MOVEL'RE7104B' ZAMSID                          124824
     C           @ZACTN    WHEQ 'E'                                       124824
     C                     MOVEL'RE7105B' ZAMSID                          124824
     C                     ENDSL                                          124824
     C                     EXSR ZASNMS                                    124824
     C                     MOVEL'E'       ERR                             124824
     C                     MOVE '1'       *IN50                           124824
     C                     END                                            124824
     C*                                                                   124824
     C                     END                                            124824
     C*                                                                   124824
     C                     END                                            124824
     C** IF AMEND MODE REQUESTED ,
     C** RECORD MUST   EXIST ON FILE AND MUST BE LIVE
     C**
     C           DDACTN    IFEQ 'A'
     C           *IN81     ANDEQ'1'
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP62                                           S01408
     C*                                                                   S01408
     C                     MOVEL'RE71022' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP63                                           S01408
     C*                                                                   S01408
     C                     END
     C           DDACTN    IFEQ 'A'
     C           *IN81     ANDEQ'0'
     C           ACST      ANDEQ'C'
     C           RECI      IFEQ 'C'
     C                     MOVEL'RE71021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     ELSE
     C                     MOVEL'RE71013' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C                     END
      *                                                                   CFT004
      ****Account*cannot*be*amended*if*incoming*funds*transfer*recorCFT004183052
      ****exist*(CFT004*must*be*on)*********************************CFT004183052
      *                                                             CFT004183052
     C********** CFT004    IFEQ 'Y'                                 CFT004183052
     C********** DDACTN    IFEQ 'A'                                 CFT004183052
     C********** *IN81     ANDEQ*OFF                                CFT004183052
     C********** IBAN      CHAININPAYIB              80             CFT004183052
     C********** *IN80     IFEQ *OFF                                CFT004183052
     C**********           MOVEL'RE72026' ZAMSID                    CFT004183052
     C**********           EXSR ZASNMS                              CFT004183052
     C**********           MOVE *ON       *IN51            REVERSE MCFT004183052
     C**********           MOVE 'E'       ERR              ERROR INDCFT004183052
     C**********           ENDIF                                    CFT004183052
     C**********           ENDIF                                    CFT004183052
     C**********           ENDIF                                    CFT004183052
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP60                                           S01408
     C*                                                                   S01408
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP8                                           S01408
     C*                                                                   S01408
     C**
     C** IF ENQUIRY MODE REQUESTED ,
     C** RECORD MUST   EXIST ON FILE
     C**
     C           DDACTN    IFEQ 'E'
     C           *IN81     ANDEQ'1'
     C           DDACTN    OREQ '1'
     C           *IN81     ANDEQ'1'
     C           DDACTN    OREQ '2'
     C           *IN81     ANDEQ'1'
     C           DDACTN    OREQ '3'
     C           *IN81     ANDEQ'1'
     C           DDACTN    OREQ '4'
     C           *IN81     ANDEQ'1'
     C           DDACTN    OREQ '5'
     C           *IN81     ANDEQ'1'
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP64                                           S01408
     C*                                                                   S01408
     C                     MOVEL'RE71022' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP65                                           S01408
     C*                                                                   S01408
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP61                                           S01408
     C*                                                                   S01408
     C**
     C** IF ACTION '2','3','4' OR '5' REQUESTED ACCOUNT MUST BE RETAIL
     C**
     C           ERR       IFEQ *BLANK
     C**
     C           DDACTN    IFEQ '2'
     C           ATYP      ANDNE'R'
     C           DDACTN    OREQ '3'
     C           ATYP      ANDNE'R'
     C           DDACTN    OREQ '4'
     C           ATYP      ANDNE'R'
     C           DDACTN    OREQ '5'
     C           ATYP      ANDNE'R'
     C                     MOVEL'RE71011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C**
     C** IF FOURTH SCREEN REQUESTED AND NO COMMISSION THAN FORBIDDEN
     C**
     C           DDACTN    IFEQ '4'
     C           *IN34     ANDNE'1'
     C                     MOVEL'RE71016' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN51            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END
     C                     END
     C**
     C** IF ALL ENTRIES VALID - LEAD TO REQUESTED SCREEN
     C**
     C** IF REVIEW FROM REQUESTED, SEND SUBFILE
     C**
     C           ERR       IFEQ *BLANK
     C**
     C           DDACTN    IFEQ *BLANK
     C           DDPKEY    IFEQ *BLANKS
     C**********           Z-ADD0         WWCNUM                                              CSD027
     C                     MOVE *BLANKS   WWCNUM                                              CSD027
     C                     MOVEL*BLANKS   WWCCY
     C                     Z-ADD0         WWACOD
     C                     Z-ADD0         WWACSQ
     C                     MOVEL*BLANKS   WWBRCA
     C                     ELSE
     C                     MOVELDDPKEY    ACKEY
     C**
     C** RETAIL OR MIDAS NUMBER
     C**
     C           ACCKY     IFEQ *BLANKS
     C           RETKY     ANDNE*BLANKS
     C                     MOVEARETKY     RETA
     C                     EXSR #RETTS
     C           *IN80     IFEQ '1'
     C                     MOVEL'R'       WWKEY   1        RETAIL NUMBER
     C                     ELSE
     C                     MOVEL'M'       WWKEY            MIDAS NBR OR BLK
     C                     END
     C                     END
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP7                                           S01408
     C*                                                                   S01408
     C                     ELSE
     C**
     C** IF REVIEW FROM NOT REQUESTED
     C**
     C           DDACTN    IFEQ 'I'
     C                     MOVEL'FK'      WWDSPY  2
     C                     MOVEA'1000'    *IN,30
     C                     END
     C**
     C           DDACTN    IFEQ 'D'
     C                     MOVEL'FK'      WWDSPY
     C                     MOVEA'0001'    *IN,30
     C                     END
     C**
     C           DDACTN    IFEQ 'A'
     C                     MOVEL'F1'      WWDSPY
     C                     MOVEA'0100'    *IN,30
     C                     END
     C**
     C           DDACTN    IFEQ 'E'
     C           DDACTN    OREQ '1'
     C                     MOVEL'F1'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     END
     C**
     C           DDACTN    IFEQ '2'
     C                     MOVEL'F2'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     END
     C**
     C           DDACTN    IFEQ '3'
     C                     MOVEL'F3'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     END
     C**
     C           DDACTN    IFEQ '4'
     C                     MOVEL'F4'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     END
     C**
     C           DDACTN    IFEQ '5'
     C                     MOVEL'F5'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     END
     C**
     C** IF ENQUIRY MODE AND USER AUTHORISED TO AMEND AND IF
     C** ACCOUNT FLAGGED FOR CLOSURE SETON INDICATOR
     C** TO FORBID AMEND
     C**
     C           *IN32     IFEQ '1'
     C           *IN41     ANDEQ'1'
     C           ACST      IFEQ 'C'
     C                     MOVE '1'       *IN39
     C                     END
     C                     END
     C**
     C** IF ENQUIRY OR AMEND MODE AND ACCOUNT RETAIL
     C** SETON INDICATOR
     C**
     C           *IN31     IFEQ '1'
     C           ATYP      ANDEQ'R'
     C           *IN32     OREQ '1'
     C           ATYP      ANDEQ'R'
     C                     MOVE '1'       *IN29
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10S0   - PROCESS REVIEW FROM SUBFILE                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1005   - SET WORK FIELDS TO BLANK                              *
      * #P1006   - SET SCREEN FIELDS TO BLANK                            *
      * ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE                *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #V10S0   - PROCESS VALIDATION OF SUBFILE                         *
      * #RETTS   - PROCESS VALIDATION OF RETAIL NUMBER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      * WWACTN   - ACTION CODE                                           *
      * WWKEY    - KEY LIST                                              *
      * WWRKEY   - RETAIL NUMBER KEY                                     *
      * WWCNUM   - CUSTOMER NUMBER                                       *
      * WWCCY    - CURRENCY CODE                                         *
      * WWACOD   - ACCOUNT CODE                                          *
      * WWACSQ   - ACCOUNT SEQUENCE                                      *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWCONT   - COUNTER                                               *
      * WWBRCD   - BRANCH CODE                                           *
      *                                                                  *
      ********************************************************************
     C           #P10S0    BEGSR                           ** #P10S0 BSR *
     C*
     C*  Set review screen indicator
     C*
     C                     MOVE 'S0'      WWRTRN
     C                     MOVE ' '       ERR
     C                     MOVEA'00000'   *IN,29
     C                     MOVE '0'       *IN39
     C                     MOVE '0'       *IN44
     C                     MOVE '0'       *IN45                           092290
     C                     MOVE '0'       *IN46
     C                     MOVE '0'       *IN47
     C                     MOVE '0'       *IN50
     C                     MOVE '0'       *IN72            DATE CLOSED
     C                     MOVE '1'       *IN79
     C                     MOVEL*BLANK    DDPKEY
     C                     MOVEL*BLANK    DDACTN
     C                     MOVEL*BLANK    WWACTN
     C                     MOVEL*BLANKS   SWSVNM
     C                     MOVEL*BLANKS   SWSVCY
     C                     MOVEL*BLANKS   SWSVAD
     C                     MOVEL*BLANKS   SWSVAS
     C                     MOVEL*BLANKS   SWSVAM
     C                     MOVEL*BLANKS   SWSVBD
     C                     MOVEL*BLANKS   SWSVAO
     C**
     C** RESET ALL WORK FIELDS AND ALL SCREEN FIELDS
     C**
     C                     EXSR #P1005
     C                     EXSR #P1006
     C*
     C** Built subfile if no error
     C*
     C           WFMT      DOUNE'S0'                       B1
     C                     MOVE *BLANKS   ZAMSID                          124824
     C*
     C*  No error then position and save to first record to display
     C*
     C           ERR       IFEQ ' '                        B2
     C*
     C           WWKEY     IFEQ 'R'                        B3
     C                     MOVELRETKY     WWRKEY
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP91                                           S01408
     C*                                                                   S01408
     C           WWRKEY    SETLLACNUM
     C**
     C                     READ ACNUM                    84
     C*
     C*  if end of file read previous record for display.
     C*
     C           *IN84     IFEQ '1'
     C           WWRKEY    SETLLACNUM
     C                     READPACNUM                    84
     C                     END
     C**
     C**********           Z-ADDCNUM      WWCNUM                                              CSD027
     C                     MOVE CNUM      WWCNUM                                              CSD027
     C                     MOVELCCY       WWCCY
     C                     Z-ADDACOD      WWACOD
     C                     Z-ADDACSQ      WWACSQ
     C                     MOVELBRCA      WWBRCA
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP92                                           S01408
     C*                                                                   S01408
     C**
     C                     MOVEL*BLANK    WWKEY
     C**
     C                     END                             E3
     C**
     C           WWACKB    SETLLACCNTLXX
     C*
     C** R E B U I L D   S U B F I L E
     C*
     C                     MOVEA'00'      *IN,21
     C                     Z-ADD*ZERO     RRN     20
     C                     WRITEGL3271C0
     C*
     C*  Fill in the subfile
     C*
     C/COPY WNCPYSRC,GL3271C189
     C           RRN       DOUEQ12                           B3
     C           *IN23     OREQ '1'
     C                     READ ACCNTLXX                 23
     C* IF NO RECORD READ READ LAST RECORD ON FILE
     C           *IN23     IFEQ '1'
     C           RRN       ANDEQ*ZERO
     C/COPY WNCPYSRC,GL3271C190
     C           WWACKB    SETLLACCNTLXX
     C/COPY WNCPYSRC,GL3271C152
     C                     READPACCNTLXX                 23
     C/COPY WNCPYSRC,GL3271C153
     C* IF NO RECORD READ THEN EMPTY FILE.
     C           *IN23     IFEQ '1'
     C                     MOVEAWEOF      SANAM
     C                     ADD  1         RRN
     C                     WRITEGL3271S0
     C                     END
     C                     END
      *                                                                                     AR703901
      ** Check if user has authority in booking branch                                      AR703901
      *                                                                                     AR703901
     C                     MOVE 'Y'       WSHOW   1                                         AR703901
     C           SUSER     CHAINMBRBS                80                                     AR703901
     C           *IN80     IFEQ *OFF                                                        AR703901
     C           RECI      ANDEQ'D'                                                         AR703901
     C                     MOVEAVBRX      WWVBRX                                            AR703901
     C           BRCA      LOKUPWWVBRX                   80                                 AR703901
     C           *IN80     IFEQ *OFF                                                        AR703901
     C                     MOVE 'N'       WSHOW                                             AR703901
     C                     ENDIF                                                            AR703901
     C                     ENDIF                                                            AR703901
      *                                                                                     AR703901
      ** If there is no record for either user or branch in MBRBS                           AR703901
      ** if the branch is invalid, display it on the browser                                AR703901
      *                                                                                     AR703901
     C           *IN23     IFEQ '0'                          B4
     C           WSHOW     ANDEQ'Y'                                                         AR703901
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP15                                           S01408
     C*                                                                   S01408
     C                     MOVE CNUM      SCNUM
     C                     MOVE CCY       SCCY
     C                     MOVE ACOD      SACOD
     C                     MOVE ACSQ      SACSQ
     C                     MOVE BRCA      SBRCA
     C                     MOVE BRCA      ABRCA
     C                     MOVE CNUM      CNUMB
     C                     MOVE CCY       CCYB
     C                     MOVE ACOD      ACODB
     C                     MOVE ACSQ      ACSQB
     C                     MOVE ANAM      SANAM
     C                     MOVELACNUMB    SACNUM
     C**
     C           RRN       IFEQ 0
     C**********           Z-ADDCNUM      WCNUM3                                              CSD027
     C                     MOVE CNUM      WCNUM3                                              CSD027
     C                     MOVELCCY       WCCY3
     C                     Z-ADDACOD      WACOD3
     C                     Z-ADDACSQ      WACSQ3
     C                     MOVELBRCA      WBRCA3
     C                     END
     C*
     C* setup retail number if retail account and retail number used.
     C*
     C                     MOVE *BLANK    SACNO
     C           ATYP      IFEQ 'R'                         B5
     C           *IN48     ANDEQ'1'
     C           ACNO      IFNE 0                           B6
     C                     MOVE ACNO      SACNO
     C                     END                              E6
     C                     END                              E5
     C*
     C* Setup Date Account opened
     C*
     C                     Z-ADDDACO      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SDACO
     C*
     C* Setup Date Account Closed
     C*
     C           DACC      IFNE 0                           B5
     C                     Z-ADDDACC      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SDACC
     C                     ELSE                             X5
     C                     MOVE *BLANK    SDACC
     C                     END                              E5
     C**
     C** WRITE IN SUBFILE
     C**
     C                     ADD  1         RRN
     C                     WRITEGL3271S0
     C                     END                              E4
     C*
     C** PAGE NOW FULL (OR EOF)
     C*
     C                     END                              E3
     C*
     C** READ ONE MORE RECORD FOR NEXT SCREEN
     C*
     C           *IN23     IFEQ '0'                           B3
     C                     READ ACCNTLXX                 23
     C                     END                                E3
     C*
     C** IF NOT EOF SET NEXT 'REVIEW FROM' KEY ELSE SET IT TO BLANK
     C*
     C           *IN23     IFEQ '0'                           B3
     C                     MOVE '1'       *IN20
     C                     MOVE CNUM      WCNUM2
     C                     MOVE CCY       WCCY2
     C                     MOVE ACOD      WACOD2
     C                     MOVE ACSQ      WACSQ2
     C                     MOVE BRCA      WBRCA2
     C                     ELSE
     C                     MOVE '0'       *IN20
     C                     MOVEL*BLANK    WCNUM2
     C                     MOVE *BLANK    WCCY2
     C                     MOVE *BLANK    WACOD2
     C                     MOVE *BLANK    WACSQ2
     C                     MOVE *BLANKS   WBRCA2
     C                     END                              E3
     C**
     C                     MOVELACKEY2    DDPKEY
     C*
     C** FOR SUBFILE CONTROL
     C*
     C           *IN24     IFEQ '1'                         B3
     C                     MOVEA'10'      *IN,21
     C                     ELSE                             X3
     C                     MOVEA'11'      *IN,21
     C                     END                              E3
     C*
     C                     END                              E2
     C**
     C                     WRITEGL3271C1
     C                     EXFMTGL3271C0
     C                     MOVEA'00'      *IN,07                          CRT001
     C                     MOVEA'000'     *IN,50
     C                     MOVEA'00000000'*IN,60
     C                     MOVEA'00'      *IN,68
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C                     END
     C**
     C** F3 PRESSED   - EXIT OF PROGRAM
     C**
     C           *INKC     IFEQ '1'                        B2
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C233
     C                     END                             E2
     C**
     C** F12 PRESSED - RETURN TO START SCREEN
     C**
     C           *INKL     IFEQ '1'                        B2
     C                     MOVEL'F0'      WFMT             START SCREEN
     C                     MOVE '0'       *IN79
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP42                                           S01408
      *                                                                   S01408
     C                     END                             E2
     C**
     C** F6 PRESSED - INSERT MODE REQUESTED
     C**
     C           *INKF     IFEQ '1'                        B2
     C** USER MUST BE AUTHORISED
     C           *IN40     IFEQ '1'                        B3
     C                     MOVE '0'       *IN79
     C                     MOVEL'FK'      WFMT
     C                     MOVE '1'       *IN30            INSERT MODE
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADD*ZERO     ODLN             Initial. O/D   CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C** RETAIL NUMBER NOT NOT USED
     C           *IN48     IFEQ '0'
     C                     MOVE '1'       *IN65
     C                     MOVE '1'       *IN68
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP12                                           S01408
     C*                                                                   S01408
     C** ACCOUNT NAME NOT DISPLAYED
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       *IN69
     C                     MOVE 'I'       DDACTN
     C                     ELSE                            X3
     C** ERROR MESSAGE
     C           ENQY      IFEQ *BLANK
     C                     MOVEL'RE71002' ZAMSID
     C                     ELSE
     C                     MOVEL'RE71017' ZAMSID           NO INSERT AUT.
     C                     END
     C                     EXSR ZASNMS
     C                     END                             E3
     C                     END                             E2
     C**
     C** F10 PRESSED - DELETE MODE REQUESTED
     C**
     C           *INKJ     IFEQ '1'                        B2
     C** USER MUST BE AUTHORISED
     C           *IN43     IFEQ '1'                        B3
     C                     MOVE 'D'       DDACTN
     C                     MOVEL'FK'      WFMT
     C                     MOVE '0'       *IN79
     C                     MOVE '1'       *IN33            DELETE MODE
     C** RETAIL NUMBER NOT USED
     C           *IN48     IFEQ '0'
     C                     MOVE '1'       *IN65
     C                     MOVE '1'       *IN68
     C                     END
     C                     ELSE                            X3
     C** ERROR MESSAGE
     C           ENQY      IFEQ *BLANK
     C                     MOVEL'RE71004' ZAMSID
     C                     ELSE
     C                     MOVEL'RE71017' ZAMSID           NO DELETE AUT.
     C                     END
     C                     EXSR ZASNMS
     C                     END                             E3
     C                     END                             E2
     C**
     C* RESET FIELD ERR ELSE SCROLL UP, SCROLL DOWN NO LONGER FUNCTIONS   099613
     C                     MOVE *BLANKS   ERR                             099613
     C** ROLLUP PRESSED
     C**
     C           *IN25     IFEQ '1'                        B2
     C                     MOVE WCNUM2    WWCNUM
     C                     MOVELWCCY2     WWCCY
     C                     MOVE WACOD2    WWACOD
     C                     MOVE WACSQ2    WWACSQ
     C                     MOVE WBRCA2    WWBRCA
     C**
     C                     END                             E2
     C**
     C** ROLLDOWN PRESSED
     C*
     C           *IN26     IFEQ '1'                        B2
     C**********           Z-ADDWCNUM3    WWCNUM                                              CSD027
     C                     MOVE WCNUM3    WWCNUM                                              CSD027
     C                     MOVELWCCY3     WWCCY
     C                     Z-ADDWACOD3    WWACOD
     C                     Z-ADDWACSQ3    WWACSQ
     C                     MOVELWBRCA3    WWBRCA
     C**
     C           WWACKB    SETLLACCNTLXX
     C                     Z-ADD0         WWCONT  30
     C           *IN81     DOUEQ'1'
     C           WWCONT    OREQ 12
     C/COPY WNCPYSRC,GL3271C056
     C                     READPACCNTLXX                 81
     C/COPY WNCPYSRC,GL3271C057
     C                     ADD  1         WWCONT
     C                     END
     C** LOAD KEY
     C           *IN81     IFEQ '1'
     C**********           Z-ADD0         WWCNUM                                              CSD027
     C                     MOVE *BLANKS   WWCNUM                                              CSD027
     C                     MOVEL*BLANKS   WWCCY
     C                     Z-ADD0         WWACOD
     C                     Z-ADD0         WWACSQ
     C                     MOVEL*BLANKS   WWBRCA
     C                     ELSE
     C**********           Z-ADDCNUM      WWCNUM                                              CSD027
     C                     MOVE CNUM      WWCNUM                                              CSD027
     C                     MOVELCCY       WWCCY
     C                     Z-ADDACOD      WWACOD
     C                     Z-ADDACSQ      WWACSQ
     C                     MOVELBRCA      WWBRCA
     C                     END                             E3
     C                     END                             E2
     C**
     C** ENTER PRESSED (REVIEW FROM OR SUBFILE ENTRY)
     C**
     C           *IN49     IFEQ '0'                        B2
     C**
     C**********           READCGL3271S0                 83               CDE002
     C                     READCGL3271S0                 80               CDE002
     C**
     C** IF A SUBFILE ENTRY HAS OCCURED
     C**
     C********** *IN83     IFEQ '0'                        B3             CDE002
     C           *IN80     IFEQ '0'                        B3             CDE002
     C           ZAMSID    ANDNE'RE71017'                                 124824
     C** DO VALIDATION ON BRANCH INPUT IF MULTIBRANCH                     097616
     C           BJSBRC    IFEQ *BLANKS                                   097616
     C                     MOVELSBRCA     @BRCA                           097616
     C           DDSEL     IFEQ '1'                                       097616
     C           DDSEL     OREQ '2'                                       097616
     C           DDSEL     OREQ '3'                                       097616
     C           DDSEL     OREQ '4'                                       097616
     C           DDSEL     OREQ '5'                                       097616
     C                     MOVEL'E'       @ZACTN                          097616
     C                     ELSE                                           097616
     C                     MOVELDDSEL     @ZACTN                          097616
     C                     END                                            097616
     C                     EXSR #AUTH                                     097616
     C           @ERR      IFNE 0                                         097616
     C                     SELEC                                          097616
     C           @ZACTN    WHNE 'E'                                       124824
     C           ENQY      ANDNE*BLANK                                    124824
     C                     MOVEL'RE71017' ZAMSID                          124824
     C           @ZACTN    WHEQ 'A'                                       097616
     C                     MOVEL'RE7103B' ZAMSID                          097616
     C           @ZACTN    WHEQ 'D'                                       097616
     C                     MOVEL'RE7104B' ZAMSID                          097616
     C           @ZACTN    WHEQ 'E'                                       097616
     C                     MOVEL'RE7105B' ZAMSID                          097616
     C                     ENDSL                                          097616
     C                     EXSR ZASNMS                                    097616
     C                     MOVEL'E'       ERR                             097616
     C                     END                                            097616
     C                     END                                            097616
     C           ERR       IFNE 'E'                                       097616
     C                     MOVELDDSEL     DDACTN
     C                     MOVE SCNUM     WWCNUM
     C                     MOVELSCCY      WWCCY
     C                     MOVE SACOD     WWACOD
     C                     MOVE SACSQ     WWACSQ
     C                     MOVE SBRCA     WWBRCA
     C**
     C                     MOVEL*BLANK    DDSEL
     C                     UPDATGL3271S0
     C                     EXSR #V10S0
     C                     END                                            097616
     C                     MOVEL*BLANKS   ERR                             097616
     C                     MOVEL*BLANK    DDSEL                           097616
     C**
     C                     ELSE                            X3
     C**
     C** REVIEW FROM ENTRY
     C**
     C                     MOVEL*BLANKS   ACKEY
     C                     MOVEL*BLANKS   ACKEY2
     C**
     C                     MOVELDDPKEY    ACKEY
     C                     MOVELDDPKEY    ACKEY2
     C**
     C           ACCKY     IFEQ *BLANKS
     C           RETKY     ANDNE*BLANKS
     C                     MOVEARETKY     RETA
     C                     EXSR #RETTS
     C**
     C           *IN80     IFEQ '1'
     C                     MOVEL'R'       WWKEY
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP14                                           S01408
     C*                                                                   S01408
     C**
     C                     END
     C           WWKEY     IFNE 'R'
     C**
     C           WCNUM2    IFNE *BLANKS
     C                     MOVE WCNUM2    WWCNUM
     C                     ELSE
     C**********           Z-ADD0         WWCNUM                                              CSD027
     C                     MOVE *BLANKS   WWCNUM                                              CSD027
     C                     END
     C**
     C                     MOVELWCCY2     WWCCY
     C           WACOD2    IFNE *BLANKS
     C                     MOVE WACOD2    WWACOD
     C                     ELSE
     C                     Z-ADD0         WWACOD
     C                     END
     C**
     C           WACSQ2    IFNE *BLANKS
     C                     MOVE WACSQ2    WWACSQ
     C                     ELSE
     C                     Z-ADD0         WWACSQ
     C                     END
     C**
     C           WBRCA2    IFNE *BLANKS
     C                     MOVELWBRCA2    WWBRCA
     C                     ELSE
     C                     MOVEL*BLANKS   WWBRCA
     C                     END
     C**
     C                     END
     C**
     C                     MOVEL*BLANKS   DDPKEY
     C**
     C                     END                             E3
     C**
     C                     END                             E2
     C**
     C                     END                             E1
     C**
     C                     ENDSR                           ** #P10S0 ESR *
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10S0   - PROCESS VALIDATION OF SUBFILE                         *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #DIR     - TO PROCESS FORMAT AND MODE                            *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10S0   - PROCESS REVIEW FROM SUBFILE                           *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWDSPY   - DISPLAY CODE                                          *
      *                                                                  *
      ********************************************************************
     C           #V10S0    BEGSR
     C**
     C** ACCESS FILE
     C**
     C           WWACKB    CHAINACCNTLXX             80
     C**
     C** TEST VALUE OF WWACTN TO DETERMINE WHICH SCREEN
     C** TO SEND AND IN WHICH MODE
     C**
     C           ATYP      IFEQ 'R'
     C                     MOVE '1'       *IN29
     C                     ELSE
     C                     MOVE '0'       *IN29
     C                     END
     C**
     C*
     C           DDACTN    IFEQ 'A'
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP57                                           S01408
     C*                                                                   S01408
     C** USER MUST BE AUTHORISED
     C           *IN41     IFEQ '1'
     C** RECORD MUST BE LIVE
     C           *IN80     IFEQ '1'
     C           DACC      ORNE *ZEROS
     C                     MOVEL'RE71013' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     ELSE
      *                                                                   CFT004
      *** Account cannot be amended if incoming funds transfer recorCFT004183052
      ****exist*(CFT004*must*be*on)                                 CFT004183052
      **                                                            CFT004183052
     C********** CFT004    IFEQ 'Y'                                 CFT004183052
     C********** IBAN      CHAININPAYIB              80             CFT004183052
     C********** *IN80     IFEQ *OFF                                CFT004183052
     C**********           MOVEL'RE72026' ZAMSID                    CFT004183052
     C**********           EXSR ZASNMS                              CFT004183052
     C**********           MOVE 'E'       ERR              ERROR INDCFT004183052
     C**********           ELSE                                     CFT004183052
     C**********           MOVEL'F1'      WWDSPY                    CFT004183052
     C**********           MOVEA'0100'    *IN,30           AMEND MODCFT004183052
     C**********           MOVE '0'       *IN79                     CFT004183052
     C**********           EXSR #DIR                                CFT004183052
     C**********           ENDIF                                    CFT004183052
     C**********           ELSE                                     CFT004183052
     C                     MOVEL'F1'      WWDSPY
     C                     MOVEA'0100'    *IN,30           AMEND MODE
     C                     MOVE '0'       *IN79
     C                     EXSR #DIR
     C**********           ENDIF                                    CFT004183052
     C                     END
     C                     ELSE
     C** ERROR MESSAGE
     C           ENQY      IFEQ *BLANK
     C                     MOVEL'RE71003' ZAMSID
     C                     ELSE
     C                     MOVEL'RE71017' ZAMSID           NO AMEND  AUT.
     C                     END
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP59                                           S01408
     C*                                                                   S01408
     C**
     C                     END
     C**
     C           DDACTN    IFEQ 'E'
     C           DDACTN    OREQ '1'
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP56                                           S01408
     C*                                                                   S01408
     C                     MOVEL'F1'      WWDSPY
     C                     MOVEA'0010'    *IN,30           ENQUIRY MODE
     C                     MOVE '0'       *IN79
     C                     EXSR #DIR
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP58                                           S01408
     C*                                                                   S01408
     C                     END
     C**
     C           DDACTN    IFEQ '2'
     C** MUST BE RETAIL
     C           *IN29     IFEQ '1'
     C                     MOVEL'F2'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     MOVE '0'       *IN79
     C                     EXSR #DIR
     C                     ELSE
     C                     MOVEL'RE71011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END
     C                     END
     C**
     C           DDACTN    IFEQ '3'
     C** MUST BE RETAIL
     C           *IN29     IFEQ '1'
     C                     MOVEL'F3'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     MOVE '0'       *IN79
     C                     EXSR #DIR
     C                     ELSE
     C                     MOVEL'RE71011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END
     C                     END
     C**
     C           DDACTN    IFEQ '4'
     C** MUST BE RETAIL
     C           *IN29     IFEQ '1'
     C                     MOVEA'0010'    *IN,30
     C                     MOVE '0'       *IN79
     C                     ELSE
     C                     MOVEL'RE71011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END
     C** AT LEAST ONE COMMISSION MUST BE PRESENT
     C           ERR       IFEQ *BLANK
     C           *IN34     ANDEQ'1'
     C                     MOVEL'F4'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     MOVE '0'       *IN79
     C                     EXSR #DIR
     C                     ELSE
     C                     MOVEL'RE71016' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END
     C                     END
     C**
     C           DDACTN    IFEQ '5'
     C** MUST BE RETAIL
     C           *IN29     IFEQ '1'
     C                     MOVEL'F5'      WWDSPY
     C                     MOVEA'0010'    *IN,30
     C                     MOVE '0'       *IN79
     C                     EXSR #DIR
     C                     ELSE
     C                     MOVEL'RE71011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END
     C                     END
     C*******************#######**********########************##########
     C           DDACTN    IFEQ 'D'
     C** USER MUST BE AUTHORISED
     C/COPY WNCPYSRC,GL3271C160
     C           *IN43     IFEQ '1'
     C                     MOVEL'FK'      WFMT
     C                     MOVE '0'       *IN79
     C                     MOVE '1'       *IN33
     C                     MOVE CNUM      SWSVNM
     C                     MOVE CCY       SWSVCY
     C                     MOVE ACOD      SWSVAD
     C                     MOVE ACSQ      SWSVAS
     C                     MOVE BRCA      SWSVBD
     C                     MOVE ANAM      SWSVAM
     C           *IN48     IFEQ '0'
     C                     MOVE '1'       *IN65
     C                     MOVE '1'       *IN68
     C                     ELSE
     C           ACNO      IFEQ *ZEROS                                   064592
     C                     MOVEL*BLANKS   SWSVAO                         064592
     C                     ELSE                                          064592
     C                     MOVE ACNO      SWSVAO
     C                     END                                           064592
     C                     END
     C                     ELSE
     C** ERROR MESSAGE
     C           ENQY      IFEQ *BLANK
     C                     MOVEL'RE71004' ZAMSID
     C                     ELSE
     C                     MOVEL'RE71017' ZAMSID           NO DELETE AUT.
     C                     END
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C/COPY WNCPYSRC,GL3271C161
     C************###########*************############***************
     C**
     C** IF ENQUIRY MODE AND USER AUTHORISED TO AMEND BUT ACCOUNT CLOSED
     C** SETON INDICATOR TO FORBID AMEND
     C**
     C           *IN32     IFEQ '1'
     C           *IN41     ANDEQ'1'
     C           SDACC     ANDNE*BLANKS
     C                     MOVE '1'       *IN39
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10FK   - INSERT AND DELETE MODE                                *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1005   - SET WORK FIELDS TO BLANK                              *
      * #P1006   - SET SCREEN FIELDS TO BLANK                            *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #P1004   - DELETE PROCESSING                                     *
      * #V10FK   - PROCESS VALIDATION OF 'FK' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      * WWPASS   - FLAG USED IN DELETE MODE                              *
      *                                                                  *
      ********************************************************************
     C           #P10FK    BEGSR                           ** #P10FK BSR *
     C*
     C*  Set start screen indicator
     C*
     C                     MOVE '0'       *IN29
     C                     MOVE '0'       *IN72            DATE CLOSED
     C                     MOVE '1'       *IN77
     C                     MOVE ' '       ERR     1
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP37                                           S01408
      *                                                                   S01408
     C**
     C                     EXSR #P1005
     C                     EXSR #P1006
     C*
     C** CLEAR WHOLE SCREEN
     C*
     C                     WRITEGL3271FC
     C                     EXSR #DELDF
     C/COPY WNCPYSRC,GL3271C021
     C*
     C*  Output format
     C*
     C           WFMT      DOUNE'FK'                       -B1
     C**
     C                     WRITEGL3271C1
     C                     EXFMTGL3271FK
     C                     MOVEA'0000000' *IN,53
     C** UNPROTECT SCREEN FIELDS AFTER DELETION PROCESSING
     C           *IN33     IFEQ '1'
     C                     MOVEA'0000000' *IN,60
     C                     END
     C                     MOVEL*BLANK    ERR
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C                     END
     C*
     C** F3 PRESSED - EXIT OF PROGRAM
     C**
     C           *INKC     IFEQ '1'                        -B2
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C234
     C                     END                             -E2
     C**
     C** F12 PRESSED - PREVIOUS SCREEN
     C**
     C           *INKL     IFEQ '1'                        -B2
     C                     MOVELWWRTRN    WFMT
     C                     MOVE '0'       *IN77
     C                     MOVE '0'       *IN42
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP43                                           S01408
      *                                                                   S01408
     C                     END                             -E2
     C**
     C** F5 PRESSED - REFRESH
     C**
     C           *INKE     IFEQ '1'
     C           *IN42     IFEQ '0'
     C                     MOVEL*BLANKS   SCNUM
     C                     MOVEL*BLANKS   SCCY
     C                     MOVEL*BLANKS   SACOD
     C                     MOVEL*BLANKS   SACSQ
     C                     MOVEL*BLANKS   SBRCA
     C                     MOVEL*BLANKS   SACNO
     C                     MOVEL*BLANKS   SANAM
     C/COPY WNCPYSRC,GL3271C022
     C                     ELSE
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVEA'1111111' *IN,60
     C                     END
     C                     END
     C*
     C** F10 PRESSED - DELETE REQUESTED
     C**
     C           *INKJ     IFEQ '1'                        B2
     C**
     C/COPY WNCPYSRC,GL3271C162
     C           *IN33     IFEQ '1'                        B3
     C           WWPASS    IFEQ 'Y'                        B4
     C                     EXSR #P1004
     C                     ELSE
     C** ERROR MESSAGE
     C                     MOVEL'RE71015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             E4
     C                     ELSE                            X3
     C** ERROR MESSAGE
     C                     MOVEL'RE71008' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             E3
     C/COPY WNCPYSRC,GL3271C163
     C                     END                             E2
     C**
     C** ENTER PRESSED - VALIDATION AND NEXT SCREEN
     C**
     C           *IN49     IFEQ '0'
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP24                                           S01408
     C*                                                                   S01408
     C**
     C** VALIDATE SCREEN
     C**
     C                     EXSR #V10FK
     C/COPY WNCPYSRC,GL3271C167
     C**
     C           ERR       IFEQ ' '                        B3
     C           *IN42     ANDEQ'1'                        DELETE CONFIRM.
     C                     MOVEL'Y'       WWPASS  1
     C                     MOVEL'FK'      WFMT
     C                     MOVEA'1111111' *IN,60           PROTECT MODE
     C/COPY WNCPYSRC,GL3271C173
     C                     ELSE
     C           *IN33     IFEQ '1'
     C                     MOVE '0'       *IN66
     C                     ELSE
     C                     MOVE '1'       *IN66
     C                     END
     C                     END                             E3
     C**
     C                     END                             E2
     C**
     C*
     C                     END                             E1
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP38                                           S01408
      *                                                                   S01408
     C**
     C                     ENDSR                           ** #P10FK ESR *
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10FK   - PROCESS VALIDATION OF 'FK' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #RETTS   - PROCESS VALIDATION OF RETAIL NUMBER                   *
      * #DIR     - TO PROCESS FORMAT AND MODE                            *
      * ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE                *
      * ZEDIT    - TO FORMAT A NUMERIC FIELD WITH DECIMAL POINT          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10FK   - INSERT AND DELETE MODE                                *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWACSQ   - ACCOUNT SEQUENCE                                      *
      * WWRKEY   - RETAIL NUMBER KEY                                     *
      * WWCNUM   - CUSTOMER NUMBER                                       *
      * WWCCY    - CURRENCY CODE                                         *
      * WWACOD   - ACCOUNT CODE                                          *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWDSPY   - DISPLAY CODE                                          *
      * WWD      - WORK FIELD                                            *
      * WWCUSK   - CUSTOMER NUMBER KEY                                   *
      * WWCCYK   - CURRENCY CODE KEY                                     *
      * WWACOK   - ACCOUNT CODE KEY                                      *
      * WWACSK   - ACCOUNT SEQUENCE KEY                                  *
      * WWACK2   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWBRCD   - BRANCH CODE                                           *
      *                                                                  *
     C********************************************************************
     C           #V10FK    BEGSR
     C*
     C                     MOVE '0'       *IN36
     C**
     C** IF INSERT OR DELETE MODE ACTIVE
     C**
     C           *IN30     IFEQ '1'                        -B1
     C           *IN33     OREQ '1'
     C*
     C** MULTIBRANCHING PRESENT - BJFLST='Y'
     C*
     C** BRANCH CODE IS NOT ENTERED
     C*
     C/COPY WNCPYSRC,GL3271C064
     C           SBRCA     IFEQ *BLANKS                    -B3
     C** SET BRANCH CODE EQUAL TO DEFAULT
     C                     MOVELDBRN      SBRCA
     C                     END                             -E3
     C** BRANCH CODE IF ENTERED MUST EXIST ON SDBRCHPD FILE
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SBRCA     @BRCA   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71040' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN57
     C                     ELSE                                           126302
     C* IF MULTIBRANCHING DO VALIDATION ON BRANCH INPUT                   097616
     C           BJSBRC    IFEQ *BLANKS                                   097616
     C                     MOVELDDACTN    @ZACTN                          097616
     C                     MOVELSBRCA     @BRCA                           097616
     C                     EXSR #AUTH                                     097616
     C           @ERR      IFNE 0                                         097616
     C           DDACTN    IFEQ 'I'                                       124824
     C                     MOVE '1'       *IN40                           097616
     C                     MOVEL'RE7102B' ZAMSID                          097616
     C                     END                                            124824
     C           DDACTN    IFEQ 'D'                                       124824
     C                     MOVE *ON       *IN41                           124824
     C                     MOVEL'RE7104B' ZAMSID                          124824
     C                     END                                            124824
     C                     EXSR ZASNMS                                    097616
     C                     MOVEL'E'       ERR                             097616
     C                     MOVE '1'       *IN57                           097616
     C                     END                                            097616
     C                     END                                            097616
     C***********          ELSE                                           126302
     C                     MOVELA8BRCD    SBRCA
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP85                                           S01408
     C*                                                                   S01408
     C                     END                             -E4
     C*
     C** CUSTOMER NUMBER ENTRY IS MANDATORY
     C*
     C           SCNUM     IFEQ *BLANKS                    -B2
     C                     MOVEL'RE71030' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN53
     C                     END                             -E2
     C*
     C***CURRENCY IS MANDATORY                                            074586
     C***********                                                         074586
     C***********SCCY      IFEQ *BLANKS                    -B2            074586
     C***********          MOVEL'RE71034' ZAMSID                          074586
     C***********          EXSR ZASNMS                                    074586
     C***********          MOVEL'E'       ERR                             074586
     C***********          MOVE '1'       *IN54                           074586
     C***********          END                             -E2            074586
     C***********                                                         074586
     C***ACCOUNT*CODE IS MANDATORY                                        074586
     C***********                                                         074586
     C***********SACOD     IFEQ *BLANKS                    -B2            074586
     C***********          MOVEL'RE71035' ZAMSID                          074586
     C***********          EXSR ZASNMS                                    074586
     C***********          MOVEL'E'       ERR                             074586
     C***********          MOVE '1'       *IN55                           074586
     C***********          END                             -E2            074586
     C**++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** ACCOUNT NAME      - VFKANAM
     C**++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** ACCOUNT NAME IS FREE FORMAT BUT MANDATORY(DELETE MODE)
     C           SANAM     IFEQ *BLANKS                    -B2
     C           *IN33     ANDEQ'1'
     C                     MOVEL'RE71043' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN59
     C                     END                             -E2
     C**
     C**If*action*code*is*D*check*that*no*Euro*Mapping*record*is   138518*153092
     C**scheduled*to*be*produced.*If*it*is*block*deletion.*        138518*153092
     C**                                                           138518*153092
     C* If action code is D check that no Sweep is scheduled.             153092
     C*                                                                   153092
     C           DDACTN    IFEQ 'D'                                       138518
     C*                                                                   138518
     C***********WWACKB    CHAINEUACMLL6             80            138518*153092
     C***********WWACKB    CHAINRESWEPL4             83            153092*154539
     C**********           MOVE SCNUM     #SCNUM  60                                   154539 CSD027
     C                     MOVE SCNUM     #SCNUM  6                                           CSD027
     C**********           MOVE SACOD     #SACOD  40                                   154539 CGL029
     C                     MOVE SACOD     #SACOD 100                                          CGL029
     C                     MOVE SACSQ     #SACSQ  20                      154539
     C********** SWACC     CHAINRESWEPL4             83            154539 CDE002
     C           SWACC     CHAINRESWEPL4             81                   CDE002
     C**                                                                  138518
     C************IN80*****IFEQ*'1'                                 138518143204
     C********** *IN80     IFEQ '0'                                 143204153092
     C********** *IN83     IFEQ '0'                                153092 CDE002
     C           *IN81     IFEQ '0'                                       CDE002
     C           SWRECI    ANDEQ'D'                                       153092
     C                     MOVE SWEP      ZA0002                          153092
     C                     MOVEL'RE72015' ZAMSID                          138518
     C                     EXSR ZASNMS                                    138518
     C                     MOVE 'E'       ERR                             138518
     C                     MOVE '1'       *IN59                           138518
     C                     END                                            138518
     C*                                                                   138518
     C                     END                                            138518
     C**                                                                  138518
     C** IF NO ERRORS PROCESS KEY VALIDATION
     C**
     C           ERR       IFEQ *BLANK                     -B2
     C**
     C** CUSTOMER NUST BE LIVE ON SDCUSTPD
     C**
     C*****                CALL 'AOCUSTR0'                                178695
     C                     CALL 'AOCUSTR1'                                178695
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SCNUM     @CNUM  10
     C                     PARM           @CNST   7
     C*****      SDCUST    PARM SDCUST    DSSDY                           178695
     C           SDCUST    PARM SDCUST    DSLDY                           178695
      *                                                                   072879
     C/COPY WNCPYSRC,GL3271C218
     C           @RTCD     IFEQ *BLANKS                                   072879
     C                     MOVE BBCUST    SCNUM                           072879
     C                     END                                            072879
      *                                                                   072879
     C           @RTCD     IFNE *BLANK
     C           BBDTDL    ORNE 0                                        060902
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71031' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN53
     C                     ELSE                            -X3
     C***CUSTOMER*CANNOT*BE*A*PARENT***********************************                       226364
     C********** BBPAIN    IFEQ 'P'                        -B4                                226364
     C**********           MOVEL'RE71032' ZAMSID                                              226364
     C**********           EXSR ZASNMS                                                        226364
     C**********           MOVEL'E'       ERR                                                 226364
     C**********           MOVE '1'       *IN53                                               226364
     C**********           END                             -E4                                226364
     C                     END                             -E3
     C*                                                                   074586
     C** CURRENCY IS MANDATORY                                            074586
     C*                                                                   074586
     C           SCCY      IFEQ *BLANKS                                   074586
     C                     MOVEL'RE71034' ZAMSID                          074586
     C                     EXSR ZASNMS                                    074586
     C                     MOVEL'E'       ERR                             074586
     C                     MOVE '1'       *IN54                           074586
     C                     END                                            074586
     C**
     C** CURRENCY MUST BE LIVE ON SDCURRPD
     C**
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SCCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFNE *BLANK
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN54
      *                                                                   072879
     C                     ELSE                                           072879
     C                     MOVE A6CYCD    SCCY                            072879
     C/COPY WNCPYSRC,GL3271C135
     C                     END                             -E3
     C*                                                                   074586
     C** ACCOUNT CODE IS MANDATORY                                        074586
     C*                                                                   074586
     C           SACOD     IFEQ *BLANKS                                   074586
     C                     MOVEL'RE71035' ZAMSID                          074586
     C                     EXSR ZASNMS                                    074586
     C                     MOVEL'E'       ERR                             074586
     C                     MOVE '1'       *IN55                           074586
     C                     END                                            074586
     C**
     C** ACCOUNT CODE MUST BE LIVE
     C                     CALL 'AOACODR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C**********           PARM SACOD     @ACOD   4                                           CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
     C                     PARM SACOD     @ACOD  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN55
     C                     ELSE                            -X3
     C**
     C** LOAD ACCOUNT TYPE FOR FURTHER PROCESS
     C**
     C                     MOVE A5ACCD    SACOD                           072879
     C                     MOVE A5ACTY    SSATYP
     C                     MOVE A5ACST    SSSTYP
     C                     MOVE A5ACTY    SWATYP
     C                     MOVE A5ACST    SWSTYP
     C           A5ACTY    IFEQ 'R'                        -B4
     C** ACCOUNT TYPE IS RETAIL
     C                     MOVE '1'       *IN29
     C                     ELSE                            -X4
     C                     MOVE '0'       *IN29
     C                     END                             -E4
     C**
     C** ACCOUNT CODE CAN NOT BE A TITLE
     C           A5TOIN    IFEQ 'Y'                        -B4
     C                     MOVEL'RE71038' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN55
     C                     END                             -E4
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP1                                           S01408
     C*                                                                   S01408
     C                     END                             -E3
     C/COPY WNCPYSRC,GL3271C023
     C**++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** ACCOUNT SEQUENCE  - VFKACSQ
     C**++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** ACCOUNT SEQUENCE NOT ENTERED
     C           SACSQ     IFEQ *BLANKS                    -B3
     C           MBIN      ANDEQ'Y'
     C** SET DEFAULT TO '01'
     C                     MOVEL'01'      SACSQ
     C                     END                             -E3
     C** ACCOUNT SEQUENCE NOT ENTERED AND MULTIB. ON DEFAULT
     C** TO START ACCOUNT SEQUENCE
     C* Excpt if customer is internal customer number then default
     C* to '01'
     C           SACSQ     IFEQ *BLANKS                    -B3
     C           MBIN      ANDEQ'Y'
     C           SCNUM     IFEQ A8BICN
     C                     MOVEL'01'      SACSQ
     C                     END                             -E3
     C                     END                             -E3
     C**
     C** ACCOUNT SEQUENCE ENTERED
     C**                                                                  155510
     C           SACSQ     IFEQ *BLANKS                                   155510
     C                     MOVE '01'      SACSQ                           155510
     C                     END                                            155510
     C**
     C           SACSQ     IFNE *BLANKS                    -B3
     C** MULTIBRANCH OFF
     C***********MBIN      IFNE 'Y'                        -B4            074588
     C** MUST BE NUMERIC BETWEEN 01 AND 99
     C                     MOVEASACSQ     SEQ
     C           SEQ,1     LOKUPNUM                      80
     C           SEQ,2     LOKUPNUM                      81
     C** NOT NUMERIC
     C           *IN80     IFEQ '0'                        -B5
     C           *IN81     OREQ '0'
     C           SACSQ     OREQ '00'                                      055357
     C                     MOVEL'RE71041' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN56
     C                     END                             -E5
     C** MULTIB. ON
     C           MBIN      IFEQ 'Y'                        -B4            074588
     C***********          ELSE                            -X4            074588
     C** MUST BE BETWEEN START ACCOUNT SEQUENCE AND END ACCOUNT
     C** SEQUENCE
     C* Excpt if customer is internal customer number then default
     C           WWACSQ    IFEQ 01                         B5
     C           SCNUM     ANDEQA8BICN
     C                     MOVE 'Y'       WWBICN
     C                     ELSE
     C                     MOVE 'N'       WWBICN  1
     C                     END                             -E5
     C*
     C                     MOVE SACSQ     WWACSQ
     C                     END                             -E4
     C**
     C                     END                             -E3
     C**
     C                     END                             -E2
     C**
     C** IF NO ERRORS
     C**
     C           ERR       IFEQ *BLANK
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP3                                           S01408
     C*                                                                   S01408
     C**
     C** RETAIL NUMBER VALIDATION ONLY IF RETAIL NUMBER USED
     C**
     C           *IN48     IFEQ '1'
     C           *IN33     ANDEQ*OFF                                       155245
     C**
     C** RETAIL NUMBER ENTERED
     C           SACNO     IFNE *BLANKS
     C** A/C TYPE MUST BE RETAIL
     C           *IN29     IFEQ '0'
     C                     MOVEL'RE71047' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN58
     C**
     C                     ELSE
     C/COPY WNCPYSRC,GL3271C065
     C** ACCOUNT TYPE IS RETAIL
     C** RETAIL MUST BE NUMERIC
     C                     MOVEASACNO     RETA
     C                     EXSR #RETTS
     C           *IN80     IFEQ '0'
     C                     MOVEL'RE71048' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN58
     C                     MOVEL'E'       ERR
     C                     ELSE
     C** MUST BE GREATER THAN 0 AND LOWER THAN 9999999999
     C                     Z-ADD99999     RETN1
     C                     Z-ADD99998     RETN2
     C                     MOVE SACNO     WWRKEY
     C           WWRKEY    IFLT 1
     C           WWRKEY    ORGT RETNR
     C                     MOVEL'RE71046' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN58
     C                     MOVEL'E'       ERR
     C                     ELSE                                                               CGL062
     C** If Modulus 11 Checking is enabled, perform this validation                           CGL062
     C           MOD11     IFEQ 'Y'                                                           CGL062
     C           DDACTN    ANDEQ'I'                                                           242011
     C                     MOVELSACNO     SRTNO                                               CGL062
     C                     EXSR #VMD11                                                        CGL062
     C           ACNOOK    IFNE 'Y'                                                           CGL062
     C                     MOVEL'RE62001' ZAMSID                                              CGL062
     C                     EXSR ZASNMS                                                        CGL062
     C                     MOVE '1'       *IN58                                               CGL062
     C                     MOVEL'E'       ERR                                                 CGL062
     C                     ENDIF                                                              CGL062
     C                     ENDIF                                                              CGL062
     C                     END
     C                     END
     C                     END
     C                     ELSE                             SACNO BLANK
     C           *IN29     IFEQ '1'
     C/COPY WNCPYSRC,GL3271C066
     C                     MOVEL'RE71046' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN55
     C                     MOVE '1'       *IN58
     C                     MOVEL'E'       ERR
     C/COPY WNCPYSRC,GL3271C067
     C                     END
     C**
     C                     END
     C**
     C                     END                             *IN48
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C107                                           S01408
     C*                                                                   S01408
     C                     END                             ERR
     C**
     C                     END                             -E1
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP34                                           S01408
     C*                                                                   S01408
     C**
     C** INSERT MODE ONLY
     C**
     C           *IN30     IFEQ '1'
     C           ERR       ANDEQ*BLANK
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C108                                           S01408
     C*                                                                   S01408
      ***********                                                  S01486 CPM004
      ***Check*if*customer*entered**s*a*Portfolio*Customer*        S01486 CPM004
      ***********                                                  S01486 CPM004
     C***********BGPFMG    IFEQ 'Y'                                S01486 CPM004
     C***********          CALL 'AOPLCSR0'                         S01486 CPM004
     C***********          PARM *BLANKS   @RTCD                    S01486 CPM004
     C***********          PARM '*KEY   ' @OPTN                    S01486 CPM004
     C***********          PARM SCNUM     @CUSN  10                S01486 CPM004
     C***********SDPLCS    PARM SDPLCS    DSFDY                    S01486 CPM004
      ***********                                                  S01486 CPM004
     C***********@RTCD     IFEQ '*NRF'                             S01486 CPM004
     C***********          MOVE *ON       *IN38                    S01486 CPM004
     C***********          ELSE                                    S01486 CPM004
     C***********          MOVE *OFF      *IN38                    S01486 CPM004
     C***********          END                                     S01486 CPM004
     C***********          END                                     S01486 CPM004
     C**
     C** RETAIL NUMBER VALIDATION
     C** CANNOT EXIST ON RETAIL ACCOUNT FILE
     C           SACNO     IFNE *BLANKS
     C                     MOVE SACNO     WWRKEY
     C           WWRKEY    CHAINACNUM                80
     C**
     C           *IN80     IFEQ '0'
     C                     MOVEL'RE71049' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN58
     C                     MOVEL'E'       ERR
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP66                                           S01408
     C*                                                                   S01408
     C                     END
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C109                                           S01408
     C*                                                                   S01408
     C**
     C** IF NO ERROR PROCESS ACCOUNT NUMBER VALIDATION
     C**
     C           ERR       IFEQ *BLANK
     C**
     C                     MOVE SCNUM     WWCNUM
     C                     MOVELSCCY      WWCCY
     C                     MOVE SACOD     WWACOD
     C                     MOVE SACSQ     WWACSQ
     C                     MOVE SBRCA     WWBRCA
     C**
     C           WWACKB    CHAINACCNTLXX             80
     C**
     C           *IN80     IFNE '1'
     C                     MOVEL'RE71020' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEA'1111'    *IN,53
     C                     MOVEL'E'       ERR
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP25                                           S01408
     C*                                                                   S01408
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP35                                           S01408
     C*                                                                   S01408
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP39                                           S01408
      *                                                                   S01408
     C**
     C** IF NO ERROR SET SCREN CONTROL FIELD TO F1
     C           ERR       IFEQ *BLANK
     C** AND PREPARE UPDATE OF FILE
     C                     MOVE SCNUM     SSCNUM
     C                     MOVE SCCY      SSCCY
     C                     MOVE SACOD     SSACOD
     C                     MOVE SACSQ     SSACSQ
     C                     MOVE SBRCA     SSSPTA
     C** RETAIL NUMBER ONLY IF ENTERED
     C                     MOVE SACNO     SSACNO
     C/COPY WNCPYSRC,GL3271C251
     C**
     C                     MOVE 'F1'      WWDSPY
     C                     EXSR #DIR
     C                     END
     C**
     C** HERE INCLUDE RETAIL DEFAULT VALUE
     C**
     C           ERR       IFEQ *BLANKS                    - B1
     C**
     C** IF INSERT MODE LOAD DEFAULT VALUES
     C**
     C                     EXSR #DEFT
     C                     MOVE SACOD     WWACOD
     C                     MOVE 'D'       WWD     1
     C/COPY WNCPYSRC,GL3271C071
      *                                                                                       CRE030
     C           CRE030    IFEQ 'Y'                                                           CRE030
     C                     MOVE SCCY      WWCCY                                               CRE030
     C           ACODK2    CHAINREDEFDF              80                                       CRE030
     C                     ELSE                                                               CRE030
     C********   ACODK     CHAINREDEF                80                                       CRE030
     C           ACODK     CHAINREDEFDF              80                                       CRE030
     C                     ENDIF                                                              CRE030
     C/COPY WNCPYSRC,GL3271C072
     C           *IN80     IFEQ '0'                        - B2
     C           RECI      ANDEQ'D'
     C********** CNUM      IFEQ *ZEROS                     - B3                               CSD027
     C           CNUM      IFEQ *BLANKS                    - B3                               CSD027
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP86                                           S01408
     C*                                                                   S01408
     C           RETN      CHAINACNUM                80
     C           *IN80     IFEQ '0'                        - B4
     C                     MOVE CNUM      WWCUSK
     C                     MOVE CCY       WWCCYK
     C                     MOVE ACOD      WWACOK
     C                     MOVE ACSQ      WWACSK
     C                     MOVE BRCA      WWBRCK
     C           WWACK3    CHAINACCNTLXX             80
     C                     END                             - E4
     C                     ELSE                            - X3
     C                     MOVE CNUM      WWCUSK
     C                     MOVE RCCY      WWCCYK
     C                     MOVE ACOD      WWACOK
     C                     MOVE SEQR      WWACSK
     C                     MOVE BRCA      WWBRCK
     C           WWACK3    CHAINACCNTLXX             80
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP87                                           S01408
     C*                                                                   S01408
     C                     END                             - E3
     C           *IN80     IFEQ '0'                        - B3
      *                                                                                       CRE030
      ** Default Minimum Balance if CRE030 is enabled                                         CRE030
     C           CRE030    IFEQ 'Y'                                                           CRE030
     C                     MOVE MINB      ZFIELD                                              CRE030
     C                     Z-ADD*ZEROS    ZADEC                                               CRE030
     C           11        SUB  *ZEROS    ZADIG                                               CRE030
     C                     EXSR ZEDIT                                                         CRE030
     C                     MOVE ZFIELD    SMINB                                               CRE030
     C                     ENDIF                                                              CRE030
     C* SET THE DEFAULT VALUE OF ACCNT
     C**
     C                     MOVEL*BLANKS   SDACO
     C                     Z-ADDNSTD      SSNSTD
     C           SSNSTD    IFNE *ZEROS                     -B5
     C                     Z-ADDSSNSTD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SNSTD
     C                     ELSE
     C                     MOVEL*BLANKS   SNSTD
     C                     END
     C**
     C                     BITOF'01234567'SWGLBT
     C                     BITOF'01234567'SSGLBT
     C                     TESTB'2'       GLBT           85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SPTAD
     C                     BITON'2'       SSGLBT
     C                     ELSE
     C                     MOVEL'N'       SPTAD
     C                     END
     C**
     C                     MOVE STFQ      SSSTFQ
     C                     MOVE STFQ      SSTFQ
     C**
     C                     Z-ADDENOC      SSENOC
     C           SSENOC    IFEQ *ZEROS                     -B5
     C                     MOVE *BLANKS   SENOC
     C                     ELSE
     C                     MOVE SSENOC    SENOC
     C                     END
     C**
     C                     MOVELADREF1    SSREF
     C                     MOVE ADREF2    SSREF
     C                     MOVE SWREF     SREF
     C**
     C                     MOVE MFFQ      SSMFFQ
     C                     MOVE MFFQ      SMFFQ
     C**
     C           CCY       IFEQ SCCY
     C                     Z-ADDDRIB      SWDRIB
     C                     Z-ADDDRIB      SSDRIB
     C           DRIB      IFEQ *ZEROS
     C                     MOVEL*BLANKS   SDRIB
     C                     ELSE
     C                     MOVE DRIB      SDRIB
     C                     END                             EN03
     C** IF NOT THE SAME CCY - CHECK BASE TYPE IS VALID FOR OTHER CCY     044443
     C                     ELSE                                           044443
     C           DRIB      IFNE *ZEROS                                    044443
     C                     MOVE DRIB      WWRIB                           044443
     C*                                                                   044443
     C** Get Base Rate Codes                                              044443
     C*                                                                   044443
     C                     CALL 'AOBSRTR0'                                044443
     C                     PARM '*MSG   ' @RTCD                           044443
     C                     PARM '*KEY   ' @OPTN                           044443
     C                     PARM WWCCY     @CYCD   3                       044443
     C                     PARM WWRIB     @BSRC   2                       044443
     C********** SDBSRT    PARM SDBSRT    DSFDY                     044443CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*                                                                   044443
     C           @RTCD     IFNE *BLANKS                    IF03           044443
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*                                                                   044443
     C*201-DEBIT BASE RATE DOESN'T EXIST IN FILE TABLE                    044443
     C*                                                                   044443
     C                     MOVEL'RE71201' ZAMSID                          044443
     C                     EXSR ZASNMS                                    044443
     C                     MOVE '1'       *IN60                           044443
     C                     MOVE 'E'       ERR                             044443
     C*                                                                   044443
     C                     ELSE                                           044443
     C                     Z-ADDDRIB      SSDRIB                          044443
     C                     MOVE DRIB      SDRIB                           044443
     C*                                                                   044443
     C                     END                                            044443
     C                     END                                            044443
     C                     END                             EN03
     C**
     C                     Z-ADDDRIS      SSDRIS
     C           DRIS      IFEQ *ZEROS
     C                     MOVE *BLANKS   SDRIS
     C                     ELSE
     C           DRIS      IFLT *ZEROS
     C                     MOVE '-'       SDSIG
     C                     Z-SUBDRIS      DRIS
     C                     ELSE
     C                     MOVE ' '       SDSIG
     C                     END
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DRIS      ZFIELD
     C                     Z-ADD7         ZADEC
     C                     Z-ADD4         ZADIG
     C                     EXSR ZEDIT
     C                     MOVELZFIELD    SDRIS
     C           SDSIG     IFEQ '-'
     C                     Z-SUBDRIS      DRIS
     C                     END
     C                     END
     C*
     C           SWDRIS    IFLT *ZEROS                     -B6
     C                     MOVE '-'       SDSIG
     C                     MOVE '-'       SADSIG
     C                     ELSE                            -X6
     C                     MOVE ' '       SDSIG
     C                     MOVE ' '       SADSIG
     C                     END                             -E6
      *                                                                   107478
      **  Following END relates to default account found (*IN80 off).     107478
      **  Moved to end of setup of default fields.                        107478
     C***********          END                             -E5            107478
     C**
     C           CCY       IFEQ SCCY
     C                     Z-ADDCRIB      SSCRIB
     C           CRIB      IFEQ *ZEROS
     C                     MOVEL*BLANKS   SCRIB
     C                     ELSE
     C                     MOVE CRIB      SCRIB
     C                     END
     C** IF NOT THE SAME CCY - CHECK BASE TYPE IS VALID FOR OTHER CCY     044443
     C                     ELSE                                           044443
     C           CRIB      IFNE *ZEROS                                    044443
     C                     MOVE CRIB      WWRIB                           044443
     C*                                                                   044443
     C** Get Base Rate Codes                                              044443
     C*                                                                   044443
     C                     CALL 'AOBSRTR0'                                044443
     C                     PARM '*MSG   ' @RTCD                           044443
     C                     PARM '*KEY   ' @OPTN                           044443
     C                     PARM WWCCY     @CYCD   3                       044443
     C                     PARM WWRIB     @BSRC   2                       044443
     C********** SDBSRT    PARM SDBSRT    DSFDY                     044443CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*                                                                   044443
     C           @RTCD     IFNE *BLANKS                    IF03           044443
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*                                                                   044443
     C*201-DEBIT BASE RATE DOESN'T EXIST IN FILE TABLE                    044443
     C*                                                                   044443
     C                     MOVEL'RE71201' ZAMSID                          044443
     C                     EXSR ZASNMS                                    044443
     C                     MOVE '1'       *IN60                           044443
     C                     MOVE 'E'       ERR                             044443
     C*                                                                   044443
     C                     ELSE                                           044443
     C                     Z-ADDCRIB      SSCRIB                          044443
     C                     MOVE CRIB      SCRIB                           044443
     C*                                                                   044443
     C                     END                                            044443
     C                     END                                            044443
     C                     END
     C**
     C                     Z-ADDCRIS      SSCRIS
     C           CRIS      IFEQ *ZEROS
     C                     MOVE *BLANKS   SCRIS
     C                     ELSE
     C           CRIS      IFLT *ZEROS
     C                     MOVE '-'       SCSIG
     C                     Z-SUBCRIS      CRIS
     C                     ELSE
     C                     MOVE ' '       SCSIG
     C                     END
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE CRIS      ZFIELD
     C                     Z-ADD7         ZADEC
     C                     Z-ADD4         ZADIG
     C                     EXSR ZEDIT
     C                     MOVELZFIELD    SCRIS
     C           SCSIG     IFEQ '-'
     C                     Z-SUBCRIS      CRIS
     C                     END
     C           SSCRIS    IFLT *ZEROS
     C                     MOVE '-'       SCSIG
     C                     MOVE '-'       SACSIG
     C                     ELSE
     C                     MOVE ' '       SCSIG
     C                     MOVE ' '       SACSIG
     C                     END
     C                     END
     C**
     C                     MOVE *BLANKS   SDRCD
     C                     MOVE *BLANKS   SCRCD
     C**
     C                     MOVELDRIF      SSDRIF
     C                     MOVE DRIF      SDRIF
     C**
     C                     MOVELCRIF      SSCRIF
     C                     MOVELCRIF      SCRIF
     C**
     C           SDRIF     IFEQ 'M'                        - B1
     C           SDRIF     OREQ 'T'
     C           SDRIF     OREQ 'Q'
     C           SDRIF     OREQ 'X'
     C           SDRIF     OREQ 'Y'
     C                     MOVE DRDY      SDNCD
     C                     ELSE
     C                     MOVE *BLANKS   SDNCD
     C                     END
     C**
     C           SCRIF     IFEQ 'M'                        - B1
     C           SCRIF     OREQ 'T'
     C           SCRIF     OREQ 'Q'
     C           SCRIF     OREQ 'X'
     C           SCRIF     OREQ 'Y'
     C                     MOVE CRDY      SCNCD
     C                     ELSE
     C                     MOVE *BLANKS   SCNCD
     C                     END
     C**
     C                     Z-ADDNDID      SSNDID
     C           SSNDID    IFNE *ZEROS
     C                     Z-ADDSSNDID    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SNDID
     C                     ELSE
     C                     MOVEL*BLANKS   SNDID
     C                     END
     C**
     C                     Z-ADDNCID      SWNCID
     C                     Z-ADDNCID      SSNCID
     C           SSNCID    IFNE *ZEROS
     C                     Z-ADDSSNCID    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SNCID
     C                     ELSE
     C                     MOVEL*BLANKS   SNCID
     C                     END
     C**
     C           CCY       IFEQ SCCY
     C           ODLN      IFEQ 0
     C                     MOVEL*BLANKS   SODLN
     C                     MOVE *BLANK    SODSC
     C                     ELSE
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE ODLN      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADD11        ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SODLN
     C                     MOVE 'N'       SODSC
     C                     END
     C                     Z-ADDODED      SSODED
     C           SSODED    IFNE *ZEROS
     C                     Z-ADDSSODED    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SODED
     C                     ELSE
     C                     MOVEL*BLANKS   SODED
     C                     END
     C                     END
     C**
     C                     BITOF'01234567'SWRETB
     C                     BITOF'01234567'SSRETB
     C                     TESTB'0'       RETB           85
     C           *IN85     IFEQ '1'
     C                     MOVE 'Y'       SRAD
     C                     BITON'0'       SSRETB
     C                     ELSE
     C                     MOVE 'N'       SRAD
     C                     END
     C                     TESTB'1'       RETB           85
     C           *IN85     IFEQ '1'
     C                     MOVE 'Y'       SRAC
     C                     BITON'1'       SSRETB
     C                     ELSE
     C                     MOVE 'N'       SRAC
     C                     END
     C                     TESTB'2'       RETB           85
     C           *IN85     IFEQ '1'
     C                     MOVE 'Y'       SBAD
     C                     BITON'2'       SSRETB
     C                     ELSE
     C                     MOVE 'N'       SBAD
     C                     END
     C                     TESTB'3'       RETB           85
     C           *IN85     IFEQ '1'
     C                     MOVE 'Y'       SBAC
     C                     BITON'3'       SSRETB
     C                     ELSE
     C                     MOVE 'N'       SBAC
     C                     END
     C**
     C                     Z-ADDFACT      SSFACT
     C           FACT      IFEQ *ZEROS
     C                     MOVE *BLANKS   SFACT
     C                     ELSE
     C                     MOVE FACT      SFACT
     C                     END
     C**
     C                     Z-ADDFCNO      SSFCNO
     C           FCNO      IFEQ *ZEROS
     C                     MOVE *BLANKS   SFCNO
     C                     ELSE
     C                     MOVE FCNO      SFCNO
     C                     END
     C**
     C                     Z-ADDDRIC      SSDRIC
     C           DRIC      IFEQ *ZEROS
     C           CER047    IFEQ 'Y'                                                         BUG23024
     C                     MOVE '0'       SDRIC                                             BUG23024
     C                     ELSE                                                             BUG23024
     C                     MOVE *BLANKS   SDRIC
     C                     ENDIF                                                            BUG23024
     C                     ELSE
     C                     MOVE DRIC      SDRIC
     C                     END
     C**
     C                     Z-ADDCRIC      SSCRIC
     C           SSCRIC    IFEQ *ZEROS
     C                     MOVE *BLANKS   SCRIC
     C                     ELSE
     C                     MOVE CRIC      SCRIC
     C                     END
      *                                                                                     BUG23348
     C           CER047    IFEQ 'Y'                                                         BUG23348
     C           SCRIC     ANDEQ*BLANKS                                                     BUG23348
     C                     MOVE '0'       SCRIC                                             BUG23348
     C                     ENDIF                                                            BUG23348
      *                                                                                     BUG23348
     C**
     C           *IN29     IFEQ '1'                        - B4
     C           WWACK2    CHAINREIACXX              80
     C           *IN80     IFEQ '0'                        - B5
     C* SET THE DEFAULT VALUE OF REIAC
     C**
     C           CCY       IFEQ SCCY
     C                     Z-ADDDICT      SSDICT
     C                     MOVEL*BLANKS   SDICT
     C           DICT      IFNE *ZEROS
     C                     MOVE DICT      SDICT
     C                     END
     C**
     C                     Z-ADDCICT      SSCICT
     C                     MOVEL*BLANKS   SCICT
     C           CICT      IFNE *ZEROS
     C                     MOVE CICT      SCICT
     C                     END
     C**
     C                     Z-ADDDCST      SSDCST
     C           SSDCST    IFEQ *ZEROS
     C                     MOVEL*BLANKS   SDCST
     C                     MOVEL*BLANKS   SADCST
     C                     ELSE
     C                     MOVE DCST      SDCST
     C                     MOVE DCST      SADCST
     C                     END
     C**
     C                     Z-ADDCCST      SSAMAL
     C           SSAMAL    IFEQ *ZEROS
     C                     MOVEL*BLANKS   SCCST
     C                     MOVEL*BLANKS   SAAMAL
     C                     ELSE
     C                     MOVE CCST      SCCST
     C                     MOVE CCST      SAAMAL
     C                     END
     C**
     C                     Z-ADDCHGT      SSCHGT
     C           CHGT      IFEQ *ZEROS
     C                     MOVE *BLANKS   SCHGT
     C                     ELSE
     C                     MOVE CHGT      SCHGT
     C                     END
     C**
     C                     Z-ADDCHST      SSMRT3
     C           CHST      IFEQ *ZEROS
     C                     MOVE *BLANKS   SCHST
     C                     ELSE
     C******************** MOVE CHGT      SCHST                           044443
     C                     MOVE CHST      SCHST                           044443
     C                     END
     C*                                                                   114907
     C** Default Transaction Charge Override field.                       114907
     C                     Z-ADDTCHO      SSTCHO                          114907
     C           SSTCHO    IFNE *ZEROS                                    114907
     C                     MOVE *BLANKS   ZFIELD                          114907
     C                     MOVE SSTCHO    ZFIELD                          114907
     C                     Z-ADDWWDECS    ZADEC                           114907
     C           7         SUB  WWDECS    ZADIG                           114907
     C                     EXSR ZEDIT                                     114907
     C                     MOVE ZFIELD    STCHO                           114907
     C                     ELSE                                           114907
     C                     MOVE *BLANKS   STCHO                           114907
     C                     END                                            114907
     C*                                                                   114907
     C** IF NOT THE SAME CCY - CHECK INTEREST CALCULATION TYPE/SUBTYPE    044443
     C** & CHARGE TYPE/SUBTYPE VALID FOR OTHER CCY                        044443
     C                     ELSE                            X1             044443
     C           DICT      IFNE *ZEROS                     B2             044443
     C           DCST      ANDNE*ZEROS                                    044443
     C                     MOVE DICT      TYPE                            044443
     C                     MOVE DCST      SBTYPE                          044443
     C                     MOVE SCCY      CURR    3                       044443
     C                     MOVE 'D'       D                               044443
     C           KEY       CHAINREINT                50                   044443
     C           *IN50     IFEQ '0'                        B3             044443
     C                     Z-ADDDICT      SSDICT                          044443
     C                     MOVE DICT      SDICT                           044443
     C                     Z-ADDDCST      SSDCST                          044443
     C                     MOVE DCST      SDCST                           044443
     C                     MOVE DCST      SADCST                          044443
     C                     END                             E3             044443
     C                     END                             E2             044443
     C           CICT      IFNE *ZEROS                     B2             044443
     C           CCST      ANDNE*ZEROS                                    044443
     C                     MOVE CICT      TYPE                            044443
     C                     MOVE CCST      SBTYPE                          044443
     C                     MOVE SCCY      CURR    3                       044443
     C                     MOVE 'D'       D                               044443
     C           KEY       CHAINREINT                50                   044443
     C           *IN50     IFEQ '0'                        B3             044443
     C                     Z-ADDCICT      SSCICT                          044443
     C                     MOVE CICT      SCICT                           044443
     C                     Z-ADDCCST      SSAMAL                          044443
     C                     MOVE CCST      SCCST                           044443
     C                     MOVE CCST      SAAMAL                          044443
     C                     END                             E3             044443
     C                     END                             E2             044443
     C           CHGT      IFNE *ZEROS                     B2             044443
     C           CHST      ANDNE*ZEROS                                    044443
     C                     MOVE CHGT      TYPE                            044443
     C                     MOVE CHST      SBTYPE                          044443
     C                     MOVE SCCY      CURR                            044443
     C                     MOVE 'D'       D                               044443
     C           KEY       CHAINRECRGDF              50                   044443
     C           *IN50     IFEQ '0'                        B3             044443
     C                     Z-ADDCHGT      SSCHGT                          044443
     C                     MOVE CHGT      SCHGT                           044443
     C                     Z-ADDCHST      SSMRT3                          044443
     C                     MOVE CHST      SCHST                           044443
     C                     END                             E3             044443
     C                     END                             E2             044443
     C                     END
     C**
     C                     MOVE PTRA      SSPTRA
     C                     MOVE SSPTRA    SPTRA
     C**
     C                     MOVE PRCH      SSPRCH
     C                     MOVE SSPRCH    SPRCH
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed,              CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C**  move Passbooks Used flag to screen field                        CRT001
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
      *                                                                   107478
      **  Only set up default if ICD Passbooks Used flag is 'Y' and a/c   107478
      **  is savings a/c.                                                 107478
      *                                                                   107478
     C           ICPBKU    ANDEQ'Y'                                       107478
     C           SWATYP    ANDEQ'R'                                       107478
     C           SWSTYP    ANDEQ'S'                                       107478
     C           CRT002    OREQ 'Y'                                       CRT002
     C           ICPBKU    ANDEQ'Y'                                       CRT002
     C           SWATYP    ANDEQ'R'                                       CRT002
     C           SWSTYP    ANDEQ'S'                                       CRT002
     C                     MOVE PBKU      SSPBKU                          CRT001
     C                     MOVE SSPBKU    SPBKU                           CRT001
     C                     END                                            CRT001
     C**
     C                     END                             - E5
     C*                                                                   CRT001
     C/COPY WNCPYSRC,GL3271C073
      **  Following processing deleted; password should not default!      107478
     C****If*Password*on*Retail*Savings*Account*(CRT101)*SAR*is**  CRT001 107478
     C****installed,*move*password*to*screen*field**               CRT001 107478
     C*                                                                   CRT001
     C***********CRT101    IFEQ 'Y'                        - B5    CRT001 107478
     C***********ATYP      ANDEQ'R'                                CRT001 107478
     C***********STYP      ANDEQ'S'                                CRT001 107478
     C*                                                                   CRT001
     C***********WWACK2    CHAINREAPWDL0             80            CRT001 107478
     C************IN80     IFEQ '0'                        - B6    CRT001 107478
     C***********          MOVE PSWD      SSPSWD                   CRT001 107478
     C***********          MOVE SSPSWD    SPSWD                    CRT001 107478
     C***********          END                             - E6    CRT001 107478
     C***********          MOVE '0'       *IN08                    CRT001 107478
     C*                                                                   CRT001
     C***********          ELSE                                    CRT001 107478
     C***********          MOVE '1'       *IN08                    CRT001 107478
     C***********          END                             - E5    CRT001 107478
     C*                                                                   CRT001
     C                     END                             - E4
     C*                                                                   114907
      **  END moved to here (end of processing if default a/c exists).    107478
      *                                                                   107478
     C                     END                                            107478
     C*                                                                   114907
     C                     MOVE WWCNUM    WWCSAV  6                       114907
     C                     MOVE SCNUM     WWCNUM                          114907
     C                     EXSR #RTVCG                                    114907
     C                     MOVE SCGRP     SCGRPA  1                       114907
     C                     MOVE WWCUSK    WWCNUM                          114907
     C                     EXSR #RTVCG                                    114907
     C                     MOVE SCGRP     SCGRPB  1                       114907
     C                     MOVE WWCSAV    WWCNUM                          114907
     C*                                                                   114907
     C           SCGRPA    IFEQ SCGRPB                                    114907
     C***********CCY       ANDEQSCCY                               114907 119826
     C*                                                                   114907
     C           WWACK4    KLIST                                          114907
     C                     KFLD           WWBRCK                          114907
     C                     KFLD           WWCUSK                          114907
     C                     KFLD           WWCCYK                          114907
     C                     KFLD           WWACOK                          114907
     C                     KFLD           WWACSK                          114907
     C*                                                                   114907
     C           WWACK4    CHAINRECOMXX              80                   114907
     C           *IN80     IFEQ '0'                                       114907
     C           CCY       IFEQ SCCY                                      119826
     C*                                                                   114907
     C                     MOVELCEXA      SWCEXA                          114907
     C                     MOVELCEXB      SWCEXB                          114907
     C                     MOVELCEXC      SWCEXC                          114907
     C                     MOVELCEXD      SWCEXD                          114907
     C                     MOVELCEXE      SWCEXE                          114907
     C                     MOVELCEXF      SWCEXF                          114907
     C                     Z-ADDNOCC      SWNOCC                          114907
     C                     MOVELCEXG      SWCEXG                          114907
     C*                                                                   114907
     C                     MOVELCEXA      SSCEXA                          114907
     C                     MOVELCEXB      SSCEXB                          114907
     C                     MOVELCEXC      SSCEXC                          114907
     C                     MOVELCEXD      SSCEXD                          114907
     C                     MOVELCEXE      SSCEXE                          114907
     C                     MOVELCEXF      SSCEXF                          114907
     C                     Z-ADDNOCC      SSNOCC                          114907
     C                     MOVELCEXG      SSCEXG                          114907
     C*                                                                   114907
     C                     ELSE                            - ccy not eq   119826
     C*                                                                   119826
     C                     MOVELCEXA      WCEXA   1                       119826
     C           WCEXA     IFEQ 'E'                                       119826
     C                     MOVELCEXA      SWCEXA                          119826
     C                     MOVELCEXA      SSCEXA                          119826
     C                     END                                            119826
     C*                                                                   119826
     C                     MOVELCEXB      WCEXB   1                       119826
     C           WCEXB     IFEQ 'E'                                       119826
     C                     MOVELCEXB      SWCEXB                          119826
     C                     MOVELCEXB      SSCEXB                          119826
     C                     END                                            119826
     C*                                                                   119826
     C                     MOVELCEXC      WCEXC   1                       119826
     C           WCEXC     IFEQ 'E'                                       119826
     C                     MOVELCEXC      SWCEXC                          119826
     C                     MOVELCEXC      SSCEXC                          119826
     C                     END                                            119826
     C*                                                                   119826
     C                     MOVELCEXD      WCEXD   1                       119826
     C           WCEXD     IFEQ 'E'                                       119826
     C                     MOVELCEXD      SWCEXD                          119826
     C                     MOVELCEXD      SSCEXD                          119826
     C                     END                                            119826
     C*                                                                   119826
     C                     MOVELCEXE      WCEXE   1                       119826
     C           WCEXE     IFEQ 'E'                                       119826
     C                     MOVELCEXE      SWCEXE                          119826
     C                     MOVELCEXE      SSCEXE                          119826
     C                     END                                            119826
     C*                                                                   119826
     C                     MOVELCEXF      WCEXF   1                       119826
     C           WCEXF     IFEQ 'E'                                       119826
     C                     MOVELCEXF      SWCEXF                          119826
     C                     MOVELCEXF      SSCEXF                          119826
     C                     END                                            119826
     C*                                                                   119826
     C                     MOVELCEXG      WCEXG   1                       119826
     C           WCEXG     IFEQ 'E'                                       119826
     C                     MOVELCEXG      SWCEXG                          119826
     C                     MOVELCEXG      SSCEXG                          119826
     C                     END                                            119826
     C*                                                                   119826
     C                     END                             - End ccy eq   119826
     C                     EXSR #P1034                                    114907
     C*                                                                   114907
     C                     END                                            114907
     C*                                                                   114907
     C                     END                                            114907
     C*                                                                   114907
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C**
     C** FOR DELETE MODE ONLY
     C**
     C           *IN33     IFEQ '1'
     C           ERR       ANDEQ*BLANK
     C**
     C** ACCOUNT NUMBER VALIDATION
     C**
     C                     MOVE SCNUM     WWCNUM
     C                     MOVE SCNUM     WWCNBR                          100296
     C                     MOVELSCCY      WWCCY
     C                     MOVE SACOD     WWACOD
     C                     MOVE SACOD     WWACDE                          100296
     C                     MOVE SACSQ     WWACSQ
     C                     MOVE SBRCA     WWBRCA
     C**
     C           WWACKB    CHAINACCNTLXX             80
     C**
     C           *IN80     IFNE '0'
     C                     MOVEL'RE71044' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEA'1111'    *IN,53
     C                     MOVEL'E'       ERR
     C                     ELSE
     C** IF ACCOUNT FOUND IT CANNOT BE FLAGGED FOR CLOSURE
     C           RECI      IFEQ '*'
     C           DACC      ORNE 0
     C                     MOVEL'RE71045' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVEA'1111'    *IN,53
     C                     END
      *                                                                   CFT004
      *** Account cannot be deleted if incoming funds transfer records    CFT004
      *** exist (CFT004 must be on)                                       CFT004
      *                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           DDACTN    IFEQ 'D'                                       CFT004
     C           IBAN      CHAININPAYIB              80                   CFT004
     C           *IN80     IFEQ *OFF                                      CFT004
     C                     MOVEL'RE72027' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE 'E'       ERR              ERROR INDIC.   CFT004
     C                     MOVEA'1111'    *IN,53                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP84                                           S01408
     C*                                                                   S01408
     C**
     C** IF RETAIL ACCOUNT ENTERED MUST BELONG TO SAME ACCOUNT
     C**
     C           SACNO     IFNE *BLANKS
     C                     MOVE SACNO     WWRKEY
     C           WWRKEY    IFNE ACNO
     C                     MOVEL'RE71046' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN58
     C                     END
     C                     END                             SACNO
     C**
     C** ACCOUNT NAME ENTERED MUST BE THE SAME AS ON ACCOUNT
     C**
     C**   Translate Account names to Upper Case                          098400
     C           LO:UP     XLATEANAM      @ANAM                           098400
     C           LO:UP     XLATESANAM     @SNAM                           098400
     C*                                                                   098400
     C***********SANAM     IFNE ANAM                                      098400
     C           @SNAM     IFNE @ANAM                                     098400
     C                     MOVEL'RE71052' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN59
     C                     END                             SANAM
     C**
     C** ACCOUNT CAN NOT BE CLOSE AT SAME DATE THEN OPENEING LDAC 'Y'
     C**
     C           BMLDAI    IFEQ 'Y'
     C           DACO      ANDEQBJRDNB
     C                     MOVEL'RE71058' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN59
     C                     END                             SDACO
     C**
     C** ACCOUNT CANNOT BE AN ALTERNATIVE ACCOUNT
     C           WWACKY    CHAINREIACDXF             80
     C**
     C           NOALT     IFGT 0
     C                     MOVEL'RE71053' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVEA'1111'    *IN,53
     C                     MOVE '1'       *IN58
     C                     END
     C**
     C** ACCOUNT CANNOT BE A PRIME ACCOUNT
     C**
     C                     MOVE SBRCA     WWSPTA
     C***********RELINK    CHAINRELINKL1             80                   154206
      *                                                                   154206
      **  Chain to primary linked account                                 154206
      *                                                                   154206
     C           RELINK    CHAINRELINKJ2             80                   154206
     C           *IN80     IFEQ '0'
     C           *IN80     DOWEQ'0'                                       154206
      *                                                                   154206
      ** Move details for secondary account into key to allow CHAIN       154206
      ** on ACCNTAB to see if secondary account has been closed.          154206
      *                                                                   154206
     C                     MOVELJBRCA     W@BRCA  3                       154206
     C                     MOVELJCUST     W@CNUM  6                       154206
     C                     MOVELJTCCY     W@CCY   3                       154206
     C**********           MOVELJACOD     W@ACOD  4                                    154206 CGL029
     C                     MOVELJACOD     W@ACOD 10                                           CGL029
     C                     MOVELJACSQ     W@ACSQ  2                       154206
      *                                                                   154206
      ** Check status of secondary account using AOACSTV0.                154206
      *                                                                   154206
     C                     CALL 'AOACSTV0'                                154206
     C                     PARM '*DBERR  '@RTCD   7                       154206
     C                     PARM '*KEY    '@OPTN   7                       154206
     C                     PARM           @RETL  10                       154206
     C                     PARM           W@CNUM                          154206
     C                     PARM           W@CCY                           154206
     C                     PARM           W@ACOD                          154206
     C                     PARM           W@ACSQ                          154206
     C                     PARM           W@BRCA                          154206
     C                     PARM *BLANKS   @ACST   1                       154206
      *                                                                   154206
      **  If account is found, and isn't closed then ...                  154206
      *                                                                   154206
     C           @ACST     IFEQ 'O'                                       154206
     C           @ACST     OREQ 'F'                                       154206
      *                                                                   154206
      ** ... print out error message to tell user can't delete account.   154206
      *                                                                   154206
     C                     MOVEL'RE71054' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVEA'1111'    *IN,53
     C                     MOVE '1'       *IN58
     C                     MOVE '1'       *IN80                           154206
      *                                                                   154206
      **  ELSE see if these is another account linked to the              154206
      **  primary. If there is, see if this account is closed or          154206
      **  not (go around the loop again).                                 154206
      *                                                                   154206
     C                     ELSE                                           154206
     C           RELINK    READERELINKJ2                 80               154206
     C                     ENDIF                                          154206
      *                                                                   154206
     C                     ENDDO                                          154206
      *                                                                   154206
     C                     END
     C*******                                                             47641
     C***ACCOUNT CODE CANNOT HAVE OUTSTANDING STOPPED CHEQUE              47641
     C*******                                                             47641
     C********** WWACKY    READESTOPC                    80               47641
     C********** *IN80     IFEQ '0'                                       47641
     C******************** MOVEL'RE71055' ZAMSID                          47641
     C******************** EXSR ZASNMS                                    47641
     C******************** MOVEL'E'       ERR                             47641
     C******************** MOVEA'1111'    *IN,53                          47641
     C******************** MOVE '1'       *IN58                           47641
     C******************** END                                            47641
     C***********                                                         47641
     C***ACCOUNT CODE CANNOT HAVE OUTSTANDING HELD ITEM                   47641
     C***********                                                         47641
     C********** WWACKY    READEHELDI                    80               47641
     C********** *IN80     IFEQ '0'                                       47641
     C******************** MOVEL'RE71056' ZAMSID                          47641
     C******************** EXSR ZASNMS                                    47641
     C******************** MOVEL'E'       ERR                             47641
     C******************** MOVEA'1111'    *IN,53                          47641
     C******************** MOVE '1'       *IN58                           47641
     C******************** END                                            47641
     C*                                                                   47641
     C*   CHECK FOR STOPPED CHEQUES - ERROR IF OUTSTANDING                47641
     C*   *IN90 SETON IF RECORD FOUND FOR THIS KEY                        47641
     C*                                                                   47641
     C                     SETOF                     90                   47641
     C           WWACKB    SETLLSTOPC                    90               47641
     C  N90                GOTO HELDCK                                    47641
     C   90                SETOF                     90                   47641
     C           *IN90     DOWNE'1'                                       47641
     C           WWACKB    READESTOPC                    90               47641
     C           *IN90     IFEQ '0'                                       47641
     C           RECI      ANDNE'*'                                       47641
     C                     MOVEL'RE71055' ZAMSID                          47641
     C                     EXSR ZASNMS                                    47641
     C                     MOVEL'E'       ERR                             47641
     C                     MOVEA'1111'    *IN,53                          47641
     C                     MOVE '1'       *IN58                           47641
     C                     END                                            47641
     C                     END                                            47641
     C*                                                                   47641
     C*   CHECK FOR HELD ITEMS - ERROR IF OUTSTANDING                     47641
     C*   *IN90 SETON IF RECORD FOUND FOR THIS KEY                        47641
     C*                                                                   47641
     C           HELDCK    TAG                                            47641
     C                     SETOF                     90                   47641
     C           WWACKC    SETLLHELDIL1                  90               47641
     C  N90                GOTO ADVALD                                    47641
     C   90                SETOF                     90                   47641
     C           *IN90     DOWNE'1'                                       47641
     C           WWACKC    READEHELDIL1                  90               47641
     C           *IN90     IFEQ '0'                                       47641
     C           RECI      ANDNE'*'                                       47641
     C                     MOVEL'RE71056' ZAMSID                          47641
     C                     EXSR ZASNMS                                    47641
     C                     MOVEL'E'       ERR                             47641
     C                     MOVEA'1111'    *IN,53                          47641
     C                     MOVE '1'       *IN58                           47641
     C                     END                                            47641
     C                     END                                            47641
     C           ADVALD    TAG                                            47641
     C***                                                                 47641
     C**                                                                  S01421
     C** ACCOUNT CANNOT HAVE ANY ENTRIES ON THE STANDING ORDERS FILE      S01421
     C**                                                                  S01421
     C           STAND     CHAINSTAND2               80                   S01421
     C           *IN80     IFEQ '0'                                       S01421
     C                     MOVEL'RE71059' ZAMSID                          S01421
     C                     EXSR ZASNMS                                    S01421
     C                     MOVEL'E'       ERR                             S01421
     C                     MOVEA'1111'    *IN,53                          S01421
     C                     MOVE '1'       *IN58                           S01421
     C                     END                                            S01421
      *                                                                   S01421
     C           STAND     CHAINSTAND3               80                   S01421
     C           *IN80     IFEQ '0'                                       S01421
     C                     MOVEL'RE71059' ZAMSID                          S01421
     C                     EXSR ZASNMS                                    S01421
     C                     MOVEL'E'       ERR                             S01421
     C                     MOVEA'1111'    *IN,53                          S01421
     C                     MOVE '1'       *IN58                           S01421
     C                     END                                            S01421
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP6                                           S01408
     C*                                                                   S01408
     C** Account should not have an attached nostro                       100296
     C*                                                                   100296
     C           NOSKEY    CHAIN@NOSTBH              80                   100296
     C           *IN80     IFEQ '0'                                       100296
     C                     MOVEL'RE71070' ZAMSID                          100296
     C                     MOVELA7CYCD    NOSD    5                       100296
     C                     MOVE A7NONB    NOSD                            100296
     C                     MOVELNOSD      ZAMSDA                          100296
     C                     EXSR ZASNMS                                    100296
     C                     MOVEL'E'       ERR                             100296
     C                     MOVEA'1111'    *IN,53                          100296
     C                     MOVE '1'       *IN58                           100296
     C                     END                                            100296
     C**
     C** IF NO ERROR SET CONFIRMATION INDICATOR ON
     C**
     C           ERR       IFEQ *BLANK
     C                     MOVE '1'       *IN42
     C                     END
      *                                                                   S01522
      ** If User Defined Correspondence installed and the account is a    S01522
      ** non=title account and the action code is delete call CGC0025.    S01522
      *                                                                   S01522
     C           BGN1ST    IFEQ 'Y'                                       S01522
     C           A5TOIN    ANDNE'Y'                                       S01522
     C*                                                                   S01522
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C116                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD    7                       S01522
     C                     PARM 'D'       ACTN    1                       S01522
     C**********           PARM ACKEY     ACCD   18                                    S01522 CGL029
     C                     PARM ACKEY     ACCD   24                                           CGL029
      *                                                                   S01522
      ** If cannot delete                                                 S01522
      *                                                                   S01522
     C           RTCD      IFEQ 'CGD1184'                                 S01522
     C                     MOVEL'RE70000' ZAMSID                          S01522
     C                     EXSR ZASNMS                                    S01522
     C                     SETOF                     42                   S01522
     C                     END                                            S01522
     C                     END                                            S01522
     C**
     C                     END                             *DELETE
     C           ERR       IFEQ *BLANK
     C                     MOVE '0'       *IN77
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10F1   - PROCESS ACCOUNT MASTER DETAILS                        *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #DEFT    - TO PROCESS DEFAULT VALUES IN INSERT MODE              *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #P1031   - TRANSFER WORK FIELDS IN SCREEN FIELDS(1ST FORMAT)     *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      * #V10F1   - PROCESS VALIDATION OF 'F1' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      * WWACTN   - ACTION CODE                                           *
      *                                                                  *
      ********************************************************************
     C           #P10F1    BEGSR                           * #P10F1 BGSR *
     C*
     C**  Set start screen indicator
     C                     MOVE ' '       ERR     1
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     MOVE *OFF      *IN52                           CEU013
     C                     ENDIF                                          CEU013
     C           *IN31     IFEQ '1'
     C                     MOVE '1'       *IN77
     C                     END
     C/COPY WNCPYSRC,GL3271C024
     C*
     C** If Midas/TI Interface is on then                                 CTI001
     C** reset *IN37, *IN76, *IN88 and *IN89                              CTI001
     C*                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C                     MOVE *OFF      *IN37                           CTI001
     C                     MOVE *OFF      *IN76                           CTI001
     C                     MOVE *OFF      *IN88                           CTI001
     C***********          MOVE *OFF      *IN89                     CTI001160463
     C                     ENDIF                                          CTI001
      *                                                                   CFT004
      *** Error indicator for IBAN field                                  CFT004
      *                                                                   CFT004
     C                     MOVE *OFF      *IN02                           CFT004
     C*                                                                   CTI001
     C**  CLEAR WHOLE SCREEN
     C                     WRITEGL3271FC
     C**
     C** IF ENQUIRY MODE AND DACC NOT EQUAL 0 THEN
     C** SETON INDICATOR TO DISPLAY IT
     C           *IN32     IFEQ '1'
     C           SWDACC    ANDNE0
     C                     MOVE '1'       *IN75
     C                     ELSE
     C                     MOVE '0'       *IN75
     C                     END
     C**
     C           WFMT      DOUNE'F1'                       -B1
     C*                                                                   CPM004
     C** Restrict output of Portfolio Reference....                       CPM004
     C*                                                                   CPM004
     C           BGPFMG    IFEQ 'Y'                                       CPM004
     C*                                                                   CPM004
     C                     MOVELSCNUM     I#CUST                          CPM004
     C                     MOVELSBRCA     I#BRCA                          CPM004
     C                     MOVEL*BLANKS   I#PTFR                          CPM004
     C                     MOVEL*BLANKS   I#CPGM                          CPM004
     C*                                                                   CPM004
     C                     CALL 'AOPLCSR1'                                CPM004
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  CPM004
     C                     PARM '*KEY   ' P@OPTN  7        I:Option       CPM004
     C                     PARM           I@PARM           I:Parameters   CPM004
     C                     PARM *BLANKS   O@PARM           O:Parameters   CPM004
     C           SDPLCS    PARM SDPLCS    DSFDY            O:Format       CPM004
      *                                                                   CPM004
     C           P@RTCD    IFEQ 'PMA0008'                                 CPM004
     C           P@RTCD    OREQ 'PMA0009'                                 CPM004
      *                                                                   CPM004
     C           *IN30     ORNE *ON                                       CPM004
     C           I#PORS    ANDNE'B'                                       CPM004
     C           ATYP      ANDNE'R'                                       CPM004
      *                                                                   CPM004
     C           *IN30     ORNE *ON                                       CPM004
     C           I#PORS    ANDEQ'B'                                       CPM004
     C           ATYP      ANDNE'R'                                       CPM004
     C           ATYP      ANDNE'N'                                       CPM004
      *                                                                   CPM004
     C           *IN30     OREQ *ON                                       CPM004
     C           I#PORS    ANDNE'B'                                       CPM004
     C           A5ACTY    ANDNE'R'                                       CPM004
      *                                                                   CPM004
     C           *IN30     OREQ *ON                                       CPM004
     C           I#PORS    ANDEQ'B'                                       CPM004
     C           A5ACTY    ANDNE'R'                                       CPM004
     C           A5ACTY    ANDNE'N'                                       CPM004
      *                                                                   CPM004
     C                     MOVE *ON       *IN38                           CPM004
     C                     ELSE                                           CPM004
     C                     MOVE *OFF      *IN38                           CPM004
     C                     END                                            CPM004
      *                                                                   CPM004
     C                     END                                            CPM004
      *                                                                   CPB001
      ** Restrict output of Portfolio Reference....                       CPB001
      *                                                                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C                     MOVELSCNUM     @CNUM     P                     CPB001
     C                     CALL 'AOCUSTR1'                                CPB001
     C                     PARM '*MSG   ' @RTCD                           CPB001
     C                     PARM '*KEY   ' @OPTN                           CPB001
     C                     PARM           @CNUM  10                       CPB001
     C                     PARM           @CNST   7                       CPB001
     C           SDCUST    PARM SDCUST    DSLDY                           CPB001
      *                                                                   CPB001
     C/COPY WNCPYSRC,GL3271C219
     C           @RTCD     IFEQ *BLANK                                    CPB001
     C           BBPRBA    ANDEQ'Y'                                       CPB001
     C                     MOVE *OFF      *IN38                           CPB001
     C                     ELSE                                           CPB001
     C           BGPFMG    IFNE 'Y'                                       CPB001
     C                     MOVE *ON       *IN38                           CPB001
     C                     ENDIF                                          CPB001
     C                     ENDIF                                          CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C/COPY WNCPYSRC,GL3271C060
     C*                                                                   CPM004
     C**
     C** IF INSERT MODE LOAD DEFAULT VALUES
     C**
     C                     WRITEGL3271C1
     C                     EXFMTGL3271F1
     C                     MOVEL*BLANK    ERR
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVE *OFF      *IN45                           CPM004
     C/COPY WNCPYSRC,GL3271C159
     C*                                                                   CTI001
     C** If Midas/TI Interface is on then restore *IN37 and *IN89         CTI001
     C** and reset *IN76 and *IN88                                        CTI001
     C*                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C                     MOVE W#IN37    *IN37                           CTI001
     C***********          MOVE W#IN89    *IN89                     CTI001160463
     C                     MOVE *OFF      *IN76                           CTI001
     C                     MOVE *OFF      *IN88                           CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CFT004
      *** Error indicator for IBAN field                                  CFT004
      *                                                                   CFT004
     C                     MOVE *OFF      *IN02                           CFT004
     C*                                                                   CTI001
     C** If EMU Account posting narrative present restore *IN52           CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C                     MOVE W#IN52    *IN52                           CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CTI001
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C*                                                                   074576
     C** Screen lock on scroll forward in enquiry mode as no previous     074576
     C** screen available to pass back to after last screen               074576
     C*                                                                   074576
     C           ATYP      IFNE 'R'                                       074576
     C                     SETOF                     25                   074576
     C                     END                                            074576
     C                     END
     C*
     C**  F3 PRESSED - EXIT OF PROGRAM
     C           *INKC     IFEQ '1'                        -B2
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C235
     C                     END                             -E2
     C*
     C**  F12 PRESSED - PREVIOUS SCREEN
     C           *INKL     IFEQ '1'                        -B2
     C                     MOVELWWRTRN    WFMT
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP44                                           S01408
      *                                                                   S01408
     C                     END                             -E2
     C*
     C**  F5 PRESSED - REFRESH
     C           *INKE     IFEQ '1'                        -B2
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C**
     C           *IN31     IFEQ '1'                        -B3
     C           *IN30     OREQ '1'
     C                     EXSR #P1031
     C                     MOVEL'F1'      WFMT
     C                     END                             -E3
     C/COPY WNCPYSRC,GL3271C025
     C                     END                             -E2
     C**  F9 PRESSED - REFRESH  ALL
     C           *INKI     IFEQ '1'                        -B2
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C**
     C           *IN30     IFEQ '1'                        -B3
     C                     MOVEL'FK'      WFMT
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       *IN69
     C                     END                             -E3
     C**
     C           *IN31     IFEQ '1'                        -B3
     C                     EXSR #P1030
     C           WWACTN    IFEQ 'A'                        -B4
     C           WWACTN    OREQ 'E'
     C                     MOVEL'F1'      WFMT
     C                     ELSE
     C                     MOVEL'F1'      WFMT
     C                     MOVE WWACTN    WFMT
     C                     END                             -E4
     C                     END                             -E3
     C                     END                             -E2
     C/COPY WNCPYSRC,GL3271C151
     C*
     C**  F8 PRESSED - FROM ENQUIRY TO AMEND MODE
     C           *INKH     IFEQ '1'                        -B2
     C* IF MULTIBRANCHING DO VALIDATION ON BRANCH INPUT                   097616
     C           BJSBRC    IFEQ *BLANKS                                   097616
     C                     MOVEL'A'       @ZACTN                          097616
     C                     MOVELSBRCA     @BRCA                           097616
     C                     EXSR #AUTH                                     097616
     C           @ERR      IFNE 0                                         097616
     C                     MOVEL'RE7103B' ZAMSID                          097616
     C                     EXSR ZASNMS                                    097616
     C                     MOVEL'E'       ERR                             097616
     C                     END                                            097616
     C                     END                                            097616
     C*
     C**  USER MUST BE AUTHORISED AND ACTION MODE IS ENQUIRY
     C           *IN41     IFEQ '1'                        -B3
     C           *IN32     ANDEQ'1'
     C           ERR       ANDEQ*BLANKS                                   097616
     C           *IN39     IFEQ '0'                        -B4
     C*
     C**  UNPROTECT FIELDS AND REDISPLAY
     C                     MOVEA'0100'    *IN,30
     C                     MOVE 'A'       DDACTN
      *                                                                   160474
      * If Midas/TI interface switched on make TI fields available too.   160474
      *                                                                   160474
     C           *IN87     IFEQ '1'                                       160474
     C                     MOVEL'1'       *IN89                           160474
     C                     ENDIF                                          160474
      *                                                                   160474
     C                     ELSE                            -X4
     C*
     C** ERROR MESSAGE
     C                     MOVEL'RE71003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E4
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ROLLUP OR ENTER PRESSED - VALIDATION AND NEXT SCREEN
     C           *IN25     IFEQ '1'                        -B2
     C           *IN49     OREQ '0'
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F1
     C/COPY WNCPYSRC,GL3271C168
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
     C                     MOVE '0'       *IN77
     C*  CHECK IF ACCOUNT RETAIL
      * WINDOW PROCESSING
     C/COPY WNCPYSRC,GL3271C052
      *
     C           BGWDPR    IFEQ 'Y'                        -B4
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP41                                           S01408
      *                                                                   S01408
     C           BGSWRT    ANDEQ'Y'
     C           SWATYP    ANDEQ'R'
     C*
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP40                                           S01408
      *                                                                   S01408
     C                     EXSR #WNDW
     C*
     C                     ELSE                            -X4
     C*
     C                     MOVEL' '       WWRTCD
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP67                                           S01408
     C*                                                                   S01408
     C*
     C                     END                             -E4
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP33                                           S01408
     C*                                                                   S01408
      *-------------------------------------------------------------------
     C*
     C** TEST IF A KEY HAS BEEN PRESSED
     C**
     C           WWRTCD    IFEQ *BLANK                     -B4
     C*
     C** ACCOUNT IS RETAIL SEND FOLLOWING FORMAT
     C           *IN29     IFEQ '1'                        -B5
     C* GENERAL ACTION REQUESTED SEND NEXT FORMAT
     C           WWACTN    IFEQ 'A'                        -B6
     C           WWACTN    OREQ 'E'
     C           *IN30     OREQ '1'
     C                     MOVEL'F2'      WFMT
     C                     END                             -E6
     C* DETAIL  ACTION REQUESTED SEND CORRECT FORMAT
     C           WWACTN    IFEQ '1'                        -B6
     C           WWACTN    OREQ '2'
     C           WWACTN    OREQ '3'
     C           WWACTN    OREQ '4'
     C           WWACTN    OREQ '5'
     C* ELSE IF AMEND MODE PROCESS SCREEN AND IF NO ERROR PROCESS UPDATE
     C* IF ERROR SEND FOURTH SCREEN
     C           *IN31     IFEQ '1'                        -B7
     C           SSTFQ     IFEQ 'E'                        -B8
     C/COPY WNCPYSRC,GLH00815
     C           SNOCC     IFGT SENOC                      -B9
     C                     MOVEL'F4'      WFMT
     C                     ELSE                            -X9
     C* ROLL IS PRESSED THEN SEND NEXT SCREEN.
     C           *IN25     IFEQ '1'                        -B10
     C                     MOVEL'F2'      WFMT
     C                     ELSE                            -X10
     C                     MOVEL'UP'      WFMT
     C                     END                             -E10
     C                     END                             -E9
     C                     ELSE                            -X8
     C           SNOCC     IFNE *BLANK                     -B9
     C           SCEXF     ORNE *BLANK
     C                     MOVEL'F4'      WFMT
     C                     ELSE                            -X9
     C* ROLL IS PRESSED THEN SEND NEXT SCREEN.
     C           *IN25     IFEQ '1'                        -B10
     C                     MOVEL'F2'      WFMT
     C                     ELSE                            -X10
     C                     MOVEL'UP'      WFMT
     C                     END                             -E10
     C                     END                             -E9
     C                     END                             -E8
     C                     END                             -E7
     C*ENQUIRY
     C           *IN32     IFEQ '1'                        -B7
     C* ROLL IS PRESSED THEN SEND NEXT SCREEN.
     C           *IN25     IFEQ '1'                        -B8
     C                     MOVEL'F2'      WFMT
     C                     ELSE                            -X8
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C117                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD    7                       S01522
     C                     PARM 'E'       ACTN    1                       S01522
     C**********           PARM ACKEY     ACCD   18                                    S01522 CGL029
     C                     PARM ACKEY     ACCD                                                CGL029
     C                     END                                            S01522
      *                                                                   CGL004
      ** If Midas-Fontis Interface is switched on, call program to        CGL004
      ** display Fontis account details.                                  CGL004
      *                                                                   CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     CALL 'GLC2800'                                 CGL004
     C                     PARM *BLANK    RTCD                            CGL004
     C                     PARM ACKEY     ACCD                            CGL004
     C                     PARM 'E'       ACTN                            CGL004
     C                     ENDIF                                          CGL004
      *                                                                   CGL004
     C                     MOVELWWRTRN    WFMT
     C                     END                             -E8
     C                     END                             -E7
     C                     END                             -E6
     C*
     C                     ELSE                            -X5
     C** ACCOUNT IS NOT RETAIL - INSERT MODE, PROCESS WRITE
     C           *IN30     IFEQ '1'                        -B6
     C                     MOVEL'IN'      WFMT
     C                     END                             -E6
     C** ACCOUNT IS NOT RETAIL - AMEND  MODE, PROCESS UPDATE
     C           *IN31     IFEQ '1'                        -B6
     C                     MOVEL'UP'      WFMT
     C                     END                             -E6
     C** ACCOUNT IS NOT RETAIL - ENQUIRY MODE, RETURN TO PREVIOUS SCREEN
     C           *IN32     IFEQ '1'                        -B6
     C/COPY WNCPYSRC,GL3271C169
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C118                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD    7                       S01522
     C                     PARM 'E'       ACTN    1                       S01522
     C**********           PARM ACKEY     ACCD   18                                    S01522 CGL029
     C                     PARM ACKEY     ACCD                                                CGL029
     C                     END                                            S01522
     C/COPY WNCPYSRC,GL3271C206
     C                     MOVELWWRTRN    WFMT
     C*
     C                     END                             -E6
     C*
     C                     END                             -E5
     C*
     C                     END                             -E4
     C*
     C                     END                             -E3
     C*
     C                     END                             -E2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP27                                           S01408
     C*                                                                   S01408
     C*
     C                     END                             -E1
     C*
     C                     ENDSR                           * #P10F1 EDSR *
     C***********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #DEFT    - TO PROCESS DEFAULT VALUES IN INSERT MODE              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F1   - PROCESS ACCOUNT MASTER DETAILS                        *
      * #P10F5   - PROCESS OTHER DETAILS                                 *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #DEFT     BEGSR                           * #DEFT BEGSR *
     C*
     C*  INITIALISE SCREEN FIELDS TO DEFAULT VALUES:
     C***********          MOVE 'N'       SPTAD                           079895
     C                     MOVE 'Y'       SPTAD                           079895
     C                     MOVE 'N'       SRAD
     C                     MOVE 'N'       SRAC
     C                     MOVE 'N'       SBAD
     C                     MOVE 'N'       SBAC
      * Dft the Statement Freq to the value held on the GL ICD (SdGelr)   084065
     C                     MOVE BKDSFC    SSTFQ                           084065
      *
      * IN INPUT MODE, DEFAULT ACCOUNT NAME TO CLIENT NAME
     C                     MOVE BBCRNM    SANAM
     C*                                                                   CTI001
      * If Midas/Trade Innovation Interface is switched on then           CTI001
      * TI Account defaults to 'N' and other TI fields to blanks          CTI001
     C*                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C                     MOVE 'N'       STIAC                           CTI001
     C                     MOVE *BLANKS   STIAN                           CTI001
     C                     MOVE *BLANKS   STIAS                           CTI001
     C                     MOVE '1'       *IN89                           160463
     C                     ENDIF                                          CTI001
      *                                                                   CPB001
     C           A5ACTY    IFEQ 'R'                                       CPB001
     C           *IN38     ANDEQ*OFF                                      CPB001
     C           *IN28     ANDEQ*ON                                       CPB001
     C           SPTFR     IFEQ *BLANKS                                   CPB001
     C**********           MOVELSCNUM     KPCNUM  60                                   CPB001 CSD027
     C                     MOVELSCNUM     KPCNUM  6                                           CSD027
     C                     MOVE 'N'       WWVAL   1                       CPB001
     C           KPCNUM    SETLLPMPORTLL                                  CPB001
     C           KPCNUM    READEPMPORTLL                 89               CPB001
      *                                                                   CPB001
     C           *IN89     DOWEQ*OFF                                      CPB001
     C           WWVAL     ANDEQ'N'                                       CPB001
     C           PNDPCL    IFEQ 0                                         CPB001
     C                     MOVE PNPTFR    SPTFR                           CPB001
     C                     MOVE 'Y'       WWVAL                           CPB001
     C                     ELSE                                           CPB001
     C           KPCNUM    READEPMPORTLL                 89               CPB001
     C                     ENDIF                                          CPB001
     C                     ENDDO                                          CPB001
     C                     ENDIF                                          CPB001
     C                     ENDIF                                          CPB001
     C/COPY WNCPYSRC,GL3271C001
     C*
     C                     ENDSR                           * #DEFT ENDSR *
     C***********************************************************************
      *                                                                  *CRE007
      * #DEFT2   - TO PROCESS DEFAULT VALUES IN INSERT MODE FOR          *CRE007
      *            ACCOUNT OTHER DETAILS SCREEN.                         *CRE007
      *                                                                  *CRE007
      * SUBROUTINE CALLS:                                                *CRE007
      *                                                                  *CRE007
      * SUBROUTINE CALLED FROM:                                          *CRE007
      * #P10F5   - PROCESS OTHER DETAILS                                 *CRE007
      *                                                                  *CRE007
      * ROUTINE USES VARIABLES:                                          *CRE007
      *                                                                  *CRE007
      ********************************************************************CRE007
     C           #DEFT2    BEGSR                           *#DEFT2 BEGSR *CRE007
      *                                                                   CRE007
      * If Insert mode and Account Holder Type is 'R', defualt            CRE007
      * BRT CATEGORY field to 'R'.                                        CRE007
      *                                                                   CRE007
     C           *IN30     IFEQ '1'                                       CRE007
     C           ACHLRT    ANDEQ'R'                                       CRE007
     C                     MOVE 'R'       SBRTCA                          CRE007
     C                     ENDIF                                          CRE007
      *                                                                   CRE007
     C                     ENDSR                                          CRE007
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10F1   - PROCESS VALIDATION OF 'F1' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE                *
      * ZDATE1   - TO FORMAT AN ALPHA DATE IN MIDAS NUMBER               *
      * ZALIGN   - TO VALIDATE A NUMERIC FIELD                           *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F1   - PROCESS ACCOUNT MASTER DETAILS                        *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDACO   - DATE ACCOUNT OPENED                                   *
      * WWNSTD   - NEXT STATEMENT DATE                                   *
      *                                                                  *
      ********************************************************************
     C           #V10F1    BEGSR
     C*
     C                     MOVE '0'       *IN36
     C*
     C** If Linked Enquiry Validate A/C number and Retail number
     C*
     C           MODID     IFEQ 'GL'
     C*
     C           SBRCA     IFEQ *BLANKS                    -B3
     C** SET BRANCH CODE EQUAL TO DEFAULT
     C                     MOVELDBRN      SBRCA
     C                     END                             -E3
     C** BRANCH CODE IF ENTERED MUST EXIST ON SDBRCHPD FILE
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SBRCA     @BRCA   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C/COPY WNCPYSRC,GL3271C191
     C           @RTCD     IFNE *BLANK
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71040' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN57
     C                     ELSE
     C                     MOVEL@BRCA     SBRCA
     C                     END                             -E4
     C**
     C** CUSTOMER NUST BE LIVE ON SDCUSTPD
     C**
     C*****                CALL 'AOCUSTR0'                                178695
     C                     CALL 'AOCUSTR1'                                178695
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SCNUM     @CNUM  10
     C                     PARM           @CNST   7
     C*****      SDCUST    PARM SDCUST    DSSDY                           178695
     C           SDCUST    PARM SDCUST    DSLDY                           178695
     C           @RTCD     IFNE *BLANK
     C/COPY WNCPYSRC,GL3271C220
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71031' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN53
     C                     ELSE                            -X3
      *                                                                   072879
     C                     MOVE BBCUST    SCNUM                           072879
     C***CUSTOMER*CANNOT*BE*A*PARENT***********************************                       226364
     C********** BBPAIN    IFEQ 'P'                        -B4                                226364
     C**********           MOVEL'RE71032' ZAMSID                                              226364
     C**********           EXSR ZASNMS                                                        226364
     C**********           MOVEL'E'       ERR                                                 226364
     C**********           MOVE '1'       *IN53                                               226364
     C**********           END                             -E4                                226364
     C                     END                             -E3
     C**
     C** CURRENCY MUST BE LIVE ON SDCURRPD
     C**
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SCCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFNE *BLANK
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN54
      *                                                                   072879
     C                     ELSE                                           072879
     C                     MOVE A6CYCD    SCCY                            072879
     C/COPY WNCPYSRC,GL3271C136
     C                     END                             -E3
     C**
     C** ACCOUNT CODE MUST BE LIVE
     C                     CALL 'AOACODR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C**********           PARM SACOD     @ACOD   4                                           CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
     C                     PARM SACOD     @ACOD                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN55
     C                     ELSE                            -X3
     C**
     C** LOAD ACCOUNT TYPE FOR FURTHER PROCESS
     C**
     C                     MOVE A5ACCD    SACOD                           072879
     C                     MOVE A5ACTY    SSATYP
     C                     MOVE A5ACST    SSSTYP
     C                     MOVE A5ACTY    SWATYP
     C                     MOVE A5ACST    SWSTYP
     C           A5ACTY    IFEQ 'R'                        -B4
     C** ACCOUNT TYPE IS RETAIL
     C                     MOVE '1'       *IN29
     C                     ELSE                            -X4
     C                     MOVE '0'       *IN29
     C                     END                             -E4
     C**
     C** ACCOUNT CODE CAN NOT BE A TITLE
     C           A5TOIN    IFEQ 'Y'                        -B4
     C                     MOVEL'RE71038' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN55
     C                     END                             -E4
     C                     END                             -E3
     C**++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** ACCOUNT SEQUENCE  - VFKACSQ
     C**++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** ACCOUNT SEQUENCE NOT ENTERED
     C           SACSQ     IFEQ *BLANKS                    -B3
     C***********MBIN      ANDEQ'Y'                                       123585
     C** SET DEFAULT TO '01'
     C                     MOVEL'01'      SACSQ
     C                     END                             -E3
     C** ACCOUNT SEQUENCE NOT ENTERED AND MULTIB. ON DEFAULT
     C** TO START ACCOUNT SEQUENCE
     C* Excpt if customer is internal customer number then default
     C* to '01'
     C           SACSQ     IFEQ *BLANKS                    -B3
     C***********MBIN      ANDEQ'Y'                                       123585
     C           SCNUM     IFEQ A8BICN
     C                     MOVEL'01'      SACSQ
     C                     END                             -E3
     C                     END                             -E3
     C**
     C** ACCOUNT SEQUENCE ENTERED
     C**                                                                  155510
     C           SACSQ     IFEQ *BLANKS                                   155510
     C                     MOVE '01'      SACSQ                           155510
     C                     END                                            155510
     C**
     C           SACSQ     IFNE *BLANKS                    -B3
     C** MULTIBRANCH OFF
     C***********MBIN      IFNE 'Y'                        -B4            074588
     C** MUST BE NUMERIC BETWEEN 01 AND 99
     C                     MOVEASACSQ     SEQ
     C           SEQ,1     LOKUPNUM                      80
     C           SEQ,2     LOKUPNUM                      81
     C** NOT NUMERIC
     C           *IN80     IFEQ '0'                        -B5
     C           *IN81     OREQ '0'
     C                     MOVEL'RE71041' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN56
     C                     END                             -E5
     C** MULTIB. ON
     C           MBIN      IFEQ 'Y'                        -B4            074588
     C***********          ELSE                            -X4            074588
     C** MUST BE BETWEEN START ACCOUNT SEQUENCE AND END ACCOUNT
     C** SEQUENCE
     C* Excpt if customer is internal customer number then default
     C           WWACSQ    IFEQ 01                         B5
     C           SCNUM     ANDEQA8BICN
     C                     MOVE 'Y'       WWBICN
     C                     ELSE
     C                     MOVE 'N'       WWBICN  1
     C                     END                             -E5
     C*
     C                     MOVE SACSQ     WWACSQ
     C                     END                             -E4
     C**
     C                     END                             -E3
     C**
     C**
     C** IF NO ERRORS
     C**
     C           ERR       IFEQ *BLANK
     C**
     C** RETAIL NUMBER VALIDATION ONLY IF RETAIL NUMBER USED
     C**
     C           *IN48     IFEQ '1'
     C**
     C** RETAIL NUMBER ENTERED
     C           SACNO     IFNE *BLANKS
     C** A/C TYPE MUST BE RETAIL
     C           *IN29     IFEQ '0'
     C                     MOVEL'RE71047' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     MOVE '1'       *IN58
     C**
     C                     ELSE
     C** ACCOUNT TYPE IS RETAIL
     C** RETAIL MUST BE NUMERIC
     C                     MOVEASACNO     RETA
     C                     EXSR #RETTS
     C           *IN80     IFEQ '0'
     C                     MOVEL'RE71048' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN58
     C                     MOVEL'E'       ERR
     C                     ELSE
     C** MUST BE GREATER THAN 0 AND LOWER THAN 9999999999
     C                     Z-ADD99999     RETN1
     C                     Z-ADD99998     RETN2
     C                     MOVE SACNO     WWRKEY
     C           WWRKEY    IFLT 1
     C           WWRKEY    ORGT RETNR
     C                     MOVEL'RE71046' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN58
     C                     MOVEL'E'       ERR
     C                     END
     C                     END
     C                     END
     C                     ELSE                             SACNO BLANK
     C           *IN29     IFEQ '1'
     C                     MOVEL'RE71046' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN55
     C                     MOVE '1'       *IN58
     C                     MOVEL'E'       ERR
     C                     END
     C**
     C                     END
     C**
     C                     END                             *IN48
     C                     END                             ERR
     C**
     C                     END                             -E1
     C/COPY WNCPYSRC,GL3271C255
     C*
     C** VALIDATE ACCOUNT NAME FIELD:
     C*  - SANAM CAN NOT BE BLANK
     C           SANAM     IFEQ *BLANK                     - B1
     C                     MOVEL'RE71100' ZAMSID           SANAM FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN59            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*
     C** VALIDATE DATE ACCOUNT OPENED:
     C*  - SDACO DEFAULT TO RUN DATE IF BLANK
     C** VALIDATION IN INSERT MODE ONLY
     C           *IN30     IFEQ '1'
     C           SDACO     IFEQ *BLANK                     - B1
     C                     Z-ADDBJRDNB    ZDAYNO
     C/COPY WNCPYSRC,GL3271C055
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SDACO
     C                     Z-ADDBJRDNB    WWDACO  50
     C*
     C*  - WHEN SDACO ENTERED
     C*  - - SDACO MUST BE VALID
     C                     ELSE                            - X1
     C                     MOVE SDACO     ZDATE
     C                     EXSR ZDATE1
     C           *IN99     IFEQ '1'                        - B2
     C                     MOVEL'RE71101' ZAMSID           SDACO FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     ELSE                            - X2
     C                     Z-ADDZDAYNO    WWDACO
     C                     END                             - E2
     C*
     C*  - - SDACO MUST BE < OR = TO RUN DATE
     C           WWDACO    IFGT BJRDNB                     - B2
     C                     MOVEL'RE71102' ZAMSID           SDACO FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C*
     C*  - - SDACO MUST BE > OR = TO RUN DATE - BACK VALUE PERIOD
     C           BJRDNB    SUB  BJBVPD    BACKVA  50
     C*
     C           WWDACO    IFLT BACKVA                     - B2
     C                     MOVEL'RE71119' ZAMSID           SDACO FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     END                             - E1
     C                     END                             - E1
     C*
     C** VALIDATE NEXT STATEMENT DATE:
     C*  - SNSTD MANDATORY IF SSTFQ IS 'Z'
     C/COPY WNCPYSRC,GL3271C003
     C           SSTFQ     IFNE 'Z'                        - B1
     C           SSTFQ     ANDNE'N'                                                           CGL001
     C           SNSTD     ANDEQ*BLANK
     C                     MOVEL'RE71103' ZAMSID           SNSTD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C/COPY WNCPYSRC,GL3271C004
     C*
     C*  - WHEN SNSTD ENTERED
     C*  - - SNSTD MUST BE VALID
     C           SNSTD     IFNE *BLANK                     - B1
     C                     MOVE SNSTD     ZDATE
     C                     EXSR ZDATE1
     C           *IN99     IFEQ '1'                        - B2
     C           SNSTD     OREQ '?'                        - B1           115860
     C                     MOVEL'RE71104' ZAMSID           SNSTD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61            REVERSE MODE
     C                     MOVEL'R'       ERR              ERROR INDIC.
     C                     ELSE                            - X2
     C                     Z-ADDZDAYNO    WWNSTD  50
     C                     END                             - E2
     C*
     C*  - - SNSTD MUST BE > OR = TO RUN DATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP77                                           S01408
     C*                                                                   S01408
     C           WWNSTD    IFLT BJRDNB                     - B2
     C                     MOVEL'RE71105' ZAMSID           SNSTD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP78                                           S01408
     C*                                                                   S01408
     C*
     C*  - - SNSTD MUST BE > OR = TO ACCOUNT OPEN DATE
     C           WWNSTD    IFLT WWDACO                     - B2
     C                     MOVEL'RE71106' ZAMSID           SNSTD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C*
     C*  - - SNSTD MUST BE = TO ACCRUAL DATE IF SSTFQ IS 'A'
     C           SSTFQ     IFEQ 'A'                        - B2
     C           WWNSTD    ANDNEBKAPDT
     C                     MOVEL'RE71107' ZAMSID           SNSTD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     ELSE                            - X1           057921
     C                     Z-ADD0         WWNSTD                          057921
     C                     END                             - E1
     C*
     C** VALIDATE FREQUENCY:
     C*  - SSTFQ MANDATORY
     C           SSTFQ     IFEQ *BLANK                     - B1
     C                     MOVEL'RE71108' ZAMSID           SSTFQ FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP79                                           S01408
     C*                                                                   S01408
     C*
     C*  - SSTFQ MUST BE VALID
     C           SSTFQ     IFNE 'A'                        - B1
     C           SSTFQ     ANDNE'B'
     C           SSTFQ     ANDNE'D'
     C           SSTFQ     ANDNE'E'
     C           SSTFQ     ANDNE'F'
     C           SSTFQ     ANDNE'L'
     C           SSTFQ     ANDNE'M'
     C           SSTFQ     ANDNE'Q'
     C           SSTFQ     ANDNE'R'
     C           SSTFQ     ANDNE'S'
     C           SSTFQ     ANDNE'T'
     C           SSTFQ     ANDNE'W'
     C           SSTFQ     ANDNE'X'
     C           SSTFQ     ANDNE'Y'
     C           SSTFQ     ANDNE'Z'
     C           SSTFQ     ANDNE'N'                                                           CGL001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP81                                           S01408
     C*                                                                   S01408
     C                     MOVEL'RE71109' ZAMSID           SSTFQ FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP80                                           S01408
     C*                                                                   S01408
     C**  Statement Frequency 'E' not allowed if Turnover Statements      094409
     C**  not installed.                                                  094409
     C           SSTFQ     IFEQ 'E'
     C************IN14     ANDEQ'0'                                       094409
     C           TTURN     ANDNE'Y'                                       094409
     C/COPY WNCPYSRC,GLH00816
     C                     MOVEL'RE71109' ZAMSID           SSTFQ FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C/COPY WNCPYSRC,GLH00717
     C                     END
     C           ERR       IFEQ ' '
     C                     MOVELSNSTD     SSSTDY
     C                     END
     C*
     C** VALIDATE NUMBER OF COPIES:
     C*  - SENOC NOT ALLOWED IF SSTFQ NOT 'E'
     C           SSTFQ     IFNE 'E'                        - B1
     C           SENOC     ANDNE*BLANK
     C/COPY WNCPYSRC,GLH00817
     C                     MOVEL'RE71110' ZAMSID           SENOC FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*
     C*  - WHEN SENOC ENTERED
     C*  - - SENOC MUST BE NUMERIC
     C           SENOC     IFNE *BLANK                     - B1
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSENOC     ZFIELD
     C                     Z-ADD2         ZADIG
     C                     Z-ADD*ZEROS    ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B2
     C                     MOVEL'RE71111' ZAMSID           SENOC FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     ELSE                            - X2
     C                     MOVE ZFIELD    SENOC
     C                     END                             - E2
     C*
     C*  - - SENOC MUST BE > ZERO
     C           SENOC     IFLE *ZERO                      - B2
     C                     MOVEL'RE71112' ZAMSID           SENOC FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     END                             - E1
     C*
     C*  - SENOC DEFAULT TO '1' IF NO ENTRY & SSTFQ SET TO 'E'
     C           SSTFQ     IFEQ 'E'                        - B1
     C           SENOC     ANDEQ*BLANK
     C/COPY WNCPYSRC,GLH00818
     C           *IN14     ANDEQ'1'
     C                     MOVE '1'       SENOC
     C                     END                             - E1
     C*
     C*
     C** Validate Next Statement Day Number
     C*
     C           SSTFQ     IFEQ 'M'
     C           SSTFQ     OREQ 'T'
     C           SSTFQ     OREQ 'Q'
     C           SSTFQ     OREQ 'X'
     C           SSTFQ     OREQ 'Y'
     C/COPY WNCPYSRC,GLH00819
     C*
     C           SNSDN     IFNE *BLANKS
     C           SNSDN     ANDNE'00'
     C*
     C                     MOVELSNSDN     @NSDN   20
     C           @NSDN     IFLT 01
     C           @NSDN     ORGT 31
     C                     MOVEL'RE71851' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVEL'E'       ERR
     C                     END
     C*
     C                     ELSE
     C*
     C           *IN61     IFNE '1'
     C                     MOVELZDAY      SNSDN
     C                     END
     C*
     C                     END
     C*
     C                     ELSE
     C           SNSDN     IFNE *BLANKS
     C           SNSDN     ANDNE'00'
     C                     MOVEL'RE71851' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C                     END
     C                     END
     C*                                                                   CEU013
     C** Validate Statement Balances in Euros.                            CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN27     ANDEQ*ON                                       CEU013
     C                     MOVE *IN52     W#IN52  10                      CEU013
     C                     MOVE *OFF      *IN52                           CEU013
     C           SEUSB     IFNE ' '                                       CEU013
     C           SEUSB     ANDNE'Y'                                       CEU013
     C           SEUSB     ANDNE'N'                                       CEU013
     C*                                                                   CEU013
     C                     MOVEL'RE71877' ZAMSID                          CEU013
     C                     EXSR ZASNMS                                    CEU013
     C                     MOVE *ON       *IN52                           CEU013
     C                     MOVEL'E'       ERR                             CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C*
     C*
     C** VALIDATE PRINT ADDRESS Y/N:
     C*  - SPTAD MUST BE 'Y' OR 'N'
     C           SPTAD     IFNE 'Y'                        - B1
     C           SPTAD     ANDNE'N'
     C                     MOVEL'RE71113' ZAMSID           SPTAD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN64            REVERSE MODE
     C                     MOVEL'1'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*
     C** VALIDATE ADDRESS REFERENCES
     C*  - WHEN SREF ENTERED
     C*  - - SREF MUST BE A LIVE ADDRESS
     C* IF NO ENTRY DEFAULT TO 'B'
     C           SREF      IFEQ *BLANK
     C                     MOVEL'B'       SREF
     C                     END
     C                     MOVE *OFF      *IN84                           079126
     C           SREF      IFNE *BLANK                     - B1
     C                     MOVE SCNUM     AENB    6
     C                     MOVEASREF      ARR,1
     C                     MOVEA*BLANK    ADR,1
     C                     MOVE '0'       *IN84                           080038
     C                     Z-ADD1         X       20
     C           X         DOWLE10                         - B2
     C           *IN65     ANDEQ'0'
     C           ARR,X     IFEQ *BLANK                     - B3
     C                     ADD  1         X
     C           X         DOWLE10                         - B4
     C           *IN65     ANDEQ'0'
     C           ARR,X     IFNE *BLANK                     - B5
     C                     MOVEL'RE71114' ZAMSID           SREF FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN65            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     ELSE                            - X5
     C                     ADD  1         X
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE                            - X3
     C                     MOVE ARR,X     AZCD    1
     C           ARR,X     IFEQ 'B'
     C                     MOVE SCNUM     WWCNUM
     C                     MOVE WWCNUM    WWCNM6  6
     C*
     C*****                CALL 'AOCUSTR0'                                178695
     C                     CALL 'AOCUSTR1'                                178695
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCNM6    @CNUM  10
     C                     PARM           @CNST   7
     C*****      SDCUST    PARM SDCUST    DSSDY                           178695
     C           SDCUST    PARM SDCUST    DSLDY                           178695
     C/COPY WNCPYSRC,GL3271C221
     C           @RTCD     IFNE *BLANKS
     C                     MOVE *ON       *IN84
     C                     ELSE                                           072879
     C                     MOVE BBCUST    SCNUM                           072879
     C/COPY WNCPYSRC,GL3271C026
     C                     END
     C*
     C                     ELSE
     C*
     C                     CALL 'AOALTNR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM AENB      @CNUA   6
     C                     PARM AZCD      @ADDR   1
     C           SDALTN    PARM SDALTN    DSFDY
     C           @RTCD     IFNE *BLANKS
     C           BCCUST    ORNE AENB                       - B5           084429
     C                     MOVE *ON       *IN84
     C                     ELSE                            - X5           075129
     C*                                                                   075129
     C* Move chosen alternate into array element.                         075129
     C*                                                                   075129
     C                     MOVE BCADCD    ARR,X                           075129
     C                     END
     C*
     C                     END
     C           *IN84     IFEQ '1'                        - B4
     C*                                                                   075129
     C* Remove previous access object message first.                      075129
     C*                                                                   075129
     C                     CALL 'ZA0250'                                  075129
     C                     MOVEL'RE71114' ZAMSID           SREF FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN65            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     ELSE                            - X4
     C                     Z-ADD1         Y       20
     C*                                                                   075129
     C* Array has the same character twice.                               075129
     C*                                                                   075129
     C           ARR,X     LOKUPADR,Y                    84
     C           *IN84     IFEQ '1'
     C                     Z-ADD1         Y
     C                     MOVEL'RE71114' ZAMSID           SREF FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN65            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     ELSE
     C                     MOVE ARR,X     ADR,X
     C                     ADD  1         X
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C*                                                                   075129
     C* Move Array to screen as details may have changed via AOALTNR0     075129
     C*                                                                   075129
     C                     MOVEAARR       SREF                            075129
     C                     END                             - E1
     C*
     C** VALIDATE REFER ALL DEBITS:
     C*  - SRAD MUST BE 'Y' OR 'N'
     C           SRAD      IFNE 'Y'                        - B1
     C           SRAD      ANDNE'N'
     C                     MOVEL'RE71113' ZAMSID           SRAD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*
     C** VALIDATE REFER ALL CREDITS
     C*  - SRAC MUST BE 'Y' OR 'N'
     C           SRAC      IFNE 'Y'                        - B1
     C           SRAC      ANDNE'N'
     C                     MOVEL'RE71113' ZAMSID           SRAC FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN67            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*
     C** VALIDATE BLOCK ALL DEBITS
     C*  - SBAD MUST BE 'Y' OR 'N'
     C           SBAD      IFNE 'Y'                        - B1
     C           SBAD      ANDNE'N'
     C                     MOVEL'RE71113' ZAMSID           SBAD FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN68            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*
     C** VALIDATE BLOCK ALL CREDITS
     C*  - SBAC MUST BE 'Y' OR 'N'
     C           SBAC      IFNE 'Y'                        - B1
     C           SBAC      ANDNE'N'
     C                     MOVE '1'       *IN69            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*                                                                   CTI001
     C** If Midas/TI Interface is on then:                                CTI001
     C*                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
      *                                                                   160464
     C           *IN30     IFEQ '1'                                       160467
     C***********STIAC     OREQ 'Y'                                 160467160473
     C           STIAC     ANDEQ'Y'                                       160473
     C           SSTIAC    ANDNE'Y'                                       160467
     C           *IN31     OREQ '1'                                       160473
     C           STIAC     ANDEQ'Y'                                       160473
     C           SSTIAC    ANDNE'Y'                                       160473
     C           #TIDFT    IFNE 'Y'                                       160464
      *                                                                   160464
      * If Screen displayed for the first time after setting TI           160464
      * account to 'Y' default TI Account number to Customer Number       160464
      *                                                                   160464
     C                     MOVELSCNUM     STIAN                           160464
      *                                                                   160464
      * If the account is for internal branch customer default to blank.  160464
      *                                                                   160464
     C           A8BICN    IFEQ SCNUM                                     160464
     C                     MOVE *BLANKS   STIAN                           160464
     C                     ENDIF                                          160464
      *                                                                   160464
     C                     MOVEL'Y'       #TIDFT                          160464
     C                     ENDIF                                          160464
      *                                                                   160464
      * If the account is for internal branch customer default suffix     160464
      * to blank.                                                         160464
      *                                                                   160464
     C           A8BICN    IFEQ SCNUM                                     160464
     C                     MOVE *BLANKS   STIAS                           160464
     C                     ELSE                                           160464
      *                                                                   160464
      * Default TI Suffix Number to next available number.                160464
      *                                                                   160464
     C                     MOVELSBRCA     WWTIBR                          160464
     C                     MOVELSTIAN     WWTIAC                          160464
     C                     MOVEL'999'     WWTISF                          160464
     C           TIAKEY    SETLLACCNTTBF                                  160464
     C                     READPACCNTTBF                 91               160464
      * Set TI Account Suffix No. to one more.                            160464
     C                     MOVE A5TIAS    @@TIAS  30                      160464
     C           @@TIAS    IFNE 999                                       160464
     C                     ADD  1         @@TIAS                          160464
     C                     ENDIF                                          160464
      *                                                                   160464
      * If previous record read has branch number or customer number      160464
      * different than needed - set TI account suffix to 1.               160464
      *                                                                   160464
     C           SBRCA     IFNE BRCA                                      160464
     C           A5TIAN    ORNE WWTIAC                                    160464
     C                     Z-ADD1         @@TIAS                          160464
     C                     ENDIF                                          160464
      *                                                                   160464
     C                     MOVEL@@TIAS    STIAS                           160464
      *                                                                   160464
     C                     ENDIF                                          160464
     C*                                                                   CTI001
     C                     MOVE *IN37     W#IN37  10                      CTI001
     C                     MOVE *IN89     W#IN89  10                      CTI001
     C                     MOVE *OFF      *IN37                           CTI001
     C                     MOVE *OFF      *IN76                           CTI001
     C                     MOVE *OFF      *IN88                           CTI001
     C***********          MOVE *OFF      *IN89                     CTI001160463
     C*                                                                   CTI001
     C                     ENDIF                                          160467
      *                                                                   160467
     C** validate TI Account: set on *IN37 if STIAC is not 'Y' or 'N'     CTI001
      *                                                                   CTI001
     C           STIAC     IFNE 'Y'                                       CTI001
     C           STIAC     ANDNE'N'                                       CTI001
     C                     MOVEL'RE71113' ZAMSID           STIAC FALSE    CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVE *ON       *IN37            REVERSE MODE   CTI001
     C                     MOVEL'E'       ERR              ERROR INDIC.   CTI001
     C                     ENDIF                                          CTI001
      *                                                                   155863
      ** validate TI Account: if TI Account is 'Y' and Customer is not    155863
      ** Branch Internal Customer then must have TI Customer flag set     155863
      ** to 'Y'                                                           155863
      *                                                                   155863
      *                                                                   155863
      ** Check Branch Internal Customer                                   155863
      *                                                                   155863
     C**********           CALL 'AOBRCHR0'                                             155863 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           155863
     C                     PARM '*KEY   ' @OPTN                           155863
     C                     PARM SBRCA     @BRCA   3                       155863
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        155863 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   155863
     C           @RTCD     IFNE *BLANKS                                   155863
     C*                                                                   155863
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE              155863
     C*                                                                   155863
     C           *IN36     IFEQ '0'                                       155863
     C                     CALL 'ZA0250'                                  155863
     C                     MOVE '1'       *IN36                           155863
     C                     END                                            155863
     C*                                                                   155863
     C                     MOVEL'RE71040' ZAMSID                          155863
     C                     EXSR ZASNMS                                    155863
     C                     MOVEL'E'       ERR                             155863
     C                     MOVE '1'       *IN57                           155863
     C                     ELSE                                           155863
      *                                                                   155863
     C           STIAC     IFEQ 'Y'                                       155863
     C           BBCUST    ANDNEA8BICN                                    155863
     C           BBTICS    ANDNE'Y'                                       155863
     C                     MOVEL'TIM0019' ZAMSID                          155863
     C                     MOVELBBCUST    ZAMSDA                          155863
     C                     MOVEL'TIUSRMSG'ZAMSGF                          155863
     C                     EXSR ZASNMS                                    155863
     C                     MOVEL'REUSRMSG'ZAMSGF                          155863
     C                     MOVEL'E'       ERR                             155863
     C                     MOVE *ON       *IN37                           155863
     C                     ENDIF                                          155863
     C                     ENDIF                                          155863
      *                                                                   155863
      ** If error found, do not validate the rest of the details.         155863
      *                                                                   155863
     C           ERR       IFEQ *BLANKS                                   155863
      *                                                                   CTI001
     C** validate TI Account: if TI Account is 'Y'                        CTI001
     C** then TI Account Type on SDACODL1 must not be blank               CTI001
      *                                                                   CTI001
     C           STIAC     IFEQ 'Y'                                       CTI001
     C           SACOD     CHAINSDACODL1             81                   CTI001
     C           *IN81     IFEQ '0'                                       CTI001
      *                                                                   CTI001
     C           A5TIAT    IFEQ *BLANKS                                   CTI001
     C                     MOVEL'RE71064' ZAMSID                          CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVEL'E'       ERR                             CTI001
     C                     MOVE *ON       *IN37                           CTI001
     C                     ENDIF                                          CTI001
     C*                                                                   CTI001
     C                     ELSE                                           CTI001
     C                     MOVEL'RE71062' ZAMSID                          CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVEL'E'       ERR                             CTI001
     C                     MOVE *ON       *IN37                           CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      ****Customer*must*be*a*designated*TI*customer,*************** 157284155863
      ****if*TI*Account*is*set*to*'Y'.***************************** 157284155863
      ***********                                                   157284155863
     C***********          CALL 'AOCUSTR0'                          157284155863
     C***********          PARM '*MSG   ' @RTCD                     157284155863
     C***********          PARM '*KEY   ' @OPTN                     157284155863
     C***********          PARM SCNUM     @CNUM  10                 157284155863
     C***********          PARM           @CNST   7                 157284155863
     C***********SDCUST    PARM SDCUST    DSSDY                     157284155863
      ***********                                                   157284155863
     C***********BBTICS    IFNE 'Y'                                 157284155863
     C***********STIAC     ANDEQ'Y'                                 157284155863
     C***********          MOVEL'RE71878' ZAMSID                    157284155863
     C***********          EXSR ZASNMS                              157284155863
     C***********          MOVEL'E'       ERR                       157284155863
     C***********          MOVE *ON       *IN37                     157284155863
     C***********          ENDIF                                    157284155863
      *                                                                   CTI001
     C** validate TI Account Number: if TI Account is 'Y' then            CTI001
     C**   if Branch Internal Customer is not the Customer                CTI001
     C**   Number from the Account file then                              CTI001
     C**     TI Account Number must be the Account Customer               CTI001
      *                                                                   CTI001
     C**********           CALL 'AOBRCHR0'                                             CTI001 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           CTI001
     C                     PARM '*KEY   ' @OPTN                           CTI001
     C                     PARM           SBRCA                           CTI001
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CTI001 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   CTI001
     C           @RTCD     IFNE *BLANKS                                   CTI001
     C           A8BICN    ORNE SCNUM                                     CTI001
     C           STIAN     ANDNESCNUM                                     CTI001
     C                     MOVEL'RE71067' ZAMSID                          CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVE *ON       *IN88                           CTI001
     C                     MOVEL'E'       ERR                             CTI001
     C                     ENDIF                                          CTI001
     C*                                                                   CTI001
     C**   TI Account Number can be any value except 000000,              CTI001
     C*    so set on *IN88 if STIAN is zero.                              CTI001
     C*                                                                   CTI001
     C**   But must be a numeric as well.                                 160465
     C*                                                                   160465
     C**********           TESTN          STIAN      88                                160465 CSD027
     C********** STIAN     IFEQ *ZERO                                                  CTI001 CSD027
     C********** *IN88     OREQ '0'                                                    160465 CSD027
     C           STIAN     IFEQ *BLANKS                                                       CSD027
     C***********STIAN     OREQ *BLANKS                             CTI001160465
     C                     MOVEL'RE71061' ZAMSID                          CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVE *ON       *IN88                           CTI001
     C                     MOVEL'E'       ERR                             CTI001
     C                     ENDIF                                          CTI001
      *                                                                   160471
      **   TI Account Suffix Number can be any value except 000,          160471
      **   and must be a numeric as well.                                 160471
      *                                                                   160471
     C                     TESTN          STIAS      76                   160471
     C           STIAS     IFEQ *ZERO                                     160471
     C           *IN76     OREQ '0'                                       160471
     C                     MOVEL'RE71071' ZAMSID                          160471
     C                     EXSR ZASNMS                                    160471
     C                     MOVE *ON       *IN76                           160471
     C                     MOVEL'E'       ERR                             160471
     C                     ENDIF                                          160471
      **                                                                  CTI001
     C** validate unique details: if TI Account is 'Y' then               CTI001
     C**   if user has changed TI Account field from 'N' to 'Y' then      CTI001
      **   for Branch Internal Customer accounts:                         CTI001
      **     Midas account branch combined with TI Account Number         CTI001
      **     and TI Account Suffix must be unique across all accounts.    CTI001
      **   for non-Branch Internal Customer accounts:                     CTI001
      **     Midas Account Branch combined with TI Account Number, Ccy    CTI001
      **     and TI Account Type must be unique across all accounts.      CTI001
      *                                                                   CTI001
     C***********STIAC     IFNE SSTIAC                              CTI001160468
     C           STIAC     IFEQ 'Y'                                       160468
     C           STIAN     ANDNESSTIAN                                    160468
     C           STIAS     ORNE SSTIAS                                    160468
      *                                                                   CTI001
     C           A8BICN    IFEQ SCNUM                                     CTI001
      *                                                                   CTI001
      **   it is a Branch Internal Customer account                       CTI001
      *                                                                   CTI001
     C           WACCNT    CHAINACCNTTI              81                   CTI001
     C           *IN81     IFEQ *OFF                                      CTI001
      *                                                                   155863
      ** Set *IN89 to '1' to make TI account number fields available      155863
      *                                                                   155863
     C                     MOVEL'1'       *IN89                           155863
     C                     MOVEL'RE71060' ZAMSID                          CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVE *ON       *IN76                           CTI001
     C                     MOVEL'E'       ERR                             CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C                     ELSE                                           CTI001
      *                                                                   CTI001
      * it is a non-Branch Internal Customer account, so:                 CTI001
      * save the TI Account Type of current account as W#TIAT             CTI001
      * Let W#FLAG be 'Y' when current account is not unique.             CTI001
      *                                                                   CTI001
     C                     MOVE 'N'       W#FLAG  1                       CTI001
     C           SACOD     CHAINSDACODL1             76                   CTI001
     C           *IN76     IFEQ *OFF                                      CTI001
     C                     MOVE A5TIAT    W#TIAT  2                       CTI001
      *                                                                   CTI001
     C           WACCNT    CHAINACCNTTI              76                   CTI001
     C************IN76     DOWEQ*OFF                               CTI001 155863
     C***********          MOVE ACOD      ACODX   4                CTI001 155863
     C***********ACODX     CHAINSDACODL1             76            CTI001 155863
     C           *IN76     IFEQ *OFF                                      CTI001
     C***********SCCY      ANDEQCCY                                CTI001 155863
     C***********W#TIAT    ANDEQA5TIAT                             CTI001 155863
     C                     MOVE 'Y'       W#FLAG                          CTI001
     C                     ENDIF                                          CTI001
     C***********          READEACCNTTI                  76        CTI001 155863
     C***********          ENDDO                                   CTI001 155863
      *                                                                   CTI001
     C                     ELSE                                           CTI001
     C                     MOVE 'Y'       W#FLAG                          CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      * now look at W#TIAT to determine *IN76                             CTI001
      *                                                                   CTI001
     C           W#FLAG    IFEQ 'Y'                                       CTI001
      *                                                                   155863
      ** Set *IN89 to '1' to make TI account number fields available      155863
      *                                                                   155863
     C                     MOVEL'1'       *IN89                           155863
     C                     MOVEL'RE71069' ZAMSID                          CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVE *ON       *IN76                           CTI001
     C                     MOVEL'E'       ERR                             CTI001
     C                     ELSE                                           CTI001
     C                     MOVE *OFF      *IN76                           CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C                     ENDIF                                          CTI001
      **                                                                  CTI001
      ** set on *IN89 if user allowed to amend TI Account N0. & Suffix:   CTI001
      **   cannot amend these fields unless:                              CTI001
      **      1) Inserting and STIAC='Y'                                  CTI001
      **   or 2) Amending and STIAC='Y' and A5TIAN & A5TIAS blank         CTI001
      **                                                                  CTI001
     C           *IN30     IFEQ *ON                                       CTI001
     C           *IN31     OREQ *ON                                       CTI001
     C           A5TIAN    ANDEQ*BLANKS                                   CTI001
     C           A5TIAS    ANDEQ*BLANKS                                   CTI001
     C                     MOVE *ON       *IN89                           CTI001
     C                     ENDIF                                          CTI001
      **                                                                  CTI001
     C                     ELSE                                           CTI001
      **                                                                  CTI001
     C**   validate TI Account Number:                                    CTI001
     C**   if TI Account is 'N' and STIAN or STIAS is not blank           CTI001
     C**   then make STIAN and STIAS blank and send warning message       CTI001
     C*                                                                   CTI001
     C           STIAC     IFEQ 'N'                                       CTI001
     C           STIAN     IFNE *BLANKS                                   CTI001
     C           STIAS     ORNE *BLANKS                                   CTI001
     C                     MOVE *BLANKS   STIAN                           CTI001
     C                     MOVE *BLANKS   STIAS                           CTI001
     C                     MOVEL'RE71068' ZAMSID                          CTI001
     C                     EXSR ZASNMS                                    CTI001
     C                     MOVEL'E'       ERR                             CTI001
     C                     ENDIF                                          CTI001
     C*                                                                   CTI001
     C*                                                                   CTI001
     C                     ENDIF                                          CTI001
     C*                                                                   CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C                     ENDIF                                          CTI001
      *                                                                   155863
     C                     ENDIF                                          155863
     C/COPY WNCPYSRC,GL3271C246
     C*
     C** Validate Profit Centre
     C*
     C           BKPRCU    IFEQ 'Y'
     C                     SELEC
      *
      * amend mode but change not allowed
     C           DDACTN    WHEQ 'A'
     C           SPRFC     ANDNESWPRFC
     C           BKPRCA    ANDNE'Y'
     C                     MOVE '1'       *IN73
     C                     MOVEL'E'       ERR
     C                     MOVEL'RE71120' ZAMSID
     C                     EXSR ZASNMS
      *
      * insert mode and no entry made, get default if this is used
      **  and if analytical accounting module is switched off             CAC001
      *                                                                   CAC001
     C           DDACTN    WHEQ 'I'
     C           SPRFC     ANDEQ*BLANKS
     C           BKPCDU    ANDEQ'Y'
     C           BGN0ST    ANDEQ'N'                                       CAC001
      *                                                                   CAC001
      **  or no entry made and analytical accounting is switched on,      CAC001
      **  get profit centre default for retail and nostro a/cs only       CAC001
      *                                                                   CAC001
     C           SPRFC     OREQ *BLANKS                                   CAC001
     C           BGN0ST    ANDEQ'Y'                                       CAC001
     C           SWATYP    ANDEQ'R'                                       CAC001
      *                                                                   CAC001
     C           SPRFC     OREQ *BLANKS                                   CAC001
     C           BGN0ST    ANDEQ'Y'                                       CAC001
     C           SWATYP    ANDEQ'N'                                       CAC001
      *                                                                   074585
      * Set up account officer from the customer of the account.          074585
      *                                                                   074585
     C                     MOVELWWCNUM    #CNUM   6                       074585
     C*****                CALL 'AOCUSTR0'                         074585 178695
     C                     CALL 'AOCUSTR1'                                178695
     C                     PARM '*MSG   ' @RTCD                           074585
     C                     PARM '*KEY   ' @OPTN                           074585
     C                     PARM #CNUM     @CNUM  10                       074585
     C                     PARM           @CNST   7                       074585
     C*****      SDCUST    PARM SDCUST    DSSDY                    074585 178695
     C           SDCUST    PARM SDCUST    DSLDY                           178695
     C/COPY WNCPYSRC,GL3271C222
     C           @RTCD     IFNE *BLANKS                    - B1           074585
     C*                                                                   074585
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE              074585
     C*                                                                   074585
     C           *IN36     IFEQ '0'                                       074585
     C                     CALL 'ZA0250'                                  074585
     C                     MOVE '1'       *IN36                           074585
     C                     END                                            074585
     C*                                                                   074585
     C                     MOVEL'RE71022' ZAMSID                          074585
     C                     EXSR ZASNMS                                    074585
     C                     MOVEL'E'       ERR                             074585
     C                     END                             - E1           074585
     C*                                                                   074585
     C                     MOVELBBACOC    WUACOC           Account offcr  074585
     C/COPY WNCPYSRC,GL3271C247
      *                                                                   074585
     C                     CALL 'AOPRFMR0'
     C                     PARM *BLANKS   RTCDPR  1
     C                     PARM *BLANKS   BOOKPR  2
     C                     PARM *BLANKS   TRTPPR  5
     C                     PARM *BLANKS   SUTPPR  2
     C                     PARM SBRCA     BRANPR  3
     C                     PARM *BLANKS   DEPTPR  3
     C                     PARM SUSER     USERPR 10
     C*********            PARM *BLANKS   ACOFPR  2                       074585
     C                     PARM WUACOC    ACOFPR  2                       074585
     C                     PARM SCNUM     CNUMPR  6
     C           SPRFC     PARM           PRFCPR  4
     C/COPY WNCPYSRC,GL3271C248
      *
     C           RTCDPR    IFEQ '2'
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVE '1'       *IN73
     C                     MOVEL'E'       ERR
     C                     MOVEL'RE71121' ZAMSID
     C                     EXSR ZASNMS
     C                     ENDIF
      *                                                                   CAC001
      **  If accounting module is switched on and default profit centre   CAC001
      **  is still blank for retail or nostro a/c, send error msg         CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           SPRFC     ANDEQ*BLANKS                                   CAC001
      *                                                                   CAC001
     C           SWATYP    IFEQ 'R'                                       CAC001
     C           SWATYP    OREQ 'N'                                       CAC001
      *                                                                   CAC001
      **  Clear first instance of access object error message             CAC001
      *                                                                   CAC001
     C           *IN36     IFEQ '0'                                       CAC001
     C                     CALL 'ZA0250'                                  CAC001
     C                     MOVE '1'       *IN36                           CAC001
     C                     ENDIF                                          CAC001
     C                     MOVE '1'       *IN73                           CAC001
     C                     MOVEL'E'       ERR                             CAC001
     C                     MOVEL'RE71123' ZAMSID                          CAC001
     C                     EXSR ZASNMS                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ENDIF                                          CAC001
      *
      * validate if entered
     C           SPRFC     WHNE *BLANKS
      *                                                                   CAC001
      **  If accounting module is switched on, allow entry for retail     CAC001
      **  and nostro accounts only.                                       CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'N'                                       CAC001
     C           BGN0ST    OREQ 'Y'                                       CAC001
     C           SWATYP    ANDEQ'R'                                       CAC001
     C           BGN0ST    OREQ 'Y'                                       CAC001
     C           SWATYP    ANDEQ'N'                                       CAC001
      *                                                                   CAC001
     C                     CALL 'AOPRFCR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY    '@OPTN   7
     C                     PARM SPRFC     @KEY    4
     C           SDPRFC    PARM SDPRFC    DSFDY
      *
     C           @RTCD     IFNE *BLANKS
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVE '1'       *IN73
     C                     MOVEL'E'       ERR
     C                     MOVEL'RE71121' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     MOVE DSPCCD    SPRFC
     C                     ENDIF
      *                                                                   CAC001
      **  Else, entry is prohibited so send error message                 CAC001
     C                     ELSE                                           CAC001
      *                                                                   CAC001
      **  Clear first instance of access object error message             CAC001
      *                                                                   CAC001
     C           *IN36     IFEQ '0'                                       CAC001
     C                     CALL 'ZA0250'                                  CAC001
     C                     MOVE '1'       *IN36                           CAC001
     C                     END                                            CAC001
     C                     MOVE '1'       *IN73                           CAC001
     C                     MOVEL'E'       ERR                             CAC001
     C                     MOVEL'RE71123' ZAMSID                          CAC001
     C                     EXSR ZASNMS                                    CAC001
      *                                                                   CAC001
     C                     ENDIF                                          CAC001
      *
     C                     ENDSL
     C                     ENDIF
     C*
     C** VALIDATE MICROFICHE FREQUENCY:
     C*  - SMFFQ MUST BE VALID IF MICOFICHE INDICATOR 'ON'
     C           *IN35     IFEQ '1'                        - B1
     C           SMFFQ     ANDNE'A'
     C           SMFFQ     ANDNE'B'
     C           SMFFQ     ANDNE'D'
     C           SMFFQ     ANDNE'Y'
     C           SMFFQ     ANDNE'1'
     C           SMFFQ     ANDNE'2'
     C           SMFFQ     ANDNE'3'
     C           SMFFQ     ANDNE'4'
     C           SMFFQ     ANDNE'5'
     C           SMFFQ     ANDNE'6'
     C           SMFFQ     ANDNE'7'
     C           SMFFQ     ANDNE' '
     C                     MOVEL'RE71115' ZAMSID           SMFFQ FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN70            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E1
     C*
     C*                                                                   S01486
      ** Validate Portfolio Reference:                                    S01486
      ** Account Code must be live                                        S01486
     C                     CALL 'AOACODR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C**********           PARM SACOD     @ACOD   4                                    S01486 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01486 CGL029
     C                     PARM SACOD     @ACOD                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                   S01486
     C           @RTCD     IFNE *BLANK                                    S01486
     C                     MOVEL'RE71037' ZAMSID                          S01486
     C                     EXSR ZASNMS                                    S01486
     C                     MOVEL'E'       ERR                             S01486
     C                     MOVE *ON       *IN55                           S01486
     C                     END                                            S01486
      *                                                                   CPM004
      ** The following lines of codes have been stripped off              CPM004
      ** as Portfolio reference is now conditioned to appear              CPM004
      ** only on appropriate account type and action code.                CPM004
      *                                                                   CPM004
      ***-*SPTFR*optional*only*if*Portfolio*Indicator*'ON'*******  S01486 CPM004
     C************IN28     IFEQ '0'                                S01486 CPM004
     C***********SPTFR     ANDNE*BLANK                             S01486 CPM004
     C***********ATYP      ORNE 'R'                                S01486 CPM004
     C***********SPTFR     ANDNE*BLANK                             S01486 CPM004
     C************IN30     ANDNE'1'                                S01486 CPM004
     C***********A5ACTY    ORNE 'R'                                S01486 CPM004
     C***********SPTFR     ANDNE*BLANK                             S01486 CPM004
     C************IN30     ANDEQ'1'                                S01486 CPM004
     C***********          MOVEL*BLANK    SPTFR                    S01486 CPM004
     C***********          MOVEL'RE71116' ZAMSID           SPTFR   S01486 CPM004
     C***********          EXSR ZASNMS                             S01486 CPM004
     C***********          MOVE *ON       *IN45            REVERSE S01486 CPM004
     C***********          MOVEL'E'       ERR              ERROR   S01486 CPM004
     C***********          END                                     S01486 CPM004
      *                                                                   S01486
      ** Validate Portfolio Reference only if module present              S01486
     C           *IN28     IFEQ '1'                                       S01486
      *                                                                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C           *IN38     ANDEQ*OFF                                      CPB001
      *                                                                   CPB001
     C                     MOVE SCNUM     WWCNUM                          178695
     C                     MOVE SCCY      WWCCY                           178695
     C                     MOVE SACOD     WWACOD                          178695
     C                     MOVE SACSQ     WWACSQ                          178695
      *                                                                   178695
     C           SPTFR     IFEQ *BLANKS                                   CPB001
     C           A5ACTY    ANDEQ'R'                                       CPB001
     C**********           MOVELSCNUM     KPCNUM  60                                   CPB001 CSD027
     C                     MOVELSCNUM     KPCNUM  6                                           CSD027
     C                     MOVE 'N'       WWVAL   1                       CPB001
     C           KPCNUM    SETLLPMPORTLL                                  CPB001
     C           KPCNUM    READEPMPORTLL                 89               CPB001
      *                                                                   CPB001
     C           *IN89     DOWEQ*OFF                                      CPB001
     C           WWVAL     ANDEQ'N'                                       CPB001
     C           PNDPCL    IFEQ 0                                         CPB001
     C                     MOVE PNPTFR    WWPTFR  4                       178695
     C           PTFRK     CHAINACCPTFR              80                   178695
      *                                                                   178695
     C           *IN80     IFEQ '0'                                       178695
     C           KPCNUM    READEPMPORTLL                 89               178695
     C                     ELSE                                           178695
     C                     MOVE PNPTFR    SPTFR                           CPB001
     C                     MOVE 'Y'       WWVAL                           CPB001
     C                     ENDIF                                          178695
      *                                                                   178695
     C                     ELSE                                           CPB001
     C           KPCNUM    READEPMPORTLL                 89               CPB001
     C                     ENDIF                                          CPB001
     C                     ENDDO                                          CPB001
      *                                                                   178695
     C           SPTFR     IFEQ *BLANKS                                   178695
     C                     MOVEL'RE71117' ZAMSID                          178695
     C                     EXSR ZASNMS                                    178695
     C                     MOVE '1'       *IN45                           178695
     C                     MOVEL'E'       ERR                             178695
     C                     ENDIF                                          178695
      *                                                                   178695
     C                     ELSE                                           178695
     C                     MOVE SPTFR     WWPTFR                          178695
     C           PTFRK     CHAINACCPTFR              80                   178695
      *                                                                   178695
     C           *IN80     IFEQ '0'                                       178695
     C           DDACTN    ANDEQ'I'                                       178695
     C                     MOVEL'RE71023' ZAMSID                          178695
     C                     EXSR ZASNMS                                    178695
     C                     MOVE '1'       *IN45                           178695
     C                     MOVEL'E'       ERR                             178695
     C                     ENDIF                                          178695
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C           BGPFMG    IFNE 'Y'                                       CPB001
     C           A5ACTY    ANDEQ'R'                                       CPB001
     C           A5INNR    ANDEQ*BLANKS                                   CPB001
     C           SPTFR     ANDNE*BLANKS                                   CPB001
     C                     MOVEL'RE71122' ZAMSID                          CPB001
     C                     EXSR ZASNMS                                    CPB001
     C                     MOVE *ON       *IN45                           CPB001
     C                     MOVEL'E'       ERR                             CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C           BGPFMG    IFNE 'Y'                                       CPB001
     C           SPTFR     ANDNE*BLANKS                                   CPB001
     C**********           MOVELSCNUM     CUST    60                                   CPB001 CSD027
     C                     MOVELSCNUM     CUST    6                                           CSD027
     C                     MOVE SPTFR     PREF    4                       CPB001
     C           POKEY     CHAINPMPORTLL             80                   CPB001
     C           *IN80     IFEQ '1'                                       CPB001
     C                     MOVEL'RE71117' ZAMSID                          CPB001
     C                     EXSR ZASNMS                                    CPB001
     C                     MOVE *ON       *IN45                           CPB001
     C                     MOVEL'E'       ERR                             CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C           PNDPCL    IFNE *ZERO                                     CPB001
     C           FLAG      IFEQ *BLANK                                    CPB001
     C                     MOVE 'Y'       FLAG    1                       CPB001
     C                     MOVEL'RE71118' ZAMSID                          CPB001
     C                     EXSR ZASNMS                                    CPB001
     C                     MOVE *ON       *IN45                           CPB001
     C                     MOVEL'E'       ERR                             CPB001
     C                     ELSE                                           CPB001
     C                     MOVEL' '       ERR                             CPB001
     C                     ENDIF                                          CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C                     ENDIF                                          CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPM004
      ***-*SPTFR*not*entered*if*SCNUM*Portfolio*customer,********* S01486 CPM004
      *****SPTFR*default*to*FCR997******************************** S01486 CPM004
     C***********          CALL 'AOPLCSR0'                         S01486 CPM004
     C***********          PARM *BLANKS   @RTCD                    S01486 CPM004
     C***********          PARM '*KEY   ' @OPTN                    S01486 CPM004
     C***********          PARM SCNUM     @CUSN  10                S01486 CPM004
     C***********SDPLCS    PARM SDPLCS    DSFDY                    S01486 CPM004
     C*                                                                   CPM004
     C/COPY WNCPYSRC,GL3271C061
     C           BGPFMG    IFEQ 'Y'                                       CPB001
     C                     MOVELSCNUM     I#CUST                          CPM004
     C                     MOVELSBRCA     I#BRCA                          CPM004
     C                     MOVELSPTFR     I#PTFR                          CPM004
     C           *IN38     IFEQ *ON                                       CPM004
     C                     MOVEL*BLANKS   I#CPGM                          CPM004
     C                     ELSE                                           CPM004
     C                     MOVEL'GL3271'  I#CPGM                          CPM004
     C                     ENDIF                                          CPM004
     C*                                                                   CPM004
     C                     CALL 'AOPLCSR1'                                CPM004
     C                     PARM *BLANKS   @RTCD   7        B:Return code  CPM004
     C                     PARM '*KEY   ' P@OPTN  7        I:Option       CPM004
     C                     PARM           I@PARM           I:Parameters   CPM004
     C                     PARM *BLANKS   O@PARM           O:Parameters   CPM004
     C           SDPLCS    PARM SDPLCS    DSFDY            O:Format       CPM004
      *                                                                   S01486
     C           @RTCD     IFEQ *BLANK                                    S01486
     C           @RTCD     OREQ 'PMA0010'                                 CPM004
     C           O#PTFR    ANDEQI#R997                                    CPM004
     C*                                                                   CPM004
     C           SPTFR     IFEQ *BLANK                                    S01486
     C           ATYP      ANDEQ'R'                                       S01486
     C           *IN30     ANDNE'1'                                       S01486
     C*                                                                   CPM004
     C           SPTFR     OREQ *BLANK                                    CPM004
     C           ATYP      ANDEQ'N'                                       CPM004
     C           *IN30     ANDNE'1'                                       CPM004
     C           FCPORS    ANDEQ'B'                                       CPM004
     C*                                                                   CPM004
     C           SPTFR     OREQ *BLANK                                    S01486
     C           A5ACTY    ANDEQ'R'                                       S01486
     C           *IN30     ANDEQ'1'                                       S01486
     C*                                                                   CPM004
     C           SPTFR     OREQ *BLANK                                    CPM004
     C           A5ACTY    ANDEQ'N'                                       CPM004
     C           *IN30     ANDEQ'1'                                       CPM004
     C           FCPORS    ANDEQ'B'                                       CPM004
     C*                                                                   CPM004
     C                     MOVE O#PTFR    SPTFR                           CPM004
     C*********************MOVE FCR997    SPTFR                    S01486 CPM004
     C                     END                                            S01486
     C*                                                                   S01486
      **If*PM*customer*and*retail*account,*the*account*code*should 092290 CPM004
      * If PM customer, the account code should have                      CPM004
      * a valid instrument type, if you want to associate a portfolio ref.092290
      * to the account.                                                   092290
     C           A5INNR    IFEQ *BLANKS                                   092290
     C***********A5ACTY    ANDEQ'R'                                092290 CPM004
     C           SPTFR     ANDNE*BLANKS                                   092290
     C***********A5INNR    OREQ *BLANKS                            092290 CPM004
     C***********ATYP      ANDEQ'R'                                092290 CPM004
     C***********SPTFR     ANDNE*BLANKS                            092290 CPM004
     C                     MOVEL'RE71122' ZAMSID                          092290
     C                     EXSR ZASNMS                                    092290
     C                     MOVE *ON       *IN45            REVERSE MODE   092290
     C                     MOVEL'E'       ERR              ERROR INDIC.   092290
     C                     ENDIF                                          092290
     C*                                                                   092290
     C                     END                                            S01486
     C*                                                                   CPM004
     C           @RTCD     IFNE *BLANKS                                   CPM004
     C           *IN38     ANDEQ*OFF                                      CPM004
     C                     MOVELO#PTFR    SPTFR                           CPM004
     C                     MOVE *ON       *IN36                           CPM004
     C                     MOVE *ON       *IN45                           CPM004
     C                     MOVEL'E'       ERR                             CPM004
     C                     ENDIF                                          CPM004
     C*                                                                   S01486
      *                                                                   183656
      ** Validate Portfolio Reference only if module present              183656
      ** and this is a portfolio customer                                 183656
      *                                                                   183656
     C           *IN28     IFEQ *ON                                       183656
     C           *IN38     ANDEQ*OFF                                      183656
      *                                                                   183656
      *  - When SPTFR entered                                             S01486
      *  - - SPTFR must be live on PMPORTPD                               S01486
     C           SPTFR     IFNE *BLANK                                    S01486
     C           SPTFR     ANDNEFCR997                                    S01486
     C           SPTFR     OREQ FCR997                                    CPB001
     C*********************MOVE SCNUM     CUST    60               S01486 CPM004
     C**********           MOVELQBCUST    CUST    60                                   CPM004 CSD027
     C                     MOVELQBCUST    CUST    6                                           CSD027
     C                     MOVE SPTFR     PREF    4                       S01486
     C***********POKEY     CHAINPMPORTLL             86            S01486 CRE001
     C************IN86     IFEQ '1'                                S01486 CRE001
     C           POKEY     CHAINPMPORTLL             80                   CRE001
     C           *IN80     IFEQ '1'                                       CRE001
     C                     MOVEL'RE71117' ZAMSID           SPTFR FALSE    S01486
     C                     EXSR ZASNMS                                    S01486
     C                     MOVE *ON       *IN45            REVERSE MODE   S01486
     C                     MOVEL'E'       ERR              ERROR INDIC.   S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C           PNDPCL    IFNE *ZERO                                     S01486
     C           FLAG      IFEQ *BLANK                                    S01486
     C                     MOVE 'Y'       FLAG    1                       S01486
     C                     MOVEL'RE71118' ZAMSID           SPTFR FALSE    S01486
     C                     EXSR ZASNMS                                    S01486
     C                     MOVE *ON       *IN45            REVERSE MODE   S01486
     C                     MOVEL'E'       ERR              ERROR INDIC.   S01486
     C                     ELSE                                           S01486
     C                     MOVEL' '       ERR                             S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C/COPY WNCPYSRC,GL3271C186
     C                     END                                            S01486
      *                                                                   S01486
     C/COPY WNCPYSRC,GL3271C170
     C           DDACTN    IFEQ 'A'                                       178695
     C           SPTFR     ANDNESWPTFR                                    178695
     C           BGN4ST    ANDEQ'Y'                                       178695
     C           BBPRBA    ANDEQ'Y'                                       178695
     C           *IN45     ANDEQ'0'                                       178695
     C                     MOVE '1'       *IN45                           178695
     C                     MOVEL'E'       ERR                             178695
     C                     MOVEL'RE71024' ZAMSID                          178695
     C                     EXSR ZASNMS                                    178695
     C                     ENDIF                                          178695
      *                                                                   S01486
      ** Error if current Portfolio Reference refers to a Portfolio       S01486
      ** for which performance already started.                           S01486
     C           DDACTN    IFEQ 'A'                                       S01486
     C           SPTFR     ANDNEWSPTFR                                    S01486
     C           WSPTFR    ANDNEFCR997                                    S01486
     C           WSPSDT    ANDLTBJRDNB                                    S01486
     C           WSPSDT    ANDNE0                                         S01486
     C           *IN45     ANDEQ'0'                                       S01486
     C                     MOVEL'RE71872' ZAMSID                          S01486
     C                     EXSR ZASNMS                                    S01486
     C                     MOVE *ON       *IN45                           S01486
     C                     MOVEL'E'       ERR                             S01486
     C                     END                                            S01486
      *                                                                   S01486
      ** Error if new Portfolio Reference entered refers to a Portfolio   S01486
      ** for which performance already started                            S01486
     C           DDACTN    IFEQ 'A'                                       S01486
     C           SPTFR     ANDNEWSPTFR                                    S01486
     C           SPTFR     ANDNEFCR997                                    S01486
     C           PNPSDT    ANDLTBJRDNB                                    S01486
     C           *IN45     ANDEQ'0'                                       S01486
     C                     MOVEL'RE71873' ZAMSID                          S01486
     C                     EXSR ZASNMS                                    S01486
     C                     MOVE *ON       *IN45                           S01486
     C                     MOVEL'E'       ERR                             S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C                     ENDIF                                          CPB001
     C*                                                                   095242
     C                     END                                            183656
      *                                                                   183656
     C           BGLMCR    IFEQ 'Y'                                       095242
     C*                                                                   095242
     C** Check if a Portfolio Lending Customer                            095242
     C*                                                                   095242
     C                     CALL 'AOLBCSR0'                                095242
     C                     PARM *BLANKS   @RTCD                           095242
     C                     PARM '*KEY   ' @OPTN                           095242
     C                     PARM SCNUM     @CUSN  10                       095242
     C           SDLBCS    PARM SDLBCS    DSFDY                           095242
     C*                                                                   095242
     C           @RTCD     IFEQ *BLANK                                    095242
     C*                                                                   095242
     C** If LB customer and retail account, the account code should       095242
     C** have a valid instrument type                                     095242
     C*                                                                   095242
     C           A5INNR    IFEQ *BLANKS                                   095242
     C           A5ACTY    ANDEQ'R'                                       095242
     C           A5INNR    OREQ *BLANKS                                   095242
     C           ATYP      ANDEQ'R'                                       095242
     C                     MOVEL'RE71122' ZAMSID                          095242
     C                     EXSR ZASNMS                                    095242
     C                     MOVE *ON       *IN45                           095242
     C                     MOVEL'E'       ERR                             095242
     C                     ENDIF                                          095242
     C*                                                                   095242
     C                     END                                            095242
     C                     END                                            095242
      *                                                                   CFT004
      *** If CFT004 is switched on                                        CFT004
      *                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
      *                                                                   CFT004
      *** Retrieve branch detail                                          CFT004
      *                                                                   CFT004
     C                     CALL 'AOBRCHR1'                                CFT004
     C                     PARM '*MSG   ' @RTCD                           CFT004
     C                     PARM '*KEY   ' @OPTN                           CFT004
     C                     PARM SBRCA     @BRCA   3                       CFT004
     C           SDBRCH    PARM SDBRCH    DSSDY                           CFT004
      *                                                                   CFT004
     C           @RTCD     IFNE *BLANK                                    CFT004
     C                     Z-ADD60        DBASE            ************** CFT004
     C                     MOVEL'SDBRCHPD'DBFILE           * DB ERROR 60* CFT004
     C                     MOVELSBRCA     DBKEY            ************** CFT004
     C                     EXSR *PSSR                                     CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      *** If IBAN generation method is blank, IBAN field must be blank    CFT004
      *                                                                   CFT004
     C           A8GENM    IFEQ *BLANKS                                   CFT004
     C           SIBAN     IFNE *BLANKS                                   CFT004
     C                     MOVEL'RE72025' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      *** If IBAN generation method is not equal to 1 and not blank,      CFT004
      *** IBAN field must be blank as system will generate IBAN           CFT004
      *                                                                   CFT004
     C           A8GENM    IFNE '1'                                       CFT004
     C           A8GENM    ANDNE*BLANKS                                   CFT004
      *                                                                   CFT004
     C           SIBAN     IFNE *BLANKS                                   CFT004
     C           DDACTN    IFEQ 'I'                                       CFT004
     C                     MOVEL'RE72020' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
     C                     ELSE                                           CFT004
     C           @IWITH    IFNE SIBAN                                     CFT004
     C                     MOVEL'RE72034' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
     C                     ELSE                                           CFT004
     C*                                                                   CFT004
     C***If*action*code is not Insert, need to set screen field to                     CFT004 198593
     C***the*version*of the IBAN without blanks.                                       CFT004 198593
     C**********                                                                       CFT004 198593
     C**********           MOVEL@INOBL    SIBAN                                        CFT004 198593
     C                     END                                            CFT004
     C                     END                                            CFT004
      *                                                                   CFT004
     C                     ELSE                                           CFT004
      *                                                                   CFT004
     C/COPY WNCPYSRC,GL3271C226
     C                     MOVEL*BLANKS   ACNT                            CFT004
     C                     MOVELSCNUM     S4CNUM                          CFT004
     C                     MOVELSCCY      S4CCY                           CFT004
     C                     MOVELSACOD     S4ACOD                          CFT004
     C                     MOVELSACSQ     S4ACSQ                          CFT004
     C                     MOVELSBRCA     S4BRCA                          CFT004
     C                     MOVELATYP      S4ATYP                          CFT004
     C                     MOVELSACNO     S4ACNO                          CFT004
     C                     MOVEL*BLANKS   S4IBAN                          CFT004
     C                     MOVEL*BLANKS   S4IBSQ                          CFT004
      *                                                                   CFT004
     C                     CALL 'AOIBANR6'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C           ACNT      PARM ACNT      DSSDY                           CFT004
      *                                                                   CFT004
     C                     SELEC                                          CFT004
      *                                                                   CFT004
      *** Maximum no. of unique IBAN sequences has been reached, error    CFT004
      *                                                                   CFT004
     C           @RTCD     WHEQ '*NOMORE'                                 CFT004
     C                     MOVEL'RE72021' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
      *                                                                   CFT004
     C           @RTCD     WHEQ '*GENMTH'                                 CFT004
      *                                                                   CFT004
      ** This is not an error for method 2, as do not generate IBANs      CFT004
      ** for General Ledger accounts.                                     CFT004
      *                                                                   CFT004
     C           A8GENM    IFNE '2'                                       CFT004
     C                     MOVEL'RE72028' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C           ERR       IFEQ *BLANKS                                   CFT004
     C                     MOVEL'W'       ERR                             CFT004
     C                     END                                            CFT004
     C                     END                                            CFT004
      *                                                                   CFT004
     C           @RTCD     WHEQ '*UNIQUE'                                 CFT004
     C                     MOVEL'RE72029' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
      *                                                                   CFT004
     C           @RTCD     WHEQ *BLANKS                                   CFT004
     C                     MOVELS4IBAN    SIBAN                           CFT004
     C                     MOVELS4IBSQ    SIBSQ                           CFT004
      *                                                                   CFT004
     C                     OTHER                                          CFT004
     C                     Z-ADD62        DBASE            ************** CFT004
     C                     MOVEL'AOIBANR6'DBFILE           * DB ERROR 62* CFT004
     C                     MOVELACNT      DBKEY            ************** CFT004
     C                     EXSR *PSSR                                     CFT004
     C                     ENDSL                                          CFT004
     C/COPY WNCPYSRC,GL3271C227
      *                                                                   CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      *** If IBAN generation method is equal to 1, validate IBAN field    CFT004
      *                                                                   CFT004
     C           A8GENM    IFEQ '1'                                       CFT004
      *                                                                   CFT004
      ****IBAN*field*is*mandatory********************************* CFT004 193178
      *** IBAN field should be input for retail accounts                  193178
      *                                                                   CFT004
     C           SIBAN     IFEQ *BLANKS                                   CFT004
     C/COPY WNCPYSRC,GL3271C266
     C           ATYP      IFEQ 'R'                                       193178
     C                     MOVEL'RE72022' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C***********          MOVEL'E'       ERR                      CFT004 193178
     C           ERR       IFEQ *BLANKS                                   193178
     C                     MOVEL'W'       ERR                             193178
     C                     END                                            193178
     C                     END                                            193178
     C/COPY WNCPYSRC,GL3271C267
      *                                                                   CFT004
     C                     ELSE                                           CFT004
      *                                                                   CFT004
      *** Call AOIBANR3 to remove any blanks in IBAN                      CFT004
      *                                                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM SIBAN     @IBAN  47                       CFT004
     C                     PARM           @IWITH 47                       CFT004
     C                     PARM           @INOBL 34                       CFT004
      *                                                                   CFT004
     C           @RTCD     IFNE *BLANKS                                   CFT004
     C                     MOVEL'RE72030' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
     C                     ELSE                                           CFT004
      ** Account canot be amended if incoming funds transfer records      183052
      ** exist  (CFT004 must be on)                                       183052
     C           IBAN      CHAININPAYIB              80                   183052
     C           *IN80     IFEQ *OFF                                      183052
     C           @INOBL    ANDNEIBAN                                      183052
     C           DDACTN    ANDEQ'A'                                       183052
     C                     MOVEL'RE72026' ZAMSID                          183052
     C                     EXSR ZASNMS                                    183052
     C                     MOVE *ON       *IN51                           183052
     C                     MOVE 'E'       ERR                             183052
     C                     MOVE *ON       *IN02                           183052
     C                     ELSE                                           183052
      *                                                                   CFT004
      *** Call AOIBANR7, match ISO country code entered with the ISO      CFT004
      *** country code returned                                           CFT004
      *                                                                   CFT004
     C                     CALL 'AOIBANR7'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM SBRCA     @BRCH   3                       CFT004
     C                     PARM           @ISOC   2                       CFT004
      *                                                                   CFT004
     C           @RTCD     IFNE *BLANK                                    CFT004
     C                     Z-ADD61        DBASE            ************** CFT004
     C                     MOVEL'AOIBANR7'DBFILE           * DB ERROR 61* CFT004
     C                     MOVELSBRCA     DBKEY            ************** CFT004
     C                     EXSR *PSSR                                     CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C           2         SUBST@INOBL:1  ISO     2                       CFT004
      *                                                                   CFT004
     C           @ISOC     IFNE ISO                                       CFT004
     C                     MOVEL'RE72023' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
      *                                                                   CFT004
     C                     ELSE                                           CFT004
      *                                                                   CFT004
      *** Retrieve IBAN country details                                   CFT004
      *                                                                   CFT004
     C           ISO       CHAINSDCTRYL2             80                   CFT004
      *                                                                   CFT004
      *** Total length of the IBAN entered must be equal to the BBAN      CFT004
      *** length plus 4 characters                                        CFT004
      *                                                                   CFT004
     C           A4BBAN    ADD  4         TOTBBN  20                      CFT004
     C           ' '       CHEKR@INOBL    IBNLGT  20                      CFT004
      *                                                                   CFT004
     C           TOTBBN    IFNE IBNLGT                                    CFT004
     C                     MOVEL'RE72033' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
      *                                                                   CFT004
     C                     ELSE                                           CFT004
      *                                                                   CFT004
      *** Call AOIBANR0 to validate the IBAN check digits                 CFT004
      *                                                                   CFT004
     C                     CALL 'AOIBANR0'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM 'V'       IACTN   1                       CFT004
     C                     PARM ISO       ICNTY   2                       CFT004
     C                     PARM @INOBL    IIBANP 34                       CFT004
     C                     PARM           OBBAN  30                       CFT004
     C                     PARM           OIBAN  34                       CFT004
     C                     PARM           OCKDG   2                       CFT004
      *                                                                   CFT004
     C           @RTCD     IFNE *BLANK                                    CFT004
     C                     MOVEL'RE72031' ZAMSID                          CFT004
     C***********          MOVELOCKDG     OCKDG0  20                                   CFT004 193106
     C***********          Z-ADDOCKDG0    ZA0003                                       CFT004 193106
     C                     MOVELOCKDG     ZA0003                                              193106
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
      *                                                                   CFT004
     C                     ELSE                                           CFT004
      *                                                                   CFT004
      *** If BBAN bank/branch length is not 0, then the fifth to          CFT004
      *** position (5 + BBAN branch/bank length) must equal the IBAN ID   CFT004
      *                                                                   CFT004
     C           A4BBRL    IFNE 0                                         CFT004
     C           A4BBRL    SUBST@INOBL:5  IBANID 10                       CFT004
      *                                                                   CFT004
     C           IBANID    IFNE A8IBID                                    CFT004
     C                     MOVEL'RE72032' ZAMSID                          CFT004
     C                     MOVELA8IBID    ZA0004                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
      *                                                                   CFT004
     C                     ELSE                                           CFT004
      *                                                                   CFT004
      *** IBAN must be unique                                             CFT004
      *                                                                   CFT004
     C           @INOBL    CHAINACCNT6               80                   CFT004
      *                                                                   CFT004
     C           *IN80     IFEQ *OFF                                      CFT004
     C**********           MOVE SCNUM     S5CNUM  60                                   CFT004 CSD027
     C                     MOVE SCNUM     S5CNUM  6                                           CSD027
     C**********           MOVE SACOD     S5ACOD  40                                   CFT004 CGL029
     C                     MOVE SACOD     S5ACOD 100                                          CGL029
     C                     MOVE SACSQ     S5ACSQ  20                      CFT004
     C                     MOVE SACNO     S5ACNO 100                      CFT004
      *                                                                   CFT004
     C           S5CNUM    IFNE CNUM                                      CFT004
     C           SCCY      ORNE CCY                                       CFT004
     C           S5ACOD    ORNE ACOD                                      CFT004
     C           S5ACSQ    ORNE ACSQ                                      CFT004
     C           SBRCA     ORNE BRCA                                      CFT004
     C           S5ACNO    ORNE ACNO                                      CFT004
     C                     MOVEL'RE72024' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     MOVE 'AAA'     SIBSQ                           CFT004
     C                     MOVEL@INOBL    SIBAN                           CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ELSE                                           CFT004
      *                                                                   CFT004
      *** IBAN must be unique                                             CFT004
      *                                                                   CFT004
     C           @INOBL    CHAINACCNT6               80                   CFT004
      *                                                                   CFT004
     C           *IN80     IFEQ *OFF                                      CFT004
     C**********           MOVE SCNUM     S5CNUM  60                                   CFT004 CSD027
     C                     MOVE SCNUM     S5CNUM  6                                           CSD027
     C**********           MOVE SACOD     S5ACOD  40                                   CFT004 CGL029
     C                     MOVE SACOD     S5ACOD                                              CGL029
     C                     MOVE SACSQ     S5ACSQ  20                      CFT004
     C                     MOVE SACNO     S5ACNO 100                      CFT004
      *                                                                   CFT004
     C           S5CNUM    IFNE CNUM                                      CFT004
     C           SCCY      ORNE CCY                                       CFT004
     C           S5ACOD    ORNE ACOD                                      CFT004
     C           S5ACSQ    ORNE ACSQ                                      CFT004
     C           SBRCA     ORNE BRCA                                      CFT004
     C           S5ACNO    ORNE ACNO                                      CFT004
     C                     MOVEL'RE72024' ZAMSID                          CFT004
     C                     EXSR ZASNMS                                    CFT004
     C                     MOVE *ON       *IN02                           CFT004
     C                     MOVEL'E'       ERR                             CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ENDIF                                          CFT004
     C                     MOVEL@INOBL    SIBAN                           CFT004
     C                     MOVE 'AAA'     SIBSQ                           CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          183052
     C*
     C** IF NO ERRORS VALIDATE WORK FIELDS
     C           ERR       IFEQ *BLANK
     C*
     C** IN INSERT MODE ONLY
     C           *IN30     IFEQ '1'
     C                     Z-ADDWWDACO    SSDACO
     C* Set control date limit for rate value date
     C                     Z-ADDWWDACO    WWVDRC  50
     C                     Z-ADDWWDACO    WWVCRC  50
     C                     Z-ADDWWDACO    SWVDRC  50
     C                     Z-ADDWWDACO    SWVCRC  50
     C                     END
     C*
     C                     MOVELSANAM     SSANAM
     C                     Z-ADDWWNSTD    SSNSTD
     C                     MOVELSSTFQ     SSSTFQ
     C                     MOVELSNSDN     SSSTDY
     C                     MOVELSPRFC     SSPRFC
     C                     MOVELSREF      SSREF
     C                     MOVE SREF      SSREF
     C                     MOVE SENOC     SSENOC
     C*                                                                   CTI001
     C** If Midas/TI Interface is on then reset TI fields:                CTI001
     C*                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C                     MOVE STIAC     SSTIAC                          CTI001
     C                     MOVE STIAN     SSTIAN                          CTI001
     C                     MOVE STIAS     SSTIAS                          CTI001
     C                     ENDIF                                          CTI001
     C**
     C           SPTAD     IFEQ 'Y'
     C                     BITON'2'       SSGLBT
     C                     ELSE
     C                     BITOF'2'       SSGLBT
     C                     END
     C**
     C           SRAD      IFEQ 'Y'
     C                     BITON'0'       SSRETB
     C                     ELSE
     C                     BITOF'0'       SSRETB
     C                     END
     C**
     C           SRAC      IFEQ 'Y'
     C                     BITON'1'       SSRETB
     C                     ELSE
     C                     BITOF'1'       SSRETB
     C                     END
     C**
     C           SBAD      IFEQ 'Y'
     C                     BITON'2'       SSRETB
     C                     ELSE
     C                     BITOF'2'       SSRETB
     C                     END
     C**
     C           SBAC      IFEQ 'Y'
     C                     BITON'3'       SSRETB
     C                     ELSE
     C                     BITOF'3'       SSRETB
     C                     END
     C**
     C                     MOVE SMFFQ     SSMFFQ
     C*
     C           SPTFR     IFEQ FCR997                                    S01486
     C           I#PORS    ANDNE'B'                                       104058
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C/COPY WNCPYSRC,GL3271C074
     C           I#PORS    OREQ 'B'                                       104058
     C           SPTFR     ANDNE*BLANKS                                   104058
     C           SPTFR     ANDEQFCR997                                    104058
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C/COPY WNCPYSRC,GL3271C075
     C                     MOVE '9997'    SSPTFR                          S01486
     C                     ELSE                                           S01486
     C                     MOVE SPTFR     SSPTFR                          S01486
     C                     END                                            S01486
     C                     END
     C*
     C                     ENDSR                           ** #V10F1 ESR *
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10F2   - PROCESS DEBIT INTEREST DETAILS                        *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #P1032   - TRANSFER WORK FIELDS IN SCREEN FIELDS(2ND FORMAT)     *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      * #V10F2   - PROCESS VALIDATION OF 'F2' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      * WWACTN   - ACTION CODE                                           *
      *                                                                  *
      ********************************************************************
     C           #P10F2    BEGSR                           * #P10F2 BGSR *
     C*
     C/COPY WNCPYSRC,GL3271C195
     C**  Set start screen indicator
     C                     MOVE ' '       ERR     1
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVEA'000'     *IN,75                          CRE001
     C                     MOVE '0'       *IN86                           CRE001
     C                     MOVELSSANAM    SANAM
     C/COPY WNCPYSRC,GL3271C027
     C*
     C**  CLEAR WHOLE SCREEN
     C                     WRITEGL3271FC
     C**
     C           WFMT      DOUNE'F2'                       -B1
     C**
     C           WIND#2    TAG
     C                     WRITEGL3271C1
     C                     EXFMTGL3271F2
     C                     MOVEL*BLANK    ERR
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVEA'000'     *IN,75                          CRE001
     C                     MOVE '0'       *IN86                           CRE001
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C                     END
     C*
     C**  F3 PRESSED - EXIT OF PROGRAM
     C           *INKC     IFEQ '1'                        -B2
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C236
     C                     END                             -E2
     C*
     C**  F12 PRESSED - PREVIOUS SCREEN
     C           *INKL     IFEQ '1'                        -B2
     C                     MOVELWWRTRN    WFMT
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP45                                           S01408
      *                                                                   S01408
     C                     END                             -E2
     C*
     C**  F5 PRESSED - REFRESH
     C           *INKE     IFEQ '1'                        -B2
     C** ENQUIRY F5 NOT ALLOWED
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C** AMEND RETURN TO FIRST SCREEN
     C           *IN31     IFEQ '1'
     C           *IN30     OREQ '1'
     C                     EXSR #P1032
     C                     END                             -E3
     C/COPY WNCPYSRC,GL3271C028
     C                     END                             -E2
     C**  F9 PRESSED - REFRESH  ALL
     C           *INKI     IFEQ '1'                        -B2
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C**
     C           *IN30     IFEQ '1'                        -B3
     C                     MOVEL'FK'      WFMT
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       *IN69
     C                     END                             -E3
     C**
     C           *IN31     IFEQ '1'
     C                     EXSR #P1030
     C           WWACTN    IFEQ 'A'
     C           WWACTN    OREQ 'E'
     C                     MOVEL'F1'      WFMT
     C                     ELSE
     C                     MOVEL'F1'      WFMT
     C                     MOVE WWACTN    WFMT
     C                     END
     C                     END                             -E3
     C                     END                             -E2
     C*
     C**  F8 PRESSED - FROM ENQUIRY TO AMEND MODE
     C           *INKH     IFEQ '1'                        -B2
     C* IF MULTIBRANCHING DO VALIDATION ON BRANCH INPUT                   097616
     C           BJSBRC    IFEQ *BLANKS                                   097616
     C                     MOVEL'A'       @ZACTN                          097616
     C                     MOVELSBRCA     @BRCA                           097616
     C                     EXSR #AUTH                                     097616
     C           @ERR      IFNE 0                                         097616
     C                     MOVEL'RE7103B' ZAMSID                          097616
     C                     EXSR ZASNMS                                    097616
     C                     MOVEL'E'       ERR                             097616
     C                     END                                            097616
     C                     END                                            097616
     C*
     C**  USER MUST BE AUTHORISED AND ACTION MODE IS ENQUIRY
     C           *IN41     IFEQ '1'                        -B3
     C           *IN32     ANDEQ'1'
     C           ERR       ANDEQ*BLANKS                                   097616
     C           *IN39     IFEQ '0'
     C*
     C**  UNPROTECT FIELDS AND REDISPLAY
     C                     MOVEA'0100'    *IN,30
     C                     MOVE 'A'       DDACTN
     C                     ELSE                            -X3
     C*
     C** ERROR MESSAGE
     C                     MOVEL'RE71003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ROLLDOWN PRESSED - VALIDATION AND PREVIOUS SCREEN
     C           *IN26     IFEQ '1'                        -B2
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F2
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
     C                     MOVEL'F1'      WFMT
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ROLLUP          PRESSED - VALIDATION AND NEXT SCREEN
     C           *IN25     IFEQ '1'                        -B2
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F2
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
      * WINDOW PROCESSING
      *
     C/COPY WNCPYSRC,GL3271C184
     C           BGWDPR    IFEQ 'Y'
     C/COPY WNCPYSRC,GL3271C013
      *    /copy to move data into the data structure fields passed
      *     as a parameter to the window controller
      /COPY QWINDSRC,GL3271MOV1
     C/COPY WNCPYSRC,GL3271C053
      *
     C                     MOVE *BLANKS   #PGM
     C                     MOVEL'GL3271#2'#PGM
      *
     C                     MOVE A5ACTY    #1ATYP
     C                     CALL 'WN0010'
     C                     PARM           #PGM   10
     C                     PARM           FKEY    2
     C                     PARM DDACTN    ACTION  1
     C                     PARM           DATA
     C                     PARM *BLANKS   #RTRN   7
     C                     PARM           SPARE 256
     C/COPY WNCPYSRC,GL3271C201
     C*
     C           #RTRN     IFEQ 'USR0790'
     C                     CALL 'SNDERMSG'
     C                     PARM 'GL3271  'ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM 'WND0001' ZAMSID  7        Message Id.
     C                     PARM 'MIDAS  ' ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
     C                     WRITEGL3271C1
      * Clear all fields
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C                     MOVE ' '       ERR     1
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVELSSANAM    SANAM
     C                     GOTO WIND#2
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP10                                           S01408
     C*                                                                   S01408
     C                     END
      *-------------------------------------------------------------------
     C/COPY WNCPYSRC,GL3271C185
     C           *IN32     IFEQ '1'
     C           WWACTN    ANDEQ'2'
     C           *IN49     ANDEQ'0'
     C                     MOVELWWRTRN    WFMT
     C                     ELSE
     C                     MOVEL'F3'      WFMT
     C                     END                             -E3
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ENTER    PRESSED - VALIDATION AND CORRECT  SCREEN
     C           *IN49     IFEQ '0'                        -B2
     C/COPY WNCPYSRC,GL3271C014
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F2
     C                     END                             -E3
     C           ERR       IFEQ ' '                        -B3
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP26                                           S01408
     C*                                                                   S01408
     C           *IN30     IFEQ '1'                        -B4
     C           WWACTN    OREQ 'A'
     C           WWACTN    OREQ 'E'
     C                     MOVEL'F3'      WFMT
     C                     END                             -E4
     C           *IN31     IFEQ '1'                        -B4
     C           WWACTN    ANDNE'A'
     C                     MOVEL'UP'      WFMT
     C                     END                             -E4
     C           *IN32     IFEQ '1'                        -B4
     C           WWACTN    ANDNE'E'
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C119                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD                            S01522
     C                     PARM 'E'       ACTN                            S01522
     C                     PARM ACKEY     ACCD                            S01522
     C                     END                                            S01522
      *                                                                   CGL004
      ** If Midas-Fontis Interface is switched on, call program to        CGL004
      ** display Fontis account details.                                  CGL004
     C/COPY WNCPYSRC,GL3271C207
      *                                                                   CGL004
     C           *IN29     IFEQ '1'                                       CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     CALL 'GLC2800'                                 CGL004
     C                     PARM *BLANK    RTCD                            CGL004
     C                     PARM ACKEY     ACCD                            CGL004
     C                     PARM 'E'       ACTN                            CGL004
     C                     ENDIF                                          CGL004
     C                     ENDIF                                          CGL004
     C/COPY WNCPYSRC,GL3271C208
      *                                                                   CGL004
     C                     MOVELWWRTRN    WFMT
     C                     END                             -E4
     C                     END                             -E3
     C*
     C                     END                             -E2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP28                                           S01408
     C*                                                                   S01408
     C*
     C                     END                             -E1
     C*
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP23                                           S01408
     C*                                                                   S01408
     C                     ENDSR                           * #P10F2 EDSR *
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10F2   - PROCESS VALIDATION OF 'F2' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZALIGN   - TO VALIDATE A NUMERIC FIELD                           *
      * ZDATE1   - TO FORMAT AN ALPHA DATE IN MIDAS NUMBER               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F2   - PROCESS DEBIT INTEREST DETAILS                        *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRIB    - WORK FIELD                                            *
      * WWDYNB   - DAY NUMBER                                            *
      * WWNDID   - DEBIT INTEREST DATE                                   *
      * WWACK2   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWRKEY   - RETAIL NUMBER KEY                                     *
      * WWCUSK   - CUSTOMER NUMBER KEY                                   *
      * WWCCYK   - CURRENCY CODE KEY                                     *
      * WWACOK   - ACCOUNT CODE KEY                                      *
      * WWACSK   - ACCOUNT SEQUENCE KEY                                  *
      * WWDECS   - NUMBER OF DECIMALS                                    *
      *                                                                  *
      ********************************************************************
     C           #V10F2    BEGSR
     C*
      *                                                                   174144
      ** Save RECI status and restore it at the end of the routine,       174144
      ** to prevent RECI being overwritten.                               174144
      *                                                                   174144
     C                     MOVELRECI      RECISV  1                       174144
      *                                                                   174144
     C                     MOVE '0'       *IN36
     C                     Z-ADD*ZEROS    WWDBRT                          077012
      *                                                                   174144
     C********************************************************************
     C*                             PART 1
     C********************************************************************
     C                     MOVE SDRCD     #DRCD   6                       053943
     C                     Z-ADDSWVDRC    WWVDRC  50
     C                     MOVE *BLANKS   WWRIB
     C           SDRIB     IFNE *BLANKS                    IF01
     C           SDICT     IFNE *BLANKS                    IF02
     C           SDCST     ORNE *BLANKS
     C*
     C*200-DEBIT INTEREST CALCULATION MUST BE NOT BLANK IF SDRIB IS ENTRY
     C*
     C                     MOVEL'RE71216' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            EL02
     C*
     C                     MOVE SDRIB     WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD   3
     C                     PARM WWRIB     @BSRC   2
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFNE *BLANKS                    IF03
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C*201-DEBIT BASE RATE DOESN'T EXIST IN FILE TABLE
     C*
     C                     MOVEL'RE71201' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE
     C                     MOVE BABSRC    SDRIB                           073234
      *                                                                   073234
      * Check currency                                                    073234
     C           BACYCD    IFNE WWCCY                                     073234
     C                     MOVEL'RE71300' ZAMSID                          073234
     C                     EXSR ZASNMS                                    073234
     C                     MOVE '1'       *IN60                           073234
     C                     MOVE 'E'       ERR                             073234
     C                     ELSE                                           073234
      *                                                                   073234
     C                     Z-ADDBANBRT    WWDBRT
     C* Set control date limit for rate value date
     C           BAVDRC    IFGT WWVDRC
     C                     Z-ADDBAVDRC    WWVDRC  50
     C                     END                             EN03
     C                     END                                            073234
     C                     END                             EN03
     C                     END                             EN02
     C  N60                MOVE SDRIB     SSDRIB
     C                     ELSE
     C                     Z-ADD*ZEROS    SSDRIB
     C                     END                             EN01
     C********************************************************************
     C*                             PART 2
     C********************************************************************
     C           SDRIS     IFNE *BLANKS                    IF01
     C           SDSIG     ORNE *BLANKS
     C           SDICT     IFNE *BLANKS                    IF02
     C           SDCST     ORNE *BLANKS
     C*
     C*202-DEBIT INTEREST CALCULATION MUST BE NOT BLANK IF SDRIS IS ENTRY
     C*
     C                     MOVEL'RE71202' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            EL02
     C*
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SDRIS     ZFIELD
     C                     Z-ADD4         ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        IF03
     C*
     C*203-DEBIT RATE/SPREAD HAS NOT A GOOD FORMAT (DECIMAL & DIGIT)
     C*
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN03
     C  N61                MOVE ZFIELD    SSDRIS
     C                     END                             EN02
     C                     ELSE
     C                     Z-ADD*ZEROS    SSDRIS
     C                     END                             EN01
     C********************************************************************
     C*                             PART 3
     C********************************************************************
     C           SDSIG     IFNE *BLANK                     IF01
     C           SDSIG     IFNE '+'                        IF02
     C           SDSIG     ANDNE'-'
     C*
     C*204-SDRIS MUST BE '+' OR '-'
     C*
     C                     MOVEL'RE71204' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN03
     C*
     C           SDRIS     IFEQ *BLANKS                    IF03
     C*
     C*205-SDRIS MUST BE NOT BLANK OR SDICT MUST BE BLANK IF SDSIG IS ENTR
     C*
     C                     MOVEL'RE71205' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN03
     C*
     C                     ELSE                            EL01
     C*
     C           SDRIS     IFNE *BLANK
     C                     MOVE '+'       SDSIG
     C                     END
     C*
     C                     END                             EN01
     C*
     C           SDSIG     IFEQ '-'
     C           SSDRIS    ANDNE*ZEROS
     C                     Z-SUBSSDRIS    SSDRIS
     C                     END
     C********************************************************************
     C*                         PART 4 & PART 5
     C********************************************************************
      **   INTEREST CALCULATION TYPE & INTEREST CALCULATION SUB-TYPE
     C           SDICT     IFNE *BLANKS
     C           SDCST     ORNE *BLANKS
     C/COPY WNCPYSRC,GL3271C137
      *       NOT ALLOWED IF BASE RATE TYPE IS NO BLANKS
     C           SDRIB     IFNE *BLANKS
     C                     MOVEL'RE71216' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     END
      *       NOT ALLOWED IF RATE/SPREAD IS NO BLANKS
     C           SDRIS     IFNE *BLANKS
     C           SDSIG     ORNE *BLANKS
     C                     MOVEL'RE71206' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     END
      *       MANDATORY IF INTEREST CALC. TYPE IS ENTERED.
     C           SDCST     IFEQ *BLANKS
     C                     MOVEL'RE71207' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C112                                           S01408
      *                                                                   S01408
      *       MUST BE VALID ON FILE.
     C                     MOVE SDICT     TYPE
     C                     MOVE SDCST     SBTYPE
     C                     MOVE SCCY      CURR    3
     C                     MOVE 'D'       D
     C           KEY       CHAINREINT                50
     C           *IN50     IFEQ '1'
     C                     MOVEL'RE71208' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     ELSE                            EN03
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C114                                           S01408
      *                                                                   S01408
     C* Set control date limit for rate value date
     C           VDTC      IFGT WWVDRC
     C                     Z-ADDVDTC      WWVDRC
     C                     END                             EN03
     C           BRT       IFNE 0
     C                     MOVE BRT       WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFEQ *BLANKS                    IF03
     C           BAVDRC    IFGT WWVDRC
     C                     Z-ADDBAVDRC    WWVDRC  50
     C                     END                             EN03
     C                     Z-ADDBANBRT    WWDBRT 117
     C                     END
     C                     END                             EN03
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C113                                           S01408
      *                                                                   S01408
     C                     END
     C  N63                MOVE SDICT     SSDICT
     C  N63                MOVE SDCST     SSDCST
     C********************************************************************
     C*                             PART 6
     C********************************************************************
     C           SDRIB     IFEQ SADRIB                     BEG01
     C           SDRIS     ANDEQSADRIS
     C           SDICT     ANDEQSADICT
     C           SDSIG     ANDEQSADSIG
     C           SDCST     ANDEQSADCST
      *       MUST NOT BE ENTERED IF NO INTEREST DETAILS AMENDED
     C           SDRCD     IFNE *BLANKS                    - B2
     C                     MOVEL'RE71209' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
      *
     C                     ELSE                            X--01
     C           SDRIB     IFNE SADRIB
     C           SDRIS     ORNE SADRIS
     C           SDICT     ORNE SADICT
     C           SDSIG     ORNE SADSIG
     C           SDCST     ORNE SADCST
      ********ELSE*MANDATORY                                              053943
      *       IF DATE IS NOT ENTERED CHECK ACTION                         053943
      *       IF ACTION CODE IS INSERT, USE SDACO FOR SDRCD               053943
     C           SDRCD     IFEQ *BLANKS                                   053943
     C/COPY WNCPYSRC,GL3271C171
     C           DDACTN    IFEQ 'I'                                       053943
     C                     MOVE SDACO     SDRCD                           053943
     C/COPY WNCPYSRC,GL3271C058
     C                     MOVE SDRCD     ZDATE                           053943
     C                     EXSR ZDATE1                                    053943
     C                     END                                            053943
      *       IF ACTION CODE IS AMEND, USE RUND FOR SDRCD                 053943
     C           DDACTN    IFEQ 'A'                                       053943
     C                     Z-ADDBJRDNB    ZDAYNO                          053943
     C                     EXSR ZDATE2                                    053943
     C                     MOVE ZDATE     SDRCD                           053943
     C                     END                                            053943
     C/COPY WNCPYSRC,GL3271C172
      *                                                                   053943
     C                     ELSE                                           053943
     C                     MOVE SDRCD     ZDATE
     C                     EXSR ZDATE1
     C                     END                                            053943
     C   99                DO                              BEG02
     C                     MOVEL'RE71210' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C007
      *       CAN NOT BE FORWARD VALUE DATE.
     C           ZDAYNO    IFGT BJRDNB                     BEG02
     C                     MOVEL'RE71211' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C008
      *       CAN NOT BE EARLIER BACK VALUE PERIOD ON TABLE FILE.
     C           BJRDNB    SUB  BJBVPD    FWORK   50
     C           ZDAYNO    IFLT FWORK                      BEG02
     C                     MOVEL'RE71215' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C042
     C*  CANNOT BE LOWER THAN LIMIT DATE
     C           ZDAYNO    IFLT WWVDRC                     BEG02
     C                     MOVEL'RE71213' ZAMSID
     C*                                                                   110010
     C** This change value date cannot be earlier than base rate chg date 110010
     C*                                                                   110010
     C           WWVDRC    IFGT OLDR                                      110010
     C                     MOVE DICT      @DICT   2                       110010
     C                     MOVE DCST      @DCST   5                       110010
     C                     MOVE DRIB      @DRIB   2                       110010
     C           @DICT     IFNE SDICT                                     110010
     C           @DCST     ORNE SDCST                                     110010
     C           @DRIB     ORNE SDRIB                                     110010
      * Setup message data for message                                    110010
     C                     Z-ADDWWVDRC    ZDAYNO                          110010
     C                     EXSR ZDATE2                                    110010
     C                     MOVE ZDATE     ZA0001                          110010
     C                     MOVEL'RE71239' ZAMSID                          110010
     C                     END                                            110010
     C                     END                                            110010
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C043
     C                     END
     C*  IF NO ERROR UPDATE
     C           *IN64     IFEQ '0'
     C                     Z-ADDZDAYNO    SSDRCD
     C                     END
     C                     END                             END01
     C********************************************************************
     C*                             PART 7
     C********************************************************************
     C/COPY WNCPYSRC,GL3271C138
      *                                                                   073234
      * If DR calc. basis is blank and a/c is non-interest bearing,       073234
      * default it to the Default Interest Calc. Basis for the currency,  073234
      * if this is blank, default to '1'.                                 073234
     C           SDRIC     IFEQ *BLANK                                    073234
     C           SDRIB     ANDEQ*BLANK                                    073234
     C           SDRIS     ANDEQ*BLANK                                    073234
     C           SDSIG     ANDEQ*BLANK                                    073234
     C           SDICT     ANDEQ*BLANK                                    073234
     C           SDCST     ANDEQ*BLANK                                    073234
     C*                                                                   073234
     C           A6DICB    IFNE *BLANK                                    073234
     C                     MOVE A6DICB    SDRIC                           073234
     C                     ELSE                                           073234
     C                     MOVE '1'       SDRIC                           073234
     C                     END                                            073234
     C*                                                                   073234
     C                     END                                            073234
     C*                                                                   073234
     C/COPY WNCPYSRC,GL3271C046
     C           SDRIC     IFLT '1'
     C           SDRIC     ORGT '7'
     C*
     C*218-ENTRY MANDATORY AND MUST BE = 1,...,7
     C*
     C                     MOVEL'RE71218' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN65
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN01
     C/COPY WNCPYSRC,GL3271C047
     C  N65                MOVE SDRIC     SSDRIC
     C********************************************************************
     C*                             PART 8
     C********************************************************************
     C/COPY WNCPYSRC,GL3271C196
      *                                                                   073234
      * If cap. date & freq. are blank and a/c is non-interest bearing,   073234
      * default it to 'Z'.                                                073234
     C           SDRIF     IFEQ *BLANK                                    073234
     C           SNDID     ANDEQ*BLANK                                    073234
     C           SDRIB     ANDEQ*BLANK                                    073234
     C           SDRIS     ANDEQ*BLANK                                    073234
     C           SDSIG     ANDEQ*BLANK                                    073234
     C           SDICT     ANDEQ*BLANK                                    073234
     C           SDCST     ANDEQ*BLANK                                    073234
     C                     MOVE 'Z'       SDRIF                           073234
     C                     END                                            073234
      *                                                                   073234
     C           SDRIB     IFNE *BLANK                     IF01
     C           SDRIS     ORNE *BLANK
     C           SDSIG     ORNE *BLANK
     C           SDICT     ORNE *BLANK
     C           SDCST     ORNE *BLANK
     C*
     C           SNDID     IFEQ *BLANK                     IF02
     C           SDRIF     ANDNE'Z'
     C*
     C*219-ENTRY MANDATORY IF DEBIT CAPITALISATION FREQUENCY IS NOT 'Z'
     C*
     C                     MOVEL'RE71219' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN02
     C                     END                             EN01
     C           SNDID     IFNE *BLANK                     IF01
     C                     MOVE SNDID     ZDATE
     C                     EXSR ZDATE1
     C                     Z-ADDZDAYNO    WWNDID  50
     C           *IN99     IFEQ '1'                        IF02
     C           WWNDID    ORLT BJRDNB
     C           WWNDID    OREQ BJRDNB
     C           WWDACO    ANDEQBJRDNB
     C           BMLDAI    ANDEQ'Y'
     C*
     C*220-NEXT DEBIT CAPITALISATION DATE IS WRONG OR LESS THAN RUN DATE
     C*
     C                     MOVEL'RE71220' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN02
     C  N66                Z-ADDWWNDID    SSNDID
     C                     ELSE
     C                     Z-ADD*ZEROS    SSNDID
     C                     END                             EN01
     C/COPY WNCPYSRC,GL3271C204
     C********************************************************************
     C*                             PART 9
     C********************************************************************
     C           SDRIF     LOKUPFREQ                     80
     C           *IN80     IFEQ '0'                        IF01
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP82                                           S01408
     C*                                                                   S01408
     C*
     C*221-DEBIT CAPITALISATION FREQUENCY MANDATORY AND MUST BE 'ABDFLMQRS
     C*
     C                     MOVEL'RE71221' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN67
     C                     MOVE 'E'       ERR
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP93                                           S01408
     C*                                                                   S01408
     C                     END                             EN01
      *                                                                   094336
      ****If*Debit*Capitalisation*Frequency*=*Z*(Demand)*then*Next* 094336147954
      ****Debit*Capitalisation*Date*must*be*blank****************** 094336147954
      **********                                                    094336147954
     C********** SDRIF     IFEQ 'Z'                                 094336147954
     C********** SNDID     IFNE *BLANKS                             094336147954
     C**********           MOVEL'RE71336' ZAMSID                    094336147954
     C**********           EXSR ZASNMS                              094336147954
     C**********           SETON                     66             094336147954
     C**********           MOVE 'E'       ERR                       094336147954
     C**********           ENDIF                                    094336147954
     C********** SNDID     IFEQ *BLANKS                             094336147954
     C**********           Z-ADD*ZEROS    SSNDID                    094336147954
     C**********           ENDIF                                    094336147954
     C**********           ENDIF                                    094336147954
     C           SNDID     IFEQ *BLANK                     IF01
     C           SDRIF     ANDNE'Z'
     C*
     C*222-DEBIT CAPITALISATION FREQUENCY MUST BE 'Z' IF NEXT ONE IS BLANK
     C*
     C                     MOVEL'RE71222' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN67
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN01
     C  N67                MOVE SDRIF     SSDRIF
     C********************************************************************
     C*                             PART 10
     C********************************************************************
     C           SDRIF     IFEQ 'M'                        - B1
     C           SDRIF     OREQ 'T'
     C           SDRIF     OREQ 'Q'
     C           SDRIF     OREQ 'X'
     C           SDRIF     OREQ 'Y'
     C*
     C           SDNCD     IFNE *BLANKS
     C           SDNCD     ANDNE'00'
     C                     MOVE SDNCD     @DNCD   20
     C*
     C           @DNCD     IFLT 1
     C           @DNCD     ORGT 31
     C                     MOVEL'RE71853' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN68
     C                     MOVE 'E'       ERR
     C                     ELSE
     C                     Z-ADD@DNCD     SSDRDY
     C                     END                             - X2
     C*
     C                     ELSE                            - X2
     C           *IN66     IFNE '1'
     C                     Z-ADDZDAY      SSDRDY
     C                     END
     C*
     C                     END                             - E2
     C                     ELSE                            - X1
     C           SDNCD     IFNE *BLANKS                    - B2
     C           SDNCD     ANDNE'00'
     C*********            MOVEL'RE71223' ZAMSID                          056983
     C                     MOVEL'RE71854' ZAMSID                          056983
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN68
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X2
     C                     Z-ADD*ZEROS    SSDRDY
     C*
     C                     END                             - E2
     C                     END                             - E1
     C/COPY WNCPYSRC,GL3271C197
     C********************************************************************
     C*                             PART 11
     C********************************************************************
     C*
     C** Validate Debit Branch
     C*
      *  If alternate entry Rate condition must exist
     C           SDACP     IFEQ *BLANK                     IF01
     C                     MOVE *BLANKS   SDRBR
     C                     ELSE                            X1
      *
     C           SDRBR     IFEQ *BLANKS
     C                     MOVELDBRN      SDRBR
     C                     END
      *  If alternate entry Can not be the account itself
     C           SDACP     IFEQ ACKEY1                     IF03
     C           SDRBR     ANDEQSBRCA
     C           SDACP     OREQ SACNO
     C                     MOVEL'RE71236' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
      *225- If alternate entry and amend mode the account can not be the
      *  alternate of another account.
     C                     ELSE                            X3
     C           *IN31     IFEQ '1'                        IF04
     C           *IN44     ANDEQ'1'
     C*
     C                     MOVEL'RE71225' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            X4
      *
      * Format of entry must be Retail A/c Number or Full Account
     C           @NDIGT    CHECKSDACP     @POSN1  30
     C           @NDIGT    CHECKSDACP:10  @POSN2  30
     C           ' '       CHECKSDACP:11  @POSN3  30
     C                     SELEC
     C           @POSN1    WHEQ 11
     C           @POSN3    ANDEQ*ZERO
      *
     C           @POSN1    WHEQ 7
     C           @POSN2    ANDEQ*ZERO
      *
     C                     OTHER
     C                     MOVEL'RE71225' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     ENDSL
      *
      *  If alternate entry account must exist and be live.
      *  alternate of another account.
     C                     MOVEL*BLANKS   ACKEYK
     C                     MOVELSDACP     ACKEYK
     C                     MOVE SDRBR     WWBRCK
      *
     C           ACCKYK    IFEQ *BLANK
     C                     Z-ADDRETKK     WURKEY 100
     C                     MOVE *BLANK    SDRBR
     C                     MOVE *BLANK    WWBRCK
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP97                                           S01408
     C*                                                                   S01408
     C           WURKEY    CHAINACNUM                80
      *                                                                   174144
      ** Also check that a/c is not closed or about to close in COB.      174144
      *                                                                   174144
     C           RECI      IFNE 'D'                                       174144
     C           ACST      OREQ 'C'                                       174144
     C*                                                                   174144
     C*225-Alternative account is closed in FILE : ACCNTLXX OR ACNUM      174144
     C*                                                                   174144
     C                     MOVEL'RE71225' ZAMSID                          174144
     C                     EXSR ZASNMS                                    174144
     C                     MOVE '1'       *IN69                           174144
     C                     MOVE 'E'       ERR                             174144
     C                     ENDIF                                          174144
     C*
     C           *IN80     IFEQ '1'                        IF05
     C*
     C*224-Alternative account doesn't exist in FILE : ACCNTLXXOR ACNUM
     C*
     C                     MOVEL'RE71224' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     ELSE
     C*
     C*    Alternative account exist in FILE : ACNUM  Setup key
     C*
     C                     MOVE CNUM      WWCUSK
     C                     MOVE CCY       WWCCYK
     C                     MOVE ACOD      WWACOK
     C                     MOVE ACSQ      WWACSK
     C                     MOVE BRCA      WWBRCK
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP98                                           S01408
     C*                                                                   S01408
     C                     END                             EN05
     C                     END                             EN04
     C                     END                             E03
     C                     END                             E01
     C           ERR       IFNE 'E'                        IF05
     C           WWACK3    SETLLACCNTLXX                 80
     C           *IN80     IFEQ '0'                        IF04
     C*
     C*224-ALTERNATIVE ACCOUNT DOESN'T EXIST IN FILE : ACCNTLXXOR ACNUM
     C*
     C                     MOVEL'RE71224' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            EL02
     C*224-ALTERNATIVE ACCOUNT DOESN'T EXIST IN FILE : ACCNTLXXOR ACNUM
     C*
     C*224-Alternative account can not have any alternate.
     C*
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWBRCK    @BRCA   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C/COPY WNCPYSRC,GL3271C192
     C           @RTCD     IFNE *BLANKS
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71852' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     ELSE
     C                     MOVE A8BRCD    SSDRBR
     C                     END
     C* IF NOT FOUND NOT RETAIL OK
     C           WWACK2    CHAINREIACDXF             80
     C           *IN80     IFEQ '0'                        IF02
     C           DACP      IFNE *BLANKS                    IF03
     C           CACP      ORNE *BLANKS
     C           CHAC      ORNE *BLANKS
     C                     MOVEL'RE71224' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     END                             E03
     C                     END                             E02
      *                                                                   174144
      ** Also check that the account has not been closed.                 174144
      *                                                                   174144
     C           RECI      IFNE 'D'                                       174144
     C           RECIRX    ORNE 'D'                                       174144
      *                                                                   174144
      ** Alternative account has been closed.                             174144
      *                                                                   174144
     C                     MOVEL'RE71225' ZAMSID                          174144
     C                     EXSR ZASNMS                                    174144
     C                     MOVE '1'       *IN69                           174144
     C                     MOVE 'E'       ERR                             174144
     C                     ENDIF                                          174144
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP2                                           S01408
     C*                                                                   S01408
     C                     END                             E02
     C*
     C           *IN69     IFEQ '0'                        IF02
     C                     MOVELACKEYK    WWDACP
     C                     END                             EN02
     C                     END                             EN01
     C                     END                             EN01
     C  N69                MOVELSDACP     SSDACP
     C  N69                MOVELSDRBR     SSDRBR
      ********************************************************************086558
      *                             PART 11A                              086558
      ********************************************************************086558
     C           SDRIB     IFEQ *BLANKS                                   086558
     C           SDSIG     ANDEQ'-'                                       086558
      *                                                                   086558
      ** 238 - Rate/Spread (SDSIG) must not be '-' if a Base Rate Type    086558
      **       (SDRIB) is entered along with an Alternate account         086558
      **       (SDACP)                                                    086558
      *                                                                   086558
     C                     MOVEL'RE71238' ZAMSID                          086558
     C                     EXSR ZASNMS                                    086558
     C                     MOVE '1'       *IN62                           086558
     C                     MOVE 'E'       ERR                             086558
     C                     ENDIF                                          086558
     C********************************************************************
     C*                             PART 12
     C********************************************************************
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP68                                           S01408
     C*                                                                   S01408
     C           SODLN     IFNE *BLANK                     IF01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE SODLN     ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADD11        ZADIG
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        IF02
     C*
     C*226-OVERDRAFT LINE IS NOT IN VALID NUMERIC FIELD
     C*
     C                     MOVEL'RE71226' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN70
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN02
     C  N70                MOVE ZFIELD    SSODLN
     C                     ELSE
     C                     MOVE *BLANKS   SSODLN
     C                     END                             EN01
     C/COPY WNCPYSRC,GL3271C225
     C           SSODLN    IFNE SWODLN
     C                     Z-ADDBJRDNB    SSDLIM
     C                     END
     C/COPY WNCPYSRC,GL3271C179
     C********************************************************************
     C*                        PART 13 & PART 14
     C********************************************************************
     C           SODLN     IFNE *BLANKS                    IF01
     C           SODSC     IFEQ *BLANKS                    IF02
     C*
     C*227-OVERDRAFT SECURED MANDATORY
     C*
     C                     MOVEL'RE71227' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN02
     C*
     C           SODED     IFEQ *BLANKS                    IF02
     C*
     C*228-OVERDRAFT EXPIRY DATE MANDATORY
     C*
     C                     MOVEL'RE71228' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN71
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            EL02
     C*
     C****** TEST NUMERIQUE DEBUT
     C                     MOVE SODED     ZDATE
     C                     EXSR ZDATE1
     C           *IN99     IFEQ '1'                        - B3
     C                     MOVEL'RE71229' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN71
     C                     MOVE 'E'       ERR
     C                     END                             - E3
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP69                                           S01408
     C*                                                                   S01408
     C**
     C           ZDAYNO    IFLT BJRDNB                     IF3
     C           *IN99     ANDEQ'0'
     C           DDACTN    ANDNE'A'                                       143064
     C           DDACTN    OREQ 'A'                                       143064
     C           *IN99     ANDEQ'0'                                       143064
     C           ZDAYNO    ANDLEBJRDNB                                    143064
     C           ZDAYNO    ANDNESWODED                                    143064
     C*
     C*229-OVERDRAFT EXPIRY DATE MUST BE AFTER THE RUN DATE
     C*
     C                     MOVEL'RE71229' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN71
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN03
     C*
     C****** TEST NUMERIQUE FIN
     C*
     C                     END                             EN02
     C  N71                Z-ADDZDAYNO    SSODED
     C*
     C                     ELSE                            EL01
     C*
      ** Overdraft Expiry Date must be blank if Overdraft Line            CRE001
      ** is ZERO and CRE001 is OFF                                        CRE001
      *                                                                   CRE001
     C           CRE001    IFNE 'Y'                                       CRE001
      *                                                                   CRE001
     C           SODED     IFNE *BLANKS                    IF02
     C*
     C*230-ENTRY OF OVERDRAFT EXPIRY DATE IS NOT ALLOWED
     C*
     C                     MOVEL'RE71230' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN71
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN02
     C                     Z-ADD*ZEROS    SSODED
      *                                                                   CRE001
     C                     ELSE                                           CRE001
      *                                                                   CRE001
      ** Allow entry in Overdraft Expiry Date if CRE001 is ON             CRE001
      *                                                                   CRE001
     C           SODED     IFNE *BLANKS                                   CRE001
     C                     MOVE SODED     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C           *IN99     IFEQ '1'                                       CRE001
     C                     MOVEL'RE71229' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN71                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
      ** 229-Overdraf Expiry Date must be after the Run Date              CRE001
      *                                                                   CRE001
     C           ZDAYNO    IFLT BJRDNB                                    CRE001
     C           *IN99     ANDEQ'0'                                       CRE001
     C                     MOVEL'RE71229' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN71                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                                          CRE001
     C  N71                Z-ADDZDAYNO    SSODED                          CRE001
      *                                                                   CRE001
     C                     ELSE                                           CRE001
     C                     Z-ADD*ZEROS    SSODED                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
     C                     END                             EN01
      *                                                                   CRE001
     C           SODLN     IFNE *BLANKS
     C           SODSC     IFEQ *BLANKS                    IF01
     C                     MOVE 'N'       SODSC
     C                     ELSE                            EL01
     C           SODSC     IFNE 'Y'                        IF02
     C           SODSC     ANDNE'N'
     C*
     C*231-ENTRY OF OVERDRAFT SECURED MUST BE 'Y' OR 'N'
     C*
     C                     MOVEL'RE71231' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C*
     C                     END                             EN02
     C                     END                             EN01
     C                     ELSE
     C           SODSC     IFNE *BLANKS
     C           CRE001    ANDNE'Y'                                       CRE001
     C                     MOVEL'RE71231' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C                     END
      *                                                                   CRE001
     C           SODSC     IFNE *BLANKS                                   CRE001
     C           ATOLVD    ANDEQ*ZEROS                                    CRE001
     C           CRE001    ANDEQ'Y'                                       CRE001
     C                     MOVEL'RE72012' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN72                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                                          CRE001
     C                     END
     C  N72                MOVE SODSC     SSODSC
      *                                                                   053943
     C           ERR       IFEQ 'E'                                       053943
     C                     MOVE #DRCD     SDRCD                           053943
     C                     END                                            053943
     C/COPY WNCPYSRC,GL3271C029
      *                                                                   CRE001
      ** If CRE001 is installed, validate Overdraft fields                CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      ** IF Dr.Int.Calc.Type OR Dr.Int.Calc.Sub-Type NOT = *blanks        CRE001
     C           SDICT     IFNE *BLANKS                    B1             CRE001
     C           SDCST     ORNE *BLANKS                    O1             CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate NOT = *blanks                       CRE001
     C           SAODR     IFNE *BLANKS                    B.2            CRE001
     C                     MOVEL'RE71874' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN86                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Sign NOT = *blanks                  CRE001
     C           SAODRX    IFNE *BLANKS                    B.2            CRE001
     C                     MOVEL'RE71874' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN75                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date NOT = *blanks     CRE001
     C           SORTC     IFNE *BLANKS                    B.2            CRE001
     C                     MOVEL'RE71874' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
      ** IF Dr.Int.Calc.Type AND Dr.Int.Calc.Sub-Type = *blanks           CRE001
     C           SDICT     IFEQ *BLANKS                    B1             CRE001
     C           SDCST     ANDEQ*BLANKS                    A1             CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate NOT = *blanks                       CRE001
     C           SAODR     IFNE *BLANKS                    B.2            CRE001
      *                                                                   CRE001
      ** Validate and format to numeric                                   CRE001
     C                     MOVE *BLANKS   ZFIELD                          CRE001
     C                     MOVE SAODR     ZFIELD                          CRE001
     C                     Z-ADD7         ZADEC                           CRE001
     C                     Z-ADD4         ZADIG                           CRE001
     C                     EXSR ZALIGN                                    CRE001
      *                                                                   CRE001
      ** IF Invalid                                                       CRE001
     C           *IN99     IFEQ '1'                        B..3           CRE001
     C                     MOVEL'RE72001' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN86                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
      *                                                                   CRE001
      ** IF Valid                                                         CRE001
     C                     ELSE                            X..3           CRE001
      *                                                                   CRE001
     C                     MOVE ZFIELD    WWAODR 117                      CRE001
      *                                                                   CRE001
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Sign NOT = *blanks                  CRE001
     C           SAODRX    IFNE *BLANKS                    B.2            CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate = *blanks                           CRE001
     C           SAODR     IFEQ *BLANKS                    B..3           CRE001
     C                     MOVEL'RE72002' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN86                           CRE001
     C                     MOVE '1'       *IN75                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Sign NOT = '+' or '-'               CRE001
     C           SAODRX    IFNE '+'                        B..3           CRE001
     C           SAODRX    ANDNE'-'                        A..3           CRE001
     C                     MOVEL'RE72003' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN75                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate NOT = *blanks                       CRE001
      ** AND Additional Overdraft Rate Sign = '-'                         CRE001
     C           SAODR     IFNE *BLANKS                    B.2            CRE001
     C           SAODRX    ANDEQ'-'                        A.2            CRE001
     C                     MULT -1        WWAODR                          CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date = *blanks         CRE001
      **    AND Additional Overdraft Rate NOT = *blanks                   CRE001
      ** OR Additional Overdraft Rate Change Value Date NOT = *blanks     CRE001
      **    AND Additional Overdraft Rate = *blanks                       CRE001
     C           SORTC     IFEQ *BLANKS                    B.2            CRE001
     C           SAODR     ANDNE*BLANKS                    A.2            CRE001
     C           SORTC     ORNE *BLANKS                    O.2            CRE001
     C           SAODR     ANDEQ*BLANKS                    A.2            CRE001
     C                     MOVEL'RE72004' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN86                           CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date NOT = *blanks     CRE001
     C           SORTC     IFNE *BLANKS                    B.2            CRE001
      *                                                                   CRE001
      ** Validate and convert to Midas Day No.                            CRE001
     C                     MOVE SORTC     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C                     Z-ADDZDAYNO    WWORTC  50                      CRE001
      *                                                                   CRE001
      ** IF Invalid Date                                                  CRE001
     C           *IN99     IFEQ *ON                        B..3           CRE001
     C                     MOVEL'RE71310' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
      *                                                                   CRE001
      ** IF Valid Date                                                    CRE001
     C                     ELSE                            X..3           CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date > Run Date        CRE001
     C           WWORTC    IFGT BJRDNB                     B...4          CRE001
     C                     MOVEL'RE71311' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E...4          CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date <                 CRE001
      **    previous Dr.Rate Change Value Date                            CRE001
     C           WWORTC    IFLT SWDRCD                     B...4          CRE001
     C                     MOVEL'RE71312' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E...4          CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date <                 CRE001
      **    Date Account Opened                                           CRE001
     C                     MOVE SDACO     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C                     Z-ADDZDAYNO    WWDACO                          CRE001
     C           WWORTC    IFLT WWDACO                     B...4          CRE001
     C                     MOVEL'RE71314' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E...4          CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date <                 CRE001
      **    Back-Value Period Limit Date                                  CRE001
     C           BJRDNB    SUB  BJBVPD    WWBKVD  50                      CRE001
     C           WWORTC    IFLT WWBKVD                     B...4          CRE001
     C                     MOVEL'RE71315' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E...4          CRE001
      *                                                                   CRE001
      ** IF Account being Inserted                                        CRE001
     C           DDACTN    IFEQ 'I'                        B...4          CRE001
      *                                                                   CRE001
      ** IF Dr.Base Rate OR Dr.Rate/Spread have been entered              CRE001
     C           SDRIB     IFNE *BLANKS                    B....5         CRE001
     C           SDRIS     ORNE *BLANKS                    B....5         CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date NOT =             CRE001
      **    Dr.Rate Change Date                                           CRE001
     C           WWORTC    IFNE SSDRCD                     B.....6        CRE001
     C                     MOVEL'RE72005' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.....6        CRE001
     C                     ENDIF                           E....5         CRE001
     C                     ENDIF                           E...4          CRE001
      *                                                                   CRE001
      ** IF Account being Amended                                         CRE001
     C           DDACTN    IFEQ 'A'                        B...4          CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date <                 CRE001
      **    previous Additional Overdraft Rate Change Value Date          CRE001
     C           WWORTC    IFLT ATORTC                     B....5         CRE001
     C                     MOVEL'RE71313' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E....5         CRE001
      *                                                                   CRE001
      ** IF Dr.Base Rate OR Dr.Rate/Spread have been amended              CRE001
     C           SWDRIB    IFNE SSDRIB                     B....5         CRE001
     C           SWDRIS    ORNE SSDRIS                     O....5         CRE001
      *                                                                   CRE001
      ** IF Additional Overdraft Rate Change Value Date NOT =             CRE001
      **    Dr.Rate Change Value Date                                     CRE001
     C           WWORTC    IFNE SSDRCD                     B.....6        CRE001
     C                     MOVEL'RE72005' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.....6        CRE001
     C                     ENDIF                           E....5         CRE001
      *                                                                   CRE001
      ** IF Dr.Base Rate, Dr.Rate/Spread AND Additional O'draft Rate      CRE001
      **    all unchanged                                                 CRE001
     C           SWDRIB    IFEQ SSDRIB                     B....5         CRE001
     C           SWDRIS    ANDEQSSDRIS                     A....5         CRE001
     C           SWAODR    ANDEQWWAODR                     A....5         CRE001
      *                                                                   CRE001
      ** IF Additional O'draft Rate Change Value Date changed             CRE001
     C           WWORTC    IFNE ATORTC                     B.....6        CRE001
     C                     MOVEL'RE72006' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN77                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.....6        CRE001
     C                     ENDIF                           E....5         CRE001
     C                     ENDIF                           E...4          CRE001
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date = *blanks                    CRE001
      ** AND screen Overdraft Line NOT = file value for Overdraft Line    CRE001
     C                     MOVE SODLN     WWODLN 110                      CRE001
      *                                                                   173634
      ** If the screen CCY is not the same as the default CCY (insert)    173634
      ** then set the work field for ODLN value to zero.                  173634
      *                                                                   173634
     C           SCCY      IFNE CCY                                       173634
     C           *IN30     ANDEQ*ON                                       173634
     C                     Z-ADD0         WFODLN 110                      173634
     C                     ELSE                                           173634
     C                     Z-ADDODLN      WFODLN                          173634
     C                     ENDIF                                          173634
      *                                                                   173634
     C           SOLVD     IFEQ *BLANKS                    B1             CRE001
     C***********WWODLN    ANDNEODLN                       A1      CRE001 173634
     C           WWODLN    ANDNEWFODLN                     A1             173634
     C                     MOVEL'RE72007' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date NOT = *zero                  CRE001
     C           SOLVD     IFNE *BLANKS                    B1             CRE001
     C                     MOVE SOLVD     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C                     Z-ADDZDAYNO    WWOLVD  50                      CRE001
      *                                                                   CRE001
      ** IF Invalid Date                                                  CRE001
     C           *IN99     IFEQ *ON                        B.2            CRE001
     C                     MOVEL'RE71310' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
      *                                                                   CRE001
      ** IF Valid Date                                                    CRE001
     C                     ELSE                            X.2            CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date > OR = Expiry Date           CRE001
     C                     MOVE SODED     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C                     Z-ADDZDAYNO    WWODED  50                      CRE001
     C           WWOLVD    IFGE WWODED                     B..3           CRE001
     C           WWODLN    ANDNESWODLN                                    134747
     C                     MOVEL'RE72008' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date > OR = Forward Value Limit   CRE001
     C           BJRDNB    ADD  BMNDFV    WWFWDL  50                      CRE001
     C           WWOLVD    IFGE WWFWDL                     B..3           CRE001
     C                     MOVEL'RE72009' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date < Date Account Opened        CRE001
     C                     MOVE SDACO     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C                     Z-ADDZDAYNO    WWDACO                          CRE001
     C           WWOLVD    IFLT WWDACO                     B..3           CRE001
     C                     MOVEL'RE71314' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date <                            CRE001
      **    Back-Value Period Limit Date                                  CRE001
     C           BJRDNB    SUB  BJBVPD    WWBKVD  50                      CRE001
     C           WWOLVD    IFLT WWBKVD                     B..3           CRE001
     C                     MOVEL'RE71315' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** IF Account being Amended                                         CRE001
     C           DDACTN    IFEQ 'A'                        B..3           CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date <                            CRE001
      **    Previous Change Value Date (if NOT *zero)                     CRE001
     C                     MOVE OPOLC     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C                     Z-ADDZDAYNO    WWPOLC  50                      CRE001
     C           WWPOLC    IFNE *ZERO                      B...4          CRE001
     C           WWOLVD    IFLT WWPOLC                     B....5         CRE001
     C                     MOVEL'RE71313' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E....5         CRE001
     C                     ENDIF                           E...4          CRE001
      *                                                                   CRE001
      ** IF Overdraft Line Change Value Date <                            CRE001
      **    file value for Overdraft Line Change Value Date               CRE001
      **     (provided Previous Change Value Date = *zero)                CRE001
     C           WWPOLC    IFEQ *ZERO                      B...4          CRE001
     C           WWOLVD    IFLT ATOLVD                     B....5         CRE001
     C                     MOVEL'RE71313' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E....5         CRE001
     C                     ENDIF                           E...4          CRE001
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
      ** IF O'd Line Change Value date blank and Expiry Date not blank    CRE001
      ** OR O'd Line Change Value date not blank and Expiry Date blank    CRE001
      ** and if not in insert mode.                                       173634
     C           *IN30     IFEQ '0'                                       173634
     C           SOLVD     IFEQ *BLANKS                    B1             CRE001
     C           SODED     ANDNE*BLANKS                    A1             CRE001
     C           ATOLVD    ANDEQ*ZEROS                     A1             CRE001
     C           ATPOLC    ANDEQ*ZEROS                     A1             CRE001
     C           WWODLN    ANDNESWODLN                                    134747
     C           SOLVD     ORNE *BLANKS                    O1             CRE001
     C           SODED     ANDEQ*BLANKS                    B1             CRE001
     C           WWODLN    ANDNESWODLN                                    134747
     C                     MOVEL'RE72007' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN71                           CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E1             CRE001
     C                     ENDIF                                          173634
      *                                                                   CRE001
      ** IF Overdraft Line AND Overdraft Expiry Date unchanged            CRE001
     C           SWODLN    IFEQ SSODLN                     B1             CRE001
     C           SWODED    ANDEQSSODED                     A1             CRE001
     C           DDACTN    ANDEQ'A'                        A2             CRE001
      *                                                                   CRE001
      ** IF This Change Value Date amended                                CRE001
     C           SOLVD     IFEQ *BLANKS                    B.2            CRE001
     C           SWOLVD    ANDNE*ZERO                      A.2            CRE001
     C           SOLVD     ORNE *BLANKS                    O.2            CRE001
     C           SWOLVD    ANDNEWWOLVD                     B.2            CRE001
     C                     MOVEL'RE72010' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
      ** IF DR Int.Calc.Type OR DR Int.Calc.Sub-Type NOT = *blanks        CRE001
     C           SDICT     IFNE *BLANKS                    B1             CRE001
     C           SDCST     ORNE *BLANKS                    A1             CRE001
      *                                                                   CRE001
      ** IF Interest Rate Review Date NOT = *blanks                       CRE001
     C           SITRD     IFNE *BLANKS                    B.2            CRE001
     C                     MOVEL'RE71874' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN76                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
      ** IF DR Int.Calc.Type AND DR Int.Calc.Sub-Type = *blanks           CRE001
     C           SDICT     IFEQ *BLANKS                    B1             CRE001
     C           SDCST     ANDEQ*BLANKS                    A1             CRE001
      *                                                                   CRE001
      ** IF Interest Rate Review Date NOT = 0                             CRE001
      **    AND Additional Overdraft Rate = *blanks                       CRE001
      **    AND Overdraft Line = *blanks                                  CRE001
     C           SITRD     IFNE *BLANKS                    B.2            CRE001
     C           SAODR     ANDEQ*BLANKS                    A.2            CRE001
     C           SODLN     ANDEQ*BLANKS                    A.2            CRE001
     C                     MOVEL'RE72011' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN76                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Interest Rate Review Date = 0                                 CRE001
     C           SITRD     IFEQ *BLANKS                    B.2            CRE001
      **    IF Additional Overdraft Rate NOT = *blanks                    CRE001
      **       OR Overdraft Line NOT = *blanks                            CRE001
     C           SAODR     IFNE *BLANKS                    B..3           CRE001
     C           SODLN     ORNE *BLANKS                    O..3           CRE001
     C           WWODLN    IFNE SWODLN                                    134747
     C                     MOVEL'RE71876' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN76                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                                          134747
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
      *                                                                   CRE001
      ** IF Interest Rate Review Date NOT = 0                             CRE001
     C           SITRD     IFNE *BLANKS                    B.2            CRE001
      *                                                                   CRE001
      ** IF Interest Rate Review Date = '999999'                          CRE001
     C           SITRD     IFEQ '999999'                   B..3           CRE001
     C                     Z-ADD999999    WWITRD  50                      CRE001
      *                                                                   CRE001
     C                     ELSE                            X..3           CRE001
      *                                                                   CRE001
     C                     MOVE SITRD     ZDATE                           CRE001
     C                     EXSR ZDATE1                                    CRE001
     C                     Z-ADDZDAYNO    WWITRD                          CRE001
      *                                                                   CRE001
      ** IF Invalid Date                                                  CRE001
     C           *IN99     IFEQ *ON                        B...4          CRE001
     C                     MOVEL'RE71220' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN76                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
      *                                                                   CRE001
      ** IF Valid Date                                                    CRE001
     C                     ELSE                            X...4          CRE001
      *                                                                   CRE001
      ** IF Interest Rate Review Date < OR = Run Date                     CRE001
     C           WWITRD    IFLE BJRDNB                     B....5         CRE001
     C                     MOVEL'RE72013' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       *IN76                           CRE001
     C                     MOVE 'E'       ERR                             CRE001
     C                     ENDIF                           E....5         CRE001
     C                     ENDIF                           E...4          CRE001
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
      * Update Dlim if O/D-chg-value-date changed.                        CRE001
     C           ERR       IFEQ *BLANKS                    No Errors      CRE001
     C           SWOLVD    ANDNEWWOLVD                     Date chged     CRE001
     C                     Z-ADDBJRDNB    SSDLIM                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
      ** Move screen fields to work fields                                CRE001
     C           *IN73     IFEQ *OFF                       B1             CRE001
     C                     Z-ADDWWOLVD    SSOLVD                          CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
     C           *IN86     IFEQ *OFF                       B1             CRE001
     C                     Z-ADDWWAODR    SSAODR                          CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
     C           *IN75     IFEQ *OFF                       B1             CRE001
     C                     MOVELSAODRX    SSAODX                          CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
     C           *IN77     IFEQ *OFF                       B1             CRE001
     C                     Z-ADDWWORTC    SSORTC                          CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
     C           *IN76     IFEQ *OFF                       B1             CRE001
     C                     Z-ADDWWITRD    SSITRD                          CRE001
     C                     ENDIF                           E1             CRE001
     C                     ENDIF                                          CRE001
     C*                                                                   208221
     C** Check if Revenue Analysis (CDE002) is present                    208221
     C*                                                                   208221
     C           CDE002    IFEQ 'Y'                                       208221
     C*                                                                   208221
     C** Only default on Insert. Note if the rate/spread is zero,         208221
     C** the margin will default to zero                                  208221
     C*                                                                   208221
     C           DDACTN    IFEQ 'I'                                       208221
     C           SDRIB     IFNE *BLANKS                                   208221
     C                     Z-ADDSSDRIS    SWDRMG                          208221
     C                     MOVEL'Y'       SWOVRD                          208221
     C                     MOVEL'Y'       SOVRD                           208221
     C                     MOVEL*BLANKS   ZFLD15                          208221
     C                     MOVE SWDRMG    ZFLD15                          208221
     C                     Z-ADD7         ZDECS                           208221
     C                     MOVEL'L'       ZECODE                          208221
     C                     EXSR ZFRPED                                    208221
     C                     MOVE ZOUT22    SDRMG                           208221
     C                     ELSE                                           208221
     C                     MOVEL*BLANKS   SWDRMG                          208221
     C                     MOVEL*BLANKS   SWOVRD                          208221
     C                     MOVEL*BLANKS   SDRMG                           208221
     C                     MOVEL*BLANKS   SOVRD                           208221
     C                     END                                            208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          208221
      *                                                                   174144
      ** Restore RECI from saved value. Also move RECI into renamed       174144
      ** RECOMXX and RECOM RECI fields.                                   174144
      *                                                                   174144
     C                     MOVELRECISV    RECI                            174144
     C                     MOVELRECISV    RECIRE                          174144
     C                     MOVELRECISV    RECIRC                          174144
      *                                                                   CRE001
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10F3   - PROCESS CREDIT INTEREST DETAILS                       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #P1033   - TRANSFER WORK FIELDS IN SCREEN FIELDS(3RD FORMAT)     *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      * #V10F3   - PROCESS VALIDATION OF 'F3' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      * WWACTN   - ACTION CODE                                           *
      *                                                                  *
      ********************************************************************
     C           #P10F3    BEGSR                           * #P10F3 BGSR *
     C*
     C**  Set start screen indicator
     C                     MOVE ' '       ERR     1
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVEL*BLANK    WWPASG  1
     C                     MOVELSSANAM    SANAM
     C/COPY WNCPYSRC,GL3271C030
     C*
     C**  CLEAR WHOLE SCREEN
     C                     WRITEGL3271FC
     C**
     C           WFMT      DOUNE'F3'                       -B1
     C**
     C           WIND#3    TAG
     C                     WRITEGL3271C1
     C                     EXFMTGL3271F3
     C                     MOVEL*BLANK    ERR
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C                     END
     C*
     C**  F3 PRESSED - EXIT OF PROGRAM
     C           *INKC     IFEQ '1'                        -B2
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C237
     C                     END                             -E2
     C*
     C**  F12 PRESSED - PREVIOUS SCREEN
     C           *INKL     IFEQ '1'                        -B2
     C                     MOVELWWRTRN    WFMT
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP46                                           S01408
      *                                                                   S01408
     C                     END                             -E2
     C*
     C**  F5 PRESSED - REFRESH
     C           *INKE     IFEQ '1'                        -B2
     C** ENQUIRY F5 NOT ALLOWED
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C** AMEND RETURN TO FIRST SCREEN
     C           *IN31     IFEQ '1'
     C           *IN30     OREQ '1'
     C                     EXSR #P1033
     C                     END                             -E3
     C/COPY WNCPYSRC,GL3271C031
     C                     END                             -E2
     C**  F9 PRESSED - REFRESH  ALL
     C           *INKI     IFEQ '1'                        -B2
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C**
     C           *IN30     IFEQ '1'                        -B3
     C                     MOVEL'FK'      WFMT
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       *IN69
     C                     END                             -E3
     C**
     C           *IN31     IFEQ '1'                        -B3
     C                     EXSR #P1030
     C           WWACTN    IFEQ 'A'                        -B4       ADTES
     C           WWACTN    OREQ 'E'                                  ADTES
     C                     MOVEL'F1'      WFMT
     C                     ELSE                            -X4       ADTES
     C                     MOVEL'F1'      WFMT                       ADTES
     C                     MOVE WWACTN    WFMT
     C                     END                             -E4
     C                     END                             -E3
     C                     END                             -E2
     C*
     C**  F8 PRESSED - FROM ENQUIRY TO AMEND MODE
     C           *INKH     IFEQ '1'                        -B2
     C* IF MULTIBRANCHING DO VALIDATION ON BRANCH INPUT                   097616
     C           BJSBRC    IFEQ *BLANKS                                   097616
     C                     MOVEL'A'       @ZACTN                          097616
     C                     MOVELSBRCA     @BRCA                           097616
     C                     EXSR #AUTH                                     097616
     C           @ERR      IFNE 0                                         097616
     C                     MOVEL'RE7103B' ZAMSID                          097616
     C                     EXSR ZASNMS                                    097616
     C                     MOVEL'E'       ERR                             097616
     C                     END                                            097616
     C                     END                                            097616
     C*
     C**  USER MUST BE AUTHORISED AND ACTION MODE IS ENQUIRY
     C           *IN41     IFEQ '1'                        -B3
     C           *IN32     ANDEQ'1'
     C           ERR       ANDEQ*BLANKS                                   097616
     C           *IN39     IFEQ '0'                        -B4
     C*
     C**  UNPROTECT FIELDS AND REDISPLAY
     C                     MOVEA'0100'    *IN,30
     C                     MOVE 'A'       DDACTN
     C                     ELSE                            -X4
     C*
     C** ERROR MESSAGE
     C                     MOVEL'RE71003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E4
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ROLLDOWN PRESSED - VALIDATION AND PREVIOUS SCREEN
     C           *IN26     IFEQ '1'                        -B2
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F3
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
     C                     MOVEL'F2'      WFMT
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ROLLUP          PRESSED - VALIDATION AND NEXT SCREEN
     C           *IN25     IFEQ '1'                        -B2
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F3
     C                     END                             -E3
     C*
     C/COPY WNCPYSRC,GL3271C182
     C           ERR       IFEQ ' '                        -B3
      * WINDOW PROCESSING
     C*
     C           BGWDPR    IFEQ 'Y'                        -B4
     C           BGNTST    ANDEQ'Y'
     C           BGWDPR    OREQ 'Y'
     C           FACH      ANDEQ'Y'
     C           BGWDPR    OREQ 'Y'
     C           TSTMC     ANDEQ'Y'
     C/COPY WNCPYSRC,GL3271C164
     C*
     C                     EXSR #WNDW
     C*
     C                     END                             -E4
      *
      *-------------------------------------------------------------------
     C** TEST IF A KEY HAS BEEN PRESSED
     C**
     C           WWRTCD    IFEQ *BLANK                     -B4
     C**
     C                     MOVEL'Y'       WWPASG
     C**
     C           *IN34     IFEQ '1'                        -B5
     C                     MOVEL'F4'      WFMT
     C                     ELSE                            -X5
     C                     MOVEL'F5'      WFMT
     C                     END                             -E5
     C**
     C           *IN32     IFEQ '1'                        -B5
     C           WWACTN    ANDEQ'3'
     C           *IN49     ANDEQ'0'
     C                     MOVELWWRTRN    WFMT
     C                     END                             -E5
     C                     END                             -E4
     C*
     C                     END                             -E3
     C                     END                             -E2
     C**  ENTER    PRESSED - VALIDATION AND CORRECT  SCREEN
     C           *IN49     IFEQ '0'                        -B2
     C           WWPASG    ANDNE'Y'
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F3
     C                     END                             -E3
     C*
     C/COPY WNCPYSRC,GL3271C183
     C           ERR       IFEQ ' '                        -B3
     C*
     C** WINDOW PROCESSING
     C*
     C           BGWDPR    IFEQ 'Y'                        -B4
     C           BGNTST    ANDEQ'Y'
     C           BGWDPR    OREQ 'Y'
     C           FACH      ANDEQ'Y'
     C           BGWDPR    OREQ 'Y'
     C           TSTMC     ANDEQ'Y'
     C/COPY WNCPYSRC,GL3271C165
     C*
     C                     EXSR #WNDW
     C*
     C                     END                             -E4
     C**
     C** TEST IF A KEY HAS BEEN PRESSED
     C**
     C           WWRTCD    IFEQ *BLANK                     -B4
     C**
     C           *IN30     IFEQ '1'                        -B5
     C           WWACTN    OREQ 'A'
     C           WWACTN    OREQ 'E'
     C** TEST IF AT LEAST ONE COMMISSION PRESENT
     C           *IN34     IFEQ '1'                        -B6
     C                     MOVEL'F4'      WFMT
     C                     ELSE                            -X6
     C                     MOVEL'F5'      WFMT
     C                     END                             -E6
     C                     END                             -E5
     C           *IN31     IFEQ '1'                        -B5
     C           WWACTN    ANDNE'A'
     C                     MOVEL'UP'      WFMT
     C                     END                             -E5
     C           *IN32     IFEQ '1'                        -B5
     C           WWACTN    ANDNE'E'
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C120                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD                            S01522
     C                     PARM 'E'       ACTN                            S01522
     C                     PARM ACKEY     ACCD                            S01522
     C                     END                                            S01522
      *                                                                   CGL004
      ** If Midas-Fontis Interface is switched on, call program to        CGL004
      ** display Fontis account details.                                  CGL004
     C/COPY WNCPYSRC,GL3271C209
      *                                                                   CGL004
     C           *IN29     IFEQ '1'                                       CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     CALL 'GLC2800'                                 CGL004
     C                     PARM *BLANK    RTCD                            CGL004
     C                     PARM ACKEY     ACCD                            CGL004
     C                     PARM 'E'       ACTN                            CGL004
     C                     ENDIF                                          CGL004
     C                     ENDIF                                          CGL004
     C/COPY WNCPYSRC,GL3271C210
      *                                                                   CGL004
     C                     MOVELWWRTRN    WFMT
     C                     END                             -E5
     C**
     C                     END                             -E4
     C**
     C                     END                             -E3
     C**
     C                     END                             -E2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP29                                           S01408
     C*                                                                   S01408
     C**
     C                     END                             -E1
     C**
     C                     ENDSR                           * #P10F3 EDSR *
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10F3   - PROCESS VALIDATION OF 'F3' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZALIGN   - TO VALIDATE A NUMERIC FIELD                           *
      * ZDATE1   - TO FORMAT AN ALPHA DATE IN MIDAS NUMBER               *
      * ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F3   - PROCESS CREDIT INTEREST DETAILS                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRIB    - WORK FIELD                                            *
      * WWNCID   - CREDIT INTEREST DATE                                  *
      * WWACK2   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWCUSK   - CUSTOMER NUMBER KEY                                   *
      * WWCCYK   - CURRENCY CODE KEY                                     *
      * WWACOK   - ACCOUNT CODE KEY                                      *
      * WWACSK   - ACCOUNT SEQUENCE KEY                                  *
      *                                                                  *
      ********************************************************************
     C           #V10F3    BEGSR
      *                                                                   174144
      ** Save RECI status and restore it at the end of the routine,       174144
      ** to prevent RECI being overwritten.                               174144
      *                                                                   174144
     C                     MOVELRECI      RECISV  1                       174144
     C*
     C                     MOVE '0'       *IN36
     C                     Z-ADD*ZEROS    WWCBRT                          077012
      *
     C********************************************************************
     C*                             PART 1
     C********************************************************************
     C                     MOVE SCRCD     #CRCD   6                      053943
     C                     Z-ADDSWVCRC    WWVCRC  50
     C                     MOVE *BLANKS   WWRIB
     C           SCRIB     IFNE *BLANKS                    IF01
     C           SCICT     IFNE *BLANKS                    IF02
     C           SCCST     ORNE *BLANKS
     C*
     C*200-DEBIT INTEREST CALCULATION MUST BE NOT BLANK IF SDRIB IS ENTRY
     C*
     C                     MOVEL'RE71300' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            EL02
     C*
     C                     MOVE SCRIB     WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFNE *BLANKS                    IF03
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C*
     C*201-DEBIT BASE RATE DOESN'T EXIST IN FILE TABLE
     C*
     C                     MOVEL'RE71301' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE
     C                     MOVE BABSRC    SCRIB                           073234
      *                                                                   073234
      * Check currency                                                    073234
     C           BACYCD    IFNE WWCCY                                     073234
     C                     MOVEL'RE71300' ZAMSID                          073234
     C                     EXSR ZASNMS                                    073234
     C                     MOVE '1'       *IN60                           073234
     C                     MOVE 'E'       ERR                             073234
     C                     ELSE                                           073234
      *                                                                   073234
     C                     Z-ADDBANBRT    WWCBRT
     C* Set control date limit for rate value date
     C           BAVDRC    IFGT WWVCRC
     C                     Z-ADDBAVDRC    WWVCRC  50
     C                     END                             EN03
     C                     END                                            073234
     C                     END                             EN03
     C                     END                             EN02
     C  N60                MOVE SCRIB     SSCRIB
     C                     ELSE
     C                     Z-ADD*ZEROS    SSCRIB
     C                     END                             EN01
      **   BASE RATE TYPE
     C********************************************************************
     C*                             PART 2
     C********************************************************************
      **   RATE / SPREAD
     C           SCRIS     IFNE *BLANKS
     C           SCSIG     ORNE *BLANKS
      *       CHECK VALID FORMAT
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE SCRIS     ZFIELD
     C                     Z-ADD4         ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZALIGN
     C   99                DO
     C                     MOVEL'RE71302' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     61
     C                     MOVE 'E'       ERR
     C                     END
      *       NOT ALLOWED IF INTEREST CALCULATION TYPE IS NO BLANKS.
     C           SCICT     IFNE *BLANKS
     C           SCCST     ORNE *BLANKS
     C                     MOVEL'RE71301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     61
     C                     MOVE 'E'       ERR
     C                     END
     C  N61                MOVE ZFIELD    SSCRIS
     C                     ELSE
     C                     Z-ADD*ZEROS    SSCRIS
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP70                                           S01408
      *                                                                   S01408
      **   SIGN FOR RATE/SPREAD
     C           SCSIG     IFNE *BLANKS
      *       NOT ALLOWED IF RATE/SPREAD IS BLANKS.
     C           SCRIS     IFEQ *BLANKS
     C                     MOVEL'RE71303' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     62
     C                     MOVE 'E'       ERR
     C                     END
      *       NOT ALLOWED IF INTEREST CALCULATION TYPE IS NO BLANKS
     C           SCICT     IFNE *BLANKS
     C           SCCST     ORNE *BLANKS
     C                     MOVEL'RE71301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     62
     C                     MOVE 'E'       ERR
     C                     END
      *       MUST BE '+' OR '-'
     C           SCSIG     IFNE '-'
     C           SCSIG     ANDNE'+'
     C                     MOVEL'RE71304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     62
     C                     MOVE 'E'       ERR
     C                     END
     C                     ELSE
     C           SCRIS     IFNE *BLANKS
     C                     MOVE '+'       SCSIG
     C                     END
     C                     END
     C           SCSIG     IFEQ '-'
     C           SSCRIS    ANDNE*ZEROS
     C                     Z-SUBSSCRIS    SSCRIS
     C                     END
     C**
      **   INTEREST CALCULATION TYPE & INTEREST CALCULATION SUB-TYPE
     C********************************************************************
     C*                         PART 4 & PART 5
     C********************************************************************
      **   INTEREST CALCULATION TYPE & INTEREST CALCULATION SUB-TYPE
     C           SCICT     IFNE *BLANKS
     C           SCCST     ORNE *BLANKS
     C/COPY WNCPYSRC,GL3271C139
      *       NOT ALLOWED IF BASE RATE TYPE IS NO BLANKS
     C           SCRIB     IFNE *BLANKS
     C                     MOVEL'RE71305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     END
      *       NOT ALLOWED IF RATE/SPREAD IS NO BLANKS
     C           SCRIS     IFNE *BLANKS
     C           SCSIG     ORNE *BLANKS
     C                     MOVEL'RE71306' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     END
      *       MANDATORY IF INTEREST CALC. TYPE IS ENTERED.
     C           SCCST     IFEQ *BLANKS
     C                     MOVEL'RE71307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     END
      *       MUST BE VALID ON FILE.
     C                     MOVE SCICT     TYPE
     C                     MOVE SCCST     SBTYPE
     C                     MOVE SCCY      CURR    3
     C                     MOVE 'D'       D
     C           KEY       CHAINREINT                50
     C           *IN50     IFEQ '1'
     C                     MOVEL'RE71308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     63
     C                     MOVE 'E'       ERR
     C                     ELSE                            EN03
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C115                                           S01408
      *                                                                   S01408
     C* Set control date limit for rate value date
     C           VDTC      IFGT WWVCRC
     C                     Z-ADDVDTC      WWVCRC
     C                     END                             EN03
     C           BRT       IFNE 0
     C                     MOVE BRT       WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFEQ *BLANKS                    IF03
     C           BAVDRC    IFGT WWVCRC
     C                     Z-ADDBAVDRC    WWVCRC  50
     C                     END                             EN03
     C                     Z-ADDBANBRT    WWCBRT 117
     C                     END
     C                     END                             EN03
     C*
     C                     END
     C/COPY WNCPYSRC,GL3271C140
     C                     END
     C  N63                MOVE SCICT     SSCICT
     C  N63                MOVE SCCST     SSAMAL
     C********************************************************************
     C*                             PART 6
     C********************************************************************
     C           SCRIB     IFEQ SACRIB                     BEG01
     C           SCRIS     ANDEQSACRIS
     C           SCICT     ANDEQSACICT
     C           SCSIG     ANDEQSACSIG
     C           SCCST     ANDEQSAAMAL
      *       MUST NOT BE ENTERED IF NO INTEREST DETAILS AMENDED
     C           SCRCD     IFNE *BLANKS                    - B2
     C                     MOVEL'RE71309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
      *
     C                     ELSE                            X--01
     C           SCRIB     IFNE SACRIB
     C           SCRIS     ORNE SACRIS
     C           SCICT     ORNE SACICT
     C           SCSIG     ORNE SACSIG
     C           SCCST     ORNE SAAMAL
      ********ELSE*MANDATORY                                              053943
      *       IF DATE IS NOT ENTERED CHECK ACTION                         053943
      *       IF ACTION CODE IS INSERT, USE SDACO FOR SDRCD               053943
     C           SCRCD     IFEQ *BLANKS                                   053943
     C           DDACTN    IFEQ 'I'                                       053943
     C                     MOVE SDACO     SCRCD                           053943
     C/COPY WNCPYSRC,GL3271C068
     C                     MOVE SCRCD     ZDATE                           053943
     C                     EXSR ZDATE1                                    053943
     C                     END                                            053943
      *       IF ACTION CODE IS AMEND, USE RUND FOR SDRCD                 053943
     C           DDACTN    IFEQ 'A'                                       053943
     C                     Z-ADDBJRDNB    ZDAYNO                          053943
     C                     EXSR ZDATE2                                    053943
     C                     MOVE ZDATE     SCRCD                           053943
     C                     END                                            053943
      *                                                                   053943
     C                     ELSE                                           053943
     C                     MOVE SCRCD     ZDATE
     C                     EXSR ZDATE1
     C                     END                                            053943
     C   99                DO                              BEG02
     C                     MOVEL'RE71310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C009
      *       CAN NOT BE FORWARD VALUE DATE.
     C           ZDAYNO    IFGT BJRDNB                     BEG02
     C                     MOVEL'RE71311' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C010
      *       CAN NOT BE EARLIER BACK VALUE PERIOD ON TABLE FILE.
     C           BJRDNB    SUB  BJBVPD    FWORK   50
     C           ZDAYNO    IFLT FWORK                      BEG02
     C                     MOVEL'RE71315' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C044
     C*  CANNOT BE LOWER THAN LIMIT DATE
     C           ZDAYNO    IFLT WWVCRC                     BEG02
     C                     MOVEL'RE71313' ZAMSID
     C*                                                                   110010
     C** This change value date cannot be earlier than base rate chg date 110010
     C*                                                                   110010
     C           WWVCRC    IFGT OLCR                                      110010
     C                     MOVE CICT      @CICT   2                       110010
     C                     MOVE CCST      @CCST   5                       110010
     C                     MOVE CRIB      @CRIB   2                       110010
     C           @CICT     IFNE SCICT                                     110010
     C           @CCST     ORNE SCCST                                     110010
     C           @CRIB     ORNE SCRIB                                     110010
     C                     Z-ADDWWVCRC    ZDAYNO                          110010
     C                     EXSR ZDATE2                                    110010
     C                     MOVE ZDATE     ZA0001                          110010
     C                     MOVEL'RE71239' ZAMSID                          110010
     C                     END                                            110010
     C                     END                                            110010
     C                     EXSR ZASNMS
     C                     SETON                     64
     C                     MOVE 'E'       ERR
     C                     END                             END02
     C/COPY WNCPYSRC,GL3271C045
     C                     END
     C*  CANNOT BE GREATER THAN PREVIOUS
     C           *IN64     IFEQ '0'
     C                     Z-ADDZDAYNO    SSDR9
     C                     END
     C                     END                             END01
     C********************************************************************
      **   CALCULATION BASIS
      *                                                                   073234
     C/COPY WNCPYSRC,GL3271C141
      * If CR calc. basis is blank and a/c is non-interest bearing,       073234
      * default it to the Default Interest Calc. Basis. If this is        073234
      * blank, default to '1'.                                            073234
     C           SCRIC     IFEQ *BLANK                                    073234
     C           SCRIB     ANDEQ*BLANK                                    073234
     C           SCRIS     ANDEQ*BLANK                                    073234
     C           SCSIG     ANDEQ*BLANK                                    073234
     C           SCICT     ANDEQ*BLANK                                    073234
     C           SCCST     ANDEQ*BLANK                                    073234
     C*                                                                   073234
     C           A6DICB    IFNE *BLANK                                    073234
     C                     MOVE A6DICB    SCRIC                           073234
     C                     ELSE                                           073234
     C                     MOVE '1'       SCRIC                           073234
     C                     END                                            073234
      *                                                                   073234
     C                     END                                            073234
      *                                                                   073234
     C/COPY WNCPYSRC,GL3271C048
     C           SCRIC     IFLT '1'
     C           SCRIC     ORGT '7'
     C                     MOVEL'RE71316' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     65
     C                     MOVE 'E'       ERR
     C                     END
     C/COPY WNCPYSRC,GL3271C049
     C  N65                MOVE SCRIC     SSCRIC
      **   NEXT CAPITALISATION
      *                                                                   073234
      * If cap. date & freq. are blank and a/c is non-interest bearing,   073234
      * default it to 'Z'.                                                073234
     C/COPY WNCPYSRC,GL3271C198
     C           SCRIF     IFEQ *BLANK                                    073234
     C           SNCID     ANDEQ*BLANK                                    073234
     C           SCRIB     ANDEQ*BLANK                                    073234
     C           SCRIS     ANDEQ*BLANK                                    073234
     C           SCSIG     ANDEQ*BLANK                                    073234
     C           SCICT     ANDEQ*BLANK                                    073234
     C           SCCST     ANDEQ*BLANK                                    073234
     C                     MOVE 'Z'       SCRIF                           073234
     C                     END                                            073234
      *                                                                   073234
     C           SCRIB     IFNE *BLANKS
     C           SCRIS     ORNE *BLANKS
     C           SCSIG     ORNE *BLANKS
     C           SDICT     ORNE *BLANKS
     C           SDCST     ORNE *BLANKS
     C           SCRIF     IFNE 'Z'
     C           SNCID     ANDEQ*BLANKS
     C                     MOVEL'RE71317' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     66
     C                     MOVE 'E'       ERR
     C                     END
     C                     END
      *       CHECK VALID DATE ENTERED
     C           SNCID     IFNE *BLANKS
     C                     MOVE SNCID     ZDATE
     C                     EXSR ZDATE1
     C   99                DO
     C                     MOVEL'RE71318' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     66
     C                     MOVE 'E'       ERR
     C                     END
      *       MUST BE GREATER OR EQUAL TO RUN DATE.
     C           ZDAYNO    IFLT BJRDNB
     C           ZDAYNO    OREQ BJRDNB
     C           WWDACO    ANDEQBJRDNB
     C           BMLDAI    ANDEQ'Y'
     C                     MOVEL'RE71319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     66
     C                     MOVE 'E'       ERR
     C                     END
     C  N66                Z-ADDZDAYNO    SSNCID
     C                     END
     C/COPY WNCPYSRC,GL3271C205
      **   CAPITALISATION FREQUENCY
      *       ENTRY MANDATORY IF DEBIT CAPIT. FREQUENCY IS NOT 'Z'
     C           SCRIF     IFNE 'Z'
     C           SNCID     ANDEQ*BLANKS
     C                     MOVEL'RE71320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     67
     C                     MOVE 'E'       ERR
     C                     END
     C           SNCID     IFEQ *BLANKS                                   178464
     C                     Z-ADD*ZEROS    SSNCID                          178464
     C                     ENDIF                                          178464
      ***********                                                   094336147954
      ****If*Credit*Capitalisation*Frequency*=*Z*(Demand)*then*Next*094336147954
      ****Credit*Capitalisation*Date*must*be*blank******************094336147954
      ***********                                                   094336147954
     C********** SCRIF     IFEQ 'Z'                                 094336147954
     C********** SNCID     IFNE *BLANKS                             094336147954
     C**********           MOVEL'RE71336' ZAMSID                    094336147954
     C**********           EXSR ZASNMS                              094336147954
     C**********           SETON                     66             094336147954
     C**********           MOVE 'E'       ERR                       094336147954
     C**********           ENDIF                                    094336147954
     C********** SNCID     IFEQ *BLANKS                             094336147954
     C**********           Z-ADD*ZEROS    SSNCID                    094336147954
     C**********           ENDIF                                    094336147954
     C**********           ENDIF                                    094336147954
      **********                                                    094336147954
      *       MUST BE A VALID STATEMENT FREQUENCY 'ABDFLMQRSTWXYZ'
     C           SCRIF     LOKUPFREQ                     50
     C  N50                DO
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP83                                           S01408
     C*                                                                   S01408
     C                     MOVEL'RE71321' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     67
     C                     MOVE 'E'       ERR
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP94                                           S01408
     C*                                                                   S01408
     C  N67                MOVE SCRIF     SSCRIF
     C*
     C**  Next Capitalisation Day Number
     C*
     C           SCRIF     IFEQ 'M'                        - B1
     C           SCRIF     OREQ 'T'
     C           SCRIF     OREQ 'Q'
     C           SCRIF     OREQ 'X'
     C           SCRIF     OREQ 'Y'
     C*
     C           SCNCD     IFNE *BLANKS
     C           SCNCD     ANDNE'00'
     C                     MOVE SCNCD     @CNCD   20
     C*
     C           @CNCD     IFLT 1
     C           @CNCD     ORGT 31
     C                     MOVEL'RE71853' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     68
     C                     MOVE 'E'       ERR
     C                     ELSE
     C                     Z-ADD@CNCD     SSCRDY
     C                     END
     C*
     C                     ELSE                            - X2
     C           *IN66     IFNE '1'                        - B3
     C                     Z-ADDZDAY      SSCRDY
     C                     END                             - X3
     C*
     C                     END                             - E2
     C                     ELSE                            - X1
     C           SCNCD     IFNE *BLANKS                    - B2
     C           SCNCD     ANDNE'00'
     C                     MOVEL'RE71854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN68
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X2
     C                     Z-ADD*ZEROS    SSCRDY
     C*
     C                     END                             - E2
     C                     END                             - E1
     C/COPY WNCPYSRC,GL3271C199
     C**
      **   ALTERNATIVE A/C TO POST CR INT.
     C********************************************************************
     C*                             PART 11
     C********************************************************************
     C*
     C** Validate Credit Branch
     C*
      *  If alternate entry Rate condition must exist
     C           SCACP     IFEQ *BLANK                     IF01
     C                     MOVE *BLANKS   SCRBR
     C                     ELSE                            X1
      *
     C           SCRBR     IFEQ *BLANKS
     C                     MOVELDBRN      SCRBR
     C                     END
      *  If alternate entry Can not be the account itself
     C           SCACP     IFEQ ACKEY1                     IF03
     C           SCRBR     ANDEQSBRCA
     C           SCACP     OREQ SACNO
     C                     MOVEL'RE71325' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
      *225- If alternate entry and amend mode the account can not be the
      *  alternate of another account.
     C                     ELSE                            X3
     C           *IN31     IFEQ '1'                        IF04
     C           *IN44     ANDEQ'1'
     C*
     C                     MOVEL'RE71325' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            X4
      *
      * Format of entry must be Retail A/c Number or Full Account
     C           @NDIGT    CHECKSCACP     @POSN1  30
     C           @NDIGT    CHECKSCACP:10  @POSN2  30
     C           ' '       CHECKSCACP:11  @POSN3  30
     C                     SELEC
     C           @POSN1    WHEQ 11
     C           @POSN3    ANDEQ*ZERO
      *
     C           @POSN1    WHEQ 7
     C           @POSN2    ANDEQ*ZERO
      *
     C                     OTHER
     C                     MOVEL'RE71324' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     ENDSL
      *
      *  If alternate entry account must exist and be live.
      *  alternate of another account.
     C                     MOVEL*BLANKS   ACKEYK
     C                     MOVELSCACP     ACKEYK
     C                     MOVE SCRBR     WWBRCK
     C           ACCKYK    IFEQ *BLANK
     C                     Z-ADDRETKK     WURKEY
     C                     MOVEL*BLANKS   SCRBR
     C                     MOVEL*BLANKS   WWBRCK
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP99                                           S01408
     C*                                                                   S01408
     C           WURKEY    CHAINACNUM                80
     C*
     C           *IN80     IFEQ '1'                        IF05
      *                                                                   174144
      ** Also check that a/c is not closed or about to close in COB.      174144
      *                                                                   174144
     C           RECI      ORNE 'D'                                       174144
     C           ACST      OREQ 'C'                                       174144
     C*
     C*224-Alternative account doesn't exist in FILE : ACCNTLXXOR ACNUM
     C*
     C                     MOVEL'RE71324' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     ELSE
     C*
     C*    Alternative account exist in FILE : ACNUM  Setup key
     C*
     C                     MOVE CNUM      WWCUSK
     C                     MOVE CCY       WWCCYK
     C                     MOVE ACOD      WWACOK
     C                     MOVE ACSQ      WWACSK
     C                     MOVE BRCA      WWBRCK
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C100                                           S01408
     C*                                                                   S01408
     C                     END                             EN05
     C                     END                             EN04
     C                     END                             E03
     C                     END                             E02
     C           ERR       IFNE 'E'                        IF05
     C           WWACK3    SETLLACCNTLXX                 80
     C           *IN80     IFEQ '0'                        IF02
     C*
     C*324-ALTERNATIVE ACCOUNT DOESN'T EXIST IN FILE : ACCNTLXXOR ACNUM
     C*
     C                     MOVEL'RE71324' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            EL02
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWBRCK    @BRCA   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71855' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     ELSE
     C                     MOVE A8BRCD    SSCRBR
     C                     END
     C*224-Alternative account can not have any alternate.
     C*
     C* Only if retail
     C           WWACK2    CHAINREIACDXF             80
     C           *IN80     IFEQ '0'                        IF02
     C           DACP      IFNE *BLANKS                    IF03
     C           CACP      ORNE *BLANKS
     C           CHAC      ORNE *BLANKS
     C                     MOVEL'RE71324' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN69
     C                     MOVE 'E'       ERR
     C                     END                             E03
     C                     END                             EN01
      *                                                                   174144
      ** Also check that the account has not been closed.                 174144
      *                                                                   174144
     C           RECI      IFNE 'D'                                       174144
     C           RECIRX    ORNE 'D'                                       174144
      *                                                                   174144
      ** Alternative account has been closed.                             174144
      *                                                                   174144
     C                     MOVEL'RE71324' ZAMSID                          174144
     C                     EXSR ZASNMS                                    174144
     C                     MOVE '1'       *IN69                           174144
     C                     MOVE 'E'       ERR                             174144
     C                     ENDIF                                          174144
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP4                                           S01408
     C*                                                                   S01408
     C                     END
     C*
     C           *IN69     IFEQ '0'                        IF02
     C                     MOVELACKEYK    WWCACP
     C                     END                             EN02
     C                     END                             EN01
     C                     END                             EN01
     C  N69                MOVELSCACP     SSCACP
     C  N69                MOVELSCRBR     SSCRBR
      **   CHARGE TYPE & SUB-TYPE
     C           SCHGT     IFNE *BLANKS
     C           SCHST     ORNE *BLANKS
     C                     SETOF                     50
     C                     MOVE SCHGT     TYPE
     C                     MOVE SCHST     SBTYPE
     C                     MOVE SCCY      CURR
     C                     MOVE 'D'       D
     C           KEY       CHAINRECRGDF              50
     C   50                DO
     C                     MOVEL'RE71326' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     7071
     C                     MOVE 'E'       ERR
     C                     END
     C                     END
     C  N70                MOVE SCHGT     SSCHGT
     C  N71                MOVE SCHST     SSMRT3
     C           JUMP      TAG
      **   ALTERNATIVE A/C TO POST CHARGE
      ********************************************************************086558
      *                             PART 11A                              086558
      ********************************************************************086558
     C           SCRIB     IFEQ *BLANKS                                   086558
     C           SCSIG     ANDEQ'-'                                       086558
      *                                                                   086558
      ** 238 - Rate/Spread (SCSIG) must not be '-' if a Base Rate Type    086558
      **       (SCRIB) is entered along with an Alternate account         086558
      **       (SCACP)                                                    086558
      *                                                                   086558
     C                     MOVEL'RE71238' ZAMSID                          086558
     C                     EXSR ZASNMS                                    086558
     C                     MOVE '1'       *IN62                           086558
     C                     MOVE 'E'       ERR                             086558
     C                     ENDIF                                          086558
     C********************************************************************
     C*                             PART 12
     C********************************************************************
     C*
     C** Validate Charge Branch
     C*
      *  If alternate entry Charge condition must exist
     C           SCHCP     IFEQ *BLANK                     IF01
     C                     MOVE *BLANKS   SCHBR
     C                     ELSE                            X1
      *
     C           SCHBR     IFEQ *BLANKS
     C                     MOVE DBRN      SCHBR
     C                     END
     C           SCHGT     IFEQ *BLANKS                    IF02
     C           SCHST     ANDEQ*BLANKS
     C                     MOVEL'RE71327' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C                     ELSE                            X02
      *  If alternate entry Can not be the account itself
     C           SCHCP     IFEQ ACKEY1                     IF03
     C           SCHBR     ANDEQSBRCA
     C           SCHCP     OREQ SACNO
     C                     MOVEL'RE71328' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
      *228- If alternate entry and amend mode the account can not be the
      *  alternate of another account.
     C                     ELSE                            X3
     C           *IN31     IFEQ '1'                        IF04
     C           *IN44     ANDEQ'1'
     C*
     C                     MOVEL'RE71326' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            X4
      *
      * Format of entry must be Retail A/c Number or Full Account
     C           @NDIGT    CHECKSCHCP     @POSN1  30
     C           @NDIGT    CHECKSCHCP:10  @POSN2  30
     C           ' '       CHECKSCHCP:11  @POSN3  30
     C                     SELEC
     C           @POSN1    WHEQ 11
     C           @POSN3    ANDEQ*ZERO
      *
     C           @POSN1    WHEQ 7
     C           @POSN2    ANDEQ*ZERO
      *
     C                     OTHER
     C                     MOVEL'RE71328' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C                     ENDSL
      *
      *  If alternate entry account must exist and be live.
      *  alternate of another account.
     C                     MOVEL*BLANKS   ACKEYK
     C                     MOVELSCHCP     ACKEYK
     C                     MOVE SCHBR     WWBRCK
     C           ACCKYK    IFEQ *BLANK
     C                     MOVE *BLANK    SCHBR
     C                     MOVE *BLANK    WWBRCK
     C                     Z-ADDRETKK     WURKEY
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C101                                           S01408
     C*                                                                   S01408
     C           WURKEY    CHAINACNUM                80
     C*
     C           *IN80     IFEQ '1'                        IF05
      *                                                                   174144
      ** Also check that a/c is not closed or about to close in COB.      174144
      *                                                                   174144
     C           RECI      ORNE 'D'                                       174144
     C           ACST      OREQ 'C'                                       174144
     C*
     C*224-Alternative account doesn't exist in FILE : ACCNTLXXOR ACNUM
     C*
     C                     MOVEL'RE71328' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C                     ELSE
     C*
     C*    Alternative account exist in FILE : ACNUM  Setup key
     C*
     C                     MOVE CNUM      WWCUSK
     C                     MOVE CCY       WWCCYK
     C                     MOVE ACOD      WWACOK
     C                     MOVE ACSQ      WWACSK
     C                     MOVE BRCA      WWBRCK
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C102                                           S01408
     C*                                                                   S01408
     C                     END                             EN05
     C                     END                             EN04
     C                     END                             E03
     C                     END                             E02
     C                     END
     C           ERR       IFNE 'E'                        IF05
     C           WWACK3    SETLLACCNTLXX                 80
     C           *IN80     IFEQ '0'                        IF02
     C*
     C*328-ALTERNATIVE ACCOUNT DOESN'T EXIST IN FILE : ACCNTLXXOR ACNUM
     C*
     C                     MOVEL'RE71328' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C*
     C                     ELSE                            EL02
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWBRCK    @BRCA   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71856' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C                     ELSE
     C                     MOVE A8BRCD    SSCHBR
     C                     END
     C*224-Alternative account can not have any alternate.
     C*
     C* Only if retail
     C           WWACK2    CHAINREIACDXF             80
     C           *IN80     IFEQ '0'                        IF02
     C           DACP      IFNE *BLANKS                    IF03
     C           CACP      ORNE *BLANKS
     C           CHAC      ORNE *BLANKS
     C                     MOVEL'RE71324' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN72
     C                     MOVE 'E'       ERR
     C                     END                             E03
     C                     END                             E02
      *                                                                   174144
      ** Also check that the account has not been closed.                 174144
      *                                                                   174144
     C           RECI      IFNE 'D'                                       174144
     C           RECIRX    ORNE 'D'                                       174144
      *                                                                   174144
      ** Alternative account has been closed.                             174144
      *                                                                   174144
     C                     MOVEL'RE71325' ZAMSID                          174144
     C                     EXSR ZASNMS                                    174144
     C                     MOVE '1'       *IN72                           174144
     C                     MOVE 'E'       ERR                             174144
     C                     ENDIF                                          174144
      *                                                                   174144
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCP5                                           S01408
     C*                                                                   S01408
     C                     END                             E02
     C*
     C           *IN72     IFEQ '0'                        IF02
     C                     MOVELACKEYK    WWCHCP
     C                     END                             EN02
     C                     END                             EN01
     C                     END                             EN01
     C  N72                MOVELSCHCP     SSCHCP
     C  N72                MOVELSCHBR     SSCHBR
      **   TRANSACTION CHARGE OVERIDE
     C           *IN18     IFEQ '1'
     C           SCHGT     IFEQ *BLANKS                    - B1
     C           SCHST     ANDEQ*BLANKS
     C           STCHO     ANDNE*BLANKS
     C                     MOVEL'RE71329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     73
     C                     MOVE 'E'       ERR
     C                     END                             - E1
     C           STCHO     IFNE *BLANKS                    - B1
      *       CHECK VALID FORMAT
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE STCHO     ZFIELD
     C                     Z-ADDWWDECS    ZADEC
     C           7         SUB  WWDECS    ZADIG
      *
     C                     EXSR ZALIGN
     C   99                DO                              - B2
     C                     MOVEL'RE71330' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     73
     C                     MOVE 'E'       ERR
     C                     END                             - E2
     C  N73                MOVE ZFIELD    SSTCHO
     C                     ELSE
     C                     Z-ADD*ZEROS    SSTCHO
     C                     END
     C                     END
      *                                                                   053943
     C           ERR       IFEQ 'E'                                       053943
     C                     MOVE #CRCD     SCRCD                           053943
     C                     END                                            053943
     C/COPY WNCPYSRC,GL3271C032
     C*                                                                   208221
     C** Check if Revenue Analysis (CDE002) is present                    208221
     C*                                                                   208221
     C           CDE002    IFEQ 'Y'                                       208221
     C*                                                                   208221
     C** Only default on Insert. Note if the rate/spread is zero,         208221
     C** the margin will default to zero                                  208221
     C*                                                                   208221
     C           DDACTN    IFEQ 'I'                                       208221
     C           SCRIB     IFNE *BLANKS                                   208221
     C                     Z-SUBSSCRIS    SWCRMG                          208221
     C                     MOVEL'Y'       SWOVRC                          208221
     C                     MOVEL'Y'       SOVRC                           208221
     C                     MOVEL*BLANKS   ZFLD15                          208221
     C                     MOVE SWCRMG    ZFLD15                          208221
     C                     Z-ADD7         ZDECS                           208221
     C                     MOVEL'L'       ZECODE                          208221
     C                     EXSR ZFRPED                                    208221
     C                     MOVE ZOUT22    SCRMG                           208221
     C                     ELSE                                           208221
     C                     MOVEL*BLANKS   SWCRMG                          208221
     C                     MOVEL*BLANKS   SWOVRC                          208221
     C                     MOVEL*BLANKS   SCRMG                           208221
     C                     MOVEL*BLANKS   SOVRC                           208221
     C                     END                                            208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          208221
      *                                                                   174144
      ** Restore RECI from saved value. Also more RECI into renamed       174144
      ** RECOMXX and RECOM RECI fields.                                   174144
      *                                                                   174144
     C                     MOVELRECISV    RECI                            174144
     C                     MOVELRECISV    RECIRE                          174144
     C                     MOVELRECISV    RECIRC                          174144
      *
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10F4   - PROCESS COMMISSIONS DETAILS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #P1034   - TRANSFER WORK FIELDS IN SCREEN FIELDS(4TH FORMAT)     *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      * #V10F4   - PROCESS VALIDATION OF 'F4' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      * WWACTN   - ACTION CODE                                           *
      *                                                                  *
      ********************************************************************
     C           #P10F4    BEGSR                           * #P10F1 BGSR *
     C*
      * Retrieve customer group                                           113843
     C                     EXSR #RTVCG                                    113843
      *                                                                   113843
      * Retrieve defaults for commissions                                 113843
     C                     EXSR #RTVCM                                    113843
     C*                                                                   113843
     C**  Set start screen indicator
     C                     MOVE ' '       ERR     1
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVEA'0000'    *IN,53                          CDE002
     C                     MOVELSSANAM    SANAM
     C*
     C**  CLEAR WHOLE SCREEN
     C                     WRITEGL3271FC
     C/COPY WNCPYSRC,GL3271C059
     C**
     C           WFMT      DOUNE'F4'                       -B1
     C**
     C                     WRITEGL3271C1
     C                     EXFMTGL3271F4
     C                     MOVEL*BLANK    ERR
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVEA'0000'    *IN,53                          CDE002
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C                     END
     C*
     C**  F3 PRESSED - EXIT OF PROGRAM
     C           *INKC     IFEQ '1'                        -B2
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C238
     C                     END                             -E2
     C*
     C**  F12 PRESSED - PREVIOUS SCREEN
     C           *INKL     IFEQ '1'                        -B2
     C                     MOVELWWRTRN    WFMT
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP47                                           S01408
      *                                                                   S01408
     C                     END                             -E2
     C*
     C**  F5 PRESSED - REFRESH
     C           *INKE     IFEQ '1'                        -B2
     C** ENQUIRY F5 NOT ALLOWED
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C** AMEND RETURN TO FIRST SCREEN
     C           *IN31     IFEQ '1'
     C           *IN30     OREQ '1'
     C                     EXSR #P1034
     C                     END                             -E3
     C                     END                             -E2
     C**  F9 PRESSED - REFRESH  ALL
     C           *INKI     IFEQ '1'                        -B2
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C**
     C           *IN30     IFEQ '1'                        -B3
     C                     MOVEL'FK'      WFMT
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       *IN69
     C                     END                             -E3
     C**
     C           *IN31     IFEQ '1'
     C                     EXSR #P1030
     C           WWACTN    IFEQ 'A'
     C           WWACTN    OREQ 'E'
     C                     MOVEL'F1'      WFMT
     C                     ELSE
     C                     MOVEL'F1'      WFMT
     C                     MOVE WWACTN    WFMT
     C                     END
     C                     END                             -E3
     C                     END                             -E2
     C*
     C**  F8 PRESSED - FROM ENQUIRY TO AMEND MODE
     C           *INKH     IFEQ '1'                        -B2
     C* IF MULTIBRANCHING DO VALIDATION ON BRANCH INPUT                   097616
     C           BJSBRC    IFEQ *BLANKS                                   097616
     C                     MOVEL'A'       @ZACTN                          097616
     C                     MOVELSBRCA     @BRCA                           097616
     C                     EXSR #AUTH                                     097616
     C           @ERR      IFNE 0                                         097616
     C                     MOVEL'RE7103B' ZAMSID                          097616
     C                     EXSR ZASNMS                                    097616
     C                     MOVEL'E'       ERR                             097616
     C                     END                                            097616
     C                     END                                            097616
     C*
     C**  USER MUST BE AUTHORISED AND ACTION MODE IS ENQUIRY
     C           *IN41     IFEQ '1'                        -B3
     C           *IN32     ANDEQ'1'
     C           ERR       ANDEQ*BLANKS                                   097616
     C           *IN39     IFEQ '0'
     C*
     C**  UNPROTECT FIELDS AND REDISPLAY
     C                     MOVEA'0100'    *IN,30
     C                     MOVE 'A'       DDACTN
     C                     ELSE                            -X3
     C*
     C** ERROR MESSAGE
     C                     MOVEL'RE71003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ROLLDOWN PRESSED - VALIDATION AND PREVIOUS SCREEN
     C           *IN26     IFEQ '1'                        -B2
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F4
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
     C                     MOVEL'F3'      WFMT
     C                     END                             -E3
     C*
     C                     END                             -E2
     C**  ROLLUP          PRESSED - VALIDATION AND NEXT SCREEN
     C           *IN25     IFEQ '1'                        -B2
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F4
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
     C           *IN32     IFEQ '1'
     C           WWACTN    ANDEQ'4'
     C           *IN49     ANDEQ'0'
     C                     MOVELWWRTRN    WFMT
     C                     ELSE
     C                     MOVEL'F5'      WFMT
     C                     END                             -E3
     C                     END                             -E3
     C                     END                             -E2
     C**  ENTER    PRESSED - VALIDATION AND CORRECT  SCREEN
     C           *IN49     IFEQ '0'                        -B2
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F4
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
     C           ERR       OREQ 'W'                                                           208221
     C           WFLAG     ANDEQ'Y'                                                           208221
     C           ERR       IFEQ 'W'                                                           208221
     C                     CALL 'ZA0250'                                                      208221
     C                     SETOF                     54  56                                   208221
     C                     END                                                                208221
     C           *IN30     IFEQ '1'                        -B4
     C           WWACTN    OREQ 'A'
     C           WWACTN    OREQ 'E'
     C                     MOVEL'F5'      WFMT
     C                     END                             -E4
     C           *IN31     IFEQ '1'
     C           WWACTN    ANDNE'A'
     C                     MOVEL'UP'      WFMT
     C                     END
     C           *IN32     IFEQ '1'
     C           WWACTN    ANDNE'E'
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C121                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD                            S01522
     C                     PARM 'E'       ACTN                            S01522
     C                     PARM ACKEY     ACCD                            S01522
     C                     END                                            S01522
      *                                                                   CGL004
      ** If Midas-Fontis Interface is switched on, call program to        CGL004
      ** display Fontis account details.                                  CGL004
     C/COPY WNCPYSRC,GL3271C211
      *                                                                   CGL004
     C           *IN29     IFEQ '1'                                       CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     CALL 'GLC2800'                                 CGL004
     C                     PARM *BLANK    RTCD                            CGL004
     C                     PARM ACKEY     ACCD                            CGL004
     C                     PARM 'E'       ACTN                            CGL004
     C                     ENDIF                                          CGL004
     C                     ENDIF                                          CGL004
     C/COPY WNCPYSRC,GL3271C212
      *                                                                   CGL004
     C                     MOVELWWRTRN    WFMT
     C                     END                             -E4
     C                     END                             -E3
     C*
     C                     END                             -E2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP30                                           S01408
     C*                                                                   S01408
     C           ERR       IFEQ 'W'                                                           208221
     C                     MOVEL'Y'       WFLAG   1                                           208221
     C                     END                                                                208221
     C*
     C                     END                             -E1
     C*
     C                     ENDSR                           * #P10F4 EDSR *
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10F4   - PROCESS VALIDATION OF 'F4' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      * ZALIGN   - TO VALIDATE A NUMERIC FIELD                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F4   - PROCESS COMMISSIONS DETAILS                           *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCNUM   - CUSTOMER NUMBER                                       *
      * WWDIG    - NUMBER OF DIGITS                                      *
      * WWDECS   - NUMBER OF DECIMALS                                    *
      * WWAMT    - WORK FIELD - AMOUNT                                   *
      * WWMONT   - WORK FIELD                                            *
      * WWCEXX   - WORK ARRAY                                            *
      *                                                                  *
      ********************************************************************
     C           #V10F4    BEGSR                           ** #V10F4 BSR *
     C*
     C                     MOVE '0'       *IN36
     C*
     C** ACCESS CUSTOMER GROUP IN SDCUSTX0
     C*
     C                     MOVELWWCNUM    #CNUM   6
     C*****                CALL 'AOCUSTR0'                                178695
     C                     CALL 'AOCUSTR1'                                178695
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM #CNUM     @CNUM  10
     C                     PARM           @CNST   7
     C*****      SDCUST    PARM SDCUST    DSSDY                           178695
     C           SDCUST    PARM SDCUST    DSLDY                           178695
     C/COPY WNCPYSRC,GL3271C223
     C           @RTCD     IFNE *BLANKS                    - B1
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71450' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
      *                                                                   072879
     C                     ELSE                                           072879
     C                     MOVE BBCUST    SCNUM                           072879
     C                     END                             - E1
     C*
     C           BBCGRP    IFEQ *BLANK
     C                     MOVEL'1'       BBCGRP
     C                     END
     C*
     C** CHECK IF CUSTOMER GROUP IS OK
     C*
     C                     Z-ADD1         I1      20
     C           BBCGRP    LOKUPGRP,I1                   10
     C*
     C           *IN10     IFNE '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD2         DBASE            ***************
     C                     MOVEL'SDCUSTPD'DBFILE           **DB ERROR 02**
     C                     MOVEL#CNUM     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             - E1
     C*-------------------------------------------------------------------
     C*
     C** CHECK IF COMMISSION ON HIGHEST OVERDRAFT PRESENT
     C*
     C           *IN12     IFEQ '1'                        - B1
     C           IN2,I1    IFEQ 'N'                        - B2
     C*
     C** FIELDS CAN BE FILL ONLY IF COMMISSION IS APPLICABLE
     C*
     C           SCEXA     IFNE *BLANKS                    - B3
     C                     MOVEL'RE71400' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60
     C                     MOVE '1'       ERR
     C                     END                             - E3
     C                     ELSE                            - X2
     C*
     C** IF COMMISSION IS ACTIVE CHECK IF THERE IS ONE FOR THE ACCOUNT
     C*
     C           SCEXA     IFNE *BLANKS                    - B3
     C*
     C** CHECK IF EXEMPT OR NOT
     C*
     C                     MOVEASCEXA     CEX
     C                     Z-ADD1         I       20
     C           CEX,I     DOWNE'E'                        - B4
     C           I         ANDLE11
     C                     ADD  1         I
     C                     END                             - E4
     C           CEX,I     IFEQ 'E'                        - B4
     C                     MOVE ' '       CEX,I
     C                     MOVE 'E'       CEX,1
     C                     MOVEACEX       SCEXA
     C                     MOVE *BLANKS   SSCEXA
     C                     MOVEL'E'       SSCEXA
     C                     ELSE                            - X4
     C*
     C** IF THERE IS A RATE CHECK IF IT IS RIGHT
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSCEXA     ZFIELD
     C                     Z-ADD2         ZADIG
     C                     Z-ADD8         ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B5
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    SSCEXA
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE
     C                     MOVE *BLANKS   SSCEXA
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*-------------------------------------------------------------------
     C*
     C** CHECK IF ACCOUNT COMMISSION (DEBIT TURNOVER) IS PRESENT
     C*
     C           *IN11     IFEQ '1'                        - B1
     C           IN1,I1    IFEQ 'N'                        - B2
     C*
     C** FIELDS CAN BE FILL ONLY IF COMMISSION IS APPLICABLE
     C*
     C           SCEXB     IFNE *BLANKS                    - B3
     C                     MOVEL'RE71401' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61
     C                     MOVE '1'       ERR
     C                     END                             - E3
     C                     ELSE                            - X2
     C*
     C** IF COMMISSION IS ACTIVE CHECK IF THERE IS ONE FOR THE ACCOUNT
     C*
     C           SCEXB     IFNE *BLANKS                    - B3
     C*
     C** CHECK IF EXEMPT OR NOT
     C*
     C                     MOVEASCEXB     CEX
     C                     Z-ADD1         I
     C           CEX,I     DOWNE'E'                        - B4
     C           I         ANDLE11
     C                     ADD  1         I
     C                     END                             - E4
     C           CEX,I     IFEQ 'E'                        - B4
     C                     MOVE ' '       CEX,I
     C                     MOVE 'E'       CEX,1
     C                     MOVEACEX       SCEXB
     C                     MOVE *BLANKS   SSCEXB
     C                     MOVEL'E'       SSCEXB
     C                     ELSE                            - X4
     C*
     C** IF THERE IS A RATE CHECK IF IT IS RIGHT
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSCEXB     ZFIELD
     C                     Z-ADD2         ZADIG
     C                     Z-ADD8         ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B5
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    SSCEXB
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE
     C                     MOVE *BLANKS   SSCEXB
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*-------------------------------------------------------------------
     C*
     C** CHECK IF COMMISSION ON DEBIT INTEREST IS PRESENT
     C*
     C           *IN15     IFEQ '1'                        - B1
     C           IN3,I1    IFEQ 'N'                        - B2
     C*
     C** FIELDS CAN BE FILL ONLY IF COMMISSION IS APPLICABLE
     C*
     C           SCEXC     IFNE *BLANKS                    - B3
     C                     MOVEL'RE71402' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62
     C                     MOVE '1'       ERR
     C                     END                             - E3
     C                     ELSE                            - X2
     C*
     C** IF COMMISSION IS ACTIVE CHECK IF THERE IS ONE FOR THE ACCOUNT
     C*
     C           SCEXC     IFNE *BLANKS                    - B3
     C*
     C** CHECK IF EXEMPT OR NOT
     C*
     C                     MOVEASCEXC     CEX
     C                     Z-ADD1         I
     C           CEX,I     DOWNE'E'                        - B4
     C           I         ANDLE11
     C                     ADD  1         I
     C                     END                             - E4
     C           CEX,I     IFEQ 'E'                        - B4
     C                     MOVE ' '       CEX,I
     C                     MOVE 'E'       CEX,1
     C                     MOVEACEX       SCEXC
     C                     MOVE *BLANKS   SSCEXC
     C                     MOVEL'E'       SSCEXC
     C                     ELSE                            - X4
     C*
     C** IF THERE IS A RATE CHECK IF IT IS RIGHT
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSCEXC     ZFIELD
     C                     Z-ADD2         ZADIG
     C                     Z-ADD8         ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B5
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    SSCEXC
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE
     C                     MOVE *BLANKS   SSCEXC
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*-------------------------------------------------------------------
     C*
     C** CHECK IF INACTIVE ACCOUNT COMMISSION IS PRESENT
     C*
     C           *IN17     IFEQ '1'                        - B1
     C           IN4,I1    IFEQ 'N'                        - B2
     C*
     C** FIELDS CAN BE FILL ONLY IF COMMISSION IS APPLICABLE
     C*
     C           SCEXD     IFNE *BLANKS                    - B3
     C                     MOVEL'RE71403' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63
     C                     MOVE '1'       ERR
     C                     END                             - E3
     C                     ELSE                            - X2
     C*
     C** IF COMMISSION IS ACTIVE CHECK IF THERE IS ONE FOR THE ACCOUNT
     C*
     C           SCEXD     IFNE *BLANKS                    - B3
     C*
     C** CHECK IF EXEMPT OR NOT
     C*
     C                     MOVEASCEXD     CEX
     C                     Z-ADD1         I
     C           CEX,I     DOWNE'E'                        - B4
     C           I         ANDLE8
     C                     ADD  1         I
     C                     END                             - E4
     C           CEX,I     IFEQ 'E'                        - B4
     C                     MOVE ' '       CEX,I
     C                     MOVE 'E'       CEX,1
     C                     MOVEACEX       SCEXD
     C                     MOVE *BLANKS   SSCEXD
     C                     MOVEL'E'       SSCEXD
     C                     ELSE                            - X4
     C*
     C** IF THERE IS A RATE CHECK IF IT IS RIGHT
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSCEXD     ZFIELD
     C                     Z-ADDWWDIG     ZADIG
     C                     Z-ADDWWDECS    ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B5
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    WWAMT
     C                     Z-ADDWWAMT     WWMONT
     C                     MOVE WWCEXX    SSCEXD
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE
     C                     MOVE *BLANKS   SSCEXD
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*-------------------------------------------------------------------
     C*
     C** CHECK IF COMMISSION ON MINIMUM AVERAGE CREDIT BALANCE
     C*
     C           *IN16     IFEQ '1'                        - B1
     C           IN5,I1    IFEQ 'N'                        - B2
     C*
     C** FIELDS CAN BE FILL ONLY IF COMMISSION IS APPLICABLE
     C*
     C           SCEXE     IFNE *BLANKS                    - B3
     C                     MOVEL'RE71404' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN64
     C                     MOVE '1'       ERR
     C                     END                             - E3
     C                     ELSE                            - X2
     C*
     C** IF COMMISSION IS ACTIVE CHECK IF THERE IS ONE FOR THE ACCOUNT
     C*
     C           SCEXE     IFNE *BLANKS                    - B3
     C*
     C** CHECK IF EXEMPT OR NOT
     C*
     C                     MOVEASCEXE     CEX
     C                     Z-ADD1         I
     C           CEX,I     DOWNE'E'                        - B4
     C           I         ANDLE8
     C                     ADD  1         I
     C                     END                             - E4
     C           CEX,I     IFEQ 'E'                        - B4
     C                     MOVE ' '       CEX,I
     C                     MOVE 'E'       CEX,1
     C                     MOVEACEX       SCEXE
     C                     MOVE *BLANKS   SSCEXE
     C                     MOVEL'E'       SSCEXE
     C                     ELSE                            - X4
     C*
     C** IF THERE IS A RATE CHECK IF IT IS RIGHT
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSCEXE     ZFIELD
     C                     Z-ADDWWDIG     ZADIG
     C                     Z-ADDWWDECS    ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B5
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN64
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    WWAMT
     C                     Z-ADDWWAMT     WWMONT
     C                     MOVE WWCEXX    SSCEXE
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE
     C                     MOVE *BLANKS   SSCEXE
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*-------------------------------------------------------------------
     C*
     C** CHECK IF CHARGE ON NUMBER OF DAILY STATEMENTS
     C*
     C           *IN14     IFEQ '1'                        - B1
     C           IN6,I1    IFEQ 'N'                        - B2
     C           SSTFQ     ORNE 'E'
     C/COPY WNCPYSRC,GLH00820
     C*
     C** FIELDS CAN BE FILL ONLY IF COMMISSION IS APPLICABLE
     C*
     C           SCEXF     IFNE *BLANKS                    - B3
     C*******    SNOCC     ANDNE*BLANKS                                   119285
     C           SNOCC     ORNE *BLANKS                                   119285
     C                     MOVEL'RE71405' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN65
     C                     MOVE '1'       ERR
     C                     ELSE                            - X3           119285
     C                     MOVE SCEXF     SSCEXF                          119285
     C                     MOVE SNOCC     SSNOCC                          119285
     C                     END                             - E3
     C                     ELSE                            - X2
     C*
     C** IF COMMISSION IS ACTIVE CHECK IF THERE IS ONE FOR THE ACCOUNT
     C*
     C           SCEXF     IFNE *BLANKS                    - B3
     C*
     C** CHECK IF EXEMPT OR NOT
     C*
     C                     MOVEASCEXF     CEX
     C                     Z-ADD1         I
     C           CEX,I     DOWNE'E'                        - B4
     C           I         ANDLE8
     C                     ADD  1         I
     C                     END                             - E4
     C           CEX,I     IFEQ 'E'                        - B4
     C                     MOVE ' '       CEX,I
     C                     MOVE 'E'       CEX,1
     C                     MOVEACEX       SCEXF
     C                     MOVE *BLANKS   SSCEXF
     C                     MOVEL'E'       SSCEXF
     C*
     C** CHECK NUMBER OF COPIES
     C*
     C           SNOCC     IFNE *BLANKS                    - B5
     C                     MOVEL'RE71407' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       ERR
     C                     ELSE                            - X5           119285
     C                     MOVE SNOCC     SSNOCC                          119285
     C                     END                             - E5
     C                     ELSE                            - X4
     C*
     C** IF THERE IS A RATE CHECK IF IT IS RIGHT
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSCEXF     ZFIELD
     C                     Z-ADDWWDIG     ZADIG
     C                     Z-ADDWWDECS    ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B5
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN65
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    WWAMT
     C                     Z-ADDWWAMT     WWMONT
     C                     MOVE WWCEXX    SSCEXF
     C                     END
     C*
     C** CHECK NUMBER OF COPIES
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE SNOCC     ZFIELD
     C                     Z-ADD*ZEROS    ZADEC
     C                     Z-ADD2         ZADIG
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'
     C                     MOVEL'RE71408' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       ERR
     C                     ELSE
     C                     MOVE ZFIELD    SSNOCC
     C           SSNOCC    IFGT SSENOC                     - B6
     C                     MOVEL'RE71408' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       ERR
     C                     ELSE                            - X6
     C                     MOVE ZFIELD    SNOCC
     C                     END                             - E6
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE                            - X3
     C                     MOVE *BLANKS   SSCEXF
     C           SNOCC     IFNE *BLANKS                    - B4
     C*
     C** CHECK NUMBER OF COPIES
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE SNOCC     ZFIELD
     C                     Z-ADD*ZEROS    ZADEC
     C                     Z-ADD2         ZADIG
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    SSNOCC
     C           *IN99     IFEQ '1'                        - B5
     C           SSNOCC    ORGT SSENOC
     C                     MOVEL'RE71408' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    SNOCC
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*-------------------------------------------------------------------
     C*
     C** CHECK IF FIXED COMMISSION IS PRESENT
     C*
     C           *IN13     IFEQ '1'                        - B1
     C           IN7,I1    IFEQ 'N'                        - B2
     C*
     C** FIELDS CAN BE FILL ONLY IF COMMISSION IS APPLICABLE
     C*
     C           SCEXG     IFNE *BLANKS                    - B3
     C                     MOVEL'RE71406' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN67
     C                     MOVE '1'       ERR
     C                     END                             - E3
     C                     ELSE                            - X2
     C*
     C** IF COMMISSION IS ACTIVE CHECK IF THERE IS ONE FOR THE ACCOUNT
     C*
     C           SCEXG     IFNE *BLANKS                    - B3
     C*
     C** CHECK IF EXEMPT OR NOT
     C*
     C                     MOVEASCEXG     CEX
     C                     Z-ADD1         I
     C           CEX,I     DOWNE'E'                        - B4
     C           I         ANDLE8
     C                     ADD  1         I
     C                     END                             - E4
     C           CEX,I     IFEQ 'E'                        - B4
     C                     MOVE ' '       CEX,I
     C                     MOVE 'E'       CEX,1
     C                     MOVEACEX       SCEXG
     C                     MOVE *BLANKS   SSCEXG
     C                     MOVEL'E'       SSCEXG
     C                     ELSE                            - X4
     C*
     C** IF THERE IS A RATE CHECK IF IT IS RIGHT
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELSCEXG     ZFIELD
     C                     Z-ADDWWDIG     ZADIG
     C                     Z-ADDWWDECS    ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B5
     C                     MOVEL'RE71203' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN67
     C                     MOVE 'E'       ERR
     C                     ELSE                            - X5
     C                     MOVE ZFIELD    WWAMT
     C                     Z-ADDWWAMT     WWMONT
     C                     MOVE WWCEXX    SSCEXG
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE
     C                     MOVE *BLANKS   SSCEXG
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
      *                                                                   CDE002
      *-------------------------------------------------------------------CDE002
      *                                                                   CDE002
      ** Check if Revenue Analysis (CDE002) is present                    CDE002
      *                                                                   CDE002
     C           CDE002    IFEQ 'Y'                                       CDE002
      *                                                                   CDE002
      ** Dr Interest Margin Override can only be 'Y' or blank             CDE002
      *                                                                   CDE002
     C           SOVRD     IFNE *BLANKS                                   CDE002
     C           SOVRD     ANDNE'Y'                                       CDE002
     C                     MOVEL'RE71409' ZAMSID                          CDE002
     C                     EXSR ZASNMS                                    CDE002
     C                     MOVE '1'       *IN55                           CDE002
     C                     MOVE '1'       ERR                             CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
      ** Dr Interest Margin can only be entered if its Override is 'Y'.   CDE002
      ** If entered it must be a number with 4 integers and 7 decimals.   CDE002
      *                                                                   CDE002
     C           SDRMG     IFNE *BLANKS                                   CDE002
      *                                                                   CDE002
     C           SOVRD     IFNE 'Y'                                       CDE002
     C                     MOVEL'RE71410' ZAMSID                          CDE002
     C                     EXSR ZASNMS                                    CDE002
     C                     MOVE '1'       *IN56                           CDE002
     C                     MOVE '1'       ERR                             CDE002
     C                     ELSE                                           CDE002
      *                                                                   CDE002
     C** Need to allow negative values                                    208221
     C*                                                                   208221
     C                     MOVE *BLANKS   ZFIELD                          CDE002
     C****************     MOVE SDRMG     ZFIELD                    CDE002208221
     C****************     Z-ADD4         ZADIG                     CDE002208221
     C****************     Z-ADD7         ZADEC                     CDE002208221
     C****************     EXSR ZALIGN                              CDE002208221
     C                     MOVE *BLANKS   ZFLD17                          208221
     C                     MOVE SDRMG     ZFLD17                          208221
     C                     Z-ADD4         ZSDIG                           208221
     C                     Z-ADD7         ZSDEC                           208221
     C                     EXSR ZASIGN                                    208221
      *                                                                   CDE002
     C           *IN99     IFEQ *ON                                       CDE002
     C*                                                                   208221
     C** Allow input of base rate                                         208221
     C*                                                                   208221
     C                     MOVELSDRMG     WWMG                            208221
     C           WWMBLK    IFEQ *BLANKS                                   208221
     C           WWMCCY    ANDNE*BLANKS                                   208221
     C           WWMBR     ANDNE*BLANKS                                   208221
     C           WWMQ1     OREQ '?'                                       208221
     C           WWMQ2     OREQ '?'                                       208221
     C           WWMQ3     OREQ '?'                                       208221
     C           WWMQ4     OREQ '?'                                       208221
     C           WWMQ5     OREQ '?'                                       208221
     C                     CALL 'AOBSRTR0'                                208221
     C                     PARM '*MSG   ' @RTCD                           208221
     C                     PARM '*KEY   ' @OPTN                           208221
     C                     PARM WWMCCY    @CYCD                           208221
     C                     PARM WWMBR     @BSRC                           208221
     C           SDBSRT    PARM SDBSRT    DSSDY                           208221
     C*                                                                   208221
     C           @RTCD     IFNE *BLANKS                                   208221
     C*                                                                   208221
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE              208221
     C*                                                                   208221
     C           *IN36     IFEQ '0'                                       208221
     C                     CALL 'ZA0250'                                  208221
     C                     MOVE '1'       *IN36                           208221
     C                     END                                            208221
     C*                                                                   208221
     C*412-DEBIT MARGIN BASE RATE DOESN'T EXIST IN FILE TABLE             208221
     C*                                                                   208221
     C                     MOVEL'RE71412' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN56                           208221
     C                     MOVE 'E'       ERR                             208221
     C*                                                                   208221
     C                     ELSE                                           208221
     C                     MOVE BABSRC    WWMBR                           208221
     C*                                                                   208221
     C** Check currency                                                   208221
     C*                                                                   208221
     C           BACYCD    IFNE WWCCY                                     208221
     C                     MOVEL'RE71413' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN56                           208221
     C                     MOVE 'E'       ERR                             208221
     C                     ELSE                                           208221
      *                                                                   208221
     C                     MOVELBACYCD    WWMCCY                          208221
     C                     ENDIF                                          208221
     C                     MOVELWWMG      SDRMG                           208221
     C                     MOVELWWMG      SSDMBR                          208221
     C                     MOVEL*BLANKS   SSDRMG                          208221
     C                     ENDIF                                          208221
     C                     ELSE                                           208221
     C                     MOVE *BLANKS   SSDRMG                          CDE002
     C                     MOVEL'RE71411' ZAMSID                          CDE002
     C                     EXSR ZASNMS                                    CDE002
     C                     MOVE '1'       *IN56                           CDE002
     C                     MOVE '1'       ERR                             CDE002
     C                     ENDIF                                          208221
     C                     ELSE                                           CDE002
     C***************      MOVE ZFIELD    SSDRMG                    CDE002208221
     C                     MOVE ZOUT15    SSDRMG                          208221
     C                     MOVE *BLANKS   SSDMBR                          208221
     C*                                                                   208221
     C           ZFSIGN    IFEQ '-'                                       208221
     C                     Z-SUBSSDRMG    SSDRMG                          208221
     C                     MOVEL'RE71414' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN56                           208221
     C           ERR       IFEQ *BLANKS                                   208221
     C                     MOVE 'W'       ERR                             208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C                     ELSE                                           CDE002
     C                     MOVE *BLANKS   SSDRMG                          CDE002
     C                     MOVE *BLANKS   SSDMBR                          208221
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
      ** Cr Interest Margin Override can only be 'Y' or blank             CDE002
      *                                                                   CDE002
     C           SOVRC     IFNE *BLANKS                                   CDE002
     C           SOVRC     ANDNE'Y'                                       CDE002
     C                     MOVEL'RE71409' ZAMSID                          CDE002
     C                     EXSR ZASNMS                                    CDE002
     C                     MOVE '1'       *IN53                           CDE002
     C                     MOVE '1'       ERR                             CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
      ** Cr Interest Margin can only be entered if its Override is 'Y'.   CDE002
      ** If entered it must be a number with 4 integers and 7 decimals.   CDE002
      *                                                                   CDE002
     C           SCRMG     IFNE *BLANKS                                   CDE002
      *                                                                   CDE002
     C           SOVRC     IFNE 'Y'                                       CDE002
     C                     MOVEL'RE71410' ZAMSID                          CDE002
     C                     EXSR ZASNMS                                    CDE002
     C                     MOVE '1'       *IN54                           CDE002
     C                     MOVE '1'       ERR                             CDE002
     C                     ELSE                                           CDE002
      *                                                                   CDE002
     C** Need to allow negative values                                    208221
     C*                                                                   208221
     C                     MOVE *BLANKS   ZFIELD                          CDE002
     C****************     MOVE SCRMG     ZFIELD                    CDE002208221
     C****************     Z-ADD4         ZADIG                     CDE002208221
     C****************     Z-ADD7         ZADEC                     CDE002208221
     C****************     EXSR ZALIGN                              CDE002208221
     C                     MOVE *BLANKS   ZFLD17                          208221
     C                     MOVE SCRMG     ZFLD17                          208221
     C                     Z-ADD4         ZSDIG                           208221
     C                     Z-ADD7         ZSDEC                           208221
     C                     EXSR ZASIGN                                    208221
      *                                                                   CDE002
     C           *IN99     IFEQ *ON                                       CDE002
     C*                                                                   208221
     C** Allow input of base rate                                         208221
     C*                                                                   208221
     C                     MOVELSCRMG     WWMG                            208221
     C           WWMBLK    IFEQ *BLANKS                                   208221
     C           WWMCCY    ANDNE*BLANKS                                   208221
     C           WWMBR     ANDNE*BLANKS                                   208221
     C           WWMQ1     OREQ '?'                                       208221
     C           WWMQ2     OREQ '?'                                       208221
     C           WWMQ3     OREQ '?'                                       208221
     C           WWMQ4     OREQ '?'                                       208221
     C           WWMQ5     OREQ '?'                                       208221
     C                     CALL 'AOBSRTR0'                                208221
     C                     PARM '*MSG   ' @RTCD                           208221
     C                     PARM '*KEY   ' @OPTN                           208221
     C                     PARM WWMCCY    @CYCD                           208221
     C                     PARM WWMBR     @BSRC                           208221
     C           SDBSRT    PARM SDBSRT    DSSDY                           208221
     C*                                                                   208221
     C           @RTCD     IFNE *BLANKS                                   208221
     C*                                                                   208221
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE              208221
     C*                                                                   208221
     C           *IN36     IFEQ '0'                                       208221
     C                     CALL 'ZA0250'                                  208221
     C                     MOVE '1'       *IN36                           208221
     C                     END                                            208221
     C*                                                                   208221
     C*412-CREDIT MARGIN BASE RATE DOESN'T EXIST IN FILE TABLE            208221
     C*                                                                   208221
     C                     MOVEL'RE71412' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN54                           208221
     C                     MOVE 'E'       ERR                             208221
     C*                                                                   208221
     C                     ELSE                                           208221
     C                     MOVE BABSRC    WWMBR                           208221
     C*                                                                   208221
     C** Check currency                                                   208221
     C*                                                                   208221
     C           BACYCD    IFNE WWCCY                                     208221
     C                     MOVEL'RE71413' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN54                           208221
     C                     MOVE 'E'       ERR                             208221
     C                     ELSE                                           208221
      *                                                                   208221
     C                     MOVELBACYCD    WWMCCY                          208221
     C                     ENDIF                                          208221
     C                     MOVELWWMG      SCRMG                           208221
     C                     MOVELWWMG      SSCMBR                          208221
     C                     MOVEL*BLANKS   SSCRMG                          208221
     C                     ENDIF                                          208221
     C                     ELSE                                           208221
     C                     MOVE *BLANKS   SSCRMG                          CDE002
     C                     MOVEL'RE71411' ZAMSID                          CDE002
     C                     EXSR ZASNMS                                    CDE002
     C                     MOVE '1'       *IN54                           CDE002
     C                     MOVE '1'       ERR                             CDE002
     C                     ENDIF                                          208221
     C                     ELSE                                           CDE002
     C***************      MOVE ZFIELD    SSCRMG                    CDE002208221
     C                     MOVE ZOUT15    SSCRMG                          208221
     C                     MOVE *BLANKS   SSCMBR                          208221
     C*                                                                   208221
     C           ZFSIGN    IFEQ '-'                                       208221
     C                     Z-SUBSSCRMG    SSCRMG                          208221
     C                     MOVEL'RE71414' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN54                           208221
     C           ERR       IFEQ *BLANKS                                   208221
     C                     MOVE 'W'       ERR                             208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C                     ELSE                                           CDE002
     C                     MOVE *BLANKS   SSCRMG                          CDE002
     C                     MOVE *BLANKS   SSCMBR                          208221
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
     C*                                                                   208221
     C** When account is amended, give warning message if the margin      208221
     C** rate is different to the rate/spread                             208221
     C*                                                                   208221
     C           DDACTN    IFEQ 'A'                                       208221
     C           SSDRIB    IFNE 0                                         208221
     C           SSDRMG    ANDNESSDRIS                                    208221
     C                     MOVEL'RE71415' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN56                           208221
     C           ERR       IFEQ *BLANKS                                   208221
     C                     MOVE 'W'       ERR                             208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          208221
     C*                                                                   208221
     C           SSCRIB    IFNE 0                                         208221
     C           SSCRMG    ANDNESSCRIS                                    208221
     C                     MOVEL'RE71415' ZAMSID                          208221
     C                     EXSR ZASNMS                                    208221
     C                     MOVE '1'       *IN54                           208221
     C           ERR       IFEQ *BLANKS                                   208221
     C                     MOVE 'W'       ERR                             208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          208221
     C                     ENDIF                                          208221
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10F5   - PROCESS OTHER DETAILS                                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #DEFT    - TO PROCESS DEFAULT VALUES IN INSERT MODE              *
      * ZA0250   - EXTERNAL PROGRAM CALLED TO DELETE ERROR MESSAGE       *
      * #P1035   - TRANSFER WORK FIELDS IN SCREEN FIELDS(5TH FORMAT)     *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      * #V10F5   - PROCESS VALIDATION OF 'F5' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      *                                                                  *
      ********************************************************************
     C           #P10F5    BEGSR                           * #P10F5 BGSR *
     C*
     C**  Set start screen indicator
     C                     MOVE ' '       ERR     1
     C                     MOVE '0'       *IN07                           107478
     C                     MOVE '0'       *IN25
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     MOVELSSANAM    SANAM
     C*
     C** Check if BRT SAR Installed.
     C*
     C**********           MOVE SCNUM     @CNUM6  60                                          CSD027
     C                     MOVE SCNUM     @CNUM6  6                                           CSD027
     C           *INU3     IFEQ '1'
     C           @CNUM6    CHAINSDCBRTL1             37
     C           *IN37     IFEQ '1'
     C           XRECI     ORNE 'D'
     C           *LOCK     IN   LDA                        ***************
     C                     Z-ADD55        DBASE            **DB ERROR 55**
     C                     MOVEL'SDCBRTPD'DBFILE           ***************
     C                     MOVELSCNUM     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             E3
     C                     ELSE
     C                     MOVE '1'       *IN19
     C                     END
      *                                                                   107478
      **  Display Passbook Used on Savings A/c if RE Teller is installed, 107478
     C**  or Retail Branch Access (CRT002) SAR is installed, and          CRT002
      **  ICD Passbooks Used flag is 'Y' and a/c is savings a/c.          107478
      *                                                                   107478
     C/COPY WNCPYSRC,GL3271C088
     C           CRT001    IFEQ 'Y'                                       107478
     C           ICPBKU    ANDEQ'Y'                                       107478
     C           SWATYP    ANDEQ'R'                                       107478
     C           SWSTYP    ANDEQ'S'                                       107478
     C           CRT002    OREQ 'Y'                                       CRT002
     C           ICPBKU    ANDEQ'Y'                                       CRT002
     C/COPY WNCPYSRC,GL3271C076
     C           SWATYP    ANDEQ'R'                                       CRT002
     C           SWSTYP    ANDEQ'S'                                       CRT002
     C/COPY WNCPYSRC,GL3271C077
     C                     MOVE '1'       *IN06                           107478
     C                     ELSE                                           107478
     C                     MOVE '0'       *IN06                           107478
     C                     END                                            107478
     C/COPY WNCPYSRC,GL3271C089
      *                                                                   107478
      **  Display Savings A/c Password if RE Teller is installed,         107478
      **  Passwords SAR is installed and a/c is savings a/c.              107478
      *                                                                   107478
     C           CRT001    IFEQ 'Y'                                       107478
     C           CRT101    ANDEQ'Y'                                       107478
     C           SWATYP    ANDEQ'R'                                       107478
     C           SWSTYP    ANDEQ'S'                                       107478
     C                     MOVE '1'       *IN08                           107478
     C                     ELSE                                           107478
     C                     MOVE '0'       *IN08                           107478
     C                     END                                            107478
     C*
     C**  CLEAR WHOLE SCREEN
     C                     WRITEGL3271FC
     C/COPY WNCPYSRC,GL3271C144
     C**
     C           WFMT      DOUNE'F5'                       -B1
     C**
     C** IF INSERT MODE LOAD DEFAULT VALUES
     C**
     C                     EXSR #DEFT2                                    CRE007
     C**
     C/COPY WNCPYSRC,GL3271C005
     C                     WRITEGL3271C1
     C/COPY WNCPYSRC,GL3271C158
     C                     EXFMTGL3271F5
     C                     MOVEL*BLANK    ERR
     C                     MOVE '0'       *IN07                           107478
     C                     MOVEA'00000000'*IN,58
     C                     MOVEA'00000000'*IN,66
     C                     CALL 'ZA0250'
     C*
     C** Checked if Linked Enquiry
     C*
     C           MODID     IFEQ 'GL'
     C                     EXSR #CMDSR
     C*                                                                   074576
     C** Screen lock on scroll forward in enquiry mode as no previous     074576
     C** screen available to pass back to after last screen               074576
     C*                                                                   074576
     C                     SETOF                     25                   074576
     C                     END
     C*
     C**  F3 PRESSED - EXIT OF PROGRAM
     C           *INKC     IFEQ '1'                        -B2
     C                     MOVEL*BLANKS   WFMT
     C/COPY WNCPYSRC,GL3271C239
     C                     END                             -E2
     C*
     C**  F12 PRESSED - PREVIOUS SCREEN
     C           *INKL     IFEQ '1'                        -B2
     C                     MOVELWWRTRN    WFMT
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP48                                           S01408
      *                                                                   S01408
     C                     END                             -E2
     C*
     C**  F5 PRESSED - REFRESH
     C           *INKE     IFEQ '1'                        -B2
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C**
     C**
     C           *IN31     IFEQ '1'
     C           *IN30     OREQ '1'
     C                     EXSR #P1035
     C                     END                             -E3
     C                     END                             -E2
     C*
     C**  F9 PRESSED - REFRESH  ALL
     C           *INKI     IFEQ '1'                        -B2
     C           *IN32     IFEQ '1'                        -B3
     C                     MOVEL'RE71009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C**
     C** IF INSERT OR AMEND MODE RETURN TO FIRST SCREEN ENTRY
     C**
     C           *IN30     IFEQ '1'                        -B3
     C                     MOVEL'FK'      WFMT
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       *IN69
     C                     END                             -E3
     C**
     C           *IN31     IFEQ '1'
     C                     EXSR #P1030
     C           WWACTN    IFEQ 'A'
     C           WWACTN    OREQ 'E'
     C                     MOVEL'F1'      WFMT
     C                     ELSE
     C                     MOVEL'F1'      WFMT
     C                     MOVE WWACTN    WFMT
     C                     END
     C                     END                             -E3
     C                     END                             -E2
     C**  F8 PRESSED - FROM ENQUIRY TO AMEND MODE
     C           *INKH     IFEQ '1'                        -B2
     C* IF MULTIBRANCHING DO VALIDATION ON BRANCH INPUT                   097616
     C           BJSBRC    IFEQ *BLANKS                                   097616
     C                     MOVEL'A'       @ZACTN                          097616
     C                     MOVELSBRCA     @BRCA                           097616
     C                     EXSR #AUTH                                     097616
     C           @ERR      IFNE 0                                         097616
     C                     MOVEL'RE7103B' ZAMSID                          097616
     C                     EXSR ZASNMS                                    097616
     C                     MOVEL'E'       ERR                             097616
     C                     END                                            097616
     C                     END                                            097616
     C*
     C**  USER MUST BE AUTHORISED AND ACTION MODE IS ENQUIRY
     C           *IN41     IFEQ '1'                        -B3
     C           *IN32     ANDEQ'1'
     C           ERR       ANDEQ*BLANKS                                   097616
     C           *IN39     IFEQ '0'
     C*
     C**  UNPROTECT FIELDS AND REDISPLAY
     C                     MOVEA'0100'    *IN,30
     C                     MOVE 'A'       DDACTN
     C                     ELSE                            -X3
     C*
     C** ERROR MESSAGE
     C                     MOVEL'RE71003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     END                             -E3
     C                     END                             -E3
     C*
     C                     END                             -E2
     C** ROLLDOWN PRESSED
     C           *IN26     IFEQ '1'                        -B2
     C                     MOVE '0'       *IN25
     C** ENQUIRY MODE NO VALIDATION            T
     C           *IN32     IFEQ '0'                        -B3
     C                     EXSR #V10F5
     C                     END                             -E3
     C** NO ERRORS
     C           ERR       IFEQ *BLANK                     -B3
     C** AT LEAST ONE COMMISSION MUST BE PRESENT
     C           *IN34     IFEQ '1'                        -B4
     C                     MOVEL'F4'      WFMT
     C                     ELSE                            -X4
     C                     MOVEL'F3'      WFMT
     C                     END                             -E4
     C                     END                             -E3
     C                     END                             -E2
     C**  ROLLUP OR ENTER PRESSED - VALIDATION AND NEXT SCREEN
     C           *IN25     IFEQ '1'                        -B2
     C           *IN49     OREQ '0'
     C*
     C**  Validate entry
     C           *IN32     IFNE '1'                        -B3
     C                     EXSR #V10F5
     C                     END                             -E3
     C*
     C           ERR       IFEQ ' '                        -B3
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP76                                           S01408
     C*                                                                   S01408
     C** INSERT MODE, PROCESS WRITE
     C           *IN30     IFEQ '1'                        -B4
     C                     MOVEL'IN'      WFMT
     C                     END                             -E4
     C**  AMEND  MODE, PROCESS UPDATE
     C           *IN31     IFEQ '1'                        -B4
     C                     MOVEL'UP'      WFMT
     C/COPY WNCPYSRC,GL3271C240
     C                     END                             -E4
     C**  ENQUIRY MODE, RETURN TO PREVIOUS SCREEN
     C           *IN32     IFEQ '1'                        -B4
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C122                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD                            S01522
     C                     PARM 'E'       ACTN                            S01522
     C                     PARM ACKEY     ACCD                            S01522
     C                     END                                            S01522
     C/COPY WNCPYSRC,GL3271C033
      *                                                                   CGL004
      ** If Midas-Fontis Interface is switched on, call program to        CGL004
      ** display Fontis account details.                                  CGL004
      *                                                                   CGL004
     C           *IN29     IFEQ '1'                                       CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     CALL 'GLC2800'                                 CGL004
     C                     PARM *BLANK    RTCD                            CGL004
     C                     PARM ACKEY     ACCD                            CGL004
     C                     PARM 'E'       ACTN                            CGL004
     C                     ENDIF                                          CGL004
     C                     ENDIF                                          CGL004
     C/COPY WNCPYSRC,GL3271C213
      *                                                                   CGL004
     C                     MOVELWWRTRN    WFMT
     C/COPY WNCPYSRC,GL3271C034
     C                     END                             -E4
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP18                                           S01408
     C*                                                                   S01408
     C                     END                             -E3
     C                     END                             -E2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP31                                           S01408
     C*                                                                   S01408
     C*
     C                     END                             -E1
     C/COPY WNCPYSRC,GL3271C145
     C*
     C                     ENDSR                           * #P10F5 EDSR *
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V10F5   - PROCESS VALIDATION OF 'F5' FORMAT                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZALIGN   - TO VALIDATE A NUMERIC FIELD                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F5   - PROCESS OTHER DETAILS                                 *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDECS   - NUMBER OF DECIMALS                                    *
      *                                                                  *
      ********************************************************************
     C           #V10F5    BEGSR
     C*
     C                     MOVE '0'       *IN36
     C*
     C** VALIDATE MINIMUM BALANCE:
     C*  - WHEN ENTERED, SMINB MUST BE VALID NUMERIC
     C           SMINB     IFNE *BLANK                     - B1
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SMINB     ZFIELD
     C                     Z-ADD*ZEROS    ZADEC
     C                     Z-ADD0         ZADIG
     C           11        SUB  *ZEROS    ZADIG
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        - B2
     C                     MOVEL'RE71500' ZAMSID           SMINB FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60            REVERSE MODE
     C                     MOVE 'E'       ERR              ERROR INDIC.
     C                     ELSE
     C                     MOVE ZFIELD    SSMDTN
     C                     END                             - E2
     C                     ELSE
     C                     Z-ADD*ZEROS    SSMDTN
     C                     END                             - E1
     C*
     C** VALIDATE FACILITY TYPE:
     C*  - WHEN ENTERED, SFACT MUST BE VALID
     C           SFACT     IFNE *BLANK                     - B1
     C                     CALL 'AOFACTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SFACT     @FACT   3                       078168
     C************         PARM SFACT     @CCY    3                       078168
     C           SDFACT    PARM SDFACT    DSFDY
     C           @RTCD     IFNE *BLANKS                    - B2
     C*
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE
     C*
     C           *IN36     IFEQ '0'
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN36
     C                     END
     C*
     C                     MOVEL'RE71501' ZAMSID           SFACT FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     ELSE                            - X2           078168
     C                     MOVE @FACT     SFACT                           078168
     C                     END                             - E2
     C                     END                             - E1
     C*
     C** VALIDATE FACILITY NUMBER
     C*  - SDACO MUST BE ENTERED IF SFACT NON BLANK
     C           SFACT     IFEQ *BLANK                     - B1
     C           SFCNO     IFNE *BLANK                     - B2
     C                     MOVEL'RE71502' ZAMSID           SFCNO FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     ELSE                            - X1
     C                     MOVE SFCNO     ZONE
     C           ZONE,1    LOKUPNUM,1                    80
     C           ZONE,2    LOKUPNUM,1                    81
     C*
     C           *IN80     IFEQ '0'                        - B2
     C           *IN81     OREQ '0'
     C                     MOVEL'RE71503' ZAMSID           SFCNO FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN62            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C*
     C* DO NOT DEFAULT FACILITY NUMBER TO '01' WHILE DISPLAYING A         078168
     C*  A MESSAGE SAYING IT IS NON-NUMERIC - USER SHOULD INPUT FACILITY  078168
     C***-*SFCNO*DEFAULT*TO*'01'*                                         078168
     C***********SFCNO     IFEQ *BLANK                     - B2           078168
     C***********          MOVE '01'      SFCNO                           078168
     C***********          END                             - E2           078168
     C*
     C*  CHECK IF FACILITY IS LINKED TO CUSTOMER
     C*  - ONLY IF FACILITY TYPE AND NUMBER HAVE BEEN INPUT               078168
     C/COPY WNCPYSRC,GL3271C148
     C           SFACT     IFNE *BLANKS                                   078168
     C           SFCNO     ANDNE*BLANKS                                   078168
     C                     MOVEL'A'       WRCTP   1
     C           FACTK     CHAINFCLTY                80
      *                                                                                     BUG5948
     C           *IN80     IFEQ *ON                                                         BUG5948
     C           FACTK     CHAINLEAGFCL0             80                                     BUG5948
     C                     ENDIF                                                            BUG5948
      *                                                                                     BUG5948
     C           *IN80     IFEQ '1'                        - B2
     C           RECI      ORNE 'D'
     C                     MOVEL'RE71505' ZAMSID           SFCNO FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN61            REVERSE MODE
     C                     MOVE '1'       *IN62            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C/COPY WNCPYSRC,GL3271C069
     C                     END                             - E2
     C                     END                                            078168
     C/COPY WNCPYSRC,GL3271C149
     C                     END                             - E1
     C**
     C           SEFAC     IFNE *BLANKS
     C/COPY WNCPYSRC,GL3271C002
     C                     MOVE SEFAC     ZONE
     C           ZONE,1    LOKUPNUM,1                    80
     C           ZONE,2    LOKUPNUM,1                    81
     C*
     C           *IN80     IFEQ '0'                        - B2
     C           *IN81     OREQ '0'
     C                     MOVEL'RE71503' ZAMSID           SEFAC FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN63            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     END                             - E2
     C*
     C** VALIDATE INACTIVE ACCOUNT
     C*  - SINAI MUST BE 'Y' OR 'N'
     C           SINAI     IFNE *BLANK                     - B1
     C           SINAI     IFNE 'Y'                        - B2
     C           SINAI     ANDNE'N'
     C                     MOVEL'RE71504' ZAMSID           SINAI FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN64            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     ELSE                            - X1
     C*
     C*  - DEFAULT TO 'N'
     C                     MOVE 'N'       SINAI
     C                     END                             - E1
     C*
     C** VALIDATE BAD DEBT
     C*  - SBADI MUST BE 'Y' OR 'N'
     C           SBADI     IFNE *BLANK                     - B1
     C           SBADI     IFNE 'Y'                        - B2
     C           SBADI     ANDNE'N'
     C                     MOVEL'RE71504' ZAMSID           SBADI FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN66            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     ELSE                            - X1
     C*
     C*  - DEFAULT TO 'N'
     C                     MOVE 'N'       SBADI
     C                     END                             - E1
     C*
     C** VALIDATE BANKRUPT LIQUIDATED
     C*  - SBRLI MUST BE 'Y' OR 'N'
     C           SBRLI     IFNE *BLANK                     - B1
     C           SBRLI     IFNE 'Y'                        - B2
     C           SBRLI     ANDNE'N'
     C                     MOVEL'RE71504' ZAMSID           SBRLI FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN65            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     ELSE                            - X1
     C*
     C*  - DEFAULT TO 'N'
     C                     MOVE 'N'       SBRLI
     C                     END                             - E1
     C*
     C** VALIDATE PRINT TRANSACTION ADVICE
     C*  - SPTRA MUST BE 'Y' OR 'N'
     C           SPTRA     IFNE *BLANK                     - B1
     C           SPTRA     IFNE 'Y'                        - B2
     C           SPTRA     ANDNE'N'
     C                     MOVEL'RE71504' ZAMSID           SPTRA FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN67            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     ELSE                            - X1
     C*
     C*  - DEFAULT TO 'N'
     C                     MOVE 'N'       SPTRA
     C                     END                             - E1
     C*
     C** VALIDATE PRINT RATE CHANGE ADVICE
     C*  - SPRCH MUST BE 'Y' OR 'N'
     C           SPRCH     IFNE *BLANK                     - B1
     C           SPRCH     IFNE 'Y'                        - B2
     C           SPRCH     ANDNE'N'
     C                     MOVEL'RE71504' ZAMSID           SPRCH FALSE
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN68            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             - E2
     C                     ELSE                            - X1
     C*
     C*  - DEFAULT TO 'N'
     C                     MOVE 'N'       SPRCH
     C                     END                             - E1
     C*                                                                   CRT001
     C** If Retail Teller System (CRT001) SAR is installed,               CRT001
     C** or Retail Branch Access (CRT002) SAR is installed                CRT002
     C** validate Passbooks Used flag                                     CRT001
     C*  - SPBKU must be 'Y' or 'N'                                       CRT001
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                        - B1           CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C*                                                                   CRT001
     C           SPBKU     IFNE *BLANK                     - B2           CRT001
     C           SPBKU     IFNE 'Y'                        - B3           CRT001
     C           SPBKU     ANDNE'N'                                       CRT001
     C                     MOVEL'RE71504' ZAMSID           SPBKU FALSE    CRT001
     C                     EXSR ZASNMS                                    CRT001
     C                     MOVE '1'       *IN07            REVERSE MODE   CRT001
     C                     MOVEL'E'       ERR              ERROR INDIC.   CRT001
     C                     END                             - E3           CRT001
     C*                                                                   CRT001
     C                     ELSE                            - X2           CRT001
     C*                                                                   CRT001
     C*  - default to 'N'                                                 CRT001
     C                     MOVE 'N'       SPBKU                           CRT001
     C                     END                             - E2           CRT001
     C*                                                                   CRT001
     C                     END                             - E1           CRT001
     C*
     C** IF NO ERRORS VALIDATE WORK FIELDS
     C           ERR       IFEQ *BLANK                     - B1
     C                     MOVE SFACT     SSFACT
     C                     MOVE SFCNO     SSFCNO
     C*********************MOVE SEFAC     SSEFAC                          103352
     C**                                                                  103352
     C           SEFAC     IFEQ *BLANKS                                   103352
     C                     MOVE *ZEROS    SSEFAC                          103352
     C                     ELSE                                           103352
     C                     MOVE SEFAC     SSEFAC                          103352
     C                     END                                            103352
     C**                                                                  103352
     C           SINAI     IFEQ 'Y'
     C                     BITON'4'       SSRETB
     C                     ELSE
     C                     BITOF'4'       SSRETB
     C                     END
     C**
     C           SBRLI     IFEQ 'Y'
     C                     BITON'6'       SSRETB
     C                     ELSE
     C                     BITOF'6'       SSRETB
     C                     END
     C**
     C           SBADI     IFEQ 'Y'
     C                     BITON'7'       SSRETB
     C                     ELSE
     C                     BITOF'7'       SSRETB
     C                     END
     C**
     C                     MOVE SPTRA     SSPTRA
     C                     MOVE SPRCH     SSPRCH
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed               CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C                     MOVE SPBKU     SSPBKU                          CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C****If*Password*on*Retail*Savings*Account*(CRT101)*SAR*is*ON*****                CRT001 CSD101
     C*                                                                   CRT001
     C/COPY WNCPYSRC,GL3271C090
     C********** CRT101    IFEQ 'Y'                                                    CRT001 CSD101
     C********** CRT001    ANDEQ'Y'                                                    107478 CSD101
     C***********ATYP      ANDEQ'R'                                CRT001 107478
     C***********STYP      ANDEQ'S'                                CRT001 107478
     C/COPY WNCPYSRC,GL3271C078
     C********** SWATYP    ANDEQ'R'                                                    107478 CSD101
     C********** SWSTYP    ANDEQ'S'                                                    107478 CSD101
     C/COPY WNCPYSRC,GL3271C079
     C**********           MOVE SPSWD     SSPSWD                                       CRT001 CSD101
     C**********           END                                                         CRT001 CSD101
     C/COPY WNCPYSRC,GL3271C091
     C*                                                                   CRT001
     C                     END                             - E1
     C*
     C** Validate Base Rate Category
     C*
     C           *INU3     IFEQ '1'
     C                     EXSR #VLBRT
     C                     MOVE SBRTCA    SSBRTC
     C                     END
     C*
     C                     ENDSR
     C********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE1Z2
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      /COPY ZSRSRC,ZEDITZ2
      /EJECT
      /COPY ZSRSRC,ZALIGNZ2
      /EJECT                                                              208221
      /COPY ZSRSRC,ZASIGNZ2                                               208221
      /EJECT                                                              208221
      /COPY ZSRSRC,ZFRPEDZ3                                               208221
      /EJECT
      /COPY ZSRSRC,ZTNLU1Z2
      /EJECT
     C********************************************************************
     C*                                                                  *
     C*  #VLBRT   - PROCESS VALIDATION OF BASE RATE CATEGORY             *
     C*                                                                  *
     C*  SUBROUTINE CALLED FROM:                                         *
     C*  #V10F5   - PROCESS OTHER DETAILS                                *
     C*                                                                  *
     C********************************************************************
     C           #VLBRT    BEGSR                           ***  #VLBRT ***
     C**
      *
      * If Account Holder type is not R                                   CRE007
      * Validate field - Mandatory entry must be L,P,X,N,C OR B
      *
     C           ACHLRT    IFNE 'R'                        B1             CRE007
     C***********SBRTCA    IFNE 'L'                        B1             CRE007
     C           SBRTCA    ANDNE'L'                                       CRE007
     C           SBRTCA    ANDNE'P'
     C           SBRTCA    ANDNE'X'
     C           SBRTCA    ANDNE'N'
     C           SBRTCA    ANDNE'C'
     C           SBRTCA    ANDNE'B'
      *                                                                   CRE007
      * If Account Holder type is R                                       CRE007
      * Validate field - Mandatory entry must be L,P,X,N,C,B, OR R        CRE007
     C           ACHLRT    OREQ 'R'                                       CRE007
     C           SBRTCA    ANDNE'L'                                       CRE007
     C           SBRTCA    ANDNE'P'                                       CRE007
     C           SBRTCA    ANDNE'X'                                       CRE007
     C           SBRTCA    ANDNE'N'                                       CRE007
     C           SBRTCA    ANDNE'C'                                       CRE007
     C           SBRTCA    ANDNE'B'                                       CRE007
     C           SBRTCA    ANDNE'R'                                       CRE007
      *
      * If field in error move error code to array and seton indicator
      * to display field in reverse image.
      *
     C                     MOVEL'RE71861' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             E1
     C*
     C*  IF ACCOUNT IS A CORPORATE CUSTOMER, BRT ACCOUNT HOLDER TYPE
     C*  MUST BE 'C'
     C*
     C           SBRTCA    IFEQ 'C'
     C           ACHLRT    ANDNE'C'
     C                     MOVEL'RE71862' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END
     C*
     C*  IF ACCOUNT IS A BANK, BRT ACCOUNT HOLDER TYPE MUST BE 'B'
     C*
     C           SBRTCA    IFEQ 'B'
     C           ACHLRT    ANDNE'B'
     C                     MOVEL'RE71863' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END
     C*
     C*  IF ACCOUNT IS EXEMPT, BRT ACCOUNT HOLDER TYPE MUST BE 'N' OR 'O'
     C*
     C           SBRTCA    IFEQ 'X'
     C           ACHLRT    ANDNE'N'
     C           ACHLRT    ANDNE'O'
     C                     MOVEL'RE71864' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END
     C*
     C* If value entered is 'L' then Account Holder Type must be
     C* 'I' or 'J'.
     C*
     C           SBRTCA    IFEQ 'L'                        B1
     C           ACHLRT    IFNE 'I'                        B*2
     C           ACHLRT    ANDNE'J'
     C*
      * If field in error move error code to array and seton indicator
      * to display field in reverse image.
     C*
     C                     MOVEL'RE71865' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             E*2
     C                     END                             E1
      *
     C*
     C* If value entered is 'P' then Account Holder Type must be 'J'
     C*
     C           SBRTCA    IFEQ 'P'                        B1
     C           ACHLRT    IFNE 'J'                        B*2
     C*
      * If field in error move error code to array and seton indicator
      * to display field in reverse image.
     C*
     C                     MOVEL'RE71866' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             E*2
     C                     END                             E1
     C*
     C* If value entered is 'N' then Account Holder Type must be
     C* 'I' or 'J'.
     C*
     C           SBRTCA    IFEQ 'N'                        B1
     C           ACHLRT    IFNE 'I'                        B*2
     C           ACHLRT    ANDNE'J'
     C*
      * If field in error move error code to array and seton indicator
      * to display field in reverse image.
     C*
     C                     MOVEL'RE71867' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             E*2
     C                     END                             E1
     C*
     C* If value entered is 'P' then none of the parties to
     C* the account may be non-resident.(HxBRTL=X)
     C*
     C           SBRTCA    IFEQ 'P'                        B1
     C           H1BRTL    IFEQ 'X'                        B*2
     C           H2BRTL    OREQ 'X'
     C           H3BRTL    OREQ 'X'
     C           H4BRTL    OREQ 'X'
     C           H5BRTL    OREQ 'X'
     C*
      * If field in error move error code to array and seton indicator
      * to display field in reverse image.
     C*
     C                     MOVEL'RE71868' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             E*2
     C                     END                             E1
     C*
     C* If value entered is 'L' then none of the parties to
     C* the account may be non-liable.(HxBRTL=N)
     C*
     C           SBRTCA    IFEQ 'L'                        B1
     C           H1BRTL    IFEQ 'N'                        B*2
     C           H2BRTL    OREQ 'N'
     C           H3BRTL    OREQ 'N'
     C           H4BRTL    OREQ 'N'
     C           H5BRTL    OREQ 'N'
     C*
      * If field in error move error code to array and seton indicator
      * to display field in reverse image.
     C*
     C                     MOVEL'RE71869' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             E*2
     C                     END                             E1
     C*
     C* If value entered is 'N' then none of the parties to
     C* the account may be liable.(HxBRTL=Y)
     C*
     C           SBRTCA    IFEQ 'N'                        B1
     C           H1BRTL    IFEQ 'Y'                        B*2
     C           H2BRTL    OREQ 'Y'
     C           H3BRTL    OREQ 'Y'
     C           H4BRTL    OREQ 'Y'
     C           H5BRTL    OREQ 'Y'
     C*
      * If field in error move error code to array and seton indicator
      * to display field in reverse image.
     C*
     C                     MOVEL'RE71870' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END                             E*2
     C                     END                             E1
     C*
     C*  IF ACCOUNT IS PART LIABLE (P) FOR BRT NEITHER OF THE PARTIES
     C*  MAY BE THE SAME OR NON RESIDENT (HXBRTL=X)
     C*
     C           SBRTCA    IFEQ 'P'
     C           H1BRTL    IFEQ H2BRTL
     C           H1BRTL    OREQ 'X'
     C           H2BRTL    OREQ 'X'
     C                     MOVEL'RE71871' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN37            REVERSE MODE
     C                     MOVEL'E'       ERR              ERROR INDIC.
     C                     END
     C                     END
      *
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
     C*                                                                  *
     C*    #CMDSR - PROCESS COMMAND KEYS                                 *
     C*                                                                  *
     C*    CALLED BY: #P10F0 - PROCESS START SCREEN                      *
     C*               #P10S0 - PROCESS REVIEW FROM SUBFILE               *
     C*               #P10FK - INSERT AND DELETE MODE                    *
     C*               #P10F1 - PROCESS ACCOUNT MASTER DETAILS            *
     C*               #P10F2 - PROCESS DEBIT INTEREST DETAILS            *
     C*               #P10F3 - PROCESS CREIT INTEREST DETAILS            *
     C*               #P10F4 - PROCESS COMMISSIONS DETAILS               *
     C*               #P10F5 - PROCESS OTHER DETAILS                     *
     C*    CALLS:     #RETSR - END OF PROGRAM PROCESSING                 *
     C*                                                                  *
     C*    THIS IS A STANDARD LINK ENQUIRY SUBROUTINE FOR PROCESSING     *
     C*    THE COMMAND KEYS                                              *
     C*                                                                  *
     C********************************************************************
     C*
     C           #CMDSR    BEGSR
     C*
     C* SET DATA AREA WORK FIELD RTNDWF TO BLANKS
     C*
     C                     MOVE *BLANK    RTNDWF  1
     C*
     C* IF F3 PRESSED, RETURN TO MENU
     C*
     C           *INKC     IFEQ '1'
     C                     MOVE 'Q'       RTNDWF
     C/COPY WNCPYSRC,GL3271C241
     C                     EXSR #RETSR
     C                     END
     C*
     C* IF F1 PRESSED, RETURN TO INITIAL ENQUIRY
     C*
     C           *INKA     IFEQ '1'
     C                     MOVE 'S'       RTNDWF
     C                     EXSR #RETSR
     C                     END
     C*
     C* IF F12 PRESSED, RETURN TO PREVIOUS ENQUIRY
     C*
     C           *INKL     IFEQ '1'
     C                     MOVE 'U'       RTNDWF
     C/COPY WNCPYSRC,GL3271C242
     C                     EXSR #RETSR
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
      /EJECT
     C********************************************************************
     C*                                                                  *
     C*    #RETSR - END OF PROGRAM PROCESSING                            *
     C*                                                                  *
     C*    CALLED BY: #CMDSR - PROCESS COMMAND KEYS                      *
     C*               *PSSR - ERROR PROCESSING                           *
     C*    CALLS:                                                        *
     C*                                                                  *
     C********************************************************************
     C*
     C           #RETSR    BEGSR
     C/COPY WNCPYSRC,GL3271C193
     C*
     C* SET ON LR
     C*
     C                     SETON                     LR
     C*
     C* ACCESS EM DATA AREA
     C*
     C           *LOCK     IN   EMSDS
     C                     MOVE RTNDWF    RETND
     C                     OUT  EMSDS
     C*
     C                     RETRN
     C*
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
     C*                                                                  *
     C*    #AUTH - CHECK ACTION CODE AND BRANCH AUTHORITY                *
     C*                                                                  *
     C*    CALLED BY: #V10F0 - PROCESS VALIDATION OF START SCREEN        *
     C*               #V10FK - PROCESS VALIDATION OF FK FORMAT           *
     C*    CALLS:                                                        *
     C*                                                                  *
     C********************************************************************
     C           #AUTH     BEGSR
     C*
     C** Multi-branch system, user must be authorised to action on
     C** branch.
     C*
     C           MBIN      IFEQ 'Y'
     C                     CALL 'ZVACTBU'
     C                     PARM           @ZACTN  1
     C                     PARM           @BRCA   3
     C                     PARM           @ERR    10
     C*
     C                     ELSE
     C*
     C** Single branch system, check user is authorised to action code
     C*
     C                     CALL 'ZVACTU'
     C                     PARM           @ZACTN
     C                     PARM           @ERR
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #DIR     - TO PROCESS FORMAT AND MODE                            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1020   - TRANSFER FILE FIELDS IN WORK FIELDS                   *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F0   - PROCESS START SCREEN                                  *
      * #V10S0   - PROCESS VALIDATION OF SUBFILE                         *
      * #V10FK   - PROCESS VALIDATION OF 'FK' FORMAT                     *
      * #P1002   - WRITE PROCESSING                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCCY    - CURRENCY CODE                                         *
      * WWDECS   - NUMBER OF DECIMALS                                    *
      * WWDIG    - NUMBER OF DIGITS                                      *
      * WWACTN   - ACTION CODE                                           *
      * WWDSPY   - DISPLAY CODE                                          *
      *                                                                  *
      ********************************************************************
     C           #DIR      BEGSR
     C**
     C** FOR INSERT, AMEND AND ENQUIRY MODE DETERMINE NUMBER
     C** OF DECIMALS FOLLOWING CURRENCY
     C**
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C** CLEAR ACCESS OBJECT ERROR MESSAGE (ZA0250 CLEARS ALL MSGS)
     C** NOT CHECKING *IN36 IN THIS CASE
     C*
     C           @RTCD     IFNE *BLANKS
     C                     CALL 'ZA0250'
     C                     ELSE                                           072879
     C                     MOVE A6CYCD    SCCY                            072879
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           A6INCY    ANDEQ'Y'                                       CEU013
     C           BJRDNB    ANDGEA6TPSD                                    CEU013
     C                     MOVE *ON       *IN27                           CEU013
     C                     ELSE                                           CEU013
     C                     MOVE *OFF      *IN27                           CEU013
     C                     ENDIF                                          CEU013
     C/COPY WNCPYSRC,GL3271C142
     C                     END
     C*
     C                     MOVEA'00'      *IN,90
     C**
     C                     Z-ADDA6NBDP    WWDECS  10
     C           13        SUB  WWDECS    WWDIG   20
     C**
     C**  INSERT MODE
     C           *IN30     IFEQ '1'
     C                     MOVE '1'       *IN66
     C                     MOVE '1'       *IN69
     C                     MOVE 'I'       DDACTN
     C** RETAIL NUMBER NOT USED
     C           *IN48     IFNE '1'
     C                     MOVE '1'       *IN65
     C                     MOVE '1'       *IN68
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP11                                           S01408
     C*                                                                   S01408
     C**
     C                     END
     C**
     C**  DELETE MODE
     C           *IN33     IFEQ '1'
     C** RETAIL MUMBER NOT USED
     C           *IN48     IFNE '1'
     C                     MOVE '1'       *IN65
     C                     MOVE '1'       *IN68
     C                     END
     C                     MOVE 'D'       DDACTN
     C**
     C                     END
     C**  AMEND  MODE
     C           *IN31     IFEQ '1'
     C** LOAD FILE FIELDS IN WORK FIELDS
     C                     EXSR #P1020
     C** LOAD WORK FIELDS IN SCREEN FIELDS
     C                     EXSR #P1030
     C                     MOVELDDACTN    WWACTN
     C                     MOVE 'A'       DDACTN
     C**
     C                     END
     C**
     C**  ENQUIRY MODE
     C           *IN32     IFEQ '1'
     C** LOAD FILE FIELDS IN WORK FIELDS
     C                     EXSR #P1020
     C** LOAD WORK FIELDS IN SCREEN FIELDS
     C                     EXSR #P1030
     C                     MOVELDDACTN    WWACTN  1
     C                     MOVE 'E'       DDACTN
     C**
     C                     END
     C** SEND FORMAT
     C                     MOVELWWDSPY    WFMT
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1001   - PROCESS INITIALIZATION                                *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1001    BEGSR                           ** #P1001 BSR *
     C*                                                                   129788
     C** Clear program message queue                                      129788
     C*                                                                   129788
     C                     CALL 'ZA0250'                                  129788
     C*
     C/COPY WNCPYSRC,GL3271CP73                                           S01408
     C*                                                                   S01408
     C* INITIALIZE ARRAYS FOR RATE AND BALANCE WHEN INTEREST TYPE IS
     C* BLANK
     C*
     C                     MOVEA*ZERO     RATN
     C                     MOVEA*ZERO     BALN
     C*
     C                     MOVEL'*'       DDPGMQ
     C                     MOVE '0'       *IN48
     C                     MOVE '0'       *IN44
     C                     MOVEL'-'       FLD0             FORMAT ACC. KEY
     C                     MOVEL'-'       FLD1             FORMAT ACC. KEY
     C                     MOVEL'-'       FLD2             FORMAT ACC. KEY
     C                     MOVEL'-'       FLD3             FORMAT ACC. KEY
     C                     MOVE '    '    ERCD
     C                     Z-ADD0         S       20
     C*
     C**   Select the program MSGQ for error msg.
     C                     MOVEL'*'       TOPQ   10
     C                     MOVEL'*PRV'    TOPRQ   5
     C*
     C**   Fill in fields for subroutine ZASNMS
     C                     MOVEL*BLANK    ZAPGM  10        Message queue
     C                     MOVEL'REUSRMSG'ZAMSGF 10        Message file
     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue
     C                     MOVEL*BLANK    ZAMSID  7        Message Id.
     C                     MOVEL*BLANK    ZAMSDA132        Message data.
     C                     MOVEL*BLANK    ZAMSTP  7        Message type.
     C** PREPARE LDA
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'GL3271'  DBPGM
     C                     OUT  LDA
     C*
     C** PREPARE COMIT TEXT
     C*
     C                     MOVEL'GL'      MDID
     C                     MOVEL'GL3271'  PGMN
     C                     MOVELWSID      WSIDX
     C*
     C** Get Bank Details
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*FIRST ' @OPTN
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFEQ *BLANK
     C*
     C** IF FOUND CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C*
     C           BJDFIN    IFEQ 'M'                        MMDDYY, 98 ON B2
     C                     MOVE '1'       *IN98
     C                     END                             E2
     C* SET RUNA for screen
     C                     MOVE BJMRDT    RUNA
     C*
     C** OTHERWISE DB ERROR
     C*
     C                     ELSE
     C           *LOCK     IN   LDA                        ***************
     C                     Z-ADD3         DBASE            **DB ERROR 03**
     C                     MOVEL'SDBANKPD'DBFILE           ***************
     C                     MOVEL@OPTN     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             E1
     C/COPY WNCPYSRC,GL3271C243
     C*
     C** GET Module setup
     C*
     C                     CALL 'AOMMODR0'
     C                     PARM '*MSG    '@RTCD   7
     C                     PARM '*FIRST  '@OPTN   7
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C           @RTCD     IFEQ *BLANKS
     C*                                                                   CTI001
     C** If Midas/Trade Innovation Interface is on then set on *IN87      CTI001
     C*                                                                   CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     SETON                     87                   CTI001
     C                     ENDIF                                          CTI001
     C*
     C** IF FOUND CHECK RETAIL MODULE PRESENT
     C*
     C           BGRTBN    IFEQ 'Y'                        B2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP13                                           S01408
     C*                                                                   S01408
     C*
     C** Get Retail Details
     C*
     C                     CALL 'AORETLR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*FIRST ' @OPTN
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C           @RTCD     IFEQ *BLANK
     C*
     C** IF FOUND
     C*
     C           BMRANR    IFEQ 'Y'                        B4
     C                     MOVE '1'       *IN48
     C                     END                             E4
     C*
     C** OTHERWISE DB ERROR
     C*
     C                     ELSE                                        *X3
     C           *LOCK     IN   LDA                        ***************
     C                     Z-ADD4         DBASE            **DB ERROR 04**
     C                     MOVEL'SDRETLPD'DBFILE           ***************
     C                     MOVEL@OPTN     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             E3
     C                     END                             E2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CCPG                                           S01408
     C*                                                                   S01408
     C*
     C           *NAMVAR   DEFN           EMSDS
     C*
     C           *LOCK     IN   EMSDS
     C                     MOVE RQDTD     MODID   2
     C                     OUT  EMSDS
     C*
     C* IF PROGRAM HAS BEEN CALLED AS A LINKED ENQUIRY, SET UP CUSTOMER
     C* NUMBER, CURRENCY, ACCOUNT CODE, ACCOUNT SEQUENCE, BRANCH CODE
     C* AND RETAIL ACCOUNT NUMBER KEY FIELDS
     C*
     C           MODID     IFEQ 'GL'
     C                     MOVELCUSTNO    SCNUM
     C                     MOVELCURRCY    SCCY
     C                     MOVELACCODE    SACOD
     C                     MOVELACCSEQ    SACSQ
     C                     MOVELBRANCH    SBRCA
     C                     MOVE *BLANKS   SACNO
     C                     SETON                     05
     C                     END
     C*
     C** IF FOUND CHECK MICROFICHE MODULE PRESENT
     C*
     C           BGMFIC    IFEQ 'Y'
     C                     MOVE '1'       *IN35
     C                     END                             E2
     C*                                                                   S01486
     C** CHECK Portfolio  MODULE PRESENT                                  S01486
     C*                                                                   S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C                     MOVE '1'       *IN28                           S01486
     C                     OPEN PMPORTLL                                  S01486
      ** Access default Portfilio Reference                               S01486
     C           BGPFMG    IFEQ 'Y'                                       CPB001
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*FIRST ' @OPTN                           S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C*                                                                   S01486
     C           @RTCD     IFNE *BLANK                                    S01486
     C                     Z-ADD4         DBASE            ************** S01486
     C                     MOVEL'SDPORTPD'DBFILE           * DB ERROR 04* S01486
     C                     MOVEL' NONE '  DBKEY            ************** S01486
     C                     EXSR *PSSR                                     S01486
     C                     ELSE                                           CPM004
     C* Get input fields for use on call to AOPLCSR1                      CPM004
     C                     MOVELFCPORS    I#PORS                          CPM004
     C                     MOVELFCR997    I#R997                          CPM004
     C                     MOVEL*BLANKS   I#BOOK                          CPM004
     C                     END                                            S01486
     C                     ENDIF                                          CPB001
     C*                                                                   S01486
     C                     END                                            S01486
     C*
     C** OTHERWISE DB ERROR
     C*
     C                     ELSE
     C           *LOCK     IN   LDA                        ***************
     C                     Z-ADD5         DBASE            **DB ERROR 05**
     C                     MOVEL'SDMMODPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             E1
     C*
     C** Get General Ledger Details
     C*
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*FIRST ' @OPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA                        ***************
     C                     Z-ADD6         DBASE            **DB ERROR 06**
     C                     MOVEL'SDGELRPD'DBFILE           ***************
     C                     MOVEL@OPTN     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             E1
      *                                                                   080620
      * Don't display the 'Profit Centre' text if BkPrCu set to 'N'       080620
      * & also protect the PC from input                                  080620
      *                                                                   080620
     C           BKPRCU    IFEQ 'N'                                       080620
     C***********          SETON                     45             080620092290
     C                     SETON                     74                   092290
     C                     ENDIF                                          080620
      *                                                                   080620
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP17                                           S01408
     C*                                                                   S01408
     C*                                                                   CRT001
     C**  Check if Retail Teller System (CRT001) SAR is installed         CRT001
     C*                                                                   CRT001
     C                     CALL 'AOSARDR0'                                CRT001
     C                     PARM *BLANKS   @RTCD                           CRT001
     C                     PARM '*VERIFY' @OPTN                           CRT001
     C                     PARM 'CRT001'  @SAR    6                       CRT001
     C*                                                                   CRT001
     C           @RTCD     IFNE *BLANKS                    - B1           CRT001
     C                     MOVE '0'       *IN03                           CRT001
     C*                                                                   CRT001
     C                     ELSE                            - X1           CRT001
     C                     MOVE '1'       *IN03                           CRT001
     C                     MOVE 'Y'       CRT001  1                       CRT001
     C*                                                                   CRT001
     C**  Check if Account Password facility processing (CRT101)          CRT001
     C**  is installed                                                    CRT001
     C*                                                                   CRT001
     C                     CALL 'AOSARDR0'                                CRT001
     C                     PARM *BLANKS   @RTCD                           CRT001
     C                     PARM '*VERIFY' @OPTN                           CRT001
     C                     PARM 'CRT101'  @SAR    6                       CRT001
     C*                                                                   CRT001
     C           @RTCD     IFNE *BLANKS                    - B2           CRT001
     C                     MOVE '0'       *IN04                           CRT001
     C                     ELSE                            - X2           CRT001
     C                     MOVE '1'       *IN04                           CRT001
     C                     MOVE 'Y'       CRT101  1                       CRT001
     C                     END                             - E2           CRT001
     C*                                                                   CRT001
     C                     END                             - E1           CRT001
     C*                                                                   CRT002
     C/COPY WNCPYSRC,GL3271C261
     C**  Check if Retail Branch Access (CRT002) SAR is installed         CRT002
     C*                                                                   CRT002
     C                     CALL 'AOSARDR0'                                CRT002
     C                     PARM *BLANKS   @RTCD                           CRT002
     C                     PARM '*VERIFY' @OPTN                           CRT002
     C                     PARM 'CRT002'  @SAR    6                       CRT002
     C*                                                                   CRT002
     C           @RTCD     IFNE *BLANKS                                   CRT002
     C           CRT002    IFNE 'Y'                                       CRT002
     C                     MOVE '0'       *IN03                           CRT002
     C                     END                                            CRT002
     C*                                                                   CRT002
     C                     ELSE                                           CRT002
     C                     MOVE '1'       *IN03                           CRT002
     C                     MOVE 'Y'       CRT002  1                       CRT002
     C                     END                                            CRT002
     C*
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C111                                           S01408
      *                                                                   S01408
     C** ACCESS ICD FOR THE COMMISSIONS
     C*
     C           *INU1     IFEQ '1'                                       091796
     C                     READ TABTBRE                  80
     C           *IN80     IFEQ '1'                        - B1
     C           RECI      ORNE 'D'
     C           *LOCK     IN   LDA
     C                     Z-ADD7         DBASE            ***************
     C                     MOVEL'TABTBRE 'DBFILE           **DB ERROR 07**
     C                     MOVEL*BLANK    DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             - E1
     C                     ENDIF                                          091796
      *                                                                   CRE001
      **  Check if Overdraft Interest Calculation (CRE001) is installed   CRE001
      *                                                                   CRE001
     C                     MOVE *BLANK    CRE001  1                       CRE001
      *                                                                   CRE001
     C                     CALL 'AOSARDR0'                                CRE001
     C                     PARM *BLANKS   @RTCD                           CRE001
     C                     PARM '*VERIFY' @OPTN                           CRE001
     C                     PARM 'CRE001'  @SAR    6                       CRE001
     C*                                                                   CRE001
     C           @RTCD     IFNE *BLANKS                    - B2           CRE001
     C           @RTCD     IFNE '*NRF   '                  - B3           CRE001
     C           *LOCK     IN   LDA                                       CRE001
     C                     Z-ADD56        DBASE            ***************CRE001
     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 56**CRE001
     C                     MOVEL@SAR      DBKEY            ***************CRE001
     C                     OUT  LDA                                       CRE001
     C                     EXSR *PSSR                                     CRE001
     C                     ENDIF                           - E3           CRE001
     C                     ELSE                            - X2           CRE001
     C                     MOVE 'Y'       CRE001                          CRE001
     C                     MOVE '1'       *IN09                           CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CGL004
      ** Check to see whether Midas-Fontis interface is switched          CGL004
      ** on.                                                              CGL004
      *                                                                   CGL004
     C                     CALL 'AOSARDR0'                                CGL004
     C                     PARM *BLANKS   @RTCD                           CGL004
     C                     PARM '*VERIFY' @OPTN                           CGL004
     C                     PARM 'CGL004'  @SAR    6                       CGL004
      *                                                                   CGL004
     C           @RTCD     IFEQ *BLANK                                    CGL004
     C                     MOVE 'Y'       CGL004  1                       CGL004
     C                     ENDIF                                          CGL004
     C*                                                                   CEU013
     C**Check if EMU Account Posting Narr.(CEU013) SAR is installed       CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM *BLANKS   @RTCD                           CEU013
     C                     PARM '*VERIFY' @OPTN                           CEU013
     C                     PARM 'CEU013'  @SAR                            CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANKS                                   CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     END                                            CEU013
      *                                                                   CFT004
      *** Check if CFT004 is switched on                                  CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM '       ' @RTCD   7                       CFT004
     C                     PARM '*VERIFY' @OPTN   7                       CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
      *                                                                   CFT004
     C           @RTCD     IFEQ *BLANK                                    CFT004
     C                     MOVE *ON       *IN01                           CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C                     MOVE *OFF      *IN01                           CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      ** Determine if Data Export for CCRM Limits is active               CDE001
      *                                                                   CDE001
     C                     CALL 'AOSARDR0'                                CDE001
     C                     PARM *BLANKS   @RTCD                           CDE001
     C                     PARM '*VERIFY' @OPTN                           CDE001
     C                     PARM 'CDE001'  @SAR                            CDE001
      *                                                                   CDE001
     C           @RTCD     IFEQ *BLANK                                    CDE001
     C                     MOVE 'Y'       CDE001  1                       CDE001
     C                     ENDIF                                          CDE001
      *                                                                   CDE001
      **  Check if Revenue Analysis (CDE002) SAR is installed             CDE002
      *                                                                   CDE002
     C                     CALL 'AOSARDR0'                                CDE002
     C                     PARM *BLANKS   @RTCD                           CDE002
     C                     PARM '*VERIFY' @OPTN                           CDE002
     C                     PARM 'CDE002'  @SAR                            CDE002
      *                                                                   CDE002
     C           @RTCD     IFEQ *BLANKS                                   CDE002
     C                     MOVE 'Y'       CDE002  1                       CDE002
     C                     MOVE *ON       *IN83                           CDE002
     C                     ELSE                                           CDE002
     C                     MOVE *OFF      *IN83                           CDE002
     C                     MOVE 'N'       CDE002                          CDE002
     C                     ENDIF                                          CDE002
      *                                                                                       CRE030
      ** Check feature CRE030                                                                 CRE030
      *                                                                                       CRE030
     C                     CALL 'AOSARDR0'                                                    CRE030
     C                     PARM *BLANKS   @RTCD   7                                           CRE030
     C                     PARM '*VERIFY' @OPTN   7                                           CRE030
     C                     PARM 'CRE030'  @SARD   6                                           CRE030
     C*                                                                                       CRE030
     C           @RTCD     IFEQ *BLANKS                                                       CRE030
     C                     MOVE 'Y'       CRE030  1                                           CRE030
     C                     ELSE                                                               CRE030
     C                     MOVE 'N'       CRE030                                              CRE030
     C                     ENDIF                                                              CRE030
     C** Obtain System Value Modulus11lChk                                                    CGL062
     C                     MOVELC#MD11    P@OP01                                              CGL062
      *                                                                                       CGL062
     C                     CALL 'AOSVALR0'                                                    CGL062
     C                     PARM *BLANKS   P@RTCD                                              CGL062
     C                     PARM           P@OP01 20                                           CGL062
     C                     PARM *BLANKS   P@VL01200                                           CGL062
     C                     PARM *BLANKS   P@OP02 20                                           CGL062
     C                     PARM *BLANKS   P@VL02200                                           CGL062
     C                     PARM *BLANKS   P@OP03 20                                           CGL062
     C                     PARM *BLANKS   P@VL03200                                           CGL062
     C                     PARM *BLANKS   P@OP04 20                                           CGL062
     C                     PARM *BLANKS   P@VL04200                                           CGL062
     C                     PARM *BLANKS   P@OP05 20                                           CGL062
     C                     PARM *BLANKS   P@VL05200                                           CGL062
     C                     PARM *BLANKS   P@OP06 20                                           CGL062
     C                     PARM *BLANKS   P@VL06200                                           CGL062
     C                     PARM *BLANKS   P@OP07 20                                           CGL062
     C                     PARM *BLANKS   P@VL07200                                           CGL062
     C                     PARM *BLANKS   P@OP08 20                                           CGL062
     C                     PARM *BLANKS   P@VL08200                                           CGL062
     C                     PARM *BLANKS   P@OP09 20                                           CGL062
     C                     PARM *BLANKS   P@VL09200                                           CGL062
     C                     PARM *BLANKS   P@OP10 20                                           CGL062
     C                     PARM *BLANKS   P@VL10200                                           CGL062
      *                                                                                       CGL062
      **  If the Return Code is blank, set Modulus 11 Check Flag                              CGL062
     C           P@RTCD    IFEQ *BLANKS                                                       CGL062
     C                     MOVELP@VL01    MOD11   1                                           CGL062
     C                     ENDIF                                                              CGL062
      *                                                                   CDE002
      **  Check if CER050 is installed                                                        CER050
      *                                                                                       CER050
     C                     CALL 'AOSARDR0'                                                    CER050
     C                     PARM *BLANKS   @RTCD                                               CER050
     C                     PARM '*VERIFY' @OPTN                                               CER050
     C                     PARM 'CER050'  @SAR                                                CER050
      *                                                                                       CER050
     C           @RTCD     IFEQ *BLANKS                                                       CER050
     C                     MOVE 'Y'       CER050  1                                           CER050
     C                     MOVE *ON       *IN92                                               CER050
     C                     ELSE                                                               CER050
     C                     MOVE 'N'       CER050                                              CER050
     C                     MOVE *OFF      *IN92                                               CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C/COPY WNCPYSRC,GL3271C154
     C*
     C** CHECK IF COMMISSIONS ARE PRESENT OR NOT
     C*
     C                     MOVE '0'       *IN11
     C                     MOVE '0'       *IN12
     C                     MOVE '0'       *IN13
     C                     MOVE '0'       *IN14
     C                     MOVE '0'       *IN15
     C                     MOVE '0'       *IN16
     C                     MOVE '0'       *IN17
     C                     MOVE '0'       *IN18
     C                     MOVE '0'       *IN34
     C/COPY WNCPYSRC,GL3271C177
     C*
     C** Charge overide at account level
     C*
     C           TCAL      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN18
     C                     END                             - E1
     C*
     C** COMMISSION ON DEBIT TURNOVER
     C*
     C           CDTO      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN11
     C                     MOVE '1'       *IN34
     C                     END                             - E1
     C*
     C** COMMISSION ON HIGHEST OVERDRAFT
     C*
     C           CHOV      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN12
     C                     MOVE '1'       *IN34
     C                     END                             - E1
     C*
     C** FIXED ACCOUNT CHARGE
     C*
     C           FXAC      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN13
     C                     MOVE '1'       *IN34
     C                     END                             - E1
     C*
     C** CHARGE ON NUMBER OF DAILY STATEMENTS
     C*
     C           CNDS      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN14
     C                     MOVE '1'       *IN34
     C                     END                             - E1
     C*
     C** COMMISSION ON DEBIT INTEREST
     C*
     C           CDRI      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN15
     C                     MOVE '1'       *IN34
     C                     END                             - E1
     C*
     C** COMMISSION ON MINIMUM AVERAGE BALANCE
     C*
     C           CMBL      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN16
     C                     MOVE '1'       *IN34
     C                     END                             - E1
     C*
     C** CHARGE ON INACTIVE ACCOUNT
     C*
     C           CINA      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN17
     C                     MOVE '1'       *IN34
     C                     END                             - E1
     C*                                                                  *
     C** READ UP TO EIGHT GROUP RECORDS AND STORE RELEVANT DETAILS       *
     C** IN INTERNAL ARRAYS                                              *
     C*                                                                  *
     C                     Z-ADD0         I1
     C           1         SETLLTABLEV4F
     C*
     C           *IN10     DOUEQ'1'                        - B1
     C                     READ TABLEV4F                 10
     C           *IN10     IFEQ '0'                        - B2
     C                     ADD  1         I1
     C                     MOVE CGRP      GRP,I1
     C                     MOVE ACMI      IN1,I1
     C                     MOVE MDBI      IN2,I1
     C                     MOVE DINI      IN3,I1
     C                     MOVE INAI      IN4,I1
     C                     MOVE MINI      IN5,I1
     C                     MOVE DYSI      IN6,I1
     C                     MOVE FIXI      IN7,I1
     C*
     C** ONLY EIGHT CUSTOMER GROUP ARE POSSIBLE
     C*
     C           I1        IFEQ 8                          - B3
     C                     MOVE '1'       *IN10
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*
     C** IF LESS THAN EIGHT CUSTOMER GROUP FILL THE EMPTY FIELDS
     C** WITH HIGH VALUE
     C*
     C           I1        DOWLT8                          - B1
     C                     ADD  1         I1
     C                     MOVE *HIVAL    GRP,I1
     C                     END                             - E1
     C*
     C** Check if Action Code is Authorised, used default branch
     C*
     C           *IN05     IFEQ '0'
     C                     MOVE DBRN      @BRCA
     C*
     C** Prepare Input Authorisation
     C*
     C           BJSBRC    IFNE *BLANKS                                   097616
     C                     MOVE 'I'       @ZACTN
     C                     EXSR #AUTH
     C           @ERR      IFEQ 0
     C                     MOVE '1'       *IN40
     C                     END
     C                     ELSE                                           097616
     C           ENQY      IFEQ *BLANK                                    124824
     C                     MOVE '1'       *IN40                           097616
     C                     END                                            124824
     C                     END                                            097616
     C*
     C** Prepare Amend Authorisation
     C*
     C                     MOVE 'A'       @ZACTN
     C           BJSBRC    IFNE *BLANKS                                   097616
     C                     EXSR #AUTH                                     093216
     C           @ERR      IFEQ 0
     C                     MOVE '1'       *IN41
     C                     END
     C                     ELSE                                           097616
     C           ENQY      IFEQ *BLANK                                    124824
     C                     MOVE '1'       *IN41                           097616
     C                     END                                            124824
     C                     END                                            097616
     C*
     C** Prepare Close Authorisation
     C*
     C                     MOVE 'D'       @ZACTN
     C           BJSBRC    IFNE *BLANKS                                   097616
     C                     EXSR #AUTH                                     093216
     C           @ERR      IFEQ 0
     C                     MOVE '1'       *IN43
     C                     END
     C                     ELSE                                           097616
     C           ENQY      IFEQ *BLANK                                    124824
     C                     MOVE '1'       *IN43                           097616
     C                     END                                            124824
     C                     END                                            097616
     C*
     C                     END
     C*
     C** Prepare Start screen output
     C*
     C           *IN05     IFEQ '0'                        B1
     C                     MOVE 'F0'      WFMT    2
     C                     ELSE
     C*********************MOVE 'F1'      WFMT                            074576
     C                     MOVE 'F0'      WFMT                            074576
     C                     MOVEA'0010'    *IN,30
     C                     END
     C*
     C** INITIALISE FIELD
     C*
     C                     BITOF'01234567'BITOFF  1
     C*
      ** Check if Switchable Feature CAP205 is installed.                                     CAP205
      *                                                                                       CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   @RTCD                                               CAP205
     C                     PARM '*VERIFY' @OPTN                                               CAP205
     C                     PARM 'CAP205'  @SAR                                                CAP205
      *                                                                                       CAP205
     C           @RTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVE 'Y'       CAP205  1                                           CAP205
     C                     SETON                     10                                       CAP205
     C                     ELSE                                                               CAP205
     C                     MOVE 'N'       CAP205                                              CAP205
     C                     SETOF                     10                                       CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C           @RTCD     IFNE *BLANK                                                        CAP205
     C           @RTCD     ANDNE'*NRF   '                                                     CAP205
     C                     SETON                     U7U8LR                                   CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     MOVEL@RTCD     DBKEY                                               CAP205
     C                     Z-ADD63        DBASE                                               CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     END                                                                CAP205
      *                                                                                       CAP205
      *                                                                                     BUG23024
     C                     CALL 'AOSARDR0'                                                  BUG23024
     C                     PARM *BLANKS   @RTCD                                             BUG23024
     C                     PARM '*VERIFY' @OPTN                                             BUG23024
     C                     PARM 'CER047'  PSARD   6                                         BUG23024
      *                                                                                     BUG23024
     C           @RTCD     IFEQ *BLANKS                                                     BUG23024
     C                     MOVE 'Y'       CER047  1                                         BUG23024
     C                     ELSE                                                             BUG23024
     C                     MOVE 'N'       CER047                                            BUG23024
     C                     ENDIF                                                            BUG23024
      *                                                                                     BUG23024
      ** Check if Switchable Feature CRE090 is installed.                                     CRE090
     C                     CALL 'AOSARDR0'                                                    CRE090
     C                     PARM *BLANKS   @RTCD                                               CRE090
     C                     PARM '*VERIFY' @OPTN                                               CRE090
     C                     PARM 'CRE090'  PSARD                                               CRE090
      *                                                                                       CRE090
     C           @RTCD     IFEQ *BLANKS                                                       CRE090
     C                     MOVE 'Y'       CRE090  1                                           CRE090
     C                     ELSE                                                               CRE090
     C                     MOVE 'N'       CRE090                                              CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE095
      ** Check if Switchable Feature CRE095 is installed.                                     CRE095
     C                     CALL 'AOSARDR0'                                                    CRE095
     C                     PARM *BLANKS   @RTCD                                               CRE095
     C                     PARM '*VERIFY' @OPTN                                               CRE095
     C                     PARM 'CRE095'  PSARD                                               CRE095
      *                                                                                       CRE095
     C           @RTCD     IFEQ *BLANKS                                                       CRE095
     C                     MOVE *ON       *IN96                                               CRE095
     C                     MOVE 'Y'       CRE095  1                                           CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE 'N'       CRE095                                              CRE095
     C                     ENDIF                                                              CRE095
      /COPY OFCPYSRCZ,CRE101_075                                                              CRE101
      *                                                                                       CRE090
     C** Dummy reads to allow files to be specified as UPDATE in F-spec                       CRE005
     C                     MOVE *OFF      *IN02                                               CRE005
     C           *IN02     IFEQ *ON                                                           CRE005
     C                     READ RERCH1PD                 80                                   CRE005
     C                     READ RERCH2PD                 80                                   CRE005
     C                     READ RERCH3PD                 80                                   CRE005
     C                     ENDIF                                                              CRE005
     C*                                                                                       CRE005
     C                     ENDSR                           ** #P1001 ESR *
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1005   - SET WORK FIELDS TO BLANK                              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F0   - PROCESS START SCREEN                                  *
      * #P10S0   - PROCESS REVIEW FROM SUBFILE                           *
      * #P10FK   - INSERT AND DELETE MODE                                *
      * #P1002   - WRITE PROCESSING                                      *
      * #P1004   - DELETE PROCESSING                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1005    BEGSR
     C**
     C/COPY WNCPYSRC,GL3271CP74                                           S01408
     C*                                                                   S01408
     C** RESET WORK FIELDS FROM FILE
     C**
     C**********           Z-ADD0         SWCNUM                                              CSD027
     C                     MOVE *BLANKS   SWCNUM                                              CSD027
     C                     MOVEL*BLANKS   SWCCY
     C                     Z-ADD0         SWACOD
     C                     Z-ADD0         SWACSQ
     C                     MOVEL*BLANKS   SWSPTA
     C                     Z-ADD0         SWACNO
     C                     MOVEL*BLANKS   SWANAM
     C                     MOVEL*BLANKS   SWATYP
     C                     MOVEL*BLANKS   SWSTYP
     C                     Z-ADD0         SWDACO
     C                     Z-ADD0         SWDACC
     C                     Z-ADD0         SWNSTD
     C                     Z-ADD0         SWECFB
     C                     Z-ADD0         SWSTDY
     C                     MOVEL*BLANK    SWSTFQ
     C                     Z-ADD0         SWENOC
     C                     MOVELBITOFF    SWGLBT
     C                     MOVEL*BLANKS   SWREF
     C                     MOVELBITOFF    SWRETB
     C                     MOVEL*BLANK    SWMFFQ
     C                     MOVEL*BLANK    SWPRFC
     C                     MOVEL*BLANKS   SWPTFR                          S01486
     C** SECOND FORMAT
     C                     Z-ADD0         SWDRIB
     C                     Z-ADD0         SWDRIS
     C                     Z-ADD0         SWDICT
     C                     MOVE *BLANKS   SADRIB
     C                     MOVE *BLANKS   SADRIS
     C                     MOVE *BLANKS   SADSIG
     C                     MOVE *BLANKS   SADICT
     C                     MOVE *BLANKS   SADCST
     C                     Z-ADD0         SWDCST
     C                     Z-ADD0         SWDRCD
     C                     Z-ADD0         SWDRIC
     C                     Z-ADD0         SWNDID
     C                     MOVEL*BLANK    SWDRIF
     C                     Z-ADD*ZEROS    SWDRDY
     C                     MOVEL*BLANKS   SWDACP
     C                     MOVEL*BLANKS   SWDRBR
     C                     Z-ADD0         SWODLN
     C                     Z-ADD0         SWDLIM
     C                     Z-ADD0         SWODED
     C                     MOVEL*BLANK    SWODSC
     C**********           MOVEL*BLANKS   WWDACP 18                                           CGL029
     C**********           MOVEL*BLANKS   WWDAC2 18                                           CGL029
     C                     MOVEL*BLANKS   WWDACP 24                                           CGL029
     C                     MOVEL*BLANKS   WWDAC2 24                                           CGL029
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADD0         SWAODR                          CRE001
     C                     MOVEL*BLANKS   SWAODX                          CRE001
     C                     Z-ADD0         SWITRD                          CRE001
     C                     Z-ADD0         SWORTC                          CRE001
     C                     Z-ADD0         SWOLVD                          CRE001
     C                     Z-ADD0         SWPOLC                          CRE001
     C                     Z-ADD0         SWPOLE                          CRE001
     C                     Z-ADD0         WWAODR                          CRE001
     C                     Z-ADD0         WWORTC                          CRE001
     C                     Z-ADD0         WWBKVD                          CRE001
     C                     Z-ADD0         WWOLVD                          CRE001
     C                     Z-ADD0         WWODED                          CRE001
     C                     Z-ADD0         WWFWDL                          CRE001
     C                     Z-ADD0         WWPOLC                          CRE001
     C                     Z-ADD0         WWITRD                          CRE001
     C                     ENDIF                                          CRE001
     C** FORMAT 3
     C                     Z-ADD0         SWCRIB
     C                     Z-ADD0         SWCRIS
     C                     Z-ADD0         SWCICT
     C                     MOVE *BLANKS   SACRIB
     C                     MOVE *BLANKS   SACRIS
     C                     MOVE *BLANKS   SACSIG
     C                     MOVE *BLANKS   SACICT
     C                     MOVE *BLANKS   SAAMAL
     C                     Z-ADD0         SWAMAL
     C                     Z-ADD0         SWDR9
     C                     Z-ADD0         SWCRIC
     C                     Z-ADD0         SWNCID
     C                     MOVEL*BLANK    SWCRIF
     C                     Z-ADD*ZEROS    SWCRDY
     C                     MOVEL*BLANKS   SWCACP
     C                     MOVEL*BLANKS   SWCRBR
     C                     Z-ADD0         SWCHGT
     C                     Z-ADD0         SWMRT3
     C                     MOVEL*BLANKS   SWCHCP
     C                     MOVEL*BLANKS   SWCHBR
     C                     Z-ADD0         SWTCHO
     C**********           MOVEL*BLANKS   WWCACP 18                                           CGL029
     C**********           MOVEL*BLANKS   WWCAC2 18                                           CGL029
     C**********           MOVEL*BLANKS   WWCHCP 18                                           CGL029
     C**********           MOVEL*BLANKS   WWCHC2 18                                           CGL029
     C                     MOVEL*BLANKS   WWCACP 24                                           CGL029
     C                     MOVEL*BLANKS   WWCAC2 24                                           CGL029
     C                     MOVEL*BLANKS   WWCHCP 24                                           CGL029
     C                     MOVEL*BLANKS   WWCHC2 24                                           CGL029
     C** FORMAT 4
     C                     MOVEL*BLANKS   SWCEXA
     C                     MOVEL*BLANKS   SWCEXB
     C                     MOVEL*BLANKS   SWCEXC
     C                     MOVEL*BLANKS   SWCEXD
     C                     MOVEL*BLANKS   SWCEXE
     C                     MOVEL*BLANKS   SWCEXF
     C                     Z-ADD0         SWNOCC
     C                     MOVEL*BLANKS   SWCEXG
     C                     MOVEL*BLANKS   SWOVRD                          CDE002
     C                     MOVEL*BLANKS   SWOVRC                          CDE002
     C                     Z-ADD*ZEROS    SWDRMG                          CDE002
     C***********          Z-ADD*ZEROS    SWDRMG                    CDE002208221
     C                     Z-ADD*ZEROS    SWCRMG                          208221
     C                     MOVEL*BLANKS   SWDMBR                          208221
     C                     MOVEL*BLANKS   SWCMBR                          208221
     C** FORMAT 5
     C                     Z-ADD0         SWMDTN
     C                     Z-ADD0         SWFACT
     C                     Z-ADD0         SWFCNO
     C                     Z-ADD0         SWEFAC
     C                     MOVEL*BLANK    SWPTRA
     C                     MOVEL*BLANK    SWPRCH
     C                     MOVEL*BLANK    SWATYP
     C                     MOVEL*BLANK    SWSTYP
     C                     MOVEL*BLANK    SWBRTC
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed               CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C                     MOVE *BLANKS   SWPBKU                          CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C****If*Password*on*Retail*Savings*Account*(CRT101)*SAR*is*ON*****                CRT001 CSD101
     C*                                                                   CRT001
     C********** CRT101    IFEQ 'Y'                                                    CRT001 CSD101
     C**********           MOVE *BLANKS   SWPSWD                                       CRT001 CSD101
     C**********           END                                                         CRT001 CSD101
     C/COPY WNCPYSRC,GL3271C252
     C**
     C** RESET WORK FIELDS FROM SCREEN
     C**
     C**********           Z-ADD0         SSCNUM                                              CSD027
     C                     MOVE *BLANKS   SSCNUM                                              CSD027
     C                     MOVEL*BLANKS   SSCCY
     C                     Z-ADD0         SSACOD
     C                     Z-ADD0         SSACSQ
     C                     MOVEL*BLANK    SSATYP
     C                     MOVEL*BLANK    SSSTYP
     C                     MOVEL*BLANKS   SSSPTA
     C                     Z-ADD0         SSACNO
     C                     MOVEL*BLANKS   SSANAM
     C                     Z-ADD0         SSDACO
     C                     Z-ADD0         WWVDRC
     C                     Z-ADD0         WWVCRC
     C                     Z-ADD0         SSDACC
     C                     Z-ADD0         SSECFB
     C                     Z-ADD0         SSNSTD
     C                     Z-ADD0         SSSTDY
     C                     MOVEL*BLANK    SSSTFQ
     C                     Z-ADD0         SSENOC
     C                     MOVELBITOFF    SSGLBT
     C                     MOVEL*BLANKS   SSREF
     C                     MOVELBITOFF    SSRETB
     C                     MOVEL*BLANK    SSMFFQ
     C                     MOVEL*BLANKS   SSPRFC
     C                     MOVEL*BLANKS   SSPTFR                          S01486
     C*                                                                   CTI001
     C** If Midas/TI Interface is on then reset TI fields:                CTI001
     C*                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C                     MOVEL*BLANKS   SSTIAC                          CTI001
     C                     MOVEL*BLANKS   SSTIAN                          CTI001
     C                     MOVEL*BLANKS   SSTIAS                          CTI001
     C                     MOVEL*BLANKS   #TIDFT  1                       160464
     C                     ENDIF                                          CTI001
     C*                                                                   CTI001
     C** SECOND FORMAT
     C                     Z-ADD0         SSDRIB
     C                     Z-ADD0         SSDRIS
     C                     Z-ADD0         SSDICT
     C                     Z-ADD0         SSDCST
     C                     Z-ADD0         SSDRCD
     C                     Z-ADD0         SSDRIC
     C                     Z-ADD0         SSNDID
     C                     MOVEL*BLANK    SSDRIF
     C                     Z-ADD*ZEROS    SSDRDY
     C                     MOVEL*BLANKS   SSDACP
     C                     MOVE *BLANKS   SSDRBR
     C                     Z-ADD0         SSODLN
     C                     Z-ADD0         SSDLIM
     C                     Z-ADD0         SSODED
     C                     MOVEL*BLANK    SSODSC
     C** FORMAT 3
     C                     Z-ADD0         SSCRIB
     C                     Z-ADD0         SSCRIS
     C                     Z-ADD0         SSCICT
     C                     Z-ADD0         SSAMAL
     C                     Z-ADD0         SSDR9
     C                     Z-ADD0         SSCRIC
     C                     Z-ADD0         SSNCID
     C                     MOVEL*BLANK    SSCRIF
     C                     Z-ADD*ZEROS    SSCRDY
     C                     MOVEL*BLANKS   SSCACP
     C                     MOVE *BLANKS   SSCRBR
     C                     Z-ADD0         SSCHGT
     C                     Z-ADD0         SSMRT3
     C                     MOVEL*BLANKS   SSCHCP
     C                     MOVE *BLANKS   SSCHBR
     C                     Z-ADD0         SSTCHO
     C** FORMAT 4
     C                     MOVEL*BLANKS   SSCEXA
     C                     MOVEL*BLANKS   SSCEXB
     C                     MOVEL*BLANKS   SSCEXC
     C                     MOVEL*BLANKS   SSCEXD
     C                     MOVEL*BLANKS   SSCEXE
     C                     MOVEL*BLANKS   SSCEXF
     C                     Z-ADD0         SSNOCC
     C                     MOVEL*BLANKS   SSCEXG
     C** FORMAT 5
     C                     Z-ADD0         SSMDTN
     C                     Z-ADD0         SSFACT
     C                     Z-ADD0         SSFCNO
     C                     Z-ADD0         SSEFAC
     C                     MOVEL*BLANK    SSPTRA
     C                     MOVEL*BLANK    SSPRCH
     C                     MOVEL*BLANK    SSBRTC
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) is installed                   CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C                     MOVE *BLANKS   SSPBKU                          CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C****If*Password*on*Retail*Savings*Account*(CRT101)*SAR*is*ON*****                CRT001 CSD101
     C*                                                                   CRT001
     C********** CRT101    IFEQ 'Y'                                                    CRT001 CSD101
     C**********           MOVE *BLANKS   SSPSWD                                       CRT001 CSD101
     C**********           END                                                         CRT001 CSD101
     C*                                                                   CEU013
     C**  If EMU Account Posting Narrative is installed(CEU013)           CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN27     ANDEQ*ON                                       CEU013
     C                     MOVE *BLANKS   SWEUSB                          CEU013
     C                     END                                            CEU013
     C/COPY WNCPYSRC,GL3271C249
     C**
     C                     ENDSR                           ** #P1005 ESR *
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1006   - SET SCREEN FIELDS TO BLANK                            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F0   - PROCESS START SCREEN                                  *
      * #P10S0   - PROCESS REVIEW FROM SUBFILE                           *
      * #P10FK   - INSERT AND DELETE MODE                                *
      * #P1002   - WRITE PROCESSING                                      *
      * #P1004   - DELETE PROCESSING                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1006    BEGSR
     C**
     C                     Z-ADD0         ACTNLU  50
     C                     Z-ADD0         RETNLU  50
     C**
     C                     MOVEL*BLANKS   SKEY
     C                     MOVEL*BLANK    DDPKEY
     C                     MOVEL*BLANKS   SCNUM
     C                     MOVEL*BLANKS   SCCY
     C                     MOVEL*BLANK    DDSEL
     C                     MOVEL*BLANKS   SACOD
     C                     MOVEL*BLANKS   SACSQ
     C                     MOVEL*BLANKS   SBRCA
     C                     MOVEL*BLANKS   SACNUM
     C                     MOVEL*BLANKS   SACNO
     C                     MOVEL*BLANKS   SANAM
     C                     MOVEL*BLANKS   SDACO
     C                     MOVEL*BLANKS   SDACC
     C                     MOVEL*BLANKS   SNSTD
     C                     MOVEL*BLANKS   SNSDN
     C                     MOVEL*BLANK    SSTFQ
     C                     MOVEL*BLANKS   SENOC
     C                     MOVEL*BLANK    SPTAD
     C                     MOVEL*BLANKS   SREF
     C                     MOVEL*BLANK    SRAD
     C                     MOVEL*BLANK    SRAC
     C                     MOVEL*BLANK    SBAD
     C                     MOVEL*BLANK    SBAC
     C                     MOVEL*BLANK    SMFFQ
     C                     MOVEL*BLANKS   SDNCD
     C                     MOVEL*BLANKS   SPRFC
     C                     MOVEL*BLANKS   SLINK
     C                     MOVEL*BLANKS   SPTFR                           S01486
     C                     MOVEL*BLANKS   SIBAN                           CFT004
     C                     MOVEL*BLANKS   SIBSQ   3                       CFT004
     C/COPY WNCPYSRC,GL3271C050
     C*                                                                   CTI001
     C** If Midas/TI Interface is on then reset TI screen fields:         CTI001
     C*                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C                     MOVEL*BLANKS   STIAC                           CTI001
     C                     MOVEL*BLANKS   STIAN                           CTI001
     C                     MOVEL*BLANKS   STIAS                           CTI001
     C                     ENDIF                                          CTI001
     C** FORMAT 2
     C                     MOVEL*BLANKS   SDRIB
     C                     MOVEL*BLANKS   SDRIS
     C                     MOVEL*BLANK    SDSIG
     C                     MOVEL*BLANKS   SDICT
     C                     MOVEL*BLANKS   SDCST
     C                     MOVEL*BLANKS   SDRCD
     C                     MOVEL*BLANKS   ODRCD
     C                     MOVEL*BLANK    SDRIC
     C                     MOVEL*BLANKS   SNDID
     C                     MOVEL*BLANK    SDRIF
     C                     MOVEL*BLANK    SDNCD
     C                     MOVEL*BLANKS   SDACP
     C                     MOVEL*BLANKS   SODLN
     C                     MOVEL*BLANKS   SODED
     C                     MOVEL*BLANK    SODSC
     C                     MOVEL*BLANK    SDRBR
     C                     MOVEL*BLANK    SCRBR
     C                     MOVEL*BLANK    SCHBR
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     MOVEL*BLANK    SOLVD                           CRE001
     C                     MOVEL*BLANK    OPOLC                           CRE001
     C                     MOVEL*BLANK    SAODR                           CRE001
     C                     MOVEL*BLANK    SAODRX                          CRE001
     C                     MOVEL*BLANK    SORTC                           CRE001
     C                     MOVEL*BLANK    OPOLE                           CRE001
     C                     MOVEL*BLANK    SITRD                           CRE001
     C                     ENDIF                                          CRE001
     C** FORMAT 3
     C                     MOVEL*BLANKS   SCRIB
     C                     MOVEL*BLANKS   SCRIS
     C                     MOVEL*BLANK    SCSIG
     C                     MOVEL*BLANKS   SCICT
     C                     MOVEL*BLANKS   SCCST
     C                     MOVEL*BLANKS   SCRCD
     C                     MOVEL*BLANKS   OCRCD
     C                     MOVEL*BLANK    SCRIC
     C                     MOVEL*BLANKS   SNCID
     C                     MOVEL*BLANK    SCRIF
     C                     MOVEL*BLANK    SCNCD
     C                     MOVEL*BLANKS   SCACP
     C                     MOVEL*BLANKS   SCHGT
     C                     MOVEL*BLANKS   SCHST
     C                     MOVEL*BLANKS   SCHCP
     C                     MOVEL*BLANKS   STCHO
     C** FORMAT 4
     C                     MOVEL*BLANKS   SCEXA
     C                     MOVEL*BLANKS   SCEXB
     C                     MOVEL*BLANKS   SCEXC
     C                     MOVEL*BLANKS   SCEXD
     C                     MOVEL*BLANKS   SCEXE
     C                     MOVEL*BLANKS   SCEXF
     C                     MOVEL*BLANKS   SNOCC
     C                     MOVEL*BLANKS   SCEXG
     C                     MOVEL*BLANKS   SOVRD                           CDE002
     C                     MOVEL*BLANKS   SDRMG                           CDE002
     C                     MOVEL*BLANKS   SDRMG                           CDE002
     C                     MOVEL*BLANKS   SOVRC                           CDE002
     C                     MOVEL*BLANKS   SCRMG                           CDE002
     C                     MOVEL*BLANKS   SCRMG                           CDE002
     C** FORMAT 5
     C                     MOVEL*BLANKS   SMINB
     C                     MOVEL*BLANKS   SFACT
     C                     MOVEL*BLANKS   SFCNO
     C                     MOVEL*BLANKS   SEFAC
     C                     MOVEL*BLANK    SINAI
     C                     MOVEL*BLANK    SBRLI
     C                     MOVEL*BLANK    SBADI
     C                     MOVEL*BLANK    SPTRA
     C                     MOVEL*BLANK    SPRCH
     C                     MOVEL*BLANK    SBRTCA
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed               CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C                     MOVE *BLANKS   SPBKU                           CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C****If*Password*on*Retail*Savings*Account*(CRT101)*SAR*is*ON*****                CRT001 CSD101
     C*                                                                   CRT001
     C********** CRT101    IFEQ 'Y'                                                    CRT001 CSD101
     C**********           MOVE *BLANKS   SPSWD                                        CRT001 CSD101
     C**********           END                                                         CRT001 CSD101
     C*                                                                   CEU013
     C**  If EMU Account Posting Narrative is installed(CEU013)           CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN27     ANDEQ*ON                                       CEU013
     C                     MOVE *BLANKS   SEUSB                           CEU013
     C                     END                                            CEU013
      *                                                                                       CAP205
      ** If CAP205 is ON.                                                                     CAP205
      *                                                                                       CAP205
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVE *BLANKS   DDIABC                                              CAP205
     C                     MOVE '0'       DDTOLR    P                                         CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CER050
     C           CER050    IFEQ 'Y'                                                           CER050
     C                     MOVE *BLANKS   DDAPRP                                              CER050
     C                     MOVE *BLANKS   DDAPRC                                              CER050
     C                     MOVE *BLANKS   DDAPRD                                              CER050
     C                     END                                                                CER050
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #RETTS   - PROCESS VALIDATION OF RETAIL NUMBER                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10S0   - PROCESS REVIEW FROM SUBFILE                           *
      * #V10FK   - PROCESS VALIDATION OF 'FK' FORMAT                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #RETTS    BEGSR
     C/COPY WNCPYSRC,GL3271C041
     C**
     C                     Z-ADD1         Y       20
     C                     SETON                         80
     C           Y         DOWLT11
     C           *IN80     ANDEQ'1'
     C**
     C           RETA,Y    LOKUPNUM                      80
     C**
     C/COPY WNCPYSRC,GL3271C015
     C                     ADD  1         Y
     C                     END
     C/COPY WNCPYSRC,GL3271C016
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1020   - TRANSFER FILE FIELDS IN WORK FIELDS                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #DIR     - TO PROCESS FORMAT AND MODE                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWBRCD   - BRANCH CODE                                           *
      * WWLINK   - WORK FIELD                                            *
      *                                                                  *
      ********************************************************************
     C           #P1020    BEGSR
     C**
     C** ACCESS ACCBR
     C**
     C           WWACKB    CHAINACCNTLXX             80
     C/COPY WNCPYSRC,GL3271C156
     C                     Z-ADDTNLU      ACTNLU
     C                     MOVELATYP      SWATYP
     C                     MOVELSTYP      SWSTYP                          107478
     C*                                                                   CEU013
     C**  If EMU Account Posting Narrative is installed(CEU013)           CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN27     ANDEQ*ON                                       CEU013
     C                     MOVELEUSB      SWEUSB                          CEU013
     C                     END                                            CEU013
     C*
     C**
     C** VALUES FOR FIRST FORMAT (NOT RETAIL)
     C**
     C***********          Z-ADDBRCD      WWSPTA
     C                     MOVELBRCA      WWSPTA
     C** TEST IF IT IS A PRIME ACCOUNT
     C**
     C           LTAS      IFEQ 99
     C                     MOVE '1'       *IN47
     C                     ELSE
     C                     MOVE '0'       *IN47
     C                     END
     C                     MOVE '0'       *IN46
     C**
     C** TEST IF IT IS A SECONDARY ACCOUNT
     C**
     C           *IN47     IFEQ '0'
     C**
     C           RELINK    CHAINRELINKL1             81
     C           *IN81     IFEQ '0'
     C                     MOVE '1'       *IN46
     C                     MOVEL*BLANKS   SLINK                           117722
     C*                                                                   117722
     C** If RE number is being used, show RE number of the prime a/c.     117722
     C           *IN48     IFEQ '1'                                       117722
     C           ACLINK    KLIST                                          117722
     C                     KFLD           LTAB                            117722
     C                     KFLD           LTCUST                          117722
     C/COPY WNCPYSRC,GL3271C174
     C                     KFLD           LTCCY                           117722
     C/COPY WNCPYSRC,GL3271C175
     C                     KFLD           LTAC                            117722
     C                     KFLD           LTAS                            117722
     C           ACLINK    CHAINACCNTLXX             80                   117722
     C           *IN80     IFEQ '0'                                       117722
     C                     MOVELACNO      SLINK                           117722
     C                     ELSE                                           117722
     C                     MOVELWWLINK    SLINK                           117722
     C                     END                                            117722
     C           WWACKB    CHAINACCNTLXX             80                   117722
     C*                                                                   117722
     C                     ELSE                                           117722
     C*                                                                   117722
     C                     MOVELWWLINK    SLINK
     C                     END                                            117722
     C*                                                                   117722
     C                     END
     C                     END
     C                     MOVE '0'       *IN44
     C**
     C**********           Z-ADDCNUM      SWCNUM                                              CSD027
     C                     MOVE CNUM      SWCNUM                                              CSD027
     C                     MOVE CCY       SWCCY
     C                     Z-ADDACOD      SWACOD
     C                     Z-ADDACSQ      SWACSQ
     C                     MOVELBRCA      SWSPTA
     C                     Z-ADDACNO      SWACNO
     C**
     C**********           Z-ADDCNUM      SSCNUM                                              CSD027
     C                     MOVE CNUM      SSCNUM                                              CSD027
     C                     MOVE CCY       SSCCY
     C                     Z-ADDACOD      SSACOD
     C                     Z-ADDACSQ      SSACSQ
     C                     MOVELBRCA      SSSPTA
     C                     Z-ADDACNO      SSACNO
     C/COPY WNCPYSRC,GL3271C250
     C**
     C                     MOVE ANAM      SWANAM
     C                     Z-ADDDACO      SWDACO
     C                     Z-ADDDACO      WWVDRC
     C                     Z-ADDDACO      WWVCRC
     C                     Z-ADDDACC      SWDACC
     C                     Z-ADDNSTD      SWNSTD
     C                     MOVE STFQ      SWSTFQ
     C                     Z-ADDECFB      SWECFB
     C                     Z-ADDENOC      SWENOC
     C                     MOVELGLBT      SWGLBT
     C                     MOVELRETB      SWRETB
     C                     MOVELADREF1    SWREF
     C                     MOVE ADREF2    SWREF
     C                     MOVE MFFQ      SWMFFQ
     C                     MOVE PRFC      SWPRFC
     C                     MOVE STDY      SWSTDY
      *                                                                   S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C           PTFR      IFEQ '9997'                                    S01486
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C                     MOVE FCR997    SWPTFR                          S01486
     C                     ELSE                                           S01486
     C                     MOVE PTFR      SWPTFR                          S01486
     C                     END                                            S01486
      *                                                                   S01486
     C                     MOVE PTFR      WSPTFR  4                       S01486
      *                                                                   S01486
      ** Check date performance started for from Portfolio                S01486
     C*********************MOVE CNUM      CUST                     S01486 CPM004
     C/COPY WNCPYSRC,GL3271C062
     C           BGPFMG    IFEQ 'Y'                                       CPB001
     C                     MOVELCNUM      I#CUST                          CPM004
     C                     MOVELBRCA      I#BRCA                          CPM004
     C                     MOVEL*BLANKS   I#PTFR                          CPM004
     C                     MOVEL*BLANKS   I#CPGM                          CPM004
     C*                                                                   CPM004
     C                     CALL 'AOPLCSR1'                                CPM004
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  CPM004
     C                     PARM '*KEY   ' P@OPTN  7        I:Option       CPM004
     C                     PARM           I@PARM           I:Parameters   CPM004
     C                     PARM *BLANKS   O@PARM           O:Parameters   CPM004
     C           SDPLCS    PARM SDPLCS    DSFDY            O:Format       CPM004
     C*                                                                   CPM004
     C                     MOVELQBCUST    CUST                     S01486 CPM004
     C                     MOVE PTFR      PREF                            S01486
     C           POKEY     CHAINPMPORTLL             80                   S01486
     C           *IN80     IFEQ '0'                                       S01486
     C                     Z-ADDPNPSDT    WSPSDT  50                      S01486
     C                     ELSE                                           S01486
     C                     Z-ADD0         WSPSDT                          S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C                     ENDIF                                          CPB001
     C/COPY WNCPYSRC,GL3271C063
     C**
     C                     MOVE ANAM      SSANAM
     C                     Z-ADDDACO      SSDACO
     C                     Z-ADDDACC      SSDACC
     C                     Z-ADDNSTD      SSNSTD
     C                     Z-ADDECFB      SSECFB
     C                     MOVE STFQ      SSSTFQ
     C                     Z-ADDENOC      SSENOC
     C                     MOVELGLBT      SSGLBT
     C                     MOVELRETB      SSRETB
     C                     MOVELADREF1    SSREF
     C                     MOVE ADREF2    SSREF
     C                     MOVE MFFQ      SSMFFQ
     C                     MOVE PRFC      SSPRFC
     C                     MOVE STDY      SSSTDY
     C                     MOVE PTFR      SSPTFR                          S01486
      *                                                                   CTI001
      ** If Midas/Trade Innovation Interface is on then                   CTI001
      **   transfer TI fields from file to working fields.                CTI001
      *                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C                     MOVE A5TIAC    SSTIAC                          CTI001
     C                     MOVE A5TIAN    SSTIAN                          CTI001
     C                     MOVE A5TIAS    SSTIAS                          CTI001
     C           *IN30     IFEQ '1'                                       160469
     C           *IN31     OREQ '1'                                       160469
     C                     MOVE '1'       *IN89                           160469
     C                     ELSE                                           160469
     C                     MOVE '0'       *IN89                           160469
     C                     ENDIF                                          160469
     C                     ENDIF                                          CTI001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP32                                           S01408
     C*                                                                   S01408
     C**
     C** FOLLOWING FIELDS ONLY IF RETAIL PRESENT
     C** AND ACCOUNT RETAIL
     C** IN INSERT MODE ACCOUNT CODE MUST BE RETAIL
     C** IN AMEND OR ENQUIRY MODE ACCOUNT TYPE MUST BE 'R'
     C           *IN30     IFEQ '1'
     C           *IN29     ANDEQ'1'
     C           *IN31     OREQ '1'
     C           ATYP      ANDEQ'R'
     C           *IN32     OREQ '1'
     C           ATYP      ANDEQ'R'
     C**
     C**   ACCESS REIAC  FOR OTHER FIELDS
     C           WWACKY    CHAINREIACDXF             80
     C           NOALT     COMP 0                    44
     C                     Z-ADDTNLU      RETNLU
     C**
     C                     Z-ADDDRIB      SWDRIB
     C                     Z-ADDDRIS      SWDRIS
     C                     Z-ADDDICT      SWDICT
     C                     Z-ADDDCST      SWDCST
     C                     Z-ADDOLDR      SWDRCD
     C                     Z-ADDDRIC      SWDRIC
     C                     Z-ADDNDID      SWNDID
     C                     MOVELDRIF      SWDRIF
     C                     Z-ADDDRDY      SWDRDY
     C                     MOVELDACP      SWDACP
     C                     MOVELDRBR      SWDRBR
     C                     Z-ADDODLN      SWODLN                          106799
     C                     Z-ADDDLIM      SWDLIM                          106799
     C                     Z-ADDODED      SWODED                          106799
     C                     MOVELODSC      SWODSC                          106799
     C                     Z-ADDODLN      SSODLN                          106799
     C                     Z-ADDDLIM      SSDLIM                          106799
     C                     Z-ADDODED      SSODED                          106799
     C                     MOVELODSC      SSODSC                          106799
     C***IF*RETAIL*NUMBER*SEARCH*FOR*MIDAS*NUMBER*AND*SAVE*IT***          110695
     C******************** MOVELSWDACP    ACKEYK                          110695
     C******************** MOVE SWDRBR    WWBRCK                          110695
     C********** ACKEYK    IFNE *BLANKS                            030310 110695
     C********** ACCKYK    IFEQ *BLANKS                                   110695
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C103                                           S01408
     C*                                                                   S01408
      ** Save O/D Line, O/D Expiry Date and O/D Secured to workfields     116760
      *                                                                   116760
     C                     Z-ADDODLN      WODLN  110                      116760
     C                     Z-ADDODED      WODED   50                      116760
     C                     MOVELODSC      WODSC   1                       116760
      *                                                                   116760
     C********** RETKK     CHAINACNUM                80                   110695
     C********** *IN80     IFEQ '0'                                       110695
      *                                                                   116760
      ** Restore saved values                                             116760
      *                                                                   116760
     C                     Z-ADDWODLN     ODLN                            116760
     C                     Z-ADDWODED     ODED                            116760
     C                     MOVELWODSC     ODSC                            116760
      *                                                                   116760
     C******************   MOVE CNUM      WWCUSK                          110695
     C******************   MOVELCCY       WWCCYK                          110695
     C******************   MOVE ACOD      WWACOK                          110695
     C******************   MOVE ACSQ      WWACSK                          110695
     C******************   MOVE BRCA      WWBRCK                          110695
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C104                                           S01408
     C*                                                                   S01408
     C******************   END                                            110695
     C******************   END                                            110695
     C******************   END                                     030310 110695
     C******************   MOVELACKEYK    WWDAC2                          110695
     C*******************  Z-ADDODLN      SWODLN                          106799
     C*******************  Z-ADDDLIM      SWDLIM                          106799
     C*******************  Z-ADDODED      SWODED                          106799
     C*******************  MOVELODSC      SWODSC                          106799
     C**
     C                     Z-ADDDRIB      SSDRIB
     C                     Z-ADDDRIS      SSDRIS
     C                     Z-ADDDICT      SSDICT
     C                     Z-ADDDCST      SSDCST
     C                     Z-ADDOLDR      SSDRCD
     C                     Z-ADDDRIC      SSDRIC
     C                     Z-ADDNDID      SSNDID
     C                     MOVELDRIF      SSDRIF
     C                     Z-ADDDRDY      SSDRDY
     C                     MOVELDACP      SSDACP
     C                     MOVE DRBR      SSDRBR
     C******************** Z-ADDODLN      SSODLN                          106799
     C******************** Z-ADDDLIM      SSDLIM                          106799
     C******************** Z-ADDODED      SSODED                          106799
     C******************** MOVELODSC      SSODSC                          106799
     C**
     C                     Z-ADDCRIB      SWCRIB
     C                     Z-ADDCRIS      SWCRIS
     C                     Z-ADDCICT      SWCICT
     C                     Z-ADDCCST      SWAMAL
     C                     Z-ADDOLCR      SWDR9
     C                     Z-ADDCRIC      SWCRIC
     C                     Z-ADDNCID      SWNCID
     C                     MOVELCRIF      SWCRIF
     C                     Z-ADDCRDY      SWCRDY
     C                     MOVELCACP      SWCACP
     C                     MOVELCRBR      SWCRBR
     C***IF*RETAIL*NUMBER*SEARCH*FOR*MIDAS*NUMBER*AND*SAVE*IT*            110695
     C******************** MOVELSWCACP    ACKEYK                          110695
     C*********************MOVE SWCRBR    WWBRCK                          110695
     C********** ACCKYK    IFEQ *BLANKS                                   110695
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C105                                           S01408
     C*                                                                   S01408
     C********** RETKK     CHAINACNUM                80                   110695
     C********** *IN80     IFEQ '0'                                       110695
     C**************       MOVE CNUM      WWCUSK                          110695
     C**************       MOVELCCY       WWCCYK                          110695
     C**************       MOVE ACOD      WWACOK                          110695
     C**************       MOVE ACSQ      WWACSK                          110695
     C**************       MOVE BRCA      WWBRCK                          110695
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271C106                                           S01408
     C*                                                                   S01408
     C**************       END                                            110695
     C**************       END                                            110695
     C**************       MOVELACKEYK    WWCAC2                          110695
     C                     Z-ADDCHGT      SWCHGT
     C                     Z-ADDCHST      SWMRT3
     C                     MOVELCHAC      SWCHCP
     C                     MOVELCHBR      SWCHBR
     C***IF*RETAIL*NUMBER*SEARCH*FOR*MIDAS*NUMBER*AND*SAVE*IT*            110695
     C**********           MOVELSWCHCP    ACKEYK                          110695
     C**********           MOVE SWCHBR    WWBRCK                          110695
     C********** ACKEYK    IFNE *BLANKS                            030310 110695
     C********** ACCKYK    IFEQ *BLANKS                                   110695
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP95                                           S01408
     C*                                                                   S01408
     C********** RETKK     CHAINACNUM                80                   110695
     C********** *IN80     IFEQ '0'                                       110695
     C**********           MOVE CNUM      WWCUSK                          110695
     C**********           MOVELCCY       WWCCYK                          110695
     C**********           MOVE ACOD      WWACOK                          110695
     C**********           MOVE ACSQ      WWACSK                          110695
     C**********           MOVE BRCA      WWBRCK                          110695
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP96                                           S01408
     C*                                                                   S01408
     C**********           END                                            110695
     C**********           END                                            110695
     C**********           END                                     030310 110695
     C**********           MOVELACKEYK    WWCHC2                          110695
     C                     Z-ADDTCHO      SWTCHO
     C**
     C                     Z-ADDCRIB      SSCRIB
     C                     Z-ADDCRIS      SSCRIS
     C                     Z-ADDCICT      SSCICT
     C                     Z-ADDCCST      SSAMAL
     C                     Z-ADDOLCR      SSDR9
     C                     Z-ADDCRIC      SSCRIC
     C                     Z-ADDNCID      SSNCID
     C                     MOVELCRIF      SSCRIF
     C                     Z-ADDCRDY      SSCRDY
     C                     MOVELCACP      SSCACP
     C                     MOVE CRBR      SSCRBR
     C                     Z-ADDCHGT      SSCHGT
     C                     Z-ADDCHST      SSMRT3
     C                     MOVELCHAC      SSCHCP
     C                     MOVE CHBR      SSCHBR
     C                     Z-ADDTCHO      SSTCHO
      *                                                                   CRE001
      ***If*CRE001*is*ON*and*Account*is*Retail,*Transfer*******    CRE001 CDE002
      ***Overdraft*file*fields*to*work*fields******************    CRE001 CDE002
      ** If either CRE001 or CDE002 are ON and Account is Retail,         CDE002
      ** Transfer ACCNTBXC file fields to work fields                     CDE002
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C           ATYP      ANDEQ'R'                                       CRE001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           ATYP      ANDEQ'R'                                       CDE002
      *                                                                   CRE001
      ** Access Account Master  Extension                                 CRE001
      *                                                                   172230
     C           DDACTN    IFEQ 'E'                                       172230
     C           ACNTBX    CHAINACCNTBXC            N80                   172230
     C                     ELSE                                           172230
     C***********ACNTBX    CHAINACCNTBXC             80            CRE001 172230
     C           ACNTBX    CHAINACCNTBXC             8082                 172230
     C           *IN82     IFEQ '1'                                       172230
     C                     MOVEL'RE71805' ZAMSID                          172230
     C                     EXSR ZASNMS                                    172230
     C                     MOVE 'E'       ERR                             172230
     C                     ROLBK                                          172230
     C                     END                                            172230
     C                     ENDIF                                          172230
      *                                                                   CRE001
     C           *IN80     IFEQ *ON                        B.2            CRE001
     C           *LOCK     IN   LDA                                       CRE001
     C                     Z-ADD26        DBASE            ***************CRE001
     C                     MOVEL'ACCNTBXC'DBFILE           **DB ERROR 26**CRE001
     C                     MOVEL#CNUM     DBKEY            ***************CRE001
     C                     OUT  LDA                                       CRE001
     C                     EXSR *PSSR                                     CRE001
     C                     END                             E.2            CRE001
      *                                                                   CRE001
      ** Move file fields to screen work fields                           CRE001
      ** if CRE001 is on,                                                 208221
      *                                                                   208221
     C           CRE001    IFEQ 'Y'                                       208221
      *                                                                   208221
     C                     Z-ADDATAODR    SWAODR                          CRE001
     C                     Z-ADDATITRD    SWITRD                          CRE001
     C                     Z-ADDATORTC    SWORTC                          CRE001
     C                     Z-ADDATOLVD    SWOLVD                          CRE001
     C                     Z-ADDATPOLC    SWPOLC                          CRE001
     C                     Z-ADDATPOLE    SWPOLE                          CRE001
     C                     Z-ADDATITRD    SWITRD                          CRE001
      *                                                                   208221
     C                     ENDIF                                          208221
      *                                                                   208221
      ** if CDE002 is on,                                                 208221
      *                                                                   208221
     C           CDE002    IFEQ 'Y'                                       208221
      *                                                                   208221
     C                     MOVE ATOVRD    SWOVRD                          CDE002
     C                     MOVE ATOVRC    SWOVRC                          CDE002
     C                     Z-ADDATDRMG    SWDRMG                          CDE002
     C                     Z-ADDATCRMG    SWCRMG                          CDE002
     C                     MOVE ATDMBR    SWDMBR                          208221
     C                     MOVE ATCMBR    SWCMBR                          208221
      *                                                                   208221
     C                     ENDIF                                          208221
      *                                                                   CRE001
      ** Move file fields to store work fields                            CRE001
      ** if CRE001 is on,                                                 208221
      *                                                                   208221
     C           CRE001    IFEQ 'Y'                                       208221
      *                                                                   208221
     C                     Z-ADDATAODR    SSAODR                          CRE001
     C                     Z-ADDATITRD    SSITRD                          CRE001
     C                     Z-ADDATORTC    SSORTC                          CRE001
     C                     Z-ADDATOLVD    SSOLVD                          CRE001
     C                     Z-ADDATPOLC    SSPOLC                          CRE001
     C                     Z-ADDATPOLE    SSPOLE                          CRE001
     C                     Z-ADDATITRD    SSITRD                          CRE001
      *                                                                   208221
     C                     ENDIF                                          208221
      *                                                                   208221
      ** if CDE002 is on,                                                 208221
      *                                                                   208221
     C           CDE002    IFEQ 'Y'                                       208221
      *                                                                   208221
     C                     MOVE ATOVRD    SSOVRD                          CDE002
     C                     MOVE ATOVRC    SSOVRC                          CDE002
     C                     Z-ADDATDRMG    SSDRMG                          CDE002
     C                     Z-ADDATCRMG    SSCRMG                          CDE002
     C                     MOVE ATDMBR    SSDMBR                          208221
     C                     MOVE ATCMBR    SSCMBR                          208221
      *                                                                   208221
     C                     ENDIF                                          208221
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
     C**
     C** ACCES COMMISSION FILE ONLY IF AT LEAST ONE COMMISSION
     C**
     C           *IN34     IFEQ '1'
     C**
     C           WWACKB    CHAINRECOMXX              80
     C**
     C                     MOVELCEXA      SWCEXA
     C                     MOVELCEXB      SWCEXB
     C                     MOVELCEXC      SWCEXC
     C                     MOVELCEXD      SWCEXD
     C                     MOVELCEXE      SWCEXE
     C                     MOVELCEXF      SWCEXF
     C                     Z-ADDNOCC      SWNOCC
     C                     MOVELCEXG      SWCEXG
     C**
     C                     MOVELCEXA      SSCEXA
     C                     MOVELCEXB      SSCEXB
     C                     MOVELCEXC      SSCEXC
     C                     MOVELCEXD      SSCEXD
     C                     MOVELCEXE      SSCEXE
     C                     MOVELCEXF      SSCEXF
     C                     Z-ADDNOCC      SSNOCC
     C                     MOVELCEXG      SSCEXG
     C**
     C                     END
     C**
     C                     Z-ADDMINB      SWMDTN
     C                     Z-ADDFACT      SWFACT
     C                     Z-ADDFCNO      SWFCNO
     C                     Z-ADDEFAC      SWEFAC
     C                     MOVELPTRA      SWPTRA
     C                     MOVELPRCH      SWPRCH
     C**
     C                     Z-ADDMINB      SSMDTN
     C                     Z-ADDFACT      SSFACT
     C                     Z-ADDFCNO      SSFCNO
     C                     Z-ADDEFAC      SSEFAC
     C                     MOVELPTRA      SSPTRA
     C                     MOVELPRCH      SSPRCH
     C**
     C                     MOVELBRTCA     SWBRTC
     C                     MOVELBRTCA     SSBRTC
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed               CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C                     MOVE PBKU      SWPBKU                          CRT001
     C                     MOVE PBKU      SSPBKU                          CRT001
     C*                                                                   CRT001
     C****Protect*the*passbook*used*flag*field*if*set*to*'N'**     CRT001 107478
     C*                                                                   CRT001
     C***********PBKU      IFEQ 'N'                                CRT001 107478
     C***********          MOVE '1'       *IN06                    CRT001 107478
     C***********          ELSE                                    CRT001 107478
     C***********          MOVE '0'       *IN06                    CRT001 107478
     C***********          END                                     CRT001 107478
     C*                                                                   CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C**  If Password on Retail Savings Account (CRT101) SAR is ON        CRT001
     C*                                                                   CRT001
     C/COPY WNCPYSRC,GL3271C092
     C********** CRT101    IFEQ 'Y'                                                    CRT001 CSD101
     C********** CRT001    ANDEQ'Y'                                                    107478 CSD101
     C***********ATYP      ANDEQ'R'                                CRT001 107478
     C***********STYP      ANDEQ'S'                                CRT001 107478
     C/COPY WNCPYSRC,GL3271C080
     C********** SWATYP    ANDEQ'R'                                                    107478 CSD101
     C********** SWSTYP    ANDEQ'S'                                                    107478 CSD101
     C/COPY WNCPYSRC,GL3271C081
     C*                                                                   CRT001
     C***********WWACKY    CHAINREAPWDL0             80            CRT001 172230
     C********** WWACKY    CHAINREAPWDL0            N8082                              172230 CSD101
     C********** *IN82     IFEQ '1'                                                    172230 CSD101
     C**********           MOVEL'RE71805' ZAMSID                                       172230 CSD101
     C**********           EXSR ZASNMS                                                 172230 CSD101
     C**********           MOVE 'E'       ERR                                          172230 CSD101
     C**********           ROLBK                                                       172230 CSD101
     C**********           END                                                         172230 CSD101
     C********** *IN80     IFEQ '0'                                                    CRT001 CSD101
     C**********           MOVE PSWD      SWPSWD                                       CRT001 CSD101
     C**********           MOVE PSWD      SSPSWD                                       CRT001 CSD101
     C**********           END                                                         CRT001 CSD101
     C***********          MOVE '0'       *IN08                    CRT001 107478
     C*                                                                   CRT001
     C***********          ELSE                                    CRT001 107478
     C***********          MOVE '1'       *IN08                    CRT001 107478
     C**********           END                                                         CRT001 CSD101
     C/COPY WNCPYSRC,GL3271C093
     C**
     C                     END
      *                                                                   110695
      * If retail no. used for alt a/c to post DR int, get full a/c no.   110695
     C                     MOVELSWDACP    ACKEYK                          110695
     C                     MOVE SWDRBR    WWBRCK                          110695
     C           ACKEYK    IFNE *BLANKS                                   110695
     C           ACCKYK    IFEQ *BLANKS                                   110695
      *                                                                   174144
      ** Save RECI status and restore it after the chain, to ensure no    174144
      ** overwrite of RECI occurs if an alternate account is closed.      174144
      *                                                                   174144
     C                     MOVELRECI      RECISV                          174144
      *                                                                   174144
     C           RETKK     CHAINACNUM                80                   110695
      *                                                                   174144
     C                     MOVELRECISV    RECI                            174144
     C           *IN80     IFEQ '0'                                       110695
     C                     MOVE CNUM      WWCUSK                          110695
     C                     MOVELCCY       WWCCYK                          110695
     C                     MOVE ACOD      WWACOK                          110695
     C                     MOVE ACSQ      WWACSK                          110695
     C                     MOVE BRCA      WWBRCK                          110695
     C                     END                                            110695
     C                     END                                            110695
     C                     END                                            110695
     C                     MOVELACKEYK    WWDAC2                          110695
      *                                                                   110695
      * If retail no. used for alt a/c to post CR int, get full a/c no.   110695
     C                     MOVELSWCACP    ACKEYK                          110695
     C                     MOVE SWCRBR    WWBRCK                          110695
     C           ACCKYK    IFEQ *BLANKS                                   110695
      *                                                                   174144
      ** Save RECI status and restore it after the chain, to ensure no    174144
      ** overwrite of RECI occurs if an alternate account is closed.      174144
      *                                                                   174144
     C                     MOVELRECI      RECISV                          174144
      *                                                                   174144
     C           RETKK     CHAINACNUM                80                   110695
      *                                                                   174144
     C                     MOVELRECISV    RECI                            174144
     C           *IN80     IFEQ '0'                                       110695
     C                     MOVE CNUM      WWCUSK                          110695
     C                     MOVELCCY       WWCCYK                          110695
     C                     MOVE ACOD      WWACOK                          110695
     C                     MOVE ACSQ      WWACSK                          110695
     C                     MOVE BRCA      WWBRCK                          110695
     C                     END                                            110695
     C                     END                                            110695
     C                     MOVELACKEYK    WWCAC2                          110695
      *                                                                   110695
      * If retail no. used for alt a/c to post charges, get full a/c no   110695
     C                     MOVELSWCHCP    ACKEYK                          110695
     C                     MOVE SWCHBR    WWBRCK                          110695
     C           ACKEYK    IFNE *BLANKS                                   110695
     C           ACCKYK    IFEQ *BLANKS                                   110695
      *                                                                   174144
      ** Save RECI status and restore it after the chain, to ensure no    174144
      ** overwrite of RECI occurs if an alternate account is closed.      174144
      *                                                                   174144
     C                     MOVELRECI      RECISV                          174144
      *                                                                   174144
     C           RETKK     CHAINACNUM                80                   110695
      *                                                                   174144
     C                     MOVELRECISV    RECI                            174144
     C           *IN80     IFEQ '0'                                       110695
     C                     MOVE CNUM      WWCUSK                          110695
     C                     MOVELCCY       WWCCYK                          110695
     C                     MOVE ACOD      WWACOK                          110695
     C                     MOVE ACSQ      WWACSK                          110695
     C                     MOVE BRCA      WWBRCK                          110695
     C                     END                                            110695
     C                     END                                            110695
     C                     END                                            110695
     C                     MOVELACKEYK    WWCHC2                          110695
      *                                                                                       CER050
     C           CER050    IFEQ 'Y'                                                           CER050
      *                                                                                       CER050
     C                     MOVE *BLANKS   WAPRP   1                                           CER050
     C                     MOVE *BLANKS   WAPRCA 10                                           CER050
     C                     MOVE *BLANKS   WAPRD  10                                           CER050
      *                                                                                       CER050
     C                     MOVE ATAPRC    WAPRP                                               CER050
      *                                                                                       CER050
     C                     MOVE *IN55     SAV55   1                                           CER050
     C                     MOVE SACNO     WWRKEY                                              CER050
     C           WWRKEY    CHAINREAPRHI0             55                                       CER050
     C           *IN55     IFEQ *OFF                                                          CER050
     C                     MOVE IAPRR     ZFLD15                                              CER050
     C                     Z-ADD2         ZDECS                                               CER050
     C                     MOVEL'L'       ZECODE                                              CER050
     C                     EXSR ZFRPED                                                        CER050
     C                     MOVE ZOUT22    WAPRD                                               CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C           WWRKEY    CHAINREAPRHI1             55                                       CER050
     C           *IN55     IFEQ *OFF                                                          CER050
     C                     MOVE IAPRR     ZFLD15                                              CER050
     C                     Z-ADD2         ZDECS                                               CER050
     C                     MOVEL'L'       ZECODE                                              CER050
     C                     EXSR ZFRPED                                                        CER050
     C                     MOVE ZOUT22    WAPRCA                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     MOVE SAV55     *IN55                                               CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C* Set control date limit for rate value date
     C           SWDRIB    IFNE 0                          IF03
     C                     MOVE SWDRIB    WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFEQ *BLANKS                    IF03
     C           BAVDRC    ANDGTWWVDRC
     C                     Z-ADDBAVDRC    WWVDRC  50
     C                     END                             EN03
     C                     END                             EN03
     C**
     C* Set control date limit for rate value date
     C           SWCRIB    IFNE 0                          IF03
     C                     MOVE SWCRIB    WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFEQ *BLANKS                    IF03
     C           BAVDRC    ANDGTWWVCRC
     C                     Z-ADDBAVDRC    WWVCRC  50
     C                     END                             EN03
     C                     END                             EN03
      *       MUST BE VALID ON FILE.
     C           SWDICT    IFNE *ZERO
     C                     MOVE SWDICT    TYPE
     C                     MOVE SWDCST    SBTYPE
     C                     MOVE SCCY      CURR    3
     C                     MOVE 'D'       D
     C           KEY       CHAINREINT                50
     C           *IN50     IFEQ '0'
     C* Set control date limit for rate value date
     C           VDTC      IFGT WWVDRC
     C                     Z-ADDVDTC      WWVDRC
     C                     END                             EN03
     C           BRT       IFNE 0
     C                     MOVE BRT       WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFEQ *BLANKS                    IF03
     C           BAVDRC    ANDGTWWVDRC
     C                     Z-ADDBAVDRC    WWVDRC  50
     C                     END                             EN03
     C                     END                             EN03
     C                     END                             EN03
     C                     END                             EN03
     C**
      *       MUST BE VALID ON FILE.
     C           SWCICT    IFNE *ZERO
     C                     MOVE SWCICT    TYPE
     C                     MOVE SWAMAL    SBTYPE
     C                     MOVE SCCY      CURR    3
     C                     MOVE 'D'       D
     C           KEY       CHAINREINT                50
     C           *IN50     IFEQ '0'
     C* Set control date limit for rate value date
     C           VDTC      IFGT WWVCRC
     C                     Z-ADDVDTC      WWVCRC
     C                     END                             EN03
     C           BRT       IFNE 0
     C                     MOVE BRT       WWRIB
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*
     C           @RTCD     IFEQ *BLANKS                    IF03
     C           BAVDRC    ANDGTWWVCRC
     C                     Z-ADDBAVDRC    WWVCRC  50
     C                     END                             EN03
     C                     END                             EN03
     C                     END                             EN03
     C                     END                             EN03
     C           SWDRCD    IFGT WWVDRC
     C                     Z-ADDSWDRCD    WWVDRC  50
     C                     END                             EN03
     C           SWDR9     IFGT WWVCRC
     C                     Z-ADDSWDR9     WWVCRC  50
     C                     END                             EN03
     C                     Z-ADDWWVDRC    SWVDRC  50
     C                     Z-ADDWWVCRC    SWVCRC  50
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1031   - TRANSFER WORK FIELDS IN SCREEN FIELDS(1ST FORMAT)     *
      * #P1032   - TRANSFER WORK FIELDS IN SCREEN FIELDS(2ND FORMAT)     *
      * #P1033   - TRANSFER WORK FIELDS IN SCREEN FIELDS(3RD FORMAT)     *
      * #P1034   - TRANSFER WORK FIELDS IN SCREEN FIELDS(4TH FORMAT)     *
      * #P1035   - TRANSFER WORK FIELDS IN SCREEN FIELDS(5TH FORMAT)     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F1   - PROCESS ACCOUNT MASTER DETAILS                        *
      * #P10F2   - PROCESS DEBIT INTEREST DETAILS                        *
      * #P10F3   - PROCESS CREDIT INTEREST DETAILS                       *
      * #P10F4   - PROCESS COMMISSIONS DETAILS                           *
      * #P10F5   - PROCESS OTHER DETAILS                                 *
      * #DIR     - TO PROCESS FORMAT AND MODE                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1030    BEGSR
     C**
     C                     MOVE SWCNUM    SCNUM
     C                     MOVE SWCCY     SCCY
     C                     MOVE SWACOD    SACOD
     C                     MOVE SWACSQ    SACSQ
     C                     MOVE SWSPTA    SBRCA
     C**
     C           SWACNO    IFNE 0
     C                     MOVE SWACNO    SACNO
     C                     ELSE
     C                     MOVEL*BLANKS   SACNO
     C                     END
     C/COPY WNCPYSRC,GL3271C253
     C**
     C                     MOVE SWANAM    SANAM
     C                     MOVE SWPRFC    SPRFC
     C                     EXSR #P1031
     C**
     C** FOLLOWING LOADING ONLY IF RETAIL ACCOUNT
     C**
     C           *IN29     IFEQ '1'
     C           *IN33     ANDEQ'0'
     C                     EXSR #P1032
     C**
     C                     EXSR #P1033
     C**
     C***AT*LEAST*ONE*COMMISSION***************************************   CDE002
      ** At least one commission or CDE002 is present                     CDE002
     C**
     C           *IN34     IFEQ '1'
     C           CDE002    OREQ 'Y'                                       CDE002
     C**
     C                     EXSR #P1034
     C**
     C                     END
     C**
     C                     EXSR #P1035
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1031   - TRANSFER WORK FIELDS IN SCREEN FIELDS(1ST FORMAT)     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F1   - PROCESS ACCOUNT MASTER DETAILS                        *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1031    BEGSR
     C**
     C                     MOVELSWANAM    SANAM
     C**
     C** CONVERT DATE ACCOUNT OPENED
     C**
     C           SWDACO    IFNE 0
     C                     Z-ADDSWDACO    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SDACO
     C                     ELSE
     C                     MOVEL*BLANKS   SDACO
     C                     END
     C**
     C** CONVERT DATE ACCOUNT CLOSED
     C**
     C           SWDACC    IFNE 0
     C                     Z-ADDSWDACC    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SDACC
     C                     ELSE
     C                     MOVEL*BLANKS   SDACC
     C                     END
     C**
     C** CONVERT NEXT STATEMENT DATE
     C**
     C           SWNSTD    IFNE 0
     C                     Z-ADDSWNSTD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SNSTD
     C                     ELSE
     C                     MOVEL*BLANKS   SNSTD
     C                     END
     C**
     C                     MOVE SWSTFQ    SSTFQ
     C**
     C           SWENOC    IFNE 0
     C                     MOVE SWENOC    SENOC
     C                     ELSE
     C                     MOVEL*BLANKS   SENOC
     C                     END
     C**
     C                     MOVELSWREF     SREF
     C**
     C                     TESTB'0'       SWRETB         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SRAD
     C                     ELSE
     C                     MOVEL'N'       SRAD
     C                     END
     C**
     C                     TESTB'1'       SWRETB         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SRAC
     C                     ELSE
     C                     MOVEL'N'       SRAC
     C                     END
     C**
     C                     TESTB'2'       SWRETB         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SBAD
     C                     ELSE
     C                     MOVEL'N'       SBAD
     C                     END
     C**
     C                     TESTB'3'       SWRETB         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SBAC
     C                     ELSE
     C                     MOVEL'N'       SBAC
     C                     END
     C**
     C                     TESTB'2'       SWGLBT         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SPTAD
     C                     ELSE
     C                     MOVEL'N'       SPTAD
     C                     END
     C**
     C                     MOVE SWMFFQ    SMFFQ
      *                                                                   CTI001
      ** If Midas/Trade Innovation Interface is on then                   CTI001
      **   transfer TI fields to screen fields.                           CTI001
      *                                                                   CTI001
     C           *IN87     IFEQ '1'                                       CTI001
     C***********A5TIAC    IFEQ *BLANKS                             CTI001160463
     C           SSTIAC    IFEQ *BLANKS                                   160463
     C           SSTIAC    ORNE 'Y'                                       160463
     C                     MOVE 'N'       STIAC                           CTI001
     C                     ENDIF                                          160472
     C                     MOVE SSTIAC    STIAC                           160472
     C                     MOVE SSTIAN    STIAN                           160463
     C                     MOVE SSTIAS    STIAS                           160463
     C***********          ELSE                                     CTI001160472
     C***********          MOVE A5TIAC    STIAC                     CTI001160472
     C***********          MOVE A5TIAN    STIAN                     160463160472
     C***********          MOVE A5TIAS    STIAS                     160463160472
     C***********          ENDIF                                    CTI001160472
     C***********          MOVE A5TIAN    STIAN                     CTI001160463
     C***********          MOVE A5TIAS    STIAS                     CTI001160463
     C                     ENDIF                                          CTI001
      **                                                                  CTI001
      *                                                                   S01486
      ***If*customer*non*Portfolio*Customer*Portfolio*Reference*shoS01486 CPM004
      ***not*be*displayed.                                         S01486 CPM004
      *                                                                   S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C***********          CALL 'AOPLCSR0'                         S01486 CPM004
     C***********          PARM *BLANKS   @RTCD                    S01486 CPM004
     C***********          PARM '*KEY   ' @OPTN                    S01486 CPM004
     C***********          PARM SCNUM     @CUSN  10                S01486 CPM004
     C***********SDPLCS    PARM SDPLCS    DSFDY                    S01486 CPM004
      ***********                                                  S01486 CPM004
     C***********@RTCD     IFEQ '*NRF'                             S01486 CPM004
     C***********          MOVE '1'       *IN38                    S01486 CPM004
     C***********          ELSE                                    S01486 CPM004
     C                     MOVELSWPTFR    SPTFR                           S01486
     C***********          MOVE '0'       *IN38                    S01486 CPM004
     C***********          END                                     S01486 CPM004
     C                     END                                            S01486
     C**
     C                     Z-ADDSWSTDY    SSSTDY
     C                     MOVELSWSTDY    SNSDN
     C*                                                                   CEU013
     C**  If EMU Account Posting Narrative is installed(CEU013)           CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN27     ANDEQ*ON                                       CEU013
     C                     MOVELSWEUSB    SEUSB                           CEU013
     C                     END                                            CEU013
     C**
      *** IBAN field                                                      CFT004
      *                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           IBAN      IFNE *BLANKS                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM IBAN      @IBAN                           CFT004
     C                     PARM           @IWITH                          CFT004
     C                     PARM           @INOBL                          CFT004
      *                                                                   CFT004
     C           @RTCD     IFEQ *BLANK                                    CFT004
     C                     MOVEL@IWITH    SIBAN                           CFT004
     C                     ENDIF                                          CFT004
     C                     END                                            CFT004
     C                     END                                            CFT004
      *                                                                   CFT004
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1032   - TRANSFER WORK FIELDS IN SCREEN FIELDS(2ND FORMAT)     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZEDIT    - TO FORMAT A NUMERIC FIELD WITH DECIMAL POINT          *
      * ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F2   - PROCESS DEBIT INTEREST DETAILS                        *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1032    BEGSR
     C**
     C                     Z-ADDSWVDRC    WWVDRC
     C           SWDRIB    IFEQ 0
     C                     MOVEL*BLANKS   SDRIB
     C                     MOVEL*BLANKS   SADRIB
     C                     ELSE
     C                     MOVE DRIB      SDRIB
     C                     MOVE DRIB      SADRIB
     C                     END
     C**
     C                     MOVE *BLANKS   SDSIG
     C           SWDRIS    IFEQ 0
     C                     MOVEL*BLANKS   SDRIS
     C                     MOVEL*BLANKS   SADRIS
     C                     ELSE
     C           SWDRIS    IFLT 0
     C                     MOVE '-'       SDSIG
     C                     MOVE '-'       SADSIG
     C                     Z-SUBSWDRIS    SWDRIS
     C                     ELSE
     C                     MOVE '+'       SDSIG
     C                     MOVE '+'       SADSIG
     C                     END
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SWDRIS    ZFIELD
     C                     Z-ADD7         ZADEC
     C                     Z-ADD4         ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SDRIS
     C                     MOVE ZFIELD    SADRIS
     C           SDSIG     IFEQ '-'
     C                     Z-SUBSWDRIS    SWDRIS
     C                     END
     C**
     C                     END
     C**
     C           SWDICT    IFEQ 0
     C                     MOVEL*BLANKS   SDICT
     C                     MOVEL*BLANKS   SADICT
     C                     ELSE
     C                     MOVE DICT      SDICT
     C                     MOVE DICT      SADICT
     C                     END
     C**
     C           SWDCST    IFEQ 0
     C                     MOVEL*BLANKS   SDCST
     C                     MOVEL*BLANKS   SADCST
     C                     ELSE
     C                     MOVE SWDCST    SDCST
     C                     MOVE SWDCST    SADCST
     C                     END
     C**
     C                     MOVEL*BLANKS   SDRCD
     C           SWDRCD    IFEQ 0
     C                     MOVEL*BLANKS   ODRCD
     C                     ELSE
     C                     Z-ADDSWDRCD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     ODRCD
     C                     END
     C**
     C/COPY WNCPYSRC,GL3271C125
     C           SWDRIC    IFEQ 0
     C                     MOVEL*BLANKS   SDRIC
     C                     ELSE
     C                     MOVE SWDRIC    SDRIC
     C                     END
      *                                                                                     BUG23024
     C           CER047    IFEQ 'Y'                                                         BUG23024
     C           SDRIC     ANDEQ*BLANK                                                      BUG23024
     C                     MOVE '0'       SDRIC                                             BUG23024
     C                     ENDIF                                                            BUG23024
      *                                                                                     BUG23024
     C/COPY WNCPYSRC,GL3271C126
     C**
     C           SWNDID    IFEQ 0
     C                     MOVEL*BLANKS   SNDID
     C                     ELSE
     C                     Z-ADDSWNDID    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SNDID
     C                     END
     C**
     C                     MOVE SWDRIF    SDRIF
     C           SDRIF     IFEQ 'M'
     C           SDRIF     OREQ 'T'
     C           SDRIF     OREQ 'Q'
     C           SDRIF     OREQ 'X'
     C           SDRIF     OREQ 'Y'
     C                     MOVE SWDRDY    SDNCD
     C                     ELSE
     C                     MOVE *BLANKS   SDNCD
     C                     END
     C**
     C                     MOVE SWDACP    SDACP
     C                     MOVE SWDRBR    SDRBR
     C**
     C           SWODLN    IFEQ 0
     C                     MOVEL*BLANKS   SODLN
     C                     ELSE
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SWODLN    ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADD11        ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SODLN
     C                     END
     C**
     C           SWODED    IFEQ 0
     C                     MOVEL*BLANKS   SODED
     C                     ELSE
     C                     Z-ADDSWODED    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SODED
     C                     END
     C**
     C                     MOVE SWODSC    SODSC
      *                                                                   CRE001
      ** If CRE001 is ON, Transfer Overdraft workfields                   CRE001
      ** to corresponding screen fields                                   CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
     C           SWAODR    IFEQ 0                          B1             CRE001
     C                     MOVEL*BLANKS   SAODR                           CRE001
     C                     MOVEL*BLANKS   SAODRX                          CRE001
     C                     ELSE                            X1             CRE001
     C           SWAODR    IFLT 0                          B.2            CRE001
     C                     MOVE '-'       SAODRX                          CRE001
     C                     Z-SUBSWAODR    SWAODR                          CRE001
     C                     ELSE                            X.2            CRE001
     C                     MOVE '+'       SAODRX                          CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
     C**                                                                  CRE001
     C                     MOVEL*BLANKS   ZFIELD                          CRE001
     C           SWORTC    IFNE 0                                         CRE001
     C                     MOVE SWAODR    ZFIELD                          CRE001
     C                     Z-ADD7         ZADEC                           CRE001
     C                     Z-ADD4         ZADIG                           CRE001
     C                     EXSR ZEDIT                                     CRE001
     C                     MOVE ZFIELD    SAODR                           CRE001
     C                     END                                            CRE001
     C           SAODRX    IFEQ '-'                        B1             CRE001
     C                     Z-SUBSWAODR    SWAODR                          CRE001
     C                     ENDIF                           E1             CRE001
     C**                                                                  CRE001
     C           SWORTC    IFEQ 0                          B1             CRE001
     C                     MOVEL*BLANKS   SORTC                           CRE001
     C                     ELSE                            X1             CRE001
     C                     Z-ADDSWORTC    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZDATE     SORTC                           CRE001
     C                     ENDIF                           E1             CRE001
     C**                                                                  CRE001
     C           SWOLVD    IFEQ 0                          B1             CRE001
     C                     MOVEL*BLANKS   SOLVD                           CRE001
     C                     ELSE                            X1             CRE001
     C                     Z-ADDSWOLVD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZDATE     SOLVD                           CRE001
     C                     ENDIF                           E1             CRE001
     C**                                                                  CRE001
     C           SWPOLC    IFEQ 0                          B1             CRE001
     C                     MOVEL*BLANKS   OPOLC                           CRE001
     C                     ELSE                            X1             CRE001
     C                     Z-ADDSWPOLC    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZDATE     OPOLC                           CRE001
     C                     ENDIF                           E1             CRE001
     C**                                                                  CRE001
     C           SWPOLE    IFEQ 0                          B1             CRE001
     C                     MOVEL*BLANKS   OPOLE                           CRE001
     C                     ELSE                            X1             CRE001
     C                     Z-ADDSWPOLE    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZDATE     OPOLE                           CRE001
     C                     ENDIF                           E1             CRE001
     C**                                                                  CRE001
     C           SWITRD    IFEQ 0                          B1             CRE001
     C                     MOVEL*BLANKS   SITRD                           CRE001
     C                     ELSE                            X1             CRE001
     C           SWITRD    IFEQ 99999                      B.2            CRE001
     C                     MOVEL'999999'  SITRD                           CRE001
     C                     ELSE                            X.2            CRE001
     C                     Z-ADDSWITRD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZDATE     SITRD                           CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E1             CRE001
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C           CRE095    IFEQ 'Y'                                                           CRE095
     C           KEYAC     CHAINGLACNTL3             80                                       CRE095
     C           *IN80     IFEQ '0'                                                           CRE095
     C           F1DNFD    IFNE 0                                                             CRE095
     C                     Z-ADDF1DNFD    ZDAYNO                                              CRE095
     C                     EXSR ZDATE2                                                        CRE095
     C                     MOVE ZDATE     S1DNFD                                              CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   S1DNFD                                              CRE095
     C                     ENDIF                                                              CRE095
     C                     MOVE F1DNFF    S1DNFF                                              CRE095
     C           F1DNFM    IFNE 0                                                             CRE095
     C                     MOVE F1DNFM    S1DNFM                                              CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   S1DNFM                                              CRE095
     C                     ENDIF                                                              CRE095
     C           F1DRFD    IFNE 0                                                             CRE095
     C                     MOVE F1DRFD    S1DRFD                                              CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   S1DRFD                                              CRE095
     C                     ENDIF                                                              CRE095
     C                     MOVE F1DNFC    S1DNFC                                              CRE095
     C                     ENDIF                                                              CRE095
     C                     ENDIF                                                              CRE095
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1033   - TRANSFER WORK FIELDS IN SCREEN FIELDS(3RD FORMAT)     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZEDIT    - TO FORMAT A NUMERIC FIELD WITH DECIMAL POINT          *
      * ZDATE2   - TO FORMAT A MIDAS NUMBER IN ALPHA DATE                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F3   - PROCESS CREDIT INTEREST DETAILS                       *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1033    BEGSR
     C**
     C                     Z-ADDSWVCRC    WWVCRC
     C           SWCRIB    IFEQ 0
     C                     MOVEL*BLANKS   SCRIB
     C                     MOVEL*BLANKS   SACRIB
     C                     ELSE
     C                     MOVE CRIB      SCRIB
     C                     MOVE CRIB      SACRIB
     C                     END
     C**
     C                     MOVEL*BLANKS   SCSIG
     C           SWCRIS    IFEQ 0
     C                     MOVEL*BLANKS   SCRIS
     C                     MOVEL*BLANKS   SACRIS
     C                     ELSE
     C           SWCRIS    IFLT 0
     C                     MOVE '-'       SCSIG
     C                     MOVE '-'       SACSIG
     C                     Z-SUBSWCRIS    SWCRIS
     C                     ELSE
     C                     MOVEL'+'       SCSIG
     C                     MOVEL'+'       SACSIG
     C                     END
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SWCRIS    ZFIELD
     C                     Z-ADD7         ZADEC
     C                     Z-ADD4         ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCRIS
     C                     MOVE ZFIELD    SACRIS
     C           SCSIG     IFEQ '-'
     C                     Z-SUBSWCRIS    SWCRIS
     C                     END
     C**
     C                     END
     C**
     C           SWCICT    IFEQ 0
     C                     MOVEL*BLANKS   SCICT
     C                     MOVEL*BLANKS   SACICT
     C                     ELSE
     C                     MOVE CICT      SCICT
     C                     MOVE CICT      SACICT
     C                     END
     C**
     C           SWAMAL    IFEQ 0
     C                     MOVEL*BLANKS   SCCST
     C                     MOVEL*BLANKS   SAAMAL
     C                     ELSE
     C                     MOVE SWAMAL    SCCST
     C                     MOVE SWAMAL    SAAMAL
     C                     END
     C**
     C                     MOVEL*BLANKS   SCRCD
     C           SWDR9     IFEQ 0
     C                     MOVEL*BLANKS   OCRCD
     C                     ELSE
     C                     Z-ADDSWDR9     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     OCRCD
     C                     END
     C**
     C/COPY WNCPYSRC,GL3271C127
     C           SWCRIC    IFEQ 0
     C                     MOVEL*BLANKS   SCRIC
     C                     ELSE
     C                     MOVE SWCRIC    SCRIC
     C                     END
      *                                                                                     BUG23348
     C           CER047    IFEQ 'Y'                                                         BUG23348
     C           SCRIC     ANDEQ*BLANKS                                                     BUG23348
     C                     MOVE '0'       SCRIC                                             BUG23348
     C                     ENDIF                                                            BUG23348
      *                                                                                     BUG23348
     C/COPY WNCPYSRC,GL3271C128
     C**
     C           SWNCID    IFEQ 0
     C                     MOVEL*BLANKS   SNCID
     C                     ELSE
     C                     Z-ADDSWNCID    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SNCID
     C                     END
     C**
     C                     MOVE SWCRIF    SCRIF
     C           SCRIF     IFEQ 'M'
     C           SCRIF     OREQ 'T'
     C           SCRIF     OREQ 'Q'
     C           SCRIF     OREQ 'X'
     C           SCRIF     OREQ 'Y'
     C                     MOVE SWCRDY    SCNCD
     C                     ELSE
     C                     MOVE *BLANKS   SCNCD
     C                     END
     C**
     C                     MOVE SWCACP    SCACP
     C                     MOVE SWCRBR    SCRBR
     C**
     C           SWCHGT    IFEQ 0
     C                     MOVEL*BLANKS   SCHGT
     C                     ELSE
     C                     MOVE SWCHGT    SCHGT
     C                     END
     C**
     C           SWMRT3    IFEQ 0
     C                     MOVEL*BLANKS   SCHST
     C                     ELSE
     C                     MOVE SWMRT3    SCHST
     C                     END
     C**
     C                     MOVE SWCHCP    SCHCP
     C                     MOVE SWCHBR    SCHBR
     C**
     C           SWTCHO    IFEQ 0
     C                     MOVEL*BLANKS   STCHO
     C                     ELSE
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE SWTCHO    ZFIELD
     C                     Z-ADDWWDECS    ZADEC
     C           11        SUB  WWDECS    ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    STCHO
     C                     END
      *                                                                                       CRE095
     C           CRE095    IFEQ 'Y'                                                           CRE095
     C           F1CNFD    IFNE 0                                                             CRE095
     C                     Z-ADDF1CNFD    ZDAYNO                                              CRE095
     C                     EXSR ZDATE2                                                        CRE095
     C                     MOVE ZDATE     S1CNFD                                              CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   S1CNFD                                              CRE095
     C                     ENDIF                                                              CRE095
     C                     MOVE F1CNFF    S1CNFF                                              CRE095
     C           F1CNFM    IFNE 0                                                             CRE095
     C                     MOVE F1CNFM    S1CNFM                                              CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   S1CNFM                                              CRE095
     C                     ENDIF                                                              CRE095
     C           F1CRFD    IFNE 0                                                             CRE095
     C                     MOVE F1CRFD    S1CRFD                                              CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   S1CRFD                                              CRE095
     C                     ENDIF                                                              CRE095
     C                     MOVE F1CNFC    S1CNFC                                              CRE095
     C                     ENDIF                                                              CRE095
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1034   - TRANSFER WORK FIELDS IN SCREEN FIELDS(4TH FORMAT)     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZEDIT    - TO FORMAT A NUMERIC FIELD WITH DECIMAL POINT          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F4   - PROCESS COMMISSIONS DETAILS                           *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCEXW   - COMMISSION RATE - WORK FIELD                          *
      * WWCEXA   - COMMISSION RATE A                                     *
      * WWRATE   - WORK FIELD FOR RATE                                   *
      * WWCEXX   - WORK ARRAY                                            *
      * WWCEXB   - COMMISSION RATE B                                     *
      * WWAMT    - WORK FIELD - AMOUNT                                   *
      * WWDECS   - NUMBER OF DECIMALS                                    *
      * WWDIG    - NUMBER OF DIGITS                                      *
      *                                                                  *
      ********************************************************************
     C           #P1034    BEGSR
     C**
     C                     MOVELSWCEXA    WWCEXW
     C**
     C           WWCEXA    IFEQ 'E'
     C                     MOVELSWCEXA    SCEXA
     C                     ELSE
     C           WWRATE    IFEQ *ZEROS
     C                     MOVE *BLANKS   SCEXA
     C                     ELSE
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD8         ZADEC
     C                     Z-ADD2         ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCEXA
     C                     END
     C                     END
     C**
     C                     MOVELSWCEXB    WWCEXW
     C**
     C           WWCEXA    IFEQ 'E'
     C                     MOVELSWCEXB    SCEXB
     C                     ELSE
     C           WWRATE    IFEQ *ZEROS
     C                     MOVE *BLANKS   SCEXB
     C                     ELSE
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD8         ZADEC
     C                     Z-ADD2         ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCEXB
     C                     END
     C                     END
     C**
     C                     MOVELSWCEXC    WWCEXW
     C**
     C           WWCEXA    IFEQ 'E'
     C                     MOVELSWCEXC    SCEXC
     C                     ELSE
     C           WWRATE    IFEQ *ZEROS
     C                     MOVE *BLANKS   SCEXC
     C                     ELSE
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD8         ZADEC
     C                     Z-ADD2         ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCEXC
     C                     END
     C                     END
     C**
     C                     MOVELSWCEXD    WWCEXX
     C**
     C           WWCEXB    IFEQ 'E'
     C                     MOVELSWCEXD    SCEXD
     C                     ELSE
     C           WWMONT    IFEQ *ZEROS
     C                     MOVE *BLANKS   SCEXD
     C                     ELSE
     C                     Z-ADDWWMONT    WWAMT  130
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWAMT     ZFIELD
     C                     Z-ADDWWDECS    ZADEC
     C           7         SUB  WWDECS    ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCEXD
     C                     END
     C                     END
     C**
     C                     MOVELSWCEXE    WWCEXX
     C**
     C           WWCEXB    IFEQ 'E'
     C                     MOVELSWCEXE    SCEXE
     C                     ELSE
     C           WWMONT    IFEQ *ZEROS
     C                     MOVE *BLANKS   SCEXE
     C                     ELSE
     C                     Z-ADDWWMONT    WWAMT
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWAMT     ZFIELD
     C                     Z-ADDWWDECS    ZADEC
     C           7         SUB  WWDECS    ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCEXE
     C                     END
     C                     END
     C**
     C                     MOVELSWCEXF    WWCEXX
     C**
     C           WWCEXB    IFEQ 'E'
     C                     MOVELSWCEXF    SCEXF
     C                     ELSE
     C           WWMONT    IFEQ *ZEROS
     C                     MOVE *BLANKS   SCEXF
     C                     ELSE
     C                     Z-ADDWWMONT    WWAMT
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWAMT     ZFIELD
     C                     Z-ADDWWDECS    ZADEC
     C           7         SUB  WWDECS    ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCEXF
     C                     END
     C                     END
     C**
     C                     MOVELSWCEXG    WWCEXX
     C**
     C           WWCEXB    IFEQ 'E'
     C                     MOVELSWCEXG    SCEXG
     C                     ELSE
     C***********WWMONT    IFEQ *ZEROS                                    060509
     C           WWCEXX    IFEQ *BLANKS                                   060509
     C                     MOVE *BLANKS   SCEXG
     C                     ELSE
     C                     Z-ADDWWMONT    WWAMT
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWAMT     ZFIELD
     C                     Z-ADDWWDECS    ZADEC
     C           7         SUB  WWDECS    ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCEXG
     C                     END
     C                     END
     C**
     C                     MOVE SWEFAC    SEFAC
     C*********************MOVE SWEFAC    SEFAC                           103352
     C**                                                                  103352
     C           SWEFAC    IFEQ 0                                         103352
     C                     MOVEL*BLANKS   SEFAC                           103352
     C                     ELSE                                           103352
     C                     MOVE SWEFAC    SEFAC                           103352
     C                     END                                            103352
     C**
     C           SWNOCC    IFEQ 0
     C                     MOVEL*BLANKS   SNOCC
     C                     ELSE
     C                     MOVE SWNOCC    SNOCC
     C                     END
     C**
      *                                                                   CDE002
      ** If CDE002 is present, load screen fields for Dr/Cr Int. Margin   CDE002
      *                                                                   CDE002
     C           CDE002    IFEQ 'Y'                                       CDE002
     C                     MOVE SWOVRD    SOVRD                           CDE002
     C                     MOVE SWOVRC    SOVRC                           CDE002
      *                                                                   CDE002
     C           SWDRMG    IFEQ *ZEROS                                    CDE002
     C           SWDMBR    ANDNE*BLANKS                                   208221
     C                     MOVE SWDMBR    SDRMG                           208221
     C***************      MOVE *BLANKS   SDRMG                     CDE002208221
     C                     ELSE                                           CDE002
     C***************      MOVEL*BLANKS   ZFIELD                    CDE002208221
     C***************      MOVE SWDRMG    ZFIELD                    CDE002208221
     C***************      Z-ADD7         ZADEC                     CDE002208221
     C***************      Z-ADD4         ZADIG                     CDE002208221
     C***************      EXSR ZEDIT                               CDE002208221
     C***************      MOVE ZFIELD    SDRMG                     CDE002208221
     C                     MOVEL*BLANKS   ZFLD15                          208221
     C                     MOVE SWDRMG    ZFLD15                          208221
     C                     Z-ADD7         ZDECS                           208221
     C                     MOVEL'L'       ZECODE                          208221
     C                     EXSR ZFRPED                                    208221
     C                     MOVE ZOUT22    SDRMG                           208221
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C           SWCRMG    IFEQ *ZEROS                                    CDE002
     C           SWCMBR    ANDNE*BLANKS                                   208221
     C                     MOVE SWCMBR    SCRMG                           208221
     C***************      MOVE *BLANKS   SCRMG                     CDE002208221
     C                     ELSE                                           CDE002
     C***************      MOVEL*BLANKS   ZFIELD                    CDE002208221
     C***************      MOVE SWCRMG    ZFIELD                    CDE002208221
     C***************      Z-ADD7         ZADEC                     CDE002208221
     C***************      Z-ADD4         ZADIG                     CDE002208221
     C***************      EXSR ZEDIT                               CDE002208221
     C***************      MOVE ZFIELD    SCRMG                     CDE002208221
     C                     MOVEL*BLANKS   ZFLD15                          208221
     C                     MOVE SWCRMG    ZFLD15                          208221
     C                     Z-ADD7         ZDECS                           208221
     C                     MOVEL'L'       ZECODE                          208221
     C                     EXSR ZFRPED                                    208221
     C                     MOVE ZOUT22    SCRMG                           208221
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1035   - TRANSFER WORK FIELDS IN SCREEN FIELDS(5TH FORMAT)     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZEDIT    - TO FORMAT A NUMERIC FIELD WITH DECIMAL POINT          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F5   - PROCESS OTHER DETAILS                                 *
      * #P1030   - TRANSFER WORK FIELDS IN SCREEN FIELDS(ALL FORMATS)    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1035    BEGSR
     C**
     C           SWMDTN    IFEQ 0
     C                     MOVEL*BLANKS   SMINB
     C                     ELSE
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SWMDTN    ZFIELD
     C                     Z-ADD*ZEROS    ZADEC
     C           11        SUB  *ZEROS    ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SMINB
     C                     END
     C**
     C           SWFACT    IFEQ 0
     C                     MOVEL*BLANKS   SFACT
     C                     ELSE
     C                     MOVE FACT      SFACT
     C                     END
     C**
     C           SWFCNO    IFEQ 0
     C                     MOVEL*BLANKS   SFCNO
     C                     ELSE
     C                     MOVE FCNO      SFCNO
     C                     END
     C**                                                                  053200
     C           SWEFAC    IFEQ 0                                         053200
     C                     MOVEL*BLANKS   SEFAC                           053200
     C                     ELSE                                           053200
     C                     MOVE SWEFAC    SEFAC                           053200
     C                     END                                            053200
     C**
     C                     TESTB'4'       SWRETB         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SINAI
     C                     ELSE
     C                     MOVEL'N'       SINAI
     C                     END
     C**
     C                     TESTB'6'       SWRETB         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SBRLI
     C                     ELSE
     C                     MOVEL'N'       SBRLI
     C                     END
     C**
     C                     TESTB'7'       SWRETB         85
     C           *IN85     IFEQ '1'
     C                     MOVEL'Y'       SBADI
     C                     ELSE
     C                     MOVEL'N'       SBADI
     C                     END
     C**
     C                     MOVE SWPTRA    SPTRA
     C                     MOVE SWPRCH    SPRCH
     C                     MOVE SWBRTC    SBRTCA
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed               CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           ICPBKU    ANDEQ'Y'                                       107478
     C           SWATYP    ANDEQ'R'                                       107478
     C           SWSTYP    ANDEQ'S'                                       107478
     C           CRT002    OREQ 'Y'                                       CRT002
     C           ICPBKU    ANDEQ'Y'                                       CRT002
     C           SWATYP    ANDEQ'R'                                       CRT002
     C           SWSTYP    ANDEQ'S'                                       CRT002
     C                     MOVE SWPBKU    SPBKU                           CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C****If*Password*on*Retail*Savings*Account*(CRT101)*SAR*is*ON*****                CRT001 CSD101
     C*                                                                   CRT001
     C/COPY WNCPYSRC,GL3271C094
     C********** CRT101    IFEQ 'Y'                                                    CRT001 CSD101
     C********** CRT001    ANDEQ'Y'                                                    107478 CSD101
     C***********ATYP      ANDEQ'R'                                CRT001 107478
     C***********STYP      ANDEQ'S'                                CRT001 107478
     C/COPY WNCPYSRC,GL3271C082
     C********** SWATYP    ANDEQ'R'                                                    107478 CSD101
     C********** SWSTYP    ANDEQ'S'                                                    107478 CSD101
     C/COPY WNCPYSRC,GL3271C083
     C**********           MOVE SWPSWD    SPSWD                                        CRT001 CSD101
     C**********           END                                                         CRT001 CSD101
     C/COPY WNCPYSRC,GL3271C095
     C**
      *                                                                                     BUG23055
     C           CER047    IFEQ 'Y'                                                         BUG23055
     C           ATYP      ANDEQ'R'                                                         BUG23055
     C                     MOVE K24C      #1K24C                                            BUG23055
     C                     MOVE X'A0'     PSDSP                                             BUG23055
     C                     MOVE X'20'     PSDS2                                             BUG23055
     C                     ELSE                                                             BUG23055
     C                     MOVE X'A7'     PSDSP                                             BUG23055
     C                     MOVE X'27'     PSDS2                                             BUG23055
     C                     ENDIF                                                            BUG23055
      *                                                                                     BUG23055
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C           KEYAC     CHAINGLACNTL3             95                                       CAP205
     C           *IN95     IFEQ '1'                                                           CAP205
     C                     MOVEL*BLANKS   DDIABC                                              CAP205
     C                     MOVE '0'       DDTOLR    P                                         CAP205
     C                     ELSE                                                               CAP205
      *                                                                                       CAP205
      ** Account Balance Check Indicator                                                      CAP205
      *                                                                                       CAP205
     C                     MOVE F1IABC    DDIABC    P                                         CAP205
      *                                                                                       CAP205
      ** Overdraft Tolerance                                                                  CAP205
      *                                                                                       CAP205
     C                     Z-ADDF1TOLR    ZFLD15                                              CAP205
     C                     MOVEL'J'       ZECODE                                              CAP205
      *                                                                                       CAP205
     C                     CALL 'AOCURRR0'                                                    CAP205
     C                     PARM           @RTCD                                               CAP205
     C                     PARM '*KEY   ' @OPTN                                               CAP205
     C                     PARM F1CCY     @CCY                                                CAP205
     C           SDCURR    PARM SDCURR    DSSDY                                               CAP205
      *                                                                                       CAP205
     C           @RTCD     IFNE *BLANKS                                                       CAP205
     C           *LOCK     IN   LDA                                                           CAP205
     C                     SETON                     U7U8                                     CAP205
     C                     MOVE '063'     DBASE                                               CAP205
     C                     MOVEL'SDCURRPD'DBFILE                                              CAP205
     C                     MOVELF1CCY     DBKEY                                               CAP205
     C                     OUT  LDA                                                           CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     ELSE                                                               CAP205
     C                     Z-ADDA6NBDP    ZDECS                                               CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C                     CALL 'ZSEDIT'                                                      CAP205
     C                     PARM           ZFLD15                                              CAP205
     C                     PARM           ZDECS                                               CAP205
     C                     PARM           ZECODE                                              CAP205
     C                     PARM           ZOUT21 21                                           CAP205
     C                     MOVE ZOUT21    DDTOLR    P                                         CAP205
      *                                                                                       CAP205
     C                     ENDIF                                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      ** Get Delay Capitalisation Days                                                        CRE090
     C                     MOVE *BLANKS   SDECD                                               CRE090
     C                     MOVE *OFF      *IN95                                               CRE090
     C           CRE090    IFEQ 'Y'                                                           CRE090
     C           ATYP      ANDEQ'R'                                                           CRE090
     C                     MOVE *ON       *IN95                                               CRE090
     C           KEYAC     CHAINGLACNTL3             80                                       CRE090
     C           *IN80     IFEQ '0'                                                           CRE090
     C                     MOVE F1DECD    ZFIELD                                              CRE090
     C                     Z-ADD0         ZADIG                                               CRE090
     C                     EXSR ZEDIT                                                         CRE090
     C                     MOVE ZFIELD    SDECD                                               CRE090
     C                     ENDIF                                                              CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
      /COPY OFCPYSRCZ,CRE101_076                                                              CRE101
     C           CER050    IFEQ 'Y'                                                           CER050
      *                                                                                       CER050
     C           WAPRP     IFEQ ' '                                                           CER050
     C                     MOVE *BLANKS   DDAPRP                                              CER050
     C                     ELSE                                                               CER050
     C                     MOVE WAPRP     DDAPRP                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C           WAPRD     IFEQ *BLANKS                                                       CER050
     C                     MOVE *BLANKS   DDAPRD                                              CER050
     C                     ELSE                                                               CER050
     C                     MOVE WAPRD     DDAPRD                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C           WAPRCA    IFEQ *BLANKS                                                       CER050
     C                     MOVE *BLANKS   DDAPRC                                              CER050
     C                     ELSE                                                               CER050
     C                     MOVE WAPRCA    DDAPRC                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1002   - WRITE PROCESSING                                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      * ZTNLU1   - TO RETRIEVE THE NEXT TRANSACTION NUMBER               *
      * #P1005   - SET WORK FIELDS TO BLANK                              *
      * #P1006   - SET SCREEN FIELDS TO BLANK                            *
      * #DIR     - TO PROCESS FORMAT AND MODE                            *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWDSPY   - DISPLAY CODE                                          *
      *                                                                  *
      ********************************************************************
     C           #P1002    BEGSR
     C*
     C/COPY WNCPYSRC,GL3271CP71                                           S01408
      *                                                                   S01408
     C** 0.
     C*
     C           *INU1     IFEQ '1'
     C** Only update MEMOS for RETAIL A/Cs                                072541
     C           *IN29     ANDEQ'1'                                       072541
     C***********                                                         CCB002
     C***********          MOVE '0'       *IN88                           CCB002
     C***********                                                         CCB002
     C***********1         CHAINMEMOS                80                   CCB002
     C***********                                                         CCB002
     C************IN80     IFEQ '1'                        - B1           CCB002
     C************IN87     OREQ '0'                                       CCB002
     C************LOCK     IN   LDA                                       CCB002
     C***********          Z-ADD8         DBASE            ***************CCB002
     C***********          MOVEL'MEMOS   'DBFILE           **DB ERROR 08**CCB002
     C***********          OUT  LDA                        ***************CCB002
     C***********          EXSR *PSSR                                     CCB002
     C***********          END                             - E1           CCB002
     C***********                                                         CCB002
     C***********FLSZM     SUB  NAMR      WRK5    50                      CCB002
     C***********WRK5      IFEQ 2                          - B1           CCB002
     C***********          MOVEL'RE71606' ZAMSID                          CCB002
     C***********          EXSR ZASNMS                                    CCB002
     C***********          MOVE '1'       ERR                             CCB002
     C***********          ELSE                            - X1           CCB002
     C***********                                                         CCB002
     C***********          Z-ADDNAMR      SSNAMR  50                      CCB002
     C***********NAMR      ADD  1         NAMR                            CCB002
     C***********          MOVE '1'       *IN76                           CCB002
     C***********          EXCPT                                          CCB002
     C***********                                                         CCB002
     C***********SSNAMR    CHAINMEMOS                80                   CCB002
     C***********                                                         CCB002
     C************IN80     IFEQ '1'                        - B2           CCB002
     C************IN88     OREQ '0'                                       CCB002
     C************LOCK     IN   LDA                                       CCB002
     C***********          Z-ADD9         DBASE            ***************CCB002
     C***********          MOVEL'MEMOS   'DBFILE           **DB ERROR 09**CCB002
     C***********          OUT  LDA                        ***************CCB002
     C***********          EXSR *PSSR                                     CCB002
     C***********          END                             - E2           CCB002
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP88                                           S01408
     C*                                                                   S01408
     C                     MOVE 'D'       RECI
     C**********           Z-ADDSSCNUM    CNUM                                         CCB002 CSD027
     C                     MOVE SSCNUM    CNUM                                                CSD027
     C                     MOVE SSCCY     CCY                             CCB002
     C                     Z-ADDSSACOD    ACOD                            CCB002
     C                     Z-ADDSSACSQ    ACSQ                            CCB002
     C                     MOVELSSSPTA    BRCA                            CCB002
     C                     Z-ADDSSACNO    ACNO                            CCB002
     C                     Z-ADD*ZEROS    LDBLN
     C                     Z-ADD*ZEROS    CLBLN
     C                     MOVE *BLANKS   ZZ005
     C                     Z-ADD*ZEROS    INLU
     C                     Z-ADD*ZEROS    BNLU
     C                     WRITEMEMOSMDF                                  CCB002
     C/COPY WNCPYSRC,GL3271C155
     C*                                                                   CCB002
     C***********          MOVE '1'       *IN76                           CCB002
     C***********          MOVE '0'       *IN87                           CCB002
     C***********          EXCPT                                          CCB002
     C***********                                                         CCB002
     C***********          END                             - E1           CCB002
     C*
     C                     END
     C*
     C                     EXSR ZTNLU1
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271C110                                           S01408
      *                                                                   S01408
     C*
     C** 5.
     C*
     C                     MOVE 'D'       RECI
     C**********           Z-ADDSSCNUM    CNUM                                                CSD027
     C                     MOVE SSCNUM    CNUM                                                CSD027
     C                     MOVE SSCCY     CCY
     C                     Z-ADDSSACOD    ACOD
     C                     Z-ADDSSACSQ    ACSQ
     C                     MOVE *BLANKS   LTAB
     C                     Z-ADD0         LTAS
     C                     MOVE *BLANK    ZZ001
     C                     MOVELSSSPTA    BRCA
     C**
     C                     MOVE SSATYP    ATYP
     C                     MOVE SSSTYP    STYP
     C                     MOVE SSMFFQ    MFFQ
     C                     MOVE *BLANK    ACST
     C                     Z-ADDSSDACO    DACO
     C                     Z-ADD0         DACC
     C                     MOVE SSANAM    ANAM
     C                     Z-ADD0         LDBL
     C                     Z-ADD0         CLBL
     C                     MOVE SSSTFQ    STFQ
     C                     Z-ADDSSSTDY    STDY
     C                     Z-ADDDACO      LSTD
     C                     Z-ADDSSNSTD    NSTD
     C                     Z-ADD0         LSTP
     C                     Z-ADD0         CFSB
     C                     Z-ADD0         LMVD
     C                     Z-ADD0         EPLB
     C                     Z-ADD0         EPCB
     C                     Z-ADD0         YTDB
     C                     MOVE SSGLBT    GLBT
     C                     MOVELSSREF     ADREF1
     C                     Z-ADD0         LTAC
     C                     Z-ADDBJRDNB    ORED
     C                     Z-ADDSSDLIM    DLIM
     C                     Z-ADD0         LRCR
     C                     Z-ADD0         RTCB
     C                     Z-ADD0         RTLB
     C                     Z-ADD0         DITM
     C                     Z-ADD0         CITM
     C                     MOVE SSREF     ADREF2
     C                     MOVE *BLANK    ZZ002
     C                     Z-ADD0         CDIR
     C                     Z-ADD0         CCIR
     C                     Z-ADDSSACNO    ACNO
     C                     MOVE SSRETB    RETB
     C                     MOVE SSODSC    ODSC
     C/COPY WNCPYSRC,GL3271C051
     C                     Z-ADDSSODLN    ODLN
     C                     Z-ADDSSODED    ODED
     C                     Z-ADD0         DIOD
     C                     Z-ADDSSFACT    FACT
     C                     Z-ADDSSFCNO    FCNO
     C                     Z-ADDSSEFAC    EFAC
     C                     Z-ADD0         HELD
     C                     Z-ADDSSMDTN    MINB
     C                     Z-ADDDACO      LACD
     C                     Z-ADD0         LISP
     C                     Z-ADDSSNAMR    RRNM
     C                     Z-ADDSSDRIB    DRIB
     C                     Z-ADDSSDRIS    DRIS
     C                     Z-ADDSSDRCD    OLDR
     C/COPY WNCPYSRC,GL3271C129
     C                     Z-ADDSSDRIC    DRIC
     C/COPY WNCPYSRC,GL3271C130
     C                     MOVE SSDRIF    DRIF
     C                     Z-ADDSSDRDY    DRDY
     C                     Z-ADDSSNDID    NDID
     C                     Z-ADDDACO      LDID
     C                     Z-ADD0         LDIA
     C                     MOVE SSSDAP    SDAP
     C                     Z-ADD0         LPAR
     C                     Z-ADD0         DIIE
     C                     Z-ADD0         DAIC
     C                     Z-ADD0         MADI
     C                     Z-ADD0         GADI
     C                     MOVE *BLANK    DDIS
     C                     Z-ADDDACO      DDIA
     C                     Z-ADD0         DRCD
     C                     Z-ADD0         OLDB
     C                     Z-ADD0         OLDS
     C                     Z-ADDSSCRIB    CRIB
     C                     Z-ADDSSCRIS    CRIS
     C                     Z-ADDSSDR9     OLCR
     C/COPY WNCPYSRC,GL3271C131
     C                     Z-ADDSSCRIC    CRIC
     C/COPY WNCPYSRC,GL3271C132
     C                     MOVE SSCRIF    CRIF
     C                     Z-ADDSSCRDY    CRDY
     C                     Z-ADDSSNCID    NCID
     C                     Z-ADDDACO      LCID
     C                     Z-ADD0         LCIA
     C                     MOVE SSSCAP    SCAP
     C                     Z-ADDDACO      LPAP
     C                     Z-ADD0         CIIE
     C                     Z-ADD0         CAIC
     C                     Z-ADD0         MACI
     C                     Z-ADD0         GACI
     C                     MOVE SSCDIS    CDIS
     C                     Z-ADDDACO      DCIA
     C                     Z-ADDSSOLCR    OLCR
     C                     Z-ADD0         OLCB
     C                     Z-ADD0         OLCS
     C                     Z-ADDBJRDNB    LCD
     C                     MOVE 'I'       CHTP
     C                     Z-ADDNATN      TNLU
     C                     Z-ADDSSENOC    ENOC
     C                     MOVE SSPRFC    PRFC
     C                     MOVE SSBRTC    BRTCA
     C                     MOVE SSPTFR    PTFR                            S01486
     C                     Z-ADD0         EPNO
     C                     Z-ADD0         ECFB
      *                                                                   CTI001
      ** If Midas/Trade Innovation Interface is on then move              CTI001
      ** TI fields to be written to file.                                 CTI001
      *                                                                   CTI001
     C           *IN87     IFEQ *ON                                       CTI001
     C                     MOVE SSTIAC    A5TIAC                          CTI001
     C                     MOVE SSTIAN    A5TIAN                          CTI001
     C                     MOVE SSTIAS    A5TIAS                          CTI001
     C                     MOVE '1'       *IN89                           160463
     C                     ENDIF                                          CTI001
     C*                                                                   164492
     C** Initialize field                                                 164492
     C                     MOVE *BLANK    EUSB                            164492
     C*                                                                   CTI001
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN27     ANDEQ*ON                                       CEU013
     C                     MOVE SEUSB     EUSB                            CEU013
     C                     ENDIF                                          CEU013
      *                                                                   CFT004
      *** IBAN field                                                      CFT004
      *                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                                           206824
     C                     CALL 'AOIBANR3'                                                    206824
     C                     PARM *BLANKS   @RTCD                                               206824
     C                     PARM SIBAN     @IBAN                                               206824
     C                     PARM           @IWITH                                              206824
     C                     PARM           @INOBL                                              206824
      *                                                                                       206824
     C           @RTCD     IFEQ *BLANKS                                                       206824
     C           DDACTN    IFEQ 'I'                                                           206824
     C                     MOVEL@INOBL    IBAN                                                206824
     C                     MOVELSIBSQ     IBSEQN                                              206824
     C                     ENDIF                                                              206824
     C           DDACTN    IFEQ 'A'                                                           206824
     C           A8GENM    ANDEQ'1'                                                           206824
     C           SIBAN     ANDNE*BLANKS                                                       206824
     C                     MOVE @INOBL    IBAN                                                206824
     C                     ENDIF                                                              206824
     C                     ENDIF                                                              206824
     C                     ENDIF                                                              206824
      *                                                                                       206824
     C**********           MOVELSIBAN     IBAN                                         CFT004 206824
     C                     MOVELSIBSQ     IBSEQN                          CFT004
      *                                                                   CFT004
     C                     MOVEASTAMP,1   ABTMST           Default Timestamp                  CPK015
     C                     WRITEACCNTABF               89
     C/COPY WNCPYSRC,GL3271C200
     C*
     C           *IN89     IFEQ '1'                        - B4
     C                     MOVEL'RE71600' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     MOVE '0'       *IN80
     C/COPY WNCPYSRC,GL3271C035
     C                     END                             - E4
     C/COPY WNCPYSRC,GL3271C157
     C**
     C** UPDATE ACCNTAC
     C**
     C           1         SETLLACCNTAC
     C                     READ ACCNTAC                  80
     C**
     C                     ADD  1         NINU
     C                     ADD  1         NOAU
     C           *IN29     IFEQ '1'
     C                     ADD  1         NRET
     C                     END
     C                     Z-ADDBJRDNB    LCD
     C                     EXSR ZTNLU1
     C                     Z-ADDNATN      TNLU
     C                     UPDATACCNTCXF
     C*
     C           *IN29     IFEQ '1'                        - B3
     C                     EXSR #P1040
     C                     END                             - E3
     C*
     C** 6.
     C*
     C           *IN80     IFEQ '0'                        - B3
     C           *IN29     ANDEQ'1'
     C           *INU1     ANDEQ'1'                                       083651
     C*
     C** 6.1
     C*
     C**********           MOVE 'D'       RECI                            182760
     C                     MOVE 'D'       RECIRC                          182760
     C**********           Z-ADDSSCNUM    CNUM                                                CSD027
     C                     MOVE SSCNUM    CNUM                                                CSD027
     C                     MOVE SSCCY     CCY
     C                     Z-ADDSSACOD    ACOD
     C                     Z-ADDSSACSQ    ACSQ
     C                     MOVE SSSPTA    BRCA
     C                     Z-ADDSSDICT    DICT
     C                     Z-ADDSSDCST    DCST
     C                     MOVE SSDACP    DACP
     C                     MOVE *BLANK    DICP
     C                     Z-ADDSSCICT    CICT
     C                     Z-ADDSSAMAL    CCST
     C                     MOVE SSCACP    CACP
     C                     MOVE *BLANK    CICP
     C                     Z-ADDSSCHGT    CHGT
     C                     Z-ADDSSMRT3    CHST
     C                     MOVE SSCHCP    CHAC
     C                     MOVE SSPTRA    PTRA
     C                     MOVE SSPRCH    PRCH
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed               CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C                     MOVE SSPBKU    PBKU                            CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C                     Z-ADD0         NRCA
     C                     Z-ADD0         RCA
     C                     Z-ADD0         MCLB
     C                     MOVE *BLANK    ZZ015
     C                     Z-ADD0         NOALT
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE STCHO     ZFIELD
     C                     MOVE SSDRBR    DRBR
     C                     MOVE SSCRBR    CRBR
     C                     MOVE SSCHBR    CHBR
     C                     Z-ADDWWDECS    ZADEC
     C           7         SUB  WWDECS    ZADIG
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    TCHO
      *
     C                     WRITEREIACDF                89
     C*
     C           *IN89     IFEQ '1'                        - B4
     C                     MOVEL'RE71601' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     MOVE '1'       *IN80
     C                     END                             - E4
     C** UPDATE FOR ALTERNATE ACCOUNTS
     C**
     C           SSDACP    IFNE *BLANKS
     C                     MOVELWWDACP    ACKEYK
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     ADD  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ 1
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE 'Y'       BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END
     C                     END
     C*
     C           SSCACP    IFNE *BLANKS
     C                     MOVELWWCACP    ACKEYK
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     ADD  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ 1
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE 'Y'       BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END
     C                     END
     C*
     C           SSCHCP    IFNE *BLANKS
     C                     MOVELWWCHCP    ACKEYK
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     ADD  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ 1
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE 'Y'       BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END
     C                     END
     C*
     C** 6.2
     C*
     C           *IN80     IFEQ '0'                        - B4
     C**********           MOVE 'D'       RECI                            182760
     C                     MOVE 'D'       RECIRE                          182760
     C**********           Z-ADDSSCNUM    CNUM                                                CSD027
     C                     MOVE SSCNUM    CNUM                                                CSD027
     C                     MOVE SSCCY     CCY
     C                     Z-ADDSSACOD    ACOD
     C                     Z-ADDSSACSQ    ACSQ
     C                     MOVE SSSPTA    BRCA
     C                     Z-ADD0         FXDC
     C                     Z-ADD0         ACCEA
     C                     Z-ADD0         ACCC
     C                     Z-ADD0         GVDPE
     C                     Z-ADD0         GVDPC
     C                     Z-ADD0         ACCRA
     C                     MOVE *BLANK    MMACC
     C                     Z-ADD0         CACCC
     C                     Z-ADD0         CDIE
     C                     Z-ADD0         CDICA
     C                     Z-ADD0         CDRR
     C                     MOVE *BLANK    MMCDI
     C                     Z-ADD0         CCDIC
     C                     Z-ADD0         IACE
     C                     Z-ADD0         IACCC
     C                     Z-ADD0         CIACC
     C                     Z-ADD0         CMBE
     C                     Z-ADD0         CMBC
     C                     Z-ADD0         ACCB
     C                     Z-ADD0         CCMBC
     C                     Z-ADD0         CHDBE
     C                     Z-ADD0         CHDBC
     C                     Z-ADD0         HDRB
     C                     Z-ADD0         CHDBR
     C                     MOVE *BLANK    MMCHDB
     C                     Z-ADD0         CCHDBC
     C                     MOVE *BLANK    CACDC
     C                     Z-ADD0         CCINST
     C                     Z-ADD0         TEGRT
     C                     Z-ADD0         VATAM
     C**
     C** EVEN IF NO COMMISSION PRESENT FIELDS MUST BE UPDATED
     C** WITH 'E' FOR 'EXEMPT
     C**
     C           SSCEXA    IFEQ *BLANKS
     C                     MOVE *BLANK    CEXA
     C                     Z-ADD0         CHDBE
     C                     Z-ADD0         CHDBC
     C                     Z-ADD0         HDRB
     C                     Z-ADD0         CHDBR
     C                     Z-ADD0         CCHDBC
     C                     ELSE
     C                     MOVE SSCEXA    CEXA
     C                     END
     C           SSCEXB    IFEQ *BLANKS
     C                     MOVE *BLANK    CEXB
     C                     Z-ADD0         ACCEA
     C                     Z-ADD0         ACCC
     C                     Z-ADD0         GVDPE
     C                     Z-ADD0         GVDPC
     C                     Z-ADD0         ACCRA
     C                     Z-ADD0         CACCC
     C                     ELSE
     C                     MOVE SSCEXB    CEXB
     C                     END
     C           SSCEXC    IFEQ *BLANKS
     C                     MOVE *BLANK    CEXC
     C                     Z-ADD0         CDIE
     C                     Z-ADD0         CDICA
     C                     Z-ADD0         CDRR
     C                     Z-ADD0         CCDIC
     C                     ELSE
     C                     MOVE SSCEXC    CEXC
     C                     END
     C           SSCEXD    IFEQ *BLANKS
     C                     MOVE *BLANK    CEXD
     C                     Z-ADD0         IACE
     C                     Z-ADD0         IACCC
     C                     Z-ADD0         CIACC
     C                     ELSE
     C                     MOVE SSCEXD    CEXD
     C                     END
     C           SSCEXE    IFEQ *BLANKS
     C                     MOVE *BLANK    CEXE
     C                     Z-ADD0         CMBE
     C                     Z-ADD0         CMBC
     C                     Z-ADD0         ACCB
     C                     Z-ADD0         CCMBC
     C                     ELSE
     C                     MOVE SSCEXE    CEXE
     C                     END
     C           SSCEXF    IFEQ *BLANKS
     C                     MOVE *BLANK    CEXF
     C                     Z-ADD0         CCINST
     C                     Z-ADD0         NOIS
     C                     Z-ADD0         NOCC
     C                     Z-ADD0         PESP
     C                     ELSE
     C                     MOVE SSCEXF    CEXF
     C                     END
     C           SSCEXG    IFEQ *BLANKS
     C                     MOVE *BLANK    CEXG
     C                     Z-ADD0         FXDC
     C                     ELSE
     C                     MOVE SSCEXG    CEXG
     C                     END
     C                     Z-ADDSSNOCC    NOCC
     C*                    Z-ADDSSNOCC    NOCC
     C                     Z-ADD0         PESP
     C                     WRITERECOMDF                89
     C*
     C           *IN89     IFEQ '1'                        - B4
     C                     MOVEL'RE71602' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     MOVE '1'       *IN80
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C** 6.3
     C*
     C           *IN80     IFEQ '0'                        - B3
     C                     MOVE 'D'       RDRECI
     C                     MOVE SSCNUM    RDPNP8
     C                     MOVE SSCCY     RDACCY
     C                     Z-ADDSSACOD    RDACOD
     C                     Z-ADDSSACSQ    RDASEQ
     C                     MOVELSSSPTA    RDSPTA
     C                     MOVE *BLANKS   RDZ011
     C                     MOVE *BLANKS   RDZ022
     C                     Z-ADD0         RDMNBL
     C                     Z-ADDNATN      RDTNLU
     C                     Z-ADDBJRDNB    RDORED
     C                     Z-ADDBJRDNB    RDLCD
     C                     MOVE 'I'       RDCHTP
     C                     Z-ADD0         RDDAIC
     C                     Z-ADD0         RDMADI
     C                     Z-ADD0         RDGADI
     C                     Z-ADD0         RDCAIC
     C                     Z-ADD0         RDMACI
     C                     Z-ADD0         RDGACI
     C                     Z-ADD0         RDHISB
     C                     Z-ADD0         RDBFDR
     C                     Z-ADD0         RDBFCR
     C                     Z-ADD0         RDTDIN
     C                     Z-ADD0         RDTCIN
     C                     Z-ADD0         RDEGLI
     C                     MOVE *BLANK    RDPOST
     C                     WRITEREACRDF                89
     C*
     C           *IN89     IFEQ '1'                        - B4
     C                     MOVEL'RE71603' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     MOVE '1'       *IN80
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C** 6.4
     C*
     C           *IN80     IFEQ '0'                        - B3
     C           1         SETLLREACRZ
     C                     READ REACRZ                   89
     C*
     C           *IN89     IFEQ '0'                        - B4
     C                     ADD  1         RZNORE
     C                     Z-ADDNATN      RZTNLU
     C*
     C** 6.5
     C*
     C                     UPDATREACRZF
     C                     ELSE                            - X4
     C                     MOVEL'RE71604' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     MOVE '1'       *IN80
     C                     END                             - E4
     C                     END                             - E4
      *                                                                   CRE001
      ** If CRE001 is installed and Account is Retail                     CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C           ATYP      ANDEQ'R'                        B.2            CRE001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           ATYP      ANDEQ'R'                                       CDE002
      *                                                                   CRE001
      ** Access Account Master Extension                                  CRE001
     C           ACNTBX    CHAINACCNTBXC             80                   CRE001
      *                                                                   CRE001
     C           *IN80     IFEQ *ON                        B..3           CRE001
     C           *LOCK     IN   LDA                                       CRE001
     C                     Z-ADD27        DBASE            ***************CRE001
     C                     MOVEL'ACCNTBXC'DBFILE           **DB ERROR 27**CRE001
     C                     MOVEL#CNUM     DBKEY            ***************CRE001
     C                     OUT  LDA                                       CRE001
     C                     EXSR *PSSR                                     CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** Move formatted work fields to file fields                        CRE001
     C                     Z-ADDSSAODR    ATAODR                          CRE001
     C                     Z-ADDSSORTC    ATORTC                          CRE001
     C                     Z-ADDSSOLVD    ATOLVD                          CRE001
     C                     Z-ADDSSITRD    ATITRD                          CRE001
     C                     Z-ADD*ZERO     ATPOLE                          CRE001
     C                     Z-ADDSSACNO    ATACNO                          CDE002
      *                                                                   CRE001
      ** If Overdraft Line Change Value Date < or = Run Date              CRE001
     C           SSOLVD    IFLE BJRDNB                     B..3           CRE001
     C                     Z-ADDSSOLVD    ATPOLC                          CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** If CDE002 is present update Cr/Dr Margin fields                  CDE002
      *                                                                   CDE002
     C           CDE002    IFEQ 'Y'                        B..3           CDE002
     C                     MOVE SOVRD     ATOVRD                          CDE002
     C                     MOVE SOVRC     ATOVRC                          CDE002
     C                     Z-ADDSSDRMG    ATDRMG                          CDE002
     C                     Z-ADDSSCRMG    ATCRMG                          CDE002
     C                     MOVE SSDMBR    ATDMBR                          208221
     C                     MOVE SSCMBR    ATCMBR                          208221
      *                                                                   CDE002
      ** If Debit Margin Override is 'Y' Change Date is rundate           CDE002
      *                                                                   CDE002
     C           SOVRD     IFEQ 'Y'                        B..4           CDE002
     C                     Z-ADDBJRDNB    ATDRMD                          CDE002
     C                     ELSE                            X..4           CDE002
     C                     Z-ADD*ZEROS    ATDRMD                          CDE002
     C                     ENDIF                           E..4           CDE002
      *                                                                   CDE002
      ** If Credit Margin Override is 'Y' Change Date is rundate          CDE002
      *                                                                   CDE002
     C           SOVRC     IFEQ 'Y'                        B..4           CDE002
     C                     Z-ADDBJRDNB    ATCRMD                          CDE002
     C                     ELSE                            X..4           CDE002
     C                     Z-ADD*ZEROS    ATCRMD                          CDE002
     C                     ENDIF                           E..4           CDE002
      *                                                                   CDE002
     C                     ENDIF                           E..3           CDE002
      *                                                                   CDE002
     C                     UPDATACCNTBD0               89                 CRE001
      *                                                                   CRE001
      ** If Overdraft present (Expiry Date entered)                       CRE001
     C           SSODED    IFNE *ZERO                      B.2            CRE001
     C                     CLEARREODHSD0                                  CRE001
     C                     MOVE WWBRCA    BRCA                            CRE001
     C**********           Z-ADDWWCNUM    CNUM                                         CRE001 CSD027
     C                     MOVE WWCNUM    CNUM                                                CSD027
     C                     MOVE WWCCY     CCY                             CRE001
     C                     Z-ADDWWACOD    ACOD                            CRE001
     C                     Z-ADDWWACSQ    ACSQ                            CRE001
     C                     MOVE SSACNO    ACNO                            CRE001
     C                     Z-ADDSSOLVD    HISD                            CRE001
     C                     Z-ADDSSODLN    ODLN                            CRE001
     C                     Z-ADDSSODED    ODED                            CRE001
     C*                                                                   CRE001
     C                     WRITEREODHSD0               89                 CRE001
     C*                                                                   CRE001
     C           *IN89     IFEQ '1'                        B..3           CRE001
     C                     MOVEL'RE72050' ZAMSID                          CRE001
     C                     EXSR ZASNMS                                    CRE001
     C                     MOVE '1'       ERR              ERROR INDIC.   CRE001
     C                     MOVE '1'       *IN80                           CRE001
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
     C                     ENDIF                           E.2            CRE001
     C*
     C** 6.7
     C*
     C           *IN80     IFEQ '0'                        - B4
     C                     MOVE 'B'       BRECI
     C                     MOVE *BLANK    BZZ001
     C                     MOVE SSSPTA    BBRCA
     C**********           Z-ADDSSCNUM    BCNUM                                               CSD027
     C                     MOVE SSCNUM    BCNUM                                               CSD027
     C                     MOVE SSCCY     BCCY
     C                     Z-ADDSSACOD    BACOD
     C                     Z-ADDSSACSQ    BACSQ
     C                     Z-ADDSSDACO    BHISD
     C                     Z-ADD0         BHISB
     C                     Z-ADD0         BMNBL
     C                     Z-ADD0         BCHGAR
     C                     Z-ADD0         BTCHGR
     C                     Z-ADD0         BCHGAN
     C                     Z-ADD0         BTCHGN
     C                     Z-ADD0         BDMVT
     C                     Z-ADD0         BDICT
     C                     Z-ADDSSDRIC    BDRCB
     C                     Z-ADD0         BDRIR
     C                     Z-ADDSSDRCD    BDRCD
     C                     Z-ADD0         BDAID
     C                     Z-ADD0         BMADI
     C                     Z-ADD0         BTMADI
     C                     Z-ADDSSDACO    BPDID
     C                     Z-ADD0         BDMINT
     C                     Z-ADD0         BCMVT
     C                     Z-ADD0         BCICT
     C                     Z-ADDSSCRIC    BCRCB
     C                     Z-ADD0         BCRIR
     C                     Z-ADD0         BCAID
     C                     Z-ADD0         BMACI
     C                     Z-ADD0         BTMACI
     C                     Z-ADDSSDACO    BPCID
     C                     Z-ADD0         BCMINT
     C                     MOVE *BLANK    BDICI
     C                     MOVE *BLANK    BCICI
     C                     MOVE *BLANK    BDRCI
     C                     MOVE *BLANK    BCRCI
     C                     Z-ADDSSDACO    BVDTC
     C                     MOVE *BLANK    BADTY
     C                     MOVEL*BLANK    BALTI
     C                     Z-ADD0         BMNBCP
     C*                    MOVE SSLGID    BLGID
     C                     Z-ADD0         BVALL
     C                     MOVE *BLANK    BLINK
     C                     MOVE *BLANK    BZ008
     C                     WRITEREHISPPF               89
     C*
     C           *IN89     IFEQ '1'                        - B5
     C                     MOVEL'RE71605' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     MOVE '1'       *IN80
     C                     END                             - E5
     C*
     C                     END                             - E4
     C                     END                             - E3
     C*                                                                   CRT001
     C****If*Password*on*Retail*Savings*Account*(CRT101)***************                CRT001 CSD101
     C****is*installed,*write*password*to*file*************************                CRT001 CSD101
     C*                                                                   CRT001
     C/COPY WNCPYSRC,GL3271C096
     C********** CRT101    IFEQ 'Y'                                                    CRT001 CSD101
     C********** CRT001    ANDEQ'Y'                                                    107478 CSD101
     C***********ATYP      ANDEQ'R'                                CRT001 107478
     C***********STYP      ANDEQ'S'                                CRT001 107478
     C/COPY WNCPYSRC,GL3271C084
     C********** SWATYP    ANDEQ'R'                                                    107478 CSD101
     C********** SWSTYP    ANDEQ'S'                                                    107478 CSD101
     C/COPY WNCPYSRC,GL3271C085
     C*                                                                   CRT001
     C**********           Z-ADDSSCNUM    CNUM                                         CRT001 CSD027
     C**********           MOVE SSCNUM    CNUM                                         CSD027 CSD101
     C**********           MOVE SSCCY     CCY                                          CRT001 CSD101
     C**********           Z-ADDSSACOD    ACOD                                         CRT001 CSD101
     C**********           Z-ADDSSACSQ    ACSQ                                         CRT001 CSD101
     C**********           MOVE SSSPTA    BRCA                                         CRT001 CSD101
     C*                                                                   106784
     C********** *IN30     IFEQ '1'                        - B4                        106784 CSD101
     C**Move*screen*field*in*for*Insert*mode*items.********************                106784 CSD101
     C**********           MOVE SPSWD     PSWD                                         106784 CSD101
     C*                                                                   106784
     C**********           ELSE                                                        106784 CSD101
     C**********           MOVE SSPSWD    PSWD                                         CRT001 CSD101
     C**********           END                             - E4                        106784 CSD101
     C*                                                                   CRT001
     C**********           WRITEREAPWDD0               89                              CRT001 CSD101
     C*                                                                   CRT001
     C********** *IN89     IFEQ '1'                                                    CRT001 CSD101
     C**********           MOVEL'RE71605' ZAMSID                                       CRT001 CSD101
     C**********           EXSR ZASNMS                                                 CRT001 CSD101
     C**********           MOVE '1'       ERR              ERROR INDIC.                CRT001 CSD101
     C**********           MOVE '1'       *IN80                                        CRT001 CSD101
     C**********           END                                                         CRT001 CSD101
     C*                                                                   CRT001
     C**********           END                                                         CRT001 CSD101
     C/COPY WNCPYSRC,GL3271C097
     C*
     C           ERR       IFNE *BLANK                     - B2
     C                     ROLBK
     C                     ELSE                            - X2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP19                                           S01408
      *                                                                   CDE001
      * Data export for CCRM - Limits                                     CDE001
      *                                                                   CDE001
     C           CDE001    IFEQ 'Y'                                       CDE001
     C                     MOVELW#ACID    T#TREF                          CDE001
     C                     CALL 'DEWTTRIG'                                CDE001
     C**********           PARM           T#TREF 20                                    CDE001 CGL029
     C                     PARM           T#TREF 26                                           CGL029
     C                     PARM 'ACCT'    T#TCAT  4                       CDE001
     C                     PARM *BLANKS   T#RSRV 10                       CDE005
     C                     ENDIF                                          CDE001
     C*                                                                   S01408
     C                     COMIT
     C/COPY WNCPYSRC,GL3271C245
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01522
      *                                                                   S01408
CC   C/COPY WNCPYSRC,GL3271C123                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD                            S01522
     C                     PARM 'I'       ACTN                            S01522
     C                     PARM ACKEY     ACCD                            S01522
     C                     END                                            S01522
      *                                                                   CGL004
      ** If Midas-Fontis Interface is switched on, call program to        CGL004
      ** display Fontis account details.                                  CGL004
     C/COPY WNCPYSRC,GL3271C214
      *                                                                   CGL004
     C           *IN29     IFEQ '1'                                       CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     CALL 'GLC2800'                                 CGL004
     C                     PARM *BLANK    RTCD                            CGL004
     C                     PARM ACKEY     ACCD                            CGL004
     C                     PARM 'I'       ACTN                            CGL004
     C                     ENDIF                                          CGL004
     C                     ENDIF                                          CGL004
     C/COPY WNCPYSRC,GL3271C215
      *                                                                   CGL004
     C                     EXSR #P1005
     C                     EXSR #P1006
     C                     END                             - E2
     C/COPY WNCPYSRC,GL3271C036
     C                     MOVEL'FK'      WWDSPY
     C                     EXSR #DIR
     C/COPY WNCPYSRC,GL3271C037
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1003   - UPDATE PROCESSING                                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZTNLU1   - TO RETRIEVE THE NEXT TRANSACTION NUMBER               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWRTRN   - START DISPLAY CODE                                    *
      *                                                                  *
      ********************************************************************
     C           #P1003    BEGSR
     C**
     C/COPY WNCPYSRC,GL3271CP72                                           S01408
     C*
     C** 1.
     C*
     C           WWACKB    CHAINACCBR                8182
     C                     MOVE '1'       *IN80
     C           TNLU      IFNE ACTNLU
     C                     MOVEL'RE71810' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     ROLBK
     C                     END
     C           *IN82     IFEQ '1'                        - B1
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     ROLBK
     C                     END                             - E1
     C*
     C           *IN81     IFEQ '0'
     C           *IN29     ANDEQ'1'
     C           *INU1     ANDEQ'1'                                       083651
     C           ERR       ANDEQ*BLANK
     C           WWACKY    CHAINREIACDF              8082
     C*
     C           TNLU      IFNE RETNLU
     C                     MOVEL'RE71810' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'E'       ERR
     C                     ROLBK
     C                     END
     C           *IN82     IFEQ '1'                        - B1
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     ROLBK
     C                     END                             - E1
     C                     END
     C           *IN80     IFEQ '0'
     C           *IN34     ANDEQ'1'
     C           *INU1     ANDEQ'1'                                       083651
     C           ERR       ANDEQ*BLANK
     C           WWACKB    CHAINRECOM                8082
     C           *IN82     IFEQ '1'                        - B1
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     ROLBK
     C                     END                             - E1
     C                     END
     C*
     C           *IN80     IFEQ '0'
     C           *INU1     ANDEQ'1'                                       083651
     C           ERR       ANDEQ*BLANK
     C           WWACKY    CHAINREACRDF              8082
     C           *IN82     IFEQ '1'                        - B1
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     ROLBK
     C                     END                             - E1
     C                     END
     C*
     C           *IN80     IFEQ '0'
     C           *INU1     ANDEQ'1'                                       083651
     C           ERR       ANDEQ*BLANK
     C           RELINK    CHAINREHISBL              8082
     C           *IN82     IFEQ '1'                        - B1
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     ROLBK
     C                     END                             - E1
     C                     END
     C*
     C** 2.
     C*
     C           ERR       IFEQ *BLANK
     C                     EXSR ZTNLU1
     C*
     C** 5.
     C*
     C           *IN81     IFEQ '0'
     C                     MOVE SSMFFQ    MFFQ
     C                     MOVE SSANAM    ANAM
     C                     MOVE SSSTFQ    STFQ
     C                     Z-ADDSSECFB    ECFB
     C*
     C*  - IF CHANGE OF FREQUENCY WITH NEW FREQUENCY 'E':
     C*    EXTRA CARRIED FORWARD BALANCE EQUAL TO LEDGER BALANCE
     C*
     C           SWSTFQ    IFNE *BLANK
     C           SWSTFQ    IFNE 'E'
     C           SSSTFQ    ANDEQ'E'
     C/COPY WNCPYSRC,GLH00821
     C                     Z-ADDLDBL      ECFB
     C                     END
     C                     END
     C                     Z-ADDSSNSTD    NSTD
     C                     Z-ADDSSSTDY    STDY
     C                     MOVE SSGLBT    GLBT
     C                     MOVELSSREF     ADREF1
     C                     MOVE SSREF     ADREF2
     C                     MOVE SSRETB    RETB
     C                     MOVELSSPRFC    PRFC
     C                     MOVE SSODSC    ODSC
     C                     Z-ADDSSODLN    ODLN
     C                     Z-ADDSSODED    ODED
     C                     Z-ADDSSDLIM    DLIM                            104313
     C                     Z-ADDSSFACT    FACT
     C                     Z-ADDSSFCNO    FCNO
     C                     Z-ADDSSEFAC    EFAC
     C                     Z-ADDSSMDTN    MINB
     C                     Z-ADDSSDRIB    DRIB
     C                     Z-ADDSSDRIS    DRIS
     C                     Z-ADDSSDRIC    DRIC
     C                     Z-ADDSSDRCD    OLDR
     C                     MOVE SSDRIF    DRIF
     C                     Z-ADDSSDRDY    DRDY
     C                     Z-ADDSSNDID    NDID
     C                     Z-ADDSSCRIB    CRIB
     C                     Z-ADDSSCRIS    CRIS
     C                     Z-ADDSSCRIC    CRIC
     C                     Z-ADDSSDR9     OLCR
     C                     MOVE SSCRIF    CRIF
     C                     Z-ADDSSCRDY    CRDY
     C                     Z-ADDSSNCID    NCID
     C                     MOVELSSBRTC    BRTCA
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           *IN27     ANDEQ*ON                                       CEU013
     C                     MOVE SEUSB     EUSB                            CEU013
     C                     ENDIF                                          CEU013
     C*
     C** SAVE PREVIOUS CHANGE
     C*
     C                     Z-ADDLCD       WWLCD   50
     C                     Z-ADDBJRDNB    LCD
     C*
     C** IF AMEND OVER INSERT THE SAME DAY KEEP AS INSERT TODAY.
     C*
     C           WWLCD     IFEQ BJRDNB
     C           CHTP      ANDEQ'I'
     C                     ELSE
     C                     MOVE 'A'       CHTP
     C                     END
     C                     Z-ADDNATN      TNLU
     C                     Z-ADDSSENOC    ENOC
     C                     MOVE SSPRFC    PRFC
     C                     MOVE SSPTFR    PTFR                            S01486
      *                                                                   CTI001
      ** If Midas/Trade Innovation Interface is on then                   CTI001
      ** update the TI fields                                             CTI001
      *                                                                   CTI001
     C           *IN87     IFEQ *ON                                       CTI001
     C                     MOVE SSTIAC    A5TIAC                          CTI001
     C                     MOVE SSTIAN    A5TIAN                          CTI001
     C                     MOVE SSTIAS    A5TIAS                          CTI001
     C                     MOVE '1'       *IN89                           160463
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
      *** IBAN field                                                      CFT004
      *                                                                   CFT004
     C                     MOVELSIBAN     IBAN                            CFT004
     C                     MOVELSIBSQ     IBSEQN                          CFT004
      *                                                                   CFT004
     C/COPY WNCPYSRC,GL3271C133
     C                     UPDATACCNTABF               80
     C*
     C           *IN80     IFEQ '1'
     C                     MOVEL'RE71600' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     MOVE '1'       *IN80
     C/COPY WNCPYSRC,GL3271C038
     C                     END
     C/COPY WNCPYSRC,GL3271C256
      *                                                                   CRE001
      ** If CRE001 is installed and Retail Account                        CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C           ATYP      ANDEQ'R'                        B.2            CRE001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           ATYP      ANDEQ'R'                                       CDE002
      *                                                                   CRE001
      ** Access Account Master 'Core' Extension                           CRE001
     C           ACNTBX    CHAINACCNTBXC             80                   CRE001
      *                                                                   CRE001
     C           *IN80     IFEQ *ON                        B..3           CRE001
     C           *LOCK     IN   LDA                                       CRE001
     C                     Z-ADD28        DBASE            ***************CRE001
     C                     MOVEL'ACCNTBXC'DBFILE           **DB ERROR 28**CRE001
     C                     MOVEL#CNUM     DBKEY            ***************CRE001
     C                     OUT  LDA                                       CRE001
     C                     EXSR *PSSR                                     CRE001
     C                     END                             E..3           CRE001
      *                                                                   CRE001
      ** Move screen work fields to file fields                           CRE001
     C                     Z-ADDSSAODR    ATAODR                          CRE001
     C                     Z-ADDSSORTC    ATORTC                          CRE001
     C                     Z-ADDSSOLVD    ATOLVD                          CRE001
     C                     Z-ADDSSITRD    ATITRD                          CRE001
     C                     Z-ADDSSACNO    ATACNO                          CDE002
      *                                                                   CRE001
      ** If Overdraft Line Change Value Date < OR = Run Date              CRE001
     C           SSOLVD    IFLE BJRDNB                     B..3           CRE001
     C           SSOLVD    ANDNE0                                         CRE001
     C                     Z-ADDSSOLVD    ATPOLC                          CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** If Overdraft Expiry Date has changed                             CRE001
     C           SSODED    IFNE SWODED                     B..3           CRE001
     C                     Z-ADDSWODED    ATPOLE                          CRE001
     C                     ENDIF                           E..3           CRE001
      *                                                                   CRE001
      ** If CDE002 is present update Cr/Dr Margin fields                  CDE002
      *                                                                   CDE002
     C           CDE002    IFEQ 'Y'                        B..3           CDE002
      *                                                                   CDE002
      ** If Debit Margin Override or Debit Margin have changed            CDE002
      *                                                                   CDE002
     C           ATOVRD    IFNE SOVRD                                     CDE002
     C           ATDRMG    ORNE SSDRMG                     B..4           CDE002
     C           ATDMBR    ORNE SSDMBR                                    208221
     C                     Z-ADDBJRDNB    ATDRMD                          CDE002
     C                     ENDIF                           E..4           CDE002
      *                                                                   CDE002
      ** If Credit Margin Override or Credit Margin have changed          CDE002
      *                                                                   CDE002
     C           ATOVRC    IFNE SOVRC                                     CDE002
     C           ATCRMG    ORNE SSCRMG                     B..4           CDE002
     C           ATCMBR    ORNE SSCMBR                                    208221
     C                     Z-ADDBJRDNB    ATCRMD                          CDE002
     C                     ENDIF                           E..4           CDE002
      *                                                                   CDE002
     C                     MOVE SOVRD     ATOVRD                          CDE002
     C                     MOVE SOVRC     ATOVRC                          CDE002
     C                     Z-ADDSSDRMG    ATDRMG                          CDE002
     C                     Z-ADDSSCRMG    ATCRMG                          CDE002
     C                     MOVE SSDMBR    ATDMBR                          208221
     C                     MOVE SSCMBR    ATCMBR                          208221
      *                                                                   CDE002
     C                     ENDIF                           E..3           CDE002
      *                                                                   CDE002
      ** Update Account Master 'Core' Extension                           CRE001
     C                     UPDATACCNTBD0                                  CRE001
      *                                                                   CRE001
      ** If Overdraft Line OR Overdraft Expiry Date has changed           CRE001
     C           SSODLN    IFNE SWODLN                     B..3           CRE001
     C           SSODED    ORNE SWODED                     O..3           CRE001
      *                                                                   CRE001
      ** Access Retail Overdraft History file for the Account,            CRE001
      **   History Date = Overdraft Line This Change Value Date           CRE001
     C                     Z-ADDSSOLVD    WWHISD                          CRE001
     C           REODHS    CHAINREODHSL0             80                   CRE001
      *                                                                   CRE001
      ** Write new record                                                 CRE001
     C           *IN80     IFEQ *ON                        B...4          CRE001
     C                     CLEARREODHSD0                                  CRE001
     C                     MOVE WWBRCA    BRCA                            CRE001
     C**********           Z-ADDWWCNUM    CNUM                                         CRE001 CSD027
     C                     MOVE WWCNUM    CNUM                                                CSD027
     C                     MOVE WWCCY     CCY                             CRE001
     C                     Z-ADDWWACOD    ACOD                            CRE001
     C                     Z-ADDWWACSQ    ACSQ                            CRE001
     C                     MOVE SSACNO    ACNO                            CRE001
     C                     Z-ADDSSOLVD    HISD                            CRE001
     C                     Z-ADDSSODLN    ODLN                            CRE001
     C                     Z-ADDSSODED    ODED                            CRE001
      *                                                                   CRE001
     C                     WRITEREODHSD0                                  CRE001
      *                                                                   CRE001
     C                     ELSE                            X...4          CRE001
      *                                                                   CRE001
     C                     Z-ADDSWODLN    PODL                            CRE001
     C                     Z-ADDSWODED    POLE                            CRE001
     C                     Z-ADDSSODLN    ODLN                            CRE001
     C                     Z-ADDSSODED    ODED                            CRE001
      *                                                                   CRE001
     C                     UPDATREODHSD0                                  CRE001
      *                                                                   CRE001
     C                     ENDIF                           E...4          CRE001
     C                     ENDIF                           E..3           CRE001
     C                     ENDIF                           E.2            CRE001
     C/COPY WNCPYSRC,GL3271C203
      *                                                                   CRE001
     C*
     C** IF CALCULATION BASIS CHANGED UPDATE RETAIL HISTORY
     C*
     C           *IN29     IFEQ '1'                        - B1
     C           *IN80     ANDEQ'0'
     C           *INU1     ANDEQ'1'                                       083651
     C*
     C           SWDRIC    IFNE SSDRIC                     - B2
     C*
     C** CHECK IF THERE IS A CAPITALISATION
     C*
     C           LDID      IFEQ DACO                       - B3
      *
     C           RELINK    CHAINREHISBL              8182
     C           *IN82     IFEQ '1'                        - B4
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     END                             - E4
     C*
     C** UPDATE B RECORD
     C*
     C  N82                DO
     C                     Z-ADDSSDRIC    BDRCB
     C                     MOVE 'Y'       BADTY
     C                     Z-ADDBHISD     BVDTC
     C                     UPDATREHISPPF
     C                     END
     C*
     C                     ELSE                            - X3
     C*
     C** ACCESS LAST CAPITALISATION S RECORD
     C*
     C                     Z-ADDLDID      WWDATE
     C           BMLDAI    IFNE 'Y'                                       048251
     C                     ADD  1         WWDATE                          048251
     C                     END                                            048251
     C*
     C           RESKEY    CHAINREHISLS              8182
     C           *IN82     IFEQ '1'                        - B4
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     END                             - E4
     C*
     C           *IN81     IFEQ '1'                        - B4
     C                     MOVEL'RE71605' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     END                             - E4
     C*
     C                     Z-ADDSSDRIC    PDRCB
     C                     UPDATREHISPSF
     C*
     C** ACCESS B RECORD TO FORCE RECALCULATION OF INTEREST SINCE LAST
     C** CAPITALISATION
     C*
     C                     MOVE 'Y'       BADTY
     C           BVDTC     IFGT PHISD                      - B4
     C                     Z-ADDPHISD     BVDTC
     C                     END                             - E4
     C                     UPDATREHISPPF
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C           SWCRIC    IFNE SSCRIC                     - B2
     C*
     C** CHECK IF THERE IS A CAPITALISATION
     C*
     C           LCID      IFEQ DACO                       - B3
     C*
     C** UPDATE B RECORD
     C*
      *
     C           RELINK    CHAINREHISBL              8182
     C           *IN82     IFEQ '1'                        - B4
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     END                             - E4
      *
     C           *IN82     IFEQ '0'                        - B4
     C                     Z-ADDSSCRIC    BCRCB
     C                     MOVE 'Y'       BADTY
     C                     Z-ADDBHISD     BVDTC
     C                     UPDATREHISPPF
     C                     END                             - E4
     C*
     C                     ELSE                            - X3
     C*
     C** ACCESS LAST CAPITALISATION S RECORD
     C*
     C                     Z-ADDLCID      WWDATE
     C           BMLDAI    IFNE 'Y'                                       048251
     C                     ADD  1         WWDATE                          048251
     C                     END                                            048251
     C*
     C           RESKEY    CHAINREHISLS              8182
     C           *IN82     IFEQ '1'                        - B4
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     END                             - E4
     C*
     C           *IN81     IFEQ '1'                        - B4
     C                     MOVEL'RE71605' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     END                             - E4
     C*
     C                     Z-ADDSSCRIC    PCRCB
     C                     UPDATREHISPSF
     C*
     C** ACCESS B RECORD TO FORCE RECALCULATION OF INTEREST SINCE LAST
     C** CAPITALISATION
     C*
     C           RELINK    CHAINREHISBL              8182
     C           *IN82     IFEQ '1'                        - B4
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     END                             - E4
     C*
     C                     MOVE 'Y'       BADTY
     C           BVDTC     IFGT PHISD                      - B4
     C                     Z-ADDPHISD     BVDTC
     C                     END                             - E4
     C                     UPDATREHISPPF
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     END
     C*
     C** 6.
     C*
     C           *IN80     IFEQ '0'
     C           *IN29     ANDEQ'1'
     C           *INU1     ANDEQ'1'                                       083651
     C*
     C** 6.0
     C*
     C                     Z-ADDSSDICT    DICT
     C                     Z-ADDSSDCST    DCST
     C                     MOVE SSDACP    DACP
     C                     Z-ADDSSCICT    CICT
     C                     Z-ADDSSAMAL    CCST
     C                     MOVE SSCACP    CACP
     C                     MOVE *BLANK    CICP
     C                     Z-ADDSSCHGT    CHGT
     C                     Z-ADDSSMRT3    CHST
     C                     MOVE SSCHCP    CHAC
     C                     MOVE SSPTRA    PTRA
     C                     MOVE SSPRCH    PRCH
     C*                                                                   CRT001
     C**  If Retail Teller System (CRT001) SAR is installed               CRT001
     C**  or Retail Branch Access (CRT002) SAR is installed               CRT002
     C*                                                                   CRT001
     C           CRT001    IFEQ 'Y'                                       CRT001
     C           CRT002    OREQ 'Y'                                       CRT002
     C                     MOVE SSPBKU    PBKU                            CRT001
     C                     END                                            CRT001
     C*                                                                   CRT001
     C*                    Z-ADDSSTCHO    TCHO
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE STCHO     ZFIELD
     C                     MOVE SSDRBR    DRBR
     C                     MOVE SSCRBR    CRBR
     C                     MOVE SSCHBR    CHBR
     C                     Z-ADDWWDECS    ZADEC
     C           7         SUB  WWDECS    ZADIG
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    TCHO
     C*                    MOVE TCHO      TCHO
     C                     UPDATREIACDF                80
     C*
     C           *IN80     IFEQ '1'
     C                     MOVEL'RE71601' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     END
     C*
     C** UPDATE OF ALTERNATE ACCOUNTS
     C           SSDACP    IFNE *BLANKS
     C           SSDACP    IFNE SWDACP
     C           SSDRBR    ORNE SWDRBR
     C                     MOVELWWDACP    ACKEYK
      * If alternate is a retail increment number of alternate.
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     ADD  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ 1
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE 'Y'       BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END                             - E1
     C                     END
     C                     END
      * If previous alternate is a retail decrement number of alternate.
     C           WWDAC2    IFNE *BLANKS
     C           SSDACP    IFNE SWDACP
     C           SSDRBR    ORNE SWDRBR
     C                     MOVELWWDAC2    ACKEYK
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     SUB  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ *ZEROS
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE *BLANKS   BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END                             - E1
     C                     END
     C                     END                             - E1
     C*
     C           SSCACP    IFNE *BLANKS
     C           SSCACP    IFNE SWCACP
     C           SSCRBR    ORNE SWCRBR
     C                     MOVELWWCACP    ACKEYK
      * If alternate is a retail increment number of alternate.
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     ADD  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ 1
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE 'Y'       BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END                             - E1
     C                     END
     C                     END
      * If previous alternate is a retail decrement number of alternate.
     C*
     C           WWCAC2    IFNE *BLANKS
     C           SSCACP    IFNE SWCACP
     C           SSCRBR    ORNE SWCRBR
     C                     MOVELWWCAC2    ACKEYK
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     SUB  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ *ZEROS
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE *BLANKS   BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END                             - E1
     C                     END
     C                     END                             - E1
     C*
     C           SSCHCP    IFNE *BLANKS
     C           SSCHCP    IFNE SWCHCP
     C           SSCHBR    ORNE SWCHBR
     C                     MOVELWWCHCP    ACKEYK
      * If alternate is a retail increment number of alternate.
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     ADD  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ 1
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE 'Y'       BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C                     END                             - E1
     C                     END
     C                     END
      * If previous alternate is a retail decrement number of alternate.
     C           WWCHC2    IFNE *BLANKS
     C           SSCHCP    IFNE SWCHCP
     C           SSCHBR    ORNE SWCHBR
     C                     MOVELWWCHC2    ACKEYK
     C           WWACK2    CHAINREIACDF              50
     C           *IN50     IFEQ '0'
     C                     SUB  1         NOALT
     C                     UPDATREIACDF
     C*
     C** UPDATE ALTI ON B RECORD
     C*
     C           NOALT     IFEQ *ZEROS
     C           REHIS     CHAINREHISBL              50
     C           *IN50     IFEQ '0'
     C                     MOVE *BLANKS   BALTI
     C                     UPDATREHISPPF
     C                     END
     C                     END
     C*
     C                     END                             - E1
     C                     END
     C                     END                             - E1
     C*
     C** 6.1
     C*
     C           *IN80     IFEQ '0'
     C           *IN34     ANDEQ'1'
     C**
     C           SSCEXA    IFEQ 'E'
     C                     Z-ADD0         CHDBE
     C                     Z-ADD0         CHDBC
     C                     Z-ADD0         HDRB
     C                     Z-ADD0         CHDBR
     C                     Z-ADD0         CCHDBC
     C                     END
     C           SSCEXB    IFEQ 'E'
     C                     Z-ADD0         ACCEA
     C                     Z-ADD0         ACCC
     C                     Z-ADD0         GVDPE
     C                     Z-ADD0         GVDPC
     C                     Z-ADD0         ACCRA
     C                     Z-ADD0         CACCC
     C                     END
     C           SSCEXC    IFEQ 'E'
     C                     Z-ADD0         CDIE
     C                     Z-ADD0         CDICA
     C                     Z-ADD0         CDRR
     C                     Z-ADD0         CCDIC
     C                     END
     C           SSCEXD    IFEQ 'E'
     C                     Z-ADD0         IACE
     C                     Z-ADD0         IACCC
     C                     Z-ADD0         CIACC
     C                     END
     C           SSCEXE    IFEQ 'E'
     C                     Z-ADD0         CMBE
     C                     Z-ADD0         CMBC
     C                     Z-ADD0         ACCB
     C                     Z-ADD0         CCMBC
     C                     END
     C           SSCEXF    IFEQ 'E'
     C                     Z-ADD0         CCINST
     C                     Z-ADD0         NOIS
     C                     Z-ADD0         NOCC
     C                     Z-ADD0         PESP
     C                     END
     C           SSCEXG    IFEQ 'E'
     C                     Z-ADD0         FXDC
     C                     END
     C                     MOVE SSCEXA    CEXA
     C                     MOVE SSCEXB    CEXB
     C                     MOVE SSCEXC    CEXC
     C                     MOVE SSCEXD    CEXD
     C                     MOVE SSCEXE    CEXE
     C                     MOVE SSCEXF    CEXF
     C                     MOVE SSCEXG    CEXG
     C                     Z-ADDSSNOCC    NOCC
     C**********           Z-ADDSSCNUM    CNUM                                                CSD027
     C                     MOVE SSCNUM    CNUM                                                CSD027
     C                     MOVE SSCCY     CCY
     C                     Z-ADDSSACOD    ACOD
     C                     Z-ADDSSACSQ    ACSQ
     C                     MOVE SSSPTA    BRCA
     C                     UPDATRECOMDF                80
     C*
     C           *IN80     IFEQ '1'
     C                     MOVEL'RE71602' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       ERR              ERROR INDIC.
     C                     END
     C*
     C                     END
     C                     END
     C*
     C** 7.
     C*
     C           *IN80     IFEQ '0'
     C           ERR       ANDEQ*BLANK
     C           1         SETLLACCNTAC
     C**
     C                     READ ACCNTAC                  81
     C*
     C** INCREMENT COUNTER ONLY IF FIRST AMEND TODAY AND NOT INSERTED TODA
     C*
     C           WWLCD     IFNE BJRDNB
     C                     ADD  1         NOAM
     C                     END
     C                     Z-ADDBJRDNB    LCD
     C                     EXSR ZTNLU1
     C                     Z-ADDNATN      TNLU
     C                     UPDATACCNTCXF
     C                     END
     C*
     C           *IN29     IFEQ '1'                                       CRE001
     C                     EXSR #P1040
     C                     ENDIF                                          CRE001
     C*                                                                   CRT001
     C**  If Password on Retail Savings Account (CRT101) SAR is           CRT001
     C**  installed, update password on file                              CRT001
     C*                                                                   CRT001
     C/COPY WNCPYSRC,GL3271C098
     C********** CRT101    IFEQ 'Y'                        - B5                        CRT001 CSD101
     C********** CRT001    ANDEQ'Y'                                                    107478 CSD101
     C***********ATYP      ANDEQ'R'                                CRT001 107478
     C***********STYP      ANDEQ'S'                                CRT001 107478
     C/COPY WNCPYSRC,GL3271C086
     C********** SWATYP    ANDEQ'R'                                                    107478 CSD101
     C********** SWSTYP    ANDEQ'S'                                                    107478 CSD101
     C/COPY WNCPYSRC,GL3271C087
     C********** ERR       ANDEQ*BLANK                                                 CRT001 CSD101
     C*                                                                   CRT001
     C********** WWACKY    CHAINREAPWDL0             80                                CRT001 CSD101
     C********** *IN80     IFEQ '0'                        - B6                        CRT001 CSD101
     C**********           MOVE SSPSWD    PSWD                                         CRT001 CSD101
     C**********           UPDATREAPWDD0                                               CRT001 CSD101
     C**********           END                             - E6                        CRT001 CSD101
     C*                                                                   CRT001
     C**********           END                             - E5                        CRT001 CSD101
     C/COPY WNCPYSRC,GL3271C099
     C*
     C           ERR       IFNE *BLANK
     C                     ROLBK
     C                     ELSE
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP20                                           S01408
     C*                                                                   S01408
     C                     COMIT
     C           BGN1ST    IFEQ 'Y'                                       S01522
      *                                                                   S01522
     C/COPY WNCPYSRC,GL3271C124                                           S01408
      *                                                                   S01408
     C                     CALL 'CGC0025'                                 S01522
     C                     PARM *BLANKS   RTCD                            S01522
     C                     PARM 'A'       ACTN                            S01522
     C                     PARM ACKEY     ACCD                            S01522
     C                     END                                            S01522
      *                                                                   CGL004
      ** If Midas-Fontis Interface is switched on, call program to        CGL004
      ** display Fontis account details.                                  CGL004
     C/COPY WNCPYSRC,GL3271C216
      *                                                                   CGL004
     C           *IN29     IFEQ '1'                                       CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     CALL 'GLC2800'                                 CGL004
     C                     PARM *BLANK    RTCD                            CGL004
     C                     PARM ACKEY     ACCD                            CGL004
     C                     PARM 'A'       ACTN                            CGL004
     C                     ENDIF                                          CGL004
     C                     ENDIF                                          CGL004
     C/COPY WNCPYSRC,GL3271C217
      *                                                                   CGL004
     C                     END
     C                     END
     C/COPY WNCPYSRC,GL3271C039
     C                     MOVE WWRTRN    WFMT
     C/COPY WNCPYSRC,GL3271C040
     C*
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1004   - DELETE PROCESSING                                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZTNLU1   - TO RETRIEVE THE NEXT TRANSACTION NUMBER               *
      * #P1005   - SET WORK FIELDS TO BLANK                              *
      * #P1006   - SET SCREEN FIELDS TO BLANK                            *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10FK   - INSERT AND DELETE MODE                                *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPASS   - FLAG USED IN DELETE MODE                              *
      * WWACKY   - DATA STRUCTURE FOR MIDAS KEY                          *
      * WWACKB   - DATA STRUCTURE FOR MIDAS KEY                          *
      *                                                                  *
      ********************************************************************
     C           #P1004    BEGSR
     C**
     C/COPY WNCPYSRC,GL3271C178
     C                     MOVEL*BLANK    WWPASS
     C**
     C** CHAIN ON FILE TO LOCK RECORD
     C**
     C           WWACKB    CHAINACCBR                8082
     C**
     C           *IN80     IFEQ '1'
     C           ACST      OREQ 'C'
     C                     MOVEL'RE71010' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'F0'      WFMT
     C                     MOVE 'E'       ERR                             160552
     C                     ELSE
     C           *IN82     IFEQ '1'                        - B1
     C                     MOVEL'RE71805' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE 'E'       ERR
     C                     ROLBK
     C                     ELSE                            -
     C**
     C** SAVE LCD AND CHTP
     C**
     C                     MOVELCHTP      PCHTP   1
     C                     Z-ADDLCD       PLCD    50
     C**
     C                     MOVEL'C'       ACST
     C**
     C                     Z-ADDBJRDNB    LCD
     C                     Z-ADDBJRDNB    DACC
     C**
     C                     MOVEL'C'       CHTP
     C** FORCE NATN IN TNLU
     C                     EXSR ZTNLU1
     C**
     C                     Z-ADDNATN      TNLU
     C**
     C/COPY WNCPYSRC,GL3271C134
     C                     UPDATACCNTABF
     C**
     C                     END
     C**
     C                     END
     C**
     C           ERR       IFEQ *BLANK
     C**
     C** ACCESS ACCNTAC
     C**
     C           1         SETLLACCNTAC
     C**
     C                     READ ACCNTAC                  80
     C**
     C           *IN80     IFEQ '0'
     C           NOCL      ADD  1         NOCL
     C           NOAU      SUB  1         NOAU
     C**
     C           PLCD      IFEQ BJRDNB
     C           PCHTP     ANDEQ'I'
     C***********          SUB  1         NORE                            087222
     C                     ADD  1         NORE                            087222
     C                     SUB  1         NINU
     C                     END
     C**
     C           PLCD      IFEQ BJRDNB
     C           PCHTP     ANDEQ'A'
     C                     SUB  1         NOAM
     C                     END
     C** FORCE RUN DATE IN LCD
     C                     Z-ADDBJRDNB    LCD
     C                     Z-ADDNATN      TNLU
     C                     UPDATACCNTCXF
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP21                                           S01408
     C*                                                                   S01408
     C**
     C                     END
     C/COPY WNCPYSRC,GL3271C176
     C** COMMIT MODIFICATION ON FILE
     C                     COMIT
     C/COPY WNCPYSRC,GL3271C166
     C**
     C                     END
     C**
     C                     EXSR #P1005
     C                     EXSR #P1006
     C                     MOVEL'FK'      WFMT
     C                     MOVE '0'       *IN42
     C/COPY WNCPYSRC,GL3271C194
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1040   - TO UPDATE STRAN WITH RATE CHANGE                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - PROCESS VALIDATION OF 'F1' FORMAT                     *
      * #P1003   - PROCESS VALIDATION OF 'F4' FORMAT                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1040    BEGSR
     C*
     C***UPDAT*STRAN*FOR*RATE*CHANGE******************************                            CRE005
      *                                                                                       CRE005
      ** Processing now updates header file RERCHHPA only                                     CRE005
      ** Records now written to RERCH1PD, RERCH2PD, RERCH3PD                                  CRE005
      *                                                                                       CRE005
      ** Setup work field for number records written                                          CRE005
     C                     Z-ADD0         WNORS   20                                          CRE005
     C/COPY WNCPYSRC,GL3271C011
     C*
     C* OUTPUT ONLY IF NO FLAT RATE
     C*
     C           SDRIB     IFEQ *BLANK
     C           SDRIS     ANDEQ*BLANK
     C           SDSIG     ANDEQ*BLANK
     C           SDICT     IFNE SADICT                     - B1
     C           SDCST     ORNE SADCST
     C/COPY WNCPYSRC,GL3271C180
     C*
     C                     EXSR ZTNLU1
     C                     Z-ADDNATN      WWNATN  50
     C********** 1         CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD10        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 10 *                    CRE005
     C**********           MOVEL'1     '  DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C************************************************************                            CRE005
     C***UPDATE*HEADER*OF*STRAN***********************************                            CRE005
     C************************************************************                            CRE005
     C**********           MOVE ZZ199     STHEAD                                              CRE005
     C**********           Z-ADDTRNO      WWTRNO  50                                          CRE005
     C**********           ADD  3         TRNO                                                CRE005
     C**********           Z-ADDWWNATN    SATN                                                CRE005
     C**********           ADD  1         NORC                                                CRE005
     C**********           MOVE STHEAD    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C*
     C** ACCESS INTEREST TYPE/SUB TYPE ONLY IF NOT ZERO
     C*
     C/COPY WNCPYSRC,GL3271C181
     C                     Z-ADD*ZEROS    S1BRIS                          075510
     C           SSDICT    IFNE *ZERO
     C           SSDCST    ORNE *ZERO
     C                     MOVE SSDICT    TYPE
     C                     MOVE SSDCST    SBTYPE
     C                     MOVE SSCCY     CURR
     C                     MOVE 'D'       D
     C           KEY       CHAINREINT                80
     C           *IN80     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD11        DBASE            ***************
     C                     MOVEL'REINT   'DBFILE           * DB ERROR 11 *
     C                     MOVELKEY       DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             - E3
     C                     Z-ADDBRT       S1BRIS                          075510
     C                     END
     C*
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD12        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 12 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S1CNUM
     C                     MOVE SSCCY     S1CCY
     C                     MOVE SSACOD    S1ACOD
     C                     MOVE SSACSQ    S1ACSQ
     C                     MOVE '1'       S1ONE
     C                     MOVE 'X'       S1X
     C                     MOVE SSACNO    S1ACNO
     C                     Z-ADDBJRDNB    S1RUND
     C                     Z-ADDSSDRCD    S1WOLD
     C**********           MOVEL'9010 RAT'S1NARR                                              CRE005
     C**********           MOVE 'E CHANGE'S1NARR                                              CRE005
     C                     Z-ADD9010      S1TRAT                                              CRE005
     C                     MOVE 'RATE'    W1NARR  4                                           CRE005
     C                     MOVE 'CHANGE'  W2NARR  6                                           CRE005
     C           W1NARR    CAT  W2NARR:1  S1NARR                                              CRE005
     C                     Z-ADDSSDICT    S1INTT
     C                     Z-ADDSSDCST    S1INTS
     C                     MOVE '0'       S1DRCR
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSSAODR    S1AODR                          CRE001
     C           SSAODR    IFNE SWAODR                                    CRE001
     C***********SSAODR    ANDNE*ZEROS                            119479  134747
     C                     Z-ADDSSORTC    S1WOLD                          CRE001
     C                     ENDIF                                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     TIME           S1TIME
     C**********           MOVE 'GE/RC'   S1RECO                                              CRE005
     C                     MOVEL'GE/RC'   S1RECO                                              CRE005
     C                     MOVELSSSPTA    S1SPTA                          S01413
     C                     MOVE 'R'       S1ATYP
     C                     Z-ADD*ZEROS    S1RVLD
     C                     MOVE BITOFF    S1BITF
     C                     Z-ADDSWDRCD    S1OLDR
     C                     Z-ADD*ZEROS    S1INRT
     C*********************Z-ADD*ZEROS    S1BRIS                          075510
     C                     Z-ADD*ZEROS    S1WRIS
     C**********           Z-ADDBJRDNB    S1WRUN                                              CRE005
     C**********           Z-ADDWWTRNO    S1TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S1NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C**********           MOVE ST1RAT    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C                     MOVE 'R'       S1RECI                                              CRE005
     C                     WRITERERCH1D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C**********           ADD  1         WWTRNO                                              CRE005
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD13        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 13 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S2CNUM
     C                     MOVE SSCCY     S2CCY
     C                     MOVE SSACOD    S2ACOD
     C                     MOVE SSACSQ    S2ACSQ
     C                     MOVE '2'       S2TWO
     C                     MOVE 'X'       S2X
     C                     Z-ADDINTH      S2INTH
     C                     Z-ADDSSDRCD    S2WOLD
     C                     MOVE '0'       S2DRCR
     C                     TIME           S2TIME
     C                     MOVE SSSPTA    S2SPTA
     C                     MOVELBAL2      BAL1
     C                     MOVELBAL1      @BAL1                                               CRE005
     C                     MOVELRAT2      RAT1
     C                     MOVELRAT1      @RAT1                                               CRE005
     C**********           Z-ADDWWTRNO    S2TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S2NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C                     MOVE 'R'       S2RECI                                              CRE005
     C*
     C* INITIAL THRESHOLD, BALANCE AND RATE SPREAD SET TO ZERO IN
     C* STRAN RATE 2 IF DEBIT INTEREST TYPE IS BLANK
     C*
     C           SSDICT    IFEQ *ZERO
     C                     Z-ADD0         S2INTH
     C                     MOVELBAL0      BAL1
     C                     MOVELRAT0      RAT1
     C                     END
     C*
     C* ADD NEW BASE RATE WITH RATE SPREAD IN STRAN RATE 2 IF DEBIT
     C* INTEREST TYPE IS EQUAL TO 2
     C*
     C           SSDICT    IFGT 0
     C*
     C* USE NEW DEBIT BASE RATE
     C***********BANBRT    ADD  RAT1A     RAT1A                           077017
     C           WWDBRT    ADD  RAT1A     RAT1A
     C*
     C* Must now use balance not rate to determine when the end of the    077017
     C* tiers/threshs has been reached and so omit the base rate.         077017
     C*                                                                   077017
     C***********RAT1B     IFNE 0                                         077017
     C           BAL1B     IFNE 0                                         077017
     C           WWDBRT    ADD  RAT1B     RAT1B
     C                     END
     C*
     C***********RAT1C     IFNE 0                                         077017
     C           BAL1C     IFNE 0                                         077017
     C           WWDBRT    ADD  RAT1C     RAT1C
     C                     END
     C*
     C***********RAT1D     IFNE 0                                         077017
     C           BAL1D     IFNE 0                                         077017
     C           WWDBRT    ADD  RAT1D     RAT1D
     C                     END
     C*
     C***********RAT1E     IFNE 0                                         077017
     C           BAL1E     IFNE 0                                         077017
     C           WWDBRT    ADD  RAT1E     RAT1E
     C                     END
     C*
     C***********RAT1F     IFNE 0                                         077017
     C           BAL1F     IFNE 0                                         077017
     C           WWDBRT    ADD  RAT1F     RAT1F
     C                     END
     C*
     C                     END
     C*
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP50                                           S01408
      *                                                                   S01408
     C**********           MOVE ST2RAT    ZZ199                                               CRE005
     C                     MOVE @RAT1     RAT1                                                CRE005
     C                     MOVE @BAL1     BAL1                                                CRE005
     C*
     C**********           UPDATSTRANF                                                        CRE005
     C                     WRITERERCH2D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C**********           ADD  1         WWTRNO                                              CRE005
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD14        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 14 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S3CNUM
     C                     MOVE SSCCY     S3CCY
     C                     MOVE SSACOD    S3ACOD
     C                     MOVE SSACSQ    S3ACSQ
     C                     MOVE '3'       S3THRE
     C                     Z-ADDSSDRCD    S3WOLD
     C                     MOVE '0'       S3DRCR
     C                     TIME           S3TIME
     C                     MOVE SSSPTA    S3SPTA
     C                     MOVE BAL2      BAL3
     C                     MOVE BAL3      @BAL3                                               CRE005
     C                     MOVE RAT2      RAT3
     C                     MOVE RAT3      @RAT3                                               CRE005
     C**********           Z-ADDWWTRNO    S3TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S3NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C                     MOVE 'R'       S3RECI                                              CRE005
     C*
     C* INITIAL THRESHOLD, BALANCE AND RATE SPREAD SET TO ZERO IN
     C* STRAN RATE 3 IF DEBIT INTEREST TYPE IS BLANK
     C*
     C           SSDICT    IFEQ *ZERO
     C                     MOVELBAL0      BAL3
     C                     MOVELRAT0      RAT3
     C                     END
     C*
     C* ADD NEW BASE RATE WITH RATE SPREAD IN STRAN RATE 2 IF DEBIT
     C* INTEREST TYPE IS NOT 0
     C*
     C           SSDICT    IFGT 0
     C*
     C           BAL3A     IFNE 0                                         077012
     C***********BANBRT    ADD  RAT3A     RAT3A                           077012
     C           WWDBRT    ADD  RAT3A     RAT3A                           077012
     C                     END                                            077012
     C*
     C* Must now use balance not rate to determine when the end of the    077017
     C* tiers/threshs has been reached and so omit the base rate.         077017
     C*                                                                   077017
     C***********RAT3B     IFNE 0                                         077017
     C           BAL3B     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3B     RAT3B                           077012
     C           WWDBRT    ADD  RAT3B     RAT3B                           077012
     C                     END
     C*
     C***********RAT3C     IFNE 0                                         077017
     C           BAL3C     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3C     RAT3C                           077012
     C           WWDBRT    ADD  RAT3C     RAT3C                           077012
     C                     END
     C*
     C***********RAT3D     IFNE 0                                         077017
     C           BAL3D     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3D     RAT3D                           077012
     C           WWDBRT    ADD  RAT3D     RAT3D                           077012
     C                     END
     C*
     C***********RAT3E     IFNE 0                                         077017
     C           BAL3E     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3E     RAT3E                           077012
     C           WWDBRT    ADD  RAT3E     RAT3E                           077012
     C                     END
     C*
     C                     END                                            077012
     C*
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP51                                           S01408
      *                                                                   S01408
     C**********           MOVE ST3RAT    ZZ199                                               CRE005
     C                     MOVEL@BAL3     BAL3                                                CRE005
     C                     MOVEL@RAT3     RAT3                                                CRE005
     C*
     C*
     C**********           UPDATSTRANF                                                        CRE005
     C                     WRITERERCH3D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C                     END                             - E1
     C                     END
     C*
     C           SSDICT    IFEQ *ZERO
     C           SDRIB     IFNE SADRIB                     - B1
     C           SDRIS     ORNE SADRIS
     C           SDSIG     ORNE SADSIG
     C           SSAODR    ORNE SWAODR                                    CRE001
     C           CRE001    ANDEQ'Y'                                       CRE001
     C*
     C                     EXSR ZTNLU1
     C                     Z-ADDNATN      WWNATN
     C********** 1         CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD15        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 15 *                    CRE005
     C**********           MOVEL'1     '  DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C************************************************************                            CRE005
     C***UPDATE*HEADER*OF*STRAN***********************************                            CRE005
     C************************************************************                            CRE005
     C**********           MOVE ZZ199     STHEAD                                              CRE005
     C**********           Z-ADDTRNO      WWTRNO                                              CRE005
     C**********           ADD  1         TRNO                                                CRE005
     C**********           Z-ADDWWNATN    SATN                                                CRE005
     C**********           ADD  1         NORC                                                CRE005
     C**********           MOVE STHEAD    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C*
     C** ACCESS BASE RATE TYPE
     C*
     C           SDRIB     IFNE *BLANKS                    - B3
     C                     MOVE SDRIB     WWRIB
     C                     MOVE SCCY      WWCCY
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C           @RTCD     IFNE *BLANKS                    - B4
     C           *LOCK     IN   LDA
     C                     Z-ADD16        DBASE            ***************
     C                     MOVEL'SDBSRTPD'DBFILE           * DB ERROR 16 *
     C                     MOVELWWRIB     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             - E4
     C                     END                             - E3
     C*
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD17        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 17 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S1CNUM
     C                     MOVE SSCCY     S1CCY
     C                     MOVE SSACOD    S1ACOD
     C                     MOVE SSACSQ    S1ACSQ
     C                     MOVE '1'       S1ONE
     C                     MOVE *BLANKS   S1X
     C                     MOVE SSACNO    S1ACNO
     C                     Z-ADDBJRDNB    S1RUND
     C                     Z-ADDSSDRCD    S1WOLD
     C**********           MOVEL'9010 RAT'S1NARR                                              CRE005
     C**********           MOVE 'E CHANGE'S1NARR                                              CRE005
     C                     Z-ADD9010      S1TRAT                                              CRE005
     C                     MOVE 'RATE'    W1NARR  4                                           CRE005
     C                     MOVE 'CHANGE'  W2NARR  6                                           CRE005
     C           W1NARR    CAT  W2NARR:1  S1NARR                                              CRE005
     C                     Z-ADD*ZEROS    S1INTT
     C                     Z-ADD*ZEROS    S1INTS
     C                     MOVE '0'       S1DRCR
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSSAODR    S1AODR                          CRE001
      *                                                                   CRE001
     C           SSAODR    IFNE SWAODR                                    CRE001
     C           SSAODR    ANDNE*ZEROS                                    119479
     C                     Z-ADDSSORTC    S1WOLD                          CRE001
     C                     ENDIF                                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     TIME           S1TIME
     C**********           MOVE 'GE/RC'   S1RECO                                              CRE005
     C                     MOVEL'GE/RC'   S1RECO                                              CRE005
     C                     MOVELSSSPTA    S1SPTA
     C                     MOVE 'R'       S1ATYP
     C                     Z-ADD*ZEROS    S1RVLD
     C                     MOVE BITOFF    S1BITF
     C                     Z-ADDSWDRCD    S1OLDR
     C**********           Z-ADDBJRDNB    S1WRUN                                              CRE005
     C**********           Z-ADDWWTRNO    S1TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S1NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C                     MOVE 'R'       S1RECI                                              CRE005
     C                     Z-ADDSSDRIS    S1WRIS
     C                     Z-ADDSSDRIS    S1INRT
     C           SDRIB     IFEQ *BLANKS
     C                     Z-ADD*ZEROS    S1BRIS
     C                     ELSE
     C                     Z-ADDSSDRIB    S1BRIS
     C***********          ADD  BANBRT    S1INRT                          077012
     C                     ADD  WWDBRT    S1INRT                          077012
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP52                                           S01408
      *                                                                   S01408
     C**********           MOVE ST1RAT    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C                     WRITERERCH1D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C*                    END                             - E2
     C                     END                             - E1
     C                     END
     C*
     C** CREDIT RATE CHANGE
     C*
     C* OUTPUT ONLY IF NO FLAT RATE
     C*
     C           SCRIB     IFEQ *BLANK
     C           SCRIS     ANDEQ*BLANK
     C           SCSIG     ANDEQ*BLANK
     C           SCICT     IFNE SACICT                     - B1
     C           SCCST     ORNE SAAMAL
     C*
     C                     EXSR ZTNLU1
     C                     Z-ADDNATN      WWNATN  50
     C********** 1         CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD18        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 18 *                    CRE005
     C**********           MOVEL'1     '  DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C************************************************************                            CRE005
     C***UPDATE*HEADER*OF*STRAN***********************************                            CRE005
     C************************************************************                            CRE005
     C**********           MOVE ZZ199     STHEAD                                              CRE005
     C**********           Z-ADDTRNO      WWTRNO  50                                          CRE005
     C**********           ADD  3         TRNO                                                CRE005
     C**********           Z-ADDWWNATN    SATN                                                CRE005
     C**********           ADD  1         NORC                                                CRE005
     C**********           MOVE STHEAD    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C*
     C** ACCESS INTEREST TYPE/SUB TYPE ONLY IF ZERO
     C*
     C                     Z-ADD*ZEROS    S1BRIS                          075510
     C           SSCICT    IFNE *ZERO
     C           SSAMAL    ORNE *ZERO
     C                     MOVE SSCICT    TYPE
     C                     MOVE SSAMAL    SBTYPE
     C                     MOVE SSCCY     CURR
     C                     MOVE 'D'       D
     C           KEY       CHAINREINT                80
     C           *IN80     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD19        DBASE            ***************
     C                     MOVEL'REINT   'DBFILE           * DB ERROR 19 *
     C                     MOVEL'KEY     'DBKEY            ***************
     C                     MOVELKEY       DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             - E3
     C                     Z-ADDBRT       S1BRIS                          075510
     C                     END
     C*
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD20        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 20 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S1CNUM
     C                     MOVE SSCCY     S1CCY
     C                     MOVE SSACOD    S1ACOD
     C                     MOVE SSACSQ    S1ACSQ
     C                     MOVE '1'       S1ONE
     C                     MOVE 'X'       S1X
     C                     MOVE SSACNO    S1ACNO
     C                     Z-ADDBJRDNB    S1RUND
     C                     Z-ADDSSDR9     S1WOLD
     C**********           MOVEL'9010 RAT'S1NARR                                              CRE005
     C**********           MOVE 'E CHANGE'S1NARR                                              CRE005
     C                     Z-ADD9010      S1TRAT                                              CRE005
     C                     MOVE 'RATE'    W1NARR  4                                           CRE005
     C                     MOVE 'CHANGE'  W2NARR  6                                           CRE005
     C           W1NARR    CAT  W2NARR:1  S1NARR                                              CRE005
     C                     Z-ADDSSCICT    S1INTT
     C                     Z-ADDSSAMAL    S1INTS
     C                     MOVE '1'       S1DRCR
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADD0         S1AODR                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     TIME           S1TIME
     C**********           MOVE 'GE/RC'   S1RECO                                              CRE005
     C                     MOVEL'GE/RC'   S1RECO                                              CRE005
     C                     MOVELSSSPTA    S1SPTA
     C                     MOVE 'R'       S1ATYP
     C                     Z-ADD*ZEROS    S1RVLD
     C                     MOVE BITOFF    S1BITF
     C                     Z-ADDSWDR9     S1OLDR
     C                     Z-ADD*ZEROS    S1INRT
     C*********************Z-ADD*ZEROS    S1BRIS                          075510
     C                     Z-ADD*ZEROS    S1WRIS
     C**********           Z-ADDBJRDNB    S1WRUN                                              CRE005
     C**********           Z-ADDWWTRNO    S1TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S1NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C                     MOVE 'R'       S1RECI                                              CRE005
     C**********           MOVE ST1RAT    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C                     WRITERERCH1D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C**********           ADD  1         WWTRNO                                              CRE005
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD21        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 21 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S2CNUM
     C                     MOVE SSCCY     S2CCY
     C                     MOVE SSACOD    S2ACOD
     C                     MOVE SSACSQ    S2ACSQ
     C                     MOVE '2'       S2TWO
     C                     MOVE 'X'       S2X
     C                     Z-ADDINTH      S2INTH
     C                     Z-ADDSSDR9     S2WOLD
     C                     MOVE '1'       S2DRCR
     C                     TIME           S2TIME
     C                     MOVE SSSPTA    S2SPTA
     C                     MOVELBAL2      BAL1
     C                     MOVELBAL1      @BAL1                                               CRE005
     C                     MOVELRAT2      RAT1
     C                     MOVELRAT1      @RAT1                                               CRE005
     C**********           Z-ADDWWTRNO    S2TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S2NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C                     MOVE 'R'       S2RECI                                              CRE005
     C*                    MOVE ST2RAT    ZZ199
     C*
     C* INITIAL THRESHOLD, BALANCE AND RATE SPREAD SET TO ZERO IN
     C* STRAN RATE 2 IF CREDIT INTEREST TYPE IS BLANK
     C*
     C           SSCICT    IFEQ *ZERO
     C                     Z-ADD0         S2INTH
     C                     MOVELBAL0      BAL1
     C                     MOVELRAT0      RAT1
     C                     END
     C*
     C* ADD NEW BASE RATE WITH RATE SPREAD IN STRAN RATE 2 IF DEBIT
     C* INTEREST TYPE IS EQUAL TO 2
     C*
     C           SSCICT    IFGT 0
     C*
     C* USE NEW CREDIT BASE RATE
     C           WWCBRT    ADD  RAT1A     RAT1A
     C*
     C* Must now use balance not rate to determine when the end of the    077017
     C* tiers/threshs has been reached and so omit the base rate.         077017
     C*                                                                   077017
     C***********RAT1B     IFNE 0                                         077017
     C           BAL1B     IFNE 0                                         077017
     C           WWCBRT    ADD  RAT1B     RAT1B
     C                     END
     C*
     C***********RAT1C     IFNE 0                                         077017
     C           BAL1C     IFNE 0                                         077017
     C           WWCBRT    ADD  RAT1C     RAT1C
     C                     END
     C*
     C***********RAT1D     IFNE 0                                         077017
     C           BAL1D     IFNE 0                                         077017
     C           WWCBRT    ADD  RAT1D     RAT1D
     C                     END
     C*
     C***********RAT1E     IFNE 0                                         077017
     C           BAL1E     IFNE 0                                         077017
     C           WWCBRT    ADD  RAT1E     RAT1E
     C                     END
     C*
     C***********RAT1F     IFNE 0                                         077017
     C           BAL1F     IFNE 0                                         077017
     C           WWCBRT    ADD  RAT1F     RAT1F
     C                     END
     C*
     C                     END
     C*
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP53                                           S01408
      *                                                                   S01408
     C**********           MOVE ST2RAT    ZZ199                                               CRE005
     C                     MOVEL@BAL1     BAL1                                                CRE005
     C                     MOVEL@RAT1     RAT1                                                CRE005
     C*
     C**********           UPDATSTRANF                                                        CRE005
     C                     WRITERERCH2D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C**********           ADD  1         WWTRNO                                              CRE005
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD22        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 22 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S3CNUM
     C                     MOVE SSCCY     S3CCY
     C                     MOVE SSACOD    S3ACOD
     C                     MOVE SSACSQ    S3ACSQ
     C                     MOVE '3'       S3THRE
     C                     Z-ADDSSDR9     S3WOLD
     C                     MOVE '1'       S3DRCR
     C                     TIME           S3TIME
     C                     MOVE SSSPTA    S3SPTA
     C                     MOVE BAL2      BAL3
     C                     MOVE BAL3      @BAL3                                               CRE005
     C                     MOVE RAT2      RAT3
     C                     MOVE RAT3      @RAT3                                               CRE005
     C**********           Z-ADDWWTRNO    S3TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S3NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C                     MOVE 'R'       S3RECI                                              CRE005
     C*
     C* INITIAL THRESHOLD, BALANCE AND RATE SPREAD SET TO ZERO IN
     C* STRAN RATE 3 IF CREDIT INTEREST TYPE IS BLANK
     C*
     C           SSCICT    IFEQ *ZERO
     C                     MOVELBAL0      BAL3
     C                     MOVELRAT0      RAT3
     C                     END
     C* ADD NEW BASE RATE WITH RATE SPREAD IN STRAN RATE 2 IF DEBIT
     C* INTEREST TYPE IS NOT 0
     C*
     C***********SSDICT    IFGT 0                                         074979
     C           SSCICT    IFGT 0                                         074979
     C*
     C           BAL3A     IFNE 0                                         077012
     C***********BANBRT    ADD  RAT3A     RAT3A                           077012
     C           WWCBRT    ADD  RAT3A     RAT3A                           077012
     C                     END                                            077012
     C*
     C* Must now use balance not rate to determine when the end of the    077017
     C* tiers/threshs has been reached and so omit the base rate.         077017
     C*                                                                   077017
     C***********RAT3B     IFNE 0                                         077017
     C           BAL3B     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3B     RAT3B                           077012
     C           WWCBRT    ADD  RAT3B     RAT3B                           077012
     C                     END
     C*
     C***********RAT3C     IFNE 0                                         077017
     C           BAL3C     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3C     RAT3C                           077012
     C           WWCBRT    ADD  RAT3C     RAT3C                           077012
     C                     END
     C*
     C***********RAT3D     IFNE 0                                         077017
     C           BAL3D     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3D     RAT3D                           077012
     C           WWCBRT    ADD  RAT3D     RAT3D                           077012
     C                     END
     C*
     C***********RAT3E     IFNE 0                                         077017
     C           BAL3E     IFNE 0                                         077017
     C***********BANBRT    ADD  RAT3E     RAT3E                           077012
     C           WWCBRT    ADD  RAT3E     RAT3E                           077012
     C                     END
     C*
     C                     END
     C*
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP54                                           S01408
      *                                                                   S01408
     C**********           MOVE ST3RAT    ZZ199                                               CRE005
     C                     MOVEL@BAL3     BAL3                                                CRE005
     C                     MOVEL@RAT3     RAT3                                                CRE005
     C*
     C*
     C**********           UPDATSTRANF                                                        CRE005
     C                     WRITERERCH3D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C                     END                             - E1
     C                     END
     C*
     C           SSCICT    IFEQ *ZERO
     C           SCRIB     IFNE SACRIB                     - B1
     C           SCRIS     ORNE SACRIS
     C           SCSIG     ORNE SACSIG
     C*
     C                     EXSR ZTNLU1
     C                     Z-ADDNATN      WWNATN
     C********** 1         CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD23        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 23 *                    CRE005
     C**********           MOVEL'1     '  DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C************************************************************                            CRE005
     C***UPDATE*HEADER*OF*STRAN***********************************                            CRE005
     C************************************************************                            CRE005
     C**********           MOVE ZZ199     STHEAD                                              CRE005
     C**********           Z-ADDTRNO      WWTRNO                                              CRE005
     C**********           ADD  1         TRNO                                                CRE005
     C**********           Z-ADDWWNATN    SATN                                                CRE005
     C**********           ADD  1         NORC                                                CRE005
     C**********           MOVE STHEAD    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C*
     C** ACCESS BASE RATE TYPE
     C*
     C           SCRIB     IFNE *BLANKS                    - B3
     C                     MOVE SCRIB     WWRIB
     C                     MOVE SCCY      WWCCY
     C*
     C** Get Base Rate Codes
     C*
     C                     CALL 'AOBSRTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WWCCY     @CYCD
     C                     PARM WWRIB     @BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C           @RTCD     IFNE *BLANKS                    - B4
     C           *LOCK     IN   LDA
     C                     Z-ADD24        DBASE            ***************
     C                     MOVEL'SDBSRTPD'DBFILE           * DB ERROR 24 *
     C                     MOVELWWRIB     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             - E4
     C                     END                             - E3
     C*
     C********** WWTRNO    CHAINSTRAN                80                                       CRE005
     C********** *IN80     IFEQ '1'                        - B3                               CRE005
     C********** *LOCK     IN   LDA                                                           CRE005
     C**********           Z-ADD25        DBASE            ***************                    CRE005
     C**********           MOVEL'STRAN   'DBFILE           * DB ERROR 25 *                    CRE005
     C**********           MOVELWWTRNO    DBKEY            ***************                    CRE005
     C**********           OUT  LDA                                                           CRE005
     C**********           EXSR *PSSR                                                         CRE005
     C**********           END                             - E3                               CRE005
     C*
     C                     MOVE SSCNUM    S1CNUM
     C                     MOVE SSCCY     S1CCY
     C                     MOVE SSACOD    S1ACOD
     C                     MOVE SSACSQ    S1ACSQ
     C                     MOVE '1'       S1ONE
     C                     MOVE *BLANKS   S1X
     C                     MOVE SSACNO    S1ACNO
     C                     Z-ADDBJRDNB    S1RUND
     C                     Z-ADDSSDR9     S1WOLD
     C**********           MOVEL'9010 RAT'S1NARR                                              CRE005
     C**********           MOVE 'E CHANGE'S1NARR                                              CRE005
     C                     Z-ADD9010      S1TRAT                                              CRE005
     C                     MOVE 'RATE'    W1NARR  4                                           CRE005
     C                     MOVE 'CHANGE'  W2NARR  6                                           CRE005
     C           W1NARR    CAT  W2NARR:1  S1NARR                                              CRE005
     C                     Z-ADD*ZEROS    S1INTT
     C                     Z-ADD*ZEROS    S1INTS
     C                     MOVE '1'       S1DRCR
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADD0         S1AODR                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     TIME           S1TIME
     C**********           MOVE 'GE/RC'   S1RECO                                              CRE005
     C                     MOVEL'GE/RC'   S1RECO                                              CRE005
     C                     MOVELSSSPTA    S1SPTA
     C                     MOVE 'R'       S1ATYP
     C                     Z-ADD*ZEROS    S1RVLD
     C                     MOVE BITOFF    S1BITF
     C                     Z-ADDSWDR9     S1OLDR
     C**********           Z-ADDBJRDNB    S1WRUN                                              CRE005
     C**********           Z-ADDWWTRNO    S1TRNO                                              CRE005
     C**********           Z-ADDWWNATN    S1NATN                                              CRE005
     C**********           MOVE 'R'       RECI                                                CRE005
     C                     MOVE 'R'       S1RECI                                              CRE005
     C                     Z-ADDSSCRIS    S1WRIS
     C                     Z-ADDSSCRIS    S1INRT
     C           SCRIB     IFEQ *BLANKS                    - B3
     C                     Z-ADD*ZEROS    S1BRIS
     C                     ELSE                            - X3
     C                     Z-ADDSSCRIB    S1BRIS
     C***********          ADD  BANBRT    S1INRT                          077012
     C                     ADD  WWCBRT    S1INRT                          077012
     C                     END                             - E3
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP55                                           S01408
      *                                                                   S01408
     C**********           MOVE ST1RAT    ZZ199                                               CRE005
     C**********           UPDATSTRANF                                                        CRE005
     C                     WRITERERCH1D0                                                      CRE005
      *                                                                                       CRE005
      ** Add 1 to header record field                                                         CRE005
     C                     ADD  1         WNORS                                               CRE005
     C*
     C*                    END                             - E2
     C                     END                             - E1
     C                     END
      *                                                                                       CRE005
      ** Read header record before update                                                     CRE005
     C           1         SETLLRERCHHA0                                                      CRE005
     C                     READ RERCHHA0                 80                                   CRE005
     C           *IN80     IFEQ '1'                                                           CRE005
     C           *LOCK     IN   LDA                                                           CRE005
     C                     Z-ADD26        DBASE                                               CRE005
     C                     MOVEL'RERCHHPA'DBFILE                                              CRE005
     C                     MOVEL'      '  DBKEY                                               CRE005
     C                     OUT  LDA                                                           CRE005
     C                     EXSR *PSSR                                                         CRE005
     C                     ENDIF                                                              CRE005
      *                                                                                       CRE005
      ** Update header record in Header file                                                  CRE005
     C           WNORS     ADD  NOREC     NOREC                                               CRE005
     C                     UPDATRERCHHA0                                                      CRE005
     C/COPY WNCPYSRC,GL3271C012
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
     C********************************************************************
     C*                                                                  *
     C* ZASNMS    - Send message to program message queue                *
     C*                                                                  *
     C* CALLS     - Y2SNMGC                                              *
     C*                                                                  *
     C* CALLED BY -                                                      *
     C* #V10F0   - PROCESS VALIDATION OF START SCREEN                    *
     C* #P10S0   - PROCESS REVIEW FROM SUBFILE                           *
     C* #V10S0   - PROCESS VALIDATION OF SUBFILE                         *
     C* #P10FK   - INSERT AND DELETE MODE                                *
     C* #V10FK   - PROCESS VALIDATION OF 'FK' FORMAT                     *
     C* #P10F1   - PROCESS ACCOUNT MASTER DETAILS                        *
     C* #V10F1   - PROCESS VALIDATION OF 'F1' FORMAT                     *
     C* #P10F2   - PROCESS DEBIT INTEREST DETAILS                        *
     C* #V10F2   - PROCESS VALIDATION OF 'F2' FORMAT                     *
     C* #P10F3   - PROCESS CREDIT INTEREST DETAILS                       *
     C* #V10F3   - PROCESS VALIDATION OF 'F3' FORMAT                     *
     C* #P10F4   - PROCESS COMMISSIONS DETAILS                           *
     C* #V10F4   - PROCESS VALIDATION OF 'F4' FORMAT                     *
     C* #P10F5   - PROCESS OTHER DETAILS                                 *
     C* #V10F5   - PROCESS VALIDATION OF 'F5' FORMAT                     *
     C* #P1002   - WRITE PROCESSING                                      *
     C* #P1003   - UPDATE PROCESSING                                     *
     C* #P1004   - DELETE PROCESSING                                     *
     C*                                                                  *
     C********************************************************************
     C           ZASNMS    BEGSR
     C/COPY WNCPYSRC,GL3271C146
     C*
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM            Program queue
     C                     PARM           ZAPGRL           Rel queue
     C                     PARM           ZAMSID           Message Id.
     C                     PARM           ZAMSGF           Message file.
     C                     PARM           ZAMSDA           Message data.
     C                     PARM           ZAMSTP           Message type.
     C*
     C** Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Message queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C*
     C*  MESSAGE OUTPUT THEREFORE DO NOT CLEAR FOR ACCESS OBJECT MSG
     C                     MOVE '1'       *IN36
     C*
     C           ZASNM9    ENDSR                           ZASNM9 TAG
     C*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #WNDW    - TO PROCESS WINDOW TAXES AND SWISS RETURNS             *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10F1   - PROCESS 'F1' FORMAT                                   *
      * #P10F3   - PROCESS 'F3' FORMAT                                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #WNDW     BEGSR
     C*
     C                     MOVE '0'       *IN25
     C                     MOVE *BLANKS   #PGM
     C                     MOVE *BLANKS   FKEY                            110515
     C*
     C           WFMT      IFEQ 'F1'
     C                     MOVEL'GL327A ' #PGM
     C                     END
     C*
     C           WFMT      IFEQ 'F3'
     C                     MOVEL'GL327B ' #PGM
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP36                                           S01408
      *                                                                   S01408
     C*
     C*  /COPY to move data into the data structure fields passed
     C*      as parameter to the window controller.
     C/COPY QWINDSRC,GL3271MOV1
     C/COPY WNCPYSRC,GL3271C054
     C*
     C                     MOVE A5ACTY    #1ATYP
     C                     CALL 'WN0010'
     C                     PARM           #PGM   10
     C                     PARM           FKEY    2
     C                     PARM DDACTN    ACTION  1
     C                     PARM           DATA
     C                     PARM *BLANKS   #RTRN   7
     C                     PARM           SPARE 256
     C*
     C*  Check the return code, F3, F12, Rollup or Rolldown
     C*    pressed from the window.
     C*
     C/COPY WNCPYSRC,GL3271C202
     C                     MOVEL*BLANK    WWRTCD  1
     C*
     C           #RTRN     IFEQ 'USR0790'                  *F3 PRESSED
     C                     MOVE '1'       *INKC
     C                     MOVE *BLANKS   WFMT
     C                     MOVE 'X'       WWRTCD
     C                     END
     C*
     C           #RTRN     IFEQ 'USR0791'                  *F12 PRESSED
     C                     MOVE '1'       *INKL
     C                     MOVE WWRTRN    WFMT
     C                     MOVE 'X'       WWRTCD
      *                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP49                                           S01408
      *                                                                   S01408
     C                     END
     C*
     C           #RTRN     IFEQ 'USR0792'                  *ROLLDOWN
     C                     MOVE 'X'       WWRTCD
     C                     END
     C/COPY WNCPYSRC,GL3271C228
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #DELDEF  - TO PROCESS DEFAULT IN DELETION MODE                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10FK   - PROCESS ISERT AND DELETE MODE                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #DELDF    BEGSR
     C**
     C           SWSVNM    IFNE *BLANKS
     C                     MOVE SWSVNM    SCNUM
     C                     MOVE SWSVCY    SCCY
     C                     MOVE SWSVAD    SACOD
     C                     MOVE SWSVAS    SACSQ
     C                     MOVE SWSVBD    SBRCA
     C                     MOVE SWSVAM    SANAM
     C                     MOVE SWSVAO    SACNO
     C**
     C** RESET FIELDS
     C                     MOVEL*BLANKS   SWSVNM
     C                     MOVEL*BLANKS   SWSVCY
     C                     MOVEL*BLANKS   SWSVAD
     C                     MOVEL*BLANKS   SWSVAS
     C                     MOVEL*BLANKS   SWSVAM
     C                     MOVEL*BLANKS   SWSVBD
     C                     MOVEL*BLANKS   SWSVAO
     C                     END
     C**
     C                     ENDSR
      ********************************************************************
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP22                                           S01408
     C*                                                                   S01408
      /EJECT
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3271CP75                                           S01408
     C*                                                                   S01408
      ********************************************************************
      *                                                                  *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #V10F1   - PROCESS VALIDATION OF 'F1' FORMAT                     *
      * #V10F4   - PROCESS VALIDATION OF 'F4' FORMAT                     *
      * #P1001   - PROCESS INITIALIZATION                                *
      * #P1002   - WRITE PROCESSING                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C**
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     ROLBK
     C**
     C                     OPEN GL3271AU
     C**
     C                     WRITEHEADAU
     C********** DBFILE    IFEQ 'STRAN   '                                                    CRE005
     C********** WWTRNO    ANDGTNBREC                                                         CRE005
     C**********           WRITEERRAU2                                                        CRE005
     C**********           END                                                                CRE005
     C                     WRITEERRAU
     C**
     C                     CLOSEGL3271AU
     C*
     C** IF PROGRAM CALLED AS LINKED ENQUIRY, SET RETURN CODE TO 'E'
     C** AND EXIT PROGRAM
     C*
     C           MODID     IFEQ 'GL'
     C                     MOVE 'E'       RTNDWF
     C                     EXSR #RETSR
     C                     END
     C/COPY WNCPYSRC,GL3271C244
     C*
     C                     MOVE '1'       *INLR
     C                     RETRN
     C                     ENDSR
      ********************************************************************
     C/COPY WNCPYSRC,GL3271C147
      /EJECT                                                              113843
      ********************************************************************113843
      * #RTVCG - Routine to retrieve and validate customer group          113843
      ********************************************************************113843
     C           #RTVCG    BEGSR                                          113843
     C*                                                                   113843
     C                     MOVE '0'       *IN36                           113843
     C*                                                                   113843
     C** ACCESS CUSTOMER GROUP IN SDCUSTX0                                113843
     C*                                                                   113843
     C                     MOVELWWCNUM    #CNUM   6                       113843
     C*****                CALL 'AOCUSTR0'                         113843 178695
     C                     CALL 'AOCUSTR1'                                178695
     C                     PARM '*MSG   ' @RTCD                           113843
     C                     PARM '*KEY   ' @OPTN                           113843
     C                     PARM #CNUM     @CNUM  10                       113843
     C                     PARM           @CNST   7                       113843
     C*****      SDCUST    PARM SDCUST    DSSDY                    113843 178695
     C           SDCUST    PARM SDCUST    DSLDY                           178695
     C/COPY WNCPYSRC,GL3271C224
     C           @RTCD     IFNE *BLANKS                    B1             113843
     C*                                                                   113843
     C** CLEAR FIRST INSTANCE OF ACCESS OBJECT ERROR MESSAGE              113843
     C*                                                                   113843
     C           *IN36     IFEQ '0'                        B.2            113843
     C                     CALL 'ZA0250'                                  113843
     C                     MOVE '1'       *IN36                           113843
     C                     ENDIF                           E.2            113843
     C*                                                                   113843
     C                     MOVEL'RE71450' ZAMSID                          113843
     C                     EXSR ZASNMS                                    113843
     C                     MOVEL'E'       ERR                             113843
     C                     ENDIF                           E1             113843
     C*                                                                   113843
     C** CHECK IF CUSTOMER GROUP IS OK                                    113843
     C* CHECK LINE BELOW FOR CONSISTENCY                                  113843
     C           BBCGRP    IFEQ *BLANKS                                   113843
     C                     MOVEL'1'       BBCGRP                          113843
     C                     END                                            113843
     C                     MOVELBBCGRP    CUCGRP  1                       113843
     C                     MOVE '0'       *IN10                           113843
     C                     Z-ADD1         I1      20                      113843
     C           CUCGRP    LOKUPGRP,I1                   10               113843
     C*                                                                   113843
     C           *IN10     IFNE '1'                        B1             113843
     C           *LOCK     IN   LDA                                       113843
     C                     Z-ADD2         DBASE            ***************113843
     C                     MOVEL'SDCUSTPD'DBFILE           **DB ERROR 02**113843
     C                     MOVEL#CNUM     DBKEY            ***************113843
     C                     OUT  LDA                                       113843
     C                     EXSR *PSSR                                     113843
     C                     ENDIF                           E1             113843
     C                     MOVELCUCGRP    SCGRP   1        Customer group 113843
     C*                                                                   113843
     C                     ENDSR                                          113843
      *                                                                   113843
      ********************************************************************113843
      /EJECT                                                              113843
      ********************************************************************113843
      *                                                                   113843
      * #RTVCM - Routine to retrieve defaults for commissions             113843
      *                                                                   113843
      ********************************************************************113843
     C           #RTVCM    BEGSR                                          113843
      *                                                                   113843
      ** Initialize/reset fields                                          113843
     C                     MOVEL*BLANKS   SCEXA1                          113843
     C                     MOVEL*BLANKS   SCEXB1                          113843
     C                     MOVEL*BLANKS   SCEXC1                          113843
     C                     MOVEL*BLANKS   SCEXD1                          113843
     C                     MOVEL*BLANKS   SCEXE1                          113843
     C                     MOVEL*BLANKS   SCEXF1                          113843
     C                     MOVEL*BLANKS   SCEXG1                          113843
     C                     MOVEL*BLANKS   SDRMG1                          CDE002
     C                     MOVEL*BLANKS   SCRMG1                          CDE002
      *                                                                   113843
      ** Setup key                                                        113843
     C                     MOVEL*BLANKS   K1FLD1 12                       113843
     C                     MOVEL*BLANKS   WU004A  4                       113843
     C                     MOVELSCCY      WU004A                          113843
     C                     MOVE 'D'       WU004A                          113843
     C                     MOVE WU004A    K1FLD1                          113843
      *                                                                   113843
      ** Retrieve defaults                                                113843
     C           K1FLD1    CHAINRECCY                99                   113843
      *                                                                   113843
     C           *IN99     IFEQ '0'                        B1             113843
      *                                                                   113843
      ** A - Highest overdraft commission                                 113843
     C           IN2,I1    IFEQ 'Y'                        B.2            113843
     C                     MOVEL*BLANKS   ZFIELD                          113843
     C                     Z-ADD2         ZADIG                           113843
     C                     Z-ADD8         ZADEC                           113843
     C                     MOVE HORT      ZFIELD                          113843
     C                     EXSR ZEDIT                                     113843
     C                     MOVE ZFIELD    SCEXA1                          113843
     C                     ENDIF                           E.2            113843
      *                                                                   113843
      ** B - Turnover commission                                          113843
     C           IN1,I1    IFEQ 'Y'                        B.2            113843
     C                     MOVEL*BLANKS   ZFIELD                          113843
     C                     Z-ADD2         ZADIG                           113843
     C                     Z-ADD8         ZADEC                           113843
     C                     MOVE ACRT      ZFIELD                          113843
     C                     EXSR ZEDIT                                     113843
     C                     MOVE ZFIELD    SCEXB1                          113843
     C                     ENDIF                           E.2            113843
      *                                                                   113843
      ** C - Debit interest commission                                    113843
     C           IN3,I1    IFEQ 'Y'                        B.2            113843
     C                     MOVEL*BLANKS   ZFIELD                          113843
     C                     Z-ADD2         ZADIG                           113843
     C                     Z-ADD8         ZADEC                           113843
     C                     MOVE DIRT      ZFIELD                          113843
     C                     EXSR ZEDIT                                     113843
     C                     MOVE ZFIELD    SCEXC1                          113843
     C                     ENDIF                           E.2            113843
      *                                                                   113843
      ** D - Inactive account commission                                  113843
     C           IN4,I1    IFEQ 'Y'                        B.2            113843
     C                     Z-ADDWWDECS    ZADEC                           113843
     C           7         SUB  WWDECS    ZADIG                           113843
      *                                                                   113843
     C                     MOVEL*BLANKS   ZFIELD                          113843
     C                     MOVE INFC      ZFIELD                          113843
     C                     EXSR ZEDIT                                     113843
     C                     MOVE ZFIELD    SCEXD1                          113843
     C                     ENDIF                           E.2            113843
      *                                                                   113843
      ** E - Minimum CR balance commission                                113843
     C           IN5,I1    IFEQ 'Y'                        B.2            113843
      *                                                                   113843
      ** Current or Savings?                                              113843
     C           SSSTYP    IFEQ 'S'                        B..3           113843
     C                     MOVE MSFC      ZFIELD                          113843
     C                     ELSE                            X..3           113843
     C                     MOVE MCFC      ZFIELD                          113843
     C                     ENDIF                           E..3           113843
     C                     Z-ADDWWDECS    ZADEC                           113843
     C           7         SUB  WWDECS    ZADIG                           113843
     C                     EXSR ZEDIT                                     113843
     C                     MOVE ZFIELD    SCEXE1                          113843
     C                     ENDIF                           E.2            113843
      *                                                                   113843
      ** F - Extra daily statement commission                             113843
     C           IN6,I1    IFEQ 'Y'                        B.2            113843
     C                     MOVEL*BLANKS   ZFIELD                          113843
     C                     Z-ADDWWDECS    ZADEC                           119589
     C           7         SUB  WWDECS    ZADIG                           119589
     C           SSTFQ     IFEQ 'E'                        B..3           113843
     C/COPY WNCPYSRC,GLH00822
     C***********          Z-ADDWWDECS    ZADEC                           119589
     C***********7         SUB  WWDECS    ZADIG                           119589
     C                     MOVE DSFC      ZFIELD                          113843
     C                     ELSE                            X..3           113843
     C                     MOVE *ZEROS    ZFIELD                          113843
     C                     ENDIF                           E..3           113843
     C                     EXSR ZEDIT                                     113843
     C                     MOVE ZFIELD    SCEXF1                          113843
     C                     ENDIF                           E.2            113843
      *                                                                   113843
      ** G - Fixed commission                                             113843
     C           IN7,I1    IFEQ 'Y'                        B.2            113843
     C                     MOVEL*BLANKS   ZFIELD                          113843
     C                     Z-ADDWWDECS    ZADEC                           113843
     C           7         SUB  WWDECS    ZADIG                           113843
     C                     MOVE FCFC      ZFIELD                          113843
     C                     EXSR ZEDIT                                     113843
     C                     MOVE ZFIELD    SCEXG1                          113843
     C                     ENDIF                           E.2            113843
      *                                                                   113843
     C           CDE002    IFEQ 'Y'                        B.2            CDE002
      *                                                                   CDE002
      ** H - Debit Interest Margin (only if CDE002 is present)            CDE002
      *                                                                   CDE002
     C           SWOVRD    IFNE 'Y'                                       208221
     C                     MOVEL*BLANKS   ZFIELD                          CDE002
     C                     Z-ADD7         ZADEC                           CDE002
     C                     Z-ADD4         ZADIG                           CDE002
     C                     MOVE DRMG      ZFIELD                          CDE002
     C                     EXSR ZEDIT                                     CDE002
     C                     MOVE ZFIELD    SDRMG1                          CDE002
     C                     ENDIF                                          208221
      *                                                                   CDE002
      ** I - Credit Interest Margin (only if CDE002 is present)           CDE002
      *                                                                   CDE002
     C           SWOVRC    IFNE 'Y'                                       208221
     C                     MOVEL*BLANKS   ZFIELD                          CDE002
     C                     MOVE CRMG      ZFIELD                          CDE002
     C                     EXSR ZEDIT                                     CDE002
     C                     MOVE ZFIELD    SCRMG1                          CDE002
     C                     ENDIF                                          208221
      *                                                                   CDE002
     C                     ENDIF                           E.2            CDE002
      *                                                                   CDE002
     C                     ENDIF                           E1             113843
      *                                                                   113843
     C                     ENDSR                                          113843
      /EJECT                                                              113843
      ********************************************************************                    CGL062
      *                                                                  *                    CGL062
      * #VMD11   - MODULUS 11 VALIDATION                                 *                    CGL062
      *                                                                  *                    CGL062
      ********************************************************************                    CGL062
     C           #VMD11    BEGSR                                                              CGL062
      *                                                                                       CGL062
      *** Initialise total fields                                                             CGL062
      *                                                                                       CGL062
     C                     Z-ADD0         TOTAL   30                                          CGL062
     C                     Z-ADD0         SUM                                                 CGL062
      *                                                                                       CGL062
      *****************************************************************                       CGL062
      *    Check digit validation for Czech clearing system                                   CGL062
      *                                                                                       CGL062
      *      Apply weighting  (ignoring digit 7)                                              CGL062
      *          digit        1  2  3  4  5  6  7  8  9  10                                   CGL062
      *          weighting    6  3  7  9 10  5  -  4  2  1                                    CGL062
      *                                                                                       CGL062
      *****************************************************************                       CGL062
      *                                                                                       CGL062
     C           SRTNO1    MULT 6         SUM,1                                               CGL062
     C           SRTNO2    MULT 3         SUM,2                                               CGL062
     C           SRTNO3    MULT 7         SUM,3                                               CGL062
     C           SRTNO4    MULT 9         SUM,4                                               CGL062
     C           SRTNO5    MULT 10        SUM,5                                               CGL062
     C           SRTNO6    MULT 5         SUM,6                                               CGL062
     C           SRTNO8    MULT 4         SUM,8                                               CGL062
     C           SRTNO9    MULT 2         SUM,9                                               CGL062
     C           SRTNO0    MULT 1         SUM,10                                              CGL062
      *                                                                                       CGL062
      ***  Sum the resulting products                                                         CGL062
      *                                                                                       CGL062
     C                     XFOOTSUM       TOTAL                                               CGL062
      *                                                                                       CGL062
      ***  Divide the total by 11                                                             CGL062
      *                                                                                       CGL062
     C           TOTAL     DIV  11        TOTAL                                               CGL062
     C                     MVR            REM     20                                          CGL062
      *                                                                                       CGL062
      ***  If the remainder is 0 set to 11 for check against table                            CGL062
      *                                                                                       CGL062
     C           REM       IFEQ 0                                                             CGL062
     C                     Z-ADD11        REM                                                 CGL062
     C                     ENDIF                                                              CGL062
      *                                                                                       CGL062
      *****************************************************************                       CGL062
      *                                                                                       CGL062
      *      Use remainder to lookup for check digit (position 7 of                           CGL062
      *      account number)                                                                  CGL062
      *          remainder      1  2  3  4  5  6  7  8  9 10  0                               CGL062
      *          check digit    4  8  1  5  9  2  6  x  3  7  0                               CGL062
      *      NB. a remainder of 8 is invalid                                                  CGL062
      *                                                                                       CGL062
      *****************************************************************                       CGL062
      *                                                                                       CGL062
     C           REM       IFEQ 8                                                             CGL062
     C           SRTNO7    ORNE CHECKD,REM                                                    CGL062
     C                     MOVE 'N'       ACNOOK  1                                           CGL062
     C                     ELSE                                                               CGL062
     C                     MOVE 'Y'       ACNOOK                                              CGL062
     C                     ENDIF                                                              CGL062
      *                                                                                       CGL062
     C                     ENDSR                                                              CGL062
      /EJECT                                                                                  CGL062
      ********************************************************************113843
     O***********MEMOS   E        87 76                                   CCB002
     O***********              NAMR      13P                              CCB002
     O***********                                                         CCB002
     O*****ZEROISE MEMO DETAIL RECORD                                     CCB002
     O***********                                                         CCB002
     O***********        E        88 76                                   CCB002
     O***********                         RECI       1                    CCB002
     O***********                         LDBLN     16                    CCB002
     O***********                         CLBLN     31                    CCB002
     O***********                         ZZ005     36                    CCB002
     O***********                         INLU      38P                   CCB002
     O***********                         BNLU      40P                   CCB002
     O*                                                                   S01408
     O/COPY WNCPYSRC,GL3271OOP1                                           S01408
** WEOF EMPTY FILE MESSAGE
File is empty                                                          ***
** STAMP - Dummy timestamp                                                                    CPK015
0001-01-01-00.00.00.000000                                                                    CPK015
** CPY@ OBJECT COPYRIGHT                                               ***
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,GL3271X001
** ZMDY
000031059090120151181212243273304334365
** ZYDY
0366073110961461
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** NUM
0123456789
** FREQ - ARRAY FOR DEBIT CAPITALISATION FREQUENCY VALIDATION
ABDFLMQRSTWXYZ
**   CHECKD - CHECK DIGIT                                                                     CGL062
48159260370
     X/COPY WNCPYSRC,GL3271X002
