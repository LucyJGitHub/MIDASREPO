     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Account master details report')               *
      *****************************************************************
      *                                                               *
      *  Midas - Retail Module                                        *
      *                                                               *
      *  GL3572 - ACCOUNT MASTER DETAILS REPORT                       *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD034725           Date 27Jul16               *
      *  Prev Amend No. MD031966           Date 27Jul15               *
      *                 LLN022A            Date 03Jun15               *
      *                 CRE101             Date 02Sep14               *
      *                 CRE095             Date 25Apr14               *
      *                 CGL165             Date 17Feb15               *
      *                 MD027647           Date 20Jun14               *
      *                 CRE090             Date 14Feb14               *
      *                 AR1095876          Date 30Sep13               *
      *                 AR936766A          Date 27Mar12               *
      *                 CRE073             Date 06Dec10               *
      *                 AR762809           Date 26May11               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CRE015             Date 18Dec09               *
      *                 CAP205             Date 19Feb10               *
      *                 BUG26720           Date 09Nov09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG18520           Date 06May08               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 244099             Date 19Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 BUG8210            Date 02Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 LLN022             Date 24Jan05               *
      *                 CSD023             Date 18Nov04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL018             Date 30Sep02               *
      *                 208221             Date 11Dec02               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 21Dec99               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 174063             Date 29Mar00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CAP035             Date 11Nov99               *
      *                 CPB001             DATE 18Aug99               *
      *                 170996             Date 18Nov99               *
      *                 CFT004             Date 19Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             DATE 15MAR99               *
      *                 S01408             DATE 28Jan99               *
      *                 CEU013             DATE 08APR98               *
      *                 CTI001             DATE 30SEP97               *
      *                 CGL004             DATE 28OCT97               *
      *                 CRE001             Date 20Feb97               *
      *                 S01408             DATE 21FEB96               *
      *                 092519             DATE 24AUG95               *
      *                 S01408             DATE 05SEP95               *
      *                 S01408             DATE 25MAY95               *
      *                 084517             DATE 18APR95               *
      *                 084499             DATE 18APR95               *
      *                 S01408             DATE 11APR95               *
      *                 S01486             DATE 07NOV94               *
      *                 076546             DATE 30SEP94               *
      *                 S01408             DATE 22AUG94               *
      *                 S01413 *CREATE     DATE 13APR93               *
      *                 xnnnnn             DATE nnxxxnn               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD034725 - Single CCY + Branch available in BFM and TI Plus  *
      *  MD031966 - GL3572P1 does not produce expected accounts       *
      *  LLN022A - BOE Upgrade to MidasPlus - incorporate code from   *
      *            /COPY members and add switchability.               *
      *  CRE101 - Interim Interest Statemetns on a Frequency          *
      *           Addition of hook CRE101_069                         *
      *           Addition of hook CRE101_070                         *
      *           Addition of hook CRE101_071                         *
      *  CRE095 - Rate fixing for RE Accounts                         *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD027647 - Delay cap days reported is incorrect.             *
      *  CRE090 - Delay Capitalisation of Interest                    *
      *  AR1095876- ABC - Forward Days 1 should = DNWD-1, not just    *
      *             RUND (Child: AR1095877) (Recompile)               *
      *  AR936766A - Overlapping of Effective Date and Portfolio      *
      *              Reference field in GL3572P1 report (Reopen)      *
      *              (Recompile)                                      *
      *  CRE073 - Interest Rate Rounding                              *
      *  AR762809 - Effective Date incorrect in the report            *
      *  CRE075 - Effective Date for Retail Accounts                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CRE015 - Retail Term and Notice Accounts                     *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  BUG26720 - COB error on GLC3571 00001                        *
      *  BUG18520 - Do not chain to ACCNTBXC if account is closed     *
      *  244099 - Report problem. Alternative A/C To Post Interest,   *
      *           blank on CREDIT side.                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  BUG8210 - GLC3571 failed due to DBERR in ACCNTBXC (empty)    *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  LLN022 - BOE Upgrade to MidasPlus.                           *
      *  CSD023 - Automatic Customer Account Closure                  *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines                                        *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL018 - Risk Weighted Assets.                               *
      *  208221 - Default Margin from Rate/Spread changes             *
      *  CDE002 - Revenue Analysis - New fields added to report.      *
      *  174063 - Data structure added for field ATCHAM in order for  *
      *           the correct number of decimal places to be applied  *
      *           to the field depending on currency.                 *
      *  CAP035 - Account maintenance API; recompiled over changed    *
      *           ACCBR.                                              *
      *  CPB001 - 'Private Banking' Module                            *
     F*  170996 - Overflow problems when printing retail accounts     *
      *  CFT004 - Straight Through Processing Phase 2                 *
      *           International Bank Account Numbers (IBAN)           *
      *  CSD005 - Switchable feature- if account narrative feature    *  *
      *           is active the current account description shall be  *  *
      *           replaced with the account narrative. Unless the Mida*  *
      *           retail module is present then it willnot be replaced*  *
     F*  S01408 - Correction of blank hook names:                     *
     F*         - Addition of core hook GL3572FTC1                    *
     F*         - Addition of core hook GL3572CTC1                    *
      *  CEU013 - EMU Account Postings Narrative                      *
      *  CTI001 - Midas / Trade Innovation Interface Phase 1          *
      *  CGL004 - Addition of Midas-Fontis Interface Account Details  *
      *  CRE001 - Overdraft Interest Calculation:                     *
      *           Read and output to report the related additional    *
      *           overdraft rate and overdraft line fields.  Also     *
      *           applied fix 109011 to move the read of SDMMODPD.    *
      *  S01408 - Core hook GL3572CCP6 added.                         *
      *  092519 - Print out portfolio reference correctly             *
      *  S01408 - Core hook GL3572CCP3 added.                         *
      *           Core hook GL3572CCP4 added.                         *
      *           Core hook GL3572CCP5 added.                         *
      *  S01408 - Core hook GL3572IIPG added.                         *
      *           Core hook GL3572EEPG added.                         *
      *           Core hook GL3572CCP1 added.                         *
      *           Core hook GL3572CCP2 added.                         *
      *           Core hook GL3572CPD1 added.                         *
      *           Core hook GL3572CLH2 added.                         *
      *  084499 - Read TABTBRE only if retail exists.                 *
      *  084517 - Initialise output file GL3572AU fields if primary   *
      *           file SADET empty.                                   *
      *  S01408 - Core hook GL3572CLH1 added.                         *
      *           Core hook GL3572CPLH added.                         *
      *  S01486 - Portfolio Management Upgrade to Release 10.         *
      *  076546 - Report profit centre                                *
      *  S01408 - Core hook GL3572FFPG added.                         *
      *           Core hook GL3572CPDR added.                         *
      *           Core hook GL3572CCPG added.                         *
      *  S01413 - Retail 3 Incorporation                              *
      *                                                               *
     F*****************************************************************
     F***SADET***IP**F     424 18AI     2 DISK                            S01486
     F***SADET***IP**F     429 18AI     2 DISK                      S01486092519
     F***SADET   IP  F     437 18AI     2 DISK                      092519CTI001
     F***SADET***IP**F  447 18AI     2 DISK                         CTI001CEU013
     F***SADET***IP  F     448 18AI     2 DISK                     CEU013 CFT004
     F***SADET***IP  F     485 18AI     2 DISK                     CFT004 CAP035
     F***SADET***IP  F     552 18AI     2 DISK                                         CAP035 CGL029
     F***SADET** IP  F     573 18AI     2 DISK                                         CGL029 CLE025
     F***SADET** IP  F     607 18AI     2 DISK                                         CLE025 CER047
     F***SADET** IP  F     648 18AI     2 DISK                                         CER047 CRE075
     F***SADET** IP  F     651 18AI     2 DISK                                         CRE075 CRE073
     FSADET   IP  F     687 18AI     2 DISK                                                   CRE073
     FSDCURRL0IF  E           K        DISK
     F/COPY WNCPYSRC,GL3572F001
     F***REIAC** IF  F     143 18AI     2 DISK                                                CGL029
     FREIAC   IF  F     218 24AI     2 DISK                                                   CGL029
     F***REACR** IF  F     172 18AI     2 DISK                                                CGL029
     FREACR   IF  F     191 24AI     2 DISK                                                   CGL029
     FACCNTBXCIF  E           K        DISK
     F/COPY WNCPYSRC,GL3572FTC1                                           S01408
     FGLFONAL0IF  E           K        DISK                               CGL004
     F*                                                                   S01408
     F/COPY WNCPYSRC,GL3572FFPG                                           S01408
      *                                                                                      LLN022A
     FBYACCTY0IF  E           K        DISK                                                  LLN022A
      ** Account Details Extention File - retrieval                                          LLN022A
      *                                                                                      LLN022A
     FREACX1PDIF  E           K        DISK                                                   CER001
     F*                                                                   S01408
     FRECCY   IF  E           K        DISK                               CDE002
      *                                                                   CDE002
      *-------------------------------------------------------------------
     FTABTBRE IF  E                    DISK
      *                                Retail ICD
     FRECOM   IF  E           K        DISK
      *                                Retail commission
     F*SDMMODPDIF E                    DISK
      *                                Modules
     FGLARWAL0IF  E           K        DISK                                                   CGL018
      * RTW: Account Risk Weigted Assets Code/Set                                             CGL018
      *                                                                                       CGL018
     FGLACNTL3IF  E           K        DISK                                                   CAP205
      ** RTV: Midas GL Account Extension File                                                 CAP205
      *                                                                                       CAP205
     FREPRPNL2IF  E           K        DISK                                                   CRE015
      ** Midas RE T&N Accounts - Periods and Penalties                                        CRE015
     F/COPY OFCPYSRCZ,CRE101_069                                                              CRE101
     FGL3572AUO   E                    PRINTER      KINFDS SPOOLU
      *                                Audit report
     FGL3572P1O   E                    PRINTER      KINFDS SPOOL      UC
      *                                Account details report
     F/COPY WNCPYSRC,GL3572F002
     F*****************************************************************
     F*
     F*  F U N C T I O N   O F   I N D I C A T O R S
     F*
     F*       01      ACCOUNT MASTER DETAIL.
     F*       02      ACCOUNT MASTER TRAILER RECORD.
     F*       03      ACCOUNT MASTER CATCHALL.
     F*       04      ACCOUNT MASTER CLOSED ACCOUNT
     F*       06      REIAC - LIVE DETAIL OR CLOSED DETAIL RECORD
     F*       07      REACR - LIVE DETAIL OR CLOSED DETAIL RECORD
     F*
     F*       17      PRINT EFFECTIVE DATE                                                    CRE075
     F*       18      CHAIN TO GL ACCOUNT EXTENSION FILE                                      CAP205
     F*       19      RETAIL ACCOUNT NO. PRESENT
     F*       20      ACCOUNT NUMBER IS 0.
     F*       21      PRINT DETAIL
     F*       22      ACCNT CONTROLS DISAGREE - NO. OF A/CS OPENED
     F*       23                              - NO. OF A/CS AMENDED
     F*       24                              - NO. OF A/CS CLOSED
     F*       25                              - NO. OF CLOSE TRAN.FAILURES
     F*       26                              - NO. OF A/CS REOPENED
     F*-------------------------------------------------------------------
     F*       28      WITHHOLDING TAX MODULE IS NOT PRESENT
     F*       29      Portfolio module on, print portfolio reference      S01486
     F*       30      = U3, for external O specs
     F*       31      = U1, for external O specs
     F*-------------------------------------------------------------------
     F*       32      CLOSED DATE IS 0.
     F*       33      OVERDRAFT SECURED
     F*       34      PRINT BRT CATEGORY
     F*       35      Overdraft Interest Calculation Feature Indicator    CRE001
     F*       36      FONTIS ACCOUNT DETAILS PRESENT                      CGL004
     F*
     F*       37      Account Narrative switchable feature                CSD005
      *       38      Rvenue Analysis switchable feature (CDE002)         CDE002
     F*       39      MICROFICHE FREQUENCY BLANK
     F*       40      NON-FIRST CYCLE.
     F*       41      CGL018 IS ON                                                            CGL018
     F*       42      REFER ALL DEBITS - YES.
     F*       43      REFER CREDIT - YES.
     F*       44      BLOCK ALL DEBITS - YES.
     F*       45      PRINT ADDRESS - YES.
     F*       46      BLOCK ALL CREDITS - YES.
     F*       47      INACTIVE - YES.
     F*       48      PRINT TRANSACTION ADVICE - YES.
     F*       49      PRINT RATE CHANGE ADVICE - YES.
     F*       50      CHANGE IN ACCOUNT CURRENCY CODE.
     F*       51      SPREAD +VE (DEBIT)
     F*       52      ADDITIONAL OVERDRAFT RATE -VE                       CRE001
     F*       53      SPREAD +VE (CREDIT)
     F*       54      ADDITIONAL OVERDRAFT RATE +VE                       CRE001
     F*       55      MAN. ADJ. +VE (DEBIT)
     F*       56      PROCESSING ACCOUNTS AFTER UPDATE FIELD NULL
     F*       57      MAN. ADJ. +VE (CREDIT)
     F*       58      MAN. ADJ. = ZERO (CREDIT)
     F*       59      ACCOUNT CLOSED TODAY
     F*       60      DATE COMPARISON
     F*       61      RETAIL A/C NOS SUPPORTED ON ICDR 3
     F*       62      ACCOUNT BALANCE CHECK (CAP205 IS ON)                                    CAP205
     F*       63      LAST CR INC/EXP AMOUNT IS DR
     F*       64      CEU013 ENHANCEMENT SWITCHED ON                      CEU013
     F*       65      DEBIT GENERATED ADJUSTMENTS TO DEBIT INTEREST
     F*       66      CREDTIT GENERATED ADJUSTMENTS TO DEBIT INTEREST
     F*       67      DEBIT GENERATED ADJUSTMENTS TO CREDIT INTEREST
     F*       68      CREDTIT GENERATED ADJUSTMENTS TO CREDIT INTEREST
     F*       69      Midas/TI Interface is on                            CTI001
     F*       70      CURRENCY HAS 0 DECIMAL PLACES.
     F*       71      CURRENCY HAS 1 DECIMAL PLACE.
     F*       72      CURRENCY HAS 2 DECIMAL PLACES.
     F*       73      CURRENCY HAS 3 DECIMAL PLACES.
     F*       74      STATEMENT CHARGES PROCESSED
     F*       75      PRINTER FILE GL0572P1 IS OPEN.
     F*       76      WHEN = 0, FILE OPENED, NO DETAILS TO REPORT.
     F*       77      FIXED ACCOUNT CHARGE PROCESSED
     F*       78      SINGLE BRANCH REQUESTED WHEN MBIN = Y
     F*       79      RECORD OUTPUT AT LEAST ONCE
     F*       80      CHANGE TYPE I - INSERT
     F*       81      CHANGE TYPE A - AMEND.
     F*       82      CHANGE TYPE C - CLOSE.
     F*       83      CHANGE TYPE R - RE-OPEN.
     F*       84      BANKRUPT - YES
     F*       85      BAD DEBT - YES
     F*       86      ACCRUED AMOUNT NEGATIVE
     F*       87      AT LEAST ONE REPORT - NO MORE OPENED
     F*       88      MBIN = Y
     F*       89      NO REPORT PRODUCED
     F*       90-99   USED IN SUBROUTINES.
     F*
     F*          U1   AMENDMENTS RUN.
     F*          U3   INTERIM REPORT.
     F*          U7   DATABASE ERROR
     F*          U8   FILE CONTROLS OUT OF BALANCE
     F*
     F*****************************************************************
     E                    CPY@    1   1 80
     E                    ZYDY    4   4  4 0             ZDATE SR. ARRAY
     E                    ZMDY   13  13  3 0             ZDATE SR. ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CCYA      150  3
     E                    DPA       150  1 0
      *-------------------------------------------------------------------
     E                    ZA1        16  1               ZALIGN/ZEDIT AR.
     E                    ZA2        16  1               ZALIGN/ZEDIT AR.
     E                    XRWA       90  5               Work Array                           CGL018
     E*                                                                                       208221
     E/COPY ZSRSRC,ZSEDITZ1                                                                   208221
     E*                                                                   S01408
     E/COPY WNCPYSRC,GL3572EEPG                                           S01408
     E*                                                                   S01408
      *-------------------------------------------------------------------
     E**
     I*    ACCOUNT MASTER DETAIL RECORD
     I**
     ISADET   NS  01   1 CD
     I       OR   04   1 CC
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCY
     I**********                             11  140ACOD                                      CGL029
     I                                       11  140ACODQQ                                    CGL029
     I                                       15  160ACSQ
     I                                       23  25 BRCA  L1
     I                                       26  26 ATYP
     I                                       27  27 STYP
     I                                       28  28 MFFQ            39
     I                                       29  29 ACST
     I                                    P  30  320DACO
     I                                    P  33  350DACC
     I                                       36  55 ANAM
     I                                    P  56  630LDBL
     I                                    P  64  710CLBL
     I                                       72  72 STFQ
     I                                    P  78  800NSTD
     I                                    P  81  820LSTP
     I                                    P  83  900CFSB
     I                                    P  91  930LMVD
     I                                      118 118 GLBT
     I                                      119 126 ADF1
     I                                      127 130 PRFC                  076546
     I                                      174 175 ADF2
     I                                      190 1990ACNO
     I                                      200 200 RETB
     I                                      201 201 ODSC
     I                                    P 202 2070ODLN
     I                                    P 208 2100ODED
     I                                    P 211 2120DIOD
     I                                      213 2150FACT
     I                                      216 2170FCNO
     I                                      218 219 EFAC
     I                                    P 220 2270HELD
     I                                    P 228 2330MINB
     I                                    P 234 2360LACD
     I                                      242 2430DRIB
     I                                    P 244 2497DRIS
     I                                    P 250 2520DRCD
     I                                      253 2530DRIC
     I                                      254 254 DRIF
     I                                      255 2560DRDY
     I                                    P 257 2590NDID
     I                                    P 260 2620LDID
     I                                    P 263 2690LDIA
     I                                    P 271 2730LPAR
     I                                    P 274 2800DIIE
     I                                      318 3190CRIB
     I                                    P 320 3257CRIS
     I                                    P 326 3280CRCD
     I                                      329 3290CRIC
     I                                      330 330 CRIF
     I                                      331 3320CRDY
     I                                    P 333 3350NCID
     I                                    P 336 3380LCID
     I                                    P 339 3450LCIA
     I                                    P 347 3490LPAP
     I                                    P 350 3560CIIE
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 401 BRTCA
     I                                    P 404 4050ENOC
     I                                    P 406 4070EPNO
     I                                    P 408 4150ECFB
     I***********                           425 428 PTFR            S01486092519
     I***********                           429 429 HLEX            S01486092519
     I                                      433 436 PTFR                  092519
     I                                      437 437 HLEX                  092519
     I                                      438 438 A5TIAC                CTI001
     I                                      439 444 A5TIAN                CTI001
     I                                      445 447 A5TIAS                CTI001
     I                                      448 448 EUSB                  CEU013
     I                                      449 482 IBAN                  CFT004
     I                                      554 5630ACOD                                      CGL029
     I**********                            574 5790FCCU                               CLE025 CSD027
     I                                      574 579 FCCU                                      CSD027
     I                                    P 649 6510ACEFDT                                    CRE075
     I                                    P 652 6577DCSP                                      CRE073
     I                                      658 658 DCSG                                      CRE073
     I                                      659 665 DRMT                                      CRE073
     I                                      666 669 DRFD                                      CRE073
     I                                    P 670 6757CCSP                                      CRE073
     I                                      676 676 CCSG                                      CRE073
     I                                      677 683 CRMT                                      CRE073
     I                                      684 687 CRFD                                      CRE073
     I/COPY WNCPYSRC,GL3572I003
     I**
     I**
     I*    ACCOUNT MASTER TRAILER RECORD
     I**
     I        NS  02   1 CT
     I                                        1   1 RECI
     I                                    P  23  250NORE
     I                                    P  29  310NOOA
     I                                    P  32  340NINU
     I                                    P  35  370NOAM
     I                                    P  38  400NOCL
     I                                    P  41  430NOAU
     I                                    P  44  460NINP
     I                                    P  47  490NORD
     I                                    P  50  520NOCF
     I                                    P  53  550NAMP
     I                                    P  56  580NAUP
     I**
     I*    CATCHALL FOR DELETED RECORDS
     I**
     I        NS  03
     I                                        1   1 RECI
     I**
     I*    RETAIL INTEREST AND CHARGES FILE
     I**
     IREIAC   NS  06   1 CD
     I       OR        1 CC
     I                                       17  180DICT
     I                                       19  230DCST
     I**********                             24  38 DACP                                      CGL029
     I                                       24  38 DACPQQ                                    CGL029
     I                                       39  400DICP
     I                                       41  420CICT
     I                                       43  470CCST
     I**********                             48  62 CACP                                      CGL029
     I                                       48  62 CACPQQ                                    CGL029
     I                                       63  640CICP
     I                                       65  660CHCT
     I                                       67  710CHST
     I**********                             72  86 CHAC                                      CGL029
     I                                       72  86 CHACQQ                                    CGL029
     I                                       87  87 PTRA
     I                                       88  88 PRCA
     I                                    P  89  950NRCA
     I                                    P  96 1020RECA
     I                                    P 103 1100MCBC
     I                                    P 131 1340TCHO
     I                                      135 137 CRBR
     I                                      138 140 DRBR
     I                                      141 143 CHBR
     I                                      156 176 DACP                                      CGL029
     I                                      177 197 CACP                                      CGL029
     I**********                            198 218 CACP                               CGL029 244099
     I                                      198 218 CHAC                                      244099
     I**
     I*    CATCHALL FOR DELETED RECORDS
     I**
     I        NS
     I**
     I*    RETAIL ACCRUED INTEREST TO DATE RECORD
     I**
     IREACR   NS  07   1 CD
     I       OR        1 CC
     I                                    P  41  470DAIC
     I                                    P  48  540MADI
     I                                    P  55  610GADI
     I                                    P  62  680CAIC
     I                                    P  69  750MACI
     I                                    P  76  820GACI
     I**
     I*    CATCHALL FOR DELETED RECORDS
     I**
     I        NS
     I**
     I/COPY WNCPYSRC,GL3572I001
     I**
     I**   DATA STRUCTURE TO CHAIN TO RETAIL FILES
     I**
     I            DS
     I**********                              1  18 REKEY                                     CGL029
     I                                        1  24 REKEY                                     CGL029
     I**********                              1   60CNUM                                      CSD027
     I                                        1   6 CNUM                                      CSD027
     I                                        7   9 CCY
     I**********                             10  130ACOD                                      CGL029
     I**********                             14  150ACSQ                                      CGL029
     I**********                             16  18 BRCA                                      CGL029
     I**********                             16  18 BRCA2                                     CGL029
     I                                       10  190ACOD                                      CGL029
     I                                       20  210ACSQ                                      CGL029
     I                                       22  24 BRCA                                      CGL029
     I                                       22  24 BRCA2                                     CGL029
     I**                                                                  CGL004
     I**   DATA STRUCTURE TO CHAIN TO FONTIS DETAILS                      CGL004
     I**                                                                  CGL004
     I            DS                                                      CGL004
     I**********                              1  18 KACCNO                             CGL004 CGL029
     I                                        1  24 KACCNO                                    CGL029
     I                                        1   3 KBRCA                 CGL004
     I**********                              4   90KCNUM                              CGL004 CSD027
     I                                        4   9 KCNUM                                     CSD027
     I                                       10  12 KCCY                  CGL004
     I**********                             13  160KACOD                              CGL004 CGL029
     I**********                             17  180KACSQ                              CGL004 CGL029
     I                                       13  220KACOD                                     CGL029
     I                                       23  240KACSQ                                     CGL029
      *
      ** Data Structure to chain to RE ICD by Ccy Details                 CDE002
      *                                                                   CDE002
     I            DS                                                      CDE002
     I                                        1  12 KRECCY                CDE002
     I                                        9  11 K#CCY                 CDE002
     I                                       12  12 K#D                   CDE002
      *                                                                   CDE002
     I*    LOCAL DATA AREA
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     ILDA        UDS                            256
     I                                        1   8 LPROC
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I**
      *-------------------------------------------------------------------
      * Redefine fields for different edit words or multiple output
      *
     I            DS
     I                                        1  150LDBL
     I                                        1  150LDBL0
     I                                        1  150LDBL1
     I                                        1  150LDBL2
     I                                        1  150LDBL3
      *
     I            DS
     I                                        1  150CLBL
     I                                        1  150CLBL0
     I                                        1  150CLBL1
     I                                        1  150CLBL2
     I                                        1  150CLBL3
      *
     I            DS
     I                                        1  150CFSB
     I                                        1  150CFSB0
     I                                        1  150CFSB1
     I                                        1  150CFSB2
     I                                        1  150CFSB3
      *
     I            DS
     I                                        1  150ECFB
     I                                        1  150ECFB0
     I                                        1  150ECFB1
     I                                        1  150ECFB2
     I                                        1  150ECFB3
      *
     I            DS
     I                                        1  130DIIE
     I                                        1  130DIIE0
     I                                        1  130DIIE1
     I                                        1  130DIIE2
     I                                        1  130DIIE3
      *
     I            DS
     I                                        1  130CIIE
     I                                        1  130CIIE0
     I                                        1  130CIIE1
     I                                        1  130CIIE2
     I                                        1  130CIIE3
      *
     I            DS
     I                                        1  130DAIC0
     I                                        1  130DAIC00
     I                                        1  130DAIC01
     I                                        1  130DAIC02
     I                                        1  130DAIC03
      *
     I            DS
     I                                        1  130CAIC0
     I                                        1  130CAIC00
     I                                        1  130CAIC01
     I                                        1  130CAIC02
     I                                        1  130CAIC03
      *
     I            DS
     I                                        1  130MADI
     I                                        1  130MADI0
     I                                        1  130MADI1
     I                                        1  130MADI2
     I                                        1  130MADI3
      *
     I            DS
     I                                        1  130MACI
     I                                        1  130MACI0
     I                                        1  130MACI1
     I                                        1  130MACI2
     I                                        1  130MACI3
      *
     I            DS
     I                                        1  130GADI
     I                                        1  130GADI0
     I                                        1  130GADI1
     I                                        1  130GADI2
     I                                        1  130GADI3
      *
     I            DS
     I                                        1  130GACI
     I                                        1  130GACI0
     I                                        1  130GACI1
     I                                        1  130GACI2
     I                                        1  130GACI3
      *
     I            DS
     I                                        1  130CALC
     I                                        1  130CALC0
     I                                        1  130CALC1
     I                                        1  130CALC2
     I                                        1  130CALC3
      *
     I            DS
     I                                        1  140HELDA
     I                                        1  140HELDA0
     I                                        1  140HELDA1
     I                                        1  140HELDA2
     I                                        1  140HELDA3
      *
     I            DS
     I                                        1   50NOCL
     I                                        1   50NOCL1
      *
     I            DS
     I                                        1   50NOCF
     I                                        1   50NOCF1
      *
     I            DS
     I                                        1   50NORD
     I                                        1   50NORD1
      *
     I            DS
     I                                        1   50NOOA
     I                                        1   50NOOA1
      *
     I            DS
     I                                        1   50NOAU
     I                                        1   50NOAU1
      *
     I            DS
     I                                        1   50NAUP
     I                                        1   50NAUP1
      *
     I            DS
     I                                        1   50CINUAF
     I                                        1   50CINUA1
     I                                        1   50CINUA2
     I                                        1   50CINUA3
      *
     I            DS
     I                                        1   50COCLAF
     I                                        1   50COCLA1
     I                                        1   50COCLA2
     I                                        1   50COCLA3
      *
     I            DS
     I                                        1   50COCFAF
     I                                        1   50COCFA1
     I                                        1   50COCFA2
     I                                        1   50COCFA3
      *                                                                   174063
     I**********  DS                                                                 174063 BUG26720
     I**********                              1   70ATCHAM                           174063 BUG26720
     I**********                              1   70ATCHA0                           174063 BUG26720
     I**********                              1   70ATCHA1                           174063 BUG26720
     I**********                              1   70ATCHA2                           174063 BUG26720
     I**********                              1   70ATCHA3                           174063 BUG26720
     I*                                                                                       208221
     I/COPY ZSRSRC,ZSEDITZ2                                                                   208221
     I*
     I**   SPOOL FILE INFORMATION DATA STRUCTURE
     I**
     I            DS
     I                                        1  42 SPLFA
     I                                        1   8 SFILP
     I                                        9  18 JBNMP
     I                                       19  28 USERP
     I                                       29  340JBNOP
     I                                       35  390SPLNO
     I                                       40  42 BRCHP
     I**
     I**   PROGRAM STATUS DATA STRUCTURE
     I**
     IPSDS       SDS
     I                                     *PROGRAM #PGM
     I                                      244 253 JOBNM
     I                                      254 263 USRID
     I                                      264 2690JOBNO
     I**
     I**   FILE INFORMATION DATA STRUCTURE
     I**
     ISPOOLU      DS
     I                                       83  90 SFILEU
     I                                    B 123 1240SFNUMU
     ISPOOL       DS
     I                                       83  90 SFILE
     I                                    B 123 1240SFNUM
     I                                    B 152 1530SFLIN                                     CRE015
     I                                    B 188 1890OFLLN                                     CRE015
     I                                    B 367 3680PRTLN                                     CRE015
     I/COPY WNCPYSRC,GL3572I002
     I**
     I** DATA AREA RUNDAT
     I**
     IRUNDT       DS
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I**
     ISDBANK    E DSSDBANKPD
     I**  EXTERNAL DS FOR BANK DETAILS
     I**
     ISDBRCH    E DSSDBRCHPD
     I**  EXTERNAL DS FOR BRANCH CODES
     I**
     ISDCUST    E DSSDCUSTPD
     I              QQDFAC                          DFACQQ                                    CGL029
     I** CLIENT DETAILS
     I**
     ISDMMOD    E DSSDMMODPD
     I** MIDAS MODULE DETAILS
     I**
     ISDRETL    E DSSDRETLPD
     I** RETAIL DETAILS
     I**
     ISDPORT    E DSSDPORTPD                                              S01486
      ** Portfolio Management ICD details                                 S01486
     I**                                                                  CEU013
     ISDCURR    E DSSDCURRPD                                              CEU013
     I** CURRENCY DETAILS                                                 CEU013
     I**                                                                  CEU013
     I*                                                                   CSD005
     ISCSARD    E DSSCSARDPD                                              CSD005
     I** MIDAS Switchable Features Accessed Via Access Program            CSD005
     I*                                                                   CSD005
     ISDACOD    E DSSDACODPD                                              CSD005
     I              QQACCD                          ACCDQQ                                    CGL029
      **  Account code details                                            CSD005
      *                                                                   CSD005
      *                                                                   S01486
     I*
     IDSFDY     E DSDSFDY
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     IDSSDY     E DSDSSDY
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
      *                                                                   CSD023
     IDSLDY     E DSDSLDY                                                 CSD023
      ** Third DS for access programs, very long data structure           CSD023
      *                                                                                       CGL018
      * Datastructure to output RWA details                                                   CGL018
      *                                                                                       CGL018
     IRWSECO      DS                          1   5                                           CGL018
     I                                        1   2 #RCODE                                    CGL018
     I I            ' '                       3   3 #BLANK                                    CGL018
     I                                        4   4 #RSET                                     CGL018
     I I            ','                       5   5 #COMMA                                    CGL018
      *                                                                                       CGL018
     I*
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL3572IIPG                                           S01408
     I            DS                                                                          CER001
     I                                        1  150WECOAM                                    CER001
     I                                        1  150WECOA0                                    CER001
     I                                        1  150WECOA1                                    CER001
     I                                        1  150WECOA2                                    CER001
     I                                        1  150WECOA3                                    CER001
      *                                                                                       CER001
      * Data structure for Correction Account                                                 CER001
      *                                                                                       CER001
     I            DS                                                                          CER001
     I                                        1  21 WECOAC                                    CER001
     I                                        1   6 WWCNUM                                    CER001
     I                                        7   9 WWCCY                                     CER001
     I                                       10  19 WWACOD                                    CER001
     I                                       20  21 WWACSQ                                    CER001
     I            DS                                                                          CER001
     I                                        1  24 W#COAC                                    CER001
     I                                        1   6 W#CNUM                                    CER001
     I                                        7   7 W#HF1                                     CER001
     I                                        8  10 W#CCY                                     CER001
     I                                       11  11 W#HF2                                     CER001
     I                                       12  21 W#ACOD                                    CER001
     I                                       22  22 W#HF3                                     CER001
     I                                       23  24 W#ACSQ                                    CER001
     I*                                                                   S01408
     I            DS                                                                          CER001
     I                                        1  10 C#ACOD                                    CER001
     I                                        1  100N#ACOD                                    CER001
     C/EJECT
      *-------------------------------------------------------------------
     C           *ENTRY    PLIST
     C                     PARM           SEQ     5         SEQUENCE NUM.
     C                     PARM           BRNCH   3         BRANCH OR ALL
     C*    DEFINE LDA
     C           *NAMVAR   DEFN           LDA
     C*
      ** Check if Switchable Feature ULX004 is installed                                      CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD                                               CER001
     C                     PARM '*VERIFY' POPTN                                               CER001
     C                     PARM 'ULX004'  PSARD                                               CER001
     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
      *                                                                                       CER001
     C           PRTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX004  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX004                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           PRTCD     IFNE *BLANK                                                        CER001
     C           PRTCD     ANDNE'*NRF   '                                                     CER001
     C                     SETON                     U7U8LR                                   CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVELPRTCD     DBKEY                                               CER001
     C                     MOVE '029'     DBASE                                               CER001
     C                     EXSR *PSSR                                                         CER001
     C                     GOTO END                                                           CER001
     C                     END                                                                CER001
      *                                                                                       CER001
      ** Check if Switchable Feature CAP205 is installed.                                     CAP205
      *                                                                                       CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   PRTCD                                               CAP205
     C                     PARM '*VERIFY' POPTN                                               CAP205
     C                     PARM 'CAP205'  PSARD                                               CAP205
     C           SCSARD    PARM SCSARD    DSSDY                                               CAP205
      *                                                                                       CAP205
     C           PRTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVE 'Y'       CAP205  1                                           CAP205
     C                     ELSE                                                               CAP205
     C                     MOVE 'N'       CAP205                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C           PRTCD     IFNE *BLANK                                                        CAP205
     C           PRTCD     ANDNE'*NRF   '                                                     CAP205
     C                     SETON                     U7U8LR                                   CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     MOVELPRTCD     DBKEY                                               CAP205
     C                     MOVE '062'     DBASE                                               CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     GOTO END                                                           CAP205
     C                     END                                                                CAP205
      *                                                                                       CAP205
     C*    PERFORM FIRST CYCLE OPERATIONS.
     C   40                GOTO START
     C                     MOVEACPY@      BIS@   80
     C*
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C*
     C                     SETOF                     89
     C           MBIN      IFEQ 'Y'
     C                     SETON                     88
     C                     END
     C                     MOVE ' '       BLK256256
     C                     MOVE BLK256    DBKEY
     C*
     C           *INU1     IFEQ '1'
     C                     MOVE 'GLC3571 'LPROC
     C                     END
     C*
     C           *INU3     IFEQ '1'
     C                     MOVE 'GLC3572 'LPROC
     C                     END
     C*
     C                     MOVEL' GL3572 'DBPGM
     C                     SETON                     40
     C**
     C*-------------------------------------------------------------------
     C*
     C                     MOVE '0'       *IN98
     C*
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     RUNN    70
     C*
     C* Use *IN30/31 instead of *INU3/U1 for external descriptions
     C*
     C                     MOVE *INU3     *IN30
     C                     MOVE *INU1     *IN31
      *                                                                   CRE001
      ** Access Midas Modules Details                                     CRE001
      *                                                                   CRE001
     C                     CALL 'AOMMODR0'                                CRE001
     C                     PARM '*MSG   ' @RTCD                           CRE001
     C                     PARM '*FIRST ' @OPTN                           CRE001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CRE001
      *                                                                   CRE001
     C           @RTCD     IFNE *BLANK                                    CRE001
     C                     SETON                     U7U8LR               CRE001
     C                     MOVEL'SDMMODPD'DBFILE                          CRE001
     C                     MOVEL@OPTN     DBKEY                           CRE001
     C                     MOVEL@OPTN     DBOPTN                          CRE001
     C                     MOVEL'002'     DBASE                           CRE001
     C                     EXSR *PSSR                                     CRE001
     C                     GOTO END                                       CRE001
     C                     ENDIF                                          CRE001
     C*
      *                                                                   CSD005
      *** Obtain switchable feature CSD005 status.                        CSD005
      *                                                                   CSD005
     C                     CALL 'AOSARDR0'                                CSD005
     C                     PARM *BLANKS   @RTCD   7                       CSD005
     C                     PARM '*VERIFY' @OPTN   7                       CSD005
     C                     PARM 'CSD005'  @SARD   6                       CSD005
     C           SCSARD    PARM SCSARD    DSFDY                           CSD005
      *                                                                   CSD005
     C                     SELEC                                          CSD005
     C           @RTCD     WHEQ *BLANK                                    CSD005
     C                     MOVE *ON       *IN37                           CSD005
     C           @RTCD     WHEQ '*NRF'                                    CSD005
     C                     MOVE *OFF      *IN37                           CSD005
     C                     OTHER                                          CSD005
     C           *LOCK     IN   LDA                                       CSD005
     C                     MOVEL'SCSARDPD'DBFILE            ************* CSD005
     C                     MOVEL'015'     DBASE             *DBERROR 015* CSD005
     C                     MOVEL@OPTN     DBKEY             ************* CSD005
     C                     SETON                     U7U8LR               CSD005
     C                     OUT  LDA                                       CSD005
     C                     EXSR *PSSR                                     CSD005
     C                     ENDSL                                          CSD005
     C/COPY WNCPYSRC,GL3572C028
      *                                                                   CSD005
     C* Get ICD55/Retail record
     C*
     C           BGRTBN    IFEQ 'Y'                                       084499
     C           BGIOAC    OREQ 'Y'                                       084499
     C           1         SETLLTABTBRE
     C                     READ TABTBRE                  99
     C           *IN99     IFEQ '1'
     C                     SETON                     U7LR  ** DB ERROR 95
     C                     MOVE 'TABLE'   DBFILE
     C                     MOVEL*BLANKS   DBKEY
     C                     Z-ADD95        DBASE
     C                     GOTO END
     C                     END
     C                     END                                            084499
     C*
     C***********STMC      IFEQ 'Y'                                       CRE001
     C           TSTMC     IFEQ 'Y'                                       CRE001
     C                     MOVE '1'       *IN74
     C                     END
     C***********FXAC      IFEQ 'Y'                                       CRE001
     C           FACH      IFEQ 'Y'                                       CRE001
     C                     MOVE '1'       *IN77
     C                     END
     C*
     C**
     C**   ACCESS BANK DETAILS
     C**
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C                     SETON                     U7U8LR
     C                     MOVEL'SDBANKPD'DBFILE
     C                     MOVEL@OPTN     DBKEY            ***************
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *
     C                     MOVEL'001'     DBASE            ***************
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C**
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON.
     C**
     C*****ACCESS MIDAS MODULE DETAILS                                    CRE001
     C***********                                                         CRE001
     C***********          CALL 'AOMMODR0'                                CRE001
     C***********          PARM '*MSG   ' @RTCD   7                       CRE001
     C***********          PARM '*FIRST ' @OPTN   7                       CRE001
     C***********SDMMOD    PARM SDMMOD    DSFDY                           CRE001
     C***********                                                         CRE001
     C***********@RTCD     IFNE *BLANK                                    CRE001
     C***********          SETON                     U7U8LR               CRE001
     C***********          MOVEL'SDMMODPD'DBFILE                          CRE001
     C***********          MOVEL@OPTN     DBKEY            ***************CRE001
     C***********          MOVEL@OPTN     DBOPTN  7        * DBERROR 002 *CRE001
     C***********          MOVEL'002'     DBASE            ***************CRE001
     C***********          EXSR *PSSR                                     CRE001
     C***********          GOTO END                                       CRE001
     C***********          END                                            CRE001
      *                                                                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C                     MOVE *ON       *IN29                           CPB001
     C                     ENDIF                                          CPB001
      *                                                                   S01486
      ** Determine if Portfolio Management Module is switched on.         S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C                     MOVE *ON       *IN29                           S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*FIRST ' @OPTN                           S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C*                                                                   S01486
     C           @RTCD     IFNE *BLANK                                    S01486
     C                     SETON                     U7U8LR               S01486
     C                     MOVEL'SDPORTPD'DBFILE                          S01486
     C                     MOVEL@OPTN     DBKEY            ***************S01486
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 012 *S01486
     C                     MOVEL'012'     DBASE            ***************S01486
     C                     EXSR *PSSR                                     S01486
     C                     GOTO END                                       S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C**
     C**   ACCESS RETAIL DETAILS, WHEN RETAIL MODULE EXISTS
     C**
     C           BGRTBN    IFEQ 'Y'
     C*
     C                     CALL 'AORETLR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C                     SETON                     U7U8LR
     C                     MOVEL'SDRETLPD'DBFILE
     C                     MOVEL@OPTN     DBKEY            ***************
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 003 *
     C                     MOVE '003'     DBASE            ***************
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C*
     C           BMRANR    COMP 'Y'                      61
     C*
     C                     END
     C*
     C*
     C* Idem for Withholding Tax
     C*
     C           BGNTST    IFEQ 'N'                        - B2
     C                     MOVE '1'       *IN28
     C                     END                             - E2
      *
      * If Midas/TI Interface is on then seton *IN69                      CTI001
      *                                                                   CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     MOVE *ON       *IN69                           CTI001
     C                     ELSE                                           CTI001
     C                     MOVE *OFF      *IN69                           CTI001
     C                     ENDIF                                          CTI001
     C/COPY WNCPYSRC,GL3572C025
      *                                                                   CTI001
     C**
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
     C**
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01383'  @SARD   6
     C           @RTCD     IFNE *BLANK
     C           @RTCD     ANDNE'*NRF   '
     C                     SETON                     U7U8LR
     C                     MOVEL'SCSARDPD'DBFILE           ***************
     C                     MOVEL@RTCD     DBKEY            * DBERROR 008 *
     C                     MOVE '008'     DBASE            ***************
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C           @RTCD     IFEQ *BLANK
     C                     MOVEL'1'       *IN34
     C                     END
     C/COPY WNCPYSRC,GL3572C023
      *
      ** Check if SAR CRE001 is set on                                    CRE001
      *                                                                   CRE001
     C                     MOVE 'N'       CRE001  1                       CRE001
     C                     CALL 'AOSARDR0'                                CRE001
     C                     PARM *BLANKS   @RTCD   7                       CRE001
     C                     PARM '*VERIFY' @OPTN   7                       CRE001
     C                     PARM 'CRE001'  @SARD   6                       CRE001
      *                                                                   CRE001
     C           @RTCD     IFNE *BLANKS                                   CRE001
     C           @RTCD     ANDNE'*NRF   '                                 CRE001
     C                     SETON                     U7U8LR               CRE001
     C                     MOVEL'CRE001'  DBKEY            ***************CRE001
     C                     MOVE 'SCSARDPD'DBFILE           * DBERROR 009 *CRE001
     C                     Z-ADD009       DBASE            ***************CRE001
     C                     EXSR *PSSR                                     CRE001
     C                     GOTO END                                       CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C           @RTCD     IFEQ *BLANKS                                   CRE001
     C                     MOVE 'Y'       CRE001                          CRE001
     C                     MOVE '1'       *IN35                           CRE001
     C                     END                                            CRE001
      *                                                                   CGL004
      *  Access SAR Details File to determine if Midas-Fontis             CGL004
      *  Interface is active.                                             CGL004
      *                                                                   CGL004
     C                     CALL 'AOSARDR0'                                CGL004
     C                     PARM '       ' @RTCD                           CGL004
     C                     PARM '*VERIFY' @OPTN                           CGL004
     C                     PARM 'CGL004'  @SARD   6                       CGL004
      *                                                                   CGL004
     C           @RTCD     IFNE *BLANK                                    CGL004
     C           @RTCD     ANDNE'*NRF   '                                 CGL004
     C                     SETON                     U7U8LR               CGL004
     C                     MOVEL'SCSARDPD'DBFILE           ***************CGL004
     C                     MOVEL@RTCD     DBKEY            * DBERROR 010 *CGL004
     C                     MOVE '010'     DBASE            ***************CGL004
     C                     EXSR *PSSR                                     CGL004
     C                     GOTO END                                       CGL004
     C                     ENDIF                                          CGL004
      *                                                                   CGL004
     C           @RTCD     IFEQ *BLANK                                    CGL004
     C                     MOVE 'Y'       CGL004  1                       CGL004
     C                     ENDIF                                          CGL004
     C*                                                                   CEU013
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  WSARD   6                       CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     ENDIF                                          CEU013
      *                                                                   CFT004
      **  Access SAR details file to see if CFT004 is installed.          CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM '*VERIFY' POPTN   7                       CFT004
     C                     PARM 'CFT004'  PSARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSSDY                           CFT004
      *                                                                   CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     MOVE '1'       *IN05                           CFT004
     C                     ELSE                                           CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C                     ENDIF                                          CFT004
     C*                                                                   CEU013
      **  Access SAR details file to see if CDE002 is installed.          CDE002
      *                                                                   CDE002
     C                     CALL 'AOSARDR0'                                CDE002
     C                     PARM *BLANKS   PRTCD                           CDE002
     C                     PARM '*VERIFY' POPTN                           CDE002
     C                     PARM 'CDE002'  PSARD                           CDE002
     C           SCSARD    PARM SCSARD    DSSDY                           CDE002
      *                                                                   CDE002
     C           PRTCD     IFEQ *BLANKS                                   CDE002
     C                     MOVE 'Y'       CDE002  1                       CDE002
     C                     MOVE *ON       *IN38                           CDE002
     C                     ELSE                                           CDE002
     C                     MOVE 'N'       CDE002                          CDE002
     C                     ENDIF                                          CDE002
     C*                                                                   CDE002
      *
      ***  Determine if switchable feature CGL018 is activated                                CGL018
      *                                                                                       CGL018
     C                     CALL 'AOSARDR0'                                                    CGL018
     C                     PARM *BLANKS   PRTCD   7                                           CGL018
     C                     PARM '*VERIFY' POPTN   7                                           CGL018
     C                     PARM 'CGL018'  PSARD   6                                           CGL018
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL018
      *                                                                                       CGL018
     C           PRTCD     IFEQ *BLANK                                                        CGL018
     C                     MOVE 'Y'       CGL018  1                                           CGL018
     C                     SETON                     41                                       CGL018
     C                     ELSE                                                               CGL018
     C                     MOVE 'N'       CGL018                                              CGL018
     C                     SETOF                     41                                       CGL018
     C                     ENDIF                                                              CGL018
      *                                                                                       CLE025
      ** Check if enhancement CLE025 (Credit Lines) is on                                     CLE025
      *                                                                                       CLE025
     C                     CALL 'AOSARDR0'                                                    CLE025
     C                     PARM *BLANKS   PRTCD                                               CLE025
     C                     PARM '*VERIFY' POPTN                                               CLE025
     C                     PARM 'CLE025'  PSARD                                               CLE025
     C           SCSARD    PARM SCSARD    DSSDY                                               CLE025
      *                                                                                       CLE025
     C           PRTCD     IFNE *BLANKS                                                       CLE025
     C           PRTCD     ANDNE'*NRF   '                                                     CLE025
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE025
     C                     MOVEL'CLE025'  DBKEY                                               CLE025
     C                     MOVEL'017'     DBASE                                               CLE025
     C                     MOVE *ON       *INU7                                               CLE025
     C                     MOVE *ON       *INU8                                               CLE025
     C                     MOVE *ON       *INLR                                               CLE025
     C                     EXSR *PSSR                                                         CLE025
     C                     GOTO END                                                           CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C           PRTCD     IFEQ *BLANKS                                                       CLE025
     C                     MOVE 'Y'       CLE025  1                                           CLE025
     C                     MOVE *ON       *IN27                                               CLE025
     C                     ELSE                                                               CLE025
     C                     MOVE 'N'       CLE025                                              CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CRE015
      ** Check if enhancement CRE015 (Terms and Notice) is on.                                CRE015
      *                                                                                       CRE015
     C                     CALL 'AOSARDR0'                                                    CRE015
     C                     PARM *BLANKS   PRTCD                                               CRE015
     C                     PARM '*VERIFY' POPTN                                               CRE015
     C                     PARM 'CRE015'  PSARD                                               CRE015
     C           SCSARD    PARM SCSARD    DSSDY                                               CRE015
      *                                                                                       CRE015
     C           PRTCD     IFNE *BLANKS                                                       CRE015
     C           PRTCD     ANDNE'*NRF   '                                                     CRE015
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE015
     C                     MOVEL'CRE015'  DBKEY                                               CRE015
     C                     MOVEL'018'     DBASE                                               CRE015
     C                     MOVE *ON       *INU7                                               CRE015
     C                     MOVE *ON       *INU8                                               CRE015
     C                     MOVE *ON       *INLR                                               CRE015
     C                     EXSR *PSSR                                                         CRE015
     C                     GOTO END                                                           CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
     C           PRTCD     IFEQ *BLANKS                                                       CRE015
     C                     MOVE 'Y'       CRE015  1                                           CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE 'N'       CRE015                                              CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE075
      ** Check if enhancement CRE075 (Effective Date) is on.                                  CRE075
      *                                                                                       CRE075
     C                     CALL 'AOSARDR0'                                                    CRE075
     C                     PARM *BLANKS   PRTCD                                               CRE075
     C                     PARM '*VERIFY' POPTN                                               CRE075
     C                     PARM 'CRE075'  PSARD                                               CRE075
     C           SCSARD    PARM SCSARD    DSSDY                                               CRE075
      *                                                                                       CRE075
     C           PRTCD     IFNE *BLANKS                                                       CRE075
     C           PRTCD     ANDNE'*NRF   '                                                     CRE075
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE075
     C                     MOVEL'CRE075'  DBKEY                                               CRE075
     C                     MOVEL'019'     DBASE                                               CRE075
     C                     MOVE *ON       *INU7                                               CRE075
     C                     MOVE *ON       *INU8                                               CRE075
     C                     MOVE *ON       *INLR                                               CRE075
     C                     EXSR *PSSR                                                         CRE075
     C                     GOTO END                                                           CRE075
     C                     ENDIF                                                              CRE075
      *                                                                                       CRE075
     C           PRTCD     IFEQ *BLANKS                                                       CRE075
     C                     MOVE 'Y'       CRE075  1                                           CRE075
     C                     ELSE                                                               CRE075
     C                     MOVE 'N'       CRE075                                              CRE075
     C                     ENDIF                                                              CRE075
      *                                                                                       CRE095
      ** Check if Switchable Feature CRE095 is installed.                                     CRE095
      *                                                                                       CRE095
     C                     CALL 'AOSARDR0'                                                    CRE095
     C                     PARM *BLANKS   PRTCD                                               CRE095
     C                     PARM '*VERIFY' POPTN                                               CRE095
     C                     PARM 'CRE095'  PSARD                                               CRE095
     C           SCSARD    PARM SCSARD    DSSDY                                               CRE095
      *                                                                                       CRE095
     C           PRTCD     IFEQ *BLANKS                                                       CRE095
     C                     MOVE *ON       *IN15                                               CRE095
     C                     MOVE 'Y'       CRE095  1                                           CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE 'N'       CRE095                                              CRE095
     C                     ENDIF                                                              CRE095
     C/COPY OFCPYSRCZ,CRE101_070                                                              CRE101
      *                                                                                     MD034725
     C                     CALL 'AOSARDR0'                                                  MD034725
     C                     PARM *BLANKS   PRTCD                                             MD034725
     C                     PARM '*VERIFY' POPTN                                             MD034725
     C                     PARM 'CTI006'  PSARD                                             MD034725
     C           SCSARD    PARM SCSARD    DSSDY                                             MD034725
      *                                                                                     MD034725
     C           PRTCD     IFNE *BLANKS                                                     MD034725
     C           PRTCD     ANDNE'*NRF   '                                                   MD034725
     C                     MOVEL'SCSARDPD'DBFILE                                            MD034725
     C                     MOVEL'CTI006'  DBKEY                                             MD034725
     C                     MOVEL'919'     DBASE                                             MD034725
     C                     MOVE *ON       *INU7                                             MD034725
     C                     MOVE *ON       *INU8                                             MD034725
     C                     MOVE *ON       *INLR                                             MD034725
     C                     EXSR *PSSR                                                       MD034725
     C                     GOTO END                                                         MD034725
     C                     ENDIF                                                            MD034725
      *                                                                                     MD034725
     C           PRTCD     IFEQ *BLANKS                                                     MD034725
     C                     MOVE 'Y'       CTI006  1                                         MD034725
     C                     ELSE                                                             MD034725
     C                     MOVE 'N'       CTI006                                            MD034725
     C                     ENDIF                                                            MD034725
      *                                                                                       CGL018
      *  DEFINE KEY FOR CHAINING TO PF/ACCNTBXC
      *
     C           KACCNT    KLIST
     C**********           KFLD           CNUMC   60                                          CSD027
     C                     KFLD           CNUMC   6                                           CSD027
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C                     KFLD           BRCA                            CRE001
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CCPG                                           S01408
     C*                                                                   S01408
     C                     Z-ADD0         CINUAF
     C                     Z-ADD0         COCLAF
     C                     Z-ADD0         COCFAF
     C                     Z-ADD0         CAIC0
     C                     Z-ADD0         CALC
     C                     Z-ADD0         DAIC0
     C                     Z-ADD0         GACI
     C                     Z-ADD0         GADI
     C                     Z-ADD0         MACI
     C                     Z-ADD0         MADI
     C                     Z-ADD0         NAUP
     C                     Z-ADD0         NOAU
     C                     Z-ADD0         NOCF
     C                     Z-ADD0         NOCL
     C                     Z-ADD0         NOOA
     C                     Z-ADD0         NORD
     C                     Z-ADD0         DBASE
     C                     Z-ADD0         ENOC
     C                     Z-ADD0         EPNO
      *-------------------------------------------------------------------
      ** Initialize printer field                                                             CER001
     C                     Z-ADD0         WE1A14                                              CER001
     C**
     C                     EXSR CCYARR
     C                     TIME           MTIME   60
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CCP2                                           S01408
     C*                                                                   S01408
      ** Define work field for Yellow Book module.                                           LLN022A
      *                                                                                      LLN022A
     C                     MOVEL*BLANK    LLN007  1                                          LLN022A
      *                                                                                      LLN022A
      ** Check to see if Yellow Book changes (LLN007) is switched on.                        LLN022A
      *                                                                                      LLN022A
     C                     CALL 'AOSARDR0'                                                   LLN022A
     C                     PARM '       ' @RTCD                                              LLN022A
     C                     PARM '*VERIFY' @OPTN                                              LLN022A
     C                     PARM 'LLN007'  @SARD                                              LLN022A
     C           @RTCD     IFNE *BLANK                                                       LLN022A
     C           @RTCD     ANDNE'*NRF   '                                                    LLN022A
     C                     SETON                     U7U8LR                                  LLN022A
     C                     MOVEL'SCSARDPD'DBFILE           ***************                   LLN022A
     C                     MOVEL@RTCD     DBKEY            * DBERROR 020 *                   LLN022A
     C                     MOVE '020'     DBASE            ***************                   LLN022A
     C                     EXSR *PSSR                                                        LLN022A
     C                     GOTO END                                                          LLN022A
     C                     ENDIF                                                             LLN022A
     C           @RTCD     IFEQ '*NRF'                                                       LLN022A
     C                     MOVEL'N'       LLN007                                             LLN022A
     C                     ELSE                                                              LLN022A
      *                                                                                      LLN022A
      ** Otherwise...                                                                        LLN022A
      *                                                                                      LLN022A
     C                     MOVEL'Y'       LLN007           BoE Yellow book                   LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
      ** Access Switchable Features file and check if CSD023              CSD023
      ** is switched on or not.                                           CSD023
      *                                                                   CSD023
     C                     CALL 'AOSARDR0'                                CSD023
     C                     PARM *BLANKS   PRTCD   7                       CSD023
     C                     PARM '*VERIFY' POPTN   7                       CSD023
     C                     PARM 'CSD023'  PSARD   6                       CSD023
     C           SCSARD    PARM SCSARD    DSFDY                           CSD023
      *                                                                   CSD023
     C           PRTCD     IFEQ *BLANKS                                   CSD023
     C                     MOVE 'Y'       CSD023  1                       CSD023
     C                     ELSE                                           CSD023
     C                     MOVE 'N'       CSD023                          CSD023
      *                                                                   CSD023
      ** Database Error, if Return Code is not blanks or *NRF             CSD023
      *                                                                   CSD023
     C           PRTCD     IFNE '*NRF   '                                 CSD023
     C                     MOVEL'SCSARDPD'DBFILE                          CSD023
     C                     MOVEL'001'     DBASE                           CSD023
     C                     MOVEL'CSD023  'DBKEY                           CSD023
     C                     EXSR *PSSR                                     CSD023
     C                     ENDIF                                          CSD023
     C                     ENDIF                                          CSD023
      ** Access Switchable Features file and check if CRE073                                  CRE073
      ** is switched on or not.                                                               CRE073
      *                                                                                       CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   PRTCD   7                                           CRE073
     C                     PARM '*VERIFY' POPTN   7                                           CRE073
     C                     PARM 'CRE073'  PSARD   6                                           CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
      *                                                                                       CRE073
     C           PRTCD     IFEQ *BLANKS                                                       CRE073
     C                     MOVE *ON       *IN16                                               CRE073
     C                     ELSE                                                               CRE073
     C                     MOVE *OFF      *IN16                                               CRE073
      *                                                                                       CRE073
      ** Database Error, if Return Code is not blanks or *NRF                                 CRE073
      *                                                                                       CRE073
     C           PRTCD     IFNE '*NRF   '                                                     CRE073
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE073
     C                     MOVEL'020'     DBASE                                               CRE073
     C                     MOVEL'CRE073  'DBKEY                                               CRE073
     C                     EXSR *PSSR                                                         CRE073
     C                     ENDIF                                                              CRE073
     C                     ENDIF                                                              CRE073
     C*
      *                                                                                       CER047
      ** Call AOSARDR0 to check for CER047                                                    CER047
      *                                                                                       CER047
     C                     CALL 'AOSARDR0'                                                    CER047
     C                     PARM *BLANKS   PRTCD                                               CER047
     C                     PARM '*VERIFY 'POPTN                                               CER047
     C                     PARM 'CER047'  PSARD                                               CER047
     C           SCSARD    PARM SCSARD    DSFDY                                               CER047
      *                                                                                       CER047
     C           PRTCD     IFEQ *BLANKS                                                       CER047
      *                                                                                       CER047
     C                     MOVE 'Y'       CER047  1                                           CER047
     C                     ELSE                                                               CER047
     C                     MOVE 'N'       CER047                                              CER047
      *                                                                                       CER047
     C                     ENDIF                                                              CER047
      *                                                                                       CER047
      ** Database Error, if Return Code is not blanks or *NRF                                 CER047
      *                                                                                       CER047
     C           PRTCD     IFNE *BLANKS                                                       CER047
     C           PRTCD     ANDNE'*NRF   '                                                     CER047
      *                                                                                       CER047
     C           *LOCK     IN   LDA                                                           CER047
     C                     MOVEL'SCSARDPD'DBFILE                                              CER047
     C                     MOVEL'906'     DBASE                                               CER047
     C                     MOVEL'CER047'  DBKEY                                               CER047
     C                     OUT  LDA                                                           CER047
     C                     EXSR *PSSR                                                         CER047
      *                                                                                       CER047
     C                     ENDIF                                                              CER047
      *                                                                                       CER047
      ** Call AOSARDR0 to check if CRE090 is installed                                        CRE090
      *                                                                                       CRE090
     C                     CALL 'AOSARDR0'                                                    CRE090
     C                     PARM *BLANKS   PRTCD                                               CRE090
     C                     PARM '*VERIFY 'POPTN                                               CRE090
     C                     PARM 'CRE090'  PSARD                                               CRE090
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE090
      *                                                                                       CRE090
     C           PRTCD     IFEQ *BLANKS                                                       CRE090
     C                     MOVE 'Y'       CRE090  1                                           CRE090
     C                     MOVE '1'       *IN08                                               CRE090
     C                     ELSE                                                               CRE090
     C                     MOVE '0'       *IN08                                               CRE090
     C                     MOVE 'N'       CRE090                                              CRE090
      *                                                                                       CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
      ** Database Error, if Return Code is not blanks or *NRF                                 CRE090
      *                                                                                       CRE090
     C           PRTCD     IFNE *BLANKS                                                       CRE090
     C           PRTCD     ANDNE'*NRF   '                                                     CRE090
      *                                                                                       CRE090
     C           *LOCK     IN   LDA                                                           CRE090
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE090
     C                     MOVEL'907'     DBASE                                               CRE090
     C                     MOVEL'CRE090'  DBKEY                                               CRE090
     C                     OUT  LDA                                                           CRE090
     C                     EXSR *PSSR                                                         CRE090
      *                                                                                       CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
     C           START     TAG                             ** START TAG **
     C*                                                                   S01408
     C           ULX004    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
     C/COPY WNCPYSRC,GL3572CCP3                                           S01408
     C                     Z-ADDACOD      N#ACOD                                              CER001
     C                     MOVE C#ACOD    NACOD                                               CER001
     C           KEYAC     CHAINREACX1PD             95                                       CER001
     C*                                                                   S01408
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     Z-ADD0         R#DECD                                              CRE090
      *                                                                                     MD027647
     C                     Z-ADDACOD      N#ACOD                                            MD027647
     C                     MOVE C#ACOD    NACOD                                             MD027647
     C           KEYAC     CHAINGLACNTL3             18                                     MD027647
      *                                                                                     MD027647
      ** Delay Capitalisation Days                                                          MD027647
      *                                                                                     MD027647
     C           CRE090    IFEQ 'Y'                                                         MD027647
     C           *IN18     ANDEQ'0'                                                         MD027647
     C                     Z-ADDF1DECD    R#DECD                                            MD027647
     C                     ENDIF                                                            MD027647
      *                                                                                       CRE095
      ** Rate Fixing for RE Accounts                                                          CRE095
      *                                                                                       CRE095
     C           CRE095    IFEQ 'Y'                                                           CRE095
     C           F1DNFD    IFNE 0                                                             CRE095
     C                     Z-ADDF1DNFD    ZDAYNO                                              CRE095
     C                     EXSR ZDATE2                                                        CRE095
     C                     MOVE ZADATE    F2DNFD  7                                           CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   F2DNFD  7                                           CRE095
     C                     ENDIF                                                              CRE095
     C           F1CNFD    IFNE 0                                                             CRE095
     C                     Z-ADDF1CNFD    ZDAYNO                                              CRE095
     C                     EXSR ZDATE2                                                        CRE095
     C                     MOVE ZADATE    F2CNFD  7                                           CRE095
     C                     ELSE                                                               CRE095
     C                     MOVE *BLANKS   F2CNFD                                              CRE095
     C                     ENDIF                                                              CRE095
     C                     ENDIF                                                              CRE095
      *                                                                                     MD027647
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C**********           Z-ADDACOD      N#ACOD                                     CAP205 MD027647
     C**********           MOVE C#ACOD    NACOD                                      CAP205 MD027647
     C                     SETON                     62                                       CAP205
     C********** KEYAC     CHAINGLACNTL3             18                              CAP205 MD027647
     C           *IN18     IFEQ '1'                                                           CAP205
     C                     MOVEL*BLANKS   R#IABC                                              CAP205
     C                     MOVE '0'       R#TOLR    P                                         CAP205
     C                     ELSE                                                               CAP205
      *                                                                                       CAP205
      ** Account Balance Check Indicator                                                      CAP205
      *                                                                                       CAP205
     C           F1IABC    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'YES'     R#IABC    P                                         CAP205
     C                     ELSE                                                               CAP205
     C                     MOVEL'NO'      R#IABC    P                                         CAP205
     C                     ENDIF                                                              CAP205
      **********                                                                     CRE090 MD027647
      ***Delay*Capitalisation Days                                                   CRE090 MD027647
      **********                                                                     CRE090 MD027647
     C********** CRE090    IFEQ 'Y'                                                  CRE090 MD027647
     C**********           Z-ADDF1DECD    R#DECD                                     CRE090 MD027647
     C**********           ENDIF                                                     CRE090 MD027647
      *                                                                                       CAP205
      ** Overdraft Tolerance                                                                  CAP205
      *                                                                                       CAP205
     C                     Z-ADDF1TOLR    ZFLD15                                              CAP205
     C                     MOVEL'J'       ZECODE                                              CAP205
      *                                                                                       CAP205
     C                     CALL 'AOCURRR0'                                                    CAP205
     C                     PARM           @RTCD                                               CAP205
     C                     PARM '*KEY   ' @OPTN                                               CAP205
     C                     PARM F1CCY     @AJCD                                               CAP205
     C           SDCURR    PARM SDCURR    DSSDY                                               CAP205
      *                                                                                       CAP205
     C           @RTCD     IFNE *BLANKS                                                       CAP205
     C           *LOCK     IN   LDA                                                           CAP205
     C                     SETON                     U7U8                                     CAP205
     C                     MOVE '063'     DBASE                                               CAP205
     C                     MOVEL'SDCURRPD'DBFILE                                              CAP205
     C                     MOVELF1CCY     DBKEY                                               CAP205
     C                     OUT  LDA                                                           CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     ELSE                                                               CAP205
     C                     Z-ADDA6NBDP    ZDECS                                               CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C                     EXSR ZSEDIT                                                        CAP205
     C                     MOVE ZOUT21    R#TOLR    P                                         CAP205
      *                                                                                       CAP205
     C                     ENDIF                                                              CAP205
     C                     ELSE                                                               CAP205
     C                     SETOF                     62                                       CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C/EJECT
     C                     SETOF                     21
     C   02                                                               084517
     COR 03                SETON                     10                   084517
     C   02
     COR 03                GOTO END
     C/COPY WNCPYSRC,GL3572C024
     C*
     C           *INL1     IFEQ '1'
     C           *IN76     IFEQ '0'
     C           *IN75     ANDEQ'1'
     C                     WRITENODTL2
     C                     WRITENODTL2B
     C                     ELSE
      * Branch end of report
     C           *IN75     IFEQ '1'
     C                     WRITEGL3572FT
     C                     WRITEGL3572FB
     C                     END
     C                     END
     C                     CLOSEGL3572P1
     C                     SETOF                     76
     C           BRNCH     IFEQ 'ALL'
     C           BRNCH     OREQ BRCA
     C                     MOVE BRCA      BRCA1   3
     C                     SETON                     7589
     C                     OPEN GL3572P1
     C                     Z-ADDSFNUM     SFNUM1  60
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE
     C                     PARM           SFNUM1
     C                     PARM *BLANKS   ZSERR   1
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C**
      *                                                                   CSD005
     C** To get Branch Name
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @DSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C                     SETON                     U7U8LR
     C                     MOVEL'SDBRCHPD'DBFILE
     C                     MOVEL@DSNB     DBKEY            ***************
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 004 *
     C                     MOVEL'004'     DBASE            ***************
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C**
     C                     ELSE
     C                     SETOF                     75
     C                     SETON                     87LR
     C                     END
     C                     END
      *                                                                   CFT004
      ** Format International Bank Account Numbers                        CFT004
      *                                                                   CFT004
     C                     MOVEL*BLANKS   RIBAN                           CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           IBAN      ANDNE*BLANKS                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM IBAN      PIBAN  47                       CFT004
     C                     PARM *BLANKS   PIWITH 47                       CFT004
     C                     PARM *BLANKS   PINOBL 34                       CFT004
      *                                                                   CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVELPIWITH    RIBAN                           CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ENDIF                                          CFT004
     C*
     C** EXIT PROGRAM WHEN NO RECORD EXIST FOR THE REQUESTED BRANCH
     C*
     C   87                GOTO EMPTY
     C**
      *-------------------------------------------------------------------
     C/COPY WNCPYSRC,GL3572C021
     C                     MOVE CINUAF    CINUAF
     C                     MOVE COCLAF    COCLAF
     C                     MOVE COCFAF    COCFAF
     C                     MOVE CAIC0     CAIC0
     C                     MOVE CALC      CALC
     C                     MOVE DAIC0     DAIC0
     C                     MOVE GACI      GACI
     C                     MOVE GADI      GADI
     C                     MOVE MACI      MACI
     C                     MOVE MADI      MADI
     C                     MOVE NAUP      NAUP
     C                     MOVE NOAU      NOAU
     C                     MOVE NOCF      NOCF
     C                     MOVE NOCL      NOCL
     C                     MOVE NOOA      NOOA
     C                     MOVE NORD      NORD
     C                     MOVE DBASE     DBASE
     C                     MOVE ENOC      ENOC
     C                     MOVE EPNO      EPNO
     C                     MOVE ECFB      ECFB
     C                     Z-ADD0         FNSQ1                           CGL004
     C                     MOVE *BLANK    FONA1                           CGL004
     C                     MOVE *BLANK    ATVD1                           CGL004
     C                     MOVE *BLANK    DATV1                           CGL004
     C                     MOVE *BLANK    WD421                           CGL004
     C                     MOVE *BLANK    GN421                           CGL004
      *-------------------------------------------------------------------
     C*
     C*    CHECK FOR CHANGE IN CURRENCY CODE.
     C           XCCY      COMP CCY                  5050
     C*
     C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
     C                     MOVE CCY       XCCY    3
     C                     Z-ADD1         X
     C           XCCY      LOKUPCCYA,X                   95
     C                     MOVE DPA,X     XDECP   10
     C*
     C*    CHECK NUMBER OF DECIMAL PLACES FOR ACCOUNT CURRENCY.
     C   50      XDECP     COMP 1                      7071
     C   50      XDECP     COMP 2                    73  72
     C*                                                                   CEU013
     C*    CHECK FOR 'IN' CURRENCY                                        CEU013
     C           *IN50     IFEQ '1'                                       CEU013
     C           CEU013    ANDEQ'Y'                                       CEU013
     C                     CALL 'AOCURRR0'                                CEU013
     C                     PARM           @RTCD   7                       CEU013
     C                     PARM '*KEY   ' @OPTN   7                       CEU013
     C                     PARM XCCY      @AJCD   3                       CEU013
     C           SDCURR    PARM SDCURR    DSSDY                           CEU013
     C           @RTCD     IFNE *BLANKS                                   CEU013
     C                     SETON                     U7U8                 CEU013
     C                     MOVE '14'      DBASE             ************  CEU013
     C                     MOVEL'SDCURRPD'DBFILE            * DATABASE *  CEU013
     C                     MOVELXCCY      DBKEY             * ERROR 14 *  CEU013
     C                     EXSR *PSSR                       ************  CEU013
     C                     ELSE                                           CEU013
     C           A6INCY    IFEQ 'Y'                                       CEU013
     C           A6TPSD    ANDLEBJRDNB                                    CEU013
     C                     SETON                     64                   CEU013
     C                     ELSE                                           CEU013
     C                     SETOF                     64                   CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C**                                                                  CEU013
     C*
     C*    ADJUST HELD AMOUNT AND MINIMUM BALANCE FOR OUTPUT.
     C                     MOVE HELD      HELDA  140
     C**********           MOVE MINB      MINBA  110                                        BUG26720
     C                     MOVE MINB      MINBA                                             BUG26720
      *                                                                   CSD005
      *** Find the account narrative for the account code if feature      CSD005
      *** CSD005 is active.                                               CSD005
      *                                                                   CSD005
     C           *IN37     IFEQ *ON                                       CSD005
      *                                                                   CSD005
     C                     MOVEL*BLANKS   W#NARR                          CSD005
     C                     MOVEL*BLANKS   @AFNB                           CSD005
      *                                                                   CSD005
     C                     MOVELACOD      @AFNB                           CSD005
     C                     CALL 'AOACODR0'                                CSD005
     C                     PARM '*BLANK ' @RTCD   7                       CSD005
     C                     PARM '*KEY   ' @OPTN   7                       CSD005
     C**********           PARM           @AFNB   4                                    CSD005 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        CSD005 CGL029
     C                     PARM           @AFNB  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                   CSD005
     C                     SELEC                                          CSD005
      *                                                                   CSD005
      *** When account narrative is entered move field into               CSD005
      *** printer field                                                   CSD005
      *                                                                   CSD005
     C           @RTCD     WHEQ *BLANKS                                   CSD005
     C                     MOVELA5NARR    W#NARR                          CSD005
      *                                                                   CSD005
      *** If field is blank then blank out printer file field             CSD005
      *                                                                   CSD005
     C           @RTCD     WHEQ '*NRF'                                    CSD005
     C                     MOVEL*BLANKS   W#NARR                          CSD005
      *                                                                   CSD005
     C                     OTHER                                          CSD005
     C           *LOCK     IN   LDA                                       CSD005
     C                     MOVEL'SDACODPD'DBFILE            ************* CSD005
     C                     MOVEL'016'     DBASE             *DBERROR 016* CSD005
     C                     MOVEL@OPTN     DBKEY             ************* CSD005
     C                     SETON                     U7U8LR               CSD005
     C                     OUT  LDA                                       CSD005
     C                     EXSR *PSSR                                     CSD005
     C                     ENDSL                                          CSD005
     C                     ENDIF                                          CSD005
      *                                                                   CSD005
     C*
     C*    CHECK CHANGE TYPE.
     C           CHTP      COMP 'I'                      80
     C           CHTP      COMP 'A'                      81
     C           CHTP      COMP 'C'                      82
     C           CHTP      COMP 'R'                      83
     C*
     C           ATYP      COMP 'R'                      19
     C           DACC      COMP RUND                     59
     C*                                                                  *
     C/COPY WNCPYSRC,GL3572C020
     C  N19
     CORN59 04             GOTO NOINTC
     C*
     C**   R E T A I L
     C**   -----------
     C**
     C*    OBTAIN CUSTOMER DETAILS
     C                     MOVE *BLANK    CLNKEY 10
     C                     MOVELCNUM      CLNKEY
     C*****                CALL 'AOCUSTR0'                                CSD023
     C                     CALL 'AOCUSTR2'                                CSD023
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM CLNKEY    @KEY1  10
     C                     PARM           @KYST   7
     C           SDCUST    PARM SDCUST    DSLDY                           CSD023
     C*****      SDCUST    PARM SDCUST    DSSDY                           CSD023
     C*
      ** If CSD023 is on, allow processing of a closed record (return     CSD023
      ** code '*NRF' and date deleted equal to zero).                     CSD023
      *                                                                   CSD023
     C           @KYST     IFNE '*CNUM  '
     C           @RTCD     ORNE *BLANK
     C           @RTCD     ANDNE'*NRF   '                                 CSD023
     C           CSD023    ANDEQ'Y'                                       CSD023
     C           @RTCD     ORNE *BLANKS                                   CSD023
     C           @RTCD     ANDEQ'*NRF   '                                 CSD023
     C           BBDTDL    ANDNE*ZEROS                                    CSD023
     C           CSD023    ANDEQ'Y'                                       CSD023
     C           @RTCD     ORNE *BLANKS                                   CSD023
     C           CSD023    ANDNE'Y'                                       CSD023
     C                     SETON                     U7U8LR
     C                     MOVEL'SDCUSTPD'DBFILE
     C                     MOVEL@KEY1     DBKEY            ***************
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 005 *
     C                     MOVEL'005'     DBASE            ***************
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C*
     C**   OBTAIN INTEREST AND CHARGES DETAILS
     C                     SETOF                     0607
     C           REKEY     CHAINREACR                99
     C  N07                SETON                     99
     C   99                SETON                     U7U8LR
     C   99                MOVEL'REACR'   DBFILE
     C   99                MOVELREKEY     DBKEY            ***************
     C   99                MOVEL'092'     DBASE            * DBERROR 092 *
     C   99                EXSR *PSSR                      ***************
     C   99                GOTO END
     C**
     C           REKEY     CHAINREIAC                99
     C  N06                SETON                     99
     C   99                SETON                     U7U8LR
     C   99                MOVEL'REIAC'   DBFILE
     C   99                MOVELREKEY     DBKEY            ***************
     C   99                MOVEL'093'     DBASE            * DBERROR 093 *
     C   99                EXSR *PSSR                      ***************
     C   99                GOTO END
      *-------------------------------------------------------------------
      *
     C           KREKEY    KLIST
     C                     KFLD           BRCA
     C                     KFLD           CNUM
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CCP4                                           S01408
     C           KEYAC     KLIST                                                              CER001
     C                     KFLD           CNUM                                                CER001
     C                     KFLD           CCY                                                 CER001
     C                     KFLD           NACOD  100                                          CER001
     C                     KFLD           ACSQ                                                CER001
     C                     KFLD           BRCA                                                CER001
     C*                                                                   S01408
     C*
     C* Get RECOM details
     C*
     C           CMDR      IFEQ 'Y'
     C           MDPF      ANDEQ'Y'
     C           FXAC      OREQ 'Y'
     C           CNDS      OREQ 'Y'
     C           CDRI      OREQ 'Y'
     C           CMBL      OREQ 'Y'
     C           CINA      OREQ 'Y'
     C           CDTO      OREQ 'Y'
     C*
     C           KREKEY    CHAINRECOM                99
     C   99                MOVEL'RECOM'   DBFILE
     C   99                SETON                     U7LR  ** DB ERROR 97
     C   99                MOVELREKEY     DBKEY
     C   99                Z-ADD97        DBASE
     C   99                GOTO END
     C*
     C* Format TCHO field
     C*
     C                     Z-ADDXDECP     ZADEC
     C                     MOVE TCHO      ZFIELD
     C/COPY WNCPYSRC,GL3572C002
     C                     EXSR GEDIT
     C                     MOVE ZFIELD    TCHOVR
     C*
     C* Setup commissions
     C*
     C           MDPF      IFEQ *BLANK
     C           CMDR      OREQ *BLANK
     C/COPY WNCPYSRC,GL3572C003
     C                     MOVEL'(N/A)'   CEXA
     C/COPY WNCPYSRC,GL3572C004
     C                     END
     C           CDTO      IFNE 'Y'
     C/COPY WNCPYSRC,GL3572C005
     C                     MOVEL'(N/A)'   CEXB
     C/COPY WNCPYSRC,GL3572C006
     C                     END
     C           CDRI      IFNE 'Y'
     C/COPY WNCPYSRC,GL3572C007
     C                     MOVEL'(N/A)'   CEXC
     C/COPY WNCPYSRC,GL3572C008
     C                     END
     C           CINA      IFNE 'Y'
     C/COPY WNCPYSRC,GL3572C009
     C                     MOVEL'(N/A)'   CEXD
     C/COPY WNCPYSRC,GL3572C010
     C                     END
     C           CMBL      IFNE 'Y'
     C/COPY WNCPYSRC,GL3572C011
     C                     MOVEL'(N/A)'   CEXE
     C/COPY WNCPYSRC,GL3572C012
     C                     END
     C           CNDS      IFNE 'Y'
     C/COPY WNCPYSRC,GL3572C013
     C                     MOVEL'(N/A)'   CEXF
     C/COPY WNCPYSRC,GL3572C014
     C                     END
     C           FXAC      IFNE 'Y'
     C/COPY WNCPYSRC,GL3572C015
     C                     MOVEL'(N/A)'   CEXG
     C/COPY WNCPYSRC,GL3572C016
     C                     END
     C*
     C                     END
      *                                                                   CGL004
      *  If Midas-Fontis Interface active, obtain Fontis Account          CGL004
      *  Details                                                          CGL004
      *                                                                   CGL004
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     MOVE BRCA      KBRCA                           CGL004
     C**********           Z-ADDCNUM      KCNUM                                        CGL004 CSD027
     C                     MOVE CNUM      KCNUM                                               CSD027
     C                     MOVE CCY       KCCY                            CGL004
     C                     MOVE ACOD      KACOD                           CGL004
     C                     MOVE ACSQ      KACSQ                           CGL004
      *                                                                   CGL004
     C           KACCNO    CHAINGLFONAD0             99                   CGL004
      *                                                                   CGL004
     C           *IN99     IFEQ '0'                                       CGL004
     C                     MOVE '1'       *IN36                           CGL004
     C                     ELSE                                           CGL004
     C                     MOVE '0'       *IN36                           CGL004
     C                     ENDIF                                          CGL004
     C                     ENDIF                                          CGL004
      *-------------------------------------------------------------------
     C*
     C********** *IN28     IFEQ '0'                                                          BUG8210
     C********** CRE001    OREQ 'Y'                                       CRE001             BUG8210
     C********** CDE002    OREQ 'Y'                                       CDE002             BUG8210
      *                                                                                      BUG8210
      ** Check if Retail Account                                                             BUG8210
      *                                                                                      BUG8210
     C           *IN19     IFEQ '1'                                                          BUG8210
     C           *IN04     ANDEQ'0'                                                         BUG18520
     C                     MOVE CNUM      CNUMC
     C           KACCNT    CHAINACCNTBXC             99
     C*
     C** DATABASE ERROR
     C           *IN99     IFEQ '1'
     C                     MOVE 'ACCNTBXC'DBFILE
     C                     SETON                     U7LR  ** DB ERROR 96
     C                     MOVELREKEY     DBKEY
     C                     Z-ADD96        DBASE
     C                     GOTO END
     C                     END
     C*
      *                                                                   CRE001
      ** Format additional overdraft fields if CRE001 is on               CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
      ** Format Additional Overdraft Rate for output                      CRE001
     C                     Z-ADDATAODR    WAODR  117                      CRE001
     C           ATAODR    IFLT *ZERO                                     CRE001
     C           ATAODR    MULT -1        WAODR                           CRE001
     C                     ENDIF                                          CRE001
     C                     MOVE *BLANKS   ZFIELD                          CRE001
     C                     MOVE WAODR     ZFIELD                          CRE001
     C                     Z-ADD7         ZADEC                           CRE001
     C                     Z-ADD4         ZADIG                           CRE001
     C                     EXSR GEDIT                                     CRE001
     C                     MOVE ZFIELD    RRAODR                          CRE001
      *                                                                   CRE001
      ** Additional Overdraft Rate - Set on indicator 54 if > 0           CRE001
      **                           - Set on indicator 52 if < 0           CRE001
     C           ATAODR    COMP 0                    5452                 CRE001
      *                                                                   CRE001
      ** Convert dates for printing to DDMMMYY                            CRE001
      *                                                                   CRE001
      ** Overdraft Rate Change Value Date                                 CRE001
     C                     MOVE *BLANKS   RRORTC                          CRE001
     C                     Z-ADDATORTC    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    RRORTC                          CRE001
      *                                                                   CRE001
      ** Overdraft Line Change Value Date                                 CRE001
     C                     MOVE *BLANKS   RROLVD                          CRE001
     C                     Z-ADDATOLVD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    RROLVD                          CRE001
      *                                                                   CRE001
      ** Previous Overdraft Line Change Value Date                        CRE001
     C                     MOVE *BLANKS   RRPOLC                          CRE001
     C                     Z-ADDATPOLC    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    RRPOLC                          CRE001
      *                                                                   CRE001
      ** Previous Overdraft Line Expiry Date                              CRE001
     C                     MOVE *BLANKS   RRPOLE                          CRE001
     C                     Z-ADDATPOLE    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    RRPOLE                          CRE001
      *                                                                   CRE001
      ** Interest Rate Review Date                                        CRE001
     C                     MOVE *BLANKS   RRITRD                          CRE001
     C           ATITRD    IFEQ 99999                                     CRE001
     C                     MOVEL'NO MATR' RRITRD                          CRE001
     C                     ELSE                                           CRE001
     C           ATITRD    IFNE 0                                         CRE001
     C                     Z-ADDATITRD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    RRITRD                          CRE001
     C                     ENDIF                                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
      ** If CDE002 is on and Interest Margin fields have not been         CDE002
      ** overridden, access PF/RECCYD for defaults.                       CDE002
      *                                                                   CDE002
     C           CDE002    IFEQ 'Y'                                       CDE002
     C                     MOVE 'D'       K#D                             CDE002
     C                     MOVE CCY       K#CCY                           CDE002
      *                                                                   CDE002
     C           KRECCY    CHAINRECCY                99                   CDE002
      *                                                                   CDE002
      ** Database Error                                                   CDE002
      *                                                                   CDE002
     C           *IN99     IFEQ '1'                                       CDE002
     C                     MOVE 'RECCYD'  DBFILE                          CDE002
     C                     MOVE *ON       *INU7                           CDE002
     C                     MOVE *ON       *INLR                           CDE002
     C                     MOVELREKEY     DBKEY                           CDE002
     C                     Z-ADD98        DBASE                           CDE002
     C                     GOTO END                                       CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C           ATOVRD    IFEQ 'Y'                                       CDE002
     C           ATDMBR    IFNE *BLANKS                                                       208221
     C                     MOVEL*BLANKS   PDRMG                                               208221
     C                     MOVELATDMBR    PDRMG                                               208221
     C                     ELSE                                                               208221
     C***********          MOVE ATDRMG    PDRMG                                         CDE002208221
     C                     MOVE ATDRMG    ZFLD15                                              208221
     C                     Z-ADD7         ZDECS                                               208221
     C                     EXSR ZSEDIT                                                        208221
     C                     MOVE ZOUT21    PDRMG                                               208221
     C                     ENDIF                                                              208221
     C                     ELSE                                           CDE002
     C***********          MOVE DRMG      PDRMG                                         CDE002208221
     C                     MOVE DRMG      ZFLD15                                              208221
     C                     Z-ADD7         ZDECS                                               208221
     C                     EXSR ZSEDIT                                                        208221
     C                     MOVE ZOUT21    PDRMG                                               208221
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C           ATOVRC    IFEQ 'Y'                                       CDE002
     C           ATCMBR    IFNE *BLANKS                                                       208221
     C                     MOVEL*BLANKS   PCRMG                                               208221
     C                     MOVELATCMBR    PCRMG                                               208221
     C                     ELSE                                                               208221
     C***********          MOVE ATCRMG    PCRMG                                         CDE002208221
     C                     MOVE ATCRMG    ZFLD15                                              208221
     C                     EXSR ZSEDIT                                                        208221
     C                     MOVE ZOUT21    PCRMG                                               208221
     C                     ENDIF                                                              208221
     C                     ELSE                                           CDE002
     C***********          MOVE CRMG      PCRMG                                         CDE002208221
     C                     MOVE CRMG      ZFLD15                                              208221
     C                     EXSR ZSEDIT                                                        208221
     C                     MOVE ZOUT21    PCRMG                                               208221
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDE002
     C/COPY OFCPYSRCZ,CRE101_071                                                              CRE101
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CPDR                                           S01408
     C*                                                                   S01408
      ** If Yellow book feature is 'on'                                                      LLN022A
      *                                                                                      LLN022A
     C           LLN007    IFEQ 'Y'                                                          LLN022A
      *                                                                                      LLN022A
     C           ACDTKY    KLIST                                                             LLN022A
     C                     KFLD           BRCA                                               LLN022A
     C                     KFLD           CNUM                                               LLN022A
     C                     KFLD           CCY                                                LLN022A
     C                     KFLD           ACOD                                               LLN022A
     C                     KFLD           ACSQ                                               LLN022A
      *                                                                                      LLN022A
      ** Get record from Account details extn file                                           LLN022A
      *                                                                                      LLN022A
     C           ACDTKY    CHAINBYACCTY0             69                                      LLN022A
      *                                                                                      LLN022A
      ** If no record found                                                                  LLN022A
      *                                                                                      LLN022A
     C           *IN69     IFEQ *ON                                                          LLN022A
     C                     MOVE *BLANK    LNETI            Netting Ind.                      LLN022A
     C                     MOVE *BLANK    LDPTP            Deposit type                      LLN022A
     C                     MOVE *BLANK    LSNOD            SAYE/Shrsav nd                    LLN022A
     C                     MOVE *BLANK    LLNTP            Loan type                         LLN022A
     C                     MOVE *BLANK    LMDAT            Loan mat date                     LLN022A
     C                     MOVE *BLANK    LLLIM            Loan limit                        LLN022A
      *                                                                                      LLN022A
      ** If extension record found                                                           LLN022A
      *                                                                                      LLN022A
     C                     ELSE                                                              LLN022A
      *                                                                                      LLN022A
      ** Convert 5-decimal date field to DDMMYY                                              LLN022A
      *                                                                                      LLN022A
     C                     Z-ADDLMDAT     ZDAYNO                                             LLN022A
     C                     EXSR ZDATE2                                                       LLN022A
      *                                                                                      LLN022A
     C                     MOVELZDATE     L#MDAT           Loan Mat. Date                    LLN022A
      *                                                                                      LLN022A
     C                     MOVELLNETI     L#NETI           For Netting                       LLN022A
     C                     MOVELLDPTP     L#DPTP           Deposit type                      LLN022A
     C                     MOVELLSNOD     L#SNOD           SAYE/Sh not.day                   LLN022A
     C                     MOVELLLNTP     L#LNTP           Loan Type                         LLN022A
     C                     MOVELLLLIM     L#LLIM           Loan Limit                        LLN022A
      *                                                                                      LLN022A
     C                     ENDIF                                                             LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
     C**
     C**   CALCULATE CHARGES ACCRUED SINCE LAST CAPITALISATION
     C           NRCA      ADD  RECA      CALC   130   86
     C**                                                                **
     C**   SETUP OUTPUT INDICATORS
     C           MADI      COMP 0                    55
     C           GADI      COMP 0                    6665
     C           MACI      COMP 0                    57  58
     C           GACI      COMP 0                    6867
     C*
     C*    ADJUST INTEREST AMOUNTS.
     C*
     C                     Z-ADDDAIC      DAIC0  130
     C                     Z-ADDCAIC      CAIC0  130
     C*
     C*
     C           NOINTC    TAG                             *** NOINTC ***
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CCP6                                           S01408
     C*                                                                   S01408
     C*
     C*    COMPARE LAST CHANGE DATE WITH TODAY'S DATE.
     C           LCD       COMP RUND                     60
     C*
     C  N60                GOTO TAG1
     C*
     C*    CALCULATE FILE CONTROL TOTALS.
     C*
     C      80   CNINU     ADD  1         CNINU   50
     C      81   CNOAM     ADD  1         CNOAM   50
     C      82N01CNOCL     ADD  1         CNOCL   50
     C      82 01CNOCF     ADD  1         CNOCF   50
     C      83   CNORD     ADD  1         CNORD   50
     C*
     C**   RETAIL ACCOUNT NUMBER CHECK
     C           ACNO      COMP 0                        20
     C**
     C   20                GOTO TAG1
     C*
     C***  RETAIL A/CS
     C*
     C   80 61   CINUAF    ADD  1         CINUAF  50
     C*
     C   82N01 61COCLAF    ADD  1         COCLAF  50
     C*
     C   82 01 61COCFAF    ADD  1         COCFAF  50
     C*
     C           TAG1      TAG                             ** TAG1 TAG **
     C*
     C***  KEEP TOTAL OF OPEN A/CS
     C*
     C   19 01 61COAUAF    ADD  1         COAUAF  50
     C   01      CNOAU     ADD  1         CNOAU   50
     C**
     C**   ACCOUNTS CLOSED BEFORE TODAY NOT REQUIRED TO REPORT
     C  N59 04             GOTO END
     C**
     C**   OUTPUT INDICATOR FOR PRINT TRANSACTION ADVICE
     C   19      PTRA      COMP 'Y'                      48
     C**
     C**   OUTPUT INDICATOR FOR RATE CHANGE ADVICE
     C   19      PRCA      COMP 'Y'                      49
     C**
     C**   SETUP OUTPUT INDICATORS
     C           ODSC      COMP 'Y'                      33
     C           DRIS      COMP 0                    51
     C           CRIS      COMP 0                    53
     C           CIIE      COMP 0                    63
     C           DACC      COMP 0                        32
     C*
     C*    CONVERT DATES FOR REPORT PRINTING TO DDMMYY FORMAT.
     C*
     C                     Z-ADDDACO      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    OPNDAT  7        OPEN DATE
     C*
     C  N32                Z-ADDDACC      ZDAYNO
     C  N32                EXSR ZDATE2
     C  N32                MOVE ZADATE    CLSDAT  7        CLOSED DATE
     C*
     C   19                Z-ADDODED      ZDAYNO
     C   19                EXSR ZDATE2
     C   19                MOVE ZADATE    EXPDAT  7        EXPIRY DATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CPD1                                           S01408
     C*                                                                   S01408
     C*
     C                     Z-ADDNSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    NXTDAT  7        NEXT STATMENT
     C*                                                    DATE
     C*
     C                     TESTB'0'       RETB           42REFER DEBITS
     C*
     C                     TESTB'1'       RETB           43REFER CREDITS
     C*
     C                     TESTB'2'       RETB           44BLOCK DEBITS
     C*
     C                     TESTB'2'       GLBT           45PRINT ADDRESS
     C*
     C                     TESTB'3'       RETB           46BLOCK CREDITS
     C*
     C   19                TESTB'4'       RETB           47INACTIVE
     C*
     C   19                TESTB'6'       RETB           84BANKRUPT
     C*
     C   19                TESTB'7'       RETB           85BAD DEBT
     C*
     C/COPY WNCPYSRC,GL3572CTC1                                           S01408
     C                     Z-ADDLMVD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    LMVDAT  7        LAST MOVE.DATE
     C/COPY WNCPYSRC,GL3572C022
     C*
     C                     Z-ADDLACD      ZDAYNO
     C                     EXSR ZDATE2                     LAST ACTIVITY
     C                     MOVE ZADATE    LACDAT  7        DATE
     C*
     C                     Z-ADDLCD       ZDAYNO
     C                     EXSR ZDATE2                     LAST CHANGE
     C                     MOVE ZADATE    LCHDAT  7        DATE
     C*
     C                     Z-ADDDRCD      ZDAYNO
     C                     EXSR ZDATE2                     DEBIT RATE
     C                     MOVE ZADATE    DRCDAT  7        CHANGE DATE
     C*
     C                     Z-ADDCRCD      ZDAYNO
     C                     EXSR ZDATE2                     CREDIT RATE
     C                     MOVE ZADATE    CRCDAT  7        CHANGE DATE
     C*
     C                     Z-ADDNDID      ZDAYNO
     C                     EXSR ZDATE2                     NEXT CAP.
     C                     MOVE ZADATE    NDIDAT  7        DEBIT DATE
     C*
     C                     Z-ADDNCID      ZDAYNO
     C                     EXSR ZDATE2                     NEXT CAP.
     C                     MOVE ZADATE    NCIDAT  7        CREDIT DATE
     C*
     C                     Z-ADDLDID      ZDAYNO
     C                     EXSR ZDATE2                     LAST POSTING
     C                     MOVE ZADATE    LPDDAT  7        DATE - DEBIT
     C*
     C                     Z-ADDLCID      ZDAYNO
     C                     EXSR ZDATE2                     LAST POSTING
     C                     MOVE ZADATE    LPCDAT  7        DATE -CREDIT
     C*
     C           CGL004    IFEQ 'Y'                                       CGL004
     C                     Z-ADDF1ATVD    ZDAYNO                          CGL004
     C                     EXSR ZDATE2                     Activation     CGL004
     C                     MOVE ZADATE    ATVD1   7        Date           CGL004
     C*                                                                   CGL004
     C                     Z-ADDF1DATV    ZDAYNO                          CGL004
     C                     EXSR ZDATE2                     De-Activation  CGL004
     C                     MOVE ZADATE    DATV1   7        Date           CGL004
     C*                                                                   CGL004
     C                     Z-ADDF1WD42    ZDAYNO                          CGL004
     C                     EXSR ZDATE2                     Next MT942     CGL004
     C                     MOVE ZADATE    WD421   7        Date           CGL004
     C                     ENDIF                                          CGL004
      ** Retrieve Reference attached to 9997 if needed.                   S01486
     C           *IN29     IFEQ '1'                                       S01486
     C********** PTFR      IFEQ *BLANKS                            S01486 CPB001
     C********** PTFR      OREQ '9997'                             S01486 CPB001
     C           PTFR      IFEQ '9997'                                    CPB001
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C                     MOVE FCR997    PTFR                            S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C/COPY WNCPYSRC,GL3572C027
     C           END       TAG                             ** END TAG ****
     C*
     C*    ACCUMULATE NUMBER OF RECORDS ON FILE.
     C           NREC      ADD  1         NREC    50
     C**
     C**   SET ACCOUNTS DETAILS OUTPUT INDICATOR FIR OPEN ACCOUNTS
     C**   AND ACCOUNTS CLOSED TODAY.
     C   01
     COR 59 04             SETON                     217976
      *-------------------------------------------------------------------
     C                     Z-ADDCINUAF    CINUAF
     C                     Z-ADDCOCLAF    COCLAF
     C                     Z-ADDCOCFAF    COCFAF
     C                     Z-ADDCAIC0     CAIC0
     C                     Z-ADDCALC      CALC
     C                     Z-ADDDAIC0     DAIC0
     C                     Z-ADDGACI      GACI
     C                     Z-ADDGADI      GADI
     C                     Z-ADDMACI      MACI
     C                     Z-ADDMADI      MADI
     C                     Z-ADDNAUP      NAUP
     C                     Z-ADDNOAU      NOAU
     C                     Z-ADDNOCF      NOCF
     C                     Z-ADDNOCL      NOCL
     C                     Z-ADDNOOA      NOOA
     C                     Z-ADDNORD      NORD
     C                     Z-ADDDBASE     DBASE
     C                     Z-ADDENOC      ENOC
     C                     Z-ADDEPNO      EPNO
     C                     Z-ADDECFB      ECFB
     C                     MOVE F1FONA    FONA1                           CGL004
     C                     MOVE F1FNSQ    FNSQ1                           CGL004
     C                     MOVE F1GN42    GN421                           CGL004
      *                                                                                       CER047
     C           ATYP      IFEQ 'R'                                                           CER047
     C           CER047    ANDEQ'Y'                                                           CER047
      *                                                                                       CER047
     C                     MOVE *ON       *IN09                                               CER047
     C                     ELSE                                                               CER047
     C                     MOVE *OFF      *IN09                                               CER047
      *                                                                                       CER047
     C                     ENDIF                                                              CER047
      *                                                                                       CER047
     C           CTI006    IFEQ 'Y'                                                         MD034725
     C                     MOVE *ON       *IN51                                             MD034725
     C                     ENDIF                                                            MD034725
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CCP1                                           S01408
     C*                                                                   S01408
      *-------------------------------------------------------------------
     C* Output to printer file
     C*
     C           *IN21     IFEQ '1'
     C           *INU7     ANDEQ'0'
     C* Header format
     C                     WRITEGL3572HR                                  170996
     C           CRE075    IFEQ 'Y'                                                           CRE075
     C           ATYP      ANDEQ'R'                                                           CRE075
     C                     Z-ADDACEFDT    ZDAYNO                                              CRE075
     C                     EXSR ZDATE2                                                        CRE075
     C**********           MOVE ZADATE    DDEFDT  6                                  CRE075 AR762809
     C                     MOVE ZADATE    DDEFDT  7                                         AR762809
     C                     SETON                         17                                   CRE075
     C                     ENDIF                                                              CRE075
     C                     WRITEGL3572F1
     C                     SETOF                         17                                   CRE075
     C           *IN19     IFEQ '1'
     C/COPY WNCPYSRC,GL3572C017
     C* Interest details
     C                     WRITEGL3572F2
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CPLH                                           S01408
     C*                                                                   S01408
     C* Overdraft
     C                     WRITEGL3572F3
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CLH1                                           S01408
     C*                                                                   S01408
     C* Charges
     C                     WRITEGL3572F4
     C*
     C* Commission
     C*
     C                     WRITEGL3572F5
     C*                                                                   170996
     C* Header details                                                    170996
     C*                                                                   170996
     C                     WRITEGL3572HR                                  170996
     C* Other details
     C*                                                                   S01408
     C           ULX004    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
     C/COPY WNCPYSRC,GL3572CCP5                                           S01408
     C           WECOAC    IFEQ *BLANKS                                                       CER001
     C                     MOVE *BLANKS   W#COAC                                              CER001
     C                     ELSE                                                               CER001
     C                     MOVE WWCNUM    W#CNUM                                              CER001
     C                     MOVE '-'       W#HF1                                               CER001
     C                     MOVE WWCCY     W#CCY                                               CER001
     C                     MOVE '-'       W#HF2                                               CER001
     C                     MOVE WWACOD    W#ACOD                                              CER001
     C                     MOVE '-'       W#HF3                                               CER001
     C                     MOVE WWACSQ    W#ACSQ                                              CER001
     C                     ENDIF                                                              CER001
     C*                                                                   S01408
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     WRITEGL3572F6
      *                                                                                       CRE015
      ** Periods and Penalties Details                                                        CRE015
      *                                                                                       CRE015
     C           CRE015    IFEQ 'Y'                                                           CRE015
      *                                                                                       CRE015
     C           KREKEY    SETLLREPRPNL2                                                      CRE015
     C           KREKEY    READEREPRPNL2                 99                                   CRE015
     C                     MOVEL'Y'       HDRIND  1                                           CRE015
      *                                                                                       CRE015
     C           *IN99     DOWEQ'0'                                                           CRE015
      *                                                                                       CRE015
     C           HDRIND    IFEQ 'Y'                                                           CRE015
     C                     WRITEGL3572R1                                                      CRE015
     C                     MOVEL'N'       HDRIND  1                                           CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
      **  Start Date                                                                          CRE015
      **  End Date                                                                            CRE015
      *                                                                                       CRE015
     C                     Z-ADDE2VDAT    ZDAYNO                                              CRE015
     C                     EXSR ZDATE2                                                        CRE015
     C                     MOVE ZADATE    E2SDAT                                              CRE015
      *                                                                                       CRE015
     C                     Z-ADDE2CEDE    ZDAYNO                                              CRE015
     C                     EXSR ZDATE2                                                        CRE015
     C                     MOVE ZADATE    E2EEDE                                              CRE015
      *                                                                                       CRE015
      ** Debit and Credit Cap Day and Month                                                   CRE015
      *                                                                                       CRE015
     C                     MOVELE2DRDY    E2DRDD                                              CRE015
     C                     MOVE E2DRDY    E2DRDM                                              CRE015
     C                     MOVELE2CRDY    E2CRDD                                              CRE015
     C                     MOVE E2CRDY    E2CRDM                                              CRE015
      *                                                                                       CRE015
      ** Period Initial Balance                                                               CRE015
      *                                                                                       CRE015
     C   70                Z-ADDE2BALN    E2BAL0                                              CRE015
     C   71                Z-ADDE2BALN    E2BAL1                                              CRE015
     C   72                Z-ADDE2BALN    E2BAL2                                              CRE015
     C   73                Z-ADDE2BALN    E2BAL3                                              CRE015
      *                                                                                       CRE015
      ** If overflow encountered, print header and Period and Penalty header                  CRE015
      *                                                                                       CRE015
     C                     Z-ADD11        RQDLN   20                                          CRE015
     C           OFLLN     SUB  PRTLN     REMLN   20                                          CRE015
     C           REMLN     IFLT RQDLN                                                         CRE015
     C                     MOVE '1'       *IN98                                               CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE '0'       *IN98                                               CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
     C           *IN98     IFEQ '1'                                                           CRE015
     C                     WRITEGL3572HR                                                      CRE015
     C                     WRITEGL3572R1                                                      CRE015
     C                     MOVE '0'       *IN98                                               CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
     C                     WRITEGL3572R2                                                      CRE015
     C           KREKEY    READEREPRPNL2                 99                                   CRE015
     C                     ENDDO                                                              CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
     C*                                                                   CGL004
     C* Fontis Account Details.                                           CGL004
     C*                                                                   CGL004
     C           *IN36     IFEQ '1'                                       CGL004
     C                     WRITEGL3572F7                                  CGL004
     C                     ENDIF                                          CGL004
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
     C                     WRITEGL3572F9                                                      CER001
     C                     ENDIF                                                              CER001
     C*                                                                   S01408
     C/COPY WNCPYSRC,GL3572CLH2                                           S01408
     C*                                                                   S01408
      ** If BoE yellow book is 'on'                                                          LLN022A
      *                                                                                      LLN022A
     C           LLN007    IFEQ 'Y'                                                          LLN022A
     C                     WRITEGL3572FA                                                     LLN022A
      *                                                                                      LLN022A
      ** Set display file fields to blank                                                    LLN022A
      *                                                                                      LLN022A
     C                     MOVE *BLANK    L#NETI           Netting Ind.                      LLN022A
     C                     MOVE *BLANK    L#DPTP           Deposit type                      LLN022A
     C                     MOVE *BLANK    L#SNOD           SAYE/Shrsav nd                    LLN022A
     C                     MOVE *BLANK    L#LNTP           Loan type                         LLN022A
     C                     MOVE *BLANK    L#MDAT           Loan mat date                     LLN022A
     C                     MOVE *BLANK    L#LLIM           Loan limit                        LLN022A
     C                     ENDIF                                                             LLN022A
     C*                                                                                      LLN022A
     C                     END
      *                                                                                       CGL018
      * Output RWA details for each account                                                   CGL018
      *                                                                                       CGL018
     C           CGL018    IFEQ 'Y'                                                           CGL018
     C                     EXSR RWADTL                                                        CGL018
     C                     WRITEGL3572F8                                                      CGL018
     C                     ENDIF                                                              CGL018
      *                                                                                       CGL018
     C/COPY WNCPYSRC,GL3572C001
      *                                                                                      LLN022A
      ** If yellow book feature is 'on'                                                      LLN022A
      *                                                                                      LLN022A
     C           LLN007    IFEQ 'Y'                                                          LLN022A
      *                                                                                      LLN022A
      ** Convert 5-decimal date field to DDMMYY                                              LLN022A
      *                                                                                      LLN022A
     C                     Z-ADDLMDAT     ZDAYNO                                             LLN022A
     C                     EXSR ZDATE2                                                       LLN022A
      *                                                                                      LLN022A
     C                     MOVELZDATE     L#MDAT           Loan Mat. Date                    LLN022A
      *                                                                                      LLN022A
     C                     MOVELLNETI     L#NETI           For Netting                       LLN022A
     C                     MOVELLDPTP     L#DPTP           Deposit type                      LLN022A
     C                     MOVELLSNOD     L#SNOD           SAYE/Sh not.day                   LLN022A
     C                     MOVELLLNTP     L#LNTP           Loan Type                         LLN022A
     C                     MOVELLLLIM     L#LLIM           Loan Limit                        LLN022A
      *                                                                                      LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
     C                     END
      *-------------------------------------------------------------------
     C*
     C/SPACE 3
     CLRN75N87             SETON                     87
     CLR         NAUP      COMP 0                        56
     CLR U1                GOTO U1ON
     C*
     C*    COMPARE FILE CONTROL TOTALS.
     C*
     C*
     C** SKIP CONTROL CHECK WHEN SINGLE BRANCH IS SELECTED
     C*
     CLR         MBIN      IFEQ 'Y'
     CLR         BRNCH     ANDEQ'ALL'
     CLR         MBIN      OREQ 'N'
     CLR         NINU      ADD  NORE      NORE             INTERIM RUN
     CLR         NORE      ADD  NINP      NORE
     C*
     CLR         NREC      COMP NORE                 U8U8
     CLR                   END
     C*
     C*    U1 ON INDICATES AMENDMENTS RUN.
     CLR                   GOTO EMPTY
     C*
     CLR         U1ON      TAG                             ** U1ON TAG **
     C*
     C*    ACCUMULATE TOTALS.
     CLR         NINU      ADD  NINP      NOOP    50
     CLR         NOAM      ADD  NAMP      NOOM    50
     CLR         NOCL      SUB  NOCF      NOCLAC  50
     C*
     CLR         EMPTY     TAG
     CLR         MBIN      IFEQ 'Y'
     CLR         BRNCH     ANDNE'ALL'
     CLR                   SETON                     78
     CLR                   END
     C*
     CLR                   Z-ADDSFNUMU    SFNUM2  60
     CLR                   OUT  LDA
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ
     CLR                   PARM '     '   SENTY
     CLR                   PARM           SFILEU
     CLR                   PARM           SFNUM2
     CLR                   PARM *BLANKS   ZSERR   1
     C*
     CLR         *LOCK     IN   LDA
     CLR         ZSERR     IFEQ 'Y'
     C*
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     CLR                   SETON                     U7U8LR
     CLR                   RETRN
     CLR                   END
     C*
     CLR         MBIN      IFEQ 'Y'
     CLR         BRNCH     ANDEQ'ALL'
     CLR         MBIN      OREQ 'N'
     C*
     C*    COMPARE ACCUMULATED AND CALCULATED TOTALS.
     C*
     C*  (ONLY TO BE DONE WHEN U1 IS ON AS TOTALISATION OF FIELDS
     C*  IS ONLY DONE IN AUDIT MODE - GLC3271.)
     CLR U1      NOOP      COMP CNINU                2222
     CLR U1      NOOM      COMP CNOAM                2323
     CLR U1      NOCLAC    COMP CNOCL                2424
     CLR U1      NOCF      COMP CNOCF                2525
     CLR U1      NORD      COMP CNORD                2626
     C**
     C*
     CLR                   END
     C*
     C** PRINT NO DETAILS TO REPORT ON EXCEPTIONAL CASES
     C*
     CLR         *IN75     IFEQ '1'
     CLR         *IN76     ANDEQ'0'
     C**
     C**   ACCESS BANK DETAILS
     C**
     CLR                   CALL 'AOBANKR0'
     CLR                   PARM '*MSG   ' @RTCD   7
     CLR                   PARM '*FIRST ' @OPTN   7
     CLR         SDBANK    PARM SDBANK    DSFDY
     C*
     CLR         @RTCD     IFNE *BLANK
     CLR                   SETON                     U7U8
     CLR                   MOVEL'SDBANKPD'DBFILE
     CLR                   MOVEL@OPTN     DBKEY            ***************
     CLR                   MOVEL@OPTN     DBOPTN  7        * DBERROR 006 *
     CLR                   MOVEL'006'     DBASE            ***************
     CLR                   EXSR *PSSR
     CLR                   END
     CLR                   WRITENODTL2
     CLR                   WRITENODTL2B
     CLR                   END
     C* End of report for last branch
     CLR         *IN75     IFEQ '1'
     CLR         *INU7     ANDEQ'0'
     CLR                   WRITEGL3572FT
     CLR                   WRITEGL3572FB
     CLR                   END
     C*
     CLR         *IN75     IFEQ '0'
     CLR         BRNCH     ANDNE'ALL'
     CLR         *IN89     ANDEQ'0'
     C**
     C** CHECK THE MULTIBRANCHING INDICATOR
     CLR                   IN   RUNDT
     C*
     CLR         MBIN      IFEQ 'Y'
     CLR                   SETON                     8788
     CLR                   OPEN GL3572P1
     CLR                   Z-ADDSFNUM     SFNUM1  60
     CLR                   OUT  LDA
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ
     CLR                   PARM BRNCH     SENTY
     CLR                   PARM           SFILE
     CLR                   PARM           SFNUM1
     CLR                   PARM *BLANKS   ZSERR   1
     C*
     CLR         *LOCK     IN   LDA
     CLR         ZSERR     IFEQ 'Y'
     C*
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     CLR                   SETON                     U7U8LR
     CLR                   RETRN
     CLR                   END
     C** To get Branch Name
     C*LR*******           CALL 'AOBRCHR0'                                                    CGL029
     CLR                   CALL 'AOBRCHR1'                                                    CGL029
     CLR                   PARM '*MSG   ' @RTCD   7
     CLR                   PARM '*KEY   ' @OPTN   7
     CLR                   PARM BRNCH     @DSNB   3
     C*LR******* SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     CLR         SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     CLR         @RTCD     IFNE *BLANK
     CLR                   SETON                     U7U8LR
     CLR                   MOVEL'SDBRCHPD'DBFILE
     CLR                   MOVEL@DSNB     DBKEY            ***************
     CLR                   MOVEL@OPTN     DBOPTN  7        * DBERROR 013 *
     CLR                   MOVEL'013'     DBASE            ***************
     CLR                   EXSR *PSSR
     CLR                   END
     C**
     C**   ACCESS BANK DETAILS
     C**
     CLR                   CALL 'AOBANKR0'
     CLR                   PARM '*MSG   ' @RTCD   7
     CLR                   PARM '*FIRST ' @OPTN   7
     CLR         SDBANK    PARM SDBANK    DSFDY
     C*
     CLR         @RTCD     IFNE *BLANK
     CLR                   SETON                     U7U8
     CLR                   MOVEL'SDBANKPD'DBFILE
     CLR                   MOVEL@OPTN     DBKEY            ***************
     CLR                   MOVEL@OPTN     DBOPTN  7        * DBERROR 007 *
     CLR                   MOVEL'007'     DBASE            ***************
     CLR                   EXSR *PSSR
     CLR                   END
     CLRNU7                WRITENODTL2
     CLRNU7                WRITENODTL2B
     CLR U7                WRITENODTL
     CLR U7                WRITENODTLB
     CLR                   END
     CLR                   END
     C*
     CLR         *IN75     IFEQ *OFF                                      MD031966
     C**   ACCESS BANK DETAILS                                            MD031966
     C**                                                                  MD031966
     CLR                   CALL 'AOBANKR0'                                MD031966
     CLR                   PARM '*MSG   ' @RTCD   7                       MD031966
     CLR                   PARM '*FIRST ' @OPTN   7                       MD031966
     CLR         SDBANK    PARM SDBANK    DSFDY                           MD031966
     C*                                                                   MD031966
     CLR         @RTCD     IFNE *BLANK                                    MD031966
     CLR                   SETON                     U7U8                 MD031966
     CLR                   MOVEL'SDBANKPD'DBFILE                          MD031966
     CLR                   MOVEL@OPTN     DBKEY            ***************MD031966
     CLR                   MOVEL@OPTN     DBOPTN  7        * DBERROR 011 *MD031966
     CLR                   MOVEL'011'     DBASE            ***************MD031966
     CLR                   EXSR *PSSR                                     MD031966
     CLR                   ELSE                                           MD031966
     CLR                   TIME           MTIME                           MD031966
     CLR                   MOVE BJMRDT    RUNA                            MD031966
     CLR                   ENDIF                                          MD031966
     CLR                   ENDIF                                          MD031966
     C**                                                                  MD031966
     C/COPY WNCPYSRC,GL3572C026
     CLR         FINISH    TAG                             ** FINISH TAG *
      *-------------------------------------------------------------------
     C* Audit formats
     C** Initialisation of the output file fields if SADET empty          084517
     CLRN10                Z-ADD0         NOCL                            084517
     CLRN40                Z-ADD0         NOCL                            084517
     CLRN10                Z-ADD0         NOCF                            084517
     CLRN40                Z-ADD0         NOCF                            084517
     CLRN10                Z-ADD0         NORD                            084517
     CLRN40                Z-ADD0         NORD                            084517
     CLRN10                Z-ADD0         NOOA                            084517
     CLRN40                Z-ADD0         NOOA                            084517
     CLRN10                Z-ADD0         NAUP                            084517
     CLRN40                Z-ADD0         NAUP                            084517
     CLRN10                Z-ADD0         CINUAF                          084517
     CLRN40                Z-ADD0         CINUAF                          084517
     CLRN10                Z-ADD0         COCLAF                          084517
     CLRN40                Z-ADD0         COCLAF                          084517
     CLRN10                Z-ADD0         COCFAF                          084517
     CLRN40                Z-ADD0         COCFAF                          084517
     C*                                                                   084517
     CLR                   WRITEGL3572AH
     CLRNU1                WRITEGL3572A1
     CLR U1                WRITEGL3572A2
     CLR U7                WRITEGL3572A3
     CLR 87NU7
     CANN79                WRITENODTLT
     CLR                   WRITEGL3572AT
      *-------------------------------------------------------------------
     C/COPY WNCPYSRC,GL3572C018
     C*
     C/COPY WNCPYSRC,GL3572C019
     C********************************************************************
     C**
     C**   SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     CSR         ZDATE2    BEGSR                           ZDATE2 BEGSR
     C**
     C**   CLEAR DATE FIELDS.
     CSR                   Z-ADD0         ZDATE   60
     CSR                   MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     CSR                   Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     CSR         ZDAYNO    SUB  1         ZDAYN1  50   99
     CSR 99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     CSR         ZDAYN1    DIV  1461      ZLYR    20
     CSR                   MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS.
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     CSR                   Z-ADD1         ZWRK2   20
     CSR         ZDTAG1    TAG                             ZDTAG1 TAG
     CSR         ZDAYN1    COMP ZYDY,ZWRK2             90
     CSRN90      ZWRK2     ADD  1         ZWRK2
     CSRN90                GOTO ZDTAG1
     CSR         ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON.
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     CSRN91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     CSR         ZLYR      MULT 4         ZWRK3   30
     CSR         ZWRK3     ADD  72        ZWRK3            BASE IS 1972.
     CSR                   Z-ADDZWRK3     ZYEAR   20
     CSR         ZYEAR     ADD  ZWRK2     ZYEAR            YEAR.
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     CSR                   SETOF                     9293
     CSR 91      ZDAYN1    COMP 59                     9293
     CSR 91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     CSR                   Z-ADD2         ZWRK2
     CSR         ZDTAG2    TAG                             ZDTAG2 TAG
     CSR         ZDAYN1    COMP ZMDY,ZWRK2             94
     CSRN94      ZWRK2     ADD  1         ZWRK2
     CSRN94                GOTO ZDTAG2
     CSR         ZWRK2     SUB  1         ZWRK2
     C**
     CSR                   Z-ADDZWRK2     ZMTH    20       MONTH.
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     CSR         ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     CSR         ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY.
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     CSR 93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     CSRN98                MOVELZDAY      ZWRK4   40
     CSR 98                MOVE ZDAY      ZWRK4
     CSRN98                MOVE ZMTH      ZWRK4
     CSR 98                MOVELZMTH      ZWRK4
     CSR                   MOVELZWRK4     ZDATE
     CSR                   MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     CSR         ZDAY      COMP 10                     95
     CSR                   MOVELZDAY      ZWRK5   5
     CSR 95                MOVEL' '       ZWRK5
     CSR                   MOVE ZMNM,ZMTH ZWRK5
     CSR                   MOVELZWRK5     ZADATE
     CSR                   MOVE ZYEAR     ZADATE
     C**
     CSR         ZDEND2    ENDSR                           ZDEND2 ENDSR
     C**
     C**
     C********************************************************************
     C**
     C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
     C**   DECIMAL PLACES FOR THOSE CURRENCIES.
     C**
     C           CCYARR    BEGSR                           *** CCYARR  ***
     C**
     C**   SET OFF ERROR INDICATOR
     C                     SETOF                     99
     C**
     C**   SET ARRAY INDEX TO ZERO.
     C                     Z-ADD0         X       30
     C**
     C**   SET UP KEY FOR CURRENCY TABLE.
     C                     MOVE *BLANKS   W@CKEY  3
     C**
     C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
     C           W@CKEY    SETLLSDCURRL0
     C**
     C**   LOOP TO READ CURRENCY DETAIL RECORDS.
     C           XLOOP     TAG                             ** XLOOP TAG **
     C                     READ SDCURRL0                 99
     C**
     C**   END IF ALL CURRENCY RECORDS PROCESSED
     C   99                GOTO XEND
     C**
     C**   INCREMENT ARRAY INDEX.
     C           X         ADD  1         X
     C**
     C**   MOVE DATA INTO ARRAYS.
     C                     MOVE A6CYCD    CCYA,X
     C                     MOVE A6NBDP    DPA,X
     C**
     C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
     C           X         COMP 150                      96
     C**
     C**   GO TO READ NEXT RECORD.
     C  N96                GOTO XLOOP
     C**
     C           XEND      TAG                             ** XEND TAG  **
     C                     ENDSR
     C**
     C********************************************************************
      * Include ZEDIT for german standards
     C********************************************************************
     C**                                                                 *
     C**  GEDIT SUBROUTINE TO INSERT A DECIMAL POINT INTO A NUMERIC FIELD*
     C**  AND TO BLANK OUT LEADING ZEROES.                               *
     C**      INPUT FIELDS:   ZFIELD 16/                                 *
     C*                       ZADEC                                      *
     C*                       ZADIG - NOT ACTUALLY USED                  *
     C*                                                                  *
     C*       ARRAYS    ZA1 ,ZA2   BOTH 16 ELEMENTS, EACH ONE BYTE LONG. *
     C*                                                                  *
     C*       OUTPUT FIELD   ZFIELD                                      *
     C*                                                                  *
     C           GEDIT     BEGSR                           ***  GEDIT  ***
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**                                                                 *
     C*       SET UP WORK FIELDS                                         *
     C*                                                                  *
     C                     MOVEA' '       ZA1                            *
     C                     MOVEA' '       ZA2                            *
     C*                                                                  *
     C                     Z-ADD16        Z1      20                     *
     C                     Z-ADD16        Z2      20                     *
     C*                                                                  *
     C           16        SUB  ZADEC     ZADEC2  20                     *
     C*                                                                  *
     C*
     C                     MOVEAZFIELD    ZA1                            *
     C*                                                                  *
     C*       CHECK TO SEE IF THERE ARE ANY DECIMAL PLACES               *
     C*                                                                  *
     C           ZADEC     COMP 0                        91              *
     C   91                GOTO ZT20                                     *
     C**                                                                 *
     C           ZT10      TAG                             ** ZT10 TAG ***
     C**                                                                 *
     C*                                                                  *
     C*       SET UP DECIMALS                                            *
     C*                                                                  *
     C                     MOVE ZA1,Z1    ZA2,Z2                         *
     C           Z1        SUB  1         Z1                             *
     C           Z2        SUB  1         Z2                             *
     C*                                                                  *
     C           Z2        COMP 0                        90              *
     C   90                GOTO ZT30                                     *
     C*                                                                  *
     C*       CHECK IF END OF DECIMALS                                   *
     C**                                                                 *
     C           Z2        COMP ZADEC2               90                  *
     C   90                GOTO ZT10                                     *
     C*                                                                  *
     C**                                                                 *
     C*       PUT IN DECIMAL PLACE                                       *
     C*                                                                  *
     C                     MOVE ','       ZA2,Z2                         *
     C           Z2        SUB  1         Z2                             *
     C*                                                                  *
     C           ZT20      TAG                             ** ZT20 TAG ***
     C*                                                                  *
     C*       SET UP INTEGERS                                            *
     C*                                                                  *
     C                     MOVE ZA1,Z1    ZA2,Z2                         *
     C           Z1        SUB  1         Z1                             *
     C           Z2        SUB  1         Z2                             *
     C**                                                                 *
     C           Z2        COMP 0                    90                  *
     C   90                GOTO ZT20                                     *
     C*                                                                  *
     C*       PUT IN LEADING BLANKS                                      *
     C*                                                                  *
     C           ZT30      TAG                             ** ZT30 TAG ***
     C**                                                                 *
     C                     Z-ADD1         Z2                             *
     C**                                                                 *
     C           ZT40      TAG                             ** ZT40 TAG ***
     C*                                                                  *
     C           ZA2,Z2    COMP '0'                  9090                *
     C   90      ZA2,Z2    COMP ' '                  9090                *
     C*                                                                  *
     C   90                GOTO ZT50                                     *
     C*                                                                  *
     C                     MOVE ' '       ZA2,Z2                         *
     C           Z2        ADD  1         Z2                             *
     C*                                                                  *
     C           Z2        COMP 16                     90                *
     C   90                GOTO ZT40                                     *
     C*                                                                  *
     C*       IF NO INTEGERS PUT IN LEADING ZERO                         *
     C*                                                                  *
     C           ZT50      TAG                             ** ZT50 TAG ***
     C*                                                                  *
     C                     Z-ADDZADEC2    Z2                             *
     C  N91      Z2        SUB  1         Z2                             *
     C           ZA2,Z2    COMP ' '                      90              *
     C   90                MOVE '0'       ZA2,Z2                         *
     C*                                                                  *
     C*       SET UP OUTPUT FIELD                                        *
     C*                                                                  *
     C           ZT60      TAG                             ** ZT60 TAG ***
     C*                                                                  *
     C                     MOVEAZA2       ZFIELD 16                      *
     C**                                                                 *
     CSR         GEND      ENDSR                           ** GEND **    *
     C**
     C********************************************************************
     C*
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
     C*
     C* CALLED FROM: AFTER ABNORMAL OPERATION OCCURS
     C*
     C* CALLS: NOTHING
     C*
     C********************************************************************
     C*
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C*
     C                     ENDSR                           ** *PSSR **
     C*****************************************************************
     C*                                                                                       208221
     C/COPY ZSRSRC,ZSEDITZ3                                                                   208221
     C*                                                                                       208221
      * RWA       : Output RWA information from GLORWAPD                *                     CGL018
      * ---                                                             *                     CGL018
      * Called By : CAPRDT                                              *                     CGL018
      * Calls     : None                                                *                     CGL018
      *******************************************************************                     CGL018
     C           RWADTL    BEGSR                                                              CGL018
      *                                                                                       CGL018
     C           KREKEY    SETLLGLARWAD0                                                      CGL018
     C           KREKEY    READEGLARWAD0                 97                                   CGL018
     C                     MOVE *BLANKS   XRWA                                                CGL018
     C                     MOVEL*BLANKS   RWASE                                               CGL018
     C                     MOVEL*BLANKS   RWASEC                                              CGL018
     C                     MOVEL*BLANKS   #CONTI                                              CGL018
     C                     Z-ADD0         U       20                                          CGL018
     C           *IN97     DOWEQ'0'                                                           CGL018
      *                                                                                       CGL018
     C                     ADD  1         U                                                   CGL018
     C                     MOVE RWCODE    #RCODE                                              CGL018
     C                     MOVE RWSETN    #RSET                                               CGL018
      *                                                                                       CGL018
     C           U         IFGT 18                                                            CGL018
     C           #CONTI    ANDNE'C'                                                           CGL018
     C                     Z-ADD1         U                                                   CGL018
     C                     MOVEL'C'       #CONTI  1                                           CGL018
     C                     MOVEL*BLANKS   RWASE                                               CGL018
     C                     MOVEAXRWA      RWASE                                               CGL018
     C                     MOVE *BLANKS   XRWA                                                CGL018
     C                     ENDIF                                                              CGL018
      *                                                                                       CGL018
     C                     MOVEARWSECO    XRWA,U                                              CGL018
      *                                                                                       CGL018
     C           KREKEY    READEGLARWAD0                 97                                   CGL018
     C                     ENDDO                                                              CGL018
      *                                                                                       CGL018
     C           U         IFEQ 0                                                             CGL018
     C                     MOVEL'None'    RWASE                                               CGL018
     C                     ELSE                                                               CGL018
      *                                                                                       CGL018
      * Last one must be without comma, so clear and output again                             CGL018
      *                                                                                       CGL018
     C                     MOVEL*BLANKS   #COMMA                                              CGL018
     C                     MOVEARWSECO    XRWA,U                                              CGL018
      *                                                                                       CGL018
     C           #CONTI    IFEQ 'C'                                                           CGL018
     C                     MOVEAXRWA      RWASEC                                              CGL018
     C                     ELSE                                                               CGL018
     C                     MOVEAXRWA      RWASE                                               CGL018
     C                     ENDIF                                                              CGL018
      *                                                                                       CGL018
     C                     MOVEL','       #COMMA                                              CGL018
     C                     ENDIF                                                              CGL018
      *                                                                                       CGL018
     C                     ENDSR                                                              CGL018
      *******************************************************************                     CGL018
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
