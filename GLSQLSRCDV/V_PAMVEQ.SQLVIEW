/*******************************************************************************/
/*                                                                             */
/*       Midas - General Ledger Module                                         */
/*                                                                             */
/*       V_PAMVEQ - Midas GL Projected Account Movements Enquiry               */
/*                                                                             */
/*       (c) Finastra International Limited 2004                               */
/*                                                                             */
/*       Last Amend No. CSD103 *CREATE   Date 20Oct20                          */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       CSD103 - Libor Deregulation - General Section                         */
/*******************************************************************************/
                                                                                :
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  AS                                                                            :
  SELECT RSACMTPD.CCYD, RSACMTPD.BRCA, RSACMTPD.CUSN,                           :
  RSACMTPD.ACDE, RSACMTPD.ASNC, RSACMTPD.PTDT,                                  :
  RSACMTPD.VUDT,                                                                :
  CASE                                                                          :
  WHEN RSACMTPD.PRFL='Y' THEN 'YES'                                             :
  ELSE 'NO'                                                                     : 
  END AS PRFL,                                                                  : 
  CASE                                                                          : 
  WHEN RSACMTPD.CQNR=0 THEN ''                                                  : 
  END AS CQNR,                                                                  : 
  CAST(RSACMTPD.TNMR AS CHAR(30)) TNMR,                                         :
  RSACMTPD.TRYP,                                                                :
  RSACMTPD.DORC,                                                                :
  CASE                                                                          :
  WHEN RSACMTPD.DORC=0 THEN (RSACMTPD.MVAM * 1)                                 :
  ELSE (RSACMTPD.MVAM * -1)                                                     : 
  END AS MVAM,                                                                  : 
  CASE WHEN (SELECT COUNT(*) FROM YBDTALIB.SCSARDPD WHERE SARN = 'S01472') > 0  :
  THEN CASE WHEN RSACMTPD.CUSN <> '' THEN ''                                    :
  ELSE '' END                                                                   :
  ELSE '' END AS ABTCH                                                          :
  FROM YBDMLIB.RSACMTPD RSACMTPD                                                :
  UNION ALL                                                                     :
  SELECT CLEARPD.CCY AS CCYD, CLEARPD.BRCA, CLEARPD.CNUM AS CUSN,               : 
  CLEARPD.ACOD AS ACDE, CLEARPD.ACSQ AS ASNC,CLEARPD.PSTD AS PTDT,              :
  CLEARPD.VALD AS VUDT,                                                         : 
  CASE                                                                          : 
  WHEN CLEARPD.CNUM <> '' THEN 'NO'                                             :
  ELSE 'NO'                                                                     :
  END AS PRFL,                                                                  : 
  CASE                                                                          :
  WHEN CLEARPD.CHQN=0 THEN ''                                                   : 
  END AS CQNR,CLEARPD.PNAR AS TNMR                                              :
  CASE                                                                          :
  WHEN CLEARPD.TRAT > 0 THEN VARCHAR(LPAD(CLEARPD.TRAT,5,'0'))                  : 
  ELSE '00000' END AS TRYP,                                                     :
  CLEARPD.DRCR AS DORC,                                                         :
  CASE                                                                          :
  WHEN CLEARPD.DRCR=0 THEN (CLEARPD.PSTA * 1)                                   : 
  ELSE (CLEARPD.PSTA * -1)                                                      :
  END AS MVAM,                                                                  :
  CASE WHEN (SELECT COUNT(*) FROM YBDTALIB.SCSARDPD WHERE SARN = 'S01472') > 0  : 
  THEN CASE WHEN SUBSTR(CLEARPD.SPOS, 1, 2) = '' THEN ''                        :
  ELSE SUBSTR(CLEARPD.SPOS, 1, 3) END                                           :
  ELSE '' END AS ABTCH                                                          :
  FROM YBDMLIB.CLEARPD CLEARPD                                                  :
 LABEL ON TABLE V_PAMVEQ IS 'Projected Account Movements';                      :
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GL Projected Account Movements                 ';                  :
                                                                                :
 