/*******************************************************************************/
/*                                                                             */
/*       Midas - General Ledger Module                                         */
/*                                                                             */
/*       V_CLACCNTB - Account Details with Position                            */
/*                                                                             */
/*       (c) Finastra International Limited 2004                               */
/*                                                                             */
/*       Last Amend No. CSD103             Date 10Aug20                        */
/*       Prev Amend No. MD046248           Date 27Oct17                        */
/*                      CRE073             Date 06Dec10                        */
/*                      CRE075             Date 06Dec10                        */
/*                      CER059             Date 19Jul10                        */
/*                      CER047             Date 19May08                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/*                      BG18886            Date 02Jun08                        */
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      CSD031             Date 10Apr06                        */
/*                      CSD027             Date 10Dec05                        */
/*                      CAP086             Date 08Jun05                        */
/*                      BUG5391            Date 18Jan05                        */
/*                      BUG3644 *CREATE    Date 12Jul04                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       CSD103 - LIBOR Deregulation - Common Layer/Standing Data              */
/*                (Recompile)                                                  */
/*       MD046248 - Finastra Rebranding                                        */
/*       CRE073 - Interest Rate Rounding (Recompile)                           */
/*       CRE075 - Effective Date for Retail Accounts (Recompile)               */
/*       CER059 - German Feature Upgrade to Delhi                              */
/*       CER047 - German Features LF037-00 Reporting §24c KWG                  */
/*                (Recompile)                                                  */
/*       BG18886 - Amend non-standard codes.                                   */
/*       CSD031 - Enhanced Centralised Static Data (Recompile)                 */
/*       CSD027 - Conversion Of Customer Number to Alpha                       */
/*       CAP086 - Introduce Auto Authorisation to the API's                    */
/*                without it. (Recompile)                                      */
/*       BUG5391 - Double display of values                                    */
/*       BUG3644 - Serious Error in Collateralised Lending                     */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  (                                                                             :
  BRCA ,                                                                        :
  CNUM ,                                                                        :
  PADCNUM ,                                                                     :
  CCY ,                                                                         :
  ACOD ,                                                                        :
  PADACOD ,                                                                     :
  ACSQ ,                                                                        :
  PADACSQ ,                                                                     :
  ACNO ,                                                                        :
  PADACNO ,                                                                     :
  CLBL ,                                                                        :
  MULTACCN ,                                                                    :
  A8ZONE ,                                                                      :
  P_NOML ,                                                                      :
  P_ASLI ,                                                                      :
  P_NMDP )                                                                      :
  AS                                                                            :
  SELECT                                                                        :
  BRCA,                                                                         :
  CNUM,                                                                         :
**DIGITS(CNUM)*AS*PADCNUM,******************************************************:             CSD027
         CNUM  AS PADCNUM,                                                      :             CSD027
  CCY,                                                                          :
  ACOD,                                                                         :
  DIGITS(ACOD) AS PADACOD,                                                      :
  ACSQ,                                                                         :
  DIGITS(ACSQ) AS PADACSQ,                                                      :
  ACNO,                                                                         :
  DIGITS(ACNO) AS PADACNO,                                                      :
  CLBL,                                                                         :
**BRCA**DIGITS(CNUM)**CCY**DIGITS(ACOD)**DIGITS(ACSQ)*AS*MULTACCN,**************:             CSD027
**BRCA*********CNUM***CCY**DIGITS(ACOD)**DIGITS(ACSQ)*AS*MULTACCN,**************:     CSD027 BG18886
  BRCA CONCAT CNUM CONCAT CCY CONCAT DIGITS(ACOD)                               :     CSD027 BG18886
      CONCAT DIGITS(ACSQ) AS MULTACCN,                                          :     CSD027 BG18886
  A8ZONE,                                                                       :
  P_NOML,                                                                       :
  P_ASLI,                                                                       :
  P_NMDP                                                                        :
  FROM                                                                          :
  (SELECT BRCA,CNUM,CCY,ACOD,ACSQ,ACNO,CLBL,A8ZONE FROM GZACCNTAB, GZSDBRCHPD   :
  WHERE A8BRCD=BRCA) A, GPTRAPPD B, GPPOSNPD C                                  :
  WHERE T_MOD = 'GL' AND T_SMOD = 'ACCT' AND A.BRCA = T_BRCA AND A.CNUM=T_CNUM  :
  AND A.CCY= T_ACCY AND A.ACOD = T_ACDN AND A.ACSQ = T_ACSN                     :
/*AND*T_ID=P_ID*AND*P_TVDI='V'*AND*P_PSTP='C'*;*********************************:            BUG5391
  AND T_ID=P_ID AND P_TVDI='V' AND P_PSTP='C'                                   :            BUG5391
  AND T_ZONE=A8ZONE;                                                            :            BUG5391
                                                                                :            BUG5391
  LABEL ON COLUMN                                                               :
  **********/**********                                                         :
  ( BRCA IS 'Brch                Code' ,                                        :
  CNUM IS 'Customer            Number' ,                                        :
  CCY IS 'Curr                Code' ,                                           :
  ACOD IS 'Acc.                Code' ,                                          :
  ACSQ IS 'A/c                 Seq                 No.' ,                       :
  ACNO IS 'Retail              Account             Number' ,                    :
  CLBL IS 'Cleared             Balance' ,                                       :
  A8ZONE IS 'Zone' ,                                                            :
  P_NOML IS 'Nominal' ,                                                         :
  P_ASLI IS 'Asset/              Liability' ,                                   :
  P_NMDP IS 'Nominal             Decimal             Plces' ) ;                 :
                                                                                :
  LABEL ON COLUMN                                                               :
  **********/**********                                                         :
  ( BRCA TEXT IS 'Branch Code - Alpha' ,                                        :
  CNUM TEXT IS 'Customer number' ,                                              :
  CCY TEXT IS 'Currency code' ,                                                 :
  ACOD TEXT IS 'Account code' ,                                                 :
  ACSQ TEXT IS 'Account sequence number' ,                                      :
  ACNO TEXT IS 'Retail account number' ,                                        :
  CLBL TEXT IS 'Cleared balance' ,                                              :
  A8ZONE TEXT IS 'Zone' ,                                                       :
  P_NOML TEXT IS 'Nominal' ,                                                    :
  P_ASLI TEXT IS 'Asset/Liability' ,                                            :
  P_NMDP TEXT IS 'Nominal Decimal Places' ) ;                                   :
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GL Account Details with Position            ';                     :
                                                                                :
