/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       GPMNUJW2 - Midas SF Global menu action codes by unique code           */
/*                                                                             */
/*       (c) Finastra International Limited 2020                               */
/*                                                                             */
/*       Last Amend No. MD056561 *CREATE   Date 31Aug20                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD056561 - Deliverable Data Split for SFMENUPD and GPMTXTPD           */
/*                                                                             */
/*******************************************************************************/
                                                                                :
  create view                                                                   :
  **********/**********                                                         :
                                                                                :
  (                                                                             :
       MIINDX                                                                   :
     , MISECL                                                                   :
     , MISNAM                                                                   :
     , MIINAR                                                                   :
     , ALLOWACT                                                                 :
     , SELECTACT                                                                :
     , MIDEL                                                                    :
     , ADINDX                                                                   :
     , ADSARN                                                                   :
     , ADAVAL                                                                   :
     , SARN                                                                     :
     , MIMMSN                                                                   :
     , FOMMSN                                                                   :
     , FOMMIN                                                                   :
     , ENABLD                                                                   :
  )                                                                             :
  as select                                                                     :
       u.MIINDX                                                                 :
     , u.MISECL                                                                 :
     , y.MISNAM                                                                 :
     , y.MIINAR                                                                 :
     , CAST (  u.MIAAC1 CONCAT u.MIAAC2 CONCAT u.MIAAC3 CONCAT u.MIAAC4         :
        CONCAT u.MIAAC5 CONCAT u.MIAAC6 CONCAT u.MIAAC7                         :
        CONCAT u.MIAAC8 CONCAT u.MIAAC9 CONCAT u.MIAAC10 as CHAR(10))           :
     , CAST (z.DDUSRP as CHAR(10))                                              :
     , y.MIDEL                                                                  :
     , v.ADINDX                                                                 :
     , v.ADSARN                                                                 :
     , v.ADAVAL                                                                 :
     , w.SARN                                                                   :
     , u.MIMMSN                                                                 :
     , x.FOMMSN                                                                 :
     , x.FOMMIN                                                                 :
     , w.ENABLD                                                                 :
  FROM GPMNUJW0 u                                                               :
  LEFT OUTER JOIN GPSARIPD v ON ( u.MIINDX = v.ADINDX )                         :
  LEFT OUTER JOIN GPSRDXTD w ON ( v.ADSARN = w.SARN )                           :
  LEFT OUTER JOIN GPMMIDPD x ON ( u.MIMMSN = x.FOMMSN )                         :
  LEFT OUTER JOIN GPMTXJW0 y ON ( y.MIINDX = u.MIINDX )                         :
  LEFT OUTER JOIN GPAMUSPD z ON ( x.FOMMIN = z.DDACTN )                         :
  WHERE                                                                         :
  ( v.ADSARN IS NULL AND x.FOMMIN = 'Y'  and CAST (  u.MIAAC1 CONCAT            :
  u.MIAAC2 CONCAT u.MIAAC3 CONCAT u.MIAAC5 CONCAT u.MIAAC6 CONCAT               :
  u.MIAAC7 CONCAT u.MIAAC8 CONCAT u.MIAAC9 CONCAT u.MIAAC10 as CHAR(10))        :
   IS NOT NULL and y.MIDEL <> 'Y')                                              :
  OR                                                                            :
  ( v.ADSARN IS NOT NULL AND w.SARN IS NOT NULL and w.ENABLD = 'E' and          :
    v.ADAVAL = 'Y' and x.FOMMIN = 'Y' and CAST (  u.MIAAC1 CONCAT               :
  u.MIAAC2 CONCAT u.MIAAC3 CONCAT u.MIAAC5 CONCAT u.MIAAC6 CONCAT               :
  u.MIAAC7 CONCAT u.MIAAC8 CONCAT u.MIAAC9 CONCAT u.MIAAC10 as CHAR(10))        :
   IS NOT NULL and y.MIDEL <> 'Y')                                              :
  OR                                                                            :
  ( v.ADSARN IS NOT NULL AND w.SARN IS NOT NULL and w.ENABLD = 'D' and          :
    v.ADAVAL = 'N' and x.FOMMIN = 'Y' and CAST (  u.MIAAC1 CONCAT               :
  u.MIAAC2 CONCAT u.MIAAC3 CONCAT u.MIAAC5 CONCAT u.MIAAC6 CONCAT               :
  u.MIAAC7 CONCAT u.MIAAC8 CONCAT u.MIAAC9 CONCAT u.MIAAC10 as CHAR(10))        :
   IS NOT NULL and y.MIDEL <> 'Y')                                              :
  OR                                                                            :
  ( v.ADSARN IS NOT NULL AND w.SARN IS NOT NULL and w.ENABLD = 'D' and          :
    v.ADAVAL = 'N' and x.FOMMIN = 'Y' and CAST (  u.MIAAC1 CONCAT               :
  u.MIAAC2 CONCAT u.MIAAC3 CONCAT u.MIAAC5 CONCAT u.MIAAC6 CONCAT               :
  u.MIAAC7 CONCAT u.MIAAC8 CONCAT u.MIAAC9 CONCAT u.MIAAC10 as CHAR(10))        :
   IS NOT NULL and y.MIDEL <> 'Y');                                             :
                                                                                :
  LABEL ON TABLE **********/**********                                          :
  IS 'Midas SF Global menu action codes by unique code' ;                       :
                                                                                :
/*******************************************************************************/
