/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_GPCUSTPD - Global Customers                                         */
/*                                                                             */
/*       (c) Finastra International Limited 2003                               */
/*                                                                             */
/*       Last Amend No. MD046248           Date 27Oct17                        */
/*       Prev Amend No. CLE134             Date 01Aug12                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/*                      BUG18040           Date 25Apr08                        */
/*                      250460             Date 30Nov07                        */
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      CSD031             Date 10Apr06                        */
/*                      CSD027             Date 10Dec05                        */
/*                      CSW037A            Date 02May05                        */
/*                      CSD025             Date 11Jan05                        */
/*                      CSW037             Date 15Dec04                        */
/*                      CSW036             Date 15Dec04                        */
/*                      BUG3087            Date 26Jul04                        */
/*                      CGP001  *CREATE    Date 20Aug03                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD046248 - Finastra Rebranding                                        */
/*       CLE134 - Past Due Call Loan Processing (Recompile)                    */
/*       BUG18040 - Optimized query to improve performance                     */
/*       250460 - Select live customers only to improve performance            */
/*       CSD031 - Enhanced Centralised Static Data (Recompile)                 */
/*       CSD027 - Conversion Of Customer Number to Alpha                       */
/*       CSW037A- Additional Field extended to 40 chars (recompile)            */
/*       CSD025 - Customer De-Activation                                       */
/*       CSW037 - Additional Field Data on MT300/MT320                         */
/*       CSW036 - Dual SWIFT BIC held on Client Details                        */
/*       BUG3087 - Disable the add local customer button if no local customer  */
/*                 currently exists.                                           */
/*       CGP001 - Global Processing                                            */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  AS                                                                            :
  SELECT                                                                        :
**DISTINCT**********************************************************************:   BUG3087 BUG18040
  GPCUSTPD.*,                                                                   :
  CASE WHEN CUCHTP = 'D' THEN 'N' ELSE 'Y' END AS CUACTIVE                      :
**,*CASE*WHEN*LOCCUST.BBCUST*IS*NULL*THEN*'NONE'*ELSE*'EXISTS'*END*AS*CULOCCUST*:     BUG3087 250460
**,*CASE*WHEN*LOCCUST.CUGCUS*IS*NULL*AND*CUCHTP*<>*'D'*THEN*'NONE'*ELSE*********:    250460 BUG18040
  , CASE WHEN (LOCCUST.CUGCUS IS NULL OR CUCHTP = 'D') THEN 'NONE' ELSE         :           BUG18040
  'EXISTS'  END AS CULOCCUST                                                    :             250460
**FROM*GPCUSTPD*****************************************************************:            BUG3087
  FROM GPCUSTPD GPCUSTPD                                                        :            BUG3087
  LEFT OUTER JOIN                                                               :            BUG3087
**V_LOCCUST*LOCCUST*************************************************************:   BUG3087 BUG18040
  (SELECT DISTINCT CUGCUS FROM GPCUSTXPD) LOCCUST                               :           BUG18040
  ON                                                                            :            BUG3087
  GPCUSTPD.CUGCUS = LOCCUST.CUGCUS;                                             :            BUG3087
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GP Global Customers                         ';                     :
                                                                                :
