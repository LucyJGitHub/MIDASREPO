/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_GPPORTPD - Global Customer Portfolios                               */
/*                                                                             */
/*       (c) Finastra International Limited 2005                               */
/*                                                                             */
/*       Last Amend No. CSD103             Date 10Aug20                        */
/*       Prev Amend No. MD046248           Date 27Oct17                        */
/*                      MD024494           Date 04Feb14                        */
/*                      CSF011             Date 12Sep11                        */
/*                      CER059             Date 19Jul10                        */
/*                      CER043             Date 02Jun08                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      BUG11273           Date 28Apr06                        */
/*                      BUG4464 *Create    Date 31Aug05                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       CSD103 - LIBOR Deregulation - Common Layer/Standing Data              */
/*       MD046248 - Finastra Rebranding                                        */
/*       MD024494 - Global Views-Customer Portfolio View: No product is shown. */
/*                - Reinstate V_GPPORTPD and apply the concept of BUG14382B.   */
/*       CSF011 - Customer Name on Inputs (Recompile)                          */
/*       CER059 - German Feature Upgrade to Delhi                              */
/*       CER043 - German Features LF041-00 New Fields and Defaulting           */
/*                (Recompile)                                                  */
/*       BUG11273 - Attempt to write duplicate record in GPGLCUSL.             */
/*                  Add GPGLCUSL.CGBRCD as new key(unique). (Recompile)        */
/*       BUG4464- Enhancement to Global Customer Portfolio View                */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  AS                                                                            :
  SELECT                                                                        :
  CASE WHEN GPPRODPD.PDGPRD IS NULL THEN 'Other' ELSE GPPRODPD.PDDESC           :
                                                      END AS PRODDESC,          :
  CASE WHEN GPPRODPD.PDDSEQ IS NULL THEN '9' ELSE GPPRODPD.PDDSEQ               :
                                                      END AS PRODSEQ,           :
  GPTRAPPD.T_SMOD,GPTRAPPD.T_ID,GPTRAPPD.T_BRCA, GPTRAPPD.T_SNAM,               :
  GPTRAPPD.T_SDAT,GPTRAPPD.T_EDAT,GPTRAPPD.T_LICD,GPTRAPPD.T_CNCD,              :
  GPTRAPPD.T_TRTP,GPTRAPPD.T_TRST,GPTRAPPD.T_STRP,GPTRAPPD.T_PCAL,              :
  GPTRAPPD.T_ZONE,GPTRAPPD.T_BOOK,GPTRAPPD.T_SESN,GPTRAPPD.T_ISTT,              :
  GPTRAPPD.T_YRNO,GPTRAPPD.T_MTHN,GPTRAPPD.T_ACSQ,GPTRAPPD.T_ACOD,              :
  GPTRAPPD.T_ACCY,GPTRAPPD.T_TREF,GPTRAPPD.T_MOD,GPTRAPPD.T_CNUM,               :
**DIGITS(T_CNUM)*AS*PADCNUM,****************************************************:           MD024494
  T_CNUM AS PADCNUM,                                                            :           MD024494
  GPGLCUSL.CGGLOB,GPGLCUSL.CGCSSN,                                              :
  GPPOSNPD.P_TVDI,GPPOSNPD.P_ASLI,GPPOSNPD.P_ID,GPPOSNPD.P_CCY,                 :
  GPPOSNPD.P_NOML,                                                              :
  GPPOSNPD.P_ONOM,GPPOSNPD.P_MKPR,GPPOSNPD.P_MKVL,GPPOSNPD.P_AITD,              :
  GPPOSNPD.P_OCCY,T_SMODSEC.SMSMOD,T_SMODSEC.SMMODDESC                          :
  FROM GPTRAPPD                                                                 :
  LEFT JOIN GPGLCUSL ON T_ZONE = CGZONE AND T_CNUM=CGCNUM                       :
  LEFT JOIN GPPOSNPD ON P_ID=T_ID                                               :
  LEFT JOIN T_SMODSEC ON T_SMOD=SMSMOD                                          :
  LEFT JOIN GPPRODXPD ON PDTRTP = T_TRTP AND PDTRST = T_TRST                    :
  AND PDZONE = T_ZONE                                                           :
  LEFT JOIN GPPRODPD ON GPPRODXPD.PDGPRD=GPPRODPD.PDGPRD;                       :
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GP Global Customer Portfolios               ';                     :
                                                                                :
