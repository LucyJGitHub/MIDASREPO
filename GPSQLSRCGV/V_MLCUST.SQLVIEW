/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_MLCUST - Midas GP Global Customers                                  */
/*                                                                             */
/*       (c) Finastra International Limited 2004                               */
/*                                                                             */
/*       Last Amend No. MD046248           Date 27Oct17                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*       Prev Amend No. CSW037A            Date 02May05                        */
/*                      CSD025             Date 11Jan05                        */
/*                      CSW037             Date 15Dec04                        */
/*                      CSW036             Date 15Dec04                        */
/*                      BUG4521            Date 17Nov04                        */
/*                      BUG3860            Date 06Aug04                        */
/*                      BUG2703            Date 01Jul04                        */
/*                      BUG3094            Date 08Jun04                        */
/*                      CLE025             Date 20Oct03                        */
/*                      BUG2585            Date 20May04                        */
/*                      BUG2643            Date 20May04                        */
/*                      CGP001  *CREATE    Date 05Mar04                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD046248 - Finastra Rebranding                                        */
/*       CSW037A- Additional Field extended to 40 chars (recompile)            */
/*       CSD025 - Customer De-Activation                                       */
/*       CSW037 - Additional Field Data on MT300/MT320                         */
/*       CSW036 - Dual SWIFT BIC held on Client Details                        */
/*       BUG4521 - Predeal Check Performance Enhancement                       */
/*       BUG3860 - SQL performance                                             */
/*       BUG2703- Additional changes for deletion handling.                    */
/*       BUG3094 - Correct typo                                                */
/*       CLE025 - Credit Lines (Recompile)                                     */
/*       BUG2585 - Filter out non-active customers                             */
/*       BUG2643- Customer Limits                                              */
/*       CGP001 - Global Processing                                            */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
***(CUSCUST, CUSGLOB, CUSCSSN, CUSNA1, CUCNA2, CUSNA3, CUSNA4, CUSRNM, CUSRTN,  :BUG2643
***CUSBRCD, CUSNBI, CUSICD, CUSACO, CUSCNCZ, CUSCOLC, CUSACTIVE, CUSFLAG)       :BUG2643
   (CUSCUST, CUSGLOB, CUSCSSN, CUSNA1, CUSNA2, CUSNA3, CUSNA4, CUSRNM,          :            BUG4521
   CUSRTN, CUSBRCD, CUSNBI, CUSICD, CUSACO, CUSCNCZ, CUSCOLC, CUSACTIVE,        :            BUG4521
   CUSFLAG)                                                                     :            BUG4521
  AS                                                                            :
  SELECT                                                                        : BUG4521
  CUSCUST, CUSGLOB, CUSCSSN, CUSNA1, CUSNA2, CUSNA3, CUSNA4, CUSRNM, CUSRTN,    : BUG4521
  CUSBRCD, CUSNBI, COALESCE(CUSICD,''), COALESCE(CUSACO,''), CUSCNCZ, CUSCOLC,  : BUG4521
  CUSACTIVE,                                                                    : BUG4521
  CASE CUSACTIVE WHEN 'A' THEN 'Amended' WHEN 'I' THEN 'Inserted'               : BUG4521
  WHEN 'D' THEN 'Deleted' ELSE '???' END AS CUSFLAG                             : BUG4521
  FROM GPCUSGPD  ;                                                              : BUG4521
**(SELECT***********************************************************************: BUG4521
*******'' AS CUSCUST,***********************************************************: BUG4521
*******GPCUSTPD.CUGCUS AS CUSGLOB,**********************************************: BUG4521
*******GPCUSTPD.CUCSSN AS CUSCSSN,**********************************************: BUG4521
*******GPCUSTPD.CUCNA1 AS CUSNA1,***********************************************: BUG4521
*******GPCUSTPD.CUCNA2 AS CUSNA2,***********************************************: BUG4521
*******GPCUSTPD.CUCNA3 AS CUSNA3,***********************************************: BUG4521
*******GPCUSTPD.CUCNA4 AS CUSNA4,***********************************************: BUG4521
*******GPCUSTPD.CUCRNM AS CUSRNM,***********************************************: BUG4521
*******GPCUSTPD.CUCRTN AS CUSRTN,***********************************************: BUG4521
*******GPCUSTPD.CUBRCD AS CUSBRCD,**********************************************: BUG4521
*******GPCUSTPD.CUBNBI AS CUSNBI,***********************************************: BUG4521
*******GPCUSTPD.CUGICD AS CUSICD,***********************************************: BUG4521
*******GPCUSTPD.CUGACO*AS*CUSACO,***********************************************: BUG4521
*******GPCUSTPD.CUCNCZ*AS*CUSCNCZ,**********************************************: BUG4521
*******GPCUSTPD.CUCOLC*AS*CUSCOLC***********************************************:BUG2643
****** GPCUSTPD.CUCOLC*AS*CUSCOLC,**********************************************:BUG2643 BUG4521
****** GPCUSTPD.CUCHTP*AS*CUSACTIVE,********************************************:BUG2643 BUG4521
**CASE**************************************************************************:BUG2643 BUG4521
***WHEN*GPCUSTPD.CUCHTP*=*'A'*THEN*'Active'*************************************:BUG2703BUG2643
***WHEN*GPCUSTPD.CUCHTP*=*'A'*THEN*'Amended'**********************************:BUG2703BUG2643BUG4521
***WHEN*GPCUSTPD.CUCHTP*=*'D'*THEN*'Deleted'************************************:BUG2643 BUG4521
***WHEN*GPCUSTPD.CUCHTP*=*'I'*THEN*'Inactive'***********************************:BUG2703BUG2643
***WHEN*GPCUSTPD.CUCHTP*=*'I'*THEN*'Inserted'*********************************:BUG2703BUG2643BUG4521
***END*AS*CUSFLAG***************************************************************:BUG2643 BUG4521
********************************************************************************:BUG2643 BUG4521
**FROM*GPCUSTPD*****************************************************************:BUG4521
**WHERE*GPCUSTPD.CUCHTP*<>*'D'************************************************:BUG2703BUG2585
**UNION*ALL*********************************************************************:BUG4521
**SELECT************************************************************************:BUG4521
*******GZSDCUSTPD.BBCUST*AS*CUSCUST,********************************************:BUG4521
*******GZSDCUSTPD.BBBRCD*||*'-'*||*GZSDCUSTPD.BBCUST*AS*CUSGLOB,****************:BUG4521
*******GZSDCUSTPD.BBCSSN*AS*CUSCSSN,********************************************:BUG4521
*******GZSDCUSTPD.BBCNA1*AS*CUSNA1,*********************************************:BUG4521
*******GZSDCUSTPD.BBCNA2*AS*CUSNA2,*********************************************:BUG4521
*******GZSDCUSTPD.BBCNA3*AS*CUSNA3,*********************************************:BUG4521
*******GZSDCUSTPD.BBCNA4*AS*CUSNA4,*********************************************:BUG4521
*******GZSDCUSTPD.BBCRNM*AS*CUSRNM,*********************************************:BUG4521
*******GZSDCUSTPD.BBCRTN*AS*CUSRTN,*********************************************:BUG4521
*******GZSDCUSTPD.BBBRCD*AS*CUSBRCD,********************************************:BUG4521
*******GZSDCUSTPD.BBBNBI*AS*CUSNBI,*********************************************:BUG4521
*******GPINDSXPD.IDGIND*AS*CUSICD,**********************************************:BUG4521
*******GPACOFXPD.ACGACO*AS*CUSACO,**********************************************:BUG4521
*******GZSDCUSTPD.BBCNCZ*AS*CUSCNCZ,********************************************:BUG4521
*******GZSDCUSTPD.BBCOLC*AS*CUSCOLC*********************************************:BUG2643
*******GZSDCUSTPD.BBCOLC*AS*CUSCOLC,********************************************:BUG2643 BUG4521
*******GZSDCUSTPD.BBTYLC*AS*ACTIVE,*********************************************:BUG2643
*******GZSDCUSTPD.BBTYLC*AS*CUSACTIVE,******************************************:BUG2643 BUG4521
********************************************************************************:BUG2643 BUG4521
**CASE**WHEN*GZSDCUSTPD.BBTYLC*=*'A'*THEN*'Active'****************************:BUG2703BUG2643
**CASE**WHEN*GZSDCUSTPD.BBTYLC*=*'A'*THEN*'Amended'***************************:BUG2703BUG2643BUG4521
***WHEN*GZSDCUSTPD.BBTYLC*=*'D'*THEN*'Deleted'**********************************:BUG2643 BUG4521
***WHEN*GZSDCUSTPD.BBTYLC*=*'I'*THEN*'Inactive'*********************************:BUG2703BUG2643
***WHEN*GZSDCUSTPD.BBTYLC = 'I' THEN 'Inserted'*******************************:BUG2703BUG2643BUG4521
***END*AS CUSFLAG***************************************************************:BUG2643 BUG4521
********************************************************************************:BUG2643 BUG4521
**FROM*GZSDCUSTPD***************************************************************:BUG4521
**INNER*JOIN*GZSDBRCHPD*ON*GZSDBRCHPD.A8BRCD*=*GZSDCUSTPD.BBBRCD****************:BUG4521
**LEFT*JOIN*GPINDSXPD*GPINDSXPD*************************************************:BUG4521
**ON*GZSDCUSTPD.BBLICD=GPINDSXPD.IDLICD*AND*GZSDBRCHPD.A8ZONE=GPINDSXPD.IDZONE**:BUG4521
**LEFT*JOIN*GPACOFXPD*GPACOFXPD*************************************************:BUG4521
**ON*GPACOFXPD.ACACOC=GZSDCUSTPD.BBACOC AND GPACOFXPD.ACZONE=GZSDBRCHPD.A8ZONE**:BUG4521
**WHERE*BBBRCD*||*BBCUST*NOT*IN*(SELECT*CUBRCD||*CUCUST*FROM*GPCUSTXPD**********:BUG3860
**LEFT*EXCEPTION*JOIN*GPCUSTXPD*************************************************:BUG3860 BUG4521
**ON*BBBRCD*=*CUBRCD*AND*BBCUST*=*CUCUST****************************************:BUG3860 BUG4521
**);****************************************************************************:BUG2703 BUG4521
**AND*GZSDCUSTPD.BBTYLC*<>*'D');********************************************:BUG2703 BUG2585 BUG4521
**);****************************************************************************:BUG2585 BUG4521
                                                                                :
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GP Global Customers                         ';                     :
                                                                                :
