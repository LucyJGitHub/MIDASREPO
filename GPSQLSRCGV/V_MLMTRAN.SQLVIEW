/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_MLMTRAN - Midas GP Manual Transactions                              */
/*                                                                             */
/*       (c) Misys International Banking Systems Ltd. 2004                     */
/*                                                                             */
/*       Last Amend No. CLE064             Date 06Dec10                        */
/*       Prev Amend No. CER059             Date 19Jul10                        */
/*                      CER020             Date 19May08                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/*                      CAP187             Date 21Aug09                        */
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/*                      BUG17953           Date 10Apr08                        */
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      BUG11925           Date 18Aug06                        */
/*                      CSD031             Date 10Apr06                        */
/*                      CSD027             Date 18Dec05                        */
/*                      CLE042             Date 06Sep05                        */
/*                      CLE106             Date 01Aug04                        */
/*                      BUG3514            Date 05Jul04                        */
/*                      BUG3262            Date 16Jun04                        */
/*                      BUG2973            Date 03Jun04                        */
/*                      CGP001  *CREATE    Date 05Mar04                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       CLE064 - Enhancement of Lending Frequencies (Recompile)               */
/*       CER059 - German Feature Upgrade to Delhi                              */
/*       CER020 - Enhanced Rollover Window: Upgrade FGE089 to                  */
/*                Midas Plus (Recompile)                                       */
/*       CAP187 - Document Linkage                                             */
/*       BUG17953 - CCSID of tables cannot be changed (Recompile)              */
/*     BUG11925 - Manual Transactions listview crashes with data conversion    */
/*                or data mapping error.                                       */
/*       CSD031 - Enhanced Centralised Static Data (Recompile)                 */
/*       CSD027 - Conversion Of Customer Number to Alpha                       */
/*       CLE042 - Extended Loan Sub Type (Recompile)                           */
/*       CLE106 - Syndications Manager.                                        */
/*       BUG3514- Recompile over changed T_MLMTRAN                             */
/*       BUG3262- view V_MLMTRAN in GPSQLSRCGV has hard coded references to    */
/*                ECGMLIB introduced by BUG2973                                */
/*       BUG2973- Housekeeping functions for the manual transactions table     */
/*       CGP001 - Global Processing                                            */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
   AS                                                                           :
**********SELECT                                                                       :     BUG2973
**********     MTID, CAST(MTID AS CHAR(2)) AS PADMTID, MTREF, MTMODULE, MTTRNTYP,         :  BUG2973
**********   MTTRNSTYP, MTBRCHCODE, MTCUSTCODE, MTASSETAMT, MTASSETCCY, MTLIABAMT ,     :    BUG2973
**********     MTLIABCCY, MTDEALDATE, MTVALDATE, MTMATDATE, MTREMARK, MTRESVID,           :  BUG2973
**********     MTDELETED, MTUSERID, MTFACBRCD, MTFACCUST, MTFACTYPE, MTFACSEQ             :  BUG2973
**********   FROM T_MLMTRAN WHERE MTDELETED <> 'Y' ;                                      :  BUG2973
                                                                                :            BUG2973
***SELECT*MTRAN.*,*BRCH.A8ZONE*AS*MTZONE,***************************************:     BUG2973 CLE106
   SELECT MTRAN.*, BRCH.A8ZONE AS MTZONE, F.LAID AS MLAID, F.ACOF AS MACOF,     :             CLE106
*****DATE(BANK.BJRDNB*+*719892)*AS*MTRUNDATE,CASE**WHEN*MTDELETED='Y'*THEN*'D'**:     BUG2973 CLE106
     DATE(BANK.BJRDNB + 719892) AS MTRUNDATE,                                   :             CLE106
     CASE WHEN MTRAN.MTDELETED='Y' THEN 'D'                                     :             CLE106
*****WHEN*MTDELETED<>'Y'*AND*MTMATDATE*<*DATE(BANK.BJRDNB*+*719892)*************:     BUG2973 CLE106
     WHEN MTRAN.MTDELETED<>'Y' AND MTRAN.MTMATDATE < DATE(BANK.BJRDNB + 719892) :             CLE106
*****THEN*'M'*ELSE*'A'*END*MTSTATUS*********************************************:     BUG2973 CEL106
     THEN 'M' ELSE 'A' END MTSTATUS,                                            :             CLE106
*****C.MTACTNCD,*F.PRTR,*F.SYIN*************************************************:      CLE106 CAP187
     C.MTACTNCD, F.PRTR, F.SYIN,                                                :             CAP187
*****FROM*T_MLMTRAN*MTRAN*INNER*JOIN*ECGMLIB/GZSDBRCHPD*BRCH********************:     BUG2973BUG3262
    (SELECT COUNT(*) FROM LEMTRNX0 EX                                           :             CAP187
     WHERE EX.MTID = MTRAN.MTID                                                 :             CAP187
     AND EX.A8ZONE = BRCH.A8ZONE) AS PCLIP                                      :             CAP187
     FROM T_MLMTRAN MTRAN INNER JOIN GZSDBRCHPD BRCH                            :            BUG3262
*****ON*MTBRCHCODE*=*A8BRCD*****************************************************:     BUG2973 CLE106
     ON MTRAN.MTBRCHCODE = BRCH.A8BRCD                                          :             CLE106
*****INNER*JOIN*ECGMLIB/GZSDBANKPD*BANK*ON*BRCH.A8ZONE*=*BJZONE*****************:     BUG2973BUG3262
*****INNER*JOIN*GZSDBANKPD*BANK*ON*BRCH.A8ZONE*=*BJZONE*************************:     BUG3262 CLE106
     INNER JOIN GZSDBANKPD BANK ON BRCH.A8ZONE = BANK.BJZONE                    :             CLE106
     LEFT OUTER JOIN T_CLMTRAN AS C ON C.MTID=MTRAN.MTID                        :             CLE106
*****LEFT*OUTER*JOIN*GZFCLTYFM*AS*F*ON*DIGITS(F.CNUM)=MTRAN.MTFACCUST***********:    CLE106 BUG11925
     LEFT OUTER JOIN GZFCLTYFM AS F ON F.CNUM=MTRAN.MTFACCUST                   :           BUG11925
     AND DIGITS(F.FACT)=MTRAN.MTFACTYPE                                         :             CLE106
     AND F.BRCA=MTRAN.MTBRCHCODE                                                :             CLE106
     AND DIGITS(F.FCNO)=MTRAN.MTFACSEQ                                          :             CLE106
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GP Manual Transactions                      ';                     :
                                                                                :
