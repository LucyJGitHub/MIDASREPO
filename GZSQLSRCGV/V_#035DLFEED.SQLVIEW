/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_#DLFEED - Global Dealing Fees                                       */
/*                                                                             */
/*       (c) Finastra International Limited 2005                               */
/*                                                                             */
/*       Last Amend No. MD046248           Date 27Oct17                        */
/*       Prev Amend No. CSF011             Date 12Sep11                        */
/*                      CER059             Date 19Jul10                        */
/*                      CER043             Date 02Jun08                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      BUG11941           Date 31Aug06                        */
/*                      CSD031             Date 10Apr06                        */
/*                      BUG11273           Date 28Apr06                        */
/*                      CSD027             Date 11Jan06                        */
/*                      233601             Date 20May05                        */
/*                      CAS011  *CREATE    Date 16May05                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD046248 - Finastra Rebranding                                        */
/*       CSF011 - Customer Name on Inputs (Recompile)                          */
/*       CER059 - German Feature Upgrade to Delhi                              */
/*       CER043 - German Features LF041-00 New Fields and Defaulting           */
/*                (Recompile)                                                  */
/*       BUG11941 - Error Message "A serious Midasplus error cccured" display- */
/*                  ed in transaction confirmation page.                       */
/*       CSD031 - Enhanced Centralised Static Data (Recompile)                 */
/*       BUG11273 - Attempt to write duplicate record in GPGLCUSL.             */
/*                  Add GPGLCUSL.CGBRCD as new key(unique). (Recompile)        */
/*       CSD027 - Conversion of Customer Number to alpha.                      */
/*       233601 - Post Fee amount to be amortised non-linearly (Recompile)     */
/*       CAS011 - EIR/AC Accounting Upgrade to MP1                             */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  AS                                                                            :
  SELECT                                                                        :
   DFRECI, DFBRCA, DFFCCY, DFPYON, DFSTTL, DFOURS, DFOSBR, DFTHER, DFDTYP,      :
   DFSTYP, DFSPTI, DFEPTI, DFSBTI, DFEBTI, DFSCCY, DFICCY, DFSWRI, DFADJY,      :
   DFLCDT, DFFSTS, DFIUSR, DFAUSR, DFXUSR, DFOSDB, DFOMDB, DFRSTM, DFRONS,      :
   DFRIBN, DFRIBA, DFROBN, DFROCN, DFPSTM, DFPONS, DFPIBN, DFPIBA, DFPOBN,      :
   DFPOCN, DFRCRN, DFRCRA, DFRVNO, DFAWBN, DFAWBA, DFBENN, DFBENA, DFDTP1,      :
   DFDTP2, DFDTP3, DFDTP4, DFDCHG, DFBTB1, DFBTB2, DFBTB3, DFBTB4, DFBTB5,      :
   DFBTB6, DFCVMR, DFFRNT, DFREPA, DFTMST, DFFREQ, DFDYIM,                      :
   CASE WHEN DFDLNO=0 THEN NULL ELSE DIGITS(DFDLNO) END AS PADDFDLNO,           :
   CASE WHEN DFFSEQ=0 THEN NULL ELSE DIGITS(DFFSEQ) END AS PADDFFSEQ,           :
   CASE WHEN DFFCOD=0 THEN NULL ELSE DIGITS(DFFCOD) END AS PADDFFCOD,           :
***CASE*WHEN*DFCUST=0*THEN*NULL*ELSE*DIGITS(DFCUST)*END*AS*PADDFCUST,***********: /*BUG11941*/
   DFCUST AS PADDFCUST,                                                         : /*BUG11941*/
   CASE WHEN DFPSTD=0 THEN NULL ELSE DATE(DFPSTD+719892) END AS FDFPSTD,        :
   CASE WHEN DFPEND=0 THEN NULL ELSE DATE(DFPEND+719892) END AS FDFPEND,        :
   CASE WHEN DFSDAT=0 THEN NULL ELSE DATE(DFSDAT+719892) END AS FDFSDAT,        :
   CASE WHEN DFLDAT=0 THEN NULL ELSE DATE(DFLDAT+719892) END AS FDFLDAT,        :
   CASE WHEN DFORED=0 THEN NULL ELSE DATE(DFORED+719892) END AS FDFORED,        :
   CASE WHEN DFLCHD=0 THEN NULL ELSE DATE(DFLCHD+719892) END AS FDFLCHD,        :
   CASE WHEN DFNPYD=0 THEN NULL ELSE DATE(DFNPYD+719892) END AS FDFNPYD,        :
   CASE WHEN DFLPDT=0 THEN NULL ELSE DATE(DFLPDT+719892) END AS FDFLPDT,        :
   DFFAMT AS SDFFAMT,                                                           :
   DFAMTS AS SDFAMTS,                                                           :
   DFADAT AS SDFADAT,                                                           :
   DFAMTO AS SDFAMTO,                                                           :
   DFAMTD AS SDFAMTD,                                                           :
   DFFEAM AS SDFFEAM,                                                           :
   DFFEAC AS SDFFEAC,                                                           :
   DFAFES AS SDFAFES,                                                           :
   DFAFEE AS SDFAFEE,                                                           :
   DFTFTD AS SDFTFTD,                                                           :
   DFAFLS AS SDFAFLS,                                                           :
   DFUAFA AS SDFUAFA,                                                           :
   A8ZONE AS CUSTZONE,                                                           :
   GPGLCUSL.CGGLOB,GPGLCUSL.CGCSSN,GPGLCUSL.CGRNM,GPGLCUSL.CGRTN,                :
   GPGLCUSL.CGICD,GPGLCUSL.CGACO,GPGLCUSL.CGCNCZ,GPGLCUSL.CGCOLC,                :
   GPGLCUSL.CGBRCD,GPGLCUSL.CGCUST,GPGLCUSL.CGZONE                               :
   FROM GZDLFEED                                                                :
   LEFT JOIN GZSDBRCHPD ON DFBRCA = A8BRCD                                      :
   LEFT JOIN GPGLCUSL GPGLCUSL ON A8ZONE = CGZONE AND CGCNUM = DFCUST;          :
                                                                                :
 * DESCRIBESTART                                                                :
 * DESCRIBEFIELD PADDFDLNO  AS DFDLNO     USING GZDLFEED                        :
 * DESCRIBEFIELD PADDFFSEQ  AS DFFSEQ     USING GZDLFEED                        :
 * DESCRIBEFIELD PADDFFCOD  AS DFFCOD     USING GZDLFEED                        :
 * DESCRIBEFIELD PADDFCUST  AS DFCUST     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFPSTD    AS DFPSTD     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFPEND    AS DFPEND     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFSDAT    AS DFSDAT     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFLDAT    AS DFLDAT     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFORED    AS DFORED     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFLCHD    AS DFLCHD     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFNPYD    AS DFNPYD     USING GZDLFEED                        :
 * DESCRIBEFIELD FDFLPDT    AS DFLPDT     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFFAMT    AS DFFAMT     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFAMTS    AS DFAMTS     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFADAT    AS DFADAT     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFAMTO    AS DFAMTO     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFAMTD    AS DFAMTD     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFFEAM    AS DFFEAM     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFFEAC    AS DFFEAC     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFAFES    AS DFAFES     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFAFEE    AS DFAFEE     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFTFTD    AS DFTFTD     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFAFLS    AS DFAFLS     USING GZDLFEED                        :
 * DESCRIBEFIELD SDFUAFA    AS DFUAFA     USING GZDLFEED                        :
 * DESCRIBEFIELD CUSTZONE   AS A8ZONE     USING GZSDBRCHPD                      :
 * DESCRIBEEND                                                                  :
/********************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GZ DL Dealing Fees - GZDLFEVD               ';                     :
                                                                                :
