/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_LOCCUST - Local Customers                                           */
/*                                                                             */
/*       (c) Finastra International Limited 2003                               */
/*                                                                             */
/*       Last Amend No. MD046248           Date 27Oct17                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/*       Prev Amend No. 250460             Date 30Nov07                        */
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      CSD031             Date 10Apr06                        */
/*                      CSD027             Date 18Dec05                        */
/*                      CSW037A            Date 02May05                        */
/*                      CSD025             Date 11Jan05                        */
/*                      CSW037             Date 15Dec04                        */
/*                      CSW036             Date 15Dec04                        */
/*                      CLE025             Date 20Oct03                        */
/*                      BUG1296            Date 25Mar04                        */
/*                      CGP001  *CREATE    Date 20Aug03                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD046248 - Finastra Rebranding                                        */
/*       250460 - Select live customers only to improve performance            */
/*       CSD031 - Enhanced Centralised Static Data (Recompile)                 */
/*       CSD027 - Conversion Of Customer Number to Alpha                       */
/*       CSW037A- Additional Field extended to 40 chars (recompile)            */
/*       CSD025 - Customer De-Activation                                       */
/*       CSW037 - Additional Field Data on MT300/MT320                         */
/*       CSW036 - Dual SWIFT BIC held on Client Details                        */
/*       CLE025 - Credit Lines (Recompile)                                     */
/*       BUG1296 - Local customer listview does not show all customers         */
/*       CGP001 - Global Processing                                            */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  AS                                                                            :
  SELECT                                                                        :
  DISTINCT A.BBCUST, A.BBCSSN, A.BBLCCD, A.BBBRCD, A.BBCNA1, A.BBCNA2,          :
           A.BBCNA3, A.BBCNA4, A.BBCRNM, A.BBCRTN, B.CUGCUS, C.A8ZONE           :
  FROM GZSDCUSTPD A, GPCUSTPD B                                                 :
  INNER JOIN GZSDBRCHPD C ON A.BBBRCD=C.A8BRCD                                  :
  WHERE B.CUCHTP <> 'D'                                                         :             250460
/***WHERE NOT EXISTS (SELECT D.CUCUST, D.CUBRCD, D.CUGCUS***********************:             250460
    AND   NOT EXISTS (SELECT D.CUCUST, D.CUBRCD, D.CUGCUS                       :             250460
                      FROM GPCUSTXPD D WHERE D.CUCUST=A.BBCUST                  :
                      AND D.CUBRCD=A.BBBRCD AND D.CUGCUS=B.CUGCUS)              :
    AND NOT EXISTS (SELECT E.CUGCUS, F.A8ZONE FROM GPCUSTXPD E                  :
                    INNER JOIN GZSDBRCHPD F ON E.CUBRCD=F.A8BRCD                :
                    WHERE E.CUGCUS=B.CUGCUS AND F.A8ZONE=C.A8ZONE)              :
/*******************AND*A.BBCUST*NOT*IN*(SELECT*G.CUCUST*FROM*GPCUSTXPD*G)******:            BUG1296
    AND NOT EXISTS (SELECT G.CUCUST, G.CUBRCD FROM GPCUSTXPD G                  :            BUG1296
                    WHERE G.CUCUST=A.BBCUST AND G.CUBRCD=A.BBBRCD)              :            BUG1296
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas GZ Local customers - GZSDCUSTPD             ';                     :
                                                                                :
