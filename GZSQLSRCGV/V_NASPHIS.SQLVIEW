/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_NASPHIS - Midas DL Historic NAP Deals                               */
/*                                                                             */
/*       (c) Finastra International Limited 2008                               */
/*                                                                             */
/*       Last Amend No. MD046248           Date 27Oct17                        */
/*       Prev Amend No. MD045500           Date 19May17                        */
/*                      AR880788           Date 15Dec11                        */
/*                      CSF011             Date 12Sep11                        */
/*                      CER059             Date 19Jul10                        */
/*                      CER034  *CREATE    Date 28Jul08                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD046248 - Finastra Rebranding                                        */
/*       MD045500 - Recompiled over amended GZDLDHISPD.                        */
/*       AR880788 - Implementation error on V7R1                               */
/*       CSF011 - Customer Name on Inputs (Recompile)                          */
/*       CER059 - German Feature Upgrade to Delhi                              */
/*       CER034 - German Features - New fields and enquiries                   */
/*                                                                             */
/*******************************************************************************/
 
  CREATE VIEW
  **********/**********
  AS
  SELECT RECI,DLNO,RCDT,RCDC,ISCN,BRCA,DTYP,DLST,DDAT,VDAT,MDAT,IDAS,BRKC,
  BAGE,CCY,PUPR,ZZ001,YRAT,ZZ008,RTSP,INTR,ZZ003,RNNA ,CNUM ,FACT ,
  FCNO , FVAL ,BCXR ,LCXR ,SDST ,OSDAQQ,TSTN, MDST, OMDAQQ,TMAN,BDID,
  ZZ002A,DISA, ZZ006 ,DPTD ,ICBS ,IPFR ,TOTI,NIDT ,IBDT,SLID,AIPD ,
  DLRC ,IACD ,AITC , AIAN,AIAP ,IPRD, IPRM, SAPR, ASDN, SADT, DAVD,
  DASN, FACO, SPI,INTF,MDBX, PINT1, ZZ015, DNSI,DSTI ,CNFI ,ACEI ,TLXI,
  ZZ010,LSWC ,LSWS ,ZZ002, ORED ,LCD,CHTP ,TNLU ,BOKC ,LNKDN,RSTM ,RONSQQ,
  RIBN, RIBA, ROBN, ROCN, PSTM, PONSQQ,PIBN, PIBA,POBN, POCN, RCRN, RCRA,
  RVNO, AWBN,AWBA,BENN, BENA,DTP1,DTP2,DTP3,DTP4,DCHG,BTB1,BTB2,BTB3,BTB4,
  BTB5,BTB6,ORBR,PRFC,ROBR, POBR,CVMR,JRDFC,NSDD ,PCLI ,PSZE ,OPUP ,NSLD,
  FSRP, FSGN,FPRC, TCOF,ACPD, ACDA, ACAP, ACAN,COFD,COFM,STCY,IC72,FSOYLC,
  FSURPL,FSTUPL,FSPUPL,FSYUPL, FSEFUP,FSECUP,FSLQPR,FSLQPS,FSAIPN,FSIPRN,FSAIAN,
  FSAITN,FSAINN,FSIPMN, FSTOTN,FSPINN,OSDA,OMDA,RONS,PONS,CLAS,TFDP,
  TFDPA,TFAM,TFAC,TFOF,AFDP,CFDP, AMDS,AMADJ,ANADJ,DSAM ,AMCOST,YMCOST,YAINT,
  'Archived' AS DSTS,
  DIGITS(DLNO) AS PADDLNO,
**DIGITS(ISCN)*AS*PADISCN,*****************************************************:              CER059
         ISCN  AS PADISCN,                                                                    CER059
  ABS(PUPR) AS PADPUPR,
  DIGITS(RSTM) AS PADRSTM,
  DIGITS(PSTM) AS PADPSTM,
**DIGITS(CNUM)*AS*PADCNUM,*****************************************************:              CER059
         CNUM  AS PADCNUM,                                                                    CER059
  CASE BAGE WHEN 999999999999999 THEN NULL ELSE BAGE END AS SBAGE,
  CASE WHEN LNKDN = 0 THEN ' ' ELSE DIGITS(LNKDN) END AS PADLNKDN,
**CASE*WHEN*ROBN*=*0*THEN*'*'*ELSE*DIGITS(ROBN)*END*AS*PADROBN,****************:              CER059
**CASE*WHEN*ROCN*=*0*THEN*'*'*ELSE*DIGITS(ROCN)*END*AS*PADROCN,****************:              CER059
**CASE*WHEN*POBN*=*0*THEN*'*'*ELSE*DIGITS(POBN)*END*AS*PADPOBN,****************:              CER059
**CASE*WHEN*POCN*=*0*THEN*'*'*ELSE*DIGITS(POCN)*END*AS*PADPOCN,****************:              CER059
  CASE WHEN ROBN = '' THEN ' ' ELSE     ROBN  END AS PADROBN,                                 CER059
  CASE WHEN ROCN = '' THEN ' ' ELSE     ROCN  END AS PADROCN,                                 CER059
  CASE WHEN POBN = '' THEN ' ' ELSE     POBN  END AS PADPOBN,                                 CER059
  CASE WHEN POCN = '' THEN ' ' ELSE     POCN  END AS PADPOCN,                                 CER059
  CASE WHEN TNLU = 0 THEN ' ' ELSE DIGITS(TNLU) END AS PADTNLU,
**CASE*WHEN*FACT*=*0*THEN*'*'*ELSE*FACT*END*AS*PADFACT,************************             AR880788
**CASE*WHEN*BDID*=*0*THEN*'*'*ELSE*DIGITS(BDID)*END*AS*PADBDID,****************:              CER059
  CASE WHEN FACT = 0 THEN ' ' ELSE DIGITS(FACT) END AS PADFACT,                             AR880788
  CASE WHEN BDID = '' THEN ' ' ELSE        BDID  END AS PADBDID,                              CER059
  CASE WHEN LCD=0 THEN NULL ELSE LCD END AS FLCD,
  CASE WHEN VDAT=0 THEN NULL ELSE VDAT END AS FDVSD,
  CASE WHEN DDAT=0 THEN NULL ELSE DDAT END AS FDDND,
  CASE WHEN SLID=0 THEN NULL ELSE SLID END AS FSLID,
  CASE WHEN MDAT=0 THEN NULL ELSE MDAT END AS FMATD,
  CASE WHEN INTR=0 THEN NULL ELSE INTR END AS SHLINTR ,
  CASE WHEN YRAT=0 THEN NULL ELSE YRAT END AS SYRAT,
  CASE WHEN FSRP= 0 THEN NULL ELSE FSRP END AS SFSRP,
  CASE WHEN BCXR=0 THEN NULL ELSE BCXR END AS SBCXR,
  ABS(PUPR) AS SPUPR,
  TOTI AS STOTI, ABS(DISA) AS SDISA,
  OPUP AS SOPUP,
  FVAL AS SFVAL,
  A8ZONE AS CUSTZONE,
  CGGLOB , CGCSSN , CGRNM , CGRTN , CGICD , CGACO , CGCNCZ , CGCOLC , CGBRCD ,
  CGCUST , CGZONE
  FROM GZDLDHISPD
  LEFT JOIN GZSDBRCHPD ON BRCA = A8BRCD
  LEFT JOIN GPGLCUSL ON A8ZONE = CGZONE AND CGCNUM = CNUM
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas DL Historic NAP Deals                       ';                     :
                                                                                :
