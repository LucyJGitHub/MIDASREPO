     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas HF Select non perm physical file')
     F*****************************************************************
     F*                                                               *
     F*  Midas - History and Audit Facility Module
     F*                                                               *
     F*  HF0520 - Select Non-permanent Physical File                  *
     F*                                                               *
     F*  Function:  This program allows the user to select the        *
     F*  (I/C INT)  non-permanent physical for use by HAF.            *
     F*                                                               *
     F*  Called By: HFC0500 - Display information On-line             *
     F*                                                               *
     F*  Calls: HFC0110 - Check physical file.                        *
     F*         HFC0113 - Check object in library.                    *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*  LAST AMEND NO. 046082             DATE 29OCT92               *
     F*  PREV AMEND NO. S01379             DATE 02OCT92               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
     F*  046082 - Include validation of file name.                    *
     F*         - Change indicators to correspond to function keys.   *
     F*         - Add message subfile processing.                     *
     F*  S01379 - New program for HAF.                                *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F**---------------------------------------------------------------
     F**  STANDARD SUB-ROUTINES
     F*----------------------------------------------------------------
     F**  FUNCTION OF INDICATORS
     F*
     F********01       CMD/1 IS PRESSED                                   046082
     F********03       CMD/13 IS PRESSED                                  046082
     F********05       CMD/5 IS PRESSED                                   046082
     F*       03       CMD/3  IS PRESSED  (EXIT)                          046082
     F*       13       CMD/13 IS PRESSED  (START)                         046082
     F*       12       CMD/12 IS PRESSED  (CANCEL)                        046082
     F*       50       ERROR OF SCREEN FIELD FOR PHYSICAL FILE            046082
     F*       U1       END PROGRAM
     F*       U3       START RESTORE
     F*       U5       RESTART ENQUIRY
     F*
     F*  90 - 99  ACT-SUBROUTINES
     F*
     F*  U7,U8    STANDARD-MIDAS ERROR
     F*----------------------------------------------------------------
     F*
     FHF0520DFCF  E                    WORKSTN
     F*
     E*-----------------------------------------------------------------
     E**                  T A B L E S
     E*
     E                    CPY@    1   1 80
     E*
     E** Array containing Copyright statement
     E*
     E*-----------------------------------------------------------------
     I*
     IJRN        UDS                            256
     I                                       23  32 PGM
     I*
     ILDA       E DSLDA                         256
      *
      ** Local data area for database error details
      *
     IRUNDAT    E DSRUNDAT
      *
      ** Data Area giving Installation Control Details
      *
     IPSDS       SDS
      *
      ** Program Status Data Structure - gives Job/Workstation name and
      ** User ID
      *
     I                                      244 253 JOB
     I                                      244 246 WSID
     I                                      254 263 USER
      *
     C/EJECT
     C*
     C** Set up copyright parameter
     C*
     C                     MOVEACPY@      BIS@   80
     C*
      *
      ** Read in Installation Data
      *
     C           *NAMVAR   DEFN           RUNDAT
     C           *NAMVAR   DEFN           LDA
     C                     IN   RUNDAT
     C                     MOVE AGMRDT    SRUNA            RUN DATE
     C                     MOVE USER      SUSER
     C                     MOVELWSID      SWSID
     C*
     C                     MOVE *BLANKS   WUMSID  7        Message Identif046082
     C                     MOVEL'HFMSGF'  WUMSGF 10        Message File Na046082
     C                     MOVEL'HF0520'  SPGMQ  10                       046082
     C                     MOVEL*BLANKS   SSFKY   4                       046082
     C*                                                                   046082
     C           AGDFF     IFEQ 'M'
     C                     SETON                     98
     C                     END
     C*
     C           *NAMVAR   DEFN           JRN
     C           *LOCK     IN   JRN
     C           *ENTRY    PLIST
     C                     PARM           NPEF   10
     C/EJECT
     C           START     TAG
     C                     WRITEHF0520C0                                  046082
     C                     EXFMTHF0520F1
     C                     CALL 'SCC0250'                                 046082
     C                     MOVE '1'       *IN50                           046082
      *                                                                   046082
     C***01                SETON                     LR                   046082
     C***01                SETON                     U1                   046082
     C***01                GOTO ENDPGM                                    046082
      *                                                                   046082
      ** CMD3 PRESSED                                                     046082
      *                                                                   046082
     C           *IN03     IFEQ '1'                                       046082
     C                     SETON                     LR                   046082
     C                     SETON                     U1                   046082
     C                     GOTO ENDPGM                                    046082
     C                     END                                            046082
      *                                                                   046082
     C***05                SETON                     LR                   046082
     C***05                SETON                     U5                   046082
     C***05                GOTO ENDPGM                                    046082
      *                                                                   046082
      ** CMD12 PRESSED                                                    046082
      *                                                                   046082
     C           *IN12     IFEQ '1'                                       046082
     C                     SETON                     LR                   046082
     C                     SETON                     U5                   046082
     C                     GOTO ENDPGM                                    046082
     C                     END                                            046082
      *                                                                   046082
      ** CMD13 PRESSED OR ENTER KEY                                       046082
      *                                                                   046082
      ** ERROR IF FILE NOT ENTERED                                        046082
      *                                                                   046082
     C           NPEF      IFEQ *BLANKS                                   046082
     C                     MOVEL'HAF0006' WUMSID           Message Identif046082
     C                     CALL 'SCC0240'                  Retrieve MSGF m046082
     C           WUMSID    PARM WUMSID    WQ0001  7        Message Identif046082
     C           WUMSGF    PARM WUMSGF    WQ0002 10        Message File Na046082
     C                     MOVE '1'       *IN50                           046082
     C                     GOTO START                                     046082
     C                     END                                            046082
      *                                                                   046082
      ** CHECK FOR FILE EXISTENCE                                         046082
      *                                                                   046082
     C                     MOVELNPEF      FOBJ   10                       046082
     C                     MOVEL'*LIBL'   FLIB   10                       046082
     C                     MOVEL'*FILE'   FTYP   10                       046082
     C                     MOVEL'Y'       FOK     1                       046082
     C                     CALL 'HFC0113'                                 046082
     C                     PARM           FOBJ                            046082
     C                     PARM           FLIB                            046082
     C                     PARM           FTYP                            046082
     C                     PARM           FOK                             046082
      *                                                                   046082
      ** ERROR IF FILE DOES NOT EXIST                                     046082
      *                                                                   046082
     C           FOK       IFEQ 'N'                                       046082
     C                     MOVEL'HAF0002' WUMSID           Message Identif046082
     C                     CALL 'SCC0240'                  Retrieve MSGF m046082
     C           WUMSID    PARM WUMSID    WQ0001           Message Identif046082
     C           WUMSGF    PARM WUMSGF    WQ0002           Message File Na046082
     C                     MOVE '1'       *IN50                           046082
     C                     GOTO START                                     046082
     C                     END                                            046082
      *                                                                   046082
      ** CHECK IF FILE IS A PHYSICAL FILE                                 046082
      *                                                                   046082
     C                     MOVELNPEF      PHYNAM 10                       046082
     C                     MOVEL*BLANKS   PHYTXT 50                       046082
     C                     MOVEL*BLANKS   PHYOK   1                       046082
     C                     Z-ADD0         PHYRL   50                      046082
     C                     CALL 'HFC0110'                                 046082
     C                     PARM           PHYNAM                          046082
     C                     PARM           PHYTXT                          046082
     C                     PARM           PHYRL                           046082
     C                     PARM           PHYOK                           046082
      *                                                                   046082
      ** ERROR IF FILE IS NOT A PHYSICAL FILE                             046082
      *                                                                   046082
     C           PHYOK     IFEQ 'N'                                       046082
     C                     MOVEL'HAF0005' WUMSID           Message Identif046082
     C                     CALL 'SCC0240'                  Retrieve MSGF m046082
     C           WUMSID    PARM WUMSID    WQ0001           Message Identif046082
     C           WUMSGF    PARM WUMSGF    WQ0002           Message File Na046082
     C                     MOVE '1'       *IN50                           046082
     C                     GOTO START                                     046082
     C                     ELSE                                           046082
      *                                                                   046082
      ** ERROR IF FILE IS NOT JOURNALLED                                  046082
      *                                                                   046082
     C           PHYOK     IFEQ 'R'                                       046082
     C                     MOVEL'HAF0010' WUMSID           Message Identif046082
     C                     CALL 'SCC0240'                  Retrieve MSGF m046082
     C           WUMSID    PARM WUMSID    WQ0001           Message Identif046082
     C           WUMSGF    PARM WUMSGF    WQ0002           Message File Na046082
     C                     MOVE '1'       *IN50                           046082
     C                     GOTO START                                     046082
     C                     END                                            046082
     C                     END                                            046082
      *                                                                   046082
      ** VALIDATION COMPLETE, CHECK IF CMD13 (START) PRESSED              046082
      *                                                                   046082
     C***03                MOVELNPEF      PGM                             046082
     C***03                OUT  JRN                                       046082
     C***03                SETON                     U3LR                 046082
     C***03                GOTO ENDPGM                                    046082
     C           *IN13     IFEQ '1'                                       046082
     C                     MOVELNPEF      PGM                             046082
     C                     OUT  JRN                                       046082
     C                     SETON                     U3LR                 046082
     C                     GOTO ENDPGM                                    046082
     C                     END                                            046082
      *                                                                   046082
      ** SEND A MESSAGE TO PRESS F13 AFTER ALL VALIDATION COMPLETE        046082
      *                                                                   046082
     C                     MOVEL'HAF0121' WUMSID           Message Identif046082
     C                     CALL 'SCC0240'                  Retrieve MSGF m046082
     C           WUMSID    PARM WUMSID    WQ0001           Message Identif046082
     C           WUMSGF    PARM WUMSGF    WQ0002           Message File Na046082
     C                     MOVEL'0'       *IN50                           046082
     C                     GOTO START
     C           ENDPGM    TAG
     C*****************************************************************
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
