/*******************************************************************************/
/*                                                                             */
/*       Midas - HIL Module                                                    */
/*                                                                             */
/*       MIVW_HOLID - Midas HIL Holidays view                                  */
/*                                                                             */
/*       (c) Finastra International Limited 2011                               */
/*                                                                             */
/*       Last Amend No. MD046248           Date 27Oct17                        */
/*       Prev Amend No. AR907056           Date 03Feb12                        */
/*                      CRE072  *CREATE    Date 30Jun11                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD046248 - Finastra Rebranding                                        */
/*       AR907056 - Redelivery of BFMI Schema (Recompile)                      */
/*       CRE072 - BankFusion Midas Teller Related Changes                      */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  (MIKEYPK,                                                                     :
   MICYCD,                                                                      :
   MILCCD,                                                                      :
   MISDAT,                                                                      :
   MIYRNB,                                                                      :
   MIMNTH,                                                                      :
   MIDAYS,                                                                      :
   MIHOLF,                                                                      :
   MICHDT,                                                                      :
   MICHDTS,                                                                     :
   VERSIONNUM)                                                                  :
  AS SELECT                                                                     :
   D1CYCD CONCAT D1LCCD CONCAT CAST(D1SDAT AS VARCHAR(100)) CONCAT D1YRNB,      :
   D1CYCD,                                                                      :
   D1LCCD,                                                                      :
   D1SDAT,                                                                      :
   D1YRNB,                                                                      :
   D1MNTH,                                                                      :
   D1DAYS,                                                                      :
   D1HOLF,                                                                      :
   D1CHDT,                                                                      :
   CASE WHEN D1CHDT = 0 THEN NULL ELSE DATE(D1CHDT + 719892) END AS MICHDTS,    :
   1 AS VERSIONNUM                                                              :
  FROM SDHOL1PD;                                                                :
                                                                                :
  LABEL ON COLUMN **********/**********                                         :
  (MIKEYPK IS 'Primary Key',                                                    :
   MICYCD IS 'Currency code' ,                                                  :
   MILCCD IS 'Location code' ,                                                  :
   MISDAT IS 'Date' ,                                                           :
   MIYRNB IS 'Year Number' ,                                                    :
   MIMNTH IS 'Month' ,                                                          :
   MIDAYS IS 'Day' ,                                                            :
   MIHOLF IS 'Holiday Flag' ,                                                   :
   MICHDTS IS 'Changed Date' );                                                 :
                                                                                :
  LABEL ON COLUMN **********/**********                                         :
  (MICYCD TEXT IS 'Currency Code' ,                                             :
   MILCCD TEXT IS 'Location Code' ,                                             :
   MISDAT TEXT IS 'Date' ,                                                      :
   MIYRNB TEXT IS 'Year Number' ,                                               :
   MIMNTH TEXT IS 'Month' ,                                                     :
   MIDAYS TEXT IS 'Day' ,                                                       :
   MIHOLF TEXT IS 'Holiday Flag' ,                                              :
   MICHDT TEXT IS 'Changed Date' ,                                              :
   MICHDTS TEXT IS 'Changed Date (SQL)' ) ;                                     :
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas HIL Holidays view                           ';                     :
                                                                                :
