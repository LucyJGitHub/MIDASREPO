     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas IBLC 2002 Access Journal Entries Ext. file')
      *****************************************************************
      *                                                               *
      *  Midas - IBLC 2002 Module                                     *
      *                                                               *
      *  RPG/IL0455    - ACCESS IBLC JOURNAL ENTRIES EXT. FILE        *
      *                                                               *
      *  Function:  This program access to IBLC journal entries       *
      *             Extended file and return on BLLINE parameter      *
      *             the extended informations to be printed           *
      *                                                               *
      *  (phase(s)) *all                                              *
      *                                                               *
      *  Called By: GL0121P - All Batch Report                        *
      *             GL0122P - Batch Details Report                    *
      *                                                               *
      *  (c) Finastra International Limited 2005                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CER001             Date 25Apr05               *
      *                 ULX043             Date 25Jul01               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  ULX043 - IBLC 2002 Reporting                                 *
      *                                                               *
      *****************************************************************
      *
     F***GLJENPYLIF  E           K        DISK                                                CER001
     FGLJPX1L0IF  E           K        DISK                                                   CER001
      ***  IBLC Journal Entries Ext.   Retrieval index     Prefix JE.
      *
      /EJECT
      *****************************************************************
     E                    CPY@    1   1 80               COPYRIGHT  ARRAY
      ***  Copyright array
     E                    ZS1        15  1 0             ZSEDIT SR. ARRAY
     E                    ZS2        21  1               ZSEDIT SR. ARRAY
      /EJECT
      *****************************************************************
     IILLINE      DS                            396
      * Extended informations from IBLC 2002
     I                                        1 132 ILLIN1
     I                                      133 264 ILLIN2
     I                                      265 396 ILLIN3
     I            DS
      * Define fields narratives
     I              'IBLC 2002 Code:'     C         FN01
     I              'Country Code:'       C         FN02
     I              'Identification:'     C         FN03
     I              'Posting amount:'     C         FN04
     I*
     ILINE1       DS                            132
     I                                        1  11 FILLER
     I                                       12  26 L1DS01
     I                                       28  30 L1DS02
     I                                       35  47 L1DS03
     I                                       49  50 L1DS04
     I                                       55  69 L1DS05
     I                                       71  72 L1DS06
     I                                       74  82 L1DS07
     I                                       87 102 L1DS08
     I                                      103 117 L1DS09
     I                                      118 118 L1DS10
      * Define lines structures
      * ZSEDIT data structure
     I            DS
     I                                        1  150WORK15
     I                                        1  150ZS1
      *
      /EJECT
      *****************************************************************
      * Main processing
      *****************************************************************
      *
      **  Access extended currency record
      *
     C********** KKEY1     CHAINGLJENPYL             89                                       CER001
     C           KKEY1     CHAINGLJPX1L0             89                                       CER001
      *
     C           *IN89     IFEQ *OFF
      *
      **  Set up extended line(s)
      *
     C           JEOPC1    IFNE 0
     C                     MOVE *BLANKS   LINE1
     C                     MOVELFN01      L1DS01    P
     C                     MOVELJEOPC1    L1DS02    P
     C                     MOVELFN02      L1DS03    P
     C                     MOVELJECOC1    L1DS04    P
     C                     MOVELFN03      L1DS05    P
     C                     MOVELJEIDC1    L1DS06    P
     C                     MOVE JEIDE1    L1DS07    P
     C                     MOVELFN04      L1DS08    P
     C                     MOVE JEDCI1    L1DS10    P
     C           JEPTA1    IFNE *ZERO
     C                     MOVE *BLANKS   ZECODE
     C                     Z-ADD0         ZFLD15
     C                     Z-ADDNBDP      ZDECS
     C                     Z-ADDJEPTA1    ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    L1DS09    P
     C                     ELSE
     C                     MOVE *BLANKS   L1DS09
     C                     ENDIF
      *
     C                     MOVELLINE1     ILLIN1    P
     C                     ENDIF
      *
     C           JEOPC2    IFNE 0
     C                     MOVE *BLANKS   LINE1
     C                     MOVELFN01      L1DS01    P
     C                     MOVELJEOPC2    L1DS02    P
     C                     MOVELFN02      L1DS03    P
     C                     MOVELJECOC2    L1DS04    P
     C                     MOVELFN03      L1DS05    P
     C                     MOVELJEIDC2    L1DS06    P
     C                     MOVE JEIDE2    L1DS07    P
     C                     MOVELFN04      L1DS08    P
     C                     MOVE JEDCI2    L1DS10    P
     C           JEPTA2    IFNE *ZERO
     C                     MOVE *BLANKS   ZECODE
     C                     Z-ADD0         ZFLD15
     C                     Z-ADDNBDP      ZDECS
     C                     Z-ADDJEPTA2    ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    L1DS09    P
     C                     ELSE
     C                     MOVE *BLANKS   L1DS09
     C                     ENDIF
      *
     C                     MOVELLINE1     ILLIN2    P
     C                     ENDIF
      *
     C           JEOPC3    IFNE 0
     C                     MOVE *BLANKS   LINE1
     C                     MOVELFN01      L1DS01    P
     C                     MOVELJEOPC3    L1DS02    P
     C                     MOVELFN02      L1DS03    P
     C                     MOVELJECOC3    L1DS04    P
     C                     MOVELFN03      L1DS05    P
     C                     MOVELJEIDC3    L1DS06    P
     C                     MOVE JEIDE3    L1DS07    P
     C                     MOVELFN04      L1DS08    P
     C                     MOVE JEDCI3    L1DS10    P
     C           JEPTA3    IFNE *ZERO
     C                     MOVE *BLANKS   ZECODE
     C                     Z-ADD0         ZFLD15
     C                     Z-ADDNBDP      ZDECS
     C                     Z-ADDJEPTA3    ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    L1DS09    P
     C                     ELSE
     C                     MOVE *BLANKS   L1DS09
     C                     ENDIF
      *
     C                     MOVELLINE1     ILLIN3    P
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Setup return parameter
     C                     MOVE '0'       PFAIL
      *-------------------------------------------------------------------------
      * End of processing
      *-------------------------------------------------------------------------
      *
      **  Return to caller program
      *
     C                     RETRN
      /EJECT
      *-------------------------------------------------------------------------
      * ZSEDIT - Routine to insert a decimal point and sign into a numeric
      *          field and to blank out leading zeros (optionaly inserting
      *          commas)
      *-------------------------------------------------------------------------
      *
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      *-------------------------------------------------------------------------
      * Initial subroutine
      *-------------------------------------------------------------------------
      *
     C           *INZSR    BEGSR
      *
     C                     MOVEACPY@      CPY@2  80        Copyrights
      *
      **  Define parameters list
      *
     C           *ENTRY    PLIST
     C                     PARM           PBTNB   3
     C                     PARM           PBINB   30
     C                     PARM           ILLINE
     C                     PARM           PFAIL   1
     C                     PARM           NBDP    10
      * Key list
     C           KKEY1     KLIST
     C                     KFLD           PBTNB
     C                     KFLD           PBINB
      *
     C                     ENDSR
      /EJECT
      *-------------------------------------------------------------------------
**  CPY@
(c) Finastra International Limited 2005
