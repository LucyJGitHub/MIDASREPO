     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas IBLC 2002 Retrieve FF Instrument Extension')
      *****************************************************************
      *                                                               *
      *  Midas - IBLC 2002 Module                                     *
      *                                                               *
      *  RPG/IL0462    - ACCESS FF INSTRUMENTS EXTENDED FILE          *
      *                                                               *
      *  Function:  This program access to ff Instruments extended    *
      *             file and return on IBFROM parameter the extended  *
      *             informations to be printed                        *
      *                                                               *
      *  (phase(s)) *all                                              *
      *                                                               *
      *  Called By: FF1140  - Instruments Aud/Req report              *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2005            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CER001             Date 25Apr05               *
      *  Prev Amend No. ULX043             Date 20Aug01               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  ULX043 - IBLC 2002 Reporting                                 *
      *                                                               *
      *****************************************************************
      *
     F***INTYPDYLIF  E           K        DISK                                                CER001
     FFFITX1L0IF  E           K        DISK                                                   CER001
      ***  IBLC Market instruments         Retrieval index       Prefix IN
      *
      /EJECT
      *-------------------------------------------------------------------------
     E                    CPY@    1   1 80               COPYRIGHT  ARRAY
      /EJECT
      *-------------------------------------------------------------------------
     IIBFROM      DS                            396
      * Extended informations from IBLC 2002
     I                                        1 132 IBFRO1
     I                                      133 264 IBFRO2
     I                                      265 396 IBFRO3
     I            DS
      * Define fields narratives
     I              'IBLC 2002 Market typ-C         FN01
     I              'e :'
     ILINE1       DS                            132
     I                                       02  24 L1DS01
     I                                       26  26 L1DS02
      ***  Define lines structures
      *
      /EJECT
      *-------------------------------------------------------------------------
      * Main processing
      *-------------------------------------------------------------------------
      *
      ***  Access extended currency record
      *
     C********** PISTT     CHAININTYPDYL             89                                       CER001
     C           PISTT     CHAINFFITX1L0             89                                       CER001
      *
     C           *IN89     IFEQ *OFF
      *
      ***  Set up extended line(s)
      *
     C                     MOVELFN01      L1DS01    P
     C                     MOVELINMRKT    L1DS02    P
     C                     MOVELLINE1     IBFRO1
      *
      ***  Ensure *blanks
      *
     C                     MOVEL*BLANKS   IBFRO2
     C                     MOVEL*BLANKS   IBFRO3
      *
     C                     ENDIF
      *-------------------------------------------------------------------------
      * End of processing
      *-------------------------------------------------------------------------
      *
      ***  Return to caller program
      *
     C                     RETRN
      /EJECT
      *-------------------------------------------------------------------------
      * Initial subroutine
      *-------------------------------------------------------------------------
      *
     C           *INZSR    BEGSR
      *
     C                     MOVEACPY@      CPY@2  80        Copyrights
      *
      ***  Define parameters list
      *
     C           *ENTRY    PLIST
     C                     PARM           PISTT   5
     C                     PARM           IBFROM
      *
     C                     ENDSR
      /EJECT
      *-------------------------------------------------------------------------
**  CPY@
(c) Misys International Banking Systems Ltd. 2005
