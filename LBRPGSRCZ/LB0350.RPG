     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LB Commit. Limit awaiting authorisation')
     H/TITLE TOTAL COMMITMENT LINES AWAITING AUTHORISATION
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Lending Module                         *
     F*                                                               *
     F*  LB0350 - Total Commitment Lines Awaiting Authorisation       *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01498             Date 11Aug94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  S01498 - Portfolio Lending Upgrade to Release 10             *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/EJECT
     F*****************************************************************
     F*
     F***ICD*record*1*Prefix*-*BJ**************************************   S01498
     F***SDBANKPDIF**E                    DISK         KINFSR *PSSR       S01498
     F*
     F** Trailer file  Prefix - TR
     FLBTRAIPDIF  E           K        DISK         KINFSR *PSSR
     F*
     F***ICD*-*branch*codes**Prefix*-*AZ*******************************   S01498
     F***SDACOFL0IF**E           K        DISK         KINFSR *PSSR       S01498
     F*
     F***ICD*-*currency*codes**Prefix*-*A6*****************************   S01498
     F***SDCURRL1IF**E           K        DISK         KINFSR *PSSR       S01498
     F*
     F** Total commitment lines awaiting authorisation
     FLB0350AUO   E             11     PRINTER
     F***********                                   KINFDS ERF2DS         S01498
     F                                              KINFDS SPOOLU         S01498
     F*
     F***Input*selection*from*report*request*program*******************   S01498
     F***QINLINE*IF  F      96            DISK         KINFSR *PSSR     UCS01498
     F*
     F** Client master file  Prefix - BB
     F***SDLBCSL0IF**E           K        DISK         KINFSR *PSSR       S01498
     FLBLBCSJ0IF  E           K        DISK         KINFSR *PSSR          S01498
     F            SDLBCSJ0                          KRENAMESDLBCSF1
     F*
     F** Client master file  Prefix - BB
     F***SDLBCSL1IF**E           K        DISK         KINFSR *PSSR       S01498
     FLBLBCSJ1IF  E           K        DISK         KINFSR *PSSR          S01498
     F            SDLBCSJ0                          KRENAMESDLBCSF2
     F*
     F** Client master file  Prefix - BB
     F***SDLBCSL3IF**E           K        DISK         KINFSR *PSSR       S01498
     F*********** SDLBCSJ0                          KRENAMESDLBCSF3       S01498
     F*
     F** Commitment line transaction file    Prefix - CT
     FLBCOMTL1IF  E           K        DISK         KINFSR *PSSR
     F*
     F** Total commitment lines awaiting authorisation
     F***LB0350P1O***E             10     PRINTER      KINFDS ERF1DS      S01498
     FLB0350P1O   E             10     PRINTER      KINFDS SPOOL      UC  S01498
     F*****************************************************************
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*       10         Overflow indicator for LB0350P1
     F*       11         Overflow indicator for LB0350AU
     F*       21         Conditions first notes line for transaction file
     F*       22         Conditions second notes line for transaction file
     F*       39         Multibranching indicator                         S01498
     F*       52         HEADINGS ALREADY PRINTED FOR BRANCH & AC.OFF.
     F*       53         AT LEAST ONE DETAIL LINE PRINTED
     F********70*********Read*fail*on*SDBANKPD*************************   S01498
     F********71*********Read*fail*on*SDLBCSL1*************************   S01498
     F*       71         Read fail on LBLBCSJ1                            S01498
     F********72*********Chain*fail*on*SDACOFL0************************   S01498
     F*       73         Chain fail on LBCOMTL1
     F********75*********Read*fail*on*SDLBCSL3*************************   S01498
     F********76*********Chain*fail*on*SDLBCSL0************************   S01498
     F*       75         Read fail on LBLBCSJ3                            S01498
     F*       76         Chain fail on LBLBCSJ0                           S01498
     F********77*********Read*fail*on*QINLINE**************************   S01498
     F********78*********Chain*to*currency*file*fails******************   S01498
     F*       79         Chain to trailer file LBTRAIPD fails
     F*       98         Used by ZDATE2
     F*****************************************************************
     E/EJECT
     E********************************************************************
     E*
     E**   Array for COPYRIGHT
     E                    CPY@    1   1 80
     E********************************************************************
     F/EJECT
     E*****************************************************************
     E/COPY ZSRSRC,ZSEDITZ1
     E*****************************************************************
     E/EJECT
     E*****************************************************************
     E/COPY ZSRSRC,ZDATE2Z1
     E*****************************************************************
     E/EJECT
     E*****************************************************************
     I*
     I*****Input*specs*for*internally*described*STRDBJWK*file**********   S01498
     I***QINLINE*NS                                                       S01498
     I****************************************1   3 ICDE                  S01498
     I****************************************4   5 IACC                  S01498
     I****************************************6  11 ICNO                  S01498
     I*                                                                   S01498
     I@RPARM      DS                            100                       S01498
     I**  Report parameters                                               S01498
     I                                        1   6 ICNO                  S01498
     I*
     I**   DATA STRUCTURE FOR COMPILATION - Copyright Insertion
     ICPYR@$      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@$$
     I*
     I** Data structures for decimal places formatting subroutine
     I/COPY ZSRSRC,ZSEDITZ2
     I*
     I*    PROGRAM STATUS DATA STRUCTURE
     I*
     IPSDS       SDS
     I                                      244 253 JOB
     I                                      254 263 USER
     I*
     I*    FILE INFORMATION DATA STRUCTURE
     I*
     I***ERF1DS******DS                                                   S01498
     ISPOOL       DS                                                      S01498
     I                                       83  92 SFILE                 S01498
     I                                    B 123 1240SFNUM                 S01498
     I*    FOR OVERFLOW
     I*
     I                                    B 367 3680LINE
     I*
     I***ERF2DS******DS                                                   S01498
     ISPOOLU      DS                                                      S01498
     I                                       83  92 SFILEU                S01498
     I                                    B 123 1240SFNUMU                S01498
     I*
     I**   FOR OVERFLOW
     I                                    B 367 3680LINE1
     IRUNDAT    E DS                                                      S01498
     I**  Standard Data Area Layout for System flags and Run Date         S01498
     I*                                                                   S01498
     I*
     I* Local Data Area
     I*
     I***LDA********UDS                            256                    S01498
     ILDA         DS                            256                       S01498
     I                                      132 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*                                                                   S01498
     ISDBANK    E DSSDBANKPD                                              S01498
     I**  Data structure for bank details                                 S01498
     I*                                                                   S01498
     ISDBRCH    E DSSDBRCHPD                                              S01498
     I**  Data structure for branch details                               S01498
     I*                                                                   S01498
     ISDCURR    E DSSDCURRPD                                              S01498
     I**  Data structure for currency details                             S01498
     I*                                                                   S01498
     ISDACOF    E DSSDACOFPD                                              S01498
     I**  Data structure for account officer details                      S01498
     I*                                                                   S01498
     IDSFDY     E DSDSFDY                                                 S01498
     I**  Short data structure for access objects                         S01498
     I*                                                                   S01498
     IDSSDY     E DSDSSDY                                                 S01498
     I**  Long data structure for access programs                         S01498
     I*                                                                   S01498
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C** PARAMETER LIST DECLARATIONS
     C** ---------------------------
     C** WWSWIT - INPUT CYCLE FLAG - 0 = CALLED FROM MENU
     C**                           - 1 = CALLED FROM ANOTHER PROGRAM
     C*
     C** Input parameter list
     C           *ENTRY    PLIST
     C                     PARM           WWSWIT  1
     C                     PARM           @RSEQ   5                       S01498
     C                     PARM           @RLEV   1                       S01498
     C                     PARM           @RENT   3                       S01498
     C                     PARM           @RPARM                          S01498
     C********************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C* Mainline
     C*
     C** Initialization Subroutine
     C                     EXSR #A
     C*
     C           WWSWIT    IFEQ '0'
     C*
     C** End of day processing
     C                     EXSR #ZA
     C*
     C***No*details*to*report*variable*********************************   S01498
     C************IN53     IFEQ '0'                                       S01498
     C***********          MOVE *BLANK    RRSPTA                          S01498
     C***********          MOVE *BLANK    RRACOC                          S01498
     C***********          MOVE *BLANK    RRACON                          S01498
     C***********          WRITEHEAD1                                     S01498
     C***********          WRITEHEAD2                                     S01498
     C***********          WRITENODTL                                     S01498
     C***********          END                                            S01498
     C*
     C** Output run controls report
     C                     EXSR #C
     C*
     C                     ELSE
     C*
     C           WWSWIT    IFEQ '1'
     C*
     C** Input cycle processing
     C                     EXSR #D
     C                     END
     C*
     C                     END
     C*
     C                     MOVE '1'       *INLR
     C                     RETRN
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*                  INDEX TO SUBROUTINES                         *
     C*                  ~~~~~~~~~~~~~~~~~~~~                         *
     C*             1.  ZDATE2-  CONVERT 5-FIGURE DAY NO TO DATE FMT  *
     C*             2.  ZSEDIT-  FORMATS CURRENCY FOR OUTPUT          *
     C*             3.  #ZDA  -  PROCESS ACCOUNT OFFICER HEADINGS     *
     C*             4.  #ZD   -  PROCESS ONE CUSTOMER                 *
     C*             5.  #ZC   -  ACCESS ACCOUNT OFFICER FILE          *
     C*             6.  #ZB   -  PROCESS ONE BRANCH CODE              *
     C*             7.  #ZA   -  PROCESS ALL BRANCHES                 *
     C**************8.**#DA***-**PROCESS*INPUT*SELECTION*<>**ALL*******   S01498
     C**************9.**#DB***-**PROCESS*A/C*OFFICER*(INPUT*CYCLE)*****   S01498
     C*            10.  #DC   -  PROCESS CUSTOMER (INPUT CYCLE)       *
     C*            11.  #A    -  INITIALISATION                       *
     C*            12.  #D    -  PROCESS QINLINE INPUT SELECTION      *
     C*            13.  #C    -  PRODUCE RUN CONTROLS REPORT          *
     C*            14.  #DBAS1-  DATABASE ERROR SUBROUTINE 1          *
     C*            15.  #DBAS2-  DATABASE ERROR SUBROUTINE 2          *
     C*            16.  #DBAS3-  DATABASE ERROR SUBROUTINE 3          *
     C*            17.  #DBAS4-  DATABASE ERROR SUBROUTINE 4          *
     C*            18.  #DBAS5-  DATABASE ERROR SUBROUTINE 5          *
     C*            19.  #DBAS6-  DATABASE ERROR SUBROUTINE 6          *
     C*            20.  #DBASZ-  DATABASE ERROR SUBROUTINE Z          *
     C*            21.  #PSSR -  PROGRAM ERROR HANDLING ROUTINE       *
     C*                                                               *
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* ZDATE2   -  Convert date from 5 numeric to DDMMMYY format     *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY-  #ZD                                               *
     C*                                                               *
     C*****************************************************************
     C/COPY ZSRSRC,ZDATE2Z2
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* ZSEDIT   -  Currency formatting subroutine                    *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY-  #ZD                                               *
     C*                                                               *
     C*****************************************************************
     C/COPY ZSRSRC,ZSEDITZ3
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #ZDA     -  Process account officer headings                  *
     C*                                                               *
     C* CALLS    -  #ZC                                               *
     C*                                                               *
     C* CALLED BY-  #ZD                                               *
     C*                                                               *
     C*****************************************************************
     C           #ZDA      BEGSR
     C*
     C**   On change of account officer or first time through
     C           BBACOC    IFNE WWACOC
     C           BBBRCD    ORNE WWSPTA
     C           WWFTT     OREQ 'Y'
     C*
     C** If nothing written for this A/c Off. write no details line
     C*******    WWNOD     IFEQ '0'
     C*******    WWFTT     ANDEQ'N'
     C*******              WRITENODTL
     C*******              END
     C                     MOVE '0'       WWNOD
     C                     MOVE 'N'       WWFTT
     C*
     C** If A/C Officer changes access A/C Officer file
     C                     EXSR #ZC
     C*
     C** Write headings
     C*******              WRITEHEAD1
     C*******              WRITEHEAD2
     C                     MOVE '0'       *IN52
     C*
     C                     MOVE BBBRCD    WWSPTA
     C                     MOVE BBACOC    WWACOC
     C*
     C                     END
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #ZD      -  Process one customer                              *
     C*                                                               *
     C* CALLS    -  #ZDA #DBAS4 #DBASZ                                *
     C*                                                               *
     C* CALLED BY-  #DB #DC #ZB                                       *
     C*                                                               *
     C*****************************************************************
     C           #ZD       BEGSR
     C*
     C**   Write new headings on change of account officer
     C                     EXSR #ZDA
     C*
     C                     MOVE BBCUST    WWCUST
     C           WWCUST    SETLLLBCOMTL1
     C           WWCUST    READELBCOMTL1                 73
     C*
     C           *IN73     DOWEQ'0'
     C*
     C** If correct record(s) exist on transaction file
     C**    process them for output
     C*
     C                     EXSR #ZDA
     C*
     C** Move '1' to no details variable
     C                     MOVE '1'       WWNOD
     C*
     C** Move transaction file fields to PRTF fields for output
     C                     MOVE BBCUST    RRCNUM
     C                     MOVE BBCRNM    RRCRNM
     C*
     C** Chain to currency file to find no of dec places for currency
     C***********CTCCY     CHAINSDCURRL1             78                   S01498
     C************IN78     IFEQ '1'                                       S01498
     C***********A6TYLC    OREQ 'D'                                       S01498
     C*                                                                   S01498
     C                     CALL 'AOCURRR0'                                S01498
     C                     PARM *BLANKS   P@RTCD                          S01498
     C                     PARM '*KEY   ' P@OPTN                          S01498
     C                     PARM CTCCY     P@CCY   3                       S01498
     C           SDCURR    PARM SDCURR    DSSDY                           S01498
     C*                                                                   S01498
     C** Check if error occurred                                          S01498
     C*                                                                   S01498
     C           P@RTCD    IFNE *BLANKS                                   S01498
     C           *LOCK     IN   LDA                                       S01498
     C                     MOVELCTCCY     DBKEY
     C                     OUT  LDA                                       S01498
     C                     EXSR #DBAS4
     C                     EXSR #DBASZ
     C                     END
     C*
     C** Format currency
     C                     MOVE A6NBDP    ZDECS
     C                     Z-ADDCTCMTL    ZFLD15
     C                     MOVE 'J'       ZECODE
     C*
     C** Format correct number of decimal places
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAMT1
     C                     MOVE CTCCY     RRCTCY
     C*
     C** Convert a 5 figure day number into date format - start DATE
     C                     Z-ADDCTSTTD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RRCTTD
     C*
     C** Convert a 5 figure day number into date format - expiry date
     C                     Z-ADDCTEXPD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RRCTEX
     C*
     C** Convert a 5 figure day number into date format - review date
     C                     Z-ADDCTREVD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RRCTVD
     C                     MOVE CTREVF    RRCTVF
     C                     MOVE CTREVN    RRCTVN
     C*
     C** Convert a 5 figure day number into date format - last change date
     C                     Z-ADDCTLCD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RRCTLC
     C           CTCHTP    IFEQ 'I'
     C                     MOVE 'INSERT'  RRCTTP
     C                     END
     C           CTCHTP    IFEQ 'A'
     C                     MOVE 'AMEND '  RRCTTP
     C                     END
     C           CTCHTP    IFEQ 'D'
     C                     MOVE 'DELETE'  RRCTTP
     C                     END
     C*
     C                     MOVE CTUSR     RRCTUS
     C*
     C** Provision for additional text to be outpout on PRTF
     C           CTNOT1    IFNE *BLANKS
     C           CTNOT2    ORNE *BLANKS
     C                     MOVE CTNOT1    RRCTN1
     C                     MOVE CTNOT2    RRCTN2
     C                     MOVE '1'       *IN21
     C                     END
     C           CTNOT3    IFNE *BLANKS
     C           CTNOT4    ORNE *BLANKS
     C                     MOVE CTNOT3    RRCTN3
     C                     MOVE CTNOT4    RRCTN4
     C                     MOVE '1'       *IN22
     C                     END
     C*                                                                   S01498
     C**  Process if there is a change in branch                          S01498
     C*                                                                   S01498
     C           BBBRCD    IFNE RRBRCA                                    S01498
     C*                                                                   S01498
     C**  If printer file is open and entity is not blank, print footer   S01498
     C*                                                                   S01498
     C           WLOPN     IFEQ 'Y'                                       S01498
     C           @RENT     ANDNE*BLANKS                                   S01498
     C                     WRITEENDREP                                    S01498
     C                     CLOSELB0350P1                                  S01498
     C                     MOVE *BLANK    WLOPN                           S01498
     C                     END                                            S01498
     C*                                                                   S01498
     C**  Open printer file LB0350P1 if entity is not blank               S01498
     C**  or the printer file is not yet open                             S01498
     C*                                                                   S01498
     C           @RENT     IFNE *BLANKS                                   S01498
     C           WLOPN     ORNE 'Y'                                       S01498
     C                     OPEN LB0350P1                                  S01498
     C                     MOVE 'Y'       WLOPN   1                       S01498
     C*                                                                   S01498
     C** Ensure Report Spool File recorded by RCF                         S01498
     C*                                                                   S01498
     C           @RENT     IFNE *BLANKS                                   S01498
     C                     MOVE BBBRCD    SENTY                           S01498
     C                     END                                            S01498
     C*                                                                   S01498
     C                     Z-ADDSFNUM     ZSNUM1  60                      S01498
     C                     CALL 'ZSFILE'                                  S01498
     C                     PARM           @RSEQ                           S01498
     C                     PARM           SENTY   3                       S01498
     C                     PARM           SFILE                           S01498
     C                     PARM           ZSNUM1                          S01498
     C                     PARM           ZSERR   1                       S01498
     C*                                                                   S01498
     C** If an error occurred during ZSFILE processing,                   S01498
     C** return to the calling program.                                   S01498
     C*                                                                   S01498
     C           ZSERR     IFEQ 'Y'                                       S01498
     C                     SETON                     U7U8LR               S01498
     C                     RETRN                                          S01498
     C                     END                                            S01498
     C*                                                                   S01498
     C**  Initialise page and line numbers                                S01498
     C*                                                                   S01498
     C                     Z-ADD*ZEROS    LINE                            S01498
     C                     Z-ADD*ZEROS    PAGE                            S01498
     C                     MOVE BBBRCD    RRBRCA                          S01498
     C*                                                                   S01498
     C**  Use access object to get branch name                            S01498
     C*                                                                   S01498
     C**********           CALL 'AOBRCHR0'                                S01498              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   P@RTCD                          S01498
     C                     PARM '*KEY   ' P@OPTN                          S01498
     C                     PARM RRBRCA    P@BRCA  3                       S01498
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01498              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01498
     C**  Check if error occurred                                         S01498
     C*                                                                   S01498
     C           P@RTCD    IFNE *BLANKS                                   S01498
     C           *LOCK     IN   LDA                                       S01498
     C                     MOVE 'SDBRCHPD'DBFILE           ***************S01498
     C                     Z-ADD50        DBASE            * DBERROR 050 *S01498
     C                     MOVE *BLANKS   DBKEY            ***************S01498
     C                     MOVELRRBRCA    DBKEY                           S01498
     C                     OUT  LDA                                       S01498
     C                     EXSR #DBASZ                                    S01498
     C                     END                                            S01498
     C*                                                                   S01498
     C                     MOVE A8BRNM    RRBRNM                          S01498
     C*                                                                   S01498
     C                     END                                            S01498
     C*                                                                   S01498
     C                     END                                            S01498
     C*                                                                   S01498
     C           LINE      IFGT 56
     C           *IN52     OREQ '0'
     C                     WRITEHEAD1
     C                     WRITEHEAD2
     C                     MOVE '1'       *IN52
     C                     END
     C                     ADD  1         RRCT1
     C                     WRITETRNDTL
     C                     MOVE '1'       *IN53
     C*
     C** Don't output notes fields
     C                     MOVEA'00'      *IN,21
     C           WWCUST    READELBCOMTL1                 73
     C                     END
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #ZC      -  Access account officer file SDACOFL0              *
     C*                                                               *
     C* CALLS    -  #DBAS2 #DBASZ                                     *
     C*                                                               *
     C* CALLED BY-  #ZB #DB #DC #ZDA                                  *
     C*                                                               *
     C*****************************************************************
     C           #ZC       BEGSR
     C           BBACOC    IFNE *BLANKS
     C                     MOVE BBACOC    AZACOC
     C*
     C** Chain to A/C Officer file for A/C Officer name
     C***********AZACOC    CHAINSDACOFL0             72                   S01498
     C************IN72     IFEQ '1'                                       S01498
     C***********AZTYLC    OREQ 'D'                                       S01498
     C*                                                                   S01498
     C                     CALL 'AOACOFR0'                                S01498
     C                     PARM *BLANKS   P@RTCD                          S01498
     C                     PARM '*KEY   ' P@OPTN                          S01498
     C                     PARM AZACOC    P@ACOC  2                       S01498
     C           SDACOF    PARM SDACOF    DSFDY                           S01498
     C*                                                                   S01498
     C           P@RTCD    IFNE *BLANK                                    S01498
     C                     EXSR #DBAS2
     C                     EXSR #DBASZ
     C                     END
     C                     MOVE AZACON    RRACON
     C                     ELSE
     C                     MOVE *BLANKS   RRACON
     C                     END
     C                     MOVE BBBRCD    RRSPTA
     C                     MOVE BBACOC    RRACOC
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #ZB      -  Process one branch code                           *
     C*                                                               *
     C* CALLS    -  #ZC #ZD                                           *
     C*                                                               *
     C* CALLED BY-  #ZA #DA                                           *
     C*                                                               *
     C*****************************************************************
     C           #ZB       BEGSR
     C*
     C                     MOVE BBBRCD    WWSVBC
     C*
     C           BBBRCD    DOWEQWWSVBC
     C           *IN71     ANDEQ'0'
     C*
     C** Process one customer
     C                     EXSR #ZD
     C***********          READ SDLBCSL1                 71               S01498
     C                     READ LBLBCSJ1                 71               S01498
     C*                                                                   S01498
     C**  Check if branch is the same is the branch selected              S01498
     C*                                                                   S01498
     C           @RENT     IFNE 'ALL'                                     S01498
     C           @RENT     ANDNE*BLANKS                                   S01498
     C           @RENT     ANDNEBBBRCD                                    S01498
     C                     MOVE *ON       *IN71                           S01498
     C                     END                                            S01498
     C*                                                                   S01498
     C                     END
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #ZA      -  Process all branches                              *
     C*                                                               *
     C* CALLS    -  #ZB                                               *
     C*                                                               *
     C* CALLED BY-  MAINLINE #D                                       *
     C*                                                               *
     C*****************************************************************
     C           #ZA       BEGSR
     C************LOVAL    SETLLSDLBCSL1                                  S01498
     C***********          READ SDLBCSL1                 71               S01498
     C*                                                                   S01498
     C                     SELEC                                          S01498
     C*                                                                   S01498
     C**  A specific branch is selected                                   S01498
     C           @RENT     WHNE 'ALL'                                     S01498
     C           @RENT     ANDNE*BLANKS                                   S01498
     C           @RENT     SETLLLBLBCSJ1                 71               S01498
     C           @RENT     READELBLBCSJ1                 71               S01498
     C*                                                                   S01498
     C                     OTHER                                          S01498
     C           *LOVAL    SETLLLBLBCSJ1                                  S01498
     C                     READ LBLBCSJ1                 71               S01498
     C*                                                                   S01498
     C                     ENDSL                                          S01498
     C*                                                                   S01498
     C           *IN71     DOWEQ'0'
     C*
     C** Process one branch code
     C                     EXSR #ZB
     C                     END
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*                                                                   S01498
     C**  Subroutines #DA and #DB were removed as selection by branch     S01498
     C**  and account officer has been removed from the program           S01498
     C*                                                                   S01498
     C*****************************************************************   S01498
     C*****************************************************************   S01498
     C**#DA******-**Process*for*one*branch*code*(input*cycle)**********   S01498
     C*****************************************************************   S01498
     C**CALLS****-**#ZB************************************************   S01498
     C*****************************************************************   S01498
     C**CALLED*BY-**#D*************************************************   S01498
     C*****************************************************************   S01498
     C*****************************************************************   S01498
     C***********#DA       BEGSR                                          S01498
     C***********ICDE      SETLLSDLBCSL1                                  S01498
     C***********          READ SDLBCSL1                 71               S01498
     C***********                                                         S01498
     C***Process*for*one*branch*code***********************************   S01498
     C***********          EXSR #ZB                                       S01498
     C***********          ENDSR                                          S01498
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*****************************************************************   S01498
     C**#DB******-**Account*officer*processing*(input*cycle)***********   S01498
     C*****************************************************************   S01498
     C**CALLS****-**#ZD*#ZC********************************************   S01498
     C*****************************************************************   S01498
     C**CALLED*BY-**#D*************************************************   S01498
     C*****************************************************************   S01498
     C*****************************************************************   S01498
     C***********#DB       BEGSR                                          S01498
     C***********          MOVE *ZEROS    WWACOC                          S01498
     C***********IACC      SETLLSDLBCSL3                                  S01498
     C***********          READ SDLBCSL3                 75               S01498
     C************IN75     DOWEQ'0'                                       S01498
     C***********IACC      ANDEQBBACOC                                    S01498
     C***********          MOVE BBBRCD    RRSPTA                          S01498
     C***********                                                         S01498
     C** Process one customer                                             S01498
     C***********          EXSR #ZD                                       S01498
     C***********          READ SDLBCSL3                 75               S01498
     C***********          END                                            S01498
     C***********          ENDSR                                          S01498
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DC      -  Customer processing (input cycle)                 *
     C*                                                               *
     C* CALLS    -  #ZC #ZD                                           *
     C*                                                               *
     C* CALLED BY-  #D                                                *
     C*                                                               *
     C*****************************************************************
     C           #DC       BEGSR
     C                     MOVE *ZEROS    WWACOC
     C***********ICNO      SETLLSDLBCSL0                                  S01498
     C***********ICNO      READESDLBCSL0                 76               S01498
     C           ICNO      SETLLLBLBCSJ0                                  S01498
     C           ICNO      READELBLBCSJ0                 76               S01498
     C           *IN76     IFEQ '1'
     C                     EXSR #DBAS3
     C                     EXSR #DBASZ
     C                     ELSE
     C*                                                                   S01498
     C**  Process only if 'ALL' branches selected or branch is the        S01498
     C**  the same as the branch selected or entity is blank              S01498
     C*                                                                   S01498
     C           @RENT     IFEQ 'ALL'                                     S01498
     C           @RENT     OREQ *BLANKS                                   S01498
     C           @RENT     OREQ BBBRCD                                    S01498
     C                     MOVE BBBRCD    RRSPTA
     C*
     C** Process one customer
     C                     EXSR #ZD
     C                     END                                            S01498
     C*                                                                   S01498
     C                     END
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #A       -  Initialization Subroutine                         *
     C*                                                               *
     C* CALLS    -  #DBAS1 #DBASZ                                     *
     C*                                                               *
     C* CALLED BY-  MAINLINE                                          *
     C*                                                               *
     C*****************************************************************
     C           #A        BEGSR
     C*                                                                   S01498
     C**  Copyright statement                                             S01498
     C*                                                                   S01498
     C                     MOVEACPY@      ACT@   80                       S01498
     C*
     C** Initialize printer file fields
     C                     MOVE *BLANKS   RRSPTA
     C                     MOVE *BLANKS   RRACOC
     C                     MOVE *BLANKS   RRACON
     C                     MOVE *BLANKS   RRCNUM
     C                     MOVE *BLANKS   RRCRNM
     C*
     C** Initialize printer file fields (Transaction file)
     C                     MOVE *BLANKS   RRCTCY
     C                     MOVE *BLANKS   RRCTTD
     C                     MOVE *BLANKS   RRCTEX
     C                     MOVE *BLANKS   RRCTVD
     C                     MOVE *BLANKS   RRCTVF
     C                     Z-ADD*ZEROS    RRCTVN
     C                     MOVE *BLANKS   RRCTLC
     C                     MOVE *BLANKS   RRCTTP
     C                     MOVE *BLANKS   RRCTUS
     C                     MOVE *BLANKS   RRCTN1
     C                     MOVE *BLANKS   RRCTN2
     C                     MOVE *BLANKS   RRCTN3
     C                     MOVE *BLANKS   RRCTN4
     C*                                                                   S01498
     C           *NAMVAR   DEFN           LDA                             S01498
     C           *LOCK     IN   LDA                                       S01498
     C*
     C** Initialize database error fields
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     MOVE *BLANKS   DBPGM
     C                     MOVEL'LB0350'  DBPGM
     C                     MOVE *ZEROS    DBASE
     C                     OUT  LDA                                       S01498
     C*
     C** Initialize switches
     C                     MOVE '0'       *INU7
     C                     MOVE '0'       *INU8
     C*
     C** Initialize file controls fields
     C                     Z-ADD0         RRCT1   50
     C                     Z-ADD0         RRNOR1  50
     C                     Z-ADD0         RRNOR2  50
     C*
     C** Initialize indicators
     C                     MOVEA'0000000' *IN,70
     C                     MOVEA'00'      *IN,78
     C*
     C** Initialize work fields
     C           *LIKE     DEFN BBACOC    WWACOC
     C           *LIKE     DEFN BBBRCD    WWSPTA
     C           *LIKE     DEFN BBBRCD    WWSVBC
     C**********           MOVE *ZEROS    WWCUST  60                                          CSD027
     C                     MOVE *BLANKS   WWCUST  6                                           CSD027
     C                     MOVE *ZEROS    WWACOC
     C                     MOVE *ZEROS    WWSPTA
     C*                                                                   S01498
     C**  Read in DTAARA/RUNDAT to get multibranching indicator           S01498
     C*                                                                   S01498
     C           *NAMVAR   DEFN           RUNDAT                          S01498
     C                     IN   RUNDAT                                    S01498
     C           AGMBIN    IFEQ 'Y'                                       S01498
     C                     MOVE '1'       *IN39                           S01498
     C                     ELSE                                           S01498
     C*                                                                   S01498
     C**  Else, setup appropriate level and entity                        S01498
     C                     MOVE 'S'       @RLEV                           S01498
     C                     MOVE *BLANKS   @RENT                           S01498
     C                     END                                            S01498
     C*
     C**Access*table*file*for*title*and*date***************************   S01498
     C***********1         SETLLSDBANKPD                                  S01498
     C***********          READ SDBANKPD                 70               S01498
     C************IN70     IFEQ '1'                                       S01498
     C***********BJTYLC    OREQ 'D'                                       S01498
     C*                                                                   S01498
     C**  Get bank details using access object                            S01498
     C*                                                                   S01498
     C                     CALL 'AOBANKR0'                                S01498
     C                     PARM '*DBERR'  P@RTCD  7                       S01498
     C                     PARM '*FIRST'  P@OPTN  7                       S01498
     C           SDBANK    PARM SDBANK    DSFDY                           S01498
     C*                                                                   S01498
     C**  Check if error occurred                                         S01498
     C*                                                                   S01498
     C           P@RTCD    IFNE *BLANK                                    S01498
     C                     EXSR #DBAS1
     C*
     C* Output files control details
     C*
     C                     EXSR #DBASZ
     C                     END
     C*
     C** Check contents of date format indicator
     C           BJDFIN    IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     ELSE
     C           BJDFIN    IFEQ 'D'
     C                     MOVE '0'       *IN98
     C                     END
     C                     END
     C*
     C                     MOVE '0'       *IN52
     C                     MOVE '0'       *IN53
     C*                                                                   S01498
     C** Ensure Audit Spool File recorded by RCF                          S01498
     C*                                                                   S01498
     C                     Z-ADDSFNUMU    ZSNUM2  60                      S01498
     C                     CALL 'ZSFILE'                                  S01498
     C                     PARM           @RSEQ                           S01498
     C                     PARM *BLANK    SENTY                           S01498
     C                     PARM           SFILEU                          S01498
     C                     PARM           ZSNUM2                          S01498
     C                     PARM           ZSERR                           S01498
     C*                                                                   S01498
     C** If an error occurred during ZSFILE processing,                   S01498
     C** return to the calling program.                                   S01498
     C*                                                                   S01498
     C           ZSERR     IFEQ 'Y'                                       S01498
     C                     SETON                     U7U8LR               S01498
     C                     RETRN                                          S01498
     C                     END                                            S01498
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #D       -  Process input file QINLINE                        *
     C*                                                               *
     C* CALLS    -  #DA #DB #DC #ZA                                   *
     C*                                                               *
     C* CALLED BY-  Mainline                                          *
     C*                                                               *
     C*****************************************************************
     C           #D        BEGSR
     C*
     C***STRDBJWK*is*under*user*control*during*input*cycle*************   S01498
     C***********          OPEN QINLINE                                   S01498
     C***********          READ QINLINE                  77               S01498
     C*
     C                     MOVE '1'       *IN42
     C*
     C************IN77     DOWEQ'0'                                       S01498
     C*
     C                     MOVE '0'       *IN43
     C                     MOVE '0'       *IN44
     C                     MOVE '0'       *IN45
     C                     MOVE '0'       *IN46
     C*
     C           ICNO      IFNE '*ALL'
     C           ICNO      ANDNE*BLANKS
     C*
     C** one customer number requested
     C                     MOVE '0'       *IN52
     C                     MOVE '0'       *IN53
     C                     MOVE '1'       *IN45
     C                     MOVE '1'       *IN46
     C                     EXSR #DC
     C                     MOVE BBCUST    RRPNP8
     C                     MOVE BBCSSN    RRNAME
     C************IN53     IFEQ '0'                                       S01498
     C***********          WRITEHEAD1                                     S01498
     C***********          WRITEHEAD2                                     S01498
     C***********          WRITENODTL                                     S01498
     C***********          END                                            S01498
     C*
     C                     END
     C*
     C           ICNO      IFEQ '*ALL'
     C                     MOVE '0'       *IN52
     C                     MOVE '0'       *IN53
     C                     MOVE '1'       *IN45
     C                     MOVE '*ALL  '  RRPNP8
     C                     EXSR #ZA
     C************IN53     IFEQ '0'                                       S01498
     C***********          MOVE *BLANK    RRSPTA                          S01498
     C***********          MOVE *BLANK    RRACOC                          S01498
     C***********          MOVE *BLANK    RRACON                          S01498
     C***********          WRITEHEAD1                                     S01498
     C***********          WRITEHEAD2                                     S01498
     C***********          WRITENODTL                                     S01498
     C***********          END                                            S01498
     C                     END
     C*
     C***one*account*officer*requested*********************************   S01498
     C***********IACC      IFNE *BLANKS                                   S01498
     C***********          MOVE '0'       *IN52                           S01498
     C***********          MOVE '0'       *IN53                           S01498
     C***********          MOVE '1'       *IN44                           S01498
     C***********          MOVE IACC      RRACCO                          S01498
     C***********          EXSR #DB                                       S01498
     C************IN53     IFEQ '0'                                       S01498
     C***********          WRITEHEAD1                                     S01498
     C***********          WRITEHEAD2                                     S01498
     C***********          WRITENODTL                                     S01498
     C***********          END                                            S01498
     C***********          END                                            S01498
     C***********                                                         S01498
     C***one*branch*code*requested*************************************   S01498
     C***********ICDE      IFNE *BLANKS                                   S01498
     C***********          MOVE '0'       *IN52                           S01498
     C***********          MOVE '0'       *IN53                           S01498
     C***********          MOVE '1'       *IN43                           S01498
     C***********          MOVE ICDE      RRBRCO                          S01498
     C***********          EXSR #DA                                       S01498
     C************IN53     IFEQ '0'                                       S01498
     C***********          MOVE *BLANK    RRSPTA                          S01498
     C***********          WRITEHEAD1                                     S01498
     C***********          WRITEHEAD2                                     S01498
     C***********          WRITENODTL                                     S01498
     C***********          END                                            S01498
     C***********          END                                            S01498
     C*
     C** No details to report variable
     C*******    WWNOD     IFEQ '0'
     C*******              WRITENODTL
     C*******              END
     C*
     C**   Initialise first time through variables
     C                     MOVE 'Y'       WWFTT   1
     C                     MOVE '1'       WWNOD   1
     C*
     C**   Produce run controls report
     C                     EXSR #C
     C*
     C***********          READ QINLINE                  77               S01498
     C***********          END                                            S01498
     C***********                                                         S01498
     C***QINLINE**is*under*user*control*during*input*cycle*************   S01498
     C***********          CLOSEQINLINE                                   S01498
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #C       -  Process run controls report                       *
     C*                                                               *
     C* CALLS    -  #DBAS5 #DBAS6 #DBASZ                              *
     C*                                                               *
     C* CALLED BY-  mainline                                          *
     C*                                                               *
     C*****************************************************************
     C           #C        BEGSR
     C*                                                                   S01498
     C**  Print report footer if it is open                               S01498
     C           WLOPN     IFEQ 'Y'                                       S01498
     C*
     C** End of report line
     C                     WRITEENDREP
     C                     CLOSELB0350P1                                  S01498
     C                     END                                            S01498
     C*
     C**   Retrieve No. of records on transaction file from trailer file
     C                     MOVEL'LBCOMTPD'WWFILE  8
     C           WWFILE    CHAINLBTRAIPD             79
     C           *IN79     IFEQ '1'
     C           TRRECI    ORNE 'T'
     C                     EXSR #DBAS5
     C                     EXSR #DBASZ
     C                     END
     C                     Z-ADDTRLIVE    RRNOR1
     C*
     C**   Set indicator for DIFFERENCE only if EOD
     C**   OR *ALL SELECTED
     C**   and 'ALL' branches are selected or entity is blank             S01498
     C*                                                                   S01498
     C           WWSWIT    IFEQ '0'
     C*                                                                   S01498
     C           ICNO      OREQ '*ALL'
     C           @RENT     ANDEQ'ALL'                                     S01498
     C*                                                                   S01498
     C           ICNO      OREQ '*ALL'                                    S01498
     C           @RENT     ANDEQ*BLANKS                                   S01498
     C*                                                                   S01498
     C           RRNOR1    COMP RRCT1                2929
     C                     ELSE
     C                     MOVE '0'       *IN29
     C                     END
     C*
     C**   Set indicator for DIFFERENCE only if EOD
     C**   or *ALL selected
     C           *IN29     IFEQ '1'
     C                     MOVE '1'       *INU8
     C                     END
     C*
     C**   Write the run controls report
     C                     Z-ADD0         PAGE
     C                     Z-ADD0         LINE1
     C                     WRITEPAGEHD
     C                     WRITERUNCTL
     C*                                                                   S01498
     C**  If no details printed, write "No details to report"             S01498
     C*                                                                   S01498
     C           *IN53     IFEQ '0'                                       S01498
     C                     WRITENODTLS                                    S01498
     C                     END                                            S01498
     C*
     C**   Reset Page and Line numbers and record counters
     C                     Z-ADD0         PAGE
     C                     Z-ADD0         LINE
     C                     Z-ADD0         RRCT1
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DBAS1   - First database error subroutine                    *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY- #A                                                 *
     C*                                                               *
     C*****************************************************************
     C           #DBAS1    BEGSR                           ***************
     C           *LOCK     IN   LDA                                       S01498
     C                     Z-ADD1         DBASE            *             *
     C                     MOVE *BLANKS   DBKEY            * DBERROR 001 *
     C                     MOVE 'SDBANKPD'DBFILE           *             *
     C                     OUT  LDA                                       S01498
     C                     ENDSR                           ***************
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DBAS2   - Second database error subroutine                   *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY- #ZC                                                *
     C*                                                               *
     C*****************************************************************
     C           #DBAS2    BEGSR                           ***************
     C           *LOCK     IN   LDA                                       S01498
     C                     Z-ADD2         DBASE            *             *
     C                     MOVELAZACOC    DBKEY            * DBERROR 002 *
     C***********          MOVE 'SDACOFL0'DBFILE           *             *S01498
     C                     MOVE 'SDACOFPD'DBFILE           *             *S01498
     C                     OUT  LDA                                       S01498
     C                     ENDSR                           ***************
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DBAS3   - Third database error subroutine                    *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY- #DC                                                *
     C*                                                               *
     C*****************************************************************
     C           #DBAS3    BEGSR                           ***************
     C           *LOCK     IN   LDA                                       S01498
     C                     Z-ADD3         DBASE            *             *
     C                     MOVELICNO      DBKEY            * DBERROR 003 *
     C***********          MOVE 'SDLBCSL0'DBFILE           *             *S01498
     C                     MOVE 'LBLBCSJ0'DBFILE           *             *S01498
     C                     OUT  LDA                                       S01498
     C                     ENDSR                           ***************
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DBAS4   - Forth database error subroutine                    *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY- #ZD                                                *
     C*                                                               *
     C*****************************************************************
     C           #DBAS4    BEGSR                           ***************
     C           *LOCK     IN   LDA                                       S01498
     C                     Z-ADD4         DBASE            *             *
     C*                                                    * DBERROR 004 *
     C***********          MOVE 'SDCURRL1'DBFILE           *             *S01498
     C                     MOVE 'SDCURRPD'DBFILE           *             *S01498
     C                     OUT  LDA                                       S01498
     C                     ENDSR                           ***************
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DBAS5   - Fifth database error subroutine                    *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY- #C                                                 *
     C*                                                               *
     C*****************************************************************
     C           #DBAS5    BEGSR                           ***************
     C           *LOCK     IN   LDA                                       S01498
     C                     Z-ADD5         DBASE            *             *
     C                     MOVELWWFILE    DBKEY            * DBERROR 005 *
     C                     MOVE 'LBTRAIPD'DBFILE           *             *
     C                     OUT  LDA                                       S01498
     C                     ENDSR                           ***************
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DBAS6   - Sixth database error subroutine                    *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY- #C                                                 *
     C*                                                               *
     C*****************************************************************
     C           #DBAS6    BEGSR                           ***************
     C           *LOCK     IN   LDA                                       S01498
     C                     Z-ADD6         DBASE            *             *
     C                     MOVELWWFILE    DBKEY            * DBERROR 006 *
     C                     MOVE 'LBTRAIPD'DBFILE           *             *
     C                     OUT  LDA                                       S01498
     C                     ENDSR                           ***************
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #DBASZ   - File controls after a database error               *
     C*                                                               *
     C* CALLS    -                                                    *
     C*                                                               *
     C* CALLED BY- #A #DC #ZD #ZC                                     *
     C*                                                               *
     C*****************************************************************
     C           #DBASZ    BEGSR
     C                     WRITEPAGEHD
     C                     WRITEDBASERR
     C*                                                                   S01498
     C**  If printer file LB0350P1 is open, report the database error     S01498
     C*                                                                   S01498
     C           WLOPN     IFEQ 'Y'                                       S01498
     C                     WRITEDBERROR                                   S01498
     C                     END                                            S01498
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     EXSR *PSSR                                     S01498
     C                     RETRN
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C* *PSSR    - Program error handling routine.
     C*
     C* CALLS             -
     C*
     C* CALLED BY         -
     C*
     C* FLDS USED         -
     C*
     C*****************************************************************
     C           *PSSR     BEGSR
     C*
     C                     DUMP
     C*
     C           #PSSR0    ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
**   CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
