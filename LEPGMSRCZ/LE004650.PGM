      *****************************************************************
/*STD *  PGMBASE                                                      *
/*EXI *  MODULE(LE004650) ACTGRP(*CALLER)                             *                      CAS011
/*EXI *  TEXT('Midas LE Fee and Discount Amortisation A/C Key Gen')   *
/*E*I** *MODULE(LE004650)**********************************************                       CAS011
/*E*I** *BNDSRVPGM(*NONE)*BNDDIR(MIDAS)*ACTGRP(*CALLER)****************                       CAS011
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *  LE004650 - Midas LE Fee and Discount Amortisation A/C Key    *
      *             Generation (Non-Linear)                           *
      *                                                               *
      *  (c) Finastra International Limited 2004                      *
      *                                                               *
      *  Last Amend No. CLE071             Date 18Jul18               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 AR1056323          Date 14Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR821740           Date 29Aug11               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CLE139             Date 06Dec10               *
      *                 243984             Date 28Oct08               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG13408A          Date 12Mar07               *
      *                 BUG13382           Date 28Feb07               *
      *                 BUG13408           Date 28Feb07               *
      *                 BUG13407           Date 28Feb07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 27Sep06               *
      *                 CSD027             Date 09Dec05               *
      *                 239022             Date 19Jul06               *
      *                 BUG10875A (Reopen) Date 12May06               *
      *                 BUG10876           Date 04May06               *
      *                 BUG10875           Date 16Mar06               *
      *                 CLE042             Date 06Sep05               *
      *                 Bug9667            Date 02Jan06               *
      *                 BUG9472            Date 06Dec05               *
      *                 BUG9428            Date 05Dec05               *
      *                 BUG9243            Date 15Nov05               *
      *                 CAS011             Date 16May05               *
      *                 233545             Date 18May05               *
      *                 232928             Date 08Apr05               *
      *                 233612             Date 20May05               *
      *                 233578             Date 19May05               *
      *                 232771             Date 21Mar05               *
      *                 232630             Date 14Mar05               *
      *                 232628             Date 14Mar05               *
      *                 232348             Date 21Feb05               *
      *                 232309             Date 21Feb05               *
      *                 232307             Date 21Feb05               *
      *                 232306             Date 09Feb05               *
      *                 232305             Date 08Feb05               *
      *                 232304             Date 07Feb05               *
      *                 231712             Date 08Feb05               *
      *                 231710             Date 25Jan05               *
      *                 231708             Date 07Jan05               *
      *                 CAS009  *CREATE    Date 04May04               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  AR1056323 - Revert back changes of CLE134 for LKEY1DP and    *
      *              LKEYFED (Recompile)                              *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  AR821740 - COB - No stamp tax account keys generated         *
      *             (Recompile)                                       *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate (Recompile)                                    *
      *  CLE139 - Lending Fee Capitalisation (Recompile)              *
      *  243984 - Considered the RAFeesCnt in writing to DB.          *
      *           (Recompile)                                         *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  BUG13408A - Reopen BUG13408. SrFeeReprt subr should not be   *
      *              executed for History record(LEFHST). (Recompile) *
      *  BUG13382 - Incorrect distribution of discount & fee          *
      *             on LE004650P1 & LE004650P2 (Recompile)            *
      *  BUG13408 - Recompile.                                        *
      *  BUG13407 - Unrealized P/L on revaluation of loans            *
      *             not reversed on the following day (Recompile)     *
      *  242286 - Recompile.                                          *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  239022 - Correction on Hash Totaling.                        *
      *  BUG10875A (Reopen) - Receiver value too small to hold result *
      *                       (Recompile)                             *
      *  BUG10876 - Applied part of SC238567 (Recompile)              *
      *  BUG10875 - Receiver value too small to hold result           *
      *             (Recompile)                                       *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  Bug9667 - Incorrect report details.                          *
      *  BUG9472 - Should exclude non-auto settle fees as events for  *
      *            these fees are not projected.                      *
      *  BUG9428 - Program dumps, "Record 7 member LEFEEDLH already   *
      *            locked to this job".                               *
      *  BUG9243 - LE004650 dumps when no loans are processed         *
      *            (Applied fix 235242) Recompile                     *
      *  CAS011 - EIR/AC Accounting Upgrade to MP1                    *
      *  233545 - Cut-off Date                                        *
      *  232928 - Amortise all fees non-linearly, EIR calculation,    *
      *           Non-linear amortisation calculation & adjustment    *
      *  233612 - Stop Accruals processing to be included in          *
      *           Nonlinear amortisation processing                   *
      *  233578 - Process loans maturing today and ensure correct     *
      *           postings                                            *
      *  232771 - Include fees on maturity on the last period         *
      *  232630 - Incorrect non-linear amortization.                  *
      *  232628 - CAS009 Rollover patch (LE).                         *
      *  232348 - Introduce cut-off date for non-linear amortisation  *
      *  232309 - Settlement on LKEYFED is incorrect when fee is a    *
      *           participant fee.                                    *
      *  232307 - Settlement details of the loan are overridden by    *
      *           fee settlement details.                             *
      *  232306 - Wrong value is stored in DSAM, EIAMTD and AFDP      *
      *  232305 - Account keys are not produced for one off fees and  *
      *           discount loan.                                      *
      *  232304 - Make the negative value to positive before adding   *
      *           it to the hash totals.                              *
      *  231712 - Amortisation Processing removed from LE004650.      *
      *           ZAAMRTCALC created to do Amortisation computation   *
      *  231710 - Amended to amortise non-linearly accruing and one   *
      *           off fees. Also amortisation will begin at the start *
      *           of the EIR period.                                  *
      *  231708 - Fixed incorrect notation of discounts and premiums  *
      *           in account keys. Due to non-linear computations,    *
      *           discounts and premiums postings can either be       *
      *           positive or negative.                               *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *                                                               *
      *****************************************************************
