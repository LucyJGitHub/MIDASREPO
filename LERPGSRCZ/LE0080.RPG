     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Guarantees maintenance')                      *
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module
      *                                                               *
      *  LE0080    - GUARANTEES DETAIL INPUT                          *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. LUC139             Date 07Jan21               *
      *  Prev Amend No. BUG14745(CER009)   Date 16Nov20               *
      *                 CER009             Date 16Nov20               *
      *                 CLE172             Date 01Oct20               *
      *                 CSD103             Date 10Aug20               *
      *                 MD055733           Date 03Jul20               *
      *                 MD050139           Date 23Mar18               *
      *                 CLE071             Date 18Jul18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD031285           Date 14Jun16               *
      *                 CGL184             Date 07Dec16               *
      *                 CLE141             Date 08Feb16               *
      *               . CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CLE064             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CLE056             Date 17Jul06               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 240764             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 27Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 199662             Date 20Dec01               *
      *                 199610             Date 20Dec01               *
      *                 197084             Date 11Sep01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 187260             Date 21Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 189116             Date 25Feb01               *
      *                 184288             Date 09Feb01               *
      *                 CLE011             Date 07Nov00               *
      *                 182814             Date 05Dec00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 168815             Date 09Feb00               *
      *                 156732             Date 11Oct99               *
     F*                 165426             Date 08Oct99               *
     F*                 148902             Date 08Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 158893 (BT0681)    Date 14Apr98               *
      *                 158892 (E44851)    Date 30Dec97               *
      *                 158891 (BT0477)    Date 19Nov97               *
      *                 158890 (E43259)    Date 06Jan95               *
      *                 158889 (E46984)    Date 31Mar94               *
     F*                 155821             Date 15Mar99               *
     F*                 155610             Date 26Feb99               *
      *                 154799             Date 24Feb99               *
      *                 151295             Date 18Feb99               *
     F*                 123785             DATE 26FEB98               *
     F*                 CLE005             Date 22May97               *
      *                 126274             Date 24Nov97               *
     F*                 123857             Date 28Oct97               *
     F*                 120056             Date 16Jul97               *
     F*                 120022             Date 04Jul97               *
     F*                 CLE004             Date 02Dec96               *
     F*                 S01408             DATE 13MAY96               *
     F*                 S01408             DATE 25MAY95               *
     F*                 046303             DATE 16JAN94               *
     F*                 S01392             DATE 30SEP92               *
     F*                 S01220             DATE 15MAR91               *
     F*                 BHF507             DATE 06SEP90               *
     F*                 BHF414             DATE 28AUG90               *
     F*                 BHF335             DATE 06AUG90               *
     F*                 S01270             DATE 10JUL90               *
     F*                 E22220             DATE 05JUN90               *
     F*                 LN0057             DATE 30APR90               *
     F*                 S01252             DATE 03FEB90               *
     F*                 S01251             DATE 03FEB90               *
     F*                 S01194             DATE 12JAN90               *
     F*                 S01241             DATE 08JAN90               *
     F*                 S01199             DATE 12/12/89              *
     F*                 S01195             DATE 25/10/89              *
     F*                 S01117             DATE 25/10/89              *
     F*                 E14820             DATE 01/11/88              *
     F*                 E10963             DATE 24/07/87              *
0011 F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  LUC139 - UCI Italian Returns Upgrade to FM2.1                *
      *  BUG14745 - Inconsistency in displaying record dtls (CER009)  *
      *  CER009 - PUMA II Upgrade to MP                               *
      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  MD050139 - AOSARDR0 called every time causing performance    *
      *             issue. Recompile due to changes in /COPY          *
      *             ZFREQ/ZFRQ*.                                      *
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD031285 - LE Guarantee was not expired on end date.         *
      *             Expired records should be shown in the screen as  *
      *             long as the facilities/loans are still active.    *
      *             Pattern fix 245406.                               *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CLE064 - Enhancement of Lending Frequencies                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CLE056 - Authorisation on Lending Transactions               *
      *  240764 - Allow user to set End Date to Run Date if the       *
      *           guarantee was entered on an earlier date.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes (recompile)                       *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  199662 - Review date already equal to rundate not allowed if *
     F*           guarantee was selected from subfile. Set on *IN03 in*
     F*           SRSUBF if action = A. If user has not amended RVDT, *
     F*           don't compare with rundate, but do other validation.*
     F*  199610 - Blank review date is overwritten on file with value *
     F*           from previous record if selected from subfile.      *
      *  197084 - Changed the condition for field BPAURV by comparing *
      *           it to 'Y' instead of 'N'                            *
     F*  187260 - Allow processing type 70 when assigning collateral. *
     F*  189116 - If F3 or F12 pressed in window do not accept input. *
     F*  184288 - Addition to 182814. Reset *IN19 in subroutines INIT *
     F*           and SRENQ to avoid error due to incorrect input.    *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *  182814 - Reset indicators 18 (expired guarantee read) and    *
      *           19 (deleted guarantee read) after CHAIN to GTEES    *
      *           file to avoid error during insert.                  *
     F*  168815 - Upon insertion of a new guarantee the sequence no.  *
     F*           should be allocated automatically. The user cannot  *
     F*           enter a sequence number with an action code 'I'.    *
     F*  156732 - Outputs collaterals and securities to GTREFGR.      *
     F*  165426 - When inserting a guarantee increment the trailer    *
     F*           GTEESZZ. However, when deleting do not decrement    *
     F*           the number of records, since the record is kept on  *
     F*           file but with a RECI of '*' instead.                *
     F*  148902 - Guarantees cannot be inserted due to indicator      *
     F*           *IN18 not initialised to '0'                        *
      *  BT0681 - Expired guarantees should be included in subfile    *
     F*  158892 - Recurring Problem with the file controls.           *
     F*  158891 - File control problems attached to new action code
     F*           X (authorize)
     F*  158890 - SHOULD BE ABLE TO DELETE AN EXPIRED GUARANTEE
     F*            21MAR96 - DELETION SHOULDN'T IMPACT FILE CONTROLS.
     F*  158889 - SHOULD BE ABLE TO EXTEND A GUARANTEE IF IT IS          *S01392
     F*                EXPIRED.                                          *S01220
     F*  155821 - Prohibit re-entry of guarantee with same key as one *
     F*           deleted today                                       *
     F*  155610 - Authorisation processing incorrect if CLE002 is     *
     F*           off as manual ICD flags are still on.               *
      *  154799 - Recompiled due to changes in /COPY,ZACCH            *
      *  151295 - Problems authorising repayment schedules            *
      *           Recompiled due to changes in ZCHKH                  *
     F*  123785 - Skip Loan/Facility validation if action code error. *
      *  CLE005 - Customer Lending Enhancements - Tranche 3           *
      *  126274 - The subfile review screen should show the customer  *
      *           short name.                                         *
     F*  123857 - Authorisation to allow F11 or not depending on ICD  *
     F*  120056 - Allow guarantees to be inserted from the subfile    *
     F*           screen. Also program crashes during enquiry mode on *
     F*           GTEES file.                                         *
     F*  120022 - Guarantees can be entered with a zero sequence no.  *
     F*  CLE004 - Customer Lending Enhancements - Tranches 1 & 2      *
     F*           Include Authorisations - CLE002.                    *
     F*  S01408 - Addition of core hook LE0080IIP1                    *
     F*           Addition of core hook LE0080EEP1                    *
     F*           Addition of core hook LE0080FFP4                    *
     F*           Addition of core hook LE0080FFP3                    *
     F*           Addition of core hook LE0080FFP2                    *
     F*           Addition of core hook LE0080FFP1                    *
     F*           Addition of core hook LE0080CP17                    *
     F*           Addition of core hook LE0080CP16                    *
     F*           Addition of core hook LE0080CP15                    *
     F*           Addition of core hook LE0080CP14                    *
     F*           Addition of core hook LE0080CP13                    *
     F*           Addition of core hook LE0080CP12                    *
     F*           Addition of core hook LE0080CP11                    *
     F*           Addition of core hook LE0080CP10                    *
     F*           Addition of core hook LE0080CCP9                    *
     F*           Addition of core hook LE0080CCP8                    *
     F*           Addition of core hook LE0080CCP7                    *
     F*           Addition of core hook LE0080CCP6                    *
     F*           Addition of core hook LE0080CCP5                    *
     F*           Addition of core hook LE0080CCP4                    *
     F*  S01408 - Addition of core hook LE0080EEPG                    *
     F*           Addition of core hook LE0080CCPG                    *
     F*           Addition of core hook LE0080CCP1                    *
     F*           Addition of core hook LE0080CCP2                    *
     F*           Addition of core hook LE0080CCP3                    *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *
     F*  S01220 - AMENDED FOR STRATEGIC RISK MANAGEMENT               *
     F*           RELEASE 10 TO ALLOW THE INPUT OF A BOOK             *
     F*           CODE AGAINST A LOAN.                                *
     F*  BHF507 - SHORTNAME CONVERSION TO CUSTOMER NUMBER NOT CORRECT *
     F*  BHF414 - REMOVE UNNECESSARY BIT FROM COMPILE TIME ARRAY      *
     F*  BHF335 - CUSTOMER FIELD NUMERIC VALIDATION NOT REQUIED       *
     F*  S01270 - CUSTOMER LENDING CHANGES                            *
     F*  E22220 - ADDITIONAL CHANGE REQUIRED TO ALL NON-SYNON         *
     F*           MAINTENANCE FUNCTIONS PREVIOUSLY CHANGED FOR        *
     F*           TRANSACTION WINDOWS.                                *
     F*           ALSO, SETLL WAS INTRODUCED FOR READ OF SDMMODPD.    *
     F*  LN0057 - CUSTOMER NAME BLANKED BEFORE NUMBER INSERTED        *
     F*  S01252 - ADDITIONAL SPARE WINDOW MANAGER PARAMETER           *
     F*  S01251 - SYNON FIELD/PROGRAM NAME CHANGES                    *
     F*  S01194 - STANDING DATA CHANGES                               *
     F*  S01241 - WINDOW INCORPORATION                                *
     F*  S01199 - ABS HELP CHANGES                                    *
     F*  S01195 - HOLIDAY PROCESSING.                                 *
     F*  S01117 - MULTIBRANCHING.                                     *
     F*  E14820 - LOOPS IF ENTER INVALID CUSTOMER SHORTNAME IN        *
     F*           'CUSTOMER' OR 'GIVEN BY' (GIVER) FIELDS             *
     F*  E10963 - WHEN DATABASE ERROR 01 OCCURS VALIDATION IS         *
     F*           STILL CARRIED OUT WHEN IT SHOULD BE SKIPPED.        *
     F*                                                               *
0012 F*****************************************************************
      *                                                                   S01408
     F/COPY WNCPYSRC,LE0080FFP4                                           S01408
      *                                                                   S01408
0015 F***LE0080FMCF  F     325            WORKSTN      KPASS  *NOIND      CLE004
     FLE0080DFCF  E                    WORKSTN                            CLE004
     F                                        SRRN  KSFILE LE0080S0       CLE004
      *                                                                   S01408
     F/COPY WNCPYSRC,LE0080FFP1                                           S01408
      *                                                                   S01408
0017 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
0019 F*SNAME***IF**F     256 10AI    39 DISK                              S01194
0020 F*ABLE   IF  F      96 12AI     2 DISK                               S01194
0024 F*CLOAN***IF**F*****400  7AI     2 DISK                              S01220
     F*CLOAN***IF**F     436  7AI     2 DISK                       S01220 CLE011
     F***CLOAN** IF  F    1310  7AI     2 DISK                                         CLE011 CGL029
     F*CLOAN***IF**F****1461  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** IF  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   IF  F    1874  7AI     2 DISK                                                   CLE134
0025 FFCLTY   IF  F     256 12AI     2 DISK
     F/COPY WNCPYSRC,LE0080F001
     FSDMMODPDIF  E                    DISK                               S01241
0022 F***GTEES   UF  F     128 15AI     2 DISK                            CLE004
0022 FGTEES   UF  F     159 15AI     2 DISK                               CLE004
0021 F                                              KCOMIT
0023 FGTREF   UF  F      32 21AI     2 DISK
0021 F                                              KCOMIT
     FLEGTEEL0IF  E           K        DISK                               CLE004
     F            GTEESGTF                          KRENAMELEGTEED0       CLE004
      *                                                                   CLE004
     FLEGTEEL1IF  E           K        DISK                               CLE004
     F            GTEESGTF                          KRENAMELEGTEED1       CLE004
      *                                                                   S01408
     F/COPY WNCPYSRC,LE0080FFP2                                           S01408
      *                                                                   S01408
0022 F***GTEESGT O   F     128            DISK                            CLE004
0022 FGTEESGT O   F     159            DISK                               CLE004
0021 F                                              KCOMIT
0021 F                                              KINFDS INFDS1
0021 F                                              KINFSR INFSR
0023 FGTREFGR O   F      32            DISK
0021 F                                              KCOMIT
0021 F                                              KINFDS INFDS2
0021 F                                              KINFSR INFSR
0011 F*                                                                  *
0026 F* ID F  C  H  L    FUNCTION OF INDICATORS
0027 F* 01            WORKSTATION FILE - INITIAL SCREEN
0028 F* 02                             - INSERT SCREEN
0029 F* 03                             - AMEND SCREEN
0030 F* 04                             - DELETE SCREEN
0031 F* 05                             - BLANK INPUT FIRST CYCLE
0031 F* 06            SFLCLR                                              CLE004
0031 F* 07            SFLDSPCTL                                           CLE004
0031 F* 08            SFLEND                                              CLE004
0031 F* 09            ROLLUP in subfile pressed                           CLE004
      *                                                                   S01408
     F/COPY WNCPYSRC,LE0080FFP3                                           S01408
      *                                                                   S01408
0036 F* 10            DETAIL RECORD - *CLINT*,CLOAN,*SNAME*,FCLTY,*TABLE* S01194
0037 F*    11         REVIEW DAY NO. ZERO
0013 F*       12      USED TO CONDITION FIRST CYCLE
0014 F*       13      SET ON IF ERROR DURING READ FROM THE WORKSTN  /   *
     F*******         HELP INDICATOR                                      S01199
0031 F* 14            Authorisation required                              CLE004
0038 F* 15            GTREF DETAIL
0039 F* 16            GTEES FILE -LIVE DETAIL
0040 F* 17                       -TRAILER
0041 F* 18                       -EXPIRED
0042 F* 19                       -CATCHALL
0031 F* 20            SFLNXTCHG                                           CLE004
0031 F* 21            Invalid action in subfile                           CLE004
0043 F*    22         BLANK INPUT -LOAN REF
0044 F*    23         LAST CHARACTER OF NUMERIC GIVER BLANK
0045 F*    24         LAST CHARACTER OF NUMERIC CUSTOMER BLANK
0046 F*    25         BLANK INPUT -FACILITY
     F**26            STORE *IN18 FOR TOTALLING                           158889
     F*    26         F11 not allowed for authorisation                   123857
     F* 27            STORE *IN18 FOR TOTALLING                    158889 123857
0047 F*    28         BLANK INPUT -REVIEW DATE
0048 F*    29         BLANK INPUT -REVIEW FREQUENCY
0049 F*    30         BLANK INPUT -TYPE-DEFAULT TO G
0050 F*       31      TYPE S OR C
0051 F*    32         BLANK INPUT -DAY NO.
0052 F*    33         ZERO REVIEW DATE ON GTEES FILE
0053 F*       35      REVERSE FIELD -DAYNO
0054 F*       36      PREVENT OUTPUT OT WORKSTATION
0055 F*       37      OUTPUT SF SCREEN
0056 F*       40      NON-DISPLAY SECOND SCREEN
0057 F*       41      NON-DISPLAY INITIAL SCREEN
0058 F*       42      NON-DISPLAY ERROR CODES
0059 F*       43      NON-DISPLAY ERROR MESSAGE
0060 F*       44      MULTIPLE USE
0061 F*       45      REVERSE FIELD -LOAN
0062 F*       46      REVERSE FIELD/BLANK INPUT -SEQUENCE
0063 F*       47      MULTIPLE USE
0064 F*       48      REVERSE FIELD/BLANK INPUT -CUSTOMER
0065 F*       49      REVERSE FIELD -FACILITY
0066 F*       50      REVERSE FIELD/BLANK INPUT -NO. OF ITEMS
0031 F*       51      EOF read on LEGTEEL0/LEGTEEL1 on subfile            CLE004
0067 F*       52      REVERSE FIELD -ACTION
0068 F*       53      REVERSE FIELD/BLANK INPUT -START DATE
0069 F*       54                                -END DATE
0070 F*       55      REVERSE FIELD -REVIEW DATE
0071 F*       56      REVERSE FIELD -REVIEW FREQ
0072 F*       57      REVERSE FIELD/BLANK INPUT -CURRENCY
0073 F*       58      REVERSE FIELD/BLANK INPUT -UNIT AMOUNT
0074 F*       59      REVERSE FIELD/BLANK INPUT -GIVER
0075 F*       60      REVERSE FIELD -TYPE
0076 F*       61      ACTION I
0077 F*       62             A
0078 F*       63             D
0079 F*       64             E
0080 F*       65      PASS FIELDS FROM GTEES TO WORKSTATION
0081 F*       66      PROTECT FOR ENQUIRE
0082 F*       67      PROTECT FOR AMEND/ENQUIRE
0083 F*       68      POSITION CURSOR FOR DELETE SCREEN
0084 F*       69      RELEASE GTEES FILE
 086 F*       71      UPDATE TRANSACTION
0087 F*       72      UPDATE TRAILER
0089 F*       74      CDP 0
0090 F*       75          1
0091 F*       76          2
0092 F*       77          3
0093 F*       78      FILE CHANGE TYPE DELETE
0094 F*       79      BLANK INPUT -LAST 4 OF CUSTOMER
0095 F*       80      BLANK INPUT -LAST 4 OF GIVER
     F*       81      IGNORE ORIGIATING BRANCH CHECKING WHEN ACTION = D   S01117
     F*               AND RELATED LOAN NOT FOUND.                         S01117
0031 F*       82      Invalid customer on review                          CLE004
0031 F*       83      Invalid facility/loan on review                     CLE004
0031 F*       84      Invalid sequence on review                          CLE004
0031 F*       85      Invalid authorise only on review                    CLE004
0031 F*       89      Work indicator                                      CLE004
0096 F*       90-99   STANDARD SR.'S
0097 F*       KJ,KL,KCSTANDARD MIDAS USAGE
 098 F*       U8      STANDARD MIDAS USAGE
0099 E                    ERCD       19  4               ERROR CODES
0100 E*******             ERMSG   1   9 55               ERROR MESSAGES   S01117
0100 E**********          ERMSG   1  14 70               ERROR MESSS01117 CLE004
0100 E****                ERMSG   1  22 75               ERROR MES CLE004 155821
0100 E***********         ERMSG   1  23 75               ERROR MES 155821 168815
0100 E**********          ERMSG   1  26 75               ERROR MESSAGES              168815 MD031285
0100 E                    ERMSG   1  27 75               ERROR MESSAGES                     MD031285
     E****                STAT    1   4 16                         CLE004 158893
     E                    STAT    1   5 16                                158893
      *                                                                   S01408
     E/COPY WNCPYSRC,LE0080EEP1                                           S01408
      *                                                                   S01408
0101 E**
0102 E**********          TABFRQ  4   4  1               FREQUENCY CODES                      CLE064
      *                                                                                       CLE064
      ** Frequency Codes                                                                      CLE064
      *                                                                                       CLE064
     E                    TABFRQ 20  20  1                                                    CLE064
0103 E**
     E/COPY ZSRSRC,ZALIGNZ1                                               S01392
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E/COPY ZSRSRC,ZFREQBZ1                                               S01392
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E*                                                                   S01408
     E/COPY WNCPYSRC,LE0080EEPG                                           S01408
     E*                                                                   S01408
     E                    CPY@    1   1 80
0112 I**
0113 I**   WORKSTATION FILE
0114 I**
0115 I*E0080FMNS  01   2 CS   3 CF                                        S01199
0116 I*******OR   02   2 CS   3 CI                                        S01199
0117 I*******OR   03   2 CS   3 CA                                        S01199
0118 I*******OR   04   2 CS   3 CD                                        S01199
     I*******                                 1   1 *IN13                 S01199
0119 I*******                                 2   3 SCID                  S01199
0120 I*******                                 4   90STRD                  S01199
0121 I*******                                 4   9 STRDA           53    S01199
0122 I*******                                10  150ENDAT                 S01199
0123 I*******                                10  15 ENDATA          54    S01199
0124 I*******                                16  210RVTD                  S01199
0125 I*******                                16  21 RVDTA           28    S01199
0126 I*******                                22  22 RVFQ            29    S01199
0127 I*******                                23  24 DAYA            32    S01199
0128 I*******                                25  27 GCCY            57    S01199
0129 I*******                                28  41 UNAMT           58    S01199
0130 I*******                                42  46 NITMA           50    S01199
0131 I*******                                47  49 COLL                  S01199
0132 I*******                                50  84 NARRS                 S01199
0133 I*******                                85  94 GIVEA           59    S01199
0134 I*******                                90  90 GIVEZ           23    S01199
0135 I*******                                91  94 GIVEL           80    S01199
0136 I*******                                95  95 TYPE            30    S01199
0137 I*******                                96 105 GCUSA           48    S01199
0138 I*******                               101 101 GCUSZ           24    S01199
0139 I*******                               102 105 GCUSL           79    S01199
0140 I*******                               106 110 FACILA          25    S01199
0141 I*******                               111 116 LOANA           22    S01199
0142 I*******                               117 119 SEQRA           46    S01199
0143 I*******                               120 120 ACTN                  S01199
0144 I*******                                 4  95 SCN1                  S01199
0145 I*******                                96 120 SCN2                  S01199
0115 I***LE0080FMNS  01   1 CS   2 CF                              S01199 CLE004
0116 I***       OR   02   1 CS   2 CI                              S01199 CLE004
0117 I***       OR   03   1 CS   2 CA                              S01199 CLE004
 118 I***       OR   04   1 CS   2 CD                              S01199 CLE004
0119 I**********                              1   2 SCID           S01199 CLE004
0120 I**********                              3   80STRD           S01199 CLE004
0121 I**********                              3   8 STRDA    53    S01199 CLE004
0122 I**********                              9  140ENDAT          S01199 CLE004
0123 I**********                              9  14 ENDATA   54    S01199 CLE004
0124 I**********                             15  200RVTD           S01199 CLE004
0125 I**********                             15  20 RVDTA    28    S01199 CLE004
0126 I**********                             21  21 RVFQ     29    S01199 CLE004
0127 I**********                             22  23 DAYA     32    S01199 CLE004
0128 I**********                             24  26 GCCY     57    S01199 CLE004
0129 I**********                             27  40 UNAMT    58    S01199 CLE004
0130 I**********                             41  45 NITMA    50    S01199 CLE004
0131 I**********                             46  48 COLL           S01199 CLE004
0132 I**********                             49  83 NARRS          S01199 CLE004
0133 I**********                             84  93 GIVEA    59    S01199 CLE004
0134 I**********                             89  89 GIVEZ    23    S01199 CLE004
0135 I**********                             90  93 GIVEL    80    S01199 CLE004
0136 I**********                             94  94 TYPE     30    S01199 CLE004
0137 I**********                             95 104 GCUSA    48    S01199 CLE004
0138 I**********                            100 100 GCUSZ    24    S01199 CLE004
0139 I**********                            101 104 GCUSL    79    S01199 CLE004
0140 I**********                            105 109 FACILA   25    S01199 CLE004
0141 I**********                            110 115 LOANA    22    S01199 CLE004
0142 I**********                            116 118 SEQRA    46    S01199 CLE004
0143 I**********                            119 119 ACTN           S01199 CLE004
0144 I**********                              3  94 SCN1           S01199 CLE004
0145 I**********                             95 119 SCN2           S01199 CLE004
0146 I********NS  05                                                      CLE004
0148 I*
0149 I*    FACILITY FILE - DETAIL 1
0150 I*
0151 IFCLTY   NS  10   1 CD  13 CA
0152 I                                        1   1 RECI
0153 I**********                              2   70CNUMF                                     CSD027
0153 I                                        2   7 CNUMF                                     CSD027
0154 I                                        8  10 FACT
0155 I                                       11  12 FCNO
0156 I                                       13  13 RCTP
     I***********                            14  160BRCD                  S01117
     I                                       14  16 BRCA                  S01117
0158 I                                       17  17 FCTI
0159 I                                       18  20 FCCY
0160 I                                    P  21  270FAMT
0161 I                                    P  28  300OVPC
0162 I                                    P  31  330DTAP
0163 I                                    P  34  360DTEX
0164 I                                       37  37 RVCR
0165 I                                       38  38 SECI
0166 I                                       39  39 MCCY
0167 I                                       40  40 MCSI
0168 I                                       41  41 NACD
0169 I                                       42  43 CRSK
0170 I                                    P  44  460DLFS
0171 I                                    P  47  527NOMR
0172 I                                    P  53  550RVDTF
0173 I                                       56  56 RVFRF
0174 I                                       57  580RVDYF
0175 I                                       59  93 NAR1
0176 I                                       94 128 NAR2
0177 I                                      129 163 NAR3
0178 I                                      164 198 NAR4
0179 I                                    P 199 2050MTDH
0180 I                                    P 206 2120MTDL
0181 I                                    P 213 2190MTDA
0182 I                                    P 220 2270QTDA
0183 I                                    P 228 2350YTDA
0184 I                                      236 237 ACOF
     I                                      238 240 ORBR                  S01117
     I                                    P 242 2440RVCD                  S01270
0185 I                                    P 247 2490ORED
0186 I                                    P 250 2520LCD
0187 I                                      253 253 CHTP
0188 I                                    P 254 2560TNLU
0189 I        NS
0190 I**************                                                      S01194
0191 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0192 I**************                                                      S01194
0193 I*ABLE***NS****   2 C0   3 C1  12 C1                                 S01194
0194 I*******AND****  13 C0                                               S01194
0195 I**************                          1   1 RECI                  S01194
0196 I**************                         12  130RCDE                  S01194
0197 I**************                         14  66 TITL                  S01194
0198 I***********                            67  67 DATF                  S01194
0199 I***********                            68  700DFBR                  S01194
0200 I**************                         74  74 MODI1                 S01194
0201 I**************                         75  75 MODI2                 S01194
0202 I**************                         76  76 MODI3                 S01194
0203 I***********                         P  77  790RUND                  S01194
0204 I***********                            80  86 RUNA                  S01194
0205 I**************                         87  870SFLG                  S01194
0206 I**************                      P  90  920LCD                   S01194
0207 I**************                         93  93 CHTP                  S01194
0208 I**************                      P  94  960TNLU                  S01194
0210 I***********                                                         S01117
0211 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01117
0212 I***********                                                         S01117
0213 I*ABLE***NS*      1 CD   2 C0   3 C1                                 S01117
0214 I*******AND*     12 C1  13 C1                                        S01117
0215 I***********                             1   1 RECI                  S01117
0216 I***********                             2   30RECT                  S01117
0217 I***********                            12  130RCDE                  S01117
0218 I***********                            14  16 BCCY                  S01117
0219 I***********                            17  19 BCYL                  S01117
0220 I***********                            20  22 HOCY                  S01117
0221 I***********                            23  280HEAD                  S01117
0222 I***********                         P  29  310APDA                  S01117
0223 I***********                            35  35 APFQ                  S01117
0225 I***********                            39  40 CUZR                  S01117
0226 I***********                         P  41  430DNWD                  S01117
0227 I***********                            44  460BVLP                  S01117
0228 I***********                            47  49 LOCY                  S01117
0229 I***********                            50  510FDAY                  S01117
0230 I***********                            52  52 ACLD                  S01117
0231 I***********                            53  53 MBIN                  S01117
0232 I***********                            86  86 ISAV                  S01117
0234 I***********                         P  90  920LCD                   S01117
0235 I***********                            93  93 CHTP                  S01117
0236 I***********                         P  94  960TNLU                  S01117
0238 I***********                                                         S01117
0238 I**************                                                      S01194
0239 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0240 I**************                                                      S01194
0241 I*ABLE***NS**10   1 CD   2 C2   3 C0                                 S01194
0242 I*******AND****  13 C1                                               S01194
0243 I**************                          1   1 RECI                  S01194
0244 I**************                         13  130SREC                  S01194
0245 I**************                         14  27 CCNM                  S01194
0246 I**************                      P  28  348SPOT                  S01194
0247 I**************                         35  37 CCYS                  S01194
0248 I**************                         38  380CDP                   S01194
0249 I**************                         39  390TNOT                  S01194
0250 I**************                         40  40 DCCY                  S01194
0251 I**************                         41  44 SRC1                  S01194
0252 I**************                         45  48 SRC2                  S01194
0253 I**************                         49  520TACC                  S01194
0254 I**************                         53  560TEQV                  S01194
0255 I**************                         57  600SWQV                  S01194
0256 I**************                         61  640TAC4                  S01194
0257 I**************                         65  680TAC5                  S01194
0258 I**************                         69  69 HIND                  S01194
0259 I**************                      P  70  768PART                  S01194
0260 I**************                         77  780SSNO                  S01194
0261 I**************                      P  79  858ERLC                  S01194
0272 I***********                                                         S01195
0273 I*****TABLE*FILE - HOLIDAY RECORD.                                   S01195
0274 I********E-EXCLUDE, I-INCLUDE.                                       S01195
0275 I***********                                                         S01195
0276 I*ABLE***NS*             2 C2   3 C2                                 S01195
0277 I*******AND*     14 CE                                               S01195
0278 I*******OR**             2 C2   3 C2                                 S01195
0279 I*******AND*     14 CI                                               S01195
0280 I***********                             1   1 RECI                  S01195
0281 I***********                             2   30RECT                  S01195
0282 I***********                             8  120HOL                   S01195
0283 I***********                            13  130SREC                  S01195
0284 I***********                            14  14 INEX                  S01195
0285 I***********                            15  89 HCCY                  S01195
0286 I***********                         P  90  920LCD                   S01195
0287 I***********                            93  93 CHTP                  S01195
0288 I***********                         P  94  960TNLU                  S01195
0279 I**************                                                      S01194
0280 I********NS****                                                      S01194
0281 I**************                          1   1 RECI                  S01194
0283 I*
0284 I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 1
0285 I*
0286 ICLOAN   NS  10   1 CD   8 CA
0287 I                                        1   1 RECI
0288 I                                        2   7 LNRF
0289 I                                        8   8 RCDT
0290 I                                        9   90MRIN
0291 I                                       10  110PTYP
0292 I**********                             12  170CNUML                                     CSD027
0292 I                                       12  17 CNUML                                     CSD027
0293 I***********                            18  200BRCD                  S01117
     I                                       18  20 BRCA                  S01117
0294 I                                       21  22 LTYP
0295 I                                       23  24 SUTP
0296 I                                    P  25  270DDAT
0297 I                                    P  28  300VDAT
0298 I                                    P  31  330MDAT
0299 I                                       34  350LASQ
0300 I**********                             36  410FCUS                                      CSD027
0300 I                                       36  41 FCUS                                      CSD027
0301 I                                       42  440FTYP
0302 I                                       45  460FSEQ
0303 I                                       47  49 CCY
0304 I                                    P  50  560CPAM
0305 I                                       57  57 INTC
0306 I                                    P  58  637INTR
0307 I**********                             64  650BRTT                                      CSD103
0307 I                                       64  65 BRTT                                      CSD103
0308 I                                    P  66  717BRTE
0309 I                                    P  72  777RTSP
0310 I                                    P  78  815MARG
0311 I                                       82  82 SPIN
0312 I                                       83  83 CHIN
0313 I                                    P  84  897WTRT
0314 I                                       90  90 WTIN
0315 I                                       91  910REPT
0316 I                                    P  92  980RAMT
0317 I                                    P  99 1010NRPD
0318 I                                      102 102 RFRQ
0319 I                                      103 1040RDYN
0320 I                                      105 107 FCCY
0321 I                                      108 1100LIND
0322 I                                      111 112 CRSK
0323 I                                      113 114 ACOF
0324 I                                      115 115 NACD
0325 I                                      116 116 RELI
0326 I                                      117 117 AUTO
0327 I                                    P 118 1240PSAM
0328 I                                    P 125 1318BCXR
0329 I                                    P 132 1388FCXR
0330 I                                      139 1400SDST
0331 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 OSDAQQ                                    CGL029
0332 I                                      153 162 TSTN
0333 I                                      163 1640MDST
     I**********                            165 176 OMDA                                      CGL029
0334 I                                      165 176 OMDAQQ                                    CGL029
0335 I                                      177 186 TMAN
0336 I                                      187 196 FACO
0337 I                                    P 197 1990RLDT
0338 I                                    P 200 2020NROD
0339 I                                      203 203 RLFQ
0340 I                                      204 2050RLDY
0341 I**********                            207 2080NBRA                                      CSD103
0341 I                                      207 208 NBRA                                      CSD103
0342 I                                    P 209 2147NRTS
0343 I                                      215 215 NSIN
0344 I                                      216 2160NCAC
0345 I                                    P 217 2230AWTP
0346 I                                    P 224 2300WTRD
0347 I                                    P 231 2370WTWD
0348 I                                    P 238 2440IWOD
0349 I                                    P 245 2510PWOD
0350 I                                      252 252 BMDI
0351 I                                      253 253 FMDI
0352 I                                    P 254 2600PDIN
     I                                      271 273 ORBR                  S01117
0353 I                                      287 287 BTIN
0354 I                                      288 2890BLDY
0355 I**********                            290 2950OLNO                                      CSD027
0355 I                                      290 295 OLNO                                      CSD027
0356 I                                      296 296 RCSI
0357 I                                      297 2970ICBS
0358 I                                      298 298 IPFR
0359 I                                    P 299 3050TOTI
0360 I                                    P 306 3080NIDT
0361 I                                    P 309 3110IBDT
0362 I                                    P 312 3140SLID
0363 I                                    P 315 3210AIPD
0364 I                                    P 322 3240DLRC
0365 I                                    P 325 3270IACD
0366 I                                    P 328 3340AITC
0367 I                                    P 335 3410TFEP
0368 I                                    P 342 3480AIAP
0369 I                                    P 349 3550IPRD
0370 I                                    P 356 3620IPRM
0371 I                                    P 363 3690ICTD
0372 I                                    P 370 3760AIMN
0373 I                                    P 377 3790RBDT
     I                                    P 380 3810NOPS
0374 I                                      384 3850IFDY
0375 I                                      386 386 LONI
0376 I                                      387 387 CNFI
0377 I                                      388 388 ACEI
0378 I                                      389 389 TLXI
0379 I                                      390 390 CBLI
0380 I                                    P 391 3930ORED
0381 I                                    P 394 3960LCD
0382 I                                      397 397 CHTP
0383 I                                    P 398 4000TNLU
     I**  BOOK CODE ADDITION FOR EXPOSURE MANAGEMENT                      S01220
     I                                      435 436 BOKC                  S01220
     I*************************************13901407 OSDA                               CGL029 CLE042
     I*************************************14081425 OMDA                               CGL029 CLE042
     I                                     15611578 OSDA                                      CLE042
     I                                     15791596 OMDA                                      CLE042
     I                                     17801782 LOIC                                      CER020
0384 I        NS
0426 I*****CUSTOMER*SHORTNAMES FILE - DETAIL RECORD.                      S01194
0427 I**************                                                      S01194
0428 I*SNAME***NS**10   1 CD                                              S01194
0102 I**************                          1   1 RECI                  S01194
0103 I**************                          2   70CNUMS                 S01194
0104 I**************                         39  48 CSNM                  S01194
0105 I***********                            94  960BRCD                  S01194
0432 I**************                                                      S01194
0433 I****SNAME*FILE - CATCHALL                                           S01194
0434 I**************                                                      S01194
0435 I********NS****                                                      S01194
0436 I**************                                                      S01194
0437 I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0438 I**************                                                      S01194
0439 I*CLINT***NS**10   1 CD   8 CA                                       S01194
0440 I**************                          1   1 RECI                  S01194
0441 I**************                          2   70CNUM                  S01194
0442 I**************                          9  28 CRNM                  S01194
0443 I**************                         29  38 CTWN                  S01194
0444 I**************                         39  48 CSNM                  S01194
0445 I**************                         49  56 CASK                  S01194
0446 I**************                         57  68 TELX                  S01194
0447 I**************                         69  80 CSID                  S01194
0448 I**************                         81  82 ACOC                  S01194
0449 I**************                         83  83 CBSI                  S01194
0450 I**************                         84  85 CCTZ                  S01194
0451 I**************                         86  87 CLOC                  S01194
0452 I**************                         88  930CPAR                  S01194
0453 I***********                            94  960BRCD                  S01194
0454 I**************                         97  980LINS                  S01194
0455 I**************                         99 1010LIND                  S01194
0456 I**************                      P 102 1040DASU                  S01194
0457 I**************                      P 105 1070CDIC                  S01194
0458 I**************                      P 108 1100DADE                  S01194
0459 I**************                        111 111 CMIN                  S01194
0460 I**************                        112 112 CTYP                  S01194
0461 I**************                        113 124 TELF                  S01194
0462 I**************                        125 133 CHID                  S01194
0463 I****CLINT*FILE - CATCHALL                                           S01194
0464 I**************                                                      S01194
0465 I********NS****                                                      S01194
0466 I*    GUARANTEES/SECURITIES/COLLATERAL FILE
0467 I*
0468 IGTEES   NS  16   1 CD
0469 I       OR   18   1 CE
0470 I       OR   19   1 C*
0471 I                                        1   1 RECI
0472 I**********                              2   70CNUM                                      CSD027
0472 I                                        2   7 CNUM                                      CSD027
0473 I                                        8  13 FCLN
0474 I                                       14  160GUSN
0475 I                                    P  17  190STTD
0476 I                                    P  20  220EDDT
0477 I                                    P  23  250RVDT            33
0478 I                                       26  26 RVFR
0479 I                                       27  280RVDY            11
0480 I                                       29  31 CCY
0481 I                                    P  32  380UAMT
0482 I                                    P  39  410NOUN
0483 I                                    P  42  480TAMT
0484 I                                       49  83 NARR
0485 I                                       84  84 GSCI
0486 I                                       85  90 GBCN
0487 I                                       95  96 GCRK
0488 I                                       97  99 COLC
0488 I                                      109 111 BRCA                  S01117
0489 I                                    P 112 1180STAM
0490 I                                    P 119 1210ORED
0491 I                                    P 122 1240LCD
0492 I                                      125 125 CHTP
0493 I                                    P 126 1280TNLU
     I                                      129 129 GSTS                  CLE004
     I                                      130 139 IUSR                  CLE004
     I                                      140 149 AUSR                  CLE004
     I                                      150 159 XUSR                  CLE004
0494 I                                        2 128 REC1
0495 I*
0496 I*    GUARANTEES/SECURITIES/COLLATERAL FILE - TRAILER
0497 I*
0498 I        NS  17   1 CT
0499 I                                        1   1 RECI
0500 I**********                              2   70CNUM                                      CSD027
0500 I                                        2   7 CNUM                                      CSD027
0501 I                                        8  13 FCLN
0502 I                                       14  160GUSN
0503 I                                    P  17  190NORE
0504 I                                    P  20  220FLSZ
0505 I                                    P  23  250NLRB
0506 I                                    P  26  280NINS
0507 I                                    P  29  310NDEL
0508 I                                    P  32  340NLRA
0509 I                                    P  35  420VLBF
0510 I                                    P  43  440VLBL
0511 I                                    P  45  520VRIF
0512 I                                    P  53  540VRIL
0513 I                                    P  55  620VRDF
0514 I                                    P  63  640VRDL
0515 I                                    P  65  720VRAF
0516 I                                    P  73  740VRAL
0517 I                                    P  75  820VLAF
0518 I                                    P  83  840VLAL
0488 I                                      109 111 BRCA                  S01117
0519 I                                    P 122 1240LCD
0520 I                                      125 125 CHTP
0521 I                                    P 126 1280TNLU
0522 I        NS
0523 I*
0524 I*    GUARANTORS REFERENCE FILE - DETAIL
0525 I*
0526 IGTREF   NS  15   1 CD
0527 I                                        1   1 RECI
0528 I**********                              2   70GOCN                                      CSD027
0529 I**********                              8  130GUCN                                      CSD027
0528 I                                        2   7 GOCN                                      CSD027
0529 I                                        8  13 GUCN                                      CSD027
0530 I                                       14  19 FCLN
0531 I                                       20  220GUSN
0531 I                                       23  25 BRCA                  S01117
0532 I        NS
      *                                                                   CLE004
     ILEGTEED0                                                            CLE004
      ** Rename fields for subfile use                                    CLE004
     I              CNUM                            FCNUM                 CLE004
     I              FCLN                            FFCLN                 CLE004
     I              GUSN                            FGUSN                 CLE004
     I              GSTS                            FGSTS                 CLE004
     I              GBCN                            FGBCN                 CLE004
     I              BRCA                            FBRCA                 CLE004
     I              IUSR                            FIUSR                 CLE004
     I              AUSR                            FAUSR                 CLE004
      *                                                                   CLE004
     ILEGTEED1                                                            CLE004
      ** Rename fields for subfile use                                    CLE004
     I              CNUM                            FCNUM                 CLE004
     I              FCLN                            FFCLN                 CLE004
     I              GUSN                            FGUSN                 CLE004
     I              GSTS                            FGSTS                 CLE004
     I              GBCN                            FGBCN                 CLE004
     I              BRCA                            FBRCA                 CLE004
     I              IUSR                            FIUSR                 CLE004
     I              AUSR                            FAUSR                 CLE004
0537 I**
0538 I**   DATA STRUCTURES
0539 I**
0540 I**   KEY TO GTEES AND GTREF
0541 I            DS
0542 I                                        1  21 GRKEY
0543 I**********                              1   60GIVER                                     CSD027
0543 I                                        1   6 GIVER                                     CSD027
0544 I                                        7  21 GTKEY
0545 I**********                              7  120GCUS                  CLE004
0545 I**********                              7  120GCUSK                              CLE004 CSD027
0545 I                                        7  12 GCUSK                                     CSD027
0546 I                                       13  18 FCLNA
0547 I**********                             19  210SEQR                  CLE004
0547 I                                       19  210SEQRK                 CLE004
0548 I**   KEY TO CLOAN
0549 I            DS
0550 I                                        1   7 CLOKEY
0551 I*************                           1   6 LOANA                 CLE004
0551 I                                        1   6 LOANB                 CLE004
0552 I                                        7   7 RCDT
0553 I*****KEY*TO*CLINT                                                   S01194
0554 I************DS                                                      S01194
0555 I**************                          1   7 CLIKEY                S01194
0556 I**************                          1   60CNUMD                 S01194
0557 I**************                          7   7 A                     S01194
0558 I*****KEY*TO*TABLE                                                   S01194
0559 I************DS                                                      S01194
0560 I**************                          1  12 TBKEY                 S01194
0561 I**************                          1   20TBKY1                 S01194
0562 I**************                          9  11 TBKY2                 S01194
0563 I**************                         12  12 TBKY3                 S01194
0564 I**   KEY TO FCLTY
0565 I            DS
0566 I                                        1  12 FCKEY
0567 I**********                              1   60FCUS                                      CSD027
0567 I                                        1   6 FCUS                                      CSD027
0568 I**********                              7  11 FACILA                CLE004
0568 I                                        7  11 FACILB                CLE004
0569 I                                       12  12 RCTP
      **                                                                  S01195
     IDSCSNM      DS                             10                       S01195
      ** DATA AREA FOR THE LOCATION CODE IN CUSTOMER SHORTNAME FIELD      S01195
     I                                        8  10 NRLC                  S01195
      **                                                                  S01195
0570 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION
0571 ILDA        UDS                            256
0572 I***********                           134 138 DBFILE                S01117
0573 I***********                           139 167 DBKEY                 S01117
0574 I***********                           168 175 DBPGM                 S01117
0575 I***********                           176 177 DBASE                 S01117
0572 I                                      134 141 DBFILE                S01117
0573 I                                      142 170 DBKEY                 S01117
0574 I                                      171 180 DBPGM                 S01117
0575 I                                      181 1830DBASE                 S01117
0570 I**   STATUS DATA AREA FOR WORKSTN IDENTIFICATION
0571 IPSDS       SDS
0572 I**********                            244 246 WSID                  CLE004
0572 I                                      244 253 WSID                  CLE004
0572 I                                      245 246 WSID2
     I                                      254 263 USRID
     I/COPY ZSRSRC,ZTNLU1Z1                                               S01392
     I**
     I**  DATA STRUCTURE 1 FOR ERROR HANDLING SUBROUTINE
     I**
     IINFDS1      DS
     I                                     *STATUS  STATS1
0255 I**
     I**  DATA STRUCTURE 2 FOR ERROR HANDLING SUBROUTINE
     I**
     IINFDS2      DS
     I                                     *STATUS  STATS2
0255 I**
     I**  DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     ICMTTXT      DS
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTNO
     I                                       26  35 USRIDX
     I**********                             51 142 SCN1                  CLE004
     I                                       51 142 SCN1B                 CLE004
     I                                      143 167 SCN2S
      *                                                                   CLE004
     I            DS                                                      CLE004
0120 I                                        1   60STRD                  CLE004
0121 I                                        1   6 STRDA                 CLE004
0122 I                                        7  120ENDAT                 CLE004
0123 I                                        7  12 ENDATA                CLE004
0124 I                                       13  180RVTD                  CLE004
0125 I                                       13  18 RVDTA                 CLE004
0126 I                                       19  19 RVFQ                  CLE004
0127 I                                       20  21 DAYA                  CLE004
0128 I                                       22  24 GCCY                  CLE004
0129 I                                       25  38 UNAMT                 CLE004
0130 I                                       39  43 NITMA                 CLE004
0131 I                                       44  46 COLL                  CLE004
0132 I                                       47  81 NARRS                 CLE004
0133 I                                       82  91 GIVEA                 CLE004
0134 I                                       87  87 GIVEZ                 CLE004
0135 I                                       88  91 GIVEL                 CLE004
0136 I                                       92  92 TYPE                  CLE004
0144 I                                        1  92 SCN1                  CLE004
      *                                                                   CLE004
     I            DS                                                      CLE004
0137 I                                        1  10 GCUSA                 CLE004
0138 I                                        6   6 GCUSZ                 CLE004
0139 I                                        7  10 GCUSL                 CLE004
0140 I                                       11  15 FACILA                CLE004
0141 I                                       16  21 LOANA                 CLE004
0142 I                                       22  24 SEQRA                 CLE004
0143 I                                       25  25 ACTN                  CLE004
0145 I                                        1  25 SCN2                  CLE004
      *                                                                   CLE004
      **  DATA STRUCTURE TO PASS DATA TO RETURN PGM                       S01241
      **                                                                  S01241
      /COPY QWINDSRC,LE0080DTA                                            S01241
      *                                                                   S01241
     I*****************************************************************   S01117
     I*                                                                   S01117
     I**  EXTERNAL DATA AREA OF RUN DATE (RUNDAT)                         S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*                                                                   S01117
     I**  EXTERNAL DATA AREA OF MENU USER                                 S01117
     IZMUSER      DS                             17                       S01117
     I                                       11  13 USRBCH                S01117
      *                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR CURRENCY CODES                                  S01194
     I              A6CYCD                          CCY                   S01194
     I              A6NBDP                          CDP                   S01194
     I              A6DLCI                          DCCY                  S01194
      *                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCNCZ                          CCTZ                  S01194
     I*                                                                   S01117
     ISDNOST    E DSSDNOSTPD                                              S01195
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01195
     I              A7NOSN                          CSNM                  S01195
      *                                                                   S01408
     I/COPY WNCPYSRC,LE0080IIP1                                           S01408
      *                                                                   S01408
      **                                                                  S01117
     ISDBANK    E DSSDBANKPD                                              S01117
     I** BANK DETAILS                                                     S01117
     I              BJLCCY                          LOCY                  S01195
     I              BJSLCD                          SYSL                  S01194
     I              BJBVPD                          BVLP                  S01117
     I*                                                                   S01117
     ISDGELR    E DSSDGELRPD                                              S01117
     I** GENERAL LEDGER DETAILS                                           S01117
     I*****         BKAPDT                          APDA            S01117S01392
     I              BKOBRU                          OBUU                  S01194
     I              BKOBUV                          OBUV                  S01194
     I              QQACCD                          QQACD1                                    CGL029
      *                                                                   CLE004
     ISCSARD    E DSSCSARDPD                                              CLE004
     I** SAR details                                                      CLE004
      *                                                                   CLE004
     ISDCLND    E DSSDCLNDPD                                              CLE004
      ** Customer lending ICD                                             CLE004
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I*                                                                   S01117
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     IPDATA       DS                           1024                                           CER009
     I                                        1  15 WKEY                                      CER009
     I                                        1   6 GCUS                                      CER009
     I                                        1   6 WCUSN                                     CER009
     I                                        7  12 WWFCLN                                    CER009
     I                                       13  15 SEQR                                      CER009
     I                                       13  150WSEQN                                     CER009
      /EJECT                                                              S01195
     C                     MOVEACPY@      BIS@   80
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP11                                           S01408
      *                                                                   S01408
      *                                                                   CLE004
      ** MAIN PROCESSING                                                  CLE004
      *                                                                   CLE004
     C                     EXSR FIRST                                     CLE004
      *                                                                   CLE004
     C           *INKC     DOUEQ'1'                                       CLE004
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP13                                           S01408
      *                                                                   S01408
     C                     EXSR SFOUT                                     CLE004
     C                     EXSR INIT                                      CLE004
      *                                                                   CLE004
     C           ACTN      IFNE *BLANK                                    CLE004
     C           GCUSA     ORNE *BLANK                                    CLE004
     C           LOANA     ORNE *BLANK                                    CLE004
     C           FACILA    ORNE *BLANK                                    CLE004
     C           SEQRA     ORNE *BLANK                                    CLE004
      *                                                                   CLE004
     C                     SELEC                                          CLE004
     C           ACTN      WHEQ 'A'                                       CLE004
     C           ACTN      OREQ 'I'                                       CLE004
     C           ACTN      OREQ 'X'                                       CLE004
     C                     EXSR INSAMD                                    CLE004
     C           ACTN      WHEQ 'E'                                       CLE004
     C                     EXSR SRENQ                                     CLE004
     C           ACTN      WHEQ 'D'                                       CLE004
     C                     EXSR SRDEL                                     CLE004
     C                     ENDSL                                          CLE004
      *                                                                   CLE004
     C                     ELSE                                           CLE004
      *                                                                   CLE004
      ** Subfile Processing                                               CLE004
      *                                                                   CLE004
     C                     EXSR SRSUBF                                    CLE004
     C                     ENDIF                                          CLE004
     C                     ENDDO                                          CLE004
      *                                                                   CLE004
     C                     MOVE '1'       *INLR                           CLE004
     C/COPY WNCPYSRC,LE0080C050
     C                     RETRN                                          CLE004
      *                                                                   CLE004
0447 C********************************************************************S01117
     C***********                                                         CLE004
     C*****FROM*ERROR HANDLING SUBROUTINE RETURN TO EXIT POINT            CLE004
     C***********                                                         CLE004
     C***********STATS1    IFEQ 01021                                     CLE004
     C***********          EXSR UDLOG                                     CLE004
     C***********          GOTO END                                       CLE004
     C***********          END                                            CLE004
     C***********                                                         CLE004
     C***********STATS2    IFEQ 01021                                     CLE004
     C***********          EXSR UDLOG                                     CLE004
     C***********          GOTO END                                       CLE004
     C***********          END                                            CLE004
     C***********                                                  S01241 CLE004
     C***********... CMD12 PRESSED  -  GO TO ENQUIRY SCREEN ...    S01241 CLE004
     C***********                                                  S01241 CLE004
     C************INKL     IFEQ '1'                                S01241 CLE004
     C***********          Z-ADD1         ETAT                     S01241 CLE004
     C***********          END                                     S01241 CLE004
     C***********                                                  S01241 CLE004
     C***********... ERROR OCCURED ON ENQUIRY SCREEN ...           S01241 CLE004
      ***********                                                  S01241 CLE004
     C**N43*01***          Z-ADD2         ETAT                     S01241 CLE004
      ***********                                                  S01241 CLE004
     C************IN12     IFEQ '0'                                S01241 CLE004
     C***********          Z-ADD1         ETAT    10               S01241 CLE004
     C***********          ELSE                                    S01241 CLE004
     C***********                                 OK TO DSP BOT    S01241 CLE004
     C***********ETAT      IFEQ 1                                  S01241 CLE004
     C***********          Z-ADD2         ETAT                     S01241 CLE004
     C***********          ELSE                                    S01241 CLE004
     C***********                                 BOT DISPLAYED    S01241 CLE004
     C***********ETAT      IFEQ 2                   OK TO DSP DET. S01241 CLE004
     C***********          Z-ADD3         ETAT                     S01241 CLE004
     C***********          MOVELGCUSA     @CUST  10                S01241 CLE004
     C***********          MOVELFACILA    @FCTLY  5                S01241 CLE004
     C***********          MOVELLOANA     @LOAN   6                S01241 CLE004
     C***********          MOVELSEQRA     @SEQ    3                S01241 CLE004
     C***********          MOVELACTN      @ACTN   1                S01241 CLE004
     C***********          ELSE                                    S01241 CLE004
     C***********                                 READY TO DISPLAY S01241 CLE004
     C***********GCUSA     IFEQ *BLANKS                WINDOW      S01241 CLE004
     C***********          Z-ADD2         ETAT                     S01241 CLE004
     C***********          ELSE                                    S01241 CLE004
     C***********          Z-ADD3         ETAT                     S01241 CLE004
     C***********          END                                     S01241 CLE004
     C***********                                                  S01241 CLE004
     C***********... CALL WINDOW WHEN ENQUIRY/CLOSE/REVERSE        S01241 CLE004
     C***********    THESE DISPLAYS CONTAINS INPUT FIELD AT BOTTOM S01241 CLE004
     C***********    OF THE SCREEN ...                             S01241 CLE004
     C***********                                                  S01241 CLE004
     C***********@ACTN     IFEQ 'E'                                S01241 CLE004
     C***********                                                  S01241 CLE004
     C***********          MOVEL'LE0080'  PROG                     S01241 CLE004
     C***********                                                  S01241 CLE004
     C***********BGL5ST    IFEQ 'Y'                                 S01241S01251
     C***********BGWDPR    IFEQ 'Y'                                S01251 CLE004
      ***********                                                  S01241 CLE004
     C***********@LOAN     IFEQ '000000'                           S01241 CLE004
     C***********@LOAN     OREQ *BLANKS                            S01241 CLE004
     C***********          MOVEL'F'       @LOAN                    S01241 CLE004
     C***********          MOVE @FCTLY    @LOAN                    S01241 CLE004
     C***********          END                                     S01241 CLE004
      ***********                                                  S01241 CLE004
      *****/copy*to move data into the data structure fields passedS01241 CLE004
      ******as*a*parameter to the window controller                S01241 CLE004
      */COPY*QWINDSRC,LE0080MOV1***                                S01241 CLE004
      ***********                                                  S01241 CLE004
     C***********          UNLCKLDA                                S01241 CLE004
     C***********          CALL 'WN0010'                           S01241 CLE004
     C***********          PARM           PROG   10                S01241 CLE004
     C***********          PARM *BLANK    KEY     2                S01241 CLE004
     C***********          PARM           @ACTN                    S01241 CLE004
     C***********          PARM           DATA                     S01241 CLE004
     C***********          PARM *BLANK    #RTRN   7                S01241 CLE004
     C***********          PARM           SPARE 256                S01252 CLE004
     C************LOCK     IN   LDA                                S01241 CLE004
     C***********          END                                     S01241 CLE004
      ***********                                                  S01241 CLE004
      ***********... SAVE DATA KEYED IN AT BOTTOM OF THE SCREEN ...S01241 CLE004
      ***********                                                  S01241 CLE004
     C***********          MOVELGCUSA     @CUST                    S01241 CLE004
     C***********          MOVELFACILA    @FCTLY                   S01241 CLE004
     C***********          MOVELLOANA     @LOAN                    S01241 CLE004
     C***********          MOVELACTN      @ACTN                    S01241 CLE004
     C***********          MOVELSEQRA     @SEQ                     S01241 CLE004
     C***********          END                                     S01241 CLE004
     C***********                                                  S01241 CLE004
     C***********          END                                     S01241 CLE004
     C***********          END                                     S01241 CLE004
     C***********          END                                     S01241 CLE004
     C***********                                                         CLE004
     C*****READ*WORKSTATION FILE /*HELP*FACILITY*                  S01199 CLE004
     C***********                                                         CLE004
     C************IN12     IFEQ '1'                                       CLE004
     C************IN13     DOUEQ'0'                                       CLE004
     C***********          READ LE0080FM                 13               CLE004
     C***01*****           MOVE SCN2      SCN2S                           CLE004
     C********** *IN13     IFEQ '1'
     C**********           MOVEAERCD      HERCD 160
     C**********           MOVEL'LE0080'  HBPGM   8
     C**********           CALL 'MHELP'                                   S01199
     C**********           PARM           HBPGM                           S01199
     C**********           PARM           HERCD                           S01199
     C**********           END                                            S01199
     C***********          END                                            CLE004
     C***********          END                                            CLE004
0576 C***********                                                         CLE004
0577 C*****FIRST*CYCLE - BLANK INPUT FROM WORKSTN - OUTPUT SF SCREEN      CLE004
0578 C***********                                                         CLE004
0580 C**N12******          SETON                     1205                 CLE004
0581 C***********          SETOF                     13                   CLE004
0582 C***05******          EXSR FIRST                                     CLE004
     C***99****************GOTO END                                 E10963E14820
     C***LR******          GOTO END                                E14820 CLE004
0585 C***********                                                         CLE004
0586 C*****RESET*FIELDS AND INDICATORS                                    CLE004
0587 C***********                                                         CLE004
     C***********                                                  S01408 CLE004
     C*/COPY*WNCPYSRC,LE0080CCPG***                                S01408 CLE004
     C***********                                                  S01408 CLE004
0588 C***********          SETOF                     363740               CLE004
0589 C***********          SETOF                     413578               CLE004
0590 C***********          SETOF                     666755               CLE004
0591 C***********          SETOF                     494552               CLE004
0592 C***********          SETOF                     566068               CLE004
     C***********          SETOF                     81            S01117 CLE004
0593 C***********                                                         CLE004
0594 C***********          SETON                       4243               CLE004
0595 C***********          MOVE BLANKS    ERCD                            CLE004
0596 C*********            MOVE BLANKS    ERRMSG 55                       BHF335
0596 C***********          MOVE BLANKS    ERRMSG 70                BHF335 CLE004
0597 C***********          Z-ADD0         S                               CLE004
0598 C***********                                                         CLE004
0599 C*****COMMAND KEY TESTS                                              CLE004
0600 C***********                                                         CLE004
0601 C***KC******          SETON                     36LR  EOJ            CLE004
0602 C***KC******          GOTO END                                       CLE004
0603 C***********                                                         CLE004
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP12                                           S01408
      *                                                                   S01408
0604 C***KL******          SETON                     05                   CLE004
0605 C***05******          EXSR SFOUT                                     CLE004
0606 C***05******          GOTO END                                       CLE004
0607 C***********                                                         CLE004
0608 C*****TEST*FOR INVALID COMMAND KEY OR INVALID SCREEN                 CLE004
0609 C***********                                                         CLE004
0610 C***04NKJ***                                                         CLE004
0611 C*RN04 KJ***          SETOF                     43                   CLE004
0612 C**N43******          SETOF                     535457               CLE004
0613 C**N43******          SETOF                     585059               CLE004
0614 C**N43******          SETOF                     604849               CLE004
0615 C**N43******          SETOF                     454652               CLE004
0616 C**N43N01***          SETON                     417868               CLE004
0617 C**N43*01N65          SETON                     40                   CLE004
0618 C**N43******          SETON                     666701               CLE004
 619 C**N43******          MOVE ERMSG,6   ERRMSG                          CLE004
0620 C**N43******          EXSR QTIME                                     CLE004
0621 C**N43******          GOTO END                                       CLE004
0622 C***********          SETOF                     65                   CLE004
0623 C***********                                                         CLE004
0624 C*****CALL*SUBR. FOR SCREEN TYPE                                     CLE004
0625 C***********                                                         CLE004
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP13                                           S01408
      *                                                                   S01408
0626 C***01******          EXSR INIT                                      CLE004
0627 C***02******                                                         CLE004
0628 C*R*03******          EXSR INSAMD                                    CLE004
0629 C***********                                                         CLE004
0630 C***02*42***                                                         CLE004
0631 C*R*03*42***                                                         CLE004
0632 C*R*04******          EXSR UDLOG                                     CLE004
0633 C***********          EXSR QTIME                                     CLE004
0634 C***********END       TAG                             ** END TAG ****CLE004
0636 C********************************************************************
0637 C*                                                                  *
0638 C*    INIT SR. TO VALIDATE INITIAL SCREEN                           *
0639 C*                                                                  *
0640 C*        ROUTINE CALLED FROM - MAIN PROCESSING
0641 C*        ROUTINE CALLS - ZALIGN (2),CLINCH,GUARCH,EXCEPT,DATCON
0642 C*
0643 C           INIT      BEGSR                           ** INIT BEGSR *
      *                                                                   CLE004
     C           *INKC     DOWEQ'0'                                       CLE004
     C           GCUSA     IFEQ *BLANK                                    CLE004
     C           FACILA    ANDEQ*BLANK                                    CLE004
     C           LOANA     ANDEQ*BLANK                                    CLE004
     C           SEQRA     ANDEQ*BLANK                                    CLE004
     C           ACTN      ANDEQ*BLANK                                    CLE004
      *                                                                   CLE004
      ** Validate Unauthorised Only field                                 CLE004
      *                                                                   CLE004
     C           SRAUT     IFNE *BLANK                                    CLE004
     C           SRAUT     ANDNE'Y'                                       CLE004
     C           SRAUT     ANDNE'N'                                       CLE004
     C                     MOVE '1'       *IN85                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,18  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           SRAUT     IFEQ *BLANK                                    CLE004
     C                     MOVE 'N'       SRAUT                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Validate Review Sequence no. field                               CLE004
      *                                                                   CLE004
     C                     MOVELSRSEQ     WNUM3   30                      CLE004
     C                     MOVE WNUM3     WFLD3   3                       CLE004
     C           SRSEQ     IFNE WFLD3                                     CLE004
     C           SRSEQ     ANDNE*BLANK                                    CLE004
     C                     MOVE '1'       *IN84                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,17  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Validate Review facility/loan field                              CLE004
      *                                                                   CLE004
     C**********           MOVELSRFOL     WNUM6                                        CLE004 CSD027
     C**********           MOVE WNUM6     WFLD6                                        CLE004 CSD027
     C**********           MOVELSRFOL     WNUM6   60                                   CSD027 CLE148
     C                     MOVELSRFOL     WNUM6   6                                           CLE148
     C                     MOVE WNUM6     WFLD6   6                                           CSD027
     C           SRFOL     IFNE WFLD6                                     CLE004
     C           SRFOL     ANDNE*BLANK                                    CLE004
      *                                                                   CLE004
     C                     MOVE SRFOL     WRFOLX  1                       CLE004
     C           WRFOLX    IFNE *BLANK                                    CLE004
     C                     MOVE '1'       *IN83                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,16  ERRMSG                          CLE004
     C                     ELSE                                           CLE004
     C                     MOVELSRFOL     WNUM5   50                      CLE004
     C                     MOVE WNUM5     WFLD5   5                       CLE004
     C           SRFOL     IFNE WFLD5                                     CLE004
     C           SRFOL     ANDNE*BLANK                                    CLE004
     C                     MOVE '1'       *IN83                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,16  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ***Validate*Review*customer*field*                                               CLE004 CSD027
      **********                                                                       CLE004 CSD027
     C**********           MOVELSRCUS     WNUM6   60                                   CLE004 CSD027
     C**********           MOVE WNUM6     WFLD6   6                                    CLE004 CSD027
     C********** SRCUS     IFNE WFLD6                                                  CLE004 CSD027
     C********** SRCUS     ANDNE*BLANK                                                 CLE004 CSD027
     C**********           MOVE '1'       *IN82                                        CLE004 CSD027
     C**********           MOVE '0'       *IN43                                        CLE004 CSD027
     C**********           MOVE ERMSG,15  ERRMSG                                       CLE004 CSD027
     C**********           ENDIF                                                       CLE004 CSD027
      *                                                                   CLE004
     C           *IN43     IFEQ '1'                                       CLE004
     C                     GOTO INEND                                     CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE '0'       *IN48                           CLE004
     C                     MOVE '0'       *IN49                           CLE004
     C                     MOVE '0'       *IN45                           CLE004
     C                     MOVE '0'       *IN46                           CLE004
     C                     MOVE '0'       *IN52                           CLE004
      *                                                                   CLE004
     C                     ELSE                                           CLE004
      *                                                                   CLE004
0642 C*
0643 C           *NAMVAR   DEFN           LDA                             S01241
     C                     SETOF                     27                   158889
0644 C*                                                                   S01241
0645 C**   RESET LAST UPDATE DATA FIELDS FOR NEW TRANSACTION
0646 C                     Z-ADD0         TNLU
0647 C                     Z-ADD0         TNLUS
0648 C                     BITOF'01234567'LBIT    1
0649 C**   CHECK TO SEE DETAILS NOT ENTERED FOR LOAN AND FACILITY
0650 C**
0651 C   22 25
0652 CORN22N25             SETOF                     43
0653 C  N43                MOVE ERMSG,8   ERRMSG
0654 C  N43      S         ADD  1         S
0655 C  N43                MOVE ' 095'    ERCD,S
0656 C  N43                SETON                     4549
0657 C  N43                SETOF                     4648
0658 C**N43*****           GOTO INITER                                    BHF335
0659 C**
0660 C**   VALIDATE ACTION CODE - MUST BE 'I','A','D','E'.
0661 C**
0662 C                     SETOF                     626364
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP14                                           S01408
      *                                                                   S01408
0663 C           ACTN      COMP 'I'                  444461
0664 C   44      ACTN      COMP 'A'                  444462
0665 C   44      ACTN      COMP 'D'                  444463
0666 C   44      ACTN      COMP 'E'                  444464
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP15                                           S01408
      *                                                                   CLE004
     C           *IN44     IFEQ '1'                                       CLE004
     C           ACTN      IFEQ 'X'                                       CLE004
     C           CLE002    IFEQ 'Y'                                       155610
     C           BPGUAU    ANDEQ'Y'                                       CLE004
     C                     MOVE '0'       *IN44                           CLE004
     C                     ENDIF                                          155610
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   S01408
0667 C  N44                MOVE ACTN      ACTNO   1
     C           *IN44     IFNE '1'                                       158891
     C           ACTN      ANDEQ'X'                                       158891
     C           ORED      IFEQ BJRDNB                                    158891
     C                     MOVE 'I'       ACTNO                           158891
     C                     ELSE                                           158891
     C                     MOVE 'A'       ACTNO                           158891
     C                     END                                            158891
     C                     END                                            158891
0668 C**N44                GOTO CUSTVL                                    S01117
     C  N44                GOTO CHKUSR                                    S01117
0669 C**
0670 C           S         ADD  1         S
0671 C                     MOVE ' 021'    ERCD,S
0672 C                     MOVE ERMSG,1   ERRMSG
0673 C                     SETON                     52
0674 C                     SETOF                     434648
0675 C**********           GOTO INITER                                    BHF335
0676 C**
     C           CHKUSR    TAG                                            S01117
     C           *IN52     IFNE '1'                                       BHF335
     C**                                                                  S01117
     C**  CHECK USER AUTHORISATION ON THE ACTION CODE WHEN                S01117
     C**  NON-MULTIBRANCHING                                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'N'                                       S01117
      *                                                                   S01117
     C                     Z-ADD*ZERO     @ERR                            S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE *ZERO                      *B1            S01117
     C                     ADD  1         S          87                   S01117
     C                     MOVE '302'     ERCD,S                          S01117
     C                     MOVE ERMSG,12  ERRMSG
     C                     SETOF                     46                   S01117
     C                     GOTO INITER                                    S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C                     END                                            BHF335
0676 C**
0677 C           CUSTVL    TAG                             ** CUSTVL TAG *
0678 C**
0679 C**   VALIDATE CUSTOMER - MUST BE ON CLINT OR SNAME FILE
0680 C**
0681 C   48                GOTO CERR
0682 C**
0683 C**   CHECK WHETHER NUMERIC USING ZALIGN SR.
0684 C**
0685 C**********           MOVE BLANKS    ZFIELD                          BHF335
0686 C**********           MOVE GCUSA     ZFIELD                          BHF335
0687 C**********           Z-ADD10        ZADIG                           BHF335
0688 C**********           Z-ADD0         ZADEC                           BHF335
0689 C**********           EXSR ZALIGN                                    BHF335
0690 C***99*********       GOTO NOTNUM                                    S01194
0691 C**
0692 C***24*********                                                      S01194
0693 C*ORN79********        GOTO CERR                                     S01194
0692 C***24N99**                                                    S01194BHF335
0693 C*ORN79N99*            GOTO CERR                               S01194BHF335
0694 C**
0695 C**********           MOVELGCUSA     GCUS    60                      BHF335
0696 C**********           MOVE GCUS      FCUS                            BHF335
0697 C**************       MOVELGCUS      CLIKEY                          S01194
0697 C                     MOVEL*BLANKS   KEYC   10                       S01194
0697 C**********           MOVELGCUS      KEYC   10                 S01194BHF335
0697 C                     MOVELGCUSA     KEYC   10                       BHF335
0698 C                     EXSR CLINCH
     C   10                MOVELBBCUST    GCUSA                           BHF335
     C   10                MOVELBBCUST    GCUS                            BHF335
     C***10********        MOVELBBCUST    SCN2                            BHF335
     C   10                MOVELBBCUST    DUMMY  10                 BHF335BHF507
     C   10                MOVELDUMMY     SCN2                            BHF507
     C   10                MOVELBBCUST    FCUS                            BHF335
0699 C   10                GOTO LOANVL
0700 C**
0701 C           CERR      TAG                             ** CERR TAG ***
0702 C                     SETON                     48
0703 C                     SETOF                     46
0704 C           S         ADD  1         S
0705 C                     MOVE ' 034'    ERCD,S
0706 C**********           GOTO INITER                                    BHF335
0707 C**
0708 C***********NOTNUM    TAG                             ** NOTNUM TAG *S01194
0709 C**************                                                      S01194
0710 C*****MUST*BE*A SHORTNAME                                            S01194
0711 C**************       SETOF                     1044                 S01194
0712 C***********GCUSA     CHAINSNAME                44                   S01194
0713 C**N10*********       SETON                     48                   S01194
0714 C**N10*********       SETOF                     46                   S01194
0715 C**N10******S**       ADD  1         S                               S01194
0716 C**N10*********       MOVE ' 035'    ERCD,S                          S01194
0717 C**N10*********       GOTO INITER                                    S01194
0718 C**********           MOVE BBCUST    CNUMS   60                S01194BHF335
0718 C**********           MOVE CNUMS     GCUS                            BHF335
0719 C**********           MOVE CNUMS     FCUS                            BHF335
0720 C**
0721 C           LOANVL    TAG                             ** LOANVL TAG *
0722 C**
0723 C**   NO FURTHER VALIDATION OF LOAN OR FACILITY REF                  S01117
     C**   FOR ACTION CODES 'E'.                                          S01117
     C**   Also if action code is invalid.                                123785
0724 C*****FOR*ACTION*CODES*'D'*AND*'E'.******                            S01117
0725 C**
0726 C***63******                                                         S01117
0727 C*R*64******          GOTO SEQVL                                     S01117
     C***64******          GOTO SEQVL                              S01117 S01117
0725 C   64                                                               123785
     COR 44                GOTO SEQVL                                     123785
0728 C**
0729 C   22                GOTO FACVL                      VALID BLANK
0730 C**
0731 C**   VALIDATE LOAN REFERENCE - MUST BE VALID LOAN ON CLOAN FILE
     C**      WHEN ACTION CODE IS I OR A. FOR ACTION CODE D, IF THE       S01117
     C**      RELATED LOAN NOT FOUND, SET ON INDICATOR TO IGNORE          S01117
     C**      THE ORIGIATING BRANCH CHECKING                              S01117
0732 C**
0733 C                     SETOF                     10
     C                     MOVELLOANA     LOANB                           CLE004
0734 C           CLOKEY    CHAINCLOAN                45
0735 C  N10                SETON                     45
0736 C   45                BITON'0'       LBIT
      *                                                                   S01117
     C   63 45             SETON                     81                   S01117
     C   63 45             SETOF                     45                   S01117
      *  IGNORE FURTHER CHECKING WHEN ACTION CODE IS D                    S01117
     C   63                GOTO SEQVL                                     S01117
      *                                                                   S01117
0737 C   45                GOTO LERR
0738 C**
0739 C**   CHECK LOAN IS PROCESSING TYPE 61-65
0740 C**
0741 C           PTYP      COMP 61                     45
0742 C  N45      PTYP      COMP 65                   45
      **   Allow Processing type of 70.                                   187260
     C   45      PTYP      IFEQ 70                                        187260
     C                     MOVE *OFF      *IN45                           187260
     C                     ENDIF                                          187260
      *                                                                   CLE005
      ** If SAR CLE005 is installed, allow PTYP 68                        CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      ANDEQ68                                        CLE005
     C                     MOVE *OFF      *IN45                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C/COPY WNCPYSRC,LE0080C003
0743 C   45                BITON'1'       LBIT
0744 C   45                GOTO LERR
0745 C**
0746 C**   CHECK CUSTOMER SAME
0747 C**
0748 C***********CNUML     COMP GCUS                 4545                 CLE004
     C                     MOVE GCUS      GCUSK                           CLE004
0748 C           CNUML     COMP GCUSK                4545                 CLE004
0749 C  N45                GOTO SEQVL
0750 C                     SETON                     48
0751 C                     BITON'2'       LBIT
0752 C**
0753 C           LERR      TAG                             ** LERR TAG ***
0754 C                     MOVE ERMSG,2   ERRMSG
0755 C                     SETOF                     43
0756 C           S         ADD  1         S
0757 C                     TESTB'0'       LBIT           44
0758 C   44                MOVE ' 025'    ERCD,S
0759 C**
0760 C                     TESTB'1'       LBIT           44
0761 C   44                MOVE ' 102'    ERCD,S
0762 C**
0763 C                     TESTB'2'       LBIT           44
0764 C   44                MOVE ' 086'    ERCD,S
0765 C**
0766 C                     GOTO SEQVL
0767 C**
0768 C           FACVL     TAG                             ** FACVL TAG **
0769 C**
0770 C**   VALIDATE FACILITY - MUST BE LIVE ON FCLTY FILE
     C**      WHEN ACTION CODE IS I OR A. FOR ACTION CODE D, IF THE       S01117
     C**      RELATED FACILITY NOT FOUND, SET ON INDICATOR TO IGNORE      S01117
     C**      THE ORIGINATING BRANCH CHECKING                             S01117
0771 C**
     C           *IN45     IFNE '1'                                       BHF335
     C           *IN49     ANDNE'1'                                       BHF335
     C*                                                                   BHF335
0772 C                     SETOF                     10
     C                     MOVE FACILA    FACILB                          CLE004
0773 C           FCKEY     CHAINFCLTY                49
0774 C  N10                SETON                     49
      *                                                                   S01117
     C   63 49             SETON                     81                   S01117
     C   63 49             SETOF                     49                   S01117
      *                                                                   S01117
0775 C  N49                GOTO SEQVL
0776 C**
0777 C           S         ADD  1         S
0778 C                     MOVE ERMSG,3   ERRMSG
0779 C                     MOVE ' 093'    ERCD,S
0780 C                     SETOF                     43
     C                     END                                            BHF335
0781 C**
0782 C           SEQVL     TAG                             ** SEQVL TAG **
     C**                                                                  S01117
     C**   CHECK USERS ACCESS TO BRANCH/ACTION                            S01117
     C**   WHEN THE RELATED LOAN/FACILITY IS AVAILABLE                    S01117
     C**   AND ACTION <> 'E'                                              S01117
     C**   CHECKING FOR ACTION = 'E' WILL BE PERFORMED UNTIL              S01117
     C**   GUARANTEE RECORD IS ACCESSED                                   S01117
     C**                                                                  S01117
     C           *IN52     IFNE '1'                                       BHF335
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *IN81     ANDNE'1'                                       S01117
     C           *IN45     ANDNE'1'                                       S01117
     C           *IN49     ANDNE'1'                                       S01117
     C           ACTN      ANDNE'E'                                       S01117
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP16                                           S01408
      *                                                                   S01408
      *                                                                   S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM BRCA      @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C**                                                                  S01117
     C           @ERR      IFNE 0                                         S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     ADD  1         S          86                   S01117
     C                     MOVE '303'     ERCD,S                          S01117
     C                     MOVE ERMSG,10  ERRMSG
     C                     ELSE                                           S01117
     C                     ADD  1         S          86                   S01117
     C                     MOVE '304'     ERCD,S                          S01117
     C                     MOVE ERMSG,11  ERRMSG
     C                     END                                            S01117
     C**                                                                  S01117
     C  N22                SETON                     454852               S01117
     C  N25                SETON                     494852               S01117
     C                     SETOF                     46                   S01117
     C                     GOTO INITER                                    S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           OBUV      IFEQ 'Y'                        *B2            S01117
     C           OBUU      ANDEQ'Y'                                       S01117
      *                                                                   S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM ORBR      @ZOBRX  3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE 0                                         S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     ADD  1         S          86                   S01117
     C                     MOVE '305'     ERCD,S                          S01117
     C                     MOVE ERMSG,13  ERRMSG
     C                     ELSE
     C                     ADD  1         S          86                   S01117
     C                     MOVE '306'     ERCD,S                          S01117
     C                     MOVE ERMSG,14  ERRMSG
     C                     END                             *E3            S01117
     C  N22                SETON                     4548                 S01117
     C  N25                SETON                     4948                 S01117
     C                     SETOF                     46                   S01117
     C                     GOTO INITER                                    S01117
     C                     END                             *E3            S01117
      *                                                                   S01117
     C                     END                             *E2            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C**                                                                  BHF335
     C                     END                                            BHF335
     C**                                                                  S01117
0783 C**                                                                  168815
0784 C**   VALIDATE SEQUENCE NO. - MUST BE BLANK ON INSERT.               168815
0785 C**                                                                  168815
     C           SEQRA     IFNE *BLANK                                    168815
     C           ACTN      ANDEQ'I'                                       168815
     C                     MOVE '1'       *IN46                           168815
     C                     MOVE '0'       *IN43                           168815
     C                     MOVE ERMSG,24  ERRMSG                          168815
     C                     GOTO INITER                                    168815
     C                     ENDIF                                          168815
0783 C**
0784 C**   VALIDATE SEQUENCE NO. - MUST BE VALID NUMERIC
0785 C**
0786 C                     MOVE BLANKS    ZFIELD
0787 C                     MOVE SEQRA     ZFIELD
0788 C                     Z-ADD3         ZADIG
0789 C                     Z-ADD0         ZADEC
0790 C  N46                EXSR ZALIGN
0791 C   99                SETON                     46
0792 C  N46                MOVE ZFIELD    SEQR
0793 C   46      S         ADD  1         S
0794 C   46                MOVE ' 107'    ERCD,S
0795 C   46
0796 COR 48
0797 COR 49
0798 COR 45                GOTO INITER
0799 C**
0800 C**   CHECK FOR 'I' NOT ON FILE , FOR 'A','D','E' ON FILE
0801 C**
0802 C**N25*****           MOVELF         FCLNA                                               CLE148
     C  N25                MOVEL' '       FCLNA                                               CLE148
0803 C  N25                MOVE FACILA    FCLNA
0804 C  N22                MOVE LOANA     FCLNA
     C                     MOVE GCUS      GCUSK                           CLE004
     C                     MOVE SEQR      SEQRK                           CLE004
0805 C                     EXSR GUARCH
     C* IF AMENDING AN EXPIRED FACILITY, THEN STORE THE INDICATOR FOR     158889
     C* SUBTOTALLING                                                      158889
     C           *IN18     IFEQ '1'                                       158889
     C                     SETON                     27                   158889
     C                     ELSE                                           158892
     C                     SETOF                     27                   158892
     C                     END                                            158889
      *                                                                   168815
     C* If sequence number is greater than 999 display message.           168815
      *                                                                   168815
     C           WKSQER    IFEQ 'Y'                                       168815
     C           FACILA    IFNE *BLANKS                                   168815
     C                     MOVE '1'       *IN46                           168815
     C                     MOVE '0'       *IN43                           168815
     C                     MOVE ERMSG,25  ERRMSG                          168815
     C                     ELSE                                           168815
     C                     MOVE '1'       *IN46                           168815
     C                     MOVE '0'       *IN43                           168815
     C                     MOVE ERMSG,26  ERRMSG                          168815
     C                     ENDIF                                          168815
     C                     ENDIF                                          168815
      *                                                                   CLE004
      ** Validate for action code 'X'                                     CLE004
      ***  Authorised user must be different from the insert and amend users                  CLE056
      ***  Unless CLE056 is enabled and not day of input and not last amender                 CLE056
      *                                                                   CLE004
     C           BPGUAU    IFEQ 'Y'                                       CLE004
     C           CLE002    ANDEQ'Y'                                       155610
     C           ACTN      ANDEQ'X'                                       CLE004
     C           RECI      ANDEQ'D'                                       CLE004
      *                                                                   CLE004
     C           USRID     IFEQ IUSR                                      CLE004
     C           CLE056    IFEQ 'N'                                                           CLE056
     C           CLE056    OREQ 'Y'                                                           CLE056
     C           ORED      ANDEQBJRDNB                                                        CLE056
     C           USRID     ANDEQIUSR                                                          CLE056
     C                     MOVE '1'       *IN52                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,19  ERRMSG                          CLE004
     C                     ENDIF                                                              CLE056
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           USRID     IFEQ AUSR                                      CLE004
     C           *IN52     ANDEQ'0'                                       CLE004
     C           CLE056    IFEQ 'N'                                                           CLE056
     C           CLE056    OREQ 'Y'                                                           CLE056
     C           LCD       ANDEQBJRDNB                                                        CLE056
     C           CHTP      ANDEQ'A'                                                           CLE056
     C           USRID     ANDEQAUSR                                                          CLE056
     C                     MOVE '1'       *IN52                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,20  ERRMSG                          CLE004
     C                     ENDIF                                                              CLE056
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           GSTS      IFNE 'C'                                       CLE004
     C           GSTS      ANDNE'R'                                       CLE004
     C           *IN52     ANDEQ'0'                                       CLE004
     C                     MOVE '1'       *IN52                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,21  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN52     IFEQ '1'                                       CLE004
     C           *IN43     ANDEQ'0'                                       CLE004
     C                     GOTO INITER                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      **                                                                  S01117
      **   WHEN MULTIBRANCHING,                                           S01117
      **   THE GUARANTEE RECORD FOUND AND THE RELATED LOAN/FACILITY       S01117
      **   NOT FOUND, OR ACTION = 'E',                                    S01117
      **   DO SPF CHECKING ON BOOKING BRANCH.                             S01117
      **                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *IN81     ANDEQ'1'                                       S01117
     C           *IN16     ANDEQ'1'                                       S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           *IN16     ANDEQ'1'                                       S01117
     C           ACTN      ANDEQ'E'                                       S01117
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP17                                           S01408
      *                                                                   S01408
      *                                                                   S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM BRCA      @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE *ZERO                      *B3            S01117
     C                     ADD  1         S          86                   S01117
     C                     MOVE '306'     ERCD,S                          S01117
     C  N22                SETON                     454852               S01117
     C  N25                SETON                     494852               S01117
     C                     GOTO INITER                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C   52                                                               BHF335
     COR 48                                                               BHF335
     CORN43                GOTO INITER                                    BHF335
     C**                                                                  S01117
0806 C   61N16N18
     CANN19                                                               155821
0807 C**N61 16             GOTO INITOK                                    158889
0807 CORN61 16                                                            158889
0807 COR 63 18                                                            158890
0807 COR 62 18             GOTO INITOK                                    158889
0808 C**
0809 C           S         ADD  1         S
0810 C                     SETON                     52
0811 C   61 16             MOVE ERMSG,9   ERRMSG
0812 C  N61N16             MOVE ERMSG,4   ERRMSG
0813 C   18                MOVE ERMSG,5   ERRMSG
0813 C   19                MOVE ERMSG,23  ERRMSG                          155821
0814 C**
0815 C   61                MOVE ' 096'    ERCD,S
0816 C   62
0817 COR 63
0818 COR 64N18             MOVE ' 097'    ERCD,S
0819 C                     SETOF                     43
0820 C   64 18             GOTO INITOK
0821 C           INITER    TAG                             ** INITER TAG *
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP4                                           S01408
      *                                                                   S01408
0822 C**
0823 C                     SETOF                     42
0824 C                     SETON                     3637
0825 C***********          SETON                     406667               CLE004
0826 C***********          GOTO INEND                                     CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN42     IFEQ '0'                                       CLE004
     C           *IN43     OREQ '0'                                       CLE004
     C           *IN16     IFEQ '1'                                       CLE004
     C           *IN18     OREQ '1'                                       CLE004
     C           *IN19     OREQ '1'                                       155821
     C                     SETON                     69                   CLE004
     C                     EXSR EXCEPT                                    CLE004
     C                     ENDIF                                          CLE004
     C                     MOVEAERCD      ERCDA                           CLE004
     C                     MOVE *OFF      *IN16                           120056
     C                     MOVE *OFF      *IN18                           148902
     C                     MOVE *OFF      *IN19                           184288
     C                     WRITELE0080F0                                  CLE004
     C                     EXFMTLE0080F1                                  CLE004
      *                                                                   CLE004
     C           *INKC     IFEQ '1'                                       CLE004
     C                     MOVE '1'       *INLR                           CLE004
     C                     RETRN                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     EXSR SRINSI                                    CLE004
     C                     ELSE                                           CLE004
     C                     GOTO INITOK                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDDO                                          CLE004
0827 C**
0828 C           INITOK    TAG                             ** INITOK TAG *
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP5                                           S01408
      *                                                                   S01408
0829 C**   SAVE LAST UPDATE IF REC READ
0830 C  N44                Z-ADDTNLU      TNLUS   50
0831 C**   RELEASE FILE IF RECORD READ
0832 C  N44                SETON                     69
0833 C  N44                EXSR EXCEPT
0834 C**
0835 C**   INITIAL SCREEN OKAY OUTPUT SECOND SCREEN.
0836 C**
0837 C                     MOVE BLNK6     LOANL   6
0838 C                     MOVE BLNK6     FACILL  5
0839 C   22                MOVE FACILA    FACILL
0840 C   25                MOVE LOANA     LOANL
0841 C                     SETOF                     404648
0842 C                     SETOF                     535457
0843 C                     SETOF                     585059
0844 C**
0845 C                     SETON                     414243
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP6                                           S01408
      *                                                                   S01408
0846 C  N61                EXSR DATCON
0847 C  N61                SETON                     6567
     C/COPY WNCPYSRC,LE0080C046
      *                                                                   CLE004
     C           *IN61     IFEQ '0'                                       CLE004
     C                     EXSR SRDSP                                     CLE004
     C                     ELSE                                                               199610
     C                     MOVE ACTN      ACTION                                              199610
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
0848 C   63
0849 COR 64                SETON                     66
0850 C   63                SETON                     68
0851 C                     SETOF                     3637
0852 C   64                SETON                     37
0853 C   64                SETOF                     41
0854 C  N64                MOVE SCN2      SCN4   25
0855 C***64******          MOVE BLANKS    SCN2                            CLE004
0856 C   64 18             SETOF                     4352
0857 C**
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP7                                           S01408
      *                                                                   S01408
0858 C           INEND     ENDSR                           ** INEND ENDSR
     C/COPY WNCPYSRC,LE0080C010
0859 C*                                                                  *
0861 C********************************************************************
0862 C*                                                                  *
0863 C*    INSAMD SR. TO VALIDATE INSERT/AMEND SCREENS                   *
0864 C*                                                                  *
0865 C*        ROUTINE CALLED FROM - MAIN PROCESSING
0866 C*        ROUTINE CALLS - ZDATE1 (3),ZALIGN (3),TABCHN,CLINCH
0867 C*
0868 C           INSAMD    BEGSR                           ** INSAMD BEGSR
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0080C008
     C                     MOVELFACILA    FACIL                           CLE004
     C                     MOVELLOANA     LOAN                            CLE004
      *                                                                   CLE004
     C           *INKC     DOUEQ'1'                                       CLE004
     C           *INKL     OREQ '1'                                       CLE004
     C           *IN42     OREQ '1'                                       CLE004
     C           ACTN      ANDNE'X'                                       CLE004
     C           WSELT     ANDNE'Y'                                       189116
     C/COPY WNCPYSRC,LE0080C021
     C           *IN42     OREQ '1'                                       CLE004
     C           ACTN      ANDEQ'X'                                       CLE004
     C           *INKK     ANDEQ'1'                                       CLE004
     C********** BPAURV    ANDEQ'N'                                                    123857 197084
     C           BPAURV    ANDNE'Y'                                                           197084
     C/COPY WNCPYSRC,LE0080C022
     C           *IN42     OREQ '1'                                       123857
     C           ACTN      ANDEQ'X'                                       123857
     C           BPAURV    ANDEQ'Y'                                       123857
     C/COPY WNCPYSRC,LE0080C014
      *                                                                   CLE004
     C           BPGUAU    IFEQ 'Y'                                       CLE004
     C           CLE002    ANDEQ'Y'                                       155610
     C           ACTN      ANDEQ'X'                                       CLE004
     C                     MOVE '1'       *IN13                           CLE004
     C                     MOVE '1'       *IN14                           CLE004
     C                     MOVEA'11'      *IN,66                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE '1'       *IN41                           CLE004
     C                     MOVEAERCD      ERCDA                           CLE004
     C                     MOVE 'N'       WSELT                           189116
      ** If no errors but F12 taken from window, reset on *IN42.          189116
     C           S         IFEQ 0                                         189116
     C                     MOVE '1'       *IN42                           189116
     C                     ENDIF                                          189116
     C                     WRITELE0080F0                                  CLE004
     C/COPY WNCPYSRC,LE0080C047
     C                     EXFMTLE0080F2                                  CLE004
     C/COPY WNCPYSRC,LE0080C048
     C                     EXSR SRINSD                                    CLE004
      *                                                                   CLE004
     C           *INKC     IFEQ '1'                                       CLE004
     C                     MOVE '1'       *INLR                           CLE004
     C                     RETRN                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0080CP12                                           S01408
      *                                                                   S01408
     C           *INKL     IFEQ '1'                                       CLE004
     C                     MOVE *OFF      *IN16                           120056
     C                     LEAVE                                          CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0080C004
0869 C**
0870 C**   VALIDATE START DATE - MANDATORY, MUST BE VALID DATE
0871 C**
0872 C  N53                MOVE STRD      WORK6   6
0873 C  N53      STRDA     COMP WORK6                5353
0874 C**
0875 C  N53                Z-ADDSTRD      ZDATE
0876 C  N53                EXSR ZDATE1
0877 C   99                SETON                     53
0878 C  N53                Z-ADDZDAYNO    STDT    50
0879 C  N53                GOTO ENDDVL
0880 C**
0881 C           S         ADD  1         S
0882 C                     MOVE ' 080'    ERCD,S
0883 C**
0884 C           ENDDVL    TAG                             ** ENDDVL TAG *
0885 C**
0886 C**   END DATE VALIDATION - MANDATORY, MUST BE LATER
0887 C**   THAN START DATE AND LATER THAN RUN DATE.
0888 C**
0889 C   54      S         ADD  1         S
0890 C   54                MOVE ' 128'    ERCD,S
0891 C   54                GOTO RVDTVL
0892 C**
0893 C                     MOVE ENDAT     WORK6
0894 C           ENDATA    COMP WORK6                5454
0895 C  N54                Z-ADDENDAT     ZDATE
0896 C  N54                EXSR ZDATE1
0897 C   99                SETON                     54
0898 C   54      S         ADD  1         S
0899 C   54                MOVE ' 080'    ERCD,S
0900 C   54                GOTO RVDTVL
0901 C**********                                                                              240764
0902 C*****GREATER THAN START DATE AND RUN DATE                                               240764
0903 C**********                                                                              240764
0904 C**********           Z-ADDZDAYNO    ENDT    50                                          240764
0905 C**N53***** ENDT      COMP STDT                   5454                                   240764
0906 C**N54***** ENDT      COMP RUND                   5454                                   240764
0907 C***54***** S         ADD  1         S                                                   240764
0908 C***54*****           MOVE ' 129'    ERCD,S                                              240764
      *                                                                                       240764
      * End Date cannot be before Run Date                                                    240764
     C                     Z-ADDZDAYNO    ENDT    50                                          240764
     C           *IN53     IFEQ '0'                                                           240764
      *                                                                                       240764
     C           ENDT      IFLT RUND                                                          240764
     C                     MOVE '1'       *IN54                                               240764
     C           S         ADD  1         S                                                   240764
     C                     MOVE ' 129'    ERCD,S                                              240764
     C                     ELSE                                                               240764
      *                                                                                       240764
      * If entered today, End Date cannot be equal to Run Date                                240764
     C           ENDT      IFEQ RUND                                                          240764
     C           ORED      ANDEQRUND                                                          240764
     C                     MOVE '1'       *IN54                                               240764
     C           S         ADD  1         S                                                   240764
     C                     MOVE ' 129'    ERCD,S                                              240764
     C                     END                                                                240764
     C                     END                                                                240764
      *                                                                                       240764
     C                     END                                                                240764
0909 C**
0910 C           RVDTVL    TAG                             ** RVDTVL TAG *
0911 C**
0912 C**   VALIDATE REVIEW DATE - IF ENTERED MUST BE VALID, MUST
0913 C**   LIE BETWEEN START AND END DATES, AND BE GREATER THAN RUN DATE
0914 C**
0915 C   28                Z-ADD0         REVDT   50
0916 C   28                Z-ADD0         DAY
0917 C   28                GOTO REVFVL
0918 C**
0919 C                     MOVE RVTD      WORK6
0920 C           WORK6     COMP RVDTA                5555
0921 C  N55                Z-ADDRVTD      ZDATE
0922 C  N55                EXSR ZDATE1
0923 C**
0924 C   99                SETON                     55
0925 C   55      S         ADD  1         S
0926 C   55                MOVE ' 080'    ERCD,S
0927 C   55                GOTO REVFVL
0928 C**
0929 C                     Z-ADDZDAYNO    REVDT
0930 C   32N29             Z-ADDZDAY      DAY     20
      * If Amending (*IN03 on), check if review date has been altered                         199662
0931 C   03      RVDT      COMP ZDAYNO                   44
0932 C   03 44             Z-ADDZDAYNO    REVDT
0933 C***03*44***          GOTO REVFVL                                                        199662
0934 C**
0935 C**   CHECK REVIEW DATE BETWEEN DATES
0936 C**********           SETOF                     44                                       199662
      *  If Inserting, or if review date has been amended, validate                           199662
      *   against run date.                                                                   199662
     C           ACTN      IFEQ 'I'                                                           199662
     C           *IN03     OREQ *ON                                                           199662
     C           *IN44     ANDEQ*OFF                                                          199662
     C/COPY WNCPYSRC,LE0080C035
0937 C           REVDT     COMP RUND                   5555
     C/COPY WNCPYSRC,LE0080C036
     C                     ENDIF                                                              199662
      *                                                                                       199662
     C                     SETOF                     44                                       199662
0938 C  N53N55   REVDT     COMP STDT                   5555
0939 C  N54N55   REVDT     COMP ENDT                 44  44
0940 C   55
0941 COR 44      S         ADD  1         S
0942 C   55                MOVE ' 220'    ERCD,S
0943 C   44                MOVE ' 223'    ERCD,S
0944 C   44                SETON                     55
0945 C**
0946 C           REVFVL    TAG                             ** REVFVL TAG *
0947 C**
0948 C**   REVIEW FREQUENCY VALIDATION - IF ENTERED MUST BE VALID
0949 C**   CAN ONLY BE ENTERED IF REVIEW DATE ENTERED.
0950 C**
0951 C   29                Z-ADD0         DAY
0952 C   29                GOTO DAYVL
0953 C**
0954 C   28N29             SETON                     56
0955 C   56      S         ADD  1         S
0956 C   56                MOVE ' 225'    ERCD,S
0957 C   56                GOTO DAYVL
0958 C**
0959 C           RVFQ      LOKUPTABFRQ                   44
0960 C   44                GOTO DAYVL
0961 C**
0962 C           S         ADD  1         S
0963 C                     MOVE ' 055'    ERCD,S
0964 C                     SETON                     56
0965 C**
0966 C           DAYVL     TAG                             ** DAYVL TAG **
0967 C**
0968 C**   VALIDATE REVIEW DAY NO. - MUST BE VALID NUMERIC
0969 C**   CAN ONLY BE ENTERED IF REVIEW DATE ENTERED.
0970 C**
0971 C   32                GOTO CCYVL
0973 C**
0974 C   29N32             SETON                     35
0975 C   35      S         ADD  1         S
0976 C   35                MOVE ' 277'    ERCD,S
0977 C   35                GOTO CCYVL
0978 C**
0979 C                     Z-ADD0         DAY
0980 C                     MOVE DAYA      DAY1    1
0981 C           DAY1      COMP ' '                      44
0982 C   44                MOVELDAYA      DAY1
0983 C   44                MOVE DAY1      DAY     20
0984 C  N44                MOVE DAYA      DAY
0985 C           DAY       COMP 01                     44
0986 C  N44      DAY       COMP 31                   44
0987 C  N44                GOTO CCYVL
0988 C**
0989 C           S         ADD  1         S
0990 C                     MOVE ' 279'    ERCD,S
0991 C                     SETON                     35
0992 C**
0993 C           CCYVL     TAG                             * CCYVL TAG
0994 C****CURRENCY*CODE*-*MANDATORY*-*MUST*BE*A*DEALING*CCY*ON*S/TABLE    S01194
0994 C**  CURRENCY CODE - MANDATORY - MUST BE A DEALING CCY ON SDCURRPD   S01194
0995 C   57                GOTO CCYER
0996 C**************       MOVE BLANKS    TBKEY                           S01194
0997 C**************       MOVE '20'      TBKY1                           S01194
0998 C**************       MOVE GCCY      TBKY2                           S01194
0999 C**************       MOVE '1'       TBKY3                           S01194
1000 C**************       EXSR TABCHN                                    S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*BLANKS' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM GCCY      K101    3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
1001 C**N10*********       GOTO CCYER                                     S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C**********           SETON                     U7U8LR         S01194BHF335
     C**********           MOVEL'SDCURRPD'DBFILE                    S01194BHF335
     C**********           MOVEL@OPTN     DBKEY            *********S01194BHF335
     C**********           MOVEL@OPTN     DBOPTN  7        * DBERRORS01194BHF335
     C**********           Z-ADD8         DBASE            *********S01194BHF335
     C**********           EXSR *PSSR                               S01194BHF335
     C                     GOTO CCYER                                     S01194
     C                     ELSE                                           S01194
     C                     MOVELCCY       GCCY                            S01194
     C                     END                                            S01194
1002 C**  DEALING CURRENCY CHECK
1003 C           DCCY      COMP 'Y'                  4444
1004 C  N44                GOTO CHECFQ
1005 C**
1006 C           CCYER     TAG                             * CCYER TAG
1007 C           S         ADD  1         S
1008 C                     MOVE ' 066'    ERCD,S
1009 C                     SETON                     57
1010 C**
1011 C           CHECFQ    TAG                             ** CHECFQ TAG *
1012 C**
1013 C**   ON INSERT CHECK NEXT REVIEW DATE NOT GREATER THAN END DATE
1014 C**   IF REVIEW DATE,FREQUENCY,CURRENCY AND END DATE ENTERED AND
1015 C**   VALID AND DAY NO. VALID IF ENTERED.
1016 C**
1017 C   03                                                AMEND
1018 COR 28                                                REV DATE BLANK
1019 COR 29                                                REV FREQ BLANK
1020 COR 35                                                REV DAY INVALID
1021 COR 54                                                END DAT INVALID
1022 COR 55                                                REV DAT INVALID
1023 COR 56                                                REV FRQ INVALID
1024 COR 57                GOTO AMTVL                      CCY INVALID
1025 C**
1026 C**   SET UP PARAMETERS FOR ZFREQB                                   S01195
1027 C**
1028 C                     MOVE RVFQ      ZFREQ
1029 C                     Z-ADDREVDT     ZDAYNO
1030 C                     Z-ADDDAY       ZMDAY
     C                     MOVE SYSL      ZLOC                            S01195
1031 C                     MOVE LOCY      ZCCY                            S01195
1032 C                     EXSR ZFREQB                                    S01195
1031 C***********          MOVE GCCY      ZCCY
1032 C***********          EXSR ZFREQB                                    S01195
1033 C**
1034 C**   CHECK NEXT REVIEW DATE EARLIER THAN END DATE
1035 C**
1036 C           ZDAYNO    COMP ENDT                 56  56
1037 C   56      S         ADD  1         S
1038 C   56                MOVE ' 054'    ERCD,S
1039 C**
1040 C           AMTVL     TAG                             * AMTVL TAG
     C/COPY WNCPYSRC,LE0080C037
1041 C**
1042 C**  AMOUNT-MANDATORY,MUST BE A VALID NUMERIC FIELD
1043 C**
1044 C   58                GOTO AMTER
1045 C**
     C/COPY WNCPYSRC,LE0080C044
1046 C                     MOVE BLANKS    ZFIELD
1047 C                     MOVE UNAMT     ZFIELD
1048 C           13        SUB  CDP       ZADIG
1049 C                     Z-ADDCDP       ZADEC
1050 C                     EXSR ZALIGN
1051 C**
1052 C                     MOVE ZFIELD    NAMT   130
     C/COPY WNCPYSRC,LE0080C001
1053 C  N99      NAMT      COMP 0                        99
     C/COPY WNCPYSRC,LE0080C002
1054 C  N99                GOTO NITMVL
1055 C**
1056 C           AMTER     TAG                             * AMTER TAG
1057 C           S         ADD  1         S
1058 C                     MOVE ' 098'    ERCD,S
1059 C   58                MOVE ' 190'    ERCD,S
1060 C                     SETON                     58
1061 C           NITMVL    TAG                             ** NITMVL TAG *
1062 C**
1063 C**   VALIDATE NO. OF ITEMS - MANDATORY , MUST BE VALID NUMERIC
1064 C**
1065 C   50                GOTO NITMER
1066 C                     MOVE BLANKS    ZFIELD
1067 C                     MOVE NITMA     ZFIELD
1068 C                     Z-ADD5         ZADIG
1069 C                     Z-ADD0         ZADEC
1070 C                     EXSR ZALIGN
1071 C                     MOVE ZFIELD    NITM    50
1072 C  N99      NITM      COMP 0                        99
     C/COPY WNCPYSRC,LE0080C005
1073 C  N99                GOTO TYPEVL
     C/COPY WNCPYSRC,LE0080C006
1074 C**
1075 C           NITMER    TAG                             ** NITMER TAG *
1076 C           S         ADD  1         S
1077 C                     MOVE ' 099'    ERCD,S
1078 C                     SETON                     50
1079 C**
     C/COPY WNCPYSRC,LE0080C007
1080 C           TYPEVL    TAG                             ** TYPEVL TAG *
     C/COPY WNCPYSRC,LE0080C038
1081 C**
1082 C**   VALIDATE TYPE - MUST BE G,S,C, DEFAULT G IF BLANK
1083 C**
1084 C                     SETOF                     31
     C/COPY WNCPYSRC,LE0080C011
1085 C   03                GOTO ENDVL                      CANNOT AMEND
     C/COPY WNCPYSRC,LE0080C012
1086 C   30                MOVE 'G'       TYPE
1087 C   30                GOTO GIVEVL
1088 C**
1089 C           TYPE      COMP 'G'                      30
1090 C           TYPE      COMP 'S'                      31
1091 C  N31      TYPE      COMP 'C'                      31
1092 C  N30N31   S         ADD  1         S
1093 C  N30N31             MOVE ' 100'    ERCD,S
1094 C  N30N31             SETON                     60
1095 C**
1096 C           GIVEVL    TAG                             ** GIVEVL TAG *
     C/COPY WNCPYSRC,LE0080C009
1097 C**
1098 C**   VALIDATE GIVER - MANDATORY , MUST BE VALID CLINT OR SHORTNAME
1099 C**   FOR TYPE 'G' MUST NOT BE SAME AS BORROWER. CANNOT AMEND
1100 C**
1101 C   59                GOTO GIVRE
1102 C**
1103 C**   CHECK NUMERIC USING ZALIGN SR.
1104 C**********           SETOF                     47                   BHF335
1105 C**********           MOVE BLANKS    ZFIELD                          BHF335
1106 C**********           MOVE GIVEA     ZFIELD                          BHF335
1107 C**********           Z-ADD10        ZADIG                           BHF335
1108 C**********           Z-ADD0         ZADEC                           BHF335
1109 C**********           EXSR ZALIGN                                    BHF335
1110 C***99*********       GOTO NUMNOT                                    S01194
1111 C**
1112 C***23*********                                                      S01194
1113 C*ORN80********        GOTO GIVRE                                    S01194
1112 C***23N99**                                                    S01194BHF335
1113 C*ORN80N99*            GOTO GIVRE                              S01194BHF335
1114 C**
1115 C                     MOVELGIVEA     GIVER
1116 C**************       MOVELGIVER     CLIKEY                          S01194
0697 C                     MOVEL*BLANKS   KEYC   10                       S01194
1116 C*********            MOVELGIVER     KEYC                      S01194BHF335
1116 C                     MOVELGIVEA     KEYC                            BHF335
1117 C                     EXSR CLINCH
1118 C  N10                GOTO GIVRE
     C           GIVEA     IFEQ '?'                                       189116
     C                     MOVE 'Y'       WSELT   1                       189116
     C                     ENDIF                                          189116
1140 C                     MOVE *BLANKS   GIVER                           S01194
1140 C                     MOVE BBCUST    GIVER                           S01194
1140 C                     MOVELGIVER     GIVEA                           189116
1119 C**
1120 C***30******GIVER     COMP GCUS                     47               CLE004
     C                     MOVE GCUS      GCUSK                           CLE004
1120 C   30      GIVER     COMP GCUSK                    47               CLE004
1121 C  N30
1122 COR 30N47             GOTO ENDVL
1123 C**
1124 C           GIVRE     TAG                             ** GIVRE TAG **
     C/COPY WNCPYSRC,LE0080C045
1125 C                     SETON                     59
1126 C           S         ADD  1         S
1127 C                     MOVE ' 034'    ERCD,S
1128 C   47                MOVE ' 268'    ERCD,S
1129 C                     GOTO ENDVL
1130 C**
1131 C***********NUMNOT    TAG                             ** NUMNOT TAG *S01194
1132 C**************                                                      S01194
1133 C*****MUST*BE*A SHORTNAME                                            S01194
1134 C**************       SETOF                     104447               S01194
1135 C***********GIVEA     CHAINSNAME                44                   S01194
1136 C**N10*********       SETON                     59                   S01194
1137 C**N10******S**       ADD  1         S                               S01194
1138 C**N10*********       MOVE ' 035'    ERCD,S                          S01194
1139 C**N10*********       GOTO ENDVL                                     S01194
1140 C**************       MOVE CNUMS     GIVER                           S01194
1141 C**************                                                      S01194
1142 C*****CHAIN*TO*CLINT FOR COUNTRY OF RISK                             S01194
1143 C**************                                                      S01194
1144 C**************       MOVELGIVER     CLIKEY                          S01194
1145 C**************       EXSR CLINCH                                    S01194
1146 C**************                                                      S01194
1147 C***30******GIVER     COMP GCUS                     47               S01194
1148 C**N30*********                                                      S01194
1149 C*OR*30N47*****        GOTO ENDVL                                    S01194
1150 C**************       SETON                     59                   S01194
1151 C***********S**       ADD  1         S                               S01194
1152 C**************       MOVE ' 035'    ERCD,S                          S01194
1153 C***47*********       MOVE ' 268'    ERCD,S                          S01194
1154 C**
1155 C           ENDVL     TAG                             ** ENDVL TAG **
1156 C**
1157 C**   IF ANY ERRORS OUTPUT ERROR SCREEN AND SET INDICATOR
1158 C**   TO PREVENT EXECUTION OF UDLOG SR.
1159 C**
1160 C           S         COMP 0                        42
1161 C   42                MOVE CCTZ      GCRSK   2
1162 C***42******          GOTO INSEND                                    CLE004
     C/COPY WNCPYSRC,LE0080C015
      *                                                                   CLE004
     C           *IN42     IFEQ '1'                                       CLE004
      *                                                                   CLE004
      ** Update file for Authorisation                                    CLE004
      *                                                                   CLE004
     C           *INKK     IFEQ '1'                                       CLE004
     C           ACTN      ANDEQ'X'                                       CLE004
     C********** BPAURV    ANDEQ'N'                                                    123857 197084
     C           BPAURV    ANDNE'Y'                                                           197084
     C           WSELT     ANDEQ'N'                                       189116
     C           ACTN      OREQ 'X'                                       123857
     C           BPAURV    ANDEQ'Y'                                       123857
     C           WSELT     ANDEQ'N'                                       189116
      *                                                                   CLE004
      *    /copy to move data into the data structure fields passed       CLE004
      *     as a parameter to the window controller                       CLE004
      /COPY WNCPYSRC,LE0080MOV1                                           CLE004
     C/COPY WNCPYSRC,LE0080C039
     C                     EXSR SRWIND                                    CLE004
      ** If F3 taken in window, exit program                              189116
     C           #RTRN     IFEQ 'Y2U9999'                                 189116
     C                     MOVE '1'       *INLR                           189116
     C                     RETRN                                          189116
     C                     ENDIF                                          189116
     C/COPY WNCPYSRC,LE0080C023
      ** If F12 taken in window, skip updates and redisplay screen        189116
     C           #RTRN     IFEQ 'USR0790'                                 189116
     C                     MOVE '0'       *IN42                           189116
     C                     ELSE                                           189116
     C                     MOVE 'A'       GSTSA   1                       CLE004
     C                     MOVELUSRID     XUSRA  10                       CLE004
     C                     EXSR UDLOG                                     CLE004
     C                     ENDIF                                          189116
     C/COPY WNCPYSRC,LE0080C024
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Update file for Insert                                           CLE004
      *                                                                   CLE004
     C           ACTN      IFEQ 'I'                                       CLE004
     C           WSELT     ANDEQ'N'                                       189116
      *                                                                   CLE004
      *    /copy to move data into the data structure fields passed       CLE004
      *     as a parameter to the window controller                       CLE004
      /COPY WNCPYSRC,LE0080MOV2                                           CLE004
     C                     EXSR SRWIND                                    CLE004
      ** If F3 taken in window, exit program                              189116
     C           #RTRN     IFEQ 'Y2U9999'                                 189116
     C                     MOVE '1'       *INLR                           189116
     C                     RETRN                                          189116
     C                     ENDIF                                          189116
     C/COPY WNCPYSRC,LE0080C032
      ** If F12 taken in window, skip updates and redisplay screen        189116
     C           #RTRN     IFEQ 'USR0790'                                 189116
     C                     MOVE '0'       *IN42                           189116
     C                     ELSE                                           189116
     C           BPGUAU    IFEQ 'Y'                                       CLE004
     C           CLE002    ANDEQ'Y'                                       155610
     C                     MOVE 'C'       GSTSA                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'A'       GSTSA                           CLE004
     C                     ENDIF                                          CLE004
     C                     MOVELUSRID     IUSRA  10                       CLE004
     C                     EXSR UDLOG                                     CLE004
     C                     ENDIF                                          189116
     C/COPY WNCPYSRC,LE0080C033
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Update file for Amend                                            CLE004
      *                                                                   CLE004
     C           ACTN      IFEQ 'A'                                       CLE004
     C           WSELT     ANDEQ'N'                                       189116
      *                                                                   CLE004
      *    /copy to move data into the data structure fields passed       CLE004
      *     as a parameter to the window controller                       CLE004
      /COPY WNCPYSRC,LE0080MOV2                                           CLE004
     C                     EXSR SRWIND                                    CLE004
      ** If F3 taken in window, exit program                              189116
     C           #RTRN     IFEQ 'Y2U9999'                                 189116
     C                     MOVE '1'       *INLR                           189116
     C                     RETRN                                          189116
     C                     ENDIF                                          189116
     C/COPY WNCPYSRC,LE0080C025
      ** If F12 taken in window, skip updates and redisplay screen        189116
     C           #RTRN     IFEQ 'USR0790'                                 189116
     C                     MOVE '0'       *IN42                           189116
     C                     ELSE                                           189116
     C           BPGUAU    IFEQ 'Y'                                       CLE004
     C           CLE002    ANDEQ'Y'                                       155610
     C           GSTS      IFNE 'C'                                       CLE004
     C                     MOVE 'R'       GSTSA                           CLE004
     C                     ENDIF                                          CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'A'       GSTSA                           CLE004
     C                     ENDIF                                          CLE004
     C                     MOVELUSRID     AUSRA  10                       CLE004
     C                     MOVEL*BLANK    XUSRA                           CLE004
     C                     EXSR UDLOG                                     CLE004
     C                     ENDIF                                          189116
     C/COPY WNCPYSRC,LE0080C026
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
     C                     ENDDO                                          CLE004
1163 C**
1164 C                     SETON                     417801
1165 C   03                SETON                     67
1166 C**
1167 C           INSEND    ENDSR                           ** INSEND ENDSR
1168 C*                                                                  *
1169 C*                                                                  *
1171 C********************************************************************
1172 C*                                                                  *
 173 C*    UDLOG SR. TO UPDATE FILES                                     *
1174 C*                                                                  *
1175 C*        ROUTINE CALLED FROM - MAIN PROCESSING
 176 C*        ROUTINE CALLS - GUARCH (2),DATCON,DBERR,FUPDER,QTIME (2)
 177 C*                        EXCEPT(5),GLZADD,GLZSUB,SFOUT
1179 C*
1180 C           UDLOG     BEGSR                           ** UDLOG BEGSR
     C**
     C**   FROM ERROR HANDLING SUBROUTINE RETURN TO EXIT POINT
     C**
     C           STATS1    IFEQ 01021
     C                     Z-ADD0         STATS1  50
     C                     GOTO INFTAG
     C                     END
     C**
     C           STATS2    IFEQ 01021
     C                     Z-ADD0         STATS2  50
     C                     GOTO INFTAG
     C                     END
     C**
1181 C**  CALCULATIONS TO UPDATE GUARANTEES FILE.
1182 C**  IF DATABASE OR SYSTEM ERROR IS FOUND INDICATORS ARE SET TO
1183 C**  REFLECT ERROR.FILES AND SCREEN ARE RELEASED TO END PROGRAM
1184 C**
1188 C**  CHECK STATUS OF RECORD UNCHANGED
     C                     MOVE GCUS      GCUSK                           CLE004
     C                     MOVE SEQR      SEQRK                           CLE004
1189 C                     EXSR GUARCH
1190 C   44                Z-ADD0         TNLU
1191 C           TNLU      COMP TNLUS                4747
     C           INFTAG    TAG                                ** INFTAG **
1192 C   47                EXSR DATCON
1193 C   47                EXSR DBERR
1194 C   47                EXSR FUPDER
1195 C**
1196 C   47                SETON                     01
1197 C   47                SETOF                     4043
1198 C   47                MOVE ERMSG,7   ERRMSG
1199 C   47                GOTO UDEND
     C**  OBTAIN LAST TRANSACTION NUMBER  AND SET UP STANDARD OUTPUT
     C**  INFORMATION
     C                     EXSR ZTNLU1
     C                     MOVE 'LE'      MDID    2
     C                     MOVEL'LE0080'  PGMN    8
     C                     MOVE WSID      WSIDX   3
     C                     MOVE USRID     USRIDX 10
1238 C**
1239 C**   CALCULATE TOTAL AMOUNT
1240 C**
1241 C           NAMT      MULT NITM      TAMTO  130
1242 C**
1243 C**   CHECK WHETHER TO OUTPUT TO GTREF
1244 C**
1245 C                     SETOF                     4415
1246 C   63                MOVELGBCN      GRKEY
     C                     MOVE GCUS      GCUSK                           CLE004
     C                     MOVE SEQR      SEQRK                           CLE004
1247 C**N62******GRKEY     CHAINGTREF                44                   CLE004
     C           *IN62     IFNE '1'                                       CLE004
     C           ACTN      ANDNE'X'                                       CLE004
1247 C           GRKEY     CHAINGTREF                44                   CLE004
     C                     ENDIF                                          CLE004
1248 C   61 44N19
1249 COR 62
1250 COR 63
1251 COR 61 19N15          GOTO GTOKAY
1252 C**
     C           ACTN      IFEQ 'X'                                       CLE004
     C                     GOTO GTOKAY                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
1253 C                     SETON                     36U7U8
1253 C                     SETON                     LR
1254 C                     MOVE 'GTREF'   DBFILE
1255 C                     MOVE '06'      DBASE            DBASE 06
1256 C                     MOVE GRKEY     DBKEY
1257 C                     GOTO UDEND
1258 C**
1259 C           GTOKAY    TAG                             ** GTOKAY TAG *
1260 C**
1261 C**   OUTPUT TO GTEES AND GTREF
1262 C                     SETON                     71
1263 C                     EXSR EXCEPT
      *                                                                   158892
     C           ACTN      IFEQ 'X'                                       158892
     C                     GOTO LOGTRX                                    158892
     C                     ENDIF                                          158892
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP8                                           S01408
      *                                                                   S01408
1264 C**
1265 C**   OBTAIN TRAILER DETAILS FOR UPDATE
1266 C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP1                                           S01408
     C*                                                                   S01408
1267 C                     MOVEL'99999999'GTKEY
1268 C                     MOVE '9999999' GTKEY
1269 C                     EXSR GUARCH
1270 C**
1271 C  N17                SETON                     U7U836
1271 C  N17                SETON                     LR
1272 C  N17                MOVE 'GTEES'   DBFILE
1273 C  N17                MOVE GTKEY     DBKEY
1274 C  N17                MOVE '05'      DBASE            DBASE 05
1275 C  N17                GOTO UDEND
1276 C**
1277 C                     Z-ADD0         ZZAMT
1278 C***62                GOTO UPDAMD                                    158892
1278 C   62N27             GOTO UPDAMD                                    158892
1279 C   61      NORE      ADD  1         NORE
1280 C***63      NORE      SUB  1         NORE                            158890
1280 C***63N27   NORE      SUB  1         NORE                    158890  158892
1280 C***63******NORE      SUB  1         NORE                    158892  165426
1281 C   61      NLRA      ADD  1         NLRA
1278 C   62 27   NLRA      ADD  1         NLRA                            158889
1282 C***63      NLRA      SUB  1         NLRA                            158890
1282 C   63N27   NLRA      SUB  1         NLRA                            158890
1283 C                     Z-ADDVLAF      ZZTOTI
1284 C                     Z-ADDVLAL      ZZTOTD
1285 C   61                MOVE NAMT      ZZAMT
1285 C   62 27             MOVE NAMT      ZZAMT                           158889
1286 C***63                MOVE UAMT      ZZAMT                           158890
1286 C   63N27             MOVE UAMT      ZZAMT                           158890
1287 C   61                EXSR GLZADD
1287 C   62 27             EXSR GLZADD                                    158889
1288 C***63                EXSR GLZSUB                                    158890
1288 C   63N27             EXSR GLZSUB                                    158890
1289 C**
1290 C                     Z-ADDZZTOTI    VLAF
1291 C                     Z-ADDZZTOTD    VLAL
1292 C**
1293 C***63                GOTO UPDEL                                    158890
1293 C   63N27             GOTO UPDEL                                    158890
1293 C   63 27             GOTO LOGTRA                                   158892
1294 C**  UPDATE NO. OF INSERTIONS ON TRAILER
1295 C           NINS      ADD  1         NINS
1296 C                     Z-ADDVRIF      ZZTOTI
1297 C                     Z-ADDVRIL      ZZTOTD
1298 C                     EXSR GLZADD
1299 C**
1300 C                     Z-ADDZZTOTI    VRIF
1301 C                     Z-ADDZZTOTD    VRIL
1302 C***61*****           GOTO LOGTRA                                    158889
1302 C   61                                                               158889
1302 COR 62 27             GOTO LOGTRA                                    158889
1303 C**  UPDATE DELETION CONTROLS
1304 C           UPDEL     TAG                             * UPDEL TAG
1305 C           NDEL      ADD  1         NDEL
1306 C**
1307 C                     Z-ADDVRDF      ZZTOTI
1308 C                     Z-ADDVRDL      ZZTOTD
1309 C                     EXSR GLZADD
1310 C**
1311 C                     Z-ADDZZTOTI    VRDF
1312 C                     Z-ADDZZTOTD    VRDL
1313 C**
1314 C                     GOTO LOGTRA
1315 C**  UPDATE AMENDMENT CONTROLS
1316 C**  ADD IF AMOUNT INCREASED , ELSE SUBTRACT
1317 C           UPDAMD    TAG                             * UPDAMD TAG
1319 C**
1320 C           NAMT      COMP UAMT                     99
1321 C   99                GOTO LOGTRA
1322 C**
1323 C           NAMT      SUB  UAMT      ZAMT   130
1324 C**
1325 C                     MOVE ZAMT      ZZAMT
1326 C                     Z-ADDVRAF      ZZTOTI
1327 C                     Z-ADDVRAL      ZZTOTD
1328 C                     EXSR GLZADD
1329 C**
1330 C                     Z-ADDZZTOTI    VRAF
1331 C                     Z-ADDZZTOTD    VRAL
1332 C**
1333 C**  UPDATE HASH AMOUNT OF LIVE RECORDS
1334 C                     Z-ADDVLAF      ZZTOTI
1335 C                     Z-ADDVLAL      ZZTOTD
1336 C                     EXSR GLZADD
1337 C**
1338 C                     Z-ADDZZTOTI    VLAF
1339 C                     Z-ADDZZTOTD    VLAL
1340 C**
1341 C           LOGTRA    TAG                             * LOGTRA TAG
1342 C**
1343 C                     SETON                     72
1344 C                     EXSR EXCEPT
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP2                                           S01408
     C*                                                                   S01408
1340 C**                                                                  158892
1341 C           LOGTRX    TAG                             * LOGTRX TAG   158892
1345 C**
     C**   END COMMITMENT CONTROL
     C                     MOVELSCN1      SCN1B                           CLE004
     C           CMTTXT    COMIT
     C**
1369 C***********          EXSR SFOUT                                     CLE004
 370 C*
1371 C           UDEND     ENDSR                           ** UDEND ENDSR
1372 C*                                                                  *
1374 C********************************************************************
1375 C*                                                                  *
1376 C*    SFOUT SR. TO OUTPUT INITIAL SCREEN.
1377 C*                                                                  *
1378 C*        ROUTINE CALLED FROM - MAIN PROCESSING,FIRST,UDLOG
1379 C*        ROUTINE CALLS - QTIME
1380 C*
1381 C           SFOUT     BEGSR                           ** SFOUT BEGSR
1382 C**
1383 C                     MOVE BLANKS    SCN1
1384 C                     MOVE BLANKS    SCN2
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CCP9                                           S01408
      *                                                                   S01408
1385 C***********          SETON                     406667               CLE004
1385 C                     SETOF                     6667                 CLE004
1386 C                     SETON                     424336
1387 C                     SETON                     37
1388 C                     SETOF                     414648
1389 C                     SETOF                     5053
1390 C                     SETOF                     545749
1391 C                     SETOF                     585945
1392 C                     SETOF                     6552
1392 C                     SETOF                     1213                 CLE004
     C                     MOVEA'0000'    *IN,82                          CLE004
1393 C**
1394 C                     EXSR QTIME
      *                                                                   CLE004
      ** Initialise screen fields                                         CLE004
      *                                                                   CLE004
     C                     EXSR SRINSL                                    CLE004
      *                                                                   120056
      *  If F9 from subfile screen pressed move I to action field         120056
      *  on initial screen                                                120056
      *                                                                   120056
     C           *INKI     IFEQ '1'                                       120056
     C                     MOVE 'I'       ACTN                            120056
     C                     ENDIF                                          120056
      *                                                                   CLE004
      ** Display initial screen                                           CLE004
      *                                                                   CLE004
     C                     WRITELE0080F0                                  CLE004
     C                     EXFMTLE0080F1                                  CLE004
     C                     EXSR SRINSI                                    CLE004
      *                                                                   CLE004
     C           *INKC     IFEQ '1'                                       CLE004
     C                     MOVE '1'       *INLR                           CLE004
     C                     RETRN                                          CLE004
     C                     ENDIF                                          CLE004
1395 C**
1396 C                     ENDSR
1397 C*                                                                  *
1399 C********************************************************************
1400 C*                                                                  *
1401 C*    GUARCH SR. TO CHAIN GTEES FILE
1402 C*                                                                  *
1403 C*        ROUTINE CALLED FROM - INSAMD,UDLOG
1404 C*
1405 C           GUARCH    BEGSR
1406 C**
1407 C                     SETOF                     161718
1408 C                     SETOF                     1944
     C                     MOVE 'N'       WKSQER                          168815
      *                                                                   168815
B01  C           ACTN      IFEQ 'I'                                       168815
     C           SEQRA     ANDEQ'   '                                     168815
     C                     MOVE 001       SEQRK                           168815
     C                     MOVE 'N'       W#EXIT  1                       168815
      *                                                                   168815
     C           GTKEY     CHAINGTEES                44                   168815
B02  C           W#EXIT    DOWNE'Y'                                       168815
B03  C           *IN44     IFEQ *ON                                       168815
     C                     MOVE 'Y'       W#EXIT                          168815
X03  C                     ELSE                                           168815
B04  C           SEQRK     IFNE 999                                       168815
     C                     ADD  1         SEQRK                           168815
     C           GTKEY     CHAINGTEES                44                   168815
X04  C                     ELSE                                           168815
     C                     MOVE 'Y'       W#EXIT                          168815
     C                     MOVE 'Y'       WKSQER  1                       168815
E04  C                     ENDIF                                          168815
E03  C                     ENDIF                                          168815
      *                                                                   168815
E02  C                     ENDDO                                          168815
      *                                                                   168815
     C                     MOVE *OFF      *IN16                           168815
     C                     MOVE '0'       *IN18                           182814
     C                     MOVE '0'       *IN19                           182814
     C                     MOVE SEQRK     SEQR                            168815
     C                     MOVE SEQRK     SEQRA                           168815
      *                                                                   168815
X01  C                     ELSE                                           168815
1409 C           GTKEY     CHAINGTEES                44
E01  C                     ENDIF                                          168815
1410 C**
1411 C                     ENDSR
1412 C*                                                                  *
1414 C********************************************************************
1415 C*                                                                  *
1416 C*   FUPDER SUBR. TO OUTPUT ERROR SCREEN WHEN RECORD HAS BEEN
1417 C*   UPDATED BY ANOTHER WORKSTATION
1418 C*
1419 C*        ROUTINE CALLED FROM - UDLOG
1420 C*
1421 C           FUPDER    BEGSR                           **  FUPDER  ***
1422 C**
1423 C           CHTP      COMP 'D'                      78
1424 C**
1425 C  N61                GOTO AMEND
1426 C**
1427 C**  FOR AN INSERT - RECORD HAS BEEN INSERTED,RECORD DETAILS DISPLAYE
1428 C**  PROTECTED , SF SCREEN OUTPUT
1429 C                     SETON                     666736
1430 C                     SETON                     3765
1431 C                     SETOF                     414648
1432 C                     GOTO ERREND
1433 C**
1434 C           AMEND     TAG                             * AMEND TAG
1435 C  N62N78             GOTO DELETE
1436 C**  ON AMEND - AMENDED - RECORD DETAILS DISPLAYED UNPROTECTED
1437 C**  KEY FIELDS NON-DISPLAY
1438 C   78                GOTO AMDEL
1439 C**  SAVE LAST UPDATE NO. FOR FURTHER ACTION
1440 C                     Z-ADDTNLU      TNLUS
1441 C**
1442 C                     SETON                     416567
1443 C                     GOTO ERREND
1444 C**
1445 C           AMDEL     TAG                             * AMDEL TAG
1446 C**  AMEND/DELETE - DELETED BLANK DETAILS DISPLAYED,SF SCREEN OUTPUT
1447 C                     SETOF                     654146
1448 C                     SETOF                     48
1449 C                     SETON                     666736
1450 C                     SETON                     37
1451 C                     MOVE BLANKS    SCN1
1452 C                     GOTO ERREND
1453 C**
1454 C           DELETE    TAG                             * DELETE TAG
1455 C**
1456 C**  DELETE -AMENDED - DISPLAY DETAILS PROTECTED-ALLOW FURTHER ACTION
1457 C                     Z-ADDTNLU      TNLUS
1458 C                     SETON                     656641
1459 C                     SETON                     6768
1460 C                     SETOF                     36
1461 C**
1462 C           ERREND    ENDSR                           * ERREND ENDSR
1463 C**
1465 C********************************************************************
1466 C*                                                                  *
1467 C*   CLINCH SUBR. TO RANDOM ACCESS CLITN FILE                       *
1468 C           CLINCH    BEGSR                           **  CLINCH   **
1469 C*                                                                  *
1470 C*        ROUTINE CALLED FROM - INIT,INSAMD
1471 C*
1472 C**
1473 C**************       SETOF                     4410                 S01194
1473 C                     SETOF                     10                   S01194
1474 C***********CLIKEY    CHAINCLINT                44                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C/COPY WNCPYSRC,LE0080C051
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     SETON                     10                   S01194
     C**********           MOVEL*BLANKS   GCUSA                     LN0057BHF335
     C**********           MOVELBBCUST    GCUSA                     S01194BHF335
     C                     END                                            S01194
1475 C**
1476 C                     ENDSR
1477 C**
1480 C********************************************************************
1481 C**************                                                     *S01194
1482 C****TABCHN*SUBR. TO RANDOM ACCESS TABLE FILE                       *S01194
1483 C***********TABCHN    BEGSR                           **  TABCHN   **S01194
1484 C**************                                                     *S01194
1485 C*********ROUTINE CALLED FROM - INSAMD,DATCON                        S01194
1486 C**************                                                      S01194
1487 C**************                                                      S01194
1488 C**************       SETOF                     1044                 S01194
1489 C***********TBKEY     CHAINTABLE                44                   S01194
1490 C**************                                                      S01194
1491 C**************       ENDSR                                          S01194
1492 C**************                                                      S01194
1494 C********************************************************************
1495 C*                                                                  *
1496 C*   DATCON SUBR. TO CONVERT FILE DATES TO DDMMYY FORMAT            *
1497 C           DATCON    BEGSR                           **  DATCON   **
1498 C*                                                                  *
1499 C*        ROUTINE CALLED FROM - INIT,UDLOG
1500 C*        ROUTINE CALLS - ZDATE2 (3),TABCHN
1501 C*
1502 C**
1503 C                     Z-ADDSTTD      ZDAYNO
1504 C                     EXSR ZDATE2
1505 C                     Z-ADDZDATE     STRD
1506 C**
1507 C                     Z-ADDEDDT      ZDAYNO
1508 C                     EXSR ZDATE2
1509 C                     Z-ADDZDATE     ENDAT
1510 C**
      * If Review date on file (RVDT) is zero (*IN33 on) then                                 199610
      * RVTD (and therefore RVDTA on screen) should also be blank.                            199610
     C   33                MOVE *BLANKS   RVDTA                                               199610
1511 C  N33                Z-ADDRVDT      ZDAYNO
1512 C  N33                EXSR ZDATE2
1513 C  N33                Z-ADDZDATE     RVTD
1514 C**
1515 C**  OBTAIN NO. OF DECIMAL PLACES TO EDIT AMOUNT FIELD
1516 C**************       MOVE BLANKS    TBKEY                           S01194
1517 C**************       MOVE '20'      TBKY1                           S01194
1518 C**************       MOVE CCY       TBKY2                           S01194
1519 C**************       MOVE '1'       TBKY3                           S01194
1520 C**************       EXSR TABCHN                                    S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM GCCY      K101    3                 S01194BHF335
     C                     PARM CCY       K101    3                    A  BHF335
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDCURRPD'DBFILE                          S01194
     C***********          MOVEL@OPTN     DBKEY            *********S01194BHF335
     C                     MOVELK101      DBKEY            ***************BHF335
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 008 *S01194
     C                     Z-ADD8         DBASE            ***************S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO DATEND                                    S01194
     C                     END                                            S01194
1521 C**
1522 C           CDP       COMP 1                      7475
1523 C           CDP       COMP 2                    77  76
1524 C**
1525 C**************       ENDSR                                          S01194
1525 C           DATEND    ENDSR                                          S01194
1526 C**
1544 C********************************************************************
1545 C*                                                                  *
1546 C*   QTIME SUBR. TO OBTAIN TIME                                     *
1547 C*                                                                  *
1548 C*        ROUTINE CALLED FROM - MAIN PROCESSING,UDLOG
1549 C*
1550 C           QTIME     BEGSR                           ** QTIME    ***
1551 C**
1552 C                     TIME           MTIME   60
1553 C**
1554 C                     ENDSR
1555 C**
1558 C********************************************************************
1559 C*                                                                  *
1560 C*   DBERR SUBR. TO RELEASE FILES IF ERROR CONDITION DETECTED       *
1561 C*                                                                  *
1562 C*        ROUTINE CALLED FROM - UDLOG
1563 C*        ROUTINE CALLS - EXCEPT
1564 C*
1565 C           DBERR     BEGSR                           **  DBERR    **
1566 C**
1567 C                     SETON                     69
1568 C                     EXSR EXCEPT
1569 C**
1570 C                     ENDSR
1572 C**
1573 C********************************************************************
1574 C*                                                                  *
1575 C*   EXCPTN SUBR. TO PERFORM EXCEPTION OUTPUT                       *
1576 C*                                                                  *
1577 C*        ROUTINE CALLED FROM - UDLOG,DBERR,INIT
1578 C*
1579 C           EXCEPT    BEGSR                           ** EXCEPT BEGSR
1580 C**
      *************************************************************S01241 CLE004
      ***********                                                  S01241 CLE004
      *****WINDOW PROCESSING                                       S01241 CLE004
      ***********                                                  S01241 CLE004
      *************************************************************S01241 CLE004
      ***********                                                  S01241 CLE004
     C***********BGL5ST    CABNE'Y'       NOWIND                    S01241S01251
     C***********BGWDPR    CABNE'Y'       NOWIND                   S01251 CLE004
     C************IN71     CABEQ'0'       NOWIND                   S01241 CLE004
     C***********          MOVEL'LE0080'  PROG                     S01241 CLE004
      ***********                                                  S01241 CLE004
     C***********@LOAN     IFEQ '000000'                           S01241 CLE004
     C***********@LOAN     OREQ *BLANKS                            S01241 CLE004
     C***********          MOVEL'F'       @LOAN                    S01241 CLE004
     C***********          MOVE @FCTLY    @LOAN                    S01241 CLE004
     C***********          END                                     S01241 CLE004
      ***********                                                   LUXRE CLE004
      *****/copy*to move data into the data structure fields passe S01241 CLE004
      ******as*a*parameter to the window controller                S01241 CLE004
      ***/COPY QWINDSRC,LE0080MOV2                                 S01241 CLE004
      ***********                                                  S01241 CLE004
     C***********          UNLCKLDA                                S01241 CLE004
     C***********          CALL 'WN0010'                           S01241 CLE004
     C***********          PARM           PROG   10                S01241 CLE004
     C***********          PARM *BLANK    KEY     2                S01241 CLE004
     C***********          PARM           @ACTN                    S01241 CLE004
      ***********                                                  S01408 CLE004
     C***/COPY WNCPYSRC,LE0080CCP3                                 S01408 CLE004
      ***********                                                  S01408 CLE004
     C***********          PARM           DATA                     S01241 CLE004
     C***********          PARM *BLANK    #RTRN                    S01241 CLE004
     C***********          PARM           SPARE                    S01252 CLE004
     C************LOCK     IN   LDA                                S01241 CLE004
     C***********                                                  S01241 CLE004
     C***********          Z-ADD1         ETAT                     S01241 CLE004
      ***Cmd12*pressed                                             S01241 CLE004
     C***********#RTRN*****IFEQ 'USR0790'                           S01241E22220
     C***********#RTRN     IFNE *BLANK                             E22220 CLE004
     C***********          CALL 'SNDERMSG'                         S01241 CLE004
     C***********          PARM 'LE0080'  ZAPGM  10        Program S01241 CLE004
     C***********          PARM           ZAPGRL  5        Rel queuS01241 CLE004
     C*********************PARM 'WND0001' ZAMSID  7        Msg.Id.  S01241E22220
     C***********          PARM #RTRN     ZAMSID  7        Msg Id. E22220 CLE004
     C*********************PARM 'MIDAS  ' ZAMSGF 10        Msg file.S01241E22220
     C***********          PARM 'WNMSGF'  ZAMSGF 10        Msg fileE22220 CLE004
     C***********          PARM           ZAMSDA132        Message S01241 CLE004
     C***********          PARM           ZAMSTP  7        Message S01241 CLE004
      **Clear*all fields                                           S01241 CLE004
     C***********          MOVEL*BLANK    ZAPGM            Program S01241 CLE004
     C***********          MOVEL*BLANK    ZAPGRL           Rel queuS01241 CLE004
     C***********          MOVEL*BLANK    ZAMSID           Message S01241 CLE004
     C***********          MOVEL*BLANK    ZAMSGF           Message S01241 CLE004
     C***********          MOVEL*BLANK    ZAMSDA           Message S01241 CLE004
     C***********          MOVEL*BLANK    ZAMSTP           Message S01241 CLE004
     C***********          GOTO FINEND                             S01241 CLE004
     C***********          END                                    S01241  CLE004
     C***********                                                  S01241 CLE004
     C***********NOWIND    TAG                                     S01241 CLE004
     C*                                                                   S01241
     C*****************************************************************   S01241
1581 C                     EXCPT
     C***********FINEND    TAG                                     S01241 CLE004
1582 C                     SETOF                     697172
1584 C**
1585 C                     ENDSR
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRWIND  -  Window Processing                                  *   CLE004
      * Called by:                                                    *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRWIND    BEGSR                                          CLE004
      * Pass current facility to LE0081                                                     BUG14745
     C                     MOVEL'F'       WWFCLN                                            BUG14745
     C                     MOVE FACIL     WWFCLN                                            BUG14745
      *                                                                   CLE004
     C           CER009    IFEQ 'Y'                                                           CER009
     C                     CALL 'LE0081'                                                      CER009
     C                     PARM ACTN      @ACTN                                               CER009
     C                     PARM           PDATA                                               CER009
     C                     PARM           #RTRN                                               CER009
     C                     ENDIF                                                              CER009
      *                                                                                       CER009
      ** Check for F3 keypress from LE0081                                                    CER009
      *                                                                                       CER009
     C           #RTRN     IFEQ 'Y2U9999'                                                     CER009
     C                     MOVE *ON       *INLR                                               CER009
     C                     RETRN                                                              CER009
     C                     ENDIF                                                              CER009
      *                                                                                       CER009
     C           BGWDPR    IFEQ 'Y'                                       CLE004
     C/COPY WNCPYSRC,LE0080C034
     C                     MOVEL'LE0080'  PROG                            CLE004
     C********** LOAN      IFEQ '000000'                                               CLE004 CLE148
     C********** LOAN      OREQ *BLANKS                                                CLE004 CLE148
     C**********           MOVEL'F'       WWFCLN  6                                    CLE004 CLE148
     C           LOAN      IFEQ *BLANKS                                                       CLE148
     C                     MOVEL' '       WWFCLN  6                                           CLE148
     C                     MOVE FACIL     WWFCLN                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     UNLCKLDA                                       CLE004
     C                     CALL 'WN0010'                                  CLE004
     C                     PARM           PROG   10                       CLE004
     C                     PARM *BLANK    KEY     2                       CLE004
     C                     PARM ACTN      @ACTN   1                       CLE004
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0080CCP3                                           CLE004
      *                                                                   CLE004
     C                     PARM           DATA                            CLE004
     C                     PARM *BLANK    #RTRN   7                       CLE004
     C                     PARM           SPARE 256                       CLE004
     C           *LOCK     IN   LDA                                       CLE004
     C*                                                                   CLE004
     C/COPY WNCPYSRC,LE0080C013
      *  Cmd12 pressed                                                    CLE004
     C           #RTRN     IFNE *BLANK                                    CLE004
     C/COPY WNCPYSRC,LE0080C027
     C                     CALL 'SNDERMSG'                                CLE004
     C                     PARM 'LE0080'  ZAPGM  10        Program queue  CLE004
     C                     PARM           ZAPGRL  5        Rel queue      CLE004
     C                     PARM #RTRN     ZAMSID  7        Msg Id.        CLE004
     C                     PARM 'WNMSGF'  ZAMSGF 10        Msg file.      CLE004
     C                     PARM           ZAMSDA132        Message data.  CLE004
     C                     PARM           ZAMSTP  7        Message type.  CLE004
      * Clear all fields                                                  CLE004
     C                     MOVEL*BLANK    ZAPGM            Program queue  CLE004
     C                     MOVEL*BLANK    ZAPGRL           Rel queue      CLE004
     C                     MOVEL*BLANK    ZAMSID           Message Id.    CLE004
     C                     MOVEL*BLANK    ZAMSGF           Message file.  CLE004
     C                     MOVEL*BLANK    ZAMSDA           Message data.  CLE004
     C                     MOVEL*BLANK    ZAMSTP           Message type.  CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0080C028
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
1586 C**
1671 C********************************************************************
1672 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
1673 C*   IND '99' IS SET BY AN OVERFLOW ERROR
1674 C*
1675 CSR         GLZADD    BEGSR                           *** GLZADD ****
1676 C*
1677 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
1678 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
1679 C*
1680 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
1681 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
1682 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
1683 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
1684 C*
1685 CSR                   EXSR GLZSUM
1686 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
1687 C*
1688 C********************************************************************
1689 C* SUBROUTINE TO SUBTRACT AN AMOUNT (ZZAMT) FROM THE TOTAL
1690 C*                                                   (ZZTOTI,ZZTOTD)
1691 C*  IND '99' IS SET BY AN OVERFLOW ERROR
1692 CSR         GLZSUB    BEGSR                           *** GLZSUB ****
1693 C* PROCESSING. JUST REVERSE THE 'SIGN' AND ADD
1694 CSR                   Z-SUBZZAMT     ZZAMT  153       REVERSE 'SIGN'
1695 CSR                   EXSR GLZADD                       AND 'ADD'
1696 CSR                   Z-SUBZZAMT     ZZAMT            RESTORE 'SIGN'
1697 CSR                   ENDSR
1699 C********************************************************************
1700 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
1701 C*                        GLZADD, GLZSUB, GLZCMP.
1702 C*          PARAMETERS PASSED -
1703 C*                     I/P ZZAMTI ZZAMTD
1704 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
1705 C*
1706 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
1707 C*
1708 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
1709 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
1710 CSR                   SETOF                     919293
1711 CSR                   SETOF                     949599
1712 C*
1713 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
1714 CSR         ZZAMTI    COMP 0                      9293
1715 CSR 93      ZZAMTD    COMP 0                      9293
1716 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1717 C*
1718 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
1719 CSR         ZZTOTI    COMP 0                      9193
1720 CSR 93      ZZTOTD    COMP 0                      9193
1721 C*
1722 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
1723 CSR 93                Z-ADDZZAMTI    ZZTOTI
1724 CSR 93                Z-ADDZZAMTD    ZZTOTD
1725 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1726 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
1727 CSR 91N92
1728 CORN91 92             GOTO ZZOFPS
1729 C*
1730 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
1731 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
1732 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
1733 C*
1734 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
1735 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
1736 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
1737 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1738 C*
1739 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1740 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1741 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1742 CSRN99                Z-ADDZZWK2     ZZTOTD
1743 CSRN99                Z-ADDZZWK3     ZZTOTI
1744 C*
1745 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1746 CSR 99                Z-ADD0         ZZAMT  153
1747 CSR                   GOTO ZZSEND
1748 C*
1749 C* THE 'SIGNS' ARE DIFFERENT
1750 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
1751 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1752 C*
1753 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
1754 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
1755 C*
1756 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1757 C*
1758 CSR 91                Z-SUBZZTOTI    ZZTOTI
1759 CSR 91                Z-SUBZZTOTD    ZZTOTD
1760 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1761 C*
1762 CSR         ZZTOTI    COMP ZZAMTI               93  95
1763 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
1764 C*
1765 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1766 CSR 95                Z-ADD0         ZZTOTI
1767 CSR 95                Z-ADD0         ZZTOTD
1768 CSR 95                GOTO ZZSEND
1769 C*
1770 C* IF ZZTOT GT. ZZAMT.
1771 CSR 93      ZZAMTD    COMP ZZTOTD               94
1772 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
1773 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
1774 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1775 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1776 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1778 C*
1779 C* IF ZZAMT GT. ZZTOT.
1780 CSRN93      ZZTOTD    COMP ZZAMTD               94
1781 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1782 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1783 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1784 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1785 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1786 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1787 C*
1788 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1789 CSR                   SETOF                     94
1790 CSR 93 91
1791 CORN93 92             SETON                     94
1792 CSR 94                Z-SUBZZTOTI    ZZTOTI
1793 CSR 94                Z-SUBZZTOTD    ZZTOTD
1794 C**
1795 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1796 CSR 92                Z-SUBZZAMTI    ZZAMTI
1797 CSR 92                Z-SUBZZAMTD    ZZAMTD
1798 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1799 C**
1800 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1801 CSR                   SETOF                     96
1802 CSR         ZZTOTD    COMP 0                        91
1803 CSR 91      ZZTOTI    COMP 0                      96
1804 CSR 96                MOVE '.000-'   ZZNEGD  5
1805 CSR                   ENDSR                             ** ENDSR **
1807 C**
     C/EJECT                                                              S01195
     C********************************************************************
2233 C*                                                                  *
2234 C*    FIRST SR. TO CARRY OUT FIRST CYCLE CALCS.                     *
2235 C*                                                                  *
2236 C*        ROUTINE CALLED FROM - MAIN PROCESSING
2237 C*
2238 C           FIRST     BEGSR                           ** FIRST BEGSR
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0080CP10                                           S01408
      *                                                                   S01408
     C                     MOVE *BLANKS   DBPGM                           S01194
     C                     MOVEL'LE0080'  DBPGM                           S01194
2239 C**************       EXSR ZSYSTM                                    S01194
2240 C***99*********       SETON                     U7U836               S01194
     C***99*********       SETON                     LR            E10963 S01194
2241 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
2242 C***99*********       MOVE ZTABKY    DBKEY                           S01194
2243 C***99*********       MOVE '01'      DBASE            * DBASE 01     S01194
     C***  DETERMINE IF WINDOW REQUIRED (BGWDPR IN SDMMODPD)              S01241
     C           1         SETLLSDMMODPD                                  E22220
     C                     READ SDMMODPD                 99               S01241
     C           *IN99     IFEQ '1'                                       S01241
     C                     SETON                     U7U8LR               S01241
     C                     SETON                     36    ************   S01241
     C                     MOVE '04'      DBASE            * DBASE 04 *   S01241
     C                     MOVEL'MMOD'    DBKEY            ************   S01241
     C                     MOVE 'SDMMOD'  DBFILE                          S01241
     C                     GOTO FEND                                      S01241
     C                     END                                            S01241
     C**                                                                  S01117
     C**  ACCESS GENERAL LEDGER DETAILS                                   S01117
     C**                                                                  S01117
     C**********           CALL 'AOGELRR0'                                S01117              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C**                                                                  S01117
     C**  ACCESS BANK DETAILS                                             S01117
     C**                                                                  S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*DBERR ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    DSFDY                           S01117
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01117
     C*                                                                   S01117
     C**  DEFINE DTAARA RUNDAT & ZMUSER                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C*                                                                   S01117
     C**    GET MBIN FROM DTAARA/RUNDAT                                   S01117
     C                     IN   RUNDT                                     S01117
     C*                                                                   S01117
     C**    GET USER'S DEFAULT BRANCH                                     S01117
     C                     IN   ZMUSER                                    S01117
2245 C**
2246 C**   SET UP FIELDS
2247 C**
2248 C                     Z-ADD0         ZERO13 130
2249 C                     Z-ADD0         ZERO5   50
2250 C                     MOVE ' '       BLANKS200
2251 C                     MOVE ' '       BLNK6   6
2252 C                     MOVE 'A'       A       1
2253 C                     MOVE 'A'       RCDT    1
2254 C                     MOVE 'A'       RCTP    1
2255 C**********           MOVE 'F'       F       1                                           CLE148
2256 C                     Z-ADD0         S       20
      *                                                                                       CER009
      ** Determine if PUMA II  Upgrade to MadisPlus feature                                   CER009
      ** is installed                                                                         CER009
      *                                                                                       CER009
     C                     CALL 'AOSARDR0'                                                    CER009
     C                     PARM *BLANKS   @RTCD                                               CER009
     C                     PARM '*KEY   ' @OPTN                                               CER009
     C                     PARM 'CER009'  PSARD                                               CER009
     C           SCSARD    PARM SCSARD    DSFDY                                               CER009
     C           @RTCD     IFEQ *BLANKS                                                       CER009
     C                     MOVE 'Y'       CER009  1                                           CER009
     C                     ELSE                                                               CER009
     C                     MOVE 'N'       CER009                                              CER009
     C           @RTCD     IFNE '*NRF    '                                                    CER009
     C                     MOVEL'SCSARDPD'DBFILE                                              CER009
     C                     Z-ADD900       DBASE                                               CER009
     C                     MOVEL'CER009'  DBKEY                                               CER009
     C                     EXSR *PSSR                                                         CER009
     C                     ENDIF                                                              CER009
     C                     ENDIF                                                              CER009
      *                                                                   CLE004
      ** Determine if Customer Lending Enhancements - Authorisation       CLE004
      ** feature is installed                                             CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*KEY   ' @OPTN                           CLE004
     C                     PARM 'CLE002'  PSARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE002  1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       CLE002                          CLE004
     C           @RTCD     IFNE '*NRF    '                                CLE004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE004
     C                     Z-ADD1         DBASE            * DBERR 01 *   CLE004
     C                     MOVEL'CLE002'  DBKEY            ************   CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE005
      ** Determine if Customer Lending Enhancements - Authorisation       CLE005
      ** feature is installed                                             CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY   ' @OPTN                           CLE005
     C                     PARM 'CLE005'  PSARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF    '                                CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     Z-ADD9         DBASE            * DBERR 09 *   CLE005
     C                     MOVEL'CLE005'  DBKEY            ************   CLE005
     C                     EXSR *PSSR                                     CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE056
      ** Check if Authorisation on Lending Transactions (CLE056) is on                        CLE056
      *                                                                                       CLE056
     C                     CALL 'AOSARDR0'                                                    CLE056
     C                     PARM *BLANKS   @RTCD                                               CLE056
     C                     PARM '*VERIFY' @OPTN                                               CLE056
     C                     PARM 'CLE056'  PSARD                                               CLE056
     C           @RTCD     IFEQ *BLANKS                                                       CLE056
     C                     MOVE 'Y'       CLE056  1                                           CLE056
     C                     ELSE                                                               CLE056
     C                     MOVE 'N'       CLE056                                              CLE056
     C           @RTCD     IFNE '*NRF    '                                                    CLE056
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CLE056
     C                     Z-ADD10        DBASE            * DBERR 10 *                       CLE056
     C                     MOVEL'CLE056'  DBKEY            ************                       CLE056
     C                     EXSR *PSSR                                                         CLE056
     C                     ENDIF                                                              CLE056
     C                     ENDIF                                                              CLE056
     C/COPY WNCPYSRC,LE0080C029
      *                                                                   CLE004
      ** Access Customer Lending ICD                                      CLE004
      *                                                                   CLE004
     C           CLE002    IFEQ 'Y'                                       CLE004
     C                     CALL 'AOCLNDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*FIRST ' @OPTN                           CLE004
     C********** SDCLND    PARM SDCLND    DSFDY                                        CLE004 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANK                                    CLE004
     C                     MOVEL'SDCLNDPD'DBFILE           ************   CLE004
     C                     Z-ADD2         DBASE            * DBERR 02 *   CLE004
     C                     MOVEL'*FIRST  'DBKEY            ************   CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Check if Authorisation of Guarantees is required                 CLE004
      *                                                                   CLE004
     C           BPGUAU    IFEQ 'Y'                                       CLE004
     C           CLE002    ANDEQ'Y'                                       155610
     C                     MOVE '1'       *IN14                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN14                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   123857
      ** Check if Authorisation of Guarantees is required                 123857
      *                                                                   123857
     C           BPAURV    IFEQ 'Y'                                       123857
     C                     MOVE '1'       *IN26                           123857
     C                     ELSE                                           123857
     C                     MOVE '0'       *IN26                           123857
     C                     ENDIF                                          123857
      *                                                                   CLE004
      ** Set up Key list                                                  CLE004
      *                                                                   CLE004
     C           KGKEY     KLIST                                          CLE004
     C**********           KFLD           WGCUST  60                                   CLE004 CSD027
     C                     KFLD           WGCUST  6                                           CSD027
     C                     KFLD           WGFCLN  6                       CLE004
     C                     KFLD           WGSEQN  30                      CLE004
      *                                                                   CLE004
2257 C           FEND      ENDSR                           ** FEND ENDSR *
2258 C*                                                                  *
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRINSL  -  Initialise all screen fields                       *   CLE004
      * Called by: SRFIRST                                            *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRINSL    BEGSR                                          CLE004
      *                                                                   CLE004
     C                     MOVE USRID     SUSER                           CLE004
     C                     MOVE BJMRDT    SRUNA                           CLE004
     C                     MOVELWSID      SWSID                           CLE004
      *                                                                   CLE004
     C                     MOVE *BLANK    ACTION                          CLE004
     C                     MOVE *BLANK    GCUS                            CLE004
     C                     MOVE *BLANK    LOAN                            CLE004
     C                     MOVE *BLANK    FACIL                           CLE004
     C                     MOVE *BLANK    SEQR                            CLE004
     C                     MOVE *BLANK    STRDA                           CLE004
     C                     MOVE *BLANK    ENDATA                          CLE004
     C                     MOVE *BLANK    RVDTA                           CLE004
     C                     MOVE *BLANK    RVFQ                            CLE004
     C                     MOVE *BLANK    DAYA                            CLE004
     C                     MOVE *BLANK    GCCY                            CLE004
     C                     MOVE *BLANK    UNAMT                           CLE004
     C                     MOVE *BLANK    NITMA                           CLE004
     C                     MOVE *BLANK    COLL                            CLE004
     C                     MOVE *BLANK    NARRS                           CLE004
     C                     MOVE *BLANK    GIVEA                           CLE004
     C                     MOVE *BLANK    TYPE                            CLE004
     C                     MOVE *BLANK    STATUS                          CLE004
     C                     MOVE *BLANK    ERCD                            CLE004
     C                     MOVE *BLANK    ERCDA                           CLE004
     C                     MOVE *BLANK    ERRMSG                          CLE004
      *                                                                   CLE004
     C                     MOVE *BLANK    GCUSA                           CLE004
     C                     MOVE *BLANK    FACILA                          CLE004
     C                     MOVE *BLANK    LOANA                           CLE004
     C                     MOVE *BLANK    SEQRA                           CLE004
     C                     MOVE *BLANK    ACTN                            CLE004
     C                     MOVE *BLANK    SRCUS                           CLE004
     C                     MOVE *BLANK    SRFOL                           CLE004
     C                     MOVE *BLANK    SRSEQ                           CLE004
     C                     MOVE 'N'       SRAUT                           CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      *                                                                   CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRDEL   -  Delete Processing                                  *   CLE004
      * Called by: Main                                               *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRDEL     BEGSR                                          CLE004
      *                                                                   CLE004
     C           *INKC     DOUEQ'1'                                       CLE004
     C           *INKL     OREQ '1'                                       CLE004
     C           *INKJ     OREQ '1'                                       CLE004
      *                                                                   CLE004
     C                     MOVEA'10'      *IN,12                          CLE004
     C                     MOVE '1'       *IN41                           CLE004
     C                     MOVEA'11'      *IN,66                          CLE004
     C                     EXFMTLE0080F2                                  CLE004
      *                                                                   CLE004
     C           *INKL     IFEQ '1'                                       120056
     C                     MOVE *OFF      *IN16                           120056
     C                     ENDIF                                          120056
      *                                                                   120056
     C           *INKJ     IFEQ '1'                                       CLE004
      *    /copy to move data into the data structure fields passed       CLE004
      *     as a parameter to the window controller                       CLE004
      /COPY WNCPYSRC,LE0080MOV1                                           CLE004
     C/COPY WNCPYSRC,LE0080C040
     C                     EXSR SRWIND                                    CLE004
     C/COPY WNCPYSRC,LE0080C019
     C                     MOVE 'D'       GSTSA                           CLE004
     C/COPY WNCPYSRC,LE0080C018
     C                     EXSR UDLOG                                     CLE004
     C/COPY WNCPYSRC,LE0080C020
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0080C016
     C                     ENDDO                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      *                                                                   CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRENQ   -  Enquire Processing                                 *   CLE004
      * Called by: Main                                               *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRENQ     BEGSR                                          CLE004
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0080C030
     C                     MOVE *OFF      *IN16                           120056
     C                     MOVE '00'      *IN,12                          CLE004
     C                     MOVE '1'       *IN41                           CLE004
     C                     MOVEA'11'      *IN,66                          CLE004
     C                     EXFMTLE0080F2                                  CLE004
     C/COPY WNCPYSRC,LE0080C017
      *                                                                   CLE004
      *    /copy to move data into the data structure fields passed       CLE004
      *     as a parameter to the window controller                       CLE004
      /COPY WNCPYSRC,LE0080MOV1                                           CLE004
     C/COPY WNCPYSRC,LE0080C041
     C                     EXSR SRWIND                                    CLE004
     C/COPY WNCPYSRC,LE0080C031
     C                     MOVE '0'       *IN18                           148902
     C                     MOVE '0'       *IN19                           184288
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      *                                                                   CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRINSI  -  Initialise intial screen fields indicators         *   CLE004
      * Called by:                                                    *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRINSI    BEGSR                                          CLE004
      *                                                                   CLE004
      /COPY WNCPYSRC,LE0080CCPG                                           CLE004
     C                     MOVEA'0'       *IN,41                          CLE004
     C                     MOVEA'11'      *IN,42                          CLE004
     C                     MOVEA'00'      *IN,45                          CLE004
     C                     MOVEA'00'      *IN,48                          CLE004
     C                     MOVEA'0'       *IN,52                          CLE004
     C                     MOVEA'0000'    *IN,82                          CLE004
      *                                                                   CLE004
     C           GCUSA     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN48                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN48                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           GCUSZ     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN24                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN24                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           GCUSL     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN79                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN79                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           FACILA    IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN25                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN25                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           LOANA     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN22                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN22                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           SEQRA     IFEQ *BLANK                                    CLE004
     C           ACTN      ANDNE'I'                                       168815
     C           SEQRA     OREQ *ZEROS                                    120022
     C           ACTN      ANDNE'I'                                       168815
     C                     MOVE '1'       *IN46                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN46                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           ACTN      IFEQ 'A'                                       CLE004
     C                     MOVE '1'       *IN03                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN03                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE *BLANK    ERCD                            CLE004
     C                     MOVE *BLANK    ERCDA                           CLE004
     C                     MOVE *BLANK    ERRMSG                          CLE004
     C                     Z-ADD0         S                               CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRINSD  -  Initialise detail screen fields indicators         *   CLE004
      * Called by:                                                    *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRINSD    BEGSR                                          CLE004
      *                                                                   CLE004
     C                     MOVEA'0'       *IN,40                          CLE004
     C                     MOVEA'11'      *IN,42                          CLE004
     C                     MOVEA'0'       *IN,35                          CLE004
     C                     MOVEA'0'       *IN,50                          CLE004
     C                     MOVEA'00'      *IN,59                          CLE004
     C                     MOVEA'000000'  *IN,53                          CLE004
      *                                                                   CLE004
     C           STRDA     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN53                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN53                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           ENDATA    IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN54                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN54                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           RVDTA     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN28                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN28                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           RVFQ      IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN29                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN29                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           DAYA      IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN32                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN32                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           GCCY      IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN57                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN57                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0080C042
     C           UNAMT     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN58                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN58                           CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0080C043
      *                                                                   CLE004
     C           NITMA     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN50                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN50                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           GIVEA     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN59                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN59                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           GIVEZ     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN23                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN23                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           GIVEL     IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN80                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN80                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           TYPE      IFEQ *BLANK                                    CLE004
     C                     MOVE '1'       *IN30                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN30                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE *BLANK    ERCD                            CLE004
     C                     MOVE *BLANK    ERCDA                           CLE004
     C                     MOVE *BLANK    ERRMSG                          CLE004
     C                     Z-ADD0         S                               CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRSUBF  -  Subfile Processing                                 *   CLE004
      * Called by: Main                                               *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRSUBF    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Initialise and clear subfile                                     CLE004
      *                                                                   CLE004
     C                     EXSR SRSINS                                    CLE004
     C                     EXSR SRSCLR                                    CLE004
      *                                                                   CLE004
      ** Set Review from ...  then load subfile                           CLE004
      *                                                                   CLE004
     C                     EXSR SRREVW                                    CLE004
     C                     EXSR SRLOAD                                    CLE004
      *                                                                   CLE004
     C           *INKC     DOUEQ'1'                                       CLE004
     C           *INKL     OREQ '1'                                       CLE004
     C                     WRITELE0080F0                                  CLE004
     C                     WRITELE0080F3                                  CLE004
     C                     EXFMTLE0080C0                                  CLE004
     C                     MOVE *BLANK    ERRMSG                          CLE004
     C                     MOVE '1'       *IN43                           CLE004
     C                     MOVEA'00'      *IN,12                          CLE004
     C                     MOVEA'0000'    *IN,82                          CLE004
      *                                                                   CLE004
     C                     SELEC                                          CLE004
     C           *INKC     WHEQ '1'                                       CLE004
     C           *INKL     WHEQ '1'                                       CLE004
      *                                                                   CLE004
      ** F5 pressed... initialise, clear and load subfile                 CLE004
      *                                                                   CLE004
     C           *INKE     WHEQ '1'                                       CLE004
     C                     EXSR SRSINS                                    CLE004
     C                     EXSR SRSCLR                                    CLE004
     C                     EXSR SRREVW                                    CLE004
     C                     EXSR SRLOAD                                    CLE004
      *                                                                   CLE004
      ** Rollup key pressed                                               CLE004
      *                                                                   CLE004
     C           *IN09     WHEQ '1'                                       CLE004
     C                     EXSR SRSINS                                    CLE004
     C                     EXSR SRLOAD                                    CLE004
      *                                                                   120056
      *  Insert key pressed, show initial screen and then process action  120056
      *                                                                   120056
     C           *INKI     WHEQ '1'                                       120056
     C                     EXSR SFOUT                                     120056
     C                     EXSR INIT                                      120056
      *                                                                   120056
     C           ACTN      IFNE *BLANK                                    120056
     C           GCUSA     ORNE *BLANK                                    120056
     C           LOANA     ORNE *BLANK                                    120056
     C           FACILA    ORNE *BLANK                                    120056
     C           SEQRA     ORNE *BLANK                                    120056
      *                                                                   120056
      * If Action is 'A', set on *IN03 as ACTN was still blank in SRINSI                      199662
     C           ACTN      IFEQ 'A'                                                           199662
     C                     MOVE '1'       *IN03                                               199662
     C                     ENDIF                                                              199662
      *                                                                                       199662
     C                     SELEC                                          120056
     C           ACTN      WHEQ 'A'                                       120056
     C           ACTN      OREQ 'I'                                       120056
     C           ACTN      OREQ 'X'                                       120056
     C                     EXSR INSAMD                                    120056
     C           ACTN      WHEQ 'E'                                       120056
     C                     EXSR SRENQ                                     120056
     C           ACTN      WHEQ 'D'                                       120056
     C                     EXSR SRDEL                                     120056
     C                     ENDSL                                          120056
     C                     ENDIF                                          120056
      *                                                                   120056
      *                                                                   CLE004
      ** Enter pressed to validate                                        CLE004
      *                                                                   CLE004
     C                     OTHER                                          CLE004
     C                     EXSR SRSVAL                                    CLE004
      *                                                                   CLE004
      ** Process subfile detail processing if no errors                   CLE004
      *                                                                   CLE004
     C           WFRST     IFEQ *BLANK                                    CLE004
     C                     EXSR SRPROC                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     Z-ADDWSRRN     SRRN                            CLE004
     C                     ENDSL                                          CLE004
     C                     ENDDO                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRSINS  -  Initialise Subfile fields                          *   CLE004
      * Called by: SRSUBF                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRSINS    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Initialise subfile                                               CLE004
      *                                                                   CLE004
     C                     MOVE *BLANKS   SACTN                           CLE004
     C                     MOVE *BLANKS   SCUST                           CLE004
     C                     MOVE *BLANKS   SFCLN                           CLE004
     C                     MOVE *BLANKS   SFCNO                           CLE004
     C                     MOVE *BLANKS   SLONO                           CLE004
     C                     MOVE *BLANKS   SSEQN                           CLE004
     C                     MOVE *BLANKS   SSTAT                           CLE004
     C                     MOVE *BLANKS   SGSTS                           CLE004
     C                     MOVE *BLANKS   SIUSR                           CLE004
     C                     MOVE *BLANKS   SAUSR                           CLE004
     C                     MOVE '0'       *IN08                           CLE004
     C                     MOVE '0'       *IN21                           CLE004
     C                     MOVEA'0000'    *IN,82                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRSCLR  -  Subfile Clear                                      *   CLE004
      * Called by: SRSUBF                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRSCLR    BEGSR                                          CLE004
      *                                                                   CLE004
     C                     MOVE '1'       *IN06                           CLE004
     C                     WRITELE0080C0                                  CLE004
     C                     MOVE '00'      *IN,06                          CLE004
      *                                                                   CLE004
     C                     Z-ADD1         SRRN    40                      CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRREVW  -  Set Loan no. from Review from                      *   CLE004
      * Called by: SRSUBF                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRREVW    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Set default value for Req. authorisation,                        CLE004
      ** and Review from field                                            CLE004
      *                                                                   CLE004
     C           SRAUT     IFEQ *BLANK                                    CLE004
     C                     MOVE 'N'       SRAUT                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           SRCUS     IFEQ *BLANK                                    CLE004
     C**********           Z-ADD0         WGCUST                                       CLE004 CSD027
     C                     MOVE *BLANKS   WGCUST                                              CSD027
     C                     ELSE                                           CLE004
     C                     MOVE SRCUS     WGCUST                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE SRFOL     WRFOLX  1                       CLE004
     C           SRFOL     IFEQ *BLANK                                    CLE004
     C                     MOVE *BLANK    WGFCLN                          CLE004
     C                     ELSE                                           CLE004
     C           WRFOLX    IFEQ *BLANK                                    CLE004
     C                     MOVELSRFOL     WFLD5                           CLE004
     C**********           MOVEL'F'       WGFCLN                                       CLE004 CLE148
     C                     MOVEL' '       WGFCLN                                              CLE148
     C                     MOVE WFLD5     WGFCLN                          CLE004
     C                     ELSE                                           CLE004
     C                     MOVE SRFOL     WGFCLN                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           SRSEQ     IFEQ *BLANK                                    CLE004
     C                     Z-ADD0         WGSEQN                          CLE004
     C                     ELSE                                           CLE004
     C                     MOVE SRSEQ     WGSEQN                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           SRAUT     IFEQ 'Y'                                       CLE004
     C           KGKEY     SETLLLEGTEEL1                                  CLE004
     C                     READ LEGTEEL1                 51               CLE004
     C                     ELSE                                           CLE004
     C           KGKEY     SETLLLEGTEEL0                                  CLE004
     C                     READ LEGTEEL0                 51               CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRLOAD  -  Load subfile records                               *   CLE004
      * Called by: SRSUBF                                             *   CLE004
      * Calls    :                                                    *   CLE004
      *****************************************************************   CLE004
     C           SRLOAD    BEGSR                                          CLE004
      *                                                                   CLE004
     C           *IN51     IFEQ '1'                                       CLE004
     C                     MOVE ERMSG,22  ERRMSG                          CLE004
     C                     MOVE '1'       *IN07                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     ELSE                                           CLE004
      *                                                                   CLE004
     C                     MOVE '0'       *IN07                           CLE004
     C                     Z-ADD1         WCTR    20                      CLE004
     C                     Z-ADDSRRN      SRECN                           CLE004
      *                                                                   CLE004
     C           *IN51     DOWEQ'0'                                       CLE004
     C           WCTR      ANDLE10                                        CLE004
      *                                                                   CLE004
     C                     EXSR SRSFMT                                    CLE004
     C                     WRITELE0080S0                                  CLE004
     C                     ADD  1         SRRN                            CLE004
     C                     ADD  1         WCTR                            CLE004
      *                                                                   CLE004
     C           SRAUT     IFEQ 'Y'                                       CLE004
     C                     READ LEGTEEL1                 51               CLE004
     C                     ELSE                                           CLE004
     C                     READ LEGTEEL0                 51               CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDDO                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN51     IFEQ '1'                                       CLE004
     C                     MOVE '1'       *IN08                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRSFMT  -  Format Subfile fields                              *   CLE004
      * Called by: SRLOAD                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRSFMT    BEGSR                                          CLE004
      *                                                                   CLE004
     C                     MOVE FCNUM     SCUST                           CLE004
      *                                                                   126274
      ** Access the Customer Details file for Shortname                   126274
      *                                                                   126274
     C                     CALL 'AOCUSTR0'                                126274
     C                     PARM '       ' @RTCD                           126274
     C                     PARM '*KEY   ' @OPTN                           126274
     C                     PARM SCUST     KEYC                            126274
     C                     PARM           KEYSTS                          126274
     C           SDCUST    PARM SDCUST    DSSDY                           126274
     C                     MOVE *BLANKS   SCSNM                           126274
     C           @RTCD     IFEQ *BLANKS                                   126274
     C                     MOVE BBCSSN    SCSNM                           126274
     C                     ELSE                                           126274
     C                     MOVE 'Unknown' SCSNM                           126274
     C                     ENDIF                                          126274
      *                                                                   126274
     C                     MOVELFFCLN     WFLD1   1                       CLE004
      *                                                                   CLE004
     C********** WFLD1     IFEQ 'F'                                                    CLE004 CLE148
     C           WFLD1     IFEQ ' '                                                           CLE148
     C                     MOVE 'F'       SFCLN                           CLE004
     C                     MOVE FFCLN     SFCNO                           CLE004
     C                     MOVE *BLANK    SLONO                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'L'       SFCLN                           CLE004
     C                     MOVE *BLANK    SFCNO                           CLE004
     C                     MOVELFFCLN     SLONO                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE FGUSN     SSEQN                           CLE004
     C                     MOVE FBRCA     SBRCA                           CLE004
     C                     MOVE FGSTS     SGSTS                           CLE004
     C                     MOVE FIUSR     SIUSR                           CLE004
     C                     MOVE FAUSR     SAUSR                           CLE004
      *                                                                   CLE004
     C                     SELEC                                          CLE004
     C           FGSTS     WHEQ 'C'                                       CLE004
     C                     MOVELSTAT,1    SSTAT                           CLE004
     C           FGSTS     WHEQ 'R'                                       CLE004
     C                     MOVELSTAT,2    SSTAT                           CLE004
     C           FGSTS     WHEQ 'A'                                       CLE004
     C                     MOVELSTAT,3    SSTAT                           CLE004
     C                     ENDSL                                          CLE004
     C           RECI      IFEQ 'E'                                       158893
     C                     MOVELSTAT,5    SSTAT                           158893
     C                     END                                            158893
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRSVAL  -  Subfile Validation                                 *   CLE004
      * Called by: SRSUBF                                             *   CLE004
      * Calls    :                                                    *   CLE004
      *****************************************************************   CLE004
     C           SRSVAL    BEGSR                                          CLE004
      *                                                                   CLE004
     C                     MOVE *BLANK    WFRST   1                       CLE004
     C                     Z-ADDSRRN      WSRRN   40                      CLE004
      *                                                                   CLE004
      ** Read changed records in subfile                                  CLE004
      *                                                                   CLE004
     C           *IN07     IFEQ '0'                                       CLE004
     C                     READCLE0080S0                 89               CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '1'       *IN89                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN89     DOWEQ'0'                                       CLE004
     C                     MOVE '0'       *IN20                           CLE004
     C                     MOVE '0'       *IN21                           CLE004
      *                                                                   CLE004
     C           SACTN     IFNE *BLANK                                    CLE004
     C                     MOVE '1'       *IN20                           CLE004
      *                                                                   CLE004
      ** Valid actions are E, A, D, and X for unauthorise loan and        CLE004
      *  authorisation is allowed                                         CLE004
      *                                                                   CLE004
     C           SACTN     IFNE 'E'                                       CLE004
     C           SACTN     ANDNE'A'                                       CLE004
     C           SACTN     ANDNE'D'                                       CLE004
     C           SACTN     ANDNE'X'                                       CLE004
     C           SACTN     OREQ 'X'                                       CLE004
     C           SGSTS     ANDEQ'A'                                       CLE004
     C           SACTN     OREQ 'X'                                       CLE004
     C           *IN14     ANDEQ'0'                                       CLE004
     C           ERRMSG    IFEQ *BLANK                                    CLE004
     C                     MOVE ERMSG,1   ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     MOVE '1'       *IN21                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Check user/action/branch authority                               CLE004
      *                                                                   CLE004
     C           *IN21     IFEQ '0'                                       CLE004
     C                     EXSR SRUAUT                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Check authorisation action if action is allowed                  CLE004
      *                                                                   CLE004
     C           SACTN     IFEQ 'X'                                       CLE004
     C           *IN14     ANDEQ'1'                                       CLE004
     C           *IN21     ANDEQ'0'                                       CLE004
     C                     EXSR SRAUTH                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                                     MD031285
      ** Expired records not allowed to amend                                               MD031285
      *                                                                                     MD031285
     C           SACTN     IFEQ 'A'                                                         MD031285
     C           SSTAT     ANDEQ'EXPIRED'                                                   MD031285
     C           ERRMSG    IFEQ *BLANK                                                      MD031285
     C                     MOVE '1'       *IN21                                             MD031285
     C                     MOVE '0'       *IN43                                             MD031285
     C                     MOVE ERMSG,27  ERRMSG                                            MD031285
     C                     ENDIF                                                            MD031285
     C                     ENDIF                                                            MD031285
      *                                                                   CLE004
      ** Save rel. record no. of first record in error                    CLE004
      *                                                                   CLE004
     C           WFRST     IFEQ *BLANK                                    CLE004
     C           *IN21     ANDEQ'1'                                       CLE004
     C                     Z-ADDSRRN      SRECN                           CLE004
     C                     MOVE 'Y'       WFRST                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     UPDATLE0080S0                                  CLE004
     C                     READCLE0080S0                 89               CLE004
     C                     ENDDO                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRPROC  -  Subfile Detail Processing                          *   CLE004
      * Called by: SRSUBF                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRPROC    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Read changed records in subfile and process according            CLE004
      ** to actions                                                       CLE004
      *                                                                   CLE004
     C           *IN07     IFEQ '0'                                       CLE004
     C                     READCLE0080S0                 89               CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '1'       *IN89                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN89     DOWEQ'0'                                       CLE004
     C           *INKL     ANDEQ'0'                                       CLE004
      *                                                                   CLE004
     C                     EXSR SRSSET                                    CLE004
      *                                                                   CLE004
     C                     SELEC                                          CLE004
     C           SACTN     WHEQ 'A'                                       CLE004
     C                     EXSR INSAMD                                    CLE004
     C           SACTN     WHEQ 'E'                                       CLE004
     C                     EXSR SRENQ                                     CLE004
     C           SACTN     WHEQ 'D'                                       CLE004
     C                     EXSR SRDEL                                     CLE004
     C           SACTN     WHEQ 'X'                                       CLE004
     C                     EXSR INSAMD                                    CLE004
     C                     ENDSL                                          CLE004
      *                                                                   CLE004
     C                     MOVE *BLANK    SACTN                           CLE004
     C                     UPDATLE0080S0                                  CLE004
      *                                                                   CLE004
     C           *INKL     IFEQ '0'                                       CLE004
     C                     READCLE0080S0                 89               CLE004
     C                     ENDIF                                          CLE004
     C                     ENDDO                                          CLE004
      *                                                                   CLE004
      ** If F12 pressed in Detail, reset F12 indicator to avoid           CLE004
      ** exiting subfile display                                          CLE004
      *                                                                   CLE004
     C           *INKL     IFEQ '1'                                       CLE004
     C                     MOVE '0'       *INKL                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Reload subfile if no more changed record to read                 CLE004
      *                                                                   CLE004
     C           *IN89     IFEQ '1'                                       CLE004
      *                                                                   CLE004
      ** Validate Unauthorised Only field                                 CLE004
      *                                                                   CLE004
     C           SRAUT     IFNE *BLANK                                    CLE004
     C           SRAUT     ANDNE'Y'                                       CLE004
     C           SRAUT     ANDNE'N'                                       CLE004
     C                     MOVE '1'       *IN85                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,18  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           SRAUT     IFEQ *BLANK                                    CLE004
     C                     MOVE 'N'       SRAUT                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Validate Review Sequence no. field                               CLE004
      *                                                                   CLE004
     C                     MOVELSRSEQ     WNUM3   30                      CLE004
     C                     MOVE WNUM3     WFLD3   3                       CLE004
     C           SRSEQ     IFNE WFLD3                                     CLE004
     C           SRSEQ     ANDNE*BLANK                                    CLE004
     C                     MOVE '1'       *IN84                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,17  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Validate Review facility/loan field                              CLE004
      *                                                                   CLE004
     C                     MOVELSRFOL     WNUM6                           CLE004
     C                     MOVE WNUM6     WFLD6                           CLE004
     C           SRFOL     IFNE WFLD6                                     CLE004
     C           SRFOL     ANDNE*BLANK                                    CLE004
      *                                                                   CLE004
     C                     MOVE SRFOL     WRFOLX  1                       CLE004
     C           WRFOLX    IFNE *BLANK                                    CLE004
     C                     MOVE '1'       *IN83                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,16  ERRMSG                          CLE004
     C                     ELSE                                           CLE004
     C                     MOVELSRFOL     WNUM5   50                      CLE004
     C                     MOVE WNUM5     WFLD5   5                       CLE004
     C           SRFOL     IFNE WFLD5                                     CLE004
     C           SRFOL     ANDNE*BLANK                                    CLE004
     C                     MOVE '1'       *IN83                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C                     MOVE ERMSG,16  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ***Validate*Review*customer*field*                                               CLE004 CSD027
      **********                                                                       CLE004 CSD027
     C**********           MOVELSRCUS     WNUM6   60                                   CLE004 CSD027
     C**********           MOVE WNUM6     WFLD6   6                                    CLE004 CSD027
     C********** SRCUS     IFNE WFLD6                                                  CLE004 CSD027
     C********** SRCUS     ANDNE*BLANK                                                 CLE004 CSD027
     C**********           MOVE '1'       *IN82                                        CLE004 CSD027
     C**********           MOVE '0'       *IN43                                        CLE004 CSD027
     C**********           MOVE ERMSG,15  ERRMSG                                       CLE004 CSD027
     C**********           ENDIF                                                       CLE004 CSD027
      *                                                                   CLE004
      ** Initialise  and clear subfile for reload                         CLE004
      *                                                                   CLE004
     C           *IN43     IFEQ '1'                                       CLE004
     C                     EXSR SRSINS                                    CLE004
     C                     EXSR SRSCLR                                    CLE004
     C                     EXSR SRREVW                                    CLE004
     C                     EXSR SRLOAD                                    CLE004
     C                     Z-ADDSRRN      WSRRN                           CLE004
     C                     Z-ADD1         SRECN                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRSSET  -  Setup other fields for Detail Processing           *   CLE004
      * Called by: SRPROC                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRSSET    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Retrieve record from GTEES file                                  CLE004
      *                                                                   CLE004
     C                     MOVE SCUST     GCUSK                           CLE004
     C/COPY WNCPYSRC,LE0080C049
     C           SFCLN     IFEQ 'F'                                       CLE004
     C**********           MOVEL'F'       FCLNA                                        CLE004 CLE148
     C                     MOVEL' '       FCLNA                                               CLE148
     C                     MOVE SFCNO     FCLNA                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE SLONO     FCLNA                           CLE004
     C                     ENDIF                                          CLE004
     C                     MOVE SSEQN     SEQRK                           CLE004
     C                     EXSR GUARCH                                    CLE004
     C           *IN18     IFEQ '1'                                       158892
     C                     SETON                     27                   158892
     C                     ELSE                                           158892
     C                     SETOF                     27                   158892
     C                     END                                            158892
      *                                                                   158892
     C                     Z-ADDTNLU      TNLUS                           CLE004
      *                                                                   CLE004
      ** Release record in file GTEES                                     CLE004
      *                                                                   CLE004
     C                     MOVE '1'       *IN69                           CLE004
     C                     EXSR EXCEPT                                    CLE004
      *                                                                   CLE004
      ** Initialise indicators                                            CLE004
      *                                                                   CLE004
     C                     MOVEA'0'       *IN,40                          CLE004
     C                     MOVEA'11'      *IN,42                          CLE004
     C                     MOVEA'0'       *IN,35                          CLE004
     C                     MOVEA'0'       *IN,50                          CLE004
     C                     MOVEA'00'      *IN,59                          CLE004
     C                     MOVEA'000000'  *IN,53                          CLE004
     C                     MOVEA'0000'    *IN,61                          CLE004
     C                     MOVE '1'       *IN65                           CLE004
     C                     MOVE '1'       *IN67                           CLE004
      *                                                                   CLE004
     C                     SELEC                                          CLE004
     C           SACTN     WHEQ 'A'                                       CLE004
     C                     MOVE '1'       *IN62                           CLE004
     C           SACTN     WHEQ 'D'                                       CLE004
     C                     MOVE '1'       *IN63                           CLE004
     C           SACTN     WHEQ 'E'                                       CLE004
     C                     MOVE '1'       *IN64                           CLE004
     C                     ENDSL                                          CLE004
      *                                                                   CLE004
     C           SACTN     IFEQ 'A'                                       CLE004
     C                     MOVE '0'       *IN66                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Move key fields to screen fields                                 CLE004
      *                                                                   CLE004
     C                     MOVE SACTN     ACTN                            CLE004
     C           ACTN      IFEQ 'X'                                       158891
     C           ORED      IFEQ BJRDNB                                    158891
     C                     MOVE 'I'       ACTNO                           158891
     C                     ELSE                                           158891
     C                     MOVE 'A'       ACTNO                           158891
     C                     END                                            158891
     C                     ELSE                                           158891
     C                     MOVE SACTN     ACTNO                           CLE004
     C                     END                                            158891
     C                     MOVE SLONO     LOANA                           CLE004
     C                     MOVE SFCNO     FACILA                          CLE004
     C                     MOVE SCUST     GCUS                            CLE004
     C                     MOVE SSEQN     SEQR                            CLE004
      *                                                                   CLE004
     C                     EXSR DATCON                                    CLE004
     C                     EXSR SRDSP                                     CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRAUTH  -  Validate authorisation action                      *   CLE004
      * Called by: SRSVAL                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRAUTH    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Authorising user must be different from the insert and           CLE004
      ** amend users                                                      CLE004
      ***  Unless CLE056 is enabled and not day of input and not last amender                 CLE056
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0080C052
     C           USRID     IFEQ SIUSR                                     CLE004
     C           CLE056    IFEQ 'N'                                                           CLE056
     C           CLE056    OREQ 'Y'                                                           CLE056
     C           ORED      ANDEQBJRDNB                                                        CLE056
     C           USRID     ANDEQSIUSR                                                         CLE056
     C                     MOVE '1'       *IN21                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C           ERRMSG    IFEQ *BLANK                                    CLE004
     C                     MOVE ERMSG,19  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                                              CLE056
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           USRID     IFEQ SAUSR                                     CLE004
     C           *IN21     ANDEQ'0'                                       CLE004
     C           CLE056    IFEQ 'N'                                                           CLE056
     C           CLE056    OREQ 'Y'                                                           CLE056
     C           LCD       ANDEQBJRDNB                                                        CLE056
     C           CHTP      ANDEQ'A'                                                           CLE056
     C           USRID     ANDEQSAUSR                                                         CLE056
     C                     MOVE '1'       *IN21                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C           ERRMSG    IFEQ *BLANK                                    CLE004
     C                     MOVE ERMSG,20  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                                              CLE056
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0080C053
      *                                                                   CLE004
      ** Status of loan must be complete or requiring re-authori-         CLE004
      ** sation                                                           CLE004
      *                                                                   CLE004
     C           SGSTS     IFNE 'C'                                       CLE004
     C           SGSTS     ANDNE'R'                                       CLE004
     C           *IN21     ANDEQ'0'                                       CLE004
     C                     MOVE '1'       *IN21                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C           ERRMSG    IFEQ *BLANK                                    CLE004
     C                     MOVE ERMSG,21  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRUAUT  -  Check if user is authorised to the action          *   CLE004
      * Called by: SRSVAL                                             *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRUAUT    BEGSR                                          CLE004
      *                                                                   CLE004
      ** For single branch system, check if user is authorised to the     CLE004
      ** action                                                           CLE004
      *                                                                   CLE004
     C                     Z-ADD0         @ERR                            CLE004
     C           MBIN      IFEQ 'N'                                       CLE004
     C                     CALL 'ZVACTU'                                  CLE004
     C                     PARM SACTN     @ZACTN                          CLE004
     C                     PARM           @ERR                            CLE004
     C           @ERR      IFNE 0                                         CLE004
     C                     MOVE '1'       *IN21                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C           ERRMSG    IFEQ *BLANK                                    CLE004
     C                     MOVE ERMSG,12  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** For multibranching system, and action codes A/E/D/X, branch code CLE004
      ** on loans file must be valid for user                             CLE004
      *                                                                   CLE004
     C           *IN21     IFEQ '0'                                       CLE004
     C           MBIN      ANDEQ'Y'                                       CLE004
     C                     CALL 'ZVACTBU'                                 CLE004
     C                     PARM SACTN     @ZACTN  1                       CLE004
     C                     PARM SBRCA     @ZBR    3                       CLE004
     C                     PARM           @ERR    10                      CLE004
     C           @ERR      IFEQ 1                                         CLE004
     C                     MOVE '1'       *IN21                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C           ERRMSG    IFEQ *BLANK                                    CLE004
     C                     MOVE ERMSG,10  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C           @ERR      IFEQ 2                                         CLE004
     C                     MOVE '1'       *IN21                           CLE004
     C                     MOVE '0'       *IN43                           CLE004
     C           ERRMSG    IFEQ *BLANK                                    CLE004
     C                     MOVE ERMSG,11  ERRMSG                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRDSP   -  Display screen fields from file file fields        *   CLE004
      * Called by: INIT                                               *   CLE004
      * Calls    : None                                               *   CLE004
      *****************************************************************   CLE004
     C           SRDSP     BEGSR                                          CLE004
      *                                                                   CLE004
     C                     MOVE ACTN      ACTION                          CLE004
     C                     MOVE LOANA     LOAN                            CLE004
     C                     MOVE FACILA    FACIL                           CLE004
     C                     MOVE RVFR      RVFQ                            CLE004
     C           RVDY      IFEQ 0                                         CLE004
     C                     MOVE *BLANK    DAYA                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE RVDY      DAYA                            CLE004
     C                     ENDIF                                          CLE004
     C                     MOVE CCY       GCCY                            CLE004
     C                     MOVE *BLANK    ZFIELD                          CLE004
     C                     MOVE UAMT      ZFIELD                          CLE004
     C                     MOVE CDP       ZADEC                           CLE004
     C                     EXSR ZEDIT                                     CLE004
     C                     MOVE ZFIELD    UNAMT                           CLE004
     C                     MOVE *BLANK    ZFIELD                          CLE004
     C                     MOVE NOUN      ZFIELD                          CLE004
     C                     Z-ADD0         ZADEC                           CLE004
     C                     EXSR ZEDIT                                     CLE004
     C                     MOVE ZFIELD    NITMA                           CLE004
     C                     MOVE COLC      COLL                            CLE004
     C                     MOVE NARR      NARRS                           CLE004
     C                     MOVELGBCN      GIVEA                           CLE004
     C                     MOVE GSCI      TYPE                            CLE004
      *                                                                   CLE004
      ** Display status of guaratees                                      CLE004
      *                                                                   CLE004
     C           ACTN      IFEQ 'I'                                       CLE004
     C                     MOVE *BLANK    STATUS                          CLE004
     C                     ELSE                                           CLE004
     C                     SELEC                                          CLE004
     C           RECI      WHEQ 'E'                                                         MD031285
     C                     MOVELSTAT,5    STATUS                                            MD031285
     C           GSTS      WHEQ 'C'                                       CLE004
     C                     MOVELSTAT,1    STATUS                          CLE004
     C           GSTS      WHEQ 'R'                                       CLE004
     C                     MOVELSTAT,2    STATUS                          CLE004
     C           GSTS      WHEQ 'A'                                       CLE004
     C                     MOVELSTAT,3    STATUS                          CLE004
     C           GSTS      WHEQ 'D'                                       CLE004
     C                     MOVELSTAT,4    STATUS                          CLE004
     C                     ENDSL                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVELGSTS      GSTSA                           CLE004
     C                     MOVELIUSR      IUSRA                           CLE004
     C                     MOVELAUSR      AUSRA                           CLE004
     C                     MOVELXUSR      XUSRA                           CLE004
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
2260 C********************************************************************
2261 C**
2262 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
2263 C**
2264 C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
2265 C**************                                                      S01194
2266 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
2267 C**************       MOVEL'01      'ZTABKY 12                       S01194
2268 C**************       MOVE '  10'    ZTABKY                          S01194
2269 C**************                                                      S01194
2270 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
2271 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
2272 C************
2273 C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
2274 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON
2275 C***********
2276 C**************       ENDSR                                          S01194
2277 C**
2279 C********************************************************************
     C**   FILE EXCEPTION / ERROR HANDLING SUBROUTINE
     C           INFSR     BEGSR
     C**   CHECK ERROR TYPE
     C           STATS1    IFEQ 01021
     C**   CHAIN FILE TO GET CURRENT DETAILS
     C           GTKEY     CHAINGTEES                44
     C**
     C           *IN44     IFEQ '0'
     C**   ROLLBACK UPDATES ALREADY DONE
     C                     ROLBK
     C**   SET ON 'RECORD UPDATED BY ANOTHER WORKSTATION' INDICATOR
     C                     SETON                     47
     C**   RESET OTHER INDICATORS
     C                     SETOF                     697172
     C**
     C                     MOVE '*DETC '  EXTTAG  6
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ELSE
     C**
     C**   CHECK ERROR TYPE
     C           STATS2    IFEQ 01021
     C**   CHAIN FILE TO GET CURRENT DETAILS
     C                     MOVE GCUS      GCUSK                           CLE004
     C                     MOVE SEQR      SEQRK                           CLE004
     C           GRKEY     CHAINGTREF                44
     C**
     C           *IN44     IFEQ '0'
     C**   ROLLBACK UPDATES ALREADY DONE
     C                     ROLBK
     C**   SET ON 'RECORD UPDATED BY ANOTHER WORKSTATION' INDICATOR
     C                     SETON                     47
     C**   RESET OTHER INDICATORS
     C                     SETOF                     697172
     C**
     C                     MOVE '*DETC '  EXTTAG  6
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     END
     C**
     C                     ENDSREXTTAG
     C**************************************************************************
     C**                                                                  S01117
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01117
     C**                                                                  S01117
     C           *PSSR     BEGSR                                          S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
 671 C********************************************************************
     C/EJECT                                                              S01195
     C/COPY ZSRSRC,ZFREQBZ2                                               S01392
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/COPY ZSRSRC,ZCHKH                                                  S01195
     C/COPY ZSRSRC,ZDATE1Z2                                               S01392
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C/COPY ZSRSRC,ZALIGNZ2                                               S01392
     C/COPY ZSRSRC,ZTNLU1Z2                                               S01392
     C/COPY ZSRSRC,ZEDITZ2                                                CLE004
     C**************************************************************************
2280 O**********                                                          CLE004
2281 O****WORKSTATION OUTPUT                                              CLE004
2282 O**********                                                          CLE004
2283 O***LE0080FMD        01N36                                           CLE004
2284 O*******OR        02N36                                              CLE004
2285 O*******OR        03N36                                              CLE004
2286 O*******OR        04N36                                              CLE004
2287 O*******OR        37                                                 CLE004
2288 O**********                         K8 'LE0080F1'                    CLE004
     O**********               *IN68      1                               CLE004
     O**********               *IN40      2                               CLE004
     O**********               *IN53      3                               CLE004
     O**********               *IN66      4                               CLE004
     O**********               *IN41      5                               CLE004
     O**********               *IN54      6                               CLE004
     O**********               *IN55      7                               CLE004
     O**********               *IN56      8                               CLE004
     O**********               *IN35      9                               CLE004
     O**********               *IN57     10                               CLE004
     O**********               *IN58     11                               CLE004
     O**********               *IN50     12                               CLE004
     O**********               *IN59     13                               CLE004
     O**********               *IN67     14                               CLE004
     O**********               *IN60     15                               CLE004
     O**********               *IN42     16                               CLE004
     O**********               *IN43     17                               CLE004
     O**********               *IN48     18                               CLE004
     O**********               *IN49     19                               CLE004
     O**********               *IN45     20                               CLE004
     O**********               *IN46     21                               CLE004
     O**********               *IN52     22                               CLE004
2289 O**********               SCID      24                               CLE004
2290 O**********       01 61 41          24 'SI'                          CLE004
2291 O**********       01 62 41          24 'SA'                          CLE004
2292 O**********       01 63 41          24 'SD'                          CLE004
2293 O**********       37                24 'SF'                          CLE004
2294 O**********               MTIME     32 '  .  .  '                    CLE004
2295 O**********               WSID      35                               CLE004
2296 O**********             01ACTNO     36                               CLE004
2297 O**********             01GCUS      42                               CLE004
2298 O**********             01LOANL     48                               CLE004
2299 O**********             01FACILL    53                               CLE004
2300 O**********             01SEQR      56                               CLE004
2301 O**********             65STRD      62                               CLE004
2302 O**********             65ENDAT     68                               CLE004
2303 O**********         N33 65RVTD      74                               CLE004
2304 O**********         N33 65RVFR      75                               CLE004
2305 O**********         N11 65RVDY      77                               CLE004
2306 O*************          65CCY       80                               BHF335
2306 O**********             65GCCY      80                               BHF335
2306 O**********             65CCY       80                        BHF335 CLE004
2307 O**********          74 65UAMT  3   94                               CLE004
2308 O**********          75 65UAMT      94 '           0. '              CLE004
2309 O**********          76 65UAMT      94 '          0.  '              CLE004
2310 O**********          77 65UAMT      94 '         0.   '              CLE004
2311 O**********             65NOUN  3   99                               CLE004
2312 O**********             65COLC     102                               CLE004
2313 O**********             65NARR     137                               CLE004
2314 O**********             65GBCN     143                               CLE004
2315 O**********             65GSCI     148                               CLE004
2316 O**********             78SCN1     148                               CLE004
2306 O**********         N57 78CCY       80                        BHF335 CLE004
2314 O**********         N59 78GIVER    143                        BHF335 CLE004
2314 O**********         N59 78         147 '    '                 BHF507 CLE004
2317 O**********               ERCD     224                               CLE004
2318 O**********               ERRMSG   280                               BHF335
2318 O**********               ERRMSG   295                        BHF335 CLE004
2319 O**********             37SCN2     325                               CLE004
     O/COPY WNCPYSRC,LE0080O001
2401 O**  GTEES FILE-INSERTION-NEW.
2402 O**
2403 OGTEESGT E        71N16N19
2403 O       AND      N18                                                 158889
2404 O                                    1 'D'
2405 O                         GTKEY     16
2406 O                         STDT      19P
2407 O                         ENDT      22P
2408 O                         REVDT     25P
2409 O                         RVFQ      26
2410 O                         DAY       28
2411 O                         GCCY      31
2412 O                         NAMT      38P
2413 O                         NITM      41P
2414 O                         TAMTO     48P
2415 O                         NARRS     83
2416 O                         TYPE      84
2417 O                         GIVER     90
2418 O                         GCRSK     96
2419 O                         COLL      99
     O                         BRCA     111                               S01117
2420 O                         ZERO13   118P
2421 O                         RUND     121P
2422 O                         RUND     124P
2423 O                         ACTNO    125
2424 O                         NATN     128P
     O                         GSTSA    129                               CLE004
     O                         IUSRA    139                               CLE004
     O                         AUSRA    149                               CLE004
     O                         XUSRA    159                               CLE004
2425 O**
2426 O**   GTEES FILE - DELETE, AMEND, INSERT OVER DELETED
2427 O**
2428 OGTEES   E        71 16
2429 O***    OR        71 19                                              155821
2429 O       OR        71 18                                              158889
2430 O                      N63           1 'D'
2431 O                       63           1 '*'
2432 O                      N63STDT      19P
2433 O                      N63ENDT      22P
2434 O                      N63REVDT     25P
2435 O                      N63RVFQ      26
2436 O                      N63DAY       28
2437 O                      N63GCCY      31
2438 O                      N63NAMT      38P
2439 O                      N63NITM      41P
2440 O                      N63TAMTO     48P
2441 O                      N63NARRS     83
2442 O                      N63TYPE      84
     O/COPY WNCPYSRC,LE0080O004
2443 O                       61GIVER     90
     O/COPY WNCPYSRC,LE0080O005
2444 O                       61GCRSK     96
2445 O                      N63COLL      99
     O                         BRCA     111                               S01117
2446 O                       61ZERO13   118P
2447 O                       61RUND     121P
2448 O                         RUND     124P
2449 O                         ACTNO    125
2450 O                         NATN     128P
     O                         GSTSA    129                               CLE004
     O                         IUSRA    139                               CLE004
     O                         AUSRA    149                               CLE004
     O                         XUSRA    159                               CLE004
2451 O**
2452 O**   UPDATE GTEES TRAILER
2453 O**
2454 OGTEES   E        72
2455 O                         NORE      19P
2456 O                         NINS      28P
2457 O                         NDEL      31P
2458 O                         NLRA      34P
2459 O                         VRIF      52P
2460 O                         VRIL      54P
2461 O                         VRDF      62P
2462 O                         VRDL      64P
2463 O                         VRAF      72P
2464 O                         VRAL      74P
2465 O                         VLAF      82P
2466 O                         VLAL      84P
2467 O                         RUND     124P
2468 O                         ACTNO    125
2469 O                         NATN     128P
2470 O**
2471 O**   OUTPUT TO GTEES TO RELEASE
2472 O**
2473 OGTEES   E        69
2474 O**
2475 O**   OUTPUT TO GTREF - INSERT NEW
2476 O**
2477 OGTREFGR E        71 30N16
2478 O*******AND      N19                                                 158889
2478 O       AND      N19N18                                              158889
2479 O***    OR        71 30 19                                           155821
2480 O***    AND       44                                                 155821
     O       OR        71 31N16                                           156732
     O       AND      N19                                                 156732
     O       OR        71 31 19                                           156732
     O       AND       44                                                 156732
2481 O                                    1 'D'
2482 O                         GRKEY     22
     O                         BRCA      25                               S01117
2483 O**
2484 O**   DELETE
2485 O**
2486 OGTREF   E        71 15
2487 O                                    1 '*'
2488 O**   REACTIVATE
2489 O***     E        71N44 30                                           155821
2490 O***    AND       19                                                 155821
2491 O***                                 1 'D'                           155821
2492 O**
      ** Add entries to TABFRQ                                                                CLE064
**   ERMSG ERROR MESSAGES
ACTION CODE INVALID
LOAN REFERENCE INVALID
FACILITY NOT ON FILE
GUARANTEE NOT ON FILE
EXPIRED GUARANTEE
INVALID COMMAND KEY
RECORD HAS BEEN UPDATED BY ANOTHER WORKSTATION
ENTER EITHER LOAN OR FACILITY DETAILS
GUARANTEE ALREADY ON FILE
USER IS NOT AUTHORISED TO ANY ACTION CODES FOR THIS MENU ITEM AND BRANCH
USER IS NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM AND BRANCH
USER IS NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM
USER IS NOT AUTHORISED TO ANY ORIGINATING BRANCHES
USER IS NOT AUTHORISED TO THE ORIGINATING BRANCH
INVALID NUMBER IN CUSTOMER REVIEW FIELD
INVALID NUMBER IN FACILITY/LOAN REVIEW FIELD
INVALID NUMBER IN SEQUENCE REVIEW FIELD
UNAUTHORISED ONLY SHOULD BE 'Y' 'N' OR BLANK
INPUT USER CANNOT BE THE SAME AS THE AUTHORISATION USER
AMENDMENT USER CANNOT BE THE SAME AS THE AUTHORISATION USER
STATUS MUST BE COMPLETE OR REQUIRE RE-AUTHORISATION
NO DETAILS TO DISPLAY
DELETED GUARANTEE
THE SEQUENCE NUMBER MUST BE BLANK ON INSERT
TOO MANY GUARANTEES FOR THIS FACILITY
TOO MANY GUARANTEES FOR THIS LOAN
EXPIRED RECORD IS NOT ALLOWED TO AMEND
** STAT ** Status   (EXPIRED added by 158893)
COMPLETE
REAUTHORISE REQ.
AUTHORISED
DELETED
EXPIRED
     X/COPY WNCPYSRC,LE0080X002
**   TABFRQ - REVIEW FREQUENCIES
DWFMTQ45X789VEYCIJNU                                                                          CLE064
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,LE0080X001
