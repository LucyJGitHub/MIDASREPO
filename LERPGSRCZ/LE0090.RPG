     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Adjustments to accrued interest input')       *
0001 H**********                                                          S01117
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *       LE0090 - ACCRUED INTEREST ADJUSTMENTS                   *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD057528           Date 27Jan21               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 CER050             Date 16Jun19               *
      *                 MD046248           Date 27Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CAS016             Date 28Feb06               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE106             Date 01Aug04               *
      *                 CAS009             Date 04May04               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 28Apr04               *
      *                 220754             Date 30Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAP074             Date 08Aug02               *
      *                 CAS005             Date 16Dec02               *
      *                 CLE028             Date 27Jun02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 207629             Date 12Aug02               *
      *                 204130             Date 25Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 144915             Date 28Oct98               *
      *                 CAC001             Date 01Feb96               *
      *                 S01392             Date 30Sep92                  *
     F*                 S01270             DATE 21MAR91                  *
     F*                       S01220          DATE  15MAR91              *
     F*                       BHF334          DATE  16AUG90              *S01194
     F*                       S01194          DATE  03JAN90              *S01194
     F*                       S01199          DATE  12/12/89             *
     F*                       S01117          DATE  16/08/89             *
     F*                       E86103          DATE  23/09/86             *
     F*                                                                  *
     F*------------------------------------------------------------------*
      *                                                               *
      *  MD057528 - Conversion of remaining BaseRateCode to Alphanum  *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  CER050 - Annualised Percentage Rate (Recompile)              *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                   *
      *  CER049 - Stamp Tax                                           *
      *  CRE073 - Interest Rate Rounding (Recompile)                     *
      *  CLE143 - Original Loan Contract Date & Effective Interest       *
      *           Rate (Recompile)                                       *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CAS016 - IAS18 EIR Recalculation (Fee Amortisation Over      *
      *           Whole Period)                                       *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CLE106 - Syndications Manager (Recompile)                    *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes.                                  *
      *  220754 - Multi-currency rollovers need to be processed       *
      *           by the online updates.                              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  207629 - Check System Value LoanCustOriginPurch to decide if *
      *           original borrower should be input as the customer of*
      *           a Part Purchased, instead of 'Purchased From' num.  *
      *  204130 - Include manual interest adjustment in the           *
      *           projection.                                         *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *  144915 - Recompiled due to changes in LF/CLOAN.              *
     F*  CAC001 - Profit Centre Accounting Development:                  *
     F*           Two new fields, Adjustment to Accrued Cost of Funds    *
     F*           and Sign will be available to enable the user to       *
     F*           manually adjust any accrual cost of funds on directly  *
     F*           funded loans.                                          *
     F*       S01392  -  JAPANESE SUB MODULE ENHANCEMENTS                *S01392
     F*       S01270 - AMENDED FOR CUSTOMER LENDING CHANGES              *S01270
     F*       S01220 - AMENDED FOR STRATEGIC RISK MANAGEMENT             *S01220
     F*                RELEASE 10 TO ALLOW THE INPUT OF A BOOK           *S01220
     F*                CODE AGAINST A LOAN.                              *S01220
     F*       BHF334 - TIDY UP DB ERROR HANDING                          *
     F*       S01194  -  STANDING DATA CHANGES                           *S01194
     F*       S01199  -  HELP CHANGES
     F*       E86103  -  CHANGE TO S/CLOAN FILE CAUSES ERROR IN          *E86103
     F*                  MAINTENANCE TODAY REPORT. CHANGE NOT REQUIRED.  *E86103
     F*       S01117  -  MULTIBRANCHING                                  *
     F*                                                                  *
0010 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,LE0090F001
0013 F***LE0090FMCF**F     206            WORKSTN      KPASS  *NOIND      CAC001
     F***LE0090FMCF  F     224            WORKSTN      KPASS  *NOIND                   CAC001 CAS005
     FLE0090FMCF  F     242            WORKSTN      KPASS  *NOIND                             CAS005
0017 F*CLOAN***UF**F*****400  7AI     2 DISK                              S01220
0017 F***CLOAN***UF**F     436  7AI     2 DISK                     S01220 CAC001
     F*CLOAN***UF**F    1187  7AI     2 DISK                       CAC001 CLE011
     F*CLOAN***UF**F    1310  7AI     2 DISK                                           CLE011 CLE028
     F*CLOAN***UF**F    1375  7AI     2 DISK                                           CLE028 CAS004
     F***CLOAN** UF  F    1389  7AI     2 DISK                                         CAS004 CAS005
     F***CLOAN** UF  F    1492  7AI     2 DISK                                         CAS005 CAP074
     F***CLOAN** UF  F    1559  7AI     2 DISK                                         CAP074 CGL029
     F***CLOAN** UF  F    1632  7AI     2 DISK                                         CGL029 CER020
     FCLOAN   UF  F    1782  7AI     2 DISK                                                   CER020
     F                                              KCOMIT
0018 FSTRAN   UF  F     200            DISK
     F                                              KCOMIT
     FLEEIRDL6UF  E           K        DISK                                                   CAS009
     F                                              KCOMIT                                    CAS009
     FLEEIRDL9UF  E           K        DISK                                                   CAS016
     F                                              KCOMIT                                    CAS016
     F            LEEIRDD0                          KRENAMELEEIRDD9                           CAS016
     FLEERAPL1UF  E           K        DISK                                                   CAS016
     F                                              KCOMIT                                    CAS016
0019 F*ABLE   IF  F      96 12AI     2 DISK                               S01194
0020 F*SNAME***IF**F     256 10AI    39 DISK                              S01194
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0022 F* 01            WORKSTATION - INSERT SCREEN
0023 F* 02                        - DUMMY SCREEN
0011 F*       03      USED TO CONDITION FIRST TIME PASS THROUGH         *
     F*               RPG CALCULATIONS CYCLE                          *
0024 F* 04            LOANS FILE - DETAIL REC-A TYPE 'D'
0012 F*       05      SET ON IF ERROR DURING READ FROM THE WORKSTATION /
     F*********         HELP INDICATOR                                    S01199
0025 F* 06                       - CATCHALL
0026 F* 07            STRAN FILE - HEADER
0027 F* 08                       - DETAIL
0028 F* 09                       - CATCHALL
0032 F**14**********  TABLE FILE - INST.CONT.DATA RECD.1                  S01194
0033 F**15**********             - CATCHALL                               S01194
0035 F**17**********  SHORTNAMES FILE - DETAIL                            S01194
0036 F**18**********                  - CATCHALL                          S01194
0037 F**19**********  TABLE FILE - CURRENCIES TABLE                       S01194
0038 F*    20         LOAN NO. BLANK
0039 F*    21         CUSTOMER NO/SHORTNAME BLANK
0040 F*    22         ADJUSTMENT AMT. BLANK
0041 F*    23         SIGN BLANK
0042 F*    24         CURRENCY BLANK
     F*    25         Adjustment to Accrued Cost of Funds blank           CAC001
     F*    26         Sign blank                                          CAC001
      *    27         Sign is + for Accrued Net Treasury Rate         *                       CAS005
      *    28         Sign is - for Accrued Net Treasury Rate         *                       CAS005
0043 F*       30      ERROR CODES SET UP
0045 F*       32      NON-DISPLAY ERROR CODES
0046 F*       33      NON-DISPLAY ERROR MESSAGES
0047 F*       34      DETAIL REC. UPDATED BY ANOTHER WORKSTATION
      *    35         CAS005 is installed                             *                       CAS005
      *    36         Error on Accrued Net Treasury Rate              *                       CAS005
      *    37         Error on Sign for Accrued Net Treasury Rate     *                       CAS005
0048 F*       38      PROCESSING TYPE = 63,65,67 OR LOAN VAL/MAT DATE INV.
0049 F*       40      OUTPUT BLANK INSERT SCREEN
0050 F*       41      BLINK LOAN NO.
0051 F*       44      UNSUCCESSFUL CHAIN TO LOANS FILE
 052 F*       45      STRAN FILE CHAIN FAIL
0053 F*       49      UNSUCCESSFUL CHAIN TO STRAN FILE
0054 F*       51      BLINK CUSTOMER
0055 F*       54      UNSUCCESSFUL CHAIN TO SNAME FILE OR INVALID CUST.NO.
     F*       55      Analytical Acctg installed, display COF fields.     CAC001
     F*       56      Blink Accrued Cost of Funds Adjustment Amount       CAC001
     F*       57      Blink Accrued Cost of Funds Adjustment Sign         CAC001
     F*       58      COF Sign is 'Plus'                                  CAC001
     F*       59      COF Sign is 'Minus'                                 CAC001
0056 F*       60      OUTPUT TO SCREEN
0057 F*       61      BLINK ADJUSTMENT AMT.
0058 F********62****  UNSUCCESSFUL CHAIN TO TABLES FILE                   S01194
0059 F*       63      BLINK SIGN
0060 F*       64      SIGN IS 'PLUS'
0061 F*       65      SIGN IS 'MINUS'
0062 F*       66      ERROR CONDITION ON SCREEN INPUT
0063 F*       67      BLINK CURRENCY
0064 F*       68      INVALID CURRENCY
0065 F*       69      REC. UPDATED BY ANOTHER WORKSTATION
0073 F*       77      OUTPUT TO STRAN - HEADER
0074 F*       78                      - DETAIL
0075 F*       79      OUTPUT TO LOANS FILE - DETAIL RECORD & LOG AFTER
0076 F*       80      RELEASE LOANS FILE
0077 F*       82      STRAN FILE NEARLY FULL
0078 F*       83      STRAN FILE FULL - SETS ON U6 AND U8
0079 E**********          EMES    1   2 55               ERROR MESSAGES   S01117
0079 E**********          EMES    1   7 70               ERROR MESSAS01117CAC001
0079 E                    EMES    1   8 70               ERROR MESSAGES   CAC001
0080 E                    ERCD       19  4               ERROR CODES
     E/COPY ZSRSRC,ZALIGNZ1                                               S01392
     E                    CPY@    1   1 80
0083 I*E0090FMNS  01   2 CS   3 CI                                        S01199
     I**********                              1   1 *IN05                 S01199
0084 I**********                              2   3 SID                   S01199
0085 I**********                              4   9 INLOAN          20    S01199
0086 I**********                             10  19 INCUSN          21    S01199
0087 I**********                             20  33 INADJ           22    S01199
0088 I**********                             34  34 INSIGN          23    S01199
0089 I**********                             35  37 INCCY           24    S01199
0090 I**********                              4  37 SCFLD                 S01199
0091 I**********                              2  37 LOTSCN                S01199
0083 ILE0090FMNS  01   1 CS   2 CI                                        S01199
0084 I                                        1   2 SID                   S01199
0085 I                                        3   8 INLOAN          20    S01199
0086 I                                        9  18 INCUSN          21    S01199
0087 I                                       19  32 INADJ           22    S01199
0088 I                                       33  33 INSIGN          23    S01199
0089 I                                       34  36 INCCY           24    S01199
     I                                       37  50 INACJ           25    CAC001
0088 I                                       51  51 INSGN           26    CAC001
     I                                       52  65 #0ANTR                                    CAS005
     I                                       66  66 #0SIGN                                    CAS005
0090 I**********                             19  36 SCFLD          S01199 CAC001
0091 I**********                              1  36 LOTSCN         S01199 CAC001
0090 I**********                             19  51 SCFLD                              CAC001 CAS005
     I**********                              1  51 LOTSCN                             CAC001 CAS005
0090 I                                       19  66 SCFLD                                     CAS005
     I                                        1  66 LOTSCN                                    CAS005
0092 I        NS  02
0093 I*
0095 I*
0096 I*
0097 I*    LOANS FILE - DETAIL - REC-A TYPE 'D'
0098 I*
0099 ICLOAN   NS  04   1 CD   8 CA
0100 I                                        1   1 RECI
0101 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0102 I                                        8   8 RCDT
0103 I                                        9   90MRIN
0104 I                                       10  110PTYP
0105 I**********                             12  170CNUM                                      CSD027
0105 I                                       12  17 CNUM                                      CSD027
0106 I*****                                  18  200BRCD                  S01117
     I                                       18  20 BRCA                  S01117
0107 I                                       21  22 LTYP
0108 I                                       23  24 SUTP
0109 I                                    P  25  270DDAT
0110 I                                    P  28  300VDAT
0111 I                                    P  31  330MDAT
0112 I                                       34  350LASQ
0113 I**********                             36  410FCUS                                      CSD027
0113 I                                       36  41 FCUS                                      CSD027
0114 I                                       42  440FTYP
0115 I                                       45  460FSEQ
0116 I                                       47  49 CCY
0117 I                                    P  50  560CPAM
0118 I                                       57  57 INTC
0119 I                                    P  58  630INTR
0120 I**********                             64  650BRTT                                    MD057528
     I                                       64  65 BRTT                                    MD057528
0121 I                                    P  66  710BRTE
0122 I                                    P  72  770RTSP
0123 I                                    P  78  815MARG
0124 I                                       82  82 SPIN
0125 I                                       83  83 CHIN
0126 I                                    P  84  897WTRT
0127 I                                       90  90 WTIN
0128 I                                       91  910REPT
0129 I                                    P  92  980RAMT
0130 I                                    P  99 1010NRPD
0131 I                                      102 102 RFRQ
0132 I                                      103 1040RDYN
0133 I                                      105 107 FCCY
0134 I                                      108 1100LIND
0135 I                                      111 112 CRSK
0136 I                                      113 114 ACOF
0137 I                                      115 115 NACD
0138 I                                      116 116 RELI
0139 I                                      117 117 AUTO
0140 I                                    P 118 1240PSAM
0141 I                                    P 125 1318BCXR
0142 I                                    P 132 1388FCXR
0143 I                                      139 1400SDST
0144 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 OSDAQQ                                    CGL029
0145 I                                      153 162 TSTN
0146 I                                      163 1640MDST
0147 I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 OMDAQQ                                    CGL029
0148 I                                      177 186 TMAN
0149 I                                      187 196 FACO
0150 I                                    P 197 1990RLDT
0151 I                                    P 200 2020NROD
0152 I                                      203 203 RLFQ
0153 I                                      204 2050RLDY
0154 I**********                            207 2080NBRA                                    MD057528
     I                                      207 208 NBRA                                    MD057528
0155 I                                    P 209 2147NRTS
0156 I                                      215 215 NSIN
0157 I                                      216 2160NCAC
0158 I                                    P 217 2230AWTP
0159 I                                    P 224 2300WTRD
0160 I                                    P 231 2370WTWD
0161 I                                    P 238 2440IWOD
0162 I                                    P 245 2510PWOD
0163 I                                      252 2520BMDI
0164 I                                      253 2530FMDI
0165 I                                    P 254 2600PDIN
     I                                      271 273 ORBR                  S01117
0166 I                                      287 287 BTIN
0167 I                                      288 2890BLDY
0168 I**********                            290 2950OLNO                                      CSD027
0168 I                                      290 295 OLNO                                      CSD027
0169 I                                      296 296 RCSI
0170 I                                      297 2970ICBS
0171 I                                      298 298 IPFR
0172 I                                    P 299 3050TOTI
0173 I                                    P 306 3080NIDT
0174 I                                    P 309 3110IBDT
0175 I                                    P 312 3140SLID
0176 I                                    P 315 3210AIPD
0177 I                                    P 322 3240DLRC
0178 I                                    P 325 3270IACD
0179 I                                    P 328 3340AITC
0180 I                                    P 335 3410TFEP
0181 I                                    P 342 3480AIAP
0182 I                                    P 349 3550IPRD
0183 I                                    P 356 3620IPRM
0184 I                                    P 363 3690ICTD
0185 I                                    P 370 3760AIMN
0186 I                                    P 377 3790RBDT
0187 I                                    P 380 3810NOPS
0188 I                                      384 3850IFDY
0189 I                                      386 386 LONI
0190 I                                      387 387 CNFI
0191 I                                      388 388 ACEI
0192 I                                      389 389 TLXI
0193 I                                      390 390 CBLI
0194 I                                    P 391 3930ORED
0195 I                                    P 394 3960LCD
0196 I                                      397 397 CHTP
0197 I                                    P 398 4000TNLU
     I**  BOOK CODE ADDITION FOR EXPOSURE MANAGEMENT                      S01220
     I                                      435 436 BOKC                  S01220
     I**********                            437 4420COCU                               204130 CSD027
     I**********                            443 4480RECE                               204130 CSD027
     I                                      437 442 COCU                                      CSD027
     I                                      443 448 RECE                                      CSD027
     I                                    P 449 4510OMDT                                      204130
     I                                    P 452 4540NIPD                                      204130
     I                                    P 455 4570NMDT                                      204130
     I                                      458 458 APMI                                      204130
     I                                      459 4600RSTM                                      204130
     I**********                            461 472 RONS                               204130 CGL029
     I                                      461 472 RONSQQ                                    CGL029
     I                                      473 480 RIBN                                      204130
     I                                      481 515 RIBA                                      204130
     I**********                            516 5210ROBN                               204130 CSD027
     I**********                            522 5270ROCN                               204130 CSD027
     I                                      516 521 ROBN                                      CSD027
     I                                      522 527 ROCN                                      CSD027
     I                                      528 5290PSTM                                      204130
     I**********                            530 541 PONS                               204130 CGL029
     I                                      530 541 PONSQQ                                    CGL029
     I                                      542 549 PIBN                                      204130
     I                                      550 584 PIBA                                      204130
     I**********                            585 5900POBN                               204130 CSD027
     I**********                            591 5960POCN                               204130 CSD027
     I                                      585 590 POBN                                      CSD027
     I                                      591 596 POCN                                      CSD027
     I                                      597 604 RCRN                                      204130
     I                                      605 639 RCRA                                      204130
     I                                      640 647 RVNO                                      204130
     I                                      648 655 AWBN                                      204130
     I                                      656 690 AWBA                                      204130
     I                                      691 698 BENN                                      204130
     I                                      699 733 BENA                                      204130
     I                                      734 768 DTP1                                      204130
     I                                      769 803 DTP2                                      204130
     I                                      804 838 DTP3                                      204130
     I                                      839 873 DTP4                                      204130
     I                                      874 876 DCHG                                      204130
     I                                      877 911 BTB1                                      204130
     I                                      912 946 BTB2                                      204130
     I                                      947 981 BTB3                                      204130
     I                                      9821016 BTB4                                      204130
     I                                     10171051 BTB5                                      204130
     I                                     10521086 BTB6                                      204130
     I                                     10871087 CVMR                                      204130
     I                                     10881091 PTFR                                      204130
      **  Additional fields for Analytical Accounting                     CAC001
     I                                    P109310987FSRP                  CAC001
     I                                     10991099 FSGN                  CAC001
     I                                     11001103 FPRC                  CAC001
     I                                    P110411100TCOF                  CAC001
     I                                    P111111170ACPD                  CAC001
     I                                    P111811240ACDA                  CAC001
     I                                    P112511310ACAJ                  CAC001
     I                                    P113211380ACAP                  CAC001
     I                                    P113911450COFD                  CAC001
     I                                    P114611520COFM                  CAC001
     I                                    P115311590CFCD                  CAC001
     I                                    P116011657NFRS                  CAC001
     I                                     11661166 NFSN                  CAC001
     I                                     11671170 NFPC                  CAC001
     I                                    P117111770PDCF                  CAC001
     I                                    P117811800FCTD                  CAC001
     I                                    P118111870FWOD                  CAC001
     I**********                          P139113970AINN                                      CAS005
     I                                    P141814240AINN                                      CAP074
     I                                    P142514310TOTN                                      CAS005
     I                                    P143214380ICTN                                      CAS005
     I                                    P143914450IWON                                      CAS005
     I                                    P144614520IPNM                                      CAS005
     I                                    P145314590PDNN                                      CAS005
     I                                    P146014660FSCPAM                                    CAS005
     I                                    P146714730FPAM                                      CLE031
     I                                    P147414808REXR                                      CLE031
     I                                     14811481 REXI                                      CLE031
     I                                     14821484 PSCY                                      CLE031
     I                                    P148514918PEXR                                      CLE031
     I                                     14921492 PEXI                                      CLE031
     I                                     14931512 FRNT                                      CAP074
     I                                     15131532 AFRT                                      CAP074
     I                                     15331533 REPA                                      CAP074
     I                                     15341559 TMST                                      CAP074
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     15971614 RONS                                      CGL029
     I                                     16151632 PONS                                      CGL029
     I                                     17801782 LOIC                                      CER020
0198 I** RE-DEFINE LAST CHANGE DETAILS AND LOT FIELDS FOR O/P
0199 I                                      394 400 LSTC
0200 I                                        1 200 LOTLN1
0201 I**************************************201 400 LOTLN2                S01270
0201 I**************************************201 434 LOTLN2          S01270S01220
0201 I                                      201 436 LOTLN2                S01220
     I**********                           10931187 LOTLN3                             CAC001 CAS005
     I**********                           10931432 LOTLN3                             CAS005 CAP074
     I                                     10931559 LOTLN3                                    CAP074
     I                                        11300 ABSTS                                     204130
     I*                                                                                       220754
     I*    LOANS FILE - DETAIL - REC-B TYPE 'D'                                               220754
     I*                                                                                       220754
     I        NS  10   1 CD   8 CB                                                            220754
     I                                        11180 ABSTK                                     220754
0202 I** CATCHALL
0203 I        NS  06
0204 I*
0205 I*
0206 I*    SINGLE ITEM TRANSACTIONS FILE - HEADER RECORD.
0207 I*
0208 ISTRAN   NS  07   1 CH
0209 I                                        1   1 RECI
0210 I                                        2   60NAVT
0211 I                                        7  110MNT
0212 I                                    P  12  140NORC
0213 I                                    P  15  170NOMA
0214 I                                    P  18  250HMAW
0215 I                                    P  26  270HMAD
0216 I                                    P  28  300NOIL
0217 I                                    P  31  380HLIW
0218 I                                    P  39  400HLID
0219 I                                    P  41  430NODL
0220 I                                    P  44  510HLDW
0221 I                                    P  52  530HLDD
0222 I                                    P  67  690NOID
0223 I                                    P  70  770HDIW
0224 I                                    P  79  800HDID
0225 I                                    P  81  830NODD
0226 I                                    P  84  910HDDW
0227 I                                    P  92  930HDDD
0228 I                                    P  94  960NOIC
0229 I                                    P  97 1040HCIW
0230 I                                    P 105 1060HCID
0231 I                                    P 107 1090NODC
0232 I                                    P 110 1170HCDW
0233 I                                    P 118 1190HCDD
0234 I                                    P 120 1220NOIF
0235 I                                    P 123 1300HFIW
0236 I                                    P 131 1320HFID
0237 I                                    P 133 1350NODF
0238 I                                    P 136 1430HFDW
0239 I                                    P 144 1450HFDD
0240 I                                    P 195 1970RRNT
0241 I                                    P 198 2000TNLU
0242 I                                        1 200 STLOT
0243 I*
0244 I*    SINGLE ITEM TRANSACTIONS FILE - DETAIL RECORD.
0245 I*    MANUAL ADJUSTMENT TO ACCRUED INTEREST - LOANS.
0246 I*
0247 I        NS  08   1 CJ
0248 I                                        1   1 RECI
0249 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0250 I**********                              8  130CNUM                                      CSD027
0250 I                                        8  13 CNUM                                      CSD027
0251 I                                       14  16 CCY
0252 I                                    P  17  230MAAM
0253 I                                       24  24 SIGN
0254 I*****                                  25  270BRCD                  S01117
     I                                       25  27 BRCA                  S01117
0255 I                                       28  380FCRF
0256 I                                       39  58 CRNM
0257 I                                       59  68 CTWN
     I                                    P  69  750ACJA                  CAC001
     I                                       76  76 CASN                  CAC001
     I                                    P  77  830MAAN                                      CAS005
     I                                       84  84 MASN                                      CAS005
0258 I                                      189 1940UDTM
0259 I                                    P 195 1970RRNT
0260 I                                    P 198 2000TNLU
0261 I**
0262 I** CATCHALL
0263 I        NS  09
0264 I                                        1   1 RECI
0265 I**
0316 I**************                                                      S01194
0317 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0318 I**************                                                      S01194
0319 I*ABLE***NS**14   2 C0   3 C1  12 C1                                 S01194
0320 I*******AND****  13 C0                                               S01194
0321 I**************                          1   1 RECI                  S01194
0322 I**************                          2   30RECT                  S01194
0323 I**************                         12  130RCDE                  S01194
0324 I**************                         14  66 TITL                  S01194
0325 I**************                         67  67 DATF                  S01194
0327 I**************                         74  74 MODI1                 S01194
0328 I**************                         75  75 MODI2                 S01194
0329 I**************                         76  76 MODI3                 S01194
0330 I**************                      P  77  790RUND                  S01194
0331 I**************                         80  86 RUNA                  S01194
0332 I**************                         87  870SFLG                  S01194
0333 I**************                      P  90  920LCD                   S01194
0334 I**************                         93  93 CHTP                  S01194
0335 I**************                      P  94  960TNLU                  S01194
0336 I**************                                                      S01194
0337 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0338 I**************                                                      S01194
0339 I********NS**19   1 CD   2 C2   3 C0                                 S01194
0340 I*******AND****  13 C1                                               S01194
0341 I**************                          1   1 RECI                  S01194
0342 I**************                          2   30RECT                  S01194
0343 I**************                         10  12 CCY                   S01194
0344 I**************                         13  130SREC                  S01194
0345 I**************                         14  27 CCNM                  S01194
0346 I**************                      P  28  348SPOT                  S01194
0347 I**************                         35  37 CCYS                  S01194
0348 I**************                         38  380CDP                   S01194
0349 I**************                         39  390TNOT                  S01194
0350 I**************                         40  40 DCCY                  S01194
0351 I**************                         41  44 SRC1                  S01194
0352 I**************                         45  48 SRC2                  S01194
0353 I**************                         49  520TACC                  S01194
0354 I**************                         53  560TEQV                  S01194
0355 I**************                         57  600SWQV                  S01194
0356 I**************                         61  640TAC4                  S01194
0357 I**************                         65  680TAC5                  S01194
0358 I**************                         69  69 HIND                  S01194
0359 I**************                      P  70  768PART                  S01194
0360 I**************                         77  780SSNO                  S01194
0361 I**************                      P  79  858ERLC                  S01194
0362 I**************                      P  90  920LCD                   S01194
0363 I**************                         93  93 CHTP                  S01194
0364 I**************                      P  94  960TNLU                  S01194
0365 I**************                                                      S01194
0366 I****CATCHALL**                                                      S01194
0367 I********NS**15                                                      S01194
0368 I**************                                                      S01194
0379 I**************                                                      S01194
0380 I*****CUSTOMER*SHORTNAMES FILE - DETAIL RECORD.                      S01194
0381 I**************                                                      S01194
0382 I*SNAME***NS**17   1 CD                                              S01194
0383 I**************                          1   1 RECI                  S01194
0384 I**************                         39  48 CSNMS                 S01194
0385 I***CNUM*RE-DEFINED FOR UNIQUENESS                                   S01194
0386 I**************                          2   70CNUMS                 S01194
0392 I****CATCHALL**                                                      S01194
0393 I********NS**18                                                      S01194
0396 I*
0397 I* LOCAL DATA AREA
0398 I*
0399 ILDA        UDS                            256
0400 I***********                           134 138 DBFILE                S01117
0401 I***********                           139 167 DBKEY                 S01117
0402 I***********                           168 175 DBPGM                 S01117
0403 I***********                           176 177 DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I                                      254 263 USRID
     I/COPY WNCPYSRC,LE0090I001
     I/COPY ZSRSRC,ZTNLU1Z1                                               S01392
     I**   DATA STRUCTURE USED IN COMMITMENT
     ICMTTXT      DS
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTCD
     I                                       26  35 USRIDX
     I**********                             51  86 LOTSCN                CAC001
     I**********                             51 101 LOTSCN                             CAC001 CAS005
     I                                       51 116 LOTSCN                                    CAS005
     I*
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
      *                                                                                       207629
      ** Datastructure to hold input parameter for AOSVALR0.                                  207629
     I            DS                                                                          207629
     I                                        1  20 WPARM                                     207629
     I                                        1   5 WPARM1                                    207629
     I                                        6  10 WPARM2                                    207629
     I                                       11  15 WPARM3                                    207629
     I                                       16  20 WPARM4                                    207629
     I/COPY WNCPYSRC,LE0090I002
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              A6NBDP                          CDP                   S01194
      *                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     ICLONQD    E DSLESTMP2PD                                                                 CER049
      *                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01117
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01117
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              CAC001
      **  External DS for Midas Module Details                            CAC001
     I*                                                                   CAC001
     ISCSARD    E DSSCSARDPD                                                                  CLE028
      ** External DS for SAR details                                                          CLE028
      *                                                                                       CLE028
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I/COPY WNCPYSRC,LE0090I003
      *                                                                                       204130
     IZ#BSTS    E DSZ#BST                                                                     204130
      ** before image of update to LE position files                                          204130
      *                                                                                       204130
     IZ#ASTS    E DSZ#AST                                                                     204130
      ** after image of update to LE position files                                           204130
      *                                                                                       204130
     IZ#WSTS    E DSZ#WST                                                                     204130
      ** work file of update to LE position files                                             204130
      *                                                                                       204130
     IZ#BSTK      DS                           2048                                           220754
     IZ#ASTK      DS                           2048                                           220754
      **                                                                  S01117
     C                     MOVEACPY@      BIS@   80
     C**
     C*    READ WORKSTATION FILE /*HELP*FACILITY*                         S01199
     C**
     C           *IN03     IFEQ '1'
     C           *IN05     DOUEQ'0'
     C                     READ LE0090FM                 05
     C********** *IN05     IFEQ '1'                                       S01199
     C**********           MOVEAERCD      HERCD 160                       S01199
     C**********           MOVEL'LE0090'  HBPGM   8                       S01199
     C**********           CALL 'MHELP'                                   S01199
     C**********           PARM           HBPGM                           S01199
     C**********           PARM           HERCD                           S01199
     C**********           END                                            S01199
     C                     END
     C  N02                GOTO MAINPR
     C                     END
0405 C  N03                SETON                     0302
0406 C                     SETOF                     05
0408 C**
0409 C** FIRST CYCLE PROCESSING
0410 C**
0411 C                     SETON                     60
0412 C                     MOVEL'LE0090  'DBPGM
      *                                                                   S01117
      *  IN DATA AREA RUNDAT                                              S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
      *                                                                   S01117
0413 C**********           EXSR ZSYSTM                                    S01194
0414 C***99*****           SETON                     U7U8                 S01194
0415 C***99*********       MOVEL'TABLE'   DBFILE                          S01194
0416 C***99*********       MOVELZTABKY    DBKEY            ***************S01194
0417 C***99*********       MOVE '01'      DBASE            * DBERROR 001 *S01194
0418 C***99*****           GOTO ENDPR                      ***************S01194
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C**                                                                  S01117
     C**   ACCESS GENERAL LEDGER DETAILS                                  S01117
     C**                                                                  S01117
     C**********           CALL 'AOGELRR0'                                             S01117 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01117 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   CAC001
     C** Check if Analytical Accounting Module is installed.              CAC001
     C*                                                                   CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*DBERR ' @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
      *                                                                   CAC001
      ** If Analytical Accounting is switched on, display Cost of Funds   CAC001
      ** fields.                                                          CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN55                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN55                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       207629
      ** Check System Value: Use Original Borrower or Purchased From?                         207629
      ** Set up AOSVALR0 parameter with GISVAL "LoanCustOriginPurch"                          207629
     C                     MOVE *BLANKS   WPARM                                               207629
     C                     MOVEL'LoanC'   WPARM1                                              207629
     C                     MOVEL'ustOr'   WPARM2                                              207629
     C                     MOVEL'iginP'   WPARM3                                              207629
     C                     MOVEL'urch'    WPARM4                                              207629
     C                     MOVELWPARM     SVALK1                                              207629
      * Call Access object:                                                                   207629
     C                     CALL 'AOSVALR0'                                                    207629
     C                     PARM           RTNCDE  7                                           207629
     C                     PARM           SVALK1 20                                           207629
     C                     PARM           SVAL1 200                                           207629
     C                     PARM           SVALK2 20                                           207629
     C                     PARM           SVAL2 200                                           207629
     C                     PARM           SVALK3 20                                           207629
     C                     PARM           SVAL3 200                                           207629
     C                     PARM           SVALK4 20                                           207629
     C                     PARM           SVAL4 200                                           207629
     C                     PARM           SVALK5 20                                           207629
     C                     PARM           SVAL5 200                                           207629
     C                     PARM           SVALK6 20                                           207629
     C                     PARM           SVAL6 200                                           207629
     C                     PARM           SVALK7 20                                           207629
     C                     PARM           SVAL7 200                                           207629
     C                     PARM           SVALK8 20                                           207629
     C                     PARM           SVAL8 200                                           207629
     C                     PARM           SVALK9 20                                           207629
     C                     PARM           SVAL9 200                                           207629
     C                     PARM           SVALK0 20                                           207629
     C                     PARM           SVAL10200                                           207629
      * If the system value is not found then issue a database error                          207629
     C           RTNCDE    IFNE '        '                                                    207629
     C                     SETON                     U7U8                 S01194              207629
     C                     MOVEL'SDSVALPD'DBFILE           ************                       207629
     C                     Z-ADD5         DBASE            * DBERR 05 *                       207629
     C                     MOVEL'SVALK1'  DBKEY            ************                       207629
     C                     GOTO ENDPR                                                         207629
     C                     ELSE                                                               207629
      * Isolate the first character of SVAL1 which = 'P' or 'O'.                              207629
     C                     MOVELSVAL1     WRK01   1        1 character fld                    207629
     C           WRK01     IFEQ 'O'                                                           207629
     C                     MOVE 'O'       PPCUST  1                                           207629
     C                     ELSE                                                               207629
     C                     MOVE 'P'       PPCUST                                              207629
     C                     ENDIF                                                              207629
     C                     ENDIF                                                              207629
      *                                                                                       CLE028
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed                         CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY' POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD   6                                           CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'005'     DBASE                                               CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     GOTO ENDPR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CAS005
      ** Check if switchable feature CAS005 is installed                                      CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD                                               CAS005
     C                     PARM '*VERIFY' POPTN   7                                           CAS005
     C                     PARM 'CAS005'  PSARD   6                                           CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFEQ *BLANKS                                                       CAS005
     C                     MOVE 'Y'       CAS005  1                                           CAS005
     C                     MOVE *ON       *IN35                                               CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE *OFF      *IN35                                               CAS005
     C           PRTCD     IFNE '*NRF   '                                                     CAS005
     C                     MOVE 'SCSARDPD'DBFILE                                              CAS005
     C                     MOVE 'CAS005'  DBKEY                                               CAS005
     C                     Z-ADD9         DBASE                                               CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS009
      ** Check if switchable feature CAS009 is installed                                      CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD                                               CAS009
     C                     PARM '*VERIFY' POPTN   7                                           CAS009
     C                     PARM 'CAS009'  PSARD   6                                           CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFEQ *BLANKS                                                       CAS009
     C                     MOVE 'Y'       CAS009  1                                           CAS009
     C                     ELSE                                                               CAS009
     C           PRTCD     IFNE '*NRF   '                                                     CAS009
     C                     MOVE 'SCSARDPD'DBFILE                                              CAS009
     C                     MOVE 'CAS009'  DBKEY                                               CAS009
     C                     Z-ADD10        DBASE                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS016
      ** Check if switchable feature CAS016 is installed                                      CAS016
      *                                                                                       CAS016
     C                     MOVE 'N'       CAS016                                              CAS016
     C                     CALL 'AOSARDR0'                                                    CAS016
     C                     PARM *BLANKS   PRTCD                                               CAS016
     C                     PARM '*VERIFY' POPTN   7                                           CAS016
     C                     PARM 'CAS016'  PSARD   6                                           CAS016
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS016
      *                                                                                       CAS016
     C           PRTCD     IFEQ *BLANKS                                                       CAS016
     C                     MOVE 'Y'       CAS016  1                                           CAS016
     C                     ELSE                                                               CAS016
     C           PRTCD     IFNE '*NRF   '                                                     CAS016
     C                     MOVE 'SCSARDPD'DBFILE                                              CAS016
     C                     MOVE 'CAS016'  DBKEY                                               CAS016
     C                     Z-ADD11        DBASE                                               CAS016
     C                     EXSR *PSSR                                                         CAS016
     C                     ENDIF                                                              CAS016
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS009
     C/COPY WNCPYSRC,LE0090C002
     C*                                                                   S01117
0420 C** DEFINE FIELDS
0421 C**
0422 C                     MOVE 'SI'      SID
0423 C                     MOVE ' '       BLK150150
0424 C                     MOVE ' '       BLK16  16
0425 C                     MOVE ' '       BLK76  76
0426 C***********          MOVE ' '       BLK34  34                       CAC001
     C**********           MOVE ' '       BLK49  49                                    CAC001 CAS005
     C                     MOVE ' '       BLK49  64                                           CAS005
0427 C                     Z-ADD0         ZERO05  50
0428 C           MAINPR    TAG                             ** MAINPR TAG *
0429 C**
0430 C                     EXSR SETOF
0431 C                     EXSR TIME
0432 C   KL
0433 COR 02                EXSR SCNOUT
0434 C   KC
0435 COR KL
0436 COR 02                GOTO ENDPR
0437 C                     EXSR SRINS
0438 C                     EXSR TIME
0439 C**
0440 C           ENDPR     TAG                             ** ENDPR TAG **
0441 C**
     C   U6
     COR U7
     COR KC                SETON                     LR
0442 C** IF ANY ERROR CODES ARE SET UP,MOVE INTO ARRAY
0443 C**
0444 C           S         COMP 0                    30
0445 C   30                MOVEAERCD,1    ERCDS
0446 C           ERRMSG    COMP BLK76                    33
0447 C  N30                SETON                     32
      **                                                                  S01117
      **   EXECUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                 S01117
      **                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
0448 C********************************************************************
0449 C**
0450 C** SUBROUTINE TO RESET SCREEN INDICATORS AND ERROR ARRAY INDEX
0451 C** CALLED FROM M.P.
0452 C           SETOF     BEGSR
0453 C                     SETOF                     33
0454 C                     SETOF                     326944
0455 C                     SETOF                     415161
0456 C                     SETOF                     636740
0457 C                     SETOF                     546865
     C                     MOVE '0'       *IN56                           CAC001
     C                     MOVE '0'       *IN57                           CAC001
     C                     MOVE '0'       *IN58                           CAC001
     C                     MOVE '0'       *IN59                           CAC001
     C                     MOVE *OFF      *IN36                                               CAS005
     C                     MOVE *OFF      *IN37                                               CAS005
     C                     MOVE *OFF      *IN27                                               CAS005
     C                     MOVE *OFF      *IN28                                               CAS005
0458 C                     MOVE '    '    ERCD
0459 C                     MOVE BLK76     ERCDS  76
0460 C                     MOVE BLK76     ERRMSG 76
0461 C                     Z-ADD0         S       20
0462 C                     ENDSR
0463 C********************************************************************
0464 C**
0465 C**  SUBROUTINE TO OUTPUT BLANK INSERT SCREEN
0466 C** CALLED FROM M.P.,SRINS
0467 C           SCNOUT    BEGSR
0468 C   82                MOVELEMES,2    ERRMSG
0469 C                     SETON                     40
0470 C                     ENDSR
0471 C********************************************************************
0472 C**
0473 C** SUBROUTINE TO PROCESS INSERT SCREEN
0474 C** CALLED FROM M.P.
0475 C** CALLS EXCPTN,ZALIGN,UDLOG,SCNOUT
0476 C           SRINS     BEGSR
0477 C**
0478 C** VALIDATE LOAN NO.CHECK THAT LOAN ON FILE
0479 C**
0480 C   20                SETON                     44
0481 C   20                GOTO LNERR
0482 C                     MOVELINLOAN    LNKEY   7
0483 C                     MOVE 'A'       LNKEY
0484 C           LNKEY     CHAINCLOAN                44
0485 C*
0486 C*    RELEASE LOANS RECORD
0487 C  N44                SETON                     80
      *                                                                                       204130
     C           *IN44     IFEQ '0'                                                           204130
     C                     MOVELABSTS     Z#BSTS                                              204130
     C                     MOVEL'Y'       BEFORE  1                                           220754
     C                     ENDIF                                                              204130
      *                                                                                       204130
0488 C  N44                EXSR EXCPTN
0489 C   06                SETON                     44
0490 C           LNERR     TAG                             ** LNERR TAG **
0491 C   44      1         ADD  S         S          41
0492 C   44                MOVE ' 025'    ERCD,S
0493 C   44                GOTO ENDINS
0494 C**
0495 C** AMENDS NOT ALLOWED TO DISCOUNTED
0496 C** LOANS/PARTICIPATIONS
      ** and Flat rate personal loans, if CLE028 is installed                                 CLE028
      *                                                                                       CLE028
0497 C           PTYP      COMP 63                       38
0498 C     N38   PTYP      COMP 65                       38
0499 C     N38   PTYP      COMP 67                       38
     C           *IN38     IFEQ *OFF                                                          CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     MOVE *ON       *IN38                                               CLE028
     C                     ENDIF                                                              CLE028
0500 C      38   1         ADD  S         S          41
0501 C      38             MOVE ' 179'    ERCD,S
0502 C      38             GOTO ENDINS
0503 C**
0504 C** CHECK VAL DATE AND MAT DATE OF LOAN AGAINST RUN DATE
0505 C**
0506 C           RUND      COMP VDAT                   3838
0507 C   38                GOTO DATERR
0508 C           MDAT      COMP 0                    38
0509 C   38      RUND      COMP MDAT                 38
0510 C           DATERR    TAG                             ** DATERR TAG *
0511 C   38      1         ADD  S         S          41
0512 C   38                MOVE ' 106'    ERCD,S
0513 C   38                GOTO ENDINS
0514 C** SAVE LAST UPDATE DETAILS
0515 C                     MOVE LSTC      LSTCS   7
     C*                                                                   S01117
     C*    IF MULTIBRANCHING = YES, CHECK AUTHORITY OF BOOKING BRANCH/    S01117
     C*    ACTION CODE, ELSE CHECK AUTHORITY ON ACTION CODE.              S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM 'I'       @ZACTN  1                       S01117
     C                     PARM BRCA      @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C*
     C*
     C                     ELSE                                           S01117
     C*
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM 'I'       @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C*
     C                     END                                            S01117
      *                                                                   S01117
     C           @ERR      IFNE 0                                         S01117
     C                     ADD  1         S          41                   S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     MOVE '303'     ERCD,S                          S01117
     C                     MOVE EMES,3    ERRMSG                          S01117
     C                     ELSE                                           S01117
     C                     MOVE '304'     ERCD,S                          S01117
     C                     MOVE EMES,4    ERRMSG                          S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C                     MOVE '302'     ERCD,S                          S01117
     C                     MOVE EMES,5    ERRMSG                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*   CHECK AUTHORITY ON ORIGINATING BRANCH, WHEN ORIGINATING         S01117
     C*   BRANCH VALIDATION IS YES.                                       S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BKOBRU    ANDEQ'Y'                                       S01117
     C           BKOBUV    ANDEQ'Y'                                       S01117
      *                                                                   S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM ORBR      @BRCX   3                       S01117
     C                     PARM           @ERR    10                      S01117
     C*                                                                   S01117
     C           @ERR      IFNE 0                                         S01117
     C                     ADD  1         S          41                   S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     MOVE '305'     ERCD,S                          S01117
     C                     MOVE EMES,6    ERRMSG                          S01117
     C                     ELSE                                           S01117
     C                     MOVE '306'     ERCD,S                          S01117
     C                     MOVE EMES,7    ERRMSG                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C**********                                                          S01194
0517 C***CHECK*IF*CUST.NO.*6*NUMERIC*OR*10*ALPHA                          S01194
0518 C**********                                                          S01194
0519 C***21*****           SETON                     54                   S01194
0520 C***21*****           GOTO CUSERR                                    S01194
0521 C**********           MOVELBLK16     ZFIELD                          S01194
0522 C**********           MOVE INCUSN    ZFIELD                          S01194
0523 C**********           Z-ADD6         ZADIG                           S01194
0524 C**********           Z-ADD0         ZADEC                           S01194
0525 C**********           EXSR ZALIGN                                    S01194
0526 C**********                                                          S01194
0527 C***NUMERIC FIELD DETECTED                                           S01194
0528 C**N99*****           GOTO NUMCHK                                    S01194
0529 C**
0530 C**************       MOVE INCUSN    SNKEY  10        99 ON,NOT NUM. S01194
0531 C***********SNKEY     CHAINSNAME                54                   S01194
     C                     MOVELINCUSN    KEYC   10                       S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM *BLANKS   KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     COMP *BLANKS              1717                 S01194
     C  N17                MOVEL*BLANKS   INCUSN                          S01194
     C  N17                MOVELBBCUST    INCUSN                          S01194
0532 C**N17******1         ADD  S         S          51                   S01194
0533 C*****N17****         MOVE ' 035'    ERCD,S                          S01194
0534 C*****N17****         GOTO ENDINS                                    S01194
0532 C   17      1         ADD  S         S          51                   S01194
0533 C      17             MOVE ' 035'    ERCD,S                          S01194
0534 C      17             GOTO ENDINS                                    S01194
     C*                                                                   S01194
     C**  CHECK CUSTOMER ENTERED = LOAN CUSTOMER                          S01194
     C*                                                                   S01194
0535 C**********           MOVE BBCUST    CNUMS   60                                   S01194 CSD027
0535 C                     MOVE BBCUST    CNUMS   6                                           CSD027
0535 C           CNUMS     COMP CNUM                 5454                 S01194
      *If the loan is a Participation Purchased, & System Value                               207629
      * LoanCustOriginPurch = 'O', use Original Borrower:                                     207629
     C           PPCUST    IFEQ 'O'                                                           207629
     C           PTYP      IFEQ 64                                                            207629
     C           PTYP      OREQ 65                                                            207629
     C           PTYP      OREQ 68                                                            207629
     C           PTYP      OREQ 71                                                            207629
     C           CNUMS     IFNE OLNO                                                          207629
     C                     MOVE '1'       *IN54                                               207629
     C                     ELSE                                                               207629
     C                     MOVE '0'       *IN54                                               207629
     C                     ENDIF                                                              207629
     C                     ENDIF                                                              207629
     C                     ENDIF                                                              207629
0536 C********** NUMCHK    TAG                             ** NUMCHK TAG *S01194
0537 C**N99*****           MOVELINCUSN    NUMCUS  60                      S01194
0538 C**N99***** NUMCUS    COMP CNUM                 5454                 S01194
0539 C********** CUSERR    TAG                             ** CUSERR TAG *S01194
0540 C   54      1         ADD  S         S          51
0541 C   54                MOVE ' 104'    ERCD,S
0542 C   54                GOTO ENDINS
0543 C**
0544 C** VALIDATE ADJUSTMENT - OBTAIN CORRECT NO OF DECIMAL PLACES
0545 C**
0546 C   22                GOTO ADJERR
0547 C**************       MOVEL'20'      CCYKEY 12
0548 C**************       MOVELCCY       TEMP4   4
0549 C**************       MOVE '1'       TEMP4
0550 C**************       MOVE TEMP4     CCYKEY
0551 C***********CCYKEY    CHAINTABLE                62
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       K101    3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
0552 C**N19*********       SETON                     U7U8
0553 C**N19*********       MOVE '02'      DBASE
0554 C**N19*********       MOVE CCYKEY    DBKEY
0555 C**N19*********       MOVE 'TABLE'   DBFILE
0556 C**N19*********       GOTO ENDINS
     C           @RTCD     IFNE *BLANKS                                   BHF334
0552 C                     SETON                     U7U8                 BHF334
     C                     MOVE '002'     DBASE            * DB ERROR 002*BHF334
     C                     MOVE CCY       DBKEY                           BHF334
     C                     MOVE 'SDCURRPD'DBFILE                          BHF334
     C                     GOTO ENDINS                                    BHF334
     C                     END                                            BHF334
0557 C                     MOVE BLK16     ZFIELD
0558 C                     MOVE INADJ     ZFIELD
0559 C                     Z-ADDCDP       ZADEC
0560 C           13        SUB  CDP       ZADIG
0561 C                     EXSR ZALIGN
0562 C  N99                MOVE ZFIELD    OTADJ  130
0563 C  N99                GOTO SGNCHK
0564 C           ADJERR    TAG                             ** ADJERR TAG *
      *                                                                   CAC001
      **  If Analytical Accounting is switched on, a blank adjustment     CAC001
      **  is allowed only if adjustment sign is blank and Accrued COF     CAC001
      **  amount is entered.                                              CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN22     ANDEQ'1'                                       CAC001
     C           *IN23     ANDEQ'1'                                       CAC001
     C           *IN25     ANDEQ'0'                                       CAC001
     C                     Z-ADD*ZEROS    OTADJ                           CAC001
     C                     Z-ADDAIMN      AIANA                           CAC001
     C                     SETOF                     6465                 CAC001
     C                     GOTO CCYCHK                                    CAC001
     C                     ENDIF                                          CAC001
0565 C   22
0566 COR 99      1         ADD  S         S          61
0567 C   22
0568 COR 99                MOVE ' 180'    ERCD,S
0569 C**
0570 C** VALIDATE SIGN
0571 C**
0572 C           SGNCHK    TAG
0573 C           INSIGN    COMP '+'                      64
0574 C  N64      INSIGN    COMP '-'                      65
0575 C  N64N65
0576 COR 23                SETON                     63
0577 C   63      1         ADD  S         S
0578 C   63                MOVE ' 182'    ERCD,S
0579 C**
0580 C** VALIDATE CURRENCY
0581 C**
     C           CCYCHK    TAG                                            CAC001
0582 C   24                SETON                     68
     C           *IN68     IFNE '1'                                       S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM           @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM INCCY     CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     68                   S01194
     C                     ELSE                                           S01194
     C                     MOVELA6CYCD    INCCY                           S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C*                                                                   S01194
0583 C  N68      INCCY     COMP CCY                  6868
0584 C   68      1         ADD  S         S          67
0585 C   68                MOVE ' 189'    ERCD,S
      *                                                                   CAC001
      **  Validate Accrued COF Manual Adjustment.                         CAC001
      ** If Analytical Accounting is switched on and loan is not          CAC001
      ** directly funded, entry to Accrued COF Manual Adj and Sign        CAC001
      ** are not allowed.                                                 CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           FPRC      ANDEQ*BLANKS                                   CAC001
      *                                                                   CAC001
     C           *IN25     IFEQ '0'                                       CAC001
     C                     MOVE '1'       *IN56                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C           *IN26     IFEQ '0'                                       CAC001
     C                     MOVE '1'       *IN57                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C           *IN25     IFEQ '0'                                       CAC001
     C           *IN26     OREQ '0'                                       CAC001
     C                     MOVELEMES,8    ERRMSG                          CAC001
     C                     GOTO ENDALL                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  If loan is directly funded and Accrued COF Manual Adj is        CAC001
      **  blanks, proceed with update.  Otherwise, validate the           CAC001
      **  two fields.                                                     CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           FPRC      ANDNE*BLANKS                                   CAC001
      *                                                                   CAC001
      **  If both Adjustment to Accrued COF and Sign fields are blank,    CAC001
      **  proceed with file update.                                       CAC001
      *                                                                   CAC001
     C           *IN25     IFEQ '1'                                       CAC001
     C           *IN26     ANDEQ'1'                                       CAC001
     C                     Z-ADD*ZEROS    OTCOF                           CAC001
     C                     Z-ADDACAJ      AACAJ                           CAC001
     C                     MOVEL*BLANKS   INSGN                           CAC001
     C                     GOTO ENDINS                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  If Adjustment to Accrued COF is blank, display error message.   CAC001
      *                                                                   CAC001
     C           *IN25     IFEQ '1'                                       CAC001
     C                     GOTO ACJERR                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  Validate Adjustment to Accrued Cost of Funds.                   CAC001
      *                                                                   CAC001
     C                     MOVE BLK16     ZFIELD                          CAC001
     C                     MOVE INACJ     ZFIELD                          CAC001
     C                     Z-ADDCDP       ZADEC                           CAC001
     C           13        SUB  CDP       ZADIG                           CAC001
     C                     EXSR ZALIGN                                    CAC001
      *                                                                   CAC001
     C           *IN99     IFEQ '0'                                       CAC001
     C                     MOVE ZFIELD    OTCOF  130                      CAC001
     C                     GOTO SGNVAL                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C           ACJERR    TAG                             ** ACJERR TAG *CAC001
     C           *IN25     IFEQ '1'                                       CAC001
     C           *IN99     OREQ '1'                                       CAC001
     C           1         ADD  S         S          56                   CAC001
     C                     MOVE ' 180'    ERCD,S                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  Validate Adjustment to Accrued COF Sign.                        CAC001
      *                                                                   CAC001
     C           SGNVAL    TAG                                            CAC001
     C           INSGN     IFEQ '+'                                       CAC001
     C                     MOVE '1'       *IN58                           CAC001
     C                     ELSE                                           CAC001
     C           INSGN     IFEQ '-'                                       CAC001
     C                     MOVE '1'       *IN59                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           *IN58     IFEQ '0'                                       CAC001
     C           *IN59     ANDEQ'0'                                       CAC001
     C           *IN26     OREQ '1'                                       CAC001
     C           1         ADD  S         S          57                   CAC001
     C                     MOVE ' 182'    ERCD,S                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ELSE                            ** BGN0ST 'N' *CAC001
     C                     Z-ADD*ZEROS    OTCOF                           CAC001
     C                     MOVEL*BLANKS   INSGN                           CAC001
     C                     ENDIF                           ** END BGN0ST *CAC001
      *                                                                                       CAS005
      ** Validate the adjustment for net treasury rate                                        CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           #0ANTR    ANDNE*BLANKS                                                       CAS005
      *                                                                                       CAS005
     C                     MOVE *BLANKS   ZFIELD                                              CAS005
     C                     MOVE #0ANTR    ZFIELD                                              CAS005
     C                     Z-ADDCDP       ZADEC                                               CAS005
     C           13        SUB  CDP       ZADIG                                               CAS005
     C                     EXSR ZALIGN                                                        CAS005
      *                                                                                       CAS005
     C           *IN99     IFEQ *OFF                                                          CAS005
     C                     MOVE ZFIELD    OTNTR  130                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN99     IFEQ *ON                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE ' 180'    ERCD,S                                              CAS005
     C                     MOVE *ON       *IN36                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Adjustment for Net Treasury Rate Sign                                       CAS005
      *                                                                                       CAS005
     C           #0ANTR    IFNE *BLANKS                                                       CAS005
     C           #0SIGN    IFNE '+'                                                           CAS005
     C           #0SIGN    ANDNE'-'                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE ' 182'    ERCD,S                                              CAS005
     C                     MOVE *ON       *IN37                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           #0SIGN    IFEQ '+'                                                           CAS005
     C                     MOVE *ON       *IN27                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           #0SIGN    IFEQ '-'                                                           CAS005
     C                     MOVE *ON       *IN28                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
0586 C**
0587 C           ENDINS    TAG                             ** ENDINS TAG *
0588 C**
0589 C** END OF VALIDATION - IF NO ERRORS,LOG AND UPDATE
0590 C**
0591 C           S         COMP 0                    66
0592 C   66
0593 COR U7 U8             GOTO ENDALL
0594 C**
0595 C                     EXSR UDLOG
0596 C**
0597 C** IF SUCCESSFUL EXIT,RETURN FRESH INSERT SCREEN
0598 C**
0599 C  N69                EXSR SCNOUT
0600 C   69                SETON                     40
0601 C           ENDALL    ENDSR                           ** ENDALL **
0602 C**
0603 C********************************************************************
 252 C*
 253 C*    ROUTINE TO ACCESS STRAN RELATIVE FILE HEADER RECORD AND
 242 C*    DUMMY UPDATE/LOCK TO PREVENT EXTERNAL UPDATE.
 254 C*
3255 C           HDRCHN    BEGSR                           *** HDRCHN ***
 256 C*
3259 C           1         CHAINSTRAN                45
3248 C  N45                EXCPTRECLCK
 245 C*
3247 C  N45      1         CHAINSTRAN                45
 260 C*
3261 C                     ENDSR
 262 C*
 263 C********************************************************************
0604 C**
0605 C** SUBROUTINE TO UPDATE STRAN FILE
0606 C** CALLED FROM UDLOG
0607 C** CALLS GLZADD
0608 C           UPDATE    BEGSR
0609 C** STRAN HEADER UPDATE
0610 C           1         CHAINSTRAN                49
0611 C  N07                SETON                     U7U8
0612 C  N07                MOVE '03'      DBASE
0613 C  N07                MOVEL'00001   'DBKEY
0614 C  N07                MOVE 'STRAN'   DBFILE
0615 C  N07                GOTO ENDUP
0616 C           NAVT      ADD  1         NAVT2   50
0617 C**
0618 C** MOVE ADJUSTMENT AMOUNT INTO ZZAMT FOR HASH TOTALLING
0619 C**
0622 C   64      NOIL      ADD  1         NOIL2   50
0623 C   65      NODL      ADD  1         NODL2   50
0624 C                     MOVE OTADJ     ZZAMT
0625 C**
0626 C   64                Z-ADDHLIW      ZZTOTI
0627 C   64                Z-ADDHLID      ZZTOTD
0628 C   65                Z-ADDHLDW      ZZTOTI
0629 C   65                Z-ADDHLDD      ZZTOTD
0630 C                     EXSR GLZADD
0631 C   64                Z-ADDZZTOTI    HLIW2  150
0632 C   64                Z-ADDZZTOTD    HLID2   30
0633 C   65                Z-ADDZZTOTI    HLDW2  150
0634 C   65                Z-ADDZZTOTD    HLDD2   30
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
      *                                                                   CAC001
      ** Move Accrued COF Adjustment Amt into ZZAMT for hash totalling    CAC001
      *                                                                   CAC001
     C           *IN58     IFEQ '1'                                       CAC001
     C           *IN64     IFEQ '1'                                       CAC001
     C           NOIL2     ADD  1         NOIL2                           CAC001
     C                     Z-ADDHLIW2     ZZTOTI                          CAC001
     C                     Z-ADDHLID2     ZZTOTD                          CAC001
     C                     ELSE                                           CAC001
     C           NOIL      ADD  1         NOIL2                           CAC001
     C                     Z-ADDHLIW      ZZTOTI                          CAC001
     C                     Z-ADDHLID      ZZTOTD                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C           *IN59     IFEQ '1'                                       CAC001
     C           *IN65     IFEQ '1'                                       CAC001
     C           NODL2     ADD  1         NODL2                           CAC001
     C                     Z-ADDHLDW2     ZZTOTI                          CAC001
     C                     Z-ADDHLDD2     ZZTOTD                          CAC001
     C                     ELSE                                           CAC001
     C           NODL      ADD  1         NODL2                           CAC001
     C                     Z-ADDHLDW      ZZTOTI                          CAC001
     C                     Z-ADDHLDD      ZZTOTD                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     MOVE OTCOF     ZZAMT                           CAC001
     C                     EXSR GLZADD                                    CAC001
     C*                                                                   CAC001
     C           *IN58     IFEQ '1'                                       CAC001
     C                     Z-ADDZZTOTI    HLIW2                           CAC001
     C                     Z-ADDZZTOTD    HLID2                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           *IN59     IFEQ '1'                                       CAC001
     C                     Z-ADDZZTOTI    HLDW2                           CAC001
     C                     Z-ADDZZTOTD    HLDD2                           CAC001
     C                     ENDIF                                          CAC001
0635 C*                                                                   CAC001
     C                     ENDIF                           ** BGN0ST 'Y' *CAC001
0635 C*                                                                   CAC001
      ** If CAS005 is installed, move Accrued NTR Adjustment Amount                           CAS005
      ** into ZZAMT for hash totalling                                                        CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
     C           *IN27     IFEQ '1'                                                           CAS005
     C           *IN64     IFEQ '1'                                                           CAS005
     C           NOIL2     ADD  1         NOIL2                                               CAS005
     C                     Z-ADDHLIW2     ZZTOTI                                              CAS005
     C                     Z-ADDHLID2     ZZTOTD                                              CAS005
     C                     ELSE                                                               CAS005
     C           NOIL      ADD  1         NOIL2                                               CAS005
     C                     Z-ADDHLIW      ZZTOTI                                              CAS005
     C                     Z-ADDHLID      ZZTOTD                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN28     IFEQ '1'                                                           CAS005
     C           *IN65     IFEQ '1'                                                           CAS005
     C           NODL2     ADD  1         NODL2                                               CAS005
     C                     Z-ADDHLDW2     ZZTOTI                                              CAS005
     C                     Z-ADDHLDD2     ZZTOTD                                              CAS005
     C                     ELSE                                                               CAS005
     C           NODL      ADD  1         NODL2                                               CAS005
     C                     Z-ADDHLDW      ZZTOTI                                              CAS005
     C                     Z-ADDHLDD      ZZTOTD                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE OTNTR     ZZAMT                                               CAS005
     C                     EXSR GLZADD                                                        CAS005
      *                                                                                       CAS005
     C           *IN27     IFEQ '1'                                                           CAS005
     C                     Z-ADDZZTOTI    HLIW2                                               CAS005
     C                     Z-ADDZZTOTD    HLID2                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN28     IFEQ '1'                                                           CAS005
     C                     Z-ADDZZTOTI    HLDW2                                               CAS005
     C                     Z-ADDZZTOTD    HLDD2                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0636 C           ENDUP     ENDSR
0637 C**
0638 C********************************************************************
0639 C**
0640 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.   S01194
0641 C**********                                                          S01194
0642 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
2265 C**************                                                      S01194
2266 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
2267 C**************       MOVEL'01      'ZTABKY 12                       S01194
2268 C**************       MOVE '  10'    ZTABKY                          S01194
2269 C**************                                                      S01194
2270 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
2271 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**********                                                          S01194
0650 C**********                                                          S01194
0651 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.                    S01194
0652 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0653 C**********                                                          S01194
2276 C********** ENDZSY    ENDSR                                          S01194
2276 C**************       ENDSR                                          S01194
0655 C**
0656 C**
0657 C********************************************************************
0658 C**
0659 C** SUBROUTINE TO GET CORRECT TIME
0660 C** CALLED FROM M.P.,UDLOG
0661 C           TIME      BEGSR
0662 C                     TIME           MTIME   60       ** TIME **
0663 C                     ENDSR
0664 C**
0665 C********************************************************************
0666 C**
0667 C** SUBROUTINE TO OUTPUT & RECORD AND SET OFF INDICATORS
0668 C** CALLED FROM SRINS,UDLOG
0669 C           EXCPTN    BEGSR                           ** EXCPTN **
     C/COPY WNCPYSRC,LE0090C003
0670 C                     EXCPT
0673 C                     SETOF                     7778
0674 C                     SETOF                     7980
0675 C                     ENDSR
0687 C********************************************************************
0688 C**
0689 C** SUBR. TO PERFORM UPDATING
0690 C** CALLED FROM SRINS
0691 C** CALLS LOGCHN
0692 C           UDLOG     BEGSR
0693 C**
0694 C** IF A DATABASE OR SYSTEM ERROR IS FOUND INDICATORS
0695 C** ARE SET TO - REFLECT THE ERROR CONDITION,RELEASE
0696 C** FILES,RELEASE SCREEN AND TO END PROGRAM.
0697 C**
0700 C*
0701 C*    ACCESS LOANS RECORD TO BE UPDATED
0702 C           LNKEY     CHAINCLOAN                44
0703 C   44                SETON                     U7U8
0704 C   44                MOVE '04'      DBASE
0705 C   44                MOVELLNKEY     DBKEY
0706 C   44                MOVE 'CLOAN'   DBFILE
0707 C   44                GOTO ENDD
0708 C** CHECK IF REC. UPDATED BY ANOTHER WS
0709 C   04      LSTC      COMP LSTCS                    34
0710 C   04N34
0711 COR 06                SETON                     69
0712 C   69                MOVELEMES,1    ERRMSG
0713 C   69                SETON                     80
0714 C   69                EXSR EXCPTN
0715 C   69                GOTO ENDD
0716 C*
     C**  OBTAIN LAST TRANSACTION NUMBER  AND SET UP STANDARD OUTPUT
     C**  INFORMATION
     C                     EXSR ZTNLU1
     C                     MOVE 'LE'      MDID    2
     C                     MOVEL'LE0090'  PGMN    8
     C                     MOVE WSID      WSIDX
     C                     MOVE 'A'       ACTCD
     C                     MOVE USRID     USRIDX
     C**
0755 C** UPDATE STRAN DETAIL
 156 C*  LOCK HDR BY READ & DUMMY UPDATE
2156 C                     EXSR HDRCHN
0757 C  N07                SETON                     U7U8
0758 C  N07                MOVEL'00001   'DBKEY
0759 C  N07                MOVEL'STRAN'   DBFILE
0760 C  N07                MOVE '07'      DBASE
0761 C  N07                GOTO ENDD
0762 C           MNT       SUB  NAVT      DIFF    50
0763 C           DIFF      COMP 10                     8282
0764 C      82   DIFF      COMP 2                      8383
0765 C   83                SETON                     U6U8
0766 C   83                GOTO ENDD
0767 C           NAVT      CHAINSTRAN                45
0768 C  N45      RECI      COMP ' '                  4545
0769 C   45                SETON                     U7U8
0770 C   45                MOVELNAVT      DBKEY
0771 C   45                MOVEL'STRAN'   DBFILE
0772 C   45                MOVE '08'      DBASE
0773 C   45                GOTO ENDD
0774 C                     SETON                     78
0775 C                     EXSR TIME
0776 C                     EXSR EXCPTN
0777 C**
0787 C** UPDATE STRAN HEADER RECORD.
0788 C                     EXSR UPDATE
0789 C                     SETON                     77
0791 C                     EXSR EXCPTN
0792 C**
0807 C** GET LOG FILE RECORD TO LOG UPDATE.
0815 C   64      AIMN      ADD  OTADJ     AIANA  130       ** LOANS FILE *
0816 C   65      AIMN      SUB  OTADJ     AIANA  130       ** UPDATE **
      *                                                                   CAC001
      ** Get log file record to log update.                               CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                        ** BGN0ST 'Y' *CAC001
     C           *IN58     IFEQ '1'                                       CAC001
     C           ACAJ      ADD  OTCOF     AACAJ  130       ** LOANS FILE *CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C           *IN59     IFEQ '1'                                       CAC001
     C           ACAJ      SUB  OTCOF     AACAJ  130       ** UPDATE **   CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                           ** BGN0ST 'Y' *CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
     C           *IN27     IFEQ *ON                                                           CAS005
     C           AINN      ADD  OTNTR     AAINN  130                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN28     IFEQ *ON                                                           CAS005
     C           AINN      SUB  OTNTR     AAINN                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
0817 C**
0819 C**   AMEND LOANS DETAIL RECORD
0820 C                     SETON                     79
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
      *                                                                                       CAS009
      **   Update the EIR Recalculation Indicator to 'Y'                                      CAS009
      *                                                                                       CAS009
     C                     EXSR UPDEIR                                                        CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
0822 C                     EXSR EXCPTN
0823 C**
     C/COPY WNCPYSRC,LE0090C001
0845 C***********                                                                             220754
     C*****END*COMMITMENT CYCLE                                                               220754
     C***********CMTTXT    COMIT                                                              220754
      *                                                                                       204130
     C           LNKEY     CHAINCLOAN                44                                       204130
     C           *IN44     IFEQ '0'                                                           204130
     C                     MOVELABSTS     Z#ASTS                                              204130
     C                     EXSR SRSHDW                                                        204130
     C                     ENDIF                                                              204130
     C                     MOVEL*BLANKS   BEFORE                                              220754
     C**                                                                                      220754
     C**   END COMMITMENT CYCLE                                                               220754
     C           CMTTXT    COMIT                                                              220754
      *                                                                                       204130
0846 C**
0847 C           ENDD      ENDSR
0951 C********************************************************************
0952 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0953 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0954 C*
0955 CSR         GLZADD    BEGSR                           *** GLZADD ****
0956 C*
0957 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0958 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0959 C*
0960 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0961 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0962 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0963 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0964 C*
0965 CSR                   EXSR GLZSUM
0966 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0967 C*
0968 C********************************************************************
0969 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0970 C*                        GLZADD, GLZSUB, GLZCMP.
0971 C*          PARAMETERS PASSED -
0972 C*                     I/P ZZAMTI ZZAMTD
0973 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0974 C*
0975 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0976 C*
0977 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0978 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0979 CSR                   SETOF                     919293
0980 CSR                   SETOF                     949599
0981 C*
0982 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0983 CSR         ZZAMTI    COMP 0                      9293
0984 CSR 93      ZZAMTD    COMP 0                      9293
0985 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0986 C*
0987 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0988 CSR         ZZTOTI    COMP 0                      9193
0989 CSR 93      ZZTOTD    COMP 0                      9193
0990 C*
0991 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0992 CSR 93                Z-ADDZZAMTI    ZZTOTI
0993 CSR 93                Z-ADDZZAMTD    ZZTOTD
0994 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0995 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0996 CSR 91N92
0997 CORN91 92             GOTO ZZOFPS
0998 C*
0999 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
1000 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
1001 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
1002 C*
1003 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
1004 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
1005 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
1006 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1007 C*
1008 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1009 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1010 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1011 CSRN99                Z-ADDZZWK2     ZZTOTD
1012 CSRN99                Z-ADDZZWK3     ZZTOTI
1013 C*
1014 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1015 CSR 99                Z-ADD0         ZZAMT  153
1016 CSR                   GOTO ZZSEND
1017 C*
1018 C* THE 'SIGNS' ARE DIFFERENT
1019 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
1020 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1021 C*
1022 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
1023 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
1024 C*
1025 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1026 C*
1027 CSR 91                Z-SUBZZTOTI    ZZTOTI
1028 CSR 91                Z-SUBZZTOTD    ZZTOTD
1029 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1030 C*
1031 CSR         ZZTOTI    COMP ZZAMTI               93  95
1032 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
1033 C*
1034 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1035 CSR 95                Z-ADD0         ZZTOTI
1036 CSR 95                Z-ADD0         ZZTOTD
1037 CSR 95                GOTO ZZSEND
1038 C*
1039 C* IF ZZTOT GT. ZZAMT.
1040 CSR 93      ZZAMTD    COMP ZZTOTD               94
1041 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
1042 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
1043 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1044 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1045 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1046 C*
1047 C*
1048 C* IF ZZAMT GT. ZZTOT.
1049 CSRN93      ZZTOTD    COMP ZZAMTD               94
1050 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1051 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1052 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1053 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1054 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1055 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1056 C*
1057 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1058 CSR                   SETOF                     94
1059 CSR 93 91
1060 CORN93 92             SETON                     94
1061 CSR 94                Z-SUBZZTOTI    ZZTOTI
1062 CSR 94                Z-SUBZZTOTD    ZZTOTD
1063 C**
1064 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1065 CSR 92                Z-SUBZZAMTI    ZZAMTI
1066 CSR 92                Z-SUBZZAMTD    ZZAMTD
1067 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1068 C**
1069 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1070 CSR                   SETOF                     96
1071 CSR         ZZTOTD    COMP 0                        91
1072 CSR 91      ZZTOTI    COMP 0                      96
1073 CSR 96                MOVE '.000-'   ZZNEGD  5
1074 CSR                   ENDSR                             ** ENDSR **
     C********************************************************************
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
      /EJECT                                                                                  204130
      *****************************************************************                       204130
      * SRSHDW  -  Update shadow files                                *                       204130
      *****************************************************************                       204130
     C           SRSHDW    BEGSR                                                              204130
      *                                                                                       204130
      ** Do on-line updates to PRONO, MEMOS, OLPOS and RSACMTPD                               204130
      ** only if not a Guarantee loan, if its a Guarantee loan then                           204130
      ** it should have an interest payment date.                                             204130
      *                                                                                       204130
     C           PTYP      IFEQ 61                                                            204130
     C           PTYP      OREQ 62                                                            204130
     C           PTYP      OREQ 63                                                            204130
     C           PTYP      OREQ 64                                                            204130
     C           PTYP      OREQ 65                                                            204130
     C           PTYP      OREQ 66                                                            204130
     C           PTYP      OREQ 67                                                            204130
     C           PTYP      OREQ 68                                                            204130
     C           PTYP      OREQ 69                                                            204130
     C           PTYP      OREQ 70                                                            204130
     C           NIDT      ANDNE0                                                             204130
     C           PTYP      OREQ 71                                                            204130
     C           NIDT      ANDNE0                                                             204130
     C           PTYP      OREQ 72                                                            204130
     C           NIDT      ANDNE0                                                             204130
     C                     MOVE 'B'       LNKEY                                               220754
     C           LNKEY     CHAINCLOAN                44                                       220754
     C                     MOVE 'A'       LNKEY                                               220754
     C                     MOVEL*BLANKS   Z#ASTK                                              220754
     C                     MOVEL*BLANKS   Z#BSTK                                              220754
     C                     MOVELABSTK     Z#ASTK                                              220754
     C           BEFORE    IFEQ 'Y'                                                           220754
     C                     MOVELABSTK     Z#BSTK                                              220754
     C                     ENDIF                                                              220754
      *                                                                                       204130
     C                     CALL 'AOOULEU0'                                                    204130
     C                     PARM           PRTCD   7                                           204130
     C                     PARM           Z#BSTS                                              204130
     C                     PARM           Z#ASTS                                              204130
     C                     PARM           Z#WSTS                                              204130
     C                     PARM           Z#BSTK                                              220754
     C                     PARM           Z#ASTK                                              220754
     C                     PARM *BLANKS   CLONQD                                              CER049
      *                                                                                       204130
     C           PRTCD     IFEQ '*ERROR*'                                                     204130
     C                     EXSR *PSSR                                                         204130
     C                     ENDIF                                                              204130
     C                     ENDIF                                                              204130
      *                                                                                       204130
     C                     COMIT                                                              204130
      *                                                                                       204130
     C                     ENDSR                                                              204130
      /EJECT                                                                                  CAS009
      *****************************************************************                       CAS009
      * UPDEIR  -  Update EIR Recalculation Indicator                 *                       CAS009
      *****************************************************************                       CAS009
      *                                                                                       CAS009
     C           UPDEIR    BEGSR                                                              CAS009
      *                                                                                       CAS009
      ** Move loan number to numeric field                                                    CAS009
      *                                                                                       CAS009
     C                     MOVE INLOAN    LOANKY                                              CAS009
      *                                                                                       CAS009
     C           CAS016    IFEQ 'Y'                                                           CAS016
     C           LOANKY    CHAINLEEIRDL9             89                                       CAS016
     C                     ELSE                                                               CAS016
     C           LOANKY    CHAINLEEIRDL6             89                                       CAS009
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS016
     C           *IN89     IFEQ *OFF                                                          CAS009
      *                                                                                       CAS009
      ** Move 'Y' to EIR Recalculation Indicator                                              CAS009
      *                                                                                       CAS009
     C                     MOVE 'Y'       EIRCAL                                              CAS009
     C           CAS016    IFEQ 'Y'                                                           CAS016
     C                     MOVE 'Y'       EIADJP                                              CAS016
     C                     UPDATLEEIRDD9                                                      CAS016
     C                     ELSE                                                               CAS016
     C                     UPDATLEEIRDD0                                                      CAS009
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS016
      ** Search all fees amortised separately                                                 CAS016
     C           CAS016    IFEQ 'Y'                                                           CAS016
     C           LOANKY    CHAINLEERAPL1             89                                       CAS016
     C           *IN89     DOWEQ'0'                                                           CAS016
     C           RUND      IFLE EIENDT                                                        CAS016
     C                     MOVE 'Y'       EIRCAL                                              CAS016
     C                     UPDATLEERAPD0                                                      CAS016
     C                     ENDIF                                                              CAS016
     C           LOANKY    READELEERAPL1                 89                                   CAS016
     C                     ENDDO                                                              CAS016
      *                                                                                       CAS016
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS009
     C                     ENDSR                                                              CAS009
      *                                                                                       CAS009
      *****************************************************************                       CAS009
      * INZSR - Initialization                                        *                       CAS009
      *****************************************************************                       CAS009
      *                                                                                       CAS009
     C           *INZSR    BEGSR                                                              CAS009
      *                                                                                       CAS009
     C           *LIKE     DEFN EITRAN    LOANKY                                              CAS009
      *                                                                                       CAS009
     C                     ENDSR                                                              CAS009
      *                                                                                       CAS009
     C********************************************************************S01117
     C/COPY ZSRSRC,ZALIGNZ2                                               S01392
     C/COPY ZSRSRC,ZTNLU1Z2                                               S01392
     C********************************************************************S01117
1076 OLE0090FMD        60NKCNU6
1077 O       AND      NU7
1078 O                                   K8 'LE0090F1'
     O                         *IN41      1
     O                         *IN51      2
     O                         *IN61      3
     O                         *IN63      4
     O                         *IN67      5
     O**************************IN32      6                               CAC001
     O**************************IN33      7                               CAC001
1079 O*************************SID        9                               CAC001
1080 O*************************MTIME     17 '  .  .  '                    CAC001
1081 O*************************WSID      20                               CAC001
     O*************************INLOAN    26                        S01117 CAC001
     O*************************INCUSN    36                        S01117 CAC001
1082 O*************************SCFLD     54                               CAC001
1083 O***********************40BLK34     54                               CAC001
1084 O***********************69INLOAN    26                               CAC001
1085 O*************************ERCDS    130                               CAC001
1086 O*************************ERRMSG   206                               CAC001
     O                         *IN55      6                               CAC001
     O                         *IN56      7                               CAC001
     O                         *IN57      8                               CAC001
     O**********               *IN32      9                                            CAC001 CAS005
     O**********               *IN33     10                                            CAC001 CAS005
     O**********               SID       12                                            CAS001 CAS005
     O**********               MTIME     20 '  .  .  '                                 CAC001 CAS005
     O**********               WSID      23                                            CAC001 CAS005
     O**********               INLOAN    29                                            CAC001 CAS005
     O**********               INCUSN    39                                            CAC001 CAS005
     O**********               SCFLD     72                                            CAC001 CAS005
     O**********             40BLK49     72                                            CAC001 CAS005
     O**********             69INLOAN    29                                            CAC001 CAS005
     O**********               ERCDS    148                                            CAC001 CAS005
     O**********               ERRMSG   224                                            CAC001 CAS005
     O                         *IN35      9                                                   CAS005
     O                         *IN36     10                                                   CAS005
     O                         *IN37     11                                                   CAS005
     O                         *IN32     12                                                   CAS005
     O                         *IN33     13                                                   CAS005
     O                         SID       15                                                   CAS005
     O                         MTIME     23 '  .  .  '                                        CAS005
     O                         WSID      26                                                   CAS005
     O                         INLOAN    32                                                   CAS005
     O                         INCUSN    42                                                   CAS005
     O                         SCFLD     90                                                   CAS005
     O                       40BLK49     90                                                   CAS005
     O                       69INLOAN    32                                                   CAS005
     O                         ERCDS    166                                                   CAS005
     O                         ERRMSG   242                                                   CAS005
1093 O**
1207 O**
1208 O** STRAN - HEADER RECORD
1209 OSTRAN   E        77
1210 O                         NAVT2      6
1211 O                       64NOIL2     30P
1212 O                       64HLIW2     38P
1213 O                       64HLID2     40P
1214 O                       65NODL2     43P
1215 O                       65HLDW2     51P
1216 O                       65HLDD2     53P
1217 O                         NATN     200P
     O                       58NOIL2     30P                              CAC001
     O                       58HLIW2     38P                              CAC001
     O                       58HLID2     40P                              CAC001
     O                       59NODL2     43P                              CAC001
     O                       59HLDW2     51P                              CAC001
     O                       59HLDD2     53P                              CAC001
     O                       27NOIL2     30P                                                  CAS005
     O                       27HLIW2     38P                                                  CAS005
     O                       27HLID2     40P                                                  CAS005
     O                       28NODL2     43P                                                  CAS005
     O                       28HLDW2     51P                                                  CAS005
     O                       28HLDD2     53P                                                  CAS005
1218 O**
1219 O** STRAN DETAIL RECORD
1220 O        E        78
1221 O                                    1 'J'
1222 O                         INLOAN     7
1223 O                         CNUM      13
1224 O                         INCCY     16
1225 O                         OTADJ     23P
1226 O                         INSIGN    24
1227 O****                     BRCD      27                               S01117
1227 O                         BRCA      27                               S01117
1228 O                         FCUS      33
1229 O                         FTYP      36
1230 O                         FSEQ      38
     O                         OTCOF     75P                              CAC001
     O                         INSGN     76                               CAC001
     O                         OTNTR     83P                                                  CAS005
     O                         #0SIGN    84                                                   CAS005
1231 O                         MTIME    194
1232 O                         NAVT     197P
1233 O                         NATN     200P
 943 O*
 944 O*    DUMMY UPDATE FROM SUBRTN HDRCHN
4945 O        E                RECLCK
4942 O                         RECI
1234 O**
1235 O** LOAN DETAIL RECORD
1236 OCLOAN   E        79 04
1237 O                         LOTLN1   200
1238 O*************************LOTLN2   400                               S01270
1238 O*************************LOTLN2   434                         S01270S01220
1238 O                         LOTLN2   436                               S01220
     O**********               LOTLN3  1187                                            CAC001 CAS005
     O**********               LOTLN3  1432                                            CAS005 CAP074
     O                         LOTLN3  1559                                                   CAP074
1239 O                         AIANA    376P
     O                       55AACAJ   1131P                              CAC001
     O**********             35AAINN   1397P                                           CAS005 CAP074
     O                       35AAINN   1424P                                                  CAP074
     O**  IF THE CHANGE DATE AND ACTION CODE IS AMENDED, THEN THE         E86103
     O**  PARTS PURCHASED AND SOLD TODAY REPORT (LE0130) IS IN ERROR.     E86103
1240 O**                       RUND     396P                              E86103
1241 O**                                397 'A'                           E86103
     O**                                                                  E86103
1242 O                         NATN     400P
1243 O*
1244 O*    LOAN FILE RELEASE
1245 O        E        80
     O*                                                                   CAC001
     O** Added 8th message to EMES array for input disability.            CAC001
     O*                                                                   CAC001
**   EMES - ERROR MESSAGES
THIS RECORD HAS BEEN UPDATED BY ANOTHER WORK STATION
WARNING - STRAN FILE NEARLY FULL
USER IS NOT AUTH. TO ANY ACTION CODES FOR THIS MENU ITEM AND BRANCH
USER IS NOT AUTH. TO THE ACTION CODE FOR THIS MENU ITEM AND BRANCH
USER IS NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM
USER IS NOT AUTHORISED TO ANY ORIGINATING BRANCHES
USER IS NOT AUTHORISED TO THE ORIGINATING BRANCH
INPUT NOT ALLOWED. LOAN IS NOT DIRECTLY FUNDED.                           CAC001
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
