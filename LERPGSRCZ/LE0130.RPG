     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Input cycle confirmations print')             *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Customer Lending Module                              *
     F*                                                               *
     F*  LE0130 - INPUT CYCLE CONFIRMATIONS PRINT                     *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD053295           Date 13Apr19               *
      *  Prev Amend No. CLE071             Date 18Jul18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CLE141             Date 08Feb16               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR322732           Date 23Jul12               *
      *                 CLE148             Date 23Jul12               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG22218           Date 23Jan09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CPK028             Date 25Jan08               *
      *                 246141             Date 26Mar07               *
      *                 245082             Date 29Jan07               *
      *                 164847             Date 30Nov06               *
      *                 CRE026             Date 19Feb07               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CLE047             Date 13Feb06               *
      *                 130808             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CAS009             Date 16May05               *
      * Midas Plus 1.2 -----------------------------------------------*
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4488            Date 18Oct04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAP074             Date 08Aug02               *
      *                 CLE033             Date 02Apr03               *
      *                 CLE031             Date 03Feb03               *
      *                 CAS005             Date 16Dec02               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 CLE028             Date 27Jun02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 207469             Date 09Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 209887             Date 26Sep02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 179355             Date 15Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 159259             Date 09Jun99               *
      *                 161157             Date 21May99               *
      *                 138866             DATE 21Jan99               *
     F*                 140158             DATE 13OCT98               *
     F*                 131730             DATE 21SEP98               *
      *                 144915             Date 28Oct98               *
     F*                 CEU004             Date 29MAR98               *
     F*                 121768             DATE 19FEB98               *
     F*                 126017             DATE 17NOV97               *
     F*                 CLE005             DATE 22MAY97               *
     F*                 CLE004             DATE 02DEC96               *
     F*                 097885             DATE 31JAN97               *
     F*                 S01408             DATE 11NOV96               *
     F*                 S01408             DATE 04SEP96               *
     F*                 CSW096             DATE 03SEP96               *
     F*                 091120             DATE 14JUN96               *
     F*                 070256             DATE 29APR96               *  *
     F*                 068669             DATE 29APR96               *  *
     F*                 S01408             DATE 24APR96               *
     F*                 S01408             DATE 12APR96               *
     F*                 S01408             DATE 04JAN96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 S01465             DATE 22MAR94               *
     F*                 066550             DATE 04FEB94               *
     F*                 S01392             DATE 14SEP92               *
     F*                 E39524             DATE 03JUN92               *
     F*                 E31465             DATE 31MAR92               *
     F*                 S01344             DATE 31MAR92               *
     F*                 S01310             DATE 31MAR92               *
     F*                 S01270             DATE 21MAR91               *
     F*                 S01220             DATE 15MAR91               *
     F*                 LN0469             DATE 02AUG90               *
     F*                 BHF312             DATE 02AUG90               *
     F*                 LN0470             DATE 27JUL90               *
     F*                 LN0345             DATE 27APR90               *
     F*                 LN0007             DATE 27APR90               *
     F*                 S01194             DATE 19DEC89               *
     F*                 E13046             DATE 13DEC89               *
     F*                 S01117             DATE 29/08/89              *
     F*                 E13514             DATE 17/08/88              *
     F*                 S01167             DATE 25/08/88              *
     F*                 S01135             DATE 03/12/87              *
     F*                 E10916             DATE 28/07/87              *
     F*                 E10924             DATE 01/06/87              *
     F*                 E47247             DATE 12/05/87              *
     F*                 S01118             DATE 11/03/87              *
     F*                 E43748             DATE 28/11/86              *
     F*                 E49673             DATE 23/10/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR322732 - LEC0212A and APISERVER locks LTRIX file.          *
      *           - Prevent LTRIX RRN 1 from being locked.            *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate (Recompile)                                    *
      *  CLE064 - Enhancement of Lending Frequencies                  *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  BUG22218 - Applied fix 255752                                *
      *  255752   - Missing loan confirmations. If UDC is present,    *
      *             only print confirmations with CNPR = 'S' (set by  *
      *             CG6000).                                          *
      *  CPK028 - Customer numbers should be alphanumeric.            *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Applied fix 235784 from Release 4.                  *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CRE026 - Consumer Banking                                    *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CLE047 - Only calculate interest until NIDT                  *
      *           (Upgrade to Midas Plus 1.2)                         *
      *  130808 - L-spec overrides page length on PRTF                *
      *           L-spec removed so that changed PRTF page length     *
      *           of 44 is recognised when Midas produces LE Conf     *
      *           spooled files.                                      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4488- Loop in APCONFS when an LECONF is sent to data queue*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements.                               *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  207469 - Condition confirmation generation with ENFFCR and   *
      *           with the confirmation's network.                    *
      *  209887 - Lending confirmations not produced. Produce confs   *
      *           for loans inserted and amended on the same day, and *
      *           always on authorisation of the loan.                *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
     F*  179355 - Confirmations not throwing new page for each conf   *
     F*           and not starting on line 12 as per other confs.     *
     F*           Amended change S01465 to allow confirmations to     *
     F*           start on correct line. Note - Recipient of Guarantee*
     F*           details, if required, are output in place of Special*
     F*           Instructions Line 2.                                *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  159259 - Confirmations are to be printed even with zero      *
      *           principal                                           *
      *  161157 - Dbase Error 23, file LELOANL0 in LE0130             *
      *  138866 - Confirmation from principal transfer loan should    *
      *           have amounts of principal and interest.             *
     F*  140158 - Loan confirmation advice notice shows incorrect     *
     F*           'Payment by and to' details.                        *
     F*  131730 - Confirmation interest problems for all repayment    *
     F*           types:- Show interest to next repayment date or next*
     F*           interest payment date or next rollover date,        *
     F*           depending on repayment type. Enhanced fix 124616.   *
     F*           Next repayment date was considered for repayment    *
     F*           type 2.                                             *
     F*  144915 - Recompiled due to changes in LF/CLOAN.              *
      *  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  CLE004 - Customer Lending Enhancements - Syndications.       *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  S01408 - Addition of core hook LE0130OP20                    *
     F*  S01408 - Addition of core hook LE0130CCP7                    *
     F*           Addition of core hook LE0130CCP8                    *
     F*           Addition of core hook LE0130CCP9                    *
     F*           Addition of core hook LE0130FFP2                    *
     F*           Addition of core hook LE0130OP15                    *
     F*           Addition of core hook LE0130OP16                    *
     F*           Addition of core hook LE0130OP17                    *
     F*           Addition of core hook LE0130OP18                    *
     F*           Addition of core hook LE0130OP19                    *
     F*  CSW096 - SWIFT changes 1996                                  *
     F*  091120 - Interest and total amount incorrect in              *
     F*           Loan Confirmation for Repayment types               *
     F*           types "1" and "3".                                  *
     F*         - Change the declaration of TOWN1 & TOWN2             *
     F*           to 11 long so as not to truncate branch.            *
     F*  070256 - NO INTEREST CALCULATED FOR REPAYMENT TYPES 1 & 3    *
     F*  068669 - IF LOAN HAS ROLLOVER DATE AND NEXT INTEREST DATES   *
     F*           CALCULATE INTEREST UPTO NEXT INT. DATE RATHER       *
     F*           THAN FROM VALUE DATE TO MATURITY.                   *
     F*  S01408 - Addition of core hook LE0130OOP5                    *
     F*           Addition of core hook LE0130OOP6                    *
     F*           Addition of core hook LE0130OOP7                    *
     F*           Addition of core hook LE0130OOP8                    *
     F*           Addition of core hook LE0130OOP9                    *
     F*           Addition of core hook LE0130OP10                    *
     F*           Addition of core hook LE0130OP11                    *
     F*           Addition of core hook LE0130OP12                    *
     F*           Addition of core hook LE0130OP13                    *
     F*           Addition of core hook LE0130OP14                    *
     F*  S01408 - Addition of core hook LE0130OOP3                    *
     F*           Addition of core hook LE0130OOP4                    *
     F*  S01408 - Addition of core hook LE0130FFP1                    *
     F*           Addition of core hook LE0130LLP1                    *
     F*           Addition of core hook LE0130LLP2                    *
     F*           Addition of core hook LE0130IIP1                    *
     F*           Addition of core hook LE0130IIP2                    *
     F*           Addition of core hook LE0130CCP1                    *
     F*           Addition of core hook LE0130CCP2                    *
     F*           Addition of core hook LE0130CCP3                    *
     F*           Addition of core hook LE0130CCP4                    *
     F*           Addition of core hook LE0130CCP5                    *
     F*           Addition of core hook LE0130CCP6                    *
     F*           Addition of core hook LE0130OOP1                    *
     F*           Addition of core hook LE0130OOP2                    *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  S01465 - BLI Guarantees Issued Enhancement.                  *
     F*  066550 - GLINTC has had historical problems and inaccuracies *
     F*           and is now externaly descibed and changed to use    *
     F*           ZINTDYZ1. See document atached to error no on GEMS  *
     F*  S01392  -  JAPANESE SUB MODULE ENHANCEMENTS                  *
     F*  E39524  -  SUPPRESS WRITE TO THE EXTRACT FILE FOR A MESSAGE  *
     F*             IF THE SETTLEMENT DETAILS HAVE BEEN LEFT BLANK    *
     F*  E31465  -  "AUTO TRANSMISSION..." MISSING FOR SWIFT MESSAGES *
     F*  S01344  -  SWIFT RATIONALISATION PHASE II                    *
     F*  S01310  -  SWIFT RATIONALISATION                             *
     F*          -  REPORT OF 'FOR A/C OF' FIELD UNTIDY               *
     F*          -  INSERT MG ROUTING                                 *
     F*          -  CONDITION ISO GEN ON SDMGMEPD/PF FLAG             *
     F*  S01270  -  AMENDED FOR CUSTOMER LENDING CHANGES              *
     F*  S01220  -  AMENDED FOR STRATEGIC RISK MANAGEMENT             *
     F*             RELEASE 10 TO ALLOW THE INPUT OF A BOOK           *
     F*             CODE AGAINST A LOAN.                              *
     F*  LN0469  -  ONLY DO THOSE LOANS WITH REQUESTED BRANCH         *
     F*  BHF312  -  POSITION 'FOR A/C OF' FIELD CORRECTLY.            *
     F*  LN0470  -  CORRECT 'SWIFT DO NOT SEND' LINES INCL. S01118    *
     F*             CHANGE- PREVENT SPECIAL INSTRUCTIONS LINE 3       *
     F*             APPEARING TWICE AND CAUSING PAGE OVERFLOW         *
     F*  LN0345  -  'MOVE' TO FIELD 'CKEY' SHOULD BE 'MOVEL'          *
     F*  LN0007  -  USE OF ALTERNATIVE ADDRESS INCORRECTLY CODED      *
     F*  S01194  -  STANDING DATA CHANGES.                            *
     F*  E13046  -  LOAN CONFIRMATIONS DO NOT PRINT OUT THE TOTAL     *
     F*             INTEREST FOR TERM LOANS. ALSO, TO BRING THE AS400 *
     F*             VERSION INTO LINE WITH S/38, SOME REDUNDANT LINES *
     F*             OF CODE (S01135) WERE REMOVED AFTER CONSULTATION  *
     F*             WITH THE SWIFT TEAM.                              *
     F*  S01117  -  MULTIBRANCHING                                    *
     F*  S01167  -  INCORPORATION OF BIC CODES + MT200'S              *
     F*  E13514  -  BENEFICIARY MISSPELT ON OUTPUT SPEC               *
     F*  S01135  -  MAKE SURE THAT TELEX NUMBER AND SWIFT ID ARE      *
     F*             PUT IN CORRECTLY IN EXTRACT FILE DEPENDING ON     *
     F*             WHETHER TELEX OR SWIFT CUSTOMER                   *
     F*  E10916  -  WHEN PRINTING CONFIRMATION FOR A CALL LOAN        *
     F*             DOES NOT CHECK IF MATURITY DATE HAS BEEN          *
     F*             ENTERED.                                          *
     F*  E10924  -  SPECIAL INSTRUCTIONS NOT PRINTED ON LOAN          *
     F*             CONFIRMATION IF PROCESSING TYPE IS 70             *
     F*  E47247  -  CHANGE CUSTOMER NAME AND ADDRESS LINES TO START   *
     F*             ON LINE 38                                        *
     F*  S01118  -  MIDAS/S.W.I.F.T. DIRECT LINK                      *
     F*  E43748  -  A DELETED CLINT RECORD CAUSES TERMINATION DUE     *
     F*             TO AN UNIDENTIFIED RECORD.                        *
     F*  E49673  -  A loan input today was having it's action code    *
     F*             ('I') overwritten with 'A' on CLOAN.              *
     F*             N.B. This error is a R11 error transferred to R21 *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*LTRIX***UF  F      40            DISK                           U1                   AR322732
     FLTRIX   UF  F      45            DISK                           U1                    AR322732
     F                                              KCOMIT
     F*SLTIX***IF  F      40  1AI     1 DISK                           U2                   AR322732
     FSLTIX   IF  F      45  1AI     1 DISK                           U2                    AR322732
     F*CLOAN***UF**F*****400  7AI     2 DISK                              S01220
     F***CLOAN***UF**F     436  7AI     2 DISK                      S01220S01465
     F***CLOAN   UF  F     458  7AI     2 DISK                     S01465 CLE004
     F***CLOAN***UF  F    1284  7AI     2 DISK                     CLE004 CEU004
     F*CLOAN***UF**F    1290  7AI     2 DISK                       CEU004 CLE011
     F*CLOAN***UF  F    1310  7AI     2 DISK                                           CLE011 CLE028
     F*CLOAN***UF  F    1375  7AI     2 DISK                                           CLE028 CAS004
     F***CLOAN***UF  F    1389  7AI     2 DISK                                                CAS004
     F***CLOAN***UF  F    1492  7AI     2 DISK                                         CLE031 CLE034
     F***CLOAN***UF  F    1493  7AI     2 DISK                                         CLE034 CAP074
     F***CLOAN** UF  F    1560  7AI     2 DISK                                         CAP074 CGL029
     F*CLOAN***UF**F****1632  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** UF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** UF  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   UF  F    1874  7AI     2 DISK                                                   CLE134
     F                                              KCOMIT
     F***LOAMS***IF  F    1057 14AI     2 DISK                                         138866 CLE031
     F***LOAMS   IF  F    1087 14AI     2 DISK                                         CLE031 CLE034
     F***LOAMS   IF  F    1109 14AI     2 DISK                                         CLE034 CAP075
     FLOAMS   IF  F    1176 14AI     2 DISK                                                   CAP075
     F***LELOANL0IF  F    1284  6AI     2 DISK                     CLE005 161157
     F*LBLOANL1IF**F    1287  6AI     2 DISK                       161157 CLE011
     F*LBLOANL1IF**F    1310  6AI     2 DISK                                           CLE011 CLE028
     F*LBLOANL1IF**F    1375  6AI     2 DISK                                           CLE028 CAS004
     F*LBLOANL1IF**F    1389  6AI     2 DISK                                           CAS004 CAS005
     F*LBLOANL1IF**F    1466  6AI     2 DISK                                           CAS005 CLE031
     F*LBLOANL1IF**F    1492  6AI     2 DISK                                           CLE031 CLE034
     F*LBLOANL1IF**F    1493  6AI     2 DISK                                           CLE034 CAP074
     FLBLOANL1IF  F    1560  6AI     2 DISK                                                   CAP074
     F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     F*CLINT   IF  F     256  7AI     2 DISK                              S01194
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0130FFP1                                           S01408
     F*                                                                   S01408
     FLEEXTAA O   F      40            DISK                           U4
     FLEEXTAB O   F      40            DISK                           U4
     FLEEXTAC O   F      40            DISK                           U4
     F*EICTX  O   F      93            DISK                      A    U1  S01310
     F*E0130P1O** F      90           LPRINTER                  S011124   S01117
     F/COPY WNCPYSRC,LE0130F001
     F*E0130P1O** F      90           LPRINTER      KINFDS SPOOL      UC               S01117 130808
     FLE0130P1O   F      90            PRINTER      KINFDS SPOOL      UC  130808
     F/COPY WNCPYSRC,LE0130F002
     FLE0130AUO   F     132            PRINTER      KINFDS SPOOLU     UC  S01117
     F* 01            LTRIX/SLTIX HEADER
     F* 02                        DETAIL
     F* 03            CLOAN FILE DETAIL
     F* 05  -  Guarantees Issued ind. in lending ICD is active            S01465
     F* 06  -  Print receiver of the guarantee                            S01465
     F**07******      TABLE LIVE RECORD                                   S01194
     F**08******      CLINT LIVE RECORD                                   S01194
     F*    10         Decimal places for 1st set ccy = 0                                      CLE031
     F*    12         Decimal places for 1st set ccy = 1                                      CLE031
     F*    13         Decimal places for 1st set ccy = 2                                      CLE031
     F*    14         Decimal places for 1st set ccy = 3                                      CLE031
     F*    15         Decimal places for 2nd set ccy = 0                                      CLE031
     F*    16         BRANCH NAME TO BE PRINTED ON CONFIRMATIONS          S01117
     F*    17         If 1st set of sett detls is to be printed                               CLE031
     F*    20         REPAYMENT DAY NO. NON-BLANK - CLOAN
     F*    21         INTEREST FREQ.DAY NO. NON-BLANK - CLOAN
     F*       22      PTYP 61,62 OR 64                                    S01392
     F*    23         FOR ACCOUNT OF BLANK - CLOAN
     F*    24         SPECIAL INSTRUCTIONS BLANK - CLOAN 'B'
     F*    25         OUTPUT BENIFICIARY BANK DETAILS
     F*    26         Decimal places for 2nd set ccy = 1                                      CLE031
     F*    27         STOP CONFIRMATION INDICATOR ON
     F*    28         INTEREST PAYMENT FREQ. BLANK - CLOAN
     F*    29         NEXT INTEREST DATE BLANK - CLOAN
     F*    30         NEXT REPAYMENT DATE BLANK - CLOAN
     F*    31         REPAYMENT FREQ. BLANK - CLOAN
     F*       11      MBIN = 'Y'                                          S01117
     F*       12      INPUT FILE HAS AT LEAST ONE DETAIL RECORD           S01117
     F*       13      SUPPRESS THE CONTROL TOTAL FOR OUTPUT               S01117
     F********17******NARRATIVE*FROM*TABLE*NOSTROS*REL. TO BE PRINTED     S01194
     F*       17      NARRATIVE FROM SDNOSTPD REL. TO BE PRINTED          S01194
     F*       18      PRINT NAME AND REPORT TOWN - NOT OURSELVES
     F*       19      FIRST CYCLE
     F*       32      PROCESSING TYPE OF CLOAN - 61
     F*       33                                 62
     F*       34                                 63
     F*       35                                 64
     F*       36                                 65
     F*       37                                 66
     F*       38                                 67
     F*       39                                 70
     F*       40      DECIMAL PLACES FOR CCY =0
     F*       41                             =1
     F*       42                             =2
     F*       43                             =3
     F*       44      PTYP 63,65 OR 67
     F*       45           61,62,64 OR 66
     F*       46      45 ON AND REPAYMENT TYPE 1
     F*       47      REPAYMENT TYPE 2
     F*       48      45 ON ADN REPAYMENT TYPE 3
     F*       49      PAY IS RECIEVE AND VICE-VERSA
     F*       50      SETTLEMENT TYPE 00
     F*       51                      01,07, OR 08
     F*       52                      02
     F*       53                      03 OR 06
     F*       54                      04
     F*       55                      05
     F*       56                      12
     F*       57                      14
     F*       58      ONLY ACCESS CLOAN FILE 'A' RECORD
     F*       59      SAVES INDICATOR INFO. THROUGH CONF SUBR
     F*       60      WORK
     F*       61      WORK
     F*       62      ALTERNAME N+A NOT FOUND - DEFAULT TO B
     F*       63      CONFIRMATION IS A COPY
     F*       64                        CANCELLATION
     F*       65                        AMENDMENT
     F*       66      PRINT SUCCESSFUL
     F*       67      NO NOSTRO CODE PRESENT FOR SETT.TYPES 01,07,08
     F*       68      DO NOT UPDATE CLOAN RECORD
     F*       69      PRINT CONFIRMATION
     F*       70      Decimal places for 2nd set ccy = 2                                      CLE031
     F*       71      MULTIBRANCHING OUTPUT INDICATOR                     S01117
     F*       72      CLOAN UPDATE
     F*       73      UPDATE LTRIX
     F*       74      Decimal places for 2nd set ccy = 3                                      CLE031
     F*       75      RELEASE LTRIX FILE
     F*       76      If 2nd set of sett detls is to be printed                               CLE031
     F*       77      RELEASE CLOAN FILE
     F********78******OUTPUT TO THE TELEX FILE                            S01310
     F*       78      WORK INDICATOR                                      S01117
     F*       79      ROLLOVER LTRIX RECORD                               S01392
     F********81******ON*IF*COUNTERPARTY*IS*A*SWIFT*MEMBER***********     S01344
     F*       81      ON IF LEEXT RECORD IS TO BE PRODUCED                S01344
     F*       82      ALLOWS OUTPUT OF ONE LEEXT HEADER
     F*       85      TELEX NUMBER FOR TELEX CUSTOMER                     S01135
     F*       87      Processing type is 69                               CLE005
     F*       88      Processing type is 71 or 72                         CLE005
     F*       96      "DO NOT SEND" TEXT                                  S01310
     F*          U1   MODE 1 - AFTER CLOAN INPUT,OR REPRINT ONE
     F*          U2   MODE 2 - REPRINT ALL
     F*          U3   MODE 3 - INPUT CYCLE TERMINATION
     F*          U4   MODE 1 - NORMAL PRINTING & OUTPUT TO LEEXT
     F/COPY WNCPYSRC,LE0130FFP2                                           S01408
     E***********         TABTYP  1   8  2 0 TABNO   5   LOAN TYPES & KEY CLE005
     E**********          TABTYP  1  13  2 0 TABNO   5   LOAN TYPES & KEY              CLE005 CLE028
     E                    TABTYP  1  14  2 0 TABNO   5   LOAN TYPES & KEY                     CLE028
     E                    NAME    1   3 28   START   2   CONFIRMN. NAMES
     E***********         NARN    1   4 38               NARRATIVE NAMES  S01392
     E***********         NARN    1   5 38               NARRATIVE S01392 CLE005
     E                    NARN    1   8 45               NARRATIVE NAMES  CLE005
     E                    NARRA   1   1 25               NARRATIVE CONSTS.
     E/COPY WNCPYSRC,LE0130E001
     E***********         TITL12  1   1 68               OUR NOSTRO CONSTSS01392
     E                    TITL12  1   2 68               OUR NOSTRO CONSTSS01392
     E                    TITL5   1   1 35                                                    CLE031
     E                    NAME12  1   3 50                IN TITLE & NAME
     E                    NAME34  1   1 50               THEIR NOS.CONSTS.
     E**********          TABF    1   7  1   TABFRQ 11   INTEREST FREQS.                      CLE064
     E                    TABF    1  20  1   TABFRQ 15   INTEREST FREQS.                      CLE064
     E                    AR         72  1               NARRATIVE SET UP
     E                    DEDIT  31  31  2               DATE EDIT ARRAY
      /COPY ZSRSRC,ZDATE2Z1                                               S01392
     L*PRINT   42FL 42OL                                                  S01124
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,LE0130E002
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E/COPY ZSRSRC,ZPOWERZ1                                                                   CLE031
     L*                                                                   S01408
     L/COPY WNCPYSRC,LE0130LLP1                                           S01408
     L*                                                                   S01408
     L*E0130P1*42FL*42OL**************                             S01124 130808
     L*                                                                   S01408
     L/COPY WNCPYSRC,LE0130LLP2                                           S01408
     L*                                                                   S01408
     I*
     I*    LOAN TRANSACTIONS INDEX FILE - HEADER RECORD.
     I*
     ILTRIX   NS  01   1 CH
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                    P   9  110NORE
     I                                    P  12  140FLSZ
     I                                    P  15  170RRLC
     I                                    P  18  200RRNA
     I                                    P  21  230RRLX
     I                                    P  24  260RRXP
     I                                    P  27  290NLNR
     I                                    P  30  320NLAR
     I                                       33  330STPI        27
     I                                    P  38  400TNLU
     I**
     I**   LOT USED FOR LOGGING
     I                                        1  40 LOT
     I*
     I*    LOAN TRANSACTIONS INDEX FILE - DETAIL RECORD.
     I*
     ILTRIX   NS  02   1 CD   2 CL
     I       OR        1 CD   2 CR                                        S01392
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                        9  130VDAT
     I                                       14  160LASN
     I                                       17  17 CHTP
     I                                       18  18 CNRQ
     I                                       19  19 CNPR
     I                                       20  20 REPR
     I                                       21  250RRLA
     I                                       26  26 LADI
     I                                       27  270PRI1
     I                                       32  34 BRCA                  LN0469
     I                                    P  35  370RRNT
     I                                    P  38  400TNLU
     I                                       41  410PRI2                                    AR322732
     I                                       42  420PRI3                                    AR322732
     I                                       43  430PRI4                                    AR322732
     I                                       44  44 CFPF                                    AR322732
     I                                       45  45 PRPF                                    AR322732
     I**
     I**   'LOT' USED FOR LOGGING
     I                                        1  40 LOT
     I*
     I        NS
     I                                        1  40 LOT
     I*
     I*    LOAN TRANSACTIONS INDEX FILE - HEADER RECORD.
     I*
     ISLTIX   NS  01   1 CH
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                    P   9  110NORE
     I                                    P  12  140FLSZ
     I                                    P  15  170RRLC
     I                                    P  18  200RRNA
     I                                    P  21  230RRLX
     I                                    P  24  260RRXP
     I                                    P  27  290NDLR
     I                                    P  30  320NDAR
     I                                       33  330STPI        27
     I                                    P  38  400TNLU
     I*
     I*    LOAN TRANSACTIONS INDEX FILE - DETAIL RECORD.
     I*
     I        NS  02   1 CD   2 CL
     I       OR        1 CD   2 CR                                        S01392
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                        9  130VDAT
     I                                       14  160LASN
     I                                       17  17 CHTP
     I                                       18  18 CNRQ
     I                                       19  19 CNPR
     I                                       20  20 REPR
     I                                       21  250RRLA
     I                                       26  26 LADI
     I                                       27  270PRI1
     I                                       32  34 BRCA                  LN0469
     I                                    P  35  370RRNT
     I                                    P  38  400TNLU
     I                                       41  410PRI2                                    AR322732
     I                                       42  420PRI3                                    AR322732
     I                                       43  430PRI4                                    AR322732
     I                                       44  44 CFPF                                    AR322732
     I                                       45  45 PRPF                                    AR322732
     I        NS
     I**
     I**   CUSTOMER LENDING LOANS FILE - HEADER RECORD
     I**
     ICLOAN   NS       1 CH
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDT
     I**
     I**   LOANS FILE - DETAIL 1
     I**
     I        NS  03   1 CD   8 CA
     I       OR        1 CM   8 CA
     I       OR        1 CR   8 CA
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDT
     I                                        9   90MRIN
     I                                       10  110PTYP
     I**********                             12  170CNUM                                      CSD027
     I                                       12  17 CNUM                                      CSD027
     I*****                                  18  200BRCD                  S01117
     I                                       18  20 BRCA                  S01117
     I                                       21  22 LTYP
     I                                       23  24 SUTP
     I                                    P  25  270DDAT
     I                                    P  28  300VDAT
     I                                    P  31  330MDAT
     I*                                                                   S01408
     I/COPY WNCPYSRC,LE0130IIP1                                           S01408
     I*                                                                   S01408
     I                                       34  350LASQ
     I**********                             36  410FCUS                                      CSD027
     I                                       36  41 FCUS                                      CSD027
     I                                       42  440FTYP
     I                                       45  460FSEQ
     I                                       47  49 CCY
     I                                    P  50  560CPAM
     I                                       57  57 INTC
     I                                    P  58  637INTR
     I                                       64  650BRTT
     I                                    P  66  717BRTE
     I                                    P  72  777RTSP
     I                                    P  78  815MARG
     I                                       82  82 SPIN
     I                                       83  83 CHIN
     I                                    P  84  897WTRT
     I                                       90  90 WTIN
     I                                       91  91 REPT
     I                                    P  92  980RAMT
     I                                    P  99 1010NRPD        30
     I                                      102 102 RFRQ            31
     I                                      103 1040RDYN        20
     I                                      105 107 FCCY
     I                                      108 1100LIND
     I                                      111 112 CRSK
     I                                      113 114 ACOF
     I                                      115 115 NACD
     I                                      116 116 RELI
     I                                      117 117 AUTO
     I                                    P 118 1240PSAM
     I                                    P 125 1318BCXR
     I                                    P 132 1388FCXR
     I                                      139 1400SDST
     I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 OSDAQQ                                    CGL029
     I                                      153 162 TSTN
     I                                      163 1640MDST
     I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 OMDAQQ                                    CGL029
     I                                      177 186 TMAN
     I                                      187 196 FACO            23
     I/COPY WNCPYSRC,LE0130I004
     I                                    P 197 1990RLDT
     I                                    P 200 2020NROD
     I                                      203 203 RLFQ
     I                                      204 2050RLDY
     I/COPY WNCPYSRC,LE0130I005
     I                                      206 206 RDFC                  S01392
     I                                      207 2080NBRA
     I                                    P 209 2147NRTS
     I                                      215 215 NSIN
     I                                      216 2160NCAC
     I                                    P 217 2230AWTP
     I                                    P 224 2300WTRD
     I                                    P 231 2370WTWD
     I                                    P 238 2440IWOD
     I                                    P 245 2510PWOD
     I                                      252 252 BMDI
     I                                      253 253 FMDI
     I                                    P 254 2600PDIN
     I                                      265 267 OSDB                  S01117
     I                                      268 270 OMDB                  S01117
     I                                      287 287 BTIN
     I                                      288 2890BLDY
     I**********                            290 2950OLNO                                      CSD027
     I                                      290 295 OLNO                                      CSD027
     I                                      296 296 RCSI
     I                                      297 2970ICBS
     I                                      298 298 IPFR            28
     I                                    P 299 3050TOTI
     I                                    P 306 3080NIDT        29
     I                                    P 309 3110IBDT
     I                                    P 312 3140SLID
     I                                    P 315 3210AIPD
     I                                    P 322 3240DLRC
     I                                    P 325 3270IACD
     I                                    P 328 3340AITC
     I                                    P 335 3410TFEP
     I                                    P 342 3480AIAP
     I                                    P 349 3550IPRD
     I                                    P 356 3620IPRM
     I                                    P 363 3690ICTD
     I                                    P 370 3760AIMN
     I                                    P 377 3790RBDT
     I                                    P 380 3810NOPS                  S01310
     I*                                                                   S01310
     I                                      384 3850IFDY        21
     I                                      386 386 LONI
     I                                      387 387 CNFI
     I                                      388 388 ACEI
     I                                      389 389 TLXI
     I                                      390 390 CBLI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 401 ADDI                  S01392
     I**  BOOK CODE ADDITION FOR EXPOSURE MANAGEMENT                      S01220
     I                                      435 436 BOKC                  S01220
     I*                                                                   S01465
     I** Receiver of the guarantee                                        S01465
     I*                                                                   S01465
     I**********                            443 4480RECE                  S01465              CSD027
     I                                      443 448 RECE                                      CSD027
      *                                                                   CLE004
     I                                     12071207 MNSG                  CLE004
     I                                     12851287 SCCY                  CEU004
     I                                     12881290 ICCY                  CEU004
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
     I                                    P139013960AIPN                                      CAS005
     I                                    P139714030AITN                                      CAS005
     I                                    P140414100AIAN                                      CAS005
     I                                    P141114170IPRN                                      CAS005
     I                                    P141814240AINN                                      CAS005
     I                                    P142514310TOTN                                      CAS005
     I                                    P143214380ICTN                                      CAS005
     I                                    P143914450IWON                                      CAS005
     I                                    P144614520IPNM                                      CAS005
     I                                    P145314590PDNN                                      CAS005
     I                                    P146014660FSCPAM                                    CAS005
     I                                    P146714730FPAM                                      CLE031
     I                                    P147414808REXR                                      CLE031
     I                                     14811481 REXI                                      CLE031
     I                                     14821484 PSCY                                      CLE031
     I                                    P148514918PEXR                                      CLE031
     I                                     14921492 PEXI                                      CLE031
     I                                     14931493 STAL                                      CLE034
     I                                     14941513 FRNT                                      CAP074
     I                                     15141533 AFRT                                      CAP074
     I                                     15341534 REPA                                      CAP074
     I                                     15351560 TMST                                      CAP074
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     17621765 CLAS                                      CLE042
     I                                     17661769 DFCL                                      CER020
     I                                     17701773 SLCL                                      CER020
     I                                    P177417760ISDT                                      CER020
     I                                    P177717790FMDT                                      CER020
     I                                     17801782 LOIC                                      CER020
     I                                     18301830 FAMU                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
     I**
     I**   'LOTL1' & 'LOTL2' USED FOR LOGGING
     I                                        1 250 LOTL1
     I**************************************251 400 LOTL2                 S01270
     I**************************************251 434 LOTL2          S01270 S01220
     I**************************************251 436 LOTL2          S01220 S01465
     I                                      251 448 LOTL2                 S01465
     I**
     I**   LOANS FILE - DETAIL 2
     I**
     I        NS  03   1 CD   8 CB
     I       OR        1 CM   8 CB
     I       OR        1 CR   8 CB
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDT
     I                                        9   90MRIN
     I                                       10  44 NAR1
     I                                       45  79 NAR2
     I                                       80 114 NAR3
     I                                      115 149 NAR4
     I                                    P 150 1560OPAM
     I                                      157 1610FRBC
     I                                    P 162 1680YPLN
     I                                    P 169 1750YFLN
     I                                    P 176 1820YWLN
     I                                    P 183 1890ABLN
     I                                    P 190 1960YPLC
     I                                    P 197 2030YFLC
     I                                    P 204 2100YWLC
     I                                    P 211 2170ABLC
     I                                    P 218 2240WWLN
     I                                    P 225 2310IWLN
     I                                    P 232 2380PWLN
     I                                      243 2440RDST                  S01392
     I                                      245 274 SPI1
     I                                      275 304 SPI2
     I                                      305 334 SPI3
     I                                      245 334 SPI             24
     I                                    P 335 3410YILN
     I**********                            343 354 ORVD                               S01392 CGL029
     I                                      343 354 ORVDQQ                                    CGL029
     I                                      355 364 THRN                  S01392
     I                                    P 365 3710NPRAM                 S01392
     I                                    P 372 3780NDAM                  S01392
     I                                      379 381 RLBR                  S01392
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                     11121114 RRSC                  CEU004
     I                                     11151117 RPSC                  CEU004
     I                                     11181120 RICY                  CEU004
     I                                     11211121 ECIN                  CEU020
     I                                     112211232RPSM                  144915
     I                                     11241135 RPOS                  144915
     I                                     11361145 RPTS                  144915
     I                                     11461148 RPSB                  144915
     I                                     11491158 RFAO                  144915
     I                                     11591163 FSFYLB                CAS001
     I                                    P116411708RRSR                  CLE031
     I                                     11711171 RRSI                  CLE031
     I                                    P117211788RPSR                  CLE031
     I                                     11791179 RPSI                  CLE031
     I                                     11801180 RSTA                  CLE034
     I                                     11811200 FRNT                  CAP074
     I                                     12011220 AFRT                  CAP074
     I                                     12211221 REPA                  CAP074
     I                                     12221247 TMST                  CAP074
     I                                     12481265 ORVD                                      CGL029
     I**
     I**   CATCH ALL
     I**
     I        NS
     I                                        1   1 RECI
      *                                                                   CLE005
     I***LELOANL0NS       1 CD                                     CLE005 161157
     ILBLOANL1NS       1 CD                                               161157
     I                                       10  110SPTYP                 CLE005
     I        NS                                                          CLE005
      *                                                                   138866
      ** Loan amendments file - DETAIL Record                             138866
      *                                                                   138866
     ILOAMS   NS       1 CD                                               138866
     I                                        8  120VDATLO                138866
     I                                       23  24 AMTP                  138866
     I                                    P  38  440PRAM                  138866
     I                                      977 977 NRLI                  138866
     I        NS                                                          138866
     I**
     I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.*              S01194
     I**
     I*TABLE***NS  07   2 C0   3 C1  12 C1                                S01194
     I*******AND      13 C0                                               S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             12  130RCDE                  S01194
     I**********                             14  66 TITL                  S01194
     I**********                             67  67 DATF                  S01194
     I***********                            68  700DFBR                  S01194
     I**********                             71  71 TLXM                  S01194
     I**********                             74  74 MODI1                 S01194
     I**********                             75  75 MODI2                 S01194
     I**********                             76  76 MODI3                 S01194
     I**********                          P  77  790RUND                  S01194
     I**********                             80  86 RUNA                  S01194
     I**********                             87  870SFLG                  S01194
     I*
     I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.*              S01194
     I*
     I********NS  07   1 CD   2 C0   3 C1                                 S01194
     I*******AND      12 C1  13 C1                                        S01194
     I**********                             14  16 BCCY                  S01194
     I**********                             47  49 LOCY                  S01194
     I*
     I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*5.*              S01194
     I*
     I*TABLE***NS  07   1 CD   2 C0   3 C1                                S01194
     I*******AND      12 C4  13 C0                                        S01194
     I**********                             47  49 USCY                  S01194
     I**********                             58  58 OURC                  S01194
     I**********                             59  59 BRNC                  S01194
     I*
     I*****TABLE*FILE*-*CURRENCIES*RECORD*1.*                             S01194
     I*
     I********NS  07   1 CD   2 C2   3 C0                                 S01194
     I*******AND      13 C1                                               S01194
     I                                       38  380CDP
     I*
     I*****TABLE*FILE*-*BRANCH*CODES*RECORD.*                             S01194
     I*
     I*ABLE   NS  07   1 CD   2 C1   3 C0                                 S01117
     I***********                             1   1 RECI                  S01117
     I***********                             2   30RECT                  S01117
     I*****                                  11  130BRCD                  S01117
     I***********                            14  43 BRNM                  S01117
     I*
     I*****TABLE*FILE*-*NOSTROS*RECORD.*                                  S01194
     I*
     I********NS  07   1 CD   2 C7   3 C0                                 S01194
     I**********                             30  350CNUMN                 S01194
     I**********                             42  66 ORAC                  S01194
     I**********                             67  69 NBRCD                 S01194
     I*
     I*****TABLE*FILE*-*COUNTERPARTY*NOSTROS*RECORD.                      S01194
     I*
     I********NS  07   1 CD   2 C7   3 C1                                 S01194
     I**********                             14  48 CPNM                  S01194
     I**********                             49  68 CPTN                  S01194
     I*
     I********NS                                                          S01194
     I*
     I*****CLIENT*FILE*-*CUSTOMER*STANDING*DATA*RECORD.                   S01194
     I*
     I*CLINT***NS* 08   1 CD   8 CA                                       S01194
     I**********                              9  28 CRNM                  S01194
     I**********                             29  38 CTWN                  S01194
0178 I**********                             57  68 TELX            S01135S01194
     I**********                             69  80 CSID                  S01194
     I*                                                                   S01135
     I**********                            161 161 SWTX           S01135 S01194
     I**********                            195 195 GSFM           E11666 S01194
     I**********                            245 245 TLXR                  S01194
     I*
     I*****CLIENT*FILE*-*CUSTOMER*NAME*AND*ADDRESS*RECORD.                S01194
     I*
     I********NS* 08   1 CD   8NCA                                        S01194
     I**********                              9  43 CNA1                  S01194
     I**********                             44  78 CNA2                  S01194
     I**********                             79 113 CNA3                  S01194
     I**********                            114 148 CNA4                  S01194
     I**********                            240 249 CTWN                  S01194
     I********NS                                                    E43748S01194
     I*
     I/COPY WNCPYSRC,LE0130I003
     I*    D A T A   S T R U C T U R E S
     I*
     I**
     I** IN CASE OF DATABASE ERRORS
     ILDA        UDS                            256
     I*
0214 I***********                           134 138 DBFILE                S01117
0215 I***********                           139 167 DBKEY                 S01117
0216 I***********                           168 175 DBPGM                 S01117
0217 I***********                           176 177 DBASE                 S01117
0214 I                                      134 141 DBFILE                S01117
0215 I                                      142 170 DBKEY                 S01117
0216 I                                      171 180 DBPGM                 S01117
0217 I                                      181 1830DBASE                 S01117
     I***********                           134 177 DBINF                 S01117
     I                                      134 183 DBINF                 S01117
     I*                                                                   CSW096
     IP@IN        DS                            256                       CSW096
     I                                        1   3 I@SNBR                CSW096
     I                                        4   9 I@DSCN                CSW096
     I                                       10  12 I@MTPY                CSW096
     I                                       13  140I@SETT                CSW096
     I                                       15  15 I@CONC                CSW096
     I                                       16  16 I@FTCS                CSW096
      ** Data structure for input parameter                               CSW096
      *                                                                   CSW096
     IP@OUT       DS                            256                       CSW096
     I**********                              1   60O@CNSN                             CSW096 CPK028
     I                                        1   6 O@CNSN                                    CPK028
     I                                        7  18 O@SWSN                CSW096
     I                                       19  38 O@NWSN                CSW096
     I                                       39  49 O@SWDS                CSW096
     I                                       46  46 W@96CN                CSW096
     I                                       47  49 W@BIC                 CSW096
     I                                       50  69 O@NWDS                CSW096
     I                                       70  75 O@NWRK                CSW096
     I                                       76  76 O@MGSG                CSW096
     I                                       77  80 O@MGST                CSW096
      ** Data structure for ouput parameter                               CSW096
      *                                                                   CSW096
     I*
     I*    EQUIVALENT FIELDS FROM DIFFERENT RECORD TYPES ON DEALS FILE
     I*
     I            DS
     I                                        1   3 CCY
     I                                        1   3 PUCY
     I*
     I                                        4  160AMT1
     I                                        4  160PUAM
     I                                        4  160PCPL
     I                                        4  160FVAL
     I*
     I                                       17  290AMT2
     I                                       17  290SLAM
     I                                       17  290PUPR
     I                                       17  290SAPRX
     I*
     I                                       30  340MDAT
     I                                       30  340OTDT
     I*
     I                                       35  40 PCUSA
     I                                       35  400PCUS
     I*
     I                                       41  46 CNUMA
     I**********                             41  460CNUM                                      CSD027
     I**********                             41  460ISCN                                      CSD027
     I                                       41  46 CNUM                                      CSD027
     I                                       41  46 ISCN                                      CSD027
     I*
     I*    SETTLEMENT DETAILS
     I*
     I            DS
     I***********                             1  24 SETTLR                S01117
     I**********                              1  27 SETTLR                             S01117 CGL029
     I                                        1  33 SETTLR                                    CGL029
     I                                        1   20PCST
     I                                        1   20SETP
     I**********                              3  14 OPCA                                      CGL029
     I**********                              3  14 OSAC                                      CGL029
     I**********                             15  24 TSCN                                      CGL029
     I**********                             15  24 TSEN                                      CGL029
     I**********                             25  27 OPSB                               S01117 CGL029
     I**********                             25  27 OSBR                               S01117 CGL029
     I                                        3  20 OPCA                                      CGL029
     I                                        3  20 OSAC                                      CGL029
     I                                       21  30 TSCN                                      CGL029
     I                                       21  30 TSEN                                      CGL029
     I                                       31  33 OPSB                                      CGL029
     I                                       31  33 OSBR                                      CGL029
     I*****                                                               S01117
     I*****                                  25  48 SETTLP                S01117
     I*****                                  25  260SCST                  S01117
     I*****                                  25  260MDST                  S01117
     I*****                                  27  38 OSCA                  S01117
     I*****                                  27  38 OMDA                  S01117
     I*****                                  39  48 TPCN                  S01117
     I*****                                  39  48 TMAN                  S01117
     I*****                                                               S01117
     I*****                                  49  72 SETTL1                S01117
     I*****                                  49  500SDST                  S01117
     I*****                                  51  62 OSDA                  S01117
     I*****                                  63  72 TSTN                  S01117
     I*                                                                   S01117
     I**********                             28  54 SETTLP                             S01117 CGL029
     I**********                             28  290SCST                               S01117 CGL029
     I**********                             28  290MDST                               S01117 CGL029
     I**********                             30  41 OSCA                               S01117 CGL029
     I**********                             30  41 OMDA                               S01117 CGL029
     I**********                             42  51 TPCN                               S01117 CGL029
     I**********                             42  51 TMAN                               S01117 CGL029
     I**********                             52  54 OSSB                               S01117 CGL029
     I**********                             52  54 OMDB                               S01117 CGL029
     I**********                                                                       S01117 CGL029
     I**********                             55  81 SETTL1                             S01117 CGL029
     I**********                             55  560SDST                               S01117 CGL029
     I**********                             57  68 OSDA                               S01117 CGL029
     I**********                             69  78 TSTN                               S01117 CGL029
     I**********                             79  81 OSDB                               S01117 CGL029
     I**********                                                                       S01392 CGL029
     I**********                             82 108 SETTL2                             S01392 CGL029
     I**********                             82  830RDST                               S01392 CGL029
     I**********                             84  95 ORVD                               S01392 CGL029
     I**********                             96 105 THRN                               S01392 CGL029
     I**********                            106 108 RLBR                               S01392 CGL029
      *                                                                                       CGL029
     I                                       34  66 SETTLP                                    CGL029
     I                                       34  350SCST                                      CGL029
     I                                       34  350MDST                                      CGL029
     I                                       36  53 OSCA                                      CGL029
     I                                       36  53 OMDA                                      CGL029
     I                                       54  63 TPCN                                      CGL029
     I                                       54  63 TMAN                                      CGL029
     I                                       64  66 OSSB                                      CGL029
     I                                       64  66 OMDB                                      CGL029
      *                                                                                       CGL029
     I                                       67  99 SETTL1                                    CGL029
     I                                       67  680SDST                                      CGL029
     I                                       69  86 OSDA                                      CGL029
     I                                       87  96 TSTN                                      CGL029
     I                                       97  99 OSDB                                      CGL029
      *                                                                                       CGL029
     I                                      100 132 SETTL2                                    CGL029
     I                                      100 1010RDST                                      CGL029
     I                                      102 119 ORVD                                      CGL029
     I                                      120 129 THRN                                      CGL029
     I                                      130 132 RLBR                                      CGL029
     I*
     I*    CONSTANT FIELDS USED IN NARRATIVE
     I*
     I            DS
     I                                        1  25 NARRA
     I                                        1  15 VALUE
     I                                       16  25 MATURI
     I/COPY WNCPYSRC,LE0130I001
     I*
     I            DS
     I***********                             1  68 TITL12                S01392
     I                                        1 136 TITL12                S01392
     I                                        1  12 PAYAT
     I                                       13  24 VALDAT
     I                                       25  39 MATDAT
     I                                       40  54 TOURAC
     I                                       55  68 FEEDUE
     I                                       69  83 ROLDAT                S01392
     I*
     I            DS
     I                                        1 150 NAME12
     I                                        1  26 INSADV
     I                                       27  50 CRTOAC
     I                                       28  50 DRTOAC
     I                                       51  62 SEND
     I                                       63  86 WAITR
     I                                       64  86 SENDR
     I                                       87  93 ASPER
     I                                       87 110 PERYOR
     I                                       88 110 PEROUR
     I                                      111 138 YOUCOL
     I                                      112 138 WECOL
     I                                      139 148 YERSEL
     I                                      140 148 OURSEL
     I**   FIELDS USED FOR BENIFICIARY BANK DETAILS
     I*
     I            DS
     I                                        1  30 SPI1
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  29 SPEC29
     I                                        6  30 SPEC30
     I*
     I            DS
     I                                        1  50 NAME34
     I                                        1  10 PAY
     I                                       11  30 AWAITA
     I                                       31  50 SPINST
     I*
     I*    FIELDS USED IN CONF SUBROUTINE
     I*
     I            DS
     I                                        1   5 KEYDS
     I                                        1   1 TYPE
     I                                        2   30N
     I                                        4   40P
     I                                        5   5 PAYREC
     I*    FIELDS USED IN MOVEA SUBROUTINE
     I            DS
     I                                        1  72 AR
     I                                        1  72 ARRAY
     I                                       73 141 ADDDS
     I                                       73  740LENGTH
     I                                       75 141 ADD
     I                                      142 142 BLK1
     I                                      142 151 BLK10
     I                                      142 167 BLK25
     I                                      142 210 BLANK
     I/COPY WNCPYSRC,LE0130I002
     I*    FIELDS USED IN NOSTRO AND CPNOS SUBROUTINES
     I            DS
     I**********                              1  12 NOSTRO                                    CGL029
     I                                        1  18 NOSTRO                                    CGL029
     I                                        1   2 NOS
     I                                        1   6 CUSTNO
     I                                        1   8 CPSH
     I                                        1  10 RETAC
     I**********                              7  10 AC                                        CGL029
     I**********                             11  12 SEQ                                       CGL029
     I**********                             13  15 BRC                                S01117 CGL029
     I**********                             16  35 CPTN                               S01117 CGL029
     I**********                             20  20 DASH                               S01117 CGL029
     I**********                             21  22 SEQX                               S01117 CGL029
     I**********                             23  23 DASH2                              S01117 CGL029
     I**********                             24  26 BRCX                               S01117 CGL029
     I                                        7  16 AC                                        CGL029
     I                                       17  18 SEQ                                       CGL029
     I                                       19  21 BRC                                       CGL029
     I                                       22  41 CPTN                                      CGL029
     I                                       32  32 DASH                                      CGL029
     I                                       33  34 SEQX                                      CGL029
     I                                       35  35 DASH2                                     CGL029
     I                                       36  38 BRCX                                      CGL029
     I*****                                  13  32 CPTN                  S01117
     I*****                                  17  17 DASH                  S01117
     I*****                                  18  19 SEQX                  S01117
     I*****TABLE*FILE*CHAINING*KEY*AND*ZERO FIELD                         S01194
     I************DS                                                      S01194
     I************                            1  12 TABKEY                S01194
     I************                            1  12 ZTABKY                S01194
     I************                            8  10 CCYKN                 S01194
     I************                            9  11 CCYK                  S01194
      /COPY ZSRSRC,ZTNLU1Z1                                               S01392
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 152 1530SFLIN                 S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     ISDCURR    E DSSDCURRPD                                              S01194
      **   CURRENCY                                                       S01194
     I              A6NBDP                          CDP                   S01194
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **                                                                  S01194
     I              BJLCCY                          LOCY                  S01194
     I              BJURPT                          TITL                  S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **                                                                  S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
      **                                                                  S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
      **                                                                  S01194
     I              BLBNOC                          BRNC                  S01194
     I              BLONOC                          OURC                  S01194
     I              QQACCD                          QQACD1                                    CGL029
      *                                                                   S01194
     ISDCNST    E DSSDCNSTPD                                              S01194
      **   COUNTERPARTY NOSTRO CODE                                       S01194
     I              AWCPNM                          CPNM                  S01194
     I              AWCNTN                          CNTN                  140158
      *                                                                   S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
      **     NOSTRO RECORDS                                               S01194
     I              A7ORAC                          ORAC                  S01194
     I              A7CUST                          CNUMN                 S01194
     I              QQACCD                          QQACD2                                    CGL029
      *                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **   CUSTOMER                                                       S01194
     I              BBCRNM                          CRNM                  S01194
     I              BBCSID                          CSID                  S01194
     I              BBCRTN                          CTWN                  S01194
     I              BBTXA1                          TELX                  S01194
     I              BBGSFM                          GSFM                  S01194
     I              BBSTFG                          SWTX                  S01194
     I              QQDFAC                          QQDFA1                                    CGL029
      *                                                                   S01194
     ISDALTN    E DSSDALTNPD                                              S01194
      **   CUSTOMER                                                       S01194
     I              BCCNA1                          CNA1                  S01194
     I              BCCNA2                          CNA2                  S01194
     I              BCCNA3                          CNA3                  S01194
     I              BCCNA4                          CNA4                  S01194
     I*
     I@MGME     E DSSDMGMEPD                                              S01310
     I** DUMMY RECORD FORMAT FOR MESSAGE DETAILS                          S01310
     I*                                                                   S01465
     ISDCLND    E DSSDCLNDPD                                              S01465
     I** External DS for customer lending details                         S01465
     I*
     ISCSARD    E DSSCSARDPD                                              CLE004
     I** Switchable Feature details                                       CLE004
     I*                                                                   CLE004
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
      *                                                                   S01392
     ISDBSRT    E DSSDBSRTPD                                              S01392
      **   BASE RATE                                                      S01392
      *                                                                   S01392
     I              'Through Account'     C         THRACC                CLE033
      * 'Through account' constant  for CLE033                            CLE033
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I*                                                                   S01408
     I/COPY WNCPYSRC,LE0130IIP2                                           S01408
     I*                                                                   S01408
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     C                     MOVEACPY@      BIS@   80
     C*                                                                   S01465
     C** Field definition                                                 S01465
     C*                                                                   S01465
     C           *LIKE     DEFN CTWN      SVCTWN                          S01465
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ1    5                       S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C*
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCURRR0'                            S01194
     C*                                                                   S01194
     C           PLISTB    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           K101    3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C*
     C** PARAMETER LIST FOR PROGRAM 'AONOSTR0'                            S01194
     C*                                                                   S01194
     C           PLISTC    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYA    6                    A  S01194
     C                     PARM           KEYB    3                    B  S01194
     C**********           PARM           KEYC    4                    C               S01194 CGL029
     C                     PARM           KEYC   10                                           CGL029
     C                     PARM           KEYD    2                    D  S01194
     C                     PARM           KEYE    2                    E  S01194
     C                     PARM           KEYF    3                    F  S01194
     C                     PARM           KEYG   10                    G  S01194
     C                     PARM           KEYH    1                    H  S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AOGELRR0'                            S01194
     C*                                                                   S01194
     C           PLISTD    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOTRADR0'                            S01194
     C*                                                                   S01194
     C           PLISTE    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C*
     C** PARAMETER LIST FOR PROGRAM 'AOMMODR0'                            S01194
     C*                                                                   S01194
     C           PLISTG    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C*
     C** PARAMETER LIST FOR PROGRAM 'AOCNSTR0'                            S01194
     C*                                                                   S01194
     C           PLISTF    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           ARCD    8                       S01194
     C           SDCNST    PARM SDCNST    DSFDY                           S01194
     C*
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOALTNR0'                            S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           AENB    6                       S01194
     C                     PARM           AZCD    1                       S01194
     C           SDALTN    PARM SDALTN    DSFDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOBSRTR0'                            S01392
     C           PLIST3    PLIST                                          S01392
     C                     PARM '*BLANKS' @RTCD                           S01392
     C                     PARM '*KEY   ' @OPTN                           S01392
     C                     PARM           BKEY1   3                       S01392
     C                     PARM           BKEY2   2                       S01392
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01392CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*                                                                   S01465
     C** Parameter list for program 'AOCLNDR0'                            S01465
     C*                                                                   S01465
     C           PLISTH    PLIST                                          S01465
     C                     PARM '*DBERR ' @RTCD   7                       S01465
     C                     PARM '*FIRST ' @OPTN   7                       S01465
     C********** SDCLND    PARM SDCLND    DSFDY                                        S01465 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C*
     C*    FIRST CYCLE
     C*
     C   19                GOTO MODE2
     C   U2                SETON                     19
     C/COPY WNCPYSRC,LE0130CCP7                                           S01408
     C**                                                                  S01117
     C*     IN THE DATA AREA RUNDAT                                       S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C/COPY WNCPYSRC,LE0130C006
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
0294 C**                                                                  S01117
     C*    SETON INDICATOR FOR NO PRINTING, IF MULTIBRANCHING = NO        S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     11                   S01117
     C                     END                                            S01117
     C**
     C**   SAVE PROGRAM NAME IN CASE OF DBERR
     C**
     C                     MOVE BLANK     DBINF
     C                     MOVE 'LE0130'  DBPGM
     C*
     C                     EXSR ZSYSTM
     C   99                MOVE '01'      DBASE            * DB ERROR 01 *
     C                     MOVE 'SDBANKPD'DBFILE                          S01194
     C***99*****           MOVELZTABKY    DBKEY                           S01194
     C***99*****           MOVE 'TABLE'   DBFILE                          S01194
     C   99                SETON                     U7U8LR
     C   99                GOTO END
     C*
     C**********           MOVE '11'      TABKEY                          S01194
     C**********           EXSR TABCHN                     ***************S01194
     C**********           CALL 'AOGELRR0'PLISTD                                       S01194 CGL029
     C                     CALL 'AOGELRR1'PLISTD                                              CGL029
     C           @RTCD     COMP *BLANKS                  07               S01194
     C  N07                MOVE '02'      DBASE            * DB ERROR 02 *
     C  N07                MOVE 'SDGELRPD'DBFILE                          S01194
     C**N07*****           MOVELTABKEY    DBKEY                           S01194
     C**N07*****           MOVE 'TABLE'   DBFILE                          S01194
     C  N07                SETON                     U7U8LR
     C  N07                GOTO END
     C*                                                                   S01465
     C** Access customer lending data                                     S01465
     C*                                                                   S01465
     C                     CALL 'AOCLNDR0'PLISTH                          S01465
     C                     MOVE '0'       *IN05                           S01465
     C           @RTCD     IFNE *BLANK                                    S01465
     C                     MOVEL'SDCLNDPD'DBFILE           ************   S01465
     C                     MOVEL@OPTN     DBKEY            * DBERR 18 *   S01465
     C                     Z-ADD18        DBASE            ************   S01465
     C                     SETON                     U7U8LR               S01465
     C                     GOTO END                                       S01465
     C                     ELSE                                           S01465
     C           BPGIAV    IFEQ 'Y'                                       S01465
     C                     MOVE '1'       *IN05                           S01465
     C                     END                                            S01465
     C                     END                                            S01465
      ** ACCESS MIDAS MODULE DETAILS                                      S01194
     C                     CALL 'AOMMODR0'PLISTG                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDMMODPD'DBFILE             *************S01194
     C                     MOVEL'010'     DBASE              * DBERR 010 *S01194
     C                     MOVEL@OPTN     DBKEY              *************S01194
     C                     END
      *                                                                   CLE004
      ** Check if CLE004 is switch ON                                     CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*KEY   ' @OPTN                           CLE004
     C                     PARM 'CLE004'  PSARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       CLE004                          CLE004
     C           @RTCD     IFNE '*NRF    '                                CLE004
     C                     MOVEL'SCSARDPD'DBFILE             *************CLE004
     C                     Z-ADD21        DBASE              * DBERR 021 *CLE004
     C                     MOVEL'CLE004'  DBKEY              *************CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE005
      ** Check if CLE005 is switch ON                                     CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY   ' @OPTN                           CLE005
     C                     PARM 'CLE005'  PSARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF    '                                CLE005
     C                     MOVEL'SCSARDPD'DBFILE             *************CLE005
     C                     Z-ADD22        DBASE              * DBERR 022 *CLE005
     C                     MOVEL'CLE005'  DBKEY              *************CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed                         CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY' POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD024       DBASE                                               CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     GOTO END                                                           CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE033
      ** Check if CLE033 is ON                                                                CLE033
      *                                                                                       CLE033
     C                     CALL 'AOSARDR0'                                                    CLE033
     C                     PARM *BLANKS   @RTCD                                               CLE033
     C                     PARM '*KEY   ' @OPTN                                               CLE033
     C                     PARM 'CLE033'  PSARD                                               CLE033
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE033
     C           @RTCD     IFEQ *BLANKS                                                       CLE033
     C                     MOVE 'Y'       CLE033  1                                           CLE033
     C                     ELSE                                                               CLE033
     C                     MOVE 'N'       CLE033                                              CLE033
     C           @RTCD     IFNE '*NRF    '                                                    CLE033
     C                     MOVEL'SCSARDPD'DBFILE             *************                    CLE033
     C                     Z-ADD24        DBASE              * DBERR 024 *                    CLE033
     C                     MOVEL'CLE033'  DBKEY              *************                    CLE033
     C                     SETON                     U7U8LR                                   CLE033
     C                     GOTO END                                                           CLE033
     C                     ENDIF                                                              CLE033
     C                     ENDIF                                                              CLE033
      *                                                                                       CLE031
      ** Check if CLE031 is switch ON                                                         CLE031
      *                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM 'CLE031'  PSARD                                               CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
     C           @RTCD     IFEQ *BLANKS                                                       CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
     C           @RTCD     IFNE '*NRF    '                                                    CLE031
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE031
     C                     Z-ADD23        DBASE                                               CLE031
     C                     MOVEL'CLE031'  DBKEY                                               CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE047
      ** Check if CLE047 is switch ON                                                         CLE047
      *                                                                                       CLE047
     C                     CALL 'AOSARDR0'                                                    CLE047
     C                     PARM *BLANKS   @RTCD                                               CLE047
     C                     PARM '*KEY   ' @OPTN                                               CLE047
     C                     PARM 'CLE047'  PSARD                                               CLE047
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE047
     C           @RTCD     IFEQ *BLANKS                                                       CLE047
     C                     MOVE 'Y'       CLE047  1                                           CLE047
     C                     ELSE                                                               CLE047
     C                     MOVE 'N'       CLE047                                              CLE047
     C           @RTCD     IFNE '*NRF    '                                                    CLE047
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE047
     C                     Z-ADD34        DBASE                                               CLE047
     C                     MOVEL'CLE047'  DBKEY                                               CLE047
     C                     SETON                     U7U8LR                                   CLE047
     C                     GOTO END                                                           CLE047
     C                     ENDIF                                                              CLE047
     C                     ENDIF                                                              CLE047
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0130CCP1                                           S01408
     C*                                                                   S01408
     C*
     C**********           MOVE '40'      TABKEY                          S01194
     C**********           EXSR TABCHN                     ***************S01194
     C                     CALL 'AOTRADR0'PLISTE                          S01194
     C           @RTCD     COMP *BLANKS                  07
     C  N07                MOVE '03'      DBASE            * DB ERROR 03 *
     C  N07                MOVEL'SDTRADPD'DBFILE                          S01194
     C**N07*****           MOVELTABKEY    DBKEY                           S01194
     C**N07*****           MOVE 'TABLE'   DBFILE                          S01194
     C  N07                SETON                     U7U8LR
     C  N07                GOTO END
     C*
     C*    TEST OURSELVES OR NOSTRO, AND BRANCH NAME ON CONFIRMATION INDS
     C*
     C           OURC      COMP 'O'                  1818
     C           BRNC      COMP 'Y'                      16
     C                     MOVE 'A'       CLIKEY  7
     C                     MOVEL'D'       DLRCDT  2
     C                     Z-ADD0         ZERO5   50
     C                     MOVE ' '       BLNKS 150
     C                     MOVEL'NOT FOUN'ERM1    9
     C                     MOVE 'D'       ERM1
     C                     MOVE ERM1      ERM    16
     C   U2                GOTO MODE2
     C*
     C*    M O D E   1 & 3   C O N F I R M A T I O N S   - ONE CYCLE ONLY
     C*
     C                     Z-ADD1         COUNT   50
     C                     Z-ADD2         NORET   50
     C*
     C*    TO ALLOW OUTPUT OF LEEXT HEADER IF U4 IS ON
     C   U4                SETON                     82
     C*
     C*    READ LTRIX HEADER.  IF LAST RECORD READ OR IN MODE 1 STOP
     C*    PRINT IND. ON, FINISH.  OTHERWISE RELEASE.
     C*
     C           AGAIN1    TAG                             ***  AGAIN1 ***
     C*
     C***********          SETOF                     81                   S01117
     C                     SETOF                     8178                 S01117
     C                     Z-ADD1         RRN     50
 156 C*  LOCK HDR BY READ & DUMMY UPDATE
2156 C                     EXSR HDRCHN
     C**N01*****           MOVED'04'      DBASE            * DB ERROR 04 *                  AR322732
     C**N01*****           MOVEL'LTRIX'  'DBFILE                                            AR322732
     C**N01*****           MOVELRRN       DBKEY                                             AR322732
     C**N01*****           SETON                     U7U8LR                                 AR322732
     C**N01*****           GOTO END                                                         AR322732
     C*
     C**NU3N19**           Z-ADDRRLC      COUNT                                             AR322732
     C**
     C**   RELEASE LTRIX HEADER
     C**
     C                     SETON                     75
     C**********           EXSR EXCPT                                                       AR322732
     C                     SETON                     19
     C*
     C           AGAIN3    TAG                             ***  AGAIN3 ***
     C                     SETOF                     78                   S01117
     C********** COUNT     ADD  1         COUNT                                             AR322732
     C********** COUNT     COMP RRNA                   60                                   AR322732
     C**NU3*27**                                                                            AR322732
     C***ORN60**                GOTO FINISH                                                 AR322732
     C*
     C*    GET AND RELEASE LTRIX DETAIL AND FIND IF CONF. TO BE PRINTED
     C*
     C**********           Z-ADDCOUNT     RRN                                               AR322732
     C                     EXSR LTRCHN
     C   LR                GOTO FINISH                                                      AR322732
      *                                                                                     AR322732
      ** If already processed by confirmation job read next one.                            AR322732
      *                                                                                     AR322732
     C           CFPF      IFEQ 'Y'                                                         AR322732
     C                     GOTO AGAIN3                                                      AR322732
     C                     ENDIF                                                            AR322732
      *                                                                                     AR322732
     C                     SETON                     75
     C**********           EXSR EXCPT                                                       AR322732
     C           RCDT      COMP 'R'                      79  ROLLOVER REC S01392
     C  N02 U3             GOTO AGAIN3
     C  N02                GOTO AGAIN1
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0130CCP2                                           S01408
     C*                                                                   S01408
     C*
     C           CNRQ      COMP 'R'                      68
     C   68NU3   CNPR      COMP 'Y'                  6868
     C   68NU3             GOTO LOAN
     C           CNRQ      COMP 'Y'                      60
     C  N60NU3             GOTO AGAIN1
     C  N60      CHTP      COMP 'I'                      60
     C  N60 79   CHTP      COMP 'A'                      60 ROLLOVER CONF S01392
     C  N60 U3   CHTP      COMP 'R'                      60
     C   60      CNPR      COMP 'Y'                  6060
      *                                                                                       255752
      ** If UDC present, ensure this record has been processed by UDC                         255752
      *                                                                                       255752
     C           BGN1ST    IFEQ 'Y'                                                           255752
     C           *IN60     ANDEQ'1'                                                           255752
     C           CNPR      ANDNE'S'                                                           255752
     C                     MOVE '0'       *IN60                                               255752
     C                     ENDIF                                                              255752
      *                                                                                       255752
     C  N60                EXSR EXCPT                                                       AR322732
     C  N60                GOTO AGAIN3
     C*
     C*    PRINT CONFIRMATION AND UPDATE FILES
     C*
     C           LOAN      TAG                             ***  LOAN   ***
     C                     EXSR CLCHN
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0130CCP3                                           S01408
     C*                                                                   S01408
     C  NLR                SETON                     77
     C  NLR                EXSR EXCPT                      RELEASE CLOAN
     C  NLR                EXSR INFOSR
     C           *INLR     IFEQ '1'                                       CLE005
     C           *IN62     ANDEQ'1'                                       CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** If Principal amount is zero, default to the transfer amount.     138866
     C           CPAM      IFEQ 0                                         138866
     C           *INLR     ANDEQ*OFF                                      138866
     C                     EXSR SRLOAM                                    138866
      *                                                                   138866
      ** If no record found, skip this loan.                              138866
      ** only for non-paricipations                                       159259
      *                                                                   159259
     C           CPAM      IFEQ 0                                         138866
     C           WFLG      ANDEQ*BLANKS                                   159259
     C           *INU3     IFEQ *ON                                       138866
     C                     GOTO AGAIN3                                    138866
     C                     ELSE                                           138866
     C                     GOTO AGAIN1                                    138866
     C                     ENDIF                                          138866
     C                     ENDIF                                          138866
     C                     ENDIF                                          138866
      *                                                                   138866
     C* USE *IN45 INSTEAD OF *IN22                                        S01392
     C**NLR*22*************EXSR INTCAL                                    S01392
     C**NLR*45**           EXSR INTCAL                              S01392070256
     C**NLR*22**           EXSR INTCAL                              070256091120
     C  NLR 45             MOVE *ZEROS    TOTINT                          091120
     C  NLR 45             MOVE *ZEROS    TOTAL                           091120
     C  NLR 45             EXSR INTCAL                                    091120
     C   LR                MOVE '05'      DBASE            * DB ERROR 05 *
     C   LR                MOVE 'CLOAN'   DBFILE
     C   LR                MOVELCLKEY     DBKEY
     C  NLR                MOVE RCDT      DLRCDT
     C*                                                                   S01117
     C           *INLR     IFNE '1'                                       S01117
     C                     EXSR MBRT                                      S01117
     C                     END                                            S01117
     C   78                GOTO END                                       S01117
     C/COPY WNCPYSRC,LE0130C002
     C  NLR                EXSR CONF
     C/COPY WNCPYSRC,LE0130C003
     C   78                GOTO END                                       S01117
     C   66NU7             EXSR UPDATE
     C  NLR U3             GOTO AGAIN3
     C  NLR                GOTO AGAIN1
     C                     GOTO END
     C*
     C*    SET OFF STOP PRINT IND. & UPDATE RRN OF LAST CONF. PROCESSED
     C*
     C           FINISH    TAG                             ***  FINISH ***
     C                     SETON                     LR
     C                     Z-ADD1         RRN
     C**********           EXSR LTRCHN                                                      AR322732
     C*
     C**N60*****           SETON                     75                                     AR322732
     C**N60*****           EXSR EXCPT                                                       AR322732
     C*
     C**N01*****           MOVE '06'      DBASE            * DB ERROR 06 *                  AR322732
     C**N01*****           MOVE 'LTRIX'   DBFILE                                            AR322732
     C**N01*****           MOVELRRN       DBKEY                                             AR322732
     C**N01*****           SETON                     U7U8LR                                 AR322732
     C********** COUNT     SUB  1         COUNT                                             AR322732
     C  NU7                EXSR UPDATE
     C                     GOTO END
     C*
     C*    M O D E   2   C O N F I R M A T I O N S
     C*
     C           MODE2     TAG                             ***  MODE2  ***
     C                     READ SLTIX                    LR               S01117
     C   LR
     CORN02                GOTO END
     C           RCDT      COMP 'R'                      79  ROLLOVER REC S01392
     C*
     C           CNRQ      COMP 'R'                      60
     C  N60      CNPR      COMP 'Y'                  6060
     C   60                GOTO END
     C*
     C                     EXSR CLCHN
     C   LR                MOVE '07'      DBASE            * DB ERROR 07 *
     C   LR                MOVE 'CLOAN'   DBFILE
     C   LR                MOVELCLKEY     DBKEY
     C   LR                GOTO END
     C                     SETON                     77
     C                     EXSR EXCPT
     C                     EXSR INFOSR
     C           *INLR     IFEQ '1'                                       CLE005
     C           *IN62     ANDEQ'1'                                       CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   138866
      ** If Principal amount is zero, default to the transfer amount.     138866
     C           CPAM      IFEQ 0                                         138866
     C                     EXSR SRLOAM                                    138866
      *                                                                   138866
      ** If no record found, skip this loan.                              138866
      ** only for non-paricipations                                       159259
      *                                                                   159259
     C           CPAM      IFEQ 0                                         138866
     C           WFLG      ANDEQ*BLANKS                                   159259
     C                     GOTO END                                       138866
     C                     ENDIF                                          138866
     C                     ENDIF                                          138866
      *                                                                   138866
     C* USE *IN45 INSTEAD OF *IN22                                        S01392
     C***22****************EXSR INTCAL                                    S01392
     C***45*****           EXSR INTCAL                              S01392070256
     C***22*****           EXSR INTCAL                              070256091120
     C   45                MOVE *ZEROS    TOTINT                          091120
     C   45                MOVE *ZEROS    TOTAL                           091120
     C   45                EXSR INTCAL                                    091120
     C/COPY WNCPYSRC,LE0130C021
     C*
     C           LNRF      COMP LASTLN                   61
     C           CHTP      COMP 'R'                      60
     C   60      ORED      COMP RUND                 6060
     C                     SETOF                     59
     C   60
     CORN61                SETON                     59
     C**                                                                  S01117
     C*  CALL MULTIBRANCH SUBROUTINE                                      S01117
     C**                                                                  S01117
     C           *IN59     IFEQ '1'                                       S01117
     C                     EXSR MBRT                                      S01117
     C                     END                                            S01117
     C   78                GOTO END                                       S01117
     C*
     C   60
     CORN61                EXSR CONF
     C   78                GOTO END                                       S01117
     C***59*****           Z-ADDLNRF      LASTLN  60                                          CLE148
     C   59                MOVELLNRF      LASTLN  6                                           CLE148
     C*
     C           END       TAG                             ***  END    ***
     C*
     C           *INLR     IFEQ '1'                                       S01117
     C           *INU7     ANDEQ'1'                                       S01117
     C                     OPEN LE0130AU                                  S01117
     C                     END                                            S01117
     C*                                                                   S01117
     CLR                   SETOF                     U2
     C*
     C**                                                                  S01117
     C*   ENSURE TOTALS SPOOL FILE RECORDED BY RCF ONLY IF ERROR          S01117
     C**                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C*                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ1                            S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C**                                                                  S01117
     C           *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     C*     EXECUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                S01117
     C**                                                                  S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0401 C*                                                                   S01117
0363 C********************************************************************S01117
     C*  SUBROUTINE TO TEST MULTIBRANCH OUTPUT                            S01117
0365 C*                                                                   S01117
     C*  MBRT IS CALLED BY MAIN PROCESSING                                S01117
     C*  CALL : NONE                                                      S01117
     C**                                                                  S01117
     C           MBRT      BEGSR                                          S01117
     C**                                                                  S01117
     C                     SETOF                     78                   S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**      IF BRCA IS LESS THAN THE REQUIRED BRANCH,                   S01117
     C**      SKIP THE CALCULATION                                        S01117
     C*                                                                   S01117
     C           BRNCH     IFNE BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETOF                     71                   S01117
     C                     SETON                     78                   S01117
     C                     GOTO ENDM                                      S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           BRCA      IFNE STRBRC                                    S01117
     C                     MOVE BRCA      STRBRC  3                       S01117
     C                     CLOSELE0130P1                                  S01117
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A REQUIRED BRANCH AND A LEVEL BREAK,       S01117
     C*       OPEN LE0130P1                                               S01117
     C**                                                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     71    ALLOW OUTPUT   S01117
     C                     OPEN LE0130P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C**  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ1                            S01117
     C                     PARM BRCA      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C**      IF BRCA IS GREATER THAN THE REQUIRED BRANCH,                S01117
     C**      END THE PROGRAM                                             S01117
     C*                                                                   S01117
     C           BRNCH     IFLT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETON                     LR78                 S01117
     C                     SETOF                     71                   S01117
     C                     GOTO ENDM                                      S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0130P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     SETON                     71    ALLOW OUTPUT   S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0130P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ1                            S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,LE0130C035
     C                     END                                            S01117
     C                     END                                            S01117
     C           ENDM      ENDSR                                          S01117
     C********************************************************************
     C*    SUBROUTINE TO PRINT CONFIRMATIONS
     C*
     C*    CONF IS CALLED BY - MAIN PROCESSING
     C*
     C*            CALLS - MOVEA;TABCHN;ZDATE2;SETTYP;NOSTRO;CPNOS;
     C*                    CLICHN;EXCPT
     C***********
     C           CONF      BEGSR                           ***  CONF   ***
     C*
     C                     SETOF                     78                   S01117
     C                     MOVE BLANK     CNA1
     C/COPY WNCPYSRC,LE0130C027
     C*
     C*    CHECK TYPE OF CONFIRMATION
     C*
     C           CHTP      COMP 'R'                      64CANCELLATION
     C*
     C***  BYPASS TO REPRT FOR REPRINT OF CONFIRMATIONS
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0130CCP4                                           S01408
     C*                                                                   S01408
     C   68
     COR U2                GOTO REPRT
     C   64                TESTB'1'       CNFI           66
     C  N64      RECI      COMP 'R'                  6666
     C  N66                GOTO ENDCON
     C           CHTP      COMP 'A'                      60AMEND
     C  N60      CHTP      COMP 'R'                      60REVERSAL
     C   U3
     COR 60                TESTB'0'       CNFI       66
     C  N66 79             TESTB'2'       CNFI       66                   S01392
     C/COPY WNCPYSRC,LE0130C022
     C   U3N66
     COR 60N66             GOTO ENDCON
     C/COPY WNCPYSRC,LE0130C023
     C           REPRT     TAG                             ***  REPRT  ***
     C                     SETOF                     6365
     C   68
     COR U2                SETON                     63    COPY
     C  N64      ORED      COMP RUND                 6565  AMENDMENT
     C           *IN65     IFEQ '0'                                                           209887
     C           CHTP      ANDEQ'A'                                                           209887
     C                     MOVE '1'       *IN65                                               209887
     C                     ENDIF                                                              209887
     C*
     C*    SET UP CONFIRMATION NAME
     C*
     C           PTYP      LOKUPTABTYP    TABNO          60
     C                     MOVE TABNO     KEYDS
     C*
     C*    SET UP CONFIRMATION NAME FOR ROLLOVER                          S01392
     C   79                MOVE '  15 '   KEYDS                           S01392
     C*                                                                   S01392
     C                     MOVEABLANK     AR
     C                     MOVE START,N   A       20
     C                     MOVELNAME,N    ADDDS
     C                     EXSR MOVEA
     C                     MOVELARRAY     CNAME  26
     C*
     C*    GET BRANCH NAME IF REQUIRED ON OUTPUT
     C*
     C***16******          MOVEL'10'      TABKEY                          S01117
     C***16******          MOVE BRCD      TABKEY                          S01117
     C***16******          EXSR TABCHN                     ***************S01117
     C***16N07***          MOVE '08'      DBASE            * DB ERROR 08 *S01117
     C***16N07***          MOVE 'TABLE'   DBFILE                          S01117
     C***16N07***          MOVELTABKEY    DBKEY                           S01117
     C***16N07***          SETON                     U7U8LR               S01117
     C**N07*16***          GOTO ENDCON                                    S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C*   GET BRANCH NAME, ONLY WHEN MBIN = YES                           S01117
     C**                                                                  S01117
     C           *IN16     ANDEQ'1'                                       S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ************   S01117
     C                     MOVEL'SDBRCHPD'DBFILE           *          *   S01117
     C                     Z-ADD16        DBASE            * DBERR 16 *   S01117
     C                     SETON                     78    *          *   S01117
*    C                     SETON                     U7U8LR************   S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO ENDCON                                    S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,LE0130C013
     C                     END                                            S01117
     C*
     C*    SET UP NARRATIVE LINE 1
     C*
     C                     Z-ADD1         A
     C*
     C*    INSERT LOAN NAME ETC
     C*
     C                     MOVELNARN,P    ADDDS
     C                     EXSR MOVEA
     C*
     C*    INSERT VALUE DATE
     C*
     C                     Z-ADDVDAT      ZDAYNO
     C   79                Z-ADDRLDT      ZDAYNO                          S01392
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALUE
     C/COPY WNCPYSRC,LE0130C007
     C*
     C**   FORMAT DATES INTO DDMMYY FORMAT FOR OUTPUT TO TELEX FILE
     C*
     C                     MOVE ZYEAR     ZWRK4
     C                     MOVELZMTH      ZWRK4
     C                     MOVELZDAY      TXDATE  60
     C                     MOVE ZWRK4     TXDATE
     C                     MOVELVALUE     ADDDS
     C   39                MOVEL' FROM'   ADD
     C                     EXSR MOVEA
     C*
     C*    INSERT MATURITY DATE / NOTICE DESCRIPTION
     C*
     C                     Z-ADD3         LENGTH
     C   39                MOVEL'TO'      ADD
     C***32****************MOVEL'AT CALL' ADD                             E10916
     C/COPY WNCPYSRC,LE0130C004
     C   32      MDAT      IFEQ *ZEROS                                    E10916
     C                     MOVEL'AT CALL' ADD                             E10916
     C                     ELSE                                           E10916
     C                     MOVELMATURI    ADDDS                           E10916
     C                     END                                            E10916
     C  N32N39             MOVELMATURI    ADDDS
     C                     EXSR MOVEA
     C*
     C*    INSERT MATURITY DATE / NOTICE DAYS
     C*
     C                     Z-ADDMDAT      ZDAYNO
     C   79                Z-ADDNROD      ZDAYNO                          S01392
     C                     EXSR ZDATE2
     C/COPY WNCPYSRC,LE0130C008
     C   32      MDAT      IFNE *ZEROS                                    E10916
     C                     MOVELZADATE    ADD                             E10916
     C/COPY WNCPYSRC,LE0130C009
     C                     EXSR MOVEA                                     E10916
     C                     END                                            E10916
     C  N32                MOVELZADATE    ADD
     C/COPY WNCPYSRC,LE0130C010
     C  N32                EXSR MOVEA
     C/COPY WNCPYSRC,LE0130C005
     C*
     C***********          MOVELARRAY     NARR1  61                       CLE005
     C                     MOVELARRAY     NARR1  68                       CLE005
     C*
     C*    GET INTEREST PAYMENT DATE AND FREQ. FOR NARRATIVE LINES 2 & 3
     C*
     C                     Z-ADDNIDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    NDATE   7
     C/COPY WNCPYSRC,LE0130C011
     C           IPFR      LOKUPTABF      TABFRQ         60
     C**********           MOVE TABFRQ    TABFQ1 11                                           CLE064
     C                     MOVE TABFRQ    TABFQ1 15                                           CLE064
     C**
     C**   SET UP EDITING FOR INTEREST FREQ. DAY NO.,IF PRESENT
     C*
     C   21                Z-ADDIFDY      X       20
     C   21                MOVELIFDY      IDAY    4
     C   21                MOVE DEDIT,X   IDAY
     C   21      IFDY      COMP 09                     6060
     C   21 60             MOVELBLK1      IDAY
     C/COPY WNCPYSRC,LE0130C036
     C**
     C**   GET REPAYMENT AND FREQUENCY
     C*
     C                     Z-ADDNRPD      ZDAYNO
     C*
     C                     EXSR ZDATE2
     C*
     C                     MOVE ZADATE    RDATE   7
     C/COPY WNCPYSRC,LE0130C012
     C           RFRQ      LOKUPTABF      TABFRQ         60
     C**********           MOVE TABFRQ    TABFQ2 11                                           CLE064
     C                     MOVE TABFRQ    TABFQ2 15                                           CLE064
     C**
     C**   SET UP EDITING FOR REPAYMENT FREQ. DAY NO.,IF PRESENT
     C**
     C   20                Z-ADDRDYN      X
     C   20                MOVELRDYN      RDAY    4
     C   20                MOVE DEDIT,X   RDAY
     C   20      RDYN      COMP 09                     6060
     C   20 60             MOVELBLK1      RDAY
     C**
     C**   FOR DISCOUNTS CALCULATE TOTAL
     C**
     C   44      CPAM      SUB  TOTI      TOTAL  130
     C   79      NPRAM     SUB  NDAM      TOTAL                           S01392
     C/COPY WNCPYSRC,LE0130C028
     C***79******NRTS      COMP 0                        60               S01392
     C***79*60***          MOVE RTSP      NRTS                            S01392
     C**                                                                  S01392
     C**   FOR ROLLOVER DISCOUNT LOAN CALCULATE DISCOUNT RATE             S01392
     C   79      NBRA      COMP 0                    6060  NEXT BASE RATE S01392
     C***79N60***          Z-ADDBRTE      BASER  117       CUR. BASEJSM08 S01392
     C   79N60             Z-ADD0         BASER  117                      S01392
     C   79N60             GOTO JUMP                                      S01392
     C   79 60             EXSR GETBR                      GET BASE RATE  S01392
     C   79N07             GOTO ENDCON                                    S01392
     C**                                                                  S01392
     C           JUMP      TAG                             ** JUMP TAG  **S01392
     C   79      NSIN      COMP 'A'                      60SPREAD IND.    S01392
     C   79 60   BASER     ADD  NRTS      DSCRTE 117       DISCOUNT RATE  S01392
     C   79 60             GOTO ENDRTE                                    S01392
     C   79      NSIN      COMP 'S'                      60               S01392
     C   79 60   BASER     SUB  NRTS      DSCRTE           DISCOUNT RATE  S01392
     C   79 60             GOTO ENDRTE                                    S01392
     C   79      NRTS      DIV  100       WRK139 139                      S01392
     C   79      WRK139    MULT BASER     DSCRTE                          S01392
     C** OUTPUT OLD RATE IF DISCOUNT RATE CALCULATED IS ZERO.             S01392
     C   79      DSCRTE    IFEQ 0                                         S01392
     C                     Z-ADDINTR      DSCRTE                          S01392
     C                     END                             END IF         S01392
     C*                                                                   S01392
     C           ENDRTE    TAG                             *** ENDRTE *** S01392
     C*
     C*    GET CURRENCY DECIMAL PLACES
     C*
     C**********           MOVEL'20'      TABKEY                          S01194
     C**********           MOVE CCY       CCYK                            S01194
     C**********           MOVE '1'       TABKEY                          S01194
     C**********           EXSR TABCHN                     ***************S01194
     C                     MOVE CCY       K101                            S01194
     C                     CALL 'AOCURRR0'PLISTB                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE '09'      DBASE            * DB ERROR 09 *S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO ENDCON                                    S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,LE0130C001
     C**N07*****           MOVE '09'      DBASE            * DB ERROR 09 *S01194
     C**N07*****           MOVE 'TABLE'   DBFILE                          S01194
     C**N07*****           MOVELTABKEY    DBKEY                           S01194
     C**N07*****           SETON                     U7U8LR               S01194
     C**N07*****           GOTO ENDCON                                    S01194
     C           CDP       COMP 1                      4041
     C           CDP       COMP 2                    43  42
     C*
     C*    MOVE SETTLEMENT FIELDS FOR LOAN/DEP OR N.A.PURCH INTO
     C*    RECEIPT/PAYMENT GROUPS - SEE DATA STRUCTURES
     C*
     C                     SETOF                     49
     C  N37N38             SETON                     49
     C   49                MOVE SETTLP    SETTLR
     C   49                MOVE SETTL1    SETTLP
     C  N49                MOVE SETTL1    SETTLR
     C   79                MOVE SETTL2    SETTLR                          S01392
     C*
     C*    SET INDICATORS FOR RECEIPT SETTLEMENT TYPE
     C*
     C                     EXSR SETTYP
     C*
     C*    SET UP OUR RECEIPT NOSTRO FIELDS
     C*
     C                     SETOF                     6117
     C                     MOVE OPCA      NOSTRO
     C                     MOVE OPSB      BRC                             S01117
     C                     EXSR QNOSTR
     C                     MOVELARRAY     TITL1  40
      *                                                                                       CLE033
     C           CLE033    IFEQ 'Y'                                                           CLE033
     C           PCST      ANDEQ09                                                            CLE033
     C                     MOVELTHRACC    NAME1                                               CLE033
     C           OPSB      CAT  OPCA      TOWN1                                               CLE033
     C                     ELSE                                                               CLE033
     C                     MOVE CPNM      NAME1  35
     C*********************MOVELCPTN      TOWN1  10                       091120
     C**********           MOVELCPTN      TOWN1  11                                    091120 CLE033
     C**********           MOVELCPTN      TOWN1  15                                    CLE033 CGL029
     C                     MOVELCPTN      TOWN1  21                                           CGL029
     C                     ENDIF                                                              CLE033
     C*
     C*    SET UP THEIR PAYMENT NOSTRO FIELDS
     C*
     C                     MOVELTSCN      NOSTRO
     C                     EXSR CPNOS
     C                     MOVELARRAY     TITL3  10
     C                     MOVE CPNM      NAME3  35
     C                     MOVE CPTN      TOWN3  20
     C   79                SETON                     39                   S01392
     C***39******          SETON                     24                   E10924
     C   39N24             MOVE SPINST    TITL6            RISK LOAN SPI. E10924
     C   39                GOTO PRINT
     C*
     C*    SET INDICATORS FOR PAYMENT SETTLEMENT TYPE
     C*
     C                     Z-ADDSCST      PCST
     C                     EXSR SETTYP
     C*
     C*    SET UP OUR PAYMENT NOSTRO FIELDS
     C*
     C                     SETON                     61
     C                     MOVE OSCA      NOSTRO
     C                     MOVE OSSB      BRC                             S01117
     C                     EXSR QNOSTR
     C                     MOVELARRAY     TITL2  27
      *                                                                                       CLE033
     C           CLE033    IFEQ 'Y'                                                           CLE033
     C           PCST      ANDEQ09                                                            CLE033
     C                     MOVELTHRACC    NAME2                                               CLE033
     C           OSSB      CAT  OSCA      TOWN2                                               CLE033
     C                     ELSE                                                               CLE033
     C                     MOVE CPNM      NAME2  35
     C*********************MOVELCPTN      TOWN2  10                       091120
     C**********           MOVELCPTN      TOWN2  11                                    091120 CLE033
     C**********           MOVELCPTN      TOWN2  15                                    CLE033 CGL029
     C                     MOVELCPTN      TOWN2  21                                           CGL029
     C                     ENDIF                                                              CLE033
     C*
     C*    SPECIAL INSTRUCTIONS
     C*
     C  N51N52N54
     CANN57                SETON                     24
     C  N24                MOVE SPINST    TITL6  20
     C*
     C**   IGNORE BLANK SPECIAL INSTRUCTIONS
     C   24                GOTO BENEND
     C*
     C**   CHECK FOR BENIFICIARY BANK DETAILS
     C           SPEC5     COMP '/BEN/'              606025
     C   60                GOTO BENEND
     C*
     C**   CHECK FOR CHIPS NUMBER
     C           SPEC8     COMP '/CH'                    60
     C   60                MOVE SPEC14    WORK6   6
     C   60                MOVE *BLANKS   SPI1
     C   60                MOVE 'CHIPS'   SPEC5
     C   60                MOVE WORK6     SPEC12
     C   60                GOTO BENEND
     C*
     C**   CHECK FOR FED. WIRE NUMBER
     C           SPEC8     COMP '/FW'                    60
     C   60                MOVE SPEC17    WORK9   9
     C   60                MOVE *BLANKS   SPI1
     C   60                MOVE 'FED.WIRE'SPEC9
     C   60                MOVE WORK9     SPEC18
     C   60                GOTO BENEND
     C*
     C**   MUST NOW BE 'ACCOUNT'
     C                     MOVE SPEC30    WORK25 25
     C                     MOVE *BLANKS   SPI1
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK25    SPEC29
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
     C*    SET UP THEIR RECEIPT NOSTRO FIELDS
     C*
     C                     MOVELTPCN      NOSTRO
     C                     EXSR CPNOS
     C                     MOVELARRAY     TITL4  10
     C                     MOVE CPNM      NAME4  35
     C/COPY WNCPYSRC,LE0130C037
     C                     MOVE CPTN      TOWN4  20
     C*
     C*    GET FOR A/C OF
     C*
     C                     MOVELFACO      NOSTRO
     C   51N23             EXSR CPNOS
     C*
     C*    GET NAME AND ADDRESS LINES AND PRINT CONFIRMATION
     C           PRINT     TAG                             ***  PRINT  ***
     C**********           MOVELCNUM      CLIKEY                          S01194
     C                     MOVELCNUM      AENB                            S01194
     C                     MOVELCNUM      CKEY                            S01194
     C**
     C**   CHECK IF COUNTERPARTY SWIFT MEMBER FROM CLINT RECORD 'A'
     C***U4*****           MOVE 'A'       CLIKEY                          S01194
     C***U4*****           EXSR CLICHN                                    S01194
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C****************************************************************    S01167
     C**************************************************************** I. S01167
     C**                   SETOF                     8581                 S01167
     C** U4 08   SWTX      IFEQ 'T'                         TELEX         S01167
     C**                   SETON                     8185                 S01167
     C**                   ELSE                                           S01167
     C** U4 08   SWTX      IFEQ 'S'                         SWIFT         S01167
     C**                   SETON                     81                   S01167
     C**                   END                                            S01167
     C**                   END                                            S01167
     C*                                                                   S01167
     C**  REMOVE OLD ROUTING                                              S01310
     C*                                                                   S01310
     C*IF*GENERATE*SWIFT*MSG*IND*=*Y*THEN*81*SET*ON**************** S01167S01310
     C                     SETOF                     8581                 S01167
     C***********SWTX      COMP 'T'                      85         S01167S01310
     C***U4*08***GSFM      IFEQ 'Y'                                 S01167S01310
     C***********          SETON                     81             S01167S01310
     C***********          END                                      S01167S01310
     C*                                                                   S01167
     C**   IF SWIFT ADDRESS BIC CODE DO NOT OUTPUT TO LEEXTAB             S01167
     C***                                                                 S01167
     C***********          MOVE CSID      CBIC    4                 S01167S01310
     C***********GSFM      IFEQ 'Y'                                 S01167S01310
     C***********CBIC      ANDEQ'BIC '                              S01167S01310
     C***********PCST      ANDEQ08                                  S01167S01310
     C***********          SETOF                     81             S01167S01310
     C***********          END                                      S01167S01310
     C****************************************************************    E13046
     C***CHECK*TO*MAKE*SURE*THAT*CORRECT*SWIFT/TELEX*NUMBER*IS*WRITTS01135E13046
     C***TO*EXTRACT*FILE********************************************S01135E13046
     C*********************                                         S01135E13046
     C*********************SETOF                     8581           S01135E13046
     C***U4*08***SWTX******IFEQ 'T'                         TELEX   S01135E13046
     C*********************SETON                     8185           S01135E13046
     C*********************ELSE                                     S01135E13046
     C***U4*08***SWTX******IFEQ 'S'                         SWIFT   S01135E13046
     C*********************SETON                     81             S01135E13046
     C*********************END                                      S01135E13046
     C*********************END                                      S01135E13046
     C*                                                                   S01135
     C**************   U4 08   CSID      COMP ' '                  8181   S01135
     C*                                                                   S01310
     C** INSERT NEW MG ROUTING                                            S01310
     C*                                                                   S01310
     C                     MOVE CSID      @BIC    4                       S01310
     C                     MOVELBRCA      @DSNB   3                       S01310
     C                     MOVELCNUM      @CUST   6                       S01310
     C***********          EXSR ROUT                               S01310 CSW096
     C                     EXSR SRROUT                                    CSW096
     C*                                                                   S01310
     C** -  LEEXT REC IS PRODUCED IF LENDING MESSAGE FLAG IS ON  -        S01344
     C** - MESSAGE NETWORK CAN BE CHANGED VIA MESSAGE MANAGEMENT -        S01344
     C*                                                                   S01310
     C           BGSWCL    IFEQ 'Y'                                       S01310
     C*                                                                   S01310
     C           *INU1     IFEQ '1'                                       S01310
     C                     SETON                     81                   S01310
     C                     END                                            S01310
     C*                                                                   S01310
     C                     ELSE                                           S01310
     C                     SETOF                     81                   S01310
     C                     END                                            S01310
     C*                                                                   S01310
     C** IF NETWORK IS 'PAPER' AND NON-ISO CONFS ARE TO BE PRODUCED       S01310
     C** - SET OFF 96 -                                                   S01310
     C** TO SUPPRESS AUTO-TRANSMISSION TEXT ON PRINTOUT                   S01310
     C*                                                                   S01310
     C           BGSWCL    IFEQ 'Y'                                       S01344
     C                     CALL 'AOMGMER0'                                S01344
     C                     PARM '*MSG    '@RTCD                           S01344
     C                     PARM '*FIRST  '@OPTN                           S01344
     C           @MGME     PARM @MGME     DSFDY                           S01344
     C*                                                                   S01344
     C           @RTCD     IFNE *BLANK                                    S01344
     C                     MOVEL'SDMGMEPD'DBFILE            * * * * * * * S01344
     C                     MOVEL'12'      DBASE             *DBERROR 12 * S01344
     C                     SETON                     U7U8LR * * * * * * * S01344
     C                     EXSR *PSSR                                     S01344
     C                     END                                            S01344
     C*                                                                   S01344
     C           @NWRK     IFEQ 'PAPER'                                   S01310
     C           ENFFCR    ANDEQ'Y'                                       S01310
     C                     SETOF                     96                   S01310
      ** - Don't output to LEEXT if ENFFCR is 'Y' & network is 'PAPER'                        207469
     C                     MOVE *OFF      *IN81                                               207469
     C                     ELSE                                           S01310
     C                     SETON                     96                   S01310
     C                     END                                            S01310
     C*                                                                   S01310
     C                     ELSE                                           S01310
     C                     SETOF                     96                   S01310
     C/COPY WNCPYSRC,LE0130C038
     C                     END                                            S01310
     C*                                                                   S01310
     C   U4 81 39          SETOF                     81
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0130CCP5                                           S01408
     C*                                                                   S01408
     C**
     C* IFEQ 'B' BYPASS ALTERNATE NAME & ADDRESS VALIDATION               LN0007
     C**
     C           NACD      IFNE 'B'                                       LN0007
     C*                                                                   LN0007
     C**********           MOVE NACD      CLIKEY                          S01194
     C                     MOVE NACD      AZCD                            S01194
     C********** CUST      TAG                             ***  CUST   ***S01194
     C**********           EXSR CLICHN                                    S01194
     C                     CALL 'AOALTNR0'PLIST2                          S01194
     C**
     C*****IF*ALTERNATE*NAME AND ADDRESS NOT FOUND DEFAULT TO B           S01194
     C*****DATABASE ERROR*ONLY IF B RECORD NOT FOUND.                     S01194
     C**
     C**N08*****           MOVE CLIKEY    CHECK   1                       S01194
     C**N08***** CHECK     COMP 'B'                  6262                 S01194
     C**N08*62**           MOVE 'B'       CLIKEY                          S01194
     C**N08*62**           GOTO CUST                                      S01194
     C**
     C**N08*****           MOVEL'CLIENT'  ERM                             S01194
     C**N08*****           MOVELERM       CNA1                            S01194
     C                     END                                            LN0007
     C*
     C**   IF ALTERNATE NAME AND ADDRESS NOT FOUND DEFAULT TO             S01194
     C**   NAME AND ADDRESS ON SDCUSTPD                                   S01194
     C**
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           NACD      OREQ 'B'                                       LN0007
     C                     MOVE BBCNA1    CNA1                            S01194
     C                     MOVE BBCNA2    CNA2                            S01194
     C                     MOVE BBCNA3    CNA3                            S01194
     C                     MOVE BBCNA4    CNA4                            S01194
     C                     END                                            S01194
     C**********           MOVE 'A'       CLIKEY                          S01194
     C*                                                                   S01465
     C** If guarantees issued is active AND receiver of the guarantee     S01465
     C** is not equal to zeros AND processing type is 70, print the       S01465
     C** corresponding report name and town of the receiver of the        S01465
     C** guarantee                                                        S01465
     C*                                                                   S01465
     C           *IN05     IFEQ '1'                                       S01465
     C           *IN39     ANDEQ'1'                                       S01465
     C********** RECE      ANDNE*ZEROS                                    S01465              CSD027
     C           RECE      ANDNE*BLANKS                                                       CSD027
     C                     MOVEL*BLANKS   CKEY                            S01465
     C                     MOVE CTWN      SVCTWN                          S01465
     C                     MOVELRECE      CKEY                            S01465
     C*                                                                   S01465
     C** Call program to access customer details                          S01465
     C*                                                                   S01465
     C                     CALL 'AOCUSTR0'PLIST1                          S01465
     C*                                                                   S01465
     C** Database error if no record found                                S01465
     C*                                                                   S01465
     C           @RTCD     IFNE *BLANKS                                   S01465
     C                     MOVEL'SDCUSTPD'DBFILE           ************   S01465
     C                     MOVELCKEY      DBKEY            * DBERR 20 *   S01465
     C                     Z-ADD20        DBASE            ************   S01465
     C                     SETON                     U7U8LR               S01465
     C                     EXSR *PSSR                                     S01465
     C                     GOTO ENDCON                                    S01465
     C                     ELSE                                           S01465
     C                     SETON                     06                   S01465
     C                     MOVELCRNM      RCRN   20                       S01465
     C                     MOVELCTWN      RCTW   10                       S01465
     C                     MOVE SVCTWN    CTWN                            S01465
     C                     END                                            S01465
     C                     END                                            S01465
     C/COPY WNCPYSRC,LE0130C032
     C*
     C   U4 81             ADD  1         NORET
     C*
      ** If CLE004 is ON, print confirmation only if consolidated         CLE004
      ** confirmation is 'Y' and non-system generated                     CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           BPCONR    IFEQ 'N'                                       CLE004
     C           MNSG      ANDEQ'M'                                       CLE004
     C                     MOVE '1'       *IN69                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN69                           CLE004
     C                     ENDIF                                          CLE004
     C                     ELSE                                           CLE004
     C                     SETON                     69
     C                     ENDIF                                          CLE004
     C*
     C*****IF*THE*CUSTOMER*LENDING*/*TELEX*MODULE*BIT*INDICATOR*IS*ON     S01310
     C*****TEST*IF*TELEXES*ARE*TO*BE*SENT*FOR*THIS*CUSTOMER**********     S01310
     C*
     C                     SETOF                     61
     C***U1*****           TESTB'3'       TLXM           61               S01194
     C***U1******BGMTMI    COMP 'Y'                      61         S01194S01310
     C***U1*61*            MOVELCNUM      CLIKEY                          S01194
     C***U1*61*            MOVE 'A'       CLIKEY                          S01194
     C*
     C**   ACCESS CLINT 'A' RECORD TO GENERATE TELEX FOR THIS CUSTOMER
     C*
     C***U1*61**           EXSR CLICHN                                    S01194
     C***U1*61**           MOVE CNUM      CKEY                      S01194LN0345
     C***U1*61**           MOVELCNUM      CKEY                      LN0345S01310
     C***U1*61*            CALL 'AOCUSTR0'PLIST1                    S01194S01310
     C***U1*61*08          TESTB'3'       TLXR           78         S01194S01310
     C***U1*61*08BBCMTI    COMP 'Y'                      78         S01194S01310
     C*
     C*****IF*CONFIRM*IS*A*COPY*DO*NOT*OUTPUT*TO*THE*TELEX*FILE**         S01310
     C*
     C***63******          SETOF                     78                   S01310
     C*                                                                   S01392
     C*  THE FOLLOWING CODING BECAME REDUNDANT AND THEREFORE REMOVED      S01392
     C*                                                                   S01392
     C*********************                                        E13046 S01392
     C**PERFORM*INTEREST*RATE*CALCULATION FOR *IN33, *IN35, *IN37  E13046 S01392
     C*********************                                        E13046 S01392
     C***Save*the*current*value*of*indicator*96*(used*for*determiniE31465 S01392
     C***if*"AUTO*TRANSMISSION*....."*is*printed*on*report)******* E31465 S01392
     C*********************MOVE**IN96*****IND96***1*************** E31465 S01392
     C********** *IN33*****IFEQ '1'                                E13046 S01392
     C********** *IN35*****OREQ '1'                                E13046 S01392
     C********** *IN37*****OREQ '1'                                E13046 S01392
     C*********************Z-ADDMDAT      ZIEND                    E13046 S01392
     C*********************Z-ADDVDAT      ZIBEG                    E13046 S01392
     C*********************Z-ADDICBS      ZICALC                   E13046 S01392
     C*********************Z-ADDINTR      ZIRATE       88          E13046 S01392
     C*********************Z-ADDCPAM      ZIAMT                    E13046 S01392
     C*********************EXSR GLINTC                             E13046 S01392
     C*********************Z-ADDZINTR     ITOT   130H              E13046 S01392
     C*********************END                                     E13046 S01392
      *********************************************************
     C*********************************************************    E31465 S01392
     C***Restore*value*of*indicator*96*(ind.*96*is*changed*in*GLINTE31465 S01392
     C*********************MOVE*IND96******IN96****************    E31465 S01392
      *                                                                                       CLE031
      ** If CLE031 is on, format fields.                                                      CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           *IN79     ANDEQ*OFF                                                          CLE031
     C           CCY       ANDNESCCY                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
     C           CLE031    OREQ 'Y'                                                           CLE031
     C           *IN79     ANDEQ*OFF                                                          CLE031
     C           CCY       ANDNEPSCY                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** Determine if receipt settlement currency is an In Currency.                          CLE031
      *                                                                                       CLE031
     C                     MOVE *OFF      *IN17                                               CLE031
     C           SCCY      IFNE *BLANK                                                        CLE031
     C                     MOVE SCCY      K101                                                CLE031
     C                     CALL 'AOCURRR0'PLISTB                                              CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C                     Z-ADD28        DBASE                                               CLE031
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     GOTO ENDCON                                                        CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE A6INCY    WRINC   1                                           CLE031
     C                     Z-ADDCDP       WRNDP   10                                          CLE031
     C                     MOVE SCCY      WCCY1   3                                           CLE031
     C           CDP       COMP 1                      1012                                   CLE031
     C           CDP       COMP 2                    14  13                                   CLE031
     C                     MOVE *ON       *IN17                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Determine if payment settlement currency is an In Currency.                          CLE031
      *                                                                                       CLE031
     C                     MOVE *OFF      *IN76                                               CLE031
     C           PSCY      IFNE *BLANK                                                        CLE031
     C                     MOVE PSCY      K101                                                CLE031
     C                     CALL 'AOCURRR0'PLISTB                                              CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C                     Z-ADD25        DBASE                                               CLE031
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     GOTO ENDCON                                                        CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE A6INCY    WPINC   1                                           CLE031
     C                     Z-ADDCDP       WPNDP   10                                          CLE031
     C                     MOVE PSCY      WCCY2   3                                           CLE031
     C           CDP       COMP 1                      1526                                   CLE031
     C           CDP       COMP 2                    74  70                                   CLE031
     C                     MOVE *ON       *IN76                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Determine if loan currency is an In Currency.                                        CLE031
      *                                                                                       CLE031
     C                     MOVE CCY       K101                                                CLE031
     C                     CALL 'AOCURRR0'PLISTB                                              CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C                     Z-ADD26        DBASE                                               CLE031
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     GOTO ENDCON                                                        CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE A6INCY    WLINC   1                                           CLE031
     C                     Z-ADDCDP       WLNDP   10                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** If processing a parts sold                                                           CLE031
      *                                                                                       CLE031
     C           PTYP      IFEQ 66                                                            CLE031
     C           PTYP      OREQ 67                                                            CLE031
     C           PTYP      OREQ 69                                                            CLE031
     C           PTYP      OREQ 72                                                            CLE031
      *                                                                                       CLE031
      ** Format first set of fields                                                           CLE031
      *                                                                                       CLE031
     C           CCY       IFNE PSCY                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or payment settlement currency is an In                               CLE031
      ** Currency, convert total amount by calling EU0200.                                    CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WPINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDTOTAL     PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE PSCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT1 130                                          CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert total amount to payment currency using                                 CLE031
      ** the payment settlement exchange rate.                                                CLE031
      *                                                                                       CLE031
     C                     Z-ADDTOTAL     ZAMTCI                                              CLE031
     C                     Z-ADDPEXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE PSCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WPNDP     ZCDPO                                               CLE031
     C                     MOVE PEXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format second set of fields                                                          CLE031
      *                                                                                       CLE031
     C           CCY       IFNE SCCY                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or receipt settlement currency is an In                               CLE031
      ** Currency, convert principal (or discount principal) by                               CLE031
      ** calling EU0200.                                                                      CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WRINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDCPAM      PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE SCCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT2 130                                          CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert principal (or discount principal) to                                   CLE031
      ** settlement currency using the receipt exchange rate.                                 CLE031
      *                                                                                       CLE031
     C                     Z-ADDCPAM      ZAMTCI                                              CLE031
     C                     Z-ADDREXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE SCCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WRNDP     ZCDPO                                               CLE031
     C                     MOVE REXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT2                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Since 1st set of fields are of payment settlement details,                           CLE031
      ** swap number of decimal places indicators of SCCY and PSCY.                           CLE031
      *                                                                                       CLE031
     C                     MOVE PSCY      WCCY1                                               CLE031
     C                     MOVE SCCY      WCCY2                                               CLE031
     C                     MOVE *IN17     WIND0   1                                           CLE031
     C                     MOVE *IN76     *IN17                                               CLE031
     C                     MOVE WIND0     *IN76                                               CLE031
      *                                                                                       CLE031
     C                     MOVE *IN10     WIND0                                               CLE031
     C                     MOVE *IN12     WIND1   1                                           CLE031
     C                     MOVE *IN13     WIND2   1                                           CLE031
     C                     MOVE *IN14     WIND3   1                                           CLE031
      *                                                                                       CLE031
     C                     MOVE *IN15     *IN10                                               CLE031
     C                     MOVE *IN26     *IN12                                               CLE031
     C                     MOVE *IN70     *IN13                                               CLE031
     C                     MOVE *IN74     *IN14                                               CLE031
      *                                                                                       CLE031
     C                     MOVE WIND0     *IN15                                               CLE031
     C                     MOVE WIND1     *IN26                                               CLE031
     C                     MOVE WIND2     *IN70                                               CLE031
     C                     MOVE WIND3     *IN74                                               CLE031
      *                                                                                       CLE031
      ** Else if processing a non-parts sold                                                  CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** Format first set of fields                                                           CLE031
      *                                                                                       CLE031
     C           CCY       IFNE SCCY                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or receipt settlement currency is an In                               CLE031
      ** Currency, convert total amount by calling EU0200.                                    CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WRINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDTOTAL     PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE SCCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT1                                              CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert total amount to receipt currency using                                 CLE031
      ** the receipt settlement exchange rate.                                                CLE031
      *                                                                                       CLE031
     C                     Z-ADDTOTAL     ZAMTCI                                              CLE031
     C                     Z-ADDREXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE SCCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WRNDP     ZCDPO                                               CLE031
     C                     MOVE REXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format second set of fields                                                          CLE031
      *                                                                                       CLE031
     C           CCY       IFNE PSCY                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or pay settlement currency is an In Currency,                         CLE031
      ** convert the principal (or discount principal) by calling                             CLE031
      ** EU0200.                                                                              CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WPINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDCPAM      PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE PSCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT2                                              CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert principal (or discount principal) to                                   CLE031
      ** settlement currency using the pay exchange rate.                                     CLE031
      *                                                                                       CLE031
     C                     Z-ADDCPAM      ZAMTCI                                              CLE031
     C                     Z-ADDPEXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE PSCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WPNDP     ZCDPO                                               CLE031
     C                     MOVE PEXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT2                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C*
     C/COPY WNCPYSRC,LE0130C020
     C                     EXSR EXCPT
     C                     SETOF                     25
     C                     SETOF                     06                   S01465
     C*
     C           ENDCON    ENDSR                           ***  ENDCON ***
     C*
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SRCONV - Convert amounts to Euro ccy equivalent.             *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCONV    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     CALL 'EU0200'                                                      CLE031
     C                     PARM *BLANKS   PRTCD   7                                           CLE031
     C                     PARM           PFRAM  183                                          CLE031
     C                     PARM           PFRCY   3                                           CLE031
     C                     PARM           PTOCY   3                                           CLE031
     C                     PARM           POUTA  150                                          CLE031
     C                     PARM           PINTA  183                                          CLE031
     C                     PARM           PEXRT  159                                          CLE031
     C                     PARM           PMDIN   1                                           CLE031
      *                                                                                       CLE031
      ** Handle Error                                                                         CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANKS                                                       CLE031
     C                     MOVEL'EU0200  'DBFILE                                              CLE031
     C                     MOVEL'*CALL   'DBKEY                                               CLE031
     C                     Z-ADD27        DBASE                                               CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      /EJECT                                                                                  CLE031
     C********************************************************************
     C*    SUBROUTINE TO GET OUR NOSTRO DETAILS
     C*
     C*    QNOSTR IS CALLED BY - CONF
     C*
     C*              CALLS - MOVEA;TABCHN;CLICHN
     C*
     C           QNOSTR    BEGSR                           ***  QNOSTR ***
     C*
     C                     MOVE BLANK     CPNM
     C                     MOVE BLANK     CPTN
     C/COPY WNCPYSRC,LE0130C014
     C                     MOVE *BLANKS   CPORAC 25                       S01117
     C/COPY WNCPYSRC,LE0130C015
     C*
     C*    SET UP TITLE
     C*
     C                     Z-ADD1         A
     C                     MOVELPAYAT     ADDDS
     C                     EXSR MOVEA
     C*
     C  N39                MOVELVALDAT    ADDDS
     C   49N61N39
     CORN49 61             MOVELMATDAT    ADDDS
     C   39                MOVELFEEDUE    ADDDS
     C   79                MOVELROLDAT    ADDDS                           S01392
     C                     EXSR MOVEA
     C*
     C  N61 51             MOVELTOURAC    ADD
     C   50 61
     COR 51 61
     COR 54
     COR 57                MOVEL'BY'      ADD
     C   50N61             MOVEL'TO'      ADD
     C                     EXSR MOVEA
     C*
     C*    SET UP NARRATIVE OR NAME AND TOWN FIELDS
     C*
     C*    SETTLE. TYPE 01 - GET NAME & TOWN FROM NOSTRO & CLINT RECORDS
     C*
     C  N51                GOTO NONAME
     C*
     C*    IS EITHER CCY LOCAL AND OURSELVES OR NOSTRO IND
     C*    ON I.C.D. 2 BLANK
     C*
     C           CCY       COMP LOCY                     60
     C   18                SETOF                     60
     C   60                MOVELOURSEL    CPNM
     C   60                GOTO NONAME
     C*
     C*    IS NOSTRO CODE PRESENT.
     C*
     C   51      NOS       COMP '  '                     67
     C   51N67   NOS       COMP '00'                     67
     C*                                                                   E39524
     C** IF THE SETTLEMENT DETAILS FIELD FOR OUR NOSTROS IS BLANK         E39524
     C** SUPPRESS THE WRITE TO LEEXTAB. HENCE NO MESSAGE WILL BE          E39524
     C** PRODUCED.                                                        E39524
     C*                                                                   E39524
     C           *IN67     IFEQ '1'                                       E39524
     C           *IN51     ANDEQ'1'                                       E39524
     C                     MOVE '0'       *IN81                           E39524
     C                     END                                            E39524
     C*                                                                   E39524
     C   51 67             GOTO NONAME
     C*
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If SAR On      CEU004
     C           SCCY      ANDNE*BLANKS                    And Stl Ccy    CEU004
     C                     MOVE SCCY      WKCCY   3         Set Ccy       CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C                     MOVE CCY       WKCCY             Set Ccy       CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                                       CLE031
      ** If feature CLE031 is on then set up the WKCCY field as follows                       CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PTYP      IFNE 66                                                            CLE031
     C           PTYP      ANDNE67                                                            CLE031
     C           PTYP      ANDNE69                                                            CLE031
     C           PTYP      ANDNE72                                                            CLE031
     C                     MOVE SCCY      WKCCY                                               CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE PSCY      WKCCY                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CEU004
     C*****ACCESS*NOSTRO*TABLE*RECORD.                                    S01194
     C*    ACCESS SDNOSTPD                                                S01194
     C*
     C**********           MOVEL'70'      TABKEY                          S01194
     C**********           MOVE CCY       CCYKN                           S01194
     C**********           MOVE NOS       TABKEY                          S01194
     C**********           EXSR TABCHN                                    S01194
     C***********          MOVE CCY       KEYB                     S01194 CEU004
     C                     MOVE WKCCY     KEYB             Set Key B      CEU004
     C                     MOVE NOS       KEYE                            S01194
     C                     CALL 'AONOSTR0'PLISTC                          S01194
     C           @RTCD     COMP *BLANKS                  07               S01194
     C  N07                MOVEL'NOSTRO'  ERM                             S01194
     C  N07                MOVELERM       CPNM
     C  N07                GOTO ENDNOS
     C  N61      ORAC      COMP BLK25                1717
     C*
     C*    GET CLIENT RECORD.
     C*
     C**********           MOVELCNUMN     CLIKEY                          S01194
     C           QCLINT    TAG                             ***  QCLINT ***
     C***51*****           EXSR CLICHN                                    S01194
     C**********           MOVE CNUMN     CKEY                      S01194LN0345
     C                     MOVELCNUMN     CKEY                            LN0345
     C   51                CALL 'AOCUSTR0'PLIST1                          S01194
     C           @RTCD     COMP *BLANKS                  08               S01194
     C  N08                MOVEL'NOSTRO'  ERM
     C  N08                MOVELERM       CPNM
     C   08                MOVELCRNM      CPNM
     C   08                MOVELCTWN      CPTN
     C/COPY WNCPYSRC,LE0130C016
     C   08                MOVELORAC      CPORAC                          S01117
     C/COPY WNCPYSRC,LE0130C017
     C*
     C           NONAME    TAG                             ***  NONAME ***
     C*
     C*    BLANK OUT 'OUR A/C WITH' IF 'INSTRS.TO BE ADVISED' OR
     C*    'OURSELVES' TO BE PRINTED.
     C*
     C   51 60N61A         ADD  3         A
     C   51 60N61
     COR 51 67N61          EXSR MOVEA
     C*
     C   51 67
     COR 50                MOVELINSADV    CPNM
     C   50
     COR 51                GOTO ENDNOS
     C*
     C*    SET UP PAY AND RECEIPT NARRATIVES
     C*
     C   54                MOVELAC        CPTN
     C   54                MOVE '-'       DASH
     C   54                MOVE SEQ       SEQX
     C   54                MOVE '-'       DASH2                           S01117
     C   54                MOVE BRC       BRCX                            S01117
     C   57                MOVELRETAC     CPTN
     C   61                GOTO QPAY
     C*
     C*         - RECEIPT NARRATIVE
     C*
     C           REC       TAG                             ***  REC    ***
     C   52                MOVELWAITR     CPNM
     C   55
     COR 53                MOVELPEROUR    CPNM
     C   55
     COR 53                MOVELASPER     CPNM
     C   54
     COR 57                MOVELDRTOAC    CPNM
     C   56                MOVELWECOL     CPNM
     C                     GOTO ENDNOS
     C*
     C*         - PAY NARRATIVE
     C*
     C           QPAY      TAG                             ***  QPAY   ***
     C   52                MOVELSENDR     CPNM
     C   52                MOVELSEND      CPNM
     C   55
     COR 53                MOVELPERYOR    CPNM
     C   54
     COR 57                MOVELCRTOAC    CPNM
     C   54
     COR 57                MOVEL'CRED'    CPNM
     C   56                MOVELYOUCOL    CPNM
     C   56                MOVEL'YOU'     CPNM
     C*
     C           ENDNOS    ENDSR                           ***  ENDNOS ***
     C*
     C********************************************************************
     C*    SUBROUTINE TO GET THEIR NOSTRO AND FOR A/C OF DETAILS
     C*
     C*
     C*    CPNOS IS CALLED BY - CONF
     C*
     C*             CALLS - MOVEA;CLICHN;TABCHN
     C*
     C***********
     C           CPNOS     BEGSR                           ***  CPNOS  ***
     C*
     C                     MOVE BLANK     CPNM
     C                     MOVE BLANK     CPTN
     C                     MOVE BLANK     ARRAY
     C*
     C*    SET UP TITLE
     C*
     C                     Z-ADD1         A
     C                     MOVE 'BY'      PAY
     C   61                MOVE 'TO'      PAY
     C   50
     COR 51                MOVELPAY       ADD
     C                     EXSR MOVEA
     C*
     C*    SET UP NAME
     C*
     C/COPY WNCPYSRC,LE0130C024
     C           RETAC     COMP BLANK                    60
     C   50
     COR 51 60             MOVELAWAITA    CPNM
     C  N51
     COR 60                GOTO ENDCPN
     C/COPY WNCPYSRC,LE0130C025
     C*
     C*    SETTLEMENT TYPES 01,07,08 AND NOSTRO NON-BLANK - GET NAME
     C*    AND TOWN FROM COUNTERPARTY SHORTNAME OR CUSTOMER NO.
     C*
     C** IF THE SETTLEMENT FIELD DETAILS FIELD FOR THEIR NOSTRO           E39524
     C** IS BLANK SUPPRESS THE WRITE TO LEEXTAB. HENCE NO MESSAGE         E39524
     C** IS PRODUCED                                                      E39524
     C*                                                                   E39524
     C           CUSTNO    IFEQ *BLANKS                                   E39524
     C           *IN51     ANDEQ'1'                                       E39524
     C                     MOVE '0'       *IN81                           E39524
     C                     END                                            E39524
     C*                                                                   E39524
     C           CUSTNO    COMP CNUMA                    60
     C***60*****           MOVELYERSEL    CPNM                            BHF312
     C***60******          MOVE YERSEL    CPNM                      BHF312S01310
     C   60                MOVELYERSEL    CPNM                            S01310
     C   60                GOTO ENDCPN
     C**********           MOVELCUSTNO    CLIKEY                          S01194
     C**********           EXSR CLICHN                                    S01194
     C**********           MOVELCUSTNO    CKEY                      S01194140158
     C                     MOVELNOSTRO    CKEY                            140158
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C                     MOVE *BLANKS   CKEY                            140158
     C           @RTCD     COMP *BLANKS                  08               S01194
     C   08                MOVELCRNM      CPNM
     C   08                MOVELCTWN      CPTN
     C**********           MOVEL'71'      TABKEY                          S01194
     C**N08*****           MOVE CPSH      TABKEY                          S01194
     C**N08*****           EXSR TABCHN                                    S01194
     C  N08                MOVE CPSH      ARCD                            S01194
     C  N08                CALL 'AOCNSTR0'PLISTF                          S01194
     C           *IN08     IFEQ '0'                                       140158
     C                     MOVELCNTN      CPTN                            140158
     C                     ENDIF                                          140158
     C  N08      @RTCD     COMP *BLANKS                  07               S01194
     C  N07N08             MOVEL'NOSTRO'  ERM
     C  N07N08             MOVELERM       CPNM
     C*
     C           ENDCPN    ENDSR                           ***  ENDCPN ***
     C*
     C********************************************************************
     C*    SET INDICATORS FOR SETTLEMENT TYPE
     C*    SETTYP IS CALLED BY - CONF
     C***********
     C           SETTYP    BEGSR                           ***  SETTYP ***
     C                     SETOF                     5657
     C                     SETOF                     535455
     C           PCST      COMP 01                   525051
     C   52      PCST      COMP 03                   545253
     C   54      PCST      COMP 05                   535455
     C   53      PCST      COMP 07                     5351
     C  N51      PCST      COMP 08                   56  51
     C   56      PCST      COMP 14                     5657
      *                                                                                       CLE033
      ** If CLE033 is on and Settle method is '09', do same processing                        CLE033
      ** as Settle method '08'                                                                CLE033
      *                                                                                       CLE033
     C           CLE033    IFEQ 'Y'                                                           CLE033
     C           PCST      ANDEQ09                                                            CLE033
     C  N51      PCST      COMP 09                   56  51                                   CLE033
     C                     ENDIF                                                              CLE033
      *                                                                                       CLE033
     C                     ENDSR
     C********************************************************************
     C*    SUBROUTINE TO INSERT WORDS IN NARRATIVE AT VARIABLE POSITIONS
     C*    AND KEEP COUNT OF NEXT POSITION.  SEE DATA STRUCTURES.
     C*    MOVEA IS CALLED BY - CONF;NOSTRO;CPNOS
     C***********
     C           MOVEA     BEGSR                           ***  MOVEA  ***
     C                     MOVEAADD       AR,A
     C           A         ADD  LENGTH    A
     C                     MOVE BLANK     ADDDS
     C                     Z-ADD0         LENGTH
     C                     ENDSR
     C********************************************************************
     C**   INFOSR - SUBROUTINE TO STORE INFORMATION ABOUT PROCESSING &
     C**   REPAYMENT TYPE FOR CLOAN RECORDS
     C*    INFOSR IS CALLED BY - MAIN PROCESSING
     C***********
     C           INFOSR    BEGSR                           ***  INFOSR ***
     C                     MOVE *BLANKS   WFLG    1                       159259
     C           PTYP      COMP 62                     3233
     C           PTYP      COMP 63                       34
     C           PTYP      COMP 64                       35
     C           PTYP      COMP 65                       36
     C           PTYP      COMP 66                       37
     C***********PTYP      COMP 67                   39  38               CLE005
     C           PTYP      COMP 67                       38               CLE005
      *                                                                                       CLE028
      ** For flat rate personal loans, processing and layout of report                        CLE028
      ** will be similar to term loans                                                        CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *ON       *IN33                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PTYP      COMP 70                       39               CLE005
     C                     SETOF                     444546
     C                     SETOF                     4748
     C                     SETOF                     22                   S01392
      *                                                                   159259
     C           *IN35     IFEQ *ON                                       159259
     C           *IN36     OREQ *ON                                       159259
     C           *IN37     OREQ *ON                                       159259
     C           *IN38     OREQ *ON                                       159259
     C                     MOVE 'Y'       WFLG                            159259
     C                     ENDIF                                          159259
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 72                                        CLE005
     C***********OLNO      CHAINLELOANL0             62            CLE005 161157
     C           OLNO      CHAINLBLOANL1             62                   161157
     C           *IN62     IFEQ '1'                                       CLE005
     C                     MOVELOLNO      DBKEY            ***************CLE005
     C                     MOVE '23'      DBASE            * DB ERROR 23 *CLE005
     C***********          MOVE 'LELOANL0'DBFILE           ********CLE005 161157
     C                     MOVE 'LBLOANL1'DBFILE                          161157
     C                     SETON                     U7U8LR               CLE005
     C                     GOTO ENDINF                                    CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           SPTYP     IFEQ 70                                        CLE005
     C                     Z-ADD99        PTYP                            CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     MOVE '0'       *IN87                           CLE005
     C                     MOVE '0'       *IN88                           CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 71                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C           PTYP      OREQ 99                                        CLE005
     C                     MOVE '1'       *IN39                           CLE005
     C                     MOVE '1'       *IN88                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           PTYP      OREQ 69                                        CLE005
     C                     MOVE '1'       *IN32                           CLE005
     C                     MOVE '1'       *IN45                           CLE005
     C                     MOVE '1'       *IN22                           CLE005
     C                     MOVE 'Y'       WFLG                            159259
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C                     MOVE '1'       *IN35                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C                     MOVE '1'       *IN37                           CLE005
     C                     MOVE '1'       *IN87                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   159259
     C           PTYP      IFEQ 71                                        159259
     C           PTYP      OREQ 72                                        159259
     C                     MOVE 'Y'       WFLG                            159259
     C                     ENDIF                                          159259
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C** 34******                                                         S01392
     C   34N79                                                            S01392
     COR 36
     COR 38                SETON                     44
     C   32
     COR 33
     COR 35
     COR 37                SETON                     45
     C   32                                                               S01392
     COR 33                                                               S01392
     COR 35                SETON                     22                   S01392
     C**   SETOF IND.22 IF MAT. DATE OF CALL/DEMAND LOAN = 0.             S01392
     C   22      MDAT      IFLE 0                                         S01392
     C                     SETOF                     22                   S01392
     C                     END                             END IF         S01392
     C**
     C**   STORE REPAYMENT TYPE INFORMATION
     C   45      REPT      COMP '1'                  47  46
     C   45 47   REPT      COMP '3'                    4748
     C***46****************                                               091120
     C*OR*48***************SETOF                      45                  091120
     C***********          ENDSR                                          CLE005
     C           ENDINF    ENDSR                                          CLE005
     C********************************************************************
     C*    SUBROUTINE TO CALCULATE INTEREST AND TOTAL AMOUNTS FOR SP      S01392
     C*                                                                   S01392
     C*    INTCAL IS CALLED BY - MAIN PROCESSING                          S01392
     C*                                                                   S01392
     C*           CALLS - GLINTC                                          S01392
     C*                                                                   S01392
     C           INTCAL    BEGSR                           *** INTCAL *** S01392
     C*                                                                   S01392
     C                     Z-ADDVDAT      ZIBEG                           S01392
     C                     Z-ADDICBS      ZICALC                          S01392
     C                     Z-ADDMDAT      ZIEND                           S01392
     C                     Z-ADDCPAM      ZIAMT                           S01392
     C                     Z-ADDINTR      ZIRATE                          S01392
     C**********           Z-ADDVDAT      ZVDAT                                        S01392 245082
     C                     Z-ADDMDAT      ZMDAT                                               245082
     C**                                                                  068669
      *  CLE047 - Only calculate interest until NIDT                      CLE047
     C           NIDT      IFNE *ZEROS                                    CLE047
     C           CLE047    ANDEQ'Y'                                       CLE047
     C                     Z-ADDSLID      ZIBEG                           CLE047
     C                     Z-ADDNIDT      ZIEND                           CLE047
     C                     END                                            CLE047
      **                                                                  CLE047
     C                     Z-ADDSLID      ZIBEG                           131730
      *                                                                   131730
      ** For repayment types 2 and 3                                      131730
      *                                                                   131730
     C           REPT      IFNE '1'                                       131730
      *                                                                   131730
     C           RLDT      IFNE *ZEROS                                    068669
     C***********NIDT      ANDNE*ZEROS                             068669 131730
      *                                                                   131730
     C           NIDT      IFNE *ZEROS                                    131730
      *                                                                   131730
     C           NRPD      IFNE *ZEROS                                    131730
      *                                                                   131730
     C           NIDT      IFLE RLDT                                      131730
     C           NIDT      IFLE NRPD                                      131730
     C***********          Z-ADDSLID      ZIBEG                    068669 131730
     C                     Z-ADDNIDT      ZIEND                           068669
     C                     ELSE                                           131730
     C                     Z-ADDNRPD      ZIEND                           131730
     C                     END                                            131730
     C                     ELSE                                           131730
     C           RLDT      IFLE NRPD                                      131730
     C                     Z-ADDRLDT      ZIEND                           131730
     C                     ELSE                                           131730
     C                     Z-ADDNRPD      ZIEND                           131730
     C                     END                                            131730
     C                     END                                            131730
      *                                                                   131730
     C                     ELSE                                           131730
     C           NIDT      IFLE RLDT                                      131730
     C                     Z-ADDNIDT      ZIEND                           131730
     C                     ELSE                                           131730
     C                     Z-ADDRLDT      ZIEND                           131730
     C                     END                                            131730
     C                     END                                            131730
      *                                                                   131730
     C                     ELSE                                           131730
      *                                                                   131730
     C           NRPD      IFNE *ZEROS                                    131730
     C           NRPD      IFLE RLDT                                      131730
     C                     Z-ADDNRPD      ZIEND                           131730
     C                     ELSE                                           131730
     C                     Z-ADDRLDT      ZIEND                           131730
     C                     END                                            131730
     C                     ELSE                                           131730
     C                     Z-ADDRLDT      ZIEND                           131730
     C                     END                                            131730
     C                     END                                            131730
     C                     ELSE                                           131730
     C           NIDT      IFNE *ZEROS                                    131730
     C           NRPD      IFNE *ZEROS                                    131730
     C           NIDT      IFLE NRPD                                      131730
     C                     Z-ADDNIDT      ZIEND                           131730
      *                                                                   131730
     C                     ELSE                                           131730
     C                     Z-ADDNRPD      ZIEND                           131730
     C                     END                                            131730
     C                     ELSE                                           131730
     C                     Z-ADDNIDT      ZIEND                           131730
     C                     END                                            131730
      *                                                                   131730
     C                     ELSE                                           131730
     C           NRPD      IFNE *ZEROS                                    131730
     C                     Z-ADDNRPD      ZIEND                           131730
     C                     END                                            131730
      *                                                                   131730
     C                     END                                            131730
      *                                                                   131730
     C                     END                                            068669
      *                                                                   131730
      ** For repayment type 1                                             131730
      *                                                                   131730
     C                     ELSE                                           131730
      *                                                                   131730
     C           NRPD      IFNE *ZEROS                                    131730
     C                     Z-ADDNRPD      ZIEND                           131730
     C                     ELSE                                           131730
      *                                                                   131730
     C           RLDT      IFNE *ZEROS                                    131730
     C                     Z-ADDRLDT      ZIEND                           131730
     C                     END                                            131730
     C                     END                                            131730
      *                                                                   131730
     C                     END                                            131730
     C**                                                                  068669
     C                     EXSR ZFLAC                                     S01392
     C/COPY WNCPYSRC,LE0130C018
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDFLTI      ZINTR                                               CLE028
     C                     ELSE                                                               CLE028
     C                     EXSR GLINTC                                    S01392
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE0130C019
      *                                                                                       CLE028
      ** For Flat rate personal loans, add the charge amount to the                           CLE028
      ** principal if Add on charges flag is 'Y'                                              CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADCF      ANDEQ'Y'                                                           CLE028
     C                     ADD  CHGA      CPAM                                                CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C***********          Z-ADDZINTR     TOTINT 130H                     S01392
     C**                                                                  S01392
     C**   ROUND DOWN INTEREST IF REQUIRED                                S01392
     C**                                                                  S01392
     C           RDFC      COMP 'Y'                      60               S01392
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *OFF      *IN60                                               CLE028
     C                     ENDIF                                                              CLE028
     C  N60                Z-ADDZINTR     TOTINT 130H                     S01392
     C   60                Z-ADDZINTR     TOTINT                          S01392
     C/COPY WNCPYSRC,LE0130C029
     C           CPAM      ADD  TOTINT    TOTAL                           S01392
     C/COPY WNCPYSRC,LE0130CCP8                                           S01408
     C*                                                                   S01392
     C                     ENDSR                                          S01392
     C******************************************************************* S01392
     C**   CALCULATIONS TO UPDATE LTRIX AND CLOAN FILES
     C*    UPDATE IS CALLED BY -MAIN PROCESSING
     C*              CALLS - TIME;EXCPT;CLCHN;LTRCHN
     C***********
     C           UPDATE    BEGSR                           ***  UPDATE ***
     C**
      ** Suppress update of TNLU field as this is of no use, only                            BUG4488
      ** causes trigger of LTRIX to send blank 'LECONF' data                                 BUG4488
     C**********           EXSR ZTNLU1                                                       BUG4488
     C*****
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0130CCP6                                           S01408
     C*                                                                   S01408
     C   68NU3NLR          GOTO DTDET
     C   LR                GOTO DTHEAD
     C**
     C**   GET CLOAN RECORD.
     C                     SETON                     58
     C                     EXSR CLCHN
     C   LR                MOVE '11'      DBASE            * DB ERROR 11 *
     C   LR                MOVE 'CLOAN'   DBFILE
     C   LR                MOVELCLKEY     DBKEY
     C   LR                GOTO ENDLOG
     C**   CLOAN RECORD UPDATE
     C**
     C                     BITON'01'      CNFI
     C   79                BITON'2'       CNFI                            S01392
     C                     SETON                     72
     C                     EXSR TIME
     C                     EXSR EXCPT
     C           DTDET     TAG                             ***  DTDET  ***
     C*    GET LTRIX DETAIL RECORD FOR UPDATE
     C**********           EXSR LTRCHN                                                      AR322732
     C  N02                SETON                     U7U8LR
     C  N02                MOVE '14'      DBASE            * DB ERROR 14 *
     C  N02                MOVELRRN       DBKEY
     C  N02                MOVE 'LTRIX'   DBFILE
     C  N02                GOTO ENDLOG
     C   68NU3NLR          GOTO DTHEAD
     C**
     C           DTHEAD    TAG                             ***  DTHEAD ***
     C***LR*****           Z-ADD1         RRN                                               AR322732
     C***LR*****           EXSR LTRCHN                                                      AR322732
     C                     SETON                     01                                     AR322732
     C  N01 LR             MOVE '15'      DBASE            * DB ERROR 15 *
     C  N01 LR             MOVE 'LTRIX'   DBFILE
     C  N01 LR             MOVELRRN       DBKEY
     C  N01 LR             GOTO ENDLOG
     C**
     C**   LTRIX RECORD UPDATE
     C**
     C**********           SETON                     73                                     AR322732
     C      LR             SETOF                     75                                     AR322732
     C                     EXSR TIME
     C                     EXSR EXCPT
     C**
     C**   END COMIT CYCLE
     C                     COMIT
     C           ENDLOG    ENDSR                           ***  ENDLOG ***
 251 C********************************************************************
 252 C*
 253 C*    ROUTINE TO ACCESS LTRIX RELATIVE FILE HEADER RECORD AND
 242 C*    DUMMY UPDATE/LOCK TO PREVENT EXTERNAL UPDATE.
 254 C*
3255 C           HDRCHN    BEGSR                           *** HDRCHN ***
 256 C*
3257 C                     SETOF                     010260
3259 C********** RRN       CHAINLTRIX                60                                     AR322732
3248 C**N60*****           EXCPTRECLCK                                                      AR322732
 245 C*
3257 C  N60                SETOF                     010260
3247 C**N60***** RRN       CHAINLTRIX                60                                     AR322732
 260 C*
3261 C                     ENDSR
 262 C*
     C********************************************************************
     C*    CHAIN TO LTRIX FILE
     C*
     C*    LTRCHN IS CALLED BY - MAIN PROCESSING;UPDATE
     C***********
     C           LTRCHN    BEGSR                           ***  LTRCHN ***
     C                     SETOF                     010260
     C********** RRN       CHAINLTRIX                60                                     AR322732
     C                     READ LTRIX                    LR                                 AR322732
     C/COPY WNCPYSRC,LE0130C026
     C                     ENDSR
     C********************************************************************
     C*    CHAIN TO CLOAN FILE
     C*    CLCHN IS CALLED BY - MAIN PROCESSING;UPDATE
     C***********
     C           CLCHN     BEGSR                           ***  CLCHN  ***
     C                     SETOF                     606103
     C**
     C**   SET UP CLOAN KEY
     C**
     C                     MOVELLNRF      CLKEY   7
     C                     MOVE 'A'       CLKEY
     C           CHAIN     TAG                             ***  CHAIN  ***
     C           CLKEY     CHAINCLOAN                60
     C   58
     COR 61                GOTO ENDCHN
     C   03                MOVE 'B'       CLKEY
     C   03                SETON                     61
     C   03                GOTO CHAIN
     C           ENDCHN    TAG                             ***  ENDCHN ***
     C  N03                SETON                     U7U8LR
     C                     SETOF                     58
     C/COPY WNCPYSRC,LE0130C030
     C                     ENDSR
      *****************************************************************   138866
      *                                                               *   138866
      *  SRLOAM - Subroutine to chain to LF/LOAMS if there is a       *   138866
      *           corresponding record for the loan being processed   *   138866
      *                                                               *   138866
      *  Called by: Main processing                                   *   138866
      *  Calls    : None                                              *   138866
      *                                                               *   138866
      *****************************************************************   138866
     C           SRLOAM    BEGSR                                          138866
      *                                                                   138866
     C                     MOVE *OFF      *IN83                           138866
      *                                                                   138866
     C           LNRF      SETLLLOAMS                    84               138866
      *                                                                   138866
      ** If an equal loan reference has been read, check if amendment     138866
      ** type is 'PT' and value date match with the start date of the     138866
      ** original loan.  Store the principal amount of the loan amendment 138866
      ** to the current principal amount of the loan, if it is zero.      138866
      *                                                                   138866
     C           *IN84     IFEQ *ON                                       138866
     C           LNRF      READELOAMS                    86               138866
     C           *IN86     DOWEQ*OFF                                      138866
     C           *IN83     ANDEQ*OFF                                      138866
     C           AMTP      IFEQ 'PT'                                      138866
     C           VDATLO    ANDEQSLID                                      138866
     C           NRLI      ANDEQ'Y'                                       138866
     C                     Z-ADDPRAM      CPAM                            138866
     C                     MOVE *ON       *IN83                           138866
     C                     ENDIF                                          138866
     C           LNRF      READELOAMS                    86               138866
     C                     END                                            138866
     C                     END                                            138866
      *                                                                   138866
     C                     ENDSR                                          138866
      *                                                                   138866
     C********************************************************************
     C*****CHAIN*TO*TABLE*FILE*AND*PARTIALLY*BLANK*OUT*CHAINING*KEY*      S01194
     C*****TABCHN*IS*CALLED*BY*-*MAIN*PROCESSING;CONF;NOSTRO;CPNOS*       S01194
     C***********                                                         S01194
     C********** TABCHN    BEGSR                           ***  TABCHN ***S01194
     C**********           SETOF                     07                   S01194
     C********** TABKEY    CHAINTABLE                60                   S01194
     C**********           MOVE BLK10     TABKEY                          S01194
     C**********           ENDSR                                          S01194
     C********************************************************************
     C*****GET*CUSTOMER DETAILS FROM CLIENT FILE                          S01194
     C*****CLICHN IS CALLED BY - CONF;NOSTRO;CPNOS                        S01194
     C***********
     C********** CLICHN    BEGSR                           ***  CLICHN ***S01194
     C**********           SETOF                     08                   S01194
     C********** CLIKEY    CHAINCLINT                60                   S01194
     C**********           ENDSR                                          S01194
     C********************************************************************
     C*    SUBROUTINE TO HANDLE EXCEPTION TIME OUTPUT
     C*    EXCPT IS CALLED BY - MAIN PROCESSING;CONF;UPDATE
     C***********
     C           EXCPT     BEGSR                           ***  EXCPT  ***
     C/COPY WNCPYSRC,LE0130C033
     C                     EXCPT
     C/COPY WNCPYSRC,LE0130C034
     C                     SETOF                     69
     C                     SETOF                     7273
     C                     SETOF                     7577
     C   U4 82             SETOF                     82
     C******               SETOF                     78                   S01310
     C                     ENDSR
     C********************************************************************
     C**   TIME SR. TO OBTAIN TIME.
     C**
     C*    TIME IS CALLED BY - UPDATE
     C***********
     C           TIME      BEGSR                           ***  TIME   ***
     C                     TIME           MTIME   60
     C                     ENDSR
     C**
     C****************************************************************    S01392
     C**   THIS SR IS ADDED FOR 150987 JSM08                              S01392
     C**                                                                  S01392
     C**   SETBR SR. TO ACCESS THE CORRECT BASE RATE OF THE ROLLOVER      S01392
     C**   DISCOUNT LOAN.                                                 S01392
     C**                                                                  S01392
     C           GETBR     BEGSR                           ***  GETBR  ***S01392
     C**                                                                  S01392
     C                     MOVE CCY       BKEY1                           S01392
     C                     MOVE NBRA      BKEY2                           S01392
     C                     CALL 'AOBSRTR0'PLIST3                          S01392
     C**                                                                  S01392
     C           @RTCD     COMP *BLANKS                  07               S01392
     C  N07                SETON                     U7U8LR               S01392
     C  N07                MOVE 'SDBSRTPD'DBFILE                          S01392
     C  N07                MOVE '19'      DBASE            * DB ERROR 19 *S01392
     C  N07                MOVELBKEY1     WRK5    5                       S01392
     C  N07                MOVE BKEY2     WRK5                            S01392
     C  N07                MOVELWRK5      DBKEY                           S01392
     C  N07                GOTO ENDBR                                     S01392
     C**                                                                  S01392
     C**   SET UP RELEVANT BASE RATE.                                     S01392
     C           BAVDNR    COMP RLDT                   6060               S01392
     C   60                Z-ADDBANBRT    BASER            NEXT BASE RATE S01392
     C  N60                Z-ADDBACBSR    BASER            CUR. BASE RATE S01392
     C**                                                                  S01392
     C           ENDBR     ENDSR                           ***  ENDBR  ***S01392
     C**                                                                  S01392
     C/EJECT                                                              S01310
      *****************************************************************   S01310
      ****ROUT*-*determine*message*routing*************************S01310 CSW096
      ****Called*by*-*main*process*********************************S01310 CSW096
      ****Calls*-*NWAD*determine*default*network*addresses*********S01310 CSW096
      ************PRAD*determine*priority*network*addresses********S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********ROUT      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ***Access*branch*details*with*Branch*code*of*sender.*********S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          CALL 'AOBRCHR0'                         S01310 CSW096
     C***********          PARM '*MSG   ' @RTCD                    S01310 CSW096
     C***********          PARM '*KEY   ' @OPTN                    S01310 CSW096
     C***********          PARM @DSNB     @BRCD   3                S01310 CSW096
     C***********SDBRCH    PARM SDBRCH    DSSDY                    S01310 CSW096
      ***********                                                  S01310 CSW096
      ***Branch*record*not*found*-*Error***************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********@RTCD     IFNE *BLANKS                            S01310 CSW096
     C***********          MOVE '31'      DBASE              * * * S01310 CSW096
     C***********          MOVEL@DSNB     DBKEY              * DBERS01310 CSW096
     C***********          MOVEL'SDBRCHPD'DBFILE             * * * S01310 CSW096
     C***********          EXSR *PSSR                              S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      *****save*branch*internal*customer*number*&*SWIFT*TID*addressS01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVELA8BICN    SECN    60               S01310 CSW096
     C***********          MOVE A8BTID    SCSID  12                S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Access*SDCUSTPD*using*branch*internal*customer*number****S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE *BLANKS   @KEY1                    S01310 CSW096
     C***********          MOVELSECN      @KEY1                    S01310 CSW096
     C***********          CALL 'AOCUSTR0'                         S01310 CSW096
     C***********          PARM '*MSG   ' @RTCD                    S01310 CSW096
     C***********          PARM '*KEY   ' @OPTN                    S01310 CSW096
     C***********          PARM           @KEY1  10                S01310 CSW096
     C***********          PARM *BLANKS   @KYST   7                S01310 CSW096
     C***********@CUST     PARM @CUST     DSSDY                    S01310 CSW096
      ***********                                                  S01310 CSW096
      ***Customer*record*not*found*-*Error*************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********@RTCD     IFNE *BLANKS                            S01310 CSW096
     C***********          MOVE '32'      DBASE              * * * S01310 CSW096
     C***********          MOVEL@KEY1     DBKEY              * DBERS01310 CSW096
     C***********          MOVEL'SDCUSTPD'DBFILE             * * * S01310 CSW096
     C***********          EXSR *PSSR                              S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Save*sender's*addresses*&*parent*customer*number*********S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE TELX      @TELX  12                S01310 CSW096
     C***********          MOVE BBSTAD    @STTX  12                S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Access*SDCUSTPD*using*destination*customer*number********S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE *BLANKS   @KEY1                    S01310 CSW096
     C***********          MOVEL@CUST     @KEY1                    S01310 CSW096
     C***********          CALL 'AOCUSTR0'                         S01310 CSW096
     C***********          PARM '*MSG   ' @RTCD                    S01310 CSW096
     C***********          PARM '*KEY   ' @OPTN                    S01310 CSW096
     C***********          PARM           @KEY1  10                S01310 CSW096
     C***********          PARM *BLANKS   @KYST   7                S01310 CSW096
     C***********@CUST     PARM @CUST     DSSDY                    S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Determine*the*routing*to*the*destination*customer.*******S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW3    IFNE *BLANKS                            S01310 CSW096
     C***********          EXSR NWAD                               S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
     C***********          EXSR PRAD                               S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C/EJECT                                                              S01310
      *****************************************************************   CSW096
      *   SRROUT - determine message routing                          *   CSW096
      *   Called by - CONF                                            *   CSW096
      *   Calls -                                                     *   CSW096
      *****************************************************************   CSW096
      *                                                                   CSW096
     C           SRROUT    BEGSR                                          CSW096
      *                                                                   CSW096
     C                     MOVELBRCA      I@SNBR                          CSW096
     C                     MOVELCNUM      I@DSCN                          CSW096
     C                     MOVEL*BLANKS   I@MTPY                          CSW096
     C                     Z-ADD0         I@SETT                          CSW096
     C                     MOVEL'Y'       I@CONC                          CSW096
     C                     MOVEL*BLANK    I@FTCS                          CSW096
      *                                                                   CSW096
     C                     CALL 'MG9900'                                  CSW096
     C                     PARM *BLANKS   @RTCD                           CSW096
     C                     PARM           P@IN                            CSW096
     C                     PARM *BLANKS   P@OUT                           CSW096
     C                     PARM           P@ZZ  256                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFNE *BLANKS                                   CSW096
     C                     MOVEL'MG9900  'DBFILE           ************   CSW096
     C                     MOVEL'*CALL'   DBKEY            * DBERR 92 *   CSW096
     C                     Z-ADD92        DBASE            ************   CSW096
     C                     SETON                     U7U8LR               CSW096
     C                     EXSR *PSSR                                     CSW096
     C                     ELSE                                           CSW096
     C**********           Z-ADDO@CNSN    SECN    60                                   CSW096 CPK028
     C                     MOVELO@CNSN    SECN    6                                           CPK028
     C                     MOVELO@SWSN    SCSID  12                       CSW096
     C                     MOVELO@NWRK    @NWRK   6                       CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C                     ENDSR                                          CSW096
     C/EJECT                                                              CSW096
      *************************************************************S01310 CSW096
      ****NWAD*-*determine*default*network*addresses***************S01310 CSW096
      ****Called*by*-*ROUT*determine*message*routing***************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*SWIFT*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW3    IFEQ 'SWIFT'                            S01310 CSW096
     C***********CSID      ANDNE*BLANKS                            S01310 CSW096
     C***********@BIC      ANDNE'BIC'                              S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELBBDNW3    @NWRK   6                S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*TELEX*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW3    IFEQ 'TELEX'                            S01310 CSW096
     C***********TELX      ANDNE*BLANKS                            S01310 CSW096
     C***********BGMTMI    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVE BBDNW3    @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*STTX******************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW3    IFEQ 'STTX'                             S01310 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVE BBDNW3    @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*PAPER*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW3    IFEQ 'PAPER'                            S01310 CSW096
     C***********          MOVE BBDNW3    @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Found*to*be*unroutable***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********@NWRK     IFEQ *BLANKS                            S01310 CSW096
     C***********          MOVEL'UNROUT'  @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****PRAD*-*determine*priority*network*addresses**************S01310 CSW096
      ****Called*by**ROUT***determine*message*routing**************S01310 CSW096
      ****Calls******TXROUT*priority*routing*to*STTX/Telex*********S01310 CSW096
      ***************SWROUT*priority*routing*to*SWIFT**************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********PRAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****If*STTX/Telex*has*higher*priority*than*SWIFT*attempt*****S01310 CSW096
      ****STTX/Telex*routing*first,*followed*by*SWIFT.*(nb.*'HigherS01310 CSW096
      ****priority*is*numerically*lower*ie.*'1'*is*higher*than*'2')S01310 CSW096
     C***********BLTXPY    IFLT BLSWPY                             S01310 CSW096
     C***********          EXSR TXROUT                             S01310 CSW096
     C***********          EXSR SWROUT                             S01310 CSW096
      ***********                                                  S01310 CSW096
      ****otherwise*attempt*SWIFT*routing*first********************S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
     C***********          EXSR SWROUT                             S01310 CSW096
     C***********          EXSR TXROUT                             S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****If*failed*to*route*to*electronic*network,*produce*paper**S01310 CSW096
     C***********@NWRK     IFEQ *BLANKS                            S01310 CSW096
     C***********          MOVEL'PAPER'   @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****TXROUT*-*Attempt*priority*routing*to*STTX/Telex,*if*not**S01310 CSW096
      *************already*routed**********************************S01310 CSW096
      ****Called*by***PRAD*****************************************S01310 CSW096
      ****Calls*******-********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********TXROUT    BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****If*not*already*routed,*attempt*STTX/Telex*routing********S01310 CSW096
     C***********@NWRK     IFEQ *BLANKS                            S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Note*that*STTX*and*Telex*are*mutually*exclusive*-*try*botS01310 CSW096
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            S01310 CSW096
     C***********@STTX     ANDNE*BLANKS                            S01310 CSW096
     C***********          MOVEL'STTX'    @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BGMTMI    IFEQ 'Y'                                S01310 CSW096
     C***********TELX      ANDNE*BLANKS                            S01310 CSW096
     C***********@TELX     ANDNE*BLANKS                            S01310 CSW096
     C***********          MOVEL'TELEX'   @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                           TXROUT  S01310 CSW096
      ***********                                                  S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****SWROUT*-*Attempt*priority*routing*to*SWIFT*if*not*alreadyS01310 CSW096
      *************routed******************************************S01310 CSW096
      ****Called*by***PRAD*****************************************S01310 CSW096
      ****Calls*******-********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********SWROUT    BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****If*not*already*routed,*attempt*SWIFT*routing*************S01310 CSW096
     C***********@NWRK     IFEQ *BLANKS                            S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********CSID      ANDNE*BLANKS                            S01310 CSW096
     C***********SCSID     ANDNE*BLANKS                            S01310 CSW096
     C***********@BIC      ANDNE'BIC'                              S01310 CSW096
     C***********          MOVEL'SWIFT'   @NWRK                    S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                           SWROUT  S01310 CSW096
      *                                                                   S01310
     C/EJECT                                                              S01310
     C/COPY WNCPYSRC,LE0130C031
      /COPY ZSRSRC,ZDATE2Z4                                               S01392
      /COPY ZSRSRC,ZFLACZ2                                                S01392
     C********************************************************************
     C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
     C           ZSYSTM    BEGSR                           ***  ZSYSTM ***
     C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
     C**********           MOVEL'01      'ZTABKY 12                       S01194
     C**********           MOVE '  10'    ZTABKY                          S01194
     C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     COMP *BLANKS              9999                 S01194
     C*                                                                   S01194
     C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004           Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANK                     If Found       CEU004
     C                     MOVE 'Y'       CEU004  1         Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD40        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     SETON                     99      Set Ind      CEU004
     C                     EXSR *PSSR                        Dump         CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ENDSR
     C********************************************************************
      /COPY ZSRSRC,ZTNLU1Z2                                               S01392
      /COPY ZSRSRC,GLINTCZ1                                               S01392
      /COPY ZSRSRC,ZSAVEZ1                                                S01392
      /COPY ZSRSRC,ZRSTORZ1                                               S01392
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
     C/EJECT                                                                                  CLE031
     C/COPY WNCPYSRC,LE0130CCP9                                           S01408
     O*LEICTX**EADD*****78                                                S01310
     O*********                           1 'D'                           S01310
     O*****                    BRCD       4                               S01117
     O*********                BRCA       4                         S01117S01310
     O*********                CNUM      10                               S01310
     O*********                PTYP      12                               S01310
     O*********                TXDATE    18                               S01310
     O*********                CCY       21                               S01310
     O*********                LNRF      27                               S01310
     O*********                          28 'F'                           S01310
     O*********                          29 'C'                           S01310
     O*********                          90 'I'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78                                                 S01310
     O*********                           2 'TO'                          S01310
     O*********                CNA1      38                               S01310
     O*********                CTWN      49                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78                                                 S01310
     O*********                CNAME     26                               S01310
     O*********                          30 'REF'                         S01310
     O*********                LNRF      37                               S01310
     O*********                          42 'DATE'                        S01310
     O*********                RUNA      50                               S01310
     O*********        64                64 'CANCELLATION'                S01310
     O*********        65                64 'AMENDMENT'                   S01310
     O*********        63                69 'COPY'                        S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O**   NARRATIVE LINE 1
     O**
     O********EADD     78                                                 S01310
     O*********                          14 'WE CONFIRM'                  S01310
     O*********                NARR1     76                               S01310
     O*********                          90 'A'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O**   NARRATIVE LINES 2 & 3
     O**
     O********EADD     78 44                                              S01310
     O*********                          28 'WITH INTEREST DISCOUNTE      S01310
     O*********                          31 'AT'                          S01310
     O*********                INTR      44 '  0 .       -'               S01310
     O*********                          46 '%'                           S01310
     O*********                          90 'B'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78 39                                              S01310
     O*********           29             20 'WITH FEES DUE ON'            S01310
     O*********           29   NDATE     28                               S01310
     O*********          N28             43 'AND THEREAFTER'              S01310
     O*********          N28   TABFQ1    55                               S01310
     O*********           21             62 'ON THE'                      S01310
     O*********           21   IDAY      67                               S01310
     O*********                          90 'B'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78 45                                              S01310
     O*********           29             24 'WITH INTEREST DUE ON'        S01310
     O*********           29   NDATE     32                               S01310
     O*********          N28             47 'AND THEREAFTER'              S01310
     O*********          N28   TABFQ1    59                               S01310
     O*********           21             66 'ON THE'                      S01310
     O*********           21   IDAY      71                               S01310
     O*********        29 47 30          75 'AND'                         S01310
     O*********                          90 'B'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78 46                                              S01310
     O*******OR        78 48                                              S01310
     O*********           30             22 'WITH REPAYMENTS OF'          S01310
     O*********           30 40RAMT      40 ' ,   ,   ,   , 0 '           S01310
     O*********           30 41RAMT      40 '   ,   ,   , 0 . '           S01310
     O*********           30 42RAMT      40 '  ,   ,   , 0 .  '           S01310
     O*********           30 43RAMT      40 ' ,   ,   , 0 .   '           S01310
     O*********           30 46          62 'PLUS ALL OUTSTANDING'        S01310
     O*********           30 46          78 'ACCRUED INTEREST'            S01310
     O*********           30 48          47 'DUE ON'                      S01310
     O*********           30 48RDATE     55                               S01310
     O*********                          90 'B'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78 47                                              S01310
     O*********           30             17 'REPAYMENTS OF'               S01310
     O*********           30 40RAMT      35 ' ,   ,   ,   , 0 '           S01310
     O*********           30 41RAMT      35 '   ,   ,   , 0 . '           S01310
     O*********           30 42RAMT      35 '  ,   ,   , 0 .  '           S01310
     O*********           30 43RAMT      35 ' ,   ,   , 0 .   '           S01310
     O*********           30             42 'DUE ON'                      S01310
     O*********           30   RDATE     50                               S01310
     O*********          N31             65 'AND THEREAFTER'              S01310
     O*********          N31   TABFQ2    77                               S01310
     O*********           20             84 'ON THE'                      S01310
     O*********           20   RDAY      89                               S01310
     O*********                          90 'C'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78 46                                              S01310
     O*********           30             10 'DUE ON'                      S01310
     O*********           30   RDATE     18                               S01310
     O*********          N31             33 'AND THEREAFTER'              S01310
     O*********          N31   TABFQ2    45                               S01310
     O*********           20             52 'ON THE'                      S01310
     O*********           20   RDAY      57                               S01310
     O*********                          90 'C'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78 48                                              S01310
     O*********          N31             18 'AND THEREAFTER'              S01310
     O*********          N31   TABFQ2    30                               S01310
     O*********           20             37 'ON THE'                      S01310
     O*********           20   RDAY      42                               S01310
     O*********                          90 'C'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78 39                                              S01310
     O*******OR        78 44                                              S01310
     O*********                          90 'C'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O**   DETAIL LINE 1
     O**
     O********EADD     78                                                 S01310
     O*********                           9 'CCY'                         S01310
     O*********           32             27 'PRINCIPAL'                   S01310
     O*********           33             27 'PRINCIPAL'                   S01310
     O*********           35             27 'PRINCIPAL'                   S01310
     O*********           44N38          27 'PRINCIPAL'                   S01310
     O*********           37             27 'PRINCIPAL SOLD'              S01310
     O*********           38             27 'PRINCIPAL SOLD'              S01310
     O*********           39             31 'AMOUNT OF GUARANTEE'         S01310
     O*********           45             45 'INTEREST RATE'               S01310
     O*********           46             45 'INTEREST RATE'               S01310
     O*********           48             45 'INTEREST RATE'               S01310
     O*********           44             43 'DISCOUNT'                    S01310
     O*********           39             43 'FEE RATE'                    S01310
     O*********           44             66 'TOTAL'                       S01310
     O*********           45N32          66 'TOTAL INTEREST'        E13046S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O**   DETAIL LINE 2
     O**
     O********EADD     78                                                 S01310
     O*********                CCY        9                               S01310
     O*********           40   CPAM      29 ' ,   ,   ,   , 0 '           S01310
     O*********           41   CPAM      29 '   ,   ,   , 0 . '           S01310
     O*********           42   CPAM      29 '  ,   ,   , 0 .  '           S01310
     O*********           43   CPAM      29 ' ,   ,   , 0 .   '           S01310
     O*********           45   INTR      45 '  0 .       -'               S01310
     O*********           46   INTR      45 '  0 .       -'               S01310
     O*********           48   INTR      45 '  0 .       -'               S01310
     O*********           39   INTR      45 '  0 .       -'               S01310
     O*********           40 44TOTI      49 ' ,   ,   ,   , 0 '           S01310
     O*********           41 44TOTI      49 '   ,   ,   , 0 . '           S01310
     O*********           42 44TOTI      49 '  ,   ,   , 0 .  '           S01310
     O*********           43 44TOTI      49 ' ,   ,   , 0 .   '           S01310
     O*********           40 44TOTAL     69 ' ,   ,   ,   , 0 '           S01310
     O*********           41 44TOTAL     69 '   ,   ,   , 0 . '           S01310
     O*********           42 44TOTAL     69 '  ,   ,   , 0 .  '           S01310
     O*********           43 44TOTAL     69 ' ,   ,   , 0 .   '           S01310
     O*********        45 40N32ITOT      69 ' ,   ,   ,   , * '     E13046S01310
     O*********        45 41N32ITOT      69 '   ,   ,   , * . '     E13046S01310
     O*********        45 42N32ITOT      69 '  ,   ,   , * .  '     E13046S01310
     O*********        45 43N32ITOT      69 ' ,   ,   , * .   '     E13046S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O**
     O********EADD     78                                                 S01310
     O*********                TITL1     40                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78                                                 S01310
     O*********                NAME1     38                               S01310
     O*********                TOWN1     49                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78                                                 S01310
     O*********                TITL3     10                               S01310
     O*********                NAME3     46                               S01310
     O*********                TOWN3     67                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78N39                                              S01310
     O*********                TITL2     27                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78N39                                              S01310
     O*********                NAME2     38                               S01310
     O*********                TOWN2     49                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78N39                                              S01310
     O*********                TITL4     10                               S01310
     O*********                NAME4     46                               S01310
     O*********                TOWN4     67                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78N23N39                                           S01310
     O*********                          10 'FOR A/C OF'                  S01310
     O*********                CPNM      46                               S01310
     O*********                CPTN      67                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78N24                                              S01310
     O*********                TITL6     20                               S01310
     O*********                SPI1      51                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78N24                                              S01310
     O*********                SPI2      51                               S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O********EADD     78                                                 S01310
     O*********             N24SPI3      51                               S01310
     O*********                          90 '*'                           S01310
     O*****                    BRCD      93                               S01117
     O*********                BRCA      93                         S01117S01310
     O*
     O*PRINT  E   09   69 16                                              S01124
     O*E0130P1E** 09   69 16                                    S01124    S01117
     O***LE0130P1E***09***69*16*71*******                          S01117 S01465
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP1                                           S01408
     O*                                                                   S01408
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP3                                           S01408
     O*                                                                   S01408
     O***********LE0130P1E  202   69 16 71                         S01465 179355
     OLE0130P1E   09   69 71                                              179355
     O       AND       11                                                 S01117
     O***********              BRNM   B  62                               179355
     O                 16      BRNM   B  62                               179355
     O/COPY WNCPYSRC,LE0130OP19                                           S01408
     O**
     O**   CONFIRMATION NAME
     O********E**212   69                                                 S01117
     O********E**212***69*71*************                          S01117 S01465
     O********E**2*****69*71***                                    S01465 179355
     O        E  212   69 71                                              179355
     O/COPY WNCPYSRC,LE0130O006
     O                         CNAME     52
     O                    79             72 'ROLLOVER'                    S01392
     O                    64             72 '- CANCELLATION'
     O***********         65             69 '- AMENDMENT'                 S01392
     O                    65N79          69 '- AMENDMENT'                 S01392
     O                    63             82 'COPY'
     O/COPY WNCPYSRC,LE0130O010
     O********E**2     69                                                 S01117
     O        E  2     69 71                                              S01117
     O                         LNRF      15
     O                         RUNA      33
     O/COPY WNCPYSRC,LE0130O001
     O**
     O**   NARRATIVE LINE 1
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O                                   14 'WE CONFIRM'
     O***********              NARR1     76                               CLE005
     O                         NARR1     83                               CLE005
     O/COPY WNCPYSRC,LE0130O015
     O**
     O**   NARRATIVE LINES 2 & 3
     O********E**2     69 44                                              S01117
     O        E  2     69 44 71                                           S01117
     O/COPY WNCPYSRC,LE0130O018
     O                                   28 'WITH INTEREST DISCOUNTED'
     O                                   31 'AT'
     O                         INTR      44 '  * .       -'
     O                                   46 '%'
     O/COPY WNCPYSRC,LE0130O019
     O********E**2     69 39                                              S01117
     O        E  2     69 39 71                                           S01117
     O       AND      N79                                                 S01392
     O/COPY WNCPYSRC,LE0130O020
     O                    29             20 'WITH FEES DUE ON'
     O                    29   NDATE     28
     O                      N28          37 'AND THEN'
     O**********            N28TABFQ1    49                                                   CLE064
     O**********             21          56 'ON THE'                                          CLE064
     O**********             21IDAY      61                                                   CLE064
     O                      N28TABFQ1    53                                                   CLE064
     O                       21          60 'ON THE'                                          CLE064
     O                       21IDAY      65                                                   CLE064
     O********E**1     69 45                                              S01117
     O/COPY WNCPYSRC,LE0130OP15                                           S01408
     O        E  1     69 45 71                                           S01117
     O                    29             24 'WITH INTEREST DUE ON'
     O                    29   NDATE     32
     O                      N28          41 'AND THEN'
     O**********            N28TABFQ1    53                                                   CLE064
     O**********             21          60 'ON THE'                                          CLE064
     O**********             21IDAY      65                                                   CLE064
     O**********       29 47 30          69 'AND'                                             CLE064
     O                      N28TABFQ1    57                                                   CLE064
     O                       21          64 'ON THE'                                          CLE064
     O                       21IDAY      69                                                   CLE064
     O                 29 47 30          73 'AND'                                             CLE064
     O/COPY WNCPYSRC,LE0130OP16                                           S01408
     O********E**1     69 46                                              S01117
     O*******OR**      69 48                                              S01117
     O        E  1     69 46 71                                           S01117
     O       OR        69 48 71                                           S01117
     O                    30             22 'WITH REPAYMENTS OF'
     O/COPY WNCPYSRC,LE0130O021
     O                    30 40RAMT      40 ' ,   ,   ,   , * '
     O                    30 41RAMT      40 '   ,   ,   , * . '
     O                    30 42RAMT      40 '  ,   ,   , * .  '
     O                    30 43RAMT      40 ' ,   ,   , * .   '
     O/COPY WNCPYSRC,LE0130O022
     O                    30 46          62 'PLUS ALL OUTSTANDING '
     O                    30 46          78 'ACCRUED INTEREST'
     O                    30 48          47 'DUE ON'
     O                    30 48RDATE     55
     O/COPY WNCPYSRC,LE0130O002
     O********E**1     69 47                                              S01117
     O        E  1     69 47 71                                           S01117
     O                    30             17 'REPAYMENTS OF'
     O/COPY WNCPYSRC,LE0130O023
     O                    30 40RAMT      35 ' ,   ,   ,   , * '
     O                    30 41RAMT      35 '   ,   ,   , * . '
     O                    30 42RAMT      35 '  ,   ,   , * .  '
     O                    30 43RAMT      35 ' ,   ,   , * .   '
     O/COPY WNCPYSRC,LE0130O024
     O                    30             42 'DUE ON'
     O                    30   RDATE     50
     O                      N31          59 'AND THEN'
     O**********            N31TABFQ2    71                                                   CLE064
     O**********             20          78 'ON THE'                                          CLE064
     O**********             20RDAY      83                                                   CLE064
     O                      N31TABFQ2    75                                                   CLE064
     O                       20          82 'ON THE'                                          CLE064
     O                       20RDAY      87                                                   CLE064
     O/COPY WNCPYSRC,LE0130O003
     O********E**1     69 46                                              S01117
     O        E  1     69 46 71                                           S01117
     O                    30             10 'DUE ON'
     O                    30   RDATE     18
     O                      N31          27 'AND THEN'
     O**********            N31TABFQ2    39                                                   CLE064
     O**********             20          46 'ON THE'                                          CLE064
     O**********             20RDAY      51                                                   CLE064
     O                      N31TABFQ2    43                                                   CLE064
     O                       20          50 'ON THE'                                          CLE064
     O                       20RDAY      55                                                   CLE064
     O/COPY WNCPYSRC,LE0130O004
     O********E**1     69 48                                              S01117
     O        E  1     69 48 71                                           S01117
     O                      N31          12 'AND THEN'
     O**********            N31TABFQ2    24                                                   CLE064
     O**********             20          31 'ON THE'                                          CLE064
     O**********             20RDAY      36                                                   CLE064
     O                      N31TABFQ2    28                                                   CLE064
     O                       20          35 'ON THE'                                          CLE064
     O                       20RDAY      40                                                   CLE064
     O/COPY WNCPYSRC,LE0130OP17                                           S01408
     O**
     O**   DETAIL LINE 1
     O********E**2     69                                                 S01117
     O        E  2     69 71                                              S01117
     O/COPY WNCPYSRC,LE0130O007
     O                                    9 'CCY'
     O                    32             27 'PRINCIPAL'
     O                    33             27 'PRINCIPAL'
     O                    35             27 'PRINCIPAL'
     O                    44N38          27 'PRINCIPAL'
     O                    79             27 'PRINCIPAL'                   S01392
     O                    37             27 'PRINCIPAL SOLD'
     O                    38             27 'PRINCIPAL SOLD'
     O***********         39             31 'AMOUNT OF GUARANTEE'         S01392
     O***********         39N79          31 'AMOUNT OF GUARANTEE'  S01392 CLE005
     O                N88 39N79          31 'AMOUNT OF GUARANTEE'         CLE005
     O                 88 39N79          31 'PARTICIPATION AMOUNT'        CLE005
     O                    45             45 'INTEREST RATE'
     O                    46             45 'INTEREST RATE'
     O                    48             45 'INTEREST RATE'
     O                    44             43 'DISCOUNT'
     O***********         39             43 'FEE RATE'                    S01392
     O                    39N79          43 'FEE RATE'                    S01392
     O                    79             45 'DISCOUNT RATE'               S01392
     O                    79             59 'DISCOUNT'                    S01392
     O/COPY WNCPYSRC,LE0130O030
     O                    22             63 'INTEREST'                    S01392
     O                    44             66 'TOTAL'
     O***********         79             83 'NET PROCEEDS'                S01392
     O                    34N79          67 'NET PROCEEDS'                S01392
     O                    79N34          83 'NET PROCEEDS'                S01392
     O                    22             84 'TOTAL'                       S01392
     O***********         45N32          66 'TOTAL INTEREST'       E13046 S01392
     O***********      37                66 'TOTAL INTEREST'       S01392 CLE005
     O                 37N87             66 'TOTAL INTEREST'              CLE005
     O**
     O**   DETAIL LINE 2
     O********E**3     69                                                 S01117
     O/COPY WNCPYSRC,LE0130O008
     O        E  3     69 71                                              S01117
     O/COPY WNCPYSRC,LE0130O009
     O                         CCY        9
     O/COPY WNCPYSRC,LE0130O025
     O                    40   CPAM      29 ' ,   ,   ,   , * '
     O                    41   CPAM      29 '   ,   ,   , * . '
     O                    42   CPAM      29 '  ,   ,   , * .  '
     O                    43   CPAM      29 ' ,   ,   , * .   '
     O                    40 79NPRAM     29 ' ,   ,   ,   , * '           S01392
     O                    41 79NPRAM     29 '   ,   ,   , * . '           S01392
     O                    42 79NPRAM     29 '  ,   ,   , * .  '           S01392
     O                    43 79NPRAM     29 ' ,   ,   , * .   '           S01392
     O/COPY WNCPYSRC,LE0130O026
     O                    45   INTR      45 '  * .       -'
     O                    46   INTR      45 '  * .       -'
     O                    48   INTR      45 '  * .       -'
     O***********         39   INTR      45 '  * .       -'               S01392
     O                    39N79INTR      45 '  * .       -'               S01392
     O/COPY WNCPYSRC,LE0130O027
     O                    40 44TOTI      49 ' ,   ,   ,   , * '
     O                    41 44TOTI      49 '   ,   ,   , * . '
     O                    42 44TOTI      49 '  ,   ,   , * .  '
     O                    43 44TOTI      49 ' ,   ,   , * .   '
     O/COPY WNCPYSRC,LE0130O028
     O                    79   DSCRTE    45 '  * .       -'               S01392
     O/COPY WNCPYSRC,LE0130O029
     O                    40 79NDAM      64 ' ,   ,   ,   , * '           S01392
     O                    41 79NDAM      64 '   ,   ,   , * . '           S01392
     O                    42 79NDAM      64 '  ,   ,   , * .  '           S01392
     O                    43 79NDAM      64 ' ,   ,   , * .   '           S01392
     O                    40 22TOTINT    65 ' ,   ,   ,   , * '           S01392
     O                    41 22TOTINT    65 '   ,   ,   , * . '           S01392
     O                    42 22TOTINT    65 '  ,   ,   , * .  '           S01392
     O                    43 22TOTINT    65 ' ,   ,   , * .   '           S01392
     O                    40 44TOTAL     69 ' ,   ,   ,   , * '
     O                    41 44TOTAL     69 '   ,   ,   , * . '
     O                    42 44TOTAL     69 '  ,   ,   , * .  '
     O                    43 44TOTAL     69 ' ,   ,   , * .   '
     O                N34 40 79TOTAL     84 ' ,   ,   ,   , * '           S01392
     O                N34 41 79TOTAL     84 '   ,   ,   , * . '           S01392
     O                N34 42 79TOTAL     84 '  ,   ,   , * .  '           S01392
     O                N34 43 79TOTAL     84 ' ,   ,   , * .   '           S01392
     O                    40 22TOTAL     86 ' ,   ,   ,   , * '           S01392
     O                    41 22TOTAL     86 '   ,   ,   , * . '           S01392
     O                    42 22TOTAL     86 '  ,   ,   , * .  '           S01392
     O                    43 22TOTAL     86 ' ,   ,   , * .   '           S01392
     O/COPY WNCPYSRC,LE0130O031
     O***********      45 40N32ITOT      69 ' ,   ,   ,   , * '    E13046 S01392
     O***********      45 41N32ITOT      69 '   ,   ,   , * . '    E13046 S01392
     O***********      45 42N32ITOT      69 '  ,   ,   , * .  '    E13046 S01392
     O***********      45 43N32ITOT      69 ' ,   ,   , * .   '    E13046 S01392
     O***********      37 40   TOTINT    69 ' ,   ,   ,   , * '    S01392 CLE005
     O***********      37 41   TOTINT    69 '   ,   ,   , * . '    S01392 CLE005
     O***********      37 42   TOTINT    69 '  ,   ,   , * .  '    S01392 CLE005
     O***********      37 43   TOTINT    69 ' ,   ,   , * .   '    S01392 CLE005
     O/COPY WNCPYSRC,LE0130O032
     O                 37 40N87TOTINT    69 ' ,   ,   ,   , * '           CLE005
     O                 37 41N87TOTINT    69 '   ,   ,   , * . '           CLE005
     O                 37 42N87TOTINT    69 '  ,   ,   , * .  '           CLE005
     O                 37 43N87TOTINT    69 ' ,   ,   , * .   '           CLE005
     O                 37 40   TOTINT    69 ' ,   ,   ,   , * '           S01392
     O                 37 41   TOTINT    69 '   ,   ,   , * . '           S01392
     O                 37 42   TOTINT    69 '  ,   ,   , * .  '           S01392
     O                 37 43   TOTINT    69 ' ,   ,   , * .   '           S01392
     O/COPY WNCPYSRC,LE0130OP18                                           S01408
     O********E  1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O                         TITL1  B  43
     O                   N39   TITL2  B  72
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O                         NAME1  B  41
     O                   N39   NAME2  B  83
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O***********              TOWN1  B  16                               091120
     O***********           N39TOWN2  B  58                               091120
     O**********               TOWN1  B  17                                            091120 CLE033
     O**********            N39TOWN2  B  59                                            091120 CLE033
     O**********               TOWN1  B  21                                            CLE033 CGL029
     O**********            N39TOWN2  B  63                                            CLE033 CGL029
     O                         TOWN1  B  27                                                   CGL029
     O                      N39TOWN2  B  75                                                   CGL029
     O        E  1     69 71 17                                                               CLE031
     O       OR  1     69 71 76                                                               CLE031
     O                    17   TITL5     38                                                   CLE031
     O                    76   TITL5     80                                                   CLE031
     O        E  1     69 71 17                                                               CLE031
     O       OR  1     69 71 76                                                               CLE031
     O                 17      WCCY1      9                                                   CLE031
     O                 17 10   WCAMT1    29 ' ,   ,   ,   , * '                               CLE031
     O                 17 12   WCAMT1    29 '   ,   ,   , * . '                               CLE031
     O                 17 13   WCAMT1    29 '  ,   ,   , * .  '                               CLE031
     O                 17 14   WCAMT1    29 ' ,   ,   , * .   '                               CLE031
     O                 76      WCCY2     51                                                   CLE031
     O                 76 15   WCAMT2    71 ' ,   ,   ,   , * '                               CLE031
     O                 76 26   WCAMT2    71 '   ,   ,   , * . '                               CLE031
     O                 76 70   WCAMT2    71 '  ,   ,   , * .  '                               CLE031
     O                 76 74   WCAMT2    71 ' ,   ,   , * .   '                               CLE031
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O                         TITL3  B  13
     O                   N39   TITL4  B  55
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O                         NAME3  B  41
     O                   N39   NAME4  B  83
     O********E**2     69                                                 S01117
     O/COPY WNCPYSRC,LE0130O011
     O        E  2     69 71                                              S01117
     O/COPY WNCPYSRC,LE0130O012
     O                         TOWN3  B  26
     O                   N39   TOWN4  B  68
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O                N23 51N39          55 'FOR A/C OF'
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O*****           N23 51N39CPNM      83                               S01117
     O*****   E  2     69                                                 S01117
     O*****           N23 51N39CPTN      68                               S01117
     O**********      N23 51N39CPNM      50                         S01117BHF312
     O****************N23 51N39CPNM      58                         BHF312S01310
     O                N23 51N39CPNM      83                               S01310
     O        E  1     69 71                                              S01310
     O****************N23 51N39CPTN      75                         S01117S01310
     O                N23 51N39CPTN      68                               S01310
     O*                                                                   S01117
     O********E**2     69                                                 S01117
     O        E  2     69 71                                              S01117
     O/COPY WNCPYSRC,LE0130O013
     O                N23 51N39CPORAC    40                               S01117
     O/COPY WNCPYSRC,LE0130O014
     O*                                                                   S01117
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O                   N24   TITL6  B  65
     O********E**1    N25 69                                              S01117
     O        E  1    N25 69 71                                           S01117
     O                   N24   SPI1      78
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O/COPY WNCPYSRC,LE0130O016
     O*************      N24   SPI2      78                               179355
     O                N24N06   SPI2      78                               179355
     O                    06             26 'RECEIVER OF GUARANTEE  '     179355
     O                    06   RCRN   B  46                               179355
     O                    06             48 '  '                          179355
     O                    06   RCTW   B  58                               179355
     O/COPY WNCPYSRC,LE0130O017
     O********E**2     69                                                 S01117
     O********E**2     69 71                                       S01117 E47247
     O********E**1     69 71                                        E47247LN0470
     O************       N24   SPI3      78                               LN0470
     O********E**1     69                                                 S01117
     O********E*12**   69 06 71                                     S01465179355
     O***********                        26 'RECEIVER OF GUARANTEE  S01465179355
     O***********              RCRN   B  46                         S01465179355
     O***********                        48 '  '                    S01465179355
     O***********              RCTW   B  58                         S01465179355
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OP13                                           S01408
     O*                                                                   S01408
     O        E  1     69 71                                              S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OP14                                           S01408
     O*                                                                   S01408
     O                         CNA1   B  44
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP5                                           S01408
     O*                                                                   S01408
     O                   N24   SPI3      78
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP6                                           S01408
     O*                                                                   S01408
     O********E**1     69                                           E47247S01117
     O        E  1     69 71                                              S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP7                                           S01408
     O*                                                                   S01408
     O                         CNA2   B  44                               E47247
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP8                                           S01408
     O*                                                                   S01408
     O********E**1     69                                                 S01117
     O        E  1     69 71                                              S01117
     O********                 CNA1   B  44                               E47247
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP9                                           S01408
     O*                                                                   S01408
     O                         CNA3   B  44                               E47247
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OP10                                           S01408
     O*                                                                   S01408
     O                 25                61 'BENIFICIARY BANK'
     O********E**1     69                                                 S01117
     O********E  1     69 71                                        S01117LN0470
     O        E        69 71                                              LN0470
     O********                 CNA2   B  44                               E47247
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OP11                                           S01408
     O*                                                                   S01408
     O                         CNA4   B  44                               E47247
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OP12                                           S01408
     O*                                                                   S01408
     O                 25      SPI1      78
     O********            U4 81          70 '** S.W.I.F.T. - DO NOT'      S01118
     O********            U4 81          78 'SEND **'                     S01118
     O**********       U4 81             69 'SWIFT - DO NOT SEND'   S01118LN0470
     O***********      U4 81             70 '** AUTO TRANSMISSION - S01118S01310
     O***********      U4 81             85 'DO NOT SEND **'        S01118S01310
     O                 U4 96             70 '** AUTO TRANSMISSION -'      S01310
     O                 U4 96             85 'DO NOT SEND **'              S01310
     O***********      78                80 '** TELEX GENERATED **'       S01310
     O********E**1     69                                                 S01117
     O********E**1     69 71                                       S01117 E47247
     O********                 CNA3   B  44                               E47247
     O********E**1     69                                                 S01117
     O********E  1     69 71                                        S01117LN0470
     O********                 CNA4   B  44                               E47247
     O********         U4 81             69 'SWIFT - DO NOT SEND'         LN0470
     O**
     O********T*32     U8 LR                                              S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP2                                           S01408
     O*                                                                   S01408
     O        T 32     U8 LR 71                                           S01117
     O                                   42 '*** REFERENCE'
     O***********              DBPGM     51                               S01117
     O                         DBPGM     53                               S01117
     O***********                        71 '- DATABASE ERROR AT'         S01117
     O                                   74 '- DATABASE ERROR -'          S01117
     O***********              DBASE     74                               S01117
     O********T**      U8 LR                                              S01117
     O***********                        37 'FILENAME'                    S01117
     O***********              DBFILE    43                               S01117
     O***********                        48 'KEY'                         S01117
     O***********              DBKEY     78                               S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OP20                                           S01408
     O*                                                                   S01408
     OLE0130AUT 32     U8 LR                                              S01117
2001 O                                   24 'REFERENCE LE0130AU'          S01117
2002 O                         TITL      90                               S01117
2003 O                                  104 'DATE'                        S01117
2004 O                         RUNA     112                               S01117
2005 O                                  122 'PAGE'                        S01117
2006 O                         PAGE     127                               S01117
     O/COPY WNCPYSRC,LE0130O005
     O        T 32     U8 LR                                              S01117
     O                                   42 '*** REFERENCE'               S01117
     O                         DBPGM     53                               S01117
     O                                   74 '- DATABASE ERROR AT'         S01117
     O                         DBASE     80                               S01117
     O        T        U8 LR                                              S01117
     O                                   37 'FILENAME'                    S01117
     O                         DBFILE    47                               S01117
     O                                   55 'KEY'                         S01117
     O                         DBKEY     85                               S01117
     O*
     O*    DTRIX FILE OUTPUT
     O*
     O*    UPDATE HEADER OR DETAIL RECORD
     OLTRIX   E        73
     O                    LR   COUNT     17P
     O                   NLR             19 'Y'
     O                    LR             33 '0'
     O                         NATN      40P
     O                                   44 'Y'                                             AR322732
     O*
     O*    LTRIX FILE - RELEASE
      *                                                                                     AR322732
      ** LTRIX file - Update 'Confirmation Processed Flag'                                  AR322732
      *                                                                                     AR322732
     O        E        75
     O                   NLR             44 'Y'                                             AR322732
 943 O*
 944 O*    DUMMY UPDATE FROM SUBRTN HDRCHN
4945 O********E*               RECLCK                                                       AR322732
4942 O**********               RECI                                                         AR322732
     O*
     O*    CLOAN FILE OUTPUT
     O*
     OCLOAN   E        72
     O                         CNFI     387
     O                         RUND     396P
     O***                N64            397 'A'                           E49673
     O                         NATN     400P
     O*
     O*    CLOAN FILE - RELEASE
     O        E        77
     O*
     O*     LEEXT FILE
     O*
     OLEEXTAA E        U4 82
     O                                    1 'H'
     O                         BRCA       4                               S01117
     OLEEXTAB E        U4 81 69
     O                                    1 'D'
     O                         BRCA       4                               S01117
     O***********              LNRF       7                               S01117
     O                         LNRF      10                               S01117
     O***********                         8 'C'                           S01117
     O                                   11 'C'                           S01117
     O********                         CSID      20                       S01135
     O***********         85   TELX      20                         S01135S01117
     O                    85   TELX      23                               S01117
     O***********        N85   CSID      20                         S01135S01117
     O                   N85   CSID      23                               S01117
     O***********              TOTI      27P                              S01117
     O                         TOTI      30P                              S01117
     OLEEXTAC T        U4 LR
     O                                    1 'T'
     O                         BRCA       4                               S01117
     O***********              NORET      6                               S01117
     O                         NORET      9                               S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0130OOP4                                           S01408
     O*                                                                   S01408
     O**
     O**   N.B. TABLE TITL12 CHANGED                                      S01117
     O**        "TO OUR A/C WITH" HAS BEEN DELETED TO GIVE :              S01117
     O**        "TO             "                                         S01117
     O*
     O**    ARRAY NARN WAS AMENDED TO INSERT ONE MORE ELEMENT             S01392
     O******ARRAY*TITL12*WAS*PHYSICALLY*AMENDED****                       S01392
     O**    ARRAY TITL12 WAS AMENTED TO INSERT ONE MORE ELEMENT           S01392
      *                                                                                       CLE064
      ** Elements of Array TABF/TABFRQ were amended by removing TBI-MONTHLY and               CLE064
      ** XSIX MONTHLY, and added more elements                                                CLE064
      *                                                                                       CLE064
**    TABTYP/TABNO  -  LOAN TYPES AND KEY TO ASSOCIATED PRINT DATA
61  11
62  11
63  11
64  22
65  22
66  23
67  23
70  34
68  22                                                                    CLE005
69  23                                                                    CLE005
71  26                                                                    CLE005
72  27                                                                    CLE005
99  28                                                                    CLE005
80  11                                                                                        CLE028
**   NAME/START  - CONFIRMATION NAMES AND START POSITION IN SET-UP ARRAY
18LOAN CONFIRMATION         10
27PARTICIPATION CONFIRMATION 1
23GUARANTEE CONFIRMATION     5
**   NARN  -  NAMES USED IN NARRATIVE
16OUR LOAN TO YOU
31OUR PARTICIPATION IN YOUR LOAN
31YOUR PARTICIPATION IN OUR LOAN
36OUR GUARANTEE ISSUED ON YOUR BEHALF
27RENEWAL OF OUR LOAN TO YOU
35OUR PARTICIPATION IN YOUR GUARANTEE                                     CLE005
43YOUR PARTICIPATION IN GUARANTEEING OUR LOAN                             CLE005
35YOUR PARTICIPATION IN OUR GUARANTEE                                     CLE005
**   NARRA  -  CONSTANT FIELDS USED IN NARRATIVE - SET UP IN DATA STRUCTUR
14VALUE        09MATURING
**   TITL12  -  CONSTANT FIELDS USED IN OUR NOSTRO TITLES - SEE DATA STRUC
11PAYMENT AT11VALUE DATE14MATURITY DATETO OUR A/C WITH13FEE DUE DATE
14ROLLOVER DATE
**   TITL5   -  CONSTANT TEXT FOR SETTLEMENT DETAILS                                          CLE031
PAYMENT IN SETTLE CCY AMOUNTING TO                                                            CLE031
**   NAME12  -  CONSTANT FIELDS USED IN OUR NOSTRO NAME - SEE DATA STRUCTU
INSTRUCTIONS TO BE ADVISED DEBIT TO A/C NUMBER
WE WILL SENDWE AWAIT YOUR REMITTANCEAS PER YOUR IN
STRUCTIONS WE SHALL COLLECT REMITTANCEYOURSELVES
**   NAME34  -  CONSTANT FIELDS USED IN THEIR NOSTRO, SET UP IN DATA STRUC
PAYMENT   WE AWAIT YOUR ADVICESPECIAL INSTRUCTIONS
**   TABF/TABFRQ  -  INTEREST PAYMENT FREQUENCIES
WWEEKLY
MMONTHLY
FFORTNIGHTLY
TTWO MONTHLY                                                                                  CLE064
QQUARTERLY
XHALF YEARLY                                                                                  CLE064
YYEARLY
DDAILY                                                                                        CLE064
4FOUR MONTHLY                                                                                 CLE064
5FIVE MONTHLY                                                                                 CLE064
7SEVEN MONTHLY                                                                                CLE064
8EIGHT MONTHLY                                                                                CLE064
9NINE MONTHLY                                                                                 CLE064
VTEN MONTHLY                                                                                  CLE064
EELEVEN MONTHLY                                                                               CLE064
CTWO YEARLY                                                                                   CLE064
ITHREE YEARLY                                                                                 CLE064
JFOUR YEARLY                                                                                  CLE064
NFIVE YEARLY                                                                                  CLE064
UTEN YEARLY                                                                                   CLE064
**   DEDIT - ARRAY OF DAY NUMBER EDITS
STNDRDTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHSTNDRDTHTHTHTHTHTHTHST
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                                           CLE031
0000001                                                                                       CLE031
0000010                                                                                       CLE031
0000100                                                                                       CLE031
0001000                                                                                       CLE031
0010000                                                                                       CLE031
0100000                                                                                       CLE031
1000000                                                                                       CLE031
