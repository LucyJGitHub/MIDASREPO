     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Participant sold enquiry')                    *
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *  LE0191 - Participations Sold Enquiry                         *
      *                                                               *
      *  Function:  This is a new program used to show a summary of   *
      *             the participations sold against a loan and their  *
      *             details.  This is available from Loan Detail      *
      *             Enquiry by using command key F15.                 *
      *                                                               *
      *  Called By: LE0190 - Loan Details Enquiry                     *
      *  Calls    : LER115 - Fees Activity Enquiry                    *
      *             SD2400 - Extended Settlements                     *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. 231618             Date 19Aug14               *
      *  Prev Amend No. AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG22764           Date 17Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 245251             Date 05Mar07               *
      *                 245082             Date 30Jan07               *
      *                 164847             Date 30Nov06               *
      *                 CRE026             Date 19Feb07               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE106             Date 01Aug04               *
      *                 CLE038             Date 11May04               *
      *                 CLE036             Date 22Sep03               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 27Oct03               *
      *                 CLE034             Date 05May03               *
      *                 CLE031             Date 03Feb03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAS001             Date 23Nov01               *
      *                 200044             Date 09Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 04Apr00               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 187270             Date 16Jan01               *
      *                 187261             Date 16Jan01               *
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD007             Date 28Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 13Aug99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 158288             Date 15Apr99               *
      *                 157606             Date 22Mar99               *
      *                 157508 (BT1476)    Date 10Feb99               *
      *                 147830             Date 10Dec98               *
      *                 142406             Date 25Nov98               *
      *                 136525             Date 05Jun98               *
      *                 CEU004             Date 02Feb98               *
     F*                 126017             DATE 14NOV97               *
     F*                 121768             DATE 19FEB98               *
      *                 CLE005             Date 22May97               *
      *                 CLE004 *Create     Date 02Dec96               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  231618 - Participant Facility By Primary Facility - Loan does*
      *           not exist in the system.                            *
      *           File Condition UC on CLOAN. Issue override command  *
      *           on file CLOAN before OPEN.                          *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CLE064 - Enhancement of Lending Frequencies                  *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER047 - German Features LF037-00 Reporting §24c             *
      *           (Recompile)                                         *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to Midas   *
      *           Plus                                                *
      *  BUG22764 - Apply core fix 143510.                            *
      *             Pattern fix after LE0190.                         *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245251 - Enquiry title is for wrong type of loan             *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Patterned after fix 235784 from Release 4.          *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CRE026 - Consumer Banking                                    *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CLE106 - Syndications Manager.                               *
      *  CLE038 - Lending Enhancement for Nordea: Allocation by Amount*
      *  CLE036 - LE Enh for Nordea Phase 1 Pty 2- Specific Base Rate *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *  CLE031 - Lending Enhancements.                               *
      *  CAS001 - Net Present Value (NPV) Accounting                  *
      *  200044 - Recompiled due to changes in LE0191DF. Change title *
      *           for Risk Parts Sold.                                *
      *  CDE002 - Revenue Analysis                                    *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
      *  187270 - If Payment Due Day field is 'M' for modify, ensure  *
      *           appropriate narrative is assigned.                  *
      *  187261 - Do not display fields linked to Syndications unless *
      *           CLE006 is switched on.                              *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *  CSD007 - Customer Closing                                    *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  CPB001 - 'Private Banking' Module                            *
      *  158288 - CPF2469 issued by Y2SNMGC within loan details       *
      *           enquiry                                             *
      *  157606 - Database error when interest payment freq. is 'R'.  *
      *           Applied fix 130240.                                 *
      *  157508 - Participations Sold in Guarantee Loans not          *
      *           identified correctly                                *
      *  147830 - On Participations sold SFL identify Risk parts sold *
      *           as 'Risk'. Also show original borrower and report   *
      *           name on details screen.                             *
      *  142406 - Wrong calculation of outstanding interest.          *
      *  136525 - User is not able to enquire on enquiry screen when  *
      *           called from Loan Details Enq screen.                *
      *  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
     F*  126017 - Correction to interest calculation for calculation  *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
      *  CLE005 - Customer Lending  Enhancements - Others             *
      *  CLE004 - Customer Lending Enhancements - Syndications.       *
      *                                                               *
      *****************************************************************
     FLE0191DFCF  E                    WORKSTN
     F                                        SRRN  KSFILE LE0191S0
      *
     F*CLOAN***IF  E           K        DISK                                                  231618
     FCLOAN   IF  E           K        DISK                           UC                      231618
     F            CLOANHHF                          KIGNORE
     F            CLOANZ1F                          KIGNORE
      *
     FLOAMS   IF  E           K        DISK
     F            LOAMSDHF                          KIGNORE
     F            LOAMSZ1F                          KIGNORE
      *
     FPSOLD   IF  E           K        DISK         KINFSR *PSSR
     F            CLOANCLF                          KRENAMEPSOLDF
      /EJECT
      *****************************************************************
      *                                                               *
      *    F U N C T I O N   O F   I N D I C A T O R S                *
      *                                                               *
      *    19           Parts Sold in a Call Loan                     *   CLE005
      *    20           Parts Sold in a Risk loan                     *   CLE005
      *    21           Invalid action code                           *
      *    22           Parts sold for customer loan                  *
      *    23           Parts sold for part purchased                 *
      *    24           SAR S01465 is installed                       *
      *    25           Guarantees issued is active                   *
      *    26           A repayment schedule exists                   *
      *    27           SAR S01518 is installed                       *
      *    28           Portfolio management is installed             *
      *    29           Profit centre is being used                   *
      *    30           Originating branch is being used              *
      *    31           System is multibranching                      *
      *    32           F19 is enabled for funding info               *
      *    33           Term parts sold                               *
      *    34           SAR CLE005 is installed                       *
      *    35           SAR CEU004 is installed                       *   CEU004
      *    36           Parts sold for guarantee issued               *   157508
      *    40           Switchable feature CLE011 is on.              *   CLE011
      *    50           Chain to CLOAN to get original borrower       *   147830
      *    67           Work indicator                                *
      *    68           Rolldown to display screen 1                  *
      *    69           Rollup/rolldown to display screen 2           *
      *    70           Rollup to display screen 3                    *
      *    71           No record in subfile                          *
      *    72           Subfile clear                                 *
      *    73           Subfile end                                   *
      *    74           Rollup for subfile                            *
      *    75           Message subfile end                           *
      *    76           Subfile next change                           *
      *    77           No more changed record                        *
      *    78           CLE034 is installed.                          *                       CLE034
      *    98           Date format is MMDDYY                         *
      *                                                               *
      *****************************************************************
      /EJECT
     E                    CPY@    1   1 80
      ** Copyright statement
     E                    ANARR   1  13 21
      ** Narratives
     E                    ADEDT  31  31  2
      ** Editing day number
     E***********         TAB1    1   7  1   TABF   11                    157606
     E**********          TAB1    1   8  1   TABF   11                                 157606 CLE064
     E                    TAB1    1  21  1   TABF   15                                 157606 CLE064
      ** Interest frequency in words
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZDATE9Z1
     E/COPY ZSRSRC,ZFRPEDZ1
     E                    CMD     1   1 80               QCMD'S                               231618
     E/COPY ZSRSRC,ZEDITZ1                                                                    CLE031
      *
     IPSOLDF
      ** Rename fields still to be formatted after accessing PSOLD        CEU004
     I              SCCY                            SCRY                  CEU004
     ILOAMSDKF
      ** Rename fields still to be formatted after accessing LOAMS
     I              LNRF                            LNRFA
     I              LTYP                            LTYPA
     I              CCY                             CCYA
     I              BRCA                            BRCAA
     I              CNUM                            CNUMA
     I              RSTM                            RSTMA
     I              RONS                            RONSA
     I              RIBN                            RIBNA
     I              RIBA                            RIBAA
     I              ROBN                            ROBNA
     I              ROCN                            ROCNA
     I              PSTM                            PSTMA
     I              PONS                            PONSA
     I              PIBN                            PIBNA
     I              PIBA                            PIBAA
     I              POBN                            POBNA
     I              POCN                            POCNA
     I              RCRN                            RCRNA
     I              RCRA                            RCRAA
     I              RVNO                            RVNOA
     I              AWBN                            AWBNA
     I              AWBA                            AWBAA
     I              BENN                            BENNA
     I              BENA                            BENAA
     I              DTP1                            DTP1A
     I              DTP2                            DTP2A
     I              DTP3                            DTP3A
     I              DTP4                            DTP4A
     I              DCHG                            DCHGA
     I              BTB1                            BTB1A
     I              BTB2                            BTB2A
     I              BTB3                            BTB3A
     I              BTB4                            BTB4A
     I              BTB5                            BTB5A
     I              BTB6                            BTB6A
     I              CVMR                            CVMRA
     I              FSRP                            FSRPA
     I              FSGN                            FSGNA
     I              FPRC                            FPRCA
     I              MNSG                            MNSGA
     I              GASS                            GASSA
     I              GPRT                            GPRTA
      *
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
      *
     ILDA         DS                            256
      ** Local data area for database error details
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      *
     IPSDS       SDS
      ** Program Status Data Structure - gives Job/Workstation name and
      ** User ID
     I                                     *PROGRAM ##PGM
     I                                      244 253 WSID
     I                                      254 263 USER
      *
     ISPARE       DS                            256
      * Read in the data structure passed from calling program.
      *
     I                                        1   1 WACTN
     I                                        2   2 WDSTS
     I                                    P   3   87WELIR
     I                                        9  12 WPRFC
     I                                    P  13  187WFSRP
     I                                       19  19 WFSGN
     I                                       20  23 WFPRC
     I                                       24  26 WCCY
     I                                       27  29 WLCCY
     I                                       30  30 WRATF
     I                                       31  31 WFRC
     I                                       32  35 WTPRC
      *
      /COPY QWINDSRC,LE0191GDTA
      ** Data to be passed to window program
      *
     I            DS
      ** Format amount returned by standard subroutine
     I                                        1  22 ZOUT22
     I                                        1  21 ZOUT21
     I                                        1  20 ZOUT20
      *
     I            DS
      ** Facility type and sequence
     I                                        1   6 WFACT
     I                                        1   30FTYP
     I I            '/'                       4   4 WTMP1
     I                                        5   60FSEQ
      *
     I            DS
      ** Default loan type/subtype
     I****************************************1   5 WDLTS                                     CLE042
     I                                        1   9 WDLTS                                     CLE042
     I                                        1   2 DFTP
     I I            '-'                       3   3 WTMP2
     I                                        4   5 DFST
     I                                        6   9 DFCL                                      CLE042
      *
     IPARM2     E DSSETLIAB
      ** data structure for passing a parameter to synon screen
      *  handling program.
      *
     IPARM3     E DSSETLIAZ
      ** data structure for passing a parameter to synon screen
      *  handling program.
     IP@ARM3    E DSSDSETLPD                                              222373
      *
      *
     ISCSARD    E DSSCSARDPD
      ** SAR details
      *
     ISDACOF    E DSSDACOFPD
      ** Account officer details
      *
     ISDBANK    E DSSDBANKPD
      ** Bank details
      *
     ISDBSRT    E DSSDBSRTPD
      ** Base rate codes
      *
     ISDCTRY    E DSSDCTRYPD
      ** Country details
      *
     ISDCLND    E DSSDCLNDPD
      ** Customer lending ICD
      *
     ISDCURR    E DSSDCURRPD
      ** Currency details
      *
     ISDCUST    E DSSDCUSTPD
      ** Customer details
      *
     ISDGELR    E DSSDGELRPD
      ** General ledger details
      *
     ISDINDS    E DSSDINDSPD
      ** Industry details
      *
     ISDLOAN    E DSSDLOANPD
      ** Loan type/subtype details
      *
     ISDMMOD    E DSSDMMODPD
      ** Midas modules details
      *
     ISDPORT    E DSSDPORTPD
      ** Portfolio management ICD
      *
     ISDPRFC    E DSSDPRFCPD
      ** Profit centre details
      *
     IDSFDY     E DSDSFDY
      ** Short data structure for access objects
      *
     IDSSDY     E DSDSSDY
      ** Long data structure for access objects
      *
     IDSLDY     E DSDSLDY                                                 CSD007
      ** Third DS for access programs, very long data structure           CSD007
      *                                                                   CSD007
     I/COPY ZSRSRC,ZDATE9Z2
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/COPY ZSRSRC,ZFRPEDZ2
     I/COPY ZSRSRC,ZINTDYZ1
      /EJECT
      *****************************************************************
      *                   Index to subroutines                        *
      *  Main routine                                                 *
      *  SRSPRO  -  Subfile processing                                *
      *  SRVALD  -  Validate subfile entry                            *
      *  SRCAUT  -  Check if user is authorised to the action         *
      *  CLEAR   -  Clears message from the program message queue     *
      *  ZASNMS  -  Sends message to the program message queue        *
      *  SRDISP  -  Display details of each selected subfile record   *
      *  SRSCR1  -  Format screen 1 details                           *
      *  SRSCR2  -  Format screen 2 details                           *
      *  SRSCR3  -  Format screen 3 details                           *
      *  SRCUST  -  Retrieve customer details                         *
      *  SRDETL  -  Process detail screens                            *
      *  SRFEES  -  Call Fees Summary program                         *
      *  SRSETT  -  Call Extended Settlement program                  *
      *  SRFUND  -  Call window program for Funding Info              *
      *  SRWIND  -  Call window manager                               *
      *  SRLOAD  -  Load subfile records                              *
      *  SRCURR  -  Retrieve currency details                         *
      *  SRINIT  -  Initial processing                                *
      *  SRSARD  -  Retrieve SAR details                              *
      *  *PSSR   -  Error handling subroutine                         *
      *****************************************************************
      *
      ** Perform initial processing
      *
     C                     Z-ADD80        MSGLEN 155                                          231618
     C                     MOVEACMD,1     PCMD   80                                           231618
     C                     CALL 'QCMDEXC'                                                     231618
     C                     PARM           PCMD                                                231618
     C                     PARM           MSGLEN                                              231618
     C                     OPEN CLOAN                                                         231618
      *                                                                                       231618
     C                     EXSR SRINIT
      *
      ** Perform subfile processing
      *
     C                     EXSR SRSPRO
      *
      ** Close SD2400 program, then end this program's processing
      *
     C           S01518    IFEQ 'Y'
     C                     MOVE 'T'       PMTERM
     C                     CALL 'SD2400'
     C                     PARM           PARM1
     C                     PARM           PARM2
     C                     PARM           PARM3
     C                     PARM SLNRF     PSLON
     C                     PARM           P@ARM3                          222373
     C                     ENDIF
      *
     C                     CLOSECLOAN                                                         231618
     C                     MOVE '1'       *INLR
      /EJECT
      *****************************************************************
      * SRSPRO  -  Subfile Processing                                 *
      * Called by: Main routine                                       *
      * Calls    : SRLOAD - Load subfile records                      *
      *            SRVALD - Validate each subfile entry               *
      *            SRDISP - Display detail screen of each subfile     *
      *****************************************************************
     C           SRSPRO    BEGSR
      *
      ** Load subfile records
      *
     C                     EXSR SRLOAD
      *
      ** Process each subfile record until F3 or F12 is pressed
      *
     C           *INKC     DOUEQ'1'
     C                     WRITELE0191F5
     C                     WRITELE0191C1
     C                     EXFMTLE0191C0
     C           *INKC     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     LEAVE
     C                     ENDIF
     C           *IN71     IFEQ '0'
     C                     EXSR SRVALD
     C           WERRF     IFEQ *BLANK
     C           WVALR     ANDNE*ZEROS
     C                     EXSR SRDISP
     C                     ENDIF
     C           WERRF     IFEQ *BLANK
     C                     Z-ADD1         SRNBR
     C                     ENDIF
     C                     ENDIF
     C                     ENDDO
      *
      ** Format return code
      *
     C                     SELEC
     C           *INKC     WHEQ '1'
     C                     MOVE 'E'       PLTYP
     C           *INKL     WHEQ '1'
     C                     MOVE 'P'       PLTYP
     C                     ENDSL
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRVALD  -  Validate subfile entry                             *
      * Called by: SRSPRO - Subfile processing                        *
      * Calls    : SRCAUT - Check user authority                      *
      *****************************************************************
     C           SRVALD    BEGSR
      *
      ** Clear error indicator and program message queue
      *
     C                     EXSR CLEAR
      *
      ** Validate action code for each subfile record
      ** ... must be 'E' and valid for menu item and/or branch
      *
     C                     MOVE 'Y'       WFRST   1
     C                     Z-ADD*ZEROS    WVALR   40
     C                     READCLE0191S0                 77
     C           *IN77     DOWEQ'0'
     C                     MOVE '0'       *IN21
      *
     C           SLSEL     IFEQ *BLANK
     C                     MOVE '0'       *IN76
     C                     ELSE
     C                     MOVE '1'       *IN76
     C           SLSEL     IFNE 'E'
     C                     MOVE '1'       *IN21
     C                     MOVEL'LEE0001' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C***********          EXSR SRCAUT                                    136525
     C                     ENDIF
      *
     C           *IN21     IFEQ '0'
     C                     ADD  1         WVALR
     C                     ELSE
     C           WFRST     IFEQ 'Y'
     C                     Z-ADDSRRN      SRNBR
     C                     MOVE *BLANK    WFRST
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
     C                     UPDATLE0191S0
     C                     READCLE0191S0                 77
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRCAUT  -  Check if user is authorised to the action          *
      * Called by: SRVALD - Validate subfile entry                    *
      * Calls    : None                                               *
      *****************************************************************
     C           SRCAUT    BEGSR
      *
      ** For single branch system, check if user is authorised to the
      ** action
      *
     C                     Z-ADD*ZEROS    @ERR
     C           BGMBIN    IFEQ 'N'
     C                     CALL 'ZVACTU'
     C                     PARM SLSEL     @ZACTN
     C                     PARM           @ERR
     C           @ERR      IFNE *ZEROS
     C                     MOVE '1'       *IN21
     C                     MOVEL'LEE0302' ZAMSID
     C                     EXSR ZASNMS
     C                     ENDIF
      *
      ** For multibranching system, branch code must be valid for
      ** the user
      *
     C                     ELSE
     C                     CALL 'ZVACTBU'
     C                     PARM SLSEL     @ZACTN  1
     C                     PARM SSBRC     @ZBR    3
     C                     PARM           @ERR    10
     C           @ERR      IFEQ 1
     C                     MOVE '1'       *IN21
     C                     MOVEL'LEE0303' ZAMSID
     C                     EXSR ZASNMS
     C                     ENDIF
     C           @ERR      IFEQ 2
     C                     MOVE '1'       *IN21
     C                     MOVEL'LEE0304' ZAMSID
     C                     EXSR ZASNMS
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * CLEAR   -  Clears the message queue                           *
      * Called by: All validation subroutines                         *
      * Calls    : None                                               *
      *****************************************************************
     C           CLEAR     BEGSR
      *
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C                     MOVE *BLANK    WERRF   1
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *  ZASNMS - Sends messages to the program's message queue       *
      *  Called by: All validation subroutines                        *
      *  Calls    : None                                              *
      *****************************************************************
     C           ZASNMS    BEGSR
      *
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
     C                     MOVE 'Y'       WERRF
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRDISP  -  Display details of each selected subfile record    *
      * Called by: SRSPRO - Subfile processing                        *
      * Calls    : SRSCR1 - Format screen 1 details                   *
      *            SRSCR2 - Format screen 2 details                   *
      *            SRSCR3 - Format screen 3 details                   *
      *            SRDETL - Process detail screens                    *
      *****************************************************************
     C           SRDISP    BEGSR
      *
     C                     EXSR CLEAR
     C                     Z-ADD1         SRRN
     C                     READCLE0191S0                 77
      *
     C           *IN77     DOWEQ'0'
      *
      ** Get loan details, display error msg if none found
      *
     C                     MOVE SLNRF     WLNRF
     C                     MOVE 'A'       WRCDT
     C           WKLON     CHAINCLOAN                67
     C                     MOVE *IN67     WIN67   1
     C                     MOVE 'B'       WRCDT
     C           WKLON     CHAINCLOAN                67
     C           WIN67     IFEQ '1'
     C           *IN67     OREQ '1'
     C                     Z-ADDSRRN      SRNBR
     C                     MOVE '1'       *IN76
     C                     UPDATLE0191S0
     C                     MOVEL'LEE0002' ZAMSID
     C                     EXSR ZASNMS
     C                     LEAVE
     C                     ENDIF
      *
      ** Format screen fields and process screen displays
      *
     C                     MOVE 'D1'      WFMT    2
     C                     EXSR SRSCR1
     C                     EXSR SRSCR2
     C                     EXSR SRSCR3
     C                     EXSR SRDETL
      *
      ** Return to calling program if F3 or F12 is pressed,
      ** otherwise, update subfile record and read next changed record
      *
     C           *INKC     IFEQ '1'
     C                     LEAVE
     C                     ELSE
     C                     MOVE *BLANK    SLSEL
     C                     UPDATLE0191S0
     C           *INKL     IFEQ '1'
     C                     LEAVE
     C                     ENDIF
     C                     ENDIF
      *
     C                     READCLE0191S0                 77
     C                     ENDDO
      *
      ** Write subfile header and footer
      *
     C                     WRITELE0191F0
     C                     WRITELE0191F4
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRSCR1  -  Format screen 1 fields                             *
      * Called by: SRDISP - Display details of each subfile record    *
      * Calls    : SRCUST - Get customer details                      *
      *            SRCURR - Get currency details                      *
      *****************************************************************
     C           SRSCR1    BEGSR
      *
      ** Clear screen fields and set up screen indicators
      *
     C                     CLEARLE0191F1
     C                     CLEARLE0191F2
     C                     CLEARLE0191F3
     C                     Z-ADD*ZEROS    WOINT  130
     C                     MOVE *BLANK    WLIVE   1
     C                     MOVE *BLANK    WMATR   1
     C                     MOVE WIN24     *IN24
     C                     MOVE WIN25     *IN25
     C                     MOVE WIN27     *IN27
     C                     MOVE WIN28     *IN28
     C                     MOVE WIN29     *IN29
     C                     MOVE WIN30     *IN30
     C                     MOVE WIN31     *IN31
     C                     MOVE WIN34     *IN34
     C                     MOVE WIN35     *IN35                           CEU004
      *
      ** Loan status
      *
     C                     MOVE BJMRDT    SRUNA
     C                     SELEC
     C           RECI      WHEQ 'M'
     C                     MOVELANARR,1   SLSTS
     C                     MOVE 'Y'       WMATR
     C           RECI      WHEQ 'R'
     C                     MOVELANARR,2   SLSTS
     C           LSTS      WHEQ 'C'
     C                     MOVELANARR,3   SLSTS
     C                     MOVE 'Y'       WLIVE
     C           LSTS      WHEQ 'A'
     C                     MOVELANARR,4   SLSTS
     C                     MOVE 'Y'       WLIVE
     C           LSTS      WHEQ 'R'
     C                     MOVELANARR,5   SLSTS
     C                     MOVE 'Y'       WLIVE
     C                     ENDSL
      *                                                                   147830
      ** Get original borrower and report name for original borrower.     147830
      ** First save original CLOAN flds                                   147830
      *                                                                   147830
     C                     EXSR SFLDS                                     147830
      *                                                                   147830
      ** Save original customer name                                      147830
      *                                                                   147830
     C                     MOVE CNUM      SVCNUM                          147830
      *                                                                   147830
      ** Save original loan ref                                           147830
      *                                                                   147830
     C**********           Z-ADDOLNO      KLNRF                                        147830 CSD027
     C                     MOVE OLNO      KLNRF                                               CSD027
     C                     MOVE 'A'       KRCDT                           147830
      *                                                                   147830
     C           KLOAN     CHAINCLOAN                50                   147830
      *                                                                   147830
     C           *IN50     IFEQ *ON                                       147830
     C                     MOVEL*BLANKS   SORGB                           147830
     C                     MOVEL*BLANKS   SRPTN                           147830
     C                     ELSE                                           147830
      *                                                                   147830
     C           PLTYP     IFEQ 'L'                                       147830
     C           PLTYP     OREQ 'G'                                       157508
     C                     MOVE CNUM      SORGB                           147830
     C                     ELSE                                           147830
     C                     MOVE OLNO      SORGB                           147830
     C                     ENDIF                                          147830
      *                                                                   147830
     C           PTYP      IFEQ 64                                        147830
     C           PTYP      OREQ 65                                        147830
     C           PTYP      OREQ 68                                        147830
     C                     MOVELOLNO      KEYC   10                       147830
     C                     ELSE                                           147830
     C                     MOVELCNUM      KEYC                            147830
     C                     ENDIF                                          147830
      *                                                                   147830
      ** Access customer file to get Customer report name (Original       147830
      *                                                                   147830
     C***********          CALL 'AOCUSTR0'                         147830 CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM '*MSG   ' @RTCD   7                       147830
     C                     PARM '*KEY   ' @OPTN   7                       147830
     C                     PARM           KEYC                            147830
     C                     PARM '*CNUM  ' KEYSTS  7                       147830
     C***********SDCUST    PARM SDCUST    DSSDY                    147830 CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
      *                                                                   147830
     C           @RTCD     IFNE *BLANKS                                   147830
      *                                                                   CSD007
     C           CSD007    IFEQ 'Y'                                       CSD007
     C           @RTCD     ANDEQ'*NRF   '                                 CSD007
     C           BBDTDL    ANDEQ*ZEROS                                    CSD007
     C                     MOVE BBCRNM    SRPTN                           CSD007
     C                     ELSE                                           CSD007
     C                     SETON                     U7U8  **DATABASE 21**147830
     C                     Z-ADD21        DBASE                           147830
     C                     MOVELKEYC      DBKEY                           147830
     C                     MOVEL'SDCUSTPD'DBFILE                          147830
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C                     ELSE                                           147830
     C                     MOVE BBCRNM    SRPTN                           147830
     C                     ENDIF                                          147830
      *                                                                   147830
      **                                                                  147830
      ** Now restore original CLOAN flds                                  147830
      *                                                                   147830
     C                     EXSR RFLDS                                     147830
      *                                                                   147830
      ** Restore original customer name                                   147830
      *                                                                   147830
     C                     MOVE SVCNUM    CNUM                            147830
      *                                                                   147830
      ** Restore original loan ref                                        147830
      *                                                                   147830
     C                     ENDIF                                          147830
      *
      ** Customer details
      *
     C                     Z-ADD4         WDBSE
     C                     MOVE CNUM      SCNUM
     C                     MOVELCNUM      PCUST
     C                     EXSR SRCUST
     C                     MOVE BBCRNM    SCRNM
     C                     MOVE OLNO      SOLNO
     C                     MOVE BRCA      SBRCA
      *
      ** Loan/processing type and book code
      *
     C                     MOVE BOKC      SBOKC
     C                     MOVE LNRF      SLNRF
     C                     CALL 'AOLOANR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM LTYP      PLNTY   2
     C                     PARM SUTP      PLNST   2
     C                     PARM CLAS      PLNCL   4                                           CLE042
     C           SDLOAN    PARM SDLOAN    DSFDY
     C           PRTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDLOANPD'DBFILE           ************
     C                     Z-ADD5         DBASE            * DBERR 05 *
     C                     MOVELLTYP      WTMP4   4        ************
     C                     MOVE SUTP      WTMP4
     C                     MOVELWTMP4     DBKEY
     C                     MOVE CLAS      DBKEY                                               CLE042
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     MOVE AYLNTD    SLNTD
     C                     MOVE PTYP      SPTYP
      *
      ** If Analytical Accounting is on and loan is a term parts sold,
      ** or Revenue Analysis is on,                                       CDE002
      ** enable F19 for funding information
      *
     C                     MOVEA'00'      *IN,32
     C           PTYP      IFEQ 66
     C                     MOVE '1'       *IN33
     C           BGN0ST    IFEQ 'Y'
     C           CDE002    OREQ 'Y'                                       CDE002
     C                     MOVE '1'       *IN32
     C                     ENDIF
     C                     ENDIF
      *                                                                   CDE002
     C           CDE002    IFEQ 'Y'                                       CDE002
     C           PTYP      ANDEQ67                                        CDE002
     C           CDE002    OREQ 'Y'                                       CDE002
     C           PTYP      ANDEQ69                                        CDE002
     C           BGN0ST    OREQ 'Y'                                       CDE002
     C           PTYP      ANDEQ69                                        CDE002
     C                     MOVE '1'       *IN32                           CDE002
     C                     ENDIF                                          CDE002
      *
      ** Deal, start and maturity dates; recourse indicator
      *
     C                     Z-ADDDDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SDDAT
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SVDAT
     C                     Z-ADDMDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SMDAT
     C                     MOVE RCSI      SRCSI
      *                                                                                       CER020
      ** Populate Initial Start and Final Maturity Date                                       CER020
      *                                                                                       CER020
     C           CER020    IFEQ 'Y'                                                           CER020
      *                                                                                       CER020
     C           ISDT      IFNE *ZEROS                                                        CER020
      *                                                                                       CER020
     C                     MOVE ISDT      ZDAYNO                                              CER020
     C                     EXSR ZDATE2                                                        CER020
     C                     MOVE ZADATE    SINSDT                                              CER020
      *                                                                                       CER020
     C                     ENDIF                                                              CER020
      *                                                                                       CER020
     C           FMDT      IFNE *ZEROS                                                        CER020
      *                                                                                       CER020
     C                     MOVE FMDT      ZDAYNO                                              CER020
     C                     EXSR ZDATE2                                                        CER020
     C                     MOVE ZADATE    SFNMDT                                              CER020
      *                                                                                       CER020
     C                     ENDIF                                                              CER020
      *                                                                                       CER020
     C                     ENDIF                                                              CER020
      *
      ** Loan currency and loan/parts sold amounts
      *
     C                     MOVE CCY       SCCY
     C                     Z-ADD6         WDBSE
     C                     MOVE CCY       PCURR
     C                     EXSR SRCURR
     C                     Z-ADDA6NBDP    WNBDP   10
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE CPAM      ZFLD15
     C                     Z-ADDWNBDP     ZDECS
     C                     MOVE 'A'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SCPAM
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE PSAM      ZFLD15
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SPSAM
      *
      ** Interest details
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE INTR      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT21    SINTR
      *                                                                                       CLE036
      ** If CLE036 is on, format base rate                                                    CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           BASR      IFNE *ZERO                                                         CLE036
     C                     MOVE *BLANKS   ZFLD15                                              CLE036
     C                     MOVE BASR      ZFLD15                                              CLE036
     C                     Z-ADD7         ZDECS                                               CLE036
     C                     MOVE 'L'       ZECODE                                              CLE036
     C                     EXSR ZFRPED                                                        CLE036
     C                     MOVE ZOUT21    SBASR                                               CLE036
     C                     ENDIF                                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           BRTT      IFNE *ZEROS
     C                     MOVE BRTT      SBRTT
     C                     ENDIF
     C                     MOVE CHIN      SCHIN
     C           ICBS      IFNE *ZEROS
     C                     MOVE ICBS      SICBS
     C                     ENDIF
      *
     C           INTC      IFEQ 'Y'
     C                     MOVE 'YES'     SINTC
     C                     ELSE
     C                     MOVE 'NO '     SINTC
     C                     ENDIF
      *
     C           NIDT      IFNE *ZEROS
     C                     Z-ADDNIDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SNIDT
     C                     ENDIF
     C           IPFR      IFNE *BLANK
     C           IPFR      LOKUPTAB1      TABF           67
     C           *IN67     IFEQ '0'
     C           *LOCK     IN   LDA
     C                     MOVEL'TABF    'DBFILE           ************
     C                     Z-ADD7         DBASE            * DBERR 07 *
     C                     MOVELIPFR      DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     MOVELTABF      SIPFR
     C                     ENDIF
      *
     C           IFDY      IFNE *ZEROS
     C                     MOVELIFDY      SIFDY
     C                     MOVE ADEDT,IFDYSIFDY
     C           IFDY      IFLT 10
     C                     MOVEL' '       SIFDY
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVE ADDI      SADDI
     C                     MOVE RDFC      SRDFC
      *
      ** Outstanding interest
      *
     C                     TESTB'3'       LONI           67
     C                     SELEC
      *
      ** ... skip interest calculation if stop accruals indicator is
      ** on or loan has not yet started or loan has matured
      *
     C           *IN67     WHEQ '1'
     C           VDAT      ORGT BJRDNB
     C           WMATR     OREQ 'Y'
     C           AITC      ADD  AIAP      WOINT
     C                     ADD  AIMN      WOINT
     C                     SUB  IPRD      WOINT
     C                     SUB  ICTD      WOINT
     C                     SUB  IWOD      WOINT
      *
      ** ... if loan has gone past due, skip calculation of interest
      ** from IACD to MDAT
      *
     C           MDAT      WHLT IACD
     C           MDAT      ANDNE*ZEROS
     C           WLIVE     ANDEQ'Y'
     C           AIAP      ADD  AIMN      WOINT
     C                     ADD  PDIN      WOINT
     C                     SUB  IPRD      WOINT
     C                     SUB  ICTD      WOINT
     C                     SUB  IWOD      WOINT
      *
      ** ... not any of the above, calculate interest from control date
      ** to rundate, round down interest if required
      *
     C                     OTHER
     C           AITC      ADD  AIAP      WOINT
     C                     ADD  AIMN      WOINT
     C                     SUB  IWOD      WOINT                           142406
     C                     SUB  ICTD      WOINT                           142406
     C                     SUB  IPRD      WOINT                           142406
     C           CPAM      IFEQ *ZEROS
     C                     Z-ADD*ZEROS    ZINTR
     C                     ELSE
     C                     Z-ADDIACD      ZIBEG
     C           MDAT      IFNE *ZEROS
     C           BJRDNB    ANDGEMDAT
     C                     Z-ADDMDAT      ZIEND
     C                     ELSE
     C                     Z-ADDBJRDNB    ZIEND
     C                     ENDIF
      *
     C                     Z-ADDMDAT      ZMDAT
     C**********           EXSR ZFLDC                                                       BUG22764
     C**********           Z-ADDVDAT      ZVDAT                                               245082
     C                     Z-ADDMDAT      ZMDAT                                               245082
     C                     EXSR ZFLAC
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDCPAM      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,LE0191C001
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,LEH01405
     C                     ENDIF
      *
     C           RCSI      IFEQ 'Y'
     C                     ADD  ZINTR     WOINT
     C                     ELSE
     C                     ADD  ZINTR     WOINT     H
     C                     ENDIF
     C                     ENDSL
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE WOINT     ZFLD15
     C                     Z-ADDWNBDP     ZDECS
     C                     MOVE 'A'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SOINT
      *
      ** Interest paid to date
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE IPRD      ZFLD15
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SIPRD
      *
      ** Withholding tax
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE WTRT      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT20    SWTRT
     C                     MOVE WTIN      SWTIN
      *
      ** Margin and portfolio reference (if Portfolio Management is
      ** switched on)
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE MARG      ZFLD15
     C                     Z-ADD5         ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT21    SMARG
      *
     C           BGPFMG    IFEQ 'Y'
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C           PTFR      IFEQ '9997'
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C                     MOVELFCR997    SPTFR
     C                     ELSE
     C                     MOVELPTFR      SPTFR
     C                     ENDIF
     C                     ENDIF
      *
      ** Facility and discount amount (for discount parts sold)
      *
     C                     MOVE FCUS      SFCUS
     C                     MOVE WFACT     SFACT
     C           PTYP      IFEQ 67
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE TOTI      ZFLD15
     C                     Z-ADDWNBDP     ZDECS
     C                     MOVE 'A'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    STOTI
     C                     ENDIF
      *
      ** Account officer and alternative customer
      *
     C           ACOF      IFNE *BLANKS
     C                     CALL 'AOACOFR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM ACOF      PACOC   2
     C           SDACOF    PARM SDACOF    DSFDY
     C           PRTCD     IFNE *BLANKS
     C                     MOVEL'SDACOFPD'DBFILE           ************
     C                     Z-ADD8         DBASE            * DBERR 08 *
     C                     MOVELACOF      DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     MOVE ACOF      SACOF
     C                     MOVE AZACON    SACON
     C                     ENDIF
     C                     MOVE NACD      SNACD
      *
      ** Country of risk and billing indicator
      *
     C           CRSK      IFNE *BLANKS
     C                     CALL 'AOCTRYR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM CRSK      PCNCD   2
     C           SDCTRY    PARM SDCTRY    DSFDY
     C           PRTCD     IFNE *BLANKS
     C                     MOVEL'SDCTRYPD'DBFILE           ************
     C                     Z-ADD9         DBASE            * DBERR 09 *
     C                     MOVELCRSK      DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     MOVE CRSK      SCRSK
     C                     MOVE A4CNNM    SCNNM
     C                     ENDIF
     C                     MOVE BTIN      SBTIN
      *
      ** Industry and billing days
      *
     C********** LIND      IFNE *ZEROS                                                        CER020
     C**********           MOVE LIND      PLICD                                               CER020
     C           LOIC      IFNE *BLANKS                                                       CER020
     C                     MOVE LOIC      PLICD                                               CER020
     C                     CALL 'AOINDSR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM           PLICD   3
     C           SDINDS    PARM SDINDS    DSFDY
     C           PRTCD     IFNE *BLANKS
     C                     MOVEL'SDINDSPD'DBFILE           ************
     C                     Z-ADD10        DBASE            * DBERR 10 *
     C**********           MOVELLIND      DBKEY            ************                       CER020
     C                     MOVELLOIC      DBKEY                                               CER020
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C**********           MOVE LIND      SLIND                                               CER020
     C                     MOVE LOIC      SLIND                                               CER020
     C                     MOVE AOLINA    SLINA
     C                     ENDIF
     C                     MOVE BLDY      SBLDY
      *
      ** Profit centre, originating branch and FRB code
      *
     C           BKPRCU    IFEQ 'Y'
     C           PRFC      ANDNE*BLANKS
     C                     CALL 'AOPRFCR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY    'POPTN
     C                     PARM PRFC      PPCCD   4
     C           SDPRFC    PARM SDPRFC    DSFDY
     C           PRTCD     IFNE *BLANKS
     C                     MOVEL'SDPRFCPD'DBFILE           ************
     C                     Z-ADD11        DBASE            * DBERR 11 *
     C                     MOVELPRFC      DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     MOVE PRFC      SPRFC
     C                     MOVE DSPCDS    SPCDS
     C                     ENDIF
     C                     MOVE ORBR      SORBR
     C           FRBC      IFNE *ZEROS
     C                     MOVE FRBC      SFRBC
     C                     ENDIF
      *                                                                                       CAS001
      ** When CAS001 Enhancement is installed                                                 CAS001
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
     C                     MOVE FSYLDC    #1YLDC                                              CAS001
     C                     MOVE FSFYLD    #1FYLD                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
      *                                                                   CLE005
      ** Switch-on appropriate indicator for the additional               CLE005
      ** processing types.                                                CLE005
      *                                                                   CLE005
     C                     MOVEA'00'      *IN,19                          CLE005
      *                                                                   CLE005
     C                     SELEC                                          CLE005
     C           PTYP      WHEQ 69                                        CLE005
     C                     MOVE *ON       *IN19                           CLE005
     C                     MOVE *ON       *IN33                           CLE005
     C           PTYP      WHEQ 72                                        CLE005
     C                     MOVE *ON       *IN20                           CLE005
     C                     MOVE *ON       *IN33                           CLE005
     C                     ENDSL                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRSCR2  -  Format screen 2 fields                             *
      * Called by: SRDISP - Display details of each subfile record    *
      * Calls    : SRCURR - Get currency details                      *
      *            SRCUST - Get customer details                      *
      *****************************************************************
     C           SRSCR2    BEGSR
      *
     C                     Z-ADD*ZEROS    WRPDD  130
     C                     Z-ADD*ZEROS    WNINT  117
      *
      ** Rollover details
      ** ... rollover date, frequency and period
      *
     C           MCRA      IFEQ 'Y'
     C                     MOVE 'YES'     SMCRA
     C                     ELSE
     C                     MOVE 'NO '     SMCRA
     C                     ENDIF
      *
     C           RLDT      IFNE *ZEROS
     C                     Z-ADDRLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SRLDT
     C                     ENDIF
      *
     C           RLFQ      IFNE *BLANKS
     C           RLFQ      LOKUPTAB1      TABF           67
     C           *IN67     IFEQ '0'
     C           *LOCK     IN   LDA
     C                     MOVEL'TABF    'DBFILE           ************
     C                     Z-ADD12        DBASE            * DBERR 12 *
     C                     MOVELRLFQ      DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     MOVE TABF      SRLFQ
     C                     ENDIF
      *
     C           RLDY      IFNE *ZEROS
     C                     MOVELRLDY      SRLDY
     C                     MOVE ADEDT,RLDYSRLDY
     C           RLDY      IFLT 10
     C                     MOVEL' '       SRLDY
     C                     ENDIF
     C                     ENDIF
      *                                                                   CLE011
     C           CLE011    IFEQ 'Y'                                       CLE011
     C                     MOVE RFDY      SRFDY                           CLE011
     C                     MOVE RFRI      SRFRI                           CLE011
     C                     ENDIF                                          CLE011
      *
      ** ... new interest rate, base rate and basis
      *
     C           CLE011    IFEQ 'Y'                                       CLE011
     C           RFRI      ANDEQ'Y'                                       CLE011
      *                                                                   CLE011
     C                     MOVE *BLANKS   ZFLD15                          CLE011
     C                     MOVE RFRT      ZFLD15                          CLE011
     C                     Z-ADD7         ZDECS                           CLE011
     C                     EXSR ZFRPED                                    CLE011
      *                                                                   CLE011
     C                     MOVE ZOUT21    SNINT                           CLE011
      *                                                                   CLE011
     C                     ELSE                                           CLE011
      *                                                                   CLE011
     C           NBRA      IFNE *ZEROS
     C           CLE036    OREQ 'Y'                                                           CLE036
     C           NBSR      ANDNE*ZEROS                                                        CLE036
     C           NBRA      IFNE *ZEROS                                                        CLE036
     C                     MOVE NBRA      SNBRA
     C                     MOVE NBRA      PKEY2
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM CCY       PKEY1   3
     C                     PARM           PKEY2   2
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
     C           PRTCD     IFNE *BLANKS
     C                     MOVEL'SDBRSTPD'DBFILE           ************
     C                     Z-ADD13        DBASE            * DBERR 13 *
     C                     MOVELCCY       WTMP5   5        ************
     C                     MOVE NBRA      WTMP5
     C                     MOVELWTMP5     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     Z-ADDBANBRT    WNINT
     C           RLDT      IFLT BAVDNR
     C                     Z-ADDBRTE      WNINT
     C                     ENDIF
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           NBSR      IFNE *ZEROS                                                        CLE036
     C                     Z-ADDNBSR      WNINT                                               CLE036
     C                     MOVE *BLANKS   ZFLD15                                              CLE036
     C                     MOVE NBSR      ZFLD15                                              CLE036
     C                     Z-ADD7         ZDECS                                               CLE036
     C                     EXSR ZFRPED                                                        CLE036
     C                     MOVE ZOUT21    SNBSR                                               CLE036
     C                     ENDIF                                                              CLE036
     C                     SELEC
     C           NSIN      WHEQ 'A'
     C                     ADD  NRTS      WNINT
     C           NSIN      WHEQ 'S'
     C                     SUB  NRTS      WNINT
     C           NSIN      WHEQ 'P'
     C           NRTS      DIV  100       WTEMP  119
     C                     MULT WTEMP     WNINT     H
     C                     ENDSL
     C                     ENDIF
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE WNINT     ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT21    SNINT
     C           NCAS      IFNE *ZEROS
     C                     MOVE NCAS      SNCAS
     C                     ENDIF
      *                                                                   CLE011
     C                     ENDIF                                          CLE011
      *
      ** ... next rollover date, new principal and new discount amount
      *
     C           NROD      IFNE *ZEROS
     C                     Z-ADDNROD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SNROD
     C                     ENDIF
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE NPRAM     ZFLD15
     C                     Z-ADDWNBDP     ZDECS
     C                     MOVE 'A'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SNPAM
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE NDAM      ZFLD15
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SNDAM
      *
      ** Syndication
      *
     C           DFTP      IFNE *BLANKS
     C                     MOVE WDLTS     SDLTS
     C                     ENDIF
     C                     SELEC
     C           LNKS      WHEQ 'Y'
     C                     MOVE 'YES'     SLNKS
     C           LNKS      WHEQ 'N'
     C                     MOVE 'NO '     SLNKS
     C                     ENDSL
      *
      ** Repayment details
      ** ... repayment date, frequency and period
      *
     C           NRPD      IFNE *ZEROS
     C                     Z-ADDNRPD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SNRPD
     C                     ENDIF
      *
     C           RFRQ      IFNE *BLANKS
     C           RFRQ      LOKUPTAB1      TABF           67
     C           *IN67     IFEQ '0'
     C           *LOCK     IN   LDA
     C                     MOVEL'TABF    'DBFILE           ************
     C                     Z-ADD14        DBASE            * DBERR 14 *
     C                     MOVELRFRQ      DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     MOVE TABF      SRFRQ
     C                     ENDIF
      *
     C           RDYN      IFNE *ZEROS
     C                     MOVELRDYN      SRDYN
     C                     MOVE ADEDT,RDYNSRDYN
     C           RDYN      IFLT 10
     C                     MOVEL' '       SRDYN
     C                     ENDIF
     C                     ENDIF
      *
      ** ... loan currency repayment amount
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE RAMT      ZFLD15
     C                     Z-ADDWNBDP     ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT20    SRAMT
      *
      ** ... facility currency repayment amount
      *
     C                     MOVE CCY       PCURR
     C                     Z-ADD15        WDBSE
     C                     EXSR SRCURR
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE FCRA      ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT20    SFCRA
      *
      ** ... repayment type and auto-settle
      *
     C                     MOVE REPT      SREPT
     C           AUTO      IFEQ 'Y'
     C           AUTO      OREQ 'C'                                                           CLE134
     C           CLE134    ANDEQ'Y'                                                           CLE134
     C                     MOVE 'YES'     SAUTO
     C                     ELSE
     C                     MOVE 'NO '     SAUTO
     C                     ENDIF
      *
      ** ... check for the existence of a repayment schedule and
      ** accumulate repayments past due
      *
     C                     MOVE 'NO '     SRSCH
     C                     MOVE '0'       *IN26
     C           LNRF      SETLLLOAMS
     C           LNRF      READELOAMS                    67
     C           *IN67     DOWEQ'0'
     C           AMTP      IFEQ 'RE'
     C                     MOVE 'YES '    SRSCH
     C                     MOVE '1'       *IN26
     C                     ENDIF
     C           AMTP      IFEQ 'PD'
     C                     SELEC
     C           REPT      WHEQ 1
     C                     ADD  PRAM      WRPDD
     C           REPT      WHEQ 2
     C                     ADD  TAMT      WRPDD
     C                     ENDSL
     C                     ENDIF
     C           LNRF      READELOAMS                    67
     C                     ENDDO
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE WRPDD     ZFLD15
     C                     Z-ADDWNBDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT20    SRPPD
      *
      ** Base and facility currency equivalents
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE BCXR      ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT20    SBCXR
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE FCXR      ZFLD15
     C                     EXSR ZFRPED
     C                     MOVE ZOUT20    SFCXR
      *
      ** Fields for S01465: customer confirmation, auto pay at maturity
      ** and original maturity date
      *
     C           S01465    IFEQ 'Y'
     C********** COCU      IFNE *ZEROS                                                        CSD027
     C           COCU      IFNE *BLANKS                                                       CSD027
     C                     Z-ADD16        WDBSE
     C                     MOVELCOCU      PCUST
     C                     EXSR SRCUST
     C                     MOVE BBCSSN    SCOCU
     C                     ENDIF
      *
     C           APMI      IFEQ 'Y'
     C                     MOVE 'YES'     SAPMI
     C                     ELSE
     C                     MOVE 'NO '     SAPMI
     C                     ENDIF
     C           OMDT      IFNE *ZEROS
     C                     Z-ADDOMDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SOMDT
     C                     ENDIF
     C                     ENDIF
      *
      ** If guarantees issued is active, format receiver of guarantee
      *
     C           BPGIAV    IFEQ 'Y'
     C********** RECE      ANDNE*ZEROS                                                        CSD027
     C           RECE      ANDNE*BLANKS                                                       CSD027
     C                     Z-ADD17        WDBSE
     C                     MOVELRECE      PCUST
     C                     EXSR SRCUST
     C                     MOVE BBCSSN    SRECE
     C                     MOVE BBCRTN    SCRTN
     C                     ENDIF
      *
      ** Format type of generation: manual or system generated and
      ** if by assignment or principal transfer
      *
     C                     SELEC
     C           MNSG      WHEQ 'S'
     C                     MOVELANARR,10  SMNSG
     C           MNSG      WHEQ 'M'
     C                     MOVELANARR,11  SMNSG
     C                     ENDSL
     C                     SELEC
     C********** GASS      WHEQ 'Y'                                                           CLE106
     C           GASS      WHEQ 'A'                                                           CLE106
     C                     MOVELANARR,12  SGAPT
     C           GPRT      WHEQ 'Y'
     C                     MOVELANARR,13  SGAPT
     C                     ENDSL
      *
      ** Fields for CLE005: Payment due/taken days and grace days
      ** for principal and interest repayments
      *
     C           CLE005    IFEQ 'Y'
      *
     C                     SELEC
     C           PDDI      WHEQ 'A'
     C                     MOVELANARR,6   SPDDI
     C           PDDI      WHEQ 'P'
     C                     MOVELANARR,7   SPDDI
     C           PDDI      WHEQ 'N'
     C                     MOVELANARR,8   SPDDI
     C           PDDI      WHEQ 'M'                                       187270
     C                     MOVELANARR,9   SPDDI                           187270
     C                     ENDSL
      *
     C                     SELEC
     C           PTDI      WHEQ 'P'
     C                     MOVELANARR,7   SPTDI
     C           PTDI      WHEQ 'N'
     C                     MOVELANARR,8   SPTDI
     C           PTDI      WHEQ 'M'
     C                     MOVELANARR,9   SPTDI
     C                     ENDSL
      *
     C                     MOVE GDIN      SGDIN
     C                     MOVE GDPR      SGDPR
     C                     ENDIF
      *
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C                     MOVE *ON       *IN78                                               CLE034
      *                                                                                       CLE034
     C           STAL      IFEQ 'Y'                                                           CLE034
     C                     MOVEL'YES'     SSTAL                                               CLE034
     C                     ELSE                                                               CLE034
     C                     MOVEL'NO'      SSTAL                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C                     MOVE *OFF      *IN78                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRSCR3  -  Format screen 3 fields                             *
      * Called by: SRDISP - Display details of each subfile record    *
      * Calls    : None                                               *
      *****************************************************************
     C           SRSCR3    BEGSR
      *
      ** Loan narratives
      *
     C                     MOVE NAR1      SNAR1
     C                     MOVE NAR2      SNAR2
     C                     MOVE NAR3      SNAR3
     C                     MOVE NAR4      SNAR4
      *
      ** If S01518 is installed, settlement instructions are
      ** available through F14, otherwise format details here
      *
     C           S01518    IFEQ 'N'
     C           SDST      IFNE *ZEROS
     C                     MOVE SDST      SSDST
     C                     ENDIF
     C                     MOVE OSDA      SOSDA
     C                     MOVE OSDB      SOSDB
     C                     MOVE TSTN      STSTN
     C           MDST      IFNE *ZEROS
     C                     MOVE MDST      SMDST
     C                     ENDIF
     C                     MOVE OMDA      SOMDA
     C                     MOVE OMDB      SOMDB
     C                     MOVE TMAN      STMAN
     C                     MOVE FACO      SFACO
     C                     MOVE SPI1      SSPI1
     C                     MOVE SPI2      SSPI2
     C                     MOVE SPI3      SSPI3
     C                     ENDIF
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                                       CEU004
     C                     MOVE SCRY      SSCCY                           CEU004
     C                     MOVE ICCY      SICCY                           CEU004
     C                     ENDIF                                          CEU004
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRCUST  -  Get customer details                               *
      * Called by: SRSCR1 - Format screen 1 details                   *
      *            SRSCR2 - Format screen 2 details                   *
      * Calls    : None                                               *
      *****************************************************************
     C           SRCUST    BEGSR
      *
     C***********          CALL 'AOCUSTR0'                                CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM           PCUST  10
     C                     PARM *BLANKS   PKYST   7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
      *                                                                   CSD007
     C           PRTCD     IFNE *BLANKS
     C           CSD007    ANDNE'Y'                                       CSD007
      *                                                                   CSD007
     C           PRTCD     ORNE *BLANKS                                   CSD007
     C           PRTCD     ANDEQ'*NRF   '                                 CSD007
     C           BBDTDL    ANDNE*ZEROS                                    CSD007
     C           CSD007    ANDEQ'Y'                                       CSD007
      *                                                                   CSD007
     C           *LOCK     IN   LDA
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     Z-ADDWDBSE     DBASE            * DBERR XX *
     C                     MOVELPCUST     DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRDETL  -  Process detail screens                             *
      * Called by: SRDISP - Display details of each subfile record    *
      * Calls    : SRFEES - Call Fees Summary program                 *
      *            SRSETT - Call Extended Settlements program         *
      *            SRFUND - Call window program for Funding Info      *
      *            SRWIND - Call window manager                       *
      *****************************************************************
     C           SRDETL    BEGSR
      *
     C           WFMT      DOUEQ*BLANKS
      *
      ** Choose which screen to display
      *
     C                     MOVEA'000'     *IN,68
     C                     SELEC
     C           WFMT      WHEQ 'D1'
     C                     EXFMTLE0191F1
     C           WFMT      WHEQ 'D2'
     C                     EXFMTLE0191F2
     C           WFMT      WHEQ 'D3'
     C                     EXFMTLE0191F3
     C                     ENDSL
      *
      ** Perform different processing depending on command key pressed
      ** (1) F8, call Fee Summary program
      ** (2) F14, call Extended Settlement program
      ** (3) F19, call window program for Funding Info
      ** (4) Rollup, next screen
      ** (5) Rolldown, previuos screen
      ** (6) Exit this processing if ENTER, F3 or F12 is pressed
      *
     C                     SELEC
     C           *INKH     WHEQ '1'
     C                     EXSR SRFEES
     C           *INKN     WHEQ '1'
     C           S01518    ANDEQ'Y'
     C                     EXSR SRSETT
     C           *INKT     WHEQ '1'
     C           BGN0ST    ANDEQ'Y'
     C           BGWDPR    ANDEQ'Y'
     C           *INKT     OREQ '1'                                       CDE002
     C           CDE002    ANDEQ'Y'                                       CDE002
     C           BGWDPR    ANDEQ'Y'                                       CDE002
     C                     EXSR SRFUND
     C           *IN68     WHEQ '1'
     C                     MOVE 'D1'      WFMT
     C           *IN69     WHEQ '1'
     C                     MOVE 'D2'      WFMT
     C           *IN70     WHEQ '1'
     C                     MOVE 'D3'      WFMT
     C                     OTHER
     C                     MOVE *BLANK    WFMT
     C                     ENDSL
     C                     ENDDO
      *
      ** Do window processing, if required
      *
     C           BGWDPR    IFEQ 'Y'
     C           *INKL     ANDEQ'0'
     C           *INKC     ANDEQ'0'
      *
      /COPY WNCPYSRC,LE0191MOV1
      *
     C                     EXSR SRWIND
     C                     ENDIF
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRFEES  -  Call Fees Summary program                          *
      * Called by: SRDETL - Process detail screens                    *
      * Calls    : None                                               *
      *****************************************************************
     C           SRFEES    BEGSR
      *
     C                     MOVE BRCA      PBRCA
     C**********           Z-ADDCNUM      PCNUM                                               CSD027
     C                     MOVE CNUM      PCNUM                                               CSD027
     C                     Z-ADD*ZEROS    PFACY
     C**********           Z-ADDLNRF      PLNRF                                               CLE148
     C                     MOVELLNRF      PLNRF                                               CLE148
      *
     C                     CALL 'LER115'
     C                     PARM           PBRCA   3
     C**********           PARM           PCNUM   60                                          CSD027
     C                     PARM           PCNUM   6                                           CSD027
     C                     PARM           PFACY   50
     C**********           PARM           PLNRF   60                                          CLE148
     C                     PARM           PLNRF   6                                           CLE148
     C                     PARM *BLANK    PRTRN   1
      *
     C           *INU7     IFEQ '1'
     C           *INU8     ANDEQ'1'
     C                     EXSR *PSSR
     C                     ENDIF
     C           PRTRN     IFEQ 'X'
     C                     MOVE '1'       *INKC
     C                     MOVE *BLANKS   WFMT
     C                     ENDIF
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRSETT  -  Call Extended Settlements program                  *
      * Called by: SRDETL - Process detail screens                    *
      * Calls    : None                                               *
      *****************************************************************
     C           SRSETT    BEGSR
      *
      ** Move settlement details, then call SD2400
      *
     C                     CLEARPARM2
     C                     CLEARPARM3
     C                     MOVE 'E'       PMACTC
     C                     MOVE 'MMLD'    PMCPGM
     C                     MOVE 'Y'       PMPRCV
     C                     MOVE 'Y'       PMPPAY
     C                     MOVE 'Y'       PMSDTV
     C                     MOVE 'N'       PMVALO
     C                     MOVELCNUM      PMCSNM
     C                     MOVE LTYP      PMTTYP
     C                     MOVE BRCA      PMBRCA
     C                     MOVE CCY       PMRCCY
     C                     MOVE CCY       PMPCCY
     C                     Z-ADDRSTM      PMRSTM
     C                     MOVE RONS      PMRONS
     C                     MOVE RIBN      PARIBN
     C                     MOVE RIBA      PMRIBA
     C                     MOVE ROBN      PAROBN
     C                     MOVE ROCN      PAROCN
     C                     Z-ADDPSTM      PMPSTM
     C                     MOVE PONS      PMPONS
     C                     MOVE PIBN      PAPIBN
     C                     MOVE PIBA      PMPIBA
     C                     MOVE POBN      PAPOBN
     C                     MOVE POCN      PAPOCN
     C                     MOVE RCRN      PARCRN
     C                     MOVE RCRA      PMRCRA
     C                     MOVE RVNO      PARVNO
     C                     MOVE AWBN      PAAWBN
     C                     MOVE AWBA      PMAWBA
     C                     MOVE BENN      PABENN
     C                     MOVE BENA      PMBENA
     C                     MOVE DTP1      PMDTP1
     C                     MOVE DTP2      PMDTP2
     C                     MOVE DTP3      PMDTP3
     C                     MOVE DTP4      PMDTP4
     C                     MOVE DCHG      PMDCHG
     C                     MOVE BTB1      PMBTB1
     C                     MOVE BTB2      PMBTB2
     C                     MOVE BTB3      PMBTB3
     C                     MOVE BTB4      PMBTB4
     C                     MOVE BTB5      PMBTB5
     C                     MOVE BTB6      PMBTB6
     C                     MOVE CVMR      PMCVMR
     C                     MOVE SLNRF     PSLON
      *                                                                   CEU004
      ** If CEU004 is on Move Settlement Currency and 'In' Currency       CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                                       CEU004
     C                     MOVE SCRY      PMRSCY                          CEU004
     C                     MOVE SCRY      PMPSCY                          CEU004
     C                     MOVE ICCY      PMIC72                          CEU004
     C                     ENDIF                                          CEU004
      *                                                                                       CLE031
      ** If CLE031 is on, set-up settlement fields.                                           CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C                     MOVE *BLANKS   PMREXR                                              CLE031
     C           REXR      IFNE *ZERO                                                         CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE REXR      ZFIELD                                              CLE031
     C                     Z-ADD8         ZADEC                                               CLE031
     C                     EXSR ZEDIT                                                         CLE031
     C                     MOVE ZFIELD    PMREXR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   PMPEXR                                              CLE031
     C           PEXR      IFNE *ZERO                                                         CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE PEXR      ZFIELD                                              CLE031
     C                     Z-ADD8         ZADEC                                               CLE031
     C                     EXSR ZEDIT                                                         CLE031
     C                     MOVE ZFIELD    PMPEXR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE REXI      PMREXI                                              CLE031
     C                     MOVE PEXI      PMPEXI                                              CLE031
     C                     MOVE PSCY      PMPSCY                                              CLE031
     C                     ENDIF                                                              CLE031
      *
      ** Call the Set. Allocations Input if CLE034 is enabled and                             CLE034
      ** Set. Allocation = 'Y'. Call the Ext. Settlements otherwise.                          CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
      *                                                                                       CLE034
     C                     CALL 'LE2230'                                                      CLE034
     C                     PARM 'LOAN'    PTYPE   4                                           CLE034
     C                     PARM           PSLON                                               CLE034
     C                     PARM *BLANKS   PVDAT   5                                           CLE034
     C                     PARM *BLANKS   PLASQ   3                                           CLE034
     C                     PARM *BLANKS   PCNFE   6                                           CLE034
     C                     PARM *BLANKS   PFACL   5                                           CLE034
     C                     PARM *BLANKS   PFESQ   2                                           CLE034
     C                     PARM           PARM2                                               CLE034
     C                     PARM           PARM3                                               CLE034
     C                     PARM *BLANKS   PMODE   1                                           CLE034
     C                     PARM *BLANKS   PTMST  26                                           CLE034
     C                     PARM *BLANKS   PERR    1                                           CLE034
     C                     PARM *BLANKS   PWARN   1                                           CLE034
     C                     PARM *BLANKS   PSNOST  1                                           CLE034
     C                     PARM *BLANKS   PSAMD   1                                           CLE034
     C                     PARM *BLANKS   PNDET   1                                           CLE034
     C                     PARM *BLANKS   PRCCY  60                                           CLE034
     C                     PARM *BLANKS   PRLOC  60                                           CLE034
     C                     PARM *BLANKS   PPCCY  60                                           CLE034
     C                     PARM *BLANKS   PPLOC  60                                           CLE034
     C                     PARM *BLANKS   PPCRF  15                                           CLE034
     C                     PARM *BLANKS   WORED   5                                           CLE038
     C                     PARM *ZEROS    WALAM  130                                          CLE038
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C                     CALL 'SD2400'
     C                     PARM *BLANKS   PARM1   7
     C                     PARM           PARM2
     C                     PARM           PARM3
     C                     PARM           PSLON   6
     C                     PARM           P@ARM3                                              222373
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *
      ** Terminate program if database error returned
      *
     C           PMDBSE    IFNE *ZEROS
     C                     MOVELPMDBFL    DBFILE           ***********
     C                     MOVE PMDBSE    DBASE            DB ERROR XX
     C                     MOVELPMDBKY    DBKEY            ***********
     C                     MOVELPMDPGM    DBPGM
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ** If Cmd3 pressed, return to menu
      *
     C           PMCMDP    IFEQ '03'
     C                     MOVE '1'       *INKC
     C                     MOVE *BLANKS   WFMT
     C                     ENDIF
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRFUND  -  Call window program for Funding Info               *
      * Called by: SRDETL - Process detail screens                    *
      * Calls    : SRWIND - Call window manager                       *
      *****************************************************************
     C           SRFUND    BEGSR
      *
      ** Set up parameter then call window manager for Funding Info
      *
     C                     MOVE 'KT'      PWKEY
     C                     MOVE 'E'       PWACT
     C                     MOVE 'E'       WACTN
     C                     MOVE 'D'       WDSTS
     C                     Z-ADD*ZEROS    WELIR
     C                     MOVE PRFC      WPRFC
     C                     Z-ADDFSRP      WFSRP
     C                     MOVE FSGN      WFSGN
     C                     MOVE FPRC      WFPRC
     C                     MOVE CCY       WCCY
     C                     MOVE BJLCCY    WLCCY
     C                     MOVE 'N'       WRATF
     C                     MOVE 'N'       WFRC
     C                     MOVE *BLANKS   WTPRC
     C                     EXSR SRWIND
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRWIND  -  Call window manager                                *
      * Called by: SRFUND - Call window program for Funding Info      *
      *            SRDETL - Process detail screens                    *
      * Calls    : None                                               *
      *****************************************************************
     C           SRWIND    BEGSR
      *
      ** Call window manager
      *
     C                     CALL 'WN0010'
     C                     PARM 'LE0191  'PWPGM  10
     C                     PARM           PWKEY   2
     C                     PARM           PWACT   1
     C                     PARM           DATA
     C                     PARM *BLANKS   PWRTN   7
     C                     PARM           SPARE 256
      *
      **  Check return code
      *
     C                     SELEC
     C           PWRTN     WHEQ 'Y2U9999'
     C                     MOVE '1'       *INKC
     C                     MOVE *BLANKS   WFMT
     C           PWRTN     WHNE *BLANKS
     C                     MOVELPWRTN     ZAMSID
     C                     MOVEL'WNMSGF ' ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'LERMSGF' ZAMSGF
     C                     ENDSL
      *
      ** Initialise PWKEY so as not to call window twice.                 158288
      *                                                                   158288
     C                     MOVE *BLANKS   PWKEY                           158288
      *                                                                   158288
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRLOAD  -  Load subfile records                               *
      * Called by: SRSPRO - Subfile processing                        *
      * Calls    : None                                               *
      *****************************************************************
     C           SRLOAD    BEGSR
      *
      ** Clear subfile and program message queue
      *
     C                     MOVE '1'       *IN72
     C                     WRITELE0191C0
     C                     MOVEA'00'      *IN,71
     C                     Z-ADD*ZEROS    SRRN    40
     C                     Z-ADD1         SRNBR
      *
      ** Load all subfile records
      *
     C********** PLOAN     SETLLPSOLDF                                                        CSD027
     C********** PLOAN     READEPSOLDF                   77                                   CSD027
     C                     MOVE PLOAN     PLOANA  6                                           CSD027
     C           PLOANA    SETLLPSOLDF                                                        CSD027
     C           PLOANA    READEPSOLDF                   77                                   CSD027
     C           *IN77     DOWEQ'0'
      *
      ** Format fields
      *
      ** ... loan reference and value date
      *
     C                     MOVE *BLANK    SLSEL
     C                     MOVE BRCA      SSBRC
     C                     MOVE LNRF      SLNRF
      *                                                                   147830
      ** Identify Risk for SFL display                                    147830
      *                                                                   147830
     C           PTYP      IFEQ 72                                        147830
     C                     MOVE 'RISK'    SSRISK                          147830
     C                     ELSE                                           147830
     C                     MOVE *BLANKS   SSRISK                          147830
     C                     ENDIF                                          147830
      *                                                                   147830
     C                     Z-ADDMDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SSMDT
      *
      ** ... get loan currency decimal places then format amount
      *
     C                     Z-ADD18        WDBSE
     C                     MOVE CCY       PCURR
     C                     EXSR SRCURR
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE CPAM      ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZFRPED
     C                     MOVE ZOUT21    SSAMT
      *
      ** ... recourse indicator and if linked to syndicate
      *
     C           RCSI      IFEQ 'Y'
     C                     MOVE 'YES'     SSRCI
     C                     ELSE
     C                     MOVE 'NO '     SSRCI
     C                     ENDIF
      *
     C                     SELEC
     C           LNKS      WHEQ 'Y'
     C                     MOVE 'YES'     SSLNK
     C           LNKS      WHEQ 'N'
     C                     MOVE 'NO '     SSLNK
     C                     OTHER
     C                     MOVE *BLANKS   SSLNK
     C                     ENDSL
      *
      ** Write subfile record, and read next parts sold
      *
     C                     ADD  1         SRRN
     C                     WRITELE0191S0
     C********** PLOAN     READEPSOLDF                   77                                   CSD027
     C           PLOANA    READEPSOLDF                   77                                   CSD027
     C                     ENDDO
      *
      ** Write subfile header and footer
      *
     C           SRRN      IFEQ *ZEROS
     C                     MOVE '1'       *IN71
     C                     ENDIF
     C                     WRITELE0191F0
     C                     WRITELE0191F4
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRCURR  -  Retrieve currency details                          *
      * Called by: SRSPRO - Subfile processing                        *
      * Calls    : None                                               *
      *****************************************************************
     C           SRCURR    BEGSR
      *
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM           PCURR   3
     C           SDCURR    PARM SDCURR    DSSDY
     C           PRTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     Z-ADDWDBSE     DBASE            * DBERR XX *
     C                     MOVELPCURR     DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRINIT  -  Initial Processing                                 *
      * Called by: Main routine                                       *
      * Calls    : SRSARD - Retriecve SAR details                     *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      ** Set up copyright parameter
      *
     C                     MOVEACPY@      CPY2@  80
      *
      ** Receive entry parameters
      *
     C           *ENTRY    PLIST
     C**********           PARM           PLOAN   60                                          CLE148
     C                     PARM           PLOAN   6                                           CLE148
     C                     PARM           PLTYP   1
      *
      *                                                                   147830
      ** Key list for CLOAN                                               147830
      *                                                                   147830
     C           KLOAN     KLIST                                          147830
     C                     KFLD           KLNRF                           147830
     C                     KFLD           KRCDT                           147830
      *                                                                   147830
     C           *LIKE     DEFN LNRF      KLNRF                           147830
     C           *LIKE     DEFN RCDT      KRCDT                           147830
      *                                                                   147830
      ** For saving and restoring original cloan fields                   147830
      *                                                                   147830
     C           *LIKE     DEFN RECI      SVRECI                          147830
     C           *LIKE     DEFN LNRF      SVLNRF                          147830
     C           *LIKE     DEFN RCDT      SVRCDT                          147830
     C           *LIKE     DEFN MRIN      SVMRIN                          147830
     C           *LIKE     DEFN PTYP      SVPTYP                          147830
     C           *LIKE     DEFN CNUM      SVCNUM                          147830
     C           *LIKE     DEFN BRCA      SVBRCA                          147830
     C           *LIKE     DEFN LTYP      SVLTYP                          147830
     C           *LIKE     DEFN SUTP      SVSUTP                          147830
     C           *LIKE     DEFN CLAS      SVCLAS                                              CLE042
     C           *LIKE     DEFN DDAT      SVDDAT                          147830
     C           *LIKE     DEFN VDAT      SVVDAT                          147830
     C           *LIKE     DEFN MDAT      SVMDAT                          147830
     C           *LIKE     DEFN LASQ      SVLASQ                          147830
     C           *LIKE     DEFN FCUS      SVFCUS                          147830
     C           *LIKE     DEFN FTYP      SVFTYP                          147830
     C           *LIKE     DEFN FSEQ      SVFSEQ                          147830
     C           *LIKE     DEFN CCY       SVCCY                           147830
     C           *LIKE     DEFN CPAM      SVCPAM                          147830
     C           *LIKE     DEFN INTC      SVINTC                          147830
     C           *LIKE     DEFN INTR      SVINTR                          147830
     C           *LIKE     DEFN BRTT      SVBRTT                          147830
     C           *LIKE     DEFN BRTE      SVBRTE                          147830
     C           *LIKE     DEFN RTSP      SVRTSP                          147830
     C           *LIKE     DEFN MARG      SVMARG                          147830
     C           *LIKE     DEFN SPIN      SVSPIN                          147830
     C           *LIKE     DEFN CHIN      SVCHIN                          147830
     C           *LIKE     DEFN WTRT      SVWTRT                          147830
     C           *LIKE     DEFN WTIN      SVWTIN                          147830
     C           *LIKE     DEFN REPT      SVREPT                          147830
     C           *LIKE     DEFN RAMT      SVRAMT                          147830
     C           *LIKE     DEFN NRPD      SVNRPD                          147830
     C           *LIKE     DEFN RFRQ      SVRFRQ                          147830
     C           *LIKE     DEFN RDYN      SVRDYN                          147830
     C           *LIKE     DEFN FCCY      SVFCCY                          147830
     C********** *LIKE     DEFN LIND      SVLIND                                       147830 CER020
     C           *LIKE     DEFN LOIC      SVLOIC                                              CER020
     C           *LIKE     DEFN CRSK      SVCRSK                          147830
     C           *LIKE     DEFN ACOF      SVACOF                          147830
     C           *LIKE     DEFN NACD      SVNACD                          147830
     C           *LIKE     DEFN RELI      SVRELI                          147830
     C           *LIKE     DEFN AUTO      SVAUTO                          147830
     C           *LIKE     DEFN PSAM      SVPSAM                          147830
     C           *LIKE     DEFN BCXR      SVBCXR                          147830
     C           *LIKE     DEFN FCXR      SVFCXR                          147830
     C           *LIKE     DEFN SDST      SVSDST                          147830
     C           *LIKE     DEFN OSDA      SVOSDA                          147830
     C           *LIKE     DEFN TSTN      SVTSTN                          147830
     C           *LIKE     DEFN MDST      SVMDST                          147830
     C           *LIKE     DEFN OMDA      SVOMDA                          147830
     C           *LIKE     DEFN TMAN      SVTMAN                          147830
     C           *LIKE     DEFN FACO      SVFACO                          147830
     C           *LIKE     DEFN RLDT      SVRLDT                          147830
     C           *LIKE     DEFN RFDY      SVRFDY                          CLE011
     C           *LIKE     DEFN RFRI      SVRFRI                          CLE011
     C           *LIKE     DEFN RFRT      SVRFRT                          CLE011
     C           *LIKE     DEFN RFAR      SVRFAR                          CLE011
     C           *LIKE     DEFN NROD      SVNROD                          147830
     C           *LIKE     DEFN RLFQ      SVRLFQ                          147830
     C           *LIKE     DEFN RLDY      SVRLDY                          147830
     C           *LIKE     DEFN RDFC      SVRDFC                          147830
     C           *LIKE     DEFN NBRA      SVNBRA                          147830
     C           *LIKE     DEFN NRTS      SVNRTS                          147830
     C           *LIKE     DEFN NSIN      SVNSIN                          147830
     C           *LIKE     DEFN NCAS      SVNCAS                          147830
     C           *LIKE     DEFN AWTP      SVAWTP                          147830
     C           *LIKE     DEFN WTRD      SVWTRD                          147830
     C           *LIKE     DEFN WTWD      SVWTWD                          147830
     C           *LIKE     DEFN IWOD      SVIWOD                          147830
     C           *LIKE     DEFN PWOD      SVPWOD                          147830
     C           *LIKE     DEFN BMDI      SVBMDI                          147830
     C           *LIKE     DEFN FMDI      SVFMDI                          147830
     C           *LIKE     DEFN PDIN      SVPDIN                          147830
     C           *LIKE     DEFN LSWC      SVLSWC                          147830
     C           *LIKE     DEFN LSWS      SVLSWS                          147830
     C           *LIKE     DEFN OSDB      SVOSDB                          147830
     C           *LIKE     DEFN OMDB      SVOMDB                          147830
     C           *LIKE     DEFN ORBR      SVORBR                          147830
     C           *LIKE     DEFN PRFC      SVPRFC                          147830
     C           *LIKE     DEFN FCLB      SVFCLB                          147830
     C           *LIKE     DEFN MLNR      SVMLNR                          147830
     C           *LIKE     DEFN BTIN      SVBTIN                          147830
     C           *LIKE     DEFN BLDY      SVBLDY                          147830
     C           *LIKE     DEFN OLNO      SVOLNO                          147830
     C           *LIKE     DEFN RCSI      SVRCSI                          147830
     C           *LIKE     DEFN ICBS      SVICBS                          147830
     C           *LIKE     DEFN IPFR      SVIPFR                          147830
     C           *LIKE     DEFN TOTI      SVTOTI                          147830
     C           *LIKE     DEFN NIDT      SVNIDT                          147830
     C           *LIKE     DEFN IBDT      SVIBDT                          147830
     C           *LIKE     DEFN SLID      SVSLID                          147830
     C           *LIKE     DEFN AIPD      SVAIPD                          147830
     C           *LIKE     DEFN DLRC      SVDLRC                          147830
     C           *LIKE     DEFN IACD      SVIACD                          147830
     C           *LIKE     DEFN AITC      SVAITC                          147830
     C           *LIKE     DEFN TFEP      SVTFEP                          147830
     C           *LIKE     DEFN AIAP      SVAIAP                          147830
     C           *LIKE     DEFN IPRD      SVIPRD                          147830
     C           *LIKE     DEFN IPRM      SVIPRM                          147830
     C           *LIKE     DEFN ICTD      SVICTD                          147830
     C           *LIKE     DEFN AIMN      SVAIMN                          147830
     C           *LIKE     DEFN RBDT      SVRBDT                          147830
     C           *LIKE     DEFN NOPS      SVNOPS                          147830
     C           *LIKE     DEFN NCHI      SVNCHI                          147830
     C           *LIKE     DEFN IFDY      SVIFDY                          147830
     C           *LIKE     DEFN LONI      SVLONI                          147830
     C           *LIKE     DEFN CNFI      SVCNFI                          147830
     C           *LIKE     DEFN ACEI      SVACEI                          147830
     C           *LIKE     DEFN TLXI      SVTLXI                          147830
     C           *LIKE     DEFN CBLI      SVCBLI                          147830
     C           *LIKE     DEFN ORED      SVORED                          147830
     C           *LIKE     DEFN LCD       SVLCD                           147830
     C           *LIKE     DEFN CHTP      SVCHTP                          147830
     C           *LIKE     DEFN TNLU      SVTNLU                          147830
     C           *LIKE     DEFN ADDI      SVADDI                          147830
     C           *LIKE     DEFN ORMD      SVORMD                          147830
     C           *LIKE     DEFN ORTI      SVORTI                          147830
     C           *LIKE     DEFN BOKC      SVBOKC                          147830
     C           *LIKE     DEFN COCU      SVCOCU                          147830
     C           *LIKE     DEFN RECE      SVRECE                          147830
     C           *LIKE     DEFN OMDT      SVOMDT                          147830
     C           *LIKE     DEFN NIPD      SVNIPD                          147830
     C           *LIKE     DEFN NMDT      SVNMDT                          147830
     C           *LIKE     DEFN APMI      SVAPMI                          147830
     C           *LIKE     DEFN RSTM      SVRSTM                          147830
     C           *LIKE     DEFN RONS      SVRONS                          147830
     C           *LIKE     DEFN RIBN      SVRIBN                          147830
     C           *LIKE     DEFN RIBA      SVRIBA                          147830
     C           *LIKE     DEFN ROBN      SVROBN                          147830
     C           *LIKE     DEFN ROCN      SVROCN                          147830
     C           *LIKE     DEFN PSTM      SVPSTM                          147830
     C           *LIKE     DEFN PONS      SVPONS                          147830
     C           *LIKE     DEFN PIBN      SVPIBN                          147830
     C           *LIKE     DEFN PIBA      SVPIBA                          147830
     C           *LIKE     DEFN POBN      SVPOBN                          147830
     C           *LIKE     DEFN POCN      SVPOCN                          147830
     C           *LIKE     DEFN RCRN      SVRCRN                          147830
     C           *LIKE     DEFN RCRA      SVRCRA                          147830
     C           *LIKE     DEFN RVNO      SVRVNO                          147830
     C           *LIKE     DEFN AWBN      SVAWBN                          147830
     C           *LIKE     DEFN AWBA      SVAWBA                          147830
     C           *LIKE     DEFN BENN      SVBENN                          147830
     C           *LIKE     DEFN BENA      SVBENA                          147830
     C           *LIKE     DEFN DTP1      SVDTP1                          147830
     C           *LIKE     DEFN DTP2      SVDTP2                          147830
     C           *LIKE     DEFN DTP3      SVDTP3                          147830
     C           *LIKE     DEFN DTP4      SVDTP4                          147830
     C           *LIKE     DEFN DCHG      SVDCHG                          147830
     C           *LIKE     DEFN BTB1      SVBTB1                          147830
     C           *LIKE     DEFN BTB2      SVBTB2                          147830
     C           *LIKE     DEFN BTB3      SVBTB3                          147830
     C           *LIKE     DEFN BTB4      SVBTB4                          147830
     C           *LIKE     DEFN BTB5      SVBTB5                          147830
     C           *LIKE     DEFN BTB6      SVBTB6                          147830
     C           *LIKE     DEFN CVMR      SVCVMR                          147830
     C           *LIKE     DEFN PTFR      SVPTFR                          147830
     C           *LIKE     DEFN HLEX      SVHLEX                          147830
     C           *LIKE     DEFN FSRP      SVFSRP                          147830
     C           *LIKE     DEFN FSGN      SVFSGN                          147830
     C           *LIKE     DEFN FPRC      SVFPRC                          147830
     C           *LIKE     DEFN TCOF      SVTCOF                          147830
     C           *LIKE     DEFN ACPD      SVACPD                          147830
     C           *LIKE     DEFN ACDA      SVACDA                          147830
     C           *LIKE     DEFN ACAJ      SVACAJ                          147830
     C           *LIKE     DEFN ACAP      SVACAP                          147830
     C           *LIKE     DEFN COFD      SVCOFD                          147830
     C           *LIKE     DEFN COFM      SVCOFM                          147830
     C           *LIKE     DEFN CFCD      SVCFCD                          147830
     C           *LIKE     DEFN NFRS      SVNFRS                          147830
     C           *LIKE     DEFN NFSN      SVNFSN                          147830
     C           *LIKE     DEFN NFPC      SVNFPC                          147830
     C           *LIKE     DEFN PDCF      SVPDCF                          147830
     C           *LIKE     DEFN FCTD      SVFCTD                          147830
     C           *LIKE     DEFN FWOD      SVFWOD                          147830
     C           *LIKE     DEFN DFTP      SVDFTP                          147830
     C           *LIKE     DEFN DFST      SVDFST                          147830
     C           *LIKE     DEFN DFCL      SVDFCL                                              CLE042
     C           *LIKE     DEFN MCRA      SVMCRA                          147830
     C           *LIKE     DEFN FCRA      SVFCRA                          147830
     C           *LIKE     DEFN PDDI      SVPDDI                          147830
     C           *LIKE     DEFN PTDI      SVPTDI                          147830
     C           *LIKE     DEFN GDPR      SVGDPR                          147830
     C           *LIKE     DEFN GDIN      SVGDIN                          147830
     C           *LIKE     DEFN LNKS      SVLNKS                          147830
     C           *LIKE     DEFN MNSG      SVMNSG                          147830
     C           *LIKE     DEFN GASS      SVGASS                          147830
     C           *LIKE     DEFN GPRT      SVGPRT                          147830
     C           *LIKE     DEFN TOLN      SVTOLN                          147830
     C           *LIKE     DEFN LSTS      SVLSTS                          147830
     C           *LIKE     DEFN IUSR      SVIUSR                          147830
     C           *LIKE     DEFN AUSR      SVAUSR                          147830
     C           *LIKE     DEFN XUSR      SVXUSR                          147830
     C           *LIKE     DEFN RATF      SVRATF                          147830
     C           *LIKE     DEFN CNCF      SVCNCF                          147830
     C           *LIKE     DEFN PCRF      SVPCRF                          147830
     C           *LIKE     DEFN LPFI      SVLPFI                          147830
     C           *LIKE     DEFN PTFC      SVPTFC                          147830
     C           *LIKE     DEFN PTFT      SVPTFT                          147830
     C           *LIKE     DEFN PTFN      SVPTFN                          147830
     C           *LIKE     DEFN PCOB      SVPCOB                          147830
     C           *LIKE     DEFN LRLD      SVLRLD                          147830
     C           *LIKE     DEFN LMCD      SVLMCD                          147830
     C           *LIKE     DEFN OIDT      SVOIDT                          147830
      *                                                                   147830
     C           *LIKE     DEFN CNUM      SVCUNM                          147830
     C           *LIKE     DEFN BASR      SVBASR                                              CLE036
     C           *LIKE     DEFN NBSR      SVNBSR                                              CLE036
      *                                                                                       CAS001
      ** When CAS001 enhancement is installed                                                 CAS001
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
     C           *LIKE     DEFN FSYLDC    SVYLDC                                              CAS001
     C           *LIKE     DEFN FSFYLD    SVFYLD                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                   147830
      ** Key list for CLOAN
      *
     C           WKLON     KLIST
     C**********           KFLD           WLNRF   60                                          CLE148
     C                     KFLD           WLNRF   6                                           CLE148
     C                     KFLD           WRCDT   1
      *
      ** Define data areas
      *
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVEL'LE0191'  DBPGM
     C                     OUT  LDA
      *
      ** Retrieve bank details
      *
     C                     CALL 'AOBANKR0'
     C                     PARM '*DBERR ' PRTCD   7
     C                     PARM '*FIRST ' POPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C           BJDFIN    IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     ENDIF
      *
      ** Retrieve midas modules details
      *
     C                     CALL 'AOMMODR0'
     C                     PARM '*DBERR ' PRTCD
     C                     PARM '*FIRST ' POPTN
     C           SDMMOD    PARM SDMMOD    DSFDY
      *
      ** Retrieve general ledger details
      *
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' PRTCD
     C                     PARM '*FIRST ' POPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *
      ** Check if profit centre is being used, if branch fields
      ** should be displayed, and if originating branch is being used
      *
     C           BKPRCU    IFEQ 'Y'
     C                     MOVE '1'       WIN29   1
     C                     ENDIF
     C           BGMBIN    IFEQ 'Y'
     C                     MOVE '1'       WIN31   1
     C           BKOBRU    IFEQ 'Y'
     C                     MOVE '1'       WIN30   1
     C                     ENDIF
     C                     ENDIF
      *
      ** Retrieve customer lending details
      ** Determine if guarantees issued is active
      *
     C                     CALL 'AOCLNDR0'
     C                     PARM '*DBERR ' PRTCD
     C                     PARM '*FIRST ' POPTN
     C********** SDCLND    PARM SDCLND    DSFDY                                               CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C           BPGIAV    IFEQ 'Y'
     C                     MOVE '1'       WIN25   1
     C                     ENDIF
      *                                                                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C                     MOVE '1'       WIN28                           CPB001
     C                     ENDIF                                          CPB001
      *
      ** Access PM ICD File if Portfolio Management is switched on
      *
     C           BGPFMG    IFEQ 'Y'
     C                     MOVE '1'       WIN28   1
     C                     CALL 'AOPORTR0'
     C                     PARM '*DBERR ' PRTCD
     C                     PARM '*FIRST'  POPTN
     C           SDPORT    PARM SDPORT    DSFDY
     C                     ENDIF
      *
      ** Determine if BLI Lending Enhancements is installed
      *
     C                     Z-ADD1         WDBSE   30
     C                     MOVE 'S01465'  PSARD
     C                     EXSR SRSARD
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       S01465
     C                     MOVE '1'       WIN24   1
     C                     ELSE
     C                     MOVE 'N'       S01465  1
     C                     ENDIF
      *
      ** Determine if Lending-Swift Enhancement is installed
      *
     C                     Z-ADD2         WDBSE
     C                     MOVE 'S01518'  PSARD
     C                     EXSR SRSARD
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       S01518
     C                     MOVE '1'       WIN27   1
     C                     ELSE
     C                     MOVE 'N'       S01518  1
     C                     ENDIF
      *
      ** Determine if Lending Enhancement - Others is installed
      *
     C                     Z-ADD3         WDBSE
     C                     MOVE 'CLE005'  PSARD
     C                     EXSR SRSARD
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CLE005
     C                     MOVE '1'       WIN34   1
     C                     ELSE
     C                     MOVE 'N'       CLE005  1
     C                     ENDIF
      *                                                                   187261
      ** Determine if Syndicated Lending is installed                     187261
      *                                                                   187261
     C                     Z-ADD25        WDBSE                           187261
     C                     MOVE 'CLE006'  PSARD                           187261
     C                     EXSR SRSARD                                    187261
     C           PRTCD     IFEQ *BLANKS                                   187261
     C                     MOVE 'Y'       CLE006                          187261
     C                     MOVE *ON       *IN15                           187261
     C                     ELSE                                           187261
     C                     MOVE 'N'       CLE006  1                       187261
     C                     MOVE *OFF      *IN15                           187261
     C                     ENDIF                                          187261
      *                                                                   CEU004
      **  Access Switchable SAR details for the existence of CEU004       CEU004
      *                                                                   CEU004
     C                     Z-ADD4         WDBSE                           CEU004
     C                     MOVE 'CEU004'  PSARD                           CEU004
     C                     EXSR SRSARD                                    CEU004
     C           PRTCD     IFEQ *BLANKS                                   CEU004
     C                     MOVE 'Y'       CEU004                          CEU004
     C                     MOVE '1'       WIN35   1                       CEU004
     C                     ELSE                                           CEU004
     C                     MOVE 'N'       CEU004  1                       CEU004
     C                     ENDIF                                          CEU004
      *                                                                   CDE002
      ** Access SAR details file to determine if CDE002 is switched on    CDE002
      *                                                                   CDE002
     C                     MOVEL'CDE002'  PSARD                           CDE002
     C                     EXSR SRSARD                                    CDE002
     C           PRTCD     IFEQ *BLANKS                                   CDE002
     C                     MOVE 'Y'       CDE002                          CDE002
     C                     ELSE                                           CDE002
     C                     MOVE 'N'       CDE002  1                       CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CSD007
      ** Access SAR detail file to check if 'Customer closing' is         CSD007
      ** installed.                                                       CSD007
      *                                                                   CSD007
     C                     Z-ADD5         WDBSE                           CSD007
     C                     MOVE 'CSD007'  PSARD                           CSD007
     C                     EXSR SRSARD                                    CSD007
     C           PRTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007  1                       CSD007
     C                     ELSE                                           CSD007
     C                     MOVE 'N'       CSD007                          CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CLE011
      **  Access Switchable SAR details for the existence of CLE011       CLE011
      *                                                                   CLE011
     C                     Z-ADD19        WDBSE                           CLE011
     C                     MOVE 'CLE011'  PSARD                           CLE011
     C                     EXSR SRSARD                                    CLE011
     C           PRTCD     IFEQ *BLANKS                                   CLE011
     C                     MOVE 'Y'       CLE011  1                       CLE011
     C                     MOVE *ON       *IN40                           CLE011
     C                     ELSE                                           CLE011
     C                     MOVE 'N'       CLE011                          CLE011
     C                     MOVE *OFF      *IN40                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                                       CAS001
      **  Access Switchable SAR details for the existence of CAS001                           CAS001
      *                                                                                       CAS001
     C                     Z-ADD26        WDBSE                                               CAS001
     C                     MOVE 'CAS001'  PSARD                                               CAS001
     C                     EXSR SRSARD                                                        CAS001
     C           PRTCD     IFEQ *BLANKS                                                       CAS001
     C                     MOVE 'Y'       CAS001  1                                           CAS001
     C                     MOVE *OFF      *IN81                                               CAS001
     C                     ELSE                                                               CAS001
     C                     MOVE 'N'       CAS001                                              CAS001
     C                     MOVE *ON       *IN81                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CLE031
      **  Check if CLE031 is installed.                                                       CLE031
      *                                                                                       CLE031
     C                     Z-ADD27        WDBSE                                               CLE031
     C                     MOVE 'CLE031'  PSARD                                               CLE031
     C                     EXSR SRSARD                                                        CLE031
     C           PRTCD     IFEQ *BLANKS                                                       CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE034
      **  Check if CLE034 is installed.                                                       CLE034
      *                                                                                       CLE034
     C                     Z-ADD28        WDBSE                                               CLE034
     C                     MOVE 'CLE034'  PSARD                                               CLE034
     C                     EXSR SRSARD                                                        CLE034
     C           PRTCD     IFEQ *BLANKS                                                       CLE034
     C                     MOVE 'Y'       CLE034  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'N'       CLE034                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE036
      ** Check if CLE036 is installed                                                         CLE036
      *                                                                                       CLE036
     C                     Z-ADD29        WDBSE                                               CLE036
     C                     MOVE 'CLE036'  PSARD                                               CLE036
     C                     EXSR SRSARD                                                        CLE036
     C           PRTCD     IFEQ *BLANKS                                                       CLE036
     C                     MOVE 'Y'       CLE036  1                                           CLE036
     C                     MOVE *ON       *IN66                                               CLE036
     C                     ELSE                                                               CLE036
     C                     MOVE 'N'       CLE036                                              CLE036
     C                     MOVE *OFF      *IN66                                               CLE036
     C                     ENDIF                                                              CLE036
      *
      ** Set up message file for screen error messages
      ** Set up fields for screen heading
      *
     C                     MOVEL'LERMSGF 'ZAMSGF
     C                     MOVE USER      SUSER
     C                     MOVE WSID      SWSID
     C                     MOVE BJMRDT    SRUNA
      *
     C                     MOVEA'00'      *IN,22
     C                     MOVE '0'       *IN36                           157508
     C           PLTYP     IFEQ 'L'
     C                     MOVE '1'       *IN22
     C                     MOVE PLOAN     SLOAN
     C                     ELSE
     C           PLTYP     IFNE 'G'                                       157508
     C                     MOVE '1'       *IN23
     C                     MOVE PLOAN     SOLNO
     C                     ELSE                                           157508
     C                     MOVE '1'       *IN36                           157508
     C                     MOVE PLOAN     SGUAR                           157508
     C                     ENDIF
     C                     ENDIF                                          157508
      *
     C                     MOVE '0'       *IN21                           CEU004
     C********** PLTYP     IFEQ 'L'                                                    CEU004 245251
     C**********           MOVE '1'       *IN22                                        CEU004 245251
     C**********           MOVE PLOAN     SLOAN                                        CEU004 245251
     C**********           ELSE                                                        CEU004 245251
     C**********           MOVE '1'       *IN23                                        CEU004 245251
     C**********           MOVE PLOAN     SOLNO                                        CEU004 245251
     C**********           ENDIF                                                       CEU004 245251
     C                     ENDSR
      /EJECT
      *****************************************************************
      * SRSARD  -  Retrieve SAR details
      * Called by: SRINIT - Initial processing                        *
      * Calls    : None                                               *
      *****************************************************************
     C           SRSARD    BEGSR
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY   ' POPTN
     C                     PARM           PSARD   6
     C           SCSARD    PARM SCSARD    DSFDY
     C           PRTCD     IFNE *BLANKS
     C           PRTCD     ANDNE'*NRF    '
     C           *LOCK     IN   LDA
     C                     MOVEL'SCSARDPD'DBFILE           ************
     C                     Z-ADDWDBSE     DBASE            * DBERR XX *
     C                     MOVELPSARD     DBKEY            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *                                                                                       CLE134
      * CLE134 - Past Due Call Loans                                                          CLE134
     C                     CALL 'AOSARDR0'                                                    CLE134
     C                     PARM *BLANKS   PRTCD   7                                           CLE134
     C                     PARM '*VERIFY' POPTN   7                                           CLE134
     C                     PARM 'CLE134'  PSARD   6                                           CLE134
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE134
      *                                                                                       CLE134
     C                     MOVE 'N'       CLE134  1                                           CLE134
     C           PRTCD     IFEQ *BLANKS                                                       CLE134
     C                     MOVE 'Y'       CLE134                                              CLE134
     C                     ENDIF                                                              CLE134
      *
      ** Check if the CER020 Feature is installed                                             CER020
      *                                                                                       CER020
     C                     CALL 'AOSARDR0'                                                    CER020
     C                     PARM *BLANKS   PRTCD                                               CER020
     C                     PARM '*VERIFY' POPTN                                               CER020
     C                     PARM 'CER020'  PSARD                                               CER020
     C           SCSARD    PARM SCSARD    DSFDY                                               CER020
      *                                                                                       CER020
     C           PRTCD     IFEQ *BLANKS                                                       CER020
      *                                                                                       CER020
     C                     MOVE 'Y'       CER020  1                                           CER020
     C                     MOVE *ON       *IN92                                               CER020
     C                     ELSE                                                               CER020
      *                                                                                       CER020
     C                     MOVE 'N'       CER020                                              CER020
     C                     MOVE *OFF      *IN92                                               CER020
      *                                                                                       CER020
     C                     ENDIF                                                              CER020
     C/COPY WNCPYSRC,LEH01297
      *                                                                                       CER020
     C                     ENDSR
      ********************************************************************147830
      *                                                                  *147830
      *    SFLDS - STORE ORIGINAL CLOAN FLDS                             *147830
      *                                                                  *147830
      *    CALLED BY: S/R SETUP                                          *147830
      *                                                                  *147830
      *    CALLS:                                                        *147830
      *                                                                  *147830
      ********************************************************************147830
      *                                                                   147830
     C           SFLDS     BEGSR                                          147830
      *                                                                   147830
     C                     MOVE RECI      SVRECI                          147830
     C**********           Z-ADDLNRF      SVLNRF                                       147830 CLE148
     C                     MOVELLNRF      SVLNRF                                              CLE148
     C                     MOVE RCDT      SVRCDT                          147830
     C                     Z-ADDMRIN      SVMRIN                          147830
     C                     Z-ADDPTYP      SVPTYP                          147830
     C**********           Z-ADDCNUM      SVCNUM                                       147830 CSD027
     C                     MOVE CNUM      SVCNUM                                              CSD027
     C                     MOVE BRCA      SVBRCA                          147830
     C                     MOVE LTYP      SVLTYP                          147830
     C                     MOVE SUTP      SVSUTP                          147830
     C                     MOVE CLAS      SVCLAS                                              CLE042
     C                     Z-ADDDDAT      SVDDAT                          147830
     C                     Z-ADDVDAT      SVVDAT                          147830
     C                     Z-ADDMDAT      SVMDAT                          147830
     C                     Z-ADDLASQ      SVLASQ                          147830
     C**********           Z-ADDFCUS      SVFCUS                                       147830 CSD027
     C                     MOVE FCUS      SVFCUS                                              CSD027
     C                     Z-ADDFTYP      SVFTYP                          147830
     C                     Z-ADDFSEQ      SVFSEQ                          147830
     C                     MOVE CCY       SVCCY                           147830
     C                     Z-ADDCPAM      SVCPAM                          147830
     C                     MOVE INTC      SVINTC                          147830
     C                     Z-ADDINTR      SVINTR                          147830
     C                     Z-ADDBRTT      SVBRTT                          147830
     C                     Z-ADDBRTE      SVBRTE                          147830
     C                     Z-ADDRTSP      SVRTSP                          147830
     C                     Z-ADDMARG      SVMARG                          147830
     C                     MOVE SPIN      SVSPIN                          147830
     C                     MOVE CHIN      SVCHIN                          147830
     C                     Z-ADDWTRT      SVWTRT                          147830
     C                     MOVE WTIN      SVWTIN                          147830
     C                     Z-ADDREPT      SVREPT                          147830
     C                     Z-ADDRAMT      SVRAMT                          147830
     C                     Z-ADDNRPD      SVNRPD                          147830
     C                     MOVE RFRQ      SVRFRQ                          147830
     C                     Z-ADDRDYN      SVRDYN                          147830
     C                     MOVE FCCY      SVFCCY                          147830
     C**********           Z-ADDLIND      SVLIND                                       147830 CER020
     C                     MOVE LOIC      SVLOIC                                              CER020
     C                     MOVE CRSK      SVCRSK                          147830
     C                     MOVE ACOF      SVACOF                          147830
     C                     MOVE NACD      SVNACD                          147830
     C                     MOVE RELI      SVRELI                          147830
     C                     MOVE AUTO      SVAUTO                          147830
     C                     Z-ADDPSAM      SVPSAM                          147830
     C                     Z-ADDBCXR      SVBCXR                          147830
     C                     Z-ADDFCXR      SVFCXR                          147830
     C                     Z-ADDSDST      SVSDST                          147830
     C                     MOVE OSDA      SVOSDA                          147830
     C                     MOVE TSTN      SVTSTN                          147830
     C                     Z-ADDMDST      SVMDST                          147830
     C                     MOVE OMDA      SVOMDA                          147830
     C                     MOVE TMAN      SVTMAN                          147830
     C                     MOVE FACO      SVFACO                          147830
     C                     Z-ADDRLDT      SVRLDT                          147830
     C                     MOVE RFDY      SVRFDY                          CLE011
     C                     MOVE RFRI      SVRFRI                          CLE011
     C                     MOVE RFAR      SVRFAR                          CLE011
     C                     Z-ADDRFRT      SVRFRT                          CLE011
     C                     Z-ADDNROD      SVNROD                          147830
     C                     MOVE RLFQ      SVRLFQ                          147830
     C                     Z-ADDRLDY      SVRLDY                          147830
     C                     MOVE RDFC      SVRDFC                          147830
     C                     Z-ADDNBRA      SVNBRA                          147830
     C                     Z-ADDNRTS      SVNRTS                          147830
     C                     MOVE NSIN      SVNSIN                          147830
     C                     Z-ADDNCAS      SVNCAS                          147830
     C                     Z-ADDAWTP      SVAWTP                          147830
     C                     Z-ADDWTRD      SVWTRD                          147830
     C                     Z-ADDWTWD      SVWTWD                          147830
     C                     Z-ADDIWOD      SVIWOD                          147830
     C                     Z-ADDPWOD      SVPWOD                          147830
     C                     MOVE BMDI      SVBMDI                          147830
     C                     MOVE FMDI      SVFMDI                          147830
     C                     Z-ADDPDIN      SVPDIN                          147830
     C                     Z-ADDLSWC      SVLSWC                          147830
     C                     Z-ADDLSWS      SVLSWS                          147830
     C                     MOVE OSDB      SVOSDB                          147830
     C                     MOVE OMDB      SVOMDB                          147830
     C                     MOVE ORBR      SVORBR                          147830
     C                     MOVE PRFC      SVPRFC                          147830
     C                     MOVE FCLB      SVFCLB                          147830
     C**********           Z-ADDMLNR      SVMLNR                                       147830 CLE148
     C                     MOVELMLNR      SVMLNR                                              CLE148
     C                     MOVE BTIN      SVBTIN                          147830
     C                     Z-ADDBLDY      SVBLDY                          147830
     C**********           Z-ADDOLNO      SVOLNO                                       147830 CSD027
     C                     MOVE OLNO      SVOLNO                                              CSD027
     C                     MOVE RCSI      SVRCSI                          147830
     C                     Z-ADDICBS      SVICBS                          147830
     C                     MOVE IPFR      SVIPFR                          147830
     C                     Z-ADDTOTI      SVTOTI                          147830
     C                     Z-ADDNIDT      SVNIDT                          147830
     C                     Z-ADDIBDT      SVIBDT                          147830
     C                     Z-ADDSLID      SVSLID                          147830
     C                     Z-ADDAIPD      SVAIPD                          147830
     C                     Z-ADDDLRC      SVDLRC                          147830
     C                     Z-ADDIACD      SVIACD                          147830
     C                     Z-ADDAITC      SVAITC                          147830
     C                     Z-ADDTFEP      SVTFEP                          147830
     C                     Z-ADDAIAP      SVAIAP                          147830
     C                     Z-ADDIPRD      SVIPRD                          147830
     C                     Z-ADDIPRM      SVIPRM                          147830
     C                     Z-ADDICTD      SVICTD                          147830
     C                     Z-ADDAIMN      SVAIMN                          147830
     C                     Z-ADDRBDT      SVRBDT                          147830
     C                     Z-ADDNOPS      SVNOPS                          147830
     C                     MOVE NCHI      SVNCHI                          147830
     C                     Z-ADDIFDY      SVIFDY                          147830
     C                     MOVE LONI      SVLONI                          147830
     C                     MOVE CNFI      SVCNFI                          147830
     C                     MOVE ACEI      SVACEI                          147830
     C                     MOVE TLXI      SVTLXI                          147830
     C                     MOVE CBLI      SVCBLI                          147830
     C                     Z-ADDORED      SVORED                          147830
     C                     Z-ADDLCD       SVLCD                           147830
     C                     MOVE CHTP      SVCHTP                          147830
     C                     Z-ADDTNLU      SVTNLU                          147830
     C                     MOVE ADDI      SVADDI                          147830
     C                     Z-ADDORMD      SVORMD                          147830
     C                     Z-ADDORTI      SVORTI                          147830
     C                     MOVE BOKC      SVBOKC                          147830
     C**********           Z-ADDCOCU      SVCOCU                                       147830 CSD027
     C**********           Z-ADDRECE      SVRECE                                       147830 CSD027
     C                     MOVE COCU      SVCOCU                                              CSD027
     C                     MOVE RECE      SVRECE                                              CSD027
     C                     Z-ADDOMDT      SVOMDT                          147830
     C                     Z-ADDNIPD      SVNIPD                          147830
     C                     Z-ADDNMDT      SVNMDT                          147830
     C                     MOVE APMI      SVAPMI                          147830
     C                     Z-ADDRSTM      SVRSTM                          147830
     C                     MOVE RONS      SVRONS                          147830
     C                     MOVE RIBN      SVRIBN                          147830
     C                     MOVE RIBA      SVRIBA                          147830
     C**********           Z-ADDROBN      SVROBN                                       147830 CSD027
     C**********           Z-ADDROCN      SVROCN                                       147830 CSD027
     C                     MOVE ROBN      SVROBN                                              CSD027
     C                     MOVE ROCN      SVROCN                                              CSD027
     C                     Z-ADDPSTM      SVPSTM                          147830
     C                     MOVE PONS      SVPONS                          147830
     C                     MOVE PIBN      SVPIBN                          147830
     C                     MOVE PIBA      SVPIBA                          147830
     C**********           Z-ADDPOBN      SVPOBN                                       147830 CSD027
     C**********           Z-ADDPOCN      SVPOCN                                       147830 CSD027
     C                     MOVE POBN      SVPOBN                                              CSD027
     C                     MOVE POCN      SVPOCN                                              CSD027
     C                     MOVE RCRN      SVRCRN                          147830
     C                     MOVE RCRA      SVRCRA                          147830
     C                     MOVE RVNO      SVRVNO                          147830
     C                     MOVE AWBN      SVAWBN                          147830
     C                     MOVE AWBA      SVAWBA                          147830
     C                     MOVE BENN      SVBENN                          147830
     C                     MOVE BENA      SVBENA                          147830
     C                     MOVE DTP1      SVDTP1                          147830
     C                     MOVE DTP2      SVDTP2                          147830
     C                     MOVE DTP3      SVDTP3                          147830
     C                     MOVE DTP4      SVDTP4                          147830
     C                     MOVE DCHG      SVDCHG                          147830
     C                     MOVE BTB1      SVBTB1                          147830
     C                     MOVE BTB2      SVBTB2                          147830
     C                     MOVE BTB3      SVBTB3                          147830
     C                     MOVE BTB4      SVBTB4                          147830
     C                     MOVE BTB5      SVBTB5                          147830
     C                     MOVE BTB6      SVBTB6                          147830
     C                     MOVE CVMR      SVCVMR                          147830
     C                     MOVE PTFR      SVPTFR                          147830
     C                     MOVE HLEX      SVHLEX                          147830
     C                     Z-ADDFSRP      SVFSRP                          147830
     C                     MOVE FSGN      SVFSGN                          147830
     C                     MOVE FPRC      SVFPRC                          147830
     C                     Z-ADDTCOF      SVTCOF                          147830
     C                     Z-ADDACPD      SVACPD                          147830
     C                     Z-ADDACDA      SVACDA                          147830
     C                     Z-ADDACAJ      SVACAJ                          147830
     C                     Z-ADDACAP      SVACAP                          147830
     C                     Z-ADDCOFD      SVCOFD                          147830
     C                     Z-ADDCOFM      SVCOFM                          147830
     C                     Z-ADDCFCD      SVCFCD                          147830
     C                     Z-ADDNFRS      SVNFRS                          147830
     C                     MOVE NFSN      SVNFSN                          147830
     C                     MOVE NFPC      SVNFPC                          147830
     C                     Z-ADDPDCF      SVPDCF                          147830
     C                     Z-ADDFCTD      SVFCTD                          147830
     C                     Z-ADDFWOD      SVFWOD                          147830
     C                     MOVE DFTP      SVDFTP                          147830
     C                     MOVE DFST      SVDFST                          147830
     C                     MOVE DFCL      SVDFCL                                              CLE042
     C                     MOVE MCRA      SVMCRA                          147830
     C                     Z-ADDFCRA      SVFCRA                          147830
     C                     MOVE PDDI      SVPDDI                          147830
     C                     MOVE PTDI      SVPTDI                          147830
     C                     Z-ADDGDPR      SVGDPR                          147830
     C                     Z-ADDGDIN      SVGDIN                          147830
     C                     MOVE LNKS      SVLNKS                          147830
     C                     MOVE MNSG      SVMNSG                          147830
     C                     MOVE GASS      SVGASS                          147830
     C                     MOVE GPRT      SVGPRT                          147830
     C**********           Z-ADDTOLN      SVTOLN                                       147830 CLE148
     C                     MOVELTOLN      SVTOLN                                              CLE148
     C                     MOVE LSTS      SVLSTS                          147830
     C                     MOVE IUSR      SVIUSR                          147830
     C                     MOVE AUSR      SVAUSR                          147830
     C                     MOVE XUSR      SVXUSR                          147830
     C                     MOVE RATF      SVRATF                          147830
     C                     MOVE CNCF      SVCNCF                          147830
     C                     MOVE PCRF      SVPCRF                          147830
     C                     MOVE LPFI      SVLPFI                          147830
     C**********           Z-ADDPTFC      SVPTFC                                       147830 CSD027
     C                     MOVE PTFC      SVPTFC                                              CSD027
     C                     Z-ADDPTFT      SVPTFT                          147830
     C                     Z-ADDPTFN      SVPTFN                          147830
     C                     MOVE PCOB      SVPCOB                          147830
     C                     Z-ADDLRLD      SVLRLD                          147830
     C                     Z-ADDLMCD      SVLMCD                          147830
     C                     Z-ADDOIDT      SVOIDT                          147830
      *                                                                                       CAS001
      ** When CAS001 enhancement is installed                                                 CAS001
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
     C                     MOVELFSYLDC    SVYLDC                                              CAS001
     C                     MOVELFSFYLD    SVFYLD                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CLE036
      ** If CLE036 is on                                                                      CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C                     Z-ADDBASR      SVBASR                                              CLE036
     C                     Z-ADDNBSR      SVNBSR                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                   147830
     C                     ENDSR                                          147830
      *                                                                   147830
      ********************************************************************147830
      *                                                                  *147830
      *    RFLDS - RE-STORE ORIGINAL CLOAN FLDS                          *147830
      *                                                                  *147830
      *    CALLED BY: S/R SETUP                                          *147830
      *                                                                  *147830
      *    CALLS:                                                        *147830
      *                                                                  *147830
      ********************************************************************147830
      *                                                                   147830
     C           RFLDS     BEGSR                                          147830
      *                                                                   147830
     C                     MOVE SVRECI    RECI                            147830
     C**********           Z-ADDSVLNRF    LNRF                                         147830 CLE148
     C                     MOVELSVLNRF    LNRF                                                CLE148
     C                     MOVE SVRCDT    RCDT                            147830
     C                     Z-ADDSVMRIN    MRIN                            147830
     C                     Z-ADDSVPTYP    PTYP                            147830
     C**********           Z-ADDSVCNUM    CNUM                                         147830 CSD027
     C                     MOVE SVCNUM    CNUM                                                CSD027
     C                     MOVE SVBRCA    BRCA                            147830
     C                     MOVE SVLTYP    LTYP                            147830
     C                     MOVE SVSUTP    SUTP                            147830
     C                     MOVE SVCLAS    CLAS                                                CLE042
     C                     Z-ADDSVDDAT    DDAT                            147830
     C                     Z-ADDSVVDAT    VDAT                            147830
     C                     Z-ADDSVMDAT    MDAT                            147830
     C                     Z-ADDSVLASQ    LASQ                            147830
     C**********           Z-ADDSVFCUS    FCUS                                         147830 CSD027
     C                     MOVE SVFCUS    FCUS                                                CSD027
     C                     Z-ADDSVFTYP    FTYP                            147830
     C                     Z-ADDSVFSEQ    FSEQ                            147830
     C                     MOVE SVCCY     CCY                             147830
     C                     Z-ADDSVCPAM    CPAM                            147830
     C                     MOVE SVINTC    INTC                            147830
     C                     Z-ADDSVINTR    INTR                            147830
     C                     Z-ADDSVBRTT    BRTT                            147830
     C                     Z-ADDSVBRTE    BRTE                            147830
     C                     Z-ADDSVRTSP    RTSP                            147830
     C                     Z-ADDSVMARG    MARG                            147830
     C                     MOVE SVSPIN    SPIN                            147830
     C                     MOVE SVCHIN    CHIN                            147830
     C                     Z-ADDSVWTRT    WTRT                            147830
     C                     MOVE SVWTIN    WTIN                            147830
     C                     Z-ADDSVREPT    REPT                            147830
     C                     Z-ADDSVRAMT    RAMT                            147830
     C                     Z-ADDSVNRPD    NRPD                            147830
     C                     MOVE SVRFRQ    RFRQ                            147830
     C                     Z-ADDSVRDYN    RDYN                            147830
     C                     MOVE SVFCCY    FCCY                            147830
     C**********           Z-ADDSVLIND    LIND                                         147830 CER020
     C                     MOVE SVLOIC    LOIC                                                CER020
     C                     MOVE SVCRSK    CRSK                            147830
     C                     MOVE SVACOF    ACOF                            147830
     C                     MOVE SVNACD    NACD                            147830
     C                     MOVE SVRELI    RELI                            147830
     C                     MOVE SVAUTO    AUTO                            147830
     C                     Z-ADDSVPSAM    PSAM                            147830
     C                     Z-ADDSVBCXR    BCXR                            147830
     C                     Z-ADDSVFCXR    FCXR                            147830
     C                     Z-ADDSVSDST    SDST                            147830
     C                     MOVE SVOSDA    OSDA                            147830
     C                     MOVE SVTSTN    TSTN                            147830
     C                     Z-ADDSVMDST    MDST                            147830
     C                     MOVE SVOMDA    OMDA                            147830
     C                     MOVE SVTMAN    TMAN                            147830
     C                     MOVE SVFACO    FACO                            147830
     C                     Z-ADDSVRLDT    RLDT                            147830
     C                     MOVE SVRFDY    RFDY                            CLE011
     C                     MOVE SVRFRI    RFRI                            CLE011
     C                     MOVE SVRFAR    RFAR                            CLE011
     C                     Z-ADDSVRFRT    RFRT                            CLE011
     C                     Z-ADDSVNROD    NROD                            147830
     C                     MOVE SVRLFQ    RLFQ                            147830
     C                     Z-ADDSVRLDY    RLDY                            147830
     C                     MOVE SVRDFC    RDFC                            147830
     C                     Z-ADDSVNBRA    NBRA                            147830
     C                     Z-ADDSVNRTS    NRTS                            147830
     C                     MOVE SVNSIN    NSIN                            147830
     C                     Z-ADDSVNCAS    NCAS                            147830
     C                     Z-ADDSVAWTP    AWTP                            147830
     C                     Z-ADDSVWTRD    WTRD                            147830
     C                     Z-ADDSVWTWD    WTWD                            147830
     C                     Z-ADDSVIWOD    IWOD                            147830
     C                     Z-ADDSVPWOD    PWOD                            147830
     C                     MOVE SVBMDI    BMDI                            147830
     C                     MOVE SVFMDI    FMDI                            147830
     C                     Z-ADDSVPDIN    PDIN                            147830
     C                     Z-ADDSVLSWC    LSWC                            147830
     C                     Z-ADDSVLSWS    LSWS                            147830
     C                     MOVE SVOSDB    OSDB                            147830
     C                     MOVE SVOMDB    OMDB                            147830
     C                     MOVE SVORBR    ORBR                            147830
     C                     MOVE SVPRFC    PRFC                            147830
     C                     MOVE SVFCLB    FCLB                            147830
     C**********           Z-ADDSVMLNR    MLNR                                         147830 CLE148
     C                     MOVELSVMLNR    MLNR                                                CLE148
     C                     MOVE SVBTIN    BTIN                            147830
     C                     Z-ADDSVBLDY    BLDY                            147830
     C**********           Z-ADDSVOLNO    OLNO                                         147830 CSD027
     C                     MOVE SVOLNO    OLNO                                                CSD027
     C                     MOVE SVRCSI    RCSI                            147830
     C                     Z-ADDSVICBS    ICBS                            147830
     C                     MOVE SVIPFR    IPFR                            147830
     C                     Z-ADDSVTOTI    TOTI                            147830
     C                     Z-ADDSVNIDT    NIDT                            147830
     C                     Z-ADDSVIBDT    IBDT                            147830
     C                     Z-ADDSVSLID    SLID                            147830
     C                     Z-ADDSVAIPD    AIPD                            147830
     C                     Z-ADDSVDLRC    DLRC                            147830
     C                     Z-ADDSVIACD    IACD                            147830
     C                     Z-ADDSVAITC    AITC                            147830
     C                     Z-ADDSVTFEP    TFEP                            147830
     C                     Z-ADDSVAIAP    AIAP                            147830
     C                     Z-ADDSVIPRD    IPRD                            147830
     C                     Z-ADDSVIPRM    IPRM                            147830
     C                     Z-ADDSVICTD    ICTD                            147830
     C                     Z-ADDSVAIMN    AIMN                            147830
     C                     Z-ADDSVRBDT    RBDT                            147830
     C                     Z-ADDSVNOPS    NOPS                            147830
     C                     MOVE SVNCHI    NCHI                            147830
     C                     Z-ADDSVIFDY    IFDY                            147830
     C                     MOVE SVLONI    LONI                            147830
     C                     MOVE SVCNFI    CNFI                            147830
     C                     MOVE SVACEI    ACEI                            147830
     C                     MOVE SVTLXI    TLXI                            147830
     C                     MOVE SVCBLI    CBLI                            147830
     C                     Z-ADDSVORED    ORED                            147830
     C                     Z-ADDSVLCD     LCD                             147830
     C                     MOVE SVCHTP    CHTP                            147830
     C                     Z-ADDSVTNLU    TNLU                            147830
     C                     MOVE SVADDI    ADDI                            147830
     C                     Z-ADDSVORMD    ORMD                            147830
     C                     Z-ADDSVORTI    ORTI                            147830
     C                     MOVE SVBOKC    BOKC                            147830
     C**********           Z-ADDSVCOCU    COCU                                         147830 CSD027
     C**********           Z-ADDSVRECE    RECE                                         147830 CSD027
     C                     MOVE SVCOCU    COCU                                                CSD027
     C                     MOVE SVRECE    RECE                                                CSD027
     C                     Z-ADDSVOMDT    OMDT                            147830
     C                     Z-ADDSVNIPD    NIPD                            147830
     C                     Z-ADDSVNMDT    NMDT                            147830
     C                     MOVE SVAPMI    APMI                            147830
     C                     Z-ADDSVRSTM    RSTM                            147830
     C                     MOVE SVRONS    RONS                            147830
     C                     MOVE SVRIBN    RIBN                            147830
     C                     MOVE SVRIBA    RIBA                            147830
     C**********           Z-ADDSVROBN    ROBN                                         147830 CSD027
     C**********           Z-ADDSVROCN    ROCN                                         147830 CSD027
     C                     MOVE SVROBN    ROBN                                                CSD027
     C                     MOVE SVROCN    ROCN                                                CSD027
     C                     Z-ADDSVPSTM    PSTM                            147830
     C                     MOVE SVPONS    PONS                            147830
     C                     MOVE SVPIBN    PIBN                            147830
     C                     MOVE SVPIBA    PIBA                            147830
     C**********           Z-ADDSVPOBN    POBN                                         147830 CSD027
     C**********           Z-ADDSVPOCN    POCN                                         147830 CSD027
     C                     MOVE SVPOBN    POBN                                                CSD027
     C                     MOVE SVPOCN    POCN                                                CSD027
     C                     MOVE SVRCRN    RCRN                            147830
     C                     MOVE SVRCRA    RCRA                            147830
     C                     MOVE SVRVNO    RVNO                            147830
     C                     MOVE SVAWBN    AWBN                            147830
     C                     MOVE SVAWBA    AWBA                            147830
     C                     MOVE SVBENN    BENN                            147830
     C                     MOVE SVBENA    BENA                            147830
     C                     MOVE SVDTP1    DTP1                            147830
     C                     MOVE SVDTP2    DTP2                            147830
     C                     MOVE SVDTP3    DTP3                            147830
     C                     MOVE SVDTP4    DTP4                            147830
     C                     MOVE SVDCHG    DCHG                            147830
     C                     MOVE SVBTB1    BTB1                            147830
     C                     MOVE SVBTB2    BTB2                            147830
     C                     MOVE SVBTB3    BTB3                            147830
     C                     MOVE SVBTB4    BTB4                            147830
     C                     MOVE SVBTB5    BTB5                            147830
     C                     MOVE SVBTB6    BTB6                            147830
     C                     MOVE SVCVMR    CVMR                            147830
     C                     MOVE SVPTFR    PTFR                            147830
     C                     MOVE SVHLEX    HLEX                            147830
     C                     Z-ADDSVFSRP    FSRP                            147830
     C                     MOVE SVFSGN    FSGN                            147830
     C                     MOVE SVFPRC    FPRC                            147830
     C                     Z-ADDSVTCOF    TCOF                            147830
     C                     Z-ADDSVACPD    ACPD                            147830
     C                     Z-ADDSVACDA    ACDA                            147830
     C                     Z-ADDSVACAJ    ACAJ                            147830
     C                     Z-ADDSVACAP    ACAP                            147830
     C                     Z-ADDSVCOFD    COFD                            147830
     C                     Z-ADDSVCOFM    COFM                            147830
     C                     Z-ADDSVCFCD    CFCD                            147830
     C                     Z-ADDSVNFRS    NFRS                            147830
     C                     MOVE SVNFSN    NFSN                            147830
     C                     MOVE SVNFPC    NFPC                            147830
     C                     Z-ADDSVPDCF    PDCF                            147830
     C                     Z-ADDSVFCTD    FCTD                            147830
     C                     Z-ADDSVFWOD    FWOD                            147830
     C                     MOVE SVDFTP    DFTP                            147830
     C                     MOVE SVDFST    DFST                            147830
     C                     MOVE SVDFCL    DFCL                                                CLE042
     C                     MOVE SVMCRA    MCRA                            147830
     C                     Z-ADDSVFCRA    FCRA                            147830
     C                     MOVE SVPDDI    PDDI                            147830
     C                     MOVE SVPTDI    PTDI                            147830
     C                     Z-ADDSVGDPR    GDPR                            147830
     C                     Z-ADDSVGDIN    GDIN                            147830
     C                     MOVE SVLNKS    LNKS                            147830
     C                     MOVE SVMNSG    MNSG                            147830
     C                     MOVE SVGASS    GASS                            147830
     C                     MOVE SVGPRT    GPRT                            147830
     C**********           Z-ADDSVTOLN    TOLN                                         147830 CLE148
     C                     MOVELSVTOLN    TOLN                                                CLE148
     C                     MOVE SVLSTS    LSTS                            147830
     C                     MOVE SVIUSR    IUSR                            147830
     C                     MOVE SVAUSR    AUSR                            147830
     C                     MOVE SVXUSR    XUSR                            147830
     C                     MOVE SVRATF    RATF                            147830
     C                     MOVE SVCNCF    CNCF                            147830
     C                     MOVE SVPCRF    PCRF                            147830
     C                     MOVE SVLPFI    LPFI                            147830
     C**********           Z-ADDSVPTFC    PTFC                                         147830 CSD027
     C                     MOVE SVPTFC    PTFC                                                CSD027
     C                     Z-ADDSVPTFT    PTFT                            147830
     C                     Z-ADDSVPTFN    PTFN                            147830
     C                     MOVE SVPCOB    PCOB                            147830
     C                     Z-ADDSVLRLD    LRLD                            147830
     C                     Z-ADDSVLMCD    LMCD                            147830
     C                     Z-ADDSVOIDT    OIDT                            147830
      *                                                                                       CAS001
      ** When CAS001 enhancement is installed                                                 CAS001
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
     C                     MOVELSVYLDC    FSYLDC                                              CAS001
     C                     MOVELSVFYLD    FSFYLD                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C                     Z-ADDSVBASR    BASR                                                CLE036
     C                     Z-ADDSVNBSR    NBSR                                                CLE036
     C                     ENDIF                                                              CLE036
      *                                                                   147830
     C                     ENDSR                                          147830
      *                                                                   147830
      /EJECT
      *****************************************************************
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *****************************************************************
     C           *PSSR     BEGSR
      *
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     CALL 'DBERRCTL'
     C                     ENDIF
      *
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     RETRN
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
     C/COPY ZSRSRC,GLINTCZ1
      /EJECT
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
     C/COPY ZSRSRC,ZDATE2Z2
      /EJECT
     C/COPY ZSRSRC,ZDATE9Z3
      /EJECT
     C/COPY ZSRSRC,ZFLACZ2
      /EJECT
     C/COPY ZSRSRC,ZFRPEDZ3
      /EJECT
     C/COPY ZSRSRC,ZINTDYZ2
      /EJECT
     C/COPY ZSRSRC,ZEDITZ2                                                                    CLE031
     C/EJECT                                                                                  CLE031
      *                                                                                       CLE064
      ** Elements of Array TABF/TABFRQ were amended by removing TBI-MONTHLY and               CLE064
      ** XSIX MONTHLY, and added more elements                                                CLE064
      *                                                                                       CLE064
** CPY@  **      Copyright statement
(c) Misys International Banking Systems Ltd. 2001
** ANARR **      Narratives
MATURED
REVERSED
COMPLETE
AUTHORISED
REQ. REAUTHORISATION
ACTUAL
PREVIOUS
NEXT
MODIFIED
SYSTEM
MANUAL
BY ASSIGNMENT
BY PRINCIPAL TRANSFER
**   ADEDT - Editing day number
STNDRDTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHSTNDRDTHTHTHTHTHTHTHST
**   TAB1;TABF - Table of frequencies in words
WWEEKLY
FFORTNIGHTLY
MMONTHLY
TTWO MONTHLY                                                                                  CLE064
QQUARTERLY
XHALF YEARLY                                                                                  CLE064
YYEARLY
RAT ROLLOVER                                                              157606
DDAILY                                                                                        CLE064
4FOUR MONTHLY                                                                                 CLE064
5FIVE MONTHLY                                                                                 CLE064
7SEVEN MONTHLY                                                                                CLE064
8EIGHT MONTHLY                                                                                CLE064
9NINE MONTHLY                                                                                 CLE064
VTEN MONTHLY                                                                                  CLE064
EELEVEN MONTHLY                                                                               CLE064
CTWO YEARLY                                                                                   CLE064
ITHREE YEARLY                                                                                 CLE064
JFOUR YEARLY                                                                                  CLE064
NFIVE YEARLY                                                                                  CLE064
UTEN YEARLY                                                                                   CLE064
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
** CMD
OVRDBF FILE(CLOAN) TOFILE(CLOAN) MBR(*ALL) SECURE(*YES) SHARE(*NO)
