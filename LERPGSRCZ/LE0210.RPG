     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Loan activity enquiry')                       *
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *    LE0210  -  LOAN ACTIVITY ENQUIRY                           *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CLE172             Date 01Oct20               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 MD053295           Date 13Apr19               *
      *                 MD052583           Date 22Jan19               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CLE154             Date 07Aug12               *
      *                 CLE141             Date 08Feb16               *
      *                 260891             Date 17Dec12               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 245082             Date 30Jan07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE106             Date 06May05               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 190005             Date 23Oct02               *
      * Midas Release 4.01.02 ----------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 14Dec99               *
      *                 183577             Date 20Apr01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 182282             Date 17Jan01               *
      *                 CLE011             Date 07Nov00               *
      *                 157669             Date 07Dec00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD007             Date 28Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      *                 165834             Date 16Mar00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 147492             Date 17Nov98               *
      *                 144916             Date 19Oct98               *
      *                 143510             Date 29Sep98               *
     F*                 CEU020             Date 16Mar98               *
     F*                 121768             DATE 19Feb98               *
     F*                 126087             DATE 18FEB98               *
     F*                 126017             DATE 17NOV97               *
     F*                 128054             DATE 23Dec97               *
     F*                 CLE005             Date 22May97               *
     F*                 123696             Date 03Oct97               *
     F*                 CLE004             Date 02Dec96               *
     F*                 117217             DATE 07APR97               *
     F*                 097885             Date 31Jan97               *
     F*                 S01408             DATE 04SEP96               *
     F*                 CAC001             Date 13Aug96               *
     F*                 S01408             Date 12Jun96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 073003             DATE 14OCT94               *
     F*                 066550             DATE 04FEB94               *
     F*                 046645             DATE 04NOV92               *
     F*                 S01392             DATE 16SEP92               *
     F*                 BH3477             DATE 18AUG92               *
     F*                 BH3419             DATE 12AUG92               *
     F*                 S01311             DATE 07JAN91               *
     F*                 S01220             DATE 02AUG90               *
     F*                 S01270             DATE 12JUNE90              *
     F*                 S01194             DATE 03/01/90              *
     F*                 S01117             DATE 15/06/89              *
     F*                 S01147             DATE 06/05/88              *
     F*                 E10159             DATE 06/05/88              *
     F*                 E81164             DATE 06/05/88              *
     F*                 E80945             DATE 06/05/88              *
     F*                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CLE172 - LIBOR Deregulation - Lending (Recompile).           *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD052583 - Rebranding changes (47K Sources) during SP17 have *
      *             removed some fixes that was already incorporated  *
      *             in previous SP                                    *
      *           - Reinstate overridden MD047993/MD035545            *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CLE154 - Loan Repayment Schedule Enhancement                 *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  260891 - Wrong projection in LOAC. Add LCD as a key.         *
      *           Recompiled due to changes in LF/HISTR.              *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Patterned after fix 235784 from Release 4.          *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CLE106 - Syndication Manager                                 *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  190005 - Display screen heading for Matured Loans Enquiry.   *
      *  CDE002 - Revenue Analysis                                    *
      *  183577 - Multi currency rollover rate is not shown when it is*
      *           the last action and should be shown on the last page*
      *           by itself.                                          *
      *  182282 - Enquiry crashes for certain loans.                  *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *  157669 - Rename new Cost of Funds fields in HISTS*           *
      *  CSD007 - Customer Closing                                    *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  165834 - Rollovers with zero interest rate should be shown.  *
     F*           Also should show negative sign on an interest rate.
     F*  147492 - Diplay history amounts with the correct number of   *
     F*           decimal places if the loan was rolled-over to a     *
     F*           new currency with different number of decimal place.*
      *  144916 - Uses old ccy base rate in calculating outstanding   *
      *           interest after multi-ccy rollover                   *
      *  143510 - Shows extra one day in interest amount computation. *
      *           Applied fix 065277 to ignore First Day Accrual ind. *
     F*  CEU020 - EMU Lending Multi-currency Rollover                 *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126087 - Wrong information shown                             *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  128054 - Additional Days Indicator displayed incorrectly for
     F*           matured loans enquiry
     F*  CLE005 - Customer Lending Enhancements - Tranche 3           *
     F*  123696 - Swap lines 42 & 43 of NARR array                    *
     F*  CLE004 - Customer Lending Enhancements - Syndication            *
     F*  117217 - New fields added to HISTS* for CLE003 are overwriting  *
     F*           those on the loan.                                     *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  S01408 - Core hook LE0210CCP5 added.                            *
     F*  CAC001 - Profit Centre Accounting Development:                  *
     F*           Spread/Rate changes('SC') and Manual Adjustments('MI') *
     F*           only displayed for interest.  No funding details       *
     F*           are shown on the enquiry.                              *
     F*  S01408 - Core hook LE0210FFP1 added.                            *
     F*           Core hook LE0210FFP2 added.                            *
     F*           Core hook LE0210EEP1 added.                            *
     F*           Core hook LE0210IIP1 added.                            *
     F*           Core hook LE0210CCP1 added.                            *
     F*           Core hook LE0210CCP2 added.                            *
     F*           Core hook LE0210CCP3 added.                            *
     F*           Core hook LE0210CCP4 added.                            *
     F*  095244 - Recompiled for Calculation method 3                    *
     F*  095238 - Recompiled for Calculation method 3                    *
     F*    073003 - Next rollover date field is displaying value         *
     F*             in NROD not RLDT, which is in fact the next          *
     F*             rollover date.                                       *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
     F*     046645  -  ADD THE ROUND DOWN INDICATOR                      *
     F*     S01392  -  JAPANESE SUB MODULE ENHANCEMENTS                  *
     F*     BH3477  -  Sometimes I do wonder....3419 was the wrong way   *
     F*                round. Sorry folks.                               *
     F*     BH3419  -  Show what loan subtype changed from and to        *
     F*     S01311  -  EXPOSURE MANAGEMENT ENQUIRIES                     *S01311
     F*     S01220  -  AMENDED FOR STRATEGIC RISK MANAGEMENT             *S01220
     F*                RELEASE 10 TO ALLOW THE INPUT OF A BOOK           *S01220
     F*                CODE AGAINST A LOAN.                              *S01220
     F*     S01270  -  CUSTOMER LENDING CHANGES                          *S01270
     F*     S01194  -  STANDING DATA CHANGES                             *S01194
     F*     S01117  -  MULTIBRANCHING.                                   *
     F*     S01147  -  RELEASE 22 (AMENDMENT TO GLINTC)                  *S01147
     F*     E10159  -  VARIOUS INTEREST/WH TAX AMOUNTS ARE DISPLAYED     *E10159
     F*                INCORRECTLY .                                     *E10159
     F*     E81164  -  PAST DUE CONDITION CHANGED TO AVOID -VE           *E81164
     F*                OUTSTANDING INTEREST                              *E81164
0011 F*     E80945  -  INDICATOR 98 SETTING IS SAVED AND RESTORED        *
0011 F*                WHEN S.R.GLINTC IS PERFORMED.                     *
0011 F*                                                                  *
0012 F********************************************************************
     F*E0210FMCF**F***  191            WORKSTN      KPASS  *NOIND         S01117
0020 F*LE0210FMCF**F*****191            WORKSTN                    S01117 S01270
0020 F*E0210FMCF**F*****216            WORKSTN                     S01270 S01392
0020 F*E0210FMCF**F*****224            WORKSTN                     S01392 046645
0020 F*LE0210FMCF**F     225            WORKSTN                    046645 CLE004
0020 FLE0210FMCF  F     255            WORKSTN                            CLE004
     F***********                                   KSLN   V              S01117
     F                                              KSLN   VSLN           S01117
0023 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0024 FHISTR   IF  E           K        DISK
0025 F***LOAMS***IF  F     320 14AI     2 DISK                            CAC001
     F*LOAMS***IF**F     969 14AI     2 DISK                       CAC001 CLE004
     F***LOAMS** IF  F    1051 14AI     2 DISK                                         CLE004 CGL029
     F*LOAMS***IF**F****1129 14AI     2 DISK                                           CGL029 CLE042
     FLOAMS   IF  F    1291 14AI     2 DISK                                                   CLE042
0026 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
0027 F*CLOAN***IF**F     400  7AI     2 DISK                              S01220
0027 F*CLOAN***IF  F     436  7AI     2 DISK                       S01220 CLE004
0027 F*CLOAN***IF**F    1275  7AI     2 DISK                       CLE004 CLE011
     F***CLOAN** IF  F    1310  7AI     2 DISK                                         CLE011 CGL029
     F*CLOAN***IF**F****1461  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** IF  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   IF  F    1874  7AI     2 DISK                                                   CLE134
0028 F/COPY WNCPYSRC,LE0210FFP1                                           S01408
0028 F* ID F  C  H  L    FUNCTION OF INDICATORS
0029 F* 01            WORKSTATION - SF SCREEN
0030 F* 02                        - CATCHALL
0018 F* 03            USED TO CONDITON FIRST TIME PASS THROUGH CYCLE *  *
0019 F* 04            SET ON IF ERROR DURING READ FROM WORKSTATION   *  *
0029 F* 05            WORKSTATION - SG SCREEN
     F*       08      NEXT SCREEN (ROLLUP)
     F*       09      FIRST SCREEN (ROLLDOWN)
0031 F* 10            *TABLE*,*CLINT*,CLOAN,HISTS,LOAMS LIVE DETAIL       S01194
0032 F* 11            CLOAN - REVERSED
     F*       12      MUTIBRANCHING INDICATOR IS NO (MBIN = 'N')          S01117
     F*       14      REQUIRED INTEREST ROUND DOWN                        S01392
     F*       15      LINKED ENQUIRY                                      S01311
     F*    16         CUSTOMER LOAN                                       S01311
     F*    17         PARTICIPATION PURCHASED                             S01311
     F*    18         PARTICIPATION SOLD                                  S01311
     F*    19         GUARANTEE ISSUED                                    S01311
0033 F*    20         DATE BLANK
0034 F*    21         CODE BLANK
0035 F*    22         REPAYMENT DAYNO ZERO
0036 F*    23         INTEREST DAYNO ZERO
0037 F*    24         CURRENT PRINCIPAL NEGATIVE
0038 F*       25      PREMIUM LOAN
0039 F*       26      DISCOUNTED LOAN
0040 F*       27      USED IN INTEREST CALCS.
0041 F*       28      USED IN INTEREST CALCS.
0042 F*       29      REVERSE IMAGE LOAN REFERENCE
0043 F*       30      FIRST SCREEN FOR LOAN
0044 F*       31      COMPLETE DISPLAYED
0045 F*       32      LOAMS RECORD EARLIER
0046 F*       33      HISTS RECORD EARLIER/SAME
0047 F*       34      NO MORE LOAMS DETAILS
0048 F*       35,36   MULTIPLE USE
0049 F*       37      NO MORE HISTS DETAILS
0050 F*       38      CHAIN FAIL
0051 F*       39      RELEASE WORKSTATION
0052 F*       40      DISPLAY INITIAL/ERROR SCREEN
0053 F*       41      LOAN INVALID
0054 F*       42      DATE INVALID
0055 F*       43      CODE INVALID
0056 F*       44      ERROR MESSAGE NON-DISPLAY
0057 F*       45      ERROR MESSAGE REVERSE IMAGE
0058 F*       46      DATE/CODE COMBINATION INVALID
0059 F*       47-49   USED IN CHECKL/CHECKH SRS TO DETERMINE WHETHER
0060 F*               ANY MORE LINES WILL BE OUTPUT FOR THIS RECORD
0061 F*               IF SCREEN FULL WHILE PROCESSING IT.
0062 F*       50      CODE H
0063 F*       51      CODE P
0064 F*       52      CODE F
0065 F*       53      CODE B
0066 F*       54,55   MULTIPLE USE
0067 F*       56      INTEREST IS CAPITALISED
     F*       57      RCSI = 'Y' AND PTYP = '64' OR '65' (CONDITIONS      S01270
     F*               OUTPUT                                              S01270
0028 F/COPY WNCPYSRC,LE0210FFP2                                           S01408
0068 F*       60      SCREEN FULL
0069 F*       61-64   CURRENCY DPS 0-3
0070 F*       65      SPREAD/RATE OUTPUT EDIT
0071 F*       66      SUPPRESS AMOUNT OUTPUT FOR STOP/START ACCRUALS
     F*       67      SUPPRESS AMOUNT OUTPUT FOR LOAN SUB-TYPE AMENDMENT  S01270
0072 F*       70      EXCEPTION - DETAIL LINE
0073 F*       71      EXCEPTION - HEADINGS ETC.
     F*                                                                   CLE004
     F*       72-73   Linked to Syndicate                                 CLE004
     F*       74      Automatic (Header)                                  CLE004
     F*       75      Assignment (Header)                                 CLE004
     F*       76      Automatic (Activity)                                CLE004
     F*       77      Assignment (Activity)                               CLE004
     F*       78      CLE004 is Present                                   CLE004
     F*                                                                   CLE004
      *       79      Matured Loans Enquiry                                                   190005
0074 F*       80-84   USED TO CONTROL RETURN IF SCREEN FULL IN
0075 F*               MIDDLE OF PROCESSING LOAM OR HIST RECORD.
      *       85      Matured Loans Enquiry purposes. To enable                               190005
      *               the Help Key at initial enquiry.                                        190005
0076 F*       90-99   STANDARD SUBROUTINES
0077 F*       KC      END OF JOB
0080 F*          U7,U8 - DATABASE ERROR
      *          U1    - Matured Loans Enquiry                                                190005
0073 E/COPY ZSRSRC,ZDATE2Z1                                               S01392
0084 E***********         MSG     1   9 43               MESSAGES         S01117
     E                    MSG     1  11 60               MESSAGES         S01117
0085 E********************NARR    1  37 30               NARRATIVES       E10159
     E                    CPY@    1   1 80
     E********************NARR    1  38 30               NARRATIVES       E10159
     E/COPY WNCPYSRC,LE0210E001
     E***********         NARR    1  41 30               NARRATIVESS01270 CLE004
     E***********         NARR    1  44 30               NARRATIVESCLE004 144916
     E                    NARR    1  49 30               NARRATIVES       144916
0028 E/COPY WNCPYSRC,LE0210EEP1                                           S01408
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
0086 I**
0087 I**   WORKSTATION FILE
0088 I**
     I*  'SF' SCREEN - NO ROLLUP/ROLLDOWN
0089 ILE0210FMNS  01   1 CS   2 CF
0090 I                                        1   2 SCID
0091 I                                        3   8 LNIN
0092 I                                        9  14 DTIN            20
0093 I                                       15  15 CDIN
     I*  'SG' SCREEN - WITH ROLLUP/ROLLDOWN
     I********NS* 05   3 CS   4 CG                                        S01117
     I***********                             1   1 *IN08                 S01117
     I***********                             2   2 *IN09                 S01117
0090 I***********                             3   4 SCID                  S01117
0091 I***********                             5  10 LNIN                  S01117
0092 I***********                            11  16 DTIN            20    S01117
0093 I***********                            17  17 CDIN                  S01117
     I        NS  05   1 CS   2 CG                                        S01117
     I                                        1   2 SCID                  S01117
     I                                        3   8 LNIN                  S01117
     I                                        9  14 DTIN            20    S01117
     I                                       15  15 CDIN                  S01117
0108 I*
0109 I*    CATCH ALL
0110 I*
0094 I        NS  02
0095 I**************                                                      S01194
0096 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0097 I**************                                                      S01194
0098 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0099 I*******AND****  13 C0                                               S01194
0100 I**************                          1   1 RECI                  S01194
0101 I**************                         12  130RCDE                  S01194
0102 I**************                         14  66 TITL                  S01194
0103 I**************                         67  67 DATF                  S01194
0104 I**********                             68  700DFBR                  S01194
0105 I**************                         74  74 MODI1                 S01194
0106 I**************                         75  75 MODI2                 S01194
0107 I**************                         76  76 MODI3                 S01194
0108 I**************                      P  77  790RUND                  S01194
0109 I**************                         80  86 RUNA                  S01194
0110 I**************                         87  870SFLG                  S01194
0111 I**************                      P  90  920LCD                   S01194
0112 I**************                         93  93 CHTP                  S01194
0113 I**************                      P  94  960TNLU                  S01194
0114 I**************                                                      S01194
0115 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0116 I**************                                                      S01194
0117 I********NS****   1 CD   2 C0   3 C1                                 S01194
0118 I*******AND****  12 C1  13 C1                                        S01194
0119 I**************                          1   1 RECI                  S01194
0120 I**************                          2   30RECT                  S01194
0121 I**************                         12  130RCDE                  S01194
0122 I**************                         14  16 BCCY                  S01194
0123 I**************                         17  19 BCYL                  S01194
0124 I**************                         20  22 HOCY                  S01194
0125 I**************                         23  280HEAD                  S01194
0126 I**************                      P  29  310APDA                  S01194
0127 I**************                         35  35 APFQ                  S01194
0128 I**************                      P  36  380LOGS                  S01194
0129 I**************                         39  40 CUZR                  S01194
0130 I**************                      P  41  430DNWD                  S01194
0131 I**************                         44  460BVLP                  S01194
0132 I**************                         47  49 LOCY                  S01194
0133 I**************                         50  510FDAY                  S01194
0134 I**************                         52  52 ACLD                  S01194
0135 I***********                            53  53 MBIN                  S01194
0136 I**************                         86  86 ISAV                  S01194
0137 I**************                      P  87  890LLOG                  S01194
0138 I**************                      P  90  920LCD                   S01194
0139 I**************                         93  93 CHTP                  S01194
0140 I**************                      P  94  960TNLU                  S01194
0141 I**************                                                      S01194
0142 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0143 I**************                                                      S01194
0144 I*TABLE***NS**10   1 CD   2 C2   3 C0                                S01194
0145 I*******AND****  13 C1                                               S01194
0146 I**************                          1   1 RECI                  S01194
0147 I**************                         13  130SREC                  S01194
0148 I**************                         14  27 CCNM                  S01194
0149 I**************                      P  28  348SPOT                  S01194
0150 I**************                         35  37 CCYS                  S01194
0151 I**************                         38  380CDP                   S01194
0152 I**************                         39  390TNOT                  S01194
0153 I**************                         40  40 DCCY                  S01194
0154 I**************                         41  44 SRC1                  S01194
0155 I**************                         45  48 SRC2                  S01194
0156 I**************                         49  520TACC                  S01194
0157 I**************                         53  560TEQV                  S01194
0158 I**************                         57  600SWQV                  S01194
0159 I**************                         61  640TAC4                  S01194
0160 I**************                         65  680TAC5                  S01194
0161 I**************                         69  69 HIND                  S01194
0162 I**************                      P  70  768PART                  S01194
0163 I**************                         77  780SSNO                  S01194
0164 I**************                      P  79  858ERLC                  S01194
0165 I**************                      P  90  920LCD                   S01194
0166 I**************                         93  93 CHTP                  S01194
0167 I**************                      P  94  960TNLU                  S01194
0168 I********NS****                                                      S01194
0169 I*
0170 I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 1
0171 I*
0172 ICLOAN   NS  10   1 CD   8 CA
0173 I       OR   10   1 CM   8 CA
0174 I       OR   11   1 CR   8 CA
0175 I                                        1   1 RECI
0176 I**********                              2   70LNRF                                      CLE148
0177 I**********                              2   70LNRFD                                     CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        2   7 LNRFD                                     CLE148
0178 I                                        8   8 RCDT
0179 I                                        9   90MRIN
0180 I                                       10  110PTYP
0181 I*    FIELD NAME CHANGED FOR PROGRAM
0182 I**********                             12  170CNUML                                     CSD027
0182 I                                       12  17 CNUML                                     CSD027
0183 I**********                             18  200BRCD                  S01117
0183 I                                       18  20 BRCA                  S01117
0184 I                                       21  22 LTYP
0185 I                                       23  24 SUTP
0186 I                                    P  25  270DDAT
0187 I                                    P  28  300VDAT
0188 I                                    P  31  330MDAT
0189 I                                       34  350LASQ
0190 I**********                             36  410FCUS                                      CSD027
0190 I                                       36  41 FCUS                                      CSD027
0191 I                                       42  440FTYP
0192 I                                       45  460FSEQ
0193 I                                       47  49 CCYL
0194 I                                    P  50  560CPAM          24
0195 I                                       57  57 INTC
0196 I                                    P  58  637INTR
0197 I**********                             64  650BRTT                                      CSD103
0197 I                                       64  65 BRTT                                      CSD103
0198 I                                    P  66  717BRTE
0199 I                                    P  72  777RTSP
0200 I                                    P  78  815MARG
0201 I                                       82  82 SPIN
0202 I                                       83  83 CHIN
0203 I                                    P  84  897WTRT
0204 I                                       90  90 WTIN
0205 I                                       91  910REPT
0206 I                                    P  92  980RAMT
0207 I                                    P  99 1010NRPD
0208 I                                      102 102 RFRQ
0209 I                                      103 1040RDYN            22
0210 I                                      105 107 FCCY
0211 I                                      108 1100LIND
0212 I                                      111 112 CRSK
0213 I                                      113 114 ACOF
0214 I                                      115 115 NACD
0215 I                                      116 116 RELI
0216 I                                      117 117 AUTO
0217 I                                    P 118 1240PSAM
0218 I                                    P 125 1318BCXR
0219 I                                    P 132 1388FCXR
0220 I                                      139 1400SDST
0221 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 OSDAQQ                                    CGL029
0222 I                                      153 162 TSTN
0223 I                                      163 1640MDST
0224 I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 OMDAQQ                                    CGL029
0225 I                                      177 186 TMAN
0226 I                                      187 196 FACO
0227 I                                    P 197 1990RLDT
0228 I                                    P 200 2020NROD
0229 I                                      203 203 RLFQ
0230 I                                      204 2050RLDY
     I                                      206 206 RDFC                  S01392
0231 I**********                            207 2080NBRA                                      CSD103
0231 I                                      207 208 NBRA                                      CSD103
0232 I                                    P 209 2147NRTS
0233 I                                      215 215 NSIN
0234 I                                      216 2160NCAC
0235 I                                    P 217 2230AWTP
0236 I                                    P 224 2300WTRD
0237 I                                    P 231 2370WTWD
0238 I                                    P 238 2440IWOD
0239 I                                    P 245 2510PWOD
0240 I                                      252 252 BMDI
0241 I                                      253 253 FMDI
0242 I                                    P 254 2600PDIN
     I                                      271 273 ORBR                  S01117
0243 I                                      287 287 BTIN
0244 I                                      288 2890BLDY
0245 I**********                            290 2950OLNO                                      CSD027
0245 I                                      290 295 OLNO                                      CSD027
0246 I                                      296 296 RCSI
0247 I                                      297 2970ICBS
0248 I                                      298 298 IPFR
0249 I                                    P 299 3050TOTI
0250 I                                    P 306 3080NIDT
0251 I                                    P 309 3110IBDT
0252 I                                    P 312 3140SLID
0253 I                                    P 315 3210AIPD
0254 I                                    P 322 3240DLRC
0255 I                                    P 325 3270IACD
0256 I                                    P 328 3340AITC
0257 I                                    P 335 3410TFEP
0258 I                                    P 342 3480AIAP
0259 I                                    P 349 3550IPRD
0260 I                                    P 356 3620IPRM
0261 I                                    P 363 3690ICTD
0262 I                                    P 370 3760AIMN
0263 I                                    P 377 3790RBDT
0264 I                                      384 3850IFDY            23
0265 I                                      386 386 LONI
0266 I                                      387 387 CNFI
0267 I                                      388 388 ACEI
0268 I                                      389 389 TLXI
0269 I                                      390 390 CBLI
0270 I                                    P 391 3930ORED
0271 I                                    P 394 3960LCD
0272 I                                      397 397 CHTP
0273 I                                    P 398 4000TNLU
     I                                      401 401 ADDI                  S01392
     I                                      410 410 ADDIM                 128054
     I                                     12061206 LNKS                  CLE004
     I                                     12071207 MNSG                  CLE004
     I                                     12081208 GASS                  CLE004
     I**********                           121012150TOLN                               CLE004 CLE148
     I                                     12101215 TOLN                                      CLE148
     I*************************************13901407 OSDA                               CGL029 CLE042
     I*************************************14081425 OMDA                               CGL029 CLE042
     I                                     15611578 OSDA                                      CLE042
     I                                     15791596 OMDA                                      CLE042
     I**  BOOK CODE                                                       S01220
     I                                      435 436 BOKC                  S01220
     I                                     17621765 CLAS                                      CLE042
     I                                     17801782 LOIC                                      CER020
      *                                                                                       CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
0274 I        NS
0275 I**************                                                      S01194
0276 I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0277 I**************                                                      S01194
0278 I*CLINT***NS**10   1 CD   8 CA                                       S01194
0279 I*******OR*****   1 CC   8 CA                                        S01194
0280 I**************                          1   1 RECI                  S01194
0281 I**************                          2   70CNUM                  S01194
0282 I**************                          9  28 CRNM                  S01194
0283 I**************                         29  38 CTWN                  S01194
0284 I**************                         39  48 CSNM                  S01194
0285 I**************                         49  56 CASK                  S01194
0286 I**************                         57  68 TELX                  S01194
0287 I**************                         69  80 CSID                  S01194
0288 I**************                         81  82 ACOC                  S01194
0289 I**************                         83  83 CBSI                  S01194
0290 I**************                         84  85 CCTZ                  S01194
0291 I**************                         86  87 CLOC                  S01194
0292 I**************                         88  930CPAR                  S01194
0293 I*****FIELD*NAME CHANGED FOR PROGRAM                                 S01194
0294 I***********                            94  960BRCDC                 S01194
0295 I**************                         97  980LINS                  S01194
0296 I**************                         99 1010LIND                  S01194
0297 I**************                      P 102 1040DASU                  S01194
0298 I**************                      P 105 1070CDIC                  S01194
0299 I**************                      P 108 1100DADE                  S01194
0300 I**************                        111 111 CMIN                  S01194
0301 I**************                        112 112 CTYP                  S01194
0302 I**************                        113 124 TELF                  S01194
0303 I**************                        125 133 CHID                  S01194
0304 I****CLINT*FILE - CATCHALL                                           S01194
0305 I**************                                                      S01194
0306 I********NS****                                                      S01194
0307 I*
     I**  HISTORY FILE - LOAN HEADER
     I*   SEVERAL FIELD NAMES SUFFIXED WITH 'H' FOR THE PROGRAM
     I*
     IHISTSHMF    10
     I**************BRCD                            BRCDH                 S01117
     I              BRCA                            BRCDH                 S01117
     I              LNRF                            LNRFH
     I              VDAT                            VDATH
     I              LCD                             LCDH                                      260891
     I              CCY                             CCYH                  147492
     I              AMTP                            AMTPH
     I              PRAM                            PRAMH
     I              BRTE                            BRTEH
     I              RTSP                            RTSPH
     I              SPIN                            SPINH
     I              REPT                            REPTH
     I              INTC                            INTCH
     I              SUTP                            SUTPH                 BH3419
     I              CPAM                            CPAMH                 CLE004
     I              AITC                            AITCH                 117217
     I              INTR                            INTRH                 117217
     I              AIAP                            AIAPH                 117217
     I              IPRD                            IPRDH                 117217
     I              ACDA                            ACDAH                 157669
     I              COFR                            COFRH                 157669
     I              ACAP                            ACAPH                 157669
     I              COFD                            COFDH                 157669
     I              CLAS                            CLASH                                     CLE042
     I*
     I**  HISTORY FILE - AMOUNT DETAIL
     I*
     IHISTSHPF    10
     I**************BRCD                            BRCDH                 S01117
     I              BRCA                            BRCDH                 S01117
     I              LNRF                            LNRFH
     I              VDAT                            VDATH
     I              LCD                             LCDH                                      260891
     I              CCY                             CCYH                  147492
     I/COPY WNCPYSRC,LE0210IIP1                                           S01408
     I              AMTP                            AMTPH
     I              PRAM                            PRAMH
     I              INTA                            INTAH
     I              WTXA                            WTXAH
     I              FEAM                            FEAMH
     I              WOIN                            WOINH
     I              SUTP                            SUTPH                 BH3419
     I              CPAM                            CPAMH                 CLE004
     I              AITC                            AITCH                 117217
     I              INTR                            INTRH                 117217
     I              AIAP                            AIAPH                 117217
     I              IPRD                            IPRDH                 117217
     I              MNSG                            MNSGH                 CLE004
     I              GASS                            GASSH                 CLE004
     I              ROLN                            ROLNH                 CLE004
     I              ACDA                            ACDAH                 157669
     I              COFR                            COFRH                 157669
     I              ACAP                            ACAPH                 157669
     I              COFD                            COFDH                 157669
     I              CLAS                            CLASH                                     CLE042
     I*
     I**   HISTORY FILE - DETAIL RATES
     I*
     IHISTSHQF    10
     I**************BRCD                            BRCDH                 S01117
     I              BRCA                            BRCDH                 S01117
     I              LNRF                            LNRFH
     I              VDAT                            VDATH
     I              LCD                             LCDH                                      260891
     I              CCY                             CCYH                  CLE004
     I              AMTP                            AMTPH
     I              BRTE                            BRTEH
     I              RTSP                            RTSPH
     I              SPIN                            SPINH
     I              STAI                            STAIH
     I**   ADDITION OF INTEREST RATE CHANGE FLAG FOR 'SC' AMENDMENTS      CAC001
     I              IRCF                            IRCFH                 CAC001
     I              CPAM                            CPAMH                 CLE004
     I              AITC                            AITCH                 117217
     I              INTR                            INTRH                 117217
     I              AIAP                            AIAPH                 117217
     I              IPRD                            IPRDH                 117217
     I              MNSG                            MNSGH                 CLE004
     I              RLCY                            RLCYH                 CLE004
     I              ACDA                            ACDAH                 157669
     I              COFR                            COFRH                 157669
     I              ACAP                            ACAPH                 157669
     I              COFD                            COFDH                 157669
0396 I*
0397 I*    CUSTOMER LENDING LOAN AMENDMENTS FILE - DETAIL
0398 I*    SEVERAL FIELD NAMES SUFFIXED WITH 'L' FOR PROGRAM
0399 I*
0400 ILOAMS   NS  10   1 CD
0401 I                                        1   1 RECI
0402 I**********                              2   70LNRFL                                     CLE148
     I                                        2   7 LNRFL                                     CLE148
0403 I                                        8  120VDATL
0404 I                                       13  150LASN
0405 I                                       16  160MRIN
0406 I                                       17  18 LTYP
0407 I                                       19  20 SUTP
0408 I                                       21  220PTYP
0409 I                                       23  24 AMTPL
0410 I                                       25  260PRSQ
0411 I**********                             27  280BRTT                                      CSD103
0411 I                                       27  28 BRTT                                      CSD103
0412 I                                    P  29  347RTSPL
0413 I                                       35  37 CCY
0414 I                                    P  38  440PRAML
0415 I                                    P  45  510INTAL
0416 I                                    P  52  580WTXAL
0417 I                                    P  59  650FEAML
0418 I                                    P  66  720TAMTL
0419 I***********                            73  750BRCDL                 S01117
0419 I                                       73  75 BRCDL                 S01117
0420 I**********                             76  810CNUM                                      CSD027
0420 I                                       76  81 CNUM                                      CSD027
0421 I                                       82  820REPTL
0422 I                                       83  83 AUTO
0423 I                                       84  84 STAIL
0424 I                                       85  860SETPL
0425 I**********                             87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
0426 I                                       99 108 TSEN
0427 I                                      109 118 FACO
0428 I                                      119 148 SPI1
0429 I                                      149 178 SPI2
0430 I                                      179 208 SPI3
0431 I                                      209 209 LAIN
0432 I                                    P 210 2157BRTEL
0433 I                                      216 216 SPINL
0434 I                                      217 2170CALC
0435 I                                      218 218 WTIN
0436 I                                      219 219 LLAG
0437 I                                      220 220 LWOI
0438 I                                      221 2250XAVD
0439 I                                      226 2280XASQ
0440 I**********                            229 2340FCUS                                      CSD027
0440 I                                      229 234 FCUS                                      CSD027
0441 I                                      235 2370FTYP
0442 I                                      238 2390FSEQ
0443 I**********                            240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
0444 I                                      246 2470FECD
0445 I                                      248 248 PDNI
0446 I                                      249 249 ACTI
0447 I                                      250 250 CNFY
0448 I                                      251 251 TLXY
0449 I                                      252 252 CBLY
0450 I                                      253 253 INTCL
     I*                                                                   S01270
     I**   ADDITION OF MATURITY DATE FOR CHANGE OF SUB-TYPE FIELD         S01270
     I*                                                                   S01270
     I                                    P 267 2690LSMD                  S01270
     I*                                                                   S01270
0451 I                                    P 311 3130ORED
0452 I                                    P 314 3160LCD
0453 I                                      317 317 CHTP
0454 I                                    P 318 3200TNLU
     I**   ADDITION OF INTEREST RATE CHANGE FLAG FOR 'SC' AMENDMENTS      CAC001
     I                                      968 968 IRCFL                 CAC001
     I**********                            978 9830ROLNL                              CLE004 CLE148
     I                                      978 983 ROLNL                                     CLE148
     I                                     10761093 OSAC                                      CGL029
     I                                     12801283 CLAS                                      CLE042
0455 I        NS
0456 I**
0457 I**   DATA STRUCTURES - KEY TO LOAMS
0458 I**
0459 I            DS
0460 I                                        1  14 LOKEY
0461 I**********                              1   60LNRF                                      CLE148
     I                                        1   6 LNRF                                      CLE148
0462 I                                        7  110DATE
0463 I                                       12  140SEQU
0464 I**************                                                      S01194
0473 I*****KEY*FOR*CURRENCY DPS                                           S01194
0474 I**************                                                      S01194
0475 I************DS                                                      S01194
0476 I**************                          1  12 CCYKEY                S01194
0477 I**************                          9  11 CCYL                  S01194
     I*                                                                   S01194
     I**   TO REDEFINE THE FIELD PRINRO IN HISTSHQ RECORD AS CHAR FIELD   S01392
     I**                                                                  S01392
     I            DS                                                      S01392
     I                                        1  130PRINRO                S01392
     I                                        1  13 PRINX                 S01392
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              CAC001
      ** Module Details                                                   CAC001
      *                                                                   CAC001
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     I              A6NBDP                          CDP                   S01194
     I              A6CYCD                          DCCY                  S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I**  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              BBCRNM                          CRNM                  S01194
     I              BBCUST                          CNUMX                 S01194
0549 I**                                                                  S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     I**************BKALDI                          ACLD            S01194S01392
     I*
     ISCSARD    E DSSCSARDPD                                              CLE004
     I*/COPY*WNCPYSRC,LE0210I001************************************************
     I/COPY WNCPYSRC,LE0210I003
      ***  External data structures for SAR Details                       CLE004
      *                                                                   CLE004
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSLDY     E DSDSLDY                                                 CSD007
      ** Third DS for access programs, very long data structure           CSD007
      *                                                                   CSD007
0478 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION
0479 I**   AND FILE SIZE INPUT
0480 ILDA        UDS                            256
0481 I***********                           134 138 DBFILE                S01117
0482 I***********                           139 167 DBKEY                 S01117
0483 I***********                           168 175 DBPGM                 S01117
0484 I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
0485 I                                      251 2560ZFSIZE
     IPSDS       SDS
     I                                      244 246 WSID
     I*
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*                                                                   S01311
     IEMSDS     E DSEMDTA                                                 S01311
     I**  LINK ENQUIRY DATA AREA                                          S01311
     I                                      141 146 LOANNO                S01311
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY WNCPYSRC,LE0210I001
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I*                                                                   S01311
      ** If U1 on then MATURED LOANS ENQUIRY                                                  190005
      *                                                                                       190005
     C           *IN03     IFEQ '0'                                                           190005
     C           *INU1     IFEQ '1'                                                           190005
     C                     MOVE '1'       *IN79                                               190005
     C                     MOVE '1'       *IN85                                               190005
     C                     EXCPT                                                              190005
     C                     MOVE '0'       *IN85                                               190005
     C                     ELSE                                                               190005
     C                     MOVE '0'       *IN79                                               190005
     C                     END                                                                190005
     C                     END                                                                190005
      *                                                                                       190005
     C                     MOVEACPY@      BIS@   80
0486 C   03                READ LE0210FM                 04
0487 C  N03                SETON                     0302
0488 C                     SETOF                     04
0489 C   02                EXSR FIRST
0490 C                     TIME           MTIME   60
0491 C**
0492 C**   COMMAND KEY TESTS
0493 C**
0494 C                     SETOF                     444560
0495 C***KC******          SETON                     39                   S01311
0496 C***KC******          GOTO END                                       S01311
     C                     EXSR CMDSR                                     S01311
     C**
     C**   KEY FOR HISTORY FILE
     C**
     C           KEY       KLIST
     C***********          KFLD           BRCD                            S01117
     C                     KFLD           BRCA                            S01117
     C                     KFLD           CNUML
     C                     KFLD           LNRFD
     C                     KFLD           VDATH
     C                     KFLD           PRSQ
     C                     KFLD           LCDH                                                260891
     C                     KFLD           LASN
0028 F/COPY WNCPYSRC,LE0210CCP1                                           S01408
     C**
0498 C**   INVALID COMMAND KEYS
0499 C**
0500 C   08 31
0501 COR 09 30             EXSR INVCOM
0502 C   08 31
0503 COR 09 30             GOTO END
0504 C**
0505 C**   ROLLUP - NEXT SCREEN REQUESTED
0506 C**
0507 C   08                SETON                     71
0508 C   08                EXCPT
0509 C   08                SETOF                     71
0510 C***08******          MOVE BLANKS    ERMSG                           S01117
0510 C   08                MOVE *BLANKS   ERMSG                           S01117
0511 C**
0512 C   08 21             EXSR SRLOHS
0513 C   08 50             EXSR SRHIST
0514 C   08N50N21          EXSR SRLOMS
0515 C**
0516 C   08 37 50
0517 COR 08N21N50
0518 CAN 34
0519 COR 08 21 37
0520 CAN 34                SETON                     31    COMPLETE
0521 C***08*31***          MOVE MSG,6     ERMSG                           S01117
0521 C   08 31             MOVELMSG,6     ERMSG                           S01117
0522 C**
0523 C   08                SETOF                     3040
0524 C***08N31***          MOVE MSG,7     CMSG   41                       S01117
0525 C***08*31***          MOVE MSG,9     CMSG                            S01117
0524 C   08N31             MOVELMSG,7     CMSG   41                       S01117
0525 C   08 31             MOVELMSG,9     CMSG                            S01117
0526 C**
0527 C**   ROLLDOWN - FIRST SCREEN REQUESTED
0528 C**
0529 C   09                Z-ADDFDATE     CDATE
0530 C   09                SETON                     7130
0531 C   09                EXCPT
0532 C   09                SETOF                     713437
0533 C   09                SETOF                     808182
0534 C   09                SETOF                     83
     C   09                SETOF                     84                   S01392
0535 C**
0536 C   09 21             EXSR SRLOHS
0537 C   09 50             EXSR SRHIST
0538 C   09N50N21          EXSR SRLOMS
0539 C**
0540 C   09                SETOF                     3140
0541 C***09******          MOVE MSG,8     CMSG                            S01117
0542 C***09******          MOVE BLANKS    ERMSG                           S01117
     C   09                MOVELMSG,8     CMSG                            S01117
     C   09                MOVE *BLANKS   ERMSG                           S01117
0543 C**
0544 C   09
0545 COR 08                GOTO END
0546 C**
0547 C**   NEW ENQUIRY
0548 C**
     C   05
0549 COR 01                EXSR VALDTE
0550 C           END       TAG                             ** END TAG ****
     C/COPY WNCPYSRC,LE0210C004
     C   39                SETON                     LR
0551 C   U7                MOVE 'LE0210'  DBPGM
      **                                                                  S01117
      **   EXCUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                  S01117
      **                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
      *                                                                   S01117
0552 C********************************************************************
0553 C*                                                                  *
0554 C*    VALIDATE SR. TO VALIDATE SCREEN INPUT                         *
0555 C*                                                                  *
0556 C*            ROUTINE CALLED FROM - MAIN PROCESSING
0557 C*            ROUTINE CALLS - ZDATE1,ZDATE2 (3),SRLOHS,SRLOMS,SRHIST
0558 C*                            GLINTC
0559 C           VALDTE    BEGSR                           ** VALDTE BEGSR
0560 C**
0561 C                     SETON                     30
0562 C                     SETOF                     414243
0563 C                     SETOF                     463134
0564 C                     SETOF                     378081
0565 C                     SETOF                     828329
     C                     SETOF                     84                   S01392
0566 C***********          MOVE BLANKS    CMSG                            S01117
0567 C***********          MOVE BLANKS    ERMSG                           S01117
     C                     MOVE *BLANKS   CMSG                            S01117
     C                     MOVE *BLANKS   ERMSG                           S01117
0568 C**
0569 C**   LOAN REF. - MUST BE ON CLOAN FILE
0570 C**
0571 C                     MOVELLNIN      CLOKEY
0572 C                     SETOF                     381011
0573 C           CLOKEY    CHAINCLOAN                38
0574 C**N10N11***          MOVELMSG,1     ERMSG  43                       S01117
     C  N10N11             MOVELMSG,1     ERMSG  78                       S01117
0575 C  N10N11             SETON                     41
0576 C  N10N11             GOTO ERTAG
0577 C   11                SETON                     29
      *                                                                   128054
      * Set up additional days indicator if a matured loan                128054
     C           RECI      IFEQ 'M'                                       128054
     C                     MOVE ADDIM     ADDI                            128054
     C                     ENDIF                                          128054
     C**                                                                  S01392
     C**   ROUND DOWN INTEREST IF REQD                                    S01392
     C           RDFC      COMP 'Y'                      14               S01392
     C*                                                                   S01117
     C*    IF MULTIBRANCHING = YES, CHECK USERS ACCESS TO BOOKING BRANCH  S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
      *                                                                   S01117
     C                     CALL 'ZVBBU'                                   S01117
     C                     PARM BRCA      @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE 0                                         S01117
     C                     SETON                     41                   S01117
     C           @ERR      IFEQ 1                                         S01194
     C                     MOVELMSG,10    ERMSG                           S01117
     C                     END                                            S01194
     C           @ERR      IFEQ 2                                         S01194
     C                     MOVELMSG,11    ERMSG                           S01194
     C                     END                                            S01194
     C                     GOTO ERTAG                                     S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
0578 C**
0579 C**   DATE - IF ENTERED MUST BE VALID
0580 C**
0581 C   20                MOVE 'START  ' ACTDY   7
0582 C   20                GOTO CODEVL
0583 C**
0584 C                     MOVE DTIN      WK60    60
0585 C                     MOVE WK60      WK6     6
0586 C           WK6       COMP DTIN                 4242
0587 C   42                MOVELMSG,2     ERMSG
0588 C   42                GOTO ERTAG
0589 C**
0590 C                     MOVE DTIN      ZDATE
0591 C                     EXSR ZDATE1
0592 C   99                MOVELMSG,2     ERMSG
0593 C   99                SETON                     42
0594 C   99                GOTO ERTAG
0595 C**
0596 C                     EXSR ZDATE2
0597 C                     MOVE ZADATE    ACTDY
0598 C**
0599 C**   CODE - IF ENTERED MUST BE H,B,F,P
0600 C**
0601 C           CODEVL    TAG                             ** CODEVL TAG *
0602 C           CDIN      COMP ' '                      21
0603 C           CDIN      COMP 'H'                      50
0604 C           CDIN      COMP 'P'                      51
0605 C           CDIN      COMP 'F'                      52
0606 C           CDIN      COMP 'B'                      53
0607 C  N50N51N52
0608 CANN53N21             SETON                     43
0609 C   43                MOVELMSG,3     ERMSG
0610 C   43                GOTO ERTAG
0611 C**
0612 C**   VALIDATE DATE/CODE COMBINATION
0613 C**
0614 C   21
0615 COR 20                GOTO ENDVL
0616 C   50
0617 COR 51
0618 COR 53      ZDAYNO    COMP RUND                 46  46
0619 C   52      ZDAYNO    COMP RUND                   46
0620 C   46                SETON                     4243
0621 C   46                MOVELMSG,4     ERMSG
0622 C   46                GOTO ERTAG
0623 C           ENDVL     TAG                             ** ENDVL TAG **
0624 C**
0625 C                     Z-ADD0         CDATE   50
0626 C                     Z-ADD0         FDATE   50
0627 C   20 52             Z-ADDRUND      CDATE
0628 C   20 52             Z-ADDRUND      FDATE
0629 C   20 52             MOVE RUNA      ACTDY
0630 C  N20                Z-ADDZDAYNO    CDATE
0631 C  N20                Z-ADDZDAYNO    FDATE
0632 C**
0633 C**   CONVERT DATES
0635 C                     Z-ADDNRPD      ZDAYNO
0636 C                     EXSR ZDATE2
0637 C                     MOVE ZADATE    NRPDA   7
0638 C**
0639 C                     Z-ADDNIDT      ZDAYNO
0640 C                     EXSR ZDATE2
0641 C                     MOVE ZADATE    NIDTA   7
     C**                                                                  S01392
     C**   DISPLAY NEXT ROLLOVER DATE                                     S01392
     C***********          Z-ADDNROD      ZDAYNO                    S01392073003
     C                     Z-ADDRLDT      ZDAYNO                          073003
     C                     EXSR ZDATE2                                    S01392
     C                     MOVE ZADATE    SNROD   7                       S01392
0642 C**
0643 C           MDAT      COMP 0                        35
0644 C   35                MOVE 'AT CALL' MDATA   7
0645 C  N35                Z-ADDMDAT      ZDAYNO
0646 C  N35                EXSR ZDATE2
0647 C  N35                MOVE ZADATE    MDATA
0648 C**
0649 C**   CALCULATE INTEREST TO TODAYS DATE
0650 C**
0651 C**    IF STOP ACCRUALS IND. IS ON, BYPASS THESE CALCS.
0652 C**
0653 C                     TESTB'3'       LONI           27
0654 C   27                GOTO STOPAC
0655 C**
0656 C**   IF LOAN NOT YET STARTED BYPASS INTEREST CALCS
0657 C**
0658 C           VDAT      COMP RUND                 27
0659 C   27                GOTO STOPAC
     C**
     C**   IF LOAN HAS GONE PAST DUE, ADD PDIN, AIAP, AIMN TO GET
     C**   INOUT AMOUNT.  SKIP CALCULATION OF INTEREST FROM IACD TO MDAT.
     C**
     C           RECI      COMP 'D'                      28
     C***28******MDAT      COMP IACD                   2727               E81164
     C   28      MDAT      COMP IACD                   27                 E81164
     C   28 27   MDAT      COMP 0                    2727
     C   28 27   AIAP      ADD  AIMN      INOUT
     C   28 27   PDIN      ADD  INOUT     INOUT
     C   28 27             GOTO SUBTRT
     C**
0660 C                     Z-ADD0         ZINTR
0661 C   24                GOTO INTTAG
0662 C                     Z-ADDIACD      ZIBEG
0663 C           MDAT      COMP 0                        27
0664 C     N27   RUND      COMP MDAT                   27
0665 C      27             MOVE RUND      ZIEND
0666 C     N27             MOVE MDAT      ZIEND
     C/COPY WNCPYSRC,LE0210C005
0667 C***CHECK*IF FIRST DAY ACCRUALS
0668 C***IF*SO*ADD EXTRA DAYS INTEREST
0669 C*****UNLESS*MATURITY DATE TODAT OR PAST
0670 C***********ACLD      COMP 'Y'                  2828
0671 C***28******RUND      COMP MDAT                   28
0672 C******28***ZIEND     ADD  1         ZIEND
0673 C*******                                                             S01392
0674 C*****CHECK FOR FIRST DAY ACCRUALS AND CALL LOAN                     S01392
0675 C*****                                                               S01392
0676 C*****      ACLD      COMP 'Y'                  2828                 S01392
0677 C***28      MDAT      COMP 0                        28               S01392
0678 C***28      ZIEND     ADD  1         ZIEND                           S01392
      *                                                                   S01392
      * adjust end date according to 'additional day indicator'           S01392
     C                     Z-ADDMDAT      ZMDAT                           S01392
     C***********          EXSR ZFLDC                              S01392 143510
     C**********           Z-ADDVDAT      ZVDAT                                        S01392 245082
     C                     Z-ADDMDAT      ZMDAT                                               245082
     C                     EXSR ZFLAC                                     S01392
      *                                                                   S01392
0679 C                     MOVE ICBS      ZICALC
0680 C                     Z-ADDCPAM      ZIAMT
0681 C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,LE0210C006
0682 C                     EXSR GLINTC
     C/COPY WNCPYSRC,LE0210C007
     C**                                                                  S01392
     C**   ROUND DOWN INTEREST IF REQD                                    S01392
     C   14                Z-ADDZINTR     RDWORK 130                      S01392
     C   14                Z-ADDRDWORK    ZINTR                           S01392
0683 C**
0684 C**   CALCULATE INTEREST OUTSTANDING
0685 C**
0686 C           INTTAG    TAG                             ** INTTAG TAG *
0687 C           ZINTR     ADD  AITC      INOUT  130H
0688 C           INOUT     ADD  AIAP      INOUT
0689 C           INOUT     ADD  AIMN      INOUT
0690 C                     GOTO SUBTRT
0691 C           STOPAC    TAG                             ** STOPAC TAG *
     C           AITC      ADD  AIAP      INOUT
     C           INOUT     ADD  AIMN      INOUT
0693 C           SUBTRT    TAG                             ** SUBTRT TAG *
0694 C           INOUT     SUB  IWOD      INOUT
0695 C           INOUT     SUB  IPRD      INOUT
0696 C           INOUT     SUB  ICTD      INOUT
     C/COPY WNCPYSRC,LE0210C010
0697 C**
0698 C**   CHAIN FOR CURRENCY DPS
0699 C**
0700 C**************       SETOF                     3810                 S01194
0701 C***********CCYKEY    CHAINTABLE                38                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYL      K101    3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
0702 C**N10*********       MOVE 'TABLE'   DBFILE                          S01194
0703 C**N10*********       MOVE CCYKEY    DBKEY                           S01194
0704 C**N10*********       Z-ADD2         DBASE            DBASE 2        S01194
0705 C**N10*********       SETON                     39U7U8               S01194
0706 C**N10*********       GOTO VEND                                      S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDCURRPD'DBFILE                          S01194
0703 C                     MOVE CCYL      DBKEY                           S01194
0704 C                     Z-ADD2         DBASE            DBASE 2        S01194
0705 C                     SETON                     39U7U8               S01194
0706 C                     GOTO VEND                                      S01194
     C                     END                                            S01194
0707 C**
0708 C           CDP       COMP 1                      6162
0709 C           CDP       COMP 2                    64  63
0710 C**
0711 C**   CHAIN TO CLINT FOR CLIENT NAME
0712 C**
0713 C**************       MOVELCNUML     CLIKEY                          S01194
0713 C                     MOVELCNUML     KEYC   10                       S01194
0714 C                     SETOF                     10                   S01194
0714 C**********           SETOF                     3810                 S01194
0715 C***********CLIKEY    CHAINCLINT                38                   S01194
     C***********          CALL 'AOCUSTR0'                         S01194 CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC                            S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C***********SDCUST    PARM SDCUST    DSSDY                    S01194 CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
     C*                                                                   S01194
0716 C**N10*********       SETON                     39U7U8               S01194
0717 C**N10*********       MOVE 'CLINT'   DBFILE                          S01194
0718 C**N10*********       MOVE CLIKEY    DBKEY                           S01194
0719 C**N10*********       Z-ADD3         DBASE            DBASE 3        S01194
0720 C**N10*********       GOTO VEND                                      S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           CSD007    ANDNE'Y'                                       CSD007
      *                                                                   CSD007
     C           @RTCD     ORNE *BLANKS                                   CSD007
     C           @RTCD     ANDEQ'*NRF   '                                 CSD007
     C           BBDTDL    ANDNE*ZEROS                                    CSD007
     C           CSD007    ANDEQ'Y'                                       CSD007
      *                                                                   CSD007
     C           @RTCD     ORNE *BLANKS                                   CSD007
     C           @RTCD     ANDNE'*NRF   '                                 CSD007
     C           CSD007    ANDEQ'Y'                                       CSD007
      *                                                                   CSD007
0716 C                     SETON                     39U7U8               S01194
0717 C                     MOVE 'SDCUSTPD'DBFILE                          S01194
0718 C                     MOVE CNUML     DBKEY                           S01194
0719 C                     Z-ADD3         DBASE            DBASE 3        S01194
0720 C                     GOTO VEND                                      S01194
     C                     END                                            S01194
0721 C**
0722 C**   TEST FOR CAPITALISATION
0723 C**
0724 C           INTC      COMP 'Y'                      56
0725 C   56                MOVE 'YES'     CAPI    3
0726 C  N56                MOVE ' NO'     CAPI
      *                                                                   CLE004
      ** If SAR CLE004 is Present                                         CLE004
      *                                                                   CLE004
     C           *IN78     IFEQ *ON                                       CLE004
      *                                                                   CLE004
      ** Check for 'Transaction from'                                     CLE004
      *                                                                   CLE004
     C********** TOLN      IFEQ *ZERO                                                  CLE004 CLE148
     C           TOLN      IFEQ *BLANKS                                                       CLE148
     C                     MOVE *BLANKS   TOLNA   6                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVELTOLN      TOLNA                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Check for Indicator Values (LNKS/MNSG/GASS)                      CLE004
      *                                                                   CLE004
     C                     MOVEA'000000'  *IN,72                          CLE004
      *                                                                   CLE004
     C           LNKS      IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN72                           CLE004
     C                     MOVE *ON       *IN73                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           LNKS      IFEQ 'N'                                       CLE004
     C                     MOVE *ON       *IN73                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           MNSG      IFEQ 'S'                                       CLE004
     C                     MOVE *ON       *IN74                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C********** GASS      IFEQ 'Y'                                                    CLE004 CLE106
     C           GASS      IFEQ 'A'                                                           CLE106
     C                     MOVE *ON       *IN75                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
0991 C*
     C**  IF THE PROCESSING TYPE IS 64 OR 65 AND THE RECOURSE INDICATOR   S01270
     C**  IS EQUAL TO 'Y' THEN OUTPUT THE 'ORIGINAL BORROWER' DETAILS     S01270
     C*
     C                     SETOF                     57
     C           PTYP      IFEQ 64
     C           PTYP      OREQ 65
     C           RCSI      IFEQ 'Y'
     C                     EXSR ORIGSR
     C                     END
     C                     END
     C**                                                                  S01311
     C**   SET ON INDICATORS TO CONDITION SCREEN TITLE FOR LOANS,         S01311
     C**   PARTICIPATIONS PURCHASED, PARTICIPATIONS SOLD, GUARANTEES      S01311
     C**   ISSUED                                                         S01311
     C                     SETOF                     161718               S01311
     C                     SETOF                     19                   S01311
     C           PTYP      IFEQ 61                                        S01311
     C           PTYP      OREQ 62                                        S01311
     C           PTYP      OREQ 63                                        S01311
     C                     SETON                     16                   S01311
     C                     END                                            S01311
     C*                                                                   S01311
     C           PTYP      IFEQ 64                                        S01311
     C           PTYP      OREQ 65                                        S01311
     C                     SETON                     17                   S01311
     C                     END                                            S01311
     C*                                                                   S01311
     C           PTYP      IFEQ 66                                        S01311
     C           PTYP      OREQ 67                                        S01311
     C                     SETON                     18                   S01311
     C                     END                                            S01311
     C*                                                                   S01311
     C           PTYP      IFEQ 70                                        S01311
     C                     SETON                     19                   S01311
     C                     END                                            S01311
      *                                                                   CLE005
      ** If CLE005 is *ON do additional processings for new               CLE005
      ** loan processing types by switching the proper                    CLE005
      ** participations purchase/sold indicator.                          CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           PTYP      OREQ 71                                        CLE005
     C           RCSI      IFEQ 'Y'                                       CLE005
     C                     EXSR ORIGSR                                    CLE005
     C                     ENDIF                                          CLE005
     C                     MOVE *ON       *IN17                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE *ON       *IN18                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
     C*
0727 C**
0728 C**   OUTPUT HEADINGS AND LOAN DETAILS
0729 C**
0730 C                     SETON                     71
0731 C                     EXCPT
0732 C                     SETOF                     71
0733 C**
0734 C   21                EXSR SRLOHS
0735 C   50                EXSR SRHIST
0736 C  N21N50             EXSR SRLOMS
0737 C**
0738 C   37 50
0739 CORN21N50 34
0740 COR 34 37 21          SETON                     31
0741 C***31******          MOVE MSG,6     ERMSG            COMPLETE       S01117
0741 C   31                MOVELMSG,6     ERMSG            COMPLETE       S01117
0742 C**
0743 C**   SET UP CMSG FIELD
0744 C**
0745 C***31******          MOVE BLANKS    CMSG                            S01117
0746 C**N31******          MOVE MSG,8     CMSG                            S01117
0745 C   31                MOVE *BLANKS   CMSG                            S01117
0746 C  N31                MOVELMSG,8     CMSG                            S01117
0747 C                     SETOF                     40
0748 C                     GOTO VEND
0749 C**
0750 C           ERTAG     TAG                             ** ERTAG TAG **
     C*                                                                   S01311
     C**   IF PROGRAM CALLED AS LINKED ENQUIRY, DISPLAY ERROR MESSAGE     S01311
     C**   ON DETAIL SCREEN                                               S01311
     C           MODID     IFEQ 'LE'                                      S01311
     C                     SETON                       4445               S01311
     C                     SETON                       3031               126087
     C*                                                                   S01311
     C**   OTHERWISE, DISPLAY ERROR MESSAGE ON FIRST SCREEN               S01311
     C                     ELSE                                           S01311
0751 C                     SETON                     404445
     C                     END                                            S01311
0752 C**
0753 C           VEND      ENDSR                           ** VEND ENDSR *
0754 C*                                                                  *
0755 C********************************************************************
0756 C********************************************************************
0757 C*                                                                  *
0758 C*    INVCOM SR. TO PROCESS INVALID COMMAND KEYS                    *
0759 C*                                                                  *
0760 C*            ROUTINE CALLED FROM - MAIN PROCESSING
0761 C           INVCOM    BEGSR                           ** INVCOM BEGSR
0762 C**
0763 C                     MOVELMSG,5     ERMSG
0764 C                     SETON                     4445
0765 C                     SETOF                     40
0766 C                     ENDSR
0767 C*                                                                  *
0768 C********************************************************************
0769 C********************************************************************
0770 C*                                                                  *
0771 C*    RDLOMS SR. TO READ LOAMS FILE                                 *
0772 C*                                                                  *
0773 C*            ROUTINE CALLED FROM - SRLOHS,SRLOMS
0774 C           RDLOMS    BEGSR                           ** RDLOMS BEGSR
0775 C**
     C                     MOVE SUTP      WLSUTP  2                       BH3419
     C                     MOVE CLAS      WLCLAS  4                                           CLE042
     C*                                                                   BH3419
0776 C                     SETOF                     3810
0777 C                     READ LOAMS                    38
0778 C                     ENDSR
0779 C*                                                                  *
0780 C********************************************************************
0769 C********************************************************************
0770 C*                                                                  *
0771 C*    RDHIST SR. TO READ HISTS FILE                                 *
0772 C*                                                                  *
0773 C*            ROUTINE CALLED FROM - SRLOHS,SRLOMS
0774 C           RDHIST    BEGSR                           * RDHIST BEGSR
0775 C**
     C                     MOVE SUTPH     WHSUTP  2                       BH3419
     C                     MOVE CLASH     WHCLAS  4                                           CLE042
     C*                                                                   BH3419
0776 C                     SETOF                     3810
0777 C                     READ HISTR                    38
0778 C                     ENDSR
0779 C*                                                                  *
0780 C********************************************************************
0781 C*                                                                  *
0791 C********************************************************************
0792 C********************************************************************
0793 C*                                                                  *
0794 C*    SRHIST SR. TO SEARCH HISTORY FILE FOR RELEVANT DETAILS        *
0795 C*                                                                  *
0796 C*            ROUTINE CALLED FROM - MAIN PROCESSING,VALDTE
0797 C*            ROUTINE CALLS - OUTH (2)
0798 C           SRHIST    BEGSR                           ** SRHIST BEGSR
0799 C***********          Z-ADD10        V       20                      S01117
     C***********          Z-ADD10        VSLN    20               S01117 CLE004
     C                     Z-ADD11        VSLN    20                      CLE004
0800 C**
0801 C**   SET UP KEY AND CHOP FOR RECORD
0802 C**
0803 C   08                EXSR OUTH
     C                     Z-ADD0         VDATH
     C                     Z-ADD0         PRSQ
     C                     Z-ADD0         LCDH                                                260891
     C                     Z-ADD0         LASN
     C  N08      KEY       SETLLHISTR
0805 C           LOOPH     TAG                             ** LOOPH  TAG *
     C                     EXSR RDHIST
0807 C   38                SETON                     37
0808 C  N37      LNRF      COMP LNRFH                3737
0809 C   37                GOTO SHEND
0810 C**
0812 C  N10                GOTO LOOPH
0813 C**
0814 C           VDATH     COMP CDATE                  35
0816 C   35                GOTO LOOPH
0817 C**
0818 C                     EXSR OUTH
0820 C   80                GOTO SHEND
0821 C  N60                GOTO LOOPH
0822 C**
0823 C**   CHECK FOR COMPLETE
0824 C**
0825 C           LOOPH2    TAG                             ** LOOPH2 TAG *
     C                     EXSR RDHIST
0827 C   38                SETON                     37
     C   37                GOTO SHEND
     C  N10                GOTO LOOPH2
0828 C  N37      LNRF      COMP LNRFH                3737
0830 C**
0831 C           SHEND     ENDSR
0832 C*                                                                  *
0833 C********************************************************************
0834 C********************************************************************
0835 C*                                                                  *
0836 C*    SRLOMS SR. TO SEARCH LOAMS FILE FOR RELEVANT DETAILS          *
0837 C*                                                                  *
0838 C*            ROUTINE CALLED FROM - MAIN PROCESSING,VALDTE
0839 C*            ROUTINE CALLS - RDLOMS (2),OUTL
0840 C           SRLOMS    BEGSR                           ** SRLOMS BEGSR
0841 C***********          Z-ADD10        V                               S01117
     C***********          Z-ADD10        VSLN                     S01117 CLE004
     C                     Z-ADD11        VSLN    20                      CLE004
0842 C**
0843 C**   SET UP KEY AND READ RECORDS
0844 C**
0845 C   08                GOTO LOOPL1
0846 C                     Z-ADDCDATE     DATE
0847 C                     Z-ADD0         SEQU
0848 C           LOKEY     SETLLLOAMS
0849 C           LOOPL     TAG                             ** LOOPL TAG **
0850 C                     EXSR RDLOMS
0851 C   38                SETON                     34
0852 C   34                GOTO SLEND
0853 C  N10                GOTO LOOPL
0854 C           LNRFL     COMP LNRF                 3434
0855 C   34                GOTO SLEND
0856 C**
0857 C**   CHECK RECORD VIS-A-VIS CODE ENTERED
0858 C**   P - PAST DUE - MUST BE TYPE PD
0859 C**
0860 C           LOOPL1    TAG                             ** LOOPL1 TAG *
0861 C   51      AMTPL     COMP 'PD'                 3535
0862 C   51 35             GOTO LOOPL
0863 C**
0864 C**   B - BACK VALUED - MUST BE PRIOR TO TODAY, AND NOT 'PD'
0865 C**
0866 C   53      VDATL     COMP RUND                 35  35
0867 C   53N35   AMTPL     COMP 'PD'                     35
0868 C   53 35             GOTO LOOPL
0869 C**
0870 C                     EXSR OUTL
0871 C   80                GOTO SLEND
0872 C  N60                GOTO LOOPL
0873 C**
0874 C**   CHECK FOR COMPLETE
0875 C**
0876 C           LOOPL2    TAG                             ** LOOPL2 TAG *
0877 C                     EXSR RDLOMS
0878 C   38                SETON                     34
0879 C   34                GOTO SLEND
0880 C  N10                GOTO LOOPL2
0881 C           LNRF      COMP LNRFL                3434
0882 C**
0883 C           SLEND     ENDSR
0884 C*                                                                  *
0885 C********************************************************************
0886 C********************************************************************
0887 C*                                                                  *
0888 C*    SRLOHS SR. TO SEARCH LOAMS AND HISTS FOR ACTIVITY             *
0889 C*                                                                  *
0890 C*            ROUTINE CALLED FROM - MAIN PROCESSING,VALDTE
0891 C*            ROUTINE CALLS - RDLOMS (3),OUTH (2),OUTL(2)
0893 C           SRLOHS    BEGSR                           ** SRLOHS BEGSR
0894 C***********          Z-ADD10        V                               S01117
     C***********          Z-ADD10        VSLN                     S01117 CLE004
     C                     Z-ADD11        VSLN    20                      CLE004
0895 C**
0896 C**   ASCERTAIN WHETHER THERE IS ACTIVITY ON EITHER FILE
0897 C**   1 - LOAMS
0898 C**
0899 C   08                GOTO LOPS3
0900 C                     Z-ADDCDATE     DATE
0901 C                     Z-ADD0         SEQU
0902 C           LOKEY     SETLLLOAMS
0903 C           LOPS1     TAG                             ** LOPS1 TAG **
0904 C                     EXSR RDLOMS
0905 C   38                SETON                     34
0906 C  N10N34             GOTO LOPS1
0907 C  N34      LNRFL     COMP LNRF                 3434
0908 C**
0909 C**   2 - HISTS
0910 C**
     C                     Z-ADD0         VDATH
     C                     Z-ADD0         PRSQ
     C                     Z-ADD0         LCDH                                                260891
     C                     Z-ADD0         LASN
     C           KEY       SETLLHISTR
0912 C           LOPS2     TAG                             ** LOPS2 TAG **
     C                     EXSR RDHIST
0914 C   38                SETON                     37
0916 C  N10N37             GOTO LOPS2
0917 C  N37      LNRFH     COMP LNRF                 3737
0918 C   37                GOTO LOPS3
0919 C**
0920 C           VDATH     COMP CDATE                  35
0922 C   35                GOTO LOPS2
0923 C**
0924 C           LOPS3     TAG                             ** LOPS3 TAG **
0925 C   34 37
0926 COR 60                GOTO SREND
0927 C**
0928 C**   NO LOAMS - OUTPUT HISTS DETAIL AND READ NEXT
0929 C**
0930 C   34                EXSR OUTH
0931 C   34 80             GOTO SREND
0932 C           LOPS4     TAG                             ** LOPS4 TAG **
0934 C   34                EXSR RDHIST
0935 C   34N10N38          GOTO LOPS4
0936 C   34 38             SETON                     37
0937 C   34N37   LNRF      COMP LNRFH                3737
0938 C   34                GOTO LOPS3
0939 C**
0940 C**   NO HISTS - OUTPUT LOAMS DETAIL AND READ NEXT
0941 C**
0942 C   37                EXSR OUTL
0943 C   37 80             GOTO SREND
0944 C           LOPS5     TAG                             ** LOPS5 TAG **
0945 C   37                EXSR RDLOMS
0946 C   37 38             SETON                     34
0947 C   37N10N34          GOTO LOPS5
0948 C   37N34   LNRF      COMP LNRFL                3434
0949 C   37                GOTO LOPS3
0950 C**
0951 C**   DETAILS ON BOTH FILES
0952 C**
0953 C           VDATH     COMP VDATL                323333
0954 C**
0955 C**   LOAM EARLIER
0956 C**
0957 C   32                EXSR OUTL
0958 C   32 80             GOTO SREND
0959 C           LOPS6     TAG                             ** LOPS6 TAG **
0960 C   32                EXSR RDLOMS
0961 C   32 38             SETON                     34
0962 C   32N34N10          GOTO LOPS6
0963 C   32N34   LNRF      COMP LNRFL                3434
0964 C   32                GOTO LOPS3
0965 C**
0966 C**   HIST EARLIER
0967 C**
0968 C   33                EXSR OUTH
0969 C   33 80             GOTO SREND
0970 C           LOPS7     TAG                             ** LOPS7 TAG **
0972 C   33                EXSR RDHIST
0973 C   33 38             SETON                     37
0974 C   33N37N10          GOTO LOPS7
0975 C   33N37   LNRF      COMP LNRFH                3737
0976 C   33                GOTO LOPS3
0977 C**
0978 C           SREND     ENDSR                           ** SREND ENDSR
0979 C*                                                                  *
0980 C********************************************************************
0981 C********************************************************************
0982 C*                                                                  *
0983 C*    OUTH SR. TO SET UP AMOUNT AND NARRATIVE FIELDS FOR HISTS      *
0984 C*                                                                  *
0985 C*            ROUTINE CALLED FROM - SRHIST,SRLOHS
0986 C*            ROUTINE CALLS - OUTHR (23),CHECKH (9)
0987 C           OUTH      BEGSR                           ** OUTH BEGSR
0988 C                     Z-ADD0         SPO
0989 C                     Z-ADD0         AMTO
     C                     MOVE '   '     CURR    3                       147492
0990 C                     SETOF                     66
0990 C                     SETOF                     67                   S01270
      *                                                                   CLE004
      ** If SAR CLE004 is Present                                         CLE004
      *                                                                   CLE004
     C           *IN78     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C                     MOVEA'00'      *IN,76                          CLE004
      *                                                                   CLE004
      ** Format Fields                                                    CLE004
      *                                                                   CLE004
     C           MNSGH     IFEQ 'S'                                       CLE004
     C                     MOVE *ON       *IN76                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C********** GASSH     IFEQ 'Y'                                                    CLE004 CLE106
     C           GASSH     IFEQ 'A'                                                           CLE106
     C                     MOVE *ON       *IN77                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Setup Narrative                                                  CLE004
      *                                                                   CLE004
     C           AMTPH     IFEQ 'PF'                                      CLE004
     C                     MOVE NARR,42   NARO                            CLE004
     C                     MOVELROLNH     #ROLN  16                       CLE004
     C                     MOVE #ROLN     NARO                            CLE004
     C                     Z-ADDPRAMH     AMTO                            CLE004
     C           CEU020    IFEQ 'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C                     EXSR OUTHR                                     CLE004
     C                     GOTO HEND                                      CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           AMTPH     IFEQ 'PT'                                      CLE004
     C                     MOVE NARR,43   NARO                            CLE004
     C                     MOVELROLNH     #ROLN  16                       CLE004
     C                     MOVE #ROLN     NARO                            CLE004
     C                     Z-ADDPRAMH     AMTO                            CLE004
     C           CEU020    IFEQ 'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C                     EXSR OUTHR                                     CLE004
     C                     GOTO HEND                                      CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           AMTPH     IFEQ 'MC'                                      CLE004
     C           *IN81     IFEQ *OFF                                      183577
     C                     MOVE NARR,44   NARO                            CLE004
     C                     MOVELCCYH      #CCY    6                       CLE004
     C                     MOVE 'TO'      #CCY                            CLE004
     C                     MOVELRLCYH     #RLCY   5                       CLE004
     C                     MOVEL#CCY      #LCY   11                       CLE004
     C                     MOVE #RLCY     #LCY                            CLE004
     C                     MOVE #LCY      NARO                            CLE004
     C                     Z-ADDCPAMH     AMTO                            CLE004
     C           CEU020    IFEQ 'Y'                                       147492
     C                     MOVE RLCYH     CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C                     EXSR OUTHR                                     CLE004
     C                     SETON                     8081                 183577
     C   60                EXSR CHECKH                                    183577
     C   60                GOTO HEND                                      183577
     C                     ENDIF                                          183577
      *                                                                   144916
      ** Multi-ccy rollover - rate                                        144916
      *                                                                   144916
     C           BRTEH     IFGT 0                                         144916
     C           RTSPH     ORGT 0                                         144916
      *                                                                   144916
     C           BRTEH     IFGT 0                                         144916
     C                     MOVE NARR,45   NARO                            144916
     C                     Z-ADDBRTEH     SPO                             144916
     C***********          EXSR OUTHR                              144916 183577
     C  N82                EXSR OUTHR                                     183577
     C                     SETON                     8082                 183577
     C   60                EXSR CHECKH                                    183577
     C   60                GOTO HEND                                      183577
     C                     ENDIF                                          144916
     C           RTSPH     IFGT 0                                         144916
     C                     Z-ADDRTSPH     SPO                             144916
     C                     SELEC                                          144916
     C           BRTEH     WHEQ 0                                         144916
     C                     MOVE NARR,46   NARO                            144916
     C           BRTEH     WHGT 0                                         144916
     C           SPINH     ANDEQ'A'                                       144916
     C                     MOVE NARR,47   NARO                            144916
     C           BRTEH     WHGT 0                                         144916
     C           SPINH     ANDEQ'S'                                       144916
     C                     MOVE NARR,48   NARO                            144916
     C           BRTEH     WHGT 0                                         144916
     C           SPINH     ANDEQ'P'                                       144916
     C                     MOVE NARR,49   NARO                            144916
     C                     ENDSL                                          144916
     C                     EXSR OUTHR                                     144916
     C                     SETOF                     808182               183577
     C                     ENDIF                                          144916
     C                     ENDIF                                          144916
     C                     GOTO HEND                                      CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CEU020
      ** If CEU020 is on and EMU-Mulit-ccy rollover have been             CEU020
      ** entered, the Multi-ccy transaction should be shown.              CEU020
      *                                                                   CEU020
     C           AMTPH     IFEQ 'MC'                                      CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C           *IN78     ANDEQ*OFF                                      CEU020
     C                     MOVE NARR,44   NARO                            CEU020
     C                     MOVELCCYH      #CCY    6                       CEU020
     C                     MOVE 'TO'      #CCY                            CEU020
     C                     MOVELRLCYH     #RLCY   5                       CEU020
     C                     MOVEL#CCY      #LCY   11                       CEU020
     C                     MOVE #RLCY     #LCY                            CEU020
     C                     MOVE #LCY      NARO                            CEU020
     C                     Z-ADDCPAMH     AMTO                            CEU020
     C           CEU020    IFEQ 'Y'                                       147492
     C                     MOVE RLCYH     CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C                     EXSR OUTHR                                     CEU020
      *                                                                   144916
      ** Multi-ccy rollover - rate                                        144916
      *                                                                   144916
     C           BRTEH     IFGT 0                                         144916
     C           RTSPH     ORGT 0                                         144916
      *                                                                   144916
     C           BRTEH     IFGT 0                                         144916
     C                     MOVE NARR,45   NARO                            144916
     C                     Z-ADDBRTEH     SPO                             144916
     C                     EXSR OUTHR                                     144916
     C                     ENDIF                                          144916
     C           RTSPH     IFGT 0                                         144916
     C                     Z-ADDRTSPH     SPO                             144916
     C                     SELEC                                          144916
     C           BRTEH     WHEQ 0                                         144916
     C                     MOVE NARR,46   NARO                            144916
     C           BRTEH     WHGT 0                                         144916
     C           SPINH     ANDEQ'A'                                       144916
     C                     MOVE NARR,47   NARO                            144916
     C           BRTEH     WHGT 0                                         144916
     C           SPINH     ANDEQ'S'                                       144916
     C                     MOVE NARR,48   NARO                            144916
     C           BRTEH     WHGT 0                                         144916
     C           SPINH     ANDEQ'P'                                       144916
     C                     MOVE NARR,49   NARO                            144916
     C                     ENDSL                                          144916
     C                     EXSR OUTHR                                     144916
     C                     ENDIF                                          144916
     C                     ENDIF                                          144916
     C                     GOTO HEND                                      CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CEU020
     C*
     C/COPY WNCPYSRC,LE0210C001
0992 C           AMTPH     COMP 'PI'                     35
0993 C   35                MOVE NARR,14   NARO   30
0994 C   35                Z-ADDPRAMH     AMTO   130
     C           *IN35     IFEQ '1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
0995 C   35                EXSR OUTHR
0996 C   35                GOTO HEND
0997 C**
0998 C           AMTPH     COMP 'MR'                     35
0999 C   35      PRAMH     COMP 0                    3636
1000 C   35 36             MOVE NARR,9    NARO
1001 C   35 36             Z-ADDPRAMH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN81     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1002 C   35 36N81          EXSR OUTHR
1003 C   35 36             SETON                     8081
1004 C   35 36 60          EXSR CHECKH
1005 C   35 36 60          GOTO HEND
0028 C/COPY WNCPYSRC,LE0210CCP2                                           S01408
1006 C**
1007 C   35      INTAH     COMP 0                    3636
1008 C   35 36             MOVE NARR,12   NARO
1009 C   35 36             Z-ADDINTAH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN82     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1010 C   35 36N82          EXSR OUTHR
1011 C   35 36             SETON                     8082
1012 C   35 36 60          EXSR CHECKH
1013 C   35 36 60          GOTO HEND
1014 C**
1015 C***35******WTXAH     COMP 0                    3636                 E10159
     C                     SETOF                     573836               E10159
     C   35      WTXAH     COMP 0                    5757                 E10159
     C   57                MOVELLNRFH     CLOKEY                          E10159
     C   57      CLOKEY    CHAINCLOAN                38                   E10159
     C   57 38             MOVE 'CLOAN'   DBFILE                          E10159
     C   57 38             MOVE CLOKEY    DBKEY                           E10159
     C   57 38             Z-ADD4         DBASE            DBASE 4        E10159
     C   57 38             SETON                     39U7U8               E10159
     C   57 38             GOTO HEND                                      E10159
     C   57      WTIN      IFNE 'G'                                       E10159
     C           WTIN      ANDNE'N'                                       E10159
     C                     SETON                     36                   E10159
     C                     END                                            E10159
     C   57                SETOF                     57                   E10159
1016 C   35 36             MOVE NARR,10   NARO
1017 C   35 36             Z-ADDWTXAH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN83     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1018 C   35 36N83          EXSR OUTHR
1019 C   35 36             SETON                     8083
1020 C   35 36 60          EXSR CHECKH
1021 C   35 36 60          GOTO HEND
1022 C**
1023 C   35      FEAMH     COMP 0                    3636
1024 C   35 36             MOVE NARR,11   NARO
1025 C   35 36             Z-ADDFEAMH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1026 C   35 36             EXSR OUTHR
1027 C   35                SETOF                     808182
1028 C   35                SETOF                     83
1029 C   35                GOTO HEND
1030 C**
1031 C           AMTPH     COMP 'IN'                     35
1032 C   35                Z-ADDINTAH     AMTO
1033 C   35N56             MOVE NARR,3    NARO
1034 C   35 56             MOVE NARR,4    NARO
     C           *IN35     IFEQ '1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1035 C   35                EXSR OUTHR
     C   35                SETOF                     5738                 E10159
     C   35      WTXAH     COMP 0                    5757                 E10159
     C   35 57             MOVELLNRFH     CLOKEY                          E10159
     C   35 57   CLOKEY    CHAINCLOAN                38                   E10159
     C   35 57 38          MOVE 'CLOAN'   DBFILE                          E10159
     C   35 57 38          MOVE CLOKEY    DBKEY                           E10159
     C   35 57 38          Z-ADD6         DBASE            DBASE 6        E10159
     C   35 57 38          SETON                     39U7U8               E10159
     C   35 57 38          GOTO HEND                                      E10159
     C   35 57   WTIN      IFEQ 'R'                                       E10159
     C                     Z-ADDWTXAH     AMTO                            E10159
     C           *IN35     IFEQ '1'                                       147492
     C           *IN57     ANDEQ'1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C                     MOVE NARR,38   NARO                            E10159
     C                     EXSR OUTHR                                     E10159
     C                     END                                            E10159
     C                     SETOF                     57                   E10159
1036 C   35                GOTO HEND
1037 C**
1038 C           AMTPH     COMP 'RE'                     35
1039 C   35      PRAMH     COMP 0                    36
1040 C   35 36             MOVE NARR,15   NARO
1041 C   35 36             Z-ADDPRAMH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN81     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1042 C   35 36N81          EXSR OUTHR
1043 C   35 36             SETON                     8081
1044 C   35 36 60          EXSR CHECKH
1045 C   35 36 60          GOTO HEND
0028 C/COPY WNCPYSRC,LE0210CCP3                                           S01408
1046 C**
1047 C   35      INTAH     COMP 0                    3636
1048 C   35 36             MOVE NARR,16   NARO
1049 C   35 36             Z-ADDINTAH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN82     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1050 C   35 36N82          EXSR OUTHR
1051 C   35 36             SETON                     8082
1052 C   35 36 60          EXSR CHECKH
1053 C   35 36 60          GOTO HEND
1054 C**
1055 C   35      WTXAH     COMP 0                    3636
1056 C   35 36             MOVE NARR,17   NARO
1057 C   35 36             Z-ADDWTXAH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1058 C   35 36             EXSR OUTHR
1059 C   35                SETOF                     808182
1060 C   35                GOTO HEND
     C*                                                                   S01270
     C********************************************************************S01270
     C**  AMENDMENT TYPE = LS (LOAN SUB-TYPE CHANGED)                     S01270
     C*                                                                   S01270
1041 C           AMTPH     IFEQ 'LS'                                      S01270
     C*                                                                   S01270
     C**  'SUB-TYPE CHANGED' MOVED TO NARRATIVE                           S01270
     C*                                                                   S01270
1040 C                     MOVE NARR,39   NARO                            S01270
     C*                                                                   BH3419
     C*********************MOVE '   TO   'NAREND  8                                    BH3419 CLE042
     C**********           MOVELSUTPH     NAREND                   BH3419 BH3477
     C**********           MOVE WHSUTP    NAREND                   BH3419 BH3477
     C*********************MOVELWHSUTP    NAREND                                       BH3477 CLE042
     C*********************MOVE SUTPH     NAREND                                       BH3477 CLE042
     C                     MOVE 'TO'      TONAR   9                                           CLE042
     C                     MOVELTONAR     NAREND 16                                           CLE042
     C                     MOVELWHSUTP    WKSTCL  6                                           CLE042
     C                     MOVE WHCLAS    WKSTCL                                              CLE042
     C                     MOVELWKSTCL    NAREND                                              CLE042
     C                     MOVELSUTPH     WKSTCL                                              CLE042
     C                     MOVE CLASH     WKSTCL                                              CLE042
     C                     MOVE WKSTCL    NAREND                                              CLE042
     C                     MOVE NAREND    NARO                            BH3419
     C*                                                                   BH3419
1040 C                     SETON                     67                   S01270
     C*                                                                   S01270
     C**  DETAILS ARE MOVED TO SCREEN IF THE SCREEN IS NOT FULL           S01270
     C**  IN THE MIDDLE OF PROCESSING THE HIST RECORD USING SUBROUT.      S01270
     C*                                                                   S01270
1042 C  N81                EXSR OUTHR                                     S01270
1043 C                     SETON                     8081                 S01270
     C*                                                                   S01270
     C**  IF THE SCREEN IS FULL IN THE MIDDLE OF PROCESSING               S01270
     C**  THE HIST RECORD, THEN A SR CHECKS IF ANY FURTHER LINES ARE      S01270
     C**  TO BE OUTPUT AND CONTINUES ACCORDINGLY                          S01270
     C*                                                                   S01270
1044 C           *IN60     IFEQ '1'                                       S01270
1044 C                     EXSR CHECKH                                    S01270
1046 C                     END                                            S01270
     C*                                                                   S01270
1043 C                     SETOF                     8081                 S01270
1045 C                     GOTO HEND                                      S01270
1046 C                     END                                            S01270
     C*                                                                   S01270
     C**  END OF AMTPH = 'LS' PROCESSING                                  S01270
     C********************************************************************S01270
     C*                                                                   S01270
1062 C           AMTPH     COMP 'MA'                     35
1063 C   35N26             MOVE NARR,5    NARO
1064 C   35 26             MOVE NARR,34   NARO
1065 C   35                Z-ADDPRAMH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN81     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1066 C   35N81             EXSR OUTHR
1067 C   35                SETON                     8081
1068 C   35 60             EXSR CHECKH
1069 C   35 60             GOTO HEND
0028 C/COPY WNCPYSRC,LE0210CCP4                                           S01408
1070 C**
1071 C   35      INTAH     COMP 0                    3636
1072 C   35 36N56          MOVE NARR,6    NARO
1073 C   35 36 56          MOVE NARR,33   NARO
1074 C   35 36             Z-ADDINTAH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN82     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1075 C   35 36N82          EXSR OUTHR
1076 C   35 36             SETON                     8082
1077 C   35 36 60          EXSR CHECKH
1078 C   35 36 60          GOTO HEND
1079 C**
1080 C   35      WTXAH     COMP 0                    3636
1081 C   35 36             MOVE NARR,7    NARO
1082 C   35 36             Z-ADDWTXAH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1083 C   35 36             EXSR OUTHR
1084 C   35                SETOF                     808182
1085 C   35                GOTO HEND
1086 C**
1087 C           AMTPH     COMP 'MI'                     35
      *                                                                   CAC001
      **  If Analytical Accounting is present - only display 'MI'         CAC001
      **  amendments when interest adjustment amount is not Zero          CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN35     IFEQ '1'                                       CAC001
     C           INTAH     ANDEQ*ZERO                                     CAC001
     C                     GOTO HEND                                      CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
1088 C   35                MOVE NARR,8    NARO
1089 C   35                Z-ADDINTAH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1090 C   35                EXSR OUTHR
1091 C   35                GOTO HEND
1092 C**
1093 C           AMTPH     COMP 'SA'                     35
1094 C   35                SETON                     66
1095 C   35      STAIH     COMP 'Y'                      36
1096 C   35 36             MOVE NARR,24   NARO
1097 C   35N36             MOVE NARR,25   NARO
     C           *IN35     IFEQ '1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1098 C   35                EXSR OUTHR
1099 C   35                GOTO HEND
1100 C**
1101 C           AMTPH     COMP 'SC'                     35
      *                                                                   CAC001
      **  If Analytical Accounting is present - only display 'SC'         CAC001
      **  amendments when change to the interest rate/spread (flag = Y)   CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           *IN35     IFEQ '1'                                       CAC001
     C           IRCFH     ANDNE'Y'                                       CAC001
     C                     GOTO HEND                                      CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
1102 C   35                MOVE NARR,26   NARO
1103 C   35                Z-ADDRTSPH     SPO    117
1104 C   35                EXSR OUTHR
1105 C   35                GOTO HEND
1106 C**
1107 C           AMTPH     COMP 'BR'                     35
1108 C   35                MOVE NARR,2    NARO
1109 C   35                Z-ADDBRTEH     SPO
1110 C   35                EXSR OUTHR
1111 C   35                GOTO HEND
1112 C**
1113 C           AMTPH     COMP 'BC'                     35
1114 C   35                MOVE NARR,1    NARO
1115 C   35                Z-ADDBRTEH     SPO
1116 C   35                EXSR OUTHR
1117 C   35                GOTO HEND
1118 C**
1119 C           AMTPH     COMP 'RO'                     35
     C*
1120 C***35******BRTEH     COMP 0                    36                   165834
     C   35      BRTEH     COMP 0                    363636               165834
1121 C   35 36             MOVE NARR,19   NARO
1122 C   35 36             Z-ADDBRTEH     SPO
1123 C   35 36N81          EXSR OUTHR
1124 C   35 36             SETON                     8081
1125 C   35 36 60          EXSR CHECKH
1126 C   35 36 60          GOTO HEND
1127 C**
      *  If there is a rollover with no base rate code, then the          165834
      *  Spread/Interest Rate should be shown, even if it is zero         165834
      *  or negative.                                                     165834
1128 C   35                Z-ADDRTSPH     SPO
1129 C***35******RTSPH     COMP 0                    36                   165834
     C   35      RTSPH     COMP 0                    363636Int.Rate/Spread165834
1130 C   35 36   BRTEH     COMP 0                        36
1131 C   35 36             MOVE NARR,20   NARO
1132 C   35 36N82          EXSR OUTHR
1133 C   35 36             SETON                     8082
1134 C   35 36 60          EXSR CHECKH
1135 C   35 36 60          GOTO HEND
1136 C**
     C**                                                                  S01392
     C**   DISPLAY ROLLOVER PRINCIPAL                                     S01392
     C   35      PRINX     COMP *BLANK               3636                 S01392
     C   35 36   PRINRO    COMP 0                    3636                 S01392
     C   35 36             Z-ADD0         SPO                             S01392
     C   35 36             MOVE NARR,40   NARO                            S01392
     C   35 36             Z-ADDPRINRO    AMTO                            S01392
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN83     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C   35 36N83          EXSR OUTHR                                     S01392
     C   35 36             SETON                     8083                 S01392
     C   35 36 60          EXSR CHECKH                                    S01392
     C   35 36 60          GOTO HEND                                      S01392
     C**                                                                  S01392
     C**   DISPLAY ROLLOVER DISCOUNT                                      S01392
     C   35 36             MOVE NARR,41   NARO                            S01392
     C   35 36             Z-ADDDISCRO    AMTO                            S01392
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN84     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C   35 36N84          EXSR OUTHR                                     S01392
     C   35 36             SETON                     8084                 S01392
     C   35 36 60          EXSR CHECKH                                    S01392
     C/COPY WNCPYSRC,LE0210C002
     C   35 36 60          GOTO HEND                                      S01392
     C**                                                                  S01392
     C   35                Z-ADDRTSPH     SPO              RESET VALUE    S01392
1137 C   35      RTSPH     COMP 0                    36
1138 C   35 36   BRTEH     COMP 0                    36
1139 C   35 36   SPINH     COMP 'A'                      54
1140 C   35 36 54          MOVE NARR,21   NARO
1141 C**
1142 C   35 36   SPINH     COMP 'S'                      54
1143 C   35 36 54          MOVE NARR,22   NARO
1144 C**
1145 C   35 36   SPINH     COMP 'P'                      54
1146 C   35 36 54          MOVE NARR,23   NARO
1147 C   35 36             EXSR OUTHR
1148 C   35                SETOF                     808182
     C   35                SETOF                     8384                 S01392
1149 C   35                GOTO HEND
     C*
1151 C           AMTPH     COMP 'ST'                     35
1152 C   35      TOTI      COMP 0                    2625
1153 C   35N25N26          MOVE NARR,27   NARO
1154 C   35 25
1155 COR 35 26             MOVE NARR,35   NARO
1156 C   35                Z-ADDPRAMH     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN81     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1157 C   35N81             EXSR OUTHR
1158 C   35                SETON                     8081
1159 C   35 60             GOTO HEND
1160 C**
1161 C   35 25             MOVE NARR,36   NARO
1162 C   35 26             MOVE NARR,37   NARO
1163 C   35 25             Z-SUBTOTI      AMTO
1164 C   35 26             Z-ADDTOTI      AMTO
1165 C   35 25             SETON                     26
     C           *IN35     IFEQ '1'                                       147492
     C           *IN26     ANDEQ'1'                                       147492
     C           *IN82     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCYH      CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1166 C   35 26N82          EXSR OUTHR
1167 C   35 26             SETON                     8082
1168 C   35 26 60          GOTO HEND
1169 C**
1170 C   35      BRTEH     COMP 0                    36
1171 C   35 36             MOVE NARR,28   NARO
1172 C   35 36             Z-ADDBRTEH     SPO
1173 C   35 36N83          EXSR OUTHR
1174 C   35 36             SETON                     8083
1175 C   35 36 60          GOTO HEND
1176 C**
1177 C   35                Z-ADDRTSPH     SPO
1178 C   35      RTSPH     COMP 0                    36
1179 C   35 36   BRTEH     COMP 0                        36
1180 C   35 36             MOVE NARR,29   NARO
1181 C   35 36N84          EXSR OUTHR
1182 C   35 36             SETON                     8084
1183 C   35 36 60          GOTO HEND
1184 C**
1185 C   35      RTSPH     COMP 0                    36
1186 C   35 36   BRTEH     COMP 0                    36
1187 C   35 36   SPINH     COMP 'A'                      54
1188 C   35 36 54          MOVE NARR,30   NARO
1189 C**
1190 C   35 36   SPINH     COMP 'S'                      54
1191 C   35 36 54          MOVE NARR,31   NARO
1192 C**
1193 C   35 36   SPINH     COMP 'P'                      54
1194 C   35 36 54          MOVE NARR,32   NARO
1195 C   35 36             EXSR OUTHR
1196 C   35                SETOF                     808182
1197 C   35                SETOF                     8384
1198 C**
1199 C           HEND      ENDSR
1200 C*                                                                  *
1201 C********************************************************************
     C*****************************************************************
     C*
     C**    ORIGSR - TO EXTRACT ORIGINAL BORROWER DETAILS AND
     C**             DISPLAY THEM.
     C*
     C**    CALLED BY  :  OUTH, OUTL
     C**    CALLS      :  AOCUSTR0
     C*
     C           ORIGSR    BEGSR
     C*
     C                     MOVELOLNO      KEYC
     C***********          CALL 'AOCUSTR0'                         S01194 CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC                            S01194
     C                     PARM '*SHNAME' KEYSTS                          S01194
     C***********SDCUST    PARM SDCUST    DSSDY                    S01194 CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
     C*
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           CSD007    ANDNE'Y'                                       CSD007
      *                                                                   CSD007
     C           @RTCD     ORNE *BLANKS                                   CSD007
     C           @RTCD     ANDEQ'*NRF   '                                 CSD007
     C           BBDTDL    ANDNE*ZEROS                                    CSD007
     C           CSD007    ANDEQ'Y'                                       CSD007
      *                                                                   CSD007
     C           @RTCD     ORNE *BLANKS                                   CSD007
     C           @RTCD     ANDNE'*NRF   '                                 CSD007
     C           CSD007    ANDEQ'Y'                                       CSD007
      *                                                                   CSD007
0716 C                     SETON                     39U7U8               S01194
0717 C                     MOVE 'SDCUSTPD'DBFILE                          S01194
0718 C                     MOVE OLNO      DBKEY                           S01194
0719 C                     Z-ADD7         DBASE            DBASE 7        S01194
     C*
     C                     ELSE                                           S01194
     C*
     C                     SETON                     57
     C                     END                                            S01194
     C*
     C                     ENDSR
     C*
     C*****************************************************************
1202 C********************************************************************
1203 C*                                                                  *
1204 C*    CHECKH SR. TO CHECK WHETHER ANY FURTHER LINES WILL BE         *
1205 C*               OUTPUT IF SCREEN IS FULL IN MIDDLE OF PROCESSING   *
1206 C*               A HISTS RECORD.                                    *
1207 C*                                                                  *
1208 C*    ROUTINE CALLED FROM OUTH                                      *
1209 C*                                                                  *
1210 C           CHECKH    BEGSR                           ** CHECKH BEGSR
1211 C**
1212 C                     SETOF                     4849
1213 C           AMTPH     COMP 'MR'                     47
1214 C   47N82   INTAH     COMP 0                    4848
1215 C   47N83N48WTXAH     COMP 0                    4848
1216 C   47N48   FEAMH     COMP 0                    4848
1217 C**
1218 C           AMTPH     COMP 'RE'                     47
1219 C  N47      AMTPH     COMP 'MA'                     47
1220 C   47N82   INTAH     COMP 0                    4848
1221 C   47N48   WTXAH     COMP 0                    4848
1222 C**
1223 C           AMTPH     COMP 'RO'                     47
1224 C   47N82   RTSPH     COMP 0                    49
1225 C   47N82 49BRTEH     COMP 0                        49
1226 C   47N82 49          SETON                     48
1227 C**
1228 C   47      RTSPH     COMP 0                    49
1229 C   47 49   BRTEH     COMP 0                    49
1230 C   47 49             SETON                     48
     C**                                                                  S01392
     C   47      PRINX     COMP *BLANK               4949                 S01392
     C   47 49   PRINRO    COMP 0                    4949                 S01392
     C   47 49N84          SETON                     48                   S01392
      *                                                                   183577
      ** Multi currency rollovers can have a change in base or spread.    183577
      *                                                                   183577
     C           AMTPH     COMP 'MC'                     47               183577
     C   47N48   BRTEH     COMP 0                    4848                 183577
     C   47N48   RTSPH     COMP 0                    4848                 183577
1231 C**
1232 C  N48                SETOF                     808182
1233 C**N48***             SETOF                     83                   S01392
     C  N48                SETOF                     8384                 S01392
1234 C**
1235 C                     ENDSR
1236 C*                                                                  *
1237 C********************************************************************
1238 C********************************************************************
1239 C*                                                                  *
1240 C*    OUTHR SR. TO OUTPUT TO SCREEN AND CHECK FULL                  *
1241 C*                                                                  *
1242 C*            ROUTINE CALLED FROM - OUTH
1243 C*            ROUTINE CALLS - ZDATE2
1244 C           OUTHR     BEGSR                           ** OUTHR BEGSR
1245 C**
1246 C**   CONVERT DATE
1247 C**
1248 C                     Z-ADDVDATH     ZDAYNO
1249 C                     EXSR ZDATE2
1250 C                     MOVE ZADATE    DUDAT   7
     C/COPY WNCPYSRC,LE0210C011
1251 C**
1252 C                     MOVE 'H'       CODE    1
1253 C           SPO       COMP 0                    6565
1254 C   66                SETON                     65
1255 C***********V         ADD  1         V                               S01117
1256 C***********V         COMP 20                       60               S01117
     C           VSLN      ADD  1         VSLN                            S01117
     C***********VSLN      COMP 20                       60         S01117182282
     C           VSLN      COMP 20                   60  60               182282
1257 C                     SETON                     70
1258 C                     EXCPT
1259 C                     SETOF                     70
1260 C**
     C/COPY WNCPYSRC,LE0210C008
1261 C                     ENDSR
1262 C*                                                                  *
1263 C********************************************************************
1264 C*                                                                  *
1265 C*                                                                  *
1266 C*    OUTL SR. TO SET UP AMOUNT AND NARRATIVE FIELDS FOR LOAMS      *
1267 C*
1268 C*            ROUTINE CALLED FROM - SRLOMS,SRLOHS
1269 C*            ROUTINE CALLS - OUTLR (10),CHECKL (3)
1270 C           OUTL      BEGSR                           **  OUTL BEGSR*
1271 C                     Z-ADD0         SPO
1272 C                     Z-ADD0         AMTO
1273 C                     SETOF                     66
1273 C                     SETOF                     67                   S01270
     C/COPY WNCPYSRC,LE0210C003
1274 C**
      *                                                                   CLE004
      ** If SAR CLE004 is *ON                                             CLE004
      *                                                                   CLE004
     C           *IN78     IFEQ *ON                                       CLE004
      *                                                                   CLE004
      ** Setup Narrative                                                  CLE004
      *                                                                   CLE004
     C           AMTPL     IFEQ 'PF'                                      CLE004
     C                     MOVE NARR,42   NARO                            CLE004
     C                     MOVELROLNL     #ROLN  16                       CLE004
     C                     MOVE #ROLN     NARO                            CLE004
     C                     Z-ADDPRAML     AMTO                            CLE004
     C           CEU020    IFEQ 'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C                     EXSR OUTLR                                     CLE004
     C                     GOTO LEND                                      CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           AMTPL     IFEQ 'PT'                                      CLE004
     C                     MOVE NARR,43   NARO                            CLE004
     C                     MOVELROLNL     #ROLN  16                       CLE004
     C                     MOVE #ROLN     NARO                            CLE004
     C                     Z-ADDPRAML     AMTO                            CLE004
     C           CEU020    IFEQ 'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
     C                     EXSR OUTLR                                     CLE004
     C                     GOTO LEND                                      CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
1275 C           AMTPL     COMP 'BC'                     35
1276 C   35                MOVE NARR,1    NARO
1277 C   35                Z-ADDBRTEL     SPO
1278 C   35                EXSR OUTLR
1279 C   35                GOTO LEND
1280 C**
1281 C           AMTPL     COMP 'MR'                     35
1282 C   35      PRAML     COMP 0                    3636
1283 C   35 36             MOVE NARR,9    NARO
1284 C   35 36             Z-ADDPRAML     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN81     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1285 C   35 36N81          EXSR OUTLR
1286 C   35 36             SETON                     8081
1287 C   35 36 60          EXSR CHECKL
1288 C   35 36 60          GOTO LEND
1289 C**
1290 C   35      INTAL     COMP 0                    3636
1291 C   35 36             Z-ADDINTAL     AMTO
1292 C   35 36             MOVE NARR,12   NARO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN82     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1293 C   35 36N82          EXSR OUTLR
1294 C   35 36             SETON                     8082
1295 C   35 36 60          EXSR CHECKL
1296 C   35 36 60          GOTO LEND
1297 C**
1298 C   35      WTXAL     COMP 0                    3636
1299 C   35 36             Z-ADDWTXAL     AMTO
1300 C   35 36             MOVE NARR,10   NARO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           *IN83     ANDEQ'0'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1301 C   35 36N83          EXSR OUTLR
1302 C   35 36             SETON                     8083
1303 C   35 36 60          EXSR CHECKL
1304 C   35 36 60          GOTO LEND
1305 C**
1306 C   35      FEAML     COMP 0                    3636
1307 C   35 36             MOVE NARR,11   NARO
1308 C   35 36             Z-ADDFEAML     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           *IN36     ANDEQ'1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1309 C   35 36             EXSR OUTLR
1310 C   35                SETOF                     808182
1311 C   35                SETOF                     83
1312 C   35                GOTO LEND
1313 C**
1314 C           AMTPL     COMP 'PD'                     35
1315 C   35                MOVE NARR,13   NARO
1316 C   35                Z-ADDTAMTL     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1317 C   35                EXSR OUTLR
1318 C   35                GOTO LEND
1319 C**
1320 C           AMTPL     COMP 'PI'                     35
1321 C   35                MOVE NARR,14   NARO
1322 C   35                Z-ADDPRAML     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1323 C   35                EXSR OUTLR
1324 C   35                GOTO LEND
1325 C**
1326 C           AMTPL     COMP 'RE'                     35
1327 C      35   REPTL     COMP 3                      36
1328 C   35 36             MOVE NARR,15   NARO
1329 C   35 36             Z-ADDPRAML     AMTO
1330 C   35N36             MOVE NARR,18   NARO
1331 C   35N36             Z-ADDTAMTL     AMTO
     C           *IN35     IFEQ '1'                                       147492
     C           CEU020    ANDEQ'Y'                                       147492
     C                     MOVE CCY       CURR                            147492
     C                     EXSR SRCDEP                                    147492
     C                     ENDIF                                          147492
1332 C   35                EXSR OUTLR
1333 C   35                GOTO LEND
1334 C**
1335 C           AMTPL     COMP 'SA'                     35
1336 C   35                SETON                     66
1337 C   35      STAIL     COMP 'Y'                      36
1338 C   35 36             MOVE NARR,24   NARO
1339 C   35N36             MOVE NARR,25   NARO
1340 C   35                EXSR OUTLR
1341 C   35                GOTO LEND
1342 C**
1343 C           AMTPL     COMP 'SC'                     35
      *                                                                   CAC001
      **  If Analytical Accounting is present - only display 'SC'         CAC001
      **  amendments w/ a change to the interest rate/spread (flag = Y)   CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           *IN35     IFEQ '1'                                       CAC001
     C           IRCFL     ANDNE'Y'                                       CAC001
     C                     GOTO LEND                                      CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
1344 C   35                MOVE NARR,26   NARO
1345 C   35                Z-ADDRTSPL     SPO
1346 C   35                EXSR OUTLR
1347 C*
     C********************************************************************S01270
     C**  AMENDMENT TYPE = LS (LOAN SUB-TYPE CHANGED)                     S01270
     C*                                                                   S01270
1041 C           AMTPL     IFEQ 'LS'                                      S01270
     C*                                                                   S01270
     C**  'SUB-TYPE CHANGED' MOVED TO NARRATIVE                           S01270
     C*                                                                   S01270
1040 C                     MOVE NARR,39   NARO                            S01270
     C*                                                                   BH3419
     C*********************MOVE '   TO   'NAREND  8                                    BH3419 CLE042
     C**********           MOVELSUTP      NAREND                   BH3419 BH3477
     C**********           MOVE WLSUTP    NAREND                   BH3419 BH3477
     C*********************MOVELWLSUTP    NAREND                                       BH3477 CLE042
     C*********************MOVE SUTP      NAREND                                       BH3477 CLE042
     C                     MOVE 'TO'      TONAR   9                                           CLE042
     C                     MOVELTONAR     NAREND 16                                           CLE042
     C                     MOVELWLSUTP    WKSTCL  6                                           CLE042
     C                     MOVE WLCLAS    WKSTCL                                              CLE042
     C                     MOVELWKSTCL    NAREND                                              CLE042
     C                     MOVELSUTP      WKSTCL                                              CLE042
     C                     MOVE CLAS      WKSTCL                                              CLE042
     C                     MOVE WKSTCL    NAREND                                              CLE042
     C                     MOVE NAREND    NARO                            BH3419
     C*                                                                   BH3419
1040 C                     SETON                     67                   S01270
     C*                                                                   S01270
     C**  DETAILS ARE MOVED TO SCREEN IF THE SCREEN IS NOT FULL           S01270
     C**  IN THE MIDDLE OF PROCESSING THE LOAMS RECORD USING SUBROUT.     S01270
     C*                                                                   S01270
1042 C  N81                EXSR OUTLR                                     S01270
1043 C                     SETON                     8081                 S01270
     C*                                                                   S01270
     C**  IF THE SCREEN IS FULL IN THE MIDDLE OF PROCESSING               S01270
     C**  THE LOAMS RECORD, THEN A SR CHECKS IF ANY FURTHER LINES ARE     S01270
     C**  TO BE OUTPUT AND CONTINUES ACCORDINGLY                          S01270
     C*                                                                   S01270
1044 C           *IN60     IFEQ '1'                                       S01270
1044 C                     EXSR CHECKL                                    S01270
1046 C                     END                                            S01270
     C*                                                                   S01270
1043 C                     SETOF                     8081                 S01270
1045 C                     GOTO LEND                                      S01270
1046 C                     END                                            S01270
     C*                                                                   S01270
     C**  END OF AMTPL = 'LS' PROCESSING                                  S01270
     C********************************************************************S01270
     C*
1348 C           LEND      ENDSR                           ** LEND ENDSR *
1349 C*                                                                  *
1350 C********************************************************************
1351 C********************************************************************
1352 C*                                                                  *
1353 C*    CHECKL SR. TO CHECK WHETHER ANY FURTHER LINES WILL BE         *
1354 C*               OUTPUT IF SCREEN FULL IN MIDDLE OF PROCESSING      *
1355 C*               A LOAMS RECORD.                                    *
1356 C*                                                                  *
1357 C*        ROUTINE CALLED FROM OUTL                                  *
1358 C*                                                                  *
1359 C           CHECKL    BEGSR                           ** CHECKL BEGSR
1360 C**
1361 C  N82      INTAL     COMP 0                    4848
1362 C  N83N48   WTXAL     COMP 0                    4848
1363 C  N48      FEAML     COMP 0                    4848
1364 C**
1365 C  N48                SETOF                     808182
1366 C  N48                SETOF                     83
1367 C**
1368 C                     ENDSR
1369 C*                                                                  *
1370 C********************************************************************
1371 C********************************************************************
1372 C*                                                                  *
1373 C*    OUTLR SR. TO OUTPUT LOAM DETAILS TO SCREEN AND CHECK FULL     *
1374 C*                                                                  *
1375 C*            ROUTINE CALLED FROM - OUTL
1376 C*            ROUTINE CALLS - ZDATE2
1377 C           OUTLR     BEGSR                           ** OUTLR BEGSR
1378 C**
1379 C**   CONVERT DATE
1380 C**
1381 C                     Z-ADDVDATL     ZDAYNO
1382 C                     EXSR ZDATE2
1383 C                     MOVE ZADATE    DUDAT   7
1384 C**
1385 C**   DETERMINE CODE
1386 C**
1387 C           AMTPL     COMP 'PD'                     55
1388 C   55                MOVE 'P'       CODE
1389 C   55                GOTO ENDCD
1390 C**
1391 C           VDATL     COMP RUND                   55
1392 C   55                MOVE 'B'       CODE
1393 C   55                GOTO ENDCD
1394 C**
1395 C                     MOVE 'F'       CODE
1396 C**
1397 C           ENDCD     TAG                             ** ENDCD TAG **
1398 C**
1399 C           SPO       COMP 0                    6565
1400 C   66                SETON                     65
1401 C**
1402 C***********V         ADD  1         V                               S01117
1403 C***********V         COMP 20                       60               S01117
     C           VSLN      ADD  1         VSLN                            S01117
     C***********VSLN      COMP 20                       60         S01117182282
     C           VSLN      COMP 20                   60  60               182282
1404 C                     SETON                     70
1405 C                     EXCPT
1406 C                     SETOF                     70
1407 C**
     C/COPY WNCPYSRC,LE0210C009
1408 C                     ENDSR
     C********************************************************************
     C/COPY ZSRSRC,ZDATE1Z2                                               S01392
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C/COPY ZSRSRC,GLINTCZ1                                               S01392
     C/COPY ZSRSRC,ZSAVEZ1                                                S01392
     C/COPY ZSRSRC,ZRSTORZ1                                               S01392
     C/COPY ZSRSRC,ZFLACZ2                                                S01392
1930 C********************************************************************
1931 C*                                                                  *
1932 C*    FIRST SR. TO PERFORM FIRST CYCLE PROCESSING                   *
1933 C*                                                                  *
1934 C*            ROUTINE CALLED FROM - MAIN PROCESSING
1935 C*            ROUTINE CALLS - ZSYSTM
1936 C           FIRST     BEGSR                           ** FIRST BEGSR
      *                                                                   CAC001
      **  Access Module Details                                           CAC001
      *                                                                   CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*MSG   ' @RTCD   7                       CAC001
     C                     PARM '*FIRST ' @OPTN   7                       CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
      *                                                                   CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     MOVEL'SDMMODPD'DBFILE           ************   CAC001
     C                     Z-ADD8         DBASE            * DBERR 08 *   CAC001
     C                     MOVEL*BLANKS   DBKEY            ************   CAC001
     C                     MOVEL'MMOD'    DBKEY                           CAC001
     C                     MOVEL'LE0210'  DBPGM                           CAC001
     C                     SETON                     U7U8LR               CAC001
     C                     GOTO FEND                                      CAC001
     C                     ENDIF                                          CAC001
      *                                                                   S01117
      * READ IN RUNDAT DATA AREA                                          S01117
      *                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
1937 C**
1938 C                     EXSR ZSYSTM
1939 C***99*********       SETON                     39U7U8               S01194
1940 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
1941 C***99*********       MOVE ZTABKY    DBKEY                           S01194
1942 C***99*********       Z-ADD1         DBASE            DBASE 1        S01194
1943 C   99                GOTO FEND
1944 C**
     C*                                                                   S01311
     C**  ACCESS EM DATA AREA                                             S01311
     C           *NAMVAR   DEFN           EMSDS                           S01311
     C*                                                                   S01311
     C           *LOCK     IN   EMSDS                                     S01311
     C                     MOVE RQDTD     MODID   2                       S01311
     C                     OUT  EMSDS                                     S01311
     C*                                                                   S01311
     C**   IF PROGRAM HAS BEEN CALLED AS A LINKED ENQUIRY, SET UP LOAN    S01311
     C**   REFERENCE AND DATE ACTIVITY FROM PARAMETERS                    S01311
     C           MODID     IFEQ 'LE'                                      S01311
     C                     MOVELLOANNO    LNIN                            S01311
     C                     MOVE *BLANKS   DTIN                            S01311
     C*                                                                   S01311
     C**   SET ON INDICATOR TO INDICATE ZERO DTIN                         S01311
     C                     SETON                     20                   S01311
     C*                                                                   S01311
     C**   SET ON INDICATOR TO CONDITION OUTPUT IN DISPLAY FILE           S01311
     C                     SETON                     15                   S01311
     C*                                                                   S01311
     C**   SUPPRESS DISPLAY OF INITIAL PROMPT SCREEN AND OUTPUT FIRST     S01311
     C**   DETAIL SCREEN                                                  S01311
     C                     SETOF                     02                   S01311
     C                     SETON                     01                   S01311
     C*                                                                   S01311
     C**   OTHERWISE DISPLAY FIRST SCREEN                                 S01311
     C                     ELSE                                           S01311
1945 C                     SETON                     40
     C                     END                                            S01311
1946 C**ACCESS*I/C*TWO                                                    S01194
1947 C**************       MOVE '11'      ZTABKY                          S01194
1948 C***********ZTABKY    CHAINTABLE                99                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
1949 C******99******       SETON                     U7U839               S01194
1950 C******99******       Z-ADD5         DBASE            **DATABASE 08**S01194
1951 C******99******       MOVELZTABKY    DBKEY                           S01194
1952 C******99******       MOVEL'TABLE'   DBFILE                          S01194
1953 C******99******       GOTO FEND                                      S01194
     C*
     C*
1954 C**************       MOVE 'A'       CLIKEY  7                       S01194
1955 C                     MOVE 'A'       CLOKEY  7
1956 C***********          MOVE ' '       BLANKS 60                       S01117
1957 C**************       MOVEL'20'      CCYKEY                          S01194
1958 C**************       MOVE '1'       CCYKEY                          S01194
      **                                                                  S01117
      ** CHECK THE MULTIBRANCHING INDICATORS TO PROTECT AND NON-DISPLAY   S01117
      ** THE BRANCH FIELD WHEN MULTIBRANCHING IS NO                       S01117
      **                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETOF                     12                   S01117
     C                     ELSE                                           S01117
     C                     SETON                     12                   S01117
     C                     END                                            S01117
      *                                                                   CLE005
      ** Check if SAR CLE005 is switched *ON.                             CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY   ' @OPTN                           CLE005
     C                     PARM 'CLE005 ' @SARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF    '                                CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     Z-ADD9         DBASE            * DBERR 09 *   CLE005
     C                     MOVEL'CLE005  'DBKEY            ************   CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CEU020
      ** Access SAR details file to see if EMU Lending                    CEU020
      ** Multi-Ccy Rollover is switched on.                               CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANK    @RTCD   7                       CEU020
     C                     PARM '*VERIFY' @OPTN   7                       CEU020
     C                     PARM 'CEU020'  @SARD   6                       CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
      *                                                                   CEU020
      ** If error in access program, exit via DBERR subroutine            CEU020
      *                                                                   CEU020
     C           @RTCD     IFNE *BLANKS                                   CEU020
     C           @RTCD     ANDNE'*NRF'                                    CEU020
     C                     MOVEL'SDSARDPD'DBFILE           ************   CEU020
     C                     MOVEL'CEU020 ' DBKEY            * DBERR 10 *   CEU020
     C                     Z-ADD10        DBASE            ************   CEU020
     C                     SETON                     U7U8LR               CEU020
     C                     END                                            CEU020
      *                                                                   CEU020
     C           @RTCD     IFEQ *BLANK                                    CEU020
     C                     MOVE 'Y'       CEU020  1                       CEU020
     C                     ELSE                                           CEU020
     C                     MOVE 'N'       CEU020                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CDE002
      ** Access SAR details file to determine if CDE002 is switched on    CDE002
      *                                                                   CDE002
     C                     CALL 'AOSARDR0'                                CDE002
     C                     PARM *BLANKS   PRTCD   7                       CDE002
     C                     PARM '*VERIFY' POPTN   7                       CDE002
     C                     PARM 'CDE002'  PSARD   6                       CDE002
     C           SCSARD    PARM SCSARD    DSFDY                           CDE002
      *                                                                   CDE002
     C                     MOVE 'N'       CDE002  1                       CDE002
     C           PRTCD     IFEQ *BLANKS                                   CDE002
     C                     MOVE 'Y'       CDE002                          CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CSD007
      ** Access SAR details file to check if 'Customer closing' is        CSD007
      ** installed.                                                       CSD007
      *                                                                   CSD007
     C                     CALL 'AOSARDR0'                                CSD007
     C                     PARM *BLANKS   @RTCD                           CSD007
     C                     PARM '*VERIFY' @OPTN                           CSD007
     C                     PARM 'CSD007'  @SARD                           CSD007
     C           SCSARD    PARM SCSARD    DSFDY                           CSD007
      *                                                                   CSD007
     C           @RTCD     IFNE *BLANKS                                   CSD007
     C           @RTCD     ANDNE'*NRF   '                                 CSD007
     C                     MOVEL'SCSARDPD'DBFILE                          CSD007
     C                     MOVEL'CSD007'  DBKEY                           CSD007
     C                     Z-ADD11        DBASE                           CSD007
     C                     SETON                     U7U8LR               CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C           @RTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007  1                       CSD007
     C                     ELSE                                           CSD007
     C                     MOVE 'N'       CSD007                          CSD007
     C                     ENDIF                                          CSD007
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
0028 C/COPY WNCPYSRC,LE0210CCP5                                           S01408
1960 C*                                                                  *
1959 C           FEND      ENDSR
     C********************************************************************
     C********************************************************************S01311
     C*                                                                  *S01311
     C*    CMDSR - PROCESS COMMAND KEYS                                  *S01311
     C*                                                                  *S01311
     C*    CALLED BY: MAIN PROCESSING                                    *S01311
     C*    CALLS:     RETSR  - END OF PROGRAM PROCESSING                 *S01311
     C*                                                                  *S01311
     C*    THIS IS A STANDARD LINK ENQUIRY SUBROUTINE FOR PROCESSING     *S01311
     C*    THE COMMAND KEYS                                              *S01311
     C*                                                                  *S01311
     C********************************************************************S01311
     C*                                                                   S01311
     C           CMDSR     BEGSR                                          S01311
     C*                                                                   S01311
     C* SET DATA AREA WORK FIELD RTNDWF TO BLANKS                         S01311
     C*                                                                   S01311
     C                     MOVE *BLANK    RTNDWF  1                       S01311
     C*                                                                   S01311
     C* IF F3 PRESSED, RETURN TO MENU                                     S01311
     C*                                                                   S01311
     C           *INKC     IFEQ '1'                                       S01311
     C                     MOVE 'Q'       RTNDWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
     C*                                                                   S01311
     C* IF F1 PRESSED, RETURN TO INITIAL ENQUIRY                          S01311
     C*                                                                   S01311
     C           *INKA     IFEQ '1'                                       S01311
     C                     MOVE 'S'       RTNDWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
     C*                                                                   S01311
     C* IF F12 PRESSED, RETURN TO PREVIOUS ENQUIRY                        S01311
     C*                                                                   S01311
     C           *INKL     IFEQ '1'                                       S01311
     C                     MOVE 'U'       RTNDWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
     C*                                                                   S01311
     C                     ENDSR                                          S01311
     C*                                                                   S01311
     C********************************************************************S01311
     C*                                                                  *147492
     C*    SRCDEP SR. TO GET CORRECT NO. OF DECIMAL PLACES               *147492
     C*                                                                  *147492
     C********************************************************************147492
      *                                                                   147492
     C           SRCDEP    BEGSR                                          147492
      *                                                                   147492
     C                     CALL 'AOCURRR0'                                147492
     C                     PARM '*MSG   ' @RTCD   7                       147492
     C                     PARM '*KEY   ' @OPTN   7                       147492
     C                     PARM CURR      K101    3                    A  147492
     C           SDCURR    PARM SDCURR    DSSDY                        B  147492
     C           @RTCD     IFNE *BLANKS                                   147492
     C                     MOVEL'SDCURRPD'DBFILE                          147492
     C                     MOVE CURR      DBKEY                           147492
     C                     Z-ADD2         DBASE            DBASE 2        147492
     C                     SETON                     39U7U8               147492
     C                     GOTO CEND                                      147492
     C                     END                                            147492
      *                                                                   147492
     C           CDP       COMP 1                      6162               147492
     C           CDP       COMP 2                    64  63               147492
     C           CEND      ENDSR                                          147492
     C********************************************************************S01311
     C*                                                                  *S01311
     C*    RETSR - END OF PROGRAM PROCESSING                             *S01311
     C*                                                                  *S01311
     C*    CALLED BY: CMDSR - PROCESS COMMAND KEYS                       *S01311
     C*               *PSSR - ERROR PROCESSING                           *S01311
     C*    CALLS:                                                        *S01311
     C*                                                                  *S01311
     C*    THIS IS A STANDARD LINK ENQUIRY SUBROUTINE FOR ENDING THE     *S01311
     C*    PROGRAM                                                       *S01311
     C*                                                                  *S01311
     C********************************************************************S01311
     C*                                                                   S01311
     C           RETSR     BEGSR                                          S01311
     C*                                                                   S01311
     C* SET ON LR                                                         S01311
     C*                                                                   S01311
     C                     SETON                     LR                   S01311
     C*                                                                   S01311
     C* ACCESS EM DATA AREA                                               S01311
     C*                                                                   S01311
     C           *LOCK     IN   EMSDS                                     S01311
     C                     MOVE RTNDWF    RETND                           S01311
     C                     OUT  EMSDS                                     S01311
     C*                                                                   S01311
     C                     RETRN                                          S01311
     C*                                                                   S01311
     C                     ENDSR                                          S01311
     C********************************************************************S01311
1962 C********************************************************************
1963 C**
1964 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
1965 C**
1966 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
1967 C**************                                                      S01194
1968 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
1969 C**************       MOVEL'01      'ZTABKY 12                       S01194
1970 C**************       MOVE '  10'    ZTABKY                          S01194
1971 C**************                                                      S01194
1972 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
1973 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
      *                                                                   CLE004
      ** Check if SAR CLE004 is present                                   CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   P@RTCD  7                       CLE004
     C                     PARM '*KEY   ' P@OPTN  7                       CLE004
     C                     PARM 'CLE004'  P@SARD  6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
      *                                                                   CLE004
     C           P@RTCD    IFEQ *BLANKS                                   CLE004
     C                     MOVE *ON       *IN78                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   S01194
1974 C**
1975 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
1976 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
1976 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
1977 C**
1978 C                     ENDSR
1979 C**
1980 C**
1981 C********************************************************************
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C*                                                                   S01311
     C* IF CALLED AS LINKED ENQUIRY, SET RETURN CODE TO 'E' AND EXECUTE   S01311
     C* END OF PROGRAM PROCESSING                                         S01311
     C*                                                                   S01311
     C           *IN15     IFEQ '1'                                       S01311
     C                     MOVE 'E'       RTNDWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
      /EJECT                                                              066550
1982 O**
1983 O**  WORKSTATION OUTPUT
1984 O**
2016 OLE0210FME        71
2017 O                                   K8 'LE0210F1'
2018 O***********              *IN29      1                               S01117
2019 O***********                         3 'SG'                          S01117
2020 O***********              MTIME     11 '  .  .  '                    S01117
2021 O***********              WSID      14                               S01117
2022 O***********              CRNM      34                               S01117
2023 O***********              CNUML     40                               S01117
2024 O***********              LNRF      46                               S01117
2025 O***********              ACTDY     53                               S01117
2026 O***********              BRCD      56                               S01117
2027 O***********            61CPAM      74 ' ,   ,   ,   , 0 -'          S01117
2028 O***********            62CPAM      74 '   ,   ,   , 0 . -'          S01117
2029 O***********            63CPAM      74 '  ,   ,   , 0 .  -'          S01117
2030 O***********            64CPAM      74 ' ,   ,   , 0 .   -'          S01117
2031 O***********              CCYL      77                               S01117
2032 O***********            61INOUT     95 ' ,   ,   ,   , 0 -'          S01117
2033 O***********            62INOUT     95 '   ,   ,   , 0 . -'          S01117
2034 O***********            63INOUT     95 '  ,   ,   , 0 .  -'          S01117
2035 O***********            64INOUT     95 ' ,   ,   , 0 .   -'          S01117
2036 O***********            61RAMT     111 '    ,   ,   , 0 '            S01117
2037 O***********            62RAMT     111 '      ,   , 0 . '            S01117
2038 O***********            63RAMT     111 '     ,   , 0 .  '            S01117
2039 O***********            64RAMT     111 '    ,   , 0 .   '            S01117
2040 O***********              RFRQ     112                               S01117
2041 O***********           N22RDYN     114                               S01117
2042 O***********              NRPDA    121                               S01117
2043 O***********              REPT     122                               S01117
2044 O***********              IPFR     124                               S01117
2045 O***********           N23IFDY     126                               S01117
2046 O***********              NIDTA    133                               S01117
2047 O***********              CAPI     136                               S01117
2048 O***********              MDATA    143                               S01117
2049 O***********            61PWOD     159 '    ,   ,   , 0 '            S01117
2050 O***********            62PWOD     159 '      ,   , 0 . '            S01117
2051 O***********            63PWOD     159 '     ,   , 0 .  '            S01117
2052 O***********            64PWOD     159 '    ,   , 0 .   '            S01117
2053 O***********            61IWOD     175 '    ,   ,   , 0 '            S01117
2054 O***********            62IWOD     175 '      ,   , 0 . '            S01117
2055 O***********            63IWOD     175 '     ,   , 0 .  '            S01117
2056 O***********            64IWOD     175 '    ,   , 0 .   '            S01117
2057 O***********            61WTWD     191 '    ,   ,   , 0 '            S01117
2058 O***********            62WTWD     191 '      ,   , 0 . '            S01117
2059 O***********            63WTWD     191 '     ,   , 0 .  '            S01117
2060 O***********            64WTWD     191 '    ,   , 0 .   '            S01117
     O                                    2 'SG'                          S01117
     O                         MTIME     10 '  .  .  '                    S01117
     O                         WSID      13                               S01117
     O                         CNUML     19                               CLE004
     O***********              CRNM      33                        S01117 CLE004
     O                         CRNM      39                               CLE004
     O*
     O**  THE FOLLOWING CHANGED TO ACCOMODATE ORIGINAL BORROWER DETAILS
     O*                                                                   S01270
     O***********      57      OLNO      39                        S01270 CLE004
     O***********      57      BBCSSN    59                        S01270 CLE004
     O                 57      OLNO      45                               CLE004
     O                 57      BBCSSN    65                               CLE004
     O*                                                                   S01270
     O****************         CNUML     39                       S01117  S01270
     O****************         LNRF      45                       S01117  S01270
     O****************         ACTDY     52                       S01117  S01270
     O****************         BRCA      55                       S01117  S01270
     O****************       61CPAM      73 ' ,   ,   ,   , 0 -'  S01117  S01270
     O****************       62CPAM      73 '   ,   ,   , 0 . -'  S01117  S01270
     O****************       63CPAM      73 '  ,   ,   , 0 .  -'  S01117  S01270
     O****************       64CPAM      73 ' ,   ,   , 0 .   -'  S01117  S01270
     O****************         CCYL      76                       S01117  S01270
     O****************       61INOUT     94 ' ,   ,   ,   , 0 -'  S01117  S01270
     O****************       62INOUT     94 '   ,   ,   , 0 . -'  S01117  S01270
     O****************       63INOUT     94 '  ,   ,   , 0 .  -'  S01117  S01270
     O****************       64INOUT     94 ' ,   ,   , 0 .   -'  S01117  S01270
     O****************       61RAMT     110 '    ,   ,   , 0 '    S01117  S01270
     O****************       62RAMT     110 '      ,   , 0 . '    S01117  S01270
     O****************       63RAMT     110 '     ,   , 0 .  '    S01117  S01270
     O****************       64RAMT     110 '    ,   , 0 .   '    S01117  S01270
     O****************         RFRQ     111                       S01117  S01270
     O****************      N22RDYN     113                       S01117  S01270
     O****************         NRPDA    120                       S01117  S01270
     O****************         REPT     121                       S01117  S01270
     O****************         IPFR     123                       S01117  S01270
     O****************      N23IFDY     125                       S01117  S01270
     O****************         NIDTA    132                       S01117  S01270
     O****************         CAPI     135                       S01117  S01270
     O****************         MDATA    142                       S01117  S01270
     O****************       61PWOD     158 '    ,   ,   , 0 '    S01117  S01270
     O****************       62PWOD     158 '      ,   , 0 . '    S01117  S01270
     O****************       63PWOD     158 '     ,   , 0 .  '    S01117  S01270
     O****************       64PWOD     158 '    ,   , 0 .   '    S01117  S01270
     O****************       61IWOD     174 '    ,   ,   , 0 '    S01117  S01270
     O****************       62IWOD     174 '      ,   , 0 . '    S01117  S01270
     O****************       63IWOD     174 '     ,   , 0 .  '    S01117  S01270
     O****************       64IWOD     174 '    ,   , 0 .   '    S01117  S01270
     O****************       61WTWD     190 '    ,   ,   , 0 '    S01117  S01270
     O****************       62WTWD     190 '      ,   , 0 . '    S01117  S01270
     O****************       63WTWD     190 '     ,   , 0 .  '    S01117  S01270
     O****************       64WTWD     190 '    ,   , 0 .   '    S01117  S01270
2061 O**
     O***********              CNUML     65                        S01270 CLE004
     O***********              LNRF      71                        S01270 CLE004
     O***********              ACTDY     78                        S01270 CLE004
     O***********              BRCA      81                        S01270 CLE004
     O***********            61CPAM      99 ' ,   ,   ,   , 0 -'   S01270 CLE004
     O***********            62CPAM      99 '   ,   ,   , 0 . -'   S01270 CLE004
     O***********            63CPAM      99 '  ,   ,   , 0 .  -'   S01270 CLE004
     O***********            64CPAM      99 ' ,   ,   , 0 .   -'   S01270 CLE004
     O***********              CCYL     102                        S01270 CLE004
     O***********            61INOUT    120 ' ,   ,   ,   , 0 -'   S01270 CLE004
     O***********            62INOUT    120 '   ,   ,   , 0 . -'   S01270 CLE004
     O***********            63INOUT    120 '  ,   ,   , 0 .  -'   S01270 CLE004
     O***********            64INOUT    120 ' ,   ,   , 0 .   -'   S01270 CLE004
     O***********            61RAMT     136 '    ,   ,   , 0 '     S01270 CLE004
     O***********            62RAMT     136 '      ,   , 0 . '     S01270 CLE004
     O***********            63RAMT     136 '     ,   , 0 .  '     S01270 CLE004
     O***********            64RAMT     136 '    ,   , 0 .   '     S01270 CLE004
     O***********              RFRQ     137                        S01270 CLE004
     O***********           N22RDYN     139                        S01270 CLE004
     O***********              NRPDA    146                        S01270 CLE004
     O***********              REPT     147                        S01270 CLE004
     O***********              IPFR     149                        S01270 CLE004
     O***********           N23IFDY     151                        S01270 CLE004
     O***********              NIDTA    158                        S01270 CLE004
     O***********              CAPI     161                        S01270 CLE004
     O***********              MDATA    168                        S01270 CLE004
     O***********            61PWOD     184 '    ,   ,   , 0 '     S01270 CLE004
     O***********            62PWOD     184 '      ,   , 0 . '     S01270 CLE004
     O***********            63PWOD     184 '     ,   , 0 .  '     S01270 CLE004
     O***********            64PWOD     184 '    ,   , 0 .   '     S01270 CLE004
     O***********            61IWOD     200 '    ,   ,   , 0 '     S01270 CLE004
     O***********            62IWOD     200 '      ,   , 0 . '     S01270 CLE004
     O***********            63IWOD     200 '     ,   , 0 .  '     S01270 CLE004
     O***********            64IWOD     200 '    ,   , 0 .   '     S01270 CLE004
     O***********            61WTWD     216 '    ,   ,   , 0 '     S01270 CLE004
     O***********            62WTWD     216 '      ,   , 0 . '     S01270 CLE004
     O***********            63WTWD     216 '     ,   , 0 .  '     S01270 CLE004
     O***********            64WTWD     216 '    ,   , 0 .   '     S01270 CLE004
     O*************************ADDI*****217*****************S01392*046645 CLE004
     O*************************SNROD****224*****************S01392*046645 CLE004
     O***********              RDFC     217                        046645 CLE004
     O***********              ADDI     218                        046645 CLE004
     O***********              SNROD    225                        046645 CLE004
     O                         LNRF      71                               CLE004
     O                         BRCA      74                               CLE004
     O                         TOLNA     80                               CLE004
     O                         ACTDY     87                               CLE004
     O                         FCUS      93                               CLE004
     O                         FTYP      96                               CLE004
     O                                   97 '-'                           CLE004
     O                         FSEQ      99                               CLE004
     O                   N72N73         102 '   '                         CLE004
     O                   N72 73         102 ' NO'                         CLE004
     O                    72 73         102 'YES'                         CLE004
     O                                  105 ' NO'                         CLE004
     O                       74         105 'YES'                         CLE004
     O                                  108 ' NO'                         CLE004
     O                       75         108 'YES'                         CLE004
     O                       61CPAM     126 ' ,   ,   ,   , 0 -'          CLE004
     O                       62CPAM     126 '   ,   ,   , 0 . -'          CLE004
     O                       63CPAM     126 '  ,   ,   , 0 .  -'          CLE004
     O                       64CPAM     126 ' ,   ,   , 0 .   -'          CLE004
     O                         CCYL     129                               CLE004
     O                       61INOUT    147 ' ,   ,   ,   , 0 -'          CLE004
     O                       62INOUT    147 '   ,   ,   , 0 . -'          CLE004
     O                       63INOUT    147 '  ,   ,   , 0 .  -'          CLE004
     O                       64INOUT    147 ' ,   ,   , 0 .   -'          CLE004
     O                         RDFC     148                               CLE004
     O                       61RAMT     164 '    ,   ,   , 0 '            CLE004
     O                       62RAMT     164 '      ,   , 0 . '            CLE004
     O                       63RAMT     164 '     ,   , 0 .  '            CLE004
     O                       64RAMT     164 '    ,   , 0 .   '            CLE004
     O                         RFRQ     165                               CLE004
     O                      N22RDYN     167                               CLE004
     O                         NRPDA    174                               CLE004
     O                         REPT     175                               CLE004
     O                         ADDI     176                               CLE004
     O                         IPFR     178                               CLE004
     O                      N23IFDY     180                               CLE004
     O                         NIDTA    187                               CLE004
     O                         CAPI     190                               CLE004
     O                         MDATA    197                               CLE004
     O                       61PWOD     213 '    ,   ,   , 0 '            CLE004
     O                       62PWOD     213 '      ,   , 0 . '            CLE004
     O                       63PWOD     213 '     ,   , 0 .  '            CLE004
     O                       64PWOD     213 '    ,   , 0 .   '            CLE004
     O                       61IWOD     229 '    ,   ,   , 0 '            CLE004
     O                       62IWOD     229 '      ,   , 0 . '            CLE004
     O                       63IWOD     229 '     ,   , 0 .  '            CLE004
     O                       64IWOD     229 '    ,   , 0 .   '            CLE004
     O                       61WTWD     245 '    ,   ,   , 0 '            CLE004
     O                       62WTWD     245 '      ,   , 0 . '            CLE004
     O                       63WTWD     245 '     ,   , 0 .  '            CLE004
     O                       64WTWD     245 '    ,   , 0 .   '            CLE004
     O                         SNROD    252                               CLE004
2061 O**
2062 O**   ACTIVITY DETAIL
2063 O**
2064 O        E        70
2065 O                                   K8 'LE0210F2'
2019 O***********                         2 'SG'                          CLE004
2066 O***********              DUDAT      9                               CLE004
2066 O                         DUDAT      7                               CLE004
2067 O***********              NARO      39                               CLE004
2067 O                         NARO      37                               CLE004
2068 O*******************N65 61AMTO      58 ' ,   ,   ,   , 0 -'          S01270
2069 O*******************N65 62AMTO      58 '   ,   ,   , 0 . -'          S01270
2070 O*******************N65 63AMTO      58 '  ,   ,   , 0 .  -'          S01270
2071 O*******************N65 64AMTO      58 ' ,   ,   , 0 .   -'          S01270
     O***********     N67N65 61AMTO      58 ' ,   ,   ,   , 0 -'   S01270 CLE004
     O***********     N67N65 62AMTO      58 '   ,   ,   , 0 . -'   S01270 CLE004
     O***********     N67N65 63AMTO      58 '  ,   ,   , 0 .  -'   S01270 CLE004
     O***********     N67N65 64AMTO      58 ' ,   ,   , 0 .   -'   S01270 CLE004
2072 O***********        N66 65SPO       58 '  0 .       '                CLE004
     O                N67N65 61AMTO      56 ' ,   ,   ,   , 0 -'          CLE004
     O                N67N65 62AMTO      56 '   ,   ,   , 0 . -'          CLE004
     O                N67N65 63AMTO      56 '  ,   ,   , 0 .  -'          CLE004
     O                N67N65 64AMTO      56 ' ,   ,   , 0 .   -'          CLE004
2072 O***********        N66 65SPO       56 '  0 .       '          CLE004165834
     O                   N66 65SPO       56 '  0 .       -'               165834
2073 O                                   58 '  '                          CLE004
2073 O                       76          58 'AU'                          CLE004
2073 O                                   60 '  '                          CLE004
2073 O                       77          60 'AS'                          CLE004
2073 O***********              CODE      59                               CLE004
2073 O                         CODE      61                               CLE004
     O                                   63 'SG'                          CLE004
1985 O        D        40N39
1986 O                                   K8 'LE0210F3'
1987 O***********              *IN44      1                               S01117
1988 O***********              *IN45      2                               S01117
1989 O***********              *IN41      3                               S01117
1990 O***********              *IN42      4                               S01117
1991 O***********              *IN43      5                               S01117
1992 O***********                         7 'SF'                          S01117
1993 O***********              MTIME     15 '  .  .  '                    S01117
1994 O***********              WSID      18                               S01117
1995 O***********              ERMSG     61                               S01117
2008 O***********              CMSG     137                               S01117
1996 O***********              LNIN     143                               S01117
1997 O***********              DTIN     149                               S01117
1998 O***********              CDIN     150                               S01117
     O                                    2 'SF'                          S01117
     O                         MTIME     10 '  .  .  '                    S01117
     O                         WSID      13                               S01117
     O                         ERMSG     91                               S01117
     O                         CMSG     132                               S01117
     O                         LNIN     138                               S01117
     O                         DTIN     144                               S01117
     O                         CDIN     145                               S01117
1999 O**
2000 O**   MESSAGE LINES AND INPUT FIELDS
2001 O**
2002 O        D       N40N39 01
     O       OR       N40N39 05
2003 O                                   K8 'LE0210F4'
2004 O***********              *IN31      1                               S01117
2005 O***********              *IN45      2                               S01117
     O***********                         4 'SG'                          S01117
2007 O***********              ERMSG     47                               S01117
2008 O***********              CMSG     123                               S01117
     O                                    2 'SG'                          S01117
     O                         ERMSG     80                               S01117
     O                         CMSG     121                               S01117
     O                 15 41   LNIN     127                               S01311
     O                 15 42   DTIN     133                               S01311
     O                 15 43   CDIN     134                               S01311
     OLE0210FME        85                                                                     190005
     O                                   K8 'LE0210F1'                                        190005
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**    MSG ARRAY OF MESSAGES
LOAN REFERENCE INVALID                                       1
ACTIVITY DATE FROM INVALID                                   2
CODE INVALID                                                 3
CODE/DATE COMBINATION INVALID                                4
INVALID COMMAND KEY                                          5
                               * COMPLETE *                  6
Rollup next screen,Rolldown first screen,                    7
Rollup next screen,                                          8
Rolldown first screen,                                       9
USER IS NOT AUTHORISED TO ANY BOOKING BRANCHES              10
USER IS NOT AUTHORISED TO THE BOOKING BRANCH                11
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   NARR   ARRAY OF NARRATIVES
BASE RATE CODE CHANGE          1
BASE RATE CHANGE               2
INTEREST PAYMENT               3
INTEREST CAPITALISED           4
MATURITY - PRINCIPAL           5
MATURITY - INTEREST            6
MATURITY - WITHHOLDING TAX     7
MANUAL INTEREST ADJUSTMENT     8
MANUAL REPAYMENT - PRINCIPAL   9
MANUAL REPAYMENT -WITHHOLD TAX10
MANUAL REPAYMENT - FEE        11
MANUAL REPAYMENT - INTEREST   12
PAST DUE - TOTAL              13
PRINCIPAL INCREASE            14
REPAYMENT - PRINCIPAL         15
REPAYMENT - INTEREST          16
REPAYMENT - WITHHOLDING TAX   17
REPAYMENT - TOTAL             18
ROLLOVER - BASE RATE          19
ROLLOVER - RATE               20
ROLLOVER - SPREAD - ADD       21
ROLLOVER - SPREAD - SUBTRACT  22
ROLLOVER - SPREAD - PERCENTAGE23
STOP ACCRUALS                 24
START ACCRUALS                25
SPREAD/RATE CHANGE            26   WAS SPREAD CHANGE
START - PRINCIPAL             27
START - BASE RATE             28
START - RATE                  29
START - SPREAD - ADD          30
START - SPREAD - SUBTRACT     31
START - SPREAD - PERCENTAGE   32
MATURITY -INTEREST CAPITALISED33
MATURITY - FACE VALUE         34
START - FACE VALUE            35
START - PREMIUM               36
START - DISCOUNT              37
WITHHOLDING TAX AMOUNT        38                                          E10159
LOAN SUB-TYPE CHANGED         39                                          S01270
ROLLOVER - PRINCIPAL          40                                          S01392
ROLLOVER - DISCOUNT           41                                          S01392
TRANSFER TO                   43                                          CLE004
TRANSFER FROM                 42                                          CLE004
MULTI-CCY ROLLOVER            44                                          CLE004
MCCY ROLL - BASE RATE         45                                          144916
MCCY ROLL - RATE              46                                          144916
MCCY ROLL - SPREAD - ADD      47                                          144916
MCCY ROLL - SPREAD - SUBTRACT 48                                          144916
MCCY ROLL - SPREAD - PERCENT  49                                          144916
     X/COPY WNCPYSRC,LE0210X001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
