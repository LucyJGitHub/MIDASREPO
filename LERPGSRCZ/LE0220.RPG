0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Projected facility availability enquiry')     *
0002 F*                                                               *
0003 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Customer Lending Module                              *
0006 F*                                                               *
0007 F*    LE0220  -  FACILITY AVAILABILITY ENQUIRY                   *
0008 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 MD024097A          Date 19Dec13               *
      *                 MD024097           Date 12Dec13               *
      *                 MD023687           Date 22Nov13               *
      *                 CGL145B            Date 01Oct13               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR787620           Date 10Jun11               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG21830           Date 16Feb09               *
      *                 BUG21870           Date 07Jan09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 247326             Date 27Apr07               *
      *                 247138             Date 18Apr07               *
      *                 246141             Date 26Mar07               *
      *                 245177A            Date 19Mar07               *
      *                 245177             Date 12Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      *                 241236             Date 19Jul06               *
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE106             Date 28Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 26Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE029             Date 04Sep02               *
      *                 CAP073             Date 08Aug01               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 214897             Date 12Feb03               *
      *                 209384             Date 10Oct02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 204446             Date 18Apr02               *
      *                 204450             Date 25Apr02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CLE023             Date 19Nov01               *
      *                 199073             Date 07Feb02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 194464             Date 15Jun01               *
      *                 CLE014             Date 20Mar01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 171784             Date 01Aug00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163937             Date 14Jul99               *
      *                 157935             Date 08Oct99               *
      *                 CLE009             Date 11May99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 160484             Date 10May99               *
      *                 158930             Date 05May99               *
      *                 152170             Date 13Jan99               *
      *                 145826             Date 04Nov98               *
     F*                 S01392             Date 30Sep92               *   S01392
     F*                 BHF495             Date 28Aug90               *   S01194
     F*                 S01270             DATE 09JUL90               *   S01270
0011 F*                 E20757             DATE 15JAN90               *
     F*                 S01194             DATE 03JAN90               *   S01194
     F*                 S01117             DATE 15/06/89              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  MD024097A  - If Facility type is 'CA' for credit agreement   *
      *            use correct facility type and number as key        *
      *            Amend hook: CGL145_009, CGL145_012 and CGL145_016  *
      *  MD024097- If facility type is 'CA' for credit agreement      *
      *            use correct facility type and number as key        *
      *            Amend hook: CGL145_016                             *
      *  MD023687- Forecast not displayed correctly                   *
      *            Amend hooks: CGL145_013, CGL145_016                *
      *  CGL145B - Subsidiaries Daily Sweeping Forecast               *
      *            Added hooks: CGL145_002, CGL145_009, CGL145_010,   *
      *                         CGL145_011, CGL145_012, CGL145_013,   *
      *                         CGL145_014, CGL145_015, CGL145_016,   *
      *                         CGL145_017, CGL145_018                *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,LEH00074                                 *
      *             WNCPYSRC,LEH00075                                 *
      *             WNCPYSRC,LEH00076                                 *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  BUG21830 - Facility List view is not refelcing correct detail*
      *             Facility details & facility availability enquiry  *
      *             are not showing updated status                    *
      *  BUG21870 - Applied fix 256346                                *
      *  256346   - Include offset amount in the computation of       *
      *             available amount when CLE025 is ON                *
      *  247326 - Incorrect Revolving Credit Indicator shown if an RC *
      *           event with Value Date less than or equal to the     *
      *           Rundate has been inserted.                          *
      *  247138 - Incorrect Facility Availability amount shown on the *
      *           enquiry.  There is a 0.01 difference between the    *
      *           amount shown and that calculated manually.          *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245177A - Incorrect availability when a repayment and an RC  *
      *            is inserted at the same time.                      *
      *  245177 - Incorrect availability when a loan and an RC is     *
      *           inserted at the same time.                          *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  241236 - Include Current Drawn Amount field.                 *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CLE106 - Syndication Manager                                 *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes.                                  *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE029 - Addition of Severity code and Limit ID to FCLTYFM   *
      *  CAP073 - Conversion of MN inputs into modular structure to   *
      *           use as APIs. Facility input Transaction Details     *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enahancements to CAS001, CAS002 and CAS004          *
      *           (Recompile)                                         *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *           (Recompile)                                         *
      *  214897 - Availability wrong if Rev. Cred. Change on a multi- *
      *           ccy facility. Cannot convert amount as FCXR rate has*
      *           not yet been retrieved from the loan. Include MRs   *
      *           in the calculation of the predicted maturity amount.*
      *  209384 - Available amount in Facility Availability Enquiry   *
      *           is not 0 when expiry date is equal to rundate while *
      *           it is 0 in Facility Details Enquiry.                *
      *  204446 - Available amount in correct due to future 'RC'      *
      *           amendment with loan repayment date and maturity date*
      *           within the next 8 days.                             *
      *  204450 - Reactivated facility should show the available      *
      *           amount equal to reactivated facility amount less    *
      *           the amount drawn prior to reactivation.             *
      *  CLE023 - Lending Facility History Improvements.              *
      *  199073 - Available Amount is not correct if a Facility       *
      *           increase or decrease is inserted.                   *
      *  194464 - BHF LE TEST/1st amount available wrong on facility  *
      *           availability enquiry                                *
      *  CLE014 - Customer Driven Lending Enhancements                *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
     F*  171784 - Add negative sign to facility amount.               *
      *  163937 - Consider backvalued facility increase/decrease when *
      *           computing for available amount for the facility.    *
     F*  157935 - Facility increase affects the facility availability *
     F*           of the previous day.  Introduced LF/FACHISHL to     *
     F*           retrieve the facility amount of the previous day.   *
     F*  CLE009 - LE I/C Swift Message Generation for Fees (Recompile)*
      *  160484 - RC change from Y to N not processed correctly       *
      *  158930 - Repay on day of RC change not processed correctly   *
     F*  152170 - Facility amendments not displayed online               *
     F*  145826 - Midas availability and exposure is wrong on            *
     F*           Credit agreements.                                     *
     F*    S01392 - JAPANESE SUB MODULE ENHANCEMENTS                     *S01392
     F*    BHF495 - SFBRCA BLANK AND THIS IS CAUSING PROBLEMS            *
     F*    S01270 - CUSTOMER LENDING AMENDMENTS                          *
     F*  E20757  - 'DATABASE ERROR' VALUE SHOULD BE '05' AND NOT 'O5'.   *
     F*    S01194 - STANDING DATA CHANGES.                               *
     F*    S01117 - MULTIBRANCHING                                       *
0012 F*                                                                  *
0013 F********************************************************************
0014 F*
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0014 F*
0017 F*E0220FMCF**F***  440            WORKSTN      KPASS  *NOIND         S01117
0017 F*E0220FMCF**F**** 469            WORKSTN                      S01117S01270
0017 F***LE0220FMCF  F     477            WORKSTN                  S01270 CLE014
     F/COPY WNCPYSRC,LE0220F001
0017 F***LE0220FMCF**F     502            WORKSTN                         CLE014              241236
      /COPY OFCPYSRCZ,CGL145_002                                                             CGL145B
     FLE0220FMCF  F     520            WORKSTN                                                241236
      /COPY OFCPYSRCZ,CGL145_009                                                             CGL145B
     F/COPY WNCPYSRC,LE0220F002
0019 F*FCLTY***IF  F     256 12AI     2 DISK                              145826
     FFCLTY   IF  F     401 12AI     2 DISK                               145826
     FFACHISHLIF  E           K        DISK                               157935
0020 F*CLINT***IF  F     256  7AI     2 DISK                              S01194
0021 F*SNAME***IF  F     256 10AI    39 DISK                              S01194
0022 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     FSDCURRPDIF  E                    DISK
     FLEFCAML3IF  E           K        DISK                               152170
     FLEFCAML9IF  E           K        DISK                               158930
     F            LEFCAMPF                          KRENAMELEFCAM         158930
     FLEFCLTL0IF  E           K        DISK                               158930
     F            FCLTYFMF                          KRENAMELEFCLTL        158930
     FFACHSAL1IF  E           K        DISK                               158930
     FLELOANL0IF  E           K        DISK                               158930
     FLELOAML3IF  E           K        DISK                               158930
     FCLOANL4 IF  E           K        DISK                                                   214897
     F            CLOANCLF                          KRENAMECLOANLJ                            214897
     FLEFCLTLHIF  E           K        DISK                                                   256346
     F/COPY WNCPYSRC,LEH00925
0023 F* ID F  C  H  L    FUNCTION OF INDICATORS
0024 F**01************WRKSTN*-*SCREEN*SI*********                         S01117
0025 F* 02            FCLTY - DETAIL REC. 1
0026 F* 03                   - DETAIL REC. 2
0027 F**05******      CLINT  - DETAIL RECORD 1                            S01194
0028 F**06******      SNAME  - DETAIL RECORD                              S01194
0029 F**07******      TABLE  -ICD RECORD 1                                S01194
0030 F**08******             - CCY CODES                                  S01194
     F* 05 - End of File (LF/FACHISHL)                                *   157935
     F* 06 - End of File (LF/FACHISHL)                                *   157935
     F* 10            DUMMY INDICATOR
0015 F*    04         USED TO CONDITION FIRST TIME PASS RPG CALC CYCLE
0016 F*    09         SET ON IF ERROR DURING READ FROM THE WORK STATION
0031 F*    11         CUSTOMER DETAILS BLANK ON INPUT
0032 F*    12         FCLTY NO. BLANK ON INPUT
0033 F*    13           "    "    "   "    "
0034 F*    14           "    "    "   "    "
0035 F**
0036 F*       15      FIRST CYCLE INDICATOR
0037 F*       16      WORK INDICATOR - WITH 17
0038 F*       17      FIRST FACILITY FOR CUSTOMER, NON-DISP(ROLLDOWN)
0039 F*       18      LAST FACILITY FOR CUSTOMER, NON-DISP,(ROLLUP)
0040 F*       20      NON-DISPLAY CUSTOMER DETAILS
0041 F*       21      NON-DISPLAY FACILITY DETAILS
      *       22      Non-Display of 'TRANCHE REVOLVING CREDIT' narr.     CLE014
0042 F********23******NON-DISPLAY*"NO FACILITIES"*MESSAGE*****************S01117
     F*       23      NOT AN NO FACILITIES CASE FOUND                     S01117
0043 F*       24      NON-DISPLAY "COMPLETE" MESSAGE
0044 F*       25      NON-DISPLAY ERROR MESSAGE
     F*       26      INVALID COMMAND KEY
0045 F*       27      CUSTOMER NUMBER INPUT
0046 F*       28      CUSTOMER SHORTNAME INPUT
0047 F********29******RETURN*CUST*NAME/NUMBER*IF*IN*ERROR*****************S01117
0047 F*       29      RETURN CUST NAME/NUMBER AND BRANCH IF IN ERROR      S01117
0048 F*       30      RETURN FACILITY NUMBER IF IN ERROR
0049 F*       31      NON-DISPLAY "NON" (OF REVOLVING CREDIT)
0049 F*       32      CHECK AVAILABILITY DATES AGAINST APPROVAL DATE
0049 F*                                    AND AGAINST EXPIRY DATE
     F*       33      ROLLUP (FOR NEXT FACILITY)
     F*       34      ROLLDOWN (FOR FIRST FACILITY)
     F*       35      MULTI-BRANCH FACILITY IND=Y                         S01117
     F*       36      MULTIBRANCHING IS NO (MBIN = 'N')                   S01117
      *       37      Switchable feature CLE014 is On.                    CLE014
      *       38      Switchable feature CLE023 is installed.                                 CLE023
0050 F**
0051 F********42*     CHAIN TO CLINT FAILED                               S01194
0052 F********43*     CHAIN TO SNAME FAILED                               S01194
0053 F*       44      FCLTY RECORDS OUT OF SEQUENCE
0054 F*       46      MATCH FOUND ON FCLTY
0055 F*       47      WORK INDICATOR FOR DAYNO CONVERSION
0056 F*       48      END OF FILE - FCLTY
0057 F*       49      FCCY BLANK ON FILE
0058 F**
0059 F*       50      OUTPUT SCREEN
0060 F*       51      RELEASE SCREEN
0061 F*       52      BLINK CUST. DETAILS ON SCREEN
0062 F*       53        "   FACILITY NO.  "    "
     F*       54      INPUT BRANCH CODE IN ERROR                          S01117
0063 F*       60      0 DECIMAL PLACES
0064 F*       61      1 DECIMAL PLACE
0065 F*       62      2 DECIMAL PLACES
0066 F*       63      3 DECIMAL PLACES
0067 F*       65      WORK INDICATOR FOR CCY ARRAYS
0068 F*       67      CCY CODE FOUND IN ARRAY
0069 F*       68      USED TO ACCESS ICD-1
0069 F*       69      END OF FILE LEFCAML3                                152170
      *       74      Record found on LEFCLTLH                                                256346
      *       80      Facility not found in FACHISA file.                                     CLE023
0070 F**
0071 F*       98      DATE FORMAT = MMDDYY
0072 F*       90/99   USED IN SUBROUTINES
0073 F*       KC      F3 - END PROGRAM
0076 F**
0077 F*         U7+U8 DATABASE ERROR
0078 F*
0080 E**********          DAY        11  5 0             DAYNOS INPUT     S01270
0081 E**********          DAT        11  7               DATES OUTPUT     S01270
0080 E                    DAY        12  5 0             DAYNOS INPUT     S01270
0081 E                    DAT        12  7               DATES OUTPUT     S01270
0082 E                    ACY       150  3               CURRENCY CODES
0083 E                    ADP       150  1 0             CCY DEC. PLACES
     E                    POWR    1   7  7 3             Ccy conversion   158930
0084 E***********         ERR     1   6 62               ERROR MESSAGES   S01117
0084 E***********         ERR     1  12 62               ERROR MES S01117 145826
     E                    ERR     1  13 62               ERROR MESSAGES   145826
     E                    BRTTLT  1   1 40               BRANCH TITLE     S01117
0085 E*
      /COPY OFCPYSRCZ,CGL145_010                                                             CGL145B
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E/COPY ZSRSRC,ZALIGNZ1                                               S01392
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE9Z1                                                                   204446
0092 E**
0093 I*E0220FMNS**01**13NCA                                               S01117
     I***********                             1   1 *IN33                 S01117
     I***********                             2   2 *IN34                 S01117
0094 I***********                             3  12 CUSDET          11    S01117
0095 I***********                            13  15 FANO1           12    S01117
0096 I***********                            16  17 FANO2           13    S01117
     ILEFCAMPF                                                            152170
     I              RECI                            AMRECI                152170
     I              BRCA                            AMBRCA                152170
     I              CNUM                            AMCNUM                152170
     I              FACT                            AMFACT                152170
     I              FCNO                            AMFCNO                152170
     I              SQNO                            AMSQNO                152170
     I              VLDT                            AMVLDT                152170
     I              FATP                            AMFATP                152170
     I              ACCY                            AMACCY                152170
     I              AAMT                            AMAAMT                152170
     I              RVCR                            AMRVCR                152170
     I              NDEX                            AMNDEX                152170
     I              ASTS                            AMASTS                152170
     I              IUSR                            AMIUSR                152170
     I              AUSR                            AMAUSR                152170
     I              XUSR                            AMXUSR                152170
     I              ORED                            AMORED                152170
     I              TLCD                            AMTLCD                152170
     I              CHTP                            AMCHTP                152170
     I              PCRF                            AMPCRF                152170
     I              PCOB                            AMPCOB                152170
     I              NPRT                            AMNPRT                                    CLE106
      *                                                                   158930
     ILEFCAM                                                              158930
     I              RECI                            AFRECI                158930
     I              BRCA                            AFBRCA                158930
     I              CNUM                            AFCNUM                158930
     I              FACT                            AFFACT                158930
     I              FCNO                            AFFCNO                158930
     I              SQNO                            AFSQNO                158930
     I              VLDT                            AFVLDT                158930
     I              FATP                            AFFATP                158930
     I              ACCY                            AFACCY                158930
     I              AAMT                            AFAAMT                158930
     I              RVCR                            AFRVCR                158930
     I              NDEX                            AFNDEX                158930
     I              ASTS                            AFASTS                158930
     I              IUSR                            AFIUSR                158930
     I              AUSR                            AFAUSR                158930
     I              XUSR                            AFXUSR                158930
     I              ORED                            AFORED                158930
     I              TLCD                            AFTLCD                158930
     I              CHTP                            AFCHTP                158930
     I              PCRF                            AFPCRF                158930
     I              PCOB                            AFPCOB                158930
     I              NPRT                            AFNPRT                                    CLE106
      *                                                                   158930
     ILEFCLTL                                                             158930
     I              FACT                            LFACT                 158930
     I              FCNO                            LFCNO                 158930
      *                                                                                       199073
     ILOAMSDKF                                                                                199073
     I              RECI                            ALRECI                                    199073
     I              CCY                             AMCCY                                     199073
     I              AUTO                            AMAUTO                                    199073
      *                                                                   158930
     ICLOANCLF                                                            158930
     I              VDAT                            VDATC                 158930
     I              FCUS                            FCUSC                                     199073
     I              FTYP                            FTYPC                                     199073
     I              FSEQ                            FSEQC                                     199073
     I              FCCY                            FCCYC                                     199073
     I              CCY                             CCYL                                      199073
      *                                                                                       199073
      *                                                                                       214897
     ICLOANLJ                                                                                 214897
      *                                                                                       214897
      ** Rename some fields of CLOANLJ                                                        214897
      *                                                                                       214897
     I              RECI                            RECIX                                     214897
     I              LNRF                            LNRFX                                     214897
     I              PTYP                            PTYPX                                     214897
     I              CNUM                            CNUMX                                     214897
     I              BRCA                            BRCAX                                     214897
     I              VDAT                            VDATX                                     214897
     I              MDAT                            MDATX                                     214897
     I              FCUS                            FCUSX                                     214897
     I              FTYP                            FTYPX                                     214897
     I              FSEQ                            FSEQX                                     214897
     I              CCY                             CCYX                                      214897
     I              CPAM                            CPAMX                                     214897
     I              FCCY                            FCCYX                                     214897
      *                                                                                       214897
     ILE0220FMNS                                                          S01117
     I                                        1  10 CUSDET          11    S01117
     I                                       11  13 FBRCA                 S01117
     I                                       14  16 FANO1           12    S01117
     I                                       17  18 FANO2           13    S01117
0097 I*
0098 I**   FACILITY FILE - DETAIL RECORD  1
0099 I*
0100 IFCLTY   NS  02   1 CD  13 CA
0101 I       OR        1 CE  13 CA
0102 I                                        1   1 RECI
0103 I**********                              2   70CNUM                                      CSD027
0103 I                                        2   7 CNUM                                      CSD027
0104 I**FACILITY*REF.*DEFINED*AS*ALPHA*FOR*PROCESSING*********            157935
0105 I***********                             8  10 FACT                  157935
0106 I***********                            11  12 FCNO                  157935
     I                                        8  100FACT                  157935
     I                                       11  120FCNO                  157935
0107 I                                       13  13 RCTP
0108 I***********                            14  160BRCD                  S01117
     I                                       14  16 BRCA                  S01117
0109 I                                       17  17 FCTI
0110 I                                       18  20 FCCY
0111 I                                    P  21  270FAMT
0112 I                                    P  28  303OVPC
0113 I                                    P  31  330DTAP
     I                                    P  34  360DTEX
0114 I*
0115 I**   DTEX FIELD RENAMED DAY,1 FOR ARRAY PROCESSING
0116 I                                    P  34  36 DAY,1
0117 I                                       37  37 RVCR
0118 I                                       38  38 SECI
0119 I                                       39  39 MCCY
0120 I                                       40  40 MCSI
0121 I                                       41  41 NACD
0122 I                                       42  43 CRSK
0123 I                                    P  44  460DLFS
0124 I                                    P  47  527NOMR
0125 I                                    P  53  550RVDT
0126 I                                       56  56 RVFR
0127 I                                       57  580RVDY
0128 I                                       59  93 NAR1
0129 I                                       94 128 NAR2
0130 I                                      129 163 NAR3
0131 I                                      164 198 NAR4
0132 I                                    P 199 2050MTDH
0133 I                                    P 206 2120MTDL
0134 I                                    P 213 2190MTDA
0135 I                                    P 220 2270QTDA
0136 I                                    P 228 2350YTDA
0137 I                                      236 237 ACOF
     I                                      238 240 ORBR                  S01117
     I** RVCD RENAMED DAY,12
     I                                    P 242 2440DAY,12                S01270
0138 I                                    P 247 2490ORED
0139 I                                    P 250 2520LCD
0140 I                                      253 253 CHTP
0141 I                                    P 254 2560TNLU
     I                                    P 321 3230AVLD                  CLE014
     I                                      339 340 TRCA                  145826
     I                                      401 401 PRTR                  145826
0142 I* COMBINED FIELD FOR FCLTY TYPE/SEQ.NO.
0143 I                                        8  12 FCTN
     I/COPY WNCPYSRC,LE0220I002
0144 I*
0145 I**   FACILITY FILE - DETAIL RECORD 2
0146 I*
0147 I        NS  03   1 CD  13 CB
0148 I       OR        1 CE  13 CB
0149 I                                        1   1 RECI
0150 I**********                              2   70CNUM                                      CSD027
0150 I                                        2   7 CNUM                                      CSD027
0151 I**FACILITY*REF*DEFINED*AS*ALPHA*FOR*PROCESSING**********            157935
0152 I***********                             8  10 FACT                  157935
0153 I***********                            11  12 FCNO                  157935
     I                                        8  100FACT                  157935
     I                                       11  120FCNO                  157935
0154 I                                       13  13 RCTP
0155 I                                       14  14 CMFT
0156 I                                       15  150CALC
0157 I                                    P  16  217SPRD
0158 I                                       22  230BCOD
0159 I                                    P  24  297BRAT
0160 I                                    P  30  320STDT
0161 I                                    P  33  350EDDT
0162 I                                    P  36  380DUDT
0163 I                                       39  39 BLFR
0164 I                                       40  410BLDN
0165 I                                       42  42 BTIN
0166 I                                       43  440BLDY
0167 I                                       45  460SETT
0168 I**********                             47  58 OBAC                                      CGL029
     I                                       47  58 OBACQQ                                    CGL029
0169 I                                       59  68 TNAC
0170 I                                    P  69  710SLCD
0171 I                                    P  72  740ACCD
0172 I                                    P  75  810ADNP
0173 I                                    P  82  880PDTD
0174 I                                    P  89  950AFPD
0175 I                                    P  96 1020ADJP
0176 I                                    P 103 1090ADJN
0177 I                                    P 110 1160TOTD
0178 I                                    P 117 1230CAMD
     I                                      130 130 MBFC                  S01117
0179 I                                      131 131 BITS
     I                                    P 257 2630CEXP                                      CLE023
0180 I*
0181 I**   RUN0-RUN9 FIELDS RENAMED DAY,2 - DAY,11
0182 I**   FOR ARRAY PROCESSING
0183 I                                    P 147 149 DAY,2
0184 I                                    P 150 152 DAY,3
0185 I                                    P 153 155 DAY,4
0186 I                                    P 156 158 DAY,5
0187 I                                    P 159 161 DAY,6
0188 I                                    P 162 164 DAY,7
0189 I                                    P 165 167 DAY,8
0190 I                                    P 168 170 DAY,9
0191 I                                    P 171 173 DAY,10
0192 I                                    P 174 176 DAY,11
0193 I                                    P 177 1830OAM1
0194 I                                    P 184 1900OAM2
0195 I                                    P 191 1970OAM3
0196 I                                    P 198 2040OAM4
0197 I                                    P 205 2110OAM5
0198 I                                    P 212 2180OAM6
0199 I                                    P 219 2250OAM7
0200 I                                    P 226 2320OAM8
0201 I                                    P 233 2390OAM9
0202 I                                    P 240 2460OA10
0203 I                                    P 247 2490ORED
0204 I                                    P 250 2520LCD
0205 I                                      253 253 CHTP
0206 I                                    P 254 2560TNLU
0207 I* COMBINED FIELD FOR FCLTY TYPE/SEQ.NO.
0208 I                                        8  12 FCTN
     I                                      331 348 OBAC                                      CGL029
     I/COPY WNCPYSRC,LEH00074
0209 I*
0210 I**   FACILITY FILE CATCHALL
0211 I*
0212 I        NS  10   1NCD
0213 I                                        1   1 RECI
0214 I*
0215 I*****CUSTOMER*FILE*DETAIL*RECORD*1                                  S01194
0216 I*
0217 I*CLINT***NS  05   1 CD   8 CA                                       S01194
0218 I*******OR*       1 CC   8 CA                                        S01194
0219 I**********                              1   1 RECI                  S01194
0220 I**********                              2   70CNUM                  S01194
0221 I**********                              8   8 RCDT                  S01194
0222 I**********                              9  28 CRNM                  S01194
0223 I**********                             29  38 CTWN                  S01194
0224 I**********                             39  48 CSNM                  S01194
0225 I**********                             49  56 CASK                  S01194
0226 I**********                             57  68 TELX                  S01194
0227 I**********                             69  80 CSID                  S01194
0228 I**********                             81  82 ACOC                  S01194
0229 I**********                             83  83 CBSI                  S01194
0230 I**********                             84  85 CCTZ                  S01194
0231 I**********                             86  87 CLOC                  S01194
     I**********                             88  930CPAR                  S01194
0233 I***********                            94  960BRCD                  S01194
0234 I**********                             97  980LINS                  S01194
0235 I**********                             99 1010LIND                  S01194
0236 I**********                          P 102 1040DASU                  S01194
0237 I**********                          P 105 1070CDIC                  S01194
0238 I**********                          P 108 1100DADE                  S01194
0239 I**********                            111 111 CMIN                  S01194
0240 I**********                            112 112 CTYP                  S01194
0241 I**********                            113 124 TELF                  S01194
0242 I**********                            125 133 CHID                  S01194
0243 I**********                            134 136 CHAB                  S01194
0244 I**********                          P 250 2520LCD                   S01194
0245 I**********                            253 253 CHTP                  S01194
0246 I**********                          P 254 2560TNLU                  S01194
0247 I*
0248 I*****CUSTOMER*FILE*CATCHALL                                         S01194
0249 I*
0250 I********NS* 10                                                      S01194
0251 I**********                              1   1 RECI                  S01194
0252 I*
0253 I*****SHORTNAME*FILE*=*DETAIL*RECORD                                 S01194
0254 I*
0255 I*SNAME***NS* 06   1 CD                                              S01194
0256 I*******OR***     1 CC                                               S01194
0257 I**********                              1   1 RECI                  S01194
0258 I**********                             39  48 CSNM                  S01194
0259 I**********                              2   70CNUM                  S01194
0260 I***********                            94  960BRCD                  S01194
0261 I**********                          P 250 2520LCD                   S01194
0262 I**********                            253 253 CHTP                  S01194
0263 I**********                          P 254 2560TNLU                  S01194
0264 I*
0265 I*****SHORTNAME*FILE*-*CATCHALL                                      S01194
0266 I*
0267 I********NS  10                                                      S01194
0268 I**********                              1   1 RECI                  S01194
0269 I*
0270 I*****TABLE*FILE*-*INSTALATION*CONTROL*DATA*RECORD*1                 S01194
0271 I*
0272 I*TABLE***NS* 07   1 CD   2 C0   3 C1                                S01194
0273 I*******AND**    12 C1  13 C0                                        S01194
0274 I**********                              1   1 RECI                  S01194
0275 I**********                              2   30RECT                  S01194
0276 I**********                             12  130RCDE                  S01194
0277 I**********                             14  66 TITL                  S01194
0278 I**********                             67  67 DATF                  S01194
0279 I***********                            68  700DFBR                  S01194
0280 I**********                             74  74 MODI1                 S01194
0281 I**********                             75  75 MODI2                 S01194
0282 I**********                             76  76 MODI3                 S01194
0283 I**********                          P  77  790RUND                  S01194
0284 I**********                             80  86 RUNA                  S01194
0285 I**********                             87  870SFLG                  S01194
0286 I**********                          P  90  920LCD                   S01194
0287 I**********                             93  93 CHTP                  S01194
0288 I**********                          P  94  960TNLU                  S01194
0523 I*
     I*
0290 I*****TABLE*FILE*-*CURRENCY*RECORD*1                                 S01194
0291 I*
0292 I********NS* 08   2 C2   3 C0                                        S01194
0293 I**********                              1   1 RECI                  S01194
0294 I**********                              2   30RECT                  S01194
0295 I**********                             10  12 CCY                   S01194
0296 I**********                             13  130SREC                  S01194
0297 I**********                             14  27 CCNM                  S01194
0298 I**********                          P  28  348SPOT                  S01194
0299 I**********                             35  37 CCYS                  S01194
0300 I**********                             38  380CDP                   S01194
0301 I**********                             39  390TNOT                  S01194
0302 I**********                             40  40 DCCY                  S01194
0303 I**********                             41  44 SRC1                  S01194
0304 I**********                             45  48 SRC2                  S01194
0305 I**********                             49  520TACC                  S01194
0306 I**********                             53  560TEQV                  S01194
0307 I**********                             57  600SWQV                  S01194
0308 I**********                             61  640TAC4                  S01194
0309 I**********                             65  680TAC5                  S01194
0310 I**********                             69  69 HIND                  S01194
0311 I**********                          P  70  768PART                  S01194
0312 I**********                             77  780SSNO                  S01194
0313 I**********                          P  79  858ERLC                  S01194
0314 I**********                             86  860MDIN                  S01194
0315 I**********                             87  870MDIA                  S01194
0316 I**********                             88  880MDIB                  S01194
0317 I**********                             93  93 CHTP                  S01194
0318 I**********                          P  94  960TNLU                  S01194
0319 I*
0320 I*****TABLE*FILE*CATCHALL                                            S01194
0321 I*
0322 I********NS* 10                                                      S01194
0323 I**********                              1   1 RECI                  S01194
     ISDCURRD0                                                            S01194
     I              A6NBDP                          CDP                   S01194
     I              A6CYCD                          CCY                   S01194
0324 I*
0325 I*    LOCAL DATA AREA FOR DATABASE ERROR REFERENCES
0326 I*
0327 ILDA        UDS                            256
0328 I***********                           134 138 DBFILE                S01117
0329 I***********                           139 167 DBKEY                 S01117
0330 I***********                           168 175 DBPGM                 S01117
0331 I***********                           176 177 DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I/COPY ZSRSRC,ZINTDYZ1                                                                   204446
     I/COPY ZSRSRC,ZDATE9Z2                                                                   204446
     I/COPY ZSRSRC,ZDAT10Z1                                                                   204446
     I*
     I**   RETRIEVE WORKSTASTION ID
     I*
     IPSDS       SDS
     I                                      244 246 WSID
     I/COPY WNCPYSRC,LEH00926
0332 I*
0333 I*    DATA STRUCTURE FOR WORKSTN INPUT
0334 I            DS
0335 I                                        1   3 FANO1
0336 I                                        4   5 FANO2
0337 I                                        1   5 FANO
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODES                                    S01117
     I              A8BRNM                          BRNM                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I*                                                                   S01194
     I*                                                                   S01194
     ILEFCLT    E DSFCLTYFM                                               158930
      ** Data structure to hold the Facilities Details                    158930
     I              FACT                            LFACT                 158930
     I              FCNO                            LFCNO                 158930
      *                                                                   158930
     IWFCLTY    E DSZ#WST                                                 158930
      ** Work file to save Facility record                                158930
      *                                                                   158930
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCRNM                          CRNM                  S01194
     I              QQDFAC                          #DFAC1                                    CGL029
      *                                                                   CLE014
     ISCSARD    E DSSCSARDPD                                              CLE014
      ** External data structures for access objects                      CLE014
      *                                                                   CLE014
     I              LCD                             SCLCD                 CLE014
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I/COPY WNCPYSRC,LE0220I001
      **                                                                  S01117
     IRUNDT       DS                                                      S01117
      ** DATAAREA RUNDAT                                                  S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     IZMUSER      DS                             17                       S01117
      ** DATA AREA OF MENU USER                                           S01117
     I                                       11  13 USRBCH                S01117
     I                                       17  17 BNKAUT                S01117
     I***SDGELR*   E DSSDGELRPD                                                    MD035545 MD047993
     I**********    QQACCD                          ACCDQQ                         MD035545 MD047993
      **  External DS for general ledger details                                            MD035545
      *                                                                                     MD035545
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
      /COPY OFCPYSRCZ,CGL145_011                                                             CGL145B
     C                     MOVEACPY@      BIS@   80
     C*****************************************************************
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C**                                                                  S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C* Set up Key List for CHAIN on LEFCAML3                             152170
     C           *LIKE     DEFN AMCNUM    WCNUM                           152170
     C           *LIKE     DEFN AMFACT    WFACT                           152170
     C           *LIKE     DEFN AMFCNO    WFCNO                           152170
     C           *LIKE     DEFN FAMT      WFAMT                           158930
     C           FCAMK     KLIST                                          152170
     C                     KFLD           WCNUM                           152170
     C                     KFLD           WFACT                           152170
     C                     KFLD           WFCNO                           152170
      *                                                                   158930
     C           FACHK     KLIST                                          158930
     C**********           KFLD           WACNUM  60                                   158930 CSD027
     C                     KFLD           WACNUM  6                                           CSD027
     C                     KFLD           WAFACT  30                      158930
     C                     KFLD           WAFCNO  20                      158930
      *                                                                                       214897
     C           CLOKY     KLIST                                                              214897
     C                     KFLD           RECI                                                214897
     C                     KFLD           LNRF                                                214897
      /COPY OFCPYSRCZ,CGL145_012                                                             CGL145B
     C**
0338 C********************************************************************
0339 C******     FIRST CYCLE PROCESSING              *********************
0340 C*
0341 C* SET FIRST CYCLE INDICATOR
0342 C   04                READ LE0220FM                 09
0343 C  N04                SETON                     04
0344 C                     SETOF                     09
0345 C   15                GOTO ENDFC
0346 C                     SETON                     15
      *                                                                   S01117
      * READ IN DATA AREA(S)                                              S01117
      *                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   RUNDT                                     S01117
     C                     IN   ZMUSER                                    S01117
      *                                                                   S01117
      * SETUP INDICATOR FOR MULTIBRANCHING                                S01117
      *                                                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     36                   S01117
     C                     END                                            S01117
0347 C*
0348 C* SET UP DATABASE ERROR REFERENCE IN LDA
0349 C                     MOVE 'LE0220  'DBPGM
0350 C                     MOVE ' '       BLANKS 29
0351 C                     MOVE BLANKS    DBKEY
0352 C* SET UP ZERO FIELD
0353 C                     Z-ADD0         ZERO   150
     C/COPY WNCPYSRC,LE0220C001
0354 C*
0355 C* ACCESS ICD-1 FOR DATE FORMAT, DATABASE ERROR IF NOT FOUND
0356 C**********           MOVEL'01'      TABKEY 12                       S01194
0357 C**********           MOVE '10'      TABKEY                          S01194
0358 C********** TABKEY    SETLLTABLE                                     S01194
0359 C**********           READ TABLE                    68               S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     COMP *BLANKS              6868                 S01194
0360 C***07N68***DATF      COMP 'M'                      98 = MMDDYY      S01194
0360 C     N68   DATF      COMP 'M'                      98 = MMDDYY      S01194
0361 C*
0362 C***68******                                                         S01194
0363 C*ORN07*****           SETON                     U7U851              S01194
0363 C   68                SETON                     U7U851               S01194
0364 C   U7 U8             MOVE '01'      DBASE              (*DBASE 01*)
0365 C***U7*U8**           MOVE 'TABLE'   DBFILE                          S01194
0365 C   U7 U8             MOVEL'SDBANKPD'DBFILE                          S01194
0366 C***U7*U8**           MOVELTABKEY    DBKEY                           S01194
0367 C   U7 U8             GOTO OUTPUT
      *                                                                   CLE014
      ** Determine if CLE014 is installed                                 CLE014
      *                                                                   CLE014
     C                     CALL 'AOSARDR0'                                CLE014
     C                     PARM '       ' PRTCD   7                       CLE014
     C                     PARM '*VERIFY' POPTN   7                       CLE014
     C                     PARM 'CLE014'  PSARD   7                       CLE014
     C           SCSARD    PARM SCSARD    DSSDY                           CLE014
      *                                                                   CLE014
      ** Handle Database Error                                            CLE014
      *                                                                   CLE014
     C           PRTCD     IFNE *BLANKS                                   CLE014
     C           PRTCD     ANDNE'*NRF   '                                 CLE014
     C                     MOVE 'SCSARDPD'DBFILE                          CLE014
     C                     MOVELPSARD     DBKEY                           CLE014
     C                     Z-ADD6         DBASE                           CLE014
     C                     MOVE *ON       *INU7                           CLE014
     C                     MOVE *ON       *INU8                           CLE014
     C                     MOVE *ON       *INLR                           CLE014
     C                     EXSR *PSSR                                     CLE014
     C                     ENDIF                                          CLE014
      *                                                                   CLE014
      ** CLE014 is installed                                              CLE014
      *                                                                   CLE014
     C           PRTCD     IFEQ *BLANKS                                   CLE014
     C                     MOVE 'Y'       CLE014  1                       CLE014
     C                     MOVE *ON       *IN37                           CLE014
     C                     ELSE                                           CLE014
     C                     MOVE 'N'       CLE014                          CLE014
     C                     MOVE *OFF      *IN37                           CLE014
     C                     ENDIF                                          CLE014
      *                                                                                       CLE023
      ** Determine if CLE023 is installed                                                     CLE023
      *                                                                                       CLE023
     C                     CALL 'AOSARDR0'                                                    CLE023
     C                     PARM '       ' PRTCD                                               CLE023
     C                     PARM '*VERIFY' POPTN                                               CLE023
     C                     PARM 'CLE023'  PSARD                                               CLE023
     C           SCSARD    PARM SCSARD    DSSDY                                               CLE023
      *                                                                                       CLE023
      ** Handle Database Error                                                                CLE023
      *                                                                                       CLE023
     C           PRTCD     IFNE *BLANKS                                                       CLE023
     C           PRTCD     ANDNE'*NRF   '                                                     CLE023
     C                     MOVE 'SCSARDPD'DBFILE                                              CLE023
     C                     MOVELPSARD     DBKEY                                               CLE023
     C                     Z-ADD7         DBASE                                               CLE023
     C                     MOVE *ON       *INU7                                               CLE023
     C                     MOVE *ON       *INU8                                               CLE023
     C                     MOVE *ON       *INLR                                               CLE023
     C                     EXSR *PSSR                                                         CLE023
     C                     ENDIF                                                              CLE023
      *                                                                                       CLE023
      ** CLE023 is installed.                                                                 CLE023
      *                                                                                       CLE023
     C           PRTCD     IFEQ *BLANKS                                                       CLE023
     C                     MOVE 'Y'       CLE023  1                                           CLE023
     C                     MOVE '1'       *IN38                                               CLE023
     C                     ELSE                                                               CLE023
     C                     MOVE 'N'       CLE023                                              CLE023
     C                     MOVE '0'       *IN38                                               CLE023
     C                     ENDIF                                                              CLE023
     C/COPY WNCPYSRC,LEH00075
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans                                                         CLE134
      *                                                                                       CLE134
     C                     CALL 'AOSARDR0'                                                    CLE134
     C                     PARM *BLANKS   PRTCD                                               CLE134
     C                     PARM '*VERIFY' POPTN                                               CLE134
     C                     PARM 'CLE134'  PSARD                                               CLE134
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE134
      *                                                                                       CLE134
     C                     MOVE 'N'       CLE134  1                                           CLE134
     C           PRTCD     IFEQ *BLANKS                                                       CLE134
     C                     MOVE 'Y'       CLE134                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE023
      ** Determine if CLE025 is installed                                                     256346
      *                                                                                       256346
     C                     CALL 'AOSARDR0'                                                    256346
     C                     PARM '       ' PRTCD                                               256346
     C                     PARM '*VERIFY' POPTN                                               256346
     C                     PARM 'CLE025'  PSARD                                               256346
     C           SCSARD    PARM SCSARD    DSSDY                                               256346
      *                                                                                       256346
      ** Handle Database Error                                                                256346
      *                                                                                       256346
     C           PRTCD     IFNE *BLANKS                                                       256346
     C           PRTCD     ANDNE'*NRF   '                                                     256346
     C                     MOVE 'SCSARDPD'DBFILE                                              256346
     C                     MOVELPSARD     DBKEY                                               256346
     C                     Z-ADD8         DBASE                                               256346
     C                     MOVE *ON       *INU7                                               256346
     C                     MOVE *ON       *INU8                                               256346
     C                     MOVE *ON       *INLR                                               256346
     C                     EXSR *PSSR                                                         256346
     C                     ENDIF                                                              256346
      *                                                                                       256346
      ** CLE025 is installed                                                                  256346
      *                                                                                       256346
     C           PRTCD     IFEQ *BLANKS                                                       256346
     C                     MOVE 'Y'       CLE025  1                                           256346
     C                     SETON                     75                                     BUG21830
     C                     ELSE                                                               256346
     C                     MOVE 'N'       CLE025                                              256346
     C                     SETOF                     75                                     BUG21830
     C                     ENDIF                                                              256346
     C/COPY WNCPYSRC,LEH01309
      /COPY OFCPYSRCZ,CGL145_013                                                             CGL145B
      *                                                                                       256346
      ***Access*general*ledger*details.********************************                     MD035545
      *****************************************************************            MD035545 MD047993
     C**********           CALL 'AOGELRR1'                                         MD035545 MD047993
     C**********           PARM '*MSG   ' @RTCD                                    MD035545 MD047993
     C**********           PARM '*FIRST ' @OPTN                                    MD035545 MD047993
     C********** SDGELR    PARM SDGELR    DSSDY                                    MD035545 MD047993
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
      *                                                                                     MD035545
0369 C* SET UP CURRENCY ARRAYS
0370 C**********           MOVEL'20'      CCYKEY 12                       S01194
0371 C**********           MOVE '1'       CCYKEY                          S01194
0372 C********** CCYKEY    SETLLTABLE                                     S01194
0373 C                     Z-ADD0         Y       30
0374 C*
0375 C           LOP1      TAG                             ** LOP1 TAG **
0376 C**************       SETOF                       0865               S01194
     C                     SETOF                         65               S01194
0377 C**********           READ TABLE                    65               S01194
0377 C                     READ SDCURRPD                 65               S01194
0378 C**N08*********                                                      S01194
0379 C*R*65*********       GOTO CCYEND                                    S01194
     C   65                GOTO CCYEND                                    S01194
0380 C*
0381 C********** RECI      COMP 'D'                      65               S01194
0382 C**N65*****           GOTO LOP1                                      S01194
0383 C********** SREC      COMP 2                        65               S01194
0384 C***65*****           GOTO LOP1                                      S01194
0385 C           Y         ADD  1         Y
0386 C                     MOVE CCY       ACY,Y
0387 C                     Z-ADDCDP       ADP,Y
0388 C           Y         COMP 150                    65
0389 C   65                GOTO LOP1
0390 C*
0391 C           CCYEND    TAG                             ** CCYEND TAG**
     C/COPY WNCPYSRC,LE0220C022
0392 C*
0393 C* SET INDICATORS FOR FIRST OUTPUT (DISPLAY ONLY FIRST
0394 C* LINE HEADINGS,F3 AND INPUT INSTRUCTIONS
0395 C*
0396 C                     SETON                     202123
0397 C                     SETON                     242531
0398 C                     SETON                     171850
0399 C*
0400 C                     GOTO OUTPUT
0402 C*
0403 C********************************************************************
0404 C******     PROCESS INPUT                       *********************
0405 C*
0406 C           ENDFC     TAG                             ** ENDFC TAG **
     C                     SETOF                     26
     C**
0407 C*
0408 C* IF NO F3 OR ROLLUP/ROLLDOWN GIVEN, SKIP TO VALIDATION
0409 C  NKCN33N34          GOTO VALID
0410 C*
0411 C* IF F3, RELEASE SCREEN AND END PROGRAM
0412 C   KC                SETOF                     50
0413 C   KC                SETON                     51
     C   KC                SETON                     LR
0414 C   KC                GOTO OUTPUT
0415 C*
0416 C* ROLLUP OR ROLLDOWN, IF INVALID,SET ERROR MESSAGE
0417 C                     SETON                     25
0418 C   33N14
0419 COR 33 18
0420 COR 34N14
0421 COR 34 17             SETOF                     25
0422 C  N25                MOVE ERR,5     MSG    62
0423 C  N25                SETON                     50
0424 C  N25                GOTO OUTPUT
0425 C*
0426 C* ROLLUP, IF VALID, UPDATE 'FANO' WITH NEXT LIVE FAC.REF
     C**
     C   33N14
     COR 33 18
     COR 34N14
     COR 34 17             SETON                     26
     C**
0427 C* (JUST READ IN PREVIOUS CYCLE) AND SKIP TO BREC
0428 C   33 14N18          MOVE FCTN      FANO
0429 C   33 14N18          GOTO BREC
0430 C*
0431 C* ROLLDOWN, IF VALID, RESET INDICATORS AND
0432 C* SKIP TO FACNO FOR FIRST FACILITY
0433 C*
0434 C   34 14N17          SETON                     161718
0435 C   34                SETON                     2425
0436 C   34                GOTO FACNO
0438 C*
0439 C********************************************************************
0440 C******     VALIDATE CUSTOMER DETAILS INPUT     *********************
0441 C* COMES FROM:  PROCESS INPUT
0442 C*
0443 C           VALID     TAG                             ** VALID TAG **
0444 C*
0445 C* RESET INDICATORS
0446 C                     SETOF                     272899
0447 C                     SETOF                     293050
0448 C                     SETOF                     525314
     C                     SETOF                     54                   S01117
0449 C                     SETON                     161718
0450 C                     SETON                     232425
0451 C*
0452 C* CHECK WHICH FIELDS INPUT OR BLANK
0453 C* IF EITHER PART OF FAC.NO.BLANK, TREAT AS ALL BLANK
0454 C   12
0455 COR 13                SETON                     14
0456 C*
0457 C* IF CUSTOMER DETAILS BLANK ON INPUT (11 ON), SET ERROR MSG.
0458 C* RETURN SCREEN - BLINK CUST.DETAILS - AND RETURN FAC.NO.IF INPUT
0459 C   11                MOVE ERR,6     MSG
0460 C   11                SETON                     295250
0461 C   11                SETOF                     25
0462 C   11N14             SETON                     30
0463 C   11                GOTO OUTPUT
0464 C*
0465 C* DETERMINE WHETHER CUSTOMER NUMBER OR SHORTNAME INPUT.
0466 C* CHECK FIELD IS NUMERIC AND 6 INTEGERS ONLY
0467 C                     MOVE BLANKS    ZFIELD
0468 C                     MOVE CUSDET    ZFIELD
0469 C                     MOVE '06'      ZADIG
0470 C                     EXSR ZALIGN
0471 C*
0472 C* 99 IS SET ON IF FIELD INPUT NOT 6 DIGIT NUMERIC
     C*
0473 C**N99*****           SETON                     27    CUSTOMER NO.   S01194
0474 C***99*****           SETON                     28    SHORTNAME      S01194
0475 C**********           SETOF                     99                   S01194
0476 C*
0477 C**IF*CUSTOMER*NUMBER,*THEN*STORE*IN*NEW*FIELD*-*CSNO,               S01194
0478 C**AND*CHECK*IT*EXISTS*ON*CLIENT*FILE                                S01194
0479 C***27*****           MOVE ZFIELD    CSNO    60                      S01194
0480 C***27*****           EXSR QCLINT                                    S01194
0481 C*
0482 C* IF NOT FOUND SET ERROR MESSAGE, RETURN                            S01194
0483 C* CUSTOMER NO. AND BLINK.  RETURN FAC.NO IF INPUT.
0484 C***27*42**           MOVE ERR,1     MSG                             S01194
0485 C***27*42**           SETON                     295052               S01194
0486 C***27*42**           SETOF                     25                   S01194
0487 C***27*42N14          SETON                     30                   S01194
0488 C***27*42**           GOTO OUTPUT                                    S01194
0489 C*
0490 C**IF*NUMBER*IS*FOUND,*NOW*HAVE*REPORT*NAME,*SKIP*TO*FACNO***********S01194
     C***27N42***          GOTO FACNO                                     S01194
0492 C*
0493 C**IF*SHORTNAME,*CHECK*EXISTS*ON*SNAME*FILE                          S01194
0494 C***28*****           MOVE CUSDET    CSNM                            S01194
0495 C***28***** CSNM      CHAINSNAME                43                   S01194
0496 C***28N43** RECI      COMP 'D'                  4343                 S01194
0497 C***28*43** RECI      COMP 'C'                  4343                 S01194
0498 C*
0499 C**IF*NOT*FOUND,*SET*ERROR*MESSAGE,*RETURN                           S01194
0500 C**SHORTNAME*AND*BLINK.**RETURN*FAC.NO.*IF*INPUT.                    S01194
0501 C***28*43**           MOVE ERR,2     MSG                             S01194
0502 C***28*43**           SETON                     295052               S01194
0503 C***28*43**           SETOF                     25                   S01194
0504 C***28*43N14          SETON                     30                   S01194
0505 C***28*43**           GOTO OUTPUT                                    S01194
0507 C*
0508 C** IF SHORTNAME FOUND, NOW HAVE CUSTNO., ACCESS REPORT NAME
0509 C***28*****           Z-ADDCNUM      CSNO                            S01194
0510 C***28*****           EXSR QCLINT                                    S01194
0511 C*
0512 C**IF*NOT*FOUND ON CLINT, DATABASE ERROR                             S01194
0513 C***28*42**           SETON                     U7U851               S01194
0514 C***28*42**           SETOF                     50                   S01194
0515 C***28*42**           MOVE '02'      DBASE              (*DBASE 02*) S01194
0516 C***28*42**           MOVE 'CLINT'   DBFILE                          S01194
0517 C***28*42**           MOVELCLINKY    DBKEY                           S01194
0518 C***28*42**           GOTO OUTPUT                                    S01194
     C*                                                                   S01194
     C                     MOVE CUSDET    CKEY                            S01194
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C*                                                                   S01194
     C* IF NOT FOUND SET ERROR MESSAGE, RETURN                            S01194
     C* CUSTOMER NO. AND BLINK.  RETURN FAC.NO IF INPUT.                  S01194
     C           *IN99     IFEQ '0'                                       S01194
     C                     MOVE ERR,1     MSG                             S01194
     C                     ELSE                                           S01194
     C                     MOVE ERR,2     MSG                             S01194
     C                     END                                            S01194
     C                     SETOF                     2599                 S01194
     C                     SETON                     295052               S01194
     C        N14          SETON                     30                   S01194
     C************         SETON                     U7U851               S01194
     C                     SETON                     51                   S01194
     C************         SETOF                     50                   S01194
     C                     MOVE '02'      DBASE                        *) S01194
     C                     MOVEL'SDCUSTPD'DBFILE             (*DBASE 02*) S01194
     C                     MOVELCKEY      DBKEY                        *) S01194
     C                     GOTO OUTPUT                                    S01194
     C                     ELSE                                           S01194
     C                     MOVEL*BLANKS   CUSDET                          S01194
     C                     MOVELBBCUST    CUSDET                          S01194
     C                     END                                            S01194
     C**********           MOVE BBCUST    CSNO    60                                   S01194 CSD027
     C                     MOVE BBCUST    CSNO    6                                           CSD027
      *                                                                   S01117
      ********************************************************************S01117
      ******     VALIDATE BRANCH INPUT               *********************S01117
      * COMES FROM:  CUST.DETAILS INPUT                                   S01117
      *                                                                   S01117
     C           BCHVLD    TAG                             * TAG BCHVLD * S01117
      *                                                                   S01117
      * SKIP THE PROCESSING WHEN MULTIBRANCHING IS NO                     S01117
     C           MBIN      IFEQ 'Y'                                       S01117
      *                                                                   S01117
      * IF BRANCH IS NOT INPUT AND FACILITY NO. IS NOT INPUT,             S01117
      * USER DEFAULT BRANCH IS USED.                                      S01117
     C           FBRCA     IFEQ *BLANKS                                   S01117
     C           *IN14     ANDEQ'1'                                       S01117
     C                     MOVE USRBCH    FBRCA                           S01117
     C                     END                                            S01117
      *                                                                   S01117
      * CHECKING THE INPUT BRANCH WHEN -                                  S01117
      *       A) FACILITY IS NOT ENTERED,                                 S01117
      *       B) FACILITY IS ENTERED BUT THE INPUT BRANCH                 S01117
      *          CODE IS NOT *BLANKS OR 'ALL'                             S01117
      *                                                                   S01117
     C           *IN14     IFEQ '1'                                       S01117
     C           *IN14     ORNE '1'                                       S01117
     C           FBRCA     ANDNE'   '                                     S01117
     C           FBRCA     ANDNE'ALL'                                     S01117
      *                                                                   S01117
      * IF 'ALL' IS INPUT, CHECK IF HAVING SYSTEM AUTHORITY               S01117
     C           FBRCA     IFEQ 'ALL'                                     S01117
      *                                                                   S01117
     C           BNKAUT    IFNE 'Y'                                       S01117
     C                     SETON                     54                   S01117
     C                     MOVE ERR,7     MSG                             S01117
     C                     END                                            S01117
      *                                                                   BHF495
     C                     MOVE FBRCA     SFBRCA                          BHF495
      *                                                                   S01117
     C                     ELSE                                           S01117
      *                                                                   S01117
      * IF NOT 'ALL', CHECK IF THE BRANCH CODE IS CORRECT                 S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*BLANKS' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM FBRCA     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     54                   S01117
     C                     MOVE ERR,8     MSG                             S01117
     C                     ELSE                                           S01117
     C                     MOVELA8BRCD    FBRCA                           S01194
      *                                                                   S01117
      * IF BRANCH CODE IS CORRECT, CHECK IF THE USER HAS AUTHORITY        S01117
      * ON THE SPECIFIED BRANCH (BOOKING)                                 S01117
     C                     CALL 'ZVBBU'                                   S01117
     C                     PARM FBRCA     @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE 0                                         S01117
     C                     SETON                     54                   S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     MOVE ERR,9     MSG                             S01117
     C                     ELSE                                           S01117
     C                     MOVE ERR,10    MSG                             S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
     C           *IN54     IFEQ '1'                                       S01117
     C                     MOVE *BLANKS   BRTTL  40                       S01117
     C                     SETON                     2950                 S01117
     C                     SETOF                     25                   S01117
     C           *IN14     IFNE '1'                                       S01117
     C                     SETON                     30                   S01117
     C                     END                                            S01117
     C                     GOTO OUTPUT                                    S01117
     C                     END                                            S01117
      *                                                                   S01117
      * SAVE THE BRANCH CODE FIELDS                                       S01117
     C           *LIKE     DEFN FBRCA     SFBRCA                          S01117
     C                     MOVE FBRCA     SFBRCA                          S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
      * SET UP BRANCH TITLE                                               S01117
     C           *IN14     IFNE '1'                                       S01117
     C                     MOVE *BLANKS   BRTTL  40                       S01117
     C                     ELSE                                           S01117
     C           FBRCA     IFEQ 'ALL'                                     S01117
     C                     MOVE BRTTLT,1  BRTTL                           S01117
     C                     ELSE                                           S01117
     C                     MOVE *BLANK    WRK9    9                       S01117
     C                     MOVEL' Br -'   WRK9                            S01117
     C                     MOVE FBRCA     WRK9                            S01117
     C                     MOVELWRK9      BRTTL                           S01117
     C                     MOVE BRNM      BRTTL                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0520 C*
0521 C********************************************************************
0522 C******     PROCESS FACILITY NUMBER             *********************
0523 C* COMES FROM:- PROCESS INPUT (ROLLDOWN)
0524 C*************-*VALIDATE*CUST.*DETAILS*INPUT****                     S01117
0524 C*            - VALIDATE BRANCH DETAILS INPUT                        S01117
0525 C*
0526 C           FACNO     TAG                             ** FACNO TAG **
0527 C*
0528 C*  IF NOT BLANK ON INPUT GOTO FACNO2
0529 C*
0530 C  N14                GOTO FACNO2
0531 C*
0532 C********************************************************************
0533 C******     IF FACILITY NO. BLANK ON INPUT      *********************
0534 C**         USE ONLY CUST.NO.TO READ FCLTY FILE
0535 C                     MOVE ZERO      FACKEY 12
0536 C                     MOVE ' '       FACKEY
0537 C                     MOVELCSNO      FACKEY
0538 C           FACKEY    SETLLFCLTY
0539 C           FACL      TAG                             ** FACL TAG **
0540 C                     SETOF                       4648
0541 C                     READ FCLTY                    48 48=END OF FILE
0542 C*
0543 C* IF NOT END OF FILE, CHECK FOR LIVE RECORD AND FOR MATCH
     C* WHEN MBIN = 'Y', CHECK FOR IF THE BRANCH ON RECORD IS             S01117
     C* THE REQUSETED                                                     S01117
0544 C**N48******RECI      COMP 'D'                      46               S01117
0545 C**N48N46***RECI      COMP 'E'                      46               S01117
      *                                                                   S01117
     C           *IN48     IFNE '1'                                       S01117
      *                                                                   S01117
     C           RECI      IFNE 'D'                                       S01117
     C           RECI      ANDNE'E'                                       S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           SFBRCA    ANDNE'ALL'                                     S01117
     C           SFBRCA    ANDNEBRCA                                      S01117
     C                     SETOF                         46               S01117
     C                     ELSE                                           S01117
     C                     SETON                         46               S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
0546 C  N48N46             GOTO FACL
0547 C  N48 46   CSNO      COMP CNUM                     46
0548 C*
0549 C* IF NO MATCH, MOVE CUST. NAME AND NUMBER TO OUTPUT FIELDS
0550 C* DISPLAY "NO FACILITIES" MESSAGE, AND OUTPUT SCREEN
0551 C  N46                MOVE CRNM      CRNMA  20
0552 C**N46*****           Z-ADDCSNO      CSNOA   60                                          CSD027
0552 C  N46                MOVE CSNO      CSNOA   6                                           CSD027
      *                                                                   S01117
     C           *IN46     IFNE '1'                                       S01117
     C           SFBRCA    IFEQ 'ALL'                                     S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C                     MOVE ERR,11    MSG                             S01117
     C                     ELSE                                           S01117
     C                     MOVE ERR,12    MSG                             S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
0553 C  N46                SETOF                     202329
0554 C  N46                SETOF                     305253
     C  N46                SETOF                     25                   S01117
0555 C**N46******          SETON                     212425               S01117
0555 C  N46                SETON                     2124                 S01117
0556 C  N46                SETON                     31
0557 C  N46                SETON                     171850
0558 C  N46                GOTO OUTPUT
0559 C*
0560 C* IF DOES MATCH, MOVE FAC.REF. TO FANO
0561 C   46                MOVE FCTN      FANO
0562 C*
0563 C* CHECK REC.TYPE A.  IF NOT, DATABASE ERROR
0564 C   46      RCTP      COMP 'A'                  4444
0565 C*
0566 C   44                SETON                     U7U851
0567 C   44                SETOF                     50
0568 C   44                MOVE '03'      DBASE              (*DBASE 03*)
0569 C   44                MOVE 'FCLTY'   DBFILE
0570 C*
0571 C   44                MOVELFANO      FKEY1   6
0572 C   44                MOVE 'A'       FKEY1
0573 C   44                MOVE FKEY1     FACKEY
0574 C   44                MOVELFACKEY    DBKEY
0575 C   44                GOTO OUTPUT
0576 C*
0577 C* IF HAVE 'A' RECORD, ACCESS 'B' RECORD
0578 C   46N44             GOTO BREC
0580 C*
0581 C********************************************************************
0582 C******   PROCESSING IF FACILITY NO. WAS INPUT   ********************
0583 C* COMES FROM:- FACNO
0584 C*
0585 C           FACNO2    TAG                             **FACNO2 TAG **
0586 C*
0587 C* VALIDATE NUMERIC, 5 INTEGERS ONLY
0588 C                     MOVE BLANKS    ZFIELD
0589 C                     MOVE FANO      ZFIELD
0590 C                     MOVE '05'      ZADIG
0591 C                     EXSR ZALIGN
0592 C*
0593 C* IF 99 ON, FAC NO. INVALID (NOT 5 DIGIT AND NUMERIC)
0594 C* OUTPUT ERROR MESSAGE AND RETURN CUST. DETAILS AND FCLTY NO.
0595 C* BLINK FACILITY NO.
0596 C   99                MOVE ERR,3     MSG
0597 C   99                SETOF                     25
0598 C   99                SETON                     293050
0599 C   99                SETON                     53
0600 C   99                GOTO OUTPUT
0601 C*
0602 C* IF FAC.NO. VALID, SETLL CNUM + FANO TO READ FCLTY FILE
0603 C                     MOVE ZERO      FACKEY
0604 C                     MOVELCSNO      FACKEY
0605 C                     MOVELFANO      FKEY1
0606 C                     MOVE 'A'       FKEY1
0607 C                     MOVE FKEY1     FACKEY
0608 C           FACKEY    SETLLFCLTY
0609 C                     SETOF                       4648
0610 C                     READ FCLTY                    48 48=END OF FILE
0611 C*
0612 C* IF NOT END OF FILE, CHECK FOR LIVE RECORD AND FOR MATCH
     C* WHEN MBIN = 'Y', CHECK FOR IF THE BRANCH ON RECORD IS             S01117
     C* THE REQUSETED                                                     S01117
0613 C**N48******RECI      COMP 'D'                      46               S01117
0614 C**N48N46***RECI      COMP 'E'                      46               S01117
0615 C**N48*46***CSNO      COMP CNUM                     46               S01117
0616 C***48*46***FANO      COMP FCTN                     46               S01117
      *                                                                   S01117
     C           *IN48     IFNE '1'                                       S01117
      *                                                                   S01117
     C           RECI      IFNE 'D'                                       S01117
     C           RECI      ANDNE'E'                                       S01117
     C           CSNO      ORNE CNUM                                      S01117
     C           FANO      ORNE FCTN                                      S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           FBRCA     ANDNE'   '                                     S01117
     C           FBRCA     ANDNE'ALL'                                     S01117
     C           FBRCA     ANDNEBRCA                                      S01117
     C                     SETOF                         46               S01117
     C                     ELSE                                           S01117
     C                     SETON                         46               S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
0617 C*
0618 C* IF NO MATCH, SET ERROR MESSAGE AND OUTPUT SCREEN
0619 C* WITH CUST.DETAILS AND FAC.NO. - BLINK FAC.NO.
0620 C  N46                MOVE ERR,4     MSG
0621 C  N46                SETOF                     25
0622 C  N46                SETON                     293050
0623 C**N46*****           SETON                     53                   S01117
0623 C  N46                SETON                     5354                 S01117
0624 C  N46                GOTO OUTPUT
0625 C*
0626 C* IF MATCH, CONTINUE
      *                                                                   S01117
     C           PRTR      IFEQ 'P'                                       145826
     C           TRCA      ANDEQ'CA'                                      145826
     C           PRTR      OREQ 'I'                                       145826
     C           TRCA      ANDEQ'CA'                                      145826
     C           PRTR      OREQ 'R'                                                           CLE106
     C           TRCA      ANDEQ'CA'                                                          CLE106
     C           PRTR      OREQ 'S'                                                           CLE106
     C           TRCA      ANDEQ'CA'                                                          CLE106
     C                     MOVE ERR,13    MSG                             145826
     C                     SETOF                     25                   145826
     C                     SETON                     293050               145826
     C                     SETON                     53                   145826
     C                     GOTO OUTPUT                                    145826
     C                     END                                            145826
      *                                                                   145826
      * TO CHECK IF THE BRANCH CODE (BOOKING) IN THE RECORD               S01117
      * IS AUTHORIZED TO THE USER WHEN BRANCH CODE IS NOT INPUT           S01117
      *                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
      *                                                                   S01117
     C           FBRCA     IFEQ '   '                                     S01117
     C           FBRCA     OREQ 'ALL'                                     S01117
      *                                                                   S01117
     C                     CALL 'ZVBBU'                                   S01117
     C                     PARM BRCA      @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE 0                                         S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     MOVE ERR,9     MSG                             S01117
     C                     ELSE                                           S01117
     C                     MOVE ERR,10    MSG                             S01117
     C                     END                                            S01117
0621 C                     SETOF                     25                   S01117
0622 C                     SETON                     293050               S01117
0623 C                     SETON                     53                   S01117
0624 C                     GOTO OUTPUT                                    S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0627 C*
0629 C********************************************************************
0630 C******     ACCESS DETAILS FROM FCLTY 'B' RECORD    *****************
0631 C* COMES FROM:- PROCESS INPUT(ROLLUP)
0632 C*            - PROCESS FACILITY NUMBER
0633 C*
0634 C           BREC      TAG                             ** BREC TAG **
     C/COPY WNCPYSRC,LEH00927
0635 C*
0636 C* ACCESS NEXT RECORD.
0637 C* IF NOT MATCHING 'B' RECORD, DATABASE ERROR
0638 C                     SETOF                       4648
0639 C                     READ FCLTY                    48
0640 C  N48      RECI      COMP 'D'                      46
0641 C  N48N46   RECI      COMP 'E'                      46
0642 C  N48 46   CSNO      COMP CNUM                     46
0643 C  N48 46   FANO      COMP FCTN                     46
0644 C  N48 46   RCTP      COMP 'B'                      46
     C/COPY WNCPYSRC,LEH00076
0645 C*
0646 C  N46                SETON                     U7U851
0647 C  N46                SETOF                     50
0648 C  N46                MOVE '04'      DBASE              (*DBASE 04*)
0649 C  N46                MOVE 'FCLTY'   DBFILE
0650 C*
0651 C  N46                MOVELFANO      FKEY1
0652 C  N46                MOVE 'B'       FKEY1
0653 C  N46                MOVE FKEY1     FACKEY
0654 C  N46                MOVELFACKEY    DBKEY
     C*                                                                   S01117
     C* CHECK MULTI-BRANCH FACILITY INDICATOR                             S01117
     C           MBFC      COMP 'Y'                      35               S01117
0655 C  N46                GOTO OUTPUT
      *                                                                   158930
      ** Consider repayments made with respect to backdated               158930
      ** Revolving Credit changes                                         158930
      *                                                                   158930
     C                     EXSR FARCHS                                    158930
      *                                                                   158930
      ** Availablity of the previous day should not depend on the         157935
      ** current facility amount, so retrieve last facility amount.       157935
     C                     Z-ADD0         PVFAMT 130                      157935
     C                     MOVE '0'       *IN05                           157935
     C           *LOVAL    SETLLFACHISHF                                  157935
     C           *IN05     DOWNE'1'                                       157935
     C                     READ FACHISHF                 05               157935
     C           *IN05     IFNE '1'                                       157935
     C                     MOVE '0'       *IN06                           157935
     C           CNUM      DOWEQFHCNUM                                    157935
     C           FACT      ANDEQFHFTYP                                    157935
     C           *IN06     ANDNE'1'                                       157935
     C           FCNO      IFEQ FHFSEQ                                    157935
     C                     Z-ADDFHLFAM    PVFAMT                          157935
     C                     END                                            157935
     C                     READ FACHISHF                 06               157935
     C                     MOVE '1'       *IN05                           157935
     C                     END                                            157935
     C                     END                                            157935
     C                     END                                            157935
      *                                                                   194464
      ** If PVFAMT is zero, the amount should be the current facility     194464
      ** amount                                                           194464
      *                                                                   194464
     C           PVFAMT    IFEQ *ZEROS                                    194464
     C                     Z-ADDFAMT      PVFAMT                          194464
     C                     ENDIF                                          194464
      *                                                                   194464
0657 C* CALCULATE AMOUNTS AVAILABLE
0658 C***********FAMT      SUB  OAM1      OAM1A  130                      157935
     C           PVFAMT    SUB  OAM1      OAM1A  130                      157935
0659 C           FAMT      SUB  OAM2      OAM2A  130
0660 C           FAMT      SUB  OAM3      OAM3A  130
0661 C           FAMT      SUB  OAM4      OAM4A  130
0662 C           FAMT      SUB  OAM5      OAM5A  130
0663 C           FAMT      SUB  OAM6      OAM6A  130
0664 C           FAMT      SUB  OAM7      OAM7A  130
0665 C           FAMT      SUB  OAM8      OAM8A  130
0666 C           FAMT      SUB  OAM9      OAM9A  130
0667 C           FAMT      SUB  OA10      OA10A  130
      *                                                                                       256346
      ** Add up offset amount to amount available when CLE025 is ON                           256346
      *                                                                                       256346
     C           CLE025    IFEQ 'Y'                                                           256346
      *                                                                                       256346
     C                     MOVELCNUM      FQCNUM  6                                           256346
     C                     MOVELFACT      FQFACT  3                                           256346
     C                     MOVELFCNO      FQFCNO  2                                           256346
      *                                                                                       256346
     C           FCQKEY    KLIST                                                              256346
     C                     KFLD           FQCNUM                                              256346
     C                     KFLD           FQFACT                                              256346
     C                     KFLD           FQFCNO                                              256346
      *                                                                                       256346
     C           FCQKEY    CHAINLEFCLTLH             74                                       256346
     C           *IN74     IFEQ '0'                                                           256346
     C                     ADD  FCXOF1    OAM1A                                               256346
     C                     ADD  FCXOF2    OAM2A                                               256346
     C                     ADD  FCXOF3    OAM3A                                               256346
     C                     ADD  FCXOF4    OAM4A                                               256346
     C                     ADD  FCXOF5    OAM5A                                               256346
     C                     ADD  FCXOF6    OAM6A                                               256346
     C                     ADD  FCXOF7    OAM7A                                               256346
     C                     ADD  FCXOF8    OAM8A                                               256346
     C                     ADD  FCXOF9    OAM9A                                               256346
     C                     ADD  FCXO10    OA10A                                               256346
     C                     ENDIF                                                              256346
      *                                                                                       256346
     C                     ENDIF                                                              256346
      *                                                                                       256346
     C* If facility has expired check to see whether there                152170
     C* is a Reopen amendment.                                            152170
     C*                                                                   152170
     C           RECI      IFEQ 'E'                                       152170
     C                     EXSR FAREOP                                    152170
     C                     ENDIF                                          152170
     C*                                                                   152170
     C** Call subroutine FACALC to check for amendments                   152170
     C                     EXSR FACALC                                    152170
      *                                                                   158930
      ** Consider Revolving Credit Changes in the facility                158930
      *                                                                   158930
     C                     EXSR FARCPA                                    158930
      *                                                                   158930
      ** Process Loan amendments for update of current                                        199073
      ** facility amount                                                                      199073
      *                                                                                       199073
     C                     EXSR FALAMD                                                        199073
      *                                                                                       199073
      /COPY OFCPYSRCZ,CGL145_014                                                             CGL145B
     C*
     C** FUNDS ARE ONLY AVAILABLE AFTER APPROVAL DATE
     C**   AND NOT AFTER EXPIRY DATE
     C*
0658 C           DTAP      COMP DAY,2                32
     C/COPY WNCPYSRC,LE0220C002
     C  N32      DTEX      COMP DAY,2                  32
     C           DTEX      IFEQ DAY,2                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C003
0659 C   32                Z-ADD0         OAM1A
0658 C           DTAP      COMP DAY,3                32
     C/COPY WNCPYSRC,LE0220C004
     C  N32      DTEX      COMP DAY,3                  32
     C           DTEX      IFEQ DAY,3                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C005
0659 C   32                Z-ADD0         OAM2A
0658 C           DTAP      COMP DAY,4                32
     C/COPY WNCPYSRC,LE0220C006
     C  N32      DTEX      COMP DAY,4                  32
     C           DTEX      IFEQ DAY,4                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C007
0659 C   32                Z-ADD0         OAM3A
0658 C           DTAP      COMP DAY,5                32
     C/COPY WNCPYSRC,LE0220C008
     C  N32      DTEX      COMP DAY,5                  32
     C           DTEX      IFEQ DAY,5                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C009
0659 C   32                Z-ADD0         OAM4A
0658 C           DTAP      COMP DAY,6                32
     C/COPY WNCPYSRC,LE0220C010
     C  N32      DTEX      COMP DAY,6                  32
     C           DTEX      IFEQ DAY,6                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C011
0659 C   32                Z-ADD0         OAM5A
0658 C           DTAP      COMP DAY,7                32
     C/COPY WNCPYSRC,LE0220C012
     C  N32      DTEX      COMP DAY,7                  32
     C           DTEX      IFEQ DAY,7                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C013
0659 C   32                Z-ADD0         OAM6A
0658 C           DTAP      COMP DAY,8                32
     C/COPY WNCPYSRC,LE0220C014
     C  N32      DTEX      COMP DAY,8                  32
     C           DTEX      IFEQ DAY,8                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C015
0659 C   32                Z-ADD0         OAM7A
0658 C           DTAP      COMP DAY,9                32
     C/COPY WNCPYSRC,LE0220C016
     C  N32      DTEX      COMP DAY,9                  32
     C           DTEX      IFEQ DAY,9                                                         209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C017
0659 C   32                Z-ADD0         OAM8A
0658 C           DTAP      COMP DAY,10               32
     C/COPY WNCPYSRC,LE0220C018
     C  N32      DTEX      COMP DAY,10                 32
     C           DTEX      IFEQ DAY,10                                                        209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C019
0659 C   32                Z-ADD0         OAM9A
0658 C           DTAP      COMP DAY,11               32
     C/COPY WNCPYSRC,LE0220C020
     C  N32      DTEX      COMP DAY,11                 32
     C           DTEX      IFEQ DAY,11                                                        209384
     C                     MOVE '1'       *IN32                                               209384
     C                     ENDIF                                                              209384
     C/COPY WNCPYSRC,LE0220C021
0659 C   32                Z-ADD0         OA10A
      /COPY OFCPYSRCZ,CGL145_015                                                             CGL145B
0668 C*
0669 C* ACCESS CURRENCY ARRAYS FOR DECIMAL PLACES
0670 C* IF CCY BLANK ON FILE, DATABASE ERROR
0671 C                     SETOF                     606162
0672 C                     SETOF                     6367
0673 C           FCCY      COMP '   '                    49
0674 C   49                GOTO DBASE5
0675 C                     Z-ADD1         T       30         60=0
0676 C           FCCY      LOKUPACY,T                    67  61=1
0677 C   67      ADP,T     COMP 1                      6061  62=2
0678 C   67N60N61ADP,T     COMP 3                      6263  63=3
0679 C*
0680 C* DATABASE ERROR IF NOT FOUND
0681 C           DBASE5    TAG                             ** DBASE5 TAG**
0682 C  N67                SETOF                     50
0683 C  N67                SETON                     U7U851
0684 C**N67******          MOVE 'O5'      DBASE              (*DBASE 05*) E20757
0684 C  N67                MOVE '05'      DBASE              (*DBASE 05*) E20757
0685 C**N67*****           MOVE 'TABLE'   DBFILE                          S01194
0685 C  N67                MOVEL'SDCURRPD'DBFILE                          S01194
0686 C**N67*****           MOVELFCCY      CKEY1   4                       S01194
0687 C**N67*****           MOVE '1'       CKEY1                           S01194
0688 C**N67*****           MOVEL'20'      CCYKEY                          S01194
0689 C**N67*****           MOVE CKEY1     CCYKEY                          S01194
0690 C**N67*****           MOVELCCYKEY    DBKEY                           S01194
0686 C  N67                MOVELFCCY      DBKEY                           S01194
0691 C  N67                GOTO OUTPUT
0692 C*
0693 C* CONVERT ALL DAYNOS TO DATE FORMAT USING ARRAYS
0694 C                     Z-ADD1         X       20
0695 C           DATE      TAG                             ** DATE TAG **
0696 C                     Z-ADDDAY,X     ZDAYNO
0697 C                     EXSR ZDATE2
0698 C                     MOVE ZADATE    DAT,X
0699 C********** X         COMP 11                     47                 S01270
0699 C           X         COMP 12                     47                 S01270
0700 C   47      X         ADD  1         X
0701 C   47                GOTO DATE
     C/COPY WNCPYSRC,LE0220C023
      *                                                                   CLE014
      ** Format last availability date for display                        CLE014
      *                                                                   CLE014
     C           CLE014    IFEQ 'Y'                                       CLE014
     C                     Z-ADDAVLD      ZDAYNO                          CLE014
     C                     EXSR ZDATE2                                    CLE014
     C                     MOVE ZADATE    SLSADT  7                       CLE014
     C                     ENDIF                                          CLE014
0702 C*
0703 C* CHECK IF REVOLVING CREDIT
0704 C           RVCR      COMP 'Y'                      31
     C           WRVCR     IFNE *BLANK                                                        247326
     C           WVLDT     ANDLEBJRDNB                                                        247326
     C           WRVCR     COMP 'Y'                      31                                   247326
     C                     ENDIF                                                              247326
      *                                                                   CLE014
      ** Check if facility is a credit agreement                          CLE014
      *                                                                   CLE014
     C           CLE014    IFEQ 'Y'                                       CLE014
     C           TRCA      IFEQ 'CA'                                      CLE014
     C           RVCR      ANDEQ'T'                                       CLE014
     C                     MOVE *ON       *IN22                           CLE014
     C                     ELSE                                           CLE014
     C                     MOVE *OFF      *IN22                           CLE014
     C                     ENDIF                                          CLE014
     C                     ELSE                                           CLE014
     C                     MOVE *OFF      *IN22                           CLE014
     C                     ENDIF                                          CLE014
0705 C*
0706 C* RENAME FIELDS TO BE OUTPUT
0707 C* (TO AVOID OVERWRITING WHEN READ SUBSEQUENT RECORDS)
0708 C                     MOVE CRNM      CRNMA
0709 C**********           Z-ADDCSNO      CSNOA                                               CSD027
0709 C                     MOVE CSNO      CSNOA                                               CSD027
0710 C                     MOVE FANO      FANOA   50
0711 C                     MOVE FCCY      FCCYA   3
0712 C                     Z-ADDFAMT      FAMTA  130
      *                                                                                       CLE023
      ** If CLE023 is installed move CEXP value to Current Exposure                           CLE023
      ** field in display file instead of CAMD.                                               CLE023
      *                                                                                       CLE023
     C           CLE023    IFEQ 'Y'                                                           CLE023
     C                     Z-ADDCEXP      CAMDA                                               CLE023
     C                     Z-ADDCAMD      DRAWA  130                                          241236
     C                     ELSE                                                               CLE023
0713 C                     Z-ADDCAMD      CAMDA  130
     C                     ENDIF                                                              CLE023
0714 C                     Z-ADDOVPC      OVPCA   53
0715 C*
0716 C* SET INDICATORS TO DISPLAY FACILITY DETAILS
0717 C                     SETOF                     202129
0718 C                     SETOF                     305253
0719 C                     SETON                     232550
0720 C*
0721 C* IF THIS ONLY FACILITY REQUESTED, OUTPUT SCREEN WITH
0722 C* '*COMPLETE*'
0723 C  N14                SETOF                     24
0724 C  N14                SETON                     1718
0725 C  N14                GOTO OUTPUT
0726 C*
0727 C* IF MAY BE OTHER FACILITIES TO DISPLAY,
0728 C* DETERMINE IF THIS IS FIRST ONE FOR THIS CUSTOMER
0729 C  N16                SETOF                     17
0730 C                     SETOF                     16
0731 C* (17 ON = FIRST FCLTY, NON-DISPLAY (ROLLDOWN))
0732 C*
0733 C* DETERMINE IF LAST FCLTY FOR THIS CUSTOMER
0734 C* READ FCLTY FILE UNTIL GET NEXT LIVE RECORD (RECI = D OR E )
0735 C* AND CHECK IF SAME CUSTOMER
0736 C           NEXT      TAG                             ** NEXT TAG **
0737 C                     SETOF                       4648
0738 C                     READ FCLTY                    48
0739 C**N48******RECI      COMP 'D'                      46               S01117
0740 C**N48N46***RECI      COMP 'E'                      46               S01117
      *                                                                   S01117
     C           *IN48     IFNE '1'                                       S01117
      *                                                                   S01117
     C           RECI      IFNE 'D'                                       S01117
     C           RECI      ANDNE'E'                                       S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           SFBRCA    ANDNE'ALL'                                     S01117
     C           SFBRCA    ANDNEBRCA                                      S01117
     C           PRTR      OREQ 'P'                                       145826
     C           TRCA      ANDEQ'CA'                                      145826
     C           PRTR      OREQ 'I'                                       145826
     C           TRCA      ANDEQ'CA'                                      145826
     C           PRTR      OREQ 'S'                                                           CLE106
     C           TRCA      ANDEQ'CA'                                                          CLE106
     C           PRTR      OREQ 'R'                                                           CLE106
     C           TRCA      ANDEQ'CA'                                                          CLE106
     C                     SETOF                         46               S01117
     C                     ELSE                                           S01117
     C                     SETON                         46               S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
0741 C  N48N46             GOTO NEXT
0742 C  N48 46   CSNO      COMP CNUM                 1818
0743 C*
0744 C* IF END OF FILE = LAST FCLTY
0745 C   48                SETON                     18
0746 C* (18 ON - LAST FCLTY, NON-DISPLAY (ROLLUP))
0747 C*
0748 C* IF LAST FCLTY, DISPLAY '*COMPLETE*'
0749 C   18                SETOF                     24
0751 C*
0752 C********************************************************************
0753 C******     TO OUTPUT SCREEN                    *********************
0754 C*
0755 C* COMES FROM:- FIRST CYCLE PROCESSING
0756 C*            - PROCESS INPUT (2 PLACES)
0757 C*            - VALID (4 PLACES)
0758 C*            - FACL (2 PLACES)
0759 C*            - FACNO2 (2 PLACES)
0760 C*            - BREC (3 PLACES)
0761 C           OUTPUT    TAG                             ** OUTPUT TAG**
     C**
     C**   IF DATABASE ERRORS SETON LR
     C**
     C   U7                SETON                     LR
0762 C**
0763 C**   IF ERRORS OUTPUT INITIAL SCREEN
0764 C**
     C**N25N26***          SETON                     171820               S01117
     C**N25N26***          SETON                     212324               S01117
     C  N25N26             SETON                     1718                 S01117
     C  N25N26 23          SETON                     20                   S01117
     C  N25N26             SETON                     2124                 S01117
     C  N25N26             SETON                     31
0768 C*
     C**   UNLESS ERRORS DO NOT OUTPUT CUSTOMER NUMBER OR FACILITY
     C*
     C  N29                MOVE BLANKS    CUSDET
     C  N29                MOVE *BLANKS   FBRCA                           S01117
     C  N30                MOVE BLANKS    FANO1
     C  N30                MOVE BLANKS    FANO2
     C*
0769 C   50                TIME           MTIME   60
      **                                                                  S01117
      **   EXCUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                  S01117
      **                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
0770 C*
0772 C********************************************************************
     C********************************************************************
0966 C***********SUBROUTINE*TO*CHAIN*TO*CLINT*FOR*REPORT*NAME*************S01194
0967 C*****CALLED*BY*VALID*(EITHER*CUST.NUMBER*OR*SHORTNAME*PROCESSING)   S01194
0968 C**********                                                          S01194
0969 C********** QCLINT    BEGSR                           ***  QCLINT ***S01194
0970 C**********                                                          S01194
0971 C**********           MOVELCSNO      CLINKY  7                       S01194
0972 C**********           MOVE 'A'       CLINKY                          S01194
0973 C********** CLINKY    CHAINCLINT                42                   S01194
0974 C**N42***** RECI      COMP 'D'                  4242                 S01194
0975 C***42***** RECI      COMP 'C'                  4242                 S01194
0976 C**********                                                          S01194
0977 C**********           ENDSR                                          S01194
0979 C**********                                                          S01194
     C********************************************************************152170
     C*                                                                   152170
     C* FAREOP -- Subroutine to handle Facility amendments for a          152170
     C*           reopen of expired Facility                              152170
     C*                                                                   152170
     C* CALLED FROM: After facility has been read                         152170
     C*                                                                   152170
     C* CALLS: NONE                                                       152170
     C*                                                                   152170
     C********************************************************************152170
     C           FAREOP    BEGSR                                          152170
     C                     MOVELCNUM      WCNUM                           152170
     C                     MOVELFACT      WFACT                           152170
     C                     MOVELFCNO      WFCNO                           152170
     C           FCAMK     SETLLLEFCAML3                                  152170
     C           FCAMK     READELEFCAML3                 69               152170
     C           *IN69     DOWEQ*OFF                                      152170
     C           AMRECI    IFEQ 'D'                                       152170
     C           AMFATP    ANDEQ'FR'                                      152170
     C                     SELEC                                          152170
     C           AMVLDT    WHLT DAY,2                                     152170
     C                     Z-ADDAMAAMT    FAMT                            152170
      *                                                                                       204450
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM1A                           152170
     C                     Z-ADDAMAAMT    OAM2A                           152170
     C                     Z-ADDAMAAMT    OAM3A                           152170
     C                     Z-ADDAMAAMT    OAM4A                           152170
     C                     Z-ADDAMAAMT    OAM5A                           152170
     C                     Z-ADDAMAAMT    OAM6A                           152170
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHEQ DAY,2                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM1A                           152170
     C                     Z-ADDAMAAMT    OAM2A                           152170
     C                     Z-ADDAMAAMT    OAM3A                           152170
     C                     Z-ADDAMAAMT    OAM4A                           152170
     C                     Z-ADDAMAAMT    OAM5A                           152170
     C                     Z-ADDAMAAMT    OAM6A                           152170
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,2                                     152170
     C           AMVLDT    ANDLEDAY,3                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM2A                           152170
     C                     Z-ADDAMAAMT    OAM3A                           152170
     C                     Z-ADDAMAAMT    OAM4A                           152170
     C                     Z-ADDAMAAMT    OAM5A                           152170
     C                     Z-ADDAMAAMT    OAM6A                           152170
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,3                                     152170
     C           AMVLDT    ANDLEDAY,4                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM3A                           152170
     C                     Z-ADDAMAAMT    OAM4A                           152170
     C                     Z-ADDAMAAMT    OAM5A                           152170
     C                     Z-ADDAMAAMT    OAM6A                           152170
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,4                                     152170
     C           AMVLDT    ANDLEDAY,5                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM4A                           152170
     C                     Z-ADDAMAAMT    OAM5A                           152170
     C                     Z-ADDAMAAMT    OAM6A                           152170
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,5                                     152170
     C           AMVLDT    ANDLEDAY,6                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM5A                           152170
     C                     Z-ADDAMAAMT    OAM6A                           152170
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,6                                     152170
     C           AMVLDT    ANDLEDAY,7                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM6A                           152170
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,7                                     152170
     C           AMVLDT    ANDLEDAY,8                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM7A                           152170
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,8                                     152170
     C           AMVLDT    ANDLEDAY,9                                     152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM8A                           152170
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,9                                     152170
     C           AMVLDT    ANDLEDAY,10                                    152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OAM9A                           152170
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,10                                    152170
     C           AMVLDT    ANDLEDAY,11                                    152170
     C           AMAAMT    SUB  CAMD      AMAAMT                                              204450
     C                     Z-ADDAMAAMT    OA10A                           152170
      *                                                                   152170
     C                     ENDSL                                          152170
     C                     MOVE 'D'       RECI                            152170
     C                     Z-ADDAMNDEX    DTEX                            152170
     C                     Z-ADDAMNDEX    DAY,1                           152170
     C                     LEAVE                                          152170
     C                     ENDIF                                          152170
     C           FCAMK     READELEFCAML3                 69               152170
     C                     ENDDO                                          152170
     C                     ENDSR                                          152170
     C********************************************************************152170
     C*                                                                   152170
     C* FACALC -- Subroutine to handle Facility amendments for the        152170
     C*           outstanding facility                                    152170
     C*                                                                   152170
     C* CALLED FROM: After facility amounts have been calculated          152170
     C*                                                                   152170
     C* CALLS: NONE                                                       152170
     C*                                                                   152170
     C********************************************************************152170
     C           FACALC    BEGSR                                          152170
     C                     MOVELCNUM      WCNUM                           152170
     C                     MOVELFACT      WFACT                           152170
     C                     MOVELFCNO      WFCNO                           152170
     C           CLE014    IFEQ 'Y'                                       CLE014
     C                     Z-ADDFAMT      SCURAM 130                      CLE014
     C                     ENDIF                                          CLE014
      *                                                                                       CLE023
      ** If CLE023 is installed populate SCURAM field with the actual                         CLE023
      ** facility amount from the Facility History File.                                      CLE023
      *                                                                                       CLE023
     C           CLE023    IFEQ 'Y'                                                           CLE023
      *                                                                                       CLE023
     C                     MOVELFACT      WFCTY                                               CLE023
     C                     MOVE FCNO      WFCTY                                               CLE023
     C                     MOVE WFCTY     WFACL                                               CLE023
      *                                                                                       CLE023
     C           FHKEY     KLIST                                                              CLE023
     C                     KFLD           WCNUM                                               CLE023
     C                     KFLD           WFACL                                               CLE023
      *                                                                                       CLE023
     C           FHKEY     SETGTFACHSAL1                                                      CLE023
     C           FHKEY     REDPEFACHSAL1                 80                                   CLE023
     C           *IN80     IFEQ '0'                                                           CLE023
     C                     Z-ADDFAAFAM    SCURAM                                              CLE023
     C                     ELSE                                                               CLE023
     C                     Z-ADDFAMT      SCURAM                                              CLE023
     C                     ENDIF                                                              CLE023
      *                                                                                       CLE023
     C                     ENDIF                                                              CLE023
      *                                                                                       CLE023
     C           FCAMK     SETLLLEFCAML3                                  152170
     C           FCAMK     READELEFCAML3                 69               152170
     C           *IN69     DOWEQ'0'                                       152170
     C                     SELEC                                          152170
      *                                                                   152170
      ** Amend amount available for a facility increase                   152170
      ** depending upon whichever working day it falls upon               152170
      *                                                                   152170
     C           AMFATP    WHEQ 'FI'                                      152170
     C           AMRECI    ANDEQ'D'                                       152170
      *                                                                   CLE014
      ** Add amendment amount to current amount if value date             CLE014
      ** is earlier than the next working date                            CLE014
      *                                                                   CLE014
     C           CLE014    IFEQ 'Y'                                       CLE014
     C           AMVLDT    ANDLTBJDNWD                                    CLE014
     C           CLE023    OREQ 'Y'                                                           CLE023
     C           AMVLDT    ANDLTBJDNWD                                                        CLE023
     C                     ADD  AMAAMT    SCURAM                          CLE014
     C                     ENDIF                                          CLE014
      *                                                                   CLE014
     C                     SELEC                                          152170
      *                                                                   163937
      ** Include backvalued facility increase on the computation of       163937
      ** available amount.                                                163937
      *                                                                   163937
     C***********AMVLDT    WHEQ DAY,2                              152170 163937
     C           AMVLDT    WHLE DAY,2                                     163937
     C                     ADD  AMAAMT    OAM1A                           152170
     C                     ADD  AMAAMT    OAM2A                           152170
     C                     ADD  AMAAMT    OAM3A                           152170
     C                     ADD  AMAAMT    OAM4A                           152170
     C                     ADD  AMAAMT    OAM5A                           152170
     C                     ADD  AMAAMT    OAM6A                           152170
     C                     ADD  AMAAMT    OAM7A                           152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,2                                     152170
     C           AMVLDT    ANDLEDAY,3                                     152170
     C                     ADD  AMAAMT    OAM2A                           152170
     C                     ADD  AMAAMT    OAM3A                           152170
     C                     ADD  AMAAMT    OAM4A                           152170
     C                     ADD  AMAAMT    OAM5A                           152170
     C                     ADD  AMAAMT    OAM6A                           152170
     C                     ADD  AMAAMT    OAM7A                           152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,3                                     152170
     C           AMVLDT    ANDLEDAY,4                                     152170
     C                     ADD  AMAAMT    OAM3A                           152170
     C                     ADD  AMAAMT    OAM4A                           152170
     C                     ADD  AMAAMT    OAM5A                           152170
     C                     ADD  AMAAMT    OAM6A                           152170
     C                     ADD  AMAAMT    OAM7A                           152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,4                                     152170
     C           AMVLDT    ANDLEDAY,5                                     152170
     C                     ADD  AMAAMT    OAM4A                           152170
     C                     ADD  AMAAMT    OAM5A                           152170
     C                     ADD  AMAAMT    OAM6A                           152170
     C                     ADD  AMAAMT    OAM7A                           152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,5                                     152170
     C           AMVLDT    ANDLEDAY,6                                     152170
     C                     ADD  AMAAMT    OAM5A                           152170
     C                     ADD  AMAAMT    OAM6A                           152170
     C                     ADD  AMAAMT    OAM7A                           152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,6                                     152170
     C           AMVLDT    ANDLEDAY,7                                     152170
     C                     ADD  AMAAMT    OAM6A                           152170
     C                     ADD  AMAAMT    OAM7A                           152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,7                                     152170
     C           AMVLDT    ANDLEDAY,8                                     152170
     C                     ADD  AMAAMT    OAM7A                           152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,8                                     152170
     C           AMVLDT    ANDLEDAY,9                                     152170
     C                     ADD  AMAAMT    OAM8A                           152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,9                                     152170
     C           AMVLDT    ANDLEDAY,10                                    152170
     C                     ADD  AMAAMT    OAM9A                           152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,10                                    152170
     C           AMVLDT    ANDLEDAY,11                                    152170
     C                     ADD  AMAAMT    OA10A                           152170
      *                                                                   152170
     C                     ENDSL                                          152170
      *                                                                   152170
      ** Amend amount available for a facility decrease                   152170
      ** depending upon whichever working day it falls upon               152170
      *                                                                   152170
     C           AMFATP    WHEQ 'FD'                                      152170
     C           AMRECI    ANDEQ'D'                                       152170
      *                                                                   CLE014
      ** Subtract amendment amount to current amount if value date        CLE014
      ** is earlier than the next working date                            CLE014
      *                                                                   CLE014
     C           CLE014    IFEQ 'Y'                                       CLE014
     C           AMVLDT    ANDLTBJDNWD                                    CLE014
     C           CLE023    OREQ 'Y'                                                           CLE023
     C           AMVLDT    ANDLTBJDNWD                                                        CLE023
     C                     SUB  AMAAMT    SCURAM                          CLE014
     C                     ENDIF                                          CLE014
      *                                                                   CLE014
     C                     SELEC                                          152170
      *                                                                   163937
      ** Include backvalued facility decrease on the computation of       163937
      ** available amount                                                 163937
      *                                                                   163937
     C***********AMVLDT    WHEQ DAY,2                              152170 163937
     C           AMVLDT    WHLE DAY,2                                     163937
     C                     SUB  AMAAMT    OAM1A                           152170
     C                     SUB  AMAAMT    OAM2A                           152170
     C                     SUB  AMAAMT    OAM3A                           152170
     C                     SUB  AMAAMT    OAM4A                           152170
     C                     SUB  AMAAMT    OAM5A                           152170
     C                     SUB  AMAAMT    OAM6A                           152170
     C                     SUB  AMAAMT    OAM7A                           152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,2                                     152170
     C           AMVLDT    ANDLEDAY,3                                     152170
     C                     SUB  AMAAMT    OAM2A                           152170
     C                     SUB  AMAAMT    OAM3A                           152170
     C                     SUB  AMAAMT    OAM4A                           152170
     C                     SUB  AMAAMT    OAM5A                           152170
     C                     SUB  AMAAMT    OAM6A                           152170
     C                     SUB  AMAAMT    OAM7A                           152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,3                                     152170
     C           AMVLDT    ANDLEDAY,4                                     152170
     C                     SUB  AMAAMT    OAM3A                           152170
     C                     SUB  AMAAMT    OAM4A                           152170
     C                     SUB  AMAAMT    OAM5A                           152170
     C                     SUB  AMAAMT    OAM6A                           152170
     C                     SUB  AMAAMT    OAM7A                           152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,4                                     152170
     C           AMVLDT    ANDLEDAY,5                                     152170
     C                     SUB  AMAAMT    OAM4A                           152170
     C                     SUB  AMAAMT    OAM5A                           152170
     C                     SUB  AMAAMT    OAM6A                           152170
     C                     SUB  AMAAMT    OAM7A                           152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,5                                     152170
     C           AMVLDT    ANDLEDAY,6                                     152170
     C                     SUB  AMAAMT    OAM5A                           152170
     C                     SUB  AMAAMT    OAM6A                           152170
     C                     SUB  AMAAMT    OAM7A                           152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,6                                     152170
     C           AMVLDT    ANDLEDAY,7                                     152170
     C                     SUB  AMAAMT    OAM6A                           152170
     C                     SUB  AMAAMT    OAM7A                           152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,7                                     152170
     C           AMVLDT    ANDLEDAY,8                                     152170
     C                     SUB  AMAAMT    OAM7A                           152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,8                                     152170
     C           AMVLDT    ANDLEDAY,9                                     152170
     C                     SUB  AMAAMT    OAM8A                           152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,9                                     152170
     C           AMVLDT    ANDLEDAY,10                                    152170
     C                     SUB  AMAAMT    OAM9A                           152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C           AMVLDT    WHGT DAY,10                                    152170
     C           AMVLDT    ANDLEDAY,11                                    152170
     C                     SUB  AMAAMT    OA10A                           152170
      *                                                                   152170
     C                     ENDSL                                          152170
      *                                                                   152170
     C                     ENDSL                                          152170
     C           FCAMK     READELEFCAML3                 69               152170
     C                     ENDDO                                          152170
     C                     ENDSR                                          152170
      *****************************************************************   158930
      *                                                               *   158930
      * FARCHS -- Subroutine to handle backdated Revolving Credit     *   158930
      *           Changes                                             *   158930
      *                                                               *   158930
      * CALLED FROM: Before facility amounts have been calculated     *   158930
      *                                                               *   158930
      * CALLS: FAFACL                                                 *   158930
      *                                                               *   158930
      *****************************************************************   158930
      *                                                                   158930
     C           FARCHS    BEGSR                                          158930
      *                                                                   158930
     C                     Z-ADDFAMT      WFAMT                           158930
     C                     MOVELCNUM      WCNUM                           158930
     C                     MOVELFACT      WFACT                           158930
     C                     MOVELFCNO      WFCNO                           158930
     C                     MOVE *BLANK    WRVCR                                               247326
      *                                                                   158930
     C           FCAMK     SETLLLEFCAML9                                  158930
     C           FCAMK     READELEFCAML9                 69               158930
      *                                                                   158930
     C           *IN69     DOWEQ'0'                                       158930
     C                     MOVE AFRVCR    WRVCR   1                       158930
     C                     MOVE AFVLDT    WVLDT   50                      158930
     C           FCAMK     READELEFCAML9                 69               158930
      *                                                                   158930
      ** Get the last Revolving Credit Change made for the day            158930
      *                                                                   158930
     C           *IN69     DOWEQ'0'                                       158930
     C           AFSQNO    ANDNE1                                         158930
     C                     MOVE AFRVCR    WRVCR                           158930
     C                     MOVE AFVLDT    WVLDT                           158930
     C           FCAMK     READELEFCAML9                 69               158930
     C                     ENDDO                                          158930
      *                                                                   158930
     C           *IN69     IFEQ '1'                                       158930
     C                     MOVE 99999     WRDAT   50                      158930
     C                     ELSE                                           158930
     C                     MOVE AFVLDT    WRDAT                           158930
     C                     ENDIF                                          158930
      *                                                                   158930
     C                     MOVELWFACT     WFCTY   5                       158930
     C                     MOVE WFCNO     WFCTY                           158930
     C                     MOVE WFCTY     WFACL   50                      158930
      *                                                                   158930
      ** Obtain repayments made in history file                           158930
      *                                                                   158930
     C           *LOVAL    SETLLFACHSAL1                                  158930
     C                     READ FACHSAL1                 70               158930
      *                                                                   158930
     C           *IN70     DOWEQ'0'                                       158930
      *                                                                   158930
     C                     MOVE *BLANKS   WFLAG   1                       158930
      *                                                                   158930
     C           FAACTN    IFEQ 'MR'                                      158930
     C           FAACTN    OREQ 'RE'                                      158930
     C           FACNUM    IFEQ WCNUM                                     158930
     C           FAFCTY    ANDEQWFACL                                     158930
     C                     MOVE 'Y'       WFLAG                           158930
     C                     ELSE                                           158930
     C                     MOVE FACNUM    WACNUM                          158930
     C                     MOVELFAFCTY    WAFACT                          158930
     C                     MOVE FAFCTY    WAFCNO                          158930
     C**********           MOVE FALOAN    WALOAN  60                                   158930 CLE148
     C                     MOVE FALOAN    WALOAN  6                                           CLE148
     C                     EXSR FAFACL                                    158930
     C                     ENDIF                                          158930
      *                                                                   158930
     C           WFLAG     IFEQ 'Y'                                       158930
     C           FADATE    ANDLTWRDAT                                     158930
     C           FADATE    ANDGEWVLDT                                     158930
     C           WRVCR     ANDEQ'Y'                                       158930
     C                     ADD  FAAAMT    WFAMT                           158930
     C                     ENDIF                                          158930
      *                                                                   158930
     C                     ENDIF                                          158930
     C                     READ FACHSAL1                 70               158930
     C                     ENDDO                                          158930
      *                                                                   158930
     C                     ENDDO                                          158930
      *                                                                   158930
     C                     Z-ADDWFAMT     FAMT                            158930
      *                                                                   158930
     C                     ENDSR                                          158930
      *                                                                   158930
      *****************************************************************   158930
      *                                                               *   158930
      * FAFACL -- Subroutine to check tranches and participants       *   158930
      *                                                               *   158930
      * CALLED FROM: FARCHS                                           *   158930
      *                                                               *   158930
      * CALLS: None                                                   *   158930
      *                                                               *   158930
      *****************************************************************   158930
      *                                                                   158930
     C           FAFACL    BEGSR                                          158930
      *                                                                   158930
     C                     CLEARWFCLTY                                    158930
     C                     MOVE LEFCLT    WFCLTY                          158930
      *                                                                   158930
     C           FACHK     CHAINLEFCLTL0             71                   158930
      *                                                                   158930
      ** Check if repayment is done to the facility's tranche             158930
      *                                                                   158930
     C           *IN71     IFEQ '0'                                       158930
     C           TRCA      IFEQ 'TR'                                      158930
     C           CANM      ANDEQWCNUM                                     158930
     C           CAFT      ANDEQWFACT                                     158930
     C           CAFN      ANDEQWFCNO                                     158930
     C                     MOVE 'Y'       WFLAG                           158930
     C                     ENDIF                                          158930
     C                     MOVE WFCLTY    LEFCLT                          158930
     C                     ENDIF                                          158930
      *                                                                   158930
      ** Check if repayment is done to the facility's participant         158930
      *                                                                   158930
     C           WALOAN    CHAINLELOANL0             71                   158930
     C           *IN71     IFEQ '0'                                       158930
     C           LPFI      IFNE ' '                                       158930
     C********** LPFI      ANDNE'R'                                                    158930 CLE106
     C           PTFC      ANDEQWCNUM                                     158930
     C           PTFT      ANDEQWFACT                                     158930
     C           PTFN      ANDEQWFCNO                                     158930
     C                     MOVE 'Y'       WFLAG                           158930
     C                     ENDIF                                          158930
     C                     MOVE WFCLTY    LEFCLT                          158930
     C                     ENDIF                                          158930
      *                                                                   158930
     C                     ENDSR                                          158930
      *                                                                   158930
      *****************************************************************   158930
      *                                                               *   158930
      * FARCPA -- Subroutine to consider Revolving Credit Changes     *   158930
      *                                                               *   158930
      * CALLED FROM: After facility amounts have been calculated      *   158930
      *                                                               *   158930
      * CALLS: FAFACL, FACONV                                         *   158930
      *                                                               *   158930
      *****************************************************************   158930
      *                                                                   158930
     C           FARCPA    BEGSR                                          158930
      *                                                                   158930
     C                     MOVELCNUM      WCNUM                           158930
     C                     MOVELFACT      WFACT                           158930
     C                     MOVELFCNO      WFCNO                           158930
      *                                                                   158930
     C           FCAMK     SETLLLEFCAML9                                  158930
     C           FCAMK     READELEFCAML9                 69               158930
      *                                                                   158930
     C           *IN69     DOWEQ'0'                                       158930
     C                     MOVE AFRVCR    WRVCR                           158930
     C                     MOVE AFVLDT    WVLDT                           158930
     C           FCAMK     READELEFCAML9                 69               158930
      *                                                                   158930
      ** Get the last Revolving Credit Change made for the day            158930
      *                                                                   158930
     C           *IN69     DOWEQ'0'                                       158930
     C           AFSQNO    ANDNE1                                         158930
     C                     MOVE AFRVCR    WRVCR                           158930
     C                     MOVE AFVLDT    WVLDT                           158930
     C           FCAMK     READELEFCAML9                 69               158930
     C                     ENDDO                                          158930
      *                                                                   158930
     C           *IN69     IFEQ '1'                                       158930
     C                     MOVE 99999     WRDAT                           158930
     C                     ELSE                                           158930
     C                     MOVE AFVLDT    WRDAT                           158930
     C                     ENDIF                                          158930
      *                                                                   158930
      ** Obtain repayments done before COB                                158930
      *                                                                   158930
     C********** *LOVAL    SETLLLELOAML3                                              158930 245177A
     C**********           READ LELOAML3                 70                           158930 245177A
      **********                                                                      158930 245177A
     C********** *IN70     DOWEQ'0'                                                   158930 245177A
      **********                                                                      158930 245177A
     C**********           MOVE *BLANKS   WFLAG                                       158930 245177A
      **********                                                                      158930 245177A
     C********** AMTP      IFEQ 'MR'                                                  158930 245177A
     C********** AMTP      OREQ 'RE'                                                  158930 245177A
     C********** FCUS      IFEQ WCNUM                                                 158930 245177A
     C********** FTYP      ANDEQWFACT                                                 158930 245177A
     C********** FSEQ      ANDEQWFCNO                                                 158930 245177A
     C**********           MOVE 'Y'       WFLAG                                       158930 245177A
     C**********           ELSE                                                       158930 245177A
     C**********           MOVE FCUS      WACNUM                                      158930 245177A
     C**********           MOVE FTYP      WAFACT                                      158930 245177A
     C**********           MOVE FSEQ      WAFCNO                                      158930 245177A
     C**********           MOVE LNRF      WALOAN                                      158930 245177A
     C**********           EXSR FAFACL                                                158930 245177A
     C**********           ENDIF                                                      158930 245177A
      **********                                                                      158930 245177A
     C********** WFLAG     IFEQ 'Y'                                                   158930 245177A
     C********** VDAT      ANDLTWRDAT                                                 158930 245177A
     C********** VDAT      ANDGEWVLDT                                                 158930 245177A
     C***********WRVCR     ANDEQ'Y'                                158930 160484
     C**********           EXSR FACONV                                                158930 245177A
     C********** WRVCR     IFEQ 'Y'                                                   160484 245177A
     C********** RVCR      ANDEQ'N'                                                   160484 245177A
     C********** WRVCR     OREQ 'N'                                                   160484 245177A
     C********** RVCR      ANDEQ'Y'                                                   160484 245177A
     C**********           EXSR FAFADD                                                158930 245177A
     C**********           ENDIF                                                      160484 245177A
     C**********           ENDIF                                                      158930 245177A
      **********                                                                      158930 245177A
     C**********           ENDIF                                                      158930 245177A
     C**********           READ LELOAML3                 70                           158930 245177A
     C**********           ENDDO                                                      158930 245177A
      **********                                                                      158930 245177A
     C********** *LOVAL    SETLLLELOANL0                                              204446 245177A
     C**********           READ LELOANL0                 70                           204446 245177A
      **********                                                                      204446 245177A
     C********** *IN70     DOWEQ'0'                                                   204446 245177A
      **********                                                                      204446 245177A
     C**********           MOVE *BLANKS   WFLAG                                       204446 245177A
      **********                                                                      204446 245177A
     C********** FCUSC     IFEQ WCNUM                                                 204446 245177A
     C********** FTYPC     ANDEQWFACT                                                 204446 245177A
     C********** FSEQC     ANDEQWFCNO                                                 204446 245177A
     C********** RECI      ANDEQ'D'                                                   204446 245177A
     C**********           MOVE 'Y'       WFLAG                                       204446 245177A
     C**********           ELSE                                                       204446 245177A
     C**********           MOVE FCUSC     WACNUM                                      204446 245177A
     C**********           MOVE FTYPC     WAFACT                                      204446 245177A
     C**********           MOVE FSEQC     WAFCNO                                      204446 245177A
     C**********           MOVE LNRF      WALOAN                                      204446 245177A
     C**********           EXSR FAFACL                                                204446 245177A
     C**********           ENDIF                                                      204446 245177A
      **********                                                                      204446 245177A
      **********NT                                                                    204446 245177A
      **********                                                                      204446 245177A
     C**********           Z-ADDCPAM      CPAML  130                                  204446 245177A
     C**********           Z-ADDFCXR      FCXRL  138                                  204446 245177A
     C**********           MOVE FMDI      FMDIL   1                                   204446 245177A
     C**********           MOVE *BLANK    AUTOL                                       204446 245177A
     C**********           MOVE AUTO      AUTOL   1                                   204446 245177A
     C********** WFLAG     IFEQ 'Y'                                                   204446 245177A
     C********** NRPD      IFGT 0                                                     204446 245177A
     C********** NRPD      ANDGTDAY,3                                                 204446 245177A
     C********** NRPD      ORGT 0                                                     204446 245177A
     C********** NRPD      ANDLEDAY,3                                                 204446 245177A
     C********** AUTO      ANDEQ'Y'                                                   204446 245177A
     C**********           Z-ADDNRPD      VDAT                                        204446 245177A
     C**********           MOVE 'RE'      AMTP                                        204446 245177A
     C**********           MOVE CCYL      CCY                                         204446 245177A
     C**********           EXSR SRRAMT                                                204446 245177A
     C**********           Z-ADDWRAMT     PRAM                                        204446 245177A
     C**********           Z-ADDWRAMT     TAMT                                        204446 245177A
     C**********           SUB  WRAMT     CPAML                                       204446 245177A
     C********** VDAT      IFLT WRDAT                                                 204446 245177A
     C********** VDAT      ANDGEWVLDT                                                 204446 245177A
     C**********           EXSR FACONV                                                204446 245177A
     C********** WRVCR     IFEQ 'Y'                                                   204446 245177A
     C********** RVCR      ANDEQ'N'                                                   204446 245177A
     C********** WRVCR     OREQ 'N'                                                   204446 245177A
     C********** RVCR      ANDEQ'Y'                                                   204446 245177A
     C**********           EXSR FAFADD                                                204446 245177A
     C**********           ENDIF                                                      204446 245177A
     C**********           ENDIF                                                      204446 245177A
      **********                                                                      204446 245177A
     C**********           ENDIF                                                      204446 245177A
     C********** LNRF      SETLLLELOAML3                                              204446 245177A
     C********** LNRF      READELELOAML3                 73                           204446 245177A
     C********** *IN73     DOWEQ'0'                                                   204446 245177A
     C********** AMTP      IFEQ 'RE'                                                  204446 245177A
     C********** AMTP      OREQ 'MR'                                                  204446 245177A
      **********                                                                      214897 245177A
     C********** AMTP      IFEQ 'MR'                                                  214897 245177A
     C**********           SUB  PRAM      CPAML                                       214897 245177A
     C**********           ENDIF                                                      214897 245177A
      **********                                                                      214897 245177A
     C********** AMTP      IFEQ 'RE'                                                  204446 245177A
     C********** REPT      IFEQ 1                                                     204446 245177A
     C**********           SUB  PRAM      CPAML                                       204446 245177A
     C**********           ELSE                                                       204446 245177A
     C**********           SUB  TAMT      CPAML                                       204446 245177A
     C**********           ENDIF                                                      204446 245177A
     C**********           ENDIF                                                      204446 245177A
     C**********           ENDIF                                                      204446 245177A
     C********** AMTP      IFEQ 'PI'                                                  204446 245177A
     C**********           ADD  PRAM      CPAML                                       204446 245177A
     C**********           ENDIF                                                      204446 245177A
     C********** LNRF      READELELOAML3                 73                           204446 245177A
     C**********           ENDDO                                                      204446 245177A
     C**********           Z-ADDFCXRL     FCXR                                        204446 245177A
     C**********           MOVE FMDIL     FMDI                                        204446 245177A
     C********** MDAT      IFGT 0                                                      204446 245177
     C*********  MDAT      ANDGTDAY,3                                                  204446 245177
     C*********  MDAT      ORGT 0                                                      204446 245177
     C*********  MDAT      ANDLEDAY,3                                                  204446 245177
     C*********  AUTOL     ANDEQ'Y'                                                    204446 245177
     C*********            MOVE CCYL      CCY                                          204446 245177
     C*********            MOVE *BLANKS   AMTP                                         204446 245177
     C*********            Z-ADDMDAT      VDAT                                         204446 245177
     C*********            Z-ADDCPAML     PRAM                                         204446 245177
     C*********  VDAT      IFLT WRDAT                                                  204446 245177
     C*********  VDAT      ANDGEWVLDT                                                  204446 245177
     C*********            EXSR FACONV                                                 204446 245177
     C*********  WRVCR     IFEQ 'Y'                                                    204446 245177
     C*********  RVCR      ANDEQ'N'                                                    204446 245177
     C*********  WRVCR     OREQ 'N'                                                    204446 245177
     C*********  RVCR      ANDEQ'Y'                                                    204446 245177
     C*********            EXSR FAFADD                                                 204446 245177
     C*********            ENDIF                                                       204446 245177
     C*********            ENDIF                                                       204446 245177
      *                                                                                       204446
     C*********            ENDIF                                                       204446 245177
     C*********            ENDIF                                                      204446 245177A
     C*********            READ LELOANL0                 70                           204446 245177A
     C*********            ENDDO                                                      204446 245177A
     C                     ENDDO                                          158930
      *                                                                   158930
     C                     ENDSR                                          158930
      *                                                                   158930
      *****************************************************************   158930
      *                                                               *   158930
      * FACONV -- Subroutine to convert repayments to facility        *   158930
      *           currency and format amount for display              *   158930
      *                                                               *   158930
      * CALLED FROM: FARCPA                                           *   158930
      *                                                               *   158930
      * CALLS: None                                                   *   158930
      *                                                               *   158930
      *****************************************************************   158930
      *                                                                   158930
     C           FACONV    BEGSR                                          158930
      *                                                                   158930
     C                     Z-ADD0         WFCBAL 130                      158930
      *                                                                                      214897
      ** Get FCXR (Facility Currency Exchange rate) from loan                                214897
      ** and CCYX (Loan Currency)                                                            214897
      *                                                                                      214897
     C           CLOKY     CHAINCLOANL4             N55                                      214897
      *                                                                   158930
      ** Get facility currency decimal places                             158930
      *                                                                   158930
     C                     Z-ADD1         T                               158930
     C           FCCY      LOKUPACY,T                    72               158930
     C           *IN72     IFEQ '1'                                       158930
     C                     MOVE ADP,T     FNBDP   10                      158930
     C                     ENDIF                                          158930
      *                                                                   158930
      ** Get loan currency decimal places                                 158930
      *                                                                   158930
     C                     Z-ADD1         T                               158930
      ** Check loan ccy, which is CCYX.                                                       214897
     C********** CCY       LOKUPACY,T                    72                            158930 214897
     C           CCYX      LOKUPACY,T                    72                                   214897
     C           *IN72     IFEQ '1'                                       158930
     C                     MOVE ADP,T     LNBDP   10                      158930
     C                     ENDIF                                          158930
      *                                                                   158930
     C           FNBDP     SUB  LNBDP     WCX     10                      158930
     C                     ADD  4         WCX                             158930
     C           FMDI      IFEQ 'D'                                       158930
     C           FCXR      DIV  POWR,WCX  WFCXRT                          158930
     C********** 1         DIV  WFCXRT    WFCXRT                                       158930 247138
     C                     ELSE                                           158930
     C           FCXR      MULT POWR,WCX  WFCXRT 159H                     158930
     C                     ENDIF                                          158930
      *                                                                   158930
      ***Manual*Repayments*********************************                            158930 199073
      ** Manual Repayments, Repayment Schedule and                                            199073
      ** Principal Increase                                                                   199073
      *                                                                   158930
     C********** AMTP      IFEQ 'MR'                                                   158930 199073
     C           FMDI      IFEQ 'D'                                                           247138
     C           PRAM      DIV  WFCXRT    WFCBAL    H                                         247138
     C                     ELSE                                                               247138
     C********** PRAM      MULT WFCXRT    WFCBAL                                       158930 247138
     C           PRAM      MULT WFCXRT    WFCBAL    H                                         247138
     C                     ENDIF                                                              247138
     C**********           ENDIF                                                       158930 199073
      *                                                                   158930
      ** Repayment Schedules                                              158930
      *                                                                   158930
     C           AMTP      IFEQ 'RE'                                      158930
     C           REPT      IFEQ 1                                         158930
     C********** PRAM      MULT POWR,WCX  WFCBAL                                       158930 199073
     C           FMDI      IFEQ 'D'                                                           247138
     C           PRAM      DIV  WFCXRT    WFCBAL    H                                         247138
     C                     ELSE                                                               247138
     C********** PRAM      MULT WFCXRT    WFCBAL                                       199073 247138
     C           PRAM      MULT WFCXRT    WFCBAL    H                                         247138
     C                     ENDIF                                                              247138
     C                     ELSE                                           158930
     C********** TAMT      MULT POWR,WCX  WFCBAL                                       158930 199073
     C           FMDI      IFEQ 'D'                                                           247138
     C           TAMT      DIV  WFCXRT    WFCBAL    H                                         247138
     C                     ELSE                                                               247138
     C********** TAMT      MULT WFCXRT    WFCBAL                                       199073 247138
     C           TAMT      MULT WFCXRT    WFCBAL    H                                         247138
     C                     ENDIF                                                              247138
     C                     ENDIF                                          158930
     C                     ENDIF                                          158930
      *                                                                   160484
      ** Subtract repayment if Revolving Credit Indicator was             160484
      ** changed from 'Y' to 'N'                                          160484
      *                                                                   160484
     C           RVCR      IFEQ 'Y'                                       160484
     C           WRVCR     ANDEQ'N'                                       160484
     C           RVCR      OREQ 'N'                                                           199073
     C           WRVCR     ANDEQ' '                                                           199073
     C                     Z-SUBWFCBAL    WFCBAL                          160484
     C                     ENDIF                                          160484
      *                                                                   158930
     C                     ENDSR                                          158930
      *                                                                   158930
      *****************************************************************   158930
      *                                                               *   158930
      * FAFADD -- Subroutine to add repayments to Revolving           *   158930
      *           Credit loans                                        *   158930
      *                                                               *   158930
      * CALLED FROM: FARCPA                                           *   158930
      *                                                               *   158930
      * CALLS: None                                                   *   158930
      *                                                               *   158930
      *****************************************************************   158930
      *                                                                   158930
     C           FAFADD    BEGSR                                          158930
      *                                                                   158930
     C                     SELEC                                          158930
     C********** VDAT      WHEQ DAY,2                                                  158930 199073
     C           VDAT      WHLE DAY,2                                                         199073
     C           WVLDT     ANDLEDAY,2                                                         204446
     C                     ADD  WFCBAL    OAM1A                           158930
     C                     ADD  WFCBAL    OAM2A                           158930
     C                     ADD  WFCBAL    OAM3A                           158930
     C                     ADD  WFCBAL    OAM4A                           158930
     C                     ADD  WFCBAL    OAM5A                           158930
     C                     ADD  WFCBAL    OAM6A                           158930
     C                     ADD  WFCBAL    OAM7A                           158930
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,2                                     158930
     C           VDAT      ANDLEDAY,3                                     158930
     C           WVLDT     ANDLEDAY,3                                                         204446
     C                     ADD  WFCBAL    OAM2A                           158930
     C                     ADD  WFCBAL    OAM3A                           158930
     C                     ADD  WFCBAL    OAM4A                           158930
     C                     ADD  WFCBAL    OAM5A                           158930
     C                     ADD  WFCBAL    OAM6A                           158930
     C                     ADD  WFCBAL    OAM7A                           158930
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,3                                     158930
     C           VDAT      ANDLEDAY,4                                     158930
     C           WVLDT     ANDLEDAY,4                                                         204446
     C                     ADD  WFCBAL    OAM3A                           158930
     C                     ADD  WFCBAL    OAM4A                           158930
     C                     ADD  WFCBAL    OAM5A                           158930
     C                     ADD  WFCBAL    OAM6A                           158930
     C                     ADD  WFCBAL    OAM7A                           158930
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,4                                     158930
     C           VDAT      ANDLEDAY,5                                     158930
     C           WVLDT     ANDLEDAY,5                                                         204446
     C                     ADD  WFCBAL    OAM4A                           158930
     C                     ADD  WFCBAL    OAM5A                           158930
     C                     ADD  WFCBAL    OAM6A                           158930
     C                     ADD  WFCBAL    OAM7A                           158930
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,5                                     158930
     C           VDAT      ANDLEDAY,6                                     158930
     C           WVLDT     ANDLEDAY,6                                                         204446
     C                     ADD  WFCBAL    OAM5A                           158930
     C                     ADD  WFCBAL    OAM6A                           158930
     C                     ADD  WFCBAL    OAM7A                           158930
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,6                                     158930
     C           VDAT      ANDLEDAY,7                                     158930
     C           WVLDT     ANDLEDAY,7                                                         204446
     C                     ADD  WFCBAL    OAM6A                           158930
     C                     ADD  WFCBAL    OAM7A                           158930
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,7                                     158930
     C           VDAT      ANDLEDAY,8                                     158930
     C           WVLDT     ANDLEDAY,8                                                         204446
     C                     ADD  WFCBAL    OAM7A                           158930
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,8                                     158930
     C           VDAT      ANDLEDAY,9                                     158930
     C           WVLDT     ANDLEDAY,9                                                         204446
     C                     ADD  WFCBAL    OAM8A                           158930
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,9                                     158930
     C           VDAT      ANDLEDAY,10                                    158930
     C           WVLDT     ANDLEDAY,10                                                        204446
     C                     ADD  WFCBAL    OAM9A                           158930
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C           VDAT      WHGT DAY,10                                    158930
     C           VDAT      ANDLEDAY,11                                    158930
     C           WVLDT     ANDLEDAY,11                                                        204446
     C                     ADD  WFCBAL    OA10A                           158930
      *                                                                   158930
     C                     ENDSL                                          158930
      *                                                                   158930
     C                     ENDSR                                          158930
      *                                                                   158930
      *****************************************************************                       199073
      *                                                               *                       199073
      * FALAMD -- Subroutine to consider Loan Amendments for the      *                       199073
      *           calculation of Current Facility Amount for non-     *                       199073
      *           Revolving Facility.                                 *                       199073
      *                                                               *                       199073
      * CALLED FROM: After Available Amounts are processed            *                       199073
      *                                                               *                       199073
      * CALLS: FACONV                                                 *                       199073
      *                                                               *                       199073
      *****************************************************************                       199073
      *                                                                                       199073
     C           FALAMD    BEGSR                                                              199073
      *                                                                                       199073
     C                     MOVELCNUM      WCNUM                                               199073
     C                     MOVELFACT      WFACT                                               199073
     C                     MOVELFCNO      WFCNO                                               199073
      *                                                                                       199073
     C                     Z-ADD0         WFCBAL                                              199073
      *                                                                                       199073
      ** Obtain repayments done before COB                                                    199073
      *                                                                                       199073
     C           *LOVAL    SETLLLELOAML3                                                      199073
     C                     READ LELOAML3                 70                                   199073
      *                                                                                       199073
     C           *IN70     DOWEQ'0'                                                           199073
      *                                                                                       199073
     C                     MOVE LNRF      WALOAN                                              199073
      *                                                                                       199073
      ** Process loan amendments for principal amount                                         199073
      *                                                                                       199073
     C           AMTP      IFEQ 'MR'                                                          199073
     C           AMTP      OREQ 'RE'                                                          199073
     C           AMTP      OREQ 'PI'                                                          199073
      *                                                                                       199073
     C           FCUS      IFEQ WCNUM                                                         199073
     C           FTYP      ANDEQWFACT                                                         199073
     C           FSEQ      ANDEQWFCNO                                                         199073
      *                                                                                       199073
     C           WALOAN    CHAINLELOANL0             71                                       199073
      *                                                                                       199073
      ** Check if value date of amendment is less than                                        199073
      ** next working day                                                                     199073
      *                                                                                       199073
     C           VDAT      IFLT BJDNWD                                                        199073
     C           ALRECI    ANDEQ'D'                                                           199073
      *                                                                                       199073
      ** Convert amount if loan ccy is not equal to                                           199073
      ** facility ccy                                                                         199073
      *                                                                                       199073
     C                     EXSR FACONV                                                        199073
      *                                                                                       199073
      ** If MR amount is greater  than zero after SR/FACONV                                   199073
      ** meaning amount is negative.                                                          199073
      *                                                                                       199073
     C                     MOVE 'N'       NEGMR                                               199073
     C           AMTP      IFEQ 'MR'                                                          199073
     C           WFCBAL    ANDGT0                                                             199073
     C           AMTP      OREQ 'PI'                                                          199073
     C                     MOVE 'Y'       NEGMR   1                                           199073
     C                     ENDIF                                                              199073
      *                                                                                       199073
      ** If facility is non-revolving and no RC record in                                     199073
      ** PF/LEFCAMPD or RC is 'N' and value date is                                           199073
      ** less than next working day.                                                          199073
      *                                                                                       199073
     C           RVCR      IFEQ 'N'                                                           199073
     C           WRVCR     ANDEQ' '                                                           199073
     C           WRVCR     OREQ 'N'                                                           199073
     C           RVCR      ANDEQ'Y'                                                           199073
     C           WVLDT     ANDLTBJDNWD                                                        199073
      *                                                                                       199073
      ** Update current facility amount if not PI or not                                      199073
      ** negative MR.                                                                         199073
      *                                                                                       199073
     C           NEGMR     IFEQ 'N'                                                           199073
     C           AMTP      ANDEQ'MR'                                                          199073
     C           AMTP      OREQ 'RE'                                                          199073
     C           AMAUTO    ANDEQ'Y'                                                           199073
      *                                                                                       CLE134
     C           AMTP      OREQ 'RE'                                                          CLE134
     C           AMAUTO    ANDEQ'C'                                                           CLE134
     C           CLE134    ANDEQ'Y'                                                           CLE134
     C                     ADD  WFCBAL    SCURAM                                              199073
     C                     ENDIF                                                              199073
     C                     ENDIF                                                              199073
      *                                                                                       199073
     C                     ENDIF                                                              199073
     C                     ENDIF                                                              199073
      *                                                                                       199073
     C                     ENDIF                                                              199073
      *                                                                                       199073
      ** Read next loan amendment                                                             199073
      *                                                                                       199073
     C                     READ LELOAML3                 70                                   199073
     C                     ENDDO                                                              199073
      *                                                                                       199073
     C                     MOVE '0'       *IN70                                               199073
     C                     MOVE '0'       *IN71                                               199073
     C                     ENDSR                                                              199073
      /EJECT                                                                                  204446
      *****************************************************************                       204446
      *                                                               *                       204446
      *  SRRAMT  -  Set Repayment Amount                              *                       204446
      *                                                               *                       204446
      *  Called by: SRFRMT                                            *                       204446
      *  Calls:                                                       *                       204446
      *  GLINTC - Calculates interest                                 *                       204446
      *                                                               *                       204446
      *****************************************************************                       204446
      *                                                                                       204446
     C           SRRAMT    BEGSR                                                              204446
      *                                                                                       204446
      ** Initialise repayment amount workfield                                                204446
      *                                                                                       204446
     C                     Z-ADD*ZERO     WRAMT  150                                          204446
     C                     SELEC                                                              204446
      *                                                                                       204446
      ** Repayment type 1 or 2                                                                204446
      *                                                                                       204446
     C           REPT      WHEQ 1                                                             204446
     C           REPT      OREQ 2                                                             204446
     C                     Z-ADDRAMT      WRAMT                                               204446
      *                                                                                       204446
      ** Repayment type 3                                                                     204446
      *                                                                                       204446
     C           REPT      WHEQ 3                                                             204446
      *                                                                                       204446
      ** Compute for interest                                                                 204446
      *                                                                                       204446
     C                     Z-ADDSLID      ZIBEG                                               204446
     C                     Z-ADDNRPD      ZIEND                                               204446
     C                     Z-ADDICBS      ZICALC                                              204446
     C                     Z-ADDCPAM      ZIAMT                                               204446
     C                     Z-ADDINTR      ZIRATE                                              204446
     C/COPY WNCPYSRC,LEH01310
     C                     EXSR GLINTC                                                        204446
     C/COPY WNCPYSRC,LEH01398
      *                                                                                       204446
      ** Round down interest if required                                                      204446
      *                                                                                       204446
     C           RDFC      IFEQ 'Y'                                                           204446
     C                     Z-ADDZINTR     WRDOWN 130                                          204446
     C                     Z-ADDWRDOWN    ZINTR                                               204446
     C                     ELSE                                                               204446
     C                     Z-ADDZINTR     WRUP   130H                                         204446
     C                     Z-ADDWRUP      ZINTR                                               204446
     C                     ENDIF                                                              204446
      *                                                                                       204446
     C           RAMT      SUB  ZINTR     WRAMT                                               204446
      *                                                                                       204446
     C                     ENDSL                                                              204446
      *                                                                                       204446
     C                     ENDSR                                                              204446
      *                                                                                       199073
      /COPY OFCPYSRCZ,CGL145_016                                                             CGL145B
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C/COPY ZSRSRC,ZALIGNZ2                                               S01392
     C/COPY ZSRSRC,GLINTCZ1                                                                   204446
     C/COPY ZSRSRC,ZINTDYZ2                                                                   204446
     C/COPY ZSRSRC,ZDATE9Z3                                                                   204446
     C/COPY ZSRSRC,ZDAT10Z2                                                                   204446
     C********************************************************************S01117
      /COPY OFCPYSRCZ,CGL145_002                                                             CGL145B
0981 OLE0220FMD        50
      /COPY OFCPYSRCZ,CGL145_018                                                             CGL145B
0982 O                                   K8 'LE0220F1'
     O***********              *IN20      1                               S01117
     O***********              *IN21      2                               S01117
     O***********              *IN31      3                               S01117
     O***********              *IN23      4                               S01117
     O***********              *IN24      5                               S01117
     O***********              *IN25      6                               S01117
     O***********              *IN18      7                               S01117
     O***********              *IN17      8                               S01117
     O***********              *IN52      9                               S01117
     O***********              *IN50     10                               S01117
     O***********              *IN53     11                               S01117
0983 O***********                        13 'SI'                          S01117
0984 O***********              MTIME     21 '  .  .  '                    S01117
0985 O***********              WSID      24                               S01117
0986 O***********              CRNMA     44                               S01117
0987 O***********              CSNOA     50                               S01117
0988 O***********              FANOA     56 '   /  '                      S01117
0989 O***********              FCCYA     59                               S01117
0990 O***********      60      FAMTA     76 ' ,   ,   ,   , 0 '           S01117
0991 O***********      61      FAMTA     76 '   ,   ,   , 0 . '           S01117
0992 O***********      62      FAMTA     76 '  ,   ,   , 0 .  '           S01117
0993 O***********      63      FAMTA     76 ' ,   ,   , 0 .   '           S01117
0994 O***DAT,2*-*DAT,11*FOR*RUN0-RUN9.*DAT,1*FOR*DTEX.****                S01117
0995 O***********              DAT,2     83                               S01117
0996 O***********      60      OAM1A    101 ' ,   ,   ,   , 0 -'          S01117
0997 O***********      61      OAM1A    101 '   ,   ,   , 0 . -'          S01117
0998 O***********      62      OAM1A    101 '  ,   ,   , 0 .  -'          S01117
0999 O***********      63      OAM1A    101 ' ,   ,   , 0 .   -'          S01117
1000 O***********              DAT,3    108                               S01117
1001 O***********      60      OAM2A    126 ' ,   ,   ,   , 0 -'          S01117
1002 O***********      61      OAM2A    126 '   ,   ,   , 0 . -'          S01117
1003 O***********      62      OAM2A    126 '  ,   ,   , 0 .  -'          S01117
1004 O***********      63      OAM2A    126 ' ,   ,   , 0 .   -'          S01117
1005 O***********              DAT,4    133                               S01117
1006 O***********      60      OAM3A    151 ' ,   ,   ,   , 0 -'          S01117
1007 O***********      61      OAM3A    151 '   ,   ,   , 0 . -'          S01117
1008 O***********      62      OAM3A    151 '  ,   ,   , 0 .  -'          S01117
1009 O***********      63      OAM3A    151 ' ,   ,   , 0 .   -'          S01117
1010 O***********              DAT,1    158                               S01117
1011 O***********              DAT,5    165                               S01117
1012 O***********      60      OAM4A    183 ' ,   ,   ,   , 0 -'          S01117
1013 O***********      61      OAM4A    183 '   ,   ,   , 0 . -'          S01117
1014 O***********      62      OAM4A    183 '  ,   ,   , 0 .  -'          S01117
1015 O***********      63      OAM4A    183 ' ,   ,   , 0 .   -'          S01117
1016 O***********      60      CAMDA    201 ' ,   ,   ,   , 0 -'          S01117
1017 O***********      61      CAMDA    201 '   ,   ,   , 0 . -'          S01117
1018 O***********      62      CAMDA    201 '  ,   ,   , 0 .  -'          S01117
1019 O***********      63      CAMDA    201 ' ,   ,   , 0 .   -'          S01117
1020 O***********              DAT,6    208                               S01117
1021 O***********      60      OAM5A    226 ' ,   ,   ,   , 0 -'          S01117
1022 O***********      61      OAM5A    226 '   ,   ,   , 0 . -'          S01117
1023 O***********      62      OAM5A    226 '  ,   ,   , 0 .  -'          S01117
1024 O***********      63      OAM5A    226 ' ,   ,   , 0 .   -'          S01117
1025 O***********              OVPCA    232 '  .   '                      S01117
1026 O***********              DAT,7    239                               S01117
1027 O***********      60      OAM6A    257 ' ,   ,   ,   , 0 -'          S01117
1028 O***********      61      OAM6A    257 '   ,   ,   , 0 . -'          S01117
1029 O***********      62      OAM6A    257 '  ,   ,   , 0 .  -'          S01117
1030 O***********      63      OAM6A    257 ' ,   ,   , 0 .   -'          S01117
1031 O***********              DAT,8    264                               S01117
1032 O***********      60      OAM7A    282 ' ,   ,   ,   , 0 -'          S01117
1033 O***********      61      OAM7A    282 '   ,   ,   , 0 . -'          S01117
1034 O***********      62      OAM7A    282 '  ,   ,   , 0 .  -'          S01117
1035 O***********      63      OAM7A    282 ' ,   ,   , 0 .   -'          S01117
1036 O***********              DAT,9    289                               S01117
1037 O***********      60      OAM8A    307 ' ,   ,   ,   , 0 -'          S01117
1038 O***********      61      OAM8A    307 '   ,   ,   , 0 . -'          S01117
1039 O***********      62      OAM8A    307 '  ,   ,   , 0 .  -'          S01117
1040 O***********      63      OAM8A    307 ' ,   ,   , 0 .   -'          S01117
1041 O***********              DAT,10   314                               S01117
1042 O***********      60      OAM9A    332 ' ,   ,   ,   , 0 -'          S01117
1043 O***********      61      OAM9A    332 '   ,   ,   , 0 . -'          S01117
1044 O***********      62      OAM9A    332 '  ,   ,   , 0 .  -'          S01117
1045 O***********      63      OAM9A    332 ' ,   ,   , 0 .   -'          S01117
1046 O***********              DAT,11   339                               S01117
1047 O***********      60      OA10A    357 ' ,   ,   ,   , 0 -'          S01117
1048 O***********      61      OA10A    357 '   ,   ,   , 0 . -'          S01117
1049 O***********      62      OA10A    357 '  ,   ,   , 0 .  -'          S01117
1050 O***********      63      OA10A    357 ' ,   ,   , 0 .   -'          S01117
1051 O***********              MSG      419                               S01117
1052 O***********              CUSDET   429                               S01117
1053 O***********              FANO1    432                               S01117
1054 O***********              FANO2    434                               S01117
     O                                    2 'SI'                          S01117
     O                         MTIME     10 '  .  .  '                    S01117
     O                         WSID      13                               S01117
     O                         BRTTL     53                               S01117
     O                         CRNMA     73                               S01117
     O                         CSNOA     79                               S01117
     O                         FANOA     85 '   /  '                      S01117
     O                         FCCYA     88                               S01117
     O***********      60      FAMTA    105 ' ,   ,   ,   , 0 '    S01117 171784
     O***********      61      FAMTA    105 '   ,   ,   , 0 . '    S01117 171784
     O***********      62      FAMTA    105 '  ,   ,   , 0 .  '    S01117 171784
     O***********      63      FAMTA    105 ' ,   ,   , 0 .   '    S01117 171784
     O                 60      FAMTA    106 ' ,   ,   ,   , 0 -'          171784
     O                 61      FAMTA    106 '   ,   ,   , 0 . -'          171784
     O                 62      FAMTA    106 '  ,   ,   , 0 .  -'          171784
     O                 63      FAMTA    106 ' ,   ,   , 0 .   -'          171784
     O                 60      SCURAM   124 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      SCURAM   124 '   ,   ,   , 0 . -'          CLE014
     O                 62      SCURAM   124 '  ,   ,   , 0 .  -'          CLE014
     O                 63      SCURAM   124 ' ,   ,   , 0 .   -'          CLE014
     O                         SLSADT   131                               CLE014
     O** DAT,2 - DAT,11 FOR RUN0-RUN9. DAT,1 FOR DTEX.                    S01117
     O***********              DAT,2    112                        S01117 171784
     O***********      60      OAM1A    130 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM1A    130 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM1A    130 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM1A    130 ' ,   ,   , 0 .   -'   S01117 171784
     O***********              DAT,3    137                        S01117 171784
     O***********      60      OAM2A    155 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM2A    155 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM2A    155 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM2A    155 ' ,   ,   , 0 .   -'   S01117 171784
     O***********              DAT,4    162                        S01117 171784
     O***********      60      OAM3A    180 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM3A    180 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM3A    180 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM3A    180 ' ,   ,   , 0 .   -'   S01117 171784
     O***********              DAT,1    187                        S01117 171784
     O***********              DAT,5    194                        S01117 171784
     O***********      60      OAM4A    212 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM4A    212 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM4A    212 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM4A    212 ' ,   ,   , 0 .   -'   S01117 171784
     O***********      60      CAMDA    230 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      CAMDA    230 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      CAMDA    230 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      CAMDA    230 ' ,   ,   , 0 .   -'   S01117 171784
     O***********              DAT,6    237                        S01117 171784
     O***********      60      OAM5A    255 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM5A    255 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM5A    255 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM5A    255 ' ,   ,   , 0 .   -'   S01117 171784
     O***********              OVPCA    261 '  .   '               S01117 171784
     O***********              DAT,7    268                        S01117 171784
     O***********      60      OAM6A    286 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM6A    286 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM6A    286 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM6A    286 ' ,   ,   , 0 .   -'   S01117 171784
     O***********                       289 'NO'                   S01117 171784
     O***********            35         289 'YES'                  S01117 171784
     O***********              DAT,8    296                        S01117 171784
     O***********      60      OAM7A    314 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM7A    314 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM7A    314 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM7A    314 ' ,   ,   , 0 .   -'   S01117 171784
     O***********              DAT,9    321                        S01117 171784
     O***********      60      OAM8A    339 ' ,   ,   ,   , 0 -'   S01117 171784
     O***********      61      OAM8A    339 '   ,   ,   , 0 . -'   S01117 171784
     O***********      62      OAM8A    339 '  ,   ,   , 0 .  -'   S01117 171784
     O***********      63      OAM8A    339 ' ,   ,   , 0 .   -'   S01117 171784
     O***********              DAT,2    113                        171784 CLE014
     O***********      60      OAM1A    131 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM1A    131 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM1A    131 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM1A    131 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********              DAT,3    138                        171784 CLE014
     O***********      60      OAM2A    156 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM2A    156 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM2A    156 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM2A    156 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********              DAT,4    163                        171784 CLE014
     O***********      60      OAM3A    181 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM3A    181 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM3A    181 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM3A    181 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********              DAT,1    188                        171784 CLE014
     O***********              DAT,5    195                        171784 CLE014
     O***********      60      OAM4A    213 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM4A    213 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM4A    213 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM4A    213 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********      60      CAMDA    231 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      CAMDA    231 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      CAMDA    231 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      CAMDA    231 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********              DAT,6    238                        171784 CLE014
     O***********      60      OAM5A    256 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM5A    256 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM5A    256 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM5A    256 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********              OVPCA    262 '  .   '               171784 CLE014
     O***********              DAT,7    269                        171784 CLE014
     O***********      60      OAM6A    287 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM6A    287 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM6A    287 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM6A    287 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********                       290 'NO'                   171784 CLE014
     O***********            35         290 'YES'                  171784 CLE014
     O***********              DAT,8    297                        171784 CLE014
     O***********      60      OAM7A    315 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM7A    315 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM7A    315 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM7A    315 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********              DAT,9    322                        171784 CLE014
     O***********      60      OAM8A    340 ' ,   ,   ,   , 0 -'   171784 CLE014
     O***********      61      OAM8A    340 '   ,   ,   , 0 . -'   171784 CLE014
     O***********      62      OAM8A    340 '  ,   ,   , 0 .  -'   171784 CLE014
     O***********      63      OAM8A    340 ' ,   ,   , 0 .   -'   171784 CLE014
     O***********              DAT,2    138                                          CLE014 BUG21830
     O***********      60      OAM1A    156 ' ,   ,   ,   , 0 -'                     CLE014 BUG21830
     O***********      61      OAM1A    156 '   ,   ,   , 0 . -'                     CLE014 BUG21830
     O***********      62      OAM1A    156 '  ,   ,   , 0 .  -'                     CLE014 BUG21830
     O***********      63      OAM1A    156 ' ,   ,   , 0 .   -'                     CLE014 BUG21830
     O                N75      DAT,2    138                                                 BUG21830
     O                 60N75   OAM1A    156 ' ,   ,   ,   , 0 -'                            BUG21830
     O                 61N75   OAM1A    156 '   ,   ,   , 0 . -'                            BUG21830
     O                 62N75   OAM1A    156 '  ,   ,   , 0 .  -'                            BUG21830
     O                 63N75   OAM1A    156 ' ,   ,   , 0 .   -'                            BUG21830
     O                         DAT,3    163                               CLE014
     O                 60      OAM2A    181 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      OAM2A    181 '   ,   ,   , 0 . -'          CLE014
     O                 62      OAM2A    181 '  ,   ,   , 0 .  -'          CLE014
     O                 63      OAM2A    181 ' ,   ,   , 0 .   -'          CLE014
     O                         DAT,4    188                               CLE014
     O                 60      OAM3A    206 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      OAM3A    206 '   ,   ,   , 0 . -'          CLE014
     O                 62      OAM3A    206 '  ,   ,   , 0 .  -'          CLE014
     O                 63      OAM3A    206 ' ,   ,   , 0 .   -'          CLE014
     O                         DAT,1    213                               CLE014
     O                         DAT,5    220                               CLE014
     O                 60      OAM4A    238 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      OAM4A    238 '   ,   ,   , 0 . -'          CLE014
     O                 62      OAM4A    238 '  ,   ,   , 0 .  -'          CLE014
     O                 63      OAM4A    238 ' ,   ,   , 0 .   -'          CLE014
     O                 60      CAMDA    256 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      CAMDA    256 '   ,   ,   , 0 . -'          CLE014
     O                 62      CAMDA    256 '  ,   ,   , 0 .  -'          CLE014
     O                 63      CAMDA    256 ' ,   ,   , 0 .   -'          CLE014
     O                         DAT,6    263                               CLE014
     O                 60      OAM5A    281 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      OAM5A    281 '   ,   ,   , 0 . -'          CLE014
     O                 62      OAM5A    281 '  ,   ,   , 0 .  -'          CLE014
     O                 63      OAM5A    281 ' ,   ,   , 0 .   -'          CLE014
     O**********               OVPCA    287 '  .   '                                   CLE014 CLE023
     O**********               DAT,7    294                                            CLE014 CLE023
     O**********       60      OAM6A    312 ' ,   ,   ,   , 0 -'                       CLE014 CLE023
     O**********       61      OAM6A    312 '   ,   ,   , 0 . -'                       CLE014 CLE023
     O**********       62      OAM6A    312 '  ,   ,   , 0 .  -'                       CLE014 CLE023
     O**********       63      OAM6A    312 ' ,   ,   , 0 .   -'                       CLE014 CLE023
     O**********                        315 'NO'                                       CLE014 CLE023
     O**********             35         315 'YES'                                      CLE014 CLE023
     O**********               DAT,8    322                                            CLE014 CLE023
     O**********       60      OAM7A    340 ' ,   ,   ,   , 0 -'                       CLE014 CLE023
     O**********       61      OAM7A    340 '   ,   ,   , 0 . -'                       CLE014 CLE023
     O**********       62      OAM7A    340 '  ,   ,   , 0 .  -'                       CLE014 CLE023
     O**********       63      OAM7A    340 ' ,   ,   , 0 .   -'                       CLE014 CLE023
     O                         DAT,7    288                                                   CLE023
     O                 60      OAM6A    306 ' ,   ,   ,   , 0 -'                              CLE023
     O                 61      OAM6A    306 '   ,   ,   , 0 . -'                              CLE023
     O                 62      OAM6A    306 '  ,   ,   , 0 .  -'                              CLE023
     O                 63      OAM6A    306 ' ,   ,   , 0 .   -'                              CLE023
     O                         OVPCA    312 '  .   '                                          CLE023
     O                         DAT,8    319                                                   CLE023
     O                 60      OAM7A    337 ' ,   ,   ,   , 0 -'                              CLE023
     O                 61      OAM7A    337 '   ,   ,   , 0 . -'                              CLE023
     O                 62      OAM7A    337 '  ,   ,   , 0 .  -'                              CLE023
     O                 63      OAM7A    337 ' ,   ,   , 0 .   -'                              CLE023
     O                                  340 'NO'                                              CLE023
     O                       35         340 'YES'                                             CLE023
     O                         DAT,9    347                               CLE014
     O                 60      OAM8A    365 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      OAM8A    365 '   ,   ,   , 0 . -'          CLE014
     O                 62      OAM8A    365 '  ,   ,   , 0 .  -'          CLE014
     O                 63      OAM8A    365 ' ,   ,   , 0 .   -'          CLE014
     O**********               DAT,10   346                         S01117S01270
     O**********       60      OAM9A    364 ' ,   ,   ,   , 0 -'    S01117S01270
     O**********       61      OAM9A    364 '   ,   ,   , 0 . -'    S01117S01270
     O**********       62      OAM9A    364 '  ,   ,   , 0 .  -'    S01117S01270
     O**********       63      OAM9A    364 ' ,   ,   , 0 .   -'    S01117S01270
     O**********               DAT,11   371                         S01117S01270
     O**********       60      OA10A    389 ' ,   ,   ,   , 0 -'    S01117S01270
     O**********       61      OA10A    389 '   ,   ,   , 0 . -'    S01117S01270
     O**********       62      OA10A    389 '  ,   ,   , 0 .  -'    S01117S01270
     O**********       63      OA10A    389 ' ,   ,   , 0 .   -'    S01117S01270
     O**********               MSG      451                         S01117S01270
     O**********               CUSDET   461                         S01117S01270
     O**********               FBRCA    464                         S01117S01270
     O**********               FANO1    467                         S01117S01270
     O**********               FANO2    469                         S01117S01270
     O***********              DAT,12   346                        S01270 171784
     O***********              DAT,10   353                        S01270 171784
     O***********      60      OAM9A    371 ' ,   ,   ,   , 0 -'   S01270 171784
     O***********      61      OAM9A    371 '   ,   ,   , 0 . -'   S01270 171784
     O***********      62      OAM9A    371 '  ,   ,   , 0 .  -'   S01270 171784
     O***********      63      OAM9A    371 ' ,   ,   , 0 .   -'   S01270 171784
     O***********              DAT,11   378                        S01270 171784
     O***********      60      OA10A    396 ' ,   ,   ,   , 0 -'   S01270 171784
     O***********      61      OA10A    396 '   ,   ,   , 0 . -'   S01270 171784
     O***********      62      OA10A    396 '  ,   ,   , 0 .  -'   S01270 171784
     O***********      63      OA10A    396 ' ,   ,   , 0 .   -'   S01270 171784
     O***********              MSG      458                        S01270 171784
     O***********              CUSDET   468                        S01270 171784
     O***********              FBRCA    471                        S01270 171784
     O***********              FANO1    474                        S01270 171784
     O***********              FANO2    476                        S01270 171784
     O**********               DAT,12   347                        171784 CLE014
     O**********               DAT,10   354                        171784 CLE014
     O**********       60      OAM9A    372 ' ,   ,   ,   , 0 -'   171784 CLE014
     O**********       61      OAM9A    372 '   ,   ,   , 0 . -'   171784 CLE014
     O**********       62      OAM9A    372 '  ,   ,   , 0 .  -'   171784 CLE014
     O**********       63      OAM9A    372 ' ,   ,   , 0 .   -'   171784 CLE014
     O**********               DAT,11   379                        171784 CLE014
     O**********       60      OA10A    397 ' ,   ,   ,   , 0 -'   171784 CLE014
     O**********       61      OA10A    397 '   ,   ,   , 0 . -'   171784 CLE014
     O**********       62      OA10A    397 '  ,   ,   , 0 .  -'   171784 CLE014
     O**********       63      OA10A    397 ' ,   ,   , 0 .   -'   171784 CLE014
     O**********               MSG      459                        171784 CLE014
     O**********               CUSDET   469                        171784 CLE014
     O**********               FBRCA    472                        171784 CLE014
     O**********               FANO1    475                        171784 CLE014
     O**********               FANO2    477                        171784 CLE014
     O**********               DAT,12   372                                            CLE014 CLE023
     O**********               DAT,10   379                                            CLE014 CLE023
     O**********       60      OAM9A    397 ' ,   ,   ,   , 0 -'                       CLE014 CLE023
     O**********       61      OAM9A    397 '   ,   ,   , 0 . -'                       CLE014 CLE023
     O**********       62      OAM9A    397 '  ,   ,   , 0 .  -'                       CLE014 CLE023
     O**********       63      OAM9A    397 ' ,   ,   , 0 .   -'                       CLE014 CLE023
     O                         DAT,10   372                                                   CLE023
     O                 60      OAM9A    390 ' ,   ,   ,   , 0 -'                              CLE023
     O                 61      OAM9A    390 '   ,   ,   , 0 . -'                              CLE023
     O                 62      OAM9A    390 '  ,   ,   , 0 .  -'                              CLE023
     O                 63      OAM9A    390 ' ,   ,   , 0 .   -'                              CLE023
     O                         DAT,12   397                                                   CLE023
     O                         DAT,11   404                               CLE014
     O                 60      OA10A    422 ' ,   ,   ,   , 0 -'          CLE014
     O                 61      OA10A    422 '   ,   ,   , 0 . -'          CLE014
     O                 62      OA10A    422 '  ,   ,   , 0 .  -'          CLE014
     O                 63      OA10A    422 ' ,   ,   , 0 .   -'          CLE014
     O/COPY WNCPYSRC,LE0220O001
     O                         MSG      484                               CLE014
     O                         CUSDET   494                               CLE014
     O                         FBRCA    497                               CLE014
     O                         FANO1    500                               CLE014
     O                         FANO2    502                               CLE014
     O                 60      DRAWA    520 ' ,   ,   ,   , 0 -'                              241236
     O                 61      DRAWA    520 '   ,   ,   , 0 . -'                              241236
     O                 62      DRAWA    520 '  ,   ,   , 0 .  -'                              241236
     O                 63      DRAWA    520 ' ,   ,   , 0 .   -'                              241236
     O/COPY WNCPYSRC,LE0220O002
      /COPY OFCPYSRCZ,CGL145_017                                                             CGL145B
**  POWR -- USED IN CURRENCY CONVERSION(FACILITY)                         158930
0000001                                                                   158930
0000010                                                                   158930
0000100                                                                   158930
0001000                                                                   158930
0010000                                                                   158930
0100000                                                                   158930
1000000                                                                   158930
**   ERR - ERROR MESSAGES
 NO RECORD ON CUSTOMER FILE FOR CUSTOMER NUMBER INPUT
 NO RECORD ON SHORTNAME FILE FOR SHORTNAME INPUT
 FACILITY NUMBER IS NOT NUMERIC
 NO VALID FACILITY WITH THIS FACILITY REFERENCE
                     INVALID COMMAND KEY
 CUSTOMER NOT ENTERED WHEN MANDATORY
 USER IS NOT AUTHORISED TO BANK LEVEL FUNCTIONS                           S01117
 BRANCH CODE INVALID                                                      S01117
 USER IS NOT AUTHORISED TO ANY BOOKING BRANCHES                           S01117
 USER IS NOT AUTHORISED TO THE BOOKING BRANCH                             S01117
 NO FACILITY FOR THIS CUSTOMER                                            S01117
 NO FACILITY FOR THIS CUSTOMER WITHIN THE BRANCH                          S01117
 ERROR ON FACILITY SELECTED. PARTICIPANT CR.AGREE. NOT ALLOWED            145826
**   BRTTLT - BRANCH TITLE TEXT                                           S01117
               All Branch                                                 S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN                        204446
00366007310109601461                                                                          204446
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                           204446
00000000310005900090001200015100181002120024300273003040033400365                             204446
