0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Guarantees maintenance today report')         *
0001 H***********                                                         S01117
0002 F********************************************************************LE0330
0003 F*                                                                  *LE0330
     F*  Midas - Customer Lending Module
0005 F*                                                                  *LE0330
0006 F*     LE0330- GUARANTEES MAINTENANCE TODAY REPORT                  *LE0330
0007 F*                                                                  *LE0330
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *
      *  Last Amend No. MD050457           Date 06Mar19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 196066             Date 10Jan03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 195801             Date 13Sep01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 190023             Date 03May01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 165426             Date 08Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 147935             Date 04Dec98               *
     F*                     BT0072            DATE 06AUG97               *S01392
     F*                     LBH024            DATE 28FEB97               *S01392
     F*                     S01408            DATE 25MAY95               *
     F*                     S01392            DATE 07OCT92               *
     F*                     S01194            DATE 03JAN90               *S01194
0010 F*                     S01117            DATE 01/09/89              *LE0330
0010 F*                     S01125            DATE 10/11/86              *LE0330
0011 F*                                                                  *LE0330
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD050457 - Do not process DBERR when customer is closed.     *
      *             Patterned fic from 261272.                        *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  196066 - Insert/Amend/Authorize user blank when CLE002 is    *
      *           off. Fix is to only display the fields when CLE002  *
      *           (Authorisation) feature is switched on.             *
      *  195801 - FOOB in LEC06 00005.  Guarantees amended/deleted    *
      *           but inserted today are not calculated as inserts    *
      *  190023 - Prevent DB errors 3/4 when guarantee is deleted     *
      *           and customer record has been deleted today.         *
     F*     165426 - FOOB. In LE0330AU should be able to see number of   *
     F*              records in total on GTEESGT, regardless of RECI.    *
      *     147935 - Addition of insert, authorise and amend user
      *              profiles to lending reports
     F*     BT0072 - D/B error 901 should not be issued when main
     F*              guarantee record deleted
     F*              (re-comile only - amendment to LE0330CCP1)
     F*     LBH024 - ADDITIONAL FIELDS                                   *S01392
     F*              - USES CORE HOOK LE0330OOPG
     F*              - ADDED HOOKS LE0330FFP1
     F*                            LE0330CCP1
     F*                            LE0330OOP1
     F*     S01408 - ADDITION OF CORE HOOK LE0330OOPG                    *
     F*              ADDITION OF CORE HOOK LE0330CCPG
     F*     S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *S01392
     F*     S01194 - STANDING DATA CHANGES.                              *
     F*     S01117 - MULTIBRANCHING                                      *
     F*     S01125 - OVERWRITE REMAINING POSITIONS IN DBPGM WITH BLANKS  *S01125
     F*                                                                  *
0012 F********************************************************************LE0330
0014 F*TEES***IP* F     128 15AI     2 DISK                               LE0330
0014 F*GTEESL1 IP  F     128 18AI     2 DISK                        LE0330147935
     FGTEESL1 IP  F     159 18AI     2 DISK                               147935
0015 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0016 F*CLINT***IF  F     256  7AI     2 DISK                              S01194
0017 FGTEEST  UF  F     128 15AI     2 DISK                               LE0330
0018 F*E0330P1O** F     132     OF     PRINTER                  S01124    S01117
0018 FLE0330P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0018 FLE0330AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F/COPY WNCPYSRC,LE0330FFP1                                           LBH024
     F/COPY WNCPYSRC,LE0330F001
0019 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0330
0020 F* 01            GTEES - HEADER                                      LE0330
0021 F* 02            GTEES - LIVE DETAIL                                 LE0330
0022 F* 03            GTEES - DELETED                                     LE0330
0023 F* 04            GTEES - TRAILER                                     LE0330
0024 F* 05            GTEES - CATCHALL                                    LE0330
0025 F**10******      TABLE AND CLINT DETAIL                              S01194
0026 F*       20      OUTPUT DETAIL LINES                                 LE0330
0027 F*       21      FACILITY BASED                                      LE0330
0028 F*       22-25   CURRENCY DECIMAL PLACES                             LE0330
0029 F*   26          VLAF NEGATIVE                                       LE0330
0030 F*   27          VLAL NEGATIVE                                       LE0330
0031 F********28******OUTPUT*HEADINGS*ON*FIRST*PAGE                       S01117
0032 F********29******NO*INPUT*TODAY                                      S01117
     F*       28      NO INPUT TODAY FOR BRANCH                           S01117
     F*       29      NO INPUT TODAY IN INPUT FILE                        S01117
0033 F*       30      FIRST CYCLE                                         LE0330
0034 F*   32          REVIEW DAY NO. BLANK                                LE0330
0035 F*   33          REVIEW DATE ZERO                                    LE0330
0036 F*       34      CHANGE TYPE I                                       LE0330
0037 F*       35      CHANGE TYPE D                                       LE0330
     F*       39      CLE002 is ON                                                            196066
0038 F*       40      MULTIPLE USE                                        LE0330
     F*       60      MULTIBRANCHING INDICATOR                            S01117
     F*       85      REPORT FILE OPENED IN FIRST PROCESSING CYCLE        S01117
0039 F*       90-99   STANDARD SUBROUTINES                                LE0330
0040 F*       U7,U8   STANDARD MIDAS USAGE                                LE0330
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
   1 I*                                                                   LE0330
0045 I*    GUARANTEES/SECURITIES/COLLATERAL FILE                          LE0330
0046 I*                                                                   LE0330
0047 I*TEES***NS* 01   1 CH                                               S01117
0047 IGTEESL1 NS  01   1 CH                                               S01117
0048 I                                        1   1 RECI                  LE0330
0049 I        NS  02   1 CD                                               LE0330
0050 I       OR   03   1 C*                                               LE0330
0051 I                                        1   1 RECI                  LE0330
0052 I**   FIELD NAME CHANGED FOR PROGRAM                                 LE0330
0053 I**********                              2   70CNUMC                              LE0330 CSD027
0053 I                                        2   7 CNUMC                                     CSD027
0054 I                                        8  13 FCLN                  LE0330
0055 I**   FIELD REDEFINED FOR PROGRAM                                    LE0330
0056 I                                        9  130FCLNF                 LE0330
0057 I                                       14  160GUSN                  LE0330
0058 I                                    P  17  190STTD                  LE0330
0059 I                                    P  20  220EDDT                  LE0330
0060 I                                    P  23  250RVDT            33    LE0330
0061 I                                       26  26 RVFR                  LE0330
0062 I                                       27  280RVDY            32    LE0330
0063 I                                       29  31 CCY                   LE0330
0064 I                                    P  32  380UAMT                  LE0330
0065 I                                    P  39  410NOUN                  LE0330
0066 I                                    P  42  480TAMT                  LE0330
0067 I                                       49  83 NARR                  LE0330
0068 I                                       84  84 GSCI                  LE0330
0069 I                                       85  90 GBCN                  LE0330
0070 I                                       95  96 GCRK                  LE0330
0071 I                                       97  99 COLC                  LE0330
     I                                      109 111 BRCA  L1              S01117
0072 I                                    P 112 1180STAM                  LE0330
0073 I                                    P 119 1210ORED                  LE0330
0074 I                                    P 122 1240LCD                   LE0330
0075 I                                      125 125 CHTP                  LE0330
0076 I                                    P 126 1280TNLU                  LE0330
     I                                      129 129 GSTS                  147935
     I                                      130 139 IUSR                  147935
     I                                      140 149 AUSR                  147935
     I                                      150 159 XUSR                  147935
0077 I        NS  05                                                      LE0330
0078 I*                                                                   LE0330
0079 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0080 I*                                                                   S01194
0081 I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
0082 I*******AND      13 C0                                               S01194
0083 I**********                              1   1 RECI                  S01194
0084 I**********                             12  130RCDE                  S01194
0085 I**********                             14  66 TITL                  S01194
0086 I**********                             67  67 DATF                  S01194
0087 I***********                            68  700DFBR                  S01194
0088 I**********                             74  74 MODI1                 S01194
0089 I**********                             75  75 MODI2                 S01194
0090 I**********                             76  76 MODI3                 S01194
0091 I**********                          P  77  790RUND                  S01194
0092 I**********                             80  86 RUNA                  S01194
0093 I**********                             87  870SFLG                  S01194
0094 I*                                                                   S01194
0095 I*****TABLE*FILE*-*CURRENCIES*RECORD*1.                              S01194
0096 I*                                                                   S01194
0097 I********NS  10   1 CD   2 C2   3 C0                                 S01194
0098 I*******AND      13 C1                                               S01194
0099 I**********                              1   1 RECI                  S01194
0100 I**********                             13  130SREC                  S01194
0101 I**********                             14  27 CCNM                  S01194
0102 I**********                          P  28  348SPOT                  S01194
0103 I**********                             35  37 CCYS                  S01194
0104 I**********                             38  380CDP                   S01194
0105 I**********                             39  390TNOT                  S01194
0106 I**********                             40  40 DCCY                  S01194
0107 I**********                             41  44 SRC1                  S01194
0108 I**********                             45  48 SRC2                  S01194
0109 I**********                             49  520TACC                  S01194
0110 I**********                             53  560TEQV                  S01194
0111 I**********                             57  600SWQV                  S01194
0112 I**********                             61  640TAC4                  S01194
0113 I**********                             65  680TAC5                  S01194
0114 I**********                             69  69 HIND                  S01194
0115 I**********                          P  70  768PART                  S01194
0116 I**********                             77  780SSNO                  S01194
0117 I**********                          P  79  858ERLC                  S01194
0118 I********NS                                                          S01194
0119 I*                                                                   S01194
0120 I*****CLIENT*FILE*-*CUSTOMER*STANDING*DATA*RECORD.                   S01194
0121 I*                                                                   S01194
0122 I*CLINT***NS  10   1 CD   8 CA                                       S01194
0123 I**********                              1   1 RECI                  S01194
0124 I**********                              2   70CNUM                  S01194
0125 I**********                              9  28 CRNM                  S01194
0126 I**********                             29  38 CTWN                  S01194
0127 I**********                             39  48 CSNM                  S01194
0128 I**********                             49  56 CASK                  S01194
0129 I**********                             57  68 TELX                  S01194
0130 I**********                             69  80 CSID                  S01194
0131 I**********                             81  82 ACOC                  S01194
0132 I**********                             83  83 CBSI                  S01194
0133 I**********                             84  85 CCTZ                  S01194
0134 I**********                             86  87 CLOC                  S01194
0135 I**********                             88  930CPAR                  S01194
0136 I***********                            94  960BRCD                  S01194
0137 I**********                             97  980LINS                  S01194
0138 I**********                             99 1010LIND                  S01194
0139 I**********                          P 102 1040DASU                  S01194
0140 I**********                          P 105 1070CDIC                  S01194
0141 I**********                          P 108 1100DADE                  S01194
0142 I**********                            111 111 CMIN                  S01194
0143 I**********                            112 112 CTYP                  S01194
0144 I**********                            113 124 TELF                  S01194
0145 I**********                            125 133 CHID                  S01194
0146 I****CLINT*FILE*-*CATCHALL                                           S01194
0147 I**                                                                  S01194
0148 I********NS                                                          S01194
0149 I*                                                                   LE0330
0150 I*    GUARANTEES/SECURITIES/COLLATERAL FILE - TRAILER                LE0330
0151 I*                                                                   LE0330
0152 IGTEEST  NS  04   1 CT                                               LE0330
0153 I                                        1   1 RECI                  LE0330
0154 I**********                              2   70CNUM                               LE0330 CSD027
0154 I                                        2   7 CNUM                                      CSD027
0155 I                                        8  13 FCLN                  LE0330
0156 I                                       14  160GUSN                  LE0330
0157 I                                    P  17  190NORE                  LE0330
0158 I                                    P  20  220FLSZ                  LE0330
0159 I                                    P  23  250NLRB                  LE0330
0160 I                                    P  26  280NINS                  LE0330
0161 I                                    P  29  310NDEL                  LE0330
0162 I                                    P  32  340NLRA                  LE0330
0163 I                                    P  35  420VLBF                  LE0330
0164 I                                    P  43  440VLBL                  LE0330
0165 I                                    P  45  520VRIF                  LE0330
0166 I                                    P  53  540VRIL                  LE0330
0167 I                                    P  55  620VRDF                  LE0330
0168 I                                    P  63  640VRDL                  LE0330
0169 I                                    P  65  720VRAF          26      LE0330
0170 I                                    P  73  740VRAL          27      LE0330
0171 I                                    P  75  820VLAF                  LE0330
0172 I                                    P  83  840VLAL                  LE0330
0173 I                                    P 122 1240LCD                   LE0330
0174 I                                      125 125 CHTP                  LE0330
0175 I                                    P 126 1280TNLU                  LE0330
0176 I        NS                                                          LE0330
     I*                                                                   S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I** EXTERNAL DS FOR BRANCHES DETAILS                                 S01117
     I**                                                                  S01117
     I              A8BRNM                          BRNM                  S01194
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              QQDFAC                          DFAC01                                    CGL029
     I              BBCRNM                          CRNM                  S01194
      **                                                                                      196066
     ISCSARD    E DSSCSARDPD                                                                  196066
      ** SAR FILE DETAILS                                                                     196066
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              A6NBDP                          CDP                   S01194
      *                                                                   S01194
     I/COPY WNCPYSRC,LE0330I001
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0177 I**                                                                  LE0330
0178 I*****DATA*STRUCTURE*FOR*KEY*TO*CURRENCIES*ON*TABLE*FILE             S01194
0179 I**                                                                  LE0330
0180 I**********  DS                                                      S01194
0181 I**********                              1  12 TBKEY                 S01194
0182 I**********                              9  11 CCY                   S01194
0183 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION              LE0330
0184 ILDA        UDS                            256                       LE0330
0185 I***********                           134 138 DBFILE                S01117
0186 I***********                           139 167 DBKEY                 S01117
0187 I***********                           168 175 DBPGM                 S01117
0188 I***********                           176 177 DBASE                 S01117
0185 I                                      134 141 DBFILE                S01117
0186 I                                      142 170 DBKEY                 S01117
0187 I                                      171 180 DBPGM                 S01117
0188 I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I**    DATA AREA RUNDAT                                              S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     C                     MOVEACPY@      BIS@   80
     C*
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C**                                                                  S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCURRR0'                            S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CURKEY  3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C*                                                                   S01194
0189 C**                                                                  LE0330
0190 C**   FIRST CYCLE PROCESSING                                         LE0330
0191 C**                                                                  LE0330
0192 C   30                GOTO ENDFC                                     LE0330
0193 C                     SETON                     302928               LE0330
     C**                                                                  S01117
     C**      IN THE DATAAREA RUNDAT                                      S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C**      SETUP MULTIBRANCHING INDICATOR                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     60                   S01117
     C                     END                                            S01117
0194 C**                                                                  LE0330
0195 C                     EXSR ZSYSTM                                    LE0330
0196 C   99                SETON                     LRU7U8               LE0330
0389 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0389 C   99                MOVE 'SDBANKPD'DBFILE                          S01194
0390 C***99*****           MOVELZTABKY    DBKEY                           S01194
0199 C   99                MOVE '02'      DBASE            DBASE 02       LE0330
0200 C   99                GOTO END                                       LE0330
      *                                                                                       196066
      ** Check if SAR is switched ON                                                          196066
      *                                                                                       196066
     C                     MOVE 'N'       CLE002  1                                           196066
     C                     CALL 'AOSARDR0'                                                    196066
     C                     PARM *BLANKS   @RTCD                                               196066
     C                     PARM '*VERIFY' @OPTN                                               196066
     C                     PARM 'CLE002'  @SARD   6                                           196066
     C           SCSARD    PARM SCSARD    DSFDY                                               196066
      *                                                                                       196066
     C           @RTCD     IFEQ *BLANKS                                                       196066
     C                     MOVE 'Y'       CLE002                                              196066
     C                     MOVE '1'       *IN39                                               196066
     C                     END                                                                196066
      *                                                                                       196066
     C           @RTCD     IFNE *BLANKS                                                       196066
     C           @RTCD     ANDNE'*NRF   '                                                     196066
      *                                                                                       196066
      ** Call to program ended in error                                                       196066
      *                                                                                       196066
     C           *LOCK     IN   LDA                                                           196066
     C                     MOVEL'CLE002'  DBKEY            ***************                    196066
     C                     MOVE 'SCSARDPD'DBFILE           * DB ERROR 05 *                    196066
     C                     Z-ADD5         DBASE            ***************                    196066
     C                     MOVEL'LE0300'  DBPGM                                               196066
     C                     OUT  LDA                                                           196066
     C                     SETON                     U7U8LR                                   196066
     C                     EXSR *PSSR                                                         196066
     C                     GOTO END                                                           196066
     C                     ENDIF                                                              196066
0201 C**                                                                  LE0330
0202 C**   SETUP FIELDS AND INDICATORS                                    LE0330
0203 C**                                                                  LE0330
0204 C                     Z-ADD0         ZERO3   30                      LE0330
0205 C                     Z-ADD0         ZERO5   50                      LE0330
0206 C                     Z-ADD0         ZERO15 150                      LE0330
0207 C                     Z-ADD0         RLIST   50                      LE0330
0208 C                     Z-ADD0         RINS    50                      LE0330
0209 C                     Z-ADD0         RDEL    50                      LE0330
0210 C                     Z-ADD0         RAFT    50                      LE0330
0211 C                     Z-ADD0         RAFTF  150                      LE0330
0212 C                     Z-ADD0         RAFTL   30                      LE0330
     C                     Z-ADD0         DBASE                           S01117
     C**                                                                  S01117
     C**      OPEN SPOOL FILE WHEN NON-MULTIBRANCHING                     S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     OF8528ALLOW OUTPUT   S01117
     C                     OPEN LE0330P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
0213 C**                                                                  LE0330
0214 C**********           MOVE 'A'       CLIKEY  7                       S01194
0215 C**********           MOVEL'20'      TBKEY                           S01194
0216 C**********           MOVE '1'       TBKEY                           S01194
0217 C                     GOTO END                                       LE0330
0218 C**                                                                  LE0330
0219 C           ENDFC     TAG                             ** ENDFC TAG **LE0330
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0330CCPG                                           S01408
     C*                                                                   S01408
0220 C**                                                                  LE0330
0221 C**   DETAIL PROCESSING                                              LE0330
0222 C**                                                                  LE0330
0223 C***********          SETOF                     2028                 S01117
0223 C                     SETOF                     20                   S01117
0224 C   05                GOTO END                                       LE0330
0225 C**                                                                  LE0330
     C*    AT CHANGE OF BRANCH CODE EXECUTE PRINT                         S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *INL1     ANDEQ'1'                                       S01117
     C                     CLOSELE0330P1                                  S01117
     C                     SETON                     2885                 S01117
     C                     OPEN LE0330P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  GET BRANCH NAME                                                 S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************** S01117
     C                     MOVEL@DSNB     DBKEY            * DBERROR 07 * S01117
     C                     Z-ADD7         DBASE            ************** S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
0226 C   02                EXSR RAFTAD                                    LE0330
0227 C**                                                                  LE0330
0228 C           LCD       COMP RUND                     40               LE0330
0229 C  N40                GOTO END                                       LE0330
0230 C**                                                                  LE0330
0231 C           CHTP      COMP 'I'                      34               LE0330
0232 C           CHTP      COMP 'D'                      35               LE0330
0233 C**                                                                  LE0330
      ** Check if Amended/Deleted but inserted on the same day                                195801
      *                                                                                       195801
     C           CHTP      IFEQ 'A'                                                           195801
     C           ORED      ANDEQRUND                                                          195801
     C           *IN35     OREQ '1'                                                           195801
     C           ORED      ANDEQRUND                                                          195801
     C                     MOVE '1'       *IN34                                               195801
     C                     ENDIF                                                              195801
      *                                                                                       195801
0234 C   34      RINS      ADD  1         RINS                            LE0330
0235 C**                                                                  LE0330
0236 C   35      RDEL      ADD  1         RDEL                            LE0330
0237 C**                                                                  LE0330
0238 C**   CHAIN TO CLIENT FILE FOR CUSTOMER DETAILS                      LE0330
0239 C**                                                                  LE0330
0240 C**********           MOVELCNUMC     CLIKEY                          S01194
0241 C**********           EXSR CLINCH                                    S01194
     C*                                                                   S01194
     C*    CALL AOCUSTR0 FOR CUSTOMER NAME                                S01194
     C*                                                                   S01194
0240 C                     MOVELCNUMC     CKEY                            S01194
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           @RTCD     ANDNE'*CUSCLS'                                                   MD050457
     C           @RTCD     IFNE '*NRF   '                                 190023
     C           BBDTDL    OREQ 0                                         190023
     C                     SETON                     U7U8LR               S01194
0242 C                     MOVE '03'      DBASE            DBASE 03       S01194
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     MOVELCKEY      DBKEY                           S01194
0243 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C                     END                                            190023
0242 C**N10*****           MOVE '03'      DBASE            DBASE 03       S01194
0243 C**N10*****           GOTO END                                       S01194
0244 C**                                                                  LE0330
0245 C                     MOVE CRNM      CRNMC  20                       LE0330
0246 C**                                                                  LE0330
0247 C*****CHAIN TO CLIENT FILE FOR GUARANTOR DETAILS                     S01194
     C**   ACCESS AOCUSTR0 FOR GUARANTOR DETAILS                          S01194
0248 C**                                                                  LE0330
0249 C**********           MOVELGBCN      CLIKEY                          S01194
0250 C**********           EXSR CLINCH                                    S01194
     C/COPY WNCPYSRC,LE0330C002
     C                     MOVELGBCN      CKEY                            S01194
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           @RTCD     ANDNE'*CUSCLS'                                                   MD050457
     C           @RTCD     IFNE '*NRF   '                                 190023
     C           BBDTDL    OREQ 0                                         190023
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '04'      DBASE            DBASE 04       S01194
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     MOVELCKEY      DBKEY                           S01194
0243 C                     GOTO END                                       S01194
     C                     END                                            190023
     C                     END                                            S01194
0251 C**N10*****           MOVE '04'      DBASE            DBASE 04       S01194
0252 C**N10*****           GOTO END                                       S01194
0253 C**                                                                  LE0330
0254 C                     MOVE CRNM      CRNMG  20                       LE0330
     C/COPY WNCPYSRC,LE0330C003
0255 C**                                                                  LE0330
0256 C*****CHAIN*TO*TABLE*FILE*FOR*CURRENCY*DECIMAL*PLACES                S01194
     C*    ACCESS AOCURRR0 FOR CCY DECIMAL PLACES                         S01194
     C*                                                                   S01194
     C                     MOVELCCY       CURKEY                          S01194
     C                     CALL 'AOCURRR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '05'      DBASE                           S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     MOVELCURKEY    DBKEY                           S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0257 C**                                                                  LE0330
0258 C**********           SETOF                     1040                 S01194
0259 C********** TBKEY     CHAINTABLE                40                   S01194
0260 C**N10*****           SETON                     LRU7U8               S01194
0261 C**N10*****           MOVE 'TABLE'   DBFILE                          S01194
0262 C**N10*****           MOVELTBKEY     DBKEY                           S01194
0263 C**N10*****           MOVE '05'      DBASE            DBASE 05       S01194
0264 C**N10*****           GOTO END                                       S01194
0265 C**                                                                  LE0330
0266 C           CDP       COMP 1                      2223               LE0330
0267 C           CDP       COMP 2                    25  24               LE0330
0268 C**                                                                  LE0330
0269 C**   CHECK WHETHER FACILITY OR LOAN BASED                           LE0330
0270 C**                                                                  LE0330
0271 C                     MOVELFCLN      FCLN1   1                       LE0330
0272 C********** FCLN1     COMP 'F'                      21                            LE0330 CLE148
     C           FCLN1     COMP ' '                      21                                   CLE148
0273 C**                                                                  LE0330
0274 C**   CONVERT DATES                                                  LE0330
0275 C**                                                                  LE0330
0276 C                     Z-ADDSTTD      ZDAYNO                          LE0330
0277 C                     EXSR ZDATE2                                    LE0330
0278 C                     MOVE ZADATE    STTDA   7                       LE0330
0279 C**                                                                  LE0330
0280 C                     Z-ADDEDDT      ZDAYNO                          LE0330
0281 C                     EXSR ZDATE2                                    LE0330
0282 C                     MOVE ZADATE    EDDTA   7                       LE0330
0283 C**                                                                  LE0330
0284 C  N33                Z-ADDRVDT      ZDAYNO                          LE0330
0285 C  N33                EXSR ZDATE2                                    LE0330
0286 C  N33                MOVE ZADATE    RVDTA   7                       LE0330
0287 C**                                                                  LE0330
     C/COPY WNCPYSRC,LE0330C001
     C/COPY WNCPYSRC,LE0330CCP1                                           LBH024
0288 C           RLIST     ADD  1         RLIST                           LE0330
0289 C**                                                                  LE0330
0290 C                     SETON                     20                   LE0330
0291 C***********          SETOF                     29                   S01117
0291 C                     SETOF                     2829                 S01117
0292 C           END       TAG                             ** END TAG ****LE0330
0293 C**                                                                  LE0330
0294 C**   LAST RECORD CALCULATIONS                                       LE0330
0295 C**                                                                  LE0330
0296 CLR U7                GOTO LRTAG                                     LE0330
0297 CLR                   MOVE '99999999'GTKEY  150                      LE0330
0298 CLR                   MOVEL'9999999' GTKEY                           LE0330
0299 CLR                   SETOF                     40                   LE0330
0300 CLR         GTKEY     CHAINGTEEST               40                   LE0330
0301 CLRN04                SETON                     U7U8                 LE0330
0302 CLRN04                MOVE 'GTEES'   DBFILE                          LE0330
0303 CLRN04                MOVELGTKEY     DBKEY                           LE0330
0304 CLRN04                MOVE '06'      DBASE            DBASE 06       LE0330
0305 CLRN04                GOTO LRTAG                                     LE0330
0306 CLR         RAFT      COMP NLRA                 U8U8                 LE0330
0307 CLRNU8      RAFTF     COMP VLAF                 U8U8                 LE0330
0308 CLRNU8      RAFTL     COMP VLAL                 U8U8                 LE0330
0309 CLR U8                GOTO LRTAG                                     LE0330
0310 C**   ADD HASH TOTALS OF INSERTS, AMENDS, DELETES TO                 LE0330
0311 C**   BEFORE INPUT VALUES AND COMPARE TO AFTER INPUT VALUES          LE0330
0312 C**                                                                  LE0330
0313 CLR         NLRB      ADD  NINS      COUNT   50                      LE0330
0314 CLR         COUNT     SUB  NDEL      COUNT                           LE0330
0315 CLR                   Z-ADDVLBF      ZZTOTI                          LE0330
0316 CLR                   Z-ADDVLBL      ZZTOTD                          LE0330
0317 CLR                   Z-ADDVRIF      ZZAMTI                          LE0330
0318 CLR                   Z-ADDVRIL      ZZAMTD                          LE0330
0319 CLR                   EXSR GLZSUM                                    LE0330
0320 C**                                                                  LE0330
0321 CLR                   Z-ADDVRAF      ZZAMTI                          LE0330
0322 CLR                   Z-ADDVRAL      ZZAMTD                          LE0330
0323 CLR                   EXSR GLZSUM                                    LE0330
0324 C**                                                                  LE0330
0325 CLR                   Z-SUBVRDF      ZZAMTI                          LE0330
0326 CLR                   Z-SUBVRDL      ZZAMTD                          LE0330
0327 CLR                   EXSR GLZSUM                                    LE0330
0328 C**                                                                  LE0330
0329 CLR         ZZTOTI    COMP VLAF                 U8U8                 LE0330
0330 CLRNU8      ZZTOTD    COMP VLAL                 U8U8                 LE0330
0331 CLRNU8      COUNT     COMP NLRA                 U8U8                 LE0330
0332 CLRNU8                EXCPT                                          LE0330
0333 C**                                                                  LE0330
0334 CLR         LRTAG     TAG                             ** LRTAG TAG **LE0330
0335 C**                                                                  LE0330
0336 C**   REVERSE SIGN OF HASH FIELD IF NEGATIVE FOR REPORT              LE0330
0337 C**                                                                  LE0330
0338 CLR 26                SETON                     27                   LE0330
0339 CLR 27                Z-SUBVRAL      VRAL                            LE0330
0340 C**                                                                  LE0330
0341 C*R U7                MOVEL'LE0330'  DBPGM                           S01125
0341 CLR U7                MOVEL'LE0330  'DBPGM                           S01125
     C**   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                       S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
     CLR                   OUT  LDA                                       S01117
     C*                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
     C**   OPEN REPORT FILE WHEN NO DETAIL TO REPORT                      S01117
     CLRN85                EXSR #ZZ                                       S01117
0342 C********************************************************************LE0330
0343 C*                                                                  *LE0330
0344 C*    RAFTAD SR TO ADD INTO HASH TOTALS OF LIVE RECORDS             *LE0330
0345 C*                                                                  *LE0330
0346 C           RAFTAD    BEGSR                           ** RAFTAD BEGSRLE0330
0347 C**                                                                  LE0330
0348 C           RAFT      ADD  1         RAFT                            LE0330
0349 C**                                                                  LE0330
0350 C                     Z-ADDRAFTF     ZZTOTI                          LE0330
0351 C                     Z-ADDRAFTL     ZZTOTD                          LE0330
0352 C                     MOVE UAMT      ZZAMT                           LE0330
0353 C                     EXSR GLZADD                                    LE0330
0354 C                     Z-ADDZZTOTI    RAFTF                           LE0330
0355 C                     Z-ADDZZTOTD    RAFTL                           LE0330
0356 C**                                                                  LE0330
0357 C                     ENDSR                                          LE0330
0358 C*                                                                   LE0330
0359 C********************************************************************LE0330
0360 C**********                                                         *S01194
0361 C*****CLINCH*SR.*TO*CHAIN TO CLINT FILE AND SET ERROR               *S01194
0362 C*****CONDITION*IF*RECORD*NOT*FOUND.                                *S01194
0363 C**********                                                         *S01194
0364 C********** CLINCH    BEGSR                           ** CLINCH BEGSRS01194
0365 C**********                                                          S01194
0366 C**********           SETOF                     1040                 S01194
0367 C********** CLIKEY    CHAINCLINT                40                   S01194
0368 C**********                                                          S01194
0369 C**N10*****           SETON                     LRU7U8               S01194
0370 C**N10*****           MOVE 'CLINT'   DBFILE                          S01194
0371 C**N10*****           MOVELCLIKEY    DBKEY                           S01194
0372 C**********                                                          S01194
0373 C**********           ENDSR                                          S01194
0374 C**********                                                         *S01194
0375 C********************************************************************LE0330
0376 C********************************************************************LE0330
0377 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0330
0378 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0330
0379 C*                                                                   LE0330
0380 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0330
0381 C*                                                                   LE0330
0382 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0330
0383 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0330
0384 C*                                                                   LE0330
0385 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0330
0386 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0330
0387 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0330
0388 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0330
0389 C*                                                                   LE0330
0390 CSR                   EXSR GLZSUM                                    LE0330
0391 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0330
0392 C*                                                                   LE0330
0393 C********************************************************************LE0330
0394 C********************************************************************LE0330
0395 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0330
0396 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0330
0397 C*          PARAMETERS PASSED -                                      LE0330
0398 C*                     I/P ZZAMTI ZZAMTD                             LE0330
0399 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0330
0400 C*                                                                   LE0330
0401 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0330
0402 C*                                                                   LE0330
0403 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0330
0404 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0330
0405 CSR                   SETOF                     919293               LE0330
0406 CSR                   SETOF                     949599               LE0330
0407 C*                                                                   LE0330
0408 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0330
0409 CSR         ZZAMTI    COMP 0                      9293               LE0330
0410 CSR 93      ZZAMTD    COMP 0                      9293               LE0330
0411 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0330
0412 C*                                                                   LE0330
0413 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0330
0414 CSR         ZZTOTI    COMP 0                      9193               LE0330
0415 CSR 93      ZZTOTD    COMP 0                      9193               LE0330
0416 C*                                                                   LE0330
0417 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0330
0418 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0330
0419 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0330
0420 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0330
0421 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0330
0422 CSR 91N92                                                            LE0330
0423 CORN91 92             GOTO ZZOFPS                                    LE0330
0424 C*                                                                   LE0330
0425 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0330
0426 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0330
0427 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0330
0428 C*                                                                   LE0330
0429 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0330
0430 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0330
0431 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0330
0432 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0330
0433 C*                                                                   LE0330
0434 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0330
0435 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0330
0436 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0330
0437 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0330
0438 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0330
0439 C*                                                                   LE0330
0440 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0330
0441 CSR 99                Z-ADD0         ZZAMT  153                      LE0330
0442 CSR                   GOTO ZZSEND                                    LE0330
0443 C*                                                                   LE0330
0444 C* THE 'SIGNS' ARE DIFFERENT                                         LE0330
0445 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0330
0446 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0330
0447 C*                                                                   LE0330
0448 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0330
0449 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0330
0450 C*                                                                   LE0330
0451 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0330
0452 C*                                                                   LE0330
0453 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0330
0454 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0330
0455 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0330
0456 C*                                                                   LE0330
0457 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0330
0458 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0330
0459 C*                                                                   LE0330
0460 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0330
0461 CSR 95                Z-ADD0         ZZTOTI                          LE0330
0462 CSR 95                Z-ADD0         ZZTOTD                          LE0330
0463 CSR 95                GOTO ZZSEND                                    LE0330
0464 C*                                                                   LE0330
0465 C* IF ZZTOT GT. ZZAMT.                                               LE0330
0466 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0330
0467 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0330
0468 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0330
0469 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0330
0470 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0330
0471 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0330
0472 C*                                                                   LE0330
0473 C*                                                                   LE0330
0474 C* IF ZZAMT GT. ZZTOT.                                               LE0330
0475 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0330
0476 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0330
0477 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0330
0478 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0330
0479 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0330
0480 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0330
0481 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0330
0482 C*                                                                   LE0330
0483 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0330
0484 CSR                   SETOF                     94                   LE0330
0485 CSR 93 91                                                            LE0330
0486 CORN93 92             SETON                     94                   LE0330
0487 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0330
0488 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0330
0489 C**                                                                  LE0330
0490 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0330
0491 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0330
0492 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0330
0493 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0330
0494 C**                                                                  LE0330
0495 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0330
0496 CSR                   SETOF                     96                   LE0330
0497 CSR         ZZTOTD    COMP 0                        91               LE0330
0498 CSR 91      ZZTOTI    COMP 0                      96                 LE0330
0499 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0330
0500 CSR                   ENDSR                             ** ENDSR **  LE0330
0501 C********************************************************************LE0330
0592 C********************************************************************LE0330
0593 C**                                                                  LE0330
0594 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE0330
0595 C**                                                                  LE0330
0596 C           ZSYSTM    BEGSR                           *** ZSYSTM *** LE0330
0597 C**                                                                  LE0330
0598 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.                    LE0330
0599 C**********           MOVEL'01      'ZTABKY 12                       S01194
0600 C**********           MOVE '  10'    ZTABKY                          S01194
0601 C**                                                                  LE0330
0602 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     COMP *BLANKS              9999                 S01194
     C*                                                                   S01194
     C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0604 C**                                                                  LE0330
0605 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    LE0330
0606 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0606 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0607 C**                                                                  LE0330
0608 C                     ENDSR                                          LE0330
0609 C**                                                                  LE0330
0610 C**                                                                  LE0330
0611 C********************************************************************LE0330
     C********************************************************************S01117
     C*                                                                   S01117
     C*    SUBROUTINE : #ZZ                                               S01117
     C*                                                                   S01117
     C*    CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCLATIONS IF     S01117
     C*    THE P1 FILES HAVE NOT ALREADY BEEN OPENDED (IE, IF THERE ARE   S01117
     C*    NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)     S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C**   OPEN P1 SPOOL FILE                                             S01117
     C                     OPEN LE0330P1                                  S01117
     C                     SETON                     OF                   S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
0612 O**                                                                  LE0330
0613 O**   GUARANTEES/SECURITY/COLLATERAL MAINTENANCE TODAY REPORT        LE0330
0614 O**                                                                  LE0330
0615 OLE0330P1H  203   OF                                                 S01124
0616 O*******OR**      28                                                 S01117
0616 O       OR        L1 60                                              S01117
0617 O***********                        23 'REFERENCE LE0330'            S01117
0617 O                                   25 'REFERENCE LE0330P1'          S01117
0618 O                         TITL      89                               LE0330
0619 O                                  122 'DATE              PAGE'      LE0330
0620 O                         RUNA     113                               LE0330
0621 O                         PAGE  3  127                               LE0330
0622 O        H  1     OF                                                 LE0330
0623 O*******OR**      28                                                 S01117
0623 O       OR        L1 60                                              S01117
0624 O***********                        63 'GUARANTEES/SECURITIES/CO'    S01117
0625 O***********                        86 'LLATERAL MAINTENANCE TO'     S01117
0626 O***********                        89 'DAY'                         S01117
0624 O                                   53 'GUARANTEES/SECURITIES/CO'    S01117
0625 O                                   76 'LLATERAL MAINTENANCE TO'     S01117
0626 O                                   79 'DAY'                         S01117
     O                       60          92 'BRANCH'                      S01117
     O                       60BRCA      96                               S01117
     O                       60          97 '-'                           S01117
     O                    60N85          97 ' '                           S01117
     O                       60BRNM     127                               S01117
0627 O        H        OF                                                 LE0330
0628 O*******OR**      28                                                 S01117
0628 O       OR        L1 60                                              S01117
0629 O***********                        63 '------------------------'    S01117
0630 O***********                        87 '------------------------'    S01117
0631 O***********                        89 '--'                          S01117
0629 O                                   53 '------------------------'    S01117
0630 O                                   77 '------------------------'    S01117
0631 O                                   79 '--'                          S01117
0632 O        H  108   OF                                                 LE0330
0633 O*******OR**      28                                                 S01117
0633 O       OR        L1 60                                              S01117
0634 O                                   68 '-----REVIEW---'              LE0330
0635 O                                   96 'NO.'                         LE0330
0636 O                                  132 'ACTION'                      LE0330
0637 O        H  1     OF                                                 LE0330
0638 O*******OR**      28                                                 S01117
0638 O       OR        L1 60                                              S01117
0639 O                                   14 'CUSTOMER NAME'               LE0330
0640 O                                   45 'FCLT/   SEQ  START DATE'     LE0330
0641 O                                   68 'END     DATE  FREQ DAY'      LE0330
0642 O                                   88 'CCY    UNIT AMOUNT'          LE0330
0643 O                                  113 'UNITS    TOTAL AMOUNT'       LE0330
0644 O                                  125 'COLL.CODE'                   LE0330
0645 O        H  2     OF                                                 LE0330
0646 O*******OR**      28                                                 S01117
0646 O       OR        L1 60                                              S01117
0647 O                                    6 'NO.'                         LE0330
0648 O                                   34 'LOAN    TYPE'                LE0330
     O/COPY WNCPYSRC,LE0330O003
0649 O                                   72 'GIVEN BY'                    LE0330
     O/COPY WNCPYSRC,LE0330O004
0650 O                                  106 'NARRATIVE'                   LE0330
0651 O        D  1     20                                                 LE0330
0652 O                         CRNMC     21                               LE0330
0653 O                       21FCLNF     28 '   /  '                      LE0330
0654 O                      N21FCLN      28                               LE0330
0655 O                         GUSN  3   33                               LE0330
0656 O                         STTDA     42                               LE0330
0657 O                         EDDTA     51                               LE0330
0658 O                      N33RVDTA     60                               LE0330
0659 O                      N33RVFR      63                               LE0330
0660 O                      N32RVDY      67                               LE0330
0661 O                         CCY       73                               LE0330
0662 O                       22UAMT      90 ' ,   ,   ,   , 0 '           LE0330
0663 O                       23UAMT      90 '   ,   ,   , 0 . '           LE0330
0664 O                       24UAMT      91 '  ,   ,   , 0 .  '           LE0330
0665 O                       25UAMT      92 ' ,   ,   , 0 .   '           LE0330
0666 O                         NOUN  3   97                               LE0330
0667 O                       22TAMT     115 ' ,   ,   ,   , 0 '           LE0330
0668 O                       23TAMT     115 '   ,   ,   , 0 . '           LE0330
0669 O                       24TAMT     116 '  ,   ,   , 0 .  '           LE0330
0670 O                       25TAMT     117 ' ,   ,   , 0 .   '           LE0330
0671 O                         COLC     122                               LE0330
0672 O                         CHTP     131                               LE0330
     O/COPY WNCPYSRC,LE0330O001
     O/COPY WNCPYSRC,LE0330OOP1                                           LBH024
0673 O********D  2     20                                                 147935
     O        D  1     20                                                 147935
     O/COPY WNCPYSRC,LE0330O002
0674 O                         CNUMC      7                               LE0330
0675 O                         GSCI      32                               LE0330
0676 O                         GBCN      68                               LE0330
0677 O                         CRNMG     89                               LE0330
0678 O                         NARR     129                               LE0330
     O********D* 2     20                                                              147935 196066
     O        D  2     20 39                                                                  196066
     O                                   36 'INSERTING USER'              147935
     O                         IUSR      48                               147935
     O                                   67 'AMENDING USER'               147935
     O                         AUSR      79                               147935
     O                                  108 'AUTHORISING USER'            147935
     O                         XUSR     120                               147935
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0330OOPG                                           S01408
     O*                                                                   S01408
     O        T  203  N85 LR                                              S01117
     O                                   25 'REFERENCE LE0330P1'          S01117
     O                         TITL      89                               S01117
     O                                  122 'DATE              PAGE'      S01117
     O                         RUNA     113                               S01117
     O                         PAGE  3  127                               S01117
     O        T  1    N85 LR                                              S01117
     O                                   53 'GUARANTEES/SECURITIES/CO'    S01117
     O                                   76 'LLATERAL MAINTENANCE TO'     S01117
     O                                   79 'DAY'                         S01117
     O                       60          92 'BRANCH'                      S01117
     O                       60BRCA      96                               S01117
     O                       60          97 '-'                           S01117
     O                    60 29          97 ' '                           S01117
     O                       60BRNM     127                               S01117
     O        T          N85 LR                                           S01117
     O                                   53 '------------------------'    S01117
     O                                   77 '------------------------'    S01117
     O                                   79 '--'                          S01117
0679 O        T   21   LR 29NU7                                           LE0330
     O       OR        L1 28NU7                                           S01117
     O       AND       60                                                 S01117
0680 O*************                      77 '*** NO INPUT TODAY ***'      S01117
0680 O                                   74 '*** NO INPUT TODAY ***'      S01117
0681 O        T 32     LR U7 U8                                           LE0330
0682 O                                   51 '*** REFERENCE LE0330'        LE0330
0683 O***********                        71 '- DATABASE ERROR AT'         S01117
0683 O                                   72 '- DATABASE ERROR ***'        S01117
0684 O***********              DBASE     74                               S01117
0685 O********T**      LR U7 U8                                           S01117
0686 O***********                        37 'FILENAME'                    S01117
0687 O***********              DBFILE    43                               S01117
0688 O***********                        48 'KEY'                         S01117
0689 O***********              DBKEY     78                               S01117
     O        T 3      L1 60NU7                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 'BRANCH '                     S01117
     O                         BRCA      77                               S01117
     O                                   81 '***'                         S01117
     O        T 3      LRNU7N60                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0690 O**                                                                  LE0330
0691 O**   FILE CONTROL REPORT                                            LE0330
0692 O**                                                                  LE0330
0693 O********T**203   LR                                                 S01117
0694 O***********                        23 'REFERENCE LE0330'            S01117
0693 OLE0330AUT  203   LR                                                 S01117
0694 O                                   25 'REFERENCE LE0330AU'          S01117
0695 O                         TITL      89                               LE0330
0696 O                                  122 'DATE              PAGE'      LE0330
0697 O                         RUNA     113                               LE0330
0698 O***********              PAGE  3  127                               S01117
0698 O                         PAGE1 3  127                               S01117
0699 O        T  1     LR                                                 LE0330
0700 O***********                        63 'GUARANTEES/SECURITIES/CO'    S01117
0701 O***********                        86 'LLATERAL MAINTENANCE TO'     S01117
0702 O***********                        89 'DAY'                         S01117
0700 O                                   56 'GUARANTEES/SECURITIES/CO'    S01117
0701 O                                   79 'LLATERAL MAINTENANCE TO'     S01117
0702 O                                   98 'DAY - FILE CONTROLS'         S01117
0703 O        T        LR                                                 LE0330
0704 O***********                        63 '------------------------'    S01117
0705 O***********                        87 '------------------------'    S01117
0706 O***********                        89 '--'                          S01117
0704 O                                   56 '------------------------'    S01117
0705 O                                   80 '------------------------'    S01117
0706 O                                   98 '------------------'          S01117
0707 O        T  217   LR                                                 LE0330
0708 O                                   18 'RUN CONTROLS'                LE0330
0709 O                                   72 '------------ REPORT'         LE0330
0710 O                                   84 '-----------'                 LE0330
0711 O                                  115 '--------- FILE CONTROL'      LE0330
0712 O                                  124 '--------'                    LE0330
0713 O        T  2     LR                                                 LE0330
0714 O                                   59 'NUMBER'                      LE0330
0715 O                                   99 'VALUE         NUMBER'        LE0330
0716 O                                  124 'VALUE'                       LE0330
0717 O        T  2     LR                                                 LE0330
0718 O                                   30 'RECORDS LISTED IN THIS'      LE0330
0719 O                                   37 'REPORT'                      LE0330
0720 O                         RLIST 3   59                               LE0330
0721 O        T  2     LR                                                 165426
0722 O                                   32 'TOTAL NUMBER OF RECORDS '    165426
0724 O                         NORE  3   99                               165426
0721 O        T  2     LR                                                 LE0330
0722 O                                   32 'RECORDS BEFORE INPUT CYC'    LE0330
0723 O                                   34 'LE'                          LE0330
0724 O                         NLRB  3   99                               LE0330
0725 O                         VLBF  4  121                               LE0330
0726 O                         VLBL     124                               LE0330
0727 O        T  2     LR                                                 LE0330
0728 O                                   24 'RECORDS INSERTED'            LE0330
0729 O                         RINS  3   59                               LE0330
0730 O                         NINS  3   99                               LE0330
0731 O                         VRIF  4  121                               LE0330
0732 O                         VRIL     124                               LE0330
0733 O        T  2     LR                                                 LE0330
0734 O                                   23 'RECORDS DELETED'             LE0330
0735 O                         RDEL  3   59                               LE0330
0736 O                         NDEL  3   99                               LE0330
0737 O                         VRDF  4  121                               LE0330
0738 O                         VRDL     124                               LE0330
0739 O        T  2     LR                                                 LE0330
0740 O                                   23 'RECORDS AMENDED'             LE0330
0741 O                         VRAF  4  121                               LE0330
0742 O                         VRAL     124                               LE0330
0743 O                       27         125 '-'                           LE0330
0744 O        T  2     LR                                                 LE0330
0745 O                                   32 'RECORDS AFTER INPUT CYCL'    LE0330
0746 O                                   33 'E'                           LE0330
0747 O                         RAFT  3   59                               LE0330
0748 O                         RAFTF 4   81                               LE0330
0749 O                         RAFTL     84                               LE0330
0750 O                         NLRA  3   99                               LE0330
0751 O                         VLAF  4  121                               LE0330
0752 O                         VLAL     124                               LE0330
0753 O***********        NU7 U8         128 '***'                         S01117
     O        T  2     LRNU7 U8                                           S01117
     O                                  128 '***   DIFFERENCE   ***'      S01117
     O        T  2     LR 29NU7                                           S01117
     O                                   74 '*** NO INPUT TODAY ***'      S01117
     O        T 32     LR U7 U8                                           S01117
     O                                   51 '*** REFERENCE LE0330'        S01117
     O                                   71 '- DATABASE ERROR AT'         S01117
     O                         DBASE     75                               S01117
     O        T        LR U7 U8                                           S01117
     O                                   37 'FILENAME'                    S01117
     O                         DBFILE    46                               S01117
     O                                   51 'KEY'                         S01117
     O                         DBKEY     81                               S01117
0754 O********T**2     LR                                                 S01117
0755 O***********                        68 '***   END OF REPORT'         S01117
0756 O***********                        74 '***'                         S01117
0757 O***********        NU7 U8         128 '***   DIFFERENCE   ***'      S01117
0758 O**                                                                  LE0330
0759 O**   UPDATE GTEES TRAILER                                           LE0330
0760 O**                                                                  LE0330
0761 OGTEEST  E                                                           LE0330
0762 O                         NLRA      25P                              LE0330
0763 O                         ZERO5     28P                              LE0330
0764 O                         ZERO5     31P                              LE0330
0765 O                         VLAF      42P                              LE0330
0766 O                         VLAL      44P                              LE0330
0767 O                         ZERO15    52P                              LE0330
0768 O                         ZERO3     54P                              LE0330
0769 O                         ZERO15    62P                              LE0330
0770 O                         ZERO3     64P                              LE0330
0771 O                         ZERO15    72P                              LE0330
0772 O                         ZERO3     74P                              LE0330
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
