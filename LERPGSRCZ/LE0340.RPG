0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Adjusts- Accrd Int Input Today Rpt')             *
0001 H***********                                                         S01117
0002 F********************************************************************LE0340
0004 F*                                                                  *LE0340
     F*  Midas - Customer Lending Module
0004 F*                                                                  *LE0340
0005 F*    LE0340 - PRINT ADJUSTMENTS TO ACCRUED INTEREST                *LE0340
0006 F*                                                                  *LE0340
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                                  *LE0340
      *  Last Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *  Prev Amend No. 245795             Date 26Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242056             Date 20Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE106             Date 15Feb05               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CAC001             Date 01Feb96               *
0009  *                 E20762             Date 22Jan90               *
     F*                 S01194             DATE 04JAN90               *
     F*                  S01117                   DATE 01/09/89          *S01117
0009 F*                  E11890                   DATE 22/02/88          *LE0340
0010 F*                                                                  *LE0340
0011 F********************************************************************
     F*                                                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  245795 - Include branch in the key fields.                   *
      *  242056 - Report title and date are not displayed if "No      *
      *           Details to Report".                                 *
      *         - "End of Report" is not displayed for non-empty file *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE106 - Syndication Manager                                 *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           If Analytical Accounting is installed, Adjustments  *
     F*           to Accrued Cost of Funds would be printed.          *
0010 F*    E20762 - OUTPUT TOTALS ON FILE EVEN IF NO DETAIL RECORDS.     *E20762
     F*    S01194 - STANDING DATA CHANGES                                *S01194
     F*    S01117 - MULTIBRANCHING                                       *S01117
0010 F*    E11890 - ALL ADJUSTMENTS ARE REPORTED FOR BRANCH 001,         *E11890
0012 F*             REGARDLESS OF WHICH BRANCH SHOULD BE USED.           *E11890
0011 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F***SAIAD***IPE*F     200 16AI     2 DISK                     LE0340 CAC001
     F***SAIAD** IPE F     208 16AI     2 DISK                                         CAC001 CAS005
     F***SAIAD** IPE F     216 16AI     2 DISK                                         CAS005 CLE106
     F***LEADINL0IPE F  228            DISK                                            CLE106 245795
     FLEADINL0IPE F     228  3AI    25 DISK                                                   245795
0014 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0016 F*E0340P1O***F     132            PRINTER                   S01124   S01117
0016 F***LE0340AUO***F*****132            PRINTER      KINFDS SPOOLU                   S01117 CLE106
0016 FLE0340P1O   F     132            PRINTER      KINFDS SPOOL      UC  S01117
0004 F*                                                                  *LE0340
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0340
0018 F**04**********  SAIAD HEADER                                                     LE0340 CLE106
0019 F**05**********  SAIAD DETAIL                                                     LE0340 CLE106
0020 F**06**********  SAIAD CATCHALL                                                   LE0340 CLE106
      * 05            Live Record from LEADINPD                                               CLE106
      * 06            Other Record from LEADINPD                                              CLE106
0021 F**07**********  TABLE FILE -I.C. DATA REC-1.                        S01194
0022 F**08**********  TABLE FILE - CURRENCIES REC.                        S01194
     F*       11      Analytical Accounting is installed                  CAC001
0023 F*       20      OFF FIRST CYCLE                                     LE0340
0024 F*       25      PAGE CHANGE.                                        LE0340
0025 F*       26      PAGE CHANGE                                         LE0340
0026 F*       27      INPUT RECORD COUNT = 0                              LE0340
0027 F*       28      HEADER INCREASES/DECREASES NOT = 0                  LE0340
0028 F*       29      HASH TOTALS OUT OF BALANCE                          LE0340
0029 F********30      UNSUCCESSFUL CHAIN TO CURRENCIES REC.               S01194
0030 F*       32      NO DECIMAL POSITIONS.                               LE0340
0031 F*       33      1 DECIMAL POSITION                                  LE0340
0032 F*       34      2 DECIMAL POSITION                                  LE0340
0033 F*       35      3 DECIMAL POSITION                                  LE0340
0034 F*       50      SETON WHEN DATA BASE ERROR                          LE0340
     F*       60      MULTIBRANCHING INDICATOR                            S01117
     F*       85      REPORT FILE OPENED IN FIRST PROCESSING CYCLE        S01117
     F*       91      USED IN SUBROUTINES                                 LE0340
     F*       92      USED IN SUBROUTINES                                 LE0340
     F*       93      USED IN SUBROUTINES                                 LE0340
     F*       94      USED IN SUBROUTINES                                 LE0340
     F*       95      USED IN SUBROUTINES                                 LE0340
     F*       96      USED IN SUBROUTINES                                 LE0340
     F*       99      USED IN SUBROUTINES                                 LE0340
0042 F*       U7&U8   DATA BASE ERROR                                     LE0340
0043 F*       U8      CONTROLS OUT OF BALANCE                             LE0340
     E                    CPY@    1   1 80
0044 I***SAIAD*HEADER******                                                            LE0340 CLE106
0045 I***SAIAD*NS**04***1*CH                                                           LE0340 CLE106
0046 I***********                             1   1 RECI                               LE0340 CLE106
0047 I***********                             2   60NAVT                               LE0340 CLE106
0048 I***********                             7  110MNT                                LE0340 CLE106
0049 I***********                         P  12  140NORC                               LE0340 CLE106
0050 I***********                         P  15  170NOMA                               LE0340 CLE106
0051 I***********                         P  18  250HMAW                               LE0340 CLE106
0052 I***********                         P  26  270HMAD                               LE0340 CLE106
0053 I***********                         P  28  300NOIL                               LE0340 CLE106
0054 I***********                         P  31  380HLIW                               LE0340 CLE106
0055 I***********                         P  39  400HLID                               LE0340 CLE106
0056 I***********                         P  41  430NODL                               LE0340 CLE106
0057 I***********                         P  44  510HLDW                               LE0340 CLE106
0058 I***********                         P  52  530HLDD                               LE0340 CLE106
0059 I***********                         P  67  690NOID                               LE0340 CLE106
0060 I***********                         P  70  770HDIW                               LE0340 CLE106
0061 I***********                         P  79  800HDID                               LE0340 CLE106
0062 I***********                         P  81  830NODD                               LE0340 CLE106
0063 I***********                         P  84  910HDDW                               LE0340 CLE106
0064 I***********                         P  92  930HDDD                               LE0340 CLE106
0065 I***********                         P  94  960NOIC                               LE0340 CLE106
0066 I***********                         P  97 1040HCIW                               LE0340 CLE106
0067 I***********                         P 105 1060HCID                               LE0340 CLE106
0068 I***********                         P 107 1090NODC                               LE0340 CLE106
0069 I***********                         P 110 1170HCDW                               LE0340 CLE106
0070 I***********                         P 118 1190HCDD                               LE0340 CLE106
0071 I***********                         P 120 1220NOIF                               LE0340 CLE106
0072 I***********                         P 123 1300HFIW                               LE0340 CLE106
0073 I***********                         P 131 1320HFID                               LE0340 CLE106
0074 I***********                         P 133 1350NODF                               LE0340 CLE106
0075 I***********                         P 136 1430HFDW                               LE0340 CLE106
0076 I***********                         P 144 1450HFDD                               LE0340 CLE106
0077 I***********                         P 195 1970RRNT                               LE0340 CLE106
0078 I***********                         P 198 2000TNLU                               LE0340 CLE106
0079 I***********                                                                      LE0340 CLE106
0080 I***********                                                                      LE0340 CLE106
0081 I***SAIAD*DETAIL*TYPE-J****************************                               LE0340 CLE106
0082 I********NS**05***1*CJ*                                                           LE0340 CLE106
      *                                                                                       CLE106
      *  LEADINL0 DETAIL: *IN05 is set on if RECI = 'D'                                       CLE106
     ILEADINL0NS  05   1 CD                                                                   CLE106
0083 I                                        1   1 RECI                  LE0340
0084 I**********                              2   70LNRF                               LE0340 CLE148
     I                                        2   7 LNRF                                      CLE148
0085 I**********                              8  130CNUM                  LE0340              CSD027
0085 I                                        8  13 CNUM                                      CSD027
0086 I                                       14  16 CCY                   LE0340
0087 I                                    P  17  230MAAM                  LE0340
0088 I                                       24  24 SIGN                  LE0340
0089 I********                               25  27 BRCD                  E11890
0089 I***********                            25  27 BRCD  L1     E11890   S01117
0089 I                                       25  27 BRCA  L1              S01117
0090 I**************                         28  380FCRF                  LE0340              CSD027
     I                                       28  38 FCRF                                      CSD027
     I                                       28  33 ##FC1                                     CSD027
     I                                       34  36 ##FC2                                     CSD027
     I                                       37  38 ##FC3                                     CSD027
0091 I                                       39  58 CRNM                  LE0340
0092 I                                       59  68 CTWN                  LE0340
0093 I                                      189 1940UDTM                  LE0340
0094 I***********                         P 195 1970RRNT                               LE0340 CLE106
0095 I***********                         P 198 2000TNLU                               LE0340 CLE106
     I***********                         P 201 2070ACAJ                               CAC001 CLE106
     I***********                           208 208 CASN                               CAC001 CLE106
     I***********                         P 209 2150MAAN                               CAS005 CLE106
     I***********                           216 216 MASN                               CAS005 CLE106
     I                                    P 195 1970TNLU                                      CLE106
     I                                    P 198 2040ACAJ                                      CLE106
     I                                      205 205 CASN                                      CLE106
     I                                    P 206 2120MAAN                                      CLE106
     I                                      213 213 MASN                                      CLE106
     I                                      214 228 PCRF                                      CLE106
0096 I*                                                                   LE0340
0097 I* CATCHALL                                                          LE0340
0098 I        NS  06                                                      LE0340
0099 I                                        1   1 RECI                  LE0340
0100 I*                                                                   LE0340
0101 I**************                                                      S01194
0102 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0103 I**************                                                      S01194
0104 I*TABLE***NS**07   2 C0   3 C1  12 C1                                S01194
0105 I*******AND****  13 C0                                               S01194
0106 I**************                          1   1 RECI                  S01194
0107 I**************                          2   30RECT                  S01194
0108 I**************                         12  130RCDE                  S01194
0109 I**************                         14  66 TITL                  S01194
0110 I**************                         67  67 DATF                  S01194
0111 I***********                            68  700DFBR                  S01194
0112 I**************                         74  74 MODI1                 S01194
0113 I**************                         75  75 MODI2                 S01194
0114 I**************                         76  76 MODI3                 S01194
0115 I**************                      P  77  790RUND                  S01194
0116 I**************                         80  86 RUNA                  S01194
0117 I**************                         87  870SFLG                  S01194
0118 I**************                      P  90  920LCD                   S01194
0119 I**************                         93  93 CHTP                  S01194
0120 I**************                      P  94  960TNLU                  S01194
0121 I**************                                                      S01194
0122 I**************                                                      S01194
0123 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0124 I**************                                                      S01194
0125 I*TABLE***NS**08   1 CD   2 C2   3 C0                                S01194
0126 I*******AND****  13 C1                                               S01194
0127 I**************                          1   1 RECI                  S01194
0128 I**************                          2   30RECT                  S01194
0129 I**************                         10  12 CCY                   S01194
0130 I**************                         13  130SREC                  S01194
0131 I**************                         14  27 CCNM                  S01194
0132 I**************                      P  28  348SPOT                  S01194
0133 I**************                         35  37 CCYS                  S01194
0134 I**************                         38  380CDP                   S01194
0135 I**************                         39  390TNOT                  S01194
0136 I**************                         40  40 DCCY                  S01194
0137 I**************                         41  44 SRC1                  S01194
0138 I**************                         45  48 SRC2                  S01194
0139 I**************                         49  520TACC                  S01194
0140 I**************                         53  560TEQV                  S01194
0141 I**************                         57  600SWQV                  S01194
0142 I**************                         61  640TAC4                  S01194
0143 I**************                         65  680TAC5                  S01194
0144 I**************                         69  69 HIND                  S01194
0145 I**************                      P  70  768PART                  S01194
0146 I**************                         77  780SSNO                  S01194
0147 I**************                      P  79  858ERLC                  S01194
0148 I**************                         86  860MDIN                  S01194
0149 I**************                         87  870MDIA                  S01194
0150 I**************                         88  880MDIB                  S01194
0151 I**************                      P  90  920LCD                   S01194
0152 I**************                         93  93 CHTP                  S01194
0153 I**************                      P  94  960TNLU                  S01194
0154 I**TABLE*CATCH*                                                      S01194
0155 I********NS****                                                      S01194
0156 I**************                          1   1 RECI                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I              BJURPT                          TITL                  S01194
     I**                                                                  S01194
     I*                                                                   S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I** EXTERNAL DS FOR BRANCHES DETAILS                                 S01117
     I**                                                                  S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I              A6NBDP                          CDP                   S01194
     I**                                                                  S01194
     ISDMMOD    E DSSDMMODPD                                              CAC001
      ** MIDAS Module details                                             CAC001
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                                                  CAS005
      ** External DS for Switchable features                                                  CAS005
      *                                                                                       CAS005
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0157 I*                                                                   LE0340
0158 I*    LOCAL DATA AREA                                                LE0340
0159 I*                                                                   LE0340
0160 ILDA        UDS                            256                       LE0340
0161 I***********                           134 138 DBFILE                S01117
0162 I***********                           139 167 DBKEY                 S01117
0163 I***********                           168 175 DBPGM                 S01117
0164 I***********                           176 177 DBASE                 S01117
0161 I                                      134 141 DBFILE                S01117
0162 I                                      142 170 DBKEY                 S01117
0163 I                                      171 180 DBPGM                 S01117
0164 I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I***SPOOLU******DS                                                                S01117 CLE106
     I*************                          83  92 SFILEU                             S01117 CLE106
     I*************                       B 123 1240SFNUMU                             S01117 CLE106
     I**                                                                  S01117
     I**    DATA AREA RUNDAT                                              S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     C                     MOVEACPY@      BIS@   80
0165 C*                                                                   LE0340
0166 C         20          GOTO BY01                                      LE0340
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0167 C                     EXSR QFIRST                                    LE0340
      *                                                                   CAC001
      **  Access MIDAS Modules file                                       CAC001
      *                                                                   CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*MSG   ' @RTCD   7                       CAC001
     C                     PARM '*FIRST ' @OPTN   7                       CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
      *                                                                   CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     MOVEL'LE0340 ' DBPGM                           CAC001
     C                     MOVEL'SDMMODPD'DBFILE           ************   CAC001
     C                     MOVEL'*FIRST ' DBKEY            * DBERR 05 *   CAC001
     C                     Z-ADD05        DBASE            ************   CAC001
     C                     EXSR *PSSR                                     CAC001
     C                     SETON                     U7U8LR               CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  Check if Analytical Accounting is installed                     CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN11                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
      ** Check if switchable feature CAS005 is installed                                      CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD   7                                           CAS005
     C                     PARM '*VERIFY' POPTN   7                                           CAS005
     C                     PARM 'CAS005'  PSARD   6                                           CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFEQ *BLANKS                                                       CAS005
     C                     MOVE 'Y'       CAS005  1                                           CAS005
     C                     ELSE                                                               CAS005
     C           PRTCD     IFNE '*NRF   '                                                     CAS005
     C                     MOVE 'SCSARDPD'DBFILE                                              CAS005
     C                     MOVE 'CAS005'  DBKEY                                               CAS005
     C                     Z-ADD6         DBASE                                               CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CAC001
0168 C******U7*U8          EXCPT                                          S01117
0169 C*FIRST CYCLE CALCULATIONS                                           LE0340
0170 C*                                                                   LE0340
0171 C***********          GOTO END                        ** BY01 TAG **              LE0340 CLE106
0172 C           BY01      TAG                                            LE0340
0173 C**NOT*'J'*REC:*GOTO*END*****************************************                 LE0340 CLE106
      * Not a live record; Go to End                                                          CLE106
0174 C         06          GOTO END                                       LE0340
0175 C*                                                                   LE0340
0176 C                     EXSR JCALC                                     LE0340
0177 C* CHECK FOR PAGE OVERFLOW.25=NEW PAGE                               LE0340
0178 C           LINE      COMP 1                        25               LE0340
0179 C***********          EXCPT                                          S01117
     C           *IN25     IFEQ '1'                                       S01117
     C           PAGE      ANDGT1                                         S01117
     C                     EXCPTHEADER                                    S01117
     C                     END                                            S01117
0180 C        N25LINE      COMP 24                       26               LE0340
0181 C         26          Z-ADD0         LINE                            LE0340
0182 C         26          SETOF                     26                   LE0340
0183 C      25             SETOF                     25                   LE0340
0184 C      U7 U8          MOVE 'LE0340'  DBPGM                           LE0340
0185 C      U7 U8          SETON                     50                   LE0340
0186 C*                                                                   LE0340
0187 C           END       TAG                             ** END TAG **  LE0340
0188 C*                                                                   LE0340
0189 C* CHECK CONTROLS AT END. IF NO 'J' RECS,  INCREASES & DECREASES     LE0340
0190 C* SHOULD = 0                                                        LE0340
0191 CLR U7 U8             GOTO LRENDB                                    LE0340
0192 CLR         RECS      COMP 0                        27               LE0340
0193 C*R****27***          SETON                     25                   S01117
0194 C*R****25***          EXCPT                                          S01117
0195 C*R*********          SETOF                     25                   S01117
0196 C***LR*******27NOIL      COMP 0                    2828                                  CLE106
0197 C***LR*******27NODL      COMP 0                    2828                                  CLE106
0198 C***LR*******28          SETON                     U8                                    CLE106
0199 C*R*******27          GOTO LREND                                     E20762
0200 C* TOTAL HEADER FIELDS AND COMPARES TO PROGRAM CALCULATED CONTROLS.
0201 C*LR*********NOIL      ADD  NODL      RECTOT  70                                         CLE106
0202 C*LR*********HLIW      ADD  HLDW      FIRST  150                                         CLE106
0203 C*LR*********HLID      ADD  HLDD      L1      40                                         CLE106
0204 C**ALLOW*FOR*ANY*OVERFLOW*IN*LAST*3*DIGITS************************                       CLE106
0205 C*LR*********          MOVELL1        L2      10                                         CLE106
0206 C*LR*********          MOVE L1        LAST    30                                         CLE106
0207 C*LR*********L2        ADD  FIRST     FIRST                                              CLE106
0208 C**COMPARES*TO*HASH*TOTS.**************************************                          CLE106
0209 C*LR*********RECTOT    COMP RECS                 2929                                    CLE106
0210 C*LR*******29          GOTO LREND                                                        CLE106
0211 C*LR*********FIRST     COMP ZZTOTI               2929                                    CLE106
0212 C*LR*******29          GOTO LREND                                                        CLE106
0213 C*LR*********LAST      COMP ZZTOTD               2929                                    CLE106
0214 C************                                                                     LE0340 CLE106
0215 C*LR********LREND     TAG                             ** LREND TAG **             LE0340 CLE106
0216 C*LR****28*27          SETOF                     27                                      CLE106
0217 C*LR*******29          SETON                     U8                                      CLE106
0218 CLR         LRENDB    TAG                             ** LRENDB TAG *LE0340
     C*****ENSURE*TOTALS*SPOOL*FILE*RECORDED*BY*RCF                                    S01117 CLE106
     C*LR*********          Z-ADDSFNUMU    ZSNUMU                                      S01117 CLE106
     C*LR*********          OUT  LDA                                                   S01117 CLE106
     C************                                                                     S01117 CLE106
     C*LR*********          CALL 'ZSFILE'                                              S01117 CLE106
     C*LR*********          PARM           SEQ     5                                   S01117 CLE106
     C*LR*********          PARM *BLANKS   SENTY   3                                   S01117 CLE106
     C*LR*********          PARM           SFILEU                                      S01117 CLE106
     C*LR*********          PARM           ZSNUMU  60                                  S01117 CLE106
     C*LR*********          PARM           ZSERR   1                                   S01117 CLE106
     C*LR**********LOCK     IN   LDA                                                   S01117 CLE106
     C*LR*********ZSERR     IFEQ 'Y'                                                   S01117 CLE106
     C*****ERROR*DURING*ZSFILE*PROCESSING,*RETURN*TO*CALLING*PROGRAM*                  S01117 CLE106
     C*LR*********          SETON                     U7U8                             S01117 CLE106
     C*LR*********          RETRN                                                      S01117 CLE106
     C*LR*********          END                                                        S01117 CLE106
     C*LR*U7*U8***          EXSR *PSSR                                                 S01117 CLE106
     C*                                                                   S01117
     C**   OPEN REPORT FILE WHEN NO DETAIL TO REPORT                      S01117
     CLRN85                EXSR #ZZ                                       S01117
0219 C******************************************                          LE0340
0220 C******************************************                          LE0340
0221 C** FIRST CYCLE CALCS                                                LE0340
0222 C** CALLED IN FIRST CYCLE                                            LE0340
0223 C** CALLS ZSYSTM                                                     LE0340
0224 C           QFIRST    BEGSR                           ** SR-FIRST   *LE0340
     C**                                                                  S01117
     C**      IN THE DATAAREA RUNDAT                                      S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**      SETUP MULTIBRANCHING INDICATOR                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     60                   S01117
     C                     END                                            S01117
0225 C*********04          GOTO F1                                                     LE0340 CLE106
0226 C***********          SETON                     U7U8LR                            LE0340 CLE106
0227 C***********          MOVEL'SAIAD'   DBFILE           ***************             LE0340 CLE106
0228 C***********          MOVEL'01'      DBASE            *  D-BASE 01  *S01117
0228 C***********          Z-ADD1         DBASE            *  D-BASE 01  *             S01117 CLE106
0229 C***********          MOVEL'H'       DBKEY            ***************             LE0340 CLE106
0230 C***I.E.*IF*FIRST*RECORD*NOT*HEADER,*DATA*BASE*ERROR.****************             LE0340 CLE106
0231 C**-*END*PROCESSING                                                               LE0340 CLE106
0232 C***********                                                                      LE0340 CLE106
0233 C***********          GOTO FEND                                                   LE0340 CLE106
0234 C*                                                                   LE0340
0235 C           F1        TAG                             ** F1 TAG **   LE0340
0236 C***ACCESS*TABLES*FILE*TO*PICK*UP*I.C.REC.*                          LE0340
0236 C*  ACCESS SDBANKPD FILE TO PICK UP I.C.REC.                         LE0340
0237 C                     EXSR ZSYSTM                                    LE0340
0238 C*********99***       SETON                     U7U8LR               S01194
0239 C        N99          GOTO F2                                        LE0340
0240 C**************       MOVEL'TABLE'   DBFILE           ***************S01194
0241 C***********          MOVEL'02'      DBASE            *  D-BASE 02  *S01117
0242 C**************       MOVELZTABKY    DBKEY            ***************S01194
0243 C                     GOTO FEND                                      LE0340
0244 C           F2        TAG                               ** F2 TAG ***LE0340
0245 C*  INITIALISE FIELDS FOR LINE COUNT & RECORD COUNT                  LE0340
0246 C                     Z-ADD0         LINE    20                      LE0340
0247 C                     Z-ADD0         RECS    50                      LE0340
0247 C                     MOVEL*BLANKS   SEQ     5                                           CLE106
0248 C*                                                                   LE0340
0249 C***SET*UP*FIELDS FOR CHAINING CURRENCIES REC.                       S01194
0250 C**************       MOVEL'20      'CHKEY  12                       S01194
0251 C**************       MOVE '1'       W1      4                       S01194
0252 C                     SETON                     20                   LE0340
     C**                                                                  S01117
     C**      OPEN SPOOL FILE WHEN NON-MULTIBRANCHING                     S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                       85  ALLOW OUTPUT   S01117
     C                     OPEN LE0340P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     EXCPTHEADER                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
0253 C           FEND      ENDSR                                          LE0340
0254 C********************************************************************LE0340
0255 C** MAIN PROCESSING SUBROUTINE                                       LE0340
0256 C** CALLED EVERY CYCLE(FOR VALID RECORDS)                            LE0340
0257 C** CALLS GLZADD(FOR HASH TOTALS)                                    LE0340
0258 C*                                                                   LE0340
0259 C           JCALC     BEGSR                           ** SR-JCALC   *LE0340
0260 C*                                                                   LE0340
     C*    AT CHANGE OF BRANCH CODE EXECUTE PRINT                         S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *INL1     ANDEQ'1'                                       S01117
     C           BRSTR     IFNE *BLANKS                                   S01117
     C                     EXCPTENDREP                                    S01117
     C                     END                                            S01117
     C                     MOVE BRCA      BRSTR   3                       S01117
     C                     CLOSELE0340P1                                  S01117
     C                     SETON                       85  ALLOW OUTPUT   S01117
     C                     OPEN LE0340P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         LINE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  GET BRANCH NAME                                                 S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************** S01117
     C                     MOVEL@DSNB     DBKEY            * DBERROR 04 * S01117
     C                     Z-ADD4         DBASE            ************** S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     EXCPTHEADER                                    S01117
     C                     GOTO JEND                                      S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     EXCPTHEADER                                    S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C**                                                                  S01117
0261 C***ACCESS*TABLE*FILE*FOR*CURRENCIES*REC.                            S01194
     C*  ACCESS CURRENCY DETAILS                                          S01194
     C**                                                                  S01194
0262 C**************       MOVELCCY       W1                              S01194
0263 C**************       MOVE W1        CHKEY                           S01194
0264 C***********CHKEY     CHAINTABLE                30                   S01194
0265 C*****N08******       SETON                     30                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       TKEY    3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
0266 C                     SETON                     U7U8LR               S01194
0266 C*********30          SETON                     U7U8LR               S01194
0267 C********N30          GOTO J1                                        S01194
0268 C**************       MOVEL'TABLE'   DBFILE           ***************S01194
0269 C***********          MOVEL'03'      DBASE            *  D-BASE 03  *S01117
0483 C                     MOVE 'SDCURRPD'DBFILE           ***************S01194
0269 C                     Z-ADD3         DBASE            *  D-BASE 03  *S01117
0484 C                     MOVELCCY       DBKEY            ***************S01194
0270 C**************       MOVELCHKEY     DBKEY            ***************S01194
0271 C                     GOTO JEND                                      LE0340
     C                     END                                            S01194
0272 C*                                                                   LE0340
0273 C           J1        TAG                             ** J1 TAG **   LE0340
0274 C*                                                                   LE0340
0275 C*  INCREMENT HASH TOTALS                                            LE0340
0276 C************         MOVE MAAM      ZZAMT                                        LE0340 CLE106
0277 C************         EXSR GLZADD                                                 LE0340 CLE106
0278 C*  INCREMENT LINE & RECORD COUNTS.                                  LE0340
0279 C           LINE      ADD  1         LINE                            LE0340
      *                                                                   CAC001
      **  Increment record count only if Analytical Accounting is off     CAC001
      **  or Analytical Accounting is on and manual int. adj. not zero    CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           MAAM      ANDNE0                                         CAC001
     C           BGN0ST    OREQ 'Y'                                                           CAS005
     C           MAAM      ANDEQ0                                                             CAS005
     C           MASN      ANDNE*BLANKS                                                       CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           BGN0ST    ORNE 'Y'                                       CAC001
0280 C           RECS      ADD  1         RECS                            LE0340
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  If Analytical Accounting is available, add Accrued COF          CAC001
      **  Adjustment Amount to file controls                              CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CASN      IFNE *BLANK                                    CAC001
     C**********           MOVE ACAJ      ZZAMT                                        CAC001 CLE106
     C**********           EXSR GLZADD                                                 CAC001 CLE106
     C           RECS      ADD  1         RECS                            CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
      ** If CAS005 is installed, add Accrued NTR Adjustment                                   CAS005
      ** Amount to file controls                                                              CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MASN      IFNE *BLANKS                                                       CAS005
     C**********           MOVE MAAN      ZZAMT                                        CAS005 CLE106
     C**********           EXSR GLZADD                                                 CAS005 CLE106
     C           RECS      ADD  1         RECS                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CAC001
0281 C* CHECK DECIMAL POSITIONS TO EDIT CURRENCY.                         LE0340
0282 C           CDP       COMP 1                      3233               LE0340
0283 C           CDP       COMP 2                    35  34               LE0340
0284 C*                                                                   LE0340
     C**                                                                  S01117
     C   05N50             EXCPTDETAIL                                    S01117
0285 C*                                                                   LE0340
0286 C           JEND      ENDSR                                          LE0340
0287 C********************************************************************LE0340
0288 C********************************************************************LE0340
0289 C**                                                                  LE0340
0290 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE0340
0291 C**                                                                  LE0340
0292 C           ZSYSTM    BEGSR                           *** ZSYSTM *** LE0340
0293 C**************                                                      S01194
0294 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0295 C**************       MOVEL'01      'ZTABKY 12                       S01194
0296 C**************       MOVE '  10'    ZTABKY                          S01194
0297 C**************                                                      S01194
0298 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0299 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 02  *S01194
     C                     Z-ADD2         DBASE            ***************S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDZSY                                    S01194
     C                     END                                            S01194
0300 C**                                                                  LE0340
0301 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    LE0340
0302 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0303 C**                                                                  LE0340
     C           ENDZSY    ENDSR                                          S01194
     C**************       ENDSR                                          S01194
0305 C**                                                                  LE0340
0306 C**                                                                  LE0340
0307 C********************************************************************LE0340
0308 C*                                                                   LE0340
0309 C********************************************************************LE0340
0310 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0340
0311 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0340
0312 C*                                                                   LE0340
0313 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0340
0314 C*                                                                   LE0340
0315 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0340
0316 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0340
0317 C*                                                                   LE0340
0318 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0340
0319 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0340
0320 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0340
0321 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0340
0322 C*                                                                   LE0340
0323 CSR                   EXSR GLZSUM                                    LE0340
0324 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0340
0325 C*                                                                   LE0340
0326 C********************************************************************LE0340
0327 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0340
0328 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0340
0329 C*          PARAMETERS PASSED -                                      LE0340
0330 C*                     I/P ZZAMTI ZZAMTD                             LE0340
0331 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0340
0332 C*                                                                   LE0340
0333 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0340
0334 C*                                                                   LE0340
0335 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0340
0336 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0340
0337 CSR                   SETOF                     919293               LE0340
0338 CSR                   SETOF                     949599               LE0340
0339 C*                                                                   LE0340
0340 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0340
0341 CSR         ZZAMTI    COMP 0                      9293               LE0340
0342 CSR 93      ZZAMTD    COMP 0                      9293               LE0340
0343 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0340
0344 C*                                                                   LE0340
0345 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0340
0346 CSR         ZZTOTI    COMP 0                      9193               LE0340
0347 CSR 93      ZZTOTD    COMP 0                      9193               LE0340
0348 C*                                                                   LE0340
0349 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0340
0350 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0340
0351 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0340
0352 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0340
0353 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0340
0354 CSR 91N92                                                            LE0340
0355 CORN91 92             GOTO ZZOFPS                                    LE0340
0356 C*                                                                   LE0340
0357 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0340
0358 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0340
0359 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0340
0360 C*                                                                   LE0340
0361 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0340
0362 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0340
0363 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0340
0364 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0340
0365 C*                                                                   LE0340
0366 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0340
0367 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0340
0368 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0340
0369 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0340
0370 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0340
0371 C*                                                                   LE0340
0372 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0340
0373 CSR 99                Z-ADD0         ZZAMT  153                      LE0340
0374 CSR                   GOTO ZZSEND                                    LE0340
0375 C*                                                                   LE0340
0376 C* THE 'SIGNS' ARE DIFFERENT                                         LE0340
0377 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0340
0378 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0340
0379 C*                                                                   LE0340
0380 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0340
0381 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0340
0382 C*                                                                   LE0340
0383 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0340
0384 C*                                                                   LE0340
0385 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0340
0386 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0340
0387 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0340
0388 C*                                                                   LE0340
0389 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0340
0390 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0340
0391 C*                                                                   LE0340
0392 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0340
0393 CSR 95                Z-ADD0         ZZTOTI                          LE0340
0394 CSR 95                Z-ADD0         ZZTOTD                          LE0340
0395 CSR 95                GOTO ZZSEND                                    LE0340
0396 C*                                                                   LE0340
0397 C* IF ZZTOT GT. ZZAMT.                                               LE0340
0398 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0340
0399 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0340
0400 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0340
0401 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0340
0402 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0340
0403 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0340
0404 C*                                                                   LE0340
0405 C*                                                                   LE0340
0406 C* IF ZZAMT GT. ZZTOT.                                               LE0340
0407 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0340
0408 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0340
0409 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0340
0410 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0340
0411 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0340
0412 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0340
0413 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0340
0414 C*                                                                   LE0340
0415 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0340
0416 CSR                   SETOF                     94                   LE0340
0417 CSR 93 91                                                            LE0340
0418 CORN93 92             SETON                     94                   LE0340
0419 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0340
0420 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0340
0421 C**                                                                  LE0340
0422 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0340
0423 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0340
0424 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0340
0425 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0340
0426 C**                                                                  LE0340
0427 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0340
0428 CSR                   SETOF                     96                   LE0340
0429 CSR         ZZTOTD    COMP 0                        91               LE0340
0430 CSR 91      ZZTOTI    COMP 0                      96                 LE0340
0431 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0340
0432 CSR                   ENDSR                             ** ENDSR **  LE0340
0433 C********************************************************************LE0340
     C********************************************************************S01117
     C*                                                                   S01117
     C*    SUBROUTINE : #ZZ                                               S01117
     C*                                                                   S01117
     C*    CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCLATIONS IF     S01117
     C*    THE P1 FILES HAVE NOT ALREADY BEEN OPENDED (IE, IF THERE ARE   S01117
     C*    NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)     S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C                     IN   RUNDT                                                         242056
     C                     EXSR ZSYSTM                                                        242056
      *                                                                                       242056
     C**   OPEN P1 SPOOL FILE                                             S01117
     C                     OPEN LE0340P1                                  S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     EXCPTHEADER                                    S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
0434 O*E0340P1E*3101   25                                        S01124   S01117
     OLE0340P1E 3101           HEADER                                     S01117
0435 O*******OR**      U7 U8                                              S01117
0435 O*******OR**      L1                                        E11890   S01117
0436 O                                   14 'REFERENCE'                   LE0340
0437 O***********                        22 'LE0340'                      S01117
0437 O                                   24 'LE0340P1'                    S01117
0438 O                         TITL      89                               LE0340
0439 O                                  104 'DATE'                        LE0340
0440 O                         RUNA     113                               LE0340
0441 O                                  122 'PAGE'                        LE0340
0442 O                         PAGE  Z  127                               LE0340
0443 O*E0340P1E*1      25                                        S01124   S01117
0444 O*******OR**      U7 U8                                              S01117
0435 O*******OR**      L1                                        E11890   S01117
0445 O***********                        11 'BRANCH'                      S01117
0446 O***********              BRCD      16                               S01117
0447 O***********                        53 'ADJUSTMENTS TO ACCRUED'      S01117
0448 O***********                        74 'INTEREST INPUT TODAY'        S01117
0449 O***********                        91 '- CUSTOMER LOANS'            S01117
     OLE0340P1E 1              HEADER                                     S01117
0447 O                                   41 'ADJUSTMENTS TO ACCRUED'      S01117
0448 O                                   62 'INTEREST INPUT TODAY'        S01117
0449 O                                   79 '- CUSTOMER LOANS'            S01117
     O                       60          92 'BRANCH'                      S01117
     O                       60BRCA      96                               S01117
     O                       60          97 '-'                           S01117
     O                       60BRNM     127                               S01117
0450 O********E*12        25                                              S01117
0451 O*******OR**      U7 U8                                              S01117
0435 O*******OR**      L1                                        E11890   S01117
0452 O***********                        53 '----------------------'      S01117
0453 O***********                        74 '---------------------'       S01117
0454 O***********                        91 '-----------------'           S01117
     OLE0340P1E 12             HEADER                                     S01117
0452 O                                   41 '----------------------'      S01117
0453 O                                   62 '---------------------'       S01117
0454 O                                   79 '-----------------'           S01117
0455 O*E0340P1E*1      25                                        S01124   S01117
0456 O*******OR**      U7 U8                                              S01117
0435 O*******OR**      L1                                        E11890   S01117
     OLE0340P1E 1              HEADER                                     S01117
0457 O***********                       103 'ADJUSTMENT'           LE0340 CAC001
     O                N11               103 'ADJUSTMENT'                  CAC001
     O                 11                94 'ADJUSTMENT'                  CAC001
     O                 11               116 'ADJ. TO ACCRUED'             CAC001
0458 O*E0340P1E*11     25                                        S01124   S01117
0459 O*******OR**      U7 U8                                              S01117
0435 O*******OR**      L1                                        E11890   S01117
     OLE0340P1E 11             HEADER                                     S01117
0460 O***********                        21 'BORROWER'             LE0340 CAC001
0461 O***********                        65 'FACILITY REF'         LE0340 CAC001
0462 O***********                        76 'LOAN'                 LE0340 CAC001
0463 O***********                        84 'CCY'                  LE0340 CAC001
0464 O***********                       101 'AMOUNT'               LE0340 CAC001
0465 O***********                       117 'TIME'                 LE0340 CAC001
     O                N11                21 'BORROWER'                    CAC001
     O                N11                65 'FACILITY REF'                CAC001
     O                N11                76 'LOAN'                        CAC001
     O                N11                84 'CCY'                         CAC001
     O                N11               101 'AMOUNT'                      CAC001
     O                N11               117 'TIME'                        CAC001
     O                 11                15 'BORROWER'                    CAC001
     O                 11                58 'FACILITY REF'                CAC001
     O                 11                69 'LOAN'                        CAC001
     O                 11                78 'CCY'                         CAC001
     O                 11                92 'AMOUNT'                      CAC001
     O                 11               117 'COST OF FUNDS/SIGN'          CAC001
     O                 11               125 'TIME'                        CAC001
0466 O*E0340P1E*11     05N50                                     S01124   S01117
     OLE0340P1E 11             DETAIL                                     S01117
0467 O***********              CNUM      14                        LE0340 CAC001
0468 O***********              CRNM      37                        LE0340 CAC001
0469 O***********              CTWN      48                        LE0340 CAC001
0470 O***********              FCRF      64 '      /   /  '        LE0340 CAC001
0471 O***********              LNRF      76                        LE0340 CAC001
0472 O***********              CCY       84                        LE0340 CAC001
0473 O***********            32MAAM     103 ' ,   ,   ,   , 0 '    LE0340 CAC001
0474 O***********            33MAAM     103 '   ,   ,   , 0 . '    LE0340 CAC001
0475 O***********            34MAAM     103 '  ,   ,   , 0 .  '    LE0340 CAC001
0476 O***********            35MAAM     103 ' ,   ,   , 0 .   '    LE0340 CAC001
0477 O***********              SIGN     104                        LE0340 CAC001
0478 O***********              UDTM     119 '  .  .  '             LE0340 CAC001
     O                N11      CNUM      14                               CAC001
     O                N11      CRNM      37                               CAC001
     O                N11      CTWN      48                               CAC001
     O***********     N11      FCRF      64 '      /   /  '               CAC001              CSD027
     O                N11      ##FC1     57                                                   CSD027
     O                N11                58 '/'                                               CSD027
     O                N11      ##FC2     61                                                   CSD027
     O                N11                62 '/'                                               CSD027
     O                N11      ##FC3     64                                                   CSD027
     O                N11      LNRF      76                               CAC001
     O                N11      CCY       84                               CAC001
     O                N11    32MAAM     103 ' ,   ,   ,   , 0 '           CAC001
     O                N11    33MAAM     103 '   ,   ,   , 0 . '           CAC001
     O                N11    34MAAM     103 '  ,   ,   , 0 .  '           CAC001
     O                N11    35MAAM     103 ' ,   ,   , 0 .   '           CAC001
     O                N11      SIGN     104                               CAC001
     O                N11      UDTM     119 '  .  .  '                    CAC001
     O                 11      CNUM       8                               CAC001
     O                 11      CRNM      31                               CAC001
     O                 11      CTWN      42                               CAC001
     O***********      11      FCRF      58 '      /   /  '               CAC001              CSD027
     O                 11      ##FC1     51                                                   CSD027
     O                 11                52 '/'                                               CSD027
     O                 11      ##FC2     55                                                   CSD027
     O                 11                56 '/'                                               CSD027
     O                 11      ##FC3     58                                                   CSD027
     O                 11      LNRF      70                               CAC001
     O                 11      CCY       78                               CAC001
     O                 11    32MAAM      97 ' ,   ,   ,   , 0 '           CAC001
     O                 11    33MAAM      97 '   ,   ,   , 0 . '           CAC001
     O                 11    34MAAM      97 '  ,   ,   , 0 .  '           CAC001
     O                 11    35MAAM      97 ' ,   ,   , 0 .   '           CAC001
     O                 11      SIGN      98                               CAC001
     O                 11    32ACAJ     117 ' ,   ,   ,   , 0 '           CAC001
     O                 11    33ACAJ     117 '   ,   ,   , 0 . '           CAC001
     O                 11    34ACAJ     117 '  ,   ,   , 0 .  '           CAC001
     O                 11    35ACAJ     117 ' ,   ,   , 0 .   '           CAC001
     O                 11      CASN     118                               CAC001
     O                 11      UDTM     127 '  .  .  '                    CAC001
0479 O        T 31     LR U7 U8                                           LE0340
0480 O                                   42 '*** REFERENCE'               LE0340
0481 O                                   51 'LE0340'                      LE0340
0482 O                                   71 '- DATABASE ERROR   '         S01117
     O        T 31     LR 27NU7                                           S01117
     O                                   76 '* NO DETAILS TO REPORT *'    S01117
     O        T 3      LR 27NU7                                           S01117
     O       OR        LRN27N60                                                               242056
     O                                   76 '*** END OF REPORT ***'       S01117
     O        T 3      LRN27 60                                                               242056
     O                                   66 '*** END OF REPORT FOR'                           242056
     O                                   74 'BRANCH '                                         242056
     O                         BRSTR     77                                                   242056
     O                                   81 '***'                                             242056
      *                                                                   S01117
0482 O***********                        71 '- DATABASE ERROR AT'         S01117
0483 O***********              DBASE     74                               S01117
0484 O********T*1      LR U7 U8                                           S01117
0485 O***********                        37 'FILE NAME'                   S01117
0486 O***********              DBFILE    43                               S01117
0487 O***********                        48 'KEY'                         S01117
0488 O***********              DBKEY     78                               S01117
     O        E 3      L1 60   ENDREP                                     S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 'BRANCH '                     S01117
     O                         BRSTR     77                               S01117
     O                                   81 '***'                         S01117
     O        E 3      LRN27N60ENDREP                                     S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0489 O*E0340P1T*3101   LR                                        S01124   S01117
     O*LE0340AUT*3101***LR                                                             S01117 CLE106
0490 O***********                        14 'REFERENCE'                                LE0340 CLE106
0491 O***********                        22 'LE0340'                      S01117
0491 O***********                        24 'LE0340AU'                                 S01117 CLE106
0492 O***********              TITL      89                                            LE0340 CLE106
0493 O***********                       104 'DATE'                                     LE0340 CLE106
0494 O***********              RUNA     113                                            LE0340 CLE106
0495 O***********                       122 'PAGE'                                     LE0340 CLE106
0496 O***********              PAGE  Z  127                                                   S01117
0496 O***********              PAGE1 Z  127                                            S01117 CLE106
0497 O********T*1      LR                                                              LE0340 CLE106
0498 O***********                        53 'ADJUSTMENTS TO ACCRUED'                   LE0340 CLE106
0499 O***********                        67 'INTEREST INPU'                            LE0340 CLE106
0500 O***********                        90 'T TODAY - FILE CONTROLS'                  LE0340 CLE106
0501 O********T*13        LR                                                           LE0340 CLE106
0502 O***********                        53 '----------------------'                   LE0340 CLE106
0503 O***********                        68 '---------------'                          LE0340 CLE106
0504 O***********                        90 '------------------------'                 LE0340 CLE106
0505 O********T*1      LR                                                              LE0340 CLE106
0506 O***********                        13 'S/SAIAD'                                  LE0340 CLE106
0507 O***********                        28 '- RUN CONTROLS'                           LE0340 CLE106
0508 O***********                        59 'NUMBER'                                   LE0340 CLE106
0509 O***********                        84 'VALUE'                                    LE0340 CLE106
0510 O********T*11     LR                                                              LE0340 CLE106
0511 O***********                        28 '----------------------'                   LE0340 CLE106
0512 O***********                        59 'OF RECORDS'                               LE0340 CLE106
0513 O***********                        84 'OF RECORDS'                               LE0340 CLE106
0514 O********T*11     LR                                                              LE0340 CLE106
0515 O***********                        29 'TOTAL RECORDS ON FILE'                    LE0340 CLE106
0516 O***********              RECTOT3   59                                            LE0340 CLE106
0517 O***********              FIRST Z   81                                            LE0340 CLE106
0518 O***********              LAST      84                                            LE0340 CLE106
0519 O*                                                                   LE0340
0520 O*                                                                   LE0340
0521 O*E0340P1T*11     LR                                        S01124   S01117
     O********T*11     LR                                                              S01117 CLE106
0522 O***********                        29 'TOTAL RECORDS ON FILE'                    LE0340 CLE106
0523 O***********                        42 '- CALCULATED'                             LE0340 CLE106
0524 O***********              RECS  3   59                                            LE0340 CLE106
0525 O***********              ZZTOTIZ   81                                            LE0340 CLE106
0526 O***********              ZZTOTD    84                                            LE0340 CLE106
0527 O***********            28         111 '***   DIFFERENCE   ***'                   LE0340 CLE106
0528 O***********            29         111 '***   DIFFERENCE   ***'                   LE0340 CLE106
     O********T*31     LR 27NU7                                                        S01117 CLE106
     O***********                        76 '* NO DETAILS TO REPORT *'                 S01117 CLE106
     O********T*31     LR U7 U8                                                        S01117 CLE106
     O***********                        51 '*** REFERENCE LE0340'                     S01117 CLE106
     O***********                        71 '- DATABASE ERROR AT'                      S01117 CLE106
     O***********              DBASE     75                                            S01117 CLE106
     O********T 1      LR U7 U8                                                        S01117 CLE106
     O***********                        37 'FILE NAME'                                S01117 CLE106
     O***********              DBFILE    46                                            S01117 CLE106
     O***********                        51 'KEY'                                      S01117 CLE106
     O***********              DBKEY     81                                            S01117 CLE106
0529 O*E0340P1T*3      27                                        S01124   S01117
0530 O***********                        76 '*** NO DETAILS TO REPORT'    S01117
0531 O***********                        80 '***'                         S01117
0532 O*E0340P1T*3      LR                                        S01124   S01117
0533 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
