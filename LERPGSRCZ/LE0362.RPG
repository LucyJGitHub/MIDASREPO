0001 H                                                                    LE0362
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Loan Base Rate Changes Update')
0002 F********************************************************************LE0362
     F*  Midas Customer Lending Module                                LE0362
0004 F*                                                                  *LE0362
0005 F*        LE0362 - LOANS BASE RATE CHANGES UPDATE                   *LE0362
0006 F*                                                                  *LE0362
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                                  *LE0362
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
0009 F*       LAST AMEND. NO. CAP038      DATE 17MAR2000                 *LE0362
      * Midas DBA 3.00 ---------------- Base -------------------------*
0009 F*       PREV AMEND. NO. S01194      DATE  2MAR90                   *LE0362
0010 F*                   NO. S01117      DATE  2MAR90                   *LE0362
0011 F********************************************************************LE0362
     F*       CAP038 - Conversion of SD inputs into modular structure
     F*                to use as APIs.
     F*                (recompiled)
     F*       S01194  -  NEW STANDING DATA
     F*       S01117  -  RELEASE TEN - LDA POSITION CHANGES
0011 F********************************************************************LE0362
0012 F*                                                                  *LE0362
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0014 F*TABLE***UF  F      96 12AI     2 DISK                              S01194
0014 FTABLETK UF  E                    DISK                               S01194
0014 FSDBSRTPDUF  E                    DISK                               S01194
0015 F*                                                                   LE0362
0016 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0362
0017 F**01********    TABLE - INSTALLATION CONTROL DATA RECORD 1          S01194
0018 F**02********          - BASE RATE DETAIL RECORD                     S01194
0019 F**03********          - CATCHALL                                    S01194
0020 F********40**    END OF TABLE FOR ICD 1 READ                         S01194
0021 F*       41      END OF TABLE FOR BASE RATE READ
0022 F********42**    TABLE FILE RECORD TYPE NOT 21                       S01194
0023 F*       43      VALUE DATE OF NEW RATE CHANGE IS LESS THAN OR EQUAL LE0362
0024 F*               TO RUN DATE                                         LE0362
0025 F*        U7+U8  DATABASE ERROR                                      LE0362
0026 F*        U8     FILE CONTROLS OUT OF BALANCE                        LE0362
0029 F*                                                                   LE0362
     E                    CPY@    1   1 80
0031 I*                                                                   LE0362
0032 I**********TABLE*FILE*ICD.1*                                         S01194
0033 I***********                                                         S01194
0034 I*TABLE***NS  01   1 CD   2 C0   3 C1                                S01194
0035 I*******AND*     12 C1  13 C0                                        S01194
0036 I**********                              1   1 RECI                  S01194
0037 I**********                              2   30RECT                  S01194
0038 I**********                             12  130RCDE                  S01194
0039 I**********                             14  66 TITL                  S01194
0040 I**********                             67  67 DATF                  S01194
0041 I**********                             68  700DFBR                  S01194
0042 I**********                             74  74 MODI1                 S01194
0043 I**********                             75  75 MODI2                 S01194
0044 I**********                             76  76 MODI3                 S01194
0045 I**********                          P  77  790RUND                  S01194
0046 I**********                             80  86 RUNA                  S01194
0047 I**********                             87  870SFLG                  S01194
0048 I**********                          P  90  920LCD                   S01194
0049 I**********                             93  93 CHTP                  S01194
0050 I**********                          P  94  960TNLU                  S01194
0051 I**********                                                          S01194
0052 I*****TABLE*FILE***BASE*RATE*RECORD*                                 S01194
0053 I**********                                                          S01194
0054 I********NS  02   1 CD   2 C2   3 C1                                 S01194
0055 I**********                              1   1 RECI                  S01194
0056 I**********                              2   30RECT                  S01194
0057 I**********                              9  11 CCY                   S01194
0058 I**********                             12  130BRTT                  S01194
0059 I**********                          P  14  197BRTE                  S01194
0060 I**********                          P  20  220VDRC                  S01194
0061 I**********                             23  23 RCIN                  S01194
0062 I**********                             24  53 BRTN                  S01194
0063 I**********                          P  54  597NBRT                  S01194
0064 I**********                          P  60  620VDNR                  S01194
0065 I**********                          P  90  920LCD                   S01194
0066 I**********                             93  93 CHTP                  S01194
0067 I**********                          P  94  960TNLU                  S01194
0068 I**********                                                          S01194
0069 I**********                                                          S01194
0070 I******CATCHALL                                                      S01194
0071 I**********                                                          S01194
0072 I********NS  03                                                      S01194
0073 I**********                              1   1 RECI                  S01194
0074 I**********                              2   30RECT                  S01194
0075 I**********                                                          S01194
0076 I**      LOCAL DATA AREA FOR DATABASE ERROR REFERENCES               LE0362
0077 I*                                                                   LE0362
0078 ILDA        UDS                            256                       LE0362
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
0083 I*                                                                   LE0362
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
0084 I********************************************************************LE0362
     C                     MOVEACPY@      BIS@   80
0085 C*                                                                   LE0362
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' RTCD    7                       S01194
     C                     PARM '*FIRST ' OPTN    7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
0086 C                     SETON                     LR                   LE0362
0087 C*                                                                   LE0362
0088 C*       ACCESS INSTALLATION CONTROL DATA RECORD 1                   LE0362
0089 C*                                                                   LE0362
0090 C***********          MOVEL'01      'TABKEY 12                       S01194
0091 C***********          MOVE '  10'    TABKEY                          S01194
0092 C***********TABKEY    SETLLTABLE                                     S01194
0093 C***********          READ TABLE                    40               S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           RTCD      IFNE *BLANKS                                   S01194
     C                     MOVE 'LE0362  'DBPGM                           S01194
     C                     Z-ADD1         DBASE                           S01194
     C                     MOVE 'SDBANKPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0094 C*                                                                   LE0362
0095 C*   DATABASE ERROR IF NOT ON I.C.D.1                                LE0362
0096 C*                                                                   LE0362
0097 C**N01******                                                         S01194
0098 C*OR*40*****           SETON                     U7U8                S01194
0099 C***U7*U8***          MOVE 'LE0362  'DBPGM                           S01194
0100 C***U7*U8***          MOVE '01'      DBASE                           S01194
0101 C***U7*U8***          MOVE 'TABLE'   DBFILE                          S01194
0102 C***U7*U8***          MOVE TABKEY    DBKEY                           S01194
0103 C***U7*U8***          GOTO END                                       S01194
0104 C*                                                                   LE0362
0105 C********** ACCESS BASE RATES TABLE                                  S01194
0106 C**********                                                          S01194
0107 C**********           MOVEL'21      'TABKEY                          S01194
0108 C**********           MOVE '    '    TABKEY                          S01194
0109 C********** TABKEY    SETLLTABLE                                     S01194
0110 C*                                                                   LE0362
0111 C           READ      TAG                             ** READ TAG ** LE0362
0112 C*                                                                   LE0362
0113 C**********           SETOF                     0203                 S01194
0114 C**********           READ TABLE                    41               S01194
0114 C                     READ TABLETK                  41               S01194
0115 C***03******RECT      COMP 21                   4242                 S01194
0116 C***41******                                                         S01194
0117 C*OR*03*42**           GOTO END                                      S01194
0118 C***03******          GOTO READ                                      S01194
0116 C   41                GOTO READ2                                     S01194
0119 C*                                                                   LE0362
0120 C**      CHECK CUSTOMER LENDING LOANS RECORDS TO BE GENERATED        LE0362
0121 C**       INDICATOR AND VALUE DATE OF NEW RATE CHANGE                LE0362
0122 C*                                                                   LE0362
0123 C                     TESTB'6'       RCIN           43               LE0362
0124 C***43******VDNR      COMP RUND                   4343               S01194
0124 C   43      VDNR      COMP BJRDNB                 4343               S01194
0125 C*                                                                   LE0362
0126 C*   IF CONDITIONS SATISFIED SET OFF INDICATOR AND OUTPUT TO TABLE FILE0362
0127 C*                                                                   LE0362
0128 C   43                BITOF'6'       RCIN
0129 C**********           EXCPT                                          S01194
0129 C                     EXCPTTABLE                                     S01194
0130 C                     GOTO READ                                      LE0362
0131 C*                                                                   LE0362
      ** REPEAT PROCESSING FOR NEW STANDING DATA FILES                    S01194
0131 C*                                                                   S01194
0111 C           READ2     TAG                             ** READ2 TAG **S01194
0112 C*                                                                   S01194
0114 C                     READ SDBSRTPD                 41               S01194
0116 C   41                GOTO END                                       S01194
0119 C*                                                                   S01194
0120 C**      CHECK CUSTOMER LENDING LOANS RECORDS TO BE GENERATED        S01194
0121 C**       INDICATOR AND VALUE DATE OF NEW RATE CHANGE                S01194
0122 C*                                                                   S01194
0123 C           BACSLR    COMP 'Y'                      43               S01194
0124 C   43      BAVDNR    COMP BJRDNB                 4343               S01194
0125 C*                                                                   S01194
0126 C*   IF CONDITIONS SATISFIED SET OFF INDICATOR AND OUTPUT TO TABLE FIS01194
0127 C*                                                                   S01194
0123 C   43                MOVE 'N'       BACSLR                          S01194
0129 C                     EXCPTSDBSRT                                    S01194
0130 C                     GOTO READ2                                     S01194
0131 C*                                                                   S01194
0132 C           END       TAG                             ** END TAG **  LE0362
0133 C*                                                                   LE0362
0134 C********************************************************************LE0362
0135 O*                                                                   LE0362
0136 O*TABLE***E*                                                         S01194
0137 O***********              RCIN      23                               S01194
0136 OTABLETKFE                TABLE                                      S01194
0137 O                         RCIN                                       S01194
     O*                                                                   S01194
0136 OSDBSRTD0E                SDBSRT                                     S01194
0137 O                         BACSLR                                     S01194
0135 O*                                                                   S01194
0134 O********************************************************************S01194
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
