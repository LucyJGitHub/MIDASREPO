     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Reversed Loans History Report')               *
     F********************************************************************
     F*  Midas - Customer Lending Module
     F*                                                                  *
     F*    LE0380 - REVERSED LOANS HISTORY REPORT                        *
     F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *
      *  Last Amend No. 260891             Date 17Dec12               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE036             Date 22Sep03               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CLE015             Date 13Dec01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 185785             Date 04Dec00                  *
      * Midas DBA 3.00 ---------------- Base ----------------------------*
     F*                 CEU020             Date 13Mar98                  *
     F*                 CLE006             Date 02Dec96                  *
     F*                 CLE004             Date 02Dec96                  *
     F*                   118463                DATE 16SEP97             *
     F*                   CAC001                DATE 13AUG96             *
     F*                   093584                DATE 28FEB96             *
     F*                   S01408                DATE 07NOV95             *
     F*                   090739                DATE 21JUL95             *
     F*                   S01392                DATE 01OCT92             *S01270
     F*                   S01270                DATE 06AUG90             *S01270
     F*                   S01194                DATE 03JAN90             *S01194
     F*                   S01117                DATE 21/06/89            *S01117
     F*                   E15649                DATE 30/11/88            *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  260891 - Wrong projection in LOAC. Add LCD as a key.         *
      *           Recompiled due to changes in LF/HISTR.              *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CLE036 - LE Enh for Nordea Phase 1 Pty 2- Specific Base Rate *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
     F*  CLE015 - Functionality moved from Syndicated Lending to         *
     F*           Customer Lending                                       *
     F*  185785 - Field CCY is shown twice in report.                    *
     F*  CEU020 - EMU LE Multi-currency Rollover                         *
     F*  CLE006 - Customer Lending Enhancements - Rollovers              *
     F*  CLE004 - Customer Lending Enhancements - Syndications           *
     F*    118463 - Reversed loan history did not show repayments -      *
     F*             indicators were not set up for ccy decimal places.   *
     F*             Apply 117816.                                        *
     F*  CAC001 - Profit Centre Accounting Development:                  *
     F*           Spread/Rate changes('SC') and Manual Adjustments('MI') *
     F*           only reported for interest.  No funding details        *
     F*           are shown on the report .                              *
     F*    093584 - Unable to change form length of spool file output    *
     F*             by changing printer file - remove Line specs.        *
     F*    S01408 - Core hook added LE0380FFP1                           *
     F*             Core hook added LE0380FFP2                           *
     F*             Core hook added LE0380LLP1                           *
     F*             Core hook added LE0380LLP2                           *
     F*    090739 - COB report (LE0380P1) should not show                *
     F*             blank branch code if no detail to report.            *
     F*    S01392 - JAPANESE SUB MODULE ENHANCEMENTS                     *S01392
     F*    S01270 - CUSTOMER LENDING CHANGES                             *S01270
     F*    S01194 - STANDING DATA CHANGES.                               *
     F*    S01117 - MULTIBRANCHING                                       *S01117
     F*    E15649 - HEADINGS NOT OUTPUT TO STANDARD                      *E15649
     F*                                                                  *
     F*****************************************************************
     F*VLNS***IP* F      80  7AI     2 DISK                               S01117
     F***RVLNS***IP  F      83  7AI     2 DISK                     S01117 CLE006
     F*RVLNS***IP**F******85  7AI     2 DISK                                           CLE006 CLE042
     FRVLNS   IP  F      94  7AI     2 DISK                                                   CLE042
     F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     F*CLINT***IF  F     256  7AI     2 DISK                              S01194
     F****HISTR***IF**F     100 20AI     3 DISK                           CAC001
     F***HISTR***IF  F     118 20AI     3 DISK                     CAC001 CLE006
     F***HISTR***IF  F     152 20AI     3 DISK                                         CLE006 CLE028
     F*HISTR***IF**F*****185 20AI     3 DISK                                           CLE028 CLE042
     FHISTR   IF  F     231 20AI     3 DISK                                                   CLE042
     F*                                                                   CLE006
     F*E0380P1O** F     132     OF    LPRINTER                  S01124    S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0380FFP1                                           S01408
     F*                                                                   S01408
     F*E0380P1O***F*****132     OF    LPRINTER      KINFDS SPOOL    S01117093584
     FLE0380P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  093584
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0380FFP2                                           S01408
     F*                                                                   S01408
     FLE0380AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F* 01            REVERSED LOANS FILE - HEADER
     F* 02                                - LIVE 'D'
     F* 03                                - TRAILER
     F**04******      TABLE FILE - INST.CONTROL DATA RECORD 1             S01194
     F**05******                  - CURRENCIES RECORD 1                   S01194
     F**06******      CUSTOMER MASTER - DETAIL RECORD A                   S01194
     F* 07            HISTORY FILE - LOAN HEADER    'A'
     F* 08                         - DETAIL AMOUNT 'D'
     F* 09                         - DETAIL RATES  'E'
     F*       22      PREMIUM LOAN
     F*       23      DISCOUNTED LOAN
     F*       24      0 DECIMAL PLACE CURRENCY
     F*       25      1 DECIMAL
     F*       26      2 DECIMALS
     F*       27      3 DECIMALS
      *    30          CEU020 is switched *ON                         *  CEU020
     F*    31          CLE004 is switched *ON                         *
     F*****32***       CLE006 is switched *ON                         *  CLE015
     F*    32          CLE006 or CLE007 is *ON                        *  CLE015
     F*    33          Print 'From-to currency' report field          *
     F*    34          Do not print 'amount' column                   *
     F*       35      NO DETAIL RECORDS
     F*       39      OVERFLOW ON EXCEPTION PRINT
     F*       40      FIRST CYCLE ONLY PROCESSING
     F*       41      NO HISTORY FOR LOAN
     F*       42      NEW LOAN - OUTPUT HEADINGS
     F*       43      HASH AMOUNT IS NEGATIVE
     F*       44      DATABASE ERROR - NO LIVE HISTORY RECORD
     F*       46      END OF HISTORY RECORDS FOR LOAN
     F********47      DATABASE ERROR - TABLE FILE                         S01194
     F*       48      VALUE DATE > ZERO (HEADER)
     F*       49      MATURITY DATE > ZERO
     F*       50      EXPECTED DATE > ZERO
     F*       51      VALUE DATE > ZERO (DETAIL)
     F*       52      'ADD' SPREAD INDICATOR
     F*       53      'SUBTRACT'
     F*       54      'PERCENTAGE'
     F*       55      'AMOUNT' ON OUTPUT LINE EDITED FOR RATES - 7 DEC,
     F*       56      SORTS OUT AMENDMENT TYPE
     F*       57      PRINT A DETAIL LINE BY EXCEPTION
     F*       58      PRINCIPAL AMOUNT - ZERO
     F*       59      PRINCIPAL AMOUNT - > ZERO
     F*       60      TO SUPPRESS 'DAY PAST DUE' IF FEE LINE
     F*       62      PRINCIPAL AMOUNT - > ZERO
     F*       63      REPAYMENT IS PAST DUE
     F*       64      PRINT EXTRA FIELDS FOR MATURITY REPAYMENT
     F*       65      INTEREST AMOUNT - > ZERO
     F*       66      WITHOLDING TAX  - > ZERO
     F*       67      FEE AMOUNT - > ZERO
     F*       68      PRINCIPAL AMOUNT - > ZERO
     F*       69      INTEREST AMOUNT - > ZERO
     F*       70      WITHOLDING TAX - > ZERO
     F*       71      BASE RATE - > ZERO
     F*       72      BASE RATE - ZERO
     F*       73      SPREAD - > OR = ZERO
     F*       74      SPREAD - > ZERO
     F*       75      ST ACCRUAL IND IS 'Y'
     F*       76      ST ACCRUAL IND IS BLANK
     F*       77      BASE RATE IS > ZERO
     F*       78      BASE RATE IS = ZERO
     F*       79      SPREAD - > ZERO
     F*       80      SPREAD - > ZERO
     F*       81      Base Rate code is 0                                                     CLE036
     F*       83      DIFFERENCE DETECTED
     F*       85      REPORT FILE OPENED IN FIRST PROCESSING CYCLE        S01117
     F*       88      MBIN = Y                                            S01117
     F*       89      CONDITIONS PRINT OF LOAN TYPE / SUBTYPE CHANGE      S01270
     F*       90      DATABASE ERROR - NO CHAIN ON HISTORY FILE
     F*       98      MMDDDYY FORMAT
     F*          U7   DATABASE ERROR
     F*          U8   DATABASE ERROR
     F*             LR LAST RECORD
     F*             OF OVERFLOW
     E********************************************************************
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E********************NARR    1  30 30               NARRATIVES       S01270
     E***********         NARR    1  31 30               NARRATIVESS01270 CLE004
     E**********          NARR    1  34 30                                             CLE004 CLE028
     E                    NARR    1  36 30                                                    CLE028
     E****************************************************************
     E                    CPY@    1   1 80
     L*                                                                   S01408
     L/COPY WNCPYSRC,LE0380LLP1                                           S01408
     L*                                                                   S01408
     L*LE0380P1*66FL*56OL******                                     S01124093584
     L*                                                                   S01408
     L/COPY WNCPYSRC,LE0380LLP2                                           S01408
     L*                                                                   S01408
     I********************************************************************
     I****    REVERSED LOANS FILE - HEADER
     I*
     IRVLNS   NS  01   1 CH
     I                                        1   1 RECI
     I*
     I***     REVERSED LOANS FILE - DETAIL
     I*
     I**       SOME FIELDS ARE RE-DEFINED FOR UNIQUENESS
     I        NS  02   1 CD
     I                                        1   1 RECI
     I***********                             2   40BRCDR                 S01117
     I                                        2   4 BRCA  L1              S01117
     I**********                              5  100CNUMR                                     CSD027
     I                                        5  10 CNUMR                                     CSD027
     I**********                             11  160LNRFR                                     CLE148
     I                                       11  16 LNRFR                                     CLE148
     I*                                             KEY FOR ZCHOP
     I                                        2  16 ZKEY
     I                                       17  190FTYPR
     I                                       20  210FSEQR
     I                                       22  23 LTYPR
     I                                       24  25 SUTPR
     I                                       26  270BRTT
     I                                    P  28  337RTSP
     I                                       34  34 SPIN
     I                                    P  35  410TOTI
     I                                    P  42  480TAID
     I                                    P  49  550IPRD
     I                                    P  56  620ICTD
     I                                    P  63  690IWOD
     I*    NEXT FIELD CHANGED FROM PRAM - ALSO ON HISTR FILE AND BOTH REQD
     I                                    P  70  760PRIN
     I                                    P  77  790MDAT
     I                                       80  82 FCLB                  S01117
     I                                       83  85 RCCY                  CLE006
     I                                       91  94 CLASR                                     CLE042
     I*
     I***     REVERSED LOANS FILE - TRAILER
     I*
     I        NS  03   1 CT
     I                                        1   1 RECI
     I                                    P   2   40NORE
     I                                    P   5  120HRWN
     I                                    P  13  140HRDC
     I*
     I***     REVERSED LOANS FILE - CATCHALL
     I*
     I        NS       1NCD
     I                                        1   1 RECI
     I*
     I********************************************************************
     I********TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.            S01194
     I*TABLE***NS  04   2 C0   3 C1  12 C1                                S01194
     I*******AND      13 C0                                               S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             12  130RCDE                  S01194
     I**********                             14  66 TITL                  S01194
     I**********                             67  67 DATF                  S01194
     I***********                            68  700DFBR                  S01194
     I**********                             74  74 MODI1                 S01194
     I**********                             75  75 MODI2                 S01194
     I**********                             76  76 MODI3                 S01194
     I**********                          P  77  790RUND                  S01194
     I**********                             80  86 RUNA                  S01194
     I**********                             87  870SFLG                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I*
     I*
     I*****TABLE*FILE*-*CURRENCIES*RECORD*1.                              S01194
     I*
     I*TABLE   NS  05   1 CD   2 C2   3 C0                                S01194
     I*******AND      13 C1                                               S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             10  12 CCY                   S01194
     I**********                             13  130SREC                  S01194
     I**********                             14  27 CCNM                  S01194
     I**********                          P  28  348SPOT                  S01194
     I**********                             35  37 CCYS                  S01194
     I**********                             38  380CDP                   S01194
     I**********                             39  390TNOT                  S01194
     I**********                             40  40 DCCY                  S01194
     I**********                             41  44 SRC1                  S01194
     I**********                             45  48 SRC2                  S01194
     I**********                             49  520TACC                  S01194
     I**********                             53  560TEQV                  S01194
     I**********                             57  600SWQV                  S01194
     I**********                             61  640TAC4                  S01194
     I**********                             65  680TAC5                  S01194
     I**********                             69  69 HIND                  S01194
     I**********                          P  70  768PART                  S01194
     I**********                             77  780SSNO                  S01194
     I**********                          P  79  858ERLC                  S01194
     I**********                             86  860MDIN                  S01194
     I**********                             87  870MDIA                  S01194
     I**********                             88  880MDIB                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I*
     I********TABLE*FILE*-*CATCHALL                                       S01194
     I*
     I********NS       1NCD                                               S01194
     I**********                              1   1 RECI                  S01194
     I*
     I********************************************************************
     I*
     I*    CLIENT FILE - CUSTOMER STANDING DATA RECORD.
     I*
     I*CLINT***NS  06   1 CD   8 CA                                       S01194
     I*******OR*       1 CC   8 CA                                        S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   70CNUM                  S01194
     I**********                              8   8 RCDT                  S01194
     I**********                              9  28 CRNM                  S01194
     I**********                             29  38 CTWN                  S01194
     I**********                             39  48 CSNM                  S01194
     I**********                             49  56 CASK                  S01194
     I**********                             57  68 TELX                  S01194
     I**********                             69  80 CSID                  S01194
     I**********                             81  82 ACOC                  S01194
     I**********                             83  83 CBSI                  S01194
     I**********                             84  85 CCTZ                  S01194
     I**********                             86  87 CLOC                  S01194
     I**********                             88  930CPAR                  S01194
     I***********                            94  960BRCD                  S01194
     I**********                             97  980LINS                  S01194
     I**********                             99 1010LIND                  S01194
     I**********                          P 102 1040DASU                  S01194
     I**********                          P 105 1070CDIC                  S01194
     I**********                          P 108 1100DADE                  S01194
     I**********                            111 111 CMIN                  S01194
     I**********                            112 112 CTYP                  S01194
     I**********                            113 124 TELF                  S01194
     I**********                            125 133 CHID                  S01194
     I**********                            134 136 CHAB                  S01194
     I**********                          P 250 2520LCD                   S01194
     I**********                            253 253 CHTP                  S01194
     I**********                          P 254 2560TNLU                  S01194
     I*
     I*
     I*****CLIENT*FILE*-*CATCHALL                                         S01194
     I*
     I********NS                                                          S01194
     I**********                              1   1 RECI                  S01194
     I*
     I**  HISTORY FILE - LOAN HEADER RECORD
     I*
     IHISTR   NS  07   1 CD   2 CA
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I***********                             3   50BRCD                  S01117
     I                                        3   5 BRCB                  S01117
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                        3  17 ZFKEY
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I                                    P  46  520PRAM
     I                                       53  540BRTT
     I                                    P  55  607BRTE
     I                                    P  61  667RTSP
     I                                       67  67 SPIN
     I                                       68  680CALC
     I                                       69  69 WTIN
     I                                       70  700REPT
     I                                       71  71 INTC
     I                                       72  73 LTYP
     I                                       74  75 SUTP
     I                                      215 218 CLAS                                      CLE042
     I*
     I** LOANS HISTORY FILE - AMOUNT DETAIL
     I*
     I        NS  08   1 CD   2 CD
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I***********                             3   50BRCD                  S01117
     I                                        3   5 BRCB                  S01117
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                        3  17 ZFKEY
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I                                    P  46  520PRAM
     I                                    P  53  590INTA
     I                                    P  60  660WTXA
     I                                    P  67  730FEAM
     I                                       74  750FECD
     I                                       76  76 WOIN
     I                                    P  77  790EXVD
     I*                                                                   S01270
     I**   NEW FIELDS ADDED TO AMOUNT DETAIL                              S01270
     I**   LOAN TYPE                                                      S01270
     I                                       80  81 LTYP                  S01270
     I*    LOAN SUB TYPE                                                  S01270
     I                                       82  83 SUTP                  S01270
     I                                    P 179 1850CHDU                                      CLE028
     I                                      228 231 CLAS                                      CLE042
     I*                                                                   S01270
     I*
     I*    HISTORY FILE - DETAIL RATES
     I*
     I        NS  09   1 CD   2 CE
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I***********                             3   50BRCD                  S01117
     I                                        3   5 BRCB                  S01117
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                        3  17 ZFKEY
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I                                       46  470BRTT
     I                                    P  48  537BRTE
     I                                    P  54  597RTSP
     I                                       60  60 SPIN
     I                                       61  610CALC
     I                                       62  62 STAI
     I*                                                                   S01270
     I**   NEW FIELD ADDED TO AMOUNT RATES                                S01270
     I**   PRINCIPAL AMOUNT                                               S01270
     I                                    P  63  690PRAM                  S01270
     I**   ADDITION OF INTEREST RATE CHANGE FLAG FOR 'SC' AMENDMENTS      CAC001
     I                                      108 108 IRCF                  CAC001
     I                                      149 151 RLCY                  CLE006
     I*                                                                   S01270
     I* HISTORY FILE - CATCHALL
     I        NS
     I                                        1   1 RECI
     I                                        3  17 ZFKEY
     I*
     I***     LOCAL DATA AREA FOR DATABASE ERROR REFERENCES
     I*
     ILDA        UDS                            256
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I                                      248 2550ZFSIZE
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I              A8BRNM                          BRNM                  S01194
     I**  EXTERNAL DS FOR BRANCH CODES                                    S01117
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
      **                                                                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              QQDFAC                          DFAC01                                    CGL029
     I              BBCRNM                          CRNM                  S01194
     I              BBCRTN                          CTWN                  S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              A6NBDP                          CDP                   S01194
      *                                                                   CAC001
     ISDMMOD    E DSSDMMODPD                                              CAC001
      ** Module Details                                                   CAC001
      *                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              CLE004
      ** SAR File Details                                                 CLE004
     I*
     I********************************************************************
     C                     MOVEACPY@      BIS@   80
     C********************************************************************
     C*
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C**                                                                  S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCURRR0'                            S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CURKEY  3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C*                                                                   S01194
     C*          FIRST CYCLE PROCESSING                             FIRST
     C   40                GOTO ENDFC
     C**                                                                  S01117
     C**      IN THE DATAAREA RUNDAT                                      S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     SETON                       3540
     C**                                                                  S01117
     C**      SETUP MULTIBRANCHING INDICATOR                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
     C*
     C*          SET UP DATABASE ERROR REFERENCE
     C*
     C                     MOVE 'LE0380  'DBPGM
     C                     MOVE ' '       BLANKS 29
     C                     MOVE BLANKS    DBKEY
     C                     Z-ADD0         DBASE                           S01117
     C*
     C*
     C*          ACCESS ICD-1 FOR DATE FORMAT, DB ERROR IF NOT FOUND
     C                     EXSR ZSYSTM                     98ON-MMDDYY
     C   99                SETON                     U7U8LR
     C   99                MOVE '01'      DBASE            * DB ERROR 01 *
     C***99*****           MOVE 'TABLE'   DBFILE                          S01194
     C   99                MOVE 'SDBANKPD'DBFILE                          S01194
     C***99*****           MOVELZTABKY    DBKEY                           S01194
     C   99                GOTO ENDT
      *                                                                   CAC001
      **  Access Module Details                                           CAC001
      *                                                                   CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*MSG   ' @RTCD   7                       CAC001
     C                     PARM '*FIRST ' @OPTN   7                       CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
      *                                                                   CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     MOVEL'SDMMODPD'DBFILE           ************   CAC001
     C                     Z-ADD7         DBASE            * DBERR 07 *   CAC001
     C                     MOVEL*BLANKS   DBKEY            ************   CAC001
     C                     MOVEL'MMOD'    DBKEY                           CAC001
     C                     SETON                     U7U8LR               CAC001
     C                     GOTO ENDT                                      CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     Z-ADD1         NROF    50
     C                     MOVE 'D'       ZRECI   1
     C**                                                                  S01117
     C**      OPEN SPOOL FILE WHEN NON-MULTIBRANCHING                     S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                       85  ALLOW OUTPUT   S01117
     C                     OPEN LE0380P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   CLE004
      ** Check if CLE004 is switched *ON.                                 CLE004
      *                                                                   CLE004
     C                     MOVE 'N'       CLE004  1                       CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*VERIFY' @OPTN                           CLE004
     C                     PARM 'CLE004'  @SARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004                          CLE004
     C                     END                                            CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANKS                                   CLE004
     C           @RTCD     ANDNE'*NRF   '                                 CLE004
      *                                                                   CLE004
      ** Call to program ended in error                                   CLE004
      *                                                                   CLE004
     C                     MOVEL'CLE004'  DBKEY            ************   CLE004
     C                     MOVE 'SCSARDPD'DBFILE           * DBERR 11 *   CLE004
     C                     Z-ADD11        DBASE            ************   CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     GOTO ENDT                                      CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE006
      ** Check if CLE006 is switched *ON.                                 CLE006
      *                                                                   CLE006
     C                     MOVE 'N'       CLE006  1                       CLE006
     C                     CALL 'AOSARDR0'                                CLE006
     C                     PARM *BLANKS   @RTCD                           CLE006
     C                     PARM '*VERIFY' @OPTN                           CLE006
     C                     PARM 'CLE006'  @SARD   6                       CLE006
     C           SCSARD    PARM SCSARD    DSFDY                           CLE006
      *                                                                   CLE006
     C           @RTCD     IFEQ *BLANKS                                   CLE006
     C                     MOVE 'Y'       CLE006                          CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           @RTCD     ANDNE'*NRF   '                                 CLE006
      *                                                                   CLE006
      ** Call to program ended in error                                   CLE006
      *                                                                   CLE006
     C                     MOVEL'CLE006'  DBKEY            ************   CLE006
     C                     MOVE 'SCSARDPD'DBFILE           * DBERR 12 *   CLE006
     C                     Z-ADD12        DBASE            ************   CLE006
     C                     SETON                     U7U8LR               CLE006
     C                     GOTO ENDT                                      CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE004
      ** Check if CLE007 is switched *ON.                                 CLE015
      *                                                                   CLE015
     C                     MOVE 'N'       CLE007  1                       CLE015
     C                     CALL 'AOSARDR0'                                CLE015
     C                     PARM *BLANKS   @RTCD                           CLE015
     C                     PARM '*VERIFY' @OPTN                           CLE015
     C                     PARM 'CLE007'  @SARD   6                       CLE015
     C           SCSARD    PARM SCSARD    DSFDY                           CLE015
      *                                                                   CLE015
     C           @RTCD     IFEQ *BLANKS                                   CLE015
     C                     MOVE 'Y'       CLE007                          CLE015
     C                     END                                            CLE015
      *                                                                   CLE015
     C           @RTCD     IFNE *BLANKS                                   CLE015
     C           @RTCD     ANDNE'*NRF   '                                 CLE015
      *                                                                   CLE015
      ** Call to program ended in error                                   CLE015
      *                                                                   CLE015
     C                     MOVEL'CLE007'  DBKEY            ************   CLE015
     C                     MOVE 'SCSARDPD'DBFILE           * DBERR 14 *   CLE015
     C                     Z-ADD14        DBASE            ************   CLE015
     C                     SETON                     U7U8LR               CLE015
     C                     GOTO ENDT                                      CLE015
     C                     ENDIF                                          CLE015
      *                                                                   CLE004
      ** Set-up SAR indicators.                                           CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN31                           CLE004
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           CLE007    OREQ 'Y'                                       CLE015
     C                     MOVE *ON       *IN32                           CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE004
      *                                                                   CEU020
      ** Check if CEU020 is present                                       CEU020
      *                                                                   CEU020
     C                     MOVEL'N'       CEU020                          CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANKS   P@RTCD  7                       CEU020
     C                     PARM '*VERIFY 'P@OPTN  7                       CEU020
     C                     PARM 'CEU020'  P@SARD  6                       CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
      *                                                                   CEU020
     C           P@RTCD    IFEQ *BLANKS                                   CEU020
     C                     MOVEL'Y'       CEU020  1                       CEU020
     C                     MOVEL'1'       *IN30                           CEU020
     C                     ELSE                                           CEU020
      *                                                                   CEU020
      ** Handle Database Error                                            CEU020
      *                                                                   CEU020
     C           P@RTCD    IFNE '*NRF    '                                CEU020
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU020
     C                     Z-ADD8         DBASE            * DBERR 08 *   CEU020
     C                     MOVEL'CEU020'  DBKEY            ************   CEU020
     C                     GOTO ENDT                                      CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CEU020
     C                     ENDIF                                          CEU020
      *                                                                                       CLE028
      ** Check if CLE028 is present                                                           CLE028
      *                                                                                       CLE028
     C                     MOVEL'N'       CLE028                                              CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   P@RTCD                                              CLE028
     C                     PARM '*VERIFY 'P@OPTN                                              CLE028
     C                     PARM 'CLE028'  P@SARD                                              CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           P@RTCD    IFEQ *BLANKS                                                       CLE028
     C                     MOVEL'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
      ** Handle Database Error                                                                CLE028
      *                                                                                       CLE028
     C           P@RTCD    IFNE '*NRF    '                                                    CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD14        DBASE                                               CLE028
     C                     MOVEL'CLE028'  DBKEY                                               CLE028
     C                     GOTO ENDT                                                          CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE036
      ** Check if CLE036 is present                                                           CLE036
      *                                                                                       CLE036
     C                     MOVEL'N'       CLE036  1                                           CLE036
      *                                                                                       CLE036
     C                     CALL 'AOSARDR0'                                                    CLE036
     C                     PARM *BLANKS   P@RTCD                                              CLE036
     C                     PARM '*VERIFY 'P@OPTN                                              CLE036
     C                     PARM 'CLE036'  P@SARD                                              CLE036
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE036
      *                                                                                       CLE036
     C           P@RTCD    IFEQ *BLANKS                                                       CLE036
     C                     MOVEL'Y'       CLE036                                              CLE036
     C                     ELSE                                                               CLE036
      *                                                                                       CLE036
      ** Handle Database Error                                                                CLE036
      *                                                                                       CLE036
     C           P@RTCD    IFNE '*NRF    '                                                    CLE036
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE036
     C                     Z-ADD15        DBASE                                               CLE036
     C                     MOVEL'CLE036'  DBKEY                                               CLE036
     C                     GOTO ENDT                                                          CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C                     ENDIF                                                              CLE036
     C*                                                                   S01117
     C           ENDFC     TAG                             ***  ENDFC  ***
     C*
     C********************************************************************
     C*                                                             EVERY
     C                     SETOF                     242526
     C                     SETOF                     27
     C                     SETOF                     424344
     C                     SETOF                     4647
     C                     SETOF                     484950
     C                     SETOF                     515253
     C                     SETOF                     54
     C*
     C**         IF HEADER RECORD READ
     C*
     C   01                GOTO ENDT
     C*
     C**         IF DETAIL RECORD READ
     C*
     C   02                EXSR DETAIL
     C*
     C**         IF TRAILER RECORD READ
     C*
     C   03                EXSR TRAILR
     C           ENDT      TAG                             ***  ENDT   ***
     C**   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                       S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
     CLR                   OUT  LDA                                       S01117
     C*                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     CLR         MBIN      IFNE 'Y'                                       S01117
     CLR         *INU7     ANDNE'1'                                       S01117
     CLR         *IN35     ANDEQ'1'                                       S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C**   OPEN REPORT FILE WHEN NO DETAIL TO REPORT                      S01117
     CLRN85                EXSR #ZZ                                       S01117
     C********************************************************************
     C*
     C**         DETAIL RECORD PROCESSING
     C*   CALLED BY RVLNS DETAIL RECORD 02,CALLS ZCHOP ZDATE2
     C           DETAIL    BEGSR                           ***  DETAIL ***
     C*                                                                   S01117
     C*    AT CHANGE OF BRANCH CODE EXECUTE PRINT                         S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *INL1     ANDEQ'1'                                       S01117
     C                     CLOSELE0380P1                                  S01117
     C                     SETON                       85  ALLOW OUTPUT   S01117
     C                     OPEN LE0380P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C*                                                                   S01117
     C                     OUT  LDA                                       S01194
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01194
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  GET BRANCH NAME                                                 S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ************** S01117
     C                     MOVEL@OPTN     DBOPTN  7        *DBASE 06 **** S01117
     C                     Z-ADD6         DBASE            ************** S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     EXCPTNODTL                                     S01117
     C                     GOTO ENDS                                      S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C*
     C*          COUNT ALL LIVE RECORDS
     C*
     C           NROF      ADD  1         NROF
     C*          HASH TOTAL LIVE RECORDS - TOTAL AMOUNTS
     C*
     C                     MOVE BLANKS    ZZAMT
     C           PRIN      COMP 0                      43
     C                     MOVE PRIN      ZZAMT
     C   43                Z-SUBZZAMT     ZZAMT
     C                     Z-ADDLVTOTI    ZZTOTI
     C                     Z-ADDLVTOTD    ZZTOTD
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    LVTOTI 150
     C                     Z-ADDZZTOTD    LVTOTD  30
     C*
     C                     Z-ADD0         PAGE2   50
     C*                                                                   S01117
     C                     SETOF                     35                   S01117
     C*
     C***********CHAIN*TO*CLIENT*FILE                              CLIENT S01194
     C*
     C**********           MOVELCNUMR     CLINKY  7                       S01194
     C**********           MOVE 'A'       CLINKY                          S01194
     C********** CLINKY    CHAINCLINT                43                   S01194
     C*                                                                   S01194
     C*    CALL AOCUSTR0 FOR CUSTOMER NAME                                S01194
     C*
     C                     MOVELCNUMR     CKEY                            S01194
     C                     MOVEL'*CNUM'   KEYSTS                          S01194
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '02'      DBASE                           S01194
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     MOVELCKEY      DBKEY                           S01194
     C                     EXCPTNODTL                                     S01117
     C                     GOTO ENDS                                      S01194
     C                     END                                            S01194
     C*          DATABASE ERROR IF LIVE OR CLOSED RECORD NOT FOUND
     C*
     C**N06*****           SETON                     U7U8LR               S01194
     C**N06*****           MOVE '02'      DBASE            * DB ERROR 02 *S01194
     C**N06*****           MOVE 'CLINT'   DBFILE                          S01194
     C**N06*****           MOVELCLINKY    DBKEY                           S01194
     C**N06*****           EXCPTNODTL                                     S01117
     C**N06*****           GOTO ENDS                                      S01194
     C*
      *                                                                   CLE006
      ** Get the currency from the currently read record.                 CLE006
      *                                                                   CLE006
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           CLE004    ANDEQ'Y'                                       CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C           CLE007    OREQ 'Y'                                       CLE015
     C                     MOVE RCCY      RCCCY   3                       CLE006
     C                     ENDIF                                          CLE006
     C*
     C           ZKEY      SETLLHISTR
     C                     SETOF                     070809
     C                     READ HISTR                    99
     C  N99      ZKEY      COMP ZFKEY                9999
     C   99                SETON                     41
     C   41                EXCPT
     C                     SETOF                     41
      *                                                                   CLE006
      ** Get the original currency from the 'ST' record in HISTR.         CLE006
      *                                                                   CLE006
     C           *IN07     IFEQ *ON                                       CLE006
     C           CLE006    ANDEQ'Y'                                       CLE006
     C           CLE004    ANDEQ'Y'                                       CLE006
     C           *IN07     OREQ '1'                                       CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C           *IN07     OREQ '1'                                       CLE015
     C           CLE007    ANDEQ'Y'                                       CLE015
     C                     MOVE CCY       ROCCY   3                       CLE006
     C                     MOVE CCY       RTCCY   3                       CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C   99                GOTO ENDS
     C*
     C*          DATABASE ERROR IF FIRST RECORD NOT LOAN HEADER
     C*
     C  N07                SETON                     U7U8LR
     C  N07                MOVE '03'      DBASE            * DB ERROR 03 *
     C  N07                MOVE 'HISTR'   DBFILE
     C  N07                MOVELZFKEY     DBKEY
     C  N07                EXCPTNODTL                                     S01117
     C  N07                GOTO ENDS
     C*
     C*          42 PRINTS HEADERS FOR LOAN
     C                     SETON                         42
     C                     GOTO LNHDR
     C**
     C           RECHAI    TAG                             ***  RECHAI ***
     C   OF                SETON                     39
     C                     SETOF                     070809
      *                                                                   CLE004
     C           CLE004    IFEQ 'N'                                       CLE004
     C                     SETOF                     242526               S01270
     C                     SETOF                     27                   S01270
     C                     ENDIF                                          CLE004
     C**
     C                     READ HISTR                    44
     C*
     C   44                GOTO ENDS
     C*
     C*   IF NOT SAME LOAN NUMBER RETURN TO PRIMARY
     C*
     C           ZKEY      COMP ZFKEY                4646
     C*
     C   46                GOTO ENDS
     C*
     C*          DATABASE ERROR IF LIVE RECORD NOT FOUND
     C           RECI      COMP 'D'                  4444
     C   44                SETON                     U7U8LR
     C   44                MOVE '04'      DBASE            * DB ERROR 04 *
     C   44                MOVE 'HISTR'   DBFILE
     C   44                MOVELZKEY      DBKEY
     C   44                GOTO ENDS
     C*
     C   08                                                AMOUNT RECORD
     COR 09                GOTO LINE                       RATES RECORD
     C*
     C           LNHDR     TAG                             ***  LNHDR  ***
     C***********CHAIN*TABLE*FILE*FOR*DECIMAL*PLACES                TABLE S01194
     C*    ACCESS AOCURRR0 FOR CCY DECIMAL PLACES                         S01194
     C*
     C                     MOVELCCY       CURKEY                          S01194
     C                     CALL 'AOCURRR0'PLIST2                          S01194
     C**********           MOVEL'20      'TABKEY 12                       S01194
     C**********           MOVELCCY       TKEY    4                       S01194
     C**********           MOVE '1'       TKEY                            S01194
     C**********           MOVE TKEY      TABKEY                          S01194
     C********** TABKEY    CHAINTABLE                47                   S01194
     C*
     C*          DATABASE ERROR IF LIVE RECORD NOT FOUND
     C*
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '05'      DBASE                           S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     MOVELCURKEY    DBKEY                           S01194
     C                     EXCPTNODTL                                     S01117
     C                     GOTO ENDS                                      S01194
     C                     END                                            S01194
     C**N47***** RECI      COMP 'D'                  4747                 S01194
     C***47*****           SETON                     U7U8LR               S01194
     C***47*****           MOVE '05'      DBASE            * DB ERROR 05 *S01194
     C***47*****           MOVE 'TABLE'   DBFILE                          S01194
     C***47*****           MOVELTABKEY    DBKEY                           S01194
     C***47*****           EXCPTNODTL                                     S01117
     C***47*****           GOTO ENDS                                      S01194
     C*
     C*          DETERMINE NO OF DECIMALS                    24=0
     C*                                                      25=1
     C           CDP       COMP 1                      2425  26=2
     C           CDP       COMP 2                    27  26  27=3
     C*
     C*         CONVERT HEADER DATES
     C*
     C           VDAT      COMP 0                    48
     C   48                Z-ADDVDAT      ZDAYNO
     C   48                EXSR ZDATE2
     C  N48                MOVE BLANKS    VDATE
     C   48                MOVE ZADATE    VDATE   7
     C*
     C           MDAT      COMP 0                    49
     C   49                Z-ADDMDAT      ZDAYNO
     C   49                EXSR ZDATE2
     C  N49                MOVE BLANKS    MATDE
     C   49                MOVE ZADATE    MATDE   7
     C*
     C*
     C**         ASSIGN SPREAD IND. AND CALC INTEREST RATE        SPREAD
     C*
     C           SPIN      COMP 'A'                      52
     C           SPIN      COMP 'S'                      53
     C           SPIN      COMP 'P'                      54
     C                     Z-ADDBRTE      INTRC  117             INT RATE
     C   52      INTRC     ADD  RTSP      INTRC
     C   53      INTRC     SUB  RTSP      INTRC
     C   54      INTRC     DIV  100       WRKF   119
     C   54      WRKF      MULT RTSP      INTRC     H
      *                                                                                       CLE036
      ** Determine if Base Rate Code is Zero and if so, print                                 CLE036
      ** the Specific Base Rate Instead                                                       CLE036
      *                                                                                       CLE036
     C                     MOVE *OFF      *IN81                                               CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           BRTT      ANDEQ*ZERO                                                         CLE036
     C                     MOVE *ON       *IN81                                               CLE036
     C                     ENDIF                                                              CLE036
     C*
     C********************************************************************
     C           LINE      TAG                             ***  LINE   ***
     C*    ACCESS AOCURRR0 FOR CCY DECIMAL PLACES                         118463
     C                     MOVELCCY       CURKEY                          118463
     C                     CALL 'AOCURRR0'PLIST2                          118463
     C*                                                                   118463
     C*          DATABASE ERROR IF LIVE RECORD NOT FOUND                  118463
     C*                                                                   118463
     C           @RTCD     IFNE *BLANKS                                   118463
     C                     SETON                     U7U8LR               118463
     C                     MOVE '07'      DBASE                           118463
     C                     MOVE 'SDCURRPD'DBFILE                          118463
     C                     MOVELCURKEY    DBKEY                           118463
     C                     EXCPTNODTL                                     118463
     C                     GOTO ENDS                                      118463
     C                     END                                            118463
     C*                                                                   118463
     C*          DETERMINE NO OF DECIMALS                    24=0         118463
     C*                                                      25=1         118463
     C           CDP       COMP 1                      2425  26=2         118463
     C           CDP       COMP 2                    27  26  27=3         118463
     C**         HEADING FIELDS COMPLETE - PRINT                 HEADINGS
     C*
     C   42                                                MAIN HEADS
     COR 39                EXCPT                           OVERFLOW HEADS
     C*
     C                     SETOF                     4235
     C   39                SETOF                     39OF
     C********************************************************************
     C*          LOAN AMOUNT/RATES LINES
     C*
     C**         CONVERT DATES
     C*
     C           EXVD      COMP 0                    50
     C   50                Z-ADDEXVD      ZDAYNO
     C   50                EXSR ZDATE2
     C  N50                MOVE BLANKS    EXVDE
     C   50                MOVE ZADATE    EXVDE   7
     C*
     C           VDAT      COMP 0                    51
     C   51                Z-ADDVDAT      ZDAYNO
     C   51                EXSR ZDATE2
     C  N51                MOVE BLANKS    VDATD
     C   51                MOVE ZADATE    VDATD   7
     C*                                                                   S01270
     C**         PROCESS ACCORDING TO AMENDMENT TYPE                      S01270
     C*          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                      S01270
     C**  MOVE LOAN TYPE AND SUB TYPE                                     S01270
     C**  TO STORAGE FIELDS, FOR PROCESSING AMEND TYPE 'LS' LATER.        S01270
     C**  (THE LOAN TYPE AND SUB TYPE ARE TAKEN FROM THE FIRST HISTORY    S01270
     C**  RECORD AND FROM THEN ON THE LT/ST ARE TAKEN FROM THE 'LS' =     S01270
     C**  AMEND TYPE RECORD)...                                           S01270
     C*                                                                   S01270
     C           CHECK     IFEQ ' '                                       S01270
     C           LTYP      ANDNE*BLANKS                                   S01270
     C           SUTP      ANDNE*BLANKS                                   S01270
     C*                                                                   S01270
     C                     MOVE LTYP      LT1     2                       S01270
     C                     MOVE SUTP      ST1     2                       S01270
     C                     MOVE CLAS      CL1     4                                           CLE042
     C                     MOVE 'Y'       CHECK   1                       S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C**  IF THE AMENDMENT TYPE IS 'LS' THEN OUTPUT THE DETAIL            S01270
     C**  LINE WITH THE CORRECT NARRATIVE TAKEN FROM THE                  S01270
     C**  COMPILE TIME TABLE TOGETHER WITH THE ORIGINAL LOAN TYPE         S01270
     C**  AND SUB TYPE AND PRINCIPAL AMOUNT...                            S01270
     C*                                                                   S01270
     C           AMTP      IFEQ 'LS'                                      S01270
     C                     MOVE LTYP      LT2     2                       S01270
     C                     MOVE SUTP      ST2     2                       S01270
     C                     MOVE CLAS      CL2     4                                           CLE042
     C                     MOVE NARR,31   NARRA                           S01270
      *                                                                   CLE004
      ** Do not print amount column for 'LS' records.                     CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN34                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETON                     8957                 S01270
     C*                                                                   S01270
     C                     EXCPT                                          S01270
     C*                                                                   S01270
     C                     SETOF                     8957                 S01270
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE *OFF      *IN34                           CLE004
     C                     ENDIF                                          CLE004
     C                     MOVE LT2       LT1                             S01270
     C                     MOVE ST2       ST1                             S01270
     C                     MOVE CL2       CL1                                                 CLE042
     C*                                                                   S01270
     C**  THEN RETURN TO READ THE NEXT HISTORY RECORD                     S01270
     C*                                                                   S01270
     C                     GOTO RECHAI                                    S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   S01270
     C*                                                                   S01270
     C           AMTP      COMP 'BC'                     56
     C   56                GOTO BCT
     C           AMTP      COMP 'BR'                     56
     C   56                GOTO BRT
     C           AMTP      COMP 'IN'                     56
     C   56                GOTO INT
     C           AMTP      COMP 'MI'                     56
      *                                                                   CLE004
      ** Additional processing when SARs CLE004 and CLE006 are set *ON.   CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           AMTP      IFEQ 'PF'                                      CLE004
     C           AMTP      OREQ 'PT'                                      CLE004
     C           AMTP      OREQ 'MC'                                      CLE006
     C           CLE006    ANDEQ'Y'                                       CLE006
     C           AMTP      OREQ 'MC'                                      CLE015
     C           CLE007    ANDEQ'Y'                                       CLE015
     C                     GOTO PTR                                       CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CEU020
     C           AMTP      IFEQ 'MC'                                      CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C                     GOTO PTR                                       CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CAC001
      **  If Analytical Accounting is present - only report 'MI'          CAC001
      **  amendments when interest adjustment amount is not Zero          CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN56     IFEQ '1'                                       CAC001
     C           INTA      ANDEQ*ZERO                                     CAC001
     C                     MOVE '0'       *IN56                           CAC001
     C                     GOTO RECHAI                                    CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C   56                GOTO MIT
     C           AMTP      COMP 'MR'                     56
     C   56                GOTO MRT
     C           AMTP      COMP 'PI'                     56
     C   56                GOTO PIT
     C           AMTP      COMP 'RE'                     56
     C   56                GOTO RET
     C           AMTP      COMP 'RO'                     56
     C   56                GOTO ROT
     C           AMTP      COMP 'SA'                     56
     C   56                GOTO SAT
     C           AMTP      COMP 'SC'                     56
      *                                                                   CAC001
      **  If Analytical Accounting is present - only report 'SC'          CAC001
      **  amendments w/ a change to the interest rate/spread (flag = Y)   CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN56     IFEQ '1'                                       CAC001
     C           IRCF      ANDNE'Y'                                       CAC001
     C                     MOVE '0'       *IN56                           CAC001
     C                     GOTO RECHAI                                    CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C   56                GOTO SCT
     C           AMTP      COMP 'ST'                     56
     C   56                GOTO STT
      *                                                                                       CLE028
      ** If processing type is 'CH', report charges added-on                                  CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           AMTP      ANDEQ'CH'                                                          CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *ON       *IN56                                               CLE028
     C                     MOVE NARR,35   NARRA                                               CLE028
     C                     Z-ADDCHDU      PAMT                                                CLE028
     C                     MOVE *ON       *IN57                                               CLE028
     C                     EXCPT                                                              CLE028
     C                     MOVE *OFF      *IN57                                               CLE028
     C                     GOTO RECHAI                                                        CLE028
     C                     ENDIF                                                              CLE028
     C*
     C********************** BASE RATE CODE CHANGE **********************
     C           BCT       TAG                             ***  BCT    ***
     C                     MOVE NARR,1    NARRA  30
     C                     Z-ADDBRTE      PRATE  117
     C                     SETON                     5557
     C                     EXCPT
     C                     SETOF                     5557
     C                     GOTO RECHAI
     C*
     C********************** BASE RATE CHANGE ***************************
     C           BRT       TAG                             ***  BRT    ***
     C                     MOVE NARR,2    NARRA
     C                     Z-ADDBRTE      PRATE
     C                     SETON                     5557
     C                     EXCPT
     C                     SETOF                     5557
     C                     GOTO RECHAI
     C*
     C********************** INTEREST PAYMENT ,OR CAPITALISED ***********
      ** If CLE028 is installed and flat rate personal loan, interest                         CLE028
      ** was added on at start.                                                               CLE028
      *                                                                                       CLE028
     C           INT       TAG                             ***  INT    ***
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE NARR,36   NARRA                                               CLE028
     C                     Z-ADDPRAM      PAMT                                                CLE028
     C                     ELSE                                                               CLE028
     C           PRAM      COMP 0                    595958
     C      58             MOVE NARR,3    NARRA
     C   59                MOVE NARR,4    NARRA
     C                     ENDIF                                                              CLE028
     C                     Z-ADDINTA      PAMT   130
     C                     SETON                     57
     C                     EXCPT
     C                     SETOF                     57
     C                     GOTO RECHAI
     C*
     C********************** MANUAL INTEREST ADJUSTMENT *****************
     C           MIT       TAG                             ***  MIT    ***
     C                     MOVE NARR,8    NARRA
     C                     Z-ADDINTA      PAMT
     C                     SETON                     57
     C                     EXCPT
     C                     SETOF                     57
     C                     GOTO RECHAI
     C********************** MANUAL REPAYMENT - PRINCIPAL ***************
     C*****                                   - INTEREST
     C******                                  - WITHHOLDING TAX
     C*******                                 - FEE
     C           MRT       TAG                             ***  MRT    ***
     C           PRAM      COMP 0                    6262
     C  N62                GOTO NOT62
     C                     MOVE NARR,9    NARRA
     C                     Z-ADDPRAM      PAMT
     C                     SETOF                       62
     C   50      VDAT      SUB  EXVD      DPDU    30 63
     C  N50                MOVEL'   -'    EXVDE
     C                     SETON                     5764
     C******** - PRINCIPAL
     C                     EXCPT
     C                     SETOF                     576463
     C           NOT62     TAG                             ***  NOT62  ***
     C           INTA      COMP 0                    6565
     C  N65                GOTO NOT65
     C                     MOVE NARR,10   NARRA
     C                     Z-ADDINTA      PAMT
     C                     SETOF                     65
     C   50      VDAT      SUB  EXVD      DPDU       63
     C  N50                MOVEL'   -'    EXVDE
     C                     SETON                     5764
     C******** - INTEREST
     C                     EXCPT
     C                     SETOF                     576463
     C           NOT65     TAG                             ***  NOT65  ***
     C           WTXA      COMP 0                    6666
     C  N66                GOTO NOT66
     C                     MOVE NARR,11   NARRA
     C                     Z-ADDWTXA      PAMT
     C                     SETOF                     66
     C   50      VDAT      SUB  EXVD      DPDU       63
     C  N50                MOVEL'   -'    EXVDE
     C                     SETON                     5764
     C******** - W/H TAX
     C                     EXCPT
     C                     SETOF                     576463
     C           NOT66     TAG                             ***  NOT66  ***
     C           FEAM      COMP 0                    6767
     C  N67                GOTO RECHAI
     C                     Z-ADDFEAM      PAMT
     C                     MOVE NARR,12   NARRA
     C                     MOVE FECD      NARRA
     C                     SETOF                     67
     C   50      VDAT      SUB  EXVD      DPDU       63
     C  N50                MOVEL'   -'    EXVDE
     C                     SETON                     576460
     C******** - FEE
     C                     EXCPT
     C                     SETOF                     576463
     C                     SETOF                     60
     C                     GOTO RECHAI
     C*
     C********************** PRINCIPAL INCREASE *************************
     C           PIT       TAG                             ***  PIT    ***
     C                     MOVE NARR,13   NARRA
     C                     Z-ADDPRAM      PAMT
     C                     SETON                     57
     C                     EXCPT
     C                     SETOF                     57
     C                     GOTO RECHAI
     C********************** REPAYMENT - PRINCIPAL **********************
     C*****                            - INTEREST
     C*******                          - WITHHOLDING TAX
     C           RET       TAG                             ***  RET    ***
     C           PRAM      COMP 0                    68
     C  N68                GOTO NOT68
     C                     MOVE NARR,14   NARRA
     C                     Z-ADDPRAM      PAMT
     C                     SETON                     57
     C******** - PRINCIPAL
     C                     EXCPT
     C                     SETOF                     5768
     C           NOT68     TAG                             ***  NOT68  ***
     C           INTA      COMP 0                    6969
     C  N69                GOTO NOT69
     C                     MOVE NARR,15   NARRA                REPAY INT
     C                     Z-ADDINTA      PAMT
     C                     SETON                     57
     C******** - INTEREST
     C                     EXCPT
     C                     SETOF                     5769
     C           NOT69     TAG                             ***  NOT69  ***
     C           WTXA      COMP 0                    7070
     C  N70                GOTO RECHAI
     C                     MOVE NARR,16   NARRA
     C                     Z-ADDWTXA      PAMT
     C                     SETON                     57
     C******** - W/H TAX
     C                     EXCPT
     C                     SETOF                     5770
     C                     GOTO RECHAI
     C*
     C********************** ROLLOVER - BASE RATE ***********************
     C******                         - RATE
     C******                         - SPREAD-ADD
     C******                         - SPREAD-SUBTRACT
     C*******                        - SPREAD-PERCENTAGE
     C           ROT       TAG                             ***  ROT    ***
     C           BRTE      COMP 0                    71  72
     C   72      RTSP      COMP 0                    73
     C   71                MOVE NARR,17   NARRA
     C   71                Z-ADDBRTE      PRATE
     C   73                MOVE NARR,18   NARRA
     C   73                Z-ADDRTSP      PRATE
     C                     SETON                     5557
     C******** - RATE
     C   71
     COR 73                EXCPT
     C                     SETOF                     5557
     C   71      RTSP      COMP 0                    74
     C   74 52             MOVE NARR,19   NARRA
     C   74 53             MOVE NARR,20   NARRA
     C   74 54             MOVE NARR,21   NARRA
     C   74                Z-ADDRTSP      PRATE
     C   74                SETON                     5557
     C******** - SPREAD
     C   74                EXCPT
     C                     SETOF                     555771
     C                     SETOF                     727374
     C                     GOTO RECHAI
     C*
     C********************** STOP ACCRUALS ******************************
     C*******                START ACCRUALS
     C           SAT       TAG                             ***  SAT    ***
     C           STAI      COMP 'Y'                      75
     C           STAI      COMP ' '                      76
     C   75                MOVE NARR,22   NARRA
     C   76                MOVE NARR,23   NARRA
     C                     Z-ADD0         PRATE
     C                     SETON                     5557
     C                     EXCPT
     C                     SETOF                     555775
     C                     SETOF                     76
     C                     GOTO RECHAI
     C*
     C********************** SPREAD CHANGE ******************************
     C           SCT       TAG                             ***  SCT    ***
     C                     MOVE NARR,24   NARRA
     C                     Z-ADDRTSP      PRATE
     C                     SETON                     5557
     C                     EXCPT
     C                     SETOF                     5557
     C                     GOTO RECHAI
     C********************** START - PRINCIPAL **************************
     C******                       - BASE RATE
     C******                       - RATE
     C******                       - SPREAD-ADD
     C*****                        - SPREAD-SUBTRACT
     C******                       - SPREAD-PERCENTAGE
     C           STT       TAG                             ***  STT    ***
     C           TOTI      COMP 0                    2322
     C  N23N22             MOVE NARR,25   NARRA
     C   22
     COR 23                MOVE NARR,28   NARRA
     C                     Z-ADDPRAM      PAMT
     C                     SETON                     57
     C******** - PRINCIPAL
     C                     EXCPT
     C                     SETOF                     57
     C*
     C   22                MOVE NARR,29   NARRA
     C   23                MOVE NARR,30   NARRA
     C   22                Z-SUBTOTI      PAMT
     C   23                Z-ADDTOTI      PAMT
     C   22                SETON                     23
     C   23                SETON                     57
     C                     EXCPT
     C                     SETOF                     57
     C*
     C           BRTE      COMP 0                    77  78
     C   77                MOVE NARR,26   NARRA
     C   77                Z-ADDBRTE      PRATE
     C   77                SETON                     5557
     C******** - BASE RATE
     C   77                EXCPT
     C                     SETOF                     5557
     C   78      RTSP      COMP 0                    79
     C   79                MOVE NARR,27   NARRA
     C   79                Z-ADDRTSP      PRATE
     C   79                SETON                     5557
     C******** - RATE
     C   79                EXCPT
     C                     SETOF                     5557
     C   77      RTSP      COMP 0                    80
     C   80                Z-ADDRTSP      PRATE
     C   80 52             MOVE NARR,5    NARRA
     C   80 53             MOVE NARR,6    NARRA
     C   80 54             MOVE NARR,7    NARRA
     C   80                SETON                     5557
     C******** - SPREAD
     C   80                EXCPT
     C                     SETOF                     555777
     C                     SETOF                     787980
     C                     GOTO RECHAI
stp   *                                                                   CLE004
      ** Principal transfer From/To &  Multi-currency rollover            CLE004
      ** processings.                                                     CLE004
      *                                                                   CLE004
     C           PTR       TAG                                            CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           CEU020    OREQ 'Y'                                       CEU020
     C                     SELEC                                          CLE004
     C           AMTP      WHEQ 'PF'                                      CLE004
     C           CEU020    ANDEQ'N'                                       CEU020
     C                     MOVE NARR,32   NARRA                           CLE004
     C           AMTP      WHEQ 'PT'                                      CLE004
     C           CEU020    ANDEQ'N'                                       CEU020
     C                     MOVE NARR,33   NARRA                           CLE004
     C                     ENDSL                                          CEU020
     C***********AMTP      WHEQ 'MC'                                      CLE006
     C           AMTP      IFEQ 'MC'                                      CEU020
     C           CLE006    ANDEQ'Y'                                       CLE006
     C           CLE004    ANDEQ'Y'                                       CEU020
     C           CEU020    OREQ 'Y'                                       CEU020
     C           AMTP      ANDEQ'MC'                                      CEU020
     C           CLE007    OREQ 'Y'                                       CLE015
     C           AMTP      ANDEQ'MC'                                      CLE015
     C                     MOVE NARR,34   NARRA                           CLE006
     C                     MOVE RLCY      RTCCY   3                       CLE006
     C                     MOVEA'11'      *IN,33                          CLE006
      *                                                                   CLE006
      ** Get the new currency's number of decimal places.                 CLE006
      *                                                                   CLE006
     C                     CALL 'AOCURRR0'                                CLE006
     C                     PARM *BLANKS   PRTCD   7                       CLE006
     C                     PARM '*KEY   ' POPTN   7                       CLE006
     C                     PARM           RTCCY                           CLE006
     C           SDCURR    PARM SDCURR    DSSDY                           CLE006
     C           PRTCD     IFNE *BLANKS                                   CLE006
     C                     SETON                     U7U8LR               CLE006
     C                     MOVEL'SDCURRPD'DBFILE           ************   CLE006
     C                     Z-ADD13        DBASE            * DBERR 13 *   CLE006
     C                     MOVELRLCY      DBKEY            ************   CLE006
     C                     GOTO ENDT                                      CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C                     MOVEA'0000'    *IN,24
     C                     SELEC                                          CLE006
     C           CDP       WHEQ 0                                         CLE006
     C                     MOVE *ON       *IN24                           CLE006
     C           CDP       WHEQ 1                                         CLE006
     C                     MOVE *ON       *IN25                           CLE006
     C           CDP       WHEQ 2                                         CLE006
     C                     MOVE *ON       *IN26                           CLE006
     C           CDP       WHEQ 3                                         CLE006
     C                     MOVE *ON       *IN27                           CLE006
     C                     ENDSL                                          CLE006
     C***********          ENDSL                                   CLE004 CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CLE004
      ** Get principal amount and convert dates to DDMMMYY format.        CLE004
      *                                                                   CLE004
     C                     MOVE PRAM      PAMT                            CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CEU020
     C           CEU020    OREQ 'Y'                                       CEU020
     C           AMTP      ANDEQ'MC'                                      CEU020
      *                                                                   CEU020
stp  C           EXVD      IFEQ 0                                         CLE004
     C           AMTP      OREQ 'MC'                                      CLE004
     C                     MOVE *BLANKS   EXVDE                           CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADDEXVD      ZDAYNO                          CLE004
     C                     EXSR ZDATE2                                    CLE004
     C                     MOVE ZADATE    EXVDE                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
stp  C           VDAT      IFEQ 0                                         CLE004
     C                     MOVE *BLANKS   VDATD                           CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADDVDAT      ZDAYNO                          CLE004
     C                     EXSR ZDATE2                                    CLE004
     C                     MOVE ZADATE    VDATD                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Print the new amendment on the report.                           CLE004
      *                                                                   CLE004
     C                     MOVE *ON       *IN64                           CLE004
     C                     MOVE *ON       *IN57                           CLE004
     C                     EXCPT                                          CLE004
     C                     MOVE *OFF      *IN57                           CLE004
     C                     MOVE *OFF      *IN64                           CLE004
     C                     MOVEA'00'      *IN,33                          CLE004
     C                     MOVE RTCCY     ROCCY                           CLE004
      *                                                                   CLE004
     C                     GOTO RECHAI
     C                     ENDIF
     C*
     C                     ENDIF                                          CEU020
      *                                                                   CEU020
     C           ENDS      ENDSR                           ***  ENDS   ***
     C*******************************************************************
     C           TRAILR    BEGSR                           ***  TRAILR ***
     C*          CALLED BY RVLNS TRAILER RECORD 03
     C           NROF      ADD  1         NROF
     C           HRWN      COMP LVTOTI               8383
     C  N83      HRDC      COMP LVTOTD               8383
     C  N83      NROF      COMP NORE                 8383
     C   83                SETON                         U8
     C                     ENDSR
     C********************************************************************
     C********************************************************************
     C**
     C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
     C**
     C           ZSYSTM    BEGSR                           ***  ZSYSTM ***
     C**
     C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
1007 C**********           MOVEL'01      'ZTABKY 12                       S01194
1008 C**********           MOVE '  10'    ZTABKY                          S01194
1009 C**                                                                  S01194
1010 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     COMP *BLANKS              9999                 S01194
     C*                                                                   S01194
     C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C**
     C                     ENDSR
     C**
     C**
     C********************************************************************
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     CSR         GLZADD    BEGSR                           ***  GLZADD ***
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ***  ZZAEND ***
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     CSR         GLZSUM    BEGSR                           ***  GLZSUM ***
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ***  ZZOFPS ***
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ***  ZZSEND ***
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C********************************************************************S01117
     C*                                                                   S01117
     C*    SUBROUTINE : #ZZ                                               S01117
     C*                                                                   S01117
     C*    CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCLATIONS IF     S01117
     C*    THE P1 FILES HAVE NOT ALREADY BEEN OPENDED (IE, IF THERE ARE   S01117
     C*    NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)     S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C**   OPEN P1 SPOOL FILE                                             S01117
     C                     OPEN LE0380P1                                  S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C*                                                                   S01117
     C                     OUT  LDA                                       S01194
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01194
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**   ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     EXCPTNODTL                                     S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     O********************************************************************
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
     O*
     OLE0380P1E  203   42                                                 S01124
     O       OR        39
     O       OR        41
     O***********                        11 'REF  LE0380'                 E15649
     O***********              TITL      66                               E15649
     O***********                        71 'DATE'                        E15649
     O***********              RUNA      79                               E15649
     O***********                        84 'PAGE'                        E15649
     O***********              PAGE      89                               E15649
     O***********                        11 'REF  LE0380'         E15649  S01117
     O                                   24 'REFERENCE LE0380P1'          S01117
     O                         TITL      89                               E15649
     O                                  104 'DATE'                        E15649
     O                         RUNA     113                               E15649
     O                                  122 'PAGE'                        E15649
     O                         PAGE     127                               E15649
     O*
     O        E  1     42
     O       OR        39
     O       OR        41
     O***********                         6 'BRANCH'                      S01117
     O***********              BRCDR     10                               S01117
     O***********                        49 'REVERSED LOAN HISTORY'       S01117
     O                                   74 'REVERSED LOAN HISTORY'       S01117
     O                       88          92 'BRANCH'                      S01117
     O                       88BRCA      96                               S01117
     O                       88          97 '-'                           S01117
     O                       88BRNM     127                               S01117
     O*
     O********E**2     42                                                 S01117
     O        E  1     42                                                 S01117
     O       OR        39
     O       OR        41
     O***********                        49 '---------------------'       S01117
     O                                   74 '---------------------'       S01117
     O*
     O        E  2     42
     O       OR        39
     O       OR        41
     O                                    7 'LOAN NO'
     O                         LNRFR     15
     O                                   26 'PAGE NO'
     O                         PAGE2     33
     O        E  1     42
     O       OR        39
     O       OR        41
     O                                    8 'CUSTOMER'
     O                         CRNM      30
     O                N39                59 'CMMT/FACILITY NO'
     O                N39      FTYPR     86
     O                N39      FSEQR     88
     O*
     O        E  1     42
     O       OR        39
     O       OR        41
     O                         CTWN      20
     O                         CNUMR     30
     O                       42          51 'INT RATE'
     O                       42INTRC     88 '  0 .       '
     O*
     O        E  1     42
     O       OR        41
     O                                   18 'LOAN TYPE/SUB TYPE'
     O                         LTYPR     27
     O                                   28 '-'
     O                         SUTPR     30
     O                         CLASR     34                                                   CLE042
     O**********             42          57 'BASE RATE CODE'                                  CLE036
     O                   N81 42          57 'BASE RATE CODE'                                  CLE036
     O                    81 42          52 'BASE RATE'                                       CLE036
     O**********             42BRTT      88                                                   CLE036
     O                   N81 42BRTT      88                                                   CLE036
     O                    81 42BRTE      88 '  0 .       '                                    CLE036
     O        E  3     41
     O***********                        59 '** NO RECORDS FOUND **'      E15649
     O                                   59 '*** NO RECORDS FOUND ***'    E15649
     O        E  1     42
     O                                   49 'SPREAD'
     O                         RTSP      87 '  0 .       '
     O                 52                88 '+'
     O                 53                88 '-'
     O                    54             88 '%'
     O*
     O        E  1     42
     O                                   11 'ORIG AMOUNT'
     O                    24   PRAM      40 ' ,   ,   ,   , 0 '
     O                    25   PRAM      40 '   ,   ,   , 0 . '
     O                    26   PRAM      40 '  ,   ,   , 0 .  '
     O                    27   PRAM      40 ' ,   ,   , 0 .   '
     O********E  1     42                                                 185785
     O********                            3 'CCY'                         185785
     O********                 CCY       40                               185785
      *                                                                   CLE006
     O        E  1     42 31 32                                           CLE006
     O       OR        42 30                                              CEU020
     O***********                        17 'Original Currency'    CLE006 CEU020
     O                                   17 'ORIGINAL CURRENCY'           CEU020
     O                         ROCCY     40                               CLE006
     O********E**1     42                                          CLE006 CEU020
     O        E  1     42N30                                              CEU020
     O***********                         3 'CCY'                         CLE006
     O***********              CCY       40                               CLE006
     O                N32                 3 'CCY'                         CLE006
     O                N32      CCY       40                               CLE006
     O***********      31 32             16 'Current Currency'     CLE006 CEU020
     O                 31 32             16 'CURRENT CURRENCY'            CEU020
     O                 31 32   RCCCY     40                               CLE006
      *                                                                   CLE006
     O                                   66 'ACCRUED INTEREST POSTED'
     O                    24   TAID      89 ' ,   ,   ,   , 0 -'
     O                    25   TAID      89 '   ,   ,   , 0 . -'
     O                    26   TAID      89 '  ,   ,   , 0 .  -'
     O                    27   TAID      89 ' ,   ,   , 0 .   -'
      *                                                                   CEU020
     O        E  1     42 30                                              CEU020
     O                                   16 'CURRENT CURRENCY'            CEU020
     O                         RCCCY     40                               CEU020
      *                                                                   CEU020
     O                                   66 'ACCRUED INTEREST POSTED'     CEU020
     O                    24   TAID      89 ' ,   ,   ,   , 0 -'          CEU020
     O                    25   TAID      89 '   ,   ,   , 0 . -'          CEU020
     O                    26   TAID      89 '  ,   ,   , 0 .  -'          CEU020
     O                    27   TAID      89 ' ,   ,   , 0 .   -'          CEU020
      *                                                                   CEU020
     O        E  1     42
     O                                   17 'CURRENT PRINCIPAL'
     O                    24   PRIN      41 ' ,   ,   ,   , 0 -'
     O                    25   PRIN      41 '   ,   ,   , 0 . -'
     O                    26   PRIN      41 '  ,   ,   , 0 .  -'
     O                    27   PRIN      41 ' ,   ,   , 0 .   -'
     O                                   56 'INTEREST PAID'
     O                    24   IPRD      89 ' ,   ,   ,   , 0 -'
     O                    25   IPRD      89 '   ,   ,   , 0 . -'
     O                    26   IPRD      89 '  ,   ,   , 0 .  -'
     O                    27   IPRD      89 ' ,   ,   , 0 .   -'
     O        E  1     42
     O                                   10 'START DATE'
     O                         VDATE     40
     O                                   63 'INTEREST CAPITALISED'
     O                    24   ICTD      89 ' ,   ,   ,   , 0 -'
     O                    25   ICTD      89 '   ,   ,   , 0 . -'
     O                    26   ICTD      89 '  ,   ,   , 0 .  -'
     O                    27   ICTD      89 ' ,   ,   , 0 .   -'
     O        E  1     42
     O                                   13 'MATURITY DATE'
     O                         MATDE     40
     O                                   63 'INTEREST WRITTEN OFF'
     O                    24   IWOD      89 ' ,   ,   ,   , 0 -'
     O                    25   IWOD      89 '   ,   ,   , 0 . -'
     O                    26   IWOD      89 '  ,   ,   , 0 .  -'
     O                    27   IWOD      89 ' ,   ,   , 0 .   -'
     O*
     O        E  1     42 88                                              S01117
     O                                   15 'FACILITY BRANCH'             S01117
     O                         FCLB      40                               S01117
     O*                                                                   S01117
     O        E 11     42
     O       OR        39
     O                                   87 'NO. OF'
     O        E  1     42
     O       OR        39
     O                                    8 'DUE DATE'
     O                                   24 'EFFECTIVE DATE'
     O                                   42 'NARRATIVE'
     O                                   71 'AMOUNT'
     O                                   86 'DAYS'
     O        E  2     42
     O       OR        39
     O                                   88 'PAST DUE'
     O********************************************************************
     O*
     O*
     O        E  1     57
     O                    64   EXVDE      7
     O                         VDATD     19
     O                         NARRA     59
     O*
     O**                  24N55PAMT      79 ' ,   ,   ,   , 0 -'          CLE004
     O**                  25N55PAMT      79 '   ,   ,   , 0 . -'          CLE004
     O**                  26N55PAMT      79 '  ,   ,   , 0 .  -'          CLE004
     O**                  27N55PAMT      79 ' ,   ,   , 0 .   -'          CLE004
     O                N34 24N55PAMT      79 ' ,   ,   ,   , 0 -'          CLE004
     O                N34 25N55PAMT      79 '   ,   ,   , 0 . -'          CLE004
     O                N34 26N55PAMT      79 '  ,   ,   , 0 .  -'          CLE004
     O                N34 27N55PAMT      79 ' ,   ,   , 0 .   -'          CLE004
     O                    24N55PAMT      79 ' ,   ,   ,   , 0 -'
     O                    25N55PAMT      79 '   ,   ,   , 0 . -'
     O                    26N55PAMT      79 '  ,   ,   , 0 .  -'
     O                    27N55PAMT      79 ' ,   ,   , 0 .   -'
     O                N75N76 55PRATE     79 '  0 .       '
     O                N60 64 63DPDU  Z   85
     O*
     O                    89             96 'FROM  '                      S01270
     O                    89   LT1       98                               S01270
     O                    89             99 '-'                           S01270
     O                    89   ST1      101                               S01270
     O                    89   CL1      105                                                   CLE042
     O                    89            109 'TO'                                              CLE042
     O                    89   LT2      113                                                   CLE042
     O                    89            114 '-'                                               CLE042
     O                    89   ST2      116                                                   CLE042
     O                    89   CL2      120                                                   CLE042
     O********************89            105 'TO'                                       S01270 CLE042
     O********************89   LT2      109                                            S01270 CLE042
     O********************89            110 '-'                                        S01270 CLE042
     O********************89   ST2      112                                            S01270 CLE042
      *                                                                   CLE006
      ** Additional details for multi-currency rollover.                  CLE006
      *                                                                   CLE006
     O                    33             94 'FROM'                        CLE006
     O                    33   ROCCY     99                               CLE006
     O                    33            103 'TO'                          CLE006
     O                    33   RTCCY    108                               CLE006
     O*                                                                   S01270
     O*
     O        T 3      U7 U8 LR                                           S01117
     O                                   42 '*** REFERENCE'               S01117
     O                                   51 'LE0380'                      S01117
     O                                   68 '- DATABASE ERROR'            S01117
     O        T 3      L1 88NU7                                           S01117
     O       AND       85                                                 090739
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCA      77                               S01117
     O                                   81 ' ***'                        S01117
     O        T 3      LRNU7N88                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
     O        E   03           NODTL                                      S01117
     O                                   24 'REFERENCE  LE0380P1'         S01117
     O                         TITL      89                               S01117
     O                                  104 'DATE'                        S01117
     O                         RUNA     113                               S01117
     O                                  122 'PAGE'                        S01117
     O                         PAGE     127                               S01117
     O        E 2              NODTL                                      S01117
     O                                   74 'REVERSED LOAN HISTORY'       S01117
     O***********            88          92 'BRANCH'                S01117090739
     O***********            88BRCA      96                         S01117090739
     O***********            88          97 '-'                     S01117090739
     O***********            88BRNM     127                         S01117090739
     O        E 1              NODTL                                      S01117
     O                                   74 '---------------------'       S01117
     O        E 3     NU7      NODTL                                      S01117
     O                                   71 '***   NO DETAILS TO REPO'    S01117
     O                                   79 'RT   ***'                    S01117
     O        E 3     NU7      NODTL                                      090739
     O                                   76 '*** END OF REPORT ***'       090739
     O*******************************************************************
     O********T**203   LR                                                 S01117
     OLE0380AUT  203   LR                                                 S01117
     O***********                        11 'REF  LE0380'                 E15649
     O***********              TITL      66                               E15649
     O***********                        71 'DATE'                        E15649
     O***********              RUNA      79                               E15649
     O***********                        84 'PAGE'                        E15649
     O***********              PAGE      89                               E15649
     O***********                        12 'REF  LE0380'         E15649  S01117
     O                                   24 'REFERENCE LE0380AU'          S01117
     O                         TITL      89                               E15649
     O                                  104 'DATE'                        E15649
     O                         RUNA     113                               E15649
     O                                  122 'PAGE'                        E15649
     O***********              PAGE     127                       E15649  S01117
     O                         PAGE1    127                               S01117
     O*
     O        T  1     LR
     O***********                        44 'REVERSED LOANS HISTORY -'    S01117
     O***********                        58 'FILE CONTROLS'               S01117
     O                                   69 'REVERSED LOANS HISTORY -'    S01117
     O                                   83 'FILE CONTROLS'               S01117
     O*
     O        T  3     LR
     O***********                        44 '------------------------'    S01117
     O***********                        58 '--------------'              S01117
     O                                   69 '------------------------'    S01117
     O                                   83 '--------------'              S01117
     O*
     O********************************************************************
     O*
     O********T**3     U7 U8 LR                                           S01117
     O***********                        41 'REF LE0380'                  S01117
     O***********                        61 'DATABASE ERROR AT'           S01117
     O***********              DBASE     64                               S01117
     O********T**1     U7 U8 LR                                           S01117
     O***********                        27 'FILENAME'                    S01117
     O***********              DBFILE    33                               S01117
     O***********                        38 'KEY'                         S01117
     O***********              DBKEY     68                               S01117
     O********************************************************************
     O********T**2     LR 35NU7                                           S01117
     O***********                        53 '* NO DETAILS TO REPORT *'    E15649
     O***********                        48 '*** NO DETAILS TO '  E15649  S01117
     O***********                        58 'REPORT ***'          E15649  S01117
     O********************************************************************
     O        T  116   LR
     O                                   24 'S/RVLNS - RUN CONTROLS'
     O************                       38 'NUMBER'                      E15649
     O                                   44 'NUMBER'                      E15649
     O                                   64 'VALUE'
     O*
     O        T  2     LR
     O                                   24 '----------------------'
     O***********                        38 'OF RECORDS'                  E15649
     O                                   44 'OF RECORDS'                  E15649
     O                                   64 'OF RECORDS'
     O*
     O        T  2     LR
     O***********                        23 'TOTAL RECORDS ON FILE'       E15649
     O                                   23 'CONTROL TOTALS - FILE'       E15649
     O                                   35 'CONTROL REC'                 E15649
     O***********        NU7   NORE  3   38                               E15649
     O                   NU7   NORE  3   44                               E15649
     O                   NU7   HRWN  Z   61
     O                   NU7   HRDC      64
     O*
     O        T  3     LR
     O***********                        26 'TOTAL RECORDS CALCULATED'    E15649
     O                                   16 'CONTROL TOTALS'              E15649
     O                                   29 '- CALCULATED'                E15649
     O***********              NROF  3   38                               E15649
     O                         NROF  3   44                               E15649
     O                         LVTOTIZ   61
     O                         LVTOTD    64
     O                 83                88 '*** DIFFERENCE ***'
     O*
     O********************************************************************
     O*
     O        T  3     U7 U8 LR                                           S01117
     O                                   42 '*** REFERENCE'               S01117
     O                                   54 'LE0380 - '                   S01117
     O                                   71 'DATABASE ERROR AT'           S01117
     O                         DBASE     75                               S01117
     O        T  1     U7 U8 LR                                           S01117
     O                                   37 'FILENAME'                    S01117
     O                         DBFILE    46                               S01117
     O                                   51 'KEY'                         S01117
     O                         DBKEY     81                               S01117
     O        T  2     LR 35NU7                                           S01117
     O       AND      N41                                                 S01117
     O                                   71 '*** NO DETAILS TO '          S01117
     O                                   81 'REPORT ***'                  S01117
     O********T**3     LR                                                 S01117
     O***********                        52 '***   END OF REPORT'         S01117
     O***********                        58 '***'                         S01117
     O*
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   NARR - NARRATIVES
BASE RATE CODE CHANGE          1
BASE RATE CHANGE               2
INTEREST PAYMENT               3
INTEREST CAPITALISED           4
START-SPREAD -ADD              5
START-SPREAD-SUBTRACT          6
START-SPREAD-PERCENTAGE        7
MANUAL INTEREST ADJUSTMENT     8
MANUAL REPAYMENT-PRINCIPAL     9
MANUAL REPAYMENT-INTEREST     10
MANUAL REPAYMENT-WITHHOLD TAX 11
MANUAL REPAYMENT-FEE CODE     12
PRINCIPAL INCREASE            13
REPAYMENT-PRINCIPAL           14
REPAYMENT-INTEREST            15
REPAYMENT-WITHHOLDING TAX     16
ROLLOVER-BASE RATE            17
ROLLOVER-RATE                 18
ROLLOVER-SPREAD-ADD           19
ROLLOVER-SPREAD-SUBTRACT      20
ROLLOVER-SPREAD-PERCENTAGE    21
STOP ACCRUALS                 22
START ACCRUALS                23
SPREAD/RATE CHANGE            24   WAS SPREAD CHANGE
START-PRINCIPAL               25
START-BASE RATE               26
START-RATE                    27
START-FACE VALUE              28
START-PREMIUM                 29
START-DISCOUNT                30
LOAN SUB-TYPE CHANGED         31                                          S01270
TRANSFER PRINCIPAL FROM       32                                          CLE004
TRANSFER PRINCIPAL TO         33                                          CLE004
MULTI-CURRENCY ROLLOVER       34                                          CLE004
CHARGES ADDED-ON              35                                                              CLE028
INTEREST ADDED-ON             36                                                              CLE028
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
