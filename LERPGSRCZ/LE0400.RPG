0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE History update')                              *
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Customer Lending Module                              *
0005 F*                                                               *
0006 F*     LE0400 - HISTORY UPDATE                                   *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD050577           Date 30May18               *      
      *  Prev Amend No. MD050139           Date 23Mar18               *      
      *                 MD051970           Date 08Oct18               *
      *                 MD051946           Date 23Sep18               *
      *                 MD050297           Date 18May18               *      
      *                 MD046248           Date 27Oct17               *
      *                 MD046080           Date 17Sep17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 MD037495           Date 11Feb16               *
      *                 AR1057551          Date 05Jun17               *
      *                 CGL184             Date 07Dec16               *
      *                 MD038509           Date 02May16               *
      *                 CLE154             Date 02Aug12               *
      *                 AR897086           Date 09Mar15               *
      *                 CLE164             Date 18Aug14               *
      *                 230712             Date 28Nov14               *
      *                 MD028338           Date 28Nov14               *
      *                 MD026266           Date 19Aug14               *
      *                 MD020985           Date 28Jun13               *
      *                 AR790759           Date 06Jun13               *
      *                 AR989420           Date 17Jun13               *
      *                 AR815697           Date 06Jun13               *
      *                 AR786878           Date 05Jun13               *
      *                 AR830785           Date 07May13               *
      *                 AR1088476          Date 23Feb13               *
      *                 AR1084876          Date 24Feb13               *
      *                 260891             Date 07Feb13               *
      *                 AR1078348          Date 17Jan13               *
      *                 AR1009681          Date 20Nov12               *
      *                 AR737209           Date 14Oct12               *
      *                 AR810495           Date 01Aug12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 259707             Date 27Jul12               *
      *                 AR316218           Date 27Jul12               *
      *                 AR317587           Date 19Aug11               *
      *                 AR947093A          Date 04May12               *
      *                 AR948094           Date 13Apr11               *
      *                 AR835977           Date 29Sep11               *
      *                 AR824724           Date 05Sep11               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      *                 263903             Date 02Feb10               *
      *                 262630             Date 09Apr09               *
      *                 262540             Date 07Nov08               *
      *                 251331             Date 22Nov07               *
      *                 AR679419           Date 15Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 255239             Date 21Jul08               *
      *                 255285             Date 16Jul08               *
      *                 254593             Date 03Jun08               *
      *                 248851A            Date 03Aug07               *
      *                 CPK028             Date 24Jan08               *
      *                 249033             Date 26Jul07               *
      *                 248851             Date 10Jul07               *
      *                 247935             Date 21May07               *
      *                 246490             Date 23Mar07               *
      *                 246141             Date 26Mar07               *
      *                 251009             Date 24Oct07               *
      *                 240807             Date 29May07               *
      *                 240746             Date 29May07               *
      *                 CAS016             Date 29May07               *
      *                 245082             Date 30Jan07               *
      *                 164847             Date 30Nov06               *
      *                 236196             Date 10Nov06               *
      *                 BUG13044           Date 18Jan07               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242886             Date 11Oct06               *
      *                 242139             Date 12Sep06               *
      *                 242286             Date 26Sep06               *
      *                 240789             Date 13Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 212318             Date 06Jun06               *
      *                 210989             Date 06Jun06               *
      *                 217477             Date 06Jun06               *
      *                 205583             Date 06Jun06               *
      *                 CLE042             Date 06Sep05               *
      *                 BUG9251            Date 15Nov05               *
      *                 225656             Date 22Mar04               *
      *                 CLE036             Date 22Sep03               *
      *                 235743             Date 26Aug05               *
      *                 BUG8142            Date 16Aug05
      *                 BUG7921            Date 29Jul05               *
      *                 BUG7878            Date 25Jul04               *
      *                 CIR013             Date 25Apr05               *
      *                 232628             Date 14Mar05               *
      *                 232319             Date 28Feb05               *
      *                 231712             Date 04May04               *
      *                 CAS009             Date 04May04               *
      *                 CSW037A            Date 02May05               *
      *                 BUG5673            Date 27Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 27Oct03               *
      *                 CAP075             Date 08Aug02               *
      *                 218782             Date 23Jun03               *
      *                 CLE034             Date 05May03               *
      *                 CLE033             Date 28Apr03               *
      *                 CLE031             Date 05Feb03               *
      *                 CAS005             Date 16Dec02               *
      *                 214981             Date 21Feb03               *
      *                 208221             Date 11Dec02               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 192997             Date 11Dec02               *
      *                 200707             Date 11Dec02               *
      *                 198585             Date 24Oct02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 204786             Date 29Oct02               *
      *                 208584             Date 17Sep02               *
      *                 208622             Date 16Sep02               *
      *                 206596             Date 13Aug02               *
      *                 204128             Date 25Apr02               *
      *                 202628             Date 25Apr02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 194459             Date 21Dec01               *
      *                 185526             Date 17Oct01               *
      *                 186070             Date 17Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 192014             Date 13Jul01               *
      *                 188115             Date 29Jun01               *
      *                 165220             Date 27Jun01               *
      *                 193225             Date 03Jul01               *
      *                 CLE014             Date 20Mar01               *
      *                 183577             Date 05Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 193987             Date 31May01               *
      *                 CLE011             Date 07Nov00               *
      *                 CPB002             Date 26Sep00               *
      *                 182711             Date 24Aug00               *
      *                 157669             Date 08Dec00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 181859             Date 09Nov00               *
      *                 182576             Date 28Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      *                 172807             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 169623             Date 07Jan00               *
      *                 165975             Date 25Aug99               *
      *                 165977             Date 23Aug99               *
      *                 160856             Date 08Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 134725             Date 14Jun99               *
      *                 162327             Date 14Jun99               *
     F*                 137026             Date 27Apr99               *
     F*                 134114             Date 27Apr99               *
      *                 159095             Date 30Apr99               *
      *                 153369             Date 26Jan99               *
      *                 149915             Date 17Dec98               *
      *                 147438             Date 29Dec98               *
      *                 144911             Date 30Oct98               *
      *                 144688             Date 15Oct98               *
     F*                 138979             Date 19Oct98               *
     F*                 133936             Date 19Oct98               *
      *                 143510             Date 29Sep98               *
      *                 132738             Date 16Jun98               *
      *                 CEU020             Date 13Mar98               *
     F*                 134798             Date 07May98               *
     F*                 CEU004             DATE 29MAR98               *
     F*                 131863             DATE 11MAR98               *
     F*                 126030             DATE 26FEB98               *
     F*                 121768             DATE 19FEB98               *
     F*                 126017             DATE 17NOV97               *
     F*                 128058             DATE 15Jan98               *
     F*                 128059             DATE 23Dec97               *
     F*                 127069             DATE 12DEC97               *
     F*                 127660             Date 19Nov97               *
     F*                 CLE007             Date 11Jul97               *
     F*                 CLE005             Date 11Jul97               *
     F*                 122098             Date 16Sep97               *
     F*                 122667             DATE 10SEP97               *
     F*                 CLE004             DATE 17JUN97               *
     F*                 120391             DATE 11JUN97               *
     F*                 117326             DATE 28APR97               *
     F*                 117042             DATE 21APR97               *
     F*                 117041             DATE 11APR97               *
     F*                 116675             DATE 11APR97               *
     F*                 116678             DATE 11APR97               *
     F*                 116332             DATE 03APR97               *
     F*                 115677             DATE 18MAR97               *
     F*                 115625             DATE 17MAR97               *
     F*                 115275             DATE 10MAR97               *
     F*                 115099             DATE 05MAR97               *
     F*                 115027             DATE 04MAR97               *
     F*                 114542             DATE 20FEB97               *
     F*                 114482             DATE 19FEB97               *
     F*                 114244             DATE 13FEB97               *
     F*                 CLE003             DATE 10DEC96               *
     F*                 097885             DATE 31JAN97               *
     F*                 S01408             DATE 11SEP96               *
     F*                 104444             DATE 12JUN96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 095243             DATE 23JUL96               *
     F*                 100594             DATE 09JUL96               *
     F*                 100677             DATE 09JUL96               *
     F*                 092675             DATE 01JUL96               *
     F*                 100790             DATE 13JUN96               *
     F*                 S01408             DATE 22MAY96               *
     F*                 S01408             DATE 09APR96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 S01408             DATE 17AUG95               *
     F*                 091165             DATE 28JUL95               *
     F*                 082477             DATE 07FEB95               *
     F*                 S01518             DATE 03OCT94               *
     F*                 066550             DATE 04FEB94               *
     F*                 046647             DATE 04NOV92               *
     F*                    042529             DATE 14SEP92               *
     F*                    040790             DATE 14SEP92               *
     F*                    S01392             DATE 14SEP92               *
     F*                    000127             DATE 16JUL92               *
     F*                    BHF499             DATE 31MAR92               *
     F*                    S01270             DATE 28SEP90               *S01270
     F*                    BHF066             DATE 25JUL90               *
     F*                    E19243             DATE 27JUN90               *
     F*                    E20818             DATE 09FEB90               *
     F*                    S01194             DATE 03JAN90               *S01194
     F*                    E17410             DATE 13DEC89               *
     F*                    S01117             DATE 08/09/89              *
     F*                    E11135             DATE 08/12/88              *
     F*                    E10969             DATE 19/02/88              *
     F*                    S01147             DATE 03/12/87              *
     F*                    E47238             DATE 09/03/87              *
     F*                    E47245             DATE 14/02/87              *
0009 F*                    E48967             DATE 14/10/86              *
0009 F*                    E43682             DATE 10/10/86              *
0009 F*                    S01114             DATE 26/09/86              *
     F*                    E80945             DATE 25/06/86              *
0009 F*                    E43236             DATE 11/06/86              *
     F*                    E47145             DATE 11/06/86              *
0009 F*                                                               *
0011 F*---------------------------------------------------------------*
      *                                                               *
      *  MD050577 - Incorrect repayment principal when the outstanding*
      *             PRINCIPAL IS EQUAL TO TOTAL REPAYMENT AMOUNT FOR  *
      *             LOAN WITH REPAYMENT TYPE 3.                       *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *      
      *  MD051970 - Missing settlement amount on Customer Bills       *
      *             and Customer Confirmation                         *
      *  MD051946 - LEACCTPD amount was converted first then reduced  *
      *             by reconverting back the amount of LEREMRPD       *
      *             to PDCL currency                                  *
      *  MD050297 - Past due amount 0 in SP15 for 8 loans when not    *
      *             zero in SP01.                                     *      
      *  MD046248 - Finastra Rebranding                               *
      *  MD046080 - Gap between CLE031 (Settlement to different       *
      *             currency) and CLE134 (PDCL processing)            *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  MD037495 - Incorrect Repayment Priority Retrieved for        *
      *             category code ZPRIM                               *
      *           - Pass CLOANZTD as the file parameter when accessing*
      *             program LE000801                                  *
      *  AR1057551 - Some loans incorrectly post interest repayments  *
      *              even though repayment type is 2 (no interest)    *
      *              - in R4 these interest payments are not posted.  *
      *              Applied for MD044778.                            *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  MD038509 - Blank Customer Code inserted to CLOANZTD          *
      *             for an MR with auto C against a PDCL with Auto Y  *
      *  CLE154 - Loan Repayment Schedule Enhancement                 *
      *           (Amendable Payment Type)                            *
      *  AR897086 - Amended program to ensure that INTDUE will not be *
      *             zeroised when interest rate (INTRAT) has sign     *
      *             opposite the interest due.                        *
      *           - Applied for MD033488                              *
      *  CLE164 - CLE134 Enhancement F (Repayment Methodology)        *
      *  230712 - Incorrect maturity interest outstanding in LOAC due *
      *           to incorrect action of interest adjustment when the *
      *           system is not in daily accruals setup.              *
      *  MD028338 - Interest calculation has rounding difference for  *
      *             Rollover of Facility Exchange Rate only. Add new  *
      *             field to flag rollover as 'FX Rate Change Only'.  *
      *             If this is Y, do not update Accrued Interest.     *
      *  MD026266 - Loan does not mature as expected.                 *
      *           - When field NACTN5 is 99999 and it is added by 1   *
      *             it becomes 0 and this cause *IN24 and *IN44       *
      *             to be off and record 'CO' not output to ACTN5DN.  *
      *             Fix is to switch on *IN24 when NACTN5 is increased*
      *             by 1 althoug the result is zero.                  *
      *  MD020985 - LEC07 and LEC0702 failed in COB.                  *
      *           - Indicator 40 is used in writing the header file.  *
      *             Unfortunately, AR989420 and AR786878 reused it    *
      *             that caused multiple header record being written. *
      *  AR790759 - Negative Past due amount cause by maturity event. *
      *             Consider PD principal for outstanding principal   *
      *             to ensure 'RE' and 'PD" will not cause for loan   *
      *             'MA' event to overdraft. (Child: AR790760)        *
      *  AR989420 - Repayment of PDCLs should use Original Loan       *
      *             Value Date instead of PDCL Value Date. Amend      *
      *             setting of SEVDAT in LEACCTPD and in LEREMRPD.    *
      *             (Child: AR989424)                                 *
      *  AR815697 - New processing for maturity events of PDCL's.     *
      *             (Child: AR815698)                                 *
      *  AR786878 - New processing for manual repayment and           *
      *             repayment schedule for PDCL's. (Child:AR786879)   *
      *  AR830785 - Recompiled due to changes in core hook RULE78Z1.  *
      *             (Child: AR830786)                                 *
      *  AR1088476 - Wrong In Date for RO in LOAC. Reverse AR835977   *
      *              to use RUND in writing Last Change Date.         *
      *              (Child: AR1088477)                               *
      *  AR1084876 - System generated erroneous interest payment      *
      *              movement for Demand Loan.                        *
      *  260891 - Wrong projection in LOAC. Add LCD as a key.         *
      *           Recompiled due to changes in LF/HISTR.              *
      *  AR1078348 - LEC06A SEQ 00009 failed during Day2 COB.         *
      *              Pointer or parameter error.                      *
      *  AR1009681 - Erroneous Interest Expected amount in MAPY       *
      *              (Outstanding Interest to Date and Interest       *
      *              Interest Expected Amount should be the same)     *
      *  AR737209 - Incorrect accrued interest for PDCL loans with    *
      *             manual interest adjustment. Amend SR/INTSDY,      *
      *             do not include MI, LS and BH on calculation.      *
      *             Applied fix 255216. (Child: AR737210)             *
      *  AR810495 - Added condition for ADDI B on SR/INTCAL to correct*
      *             interest computation on maturity.                 *
      *             Formalised fix on-site. (Child: AR810496)         *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  259707 - Initialise LONTYP and SUBTYP with correct values    *
      *           when amendment type LS is already on history and no *
      *           re-computation will be done on today's COB.         *
      *           Apply fix 229669.                                   *
      *  AR316218 - Invalid data for fields introduced by CAS005 in   *
      *             HISTS* files. Preventive fix - set fields to zero *
      *             if CAS005 is switched off.                        *
      *  AR317587 - Matured Loan can't be recovered using maturity    *
      *             date as the value date of the manual repayment.   *
      *             Amended program to allow value date of MR greater *
      *             than Maturity date for past due loans.            *
      *             (Child: AR810533)                                 *
      *  AR947093A - Base Rate amendment resulted to 0 interest rate  *
      *  AR948094 - Only base rate was captured when loan was rolled  *
      *             over                                              *
      *  AR835977 - Show future IN Date (Child:AR836855)              *
      *  AR824724 - CRE073 fields not updated properly                *
      *  CRE073 - Interest Rate Rounding                              *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  263903 - Consider Payment Taken Indicator when producing     *
      *           Cash Flows                                          *
      *  262630 - Rework fix 240746, which caused suppression of      *
      *           cash flows for interest payments.                   *
      *  262540 - Incorrect accrual due to incorrect value of fields  *
      *           added by CAS005. Increase length of HISTS* files.   *
      *  251331 - Loan Reactivation should be correctly reflected in  *
      *           loan history.  Negative MRs should be included.     *
      *  AR679419 - No Outstanding interest displayed in LOAC         *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  255239 - Sub-type change: wrong entries on loan accounts.    *
      *           applied fix 227657                                  *
      *           Loan Subtype (SUTP) is incorrectly saved to HISTSHP *
      *           when a backvalued repayment is procesed with value  *
      *           date earlier than the last loan subtype change.     *
      *  255285 - rate/spread was not populated correctly.            *
      *  254593 - Applied core fix 253571 from 1.2.1 plus additional  *
      *           validation.                                        *
      *  253571 - Additional interest generated on maturity even if   *
      *           the loan was early settled. Enhance 248851 to       *
      *           consider accrued interest adjustments before        *
      *           comparing to interest paid/received to date.        *
      *  248851A- Prevent data corruption of interest header file     *
      *           value date, accrued interest to date, and interest  *
      *           paid/received to date.                              *
      *  CPK028 - Customer numbers should be alphanumeric.            *
      *  249033 - Don't update RATSPD with the value of RTSP if       *
      *           IRCF is not equal to 'Y'                            *
      *  248851 - Recalculate loan history if AITC less than IPRD or  *
      *           principal in loan detail not equal principal in     *
      *           history file.                                       *
      *  247935 - Field TPRAM not being cleared and led to a large    *
      *           accrual amount to be generated on the maturity.     *
      *  246490 - Invalid data on ROLN field in LOAMSDK after COB     *
      *           (Apply GEMS 235579 and 244214A). Include remaining  *
      *           LOAMS fields RSTM, FRAM, FINT, FIXA and FTOT        *
      *  244214A - Rest of fields for LOAM record still has           *
      *            corrupt value ('++++'). Further amendment          *
      *            to 244214 / 235579.                                *
      *  244214 - Data Mapping error when confirming authorise of     *
      *           a Principal Transfer (apply GEMS 235579).           *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  251009 - Applied fixes 240956 and 243816.                    *
      *  240807 - Cashflow Midas Day number not consistent with       *
      *           cashflow date (FLDATE) in the file.                 *
      *  240746 - Data Corruption on Interest Cashflows               *
      *  CAS016 - IAS18 EIR Recalculation (Fee Amortisation Over      *
      *           Whole Period)                                       *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Applied fix 235784 from Release 4.                  *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  236196 - Output all movements across the loan since the last *
      *           statement in INTST* files, even if CLE003 is on.    *
      *  BUG13044 - Principal amount cash flow does not appear on     *
      *              future dated loan.                               *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242886 - Because of fix 124102 in LE0390, BUG9251 and 7878   *
      *           should be amended to correct postings for loans     *
      *           with REPT = 3 and CPAM < RAMT.                      *
      *  242139 - CPAM of ST record equal to zero when CAS005 is on.  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  240789 - Lending Module - The Loan past due reversal issue.  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  212318 - AITC and LVDAT should not be updated by loan        *
      *           subtype change. Applied fixes 190115 and 192020.    *
      *  210989 - Ensure MA record written in CUTX1HP has correct     *
      *           backvalued movement indicator.                      *
      *  217477 - When CLE003 is on, no processing takes place for    *
      *           'BH' records. As a result, LVDAT should not be      *
      *           updated. Otherwise, if there is a 'BH' record       *
      *           with the same value date as a 'MI' record but       *
      *           no other actions, the accrued interest from the     *
      *           previous action up to this value date will be       *
      *           missed.                                             *
      *  205583 - SPIN field is not being defaulted to 'A' when a     *
      *           rollover is input without any details causing       *
      *           wrong calculations on interest postings. Apply fix  *
      *           204636.                                             *
      *  CLE042 - Extended Loan Sub Type                              *
      *  BUG9251 - Wrong CF projection on repayment type 3 (Applied   *
      *            fix 233176)                                        *
      *  225656 - CPAM needs to be set to the new principal of the    *
      *           rollover when a facility exchange rate has been     *
      *           defined. Fix to CLE031                              *
      *           For an action file record, should set CPAM to       *
      *           action amount PRAM. For a history record, should    *
      *           set CPAM to the Rollover Principal amount.          *
      *  CLE036 - Lending Enhancements for Nordea Phase 1 Priority 2: *
      *           Allow specific base rates                           *
      *           Allow repayments in facility currency               *
      *  235743 - LE UDC multiple print of the same statement.        *
      *           Patterned after fix 225103.                         *
      *  BUG8142- The repayment amount is missing the interest amount *
      *           The ACTNnDK file has the full repayment as input    *
      *           but only the principal is being output to ACTN5DK   *
      *  BUG7921 - Difference in outstanding interest for loans with  *
      *            stop accruals.                                     *
      *  BUG7878 - Incorrect repayment amount when remaining          *
      *            principal is less than the repayment amount.       *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  232628 - CAS009 Rollover patch (LE).                         *
      *  232319 - Rate shown in LE004620 is incorrect                *
      *  231712 - Generate a separate cash flow record for interest   *
      *           repayments.                                         *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG5673 - Backvalued start accruals are not properly         *
      *            processed when processing loan actions.            *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  CAP075 - Lending API enhancements - Loan Amendment.          *
      *           (amendment in common with CAP079)                   *
      *  218782 - Check system value Settlement09Postings to decide   *
      *           whether to use Settlement or Transaction Ccy.       *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *  CLE033 - Settlement method 09 processing                     *
      *  CLE031 - Lending Enhancements.                               *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  214981 - Amortisation incorrect for Rules of 78 loans.       *
      *  208221 - Changes identified during alpha site                *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  192997 - Incorrect interest calculation due to a backvalued  *
      *           rollover.  The rate should be updated properly in   *
      *           the history file for a backvalued rollover.         *
      *  200707 - Switch on *IN78 when SUMONT is greater than or      *
      *           equal to zero.                                      *
      *  198585 - Wrong calculated interest after backvalued 'BC'.    *
      *           During 'IH' update, check if backvalued base rate   *
      *           code change is 'Y' before populating the base rate  *
      *           code and base rate fields with the new values.      *
      *  204786 - Funding rate is corrupted when a rollover was       *
      *           processed during Close of Business.                 *
      *  208584 - Reverse core fix 186070.                            *
      *  208622 - HISTSHQ's CPAM field is zeroised when MROLL         *
      *           subroutine is executed during historic records      *
      *           processing, eventually, causing the reversal of     *
      *           all interest accrual.                               *
      *           Prevent the updating of CPAM with zero amount.      *
      *  206596 - Do not process loan amendments if they are greater  *
      *           than the maturity date of the loan.                 *
      *  204128 - Confo and telex generation should only be done for  *
      *           records from ACTN4 file.                            *
      *  202628 - Output a record to CONFSDK for Principal Transfers  *
      *           From (PF).                                          *
      *  194459 - History file replication indicator needs setting    *
      *           for TOF. Separate HISTSHP WREPI from CLOANCL REPI.  *
      *  185526 - PAMONT should have amount in new currency for 'MC'. *
      *  186070 - Incorrect interest accrual when loan subtype was    *
      *           changed twice.                                      *
      *           Subroutine MCLSSR was amended in order not to       *
      *           update AITC field when loan subtype is changed.     *
      *  192014 - Amendment type 'MI' should not perform int. calc    *
      *           when it is from the history files (*IN12='0').      *
      *           This is to prevent a 0.01 discrepancy.  Applied fix *
      *           188044 to SR/MIADJ only.                            *
      *  188115 - Interest calculation still using old rate after     *
      *           a backvalued spread rate change.                    *
      *  165220 - Subtract one day when computing interest : if Stop  *
      *           Accrual's value date is equal to the event control  *
      *           date and if the loan is set to accrue on last day.  *
      *  193225 - Wrong accounting generated when a forward valued    *
      *           multi-currency rollover is logged.                  *
      *           Fix is to switch off *IN81 in subroutine MROLL      *
      *           even if no multi-currency action record is written  *
      *           on ACTN5DK file.                                    *
      *  CLE014 - Customer Driven Lending Enhancements                *
      *  183577 - Repayment not taken into account when rolling over  *
      *           principal to EUR. Fix 147438 is also required for   *
      *           repayment types 1 and 2.                            *
      *  193987 - Remove fix 182711. It is only required in LE0450.   *
      *           Reinstate 160856.                                   *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CPB002 - Meridian DBA Middleware Replication Customization.  *
      *  182711 - B/vaued Repayment,type 2,treated as if with accrued *
      *           interest even if the repayment type is 2            *
      *           Remove fix 160856                                   *
      *  157669 - Calculation of Cost of Funds is wrong when actions  *
      *           are back-valued:-                                   *
      *           In STREC, initialise COFRAT and CVDAT if CLE003 is  *
      *           'Y', so that COF is calculated correctly in INTCAL. *
      *  181859 - Loan payment due advice not being generated.        *
      *           Applied fix 167279.                                 *
      *           Also apply code not to generate advice if record    *
      *           comes from history or CBLY not'Y'                   *
     F*  182576 - Recompile over changed version of HISTS             *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  172807 - Zero Interest payments after a multi-ccy rollover.  *
      *           Update OSPRIN in MROLL with new principal amount.   *
      *           Zeroise CPAM and INTR if CLE003 is off. Only use    *
      *           INTR in MROLL if CLE003 is on.                      *
      *  169623 - Missing Account keys for a multi-currency rollover  *
      *           and maturity date becomes 0 even the loan is a term *
      *           loan.                                               *
      *  165977 - CPAM field of 'MC' record should be updated for     *
      *           discount loans.                                     *
      *  165975 - ECIN field should not be set-up here.  This was     *
      *           already done in LE0390.                             *
      *  160856 - Incorrect matured amount due to backvalued          *
      *           principal increase. Applied fix 158698.             *
      *  134725 - PSAM of original loan should be updated if there is *
      *           a multi-ccy rollover.                               *
      *  162327 - Amount Sold on primary Loan is still not correct.   *
      *  137026 - Loan has not started yet but it has already         *
      *           accrued interest. Apply 086550.                     *
      *  134114 - Interest discrepancy is encountered when the loan   *
      *           subtype is amended on the same day the backvalued   *
      *           loan is entered.  Subroutine MCLSSR was amended in  *
      *           such a way that the Interest Header Value Date is   *
      *           not altered if a backvalued loan is inserted.       *
      *  159095 - Amount Sold on primary Loan is not correct          *
     F*  153369 - Future valued Manual Repayments should generate     *
     F*           SWIFT message in COB.                               *
      *  149915 - Amount sold exceeds loan amount.                    *
      *  147438 - Multi-currency rollover not working for repay 3.    *
      *  144911 - Interest calculation basis becomes 0 after multi-   *
      *           ccy rollover.                                       *
      *  144688 - Include all types of loan that can be rolled over.  *
     F*  138979 - Check if CLE004 lending enhancement is on before    *
     F*           processing rollovers of discounted participations   *
     F*           sold and purchased. Amendment to 122098.            *
     F*  133936 - Remove the coding that initializes PRINRO and       *
     F*           DISCRO to zero. This zeroises the outstanding prin- *
     F*           cipal if the record read is from the history file.  *
      *  143510 - Negative interest outstanding after multi-ccy       *
      *           rollover.                                           *
     F*  132738 - Customer name, address & principal/interest total   *  *
     F*           due not being printed on LE0540P2 confo.            *
     F*           Cause of error is fix 092675.  CTRQ should not be   *
     F*           reset as it is being used in LE0540. Error          *
     F*           092675 has already been fixed by 065665 in LE0370.  *
     F*  CEU020 - EMU Lending Multi-currency Rollover                 *
     F*  134798 - Missing EMU codes                                   *
     F*  CEU004 - EMU Lending Settlement Currency Conversion.         *
     F*  131863 - Backvalued BC results in subsequent RO record       *
     F*           updated to interest rate of BC, backvalued BC       *
     F*           should not carry interest charge through to RO.     *
     F*  126030 - Maintain correct principal amount when principal is *
     F*           reduced by Rollover of discounted loan. OSPRIN      *
     F*           should be reduced.                                  *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  128058 - No loan amendment confirmations produced in COB.    *
     F*           Allowance for increased length of LOAMSDKF must     *
     F*           be made when outputting LETLXDK and CONFSDK as      *
     F*           well as ACTN5DK. (Partially fixed under CLE007      *
     F*           development)                                        *
     F*  128059 - Action records for rollovers may have rate/spread   *
     F*           with blank spread indicator. Change to 'A' so that  *
     F*           sr/qntrat will calculate the new rate.              *
     F*  127069 - For multi-currency rollover the new currency is     *
     F*           output to original currency field, plus some fields *
     F*           are dropped.                                        *
     F*  127660 - FOOB in HISTS                                       *
     F*  CLE007 - Customer Lending Enhancements - Others              *
     F*  CLE005 - Customer Lending Enhancements - Tranche 3           *
     F*  122098 - Add processing to calculate the details for rollover*
     F*           of Discounted PP/PSs.                               *
     F*  122667 - MNSG, GASS, GPRT AND ROLN are not written to        *
     F*           HIUPDHP                                             *
     F*  CLE004 - Customer Lending Enhancements - Syndications        *
     F*           Tranche II.                                         *
     F*  120391 - Start record on history corrupt when loan start
     F*           processed not the same date as loan input i.e.
     F*           forward-valued
     F*         - History not being dropped on reversal when CLE003 on
     F*         - Bills / Telexes processing corrupted by CAC001 - LOTH
     F*           needs to be redefined on input, so as to be output
     F*           correctly to INSTS* and CUTX*
     F*  117326 - When a 'BR' is back-valued to start, the processing *
     F*           of the new fields (CLE003) is by-passed.            *
     F*  117042 - Accrued Interest to Control Date not updated when   *
     F*           first action record is 'BR' or 'LS'.                *
     F*           Similar correction to Stop Accrual processing.      *
     F*  117041 - IH records are missing.                             *
     F*  116675 - Ensure REPTYP is set.                               *
     F*  116678 - The five new fields, CPAM, AITC, INTR, AIAP and     *
     F*           IPRD should not be maintained.                      *
     F*  116332 - Accrued interest to control date error.             *
     F*  115677 - Previous fix (115625) causes file control problems  *
     F*           with History file.                                  *
     F*  115625 - Interest Payment on a frequency is zero, accrual    *
     F*           shows total from start of loan as outstanding and   *
     F*           multiple 'IH' records are output.                   *
     F*  115275 - 'PI' backvalued to loan start and 'MR' backvalued   *
     F*           on day of maturity are not processed correctly as   *
     F*           the current principal is reset when the 'IH' is     *
     F*           processed.                                          *
     F*  115099 - New fields for CLE003 are not written correctly to  *
     F*           the start date records for discounted loans.        *
     F*  115027 - Update ICALCB only if it's A ROLLOVER or a start    *
     F*           record.                                             *
     F*           Don't update LVDAT if it's Manual Interest Adjustment
     F*  114542 - Rollover rates not written to rollover record       *
     F*         - Int paid/received not updated when last action      *
     F*           processed is an interest payment.                   *
     F*         - Stop/start accruals not processed correctly. AITC   *
     F*           still gets updated with wrong amount.               *
     F*  114482 - MI records are corrupting AITC.                     *
     F*  114244 - Half Adjust accrued interest fix.                   *
     F*  CLE003 - Back-Valued Loan Amendments.                        *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  S01408 - Addition of core hook LE0400CP23                    *
     F*           Addition of core hook LE0400CP22                    *
     F*           Addition of core hook LE0400CP21                    *
     F*           Addition of core hook LE0400CP20                    *
     F*  104444 - Output to history files incorrect. Fields are in    *
     F*           wrong positions.                                    *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           Calculate COF interest amount.                      *
     F*  095243 - Incorrect backvalued header record output to HIUPD  *
     F*           for new loans/amendments, causing FCOOB in LE0900.  *
     F*           Fix is to set on *IN47 rather than *IN46 for a new  *
     F*           loan.                                               *
     F*  100594 - LS actions are being dropped from the history       *
     F*           file the next time that the loan is actioned.       *
     F*           Amended the subroutine MCLSSR to output the         *
     F*           record whether or not it is from the action         *
     F*           file.                                               *
     F*  100677 - 0 interest put in history when interest record is   *
     F*           output at the same day with loan subtype amendment. *
     F*  092675 - SOME STATEMENTS ARE PRODUCED DAILY IN LE0540 WITHOUT*
     F*           ACTIONS. RESET CTRQ, CUTX1HP WILL NOT BEEN WRONGLY  *
     F*           LOADED.                                             *
     F*  100790 - Loan Payment Int. Advice produced with No. of Days  *
     F*           Interest Calc. set to 0. Fix is to move value of    *
     F*           ZZINDY to ZDAYN1 before writing to filw SCUTX.      *
     F*  S01408 - Addition of core hook LE0400CCP6                    *
     F*           Addition of core hook LE0400CCP7                    *
     F*           Addition of core hook LE0400CCP8                    *
     F*           Addition of core hook LE0400CCP9                    *
     F*           Addition of core hook LE0400CP10                    *
     F*           Addition of core hook LE0400CP11                    *
     F*           Addition of core hook LE0400CP12                    *
     F*           Addition of core hook LE0400CP13                    *
     F*           Addition of core hook LE0400CP14                    *
     F*           Addition of core hook LE0400CP15                    *
     F*           Addition of core hook LE0400CP16                    *
     F*           Addition of core hook LE0400CP17                    *
     F*           Addition of core hook LE0400CP18                    *
     F*           Addition of core hook LE0400CP19                    *
     F*           Addition of core hook LE0400CP20                    *
     F*           Addition of core hook LE0400OOP1                    *
     F*  S01408 - Addition of core hook LE0400CCP5                    *
     F*           Addition of core hook LE0400CCP4                    *
     F*           Addition of core hook LE0400CCP3                    *
     F*           Addition of core hook LE0400IIP2                    *
     F*           Addition of core hook LE0400IIP1                    *
     F*           Addition of core hook LE0400FFP1                    *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*    S01408 - Core hook added LE0400CCP1                           *
     F*             Core hook added LE0400CCP2                           *
     F*    091165 - 'PI' history records are being extracted to          *
     F*              PTSLDPT file causing the sold amount of a           *
     F*             loan to be corrupted in LE0450.                      *
     F*    082477 - Remove S01114, which was to include Risk Loans in    *
     F*             Demand Loan Interest Statement - guarantees do not   *
     F*             normally have interest.  If a client wants the report*
     F*             to include risk loans, this SAR can be reinstated,   *
     F*             but pgm LE0630 must be amended to print 'Risk Loan'  *
     F*             instead of 'Demand Loan' for a risk loan, and the    *
     F*             report name in RCF must be changed.                  *
     F*  S01518 - BLI Lending SWIFT Enhancements.                     *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
     F*     046647  -  LS ACTIONS IN HISTORY CORRUPT ACTIONS              042529
     F*     042529  -  WHEN A LOAN MATURES, PROCESSING TYPES 70 ARE NOT   042529
     F*                DROPPED FROM THE HISTORY FILE                      042529
     F*     040790  -  IF an action is BACK- VALUED (*IN62 = 1)           040790
     F*                DO NOT reinitialise the running totals with the    040790
     F*                information from the 'BH' record                   040790
     F*  S01392  -  JAPANESE SUB MODULE ENHANCEMENTS                     *S01392
     F*  000127  -  Problem when have maturity record on ACTN3DK and     *
     F*             'LS' record on HISTSHP. SR/HIST had no processing    *
     F*             for 'LS'.                                            *
     F*     BHF499  -  PART SOLD NOT UPDATED FOR PRINCIPAL INCREASE      *BHF499
     F*                ON THE LOAN THE PART SOLD IS BOOKED AGAINST.      *BHF499
     F*                APPLY NY ERROR FIX E21301                         *BHF499
     F*     S01270  -  CUSTOMER LENDING CHANGES.                         *S01270
     F*     BHF066  -  CHANGE MADE UNDER MULTI-BRANCHING SAR NUMBER      *BHF066
     F*                DID INCORRECT COMPARISON OF SIGN OF PRINCIPAL     *BHF066
     F*     E19243  -  SAVE VALUE OF BASE RATE TO NEWBRT BEFORE THIS     *E19243
     F*                FIELD IS USED.                                    *E19243
     F*     E20818  -  REMOVE FIX E48967 - PRINCIPAL SHOULD BE OUTPUT.   *E20818
     F*     S01194  -  STANDING DATA CHANGES.                            *S01194
     F*     E17410  -  WRONG INTEREST DUE AND INTEREST RATE SHOWN ON     *E17410
     F*                INTEREST ADVICE.                                  *E17410
     F*     S01117  -  MULTIBRANCHING                                    *S01117
     F*     E11135  -  NUMBER OF RECORDS NOT UPDATED CORRECTLY.          *E11135
     F*     E10969  -  DEMAND LOAN INTEREST STATEMENTS NOT OUTPUT FOR    *E10969
     F*                DEMAND LOANS.                                     *E10969
     F*     S01147  -  RELEASE 22 (AMENDMENT TO GLINTC)                  *S01147
     F*     E47238  -  WHEN BASE RATE CHANGE IS BACK-VALUED TO LAST      *E47238
     F*                ACTIONED ROLLOVER DATE,THE OLD RATE ON HISTORY    *E47238
     F*                FILE IS NOT UPDATED.                              *E47238
     F*     E47245  -  INDICATOR 30 USED IN A PECO HAS ALREADY           *E47245
     F*                BEEN USED FOR INTEREST CAPITALIZATION.            *E47245
     F*     S01114  -  CHANGE OUTPUT RECORDS FOR INTEREST STATEMENTS     *S01114
     F*                FOR RISK LOANS                                    *S01114
0011 F*     E80945  -  INDICATOR 98 SETTING IS SAVED AND RESTORED        *E80945
0011 F*                WHEN S.R.GLINTC IS PERFORMED.                     *E80945
0008 F*                                                                  *
     F*     E43682  -  CALCULATION OF WITHOLDING TAX WAS PRODUCING RESULT*E43682
     F*                THAT HAD RECURRING PART THAT WOULD NOT ROUND UP.  *E43682
     F*                IF THERE IS A RESULT WITH DECIMAL IN THE REGION   *E43682
     F*                OF 0.4444 THEN ROUND UP RESULT BY ONE. (SUBROUTINE*E43682
     F*                WHTAX)                                            *E43682
     F*                                                                  *
     F*     E48967  -  THE TOTAL AMONT FIELD ON THE 'MA' RECORD FOR A    *E48967
     F*                RISK LOAN INCLUDES THE PRINCIPAL & OUTSTANDING    *E48967
     F*                INTEREST AMOUNT.                                  *E48967
     F*                                                                  *
     F*****************************************************************
0013 F***HISTS***IP AF     100 25AI     3 DISK                            CAC001
     F***HISTS***IP AF     118 25AI     3 DISK                     CAC001 CLE003
     F***HISTS***IP AF     152 25AI     3 DISK                     CLE003 157669
     F***HISTS***IP AF     179 25AI     3 DISK                               157669           CLE028
     F***HISTS** IP AF     185 25AI     3 DISK                                         CLE028 CAS005
     F*HISTS***IP*AF*****227 25AI     3 DISK                                           CAS005 CLE042
     F***HISTS** IP AF     231 25AI     3 DISK                                         CLE042 CRE073
     FHISTS   IP AF     247 25AI     3 DISK                                                   CRE073
0014 F***ACTN4***IS AF     320 25AI     3 DISK                            S01518
     F***ACTN4***IS AF     949 25AI     3 DISK                     S01518 CAC001
     F***ACTN4***IS AF     969 25AI     3 DISK                     CAC001 CLE004
     F***ACTN4***IS AF    1057 25AI     3 DISK                     CLE004 CLE005
     F***ACTN4***IS AF    1060 25AI     3 DISK                     CLE005 CEU004
     F***ACTN4***IS AF    1066 25AI     3 DISK                     CEU004 CEU020
     F***ACTN4***IS AF    1067 25AI     3 DISK                                         CEU020 CLE028
     F***ACTN4** IS AF    1075 25AI     3 DISK                                         CLE028 CAS005
     F***ACTN4** IS AF    1089 25AI     3 DISK                                         CAS005 CLE031
     F***ACTN4** IS AF    1108 25AI     3 DISK                                         CLE031 CLE034
     F***ACTN4** IS AF    1109 25AI     3 DISK                                         CLE034 CAP075
     F***ACTN4** IS AF    1176 25AI     3 DISK                                         CAP075 CGL029
     F***ACTN4** IS AF    1230 25AI     3 DISK                                         CGL029 CLE036
     F*ACTN4***IS*AF****1268 25AI     3 DISK                                           CLE036 CLE042
     FACTN4   IS AF    1291 25AI     3 DISK                                                   CLE042
      *                                                                   149915
     FCLOAN   IF  E           K        DISK                               149915
     F            CLOANHHF                          KIGNORE               149915
     F**********  CLOANCKF                          KIGNORE                          149915 MD028338
     F            CLOANZ1F                          KIGNORE               149915
      *                                                                   149915
     FHISTR   IF  E           K        DISK                                                   248851
     F            HISTSHMF                          KIGNORE                                   248851
     F            HISTSHPF                          KRENAMEHISTRPF                            248851
     F            HISTSHQF                          KRENAMEHISTRQF                            248851
     FLOAMSLB IF  E           K        DISK                                                 AR790759
     F            LOAMSDKF                          KRENAMELOAMS5F                          AR790759
     FLEHISTLDIF  E           K        DISK                                                 AR317587
     F            HISTSHMF                          KRENAMEHISTM1F                          AR317587
     F            HISTSHNF                          KRENAMEHISTN1F                          AR317587
     F            HISTSHPF                          KRENAMEHISTP1F                          AR317587
     F            HISTSHQF                          KRENAMEHISTQ1F                          AR317587
     FLEACT3L2IF  E           K        DISK                                                 AR317587
     F            LOAMSDKF                          KRENAMEACTN3PF                          AR317587
0015 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0016 FHIUPDHH O   F     100            DISK
0016 F***HIUPDHM*O   F     100            DISK                            CAC001
0016 F***HIUPDHN*O   F     100            DISK                            CAC001
0016 F***HIUPDHP*O   F     100            DISK                            CAC001
0016 F***HIUPDHQ*O   F     100            DISK                            CAC001
     F***HIUPDHM*O   F     118            DISK                     CAC001 CLE003
     F***HIUPDHM*O   F     152            DISK                     CLE003 157669
     F***HIUPDHM O   F     179            DISK                                         157669 CAS005
     F*HIUPDHM*O***F*****214            DISK                                           CAS005 CLE042
     F***HIUPDHM O   F     218            DISK                                         CLE042 CRE073
     FHIUPDHM O   F     247            DISK                                                   CRE073
     F***HIUPDHN O   F     118            DISK                                         CAC001 CAS005
     F***HIUPDHN O   F     132            DISK                                         CAS005 CRE073
     FHIUPDHN O   F     161            DISK                                                   CRE073
     F***HIUPDHP* O   F     107            DISK                    CAC001 CLE003
     F***HIUPDHP O   F     141            DISK                     CLE003 122667
     F***HIUPDHP O   F     150            DISK                     122667 157669
     F***HIUPDHP O   F     177            DISK                     157669 CPB002
     F***HIUPDHP*O   F     178            DISK                               CPB002           CLE028
     F***HIUPDHP O   F     185            DISK                                         CLE028 CAS005
     F*HIUPDHP*O***F*****227            DISK                                           CAS005 CLE042
     F***HIUPDHP O   F     231            DISK                                      CLE042 AR1057551
     FHIUPDHP O   F     232            DISK                                                AR1057551
     F***HIUPDHQ*O   F     113            DISK                     CAC001 CLE003
     F***HIUPDHQ*O   F     147            DISK                     CLE003 127069
     F***HIUPDHQ*O   F     151            DISK                     127069 157669
     F***HIUPDHQ O   F     178            DISK                                         157669 CAS005
     F***HIUPDHQ O   F     206            DISK                                         CAS005 CRE073
     FHIUPDHQ O   F     235            DISK                                                   CRE073
0016 FHIUPDZX O   F     100            DISK
0017 FACTN5DH O   F     320            DISK
0017 F***ACTN5DK*O   F     320            DISK                            S01518
     F***ACTN5DK*O   F     949            DISK                     S01518 CAC001
0017 F***ACTN5DN*O   F     320            DISK                            CAC001
     F***ACTN5DK O   F     969            DISK                     CAC001 CLE004
     F***ACTN5DK*O   F    1057            DISK                     CLE004 CLE005
     F***ACTN5DK*O   F    1060            DISK                     CLE005 CEU004
     F***ACTN5DK*O   F    1066            DISK                     CEU004 CEU020
     F***ACTN5DK*O   F    1067            DISK                               CEU020           CLE028
     F***ACTN5DK O   F    1075            DISK                                         CLE028 CAS005
     F***ACTN5DK O   F    1089            DISK                                         CAS005 CLE031
     F***ACTN5DK O   F    1108            DISK                                         CLE031 CLE034
     F***ACTN5DK O   F    1109            DISK                                         CLE034 CAP075
     F***ACTN5DK O   F    1176            DISK                                         CAP075 CGL029
     F***ACTN5DK O   F    1230            DISK                                         CGL029 CLE036
     F*ACTN5DK*O***F****1268            DISK                                           CLE036 CLE042
     FACTN5DK O   F    1291            DISK                                                   CLE042
     F***ACTN5DN O   F     344            DISK                                         CAC001 CAS005
     F*ACTN5DN*O***F*****365            DISK                                           CAS005 CLE042
     FACTN5DN O   F     369            DISK                                                   CLE042
     FLELEGDPDO   E                    DISK                      A                            CLE134
0017 FACTN5ZX O   F     320            DISK
0018 FLETLXHH O   F     320            DISK
0018 F***LETLXDK*O   F     320            DISK                            S01518
     F***LETLXDK*O   F     949            DISK                     S01518 CAC001
     F***LETLXDK*O   F     969            DISK                     CAC001 CLE005
     F***LETLXDK*O   F    1060            DISK                     CLE005 CEU004
     F***LETLXDK*O   F    1066            DISK                     CEU004 CEU020
     F***LETLXDK*O   F    1067            DISK                               CEU020           CLE028
     F***LETLXDK O   F    1075            DISK                                         CLE028 CAS005
     F***LETLXDK O   F    1089            DISK                                         CAS005 CLE031
     F***LETLXDK O   F    1108            DISK                                         CLE031 CLE034
     F***LETLXDK O   F    1109            DISK                                         CLE034 CAP075
     F***LETLXDK O   F    1176            DISK                                         CAP075 CGL029
     F***LETLXDK O   F    1230            DISK                                         CGL029 CLE036
     F*LETLXDK*O***F****1268            DISK                                           CLE036 CLE042
     FLETLXDK O   F    1291            DISK                                                   CLE042
0018 FLETLXZX O   F     320            DISK
0019 FCONFSHH O   F     320            DISK
0019 F***CONFSDK*O   F     320            DISK                            S01518
     F***CONFSDK*O   F     949            DISK                     S01518 CAC001
     F***CONFSDK*O   F     969            DISK                     CAC001 CLE005
     F***CONFSDK*O   F    1060            DISK                     CLE005 CEU004
     F***CONFSDK*O   F    1066            DISK                     CEU004 CEU020
     F***CONFSDK*O   F    1067            DISK                                         CEU020 CLE028
     F***CONFSDK O   F    1075            DISK                                         CLE028 CAS005
     F***CONFSDK O   F    1089            DISK                                         CAS005 CLE031
     F***CONFSDK O   F    1108            DISK                                         CLE031 CLE034
     F***CONFSDK O   F    1109            DISK                                         CLE034 CAP075
     F***CONFSDK O   F    1176            DISK                                         CAP075 CGL029
     F***CONFSDK O   F    1230            DISK                                         CGL029 CLE036
     F*CONFSDK*O***F****1268            DISK                                          CLE036 CLE042
     FCONFSDK O   F    1291            DISK                                                   CLE042
0019 FCONFSZX O   F     320            DISK
0020 FINTSTHH O   F     100            DISK
0020 F*INTSTHN*O***F*****100            DISK                                                  CLE042
0020 FINTSTHN O   F     104            DISK                                                   CLE042
0020 FINTSTHQ O   F     100            DISK
0020 FINTSTZX O   F     100            DISK
0021 FCUTX1HH O   F     100            DISK
0021 F***CUTX1HN*O   F     100            DISK                            CLE004
     F***CUTX1HN O   F     134            DISK                                         CLE004 CLE028
     FCUTX1HN O   F     135            DISK                                                   CLE028
0021 F***CUTX1HP*O   F     100            DISK                            CLE004
     F***CUTX1HP*O   F     135            DISK                     CLE004 CEU004
     F***CUTX1HP*O   F     138            DISK                               CEU004           CLE028
     F***CUTX1HP O   F     145            DISK                                         CLE028 CLE031
     FCUTX1HP O   F     153            DISK                                                   CLE031
0021 F***CUTX1HQ*O   F     100            DISK                            CLE004
     FCUTX1HQ O   F     138            DISK                               CLE004
0021 FCUTX1ZX O   F     100            DISK
0022 FPTSLDHH O   F      40            DISK
0022 FPTSLDPT O   F      40            DISK
0022 FPTSLDZX O   F      40            DISK
      *                                                                                       CAS009
     FLECFLSPDO   E                    DISK         KINFSR *PSSR                              CAS009
      ** Midas LE Cash Flows Using All-in-Rate                                                CAS009
      *                                                                                       CAS009
      ** Midas LE Cash Flows Using All-in-Rate                                                CAS016
     FLECFLSL0UF  E           K        DISK         KINFSR *PSSR                              CAS016
     F            LECFLSD0                          KRENAMELECFLSD1                           CAS016
      *                                                                                     AR786878
     FACNUM   IF  E           K        DISK         KINFSR *PSSR                            AR786878
     F***LEACCNL4IF  E           K        DISK         KINFSR *PSSR                  AR786878 CLE164
     FLEREMRPDO   E                    DISK         KINFSR *PSSR                            AR786878
      *                                                                                     AR786878
     FCLOAMQL0IF  E           K        DISK         KINFSR *PSSR                              CRE073
      ** Midas LE Loan amendments extension file                                              CRE073
      *                                                                                       CAS016
     F/COPY WNCPYSRC,LE0400F001
     F*E0400P1O** F     132     OF     PRINTER                      S01124S01117
     FLE0400P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0400AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
     FMCLONCL1IF  E           K        DISK                                                 AR989420
     F            CLOANCLF                          KRENAMEMCLOANF                          AR989420
     FLEPDUELZIF  E           K        DISK                                                 AR989420
     FLEPDUFLZIF  E           K        DISK                                                 AR989420
     FLEFEEDLZIF  E           K        DISK                                                 AR989420
     FLEFEEDL1IF  E           K        DISK                                                   CLE164
     F            LEFEEDF                           KRENAMELFEE1F                             CLE164
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0400FFP1                                           S01408
     F*                                                                   S01408
0024 F*
0025 F* ID F  C  H  L    FUNCTION OF INDICATORS
0026 F* 01            HISTS FILE - HEADER REC.
0027 F* 02            HISTS FILE - LOAN HEADER REC.
0028 F* 03            HISTS FILE - BACK-VALUE HEADER REC.
0029 F* 04            HISTS FILE - INTEREST HEADER REC.
0030 F* 05            HISTS FILE - AMOUNT REC.
0031 F* 06            HISTS FILE - RATE REC.
0032 F* 07            HISTS FILE - MATURED LOAN REC.
0033 F* 08            HISTS FILE - TRAILER REC.
0034 F* 09            HISTS FILE - CATCH-ALL
0035 F* 10            ACTN4 FILE - HEADER REC.
0036 F* 11            ACTN4 FILE - CONTROL REC.
0037 F* 12            ACTN4 FILE - DETAIL REC.
0038 F* 13            ACTN4 FILE - TRAILER REC.
0039 F* 14            ACTN4 FILE - CATCH-ALL
0040 F*       15      BR REC. PROC'D WITH DIFFERENT BASE CODE TO CURRENT
0041 F*       16      INTDUE SUBR. - INTEREST DUE IS GREATER THAN ZERO
0042 F*       17      WORK INDICATOR
0043 F*       18      IF OFF,REC.O/P TO ACTN5,LETLX OR CONFS AS I/P
0044 F*       19      MANREP SUBR. - WHTAX TYPE IS GROSS
0045 F*       20      BACK-VALUE HEADER HAS BEEN O/P TO HIUPD
0046 F*       21      INTEREST HEADER HAS BEEN READ FROM HISTS
0047 F*       22      INTEREST HEADER HAS BEEN O/P TO HIUPD
0048 F*       23      INTEREST CALCULATIONS REQUIRED
0049 F*       24      AT LEAST ONE DETAIL RECORD O/P TO ACTN5
0050 F*       25      START DATE REC. READ FROM ACTN4
0051 F********26******CREDIT SUBR. - SA REC. IS FOR START ACCRUALS        CAC001
0052 F*       27      STOP ACCRUALS (HISTORY REC.)
0053 F*       28      BACK-VALUE HEADER HAS BEEN READ
0054 F*       29      BACK-VALUE HEADER TO BE MOVED OR SAME AS 62
0055 F*       30      WORK INDICATOR
0056 F*       31      WORK INDICATOR
0057 F*       32      HIST AND ACTN SUBR. - WORK INDICATOR
0058 F*       33      PRINC. AMT. TO BE PRINTED
0059 F*       34      INT. AMT. TO BE PRINTED
0060 F*       35      FEE AMT. TO BE PRINTED
0061 F*       36      BASE RATE CODE TO BE PRINTED
0062 F*       37      REPAYMENT TYPE 1
0063 F*       38      REPAYMENT TYPE 2
0064 F*       39      REPAYMENT TYPE 3
0065 F*       40      OUTPUT HEADER RECS.TO LETLX,CONFS,INTST,CUTX1,PTLSD
0066 F*       41      OUTPUT HEADER RECS.TO HIUPD AND ACTN5
0067 F*       42      REC. O/P TO HIUPD AS I/P
0068 F*       43      O/P OF INTEREST HEADER TO HIUPD WHEN MOVED
0069 F*       44      O/P OF CONTROL REC. TO ACTN5
0070 F*       45      O/P OF DETAIL REC. TO ACTN5
0071 F*       46      O/P OF BACK-VALUE HEADER TO HIUPD WHEN MOVED
0072 F*       47      O/P OF BACK-VALUE HEADER TO HIUPD WHEN CREATED
0073 F*       48      O/P OF INTEREST HEADER TO HIUPD WHEN CREATED
0074 F*       49      O/P OF INTEREST HEADER TO INTST
0075 F*       50      FIRST CYCLE INDICATOR
0076 F*       51      O/P OF START REC. TO HIUPD WHEN CREATED
0077 F*       52      O/P OF INTEREST HEADER TO CUTX1
0078 F*       53      BASE RATE TO BE PRINTED
0079 F*       54      RATE/SPREAD TO BE PRINTED
0080 F*       55      SPREAD IND. TO BE PRINTED
0081 F*       56      O/P OF AMOUNT REC.TO HIUPD WHEN PROCESSED FROM ACTN4
0082 F*       57      O/P OF RATE REC.TO HIUPD WHEN PROCESSED FROM ACTN4
0083 F*       58      O/P OF DETAIL AMOUNT REC. TO INTST
0084 F*       59      O/P OF DETAIL RATE REC. TO INTST
0085 F*       60      CUSTOMER BILL/TELEX REQUIRED
     F*       61      SET AUTO SETTLE IND FOR RISK LOAN W/ MAT ACTN &     E47245
     F*               O/S AMT = PRINCIPAL                                 E47245
0086 F*       62      REC. BACK VALUED BEYOND START/LAST INT. DATE
0087 F*       63      INTEREST PAYMENTS EXIST
0088 F*       64      ACTION RECS. EXIST FOR THIS CONTROL REC.
0089 F********65******CREDIT*SUBR.*-*O/S*PRINC.*-VE***********************S01117
     F*       65      MULTIBRANCHING INDICATOR = NO                       S01117
     F*       66      MA ACTION RECORD MATURING TODAY
0090 F*       67      DISCOUNTED LOAN
0091 F*       68      REC. O/P TO HIUPD IS MATURED
0092 F*       69      LOAN REVERSAL
     F*       70      ST RECORD READ
0093 F*       71      PROCESSING TYPE IS '61' - DEMAND LOAN
0094 F*    72         ACTION INDICATOR IS BLANK
0095 F*       73      MIADJ SUBR. - VALUE DATE IS GREATER THAN INT.ACC.C.D
0096 F*       74      CURRENCY DEC. PL. IS 0   ||  THESE INDICATORS ARE
0097 F*       75      CURRENCY DEC. PL. IS 1   ||  ALSO USED TO OUTPUT
0098 F*       76      CURRENCY DEC. PL. IS 2   ||  MATURE HIST.RECS.(SEE
0099 F*       77      CURRENCY DEC. PL. IS 3   ||  SUBROUTINE HIST)
0100 F*       78      O/P OF DETAIL AMOUNT REC. TO CUTX1
0101 F*       79      O/P OF DETAIL RATE REC. TO CUTX1
0102 F*       80      DIFFERENCE IN NUMBER OF HISTS RECS. READ
     F*       80      RE-USED FOR B/R CHG WITH VALUE DATE = START DATE
0103 F*       81      DIFFERENCE IN NUMBER OF ACTN4 RECS. READ
0104 F*       82      O/P OF DETAIL REC. TO LETLX
0105 F*       83      O/P OF DETAIL REC. TO CONFS
0106 F*       84      O/P OF DETAIL REC. TO PTSLD
0107 F*       85      NO ROLLOVER DETAILS ON ROLLOVER REC.
0108 F*       86      START/STOP ACCRUALS TO BE PRINTED
0109 F*       87      O/P LINE TO REPORT
0110 F*       88      O/P 2ND. LETLX REC. FOR MATURITIES
0111 F*       89      AT LEAST ONE DETAIL LINE ON REPORT
0112 F*       90-98   INDICATORS USED IN STANDARD SUBR.
0113 F*       99      ERROR IN CHAIN
0114 F*             L1CHANGE IN LOAN NUMBER
0115 F*          U3   NON-WORKING DAY AFTER BRANCH ACCRUAL DATE
0116 F*          U7   DATABASE ERROR
0117 F*          U8   DATABASE ERROR
0118 F*             OFOVERFLOW INDICATOR
0119 F*
     E/COPY ZSRSRC,ZDATE2Z1
     E                    CPY@    1   1 80
     E                    SVAL    1   1 20                                                    218782
     E                    RN      1   9  7 7                              E43682
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E**********          ALNF      500  6 0 ADTE   13 0                               147438 CLE148
     E                    ALNF      500  6   ADTE   13 0                                      CLE148
     E                    AAMT      500 13 0 ACCY    3                    147438
      * Arrays to hold currencies and 'In' currency indicator                                 CLE031
     E                    ACR       150  3  A                                                 CLE031
     E                    ACI       150  1                                                    CLE031
     E/COPY ZSRSRC,ZFREQBZ1                                                                   CLE028
     E/COPY ZSRSRC,ZHOLE                                                                      CLE028
      *                                                                   149915
     ICLOANCLF                                                            149915
      *                                                                   149915
      ** Rename Fields                                                    149915
      *                                                                   149915
     I              RECI                            WRECI                 149915
     I              LNRF                            WLNRF                 149915
     I              RCDT                            WRCDT                 149915
     I              MRIN                            WMRIN                 149915
     I              PTYP                            WPTYP                 149915
     I              CNUM                            WCNUM                 149915
     I              BRCA                            WBRCA                 149915
     I              LTYP                            WLTYP                 149915
     I              SUTP                            WSUTP                 149915
     I              DDAT                            WDDAT                                     206596
     I              VDAT                            WVDAT                 149915
     I              MDAT                            WMDAT                                     206596
     I              FCUS                            WFCUS                 149915
     I              FTYP                            WFTYP                 149915
     I              FSEQ                            WFSEQ                 149915
     I              CCY                             WCCY                  149915
     I              CPAM                            WCPAM                 149915
     I              INTC                            WINTC                 149915
     I              INTR                            WINTR                 149915
     I              BRTT                            WBRTT                 149915
     I              BRTE                            WBRTE                 149915
     I              RTSP                            WRTSP                 149915
     I              SPIN                            WSPIN                 149915
     I              CHIN                            WCHIN                 149915
     I              WTRT                            WWTRT                 149915
     I              WTIN                            WWTIN                 149915
     I              REPT                            WREPT                 149915
     I              NACD                            WNACD                 149915
     I              AUTO                            WAUTO                 149915
     I              FACO                            WFACO                 149915
     I              RLDT                            WRLDT                                     206596
     I              RDFC                            WRDFC                 149915
     I              PDIN                            WPDIN                 149915
     I              FCLB                            WFCLB                 149915
     I              BTIN                            WBTIN                 149915
     I              TOTI                            WTOTI                 149915
     I              IACD                            WIACD                 149915
     I              AITC                            WAITC                 149915
     I              AIAP                            WAIAP                 149915
     I              IPRD                            WIPRD                 149915
     I              ORED                            WORED                 149915
     I              LCD                             WLCD                  149915
     I              CHTP                            WCHTP                 149915
     I              TNLU                            WTNLU                 149915
     I              ADDI                            WADDI                 149915
     I              NMDT                            WNMDT                                     206596
     I              RSTM                            WRSTM                 149915
     I              RONS                            WRONS                 149915
     I              RIBN                            WRIBN                 149915
     I              RIBA                            WRIBA                 149915
     I              ROBN                            WROBN                 149915
     I              ROCN                            WROCN                 149915
     I              PSTM                            WPSTM                 149915
     I              PONS                            WPONS                 149915
     I              PIBN                            WPIBN                 149915
     I              PIBA                            WPIBA                 149915
     I              POBN                            WPOBN                 149915
     I              POCN                            WPOCN                 149915
     I              RCRN                            WRCRN                 149915
     I              RCRA                            WRCRA                 149915
     I              RVNO                            WRVNO                 149915
     I              AWBN                            WAWBN                 149915
     I              AWBA                            WAWBA                 149915
     I              BENN                            WBENN                 149915
     I              BENA                            WBENA                 149915
     I              DTP1                            WDTP1                 149915
     I              DTP2                            WDTP2                 149915
     I              DTP3                            WDTP3                 149915
     I              DTP4                            WDTP4                 149915
     I              DCHG                            WDCHG                 149915
     I              BTB1                            WBTB1                 149915
     I              BTB2                            WBTB2                 149915
     I              BTB3                            WBTB3                 149915
     I              BTB4                            WBTB4                 149915
     I              BTB5                            WBTB5                 149915
     I              BTB6                            WBTB6                 149915
     I              CVMR                            WCVMR                 149915
     I              FSRP                            WFSRP                 149915
     I              FSGN                            WFSGN                 149915
     I              FPRC                            WFPRC                 149915
     I              TCOF                            WTCOF                 149915
     I              ACDA                            WACDA                 149915
     I              ACAP                            WACAP                                     206596
     I              COFD                            WCOFD                 149915
     I              MNSG                            WMNSG                 149915
     I              GASS                            WGASS                 149915
     I              GPRT                            WGPRT                 149915
     I              SCCY                            WSCCY                                     206596
     I              AITN                            WAITN                                     CAS005
     I              IPRN                            WIPRN                                     CAS005
     I              FPAM                            WFPAM                                     CLE031
     I              REXR                            WREXR                                     CLE031
     I              REXI                            WREXI                                     CLE031
     I              PSCY                            WPSCY                                     CLE031
     I              PEXR                            WPEXR                                     CLE031
     I              PEXI                            WPEXI                                     CLE031
     I              STAL                            WSTAL                                     CLE034
     I              CLAS                            WCLAS                                     CLE042
      *                                                                                     MD028338
     ICLOANCKF                                                                              MD028338
     I              RECI                            WRECIK                                  MD028338
     I              LNRF                            WLNRFK                                  MD028338
     I              RCDT                            WRCDTK                                  MD028338
     I              MRIN                            WMRINK                                  MD028338
      *                                                                                     MD028338
      ** Reuse filler ZZ004 to serve as FX Rate Change Only Indicator                       MD028338
      *                                                                                     MD028338
     I              ZZ004                           WFRCOK                                  MD028338
     I              SPI1                            WSPI1K                                  MD028338
     I              SPI2                            WSPI2K                                  MD028338
     I              SPI3                            WSPI3K                                  MD028338
     I              LCD                             WLCDK                                   MD028338
     I              ORED                            WOREDK                                  MD028338
     I              CHTP                            WCHTPK                                  MD028338
     I              TNLU                            WTNLUK                                  MD028338
     I              ECIN                            WECINK                                  MD028338
     I              FRNT                            WFRNTK                                  MD028338
     I              AFRT                            WAFRTK                                  MD028338
     I              REPA                            WREPAK                                  MD028338
     I              TMST                            WTMSTK                                  MD028338
      *                                                                                       CAS016
      *Rename cash flow record                                                                CAS016
     ILECFLSD1                                                                                CAS016
     I              LFLNRF                          LSLNRF                                    CAS016
     I              LFLTYP                          LSLTYP                                    CAS016
     I              LFLNST                          LSLNST                                    CAS016
     I              LFFLDT                          LSFLDT                                    CAS016
     I              LFDATE                          LSDATE                                    CAS016
     I              LFNDYP                          LSNDYP                                    CAS016
     I              LFNDYY                          LSNDYY                                    CAS016
     I              LFCAMT                          LSCAMT                                    CAS016
     I              LFFTYP                          LSFTYP                                    CAS016
     I              LFIRAT                          LSIRAT                                    CAS016
     I              LFSPRR                          LSSPRR                                    CAS016
     I              LFYLDC                          LSYLDC                                    CAS016
     I              LFFYLD                          LSFYLD                                    CAS016
     I              LFDSCF                          LSDSCF                                    CAS016
     I              LFNPVA                          LSNPVA                                    CAS016
     I              LFIOIN                          LSIOIN                                    CAS016
     I              LFCNUM                          LSCNUM                                    CAS016
     I              LFBRCA                          LSBRCA                                    CAS016
     I              LFCYCD                          LSCYCD                                    CAS016
     I/COPY WNCPYSRC,LE0400I007
      *                                                                                     AR786878
      ** Rename ACCNTAB fields                                                              AR786878
      *                                                                                     AR786878
     IACCNTABF                                                                              AR786878
     I              RECI                            ACRECI                                  AR786878
     I              ACNO                            ACACNO                                  AR786878
     I              CNUM                            ACCNUM                                  AR786878
     I              CCY                             ACCCY                                   AR786878
     I              ACOD                            ACACOD                                  AR786878
     I              ACSQ                            ACACSQ                                  AR786878
     I              ACST                            ACACST                                  AR786878
     I              ATYP                            ACATYP                                  AR786878
     I              BRCA                            ACBRCA                                  AR786878
     I              ZZ001                           ACZZ01                                  AR786878
     I              MFFQ                            ACMFFQ                                  AR786878
     I              LCD                             ACLCD                                   AR786878
     I              CHTP                            ACCHTP                                  AR786878
     I              TNLU                            ACTNLU                                  AR786878
     I              PTFR                            ACPTFR                                  AR786878
     I              RRNM                            ACRRNM                                  AR786878
     I              DACO                            ACDACO                                  AR786878
     I              ANAM                            ACANAM                                  AR786878
     I              CLBL                            ACCLBL                                  AR786878
     I              RETB                            ACRETB                                  AR786878
     I              ODLN                            ACODLN                                  AR786878
     I              ODED                            ACODED                                  AR786878
     I              HELD                            ACHELD                                  AR786878
     I              MINB                            ACMINB                                  AR786878
     I              DRIF                            ACDRIF                                  AR786878
     I              LDID                            ACLDID                                  AR786878
     I              CRIF                            ACCRIF                                  AR786878
     I              LCID                            ACLCID                                  AR786878
     I              STYP                            ACSTYP                                  AR786878
      *                                                                                     AR989420
      ** Rename MCLOANF fields                                                              AR989420
      *                                                                                     AR989420
     IMCLOANF                                                                               AR989420
     I              LNRF                            OLLNRF                                  AR989420
     I              VDAT                            OLVDAT                                  AR989420
      *                                                                                     AR989420
      ** Rename MCLOANCLF fields                                                            AR989420
      *                                                                                     AR989420
     IMLOANCLF                                                                              AR989420
     I              LNRF                            OLLNRF                                  AR989420
     I              VDAT                            OLVDAT                                  AR989420
      *                                                                                     AR989420
      ** Rename LEFEED fields                                                               AR989420
      *                                                                                     AR989420
     ILEFEEDF                                                                               AR989420
     I              FECNUM                          OLCNUM                                  AR989420
     I              FELOAN                          OLLOAN                                  AR989420
     I              FEFSEQ                          OLFSEQ                                  AR989420
     I              FEFACL                          OLFACL                                  AR989420
     I              FEPSTD                          OLVDAT                                  AR989420
      *                                                                                     AR989420
0123 I*
0124 I** LOANS HISTORY FILE - FILE HEADER RECORD
0125 I*
0126 IHISTS   NS  01   1 CH
0127 I                                        1 100 LOTH
0128 I*
0129 I** LOANS HISTORY FILE - LOAN HEADER RECORD
0130 I*
0131 I        NS  02   1 CD   2 CA
0132 I       OR   07   1 CM   2 CA
0133 I                                        1   1 RECI
0134 I                                        2   2 RCDT
0135 I***********                             3   50BRCD    M5            S01117
0135 I                                        3   5 BRCA  L2M5            S01117
0136 I**********                              6  110CNUM    M4                                CSD027
0136 I                                        6  11 CNUM    M4                                CSD027
0137 I**********                             12  170LNRF  L1M3                                CLE148
     I                                       12  17 LNRF  L1M3                                CLE148
0138 I                                       18  220VDAT    M2
0139 I                                       23  240PRSQ    M1
0140 I                                       25  270LASN
0141 I**********                             28  330FCUS                                      CSD027
0141 I                                       28  33 FCUS                                      CSD027
0142 I                                       34  360FTYP
0143 I                                       37  380FSEQ
0144 I                                       39  400PTYP
0145 I                                       41  43 CCY
0146 I                                       44  45 AMTP
0147 I                                    P  46  520PRAM
0148 I                                       53  540BRTT
0149 I                                    P  55  607BRTE
0150 I                                    P  61  667RTSP
0151 I                                       67  67 SPIN
0152 I                                       68  680CALC
0153 I                                       69  69 WTIN
0154 I                                       70  700REPT
0155 I                                       71  71 INTC
0156 I                                       72  73 LTYP
0157 I                                       74  75 SUTP
0158 I                                    P  76  820DISC
     I                                       83  85 FCLB                  S01117
0159 I                                    P  97  990ORED
     I                                    P 101 1067FSRP                  CAC001
     I                                      107 107 FSGN                  CAC001
     I                                    P 108 1140TCOF                  CAC001
     I                                      115 118 FPRC                  CAC001
     I                                    P 119 1250CPAM                  CLE003
     I                                    P 126 1320AITC                  CLE003
     I                                    P 133 1387INTR                  CLE003
     I                                    P 139 1450AIAP                  CLE003
     I                                    P 146 1520IPRD                  CLE003
     I                                    P 153 1590ACDA                  157669
     I                                    P 160 1657COFR                  157669
     I                                    P 166 1720ACAP                  157669
     I                                    P 173 1790COFD                  157669
     I                                    P 180 1860AITN                                      CAS005
     I                                    P 187 1930AIAN                                      CAS005
     I                                    P 194 2000IPRN                                      CAS005
     I                                    P 201 2070FSPRAM                                    CAS005
     I                                    P 208 2140FSCPAM                                    CAS005
     I                                      215 218 CLAS                                      CLE042
     I                                    P 219 2210OCDT                                      CRE073
     I                                    P 222 2298EAIR                                      CRE073
     I**********                          P 230 2357CNSPO                            CRE073 AR824724
     I**********                            236 236 CNSGO                            CRE073 AR824724
     I**********                            237 243 RDMTO                            CRE073 AR824724
     I**********                            244 247 RDFDO                            CRE073 AR824724
     I                                    P 230 2357CNSP                                    AR824724
     I                                      236 236 CNSG                                    AR824724
     I                                      237 243 RDMT                                    AR824724
     I                                      244 247 RDFD                                    AR824724
0160 I***********                             1 100 LOTH                  CAC001
     I***********                             1 118 LOTHM          CAC001 CLE003
     I***********                             1 152 LOTHM          CLE003 157669
     I**********                              1 179 LOTHM                              157669 CAS005
     I****************************************1 214 LOTHM                              CAS005 CLE042
     I**********                              1 218 LOTHM                              CLE042 CRE073
     I                                        1 247 LOTHM                                     CRE073
0160 I                                        1 100 LOTH                  120391
0161 I*
0162 I** LOANS HISTORY FILE - BV/INT HEADER RECORD
0163 I*
0164 I        NS  03   1 CD   2 CH  44 CB
0165 I       OR   04   1 CD   2 CH  44 CI
0166 I                                        1   1 RECI
0167 I                                        2   2 RCDT
0168 I***********                             3   50BRCD    M5            S01117
0168 I                                        3   5 BRCA    M5            S01117
0169 I**********                              6  110CNUM    M4                                CSD027
0169 I                                        6  11 CNUM    M4                                CSD027
0170 I**********                             12  170LNRF    M3                                CLE148
     I                                       12  17 LNRF    M3                                CLE148
0171 I                                       18  220VDAT    M2
0172 I                                       23  240PRSQ    M1
0173 I                                       25  270LASN
0174 I**********                             28  330FCUS                                      CSD027
0174 I                                       28  33 FCUS                                      CSD027
0175 I                                       34  360FTYP
0176 I                                       37  380FSEQ
0177 I                                       39  400PTYP
0178 I                                       41  43 CCY
0179 I                                       44  45 AMTP
0180 I                                    P  46  520PRAM
0181 I                                    P  53  587BRTE
0182 I                                    P  59  647RTSP
0183 I                                       65  650CALC
0184 I                                       66  66 SPIN
0185 I                                    P  67  730INTA
0186 I                                    P  74  760STPG      04
0187 I                                       77  780BRTT
0188 I                                    P  79  850PPIS      04
0189 I                                    P  86  920IPIS      04
0190 I                                    P  93  990IPPS      04
     I                                    P 101 1067FSRP                  CAC001
     I                                      107 107 FSGN                  CAC001
     I                                    P 108 1140COFA                  CAC001
     I                                      115 118 FPRC                  CAC001
     I                                    P 119 1250INTN                                      CAS005
     I                                    P 126 1320FSPRAM                                    CAS005
     I                                    P 133 1350OCDT                                      CRE073
     I                                    P 136 1438EAIR                                      CRE073
     I**********                          P 144 1497CNSPO                            CRE073 AR824724
     I**********                            150 150 CNSGO                            CRE073 AR824724
     I**********                            151 157 RDMTO                            CRE073 AR824724
     I**********                            158 161 RDFDO                            CRE073 AR824724
     I                                    P 144 1497CNSP                                    AR824724
     I                                      150 150 CNSG                                    AR824724
     I                                      151 157 RDMT                                    AR824724
     I                                      158 161 RDFD                                    AR824724
0191 I***********                             1 100 LOTH                  CAC001
0192 I***********                             1 100 LOTBV     03          CAC001
0193 I***********                             1 100 LOTIN     04          CAC001
     I**********                              1 118 LOTHN                              CAC001 CAS005
     I**********                              1 118 LOTBV     03                       CAC001 CAS005
     I**********                              1 118 LOTIN     04                       CAC001 CAS005
     I**********                              1 132 LOTHN                              CAS005 CRE073
     I**********                              1 132 LOTBV     03                       CAS005 CRE073
     I**********                              1 132 LOTIN     04                       CAS005 CRE073
     I                                        1 161 LOTHN                                     CRE073
     I                                        1 161 LOTBV     03                              CRE073
     I                                        1 161 LOTIN     04                              CRE073
0191 I                                        1 100 LOTH                  120391
0194 I*
0195 I** LOANS HISTORY FILE - AMOUNT RECORD
0196 I*
0197 I        NS  05   1 CD   2 CD
0198 I                                        1   1 RECI
0199 I                                        2   2 RCDT
0200 I***********                             3   50BRCD    M5            S01117
0200 I                                        3   5 BRCA    M5            S01117
0201 I**********                              6  110CNUM    M4                                CSD027
0201 I                                        6  11 CNUM    M4                                CSD027
0202 I**********                             12  170LNRF    M3                                CLE148
     I                                       12  17 LNRF    M3                                CLE148
0203 I                                       18  220VDAT    M2
0204 I                                       23  240PRSQ    M1
0205 I                                       25  270LASN
0206 I**********                             28  330FCUS                                      CSD027
0206 I                                       28  33 FCUS                                      CSD027
0207 I                                       34  360FTYP
0208 I                                       37  380FSEQ
0209 I                                       39  400PTYP
0210 I                                       41  43 CCY
0211 I                                       44  45 AMTP
0212 I                                    P  46  520PRAM
0213 I                                    P  53  590INTA
0214 I                                    P  60  660WTXA
0215 I                                    P  67  730FEAM
0216 I                                       74  750FECD
0217 I                                       76  76 WOIN
0218 I                                    P  77  790EXVD
     I*                                                                   S01270
     I**   ADDITION OF LOAN-TYPE/SUB-TYPE FIELDS                          S01270
     I*                                                                   S01270
     I                                       80  81 LTYP                  S01270
     I                                       82  83 SUTP                  S01270
     I*                                                                   S01270
0219 I                                    P  97  990ORED
     I                                    P 101 1070COFA                  CAC001
     I                                    P 108 1140CPAM                  CLE003
     I                                    P 115 1210AITC                  CLE003
     I                                    P 122 1277INTR                  CLE003
     I                                    P 128 1340AIAP                  CLE003
     I                                    P 135 1410IPRD                  CLE003
     I                                      142 142 MNSG                  122667
     I                                      143 143 GASS                  122667
     I                                      144 144 GPRT                  122667
     I**********                            145 1500ROLN                               122667 CLE148
     I                                      145 150 ROLN                                      CLE148
     I                                    P 151 1570ACDA                  157669
     I                                    P 158 1637COFR                  157669
     I                                    P 164 1700ACAP                  157669
     I                                    P 171 1770COFD                  157669
     I**********                            178 178 REPI           CPB002 194459
     I                                      178 178 WREPI                 194459
     I                                    P 179 1850CHDU                                      CLE028
     I                                    P 186 1920AITN                                      CAS005
     I                                    P 193 1990AIAN                                      CAS005
     I                                    P 200 2060IPRN                                      CAS005
     I                                    P 207 2130INTN                                      CAS005
     I                                    P 214 2200FSPRAM                                    CAS005
     I                                    P 221 2270FSCPAM                                    CAS005
     I                                      228 231 CLAS                                      CLE042
     I                                      232 2320REPT                                      CLE154
0220 I***********                             1 100 LOTH                  CAC001
     I/COPY WNCPYSRC,LE0400I003
     I***********                             1 107 LOTHP          CAC001 CLE003
     I***********                             1 141 LOTHP          CLE003 122667
     I***********                             1 150 LOTHP          122667 157669
     I***********                             1 177 LOTHP          157669 CPB002
     I**********                              1 178 LOTHP                              CPB002 CAS005
     I****************************************1 220 LOTHP                              CAS005 CLE042
     I**********                              1 231 LOTHP                           CLE042 AR1057551
     I                                        1 232 LOTHP                                  AR1057551
0191 I                                        1 100 LOTH                  120391
0221 I*
0222 I** LOANS HISTORY FILE - RATE RECORD
0223 I*
0224 I        NS  06   1 CD   2 CE
0225 I                                        1   1 RECI
0226 I                                        2   2 RCDT
0227 I***********                             3   50BRCD    M5            S01117
0227 I                                        3   5 BRCA    M5            S01117
0228 I**********                              6  110CNUM    M4                                CSD027
0228 I                                        6  11 CNUM    M4                                CSD027
0229 I**********                             12  170LNRF    M3                                CLE148
     I                                       12  17 LNRF    M3                                CLE148
0230 I                                       18  220VDAT    M2
0231 I                                       23  240PRSQ    M1
0232 I                                       25  270LASN
0233 I**********                             28  330FCUS                                      CSD027
0233 I                                       28  33 FCUS                                      CSD027
0234 I                                       34  360FTYP
0235 I                                       37  380FSEQ
0236 I                                       39  400PTYP
0237 I                                       41  43 CCY
0238 I                                       44  45 AMTP
0239 I                                       46  470BRTT
0240 I                                    P  48  537BRTE
0241 I                                    P  54  597RTSP
0242 I                                       60  60 SPIN
0243 I                                       61  610CALC
0244 I                                       62  62 STAI
     I                                    P  63  690PRINRO                126030
0245 I                                    P  97  990ORED
      *                                                                                     MD028338
      ** Reuse filler ZZ001 to serve as FX Rate Change Only Indicator                       MD028338
      *                                                                                     MD028338
     I                                      100 100 FRCO                                    MD028338
     I                                    P 101 1067FSRP                  CAC001
     I                                      107 107 FSGN                  CAC001
     I                                      108 108 IRCF                  CAC001
     I                                      109 109 FRCF                  CAC001
     I                                      110 113 FPRC                  CAC001
     I                                    P 114 1200CPAM                  CLE003
     I                                    P 121 1270AITC                  CLE003
     I                                    P 128 1337INTR                  CLE003
     I                                    P 134 1400AIAP                  CLE003
     I                                    P 141 1470IPRD                  CLE003
     I                                      148 148 MNSG                  127069
     I                                      149 151 RLCY                  127069
     I                                    P 152 1580ACDA                  157669
     I                                    P 159 1647COFR                  157669
     I                                    P 165 1710ACAP                  157669
     I                                    P 172 1780COFD                  157669
     I                                    P 179 1850AITN                                      CAS005
     I                                    P 186 1920AIAN                                      CAS005
     I                                    P 193 1990IPRN                                      CAS005
     I                                    P 200 2060FSCPAM                                    CRE073
     I                                    P 207 2090OCDT                                      CRE073
     I                                    P 210 2178EAIR                                      CRE073
     I**********                          P 218 2237CNSPO                            CRE073 AR824724
     I**********                            224 224 CNSGO                            CRE073 AR824724
     I**********                            225 231 RDMTO                            CRE073 AR824724
     I**********                            232 235 RDFDO                            CRE073 AR824724
     I                                    P 218 2237CNSP                                    AR824724
     I                                      224 224 CNSG                                    AR824724
     I                                      225 231 RDMT                                    AR824724
     I                                      232 235 RDFD                                    AR824724
0246 I***********                             1 100 LOTH                  CAC001
     I***********                             1 113 LOTHQ          CAC001 CLE003
     I***********                             1 147 LOTHQ          CLE003 127069
     I***********                             1 151 LOTHQ          127069 157669
     I**********                              1 178 LOTHQ                              157669 CAS005
     I**********                              1 199 LOTHQ                              CAS005 262540
     I**********                              1 206 LOTHQ                              262540 CRE073
     I                                        1 235 LOTHQ                                     CRE073
0191 I                                        1 100 LOTH                  120391
     I/COPY WNCPYSRC,LE0400I004
0247 I*
0248 I** LOANS HISTORY FILE - MATURED LOAN RECORD
0249 I*
0250 I        NS  07   1 CM
0251 I                                        1   1 RECI
0252 I                                        2   2 RCDT
0253 I***********                             3   50BRCD    M5            S01117
0253 I                                        3   5 BRCA    M5            S01117
0254 I**********                              6  110CNUM    M4                                CSD027
0254 I                                        6  11 CNUM    M4                                CSD027
0255 I**********                             12  170LNRF    M3                                CLE148
     I                                       12  17 LNRF    M3                                CLE148
0256 I                                       18  220VDAT    M2
0257 I                                       23  240PRSQ    M1
     I/COPY WNCPYSRC,LE0400I005
0258 I***********                             1 100 LOTH                  CAC001
     I***********                             1 118 LOTHM          CAC001 CLE003
     I***********                             1 152 LOTHM          CLE003 157669
     I**********                              1 179 LOTHM                              157669 CAS005
     I**********                              1 118 LOTHN                              CAC001 CAS005
     I****************************************1 214 LOTHM                              CAS005 CLE042
     I**********                              1 218 LOTHM                              CLE042 CRE073
     I**********                              1 132 LOTHN                              CAS005 CRE073
     I                                        1 247 LOTHM                                     CRE073
     I                                        1 161 LOTHN                                     CRE073
     I***********                             1 107 LOTHP          CAC001 CLE003
     I***********                             1 141 LOTHP          CLE003 122667
     I***********                             1 150 LOTHP          122667 157669
     I***********                             1 177 LOTHP          157669 CPB002
     I**********                              1 178 LOTHP                              CPB002 CAS005
     I****************************************1 220 LOTHP                              CAS005 CLE042
     I**********                              1 231 LOTHP                           CLE042 AR1057551
     I                                        1 232 LOTHP                                  AR1057551
     I***********                             1 113 LOTHQ          CAC001 CLE003
     I***********                             1 147 LOTHQ          CLE003 127069
     I***********                             1 151 LOTHQ          127069 157669
     I**********                              1 178 LOTHQ                              157669 CAS005
     I**********                              1 199 LOTHQ                              CAS005 262540
     I**********                              1 206 LOTHQ                              262540 CRE073
     I                                        1 235 LOTHQ                                     CRE073
0258 I                                        1 100 LOTH                  120391
0259 I*
0260 I** LOANS HISTORY FILE - TRAILER RECORD
0261 I*
0262 I        NS  08   1 CT
0263 I                                        1   1 RECI
0264 I                                    P   2   40NOREH
0265 I*
0266 I** LOANS HISTORY FILE - CATCH ALL
0267 I*
0268 I        NS  09
0269 I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
0270 I*
0271 I*  ACTIONS TODAY FILE - HEADER RECORD
0272 I*
0273 IACTN4   NS  10   1 CH
0274 I                                        1 256 LOTA1
0275 I                                      257 320 LOTA2
     I/COPY WNCPYSRC,LE0400I002
0276 I*
0277 I** ACTIONS TODAY FILE - CONTROL RECORD
0278 I*
0279 I        NS  11   1 CD  23 CC  24 CO
0280 I                                        1   1 RECI
0281 I**********                              2   70LNRF  L1M3                                CLE148
     I                                        2   7 LNRF  L1M3                                CLE148
0282 I                                        8  120VDAT    M2
0283 I                                       13  150LASN
0284 I                                       16  160MRIN
0285 I                                       17  18 LTYP
0286 I                                       19  20 SUTP
0287 I                                       21  220PTYP
0288 I                                       23  24 AMTP
0289 I                                       25  260PRSQ    M1
0290 I                                       27  27 CTRQ
0291 I                                       28  28 RBVA
0292 I                                       29  29 RBVS
0293 I                                       30  30 INPY
0294 I                                    P  31  330LIVD
0295 I                                       34  34 ACCR
0296 I                                       35  37 CCY
0297 I***********                            73  750BRCD    M5            S01117
0297 I                                       73  75 BRCA  L2M5            S01117
0298 I**********                             76  810CNUM    M4                                CSD027
0298 I                                       76  81 CNUM    M4                                CSD027
0299 I                                       82  82 RBSA
0300 I                                       83  83 IBSA
0301 I                                       84  84 MBSA
0302 I                                       85  85 LNMA
0303 I                                       86  86 LNRV
0304 I                                    P  87  890LTVD
0305 I                                    P  90  920ECDT
0306 I                                    P  96  980PLCD
0307 I                                    P  99 1010PLND
0308 I                                    P 102 1040CTXD
0309 I                                    P 105 1070EXTD
0310 I                                    P 108 1100NIAD
0311 I                                    P 111 1170AITC
0312 I                                      118 118 ICRQ
0313 I                                    P 119 1250TINP
0314 I                                    P 126 1320TIPD
0315 I                                    P 133 1387WTRT
0316 I                                      139 139 NACD
0317 I                                      140 140 BTIN
     I                                      141 141 CHINA
     I                                      240 242 FCLB                  S01117
     I                                      243 243 RDFC                  S01392
     I                                      244 244 ADDI                  S01392
     I                                    P 321 3270ACDA                  CAC001
     I                                    P 328 3340TCPD                  CAC001
     I                                    P 335 3410TCFP                  CAC001
     I                                    P 342 3440NFCD                  CAC001
     I                                    P 345 3510AITN                                      CAS005
     I                                    P 352 3580TNNP                                      CAS005
     I                                    P 359 3650TNPD                                      CAS005
     I                                      366 369 CLAS                                      CLE042
0318 I                                        1 256 LOTC1
0319 I***********                           257 320 LOTC2                 CAC001
     I**********                            257 344 LOTC2                              CAC001 CAS005
     I**************************************257 365 LOTC2                              CAS005 CLE042
     I                                      257 369 LOTC2                                     CLE042
0320 I*
0321 I** ACTIONS TODAY FILE - START RECORD
0322 I*
0323 I        NS  12   1 CD  23 CS  24 CT
0324 I                                        1   1 RECI
0325 I**********                              2   70LNRF    M3                                CLE148
     I                                        2   7 LNRF    M3                                CLE148
0326 I                                        8  120VDATS   M2
0327 I                                       13  150LASN
0328 I                                       16  160MRIN
0329 I                                       17  18 LTYP
0330 I                                       19  20 SUTP
0331 I                                       21  220PTYP
0332 I                                       23  24 AMTP
0333 I                                       25  260PRSQ    M1
0334 I                                       27  280BRTTS
0335 I                                    P  29  347RTSPS
0336 I                                       35  37 CCY
0337 I                                    P  38  440PRAMS
0338 I                                    P  45  510INTA
0339 I                                    P  52  580WTXA
0340 I                                    P  59  650FEAM
0341 I                                    P  66  720TAMT
0342 I***********                            73  750BRCD    M5            S01117
0342 I                                       73  75 BRCA    M5            S01117
0343 I**********                             76  810CNUM    M4                                CSD027
0343 I                                       76  81 CNUM    M4                                CSD027
0344 I                                       82  820REPT
0345 I                                       83  83 AUTO
0346 I                                       84  84 STAI
0347 I                                       85  860SETP
0348 I*********                              87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
0349 I                                       99 108 TSEN
0350 I                                      109 118 FACO
0351 I                                      119 148 SPI1
0352 I                                      149 178 SPI2
0353 I                                      179 208 SPI3
0354 I                                      209 209 LAIN
0355 I                                    P 210 2157BRTES
0356 I                                      216 216 SPINS
0357 I                                      217 2170CALCS
0358 I                                      218 218 WTIN
0359 I                                      219 219 LLAG
0360 I                                      220 220 LWOI
0361 I                                      221 2250XAVD
0362 I                                      226 2280XASQ
0363 I**********                            229 2340FCUS                                      CSD027
0363 I                                      229 234 FCUS                                      CSD027
0364 I                                      235 2370FTYP
0365 I                                      238 2390FSEQ
0366 I**********                            240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
0367 I                                      246 2470FECD
0368 I                                      248 248 PDNI
0369 I                                      249 249 ACTI            72
0370 I                                      250 250 CNFY
0371 I                                      251 251 TLXY
0372 I                                      252 252 CBLY
0373 I                                      253 253 INTC
0374 I                                      255 255 ACBI
     I                                      256 256 CHIN
     I                                    P 257 2580LSWCC                                     235579
     I                                    P 259 2600LSESC                                     235579
     I                                    P 267 2690LSMD                                      235579
     I                                    P 270 2760REBT                                      235579
0375 I                                    P 311 3130ORED
0376 I                                    P 314 3160LCD
0377 I                                      317 317 CHTP
0378 I                                    P 318 3200TNLU
     I                                      321 3220RSTM                  S01518
     I**********                            323 334 RONS                               S01518 CGL029
     I                                      323 334 RONSQQ                                    CGL029
     I                                      335 342 RIBN                  S01518
     I                                      343 377 RIBA                  S01518
     I**********                            378 3830ROBN                               S01518 CSD027
     I**********                            384 3890ROCN                               S01518 CSD027
     I                                      378 383 ROBN                                      CSD027
     I                                      384 389 ROCN                                      CSD027
     I                                      390 3910PSTM                  S01518
     I**********                            392 403 PONS                               S01518 CGL029
     I                                      392 403 PONSQQ                                    CGL029
     I                                      404 411 PIBN                  S01518
     I                                      412 446 PIBA                  S01518
     I**********                            447 4520POBN                               S01518 CSD027
     I**********                            453 4580POCN                               S01518 CSD027
     I                                      447 452 POBN                                      CSD027
     I                                      453 458 POCN                                      CSD027
     I                                      459 466 RCRN                  S01518
     I                                      467 501 RCRA                  S01518
     I                                      502 509 RVNO                  S01518
     I                                      510 517 AWBN                  S01518
     I                                      518 552 AWBA                  S01518
     I                                      553 560 BENN                  S01518
     I                                      561 595 BENA                  S01518
     I                                      596 630 DTP1                  S01518
     I                                      631 665 DTP2                  S01518
     I                                      666 700 DPT3                  S01518
     I                                      701 735 DPT4                  S01518
     I                                      736 738 DCHG                  S01518
     I                                      739 773 BTB1                  S01518
     I                                      774 808 BTB2                  S01518
     I                                      809 843 BTB3                  S01518
     I                                      844 878 BTB4                  S01518
     I                                      879 913 BTB5                  S01518
     I                                      914 948 BTB6                  S01518
     I                                      949 949 CVMR                  S01518
     I                                    P 950 9557FSRPS                 CAC001
     I                                      956 956 FSGNS                 CAC001
     I                                      957 960 FPRCS                 CAC001
     I                                    P 961 9670COFA                  CAC001
     I                                      968 968 IRCF                  CAC001
     I                                      969 969 FRCF                  CAC001
     I                                      974 974 MNSG                  122667
     I                                      975 975 GASS                  122667
     I                                      976 976 GPRT                  122667
     I**********                            978 9830ROLN                               122667 CLE148
     I                                      978 983 ROLN                                      CLE148
     I                                      984 9860ROSN                                      235579
     I**********                            990 9950RORC                               235579 CPK028
     I                                      990 995 RORC                                      CPK028
     I                                      9981000 RLCY                  CLE004
     I                                    P100110070PNAM                                      235579
     I                                     10081008 PAST                  CLE007
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                  CEU020
     I                                     10681068 REPI                                      CAS005
     I                                    P106910750CHDU                                      CLE028
     I                                    P107610820INTN                                      CAS005
     I                                    P108310890PRAMN                                     CAS005
     I                                    P109010968REXR                                      CLE031
     I                                     10971097 REXI                                      CLE031
     I                                     10981100 PSCY                                      CLE031
     I                                    P110111078PEXR                                      CLE031
     I                                     11081108 PEXI                                      CLE031
     I                                     11091109 STAL                                      CLE034
     I                                     11101129 FRNT                                      CAP075
     I                                     11301149 AFRT                                      CAP075
     I                                     11501150 REPA                                      CAP075
     I                                     11511176 TMST                                      CAP075
     I                                     11771194 OSAC                                      CGL029
     I                                     11951212 RONS                                      CGL029
     I                                     12131230 PONS                                      CGL029
     I                                    P123512410FRAM                                      246490
     I                                    P124212480FINT                                      246490
     I                                    P124912550FTXA                                      246490
     I                                    P125612620FTOT                                      246490
     I                                    P126312690FPEN                                      CLE134
     I                                    P127012757BASR                                      CLE134
     I                                     12801283 CLAS                                      CLE042
      *                                                                                       CLE031
0379 I                                        1 256 LOTA1
0380 I                                      257 320 LOTA2
0442 I***********                           321 949 LOTA3          S01518 CAC001
     I***********                           321 969 LOTA3          CAC001 CLE004
     I***********                           3211057 LOTA3          CLE004 CLE005
     I***********                           3211060 LOTA3          CLE005 CEU004
     I***********                           3211066 LOTA3          CEU004 CEU020
     I***********                           3211067 LOTA3                              CEU020 CLE028
     I**********                            3211075 LOTA3                              CLE028 CAS005
     I**********                            3211089 LOTA3                              CAS005 CLE031
     I**********                            3211108 LOTA3                              CLE031 CLE034
     I**********                            3211109 LOTA3                              CLE034 CAP075
     I**********                            3211176 LOTA3                              CAP075 CGL029
     I**********                            3211230 LOTA3                              CGL029 CLE036
     I**************************************3211268 LOTA3                              CLE036 CLE042
     I                                      3211291 LOTA3                                     CLE042
     I/COPY WNCPYSRC,LE0400I006
0381 I*
0382 I** ACTIONS TODAY FILE - DETAIL RECORD
0383 I*
0384 I        NS  12   1 CD
0385 I       OR        1 CR
0386 I                                        1   1 RECI
0387 I**********                              2   70LNRF    M3                                CLE148
     I                                        2   7 LNRF    M3                                CLE148
0388 I                                        8  120VDAT    M2
0389 I                                       13  150LASN
0390 I                                       16  160MRIN
0391 I                                       17  18 LTYP
0392 I                                       19  20 SUTP
0393 I                                       21  220PTYP
0394 I                                       23  24 AMTP
0395 I                                       25  260PRSQ    M1
0396 I                                       27  280BRTT
0397 I                                    P  29  347RTSP
0398 I                                       35  37 CCY
0399 I                                    P  38  440PRAM
0400 I                                    P  45  510INTA
0401 I                                    P  52  580WTXA
0402 I                                    P  59  650FEAM
0403 I                                    P  66  720TAMT
0404 I***********                            73  750BRCD    M5            S01117
0404 I                                       73  75 BRCA    M5            S01117
0405 I**********                             76  810CNUM    M4                                CSD027
0405 I                                       76  81 CNUM    M4                                CSD027
0406 I                                       82  820REPT
0407 I                                       83  83 AUTO
0408 I                                       84  84 STAI
0409 I                                       85  860SETP
0410 I**********                             87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
0411 I                                       99 108 TSEN
0412 I                                      109 118 FACO
0413 I                                      119 148 SPI1
0414 I                                      149 178 SPI2
0415 I                                      179 208 SPI3
0416 I                                      209 209 LAIN
0417 I                                    P 210 2157BRTE
0418 I                                      216 216 SPIN
0419 I                                      217 2170CALC
0420 I                                      218 218 WTIN
0421 I                                      219 219 LLAG
0422 I                                      220 220 LWOI
0423 I                                      221 2250XAVD
0424 I                                      226 2280XASQ
0425 I***********                           229 2340FCUS                                      CSD027
0425 I                                      229 234 FCUS                                      CSD027
0426 I                                      235 2370FTYP
0427 I                                      238 2390FSEQ
0428 I***********                           240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
0429 I                                      246 2470FECD
0430 I                                      248 248 PDNI
0431 I                                      249 249 ACTI            72
0432 I                                      250 250 CNFY
0433 I                                      251 251 TLXY
0434 I                                      252 252 CBLY
0435 I                                      253 253 INTC
0436 I                                      255 255 ACBI
     I                                      256 256 CHIN
     I                                    P 257 2580LSWCC                                     235579
     I                                    P 259 2600LSWSC                                     235579
     I                                      261 263 OSBR                  S01117
     I                                      264 266 FCLB                  S01117
     I                                    P 267 2690LSMD                                      235579
     I                                    P 270 2760REBT                  S01392
0437 I                                    P 311 3130ORED
0438 I                                    P 314 3160LCD
0439 I                                      317 317 CHTP
0440 I                                    P 318 3200TNLU
     I                                      321 3220RSTM                  S01518
     I**********                            323 334 RONS                               S01518 CGL029
     I                                      323 334 RONSQQ                                    CGL029
     I                                      335 342 RIBN                  S01518
     I                                      343 377 RIBA                  S01518
     I**********                            378 3830ROBN                               S01518 CSD027
     I**********                            384 3890ROCN                               S01518 CSD027
     I                                      378 383 ROBN                                      CSD027
     I                                      384 389 ROCN                                      CSD027
     I                                      390 3910PSTM                  S01518
     I**********                            392 403 PONS                               S01518 CGL029
     I                                      392 403 PONSQQ                                    CGL029
     I                                      404 411 PIBN                  S01518
     I                                      412 446 PIBA                  S01518
     I**********                            447 4520POBN                               S01518 CSD027
     I**********                            453 4580POCN                               S01518 CSD027
     I                                      447 452 POBN                                      CSD027
     I                                      453 458 POCN                                      CSD027
     I                                      459 466 RCRN                  S01518
     I                                      467 501 RCRA                  S01518
     I                                      502 509 RVNO                  S01518
     I                                      510 517 AWBN                  S01518
     I                                      518 552 AWBA                  S01518
     I                                      553 560 BENN                  S01518
     I                                      561 595 BENA                  S01518
     I                                      596 630 DTP1                  S01518
     I                                      631 665 DTP2                  S01518
     I                                      666 700 DPT3                  S01518
     I                                      701 735 DPT4                  S01518
     I                                      736 738 DCHG                  S01518
     I                                      739 773 BTB1                  S01518
     I                                      774 808 BTB2                  S01518
     I                                      809 843 BTB3                  S01518
     I                                      844 878 BTB4                  S01518
     I                                      879 913 BTB5                  S01518
     I                                      914 948 BTB6                  S01518
     I                                      949 949 CVMR                  S01518
     I                                    P 950 9557FSRP                  CAC001
     I                                      956 956 FSGN                  CAC001
     I                                      957 960 FPRC                  CAC001
     I                                    P 961 9670COFA                  CAC001
     I                                      968 968 IRCF                  CAC001
     I                                      969 969 FRCF                  CAC001
     I                                      974 974 MNSG                  122667
     I                                      975 975 GASS                  122667
     I                                      976 976 GPRT                  122667
     I**********                            978 9830ROLN                               122667 CLE148
     I                                      978 983 ROLN                                      CLE148
     I                                      984 9860ROSN                                      235579
     I**********                            990 9950RORC                               235579 CPK028
     I                                      990 995 RORC                                      CPK028
     I                                      9981000 RLCY                  CLE004
     I                                    P100110070PNAM                                      235579
     I                                     10081008 PAST                  CLE007
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                  CEU020
     I                                     10681068 REPI                                      CAS005
     I                                    P106910750CHDU                                      CLE028
     I                                    P107610820INTN                                      CAS005
     I                                    P108310890FSPRAM                                    CAS005
     I                                    P109010968REXR                                      CLE031
     I                                     10971097 REXI                                      CLE031
     I                                     10981100 PSCR                                      CLE031
     I                                    P110111078PEXR                                      CLE031
     I                                     11081108 PEXI                                      CLE031
     I                                     11091109 STAL                                      CLE034
     I                                     11101129 FRNT                                      CAP075
     I                                     11301149 AFRT                                      CAP075
     I                                     11501150 REPA                                      CAP075
     I                                     11511176 TMST                                      CAP075
     I                                     11771194 OSAC                                      CGL029
     I                                     11951212 RONS                                      CGL029
     I                                     12131230 PONS                                      CGL029
     I                                    P123512410FRAM                                      246490
     I                                    P124212480FINT                                      246490
     I                                    P124912550FTXA                                      246490
     I                                    P125612620FTOT                                      246490
     I                                    P126312690FPEN                                      CLE134
     I                                    P127012757BASR                                      CLE134
     I                                     12801283 CLAS                                      CLE042
      *                                                                                       CLE031
0441 I                                        1 256 LOTA1
0442 I                                      257 320 LOTA2
0442 I***********                           321 949 LOTA3          S01518 CAC001
     I***********                           321 969 LOTA3          CAC001 CLE004
     I***********                           3211057 LOTA3          CLE004 CLE005
     I***********                           3211060 LOTA3          CLE005 CEU004
     I***********                           3211066 LOTA3          CEU004 CEU020
     I**********                            3211067 LOTA3                 CEU020              CLE028
     I**********                            3211075 LOTA3                              CLE028 CAS005
     I**********                            3211089 LOTA3                              CAS005 CLE031
     I**********                            3211108 LOTA3                              CLE031 CLE034
     I**********                            3211109 LOTA3                              CLE034 CAP075
     I**********                            3211176 LOTA3                              CAP075 CGL029
     I**********                            3211230 LOTA3                              CGL029 CLE036
     I**************************************3211268 LOTA3                              CLE036 CLE042
     I                                      3211291 LOTA3                                     CLE042
0443 I*
0444 I** ACTIONS TODAY FILE - TRAILER RECORD
0445 I*
0446 I        NS  13   1 CT
0447 I                                        1   1 RECI
0448 I                                    P  17  190NOREA
0449 I*
0450 I** ACTIONS TODAY FILE - CATCH ALL
0451 I*
0452 I        NS  14
0453 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I*                                                                                       248851
     IHISTRPF                                                                                 248851
     I              RECI                            XRECI                                     248851
     I              RCDT                            XRCDT                                     248851
     I              BRCA                            XBRCA                                     248851
     I              CNUM                            XCNUM                                     248851
     I              LNRF                            XLNRF                                     248851
     I              VDAT                            XVDAT                                     248851
     I              PRSQ                            XPRSQ                                     248851
     I              LASN                            XLASN                                     248851
     I              FCUS                            XFCUS                                     248851
     I              FTYP                            XFTYP                                     248851
     I              FSEQ                            XFSEQ                                     248851
     I              PTYP                            XPTYP                                     248851
     I              CCY                             XCCY                                      248851
     I              AMTP                            XAMTP                                     248851
     I              PRAM                            XPRAM                                     248851
     I              INTA                            XINTA                                     248851
     I              WTXA                            XWTXA                                     248851
     I              FEAM                            XFEAM                                     248851
     I              FECD                            XFECD                                     248851
     I              WOIN                            XWOIN                                     248851
     I              EXVD                            XEXVD                                     248851
     I              LTYP                            XLTYP                                     248851
     I              SUTP                            XSUTP                                     248851
     I              ZZ013                           XZZ013                                    248851
     I              LCD                             XLCD                                      248851
     I              ZZ001                           XZZ001                                    248851
     I              COFA                            XCOFA                                     248851
     I              CPAM                            XCPAM                                     248851
     I              AITC                            XAITC                                     248851
     I              INTR                            XINTR                                     248851
     I              AIAP                            XAIAP                                     248851
     I              IPRD                            XIPRD                                     248851
     I              MNSG                            XMNSG                                     248851
     I              GASS                            XGASS                                     248851
     I              GPRT                            XGPRT                                     248851
     I              ROLN                            XROLN                                     248851
     I              ACDA                            XACDA                                     248851
     I              COFR                            XCOFR                                     248851
     I              ACAP                            XACAP                                     248851
     I              COFD                            XCOFD                                     248851
     I              REPI                            XREPI                                     248851
     I              CHDU                            XCHDU                                     248851
     I              AITN                            XAITN                                     248851
     I              AIAN                            XAIAN                                     248851
     I              IPRN                            XIPRN                                     248851
     I              INTN                            XINTN                                     248851
     I              FSPRAM                          XFSPRA                                    248851
     I              FSCPAM                          XFSCPA                                    248851
     I              REPT                            XREPT                                  AR1057551
     IHISTRQF                                                                                 248851
     I              RECI                            XRECI                                     248851
     I              RCDT                            XRCDT                                     248851
     I              BRCA                            XBRCA                                     248851
     I              CNUM                            XCNUM                                     248851
     I              LNRF                            XLNRF                                     248851
     I              VDAT                            XVDAT                                     248851
     I              PRSQ                            XPRSQ                                     248851
     I              LASN                            XLASN                                     248851
     I              FCUS                            XFCUS                                     248851
     I              FTYP                            XFTYP                                     248851
     I              FSEQ                            XFSEQ                                     248851
     I              PTYP                            XPTYP                                     248851
     I              CCY                             XCCY                                      248851
     I              AMTP                            XAMTP                                     248851
     I              BRTT                            XBRTT                                     248851
     I              BRTE                            XBRTE                                     248851
     I              RTSP                            XRTSP                                     248851
     I              SPIN                            XSPIN                                     248851
     I              CALC                            XCALC                                     248851
     I              STAI                            XSTAI                                     248851
     I              PRINRO                          XPRINR                                    248851
     I              DISCRO                          XDISCR                                    248851
     I              ZZ020                           XZZ020                                    248851
     I              LCD                             XLCD                                      248851
     I              ZZ001                           XZZ001                                    248851
     I              FSRP                            XFSRP                                     248851
     I              FSGN                            XFSGN                                     248851
     I              IRCF                            XIRCF                                     248851
     I              FRCF                            XFRCF                                     248851
     I              FPRC                            XFPRC                                     248851
     I              CPAM                            XCPAM                                     248851
     I              AITC                            XAITC                                     248851
     I              INTR                            XINTR                                     248851
     I              AIAP                            XAIAP                                     248851
     I              IPRD                            XIPRD                                     248851
     I              MNSG                            XMNSG                                     248851
     I              RLCY                            XRLCY                                     248851
     I              ACDA                            XACDA                                     248851
     I              COFR                            XCOFR                                     248851
     I              ACAP                            XACAP                                     248851
     I              COFD                            XCOFD                                     248851
     I              AITN                            XAITN                                     248851
     I              AIAN                            XAIAN                                     248851
     I              IPRN                            XIPRN                                     248851
     I              FSCPAM                          XFSCPA                                    248851
      *                                                                                     AR317587
     IHISTM1F                                                                               AR317587
     I              RECI                            XRECI                                   AR317587
     I              RCDT                            XRCDT                                   AR317587
     I              BRCA                            XBRCA                                   AR317587
     I              CNUM                            XCNUM                                   AR317587
     I              LNRF                            XLNRF                                   AR317587
     I              VDAT                            XVDAT                                   AR317587
     I              PRSQ                            XPRSQ                                   AR317587
     I              LASN                            XLASN                                   AR317587
     I              FCUS                            XFCUS                                   AR317587
     I              FTYP                            XFTYP                                   AR317587
     I              FSEQ                            XFSEQ                                   AR317587
     I              PTYP                            XPTYP                                   AR317587
     I              CCY                             XCCY                                    AR317587
     I              AMTP                            XAMTP                                   AR317587
     I              PRAM                            XPRAM                                   AR317587
     I              BRTT                            XBRTT                                   AR317587
     I              BRTE                            XBRTE                                   AR317587
     I              RTSP                            XRTSP                                   AR317587
     I              SPIN                            XSPIN                                   AR317587
     I              CALC                            XCALC                                   AR317587
     I              WTIN                            XWTIN                                   AR317587
     I              REPT                            XREPT                                   AR317587
     I              INTC                            XINTC                                   AR317587
     I              LTYP                            XLTYP3                                  AR317587
     I              SUTP                            XSUTP                                   AR317587
     I              TOTI                            XTOTI1                                  AR317587
     I              FCLB                            XFCLB                                   AR317587
     I              LCD                             XLCD                                    AR317587
     I              FSRP                            XFSRP                                   AR317587
     I              FSGN                            XFSGN                                   AR317587
     I              TCOF                            XTCOF                                   AR317587
     I              FPRC                            XFPRC                                   AR317587
     I              CPAM                            XCPAM                                   AR317587
     I              AITC                            XAITC                                   AR317587
     I              INTR                            XINTR                                   AR317587
     I              AIAP                            XAIAP                                   AR317587
     I              IPRD                            XIPRD                                   AR317587
     I              ACDA                            XACDA                                   AR317587
     I              COFR                            XCOFR                                   AR317587
     I              ACAP                            XACAP                                   AR317587
     I              COFD                            XCOFD                                   AR317587
      *                                                                                     AR317587
      *                                                                                     AR317587
     IHISTN1F                                                                               AR317587
     I              RECI                            XRECI                                   AR317587
     I              RCDT                            XRCDT                                   AR317587
     I              BRCA                            XBRCA                                   AR317587
     I              CNUM                            XCNUM                                   AR317587
     I              LNRF                            XLNRF                                   AR317587
     I              VDAT                            XVDAT                                   AR317587
     I              PRSQ                            XPRSQ                                   AR317587
     I              LASN                            XLASN                                   AR317587
     I              FCUS                            XFCUS                                   AR317587
     I              FTYP                            XFTYP                                   AR317587
     I              FSEQ                            XFSEQ                                   AR317587
     I              PTYP                            XPTYP                                   AR317587
     I              CCY                             XCCY                                    AR317587
     I              AMTP                            XAMTP                                   AR317587
     I              PRAM                            XPRAM                                   AR317587
     I              BRTE                            XBRTE                                   AR317587
     I              RTSP                            XRTSP                                   AR317587
     I              CALC                            XCALC                                   AR317587
     I              SPIN                            XSPIN                                   AR317587
     I              INTA                            XINTA                                   AR317587
     I              STPG                            XSTPG                                   AR317587
     I              BRTT                            XBRTT                                   AR317587
     I              PPIS                            XPPIS                                   AR317587
     I              IPIS                            XIPIS                                   AR317587
     I              IPPS                            XIPPS                                   AR317587
     I              FSRP                            XFSRP                                   AR317587
     I              FSGN                            XFSGN                                   AR317587
     I              COFA                            XCOFA                                   AR317587
     I              FPRC                            XFPRC                                   AR317587
      *                                                                                     AR317587
     IHISTP1F                                                                               AR317587
     I              RECI                            XRECI                                   AR317587
     I              RCDT                            XRCDT                                   AR317587
     I              BRCA                            XBRCA                                   AR317587
     I              CNUM                            XCNUM                                   AR317587
     I              LNRF                            XLNRF                                   AR317587
     I              VDAT                            XVDAT                                   AR317587
     I              PRSQ                            XPRSQ                                   AR317587
     I              LASN                            XLASN                                   AR317587
     I              FCUS                            XFCUS                                   AR317587
     I              FTYP                            XFTYP                                   AR317587
     I              FSEQ                            XFSEQ                                   AR317587
     I              PTYP                            XPTYP                                   AR317587
     I              CCY                             XCCY                                    AR317587
     I              AMTP                            XAMTP                                   AR317587
     I              PRAM                            XPRAM                                   AR317587
     I              INTA                            XINTA                                   AR317587
     I              WTXA                            XWTXA                                   AR317587
     I              FEAM                            XFEAM                                   AR317587
     I              FECD                            XFECD                                   AR317587
     I              WOIN                            XWOIN                                   AR317587
     I              EXVD                            XEXVD                                   AR317587
     I              LTYP                            XLTYP                                   AR317587
     I              SUTP                            XSUTP                                   AR317587
     I              LCD                             XLCD                                    AR317587
     I              COFA                            XCOFA                                   AR317587
     I              CPAM                            XCPAM                                   AR317587
     I              AITC                            XAITC                                   AR317587
     I              INTR                            XINTR                                   AR317587
     I              AIAP                            XAIAP                                   AR317587
     I              IPRD                            XIPRD                                   AR317587
     I              MNSG                            XMNSG                                   AR317587
     I              GASS                            XGASS                                   AR317587
     I              GPRT                            XGPRT                                   AR317587
     I              ROLN                            XROLN                                   AR317587
     I              ACDA                            XACDA                                   AR317587
     I              COFR                            XCOFR                                   AR317587
     I              ACAP                            XACAP                                   AR317587
     I              COFD                            XCOFD                                   AR317587
     I              REPI                            XREPI                                   AR317587
     I              REPT                            XREPT                                  AR1057551
      *                                                                                     AR317587
     IHISTQ1F                                                                               AR317587
     I              RECI                            XRECI                                   AR317587
     I              RCDT                            XRCDT                                   AR317587
     I              BRCA                            XBRCA                                   AR317587
     I              CNUM                            XCNUM                                   AR317587
     I              LNRF                            XLNRF                                   AR317587
     I              VDAT                            XVDAT                                   AR317587
     I              PRSQ                            XPRSQ                                   AR317587
     I              LASN                            XLASN                                   AR317587
     I              FCUS                            XFCUS                                   AR317587
     I              FTYP                            XFTYP                                   AR317587
     I              FSEQ                            XFSEQ                                   AR317587
     I              PTYP                            XPTYP                                   AR317587
     I              CCY                             XCCY                                    AR317587
     I              AMTP                            XAMTP                                   AR317587
     I              BRTT                            XBRTT                                   AR317587
     I              BRTE                            XBRTE                                   AR317587
     I              RTSP                            XRTSP                                   AR317587
     I              SPIN                            XSPIN                                   AR317587
     I              CALC                            XCALC                                   AR317587
     I              STAI                            XSTAI                                   AR317587
     I              PRINRO                          XPRNRO                                  AR317587
     I              DISCRO                          XDSCRO                                  AR317587
     I              ZZ020                           XZZ020                                  AR317587
     I              LCD                             XLCD                                    AR317587
     I              ZZ001                           XZZ001                                  AR317587
     I              FSRP                            XFSRP                                   AR317587
     I              FSGN                            XFSGN                                   AR317587
     I              IRCF                            XIRCF                                   AR317587
     I              FRCF                            XFRCF                                   AR317587
     I              FPRC                            XFPRC                                   AR317587
     I              CPAM                            XCPAM                                   AR317587
     I              AITC                            XAITC                                   AR317587
     I              INTR                            XINTR                                   AR317587
     I              AIAP                            XAIAP                                   AR317587
     I              IPRD                            XIPRD                                   AR317587
     I              MNSG                            XMNSG                                   AR317587
     I              RLCY                            XRLCY                                   AR317587
     I              ACDA                            XACDA                                   AR317587
     I              COFR                            XCOFR                                   AR317587
     I              ACAP                            XACAP                                   AR317587
     I              COFD                            XCOFD                                   AR317587
      *                                                                                     AR317587
     IACTN3PF                                                                               AR317587
     I              LNRF                            LNRFX                                   AR317587
     I              VDAT                            VDATX                                   AR317587
     I              AMTP                            AMTPX                                   AR317587
     I              PRAM                            PRAMX                                   AR317587
     I              INTA                            INTAX                                   AR317587
     I              TAMT                            TAMTX                                   AR317587
     I              XAVD                            XAVDX                                   AR317587
0454 I*
0455 I***TABLE*FILE*-INSTALLATION*CONTROL*DATA*RECORD*1                   S01194
0456 I*                                                                   S01194
0457 I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
0458 I*******AND      13 C0                                               S01194
0459 I**********                              1   1 RECI                  S01194
0460 I**********                              2   30RECT                  S01194
0461 I**********                             12  130RCDE                  S01194
0462 I**********                             14  66 TITL                  S01194
0463 I**********                             67  67 DATF                  S01194
0464 I***********                            68  700DFBR                  S01194
0465 I**********                             74  74 MODI1                 S01194
0466 I**********                             75  75 MODI2                 S01194
0467 I**********                             76  76 MODI3                 S01194
0468 I**********                          P  77  790RUND                  S01194
0469 I**********                             80  86 RUNA                  S01194
0470 I**********                             87  870SFLG                  S01194
0471 I**********                          P  90  920LCD                   S01194
0472 I**********                             93  93 CHTP                  S01194
0473 I**********                          P  94  960TNLU                  S01194
0474 I*
0475 I*
0476 I***TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2                  S01194
0477 I*
0478 I********NS       2 C0   3 C1  12 C1                                 S01194
0479 I*******AND      13 C1                                               S01194
0480 I**********                              1   1 RECI                  S01194
0481 I**********                              2   30RECT                  S01194
0482 I**********                             12  130RCDE                  S01194
0483 I**********                             14  16 BCCY                  S01194
0484 I**********                             17  19 BCYL                  S01194
0485 I**********                             20  22 HOCY                  S01194
0486 I**********                             23  280HEAD                  S01194
0487 I**********                          P  29  310APDA                  S01194
0488 I**********                             35  35 APFQ                  S01194
0489 I**********                          P  36  380LOGS                  S01194
0490 I**********                             39  40 CUZR                  S01194
0491 I**********                          P  41  430DNWD                  S01194
0492 I**********                             44  460BVLP                  S01194
0493 I**********                             47  49 LOCY                  S01194
0494 I**********                             50  510FDAY                  S01194
0495 I**********                             52  52 ACLD                  S01194
0496 I***********                            53  53 MBIN                  S01194
0497 I**********                             86  86 ISAV                  S01194
0498 I**********                          P  87  890LLOG                  S01194
0499 I**********                          P  90  920LCD                   S01194
0500 I**********                             93  93 CHTP                  S01194
0501 I**********                          P  94  960TNLU                  S01194
0502 I*
0503 I***TABLE*FILE*-*CURRENCY*RECORD*1                                   S01194
0504 I*
0505 I********NS       2 C2   3 C0  13 C1                                 S01194
0506 I**********                              1   1 RECI                  S01194
0507 I**********                              2   30RECT                  S01194
0508 I**********                             10  12 CCY                   S01194
0509 I**********                             13  130SREC                  S01194
0510 I**********                             14  27 CCNM                  S01194
0511 I**********                          P  28  348SPOT                  S01194
0512 I**********                             35  37 CCYS                  S01194
0513 I**********                             38  380CDP                   S01194
0514 I**********                             39  390TNOT                  S01194
0515 I**********                             40  40 DCCY                  S01194
0516 I**********                             41  44 SRC1                  S01194
0517 I**********                             45  48 SRC2                  S01194
0518 I**********                             49  520TACC                  S01194
0519 I**********                             53  560TEQV                  S01194
0520 I**********                             57  600SWQV                  S01194
0521 I**********                             61  640TAC4                  S01194
0522 I**********                             65  680TAC5                  S01194
0523 I**********                             69  69 HIND                  S01194
0524 I**********                          P  70  768PART                  S01194
0525 I**********                             77  780SSNO                  S01194
0526 I**********                          P  79  858ERLC                  S01194
0527 I**********                             86  860MDIN                  S01194
0528 I**********                             87  870MDIA                  S01194
0529 I**********                             88  880MDIB                  S01194
0530 I**********                          P  90  920LCD                   S01194
0531 I**********                             93  93 CHTP                  S01194
0532 I**********                          P  94  960TNLU                  S01194
     I*                                                                   S01408
     I/COPY WNCPYSRC,LE0400IIP1                                           S01408
     I*                                                                   S01408
0533 I*
0534 I** DATA STRUCTURES
0535 I*
0536 I*
0537 I** KEY TO CURRENCY RECORD
0538 I*
0539 I**********  DS                                                      S01194
0540 I**********                              9  11 CCY                   S01194
0541 I**********                              1  12 ZTABKY                S01194
0542 I*
0543 I** LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS
0544 I*
0545 ILDA        UDS                            256
0546 I***********                           134 138 DBFILE                S01117
0547 I***********                           139 167 DBKEY                 S01117
0548 I***********                           168 175 DBPGM                 S01117
0549 I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - P1                           S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - AU                           S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
      **                                                                  S01117
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
      *                                                                                     AR786878
     I            DS                                                                        AR786878
     I                                        1  18 DSRPOS                                  AR786878
     I                                        1   6 DSACCN                                  AR786878
     I                                        7  16 DSACAC                                  AR786878
     I                                       17  18 DSACAS                                  AR786878
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJBVPD                          BVLP                  S01194
     I              BJURPT                          TITL                  S01194
      **                                                                  S01117
     ID#CLON      DS                                                                          CLE028
     I**********                              1   60WALON                              CLE028 CLE148
     I                                        1   6 WALON                                     CLE148
     I                                        7   7 WEPAR                                     CLE028
     IWVCATC      DS                                                                          CLE164
     I                                        1   50PFCNR                                     CLE164
     I                                        7   80PFSEQ                                     CLE164
     I                                        9  160PREPR                                     CLE164
     I                                       17  240PCAPR                                     CLE164
      *                                                                                       CLE028
      ** General ledger details                                                               CLE028
     ISDGELR    E DSSDGELRPD                                                                  CLE028
      *                                                                                       CLE028
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01194
     I              QQDFAC                          DFACBK                                    CGL029
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              A6NBDP                          CDP                   S01194
     I*                                                                   CEU004
     ISCSARD    E DSSCSARDPD                                              CEU004
     I/COPY WNCPYSRC,LE0400I008
     I* SAR file details accessed via access program AOSARDR0             CEU004
     I*                                                                   CEU004
      *                                                                   CAC001
     I*SDSVAL***E*DSSDSVALPD*                                                          218782 222373
      ****EXTERNAL*DS*FOR*SYSTEM*VALUES*                                               218782 222373
      **********                                                                       218782 222373
     ISDMMOD    E DSSDMMODPD                                              CAC001
      **  External DS for Module Details                                  CAC001
     I*                                                                   S01408
     I/COPY WNCPYSRC,LE0400IIP2                                           S01408
     I*                                                                   S01408
     ISDCUST    E DSSDCUSTPD                                              CPB002
     I**  External Data Structure for Customer Details.                   CPB002
     I              QQDFAC                          #DFAC1                                    CGL029
     I*                                                                   CPB002
     IDSLDY     E DSDSLDY                                                 CPB002
     I* THIRD DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE            CPB002
     I*                                                                   CPB002
      *                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     I/COPY WNCPYSRC,LE0400I001
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/COPY ZSRSRC,ZHOLI                                                                      CLE028
     I              'PRINCIPAL'           C         K1                                        CLE164
     I              'INTEREST '           C         K2                                        CLE164
      **                                                                  S01117
     C                     MOVEACPY@      BIS@   80
      *                                                                   S01117
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C**                                                                  S01117
     C** PARAMETER LIST FOR PROGRAM 'AOCURRR0'                            S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CURKEY  3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C*                                                                   CAC001
     C** Parameter List for Program 'AOMMODR0'.                           CAC001
     C*                                                                   CAC001
     C           PMMOD     PLIST                                          CAC001
     C                     PARM '*MSG   ' @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
     C/COPY WNCPYSRC,LE0400C018
0550 C*
0551 C** MAIN PROCESSING
0552 C*
0553 C** CALLS:      INIT,EXCPT,ACTN,HIST,PREVLN
0554 C*
0555 C** FIRST CYCLE CALCS
0556 C*
0557 C  N50                EXSR INIT
0558 C  N50 U7 U8          EXSR EXCPT                      DATABASE ERROR
0559 C  N50 U7 U8          GOTO END                        - PRINT
0560 C*
0561 C** NEW LOAN - RESET INDICATORS AND ZEROISE FIELDS
0562 C*
0563 C   L1                SETOF                     152829
0564 C   L1                SETOF                     202122
0565 C   L1                SETOF                     232425
     C   L1                SETOF                     70
     C   L1                SETOF                     80
0566 C   L1                Z-ADD0         INPAID 130       INT.PD.THIS RUN
0567 C   L1                Z-ADD0         INPAST 130       INT.PS.DUE  "
     C   L1                Z-ADD0         CFPAID 130       COF.PD.THIS    CAC001
     C   L1                Z-ADD0         CFPAST 130       COF.PS.DUE  "  CAC001
0568 C   L1                Z-ADD0         NOSTRC  50       NO.STMT.RECS/LN
     C   L1                Z-ADD0         OPINTA                                             248851A
0569 C   L1                MOVE ' '       STAIND  1
     C   L1                MOVE ' '       ECIN                            183577
     C/COPY WNCPYSRC,LE0400C012
      *                                                                   CLE003
     C   L1                MOVE 'Y'       W#ACTN                          CLE003
     C   L1                MOVE 'N'       W#CONV                          CLE003
     C   L1                Z-ADD*ZEROS    TPRAM                                               247935
     C   L1                Z-ADD0         WOPRIN 130                                        AR790759
      *                                                                                       235743
      ** Ensure IN52 is initialised for every change in loan                                  235743
      *                                                                                       235743
     C           *INL1     IFEQ '1'                                                           235743
     C           CLE004    ANDEQ'Y'                                                           235743
     C                     MOVE '0'       IN52                                                235743
     C                     Z-ADD*ZEROS    W#VDAT                                              235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
      *                                                                                       CLE028
     C   L1                Z-ADD0         WCHDU                                               CLE028
     C   L1                Z-ADD0         WINTA                                               CLE028
     C   L1                Z-ADD0         WTCHDU                                              CLE028
     C   L1                Z-ADD0         W#CPAM                                              CLE028
      *                                                                                       CLE028
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *INL1     ANDEQ*ON                                                           CAS005
     C                     Z-ADD*ZEROS    NTRPID 130                                          CAS005
     C                     Z-ADD*ZEROS    NTRPST 130                                          CAS005
     C                     ENDIF                                                              CAS005
0570 C*
0571 C** DELETED REC FOUND - DATABASE ERROR
0572 C*
0573 C   09
0574 COR 14                SETON                     U7U8LR
0575 C   U7                MOVEL'LOAN '   DBKEY1 12
0576 C   U7                MOVE LNRF      DBKEY1
0577 C   U7                MOVELDBKEY1    DBKEY
0578 C   U7                Z-ADD5         DBASE
0579 C   U7 09             MOVE 'HISTS'   DBFILE
0580 C   U7 14             MOVE 'ACTN4'   DBFILE
0581 C   U7                EXSR EXCPT
0582 C   U7                GOTO END
0583 C*
0584 C** COUNT RECORDS READ FROM EACH FILE
0585 C*
0586 C   10
0587 COR 11
0588 COR 12
0589 COR 13      NACTN4    ADD  1         NACTN4  50
0590 C  N10N11N12
0591 CANN13      NHISTS    ADD  1         NHISTS  50
0592 C*
0593 C** FILE HEADERS -WRITE TO HIUPD OR ACTN5 AND MAINTAIN COUNT
0594 C*
0595 C   01
0596 COR 10                SETON                     41
0597 C   10                SETOF                     18    O/P AS I/P
0598 C   01
0599 COR 10                EXSR EXCPT
0600 C   01      NHIUPD    ADD  1         NHIUPD  50
0601 C   10      NACTN5    ADD  1         NACTN5  50
0602 C*
0603 C** TRAILER RECORD - IGNORE
0604 C*
0605 C   08
0606 COR 13
0607 COR 01
0608 COR 10                GOTO END
      **                                                                  S01117
      **  DO THE CHANGE OF BRANCH PROCESSING WHEN LEVEL BREAK             S01117
      **    (CHANGE OF BRANCH)                                            S01117
      **                                                                  S01117
     C           *INL2     IFEQ '1'                                       S01117
      *                                                                   S01117
     C                     CLOSELE0400P1                                  S01117
     C                     MOVE *BLANK    P1DTLC                          S01117
     C                     OPEN LE0400P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     SETON                     OF                   S01117
      **                                                                  S01117
      **   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      **                                                                  S01117
      ** GET BRANCH NAME WHEN MBIN = 'Y'                                  S01117
      **                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 013 *S01117
     C                     Z-ADD13        DBASE            ***************S01117
     C                     SETON                     U7U8LR               S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C*                                                                   S01392
     C***********          Z-ADD0         PRINRO                    S01392133936
     C***********          Z-ADD0         DISCRO                    S01392133936
     C**                                                                  S01117
0610 C** PROCESS REC. ACCORDING TO FILE READ
0611 C*
     C********** CLE004    IFEQ 'Y'                                                    CLE004 235743
     C**********           MOVE '0'       IN52                                         CLE004 235743
     C**********           ENDIF                                                       CLE004 235743
      *                                                                                       206596
      ** Record read is from control record or detail records (ACTN3DK/N)                     206596
      *                                                                                       206596
     C           *IN11     IFEQ '1'                                                           206596
     C           *IN12     OREQ '1'                                                           206596
      *                                                                                       206596
     C           WWLOAN    KLIST                                                              206596
     C                     KFLD           LNRF                                                206596
     C                     KFLD           RCDT                                                206596
     C                     MOVE 'A'       RCDT                                                206596
     C                     MOVE *IN26     WIN26   1                                           206596
      *                                                                                       206596
     C           WWLOAN    CHAINCLOAN               N26                                       206596
     C           *IN26     IFEQ '1'                                                           206596
     C           *LOCK     IN   LDA                                                           206596
     C                     MOVEL'CLOAN'   DBFILE           ************                       206596
     C                     Z-ADD20        DBASE            * DBERR 20 *                       206596
     C                     MOVELLNRF      DBKEY            ************                       206596
     C                     OUT  LDA                                                           206596
     C                     EXSR *PSSR                                                         206596
     C                     ENDIF                                                              206596
      *                                                                                     AR317587
      ** If loan amendments value date (VDAT) is later than maturity                        AR317587
      ** date (MDAT) but expected value date (XAVD) is earlier or                           AR317587
      ** equal than MDAT, use XAVD as VDAT of the loan.                                     AR317587
      *                                                                                     AR317587
     C                     MOVE *BLANKS   WXIND   1                                         AR317587
     C           *LIKE     DEFN VDAT      WVDTE                                             AR317587
      *                                                                                     AR317587
     C           VDAT      IFGT WMDAT                                                       AR317587
     C           XAVD      ANDLEWMDAT                                                       AR317587
     C           XAVD      ANDNE*ZERO                                                       AR317587
     C           VDAT      ANDLERUND                                                        AR317587
     C           WMDAT     ANDNE*ZERO                                                      AR1084876
     C                     MOVE 'Y'       WXIND                                             AR317587
     C                     Z-ADDVDAT      WVDTE                                             AR317587
     C                     Z-ADDWMDAT     VDAT                                              AR317587
     C                     ENDIF                                                            AR317587
      *                                                                                       CAS005
      ** Save the Margin Rate                                                                 CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDMARG      WKMARG  75                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       206596
      ** Skip loan amendments if they are later than maturity date                            206596
      ** Maturity date is updated in LE0450                                                   206596
      *                                                                                       206596
     C           VDAT      IFGT WMDAT                                                         206596
     C           WMDAT     ANDNE0                                                             206596
     C           AMTP      ANDNE'RV'                                                          240789
      *                                                                                       206596
      ** Skip loan amendments if New Maturity date is zero                                    206596
      *                                                                                       206596
     C           WNMDT     IFEQ 0                                                             206596
      *                                                                                       206596
      ** ... or if New Maturity date not zero but Rollover date is                            206596
      ** zero (no rollover during COB)                                                        206596
      *                                                                                       206596
     C           WNMDT     ORNE 0                                                             206596
     C           WRLDT     ANDEQ0                                                             206596
      *                                                                                       206596
      ** ... or if New Maturity date is not zero and Rollover date is                         206596
      ** greater than rundate (no rollover during COB)                                        206596
      *                                                                                       206596
     C           WNMDT     ORNE 0                                                             206596
     C           WRLDT     ANDNE0                                                             206596
     C           WRLDT     ANDGTRUND                                                          206596
      *                                                                                       206596
      ** ... or if New Maturity date is not zero and Rollover date is                         206596
      ** less than or equal to rundate (there's rollover on COB) and                          206596
      ** Loan Amendment's value date is greater than the New Maturity                         206596
      ** date                                                                                 206596
      *                                                                                       206596
     C           WNMDT     ORNE 0                                                             206596
     C           WRLDT     ANDNE0                                                             206596
     C           WRLDT     ANDLERUND                                                          206596
     C           VDAT      ANDGTWNMDT                                                         206596
      *                                                                                       206596
     C                     GOTO END                                                           206596
     C                     ENDIF                                                              206596
      *                                                                                       206596
     C                     ENDIF                                                              206596
      *                                                                                       206596
     C                     MOVE WIN26     *IN26                                               206596
     C                     ENDIF                                                              206596
      *                                                                                       CAS009
      ** Initialise cash flow flag                                                            CAS009
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C                     MOVE ' '       WGHCF   1                                           CAS009
     C                     MOVE ' '       WROLL   1                                           232628
     C                     ENDIF                                                              CAS009
      *                                                                                     AR317587
      ** Recalculate from the start if VDAT is greater than MDAT.                           AR317587
      *                                                                                     AR317587
     C           *IN11     IFEQ '0'                                                         AR317587
     C           *IN12     ANDEQ'0'                                                         AR317587
     C           VDAT      ANDGTWMDAT                                                       AR317587
     C           WMDAT     ANDNE*ZERO                                                      AR1084876
      *                                                                                     AR317587
      ** Recalculate only once.                                                             AR317587
      *                                                                                     AR317587
     C           INDIC     IFEQ ' '                                                         AR317587
      *                                                                                     AR317587
     C           KHISR2    SETLLLEHISTLD                                                    AR317587
     C           KHISR2    READELEHISTLD                 17                                 AR317587
     C           *IN17     DOWEQ'0'                                                         AR317587
      *                                                                                     AR317587
     C           XVDAT     IFLE WMDAT                                                       AR317587
     C           XAMTP     ANDNE'MA'                                                        AR317587
     C                     EXSR HIST1                                                       AR317587
     C                     ENDIF                                                            AR317587
     C           KHISR2    READELEHISTLD                 17                                 AR317587
     C                     ENDDO                                                            AR317587
     C                     ENDIF                                                            AR317587
      *                                                                                     AR317587
     C                     MOVE 'Y'       INDIC   1                                         AR317587
     C                     MOVE 'Y'       WXIND                                             AR317587
     C                     Z-ADDVDAT      WVDTE                                             AR317587
     C                     Z-ADDWMDAT     VDAT                                              AR317587
      *                                                                                     AR317587
     C                     ENDIF                                                            AR317587
0612 C   11
0613 COR 12                EXSR ACTN                       ACTN4 FILE READ
0614 C*
0615 C  N11N12             EXSR HIST                       HISTS FILE READ
0616 C*
0617 C   U7 U8             EXSR EXCPT
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                   CLE003
     C           *LIKE     DEFN CPAM      W#CPAM                          CLE003
     C           *LIKE     DEFN AITC      W#AITC                          CLE003
     C           *LIKE     DEFN AIAP      W#AIAP                          CLE003
     C           *LIKE     DEFN INTR      W#INTR                          CLE003
     C           *LIKE     DEFN IPRD      W#IPRD                          CLE003
     C           *LIKE     DEFN ACDA      W#ACDA                          157669
     C           *LIKE     DEFN ACAP      W#ACAP                          157669
     C           *LIKE     DEFN COFR      W#COFR                          157669
     C           *LIKE     DEFN COFD      W#COFD                          157669
      *                                                                   CLE003
     C                     Z-ADDCPAM      W#CPAM                          CLE003
     C                     Z-ADDAITC      W#AITC                          CLE003
     C                     Z-ADDIPRD      W#IPRD                          CLE003
     C                     Z-ADDAIAP      W#AIAP                          CLE003
     C                     Z-ADDINTR      W#INTR                          CLE003
     C                     Z-ADDACDA      W#ACDA                          157669
     C                     Z-ADDCOFD      W#COFD                          157669
     C                     Z-ADDACAP      W#ACAP                          157669
     C                     Z-ADDCOFR      W#COFR                          157669
      *                                                                                       212318
      ** For LS change, always use the previous AITC                                          212318
      *                                                                                       212318
     C           AMTP      IFEQ 'LS'                                                          212318
     C                     Z-ADDL#AITC    AITC                                                212318
     C                     ELSE                                                               212318
      *                                                                                       212318
      ** Else, save the current AITC                                                          212318
      *                                                                                       212318
     C                     Z-ADDAITC      L#AITC 130                                          212318
     C                     ENDIF                                                              212318
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDIPRN      W#IPRN 130                                          CAS005
     C                     Z-ADDAIAN      W#AIAN 130                                          CAS005
     C                     Z-ADDAITN      W#AITN 130                                          CAS005
     C                     Z-ADDFSCPAM    W#FSCP 130                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE003
     C           W#ACTN    IFEQ 'Y'                                       CLE003
     C           *IN67     IFEQ *OFF                                      116678
     C                     Z-ADDCPAM      OSPRIN                          CLE003
     C                     Z-ADDINTR      INTRAT                          CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSCPAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C023
     C           AITC      ADD  AIAP      ACCINT                          116332
     C                     Z-ADDACCINT    ACCIN2 130                                          235743
     C           AITC      ADD  AIAP      AIIACD                          116332
     C/COPY WNCPYSRC,LE0400C024
      *                                                                   157669
      *  If Analytical accounting is ON                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C                     Z-ADDCOFR      COFRAT                          157669
     C           ACDA      ADD  ACAP      ACCCOF                          157669
     C           ACDA      ADD  ACAP      ACIACD                          157669
     C                     ENDIF                                          157669
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           AITN      ADD  AIAN      ACCNTR                                              CAS005
     C           AITN      ADD  AIAN      ANIACD 130                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   157669
     C                     ENDIF                                          116678
      *                                                                   115027
     C           AMTP      IFEQ 'RO'                                      115027
     C           AMTP      OREQ 'ST'                                      115027
     C           AMTP      OREQ 'MC'                                      144911
     C                     Z-ADDCALC      ICALCB                          CLE003
     C                     Z-ADDBRTT      BASECD                          115275
     C                     Z-ADDBRTE      BASERT                          115275
     C                     Z-ADDRTSP      SPREAD                          115275
     C                     MOVE SPIN      SPRIND                          115275
      *                                                                   116675
     C           AMTP      IFEQ 'ST'                                      116675
     C                     MOVE *ON       *IN70                           117041
     C                     MOVE INTC      CAPNIN                          116675
     C                     MOVE REPT      REPTYP                          116675
     C                     MOVE WTIN      WHTTYP                          116675
     C                     MOVE LTYP      LONTYP  2                                           227657
     C                     MOVE SUTP      SUBTYP  2                                           227657
     C           BGN0ST    IFEQ 'Y'                                       116675
     C           CDE002    OREQ 'Y'                                                           208221
     C                     Z-ADDFSRP      FUNDRT                          116675
     C                     MOVE FSGN      FUNDSN                          116675
     C                     MOVE FPRC      FUNPRF                          116675
     C                     ENDIF                                          116675
     C                     ENDIF                                          116675
      *                                                                   116675
     C           AMTP      IFEQ 'RO'                                      116675
     C           BGN0ST    IFEQ 'Y'                                       116675
     C           CDE002    OREQ 'Y'                                                           208221
      *                                                                                       208221
      ** If Revenue Analysis feature is on, perform defaulting of funding                     208221
      ** details                                                                              208221
      *                                                                                       208221
     C********** FPRC      IFEQ *BLANKS                                                116675 204786
     C           FPRC      IFNE *BLANKS                                                       204786
     C           FSRP      ANDEQ*ZEROS                                                        204786
     C           BGN0ST    ANDEQ'Y'                                                           208221
     C                     MOVE '1'       *IN26                           116675
     C                     ELSE                                           116675
     C                     MOVE '0'       *IN26                           116675
     C                     Z-ADDFSRP      FUNDRT                          116675
     C                     MOVE FSGN      FUNDSN                          116675
     C                     MOVE FPRC      FUNPRF                          116675
     C                     ENDIF                                          116675
     C                     EXSR QCFRAT                                    116675
     C                     ENDIF                                          116675
     C                     ENDIF                                          116675
      *                                                                   116675
     C                     ENDIF                                          115027
      *                                                                   115027
     C           AMTP      IFEQ 'BC'                                      115275
     C                     Z-ADDBRTT      BASECD                          115275
     C                     Z-ADDBRTE      BASERT                          115275
     C                     ENDIF                                          115275
      *                                                                   115275
     C           AMTP      IFEQ 'BR'                                      115275
     C                     Z-ADDBRTE      BASERT                          115275
     C                     ENDIF                                          115275
      *                                                                   115275
     C           AMTP      IFEQ 'SC'                                      115275
     C                     Z-ADDRTSP      SPREAD                          115275
     C           BGN0ST    IFEQ 'Y'                                       116675
     C           IRCF      ANDEQ'Y'                                       116675
     C           BGN0ST    OREQ 'N'                                       116675
     C                     EXSR QNTRAT                                    116675
     C                     ENDIF                                          116675
      *                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           CDE002    OREQ 'Y'                                                           208221
     C           FRCF      IFEQ 'Y'                                       157669
     C                     Z-ADDFSRP      FUNDRT                          157669
     C                     ENDIF                                          157669
     C                     EXSR QCFRAT                                    157669
     C                     ENDIF                                          157669
      *                                                                   157669
     C                     ENDIF                                          115275
      *                                                                   117042
     C           AMTP      IFEQ 'SA'                                      117042
     C                     MOVE STAI      STAIND                          117042
     C                     ENDIF                                          117042
      *                                                                   115275
     C/COPY WNCPYSRC,LE0400C042
      *                                                                                     MD028338
     C           *IN06     IFEQ *ON                                                         MD028338
     C           AMTP      ANDEQ'RO'                                                        MD028338
     C           FRCO      ANDEQ'Y'                                                         MD028338
     C                     MOVE 'Y'       WFXCHG                                            MD028338
     C                     ENDIF                                                            MD028338
      *                                                                                     MD028338
     C           AMTP      IFNE 'MI'                                      115027
     C           AMTP      ANDNE'LS'                                                          212318
     C           WFXCHG    ANDNE'Y'                                                         MD028338
     C           AMTP      IFNE 'BH'                                      217477
     C           CLE003    ORNE 'Y'                                       217477
     C*                                                                                      248851A
     C           W#CONV    IFEQ 'Y'                                                          248851A
     C           AMTP      ANDEQ'IH'                                                         248851A
     C                     ELSE                                                              248851A
      *                                                                                     AR317587
      ** Use expected value date as LVDAT if VDAT is later than MDAT.                       AR317587
      *                                                                                     AR317587
     C           VDAT      IFGT WMDAT                                                       AR317587
     C           XAVD      ANDNE*ZEROS                                                      AR317587
     C           WMDAT     ANDNE*ZEROS                                                     AR1084876
     C           VDAT      ORGT WMDAT                                                       AR317587
     C           EXVD      ANDNE*ZEROS                                                      AR317587
     C           WMDAT     ANDNE*ZEROS                                                     AR1084876
      *                                                                                     AR317587
      ** Use MDAT instead of expected value date as LVDAT.                                  AR317587
      *                                                                                     AR317587
     C                     Z-ADDWMDAT     LVDAT                                             AR317587
     C                     ELSE                                                             AR317587
     C                     Z-ADDVDAT      LVDAT                           CLE003
     C                     ENDIF                                                            AR317587
     C*                                                                   157669
      *  If Analytical accounting is ON                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           VDAT      IFGT WMDAT                                                       AR317587
     C           XAVD      ANDNE*ZEROS                                                      AR317587
     C           WMDAT     ANDNE*ZEROS                                                     AR1084876
     C           VDAT      ORGT WMDAT                                                       AR317587
     C           EXVD      ANDNE*ZEROS                                                      AR317587
     C           WMDAT     ANDNE*ZEROS                                                     AR1084876
      *                                                                                     AR317587
      ** Use MDAT instead of expected value date as LVDAT.                                  AR317587
      *                                                                                     AR317587
     C                     Z-ADDWMDAT     CVDAT                                             AR317587
     C                     ELSE                                                             AR317587
     C                     Z-ADDVDAT      CVDAT                           157669
     C                     ENDIF                                                            AR317587
     C                     ENDIF                                          157669
     C*                                                                   157669
     C                     ENDIF                                                             248851A
     C                     ENDIF                                          217477
     C                     ENDIF                                          115027
     C/COPY WNCPYSRC,LE0400C043
      *                                                                   115027
     C                     ENDIF                                          115027
      *                                                                   CLE003
     C/COPY WNCPYSRC,LE0400C108
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C           LNRF      IFNE PLNRF                                                       AR317587
     C                     MOVE *BLANKS   INDIC                                             AR317587
     C**********           MOVE LNRF      PLNRF   60                                 AR317587 CLE148
     C                     MOVELLNRF      PLNRF   6                                           CLE148
     C                     ENDIF                                                            AR317587
      *                                                                                     MD028338
     C                     MOVE 'N'       WFXCHG  1                                         MD028338
     C                     MOVE ' '       WFXFLG  1                                         MD028338
0618 C*
0619 C           END       TAG                             ** END TAG **
     C/COPY WNCPYSRC,LE0400C016
0620 C*
0621 C** TOTAL TIME CALCS - END PROCESSING OF PREVIOUS LOAN SET
0622 C*
0623 CL1NU7                EXSR PREVLN
      **                                                                  S01117
      **  IF P1 HAVE BEEN OPENED BUT NO DETAIL PRINTED, EXCEPT NO         S01117
      **  DETAIL MESSAGE TO P1  (WHEN BRANCH LEVEL BREAK)                 S01117
      **                                                                  S01117
     CL2         P1OP      IFEQ 'Y'                                       S01117
     CL2         *INU7     ANDNE'1'                                       S01117
      *                                                                   S01117
      *                                                                   S01117
     CL2         P1DTLC    IFNE 'Y'                                       S01117
     CL2                   EXCPTP1NODL                                    S01117
     CL2                   END                                            S01117
      *                                                                   S01117
     CL2                   EXCPTP1END                                     S01117
      *                                                                   S01117
     CL2                   END                                            S01117
     C/COPY WNCPYSRC,LE0400C041
0624 C*
0625 C** LAST RECORD CALCS - CHECK RECORD COUNTS AND OUTPUT FILE CONT.REP.
0626 C*
0627 CLRNU7      NHISTS    COMP NOREH                8080
0628 CLRNU7      NACTN4    COMP NOREA                8181
0629 CLRNU7 80
0630 CORNU7 81             SETON                     U8
0631 C*
0632 C** OUTPUT TRAILER RECORDS TO FILES
0633 C*
0634 CLR 50      NHIUPD    ADD  1         NHIUPD
0635 CLR 50      NACTN5    ADD  1         NACTN5
0636 CLR 50NU3   NLETLX    ADD  1         NLETLX
0637 CLR 50NU3   NCONFS    ADD  1         NCONFS
0638 CLR 50      NINTST    ADD  1         NINTST
0639 CLR 50NU3   NCUTX1    ADD  1         NCUTX1
0640 CLR 50      NPTSLD    ADD  1         NPTSLD
      **                                                                  S01117
      **   EXECUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                 S01117
      **                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
      **                                                                  S01117
      ** ENSURE TOTAL SPOOL FILE RECORDED BY RCF                          S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
     CLR                   OUT  LDA                                       S01117
      *                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      **                                                                  S01117
      ** WHEN P1 HAS NOT BEEN OPENED                                      S01117
      **                                                                  S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
0641 C*
     C********************************************************************194459
     C********************************************************************194459
     C*                                                                   194459
     C** OUTTOF Subroutine - to update REPI Flag to replicate data to     194459
     C** TOF if customer is Private Banking.                              194459
     C*                                                                   194459
     C** Called by:  MANREP,INTPAY,REPAY                                  194459
     C*                                                                   194459
     C           OUTTOF    BEGSR                           ** OUTTOF **   194459
     C*                                                                   194459
     C           *IN68     IFEQ *OFF                                      194459
      *                                                                   194459
     C                     MOVELCNUM      KCUST     P                     194459
     C                     CALL 'AOCUSTR1'                                194459
     C                     PARM '*MSG   ' KRTCD   7                       194459
     C                     PARM '*KEY   ' KOPTN   7                       194459
     C                     PARM           KCUST  10                       194459
     C                     PARM           KKYST   7                       194459
     C           SDCUST    PARM SDCUST    DSLDY                           194459
      *                                                                   194459
      ** Check if Private Customer                                        194459
     C           KRTCD     IFEQ *BLANKS                                   194459
     C           BBPRBA    ANDEQ'Y'                                       194459
     C                     MOVE 'Y'       WREPI                           194459
     C                     ENDIF                                          194459
     C                     ENDIF                                          194459
      *                                                                   194459
     C                     ENDSR                           ** ENDSR **    194459
     C*                                                                   194459
     C********************************************************************194459
0642 C********************************************************************
0643 C*
0644 C** EXCPT SUBROUTINE - OUTPUT RECORDS TO FILES AND PRINTER
0645 C*
0646 C** CALLED BY:  MAIN PROCESSING,HIST,OUTBVH,OUTINH,PREVLN,STREC,
0647 C**             BVHED,INTHED,MIADJ,PRINC,MANREP,INTPAY,REPAY,SPRCHG,
0648 C**             BRTCHG,BRCCHG,ROLL,STACC,REVSL,DEALDT,STRTDT,PASTDU,
0649 C**             MATUR,INIT,MCLSSR                                    S01270
0650 C*
0651 C           EXCPT     BEGSR                           ** EXCPT **
      *                                                                   116678
      *                                                                                     AR316218
     C           CAS005    IFNE 'Y'                                                         AR316218
     C                     Z-ADD*ZEROS    AITN                                              AR316218
     C                     Z-ADD*ZEROS    IPRN                                              AR316218
     C                     Z-ADD*ZEROS    INTN                                              AR316218
     C                     Z-ADD*ZEROS    AIAN                                              AR316218
     C                     Z-ADD*ZEROS    FSPRAM                                            AR316218
     C                     Z-ADD*ZEROS    FSCPAM                                            AR316218
     C                     END                                                              AR316218
      *                                                                                     AR316218
     C           *IN67     IFEQ *ON                                       116678
     C***********CEU020    IFEQ 'Y'                                144688 165977
     C***********ECIN      ANDEQ'Y'                                144688 165977
     C***********AMTP      ANDEQ'MC'                               144688 165977
     C           AMTP      IFEQ 'MC'                                      165977
     C                     Z-ADDPRAM      CPAM                            144688
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ELSE                                           144688
     C                     Z-ADD0         CPAM                            116678
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD*ZEROS    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                          144688
     C                     Z-ADD0         AITC                            116678
     C                     Z-ADD0         IPRD                            116678
     C                     Z-ADD0         AIAP                            116678
     C                     Z-ADD0         INTR                            116678
     C                     Z-ADD0         ACDA                            157669
     C                     Z-ADD0         COFD                            157669
     C                     Z-ADD0         ACAP                            157669
     C                     Z-ADD0         COFR                            157669
     C                     Z-ADD*ZEROS    AITN                                                CAS005
     C                     Z-ADD*ZEROS    IPRN                                                CAS005
     C                     Z-ADD*ZEROS    AIAN                                                CAS005
     C                     ENDIF                                          116678
      *****If*History*Amount*Reords                                CPB002 194459
      *******And*Maturity*Events                                   CPB002 194459
      *******And*Private*Banking*Module*Switched*on                CPB002 194459
      **********                                                   CPB002 194459
     C********** *IN05     IFEQ *ON                                CPB002 194459
     C********** *IN68     ANDEQ*ON                                CPB002 194459
     C********** BGN4ST    ANDEQ'Y'                                CPB002 194459
      **********                                                   CPB002 194459
     C********** AMTP      IFEQ 'RE'                               CPB002 194459
     C********** AMTP      OREQ 'IN'                               CPB002 194459
      **********                                                   CPB002 194459
     C**********           MOVELCNUM      KCUST     P              CPB002 194459
     C**********           CALL 'AOCUSTR1'                         CPB002 194459
     C**********           PARM '*MSG   ' KRTCD   7                CPB002 194459
     C**********           PARM '*KEY   ' KOPTN   7                CPB002 194459
     C**********           PARM           KCUST  10                CPB002 194459
     C**********           PARM           KKYST   7                CPB002 194459
     C********** SDCUST    PARM SDCUST    DSLDY                    CPB002 194459
      **********                                                   CPB002 194459
      ***Check*if*Private*Customer                                 CPB002 194459
     C********** KRTCD     IFEQ *BLANKS                            CPB002 194459
     C********** BBPRBA    ANDEQ'Y'                                CPB002 194459
     C**********           MOVE 'Y'       REPI                     CPB002 194459
     C**********           ENDIF                                   CPB002 194459
     C**********           ENDIF                                   CPB002 194459
     C**********           ELSE                                    CPB002 194459
     C**********           MOVE *BLANKS   REPI                     CPB002 194459
     C**********           ENDIF                                   CPB002 194459
      *                                                                                       CLE028
      ** In LE0400P1, instead of printing FEES when *IN35 is on,                              CLE028
      ** print 'CHRG' and value of CHDU when indicator CLE028 (*IN17) is on.                  CLE028
      *                                                                                       CLE028
     C                     MOVE *IN17     WIN17   1                                           CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C                     MOVE '1'       *IN17                                               CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE '0'       *IN17                                               CLE028
     C                     ENDIF                                                              CLE028
0652 C*
     C/COPY WNCPYSRC,LE0400CP17                                           S01408
      *                                                                                       CAS009
      ** Generate historic cash flows when writing a record                                   CAS009
      ** in HISTSHP.                                                                          CAS009
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           WGHCF     ANDEQ'Y'                                                           CAS009
     C           CAS009    OREQ 'Y'                                                           232628
     C           WROLL     ANDEQ'Y'                                                           232628
     C           *IN51     IFEQ '1'                                                           CAS009
     C           *IN56     OREQ '1'                                                           CAS009
     C           *IN57     OREQ '1'                                                           232628
     C                     EXSR SRLECF                                                        CAS009
     C                     ENDIF                                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
0653 C                     EXCPT
0654 C*
     C                     MOVE WIN17     *IN17                                               CLE028
0655 C                     SETOF                     333435
0656 C                     SETOF                     36
0657 C                     SETOF                     404142
0658 C                     SETOF                     434445
0659 C                     SETOF                     464748
0660 C                     SETOF                     495152
0661 C                     SETOF                     535455
0662 C                     SETOF                     565758
0663 C                     SETOF                     597879
0664 C                     SETOF                     868788
     C                     MOVE *BLANK    BVMV                                                210989
0665 C*
0666 C                     ENDSR                           ** ENDSR **
0667 C*
0668 C********************************************************************
0669 C********************************************************************
0670 C*
0671 C** HIST SUBROUTINE - PROCESS RECS READ FROM S/HISTS
0672 C*
0673 C** CALLED BY:  MAIN PROCESSING
0674 C** CALLS:      EXCPT,STREC,BVHED,INTHED,PRINC,MANREP,INTPAY,REPAY,
0675 C**             MIADJ,STACC,SPRCHG,BRTCHG,BRCCHG,ROLL
0676 C*
0677 C           HIST      BEGSR                           ** HIST **
0678 C*
0679 C** MATURED LOAN OR NO ACTIONS FOR LOAN TODAY - WRITE REC. STRAIGHT
0680 C** TO S/HIUPD
0681 C*
     C** THIS PROCESSING WAS ADDED TO THE S/34 VERSION SINCE MATURED
     C** HISTORY RECORDS MUST BE OUTPUT TO THE RELEVENT PHYSICAL FILE.
     C** AS ALL INDICATORS HAVE BEEN ALLOCATED,SOME,USED PREVIOUSLY
     C** FOR OUTPUT EDITING OF DECIMAL PLACES,WHICH ARE NOT REQUIRED BY
     C** MATURED HISTORY PROCESSING,ARE USED HERE.THESE INDICATORS ARE
     C** SET OFF AFTER THE EXCEPTION SUBROUTINE SO THAT THEY WILL NOT
     C** EFFECT ANY PROCEEDING RECORDS.
     C*
     C/COPY WNCPYSRC,LE0400CP18                                           S01408
      *                                                                   CLE003
      *  Store the value date from the history interest file              CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           AMTP      ANDEQ'IH'                                      CLE004
     C                     MOVE VDAT      W#VDAT                          CLE004
     C                     MOVE VDAT      PHVDAT                                              235743
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                                       212318
      ** Use the previous value of AITC for LS change                                         212318
      *                                                                                       212318
     C           AMTP      IFEQ 'LS'                                                          212318
     C                     Z-ADDL#AITC    AITC                                                212318
     C                     ENDIF                                                              212318
      *                                                                   CLE003
      *  If No actions today, the program will run as a conversion        CLE003
      *  to populate the five new fileds.                                 CLE003
      *                                                                   CLE003
      ** If mature then don't maintain the five new fields.               CLE003
     C           *IN07     IFEQ *ON                                       CLE003
      *                                                                   CLE003
MaturC           RCDT      COMP 'A'                      74               CLE003
Intr C           RCDT      COMP 'H'                      75               CLE003
Amnt C           RCDT      COMP 'D'                      76               CLE003
Rate C           RCDT      COMP 'E'                      77               CLE003
     C                     SETON                     42                   CLE003
     C                     EXSR EXCPT                                     CLE003
     C                     SETOF                     7475                 CLE003
     C                     SETOF                     7677                 CLE003
     C           NHIUPD    ADD  1         NHIUPD                          CLE003
     C                     GOTO HISTEN                                    CLE003
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
0693 C   69                GOTO HISTEN                                    120391
      *                                                                   CLE003
      ** If Start record and CPAM & INTR = 0 then Calculate interest      CLE003
      ** from the start of the loan i.e set W#CONV to 'Y'.                CLE003
     C           *IN02     IFEQ *ON                                       CLE003
     C                     EXSR CHAITC                                                        248851
     C           CPAM      IFEQ 0                                         CLE003
     C           INTR      ANDEQ0                                         CLE003
     C                     MOVE 'Y'       W#CONV  1                       CLE003
     C/COPY WNCPYSRC,LE0400C044
     C                     ENDIF                                          CLE003
     C                     ELSE                                           181859
     C           *IN04     IFEQ '1'                                       181859
     C           CTRQ      ANDEQ'Y'                                       181859
     C                     MOVE 'Y'       W#CONV                          181859
     C                     Z-ADDVDAT      PHVDAT                          181859
     C                     ENDIF                                          181859
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C           W#CONV    IFEQ 'N'                                       CLE003
     C           *IN04     IFEQ *ON                                       115625
     C           *IN63     ANDEQ*OFF                                      115625
     C           *IN04     OREQ *OFF                                      115625
      *                                                                   115625
     C           *IN04     IFEQ *ON                                       115625
     C                     MOVE *ON       *IN22                           115625
     C/COPY WNCPYSRC,LE0400C045
     C                     ENDIF                                          115625
      *                                                                   115625
     C           *IN04     IFEQ '0'                                                           236196
     C           *IN71     ANDEQ'1'                                                           236196
     C           *IN63     ANDEQ'1'                                                           236196
     C                     MOVE '1'       INTST   1                                           236196
     C                     SELEC                                                              236196
     C           AMTP      WHEQ 'PI'                                                          236196
     C                     EXSR PRINC                                                         236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'MR'                                                          236196
     C                     EXSR MANREP                                                        236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'IN'                                                          236196
     C                     EXSR INTPAY                                                        236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'RE'                                                          236196
     C                     EXSR REPAY                                                         236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'MI'                                                          236196
     C                     EXSR MIADJ                                                         236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'PT'                                                          236196
     C                     EXSR PRINTO                                                        236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'SA'                                                          236196
     C                     EXSR STACC                                                         236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'SC'                                                          236196
     C                     EXSR SPRCHG                                                        236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'BR'                                                          236196
     C                     EXSR BRTCHG                                                        236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'BC'                                                          236196
     C                     EXSR BRCCHG                                                        236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C           AMTP      WHEQ 'RO'                                                          236196
     C                     EXSR ROLL                                                          236196
     C                     MOVE '0'       INTST                                               236196
     C                     GOTO HISTEN                                                        236196
     C                     ENDSL                                                              236196
     C                     MOVE '0'       INTST                                               236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
     C                     SETON                     42                   CLE003
     C                     EXSR EXCPT                                     CLE003
     C           NHIUPD    ADD  1         NHIUPD                          CLE003
      *                                                                                       259707
      ** Initialise Loan type and sub-type with the correct values                            259707
      ** when amendment type is LS and processing will skip recalculation                     259707
      ** from start(i.e. no recomputation needed on this COB run)                             259707
      *                                                                                       259707
     C           AMTP      IFEQ 'LS'                                                          259707
     C                     MOVE LTYP      LONTYP                                              259707
     C                     MOVE SUTP      SUBTYP                                              259707
     C                     ENDIF                                                              259707
      *                                                                                       259707
     C                     GOTO HISTEN                                    CLE003
     C                     ENDIF                                          115625
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C                     ELSE                                           CLE003
      *                                                                   CLE003
     C  N07                GOTO NOTMAT
     C/COPY WNCPYSRC,LE0400C008
     C           RCDT      COMP 'A'                      74
     C           RCDT      COMP 'H'                      75
     C           RCDT      COMP 'D'                      76
     C           RCDT      COMP 'E'                      77
     C*
     C           NOTMAT    TAG                             ** NOTMAT TAG**
     C**
0682 C   07
0683 CORN64                SETON                     42
0684 C   07
0685 CORN64                EXSR EXCPT
     C                     SETOF                     7475
     C                     SETOF                     7677
     C/COPY WNCPYSRC,LE0400C019
0686 C   07
0687 CORN64      NHIUPD    ADD  1         NHIUPD
0688 C   07
0689 CORN64                GOTO HISTEN
0690 C*
0691 C** IF LOAN BEING REVERSED TODAY - DROP REC.
0692 C*
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
0693 C   69                GOTO HISTEN
0694 C*
0695 C** LIVE LOAN PROCESSING - PROCESS ACCORDING TO AMEND TYPE
0696 C*
0697 C   02                EXSR STREC                      START REC
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           *IN02     IFEQ *ON                                       CLE003
     C                     MOVE *ON       *IN28                           CLE003
     C                     ENDIF                                          CLE003
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C           CLE003    IFNE 'Y'                                       CLE003
0698 C   03                EXSR BVHED                      B/V HEADER
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
0699 C   04                EXSR INTHED                     INT HEADER
0700 C*
0701 C  N05                GOTO RATE
0702 C*
0703 C** AMOUNT RECS.
0704 C*
0705 C           AMTP      COMP 'PI'                     32
0706 C   32                EXSR PRINC                      PRINC.INCR.
0707 C   32                GOTO HISTEN
0708 C           AMTP      COMP 'MR'                     32
0709 C   32                EXSR MANREP                     MANUAL REPAY'T
0710 C   32                GOTO HISTEN
0711 C           AMTP      COMP 'IN'                     32
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           AMTP      ANDEQ'IN'                                                          CLE028
     C                     EXSR SRINAI                                                        CLE028
     C                     MOVE *ON       *IN32                                               CLE028
     C                     ELSE                                                               CLE028
0712 C   32                EXSR INTPAY                     INTEREST PAY'T
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0713 C   32                GOTO HISTEN
0714 C           AMTP      COMP 'RE'                     32
0715 C   32                EXSR REPAY                      REPAYMENT
0716 C   32                GOTO HISTEN
0717 C           AMTP      COMP 'MI'                     32
0718 C   32                EXSR MIADJ                      MAN.INT.ADJ.P'D
0719 C   32                GOTO HISTEN
     C           AMTP      COMP 'LS'                     32               000127
     C   32                EXSR MCLSSR                     LOAN SUBTYPEP  000127
     C   32                GOTO HISTEN                                    000127
0720 C*
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C                     MOVE *ON       *IN32                           CLE004
     C                     EXSR PRINTO                     TRANS PRINC TO CLE004
     C                     GOTO HISTEN                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PF'                                      CLE004
     C                     MOVE *ON       *IN32                           CLE004
     C                     EXSR PRINFR                     TRANS PRNC FROMCLE004
     C                     GOTO HISTEN                                    CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CLE028
     C           AMTP      IFEQ 'CH'                                                          CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     MOVE '1'       *IN32                                               CLE028
     C                     EXSR SRCHRG                                                        CLE028
     C                     GOTO HISTEN                                                        CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   CLE004
0721 C                     GOTO DBERR
0722 C*
0723 C           RATE      TAG                             ** RATE TAG **
0724 C*
0725 C  N06                GOTO HISTEN
0726 C*
0727 C** RATE RECS.
0728 C*
0729 C           AMTP      COMP 'SA'                     32
0730 C   32                EXSR STACC                      STOP/START ACCR
0731 C   32                GOTO HISTEN
0732 C           AMTP      COMP 'SC'                     32
0733 C   32                EXSR SPRCHG                     SPREAD CHANGE
0734 C   32                GOTO HISTEN
0735 C           AMTP      COMP 'BR'                     32
0736 C   32                EXSR BRTCHG                     BASE RATE CHNGE
0737 C   32                GOTO HISTEN
0738 C           AMTP      COMP 'BC'                     32
0739 C   32                EXSR BRCCHG                     BASE RT.CODE CH
0740 C   32                GOTO HISTEN
0741 C           AMTP      COMP 'RO'                     32
0742 C   32                EXSR ROLL                       ROLLOVER
0743 C   32                GOTO HISTEN
0744 C*
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           CEU020    OREQ 'Y'                                       CEU020
     C           AMTP      IFEQ 'MC'                                      CLE004
     C                     MOVE *ON       *IN32                           CLE004
     C                     EXSR MROLL                      MULTI CCY ROLL CLE004
     C                     GOTO HISTEN                                    CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0400C017
      *                                                                   CLE004
0745 C** INVALID AMEND TYPE
0746 C*
0747 C           DBERR     TAG                             ** DBERR TAG **
0748 C                     SETON                     U7U8LR
0749 C                     MOVE LNRF      DBKEY3
0750 C                     MOVELDBKEY2    DBKEY
0751 C                     MOVE DBKEY3    DBKEY
0752 C                     Z-ADD6         DBASE
0753 C                     MOVE 'HISTS'   DBFILE
0754 C*
0755 C           HISTEN    ENDSR                           ** HISTEN **
0756 C*
     C********************************************************************                    248851
     C********************************************************************                    248851
     C*                                                                                       248851
     C** CHAITC SUBROUTINE - COMPARE ACCRUED INTEREST TO INTEREST RECEIVED                    248851
     C*                                                                                       248851
     C** CALLED BY:  HIST                                                                     248851
     C** CALLS:                                                                               248851
     C*                                                                                       248851
     C           CHAITC    BEGSR                                                              248851
     C*                                                                                       248851
     C           KHISR1    KLIST                                                              248851
     C                     KFLD           BRCA                                                248851
     C                     KFLD           CNUM                                                248851
     C                     KFLD           LNRF                                                248851
     C                     KFLD           HIVDAT  50                                          248851
     C*                                                                                       248851
     C           KHISR2    KLIST                                                              248851
     C                     KFLD           BRCA                                                248851
     C                     KFLD           CNUM                                                248851
     C                     KFLD           LNRF                                                248851
     C*                                                                                       248851
     C                     MOVE *IN97     IN97    1                                           248851
     C                     MOVE *HIVAL    HIVDAT                                              248851
     C           KHISR1    SETGTHISTR                                                         248851
     C           KHISR2    REDPEHISTR                    97                                   248851
     C*                                                                                       248851
     C           *IN97     IFEQ *OFF                                                          253571
     C           XAITC     ADD  XAIAP     TACINT 150                                          253571
     C                     ENDIF                                                              253571
      *                                                                                       253571
     C           *IN97     IFEQ '0'                                                           248851
     C********** XAITC     ANDLTXIPRD                                                  248851 253571
     C           TACINT    ANDLTXIPRD                                                         253571
     C           XIPRD     ANDGT0                                                             254593
     C           XCPAM     ORNE WCPAM                                                         248851
     C           *IN97     ANDEQ'0'                                                           248851
     C                     Z-ADD0         CPAM                                                248851
     C                     Z-ADD0         INTR                                                248851
     C                     ENDIF                                                              248851
     C                     MOVE IN97      *IN97                                               248851
     C*                                                                                       248851
     C                     ENDSR                                                              248851
     C*                                                                                       248851
0757 C********************************************************************
0758 C********************************************************************
0759 C*
0760 C** ACTN SUBROUTINE - PROCESS RECS READ FROM S/ACTN4
0761 C*
0762 C** CALLED BY:  MAIN PROCESSING
0763 C** CALLS:      CONTRL,REVSL,DEALDT,STRTDT,MIADJ,PRINC,MANREP,INTPAY,
0764 C**             REPAY,PASTDU,MATUR,SPRCHG,BRTCHG,BRCCHG,ROLL,STACC
0765 C*
0766 C           ACTN      BEGSR                           ** ACTN **
0767 C*
      *                                                                                      BUG5673
      ** Initialize VDATS for every read action record to ensure                             BUG5673
      ** correct accrual processing.                                                         BUG5673
      *                                                                                      BUG5673
     C           *IN11     IFEQ '1'                                                          BUG5673
     C                     Z-ADD0         VDATS                                              BUG5673
     C                     ENDIF                                                             BUG5673
      *                                                                                      BUG5673
      ** If CAS009 is enabled, check if we need to generate historic                          CAS009
      ** cash flows.                                                                          CAS009
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           PTYP      IFNE 70                                                            CAS009
     C           PTYP      ANDNE71                                                            CAS009
     C           PTYP      ANDNE72                                                            CAS009
     C           AMTP      IFEQ 'ST'                                                          CAS009
     C           AMTP      OREQ 'PI'                                                          CAS009
     C           AMTP      OREQ 'MR'                                                          CAS009
     C           AMTP      OREQ 'IN'                                                          CAS009
     C           AMTP      OREQ 'RE'                                                          CAS009
     C           AMTP      OREQ 'PF'                                                          CAS009
     C           AMTP      OREQ 'PT'                                                          CAS009
     C           AMTP      OREQ 'MA'                                                          CAS009
     C                     MOVE 'Y'       WGHCF                                               CAS009
     C                     ENDIF                                                              CAS009
     C           AMTP      IFEQ 'RO'                                                          232628
     C                     MOVE 'Y'       WROLL                                               232628
     C                     ENDIF                                                              232628
     C                     ENDIF                                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C/COPY WNCPYSRC,LE0400CP16                                           S01408
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           *IN12     IFEQ *ON                                       CLE003
      *                                                                   CLE003
     C                     MOVE 'Y'       W#CONV                          CLE003
      *****************************************************************              BUG5673 BUG7921
      ***Move*STAI*to*work*variable*when*processing*loan*actions*******              BUG5673 BUG7921
      ***to*trigger*recalculation*for*backvalued*start*accruals.*******              BUG5673 BUG7921
      *****************************************************************              BUG5673 BUG7921
     C**********           MOVE STAI      STAIND                                     BUG5673 BUG7921
      *                                                                   CLE003
      ** First Action record                                              CLE003
     C           W#ACTN    IFEQ 'Y'                                       CLE003
     C                     MOVE 'N'       W#ACTN  1                       CLE003
      *                                                                   CLE003
     C           AMTP      IFEQ 'MI'                                      CLE003
     C           AMTP      OREQ 'PI'                                      CLE003
     C           AMTP      OREQ 'MR'                                      CLE003
     C           AMTP      OREQ 'IN'                                      115625
     C           AMTP      OREQ 'RE'                                      CLE003
     C           AMTP      OREQ 'SC'                                      CLE003
     C           AMTP      OREQ 'BR'                                      117042
     C           AMTP      OREQ 'BC'                                      CLE003
     C           AMTP      OREQ 'RO'                                      CLE003
     C           AMTP      OREQ 'SA'                                      CLE003
     C           AMTP      OREQ 'PD'                                      CLE003
     C           AMTP      OREQ 'MA'                                      CLE003
     C           AMTP      OREQ 'LS'                                      117042
     C           AMTP      OREQ 'PT'                                      CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C           AMTP      OREQ 'MC'                                      CLE004
      *                                                                   CLE003
     C           STAIND    IFNE 'Y'                                       CLE003
     C                     MOVE *ON       *IN23                           CLE003
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#COFR    COFR                            157669
     C/COPY WNCPYSRC,LE0400C109
     C***********AITC      ADD  AIAP      ACCINT                    CLE003116332
     C***********AITC      ADD  AIAP      AIIACD                    CLE003116332
     C                     ENDIF                                          CLE003
     C                     MOVE *IN23     WIN23   1                                           251009
     C                     TESTB'3'       LONI       23                                       251009
     C           *IN23     IFEQ '0'                                                           251009
     C           VDAT      ANDGTWIACD                                                         251009
     C                     MOVE '0'       *IN23                                               251009
     C                     ELSE                                                               251009
     C                     MOVE WIN23     *IN23                                               251009
     C                     ENDIF                                                              251009
      *                                                                   CLE003
     C                     ENDIF                                          CLE003
     C                     ENDIF                                          CLE003
     C                     ENDIF                                          CLE003
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
0768 C** PROCESS ACCORDING TO AMEND TYPE
      *
0770 C   11                EXSR CONTRL                     CONTROL RECORD
     C/COPY WNCPYSRC,LE0400C009
0771 C   11                GOTO ACTNEN
0772 C*
0773 C           AMTP      COMP 'RV'                     32
0774 C   32                EXSR REVSL                      REVERSAL RECORD
0775 C   32                GOTO ACTNEN
0776 C           AMTP      COMP 'DD'                     32
0777 C   32                EXSR DEALDT                     DEAL DATE REC.
0778 C   32                GOTO ACTNEN
0779 C           AMTP      COMP 'ST'                     32
0780 C   32                EXSR STRTDT                     START DATE REC.
0781 C   32                GOTO ACTNEN
      *                                                                                       CLE028
     C           AMTP      IFEQ 'CH'                                                          CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     MOVE '1'       *IN32                                               CLE028
     C                     EXSR SRCHRG                                                        CLE028
     C                     GOTO ACTNEN                                                        CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0782 C           AMTP      COMP 'MI'                     32
0783 C   32                EXSR MIADJ                      MAN.INT.ADJ.NPD
0784 C   32                GOTO ACTNEN
0785 C           AMTP      COMP 'PI'                     32
0786 C   32                EXSR PRINC                      PRINC.INCR.
0787 C   32                GOTO ACTNEN
0788 C           AMTP      COMP 'MR'                     32
0789 C   32                EXSR MANREP                     MANUAL REPAY'T
0790 C   32                GOTO ACTNEN
0791 C           AMTP      COMP 'IN'                     32
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           AMTP      ANDEQ'IN'                                                          CLE028
     C                     EXSR SRINAI                                                        CLE028
     C                     MOVE *ON       *IN32                                               CLE028
     C                     ELSE                                                               CLE028
0792 C   32                EXSR INTPAY                     INTEREST PAY'T
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0793 C   32                GOTO ACTNEN
0794 C           AMTP      COMP 'RE'                     32
0795 C   32                EXSR REPAY                      REPAYMENT
0796 C   32                GOTO ACTNEN
0797 C           AMTP      COMP 'PD'                     32
0798 C   32                EXSR PASTDU                     PAST DUE REP'T
0799 C   32                GOTO ACTNEN
0800 C           AMTP      COMP 'MA'                     32
0801 C   32                EXSR MATUR                      MATURITY
0802 C   32                GOTO ACTNEN
0803 C           AMTP      COMP 'SC'                     32
0804 C   32                EXSR SPRCHG                     SPREAD CHANGE
0805 C   32                GOTO ACTNEN
0806 C           AMTP      COMP 'BR'                     32
0807 C   32                EXSR BRTCHG                     BASE RATE CHNGE
0808 C   32                GOTO ACTNEN
0809 C           AMTP      COMP 'BC'                     32
0810 C   32                EXSR BRCCHG                     BASE RT.CODE CH
0811 C   32                GOTO ACTNEN
0812 C           AMTP      COMP 'RO'                     32
0813 C   32                EXSR ROLL                       ROLLOVER
0814 C   32                GOTO ACTNEN
0815 C           AMTP      COMP 'SA'                     32
0816 C   32                EXSR STACC                      STOP/START ACC.
0817 C   32                GOTO ACTNEN
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C                     MOVE *ON       *IN32                           CLE004
     C                     EXSR PRINTO                     TRANS PRINC TO CLE004
     C                     GOTO ACTNEN                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PF'                                      CLE004
     C                     MOVE *ON       *IN32                           CLE004
     C                     EXSR PRINFR                     TRANS PRNC FROMCLE004
     C                     GOTO ACTNEN                                    CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CEU020
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CEU020
     C           CEU020    OREQ 'Y'                                       CEU020
     C           AMTP      IFEQ 'MC'                                      CLE004
     C                     MOVE *ON       *IN32                           CLE004
     C                     EXSR MROLL                      MULTI CCY ROLL CLE004
     C                     GOTO ACTNEN                                    CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C*
     C**   FOLLOWING PROCESSING ONLY CARRIED OUT IF RECORD                S01270
     C**   READ IS FROM DETAIL RECORD OF ACTN4 (IN12 = '1')               S01270
     C*                                                                   S01270
     C           *IN12     IFEQ '1'                                       S01270
     C*                                                                   S01270
     C**   AMEND TYPE = 'LS' PROCESSING                                   S01270
     C*                                                                   S01270
0815 C           AMTP      IFEQ 'LS'                                      S01270
0816 C                     EXSR MCLSSR                                    S01270
     C                     MOVE '1'       *IN32                           S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C                     END                                            S01270
     C/COPY WNCPYSRC,LE0400C025
     C*                                                                   S01270
     C**   MISS OUT DBERROR ROUTINE WITHOUT USING 'GOTO' IN               S01270
     C**   PREVIOUS 'LS' RECORD PROCESSING                                S01270
     C*                                                                   S01270
0815 C           *IN32     IFEQ '0'                                       S01270
0818 C*
0819 C** INVALID AMEND TYPE
0820 C*
0821 C                     SETON                     U7U8LR
0822 C                     MOVE LNRF      DBKEY3
0823 C                     MOVELDBKEY2    DBKEY
0824 C                     MOVE DBKEY3    DBKEY
0825 C                     Z-ADD7         DBASE
0826 C                     MOVE 'ACTN4'   DBFILE
0827 C*
     C                     END                                            S01270
     C*                                                                   S01270
0828 C           ACTNEN    ENDSR                           ** ACTNEN **
0829 C*
0830 C********************************************************************
0831 C********************************************************************
0832 C*
0833 C** OUTBVH SUBROUTINE - TO CHECK IF B/V HEADER IS TO BE OUTPUT YET
0834 C*
0835 C** CALLED BY:  MIADJ,PRINC,MANREP,INTPAY,REPAY,SPRCHG,BRTCHG,BRCCHG,
0836 C**             ROLL,STACC,PASTDU,MATUR
0837 C** CALLS:      EXCPT
0838 C*
0839 C           OUTBVH    BEGSR                           ** OUTBVH **
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                   CLE003
      ** SETON *IN20 (Backvalue header written). also mean Backvalue      CLE003
      ** header not needed                                                CLE003
     C                     MOVE *ON       *IN20                           CLE003
     C                     GOTO OBVHEN                                    CLE003
     C                     ENDIF                                          CLE003
0840 C*
0841 C** CHECK IF B/V HEADER ALREADY OUTPUT
0842 C*
0843 C***20******          GOTO OBVHEN                                    E35700
     C  N28                                                               E35700
0843 COR 20                GOTO OBVHEN                                    E35700
0844 C*
0845 C** OUTPUT IF VALUE DATE OF RECORD PROCESSED IS GREATER THAN BVLP
0850 C** *IN46 - OUTPUT BV HEADER WHEN HISTORY RECORD MOVED               095243
0850 C** *IN47 - OUTPUT BV HEADER WHEN HISTORY RECORD CREATED             095243
0846 C*
0847 C           VDAT      COMP BVDAT                30
0848 C  N30                GOTO OBVHEN
0849 C*
0850 C***********          SETON                     46                   095243
0850 C  N25                SETON                     46                   095243
0850 C   25                SETON                     47                   095243
0851 C                     Z-ADDACCINT    ACCIN
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           ACDA      ADD  ACAP      ACCCO                           157669
     C                     ELSE                                           157669
     C                     Z-ADDACCCOF    ACCCO                           CAC001
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
0852 C                     EXSR EXCPT
0853 C           NHIUPD    ADD  1         NHIUPD     20
0854 C*
0855 C** IF NO BACK VALUATIONS BEYOND SLID,DISCONTINUE INTEREST CALCS
0856 C*
0857 C  N62                SETOF                     23
0858 C*
0859 C           OBVHEN    ENDSR                           ** OBVHEN **
0860 C*
0861 C********************************************************************
0862 C********************************************************************
0863 C*
0864 C** OUTINH SUBROUTINE - TO CHECK IF INT.HEADER IS TO BE OUTPUT YET
0865 C*
0866 C** CALLED BY:  MIADJ,PRINC,MANREP,INTPAY,REPAY,SPRCHG,BRTCHG,BRCCHG,
0867 C**             ROLL,STACC,PASTDU,MATUR
0868 C** CALLS:      STDETS,EXCPT
0869 C*
0870 C           OUTINH    BEGSR                           ** OUTINH **
0871 C*
0872 C** CHECK IF B/V HEADER AND INT. HEADER OUTPUT YET
0873 C*
0874 C  N21                                                INT HD.NOT READ
0875 CORN20                                                B/V HD.NOT O/P
0876 COR 22                GOTO OINHEN                     INT HD.ALRDY OP
0877 C*
0878 C** OUTPUT IF VALUE DATE OF RECORD PROCESSED IS GREATER THAN VALUE
0879 C** DATE OF LAST INT. PAYMENT ACTIONED TODAY
0880 C*
0881 C           VDAT      COMP LIVD                 30
0882 C  N30                GOTO OINHEN
0883 C*
0884 C** DETERMINE STATEMENT DETAILS IF REQUIRED
0885 C*
0886 C   25                Z-ADD0         STPG             NEW LOAN
0887 C   25                Z-ADD0         PPIS
0888 C   25                Z-ADD0         IPIS
0889 C   25                Z-ADD0         IPTDPS
0890 C  N25                Z-ADDIPPS      IPTDPS
0891 C*
0892 C   71 63             EXSR STDETS
0893 C*
0894 C** OUTPUT INTEREST HEADER
0895 C*
0896 C  N25                SETON                     43
0897 C   25                SETON                     48
      *                    ENDIF                                          CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      ACCIN                           CLE003
     C                     ELSE                                           CLE003
0898 C                     Z-ADDACCINT    ACCIN
     C                     ENDIF                                          CLE003
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           ACDA      ADD  ACAP      ACCCO                           157669
     C                     ELSE                                           157669
     C                     Z-ADDACCCOF    ACCCO                           CAC001
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
0899 C                     EXSR EXCPT
0900 C           NHIUPD    ADD  1         NHIUPD     22
0901 C*
0902 C** IF CUSTOMER BILLS/TELEXES TO BE PRODUCED,O/P INT.HEADER TO CUTX1
0903 C*
0904 C   U3                GOTO OINHEN
      *                                                                   CLE004
      * Do not output to CUTX1HN if it has already been done.             CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
0905 C*
0906 C   60                SETON                     52
0907 C*
0908 C** CALCULATE TOTAL INTEREST PAID
0909 C*
0910 C   60N25   IPAIDP    ADD  INPAID    TOTINP 130
0911 C   60 25             Z-ADDINPAID    TOTINP
0912 C   60                EXSR EXCPT
0913 C   60      NCUTX1    ADD  1         NCUTX1
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN60     ANDEQ'1'                                                           235743
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
0914 C*
0915 C           OINHEN    ENDSR                           ** OINHEN **
0916 C*
0917 C********************************************************************
0918 C********************************************************************
0919 C*
0920 C** INTCAL SUBROUTINE - PERFORM BASIC INTEREST CALCULATIONS
0921 C*
0922 C** CALLED BY:  MIADJ,PRINC,MANREP,INTPAY,REPAY,SPRCHG,BRTCHG,BRCCHG,
0923 C**             ROLL,STACC,PASTDU,MATUR
0924 C** CALLS:      GLINTC
0925 C*
0926 C           INTCAL    BEGSR                           ** INTCAL **
0927 C*
0928 C** IF PRINCIPAL IS LESS THAN OR EQUAL TO 0, OR IF MI ACTION REC AND
0929 C** VDAT > IACD, ZEROISE INTEREST CALCULATED
0930 C*
0931 C           OSPRIN    COMP 0                      3030
     C                     MOVE *IN31     IN31    1                                           245082
     C                     MOVE '0'       *IN31                                               245082
     C           *IN30     IFEQ '1'                                                           245082
     C           AMTP      ANDEQ'MA'                                                          245082
     C           TPRAM     ANDNE0                                                             245082
     C           ADDI      ANDEQ'B'                                                         AR810495
     C                     MOVE '0'       *IN30                                               245082
     C                     Z-ADDOSPRIN    TPRIN  130                                          245082
     C                     Z-ADDTPRAM     OSPRIN                                              245082
     C                     MOVE '1'       *IN31                                               245082
     C                     END                                                                245082
0932 C   30
0933 COR 73                Z-ADD0         INT    152
0934 C   30
0935 COR 73                Z-ADD0         ZDAYN1
0936 C   30
0937 COR 73                GOTO ADDINT
0938 C*
0939 C** CALCULATE INTEREST
0940 C*
0941 C                     Z-ADDLVDAT     ZIBEG
0942 C                     Z-ADDVDAT      ZIEND
     C/COPY WNCPYSRC,LE0400C107
     C*                                                                   S01392
     C** IF ACCRUE ON FIRST & LAST DAY, ADD 1 DAY                         S01392
      ** This is not applicable for Rule of 78 Calculation                                    CLE028
     C*                                                                   S01392
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
     C********** STRDAT    IFEQ ZIBEG                                                  S01392 245082
     C           AMTP      IFEQ 'MA'                                                          245082
     C           VDAT      ANDEQZIEND                                                         245082
     C           ADDI      ANDEQ'B'                                       S01392
     C                     ADD  1         ZIEND                           S01392
     C                     END                                            S01392
     C                     ENDIF                                                              CLE028
      ** If Amendment type is 'SA' and value date is equal to                                 165220
      ** Event Control Date, subtract 1 day if the the additional                             165220
      ** day indicator is 'L'.                                                                165220
      ** This is not applicable for Rule of 78 Calculation                                    CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
     C           AMTP      IFEQ 'SA'                                                          165220
     C           VDAT      IFEQ ECDT                                                          165220
     C           ADDI      ANDEQ'L'                                                           165220
     C                     SUB  1         ZIEND                                               165220
     C                     ENDIF                                                              165220
     C                     ENDIF                                                              165220
     C                     ENDIF                                                              CLE028
0943 C                     Z-ADDICALCB    ZICALC
0944 C                     Z-ADDOSPRIN    ZIAMT
0945 C                     Z-ADDINTRAT    ZIRATE
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDZIBEG     WKBEG   50                                          CAS005
     C                     Z-ADDZIEND     WKEND   50                                          CAS005
     C                     Z-ADDZICALC    WKCALC  10                                          CAS005
     C                     Z-ADDNOSPRI    WKAMT  150                                          CAS005
     C                     ENDIF                                                              CAS005
0946 C*
     C/COPY WNCPYSRC,LE0400CCP4                                           S01408
      *                                                                                       CLE028
      ** Instead of executing SR/GLINTC, process RULE78Z1 if CLE028 is on,                    CLE028
      ** and processing type (PTYP) is 80                                                     CLE028
      *                                                                                       CLE028
      ** First chain to cloan to get value for repayment details                              CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
      *                                                                                       CLE028
     C                     MOVE 'A'       WEPAR                                               CLE028
     C                     MOVE LNRF      WALON                                               CLE028
     C           WKLON     CHAINCLOAN                26                                       CLE028
      *                                                                                       CLE028
     C           *IN26     IFEQ '1'                                                           CLE028
     C           *LOCK     IN   LDA                                                           CLE028
     C                     MOVEL'CLOAN'   DBFILE                                              CLE028
     C                     Z-ADD19        DBASE                                               CLE028
     C                     MOVELD#CLON    DBKEY                                               CLE028
     C                     OUT  LDA                                                           CLE028
     C                     EXSR *PSSR                                                         CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
     C**********           Z-ADDVDAT      W78VDT                                       CLE028 214981
     C                     Z-ADDWVDAT     W78VDT                                              214981
     C                     Z-ADDWMDAT     W78MDT                                              CLE028
     C                     Z-ADDFLTI      W78FLT                                              CLE028
     C                     MOVE RFRQ      W78RPF                                              CLE028
     C                     Z-ADDFRPD      W78FRD                                              CLE028
     C                     Z-ADDRDYN      W78RPM                                              CLE028
     C                     MOVE CCY       W78CCY                                              CLE028
     C                     MOVE *BLANKS   W78LCN                                              CLE028
     C                     Z-ADDVDAT      W78BEG                                              CLE028
     C                     Z-ADDVDAT      W78END                                              CLE028
      *                                                                                       CLE028
     C                     MOVE 'A'       W78ROA                                              CLE028
     C                     EXSR RULE78                                                        CLE028
     C                     Z-ADDW78INT    WACINT 152                                          CLE028
      *                                                                                       CLE028
     C                     MOVE 'R'       W78ROA                                              CLE028
     C                     EXSR RULE78                                                        CLE028
     C                     Z-ADDW78INT    ZINTR                                               CLE028
     C                     Z-ADDW78NPY    WNPY    50                                          CLE028
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
0946 C*
     C/COPY WNCPYSRC,LEH01311
0947 C                     EXSR GLINTC
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0400CCP5                                           S01408
0948 C*
0949 C                     Z-ADDZINTR     INT
     C                     Z-ADDZZINDY    ZDAYN1                          100790
0950 C*
     C**   ROUND DOWN IF REQUIRED                                         S01392
     C*                                                                   S01392
     C           RDFC      IFEQ 'Y'                                       S01392
     C                     Z-ADDINT       INT130 130                      S01392
     C                     Z-ADDINT130    INT                             S01392
     C                     END                                            S01392
     C*                                                                   S01392
0951 C           ADDINT    TAG                             ** ADDINT TAG *
     C           *IN31     IFEQ '1'                                                           245082
     C                     Z-ADDTPRIN     OSPRIN                                              245082
     C                     END                                                                245082
     C                     MOVE IN31      *IN31                                               245082
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C*                                                                   CAC001
     C           *IN30     IFEQ '1'                                       CAC001
     C           IN73      OREQ '1'                                       CAC001
     C                     Z-ADD0         COF    152                      CAC001
     C                     ELSE                                           CAC001
     C*                                                                   CAC001
     C                     Z-ADDCVDAT     ZIBEG                           CAC001
     C                     Z-ADDVDAT      ZIEND                           CAC001
     C*                                                                   CAC001
     C********** STRDAT    IFEQ ZIBEG                                                  CAC001 245082
     C           AMTP      IFEQ 'MA'                                                          245082
     C           VDAT      ANDEQZIEND                                                         245082
     C           ADDI      ANDEQ'B'                                       CAC001
     C                     ADD  1         ZIEND                           CAC001
     C                     ENDIF                                          CAC001
     C           AMTP      IFEQ 'SA'                                                          165220
     C           VDAT      IFEQ ECDT                                                          165220
     C           ADDI      ANDEQ'L'                                                           165220
     C                     SUB  1         ZIEND                                               165220
     C                     ENDIF                                                              165220
     C                     ENDIF                                                              165220
     C*                                                                   CAC001
     C                     Z-ADDCOFRAT    ZIRATE                          CAC001
     C/COPY WNCPYSRC,LE0400C105
     C                     EXSR GLINTC                                    CAC001
     C/COPY WNCPYSRC,LE0400C106
     C                     Z-ADDZINTR     COF                             CAC001
     C*                                                                   CAC001
     C           RDFC      IFEQ 'Y'                                       CAC001
     C                     Z-ADDCOF       COF130 130                      CAC001
     C                     Z-ADDCOF130    COF                             CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
      ** Compute for the interest amount using the net treasury rate                          CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDWKBEG     ZIBEG                                               CAS005
     C                     Z-ADDWKEND     ZIEND                                               CAS005
     C                     Z-ADDWKCALC    ZICALC                                              CAS005
     C                     Z-ADDWKAMT     ZIAMT                                               CAS005
     C           INTRAT    SUB  WKMARG    ZIRATE                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,LEH01312
     C                     EXSR GLINTC                                                        CAS005
     C/COPY WNCPYSRC,LEH01399
      *                                                                                       CAS005
     C                     Z-ADDZINTR     WCAMT  130                                          CAS005
     C                     ENDIF                                                              CAS005
0952 C*
0953 C** SET UP NO. OF DAYS INT. CALC. FIELD
0954 C*
0955 C                     Z-ADDZDAYN1    NODYSI  50
0956 C*
0957 C** ADD TO ACCRUED INTEREST
0958 C*
      ** Add accrued interest rather than interest repaid.                                    CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     ADD  WACINT    ACCINT    H                                         CLE028
     C                     ELSE                                                               CLE028
0959 C           ACCINT    ADD  INT       ACCINT    H
     C                     ENDIF                                                              CLE028
     C                     Z-ADDACCINT    ACCIN2    H                                         235743
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           ACCCOF    ADD  COF       ACCCOF    H                     CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           ACCNTR    ADD  WCAMT     ACCNTR    H                                         CAS005
     C                     ENDIF                                                              CAS005
0960 C*
0961 C** ADD TO ACCRUED INTEREST TO IACD IF VDAT < OR = IACD
0962 C*
0963 C           VDAT      COMP NIAD                   3030
     C/COPY WNCPYSRC,LE0400C013
      *                                                                                       CLE028
      ** Add interest accrued rather than interest repaid                                     CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN30     ANDEQ'1'                                                           CLE028
     C                     ADD  WACINT    AIIACD    H                                         CLE028
     C                     ELSE                                                               CLE028
0964 C   30      AIIACD    ADD  INT       AIIACD    H
     C                     ENDIF                                                              CLE028
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           VDAT      ANDLENFCD                                      CAC001
     C           ACIACD    ADD  COF       ACIACD    H                     CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN30     ANDEQ*ON                                                           CAS005
     C           ANIACD    ADD  WCAMT     ANIACD    H                                         CAS005
     C                     ENDIF                                                              CAS005
0965 C*
0966 C** LOAD VALUE DATE INTO 'LAST VALUE DATE'
0967 C*
0968 C  N73                Z-ADDVDAT      LVDAT
     C/COPY WNCPYSRC,LE0400C014
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           IN73      ANDNE'1'                                       CAC001
     C                     Z-ADDVDAT      CVDAT                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                                     AR317587
      ** Restore the original value of VDAT.                                                AR317587
      *                                                                                     AR317587
     C           WXIND     IFEQ 'Y'                                                         AR317587
     C                     MOVE *BLANKS   WXIND                                             AR317587
     C                     Z-ADDWVDTE     VDAT                                              AR317587
     C                     ENDIF                                                            AR317587
0969 C*
0970 C                     ENDSR                           ** ENDSR **
0971 C*
0972 C********************************************************************
0973 C********************************************************************
0974 C*
0975 C** CREDIT SUBROUTINE - TO CHECK FOR NEGATIVE CURRENT PRINCIPAL
0976 C*
0977 C** CALLED BY:  MIADJ,PRINC,MANREP,INTPAY,REPAY,SPRCHG,BRTCHG,BRCCHG,
0978 C**             ROLL,STACC,MCLSSR
0979 C** CALLS:      ZDATE2,EXCPT
0980 C*
0981 C           CREDIT    BEGSR                           ** CREDIT **
0982 C*
0983 C** CHECK SIGN OF OUTSTANDING PRINCIPAL
0984 C*
0985 C***********OSPRIN    COMP 0                      65                 S01117
0986 C**N65******          GOTO CREDEN                                    S01117
     C***********OSPRIN    IFLT 0                                S01117   BHF066
     C***********          GOTO CREDEN                           S01117   BHF066
     C           OSPRIN    IFGE 0                                         BHF066
     C                     GOTO CREDEN                                    BHF066
     C                     END                                            S01117
0987 C*
0988 C** IF PROCESSING REC. FROM HISTS, SET UP FIELDS FOR O/P
0989 C*
0990 C   05                Z-ADDPRAM      PAMONT 130
0991 C   05                Z-ADDINTA      IAMONT 130
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   05                Z-ADDCOFA      CAMONT 130                      CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN05     ANDEQ*ON                                                           CAS005
     C                     Z-ADDFSPRAM    NPAMNT 130                                          CAS005
     C                     Z-ADDINTN      NAMONT 130                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0992 C   05                Z-ADDFEAM      FAMONT 130
0993 C   06                Z-ADDBRTT      BRATEC  20
0994 C   06                Z-ADDBRTE      BRATE  117
0995 C   06                Z-ADDRTSP      RATSPD 117
0996 C   06                MOVE SPIN      SPINDI  1
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN06     ANDEQ'1'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN06     ANDEQ'1'                                                           208221
     C                     Z-ADDFSRP      FUNDSP 117                      CAC001
     C                     MOVE FSGN      FUNDSG  1                       CAC001
     C                     MOVE FPRC      FUNDPC  4                       CAC001
     C                     MOVE IRCF      INTFLG  1                       CAC001
     C                     MOVE FRCF      COFFLG  1                       CAC001
     C                     ENDIF                                          CAC001
0997 C*
0998 C** FIND CURRENCY DECIMAL PLACES
0999 C*
1000 C**********           MOVELCCY       WRK4    4                       S01194
1001 C**********           MOVE '1'       WRK4                            S01194
1002 C**********           MOVE WRK4      ZTABKY                          S01194
1003 C*
1004 C********** ZTABKY    CHAINTABLE                99                   S01194
1005 C**N99***** RECI      COMP 'D'                  9999                 S01194
     C*                                                                   S01194
1000 C                     MOVELCCY       CURKEY                          S01194
     C                     CALL 'AOCURRR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
1006 C                     SETON                     U7U8LR               S01194
1007 C                     MOVELCURKEY    DBKEY                           S01194
1008 C                     Z-ADD4         DBASE                           S01194
1009 C                     MOVE 'SDCURRPD'DBFILE                          S01194
1010 C                     GOTO CREDEN                                    S01194
     C                     END                                            S01194
1006 C***99******          SETON                     U7U8LR               S01194
1007 C***99******          MOVELZTABKY    DBKEY                           S01194
1008 C***99******          Z-ADD4         DBASE                           S01194
1009 C***99******          MOVE 'TABLE'   DBFILE                          S01194
1010 C***99******          GOTO CREDEN                                    S01194
1011 C*
1012 C           CDP       COMP 1                      7475
1013 C           CDP       COMP 2                    77  76
1014 C*
1015 C** CONVERT VALUE DATE
1016 C*
1017 C                     Z-ADDVDAT      ZDAYNO
1018 C                     EXSR ZDATE2
1019 C*
1020 C** DETERMINE WHICH FIELDS ARE TO BE PRINTED ACCORDING TO AMEND TYPE
1021 C*
1022 C           AMTP      COMP 'MI'                     32
1023 C   32                SETON                     34
1024 C   32                GOTO PRINT
1025 C           AMTP      COMP 'PI'                     32
1026 C   32                SETON                     33
1027 C   32                GOTO PRINT
1028 C           AMTP      COMP 'MR'                     32
1029 C   32                SETON                     333435
1030 C   32                GOTO PRINT
1031 C           AMTP      COMP 'IN'                     32
1032 C   32                SETON                     3334
1033 C   32                GOTO PRINT
1034 C           AMTP      COMP 'RE'                     32
1035 C   32                SETON                     3334
1036 C   32                GOTO PRINT
1037 C           AMTP      COMP 'SC'                     32
1038 C   32                SETON                     54
1039 C   32                GOTO PRINT
1040 C           AMTP      COMP 'BR'                     32
1041 C   32                SETON                     3653
1042 C   32                GOTO PRINT
1043 C           AMTP      COMP 'BC'                     32
1044 C   32                SETON                     3653
1045 C   32                GOTO PRINT
1046 C           AMTP      COMP 'RO'                     32
1047 C   32                SETON                     365354
1048 C   32                SETON                     55
1049 C   32                GOTO PRINT
1050 C           AMTP      COMP 'SA'                     32
1051 C   32                SETON                     86
1052 C***32******STAI      COMP 'Y'                  2626  26 ON - START  CAC001
     C*                                                                   CAC001
     C           *IN32     IFEQ '1'                                       CAC001
     C           STAI      IFEQ 'Y'                                       CAC001
     C                     MOVE ' STOP'   WACIND  5                       CAC001
     C                     ELSE                                           CAC001
     C                     MOVE 'START'   WACIND                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   S01270
     C**  ADDITION OF PROCESSING FOR AMEND TYPE LS                        S01270
     C**  PRODUCE DETAILS ON THE REPORT THE SAME AS 'PI'.                 S01270
     C*                                                                   S01270
     C           AMTP      IFEQ 'LS'                                      S01270
     C                     MOVEA'11'      *IN,32                          S01270
     C                     END                                            S01270
1053 C*
1054 C           PRINT     TAG                             ** PRINT TAG **
      **                                                                  S01117
      **  SET THE VALUE OF P1DTLC (AT LEAST 1 DETAIL RECORD PRINTED IN    S01117
      **     CURRENT P1)                                                  S01117
      **                                                                  S01117
     C                     MOVE 'Y'       P1DTLC  1                       S01117
      *                                                                   S01117
1055 C                     SETON                     8789
1056 C                     EXSR EXCPT
     C                     SETOF                     747576
     C                     SETOF                     77
     C*                                                                   S01270
     C**  SETOF THE INDICATOR FOR AMTP =  'LS' WITHOUT COMPARE            S01270
     C*                                                                   S01270
     C           AMTP      IFEQ 'LS'                                      S01270
     C                     MOVE '0'       *IN32                           S01270
     C                     END                                            S01270
1057 C*
1058 C           CREDEN    ENDSR                           ** CREDEN **
1059 C*
1060 C********************************************************************
1061 C********************************************************************
1062 C*
1063 C** WHTAX SUBROUTINE - TO CALCULATE WITHHOLDING TAX
1064 C*
1065 C** CALLED BY:  MANREP,INTPAY,REPAY,PASTDU,MATUR
1066 C*
1067 C           WHTAX     BEGSR                           ** WHTAX **
1068 C*
1069 C** CALCULATE INTEREST RECEIVED AND TAX AMOUNT ACCORDING TO WHT TYPE
1070 C*
1071 C           WHTTYP    COMP 'N'                      31NET
1072 C  N31N19             GOTO WTNOTN
1073 C*
1074 C                     Z-ADDWHTINT    OPINTA 130       INT REC'D
1075 C*
1076 C           100       SUB  WTRT      WTWRK  117
1077 C           WTRT      DIV  WTWRK     WTWRK
     C***** CHECK WHETHER WTWRK IS A RECURRING DECIMAL *****              E43682
     C                     Z-ADDWTWRK     RNDXX   77                      E43682
     C                     Z-ADD1         M       20                      E43682
     C           RNDXX     LOKUPRN,M                     31               E43682
1078 C           WHTINT    MULT WTWRK     OPWTXA 130H      TAX AMOUNT
     C  N31                GOTO RNDEND                                    E43682
     C*** IF A RECURRING DECIMAL THEN CHECK WHETHER RESULT HAS DECIMAL ***E43682
     C*** PART IN THE REGION OF 0.444 AND ROUND UP IF APPROPRIATE ***     E43682
     C           WHTINT    MULT WTWRK     RNDY   133H                     E43682
     C                     Z-ADDRNDY      RNDYY  130                      E43682
     C           RNDY      SUB  RNDYY     RNDYYY  33                      E43682
     C           RNDYYY    COMP 0.444                30  30               E43682
     C   30      RNDY      ADD  1         OPWTXA                          E43682
     C           RNDEND    TAG                                            E43682
     C**********                                           ***************E43682
1079 C*
1080 C** TYPE 'N' OR MR AND 'G' - WHTAX AMT. NOT ADDED TO TOTAL - ZEROISE
1081 C*
1082 C                     Z-ADD0         OPTAMT 130
1083 C*
1084 C                     GOTO WHTEN
1085 C*
1086 C           WTNOTN    TAG                             ** WTNOTN TAG *
1087 C*                                                    GROSS & REC'BLE
1088 C           WTRT      DIV  100       WTWRK
1089 C           WHTINT    MULT WTWRK     OPWTXA    H      TAX AMOUNT
1090 C*
1091 C           WHTINT    SUB  OPWTXA    OPINTA           INT.REC'D
1092 C*
1093 C** DETERMINE WHETHER WHT AMOUNT TO BE ADDED INTO TOTAL AMT
1094 C*
1095 C           WHTTYP    COMP 'G'                      31
1096 C   31                Z-ADD0         OPTAMT
1097 C  N31                Z-ADDOPWTXA    OPTAMT
1098 C*
1099 C           WHTEN     ENDSR                           ** WHTEN **
1100 C*
1101 C********************************************************************
1102 C********************************************************************
1103 C*
1104 C** QNTDUE SUBROUTINE - TO CALC. INT. DUE FOR WHTAX PURPOSES
1105 C*
1106 C** CALLED BY:  INTPAY,REPAY,PASTDU,MATUR
1107 C*
1108 C           QNTDUE    BEGSR                           ** QNTDUE **
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      ACCINT                          CLE003
     C                     Z-ADDACCINT    ACCIN2                                              235743
     C                     ENDIF                                          CLE003
      *                                                                                       CLE028
      ** Move calculated interest to INTDUE for flat rate                                     CLE028
      ** personal loan                                                                        CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *OFF      *IN16                                               CLE028
     C                     MOVE *OFF      *IN17                                               CLE028
     C                     Z-ADDINT       INTDUE                                              CLE028
     C           INTDUE    IFLT *ZERO                                                         CLE028
     C                     MOVE *ON       *IN17                                               CLE028
     C                     ENDIF                                                              CLE028
     C           INTDUE    IFGT *ZERO                                                         CLE028
     C                     MOVE *ON       *IN16                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ELSE                                                               CLE028
     C/COPY WNCPYSRC,LE0400C046
1109 C*
     C**   ONLY SUBTRACT INTEREST PAST DUE IF NOT MATURITY
1110 C           ACCINT    SUB  IPAIDP    INTDUE 130
1111 C           INTDUE    SUB  INPAID    INTDUE
1112 C  N66      INTDUE    SUB  IPASTP    INTDUE
1113 C  N66      INTDUE    SUB  INPAST    INTDUE 130 1617
     C/COPY WNCPYSRC,LE0400C026
     C                     ENDIF                                                              CLE028
1114 C*
1115 C** IF INT. DUE < 0 AND INT. RATE > 0  OR
1116 C**    INT. DUE > 0 AND INT. RATE < 0 THEN SET INT. DUE TO ZERO
1117 C*
1118 C********** INTRAT    COMP 0                    3031                                   AR897086
1119 C**********                                                                            AR897086
1120 C***31*16N66                                                                           AR897086
1121 C*OR*30*17N66          Z-ADD0         INTDUE                                           AR897086
     C           *IN66     IFEQ *OFF                                                        MD050297
     C           ACCINT    ANDGT0                                                           MD050297
     C           IPAIDP    ANDGE0                                                           MD050297
     C           INPAID    ANDGE0                                                           MD050297
     C           INTRAT    ANDGT0                                                           MD050297
     C           INTDUE    ANDLT0                                                           MD050297
     C                     Z-ADD0         INTDUE                                            MD050297
     C                     ENDIF                                                            MD050297
     C/COPY WNCPYSRC,LE0400C047
1122 C*
1123 C           INTDUE    COMP 0                    16
1124 C*
1125 C                     ENDSR                           ** ENDSR **
1126 C*
1127 C********************************************************************
     C/COPY WNCPYSRC,LE0400C002
     C/EJECT                                                              CAC001
     C*****************************************************************   CAC001
     C*                                                               *   CAC001
     C*  Subroutine  :  QCFRAT                                        *   CAC001
     C*  Function    :  Calculate Effective Funding Rate              *   CAC001
     C*                                                               *   CAC001
     C*  Called by   :  STREC  - Process HISTS File Loan Header Record*   CAC001
     C*                 BVHED  - Process HISTS File B/V Header Record.*   CAC001
     C*                 INTHED - Process HISTS File Interest Header   *   CAC001
     C*                          Record.                              *   CAC001
     C*                 SPRCHG - Process Spread Rate Changes.         *   CAC001
     C*                 BRTCHG - Process Base Rate Changes.           *   CAC001
     C*                 BRCCHG - Process Base Rate Code Changes.      *   CAC001
     C*  Calls       :  -                                             *   CAC001
     C*                                                               *   CAC001
     C*****************************************************************   CAC001
      *                                                                   CAC001
     C           QCFRAT    BEGSR                           ** QCFRAT **   CAC001
      *                                                                   CAC001
     C                     SELEC                                          CAC001
     C           FUNDSN    WHEQ ' '                                       CAC001
     C                     Z-ADDFUNDRT    COFRAT 117                      CAC001
     C           FUNDSN    WHEQ '+'                                       CAC001
     C           INTRAT    ADD  FUNDRT    COFRAT                          CAC001
     C           FUNDSN    WHEQ '-'                                       CAC001
     C           INTRAT    SUB  FUNDRT    COFRAT                          CAC001
     C                     ENDSL                                          CAC001
      *                                                                   CAC001
     C           QCFRA9    ENDSR                           ** QCFRA9 **   CAC001
      *                                                                   CAC001
     C*****************************************************************   CAC001
     C/EJECT                                                              CAC001
     C*****************************************************************   CAC001
     C*                                                               *   CAC001
     C*  Subroutine  :  QCFDUE                                        *   CAC001
     C*  Function    :  Calculate COF Due                             *   CAC001
     C*                                                               *   CAC001
     C*  Called by   :  INTPAY - Interest Payments Processing         *   CAC001
     C*                 REPAY  - Repayment Processing                 *   CAC001
     C*                 PASTDU - Past Due Repayment Processing        *   CAC001
     C*                 MATUR  - Maturity Processing                  *   CAC001
     C*  Calls       :  -                                             *   CAC001
     C*                                                               *   CAC001
     C*****************************************************************   CAC001
     C*                                                                   CAC001
     C           QCFDUE    BEGSR                           ** QCFDUE **   CAC001
     C*                                                                   157669
     C           CLE003    IFEQ 'Y'                                       157669
     C           ACDA      ADD  ACAP      ACCCOF                          157669
     C                     ENDIF                                          157669
     C*                                                                   CAC001
     C           ACCCOF    SUB  CPAIDP    COFDUE 130                      CAC001
     C           COFDUE    SUB  CFPAID    COFDUE                          CAC001
     C*                                                                   CAC001
     C**  Subtract COF Past Due if not Maturity.                          CAC001
     C*                                                                   CAC001
     C           *IN66     IFEQ '0'                                       CAC001
     C           COFDUE    SUB  CPASTP    COFDUE                          CAC001
     C           COFDUE    SUB  CFPAST    COFDUE                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C**  If COF Due < 0 and COF Rate > 0  OR                             CAC001
     C**     COF Due > 0 and COF Rate < 0 then set COF Due to zero.       CAC001
     C*                                                                   CAC001
     C           *IN66     IFEQ '0'                                       CAC001
     C           COFDUE    ANDLT0                                         CAC001
     C           COFRAT    ANDGT0                                         CAC001
     C           *IN66     OREQ '0'                                       CAC001
     C           COFDUE    ANDGT0                                         CAC001
     C           COFRAT    ANDLT0                                         CAC001
     C                     Z-ADD0         COFDUE                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           QCFDU9    ENDSR                           ** QCFDU9 **   CAC001
     C*                                                                   CAC001
     C*****************************************************************   CAC001
     C/EJECT                                                              CAC001
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRNDUE - Calculate Interest Due using the Net Treasury Rate  *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRNDUE    BEGSR                                                              CAS005
      *                                                                                       CAS005
     C           CLE003    IFEQ 'Y'                                                           CAS005
     C           AITN      ADD  AIAN      ACCNTR 150                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Only subtract interest past due if not maturity                                      CAS005
      *                                                                                       CAS005
     C           ACCNTR    SUB  NTRPDP    NTRDUE 130                                          CAS005
     C           NTRDUE    SUB  NTRPID    NTRDUE                                              CAS005
      *                                                                                       CAS005
     C           *IN66     IFEQ *OFF                                                          CAS005
     C           NTRDUE    SUB  NTRPTP    NTRDUE                                              CAS005
     C           NTRDUE    SUB  NTRPST    NTRDUE                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** If Int. due < 0 and Int. Rate > 0  OR                                                CAS005
      **    Int. due > 0 and Int. Rate < 0 then set int. due to zero                          CAS005
      *                                                                                       CAS005
     C           NTRDUE    IFLT *ZERO                                                         CAS005
     C           INTRAT    ANDGT*ZERO                                                         CAS005
     C           *IN66     ANDEQ*OFF                                                          CAS005
     C           NTRDUE    ORGT *ZERO                                                         CAS005
     C           INTRAT    ANDLT*ZERO                                                         CAS005
     C           *IN66     ANDEQ*OFF                                                          CAS005
     C                     Z-ADD*ZERO     NTRDUE                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C*          INTDUE    COMP 0                    16                                       CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      ****************************************************************                        CAS005
      /EJECT                                                                                  CAS005
1128 C********************************************************************
1129 C*
1130 C** STDETS SUBROUTINE - DETERMINE INTEREST STMT.DETAILS FOR INT.HEADR
1131 C*
1132 C** CALLED BY:  OUTINH,PREVLN
1133 C*
1134 C           STDETS    BEGSR                           ** STDETS **
1135 C*
1136 C** DETERMINE NO OF NEW STMT. PAGES NEEDED
1137 C*
1138 C           NOSTRC    DIV  11        NUSTPG  50
1139 C                     MVR            REM     20 30
1140 C   30      NUSTPG    ADD  1         NUSTPG
1141 C           NUSTPG    ADD  STPG      STPG
1142 C*
1143 C** SET UP PRINC. & INT. & INT. PAID AT PREV. INT. STMT.
1144 C*
1145 C                     Z-ADDOSPRIN    PPIS             PRINCIPAL
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      ACCINT                          CLE003
     C           ACCINT    ADD  IPRD      ACCINT                          CLE003
     C                     Z-ADDACCINT    ACCIN2                                              235743
     C*                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           ACDA      ADD  ACAP      ACCCOF                          157669
     C           ACCCOF    ADD  COFD      ACCCOF                          157669
     C                     ENDIF                                          157669
     C*                                                                   157669
     C                     ENDIF                                          CLE003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           AITN      ADD  AIAN      ACCNTR                                              CAS005
     C           ACCNTR    ADD  IPRN      ACCNTR                                              CAS005
     C                     ENDIF                                                              CAS005
1146 C                     Z-ADDACCINT    IPIS             INTEREST
      *                                                                   CLE003
1147 C           IPAIDP    ADD  INPAID    IPTDPS
1148 C*
1149 C                     ENDSR                           ** ENDSR **
1150 C*
1151 C********************************************************************
1152 C********************************************************************
1153 C*
1154 C** QNTRAT SUBROUTINE - CALCULATE EFFECTIVE INTEREST RATE
1155 C*
1156 C** CALLED BY:  BVHED,INTHED,SPRCHG,BRTCHG,BRCCHG,ROLL
1157 C*
1158 C           QNTRAT    BEGSR                           ** QNTRAT **
1159 C*
1160 C           SPRIND    COMP 'A'                      31
1161 C   31      BASERT    ADD  SPREAD    INTRAT 117
1162 C   31                GOTO INTEN
1163 C*
1164 C           SPRIND    COMP 'S'                      31
1165 C   31      BASERT    SUB  SPREAD    INTRAT
1166 C   31                GOTO INTEN
1167 C*
1168 C           SPREAD    DIV  100       WORK   139
1169 C           WORK      MULT BASERT    INTRAT    H
1170 C*
1171 C           INTEN     ENDSR                           ** INTEN **
1172 C*
1173 C********************************************************************
1174 C********************************************************************
1175 C*
1176 C** CONTRL SUBROUTINE - TO SAVE INFORMATION FROM THE ACTN4 CONT. REC.
1177 C*
1178 C** CALLED BY:  ACTN
1179 C*
1180 C           CONTRL    BEGSR                           ** CONTRL **
1181 C*
1182 C** DETERMINE INDICATOR SETTINGS
1183 C*
1184 C           CTRQ      COMP 'Y'                      60TELEX REQ'D
      *                                                                   CLE003
     C           CLE003    IFNE 'Y'                                       CLE003
1185 C           RBVS      COMP 'Y'                      62B/V BEY'D SLID
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
1186 C           INPY      COMP 'Y'                      63INT. PAY'T.
1187 C           ACCR      COMP 'Y'                      64ACTN.RECS.EXIST
1188 C           LNMA      COMP 'Y'                      68LOAN MATURING
1189 C           LNRV      COMP 'Y'                      69LOAN REVERSAL
     C***********          MOVE ' '       CTRQ                     092675 132738
1190 C*
1191 C** SET UP FIELDS FOR INTEREST CALCULATION
1192 C*
1193 C                     Z-ADDTINP      IPAIDP 130
1194 C                     Z-ADDTIPD      IPASTP 130
      *                                                                                     AR790759
      ** Set up field for Outstanding Principal                                             AR790759
      *                                                                                     AR790759
     C                     MOVE *IN26     WIN26                                             AR790759
     C                     Z-ADD0         WTOPD  130                                        AR790759
     C           LNRF      SETLLLOAMS5F                                                     AR790759
     C           LNRF      READELOAMS5F                  26                                 AR790759
      *                                                                                     AR790759
     C           *IN26     DOWEQ'0'                                                         AR790759
     C           PRAMDK    IFNE 0                                                           AR790759
     C                     ADD  PRAMDK    WTOPD                                             AR790759
     C                     ENDIF                                                            AR790759
     C           LNRF      READELOAMS5F                  26                                 AR790759
     C                     ENDDO                                                            AR790759
      *                                                                                     AR790759
     C                     Z-ADDWCPAM     WOPRIN                                            AR790759
      *                                                                                     AR790759
     C                     MOVE 'N'       WPDCL   1                                         AR790759
     C                     MOVELWLTYP     WLLTYP  1                                         AR790759
     C           WLLTYP    IFEQ 'X'                                                         AR790759
     C           WLLTYP    OREQ 'Y'                                                         AR790759
     C           WLLTYP    OREQ 'Z'                                                         AR790759
     C                     MOVE 'Y'       WPDCL                                             AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
     C           WPDCL     IFEQ 'N'                                                         AR790759
     C           WOPRIN    SUB  WTOPD     WOPRIN                                            AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
     C                     MOVE WIN26     *IN26                                             AR790759
     C*                                                                   CAC001
     C** Set up fields for Cost of Funds Calculation.                     CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDTCFP      CPAIDP 130                      CAC001
     C                     Z-ADDTCPD      CPASTP 130                      CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDTNNP      NTRPDP 130                                          CAS005
     C                     Z-ADDTNPD      NTRPTP 130                                          CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   CAC001
     C** INITIALIZE FIELDS FOR STORING BACK VALUED BASE RATE CHANGE       E47238
     C                     MOVE 'N'       BVBCHG  1                       E47238
     C                     Z-ADD0         BVBRVD  50                      E47238
     C                     Z-ADD0         NEWBRT 137                      E47238
     C                     MOVE *BLANKS   NEWBRC  20                                          198585
     C                     MOVE 'N'       BVSCHG  1                       188115
     C                     Z-ADD0         BVSRVD  50                      188115
     C                     Z-ADD0         NEWSRT 117                      188115
1195 C           PTYP      COMP 61                       71DEMAND LOAN
     C***********PTYP      COMP 70                       71RISK LOANS01114E10969
     C**N71******PTYP      COMP 70                       71RISK LOANE10969082477
1196 C           PTYP      COMP 63                       67DISCOUNTED LOAN
1197 C  N67      PTYP      COMP 65                       67DISCOUNTED LOAN
1198 C  N67      PTYP      COMP 67                       67DISCOUNTED LOAN
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      ANDEQ68                                        CLE005
     C                     MOVE '1'       *IN71                           CLE005
     C                     ENDIF                                          CLE005
1199 C*
1200 C** DISC. LOAN - ZEROISE VDAT OF LAST BILL CONTAING INT. PAYMENT
1201 C*
1202 C   67                Z-ADD0         LTVD
     C/COPY WNCPYSRC,LE0400C027
1203 C*
1204 C                     ENDSR                           ** ENDSR **
     C/COPY WNCPYSRC,LE0400C048
1205 C*
1206 C********************************************************************
1207 C********************************************************************
1208 C*
1209 C** PREVLN SUBROUTINE - COMPLETE PROCESSING FOR PREVIOUS LOAN SET
1210 C*
1211 C** CALLED BY:  MAIN PROCESSING
1212 C** CALLS:      STDETS,EXCPT
1213 C*
1214 C           PREVLN    BEGSR                           ** PREVLN **
1215 C*
1216 C   25N21             EXSR INTHED
1217 C*
1218 C** IF NO ACTION RECS ACTIONED (I.E. NO RECS O/P TO ACTN5),DO NO
1219 C** FURTHER PROCESSING
1220 C*
      ** Ensure AIIAC and AIIACD is now cleared before going back         137026
      ** to the calling routine                                           137026
      *                                                                   137026
     C           *IN24     IFEQ '0'                                       137026
     C           *IN15     ANDEQ'0'                                       137026
     C                     Z-ADD*ZEROS    AIIAC                           137026
     C                     Z-ADD*ZEROS    AIIACD                          137026
     C                     ENDIF                                          137026
     C/COPY WNCPYSRC,LE0400C087
1221 C  N24N15             GOTO PREVEN
     C/COPY WNCPYSRC,LE0400C088
1222 C*
1223 C** IF INT.HEADER NOT OUTPUT TO S/HIUPD YET, THEN OUTPUT NOW
1224 C*
1225 C** IF LOAN IS REVERSED, OR IF A DEAL DATE ACTION RECORD WAS
1226 C** PROCESSED AND START DATE RECORD NOT PROCESSED, THEN THERE SHOULD
1227 C** BE NO OUTPUT TO S/HIUPD. THEREFORE, BYPASS OUTPUT OF INTEREST
1228 C** HEADER IF BACK-VALUE HEADER HAS NOT BEEN OUTPUT.
1229 C*
1230 C   22
1231 CORN20                GOTO OUTCON
1232 C*
1233 C** DETERMINE STATEMENT DETAILS IF REQ'D
1234 C*
1235 C   25                Z-ADD0         STPG
1236 C   25                Z-ADD0         PPIS
1237 C   25                Z-ADD0         IPIS
1238 C   25                Z-ADD0         IPTDPS 130
1239 C  N25                Z-ADDIPPS      IPTDPS
1240 C   71 63             EXSR STDETS
1241 C*
1242 C** OUTPUT INTEREST HEADER
1243 C*
1244 C  N25                SETON                     43
1245 C   25                SETON                     48
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      ACCINT                          CLE003
     C                     Z-ADDACCINT    ACCIN2                                              235743
     C                     ENDIF                                          CLE003
1246 C                     Z-ADDACCINT    ACCIN
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           ACDA      ADD  ACAP      ACCCOF                          157669
     C                     ENDIF                                          157669
     C                     Z-ADDACCCOF    ACCCO                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           CLE003    ANDEQ'Y'                                                           CAS005
     C           AITN      ADD  AIAN      ACCNTR                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
      **Store*original*currency*value,*replace*with*Multi-currency* CLE004127069
      **value*for*output******************************************* CLE004127069
      *                                                                   CLE004
     C***********CLE004    IFEQ 'Y'                                 CLE004127069
     C***********AMTP      ANDEQ'MC'                                CLE004127069
     C***********          MOVE CCY       W#CCY                     CLE004127069
     C***********          MOVE RLCY      CCY                       CLE004127069
     C***********          ENDIF                                    CLE004127069
     C*                                                                   CAC001
1247 C                     EXSR EXCPT
1248 C           NHIUPD    ADD  1         NHIUPD
      *                                                                   CLE004
     C***********CLE004    IFEQ 'Y'                                 CLE004127069
     C***********AMTP      ANDEQ'MC'                                CLE004127069
     C***********          MOVE W#CCY     CCY                       CLE004127069
     C***********          ENDIF                                    CLE004127069
1249 C*
1250 C** OUTPUT CONTROL RECORD
1251 C*
1252 C           OUTCON    TAG                             ** OUTCON TAG *
      *                                                                   157669
      ** Ensure AIIAC and AIIACD is now cleared before going back         157669
      ** to the calling routine                                           157669
      *                                                                   157669
     C           *IN24     IFEQ '0'                                       157669
     C                     Z-ADD*ZEROS    AIIAC                           157669
     C                     Z-ADD*ZEROS    AIIACD                          157669
     C                     ENDIF                                          157669
1253 C*
1254 C  N24                GOTO PREVEN
      ***********************************************************  137026 157669
      ***Ensure*AIIAC*and*AIIACD*is*now*cleared*before*going*back  137026 157669
      ***to*the*calling*routine**********************************  137026 157669
      ***********************************************************  137026 157669
     C************IN24     IFEQ '0'                                137026 157669
     C***********          Z-ADD*ZEROS    AIIAC                    137026 157669
     C***********          Z-ADD*ZEROS    AIIACD                   137026 157669
     C***********          ENDIF                                   137026 157669
1255 C*
1256 C                     SETON                     44
1257 C                     Z-ADDAIIACD    AIIAC  130
1258 C  N20                Z-ADD0         AIIAC
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDACIACD    ACIAC  130                      CAC001
     C  N20                Z-ADD0         ACIAC                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDANIACD    ANIAC  130                                          CAS005
     C           *IN20     IFEQ *OFF                                                          CAS005
     C                     Z-ADD*ZEROS    ANIAC                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   CAC001
     C/COPY WNCPYSRC,LE0400C049
1259 C                     EXSR EXCPT
     C/COPY WNCPYSRC,LE0400C050
1260 C           NACTN5    ADD  1         NACTN5
     C/COPY WNCPYSRC,LE0400C028
      *                                                                                     AR317587
     C           *IN67     IFEQ '1'                                                         AR317587
     C                     Z-ADD0         AIIACD                                            AR317587
     C                     ENDIF                                                            AR317587
1261 C*
      *                                                                   157669
     C           PREVEN    TAG                             ** PREVEN TAG *157669
      *                                                                   157669
      **  If the next loan processed is newly inserted and is             157669
      **  valued in the future, it uses the previous value of             157669
      **  AIIACD unwantedly.  So initialise this field after              157669
      **  each loan processed.                                            157669
      *                                                                   157669
     C                     Z-ADD0         AIIACD                          157669
     C                     Z-ADD0         ACIACD                          157669
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD*ZEROS    ANIACD                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADD0         WACINT                                              CLE028
     C*                                                                   157669
1262 C***********PREVEN    ENDSR                           ** PREVEN **   157669
     C                     ENDSR                           ** ENDSR **    157669
     C/COPY WNCPYSRC,LE0400C038
1263 C*
1264 C********************************************************************
1265 C********************************************************************
1266 C*
1267 C** STREC SUBROUTINE - TO PROCESS HISTS FILE LOAN HEADER RECORD
1268 C*
1269 C** CALLED BY:  HIST
1270 C** CALLS:      EXCPT
1271 C*
1272 C           STREC     BEGSR                           ** STREC **
     C*
     C** SET INDICATOR TO SHOW RECORDS READ
     C                     SETON                     70
1273 C*
1274 C** SAVE FIELDS NEEDED FOR INT. CALC.
1275 C*
1276 C                     MOVE INTC      CAPNIN
1277 C                     MOVE REPT      REPTYP
1278 C                     MOVE WTIN      WHTTYP
     C**
     C**   RATE FIELDS AS WELL AS PRIN. AMT. SET UP HERE. THIS WILL
     C**   DO NO HARM AND WILL PREVENT ANY ERRORS LIKE THAT WITH
     C**   THE PRIN. AMT. FROM OCCURRING.
     C**
     C                     Z-ADDPRAM      OSPRIN
     C                     Z-ADDBRTE      BASERT
     C                     Z-ADDRTSP      SPREAD
     C                     MOVE SPIN      SPRIND
     C                     Z-ADDCALC      ICALCB
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C                     Z-ADDFSRP      FUNDRT                          CAC001
     C                     MOVE FSGN      FUNDSN                          CAC001
     C                     MOVE FPRC      FUNPRF                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE003
1279 C*
1280 C** OUTPUT RECORD AS INPUT
1281 C*
     C           CLE003    IFNE 'Y'                                       CLE003
1282 C                     SETON                     42
1283 C                     EXSR EXCPT
     C***********          ENDIF                                   CLE003 115625
1284 C           NHIUPD    ADD  1         NHIUPD
     C                     ENDIF                                          115625
1285 C                     Z-ADDVDAT      PHVDAT  50
     C                     Z-ADDVDAT      VDATS
     C                     MOVE BRTT      BASECD
     C                     Z-ADDVDAT      STRDAT  50       START DAY      S01392
     C*  IF an action is BACK- VALUED (*IN62 = 1)                         040790
     C*     interest calculation is required from start of loan           040790
     C           *IN62     IFEQ '1'                        Backval. Action040790
     C                     SETON                     23    INT.CALCS REQ'D040790
     C                     Z-ADD0         ACCINT                          040790
     C                     Z-ADD0         ACCIN2                                              235743
     C                     Z-ADD0         AIIACD                          040790
     C                     Z-ADD0         ACCCOF                          CAC001
     C                     Z-ADD0         ACIACD                          CAC001
     C                     Z-ADDVDAT      LVDAT                           040790
     C                     Z-ADD*ZEROS    ANIACD                                              CAS005
     C                     Z-ADD*ZEROS    ACCNTR                                              CAS005
     C                     EXSR QNTRAT                                    040790
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDVDAT      CVDAT                           CAC001
     C                     EXSR QCFRAT                                    CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     END                             Backval. Action040790
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                   CLE003
      **  Interest must be calculated from the start of the loan          CLE003
     C           CPAM      IFEQ 0                                         CLE003
     C           INTR      ANDEQ0                                         CLE003
      *                                                                   CLE003
     C********** PTYP      IFNE 63                                                   CLE003 AR317587
     C********** PTYP      ANDNE65                                                   CLE003 AR317587
     C********** PTYP      ANDNE67                                                   CLE003 AR317587
     C********** STAIND    ANDNE'Y'                                                  CLE003 AR317587
     C           STAIND    IFNE 'Y'                                                         AR317587
     C                     MOVE *ON       *IN23                           CLE003
     C                     Z-ADDPRAM      CPAM                            CLE003
     C                     Z-ADDPRAM      W#CPAM                          CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    FSCPAM                                              CAS005
     C                     Z-ADDFSPRAM    W#FSCP                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     EXSR QNTRAT                                    CLE003
     C                     Z-ADDINTRAT    INTR                            CLE003
     C                     Z-ADDINTRAT    W#INTR                          CLE003
      *                                                                   157669
      ** Determine Cost of Funds rate (COFRAT)                            157669
      *                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C                     EXSR QCFRAT                                    157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADDCOFRAT    W#COFR                          157669
     C                     ENDIF                                          157669
      *                                                                   157669
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C                     Z-ADD0         AITC                            CLE003
     C                     Z-ADD0         AIAP                            CLE003
     C                     Z-ADD0         IPRD                            CLE003
     C                     Z-ADD0         ACDA                            157669
     C                     Z-ADD0         ACAP                            157669
     C                     Z-ADD0         COFD                            157669
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD0         AITN                                                CAS005
     C                     Z-ADD0         AIAN                                                CAS005
     C                     Z-ADD0         IPRN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
      ** Initialize begining date for accrual calculation                 CLE003
     C                     Z-ADDVDAT      LVDAT                           CLE003
      *                                                                   157669
      ** Initialize beginning date for Cost of Funds calculation          157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C                     Z-ADDVDAT      CVDAT                           157669
     C                     ENDIF                                          157669
      *                                                                   157669
     C                     SETON                     42                   CLE003
     C                     EXSR EXCPT                                     CLE003
     C           NHIUPD    ADD  1         NHIUPD                          115677
      *                                                                   CLE003
     C                     ENDIF                                          CLE003
1286 C*
1287 C                     ENDSR                           ** ENDSR **
1288 C*
1289 C********************************************************************
1290 C********************************************************************
1291 C*
1292 C** BVHED SUBROUTINE - TO PROCESS HISTS FILE B/V HEADER RECORD
1293 C*
1294 C** CALLED BY:  HIST
1295 C** CALLS:      QNTRAT,EXCPT
1296 C*
1297 C           BVHED     BEGSR                           ** BVHED **
1298 C*
1299 C** SET ON IND. TO SHOW REC. READ
1300 C*
1301 C                     SETON                     28
     C/COPY WNCPYSRC,LE0400C029
1302 C*
1303 C** INT. CALCS. REQ'D IF REC B/V BEYOND SLID OR VAL.DATE OF B/V HEADR
1304 C** IS LESS THAN BVLP. IF SO,SET UP INT. CALC. FIELDS
1305 C*
1306 C           VDAT      COMP BVDAT                  30
     C**
     C**  IF BASE RATE CHANGE BACK-VALUED TO START DATE, AND
     C**  BACK-VALUE HEADER STILL AT START, THEN USE NEW RATE
     C**
     C   80      VDAT      COMP VDATS                    80
     C   80                Z-ADDBRTES     BRTE
1307 C*
1308 C** SET ON IND. FOR 'SA' PROCESSING
1309 C*
1310 C   62
1311 COR 30                SETON                     29
1312 C*
1313 C  N62N30             SETOF                     23    INT CALCS.NOT
1314 C  N62N30             GOTO OPBVHD                     REQ'D
1315 C*
     C*  IF an action is BACK- VALUED (*IN62 = 1)                         040790
     C*     DO NOT reinitialise the running totals with the information   040790
     C*            from the 'BH' record                                   040790
     C*     DO NOT output the 'BH' record as input : recalculate the 'BH' 040790
     C*            record information                                     040790
     C   62                GOTO BVHEN                                     040790
     C*                                                                   040790
1316 C                     Z-ADDINTA      ACCINT
     C                     Z-ADDINTA      ACCIN2                                              235743
1317 C                     Z-ADDINTA      AIIACD
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDCOFA      ACCCOF                          CAC001
     C                     Z-ADDCOFA      ACIACD                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDINTN      ACCNTR                                              CAS005
     C                     Z-ADDINTN      ANIACD                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
1318 C                     Z-ADDPRAM      OSPRIN
1319 C                     Z-ADDBRTT      BASECD
1320 C                     Z-ADDBRTE      BASERT
1321 C                     Z-ADDRTSP      SPREAD
1322 C                     MOVE SPIN      SPRIND
1323 C                     Z-ADDCALC      ICALCB
1324 C                     Z-ADDVDAT      LVDAT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C                     Z-ADDFSRP      FUNDRT                          CAC001
     C                     MOVE FSGN      FUNDSN                          CAC001
     C                     MOVE FPRC      FUNPRF                          CAC001
     C                     Z-ADDVDAT      CVDAT                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
1325 C*
1326 C** CALCULATE EFFECTIVE INTEREST RATE
1327 C*
1328 C                     EXSR QNTRAT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     EXSR QCFRAT                                    CAC001
     C                     ENDIF                                          CAC001
1329 C*
1330 C                     SETON                     23    INT.CALCS REQ'D
1331 C           STAIND    COMP 'Y'                  2323
1332 C*
1333 C           OPBVHD    TAG                             ** OPBVHD TAG *
     C   20                GOTO BVHEN
1334 C*
1335 C** OUTPUT B/V HEADER AS INPUT IF NOT TO BE MOVED
1336 C*
1337 C  N30                SETON                     42
1338 C  N30                EXSR EXCPT
1339 C  N30      NHIUPD    ADD  1         NHIUPD     20
1340 C  N30                Z-ADDVDAT      PHVDAT
1341 C*
     C           BVHEN     ENDSR                           ** BVHEN **
1343 C*
1344 C********************************************************************
1345 C********************************************************************
1346 C*
1347 C** INTHED SUBROUTINE - TO PROCESS HISTS FILE INTEREST HEADER RECORD
1348 C*
1349 C** CALLED BY:  HIST,STRTDT
1350 C** CALLS:      EXCPT,QNTRAT
1351 C*
1352 C           INTHED    BEGSR                           ** INTHED **
1353 C*
1354 C** SET ON IND. TO SHOW RECORD READ
1355 C*
1356 C                     SETON                     21
     C/COPY WNCPYSRC,LE0400C030
1357 C*
1358 C** IF B/V HEADER NOT YET OUTPUT.THEN OUTPUT NOW
1359 C*
     C** INDICATOR 28 IS ON WHEN THE BH RECORD HAS BEEN READ (N25)        E35700
     C**                 OR WHEN CREATING  A NEW LOAN ON HIST (25)        E35700
     C**                                                                  E35700
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      ACCIN                           CLE003
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C                     Z-ADDW#AITC    AITC                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ELSE                                           CLE003
     C                     Z-ADDACCINT    ACCIN  130                      E35700
     C                     ENDIF                                          CLE003
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           ACDA      ADD  ACAP      ACCCO                           157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#COFD    COFD                            157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ELSE                                           157669
     C                     Z-ADDACCCOF    ACCCO  130                      CAC001
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           *IN28     IFEQ '1'                                       E35700
     C           CLE003    IFEQ 'Y'                                       CLE003
      ** SETON *IN20 (Backvalue header written). also mean Backvalue      CLE003
      ** header not needed                                                CLE003
     C                     MOVE *ON       *IN20                           CLE003
     C                     ENDIF                                          CLE003
1360 C  N20N25             SETON                     46
1361 C  N20 25             SETON                     47
1362 C**N20******          Z-ADDACCINT    ACCIN  130                      E35700
1363 C  N20                EXSR EXCPT
1364 C  N20      NHIUPD    ADD  1         NHIUPD     20
     C                     END                                            E35700
     C**
     C**   IF BASE RATE CHANGE BACK-VALUED TO START DATE, AND
     C**   INTEREST HEADER STILL AT START, THEN USE NEW RATE
     C**
     C   80      VDAT      COMP VDATS                    80
     C   80                Z-ADDBRTES     BRTE
     C**                                                                  E17410
     C**   IF BASE RATE CHANGE BACK-VALUED ON OR BEFORE START LAST        E17410
     C**   INTEREST DATE , I.E. RBVS = Y , THEN USE NEW RATE.             E17410
     C**                                                                  E17410
     C   62                Z-ADDNEWBRT    BRTE                            E17410
     C           *IN62     IFEQ '1'                                       188115
     C                     Z-ADDNEWSRT    RTSP                            188115
     C                     ENDIF                                          188115
1365 C*
1366 C** IF NO RECORDS BACK VALUED PRIOR TO SLID, OR IF PROCESSING OF
1367 C** START DATE RECORD, INITIALISE FIELDS FOR INTEREST CALCULATION
1368 C*
1369 C   62N25             GOTO DEMAND
     C           CLE003    IFNE 'Y'                                       116332
1370 C  N25                Z-ADDINTA      ACCINT 150
     C                     ENDIF                                          116332
      *                                                                                       CLE028
      ** If flat rate personal loan, do not zeroise accrued interest                          CLE028
      ** since this already have a value calculated from Start date action                    CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
1371 C   25                Z-ADD0         ACCINT
     C                     ENDIF                                                              CLE028
     C           CLE003    IFNE 'Y'                                       116332
1372 C  N25                Z-ADDINTA      AIIACD 150
     C                     ENDIF                                          116332
      *                                                                                       CLE028
      ** If flat rate personal loan, do not zeroise accrued interest                          CLE028
      ** since this already have a value calculated from Start date action                    CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
1373 C   25                Z-ADD0         AIIACD
     C                     ENDIF                                                              CLE028
     C                     Z-ADDACCINT    ACCIN2                                              235743
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFNE 'Y'                                       157669
     C  N25                Z-ADDCOFA      ACCCOF 150                      CAC001
     C                     ENDIF                                          157669
     C   25                Z-ADD0         ACCCOF                          CAC001
     C           CLE003    IFNE 'Y'                                       157669
     C  N25                Z-ADDCOFA      ACIACD 150                      CAC001
     C                     ENDIF                                          157669
     C   25                Z-ADD0         ACIACD                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           CLE003    IFNE 'Y'                                                           CAS005
     C           *IN25     ANDEQ*OFF                                                          CAS005
     C                     Z-ADDINTN      ACCNTR                                              CAS005
     C                     Z-ADDINTN      ANIACD                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN25     IFEQ *ON                                                           CAS005
     C                     Z-ADD*ZEROS    ACCNTR                                              CAS005
     C                     Z-ADD*ZEROS    ANIACD                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   CAC001
     C           CLE003    IFNE 'Y'                                       115275
1374 C**N25******          Z-ADDPRAM      OSPRIN 130                      160856
     C************IN25     IFEQ '0'                                 160856182711
     C************IN04     ANDEQ'0'                                 160856182711
     C***********          Z-ADDPRAM      OSPRIN 130                160856182711
     C***********          ENDIF                                    160856182711
     C**N25*****           Z-ADDPRAM      OSPRIN 130                                   182711 193987
     C           *IN25     IFEQ '0'                                                           193987
     C           *IN04     ANDEQ'0'                                                           193987
     C                     Z-ADDPRAM      OSPRIN 130                                          193987
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NOSPRI 130                                          CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              193987
     C           BVBCHG    IFEQ 'N'                                                           198585
1375 C  N25                Z-ADDBRTT      BASECD  20
1376 C  N25                Z-ADDBRTE      BASERT 117
1377 C**N25*****           Z-ADDRTSP      SPREAD 117                      188115
     C                     ELSE                                                               198585
     C           *IN25     IFEQ '0'                                                           198585
     C                     MOVE NEWBRC    BASECD                                              198585
     C                     Z-ADDNEWBRT    BASERT                                              198585
     C                     ENDIF                                                              198585
     C                     ENDIF                                                              198585
     C           *IN25     IFEQ '0'                                       188115
     C           *IN04     ANDEQ'0'                                       188115
     C                     Z-ADDRTSP      SPREAD 117                      188115
     C                     ENDIF                                          188115
1378 C  N25                MOVE SPIN      SPRIND  1
1379 C  N25                Z-ADDCALC      ICALCB  10
1380 C  N25                Z-ADDVDAT      LVDAT   50
     C                     ENDIF                                          115275
     C/COPY WNCPYSRC,LE0400C015
     C*                                                                   115275
1381 C   25                Z-ADDPRAMS     OSPRIN
1382 C   25                Z-ADDBRTTS     BASECD
1383 C   25                Z-ADDBRTES     BASERT
1384 C   25                Z-ADDRTSPS     SPREAD
1385 C   25                MOVE SPINS     SPRIND
1386 C   25                Z-ADDCALCS     ICALCB
1387 C   25                Z-ADDVDATS     LVDAT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN25     ANDEQ*ON                                                           CAS005
     C                     Z-ADDPRAMN     NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
      ** For flat rate personal loans, add charges due and interest due to principal          CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     ADD  WCHDU     OSPRIN                                              CLE028
     C                     ADD  WINTA     OSPRIN                                              CLE028
     C                     ENDIF                                                              CLE028
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN25     IFEQ '0'                                       CAC001
     C           CLE003    IFNE 'Y'                                       157669
     C                     Z-ADDFSRP      FUNDRT 117                      CAC001
     C                     MOVE FSGN      FUNDSN  1                       CAC001
     C                     MOVE FPRC      FUNPRF  4                       CAC001
     C                     Z-ADDVDAT      CVDAT   50                      CAC001
     C                     ENDIF                                          157669
     C                     ELSE                                           CAC001
     C                     Z-ADDFSRPS     FUNDRT                          CAC001
     C                     MOVE FSGNS     FUNDSN                          CAC001
     C                     MOVE FPRCS     FUNPRF                          CAC001
     C                     Z-ADDVDATS     CVDAT                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
1388 C*
1389 C** CALCULATE EFFECTIVE INTEREST RATE
1390 C*
1391 C                     EXSR QNTRAT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     EXSR QCFRAT                                    CAC001
     C                     ENDIF                                          CAC001
1392 C*
1393 C           DEMAND    TAG                             ** DEMAND TAG *
1394 C*
1395 C** DETERMINE IF INT. STMTS TO BE PRODUCED. IF SO, O/P INT. HEADER
1396 C** TO S/INTST
1397 C*
1398 C   71 63             SETON                     49
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      ACCIN                           CLE003
     C                     ELSE                                           CLE003
1399 C                     Z-ADDACCINT    ACCIN
     C                     ENDIF                                          CLE003
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           ACDA      ADD  ACAP      ACCCO                           157669
     C                     ELSE                                           157669
     C                     Z-ADDACCCOF    ACCCO                           CAC001
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
1400 C*
1401 C   71 63             EXSR EXCPT
1402 C   71 63   NINTST    ADD  1         NINTST
1403 C*
1404 C** NO INTEREST PAYMENTS TO ACTION - OUTPUT INTEREST HEADER TO HIUPD
1405 C** AND CUTX1
1406 C*
1407 C  N63 25             Z-ADD0         STPG
1408 C  N63 25             Z-ADD0         PPIS
1409 C  N63 25             Z-ADD0         IPIS
1410 C  N63 25             Z-ADD0         IPTDPS
1411 C  N63N25             Z-ADDIPPS      IPTDPS
      *                                                                   CLE004
      * Do not output to CUTX1HN if it has already been done.             CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
      *                                                                   CLE004
1412 C   60
1413 CANN63NU3 25          Z-ADDINPAID    TOTINP
1414 C   60
1415 CANN63NU3N25IPAIDP    ADD  INPAID    TOTINP
1416 C  N63N25             SETON                     43
1417 C  N63 25N22          SETON                     48
1418 C  N63NU3 60          SETON                     52
1419 C  N63                EXSR EXCPT
1420 C**N63N22***NHIUPD    ADD  1         NHIUPD     22                   E11135
     C  N63N25                                                            E11135
     CORN63N22 25NHIUPD    ADD  1         NHIUPD     22                   E11135
1421 C  N63NU3 60NCUTX1    ADD  1         NCUTX1
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *IN63     ANDEQ'0'                                                           235743
     C           *INU3     ANDEQ'0'                                                           235743
     C           *IN60     ANDEQ'1'                                                           235743
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
1422 C*
1423 C** SET ON IND.TO PERFORM INT.CALC.
1424 C*
1425 C                     SETON                     23
1426 C           STAIND    COMP 'Y'                  2323
1427 C*
1428 C                     ENDSR                           ** ENDSR **
1429 C*
1430 C********************************************************************
1431 C********************************************************************
1432 C*
1433 C** MIADJ SUBROUTINE - TO PROCESS MANUAL INTEREST ADJUSTMENTS
1434 C*
1435 C** CALLED BY:  HIST,ACTN
1436 C** CALLS:      OUTBVH,OUTINH,INTCAL,EXCPT,CREDIT
1437 C*
1438 C           MIADJ     BEGSR                           ** MIADJ **
1439 C*
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTMIR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
1440 C   25N21             EXSR INTHED
1441 C*
1442 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
1443 C*
1444 C                     EXSR OUTBVH
1445 C*
1446 C                     EXSR OUTINH
1447 C*
1448 C** PERFORM INT. CALCS. IF NECESSARY
      *                                                                                       230712
      ** For non-daily accruals system, zeroise INTA if MI is not                             230712
      ** to be actioned yet at rundate.                                                       230712
      *                                                                                       230712
     C           *IN12     IFEQ '1'                                                           230712
     C           *IN72     ANDEQ'1'                                                           230712
     C                     Z-ADD0         INTA                                                230712
     C                     ENDIF                                                              230712
1449 C*
1450 C** IF PROCESSING RECORD FROM ACTN4, CHECK VALUE DATE AGAINST IACD
1451 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C                     MOVE *ON       *IN73                           114482
     C                     MOVE '1'       IN73                            114482
     C           INTA      ADD  W#AIAP    AIAP                            CLE003
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE003
      **  **** Note that manual adjustment record (AMTP = 'MI') will      CLE003
      **  Not have a calculated AITC. Only where the rate or              CLE003
      **  principal change should the accrual be calculated for           CLE003
      **  AITC. A calculation of interest will result in 2 calculation    CLE003
      **  instead of 1. Thus, may result in rounding differences. ****    CLE003
     C                     Z-ADDW#AITC    AITC                            CLE003
      *                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           COFA      ADD  W#ACAP    ACAP                            157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#COFD    COFD                            157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
      *                                                                   157669
     C                     ELSE                                           CLE003
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
1452 C   12      VDAT      COMP NIAD                 73
     C*******              ENDIF                                   CLE003 114482
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN12     IFEQ '1'                                       CAC001
     C           VDAT      ANDGTNFCD                                      CAC001
     C                     MOVE '1'       IN73    1                       CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       IN73                            CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      ** If *IN12 = '0' (from History File), do not perform interest      192014
      ** calculation for AMTP = 'MI'                                      192014
     C           *IN12     IFEQ '0'                                       192014
     C                     MOVE '1'       *IN73                           192014
     C                     ENDIF                                          192014
     C                     ENDIF                                          114482
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           INTN      ADD  W#AIAN    AIAN                                                CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
1453 C*
1454 C   23                EXSR INTCAL
1455 C*
1456 C                     SETOF                     73
     C                     MOVE '0'       IN73                            CAC001
1457 C*
1458 C** ADD MANUAL INTEREST ADJUSTMENT AMOUNT
1459 C*
1460 C           ACCINT    ADD  INTA      ACCINT
     C                     Z-ADDACCINT    ACCIN2                                              235743
1461 C           AIIACD    ADD  INTA      AIIACD
     C/COPY WNCPYSRC,LE0400C031
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           ACCCOF    ADD  COFA      ACCCOF                          CAC001
     C           ACIACD    ADD  COFA      ACIACD                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           ACCNTR    ADD  INTN      ACCNTR                                              CAS005
     C           ANIACD    ADD  INTN      ANIACD                                              CAS005
     C                     ENDIF                                                              CAS005
1462 C*
1463 C           OUTMIR    TAG                             ** OUTMIR TAG *
1464 C*
1465 C** OUTPUT RECS TO S/HIUPD AND S/ACTN5
1466 C   05                SETON                     42    HISTS REC. READ
1467 C*
1468 C** FOR ACTN4 PROCESSING,SET UP FIELD FOR O/P TO HIUPD,INTST OR CUTX1
1469 C*
1470 C   12                Z-ADD0         PAMONT
1471 C   12                Z-ADDINTA      IAMONT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   12                Z-ADDCOFA      CAMONT                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN12     ANDEQ*ON                                                           CAS005
     C                     Z-ADD*ZERO     NPAMNT                                              CAS005
     C                     Z-ADDINTN      NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
1472 C   12                Z-ADD0         TAMONT 130
1473 C   12                Z-ADD0         FAMONT
1474 C   12                Z-ADD0         FEECOD  20
1475 C   12                MOVE ' '       WRTOFF  1
1476 C   12                Z-ADD0         EXVDAT  50
     C/COPY WNCPYSRC,LE0400CP19                                           S01408
1477 C*
1478 C** FOR ACTN4 PROCESSING, ONLY OUTPUT RECS. IF ACTION IND IS 'Y'
1479 C*
1480 C   12 72             GOTO INTSMI
1481 C*
1482 C   12                SETON                     4556
1483 C                     SETOF                     18    O/P AS I/P
1484 C*
1485 C                     EXSR EXCPT
1486 C*
1487 C           NHIUPD    ADD  1         NHIUPD
1488 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to allow                         MD026266
      ** output of 'CO' record to ACTN5DN.                                                  MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
1489 C*
1490 C                     Z-ADDVDAT      PHVDAT
1491 C*
1492 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE (IF NOT MATURING)
1493 C*
1494 C  N68                EXSR CREDIT
1495 C  N68 U7 U8          GOTO MIADEN                     DATABASE ERROR
1496 C*
1497 C           INTSMI    TAG                             ** INTSMI TAG *
1498 C*
1499 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
1500 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
1501 C                     Z-ADDACCINT    TINTTM 132
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
1502 C*
1503 C** OUTPUT REC. TO S/INTST IF NECESSARY
1504 C*
1505 C  N21                                                INT.HD.NOT READ
1506 COR 22                                                INT.HD.O/P
1507 CORN71                                                NOT DEMAND LOAN
1508 CORN63                GOTO CUTXMI                     NO INT PAYM'TS
1509 C*
1510 C                     SETON                     58
1511 C                     EXSR EXCPT
1512 C           NINTST    ADD  1         NINTST
1513 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO MIADEN                                                        236196
     C                     ENDIF                                                              236196
1514 C*
1515 C           CUTXMI    TAG                             ** CUTXMI TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV    1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on, if CLE031 or CEU004 are on                                    CLE031
      ** Set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52    1                       CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
1516 C*
1517 C** OUTPUT REC. TO S/CUTX1 IF NECESSARY
1518 C*
1519 C   U3                GOTO MIADEN
1520 C*
1521 C           VDAT      COMP LTVD                 30
1522 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C089
1523 C*
1524 C  N60
1525 CORN22
1526 COR 30N12
1527 COR 30 12N31          GOTO MIADEN
1528 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C*                                                                                       181859
     C**                                                                  E43236
     C* ONLY OUTPUT TO CUTX1 IF TOTAL DUE IS POSITIVE                     E43236
     C**                                                                  E43236
1529 C***********          SETON                     78                   E43236
1531 C********** PAMONT    ADD  IAMONT    SUMONT 150 78                   E43236              200707
     C           PAMONT    ADD  IAMONT    SUMONT 150 78  78                                   200707
1519 C  N78                GOTO MIADEN                                    E43236
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** do SR/SETCLX                                                                         CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
1530 C                     EXSR EXCPT
1531 C           NCUTX1    ADD  1         NCUTX1
1532 C*
1533 C           MIADEN    ENDSR                           ** MIADEN **
1534 C*
1536 C********************************************************************
1537 C*
1538 C** PRINC SUBROUTINE - TO PROCESS PRINCIPAL INCREASES
1539 C*
1540 C** CALLED BY:  HIST,ACTN
1541 C** CALLS:      OUTBVH,OUTINH,INTCAL,EXCPT,CREDIT
1542 C*
1543 C           PRINC     BEGSR                           ** PRINC **
     C*
     C** IF LOAN NOT STARTED YET,AND START DATE IS NOT WITHIN EXTRACT
     C** PERIOD,NO'ST'RECORD WILL HAVE BEEN READ.THE'PI'RECORD IS
     C** MERELY FOR CONFIRMATIONS.THEREFORE SUPRESS OUTPUT OF BV/INT
     C** HEADERS TO S/HIUPD
     C*
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTPIR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
     C     N70             SETON                     2022
1544 C*
1545 C   25N21             EXSR INTHED
1546 C*
1547 C** IF ACTION REC. IS REVERSED AND CONF. REQ'D ,O/P
1548 C** TO CONFS AS IS, AND DO NO FURTHER PROCESSING
1549 C*
1550 C   12      RECI      COMP 'R'                      61
1551 C   12 61   CNFY      COMP 'Y'                      61
1552 C   12 61NU3          SETON                     83
1553 C   12 61NU3          SETOF                     18
1554 C   12 61NU3          EXSR EXCPT
1555 C   12 61NU3NCONFS    ADD  1         NCONFS
1556 C   12 61NU3          SETOF                     83
1557 C   12 61             GOTO PRINEN
1558 C*
1559 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
1560 C*
1561 C                     EXSR OUTBVH
1562 C*
1563 C                     EXSR OUTINH
1564 C*
1565 C** PERFORM INT CALCS. IF NECESSARY
1566 C*
1567 C   23                EXSR INTCAL
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C051
     C           W#CPAM    ADD  PRAM      CPAM                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    ADD  FSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C052
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C*                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#COFD    COFD                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
     C                     ENDIF                                          CLE003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
1568 C*
1569 C** ADD PRINCIPAL INCREASE AMOUNT
1570 C*
1571 C           OSPRIN    ADD  PRAM      OSPRIN
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           NOSPRI    ADD  FSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
1572 C*
1573 C           OUTPIR    TAG                             ** OUTPIR TAG *
1574 C*
1575 C** OUTPUT RECS TO S/HIUPD AND S/ACTN5
1576 C*
1577 C   05                SETON                     42    HISTS REC. READ
1578 C*
1579 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
1580 C*
1581 C   12                Z-ADDPRAM      PAMONT
1582 C   12                Z-ADD0         IAMONT
      *                                                                                     AR790759
     C           *IN12     IFEQ '1'                                                         AR790759
     C                     ADD  PRAM      WOPRIN                                            AR790759
     C                     ENDIF                                                            AR790759
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   12                Z-ADD0         CAMONT                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN12     ANDEQ*ON                                                           CAS005
     C                     Z-ADDFSPRAM    NPAMNT                                              CAS005
     C                     Z-ADD*ZERO     NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
1583 C   12                Z-ADD0         TAMONT
1584 C   12                Z-ADD0         FAMONT
1585 C   12                Z-ADD0         FEECOD
1586 C   12                MOVE ' '       WRTOFF
1587 C   12                Z-ADD0         EXVDAT
     C/COPY WNCPYSRC,LE0400CCP6                                           S01408
1588 C*
1589 C** FOR ACTN4 PROCESSING, ONLY O/P RECS. IF ACTION IND. IS 'Y'
1590 C*
1591 C   12 72             GOTO TELXPI
1592 C*
1593 C   12                SETON                     4556
1594 C                     SETOF                     18    O/P AS I/P
1595 C*
1596 C                     EXSR EXCPT
1597 C*
1598 C           NHIUPD    ADD  1         NHIUPD
1599 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
     C/COPY WNCPYSRC,LE0400C020
1600 C*
1601 C                     Z-ADDVDAT      PHVDAT
1602 C*
1603 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
1604 C*
1605 C  N68                EXSR CREDIT
1606 C  N68 U7 U8          GOTO PRINEN                     DATABASE ERROR
     C*                                                                   091165
     C           *IN12     IFEQ '1'                                       091165
     C*                                                                   BHF499
      *                                                                   159095
      ** Part Sold Amount should not be updated when an 'PI' record being 159095
      ** processed is generated by assignment since PSAM was already      159095
      ** updated by LE2040 during I/C.                                    159095
      *                                                                   159095
     C           CLE005    IFEQ 'Y'                                       159095
     C***********GASS      ANDEQ'N'                                159095 162327
     C           GASS      ANDNE'A'                                       162327
     C           CLE005    ORNE 'Y'                                       159095
      *                                                                   159095
     C           PTYP      COMP 66                       84               BHF499
     C  N84      PTYP      COMP 67                       84               BHF499
      *                                                                   CLE005
      ** Processing types 69 and 72 are new and introduced by CLE005      CLE005
      ** for call parts sold and risk parts sold, respectively            CLE005
      *                                                                   CLE005
     C           *IN84     IFEQ '0'                                       CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE '1'       *IN84                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C           CLE004    IFEQ 'Y'                                       149915
     C                     EXSR CHKIPP                                    149915
     C                     ENDIF                                          149915
      *                                                                   159095
     C                     ENDIF                                          159095
     C*                                                                   BHF499
     C                     EXSR EXCPT                                     BHF499
     C   84      NPTSLD    ADD  1         NPTSLD                          BHF499
     C                     SETOF                         84               BHF499
     C                     END                                            091165
1607 C*
1608 C           TELXPI    TAG                             ** TELXPI TAG *
1609 C*
1610 C** PAY/RECEIVE TELEXES & CONFIRMATIONS PRODUCED FOR ACTN4 RECS. ONLY
1611 C*
1612 C   U3
1613 CORN12                GOTO INTSPI
1614 C*
1615 C           TLXY      COMP 'Y'                      82
1616 C           CNFY      COMP 'Y'                      83
1617 C*
1618 C                     SETOF                     18    O/P AS I/P
     C   82                                                               S01117
     COR 83      OSBR      IFEQ *BLANK                                    S01117
     C                     MOVE BRCA      OSBR                            S01117
     C                     END                                            S01117
      *                                                                                       CLE031
      ** If indicator 82 is on and if feature CLE031 is on                                    CLE031
      ** set work type to 'start' and do SR/SETCCY and SR/SETLLX                              CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'S'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'S'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
1619 C                     EXSR EXCPT
1620 C   82      NLETLX    ADD  1         NLETLX
1621 C   83      NCONFS    ADD  1         NCONFS
1622 C                     SETOF                     8283
1623 C*
1624 C           INTSPI    TAG                             ** INTSPI TAG *
1625 C*
1626 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
1627 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
1628 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
1629 C*
1630 C** OUTPUT REC. TO S/INTST IF NECESSARY
1631 C*
1632 C  N21                                                INT.HD.NOT READ
1633 COR 22                                                INT.HD.O/P
1634 CORN71                                                NOT DEMAND LOAN
1635 CORN63                GOTO CUTXPI                     NO INT PAYM'TS
1636 C*
1637 C                     SETON                     58
1638 C                     EXSR EXCPT
1639 C           NINTST    ADD  1         NINTST
1640 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO PRINEN                                                        236196
     C                     ENDIF                                                              236196
1641 C*
1642 C           CUTXPI    TAG                             ** CUTXPI TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV    1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETON                     78                   CLE004
      ** If indicator 78 is on and if feature CLE031 is on                                    CLE031
      ** set WTYPE to 'S' and execute SR/SETCCY and SR/SETCLX                                 CLE034
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'S'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
1643 C*
1644 C** OUTPUT REC. TO S/CUTX1 IF NECESSARY
1645 C*
1646 C   U3                GOTO PRINEN
1647 C*
1648 C           VDAT      COMP LTVD                 30
1649 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C090
1650 C*
1651 C  N60
1652 CORN22
1653 COR 30N12
1654 COR 30 12N31          GOTO PRINEN
1655 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C**                                                                  E43236
     C* ONLY OUTPUT TO CUTX1 IF TOTAL DUE IS POSITIVE                     E43236
     C**                                                                  E43236
1529 C*********************SETON*********************78                   E43236
1531 C********** PAMONT    ADD  IAMONT    SUMONT 150 78                   E43236              200707
     C           PAMONT    ADD  IAMONT    SUMONT 150 78  78                                   200707
1519 C  N78                GOTO PRINEN                                    E43236
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV    1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If indicator 78 is on and if feature CLE031 is on                                    CLE031
      ** execute SR/SETCLX only if CLE034 is disabled and Set.                                CLE034
      ** Allocation <> 'Y'.                                                                   CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
1657 C                     EXSR EXCPT
1658 C           NCUTX1    ADD  1         NCUTX1
1659 C*
1660 C           PRINEN    ENDSR                           ** PRINEN **
1661 C*
1663 C********************************************************************
1664 C*
1665 C** MANREP SUBROUTINE - TO PROCESS MANUAL REPAYMENTS
1666 C*
1667 C** CALLED BY:  HIST ACTN
1668 C** CALLS:      OUTBVH,OUTINH,INTCAL,WHTAX,EXCPT,CREDIT
1669 C*
1670 C           MANREP    BEGSR                           ** MANREP **
1671 C*
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTMRR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
1672 C   25N21             EXSR INTHED
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0400CCP1                                           S01408
     C*                                                                   S01408
1673 C*
1674 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
1675 C*
1676 C                     EXSR OUTBVH
1677 C*
1678 C                     EXSR OUTINH
1679 C*
1680 C** PERFORM INT. CALCS. IF NECESSARY
1681 C*
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
1682 C   23                EXSR INTCAL
      *                                                                                       CLE028
      ** Else, initialise subroutine output field INT and COF because it                      CLE028
      ** did not pass to INTCAL subroutine                                                    CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADD*ZERO     INT                                                 CLE028
     C                     Z-ADD*ZERO     COF                                                 CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C053
     C           W#CPAM    SUB  PRAM      CPAM                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    SUB  FSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C           W#IPRD    ADD  INTA      IPRD                            CLE003
     C/COPY WNCPYSRC,LE0400C054
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           W#COFD    ADD  COFA      COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
     C                     ENDIF                                          CLE003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#IPRN    ADD  INTN      IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
1683 C*
1684 C** SUBTRACT MR AMOUNT FROM OUTSTANDING PRINCIPAL
1685 C*
     C/COPY WNCPYSRC,LE0400C055
1686 C           OSPRIN    SUB  PRAM      OSPRIN
     C           OSPRIN    IFEQ 0                                                             245082
     C                     Z-ADDPRAM      TPRAM  130                                          245082
     C                     END                                                                245082
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           NOSPRI    SUB  FSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
      ** Subtract Interest and/or Charges Refunded if these were added                        CLE028
      ** on at start for early pay-offs of flat rate personal loans                           CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      IFEQ 'Y'                                                           CLE028
     C                     SUB  REBT      OSPRIN                                              CLE028
     C           CLE003    IFEQ 'Y'                                                           CLE028
     C           W#CPAM    SUB  REBT      CPAM                                                CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C           ADCF      IFEQ 'Y'                                                           CLE028
     C                     SUB  CHDU      OSPRIN                                              CLE028
     C           CLE003    IFEQ 'Y'                                                           CLE028
     C           W#CPAM    SUB  CHDU      CPAM                                                CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C/COPY WNCPYSRC,LE0400C056
1687 C*
1688 C** FOR ACTION RECORD, CALCULATE WITHHOLDING TAX IF INT. RATE > 0
1689 C** AND NOT ALREADY CALCULATED
1690 C*
1691 C  N12                GOTO OUTMRR
1692 C*
1693 C           INTRAT    COMP 0                    30
1694 C  N30                Z-ADD0         OPWTXA
1695 C  N30                Z-ADD0         OPTAMT
1696 C  N30                Z-ADDINTA      OPINTA
1697 C  N30                GOTO MRUPD
1698 C*
1699 C           WTXA      COMP 0                    1717
1700 C   17                Z-ADDWTXA      OPWTXA
1701 C   17                Z-ADDINTA      OPINTA
1702 C*
1703 C  N17                Z-ADDINTA      WHTINT 130
1704 C*
1705 C** IF WHT TYPE IS GROSS, CALCULATE AS THOUGH NET
1706 C*
1707 C           WHTTYP    COMP 'G'                      19
1708 C  N17                EXSR WHTAX
1709 C*
1710 C           MRUPD     TAG                             ** MRUPD TAG **
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDCOFA      OPCOFA 130                      CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDINTN      OPINTN 130                                          CAS005
     C                     ENDIF                                                              CAS005
1711 C*
1712 C** UPDATE INTEREST PAID THIS RUN
1713 C*
1714 C           INPAID    ADD  INTA      INPAID
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CFPAID    ADD  COFA      CFPAID                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           NTRPID    ADD  INTN      NTRPID                                              CAS005
     C                     ENDIF                                                              CAS005
1715 C*
1716 C** IF WHT TYPE IS GROSS,ALSO ADD WHT. AMT
1717 C*
1718 C   19      INPAID    ADD  OPWTXA    INPAID
1719 C                     SETOF                     19
1720 C*
1721 C** SET UP FIELDS FOR OUTPUT AND CALCULATE TOTAL AMOUNT
1722 C*
1723 C                     Z-ADDPRAM      OPPRAM 130
1724 C  N17      OPTAMT    ADD  OPPRAM    OPTAMT
1725 C  N17      OPTAMT    ADD  OPINTA    OPTAMT
1726 C  N17      OPTAMT    ADD  FEAM      OPTAMT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NOPPRA 130                                          CAS005
     C                     ENDIF                                                              CAS005
1727 C*
     C/COPY WNCPYSRC,LE0400CCP7                                           S01408
1728 C   17                Z-ADDTAMT      OPTAMT
1729 C*
1730 C                     MOVE ' '       OPINTC  1
1731 C*
1732 C                     SETOF                     17
1733 C*
1734 C           OUTMRR    TAG                             ** OUTMRR TAG *
1735 C*
1736 C** OUTPUT RECS. TO S/HIUPD AND S/ACTN5
1737 C*
1738 C   05                SETON                     42    HISTS REC. READ
1739 C*
1740 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
1741 C*
1742 C   12                Z-ADDOPPRAM    PAMONT
1743 C   12                Z-ADDOPINTA    IAMONT
      *                                                                                     AR790759
     C           *IN12     IFEQ '1'                                                         AR790759
     C                     SUB  OPPRAM    WOPRIN                                            AR790759
     C                     ENDIF                                                            AR790759
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   12                Z-ADDOPCOFA    CAMONT                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN12     ANDEQ*ON                                                           CAS005
     C                     Z-ADDNOPPRA    NPAMNT                                              CAS005
     C                     Z-ADDOPINTN    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
1744 C   12                Z-ADDOPWTXA    TAMONT
1745 C   12                Z-ADDFEAM      FAMONT
1746 C   12                Z-ADDFECD      FEECOD
1747 C   12                MOVE LWOI      WRTOFF
1748 C   12                Z-ADDXAVD      EXVDAT
     C/COPY WNCPYSRC,LE0400CCP8                                           S01408
1749 C*
1750 C** FOR ACTN4 PROCESSING, ONLY O/P RECS. IF ACTION IND. IS 'Y'
1751 C*
1752 C   12 72             GOTO INTSMR
      *                                                                                       CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C           *IN12     IFEQ *ON                                                           CLE134
     C           *IN72     ANDEQ*OFF                                                          CLE134
     C           ACTI      ANDEQ'C'                                                           CLE134
     C           AUTO      ANDEQ'C'                                                           CLE134
     C           NEWCOB    IFNE 'Y'                                                           CLE134
     C                     EXSR SRWLEG                                                        CLE134
     C                     ENDIF                                                              CLE134
     C                     GOTO INTSMR                                                        CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                     AR786878
     C           NEWCOB    IFEQ 'N'                                                         AR786878
     C           *IN12     IFEQ '1'                                                         AR786878
     C           *IN72     ANDEQ'0'                                                         AR786878
     C           ACTI      ANDEQ'P'                                                         AR786878
     C                     EXSR SETFLD                                                      AR786878
     C                     GOTO INTSMR                                                      AR786878
     C                     ENDIF                                                            AR786878
     C                     ENDIF                                                            AR786878
     C                     ENDIF                                                              CLE134
1753 C*
1754 C   12                SETON                     455618
      *                                                                   CLE007
     C********** CLE014    IFEQ 'N'                                                    CLE014 251331
     C********** CLE007    IFEQ 'Y'                                                    CLE007 251331
     C********** *IN12     ANDEQ'1'                                                    CLE007 251331
     C********** PAST      ANDEQ'Y'                                                    CLE007 251331
     C**********           MOVE '0'       *IN56                                        CLE007 251331
     C**********           ENDIF                                                       CLE007 251331
     C**********           ENDIF                                                       CLE014 251331
     C/COPY WNCPYSRC,LE0400C086
      *                                                                   127660
     C                     MOVE *BLANK    WOUTP   1                       127660
     C           CLE007    IFEQ 'Y'                                       127660
     C           *IN42     IFEQ '1'                                       127660
     C           *IN05     ANDEQ'1'                                       127660
     C           *IN42     OREQ '1'                                       127660
     C           *IN76     ANDEQ'1'                                       127660
     C           *IN56     OREQ '1'                                       127660
     C                     MOVE 'Y'       WOUTP                           127660
     C                     ENDIF                                          127660
     C                     ELSE                                           127660
     C                     MOVE 'Y'       WOUTP                           127660
     C                     ENDIF                                          127660
1755 C*
      ** Update repi flag                                                 194459
     C                     MOVE *BLANKS   WREPI                           194459
     C           BGN4ST    IFEQ 'Y'                                       194459
     C           LCD       ANDEQRUND                                      194459
     C           *IN68     ANDEQ*OFF                       Not maturity   194459
      *                                                                   194459
      ** Only "RE" and "IN" must be processed.                            194459
     C           AMTP      IFEQ 'RE'                                      194459
     C           AMTP      OREQ 'IN'                                      194459
     C                     EXSR OUTTOF                                    194459
     C                     ENDIF                                          194459
      *                                                                   194459
     C                     ENDIF                                          194459
      *                                                                   194459
1756 C                     EXSR EXCPT
1757 C*
     C***********CLE007    IFEQ 'Y'                                CLE007 127660
     C************IN56     ANDEQ'1'                                CLE007 127660
     C***********CLE007    OREQ 'N'                                CLE007 127660
      *                                                                   127660
     C           WOUTP     IFEQ 'Y'                                       127660
1758 C           NHIUPD    ADD  1         NHIUPD
     C                     ENDIF                                          CLE007
1759 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
1760 C*
1761 C                     Z-ADDVDAT      PHVDAT
1762 C*
1763 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING)
1764 C*
1765 C  N68                EXSR CREDIT
1766 C  N68 U7 U8          GOTO MANREN                     DATABASE ERROR
1767 C*
1768 C** OUTPUT REC. TO S/PTSLD IF NECESSARY.(ACTN4 PROCESSING ONLY).
1769 C*
1770 C  N12                GOTO INTSMR
1771 C*
      *                                                                   159095
      ** Part Sold Amount should not be updated when an 'MR' record being 159095
      ** processed is generated by assignment since PSAM was already      159095
      ** updated by LE2110 during I/C.                                    159095
      *                                                                   159095
     C           CLE005    IFEQ 'Y'                                       159095
     C***********GASS      ANDEQ'N'                                159095 162327
     C           GASS      ANDNE'A'                                       162327
     C           CLE005    ORNE 'Y'                                       159095
      *                                                                   159095
1772 C           PTYP      COMP 66                       84
1773 C  N84      PTYP      COMP 67                       84
      *                                                                   CLE005
      ** Processing types 69 and 72 are new and introduced by CLE005      CLE005
      ** for call parts sold and risk parts sold, respectively            CLE005
      *                                                                   CLE005
     C           *IN84     IFEQ '0'                                       CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE '1'       *IN84                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C           CLE004    IFEQ 'Y'                                       149915
     C                     EXSR CHKIPP                                    149915
     C                     ENDIF                                          149915
      *                                                                   159095
     C                     ENDIF                                          159095
1774 C*
1775 C                     EXSR EXCPT
1776 C   84      NPTSLD    ADD  1         NPTSLD
1777 C                     SETOF                     84
1778 C*
1779 C           INTSMR    TAG                             ** INTSMR TAG *
      *                                                                   153369
      ** Pay/Receive Telexes & Conf ACTN4 Recs. only                      153369
      *                                                                   153369
     C           *INU3     IFEQ *OFF                                      153369
     C           *IN12     ANDEQ*ON                                       153369
     C           CLE004    ANDEQ'Y'                                       153369
      *                                                                   153369
     C           TLXY      IFEQ 'Y'                                       153369
     C                     MOVE *ON       *IN82                           153369
     C                     ENDIF                                          153369
      *                                                                   153369
     C           CNFY      IFEQ 'Y'                                       153369
     C                     MOVE *ON       *IN83                           153369
     C                     ENDIF                                          153369
      *                                                                   153369
     C                     SETON                     18                   153369
      *                                                                   153369
      ** If indicator 82 is on and if feature CLE031 is on                                    CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETLLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     153369
      *                                                                   153369
     C           *IN82     IFEQ *ON                                       153369
     C                     ADD  1         NLETLX                          153369
     C                     ENDIF                                          153369
      *                                                                   153369
     C           *IN83     IFEQ *ON                                       153369
     C                     ADD  1         NCONFS                          153369
     C                     ENDIF                                          153369
      *                                                                   153369
     C                     SETOF                     8283                 153369
      *                                                                   153369
     C                     ENDIF                           *** *INU3 **** 153369
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0400CCP2                                           S01408
     C*                                                                   S01408
1780 C*
1781 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
1782 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
1783 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
1784 C*
1785 C** OUTPUT REC. TO S/INTST IF NECESSARY
1786 C*
1787 C  N21                                                INT.HD.NOT READ
1788 COR 22                                                INT.HD. O/P
1789 CORN71                                                NOT DEMAND LOAN
1790 CORN63                GOTO CUTXMR                     NO INT PAYM'TS
1791 C*
1792 C                     SETON                     58
1793 C                     EXSR EXCPT
1794 C           NINTST    ADD  1         NINTST
1795 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO MANREN                                                        236196
     C                     ENDIF                                                              236196
1796 C*
1797 C           CUTXMR    TAG                             ** CUTXMR TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on and if feature CLE031 is on                                    CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
1798 C*
1799 C** OUTPUT REC. TO S/CUTX1 IF NECESSARY
1800 C*
1801 C   U3                GOTO MANREN
1802 C*
1803 C           VDAT      COMP LTVD                 30
1804 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C091
1805 C*
1806 C  N60
1807 CORN22
1808 COR 30N12
1809 COR 30 12N31          GOTO MANREN
1810 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C**                                                                  E43236
     C* ONLY OUTPUT TO CUTX1 IF TOTAL DUE IS POSITIVE                     E43236
     C**                                                                  E43236
1529 C*********************SETON*********************78                   E43236
1531 C********** PAMONT    ADD  IAMONT    SUMONT 150 78                   E43236              200707
1531 C           PAMONT    ADD  IAMONT    SUMONT 150 78  78                                   200707
1519 C  N78                GOTO MANREN                                    E43236
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If indicator 78 is on and if feature CLE031 is on                                    CLE031
      ** execute SR/SETCLX only if CLE034 is disabled and Set.                                CLE034
      ** Allocation <> 'Y'.                                                                   CLE034
      ***do*SR/SETCCY**************************************************                CLE031 CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
1812 C                     EXSR EXCPT
1813 C           NCUTX1    ADD  1         NCUTX1
1814 C*
1815 C           MANREN    ENDSR                           ** MANREN **
1816 C*
1818 C********************************************************************
1819 C*
1820 C** INTPAY SUBROUTINE - TO PROCESS INTEREST PAYMENTS
1821 C*
1822 C** CALLED BY:  HIST,ACTN
1823 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTDUE,WHTAX,EXCPT,CREDIT
1824 C*
1825 C           INTPAY    BEGSR                           ** INTPAY **
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTINR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
1826 C   25N21             EXSR INTHED
1827 C*
1828 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
1829 C*
1830 C                     EXSR OUTBVH
1831 C*
1832 C                     EXSR OUTINH
1833 C*
1834 C** PERFORM INTEREST CALCS. IF NECESSARY
1835 C*
1836 C   23                EXSR INTCAL
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                   CLE003
     C           *IN05     IFEQ *ON                                       114542
     C/COPY WNCPYSRC,LE0400C057
     C           W#CPAM    ADD  PRAM      CPAM                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    ADD  FSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C           W#IPRD    ADD  INTA      IPRD                            CLE003
     C/COPY WNCPYSRC,LE0400C058
     C                     ENDIF                                          114542
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
      *                                                                   CLE003
     C***********INTC      IFEQ 'Y'                                CLE003 114542
     C************LIKE     DEFN CPAM      W#TOT1                   CLE003 114542
     C***********AIAP      ADD  AITC      W#TOT1                   CLE003 114542
     C***********W#TOT1    SUB  IPRD      W#TOT1                   CLE003 114542
     C***********          ADD  W#TOT1    CPAM                     CLE003 114542
     C***********          ENDIF                                   CLE003 114542
      *                                                                   CLE003
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C*                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C*                                                                   157669
     C           *IN05     IFEQ *ON                                       157669
     C           W#COFD    ADD  COFA      COFD                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C*                                                                   157669
     C                     ENDIF                                          157669
      *                                                                   CLE003
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
     C                     ENDIF                                          CLE003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN05     IFEQ *ON                                                           CAS005
     C           W#IPRN    ADD  INTN      IPRN                                                CAS005
     C                     ENDIF                                                              CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C032
1837 C*
1838 C** IF HISTS PROCESSING, ADD PRINC. AMT.
1839 C*
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN05     ANDEQ*ON                                                           CAS005
     C           NOSPRI    ADD  FSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
1840 C   05      OSPRIN    ADD  PRAM      OSPRIN
1841 C   05                GOTO OUTINR
1842 C*
1843 C** IF ACTN4 PROCESSING, ADD INTEREST DUE
1844 C*
1845 C                     EXSR QNTDUE
     C/COPY WNCPYSRC,LE0400C033
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     EXSR QCFDUE                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     EXSR SRNDUE                                                        CAS005
     C                     ENDIF                                                              CAS005
1846 C*
1847 C** IF INT. TO BE CAPITALISED, ADD TO O/S PRINC. ALSO
1848 C*
1849 C           CAPNIN    COMP 'Y'                      30
1850 C   30      OSPRIN    ADD  INTDUE    OSPRIN
1851 C           INPAID    ADD  INTDUE    INPAID
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CFPAID    ADD  COFDUE    CFPAID                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN30     IFEQ *ON                                                           CAS005
     C           NOSPRI    ADD  NTRDUE    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C           NTRPID    ADD  NTRDUE    NTRPID                                              CAS005
     C                     ENDIF                                                              CAS005
1852 C*
1853 C** CALC. WHTAX IF INT. DUE > 0
1854 C*
1855 C  N16                Z-ADD0         OPWTXA
1856 C  N16                Z-ADD0         OPTAMT
1857 C  N16                Z-ADDINTDUE    OPINTA
1858 C*
1859 C   16                Z-ADDINTDUE    WHTINT
1860 C   16                EXSR WHTAX
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0400CP22                                           S01408
      *                                                                   S01408
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDCOFDUE    OPCOFA                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDNTRDUE    OPINTN                                              CAS005
     C                     ENDIF                                                              CAS005
1861 C*
1862 C** SET UP FIELDS FOR OUTPUT
1863 C*
1864 C   30                Z-ADDOPINTA    OPPRAM
1865 C  N30                Z-ADD0         OPPRAM
1866 C   30                Z-ADD0         OPTAMT
1867 C  N30      OPTAMT    ADD  OPINTA    OPTAMT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN30     IFEQ *ON                                                           CAS005
     C                     Z-ADDOPINTN    NOPPRA                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADD*ZEROS    NOPPRA                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0400CP23                                           S01408
      *                                                                   S01408
1868 C   30                MOVE 'Y'       OPINTC
1869 C  N30                MOVE ' '       OPINTC
1870 C*
1871 C           OUTINR    TAG                             ** OUTINR TAG *
1872 C*
1873 C** OUTPUT RECS. TO S/HIUPD AND S/ACTN5
1874 C*
1875 C   05                SETON                     42    HISTS REC. READ
1876 C*
1877 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
1878 C*
1879 C   12                Z-ADDOPPRAM    PAMONT
1880 C   12                Z-ADDOPINTA    IAMONT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN12     ANDEQ*ON                                                           CAS005
     C                     Z-ADDNOPPRA    NPAMNT                                              CAS005
     C                     Z-ADDOPINTN    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           CLE003    IFEQ 'Y'                                       114542
     C           *IN12     IFEQ *ON                                       114542
     C           W#CPAM    ADD  PAMONT    CPAM                            114542
     C           W#IPRD    ADD  IAMONT    IPRD                            114542
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    ADD  NPAMNT    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C059
     C                     ENDIF                                          114542
     C                     ENDIF                                          114542
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   12                Z-ADDOPCOFA    CAMONT                          CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           *IN12     IFEQ *ON                                       157669
     C           W#COFD    ADD  CAMONT    COFD                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN12     IFEQ *ON                                                           CAS005
     C                     Z-ADDOPINTN    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           CLE003    IFEQ 'Y'                                                           CAS005
     C           *IN12     ANDEQ*ON                                                           CAS005
     C           W#IPRN    ADD  NAMONT    IPRN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
1881 C   12                Z-ADDOPWTXA    TAMONT
1882 C   12                Z-ADD0         FAMONT
1883 C   12                Z-ADD0         FEECOD
1884 C   12                MOVE ' '       WRTOFF
1885 C   12                Z-ADD0         EXVDAT
     C/COPY WNCPYSRC,LE0400CCP9                                           S01408
1886 C*
1887 C** FOR ACTN4 PROCESSING,ONLY O/P RECS.IF ACTION IND. IS 'Y'
1888 C*
1889 C   12 72             GOTO TELXIN
      *                                                                                       CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C           *IN12     IFEQ *ON                                                           CLE134
     C           *IN72     ANDEQ*OFF                                                          CLE134
     C           ACTI      ANDEQ'C'                                                           CLE134
     C           AUTO      ANDEQ'C'                                                           CLE134
     C           NEWCOB    IFNE 'Y'                                                           CLE134
     C                     EXSR SRWLEG                                                        CLE134
     C                     ENDIF                                                              CLE134
     C                     GOTO TELXIN                                                        CLE134
     C                     ENDIF                                                              CLE134
     C                     ENDIF                                                              CLE134
1890 C*
1891 C   12                SETON                     455618
1892 C*
      ** Update repi flag                                                 194459
     C                     MOVE *BLANKS   WREPI                           194459
     C           BGN4ST    IFEQ 'Y'                                       194459
     C           LCD       ANDEQRUND                       From LF/HISTS  194459
     C           *IN68     ANDEQ*OFF                       Not maturity   194459
      *                                                                   194459
      ** Only "RE" and "IN" must be processed.                            194459
     C           AMTP      IFEQ 'RE'                                      194459
     C           AMTP      OREQ 'IN'                                      194459
     C                     EXSR OUTTOF                                    194459
     C                     ENDIF                                          194459
      *                                                                   194459
     C                     ENDIF                                          194459
      *                                                                   194459
1893 C                     EXSR EXCPT
1894 C*
1895 C           NHIUPD    ADD  1         NHIUPD
1896 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
1897 C*
1898 C                     Z-ADDVDAT      PHVDAT
1899 C*
1900 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
1901 C*
1902 C  N68                EXSR CREDIT
1903 C  N68 U7 U8          GOTO INTPEN                     DATABASE ERROR
1904 C*
1905 C** OUTPUT REC. TO S/PTSLD IF NECESSARY (ACTN4 PROCESSING ONLY)
1906 C** O/P ONLY IF INT. IS CAP'D
1907 C*
1908 C  N12
1909 CORN30                GOTO TELXIN
1910 C*
1911 C           PTYP      COMP 66                       84
1912 C  N84      PTYP      COMP 67                       84
      *                                                                   CLE005
      ** Processing types 69 and 72 are new and introduced by CLE005      CLE005
      ** for call parts sold and risk parts sold, respectively            CLE005
      *                                                                   CLE005
     C           *IN84     IFEQ '0'                                       CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE '1'       *IN84                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C           CLE004    IFEQ 'Y'                                       149915
     C                     EXSR CHKIPP                                    149915
     C                     ENDIF                                          149915
1913 C*
1914 C                     EXSR EXCPT
1915 C   84      NPTSLD    ADD  1         NPTSLD
1916 C                     SETOF                     84
1917 C*
1918 C           TELXIN    TAG                             ** TELXIN TAG *
1919 C*
1920 C** PAY/RECEIVE TELEXES (ACTN4 PROCESSING ONLY)
1921 C*
1922 C   U3
1923 CORN12                GOTO INTSIN
1924 C*
1925 C           TLXY      COMP 'Y'                      82
1926 C*
1927 C** IF INT. IS CAP'D, O/P INT. AMT. IN TOTAL AMT. FIELD FOR P/R ONLY
1928 C*
1929 C   30                Z-ADDOPINTA    OPTAMT
1930 C*
1931 C                     SETON                     18
      *                                                                                       CLE031
      ** If indicator 82 is on and if feature CLE031 is on                                    CLE031
      ** Set work type to 'end' and do SR/SETCCY and SR/SETLLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
1932 C                     EXSR EXCPT
1933 C   82      NLETLX    ADD  1         NLETLX
1934 C                     SETOF                     82
1935 C*
1936 C           INTSIN    TAG                             ** INTSIN TAG *
1937 C*
1938 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
1939 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
1940 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
1941 C*
1942 C** OUTPUT REC. TO S/INTST IF NECESSARY
1943 C*
1944 C  N21                                                INT.HD.NOT READ
1945 COR 22                                                INT.HD.O/P
1946 CORN71                                                NOT DEMAND LOAN
1947 CORN63                GOTO CUTXIN                     NO INT.PAYM'TS
1948 C*
1949 C                     SETON                     58
1950 C                     EXSR EXCPT
1951 C           NINTST    ADD  1         NINTST
1952 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO INTPEN                                                        236196
     C                     ENDIF                                                              236196
1953 C*
1954 C           CUTXIN    TAG                             ** CUTXIN TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** sSet work type to 'end' and do SR/SETCCY and SR/SETCLX                               CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
1955 C*
1956 C** OUTPUT REC.TO S/CUTX1 IF NECESSARY
1957 C*
1958 C   U3                GOTO INTPEN
1959 C*
1960 C           VDAT      COMP LTVD                 30
1961 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C092
1962 C*
1963 C  N60
1964 CORN22
1965 COR 30N12
1966 COR 30 12N31          GOTO INTPEN
1967 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C**                                                                  E43236
     C* ONLY OUTPUT TO CUTX1 IF TOTAL DUE IS POSITIVE                     E43236
     C**                                                                  E43236
1529 C*********************SETON*********************78                   E43236
1531 C********** PAMONT    ADD  IAMONT    SUMONT 150 78                   E43236              200707
1531 C           PAMONT    ADD  IAMONT    SUMONT 150 78  78                                   200707
1519 C  N78                GOTO INTPEN                                    E43236
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0400C003
      *                                                                                       CLE031
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** Set work type to 'end' and do SR/SETCLX                                              CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
1969 C                     EXSR EXCPT
1970 C           NCUTX1    ADD  1         NCUTX1
     C/COPY WNCPYSRC,LE0400C004
1971 C*
1972 C           INTPEN    ENDSR                           ** INTPEN **
1973 C*
1974 C********************************************************************
1975 C********************************************************************
1976 C*
1977 C** REPAY SUBROUTINE - TO PROCESS REPAYMENTS
1978 C*
1979 C** CALLED BY:  HIST,ACTN
1980 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTDUE,WHTAX,EXCPT,CREDIT
1981 C*
1982 C           REPAY     BEGSR                           ** REPAY **
      *                                                                                       CLE154
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C                     Z-ADDREPT      REPTYP                                              CLE154
     C                     END                                                                CLE154
     C*
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTRER                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
     C** SUPRESS OUTPUT OF BV/INT HEADERS IF NO'ST'RECORD READ
     C**     (SEE PRINC SUBROUTINE)
     C*
     C     N70             SETON                     2022
1983 C*
1984 C   25N21             EXSR INTHED
1985 C*
1986 C** IF ACTION REC. IS REVERSED AND CONF. REQ'D ,O/P
1987 C** TO CONFS AS IS, AND DO NO FURTHER PROCESSING
1988 C*
1989 C   12      RECI      COMP 'R'                      61
1990 C   12 61   CNFY      COMP 'Y'                      61
1991 C   12 61NU3          SETON                     83
1992 C   12 61NU3          SETOF                     18
1993 C   12 61NU3          EXSR EXCPT
1994 C   12 61NU3NCONFS    ADD  1         NCONFS
1995 C   12 61NU3          SETOF                     83
1996 C   12 61             GOTO REPYEN
1997 C*
1998 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
1999 C*
2000 C                     EXSR OUTBVH
2001 C*
2002 C                     EXSR OUTINH
2003 C*
2004 C** PERFORM INTEREST CALCS. IF NECESSARY
2005 C*
2006 C   23                EXSR INTCAL
      *                                                                   147438
      ** For multi-currency rollover and repayment type 3, make           147438
      ** sure that repayment amount is correct                            147438
      *                                                                   147438
     C           CEU020    IFEQ 'Y'                                       147438
     C           ECIN      ANDEQ'Y'                                       147438
     C***********REPTYP    ANDEQ3                                  147438 183577
     C                     ADD  1         Y                               147438
     C                     Z-ADDOSPRIN    PRAM                            147438
     C**********           Z-ADDLNRF      ALNF,Y                                       147438 CLE148
     C                     MOVELLNRF      ALNF,Y                                              CLE148
     C                     Z-ADDVDAT      ADTE,Y                          147438
     C                     Z-ADDOSPRIN    AAMT,Y                          147438
     C                     MOVE CCY       ACCY,Y                          147438
     C                     ENDIF                                          147438
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                   CLE003
     C           *IN05     IFEQ *ON                                       114542
     C/COPY WNCPYSRC,LE0400C060
     C           W#CPAM    SUB  PRAM      CPAM                            CLE003
     C           W#IPRD    ADD  INTA      IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    SUB  FSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C061
     C                     ENDIF                                          114542
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
      *                                                                   CLE003
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C*                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C*                                                                   157669
     C           *IN05     IFEQ *ON                                       157669
     C           W#COFD    ADD  COFA      COFD                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C*                                                                   157669
     C                     ENDIF                                          157669
      *                                                                   CLE003
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
     C                     ENDIF                                          CLE003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN05     IFEQ *ON                                                           CAS005
     C           W#IPRN    ADD  INTN      IPRN                                                CAS005
     C                     ENDIF                                                              CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C                     ENDIF                                                              CAS005
2007 C*
2008 C** IF HISTS PROCESSING, SUBTRACT PRINCIPAL AMT.
2009 C*
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN05     ANDEQ*ON                                                           CAS005
     C           NOSPRI    SUB  FSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
2010 C   05      OSPRIN    SUB  PRAM      OSPRIN
     C           OSPRIN    IFEQ 0                                                             245082
     C           *IN05     ANDEQ'1'                                                           245082
     C                     Z-ADDPRAM      TPRAM  130                                          245082
     C                     END                                                                245082
2011 C   05                GOTO OUTRER
2012 C*
2013 C** ACTN4 PROCESSING - CALC.INT.DUE
2014 C*
2015 C                     EXSR QNTDUE
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     EXSR QCFDUE                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     EXSR SRNDUE                                                        CAS005
     C                     ENDIF                                                              CAS005
2016 C*
2017 C** FOR REP.TYPE 3,CALC.PRINC. AND INT. AMTS.
2018 C*
2019 C           REPTYP    COMP 2                    393738
2020 C*
     C           *IN37     IFEQ '1'                                                         AR790759
     C           *IN38     OREQ '1'                                                         AR790759
     C           PRAM      IFGT WOPRIN                                                      AR790759
     C                     Z-ADDWOPRIN    PRAM                                              AR790759
      *                                                                                     AR790759
     C           *IN37     IFEQ '1'                                                         AR790759
     C           PRAM      ADD  INTA      TAMT                                              AR790759
     C                     ELSE                                                             AR790759
     C                     Z-ADDPRAM      TAMT                                              AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
     C                     ENDIF                                                            AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
     C           CEU020    IFEQ 'Y'                                       147438
     C           ECIN      ANDEQ'Y'                                       147438
     C           *IN39     ANDEQ'1'                                       147438
     C           PRAM      ADD  INTDUE    TAMT                            147438
     C                     Z-ADDINTDUE    REINT                           147438
     C                     Z-ADDPRAM      REPRIN                          147438
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           FSPRAM    ADD  NTRDUE    NTAMT  130                                          CAS005
     C                     Z-ADDFSPRAM    NREPRI 130                                          CAS005
     C                     Z-ADDNTRDUE    RENTR  130                                          CAS005
     C                     ENDIF                                                              CAS005
     C                     ELSE                                           147438
2021 C   39      INTDUE    COMP TAMT                 17
2022 C   39N17             Z-ADDINTDUE    REINT  130
     C***********TAMT      IFEQ OSPRIN                                                BUG9251 242886
     C           TAMT      IFGE OSPRIN                                                        242886
     C           *IN39     IFEQ '1'                                                          BUG9251
     C           *IN17     ANDEQ'0'                                                          BUG9251
     C***********          Z-ADDTAMT      REPRIN                                      BUG9251 242886
     C                     Z-ADDOSPRIN    REPRIN                                              242886
     C           OSPRIN    IFGT WOPRIN                                                      AR790759
     C                     Z-ADDWOPRIN    REPRIN                                            AR790759
     C           REPRIN    ADD  REINT     TAMT                                              AR790759
     C                     ENDIF                                                            AR790759
     C********** OSPRIN    ADD  INTDUE    WRAMT  130                                 242886 AR790759
     C           REPRIN    ADD  REINT     WRAMT  130                                        AR790759
     C           WRAMT     IFGT RAMT                                                          242886
     C********** TAMT      ANDGTOSPRIN                                               242886 AR790759
     C********** TAMT      ANDGTREPRIN                                             AR790759 MD050577
     C           TAMT      ANDGEREPRIN                                                      MD050577
     C           TAMT      SUB  INTDUE    REPRIN                                              242886
     C                     ENDIF                                                              242886
     C                     ENDIF                                                             BUG9251
     C                     ELSE                                                              BUG9251
2023 C   39N17   TAMT      SUB  INTDUE    REPRIN 130
      *                                                                                     AR790759
     C           *IN39     IFEQ '1'                                                         AR790759
     C           *IN17     ANDEQ'0'                                                         AR790759
     C           REPRIN    ANDGTWOPRIN                                                      AR790759
     C                     Z-ADDWOPRIN    REPRIN                                            AR790759
     C           REINT     ADD  REPRIN    TAMT                                              AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
     C                     ENDIF                                                             BUG9251
      ***********                                                                     BUG7878 242886
      ***For*repayment type 3, if remaining principal is less than the sum            BUG7878 242886
      ***of*repayment amount and interest, do not deduct INTDUE from TAMT.            BUG7878 242886
      ***********                                                                     BUG7878 242886
     C************IN39     IFEQ '1'                                                   BUG7878 242886
     C************IN17     ANDEQ'0'                                                   BUG7878 242886
     C***********TAMT      ADD  INTDUE    WRAMT  130                                  BUG7878 242886
     C***********WRAMT     IFLT RAMT                                                  BUG7878 242886
     C***********          ADD  INTDUE    REPRIN                                      BUG7878 242886
     C***********          ENDIF                                                      BUG7878 242886
     C***********          ENDIF                                                      BUG7878 242886
2024 C   39 17             Z-ADDTAMT      REINT
2025 C   39 17             Z-ADD0         REPRIN
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN39     IFEQ *ON                                                           CAS005
     C           *IN17     ANDEQ*OFF                                                          CAS005
     C                     Z-ADDNTRDUE    RENTR                                               CAS005
     C           NTAMT     SUB  NTRDUE    NREPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN39     IFEQ *ON                                                           CAS005
     C           *IN17     ANDEQ*ON                                                           CAS005
     C                     Z-ADDNTAMT     RENTR                                               CAS005
     C                     Z-ADD*ZEROS    NREPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN39     IFEQ '1'                                                           CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     Z-ADDTAMT      REPRIN                                              CLE028
     C                     ENDIF                                                              CLE028
     C           ADCF      IFEQ 'Y'                                                           CLE028
     C           WNPY      ANDNE*ZERO                                                         CLE028
     C           CHGA      DIV  WNPY      CHDU      H                                         CLE028
     C                     ADD  CHDU      WTCHDU 130                                          CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                          147438
     C/COPY WNCPYSRC,LE0400CP10                                           S01408
      *                                                                                       CLE154
      ** If the feature is on and Repayment type is '2'                                       CLE154
      ** and INTC #' ' (INTC from Action file,                                                CLE154
      ** meaning it is an Interest Repayment Schedule)                                        CLE154
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTC      ANDNE*BLANKS                                                       CLE154
     C                     Z-ADDINTDUE    REINT                                               CLE154
     C                     END                                                                CLE154
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN39     ANDEQ'1'                                       CAC001
     C           CEU020    IFEQ 'Y'                                       157669
     C           ECIN      ANDEQ'Y'                                       157669
     C                     Z-ADDCOFDUE    RECOF                           157669
     C                     ELSE                                           157669
     C           COFDUE    IFLE TAMT                                      CAC001
     C                     Z-ADDCOFDUE    RECOF  130                      CAC001
     C                     ELSE                                           CAC001
     C                     Z-ADDTAMT      RECOF                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
2026 C*
2027 C** UPDATE O/S PRIN.& INT.PD.THIS RUN ACCORDING TO REPAYMENT TYPE
2028 C*
2029 C   37
2030 COR 38      OSPRIN    SUB  PRAM      OSPRIN
     C           OSPRIN    IFEQ 0                                                             245082
     C           *IN37     ANDEQ'1'                                                           245082
     C           OSPRIN    OREQ 0                                                             245082
     C           *IN38     ANDEQ'1'                                                           245082
     C                     Z-ADDPRAM      TPRAM  130                                          245082
     C                     END                                                                245082
2031 C   39      OSPRIN    SUB  REPRIN    OSPRIN
2032 C*
2033 C   37      INPAID    ADD  INTDUE    INPAID
2034 C   39      INPAID    ADD  REINT     INPAID
      *                                                                                       CLE154
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTC      ANDNE*BLANKS                                                       CLE154
     C           INPAID    ADD  REINT     INPAID                                              CLE154
     C                     END                                                                CLE154
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   37      CFPAID    ADD  COFDUE    CFPAID                          CAC001
     C   39      CFPAID    ADD  RECOF     CFPAID                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN37     IFEQ *ON                                                           CAS005
     C           NTRPID    ADD  NTRDUE    NTRPID                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN39     IFEQ *ON                                                           CAS005
     C           NTRPID    ADD  RENTR     NTRPID                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN37     IFEQ *ON                                                           CAS005
     C           *IN38     OREQ *ON                                                           CAS005
     C           NOSPRI    ADD  FSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2035 C*
2036 C** FOR REPAY TYPE 1,CALC.WHTAX IF INT.DUE > 0
2037 C*
2038 C  N37
2039 CORN16                Z-ADD0         OPWTXA
2040 C  N37
2041 CORN16                Z-ADD0         OPTAMT
2042 C   38                Z-ADD0         OPINTA
2043 C   39                Z-ADDREINT     OPINTA
2044 C   37N16             Z-ADDINTDUE    OPINTA
      *                                                                                       CLE154
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTC      ANDNE*BLANKS                                                       CLE154
     C                     Z-ADDREINT     OPINTA                                              CLE154
     C                     END                                                                CLE154
2045 C*
2046 C   37 16             Z-ADDINTDUE    WHTINT
2047 C   37 16             EXSR WHTAX
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   37                Z-ADDCOFDUE    OPCOFA                          CAC001
     C   38                Z-ADD0         OPCOFA                          CAC001
     C   39                Z-ADDRECOF     OPCOFA                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN37     IFEQ *ON                                                           CAS005
     C**********           Z-ADDNTRDUE    OPINTA                                      CAS005 BUG8142
     C           NTRDUE    ANDLE0                                                            BUG8142
     C                     Z-ADDNTRDUE    OPINTN                                             BUG8142
     C                     ENDIF                                                              CAS005
     C           *IN38     IFEQ *ON                                                           CAS005
     C**********           Z-ADD*ZEROS    OPINTA                                      CAS005 BUG8142
     C                     Z-ADD*ZEROS    OPINTN                                             BUG8142
     C                     ENDIF                                                              CAS005
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTC      ANDNE' '                                                           CLE154
     C                     Z-ADDNTRDUE    OPINTN                                              CLE154
     C                     END                                                                CLE154
     C           *IN39     IFEQ *ON                                                           CAS005
     C**********           Z-ADDRENTR     OPINTA                                      CAS005 BUG8142
     C                     Z-ADDRENTR     OPINTN                                             BUG8142
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2048 C*
2049 C** SET UP FIELDS FOR OUTPUT
2050 C*
2051 C   37
2052 COR 38                Z-ADDPRAM      OPPRAM
2053 C   39                Z-ADDREPRIN    OPPRAM
2054 C           OPTAMT    ADD  OPPRAM    OPTAMT
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN37     IFEQ *ON                                                           CAS005
     C           *IN38     OREQ *ON                                                           CAS005
     C                     Z-ADDFSPRAM    NOPPRA                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN39     IFEQ *ON                                                           CAS005
     C                     Z-ADDNREPRI    NOPPRA                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C005
2055 C           OPTAMT    ADD  OPINTA    OPTAMT
2056 C                     MOVE ' '       OPINTC
      *                                                                                       CLE028
      ** If Repayment type 3 and Flat rate personal loan, and add on interest                 CLE028
      ** flag is 'Y', total amount should be equal to total principal amount.                 CLE028
      ** This is because interest amount was already added on principal.                      CLE028
      ** INTA field only contains interest amount to be amortised.                            CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN39     IFEQ '1'                                                           CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     Z-ADDOPPRAM    OPTAMT                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE0400CP11                                           S01408
2057 C*
2058 C           OUTRER    TAG                             ** OUTRER TAG *
2059 C*
2060 C** OUTPUT RECS. TO S/HIUPD AND S/ACTN5
2061 C*
2062 C   05                SETON                     42    HISTS REC. READ
     C*                                                                   S01392
     C**  FOR DISC LOANS, IF AMTP = 63, AUTO SETTL IS 'Y',                S01392
     C**  REPAYMENT INT IS 0                                              S01392
     C*   Also process for types 65/67 - PP/PS                            122098
     C*                                                                   S01392
      *                                                                                       CLE134
     C                     MOVE AUTO      WAUTO   1                                           CLE134
     C           WAUTO     IFEQ 'C'                                                           CLE134
     C           CLE134    ANDEQ'Y'                                                           CLE134
     C                     MOVE 'Y'       WAUTO   1                                           CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
     C           *IN12     IFEQ '1'                                       S01392
     C           AMTP      ANDEQ'RE'                                      S01392
     C***********PTYP      ANDEQ63                                 S01392 122098
     C*********  AUTO      ANDEQ'Y'                                                    S01392 CLE134
     C           WAUTO     ANDEQ'Y'                                                           CLE134
     C           PTYP      IFEQ 63                                        122098
     C           PTYP      OREQ 65                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C           PTYP      OREQ 67                                        S01392
     C           CLE004    ANDEQ'Y'                                       138979
     C                     Z-ADD0         OPINTA                          S01392
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADD0         OPCOFA                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD*ZEROS    OPINTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   CAC001
     C                     ENDIF                                          122098
     C                     END                                            S01392
2063 C*
2064 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
2065 C*
2066 C   12                Z-ADDOPPRAM    PAMONT
2067 C   12                Z-ADDOPINTA    IAMONT
      *                                                                                     AR790759
     C           *IN12     IFEQ '1'                                                         AR790759
     C                     SUB  OPPRAM    WOPRIN                                            AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN12     ANDEQ*ON                                                           CAS005
     C                     Z-ADDNOPPRA    NPAMNT                                              CAS005
     C                     Z-ADDOPINTN    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           CLE003    IFEQ 'Y'                                       114542
     C           *IN12     IFEQ *ON                                       114542
     C           W#CPAM    SUB  PAMONT    CPAM                            114542
     C           W#IPRD    ADD  IAMONT    IPRD                            114542
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    SUB  NPAMNT    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C062
     C                     ENDIF                                          114542
     C                     ENDIF                                          114542
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   12                Z-ADDOPCOFA    CAMONT                          CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           *IN12     IFEQ *ON                                       157669
     C           W#COFD    ADD  CAMONT    COFD                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN12     IFEQ *ON                                                           CAS005
     C                     Z-ADDOPINTN    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           CLE003    IFEQ 'Y'                                                           CAS005
     C           *IN12     ANDEQ*ON                                                           CAS005
     C           W#IPRN    ADD  NAMONT    IPRN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
2068 C   12                Z-ADDOPWTXA    TAMONT
2069 C   12                Z-ADD0         FAMONT
2070 C   12                Z-ADD0         FEECOD
2071 C   12                MOVE ' '       WRTOFF
2072 C   12                Z-ADD0         EXVDAT
     C/COPY WNCPYSRC,LE0400CP12                                           S01408
2073 C*
2074 C** FOR ACTN4 PROCESSING,ONLY O/P RECS.IF ACTION IND. IS 'Y'
2075 C*
2076 C   12 72             GOTO TELXRE
      *                                                                                       CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C           *IN12     IFEQ *ON                                                           CLE134
     C           *IN72     ANDEQ*OFF                                                          CLE134
     C           ACTI      ANDEQ'C'                                                           CLE134
     C           AUTO      ANDEQ'C'                                                           CLE134
     C           NEWCOB    IFEQ 'N'                                                           CLE134
     C                     EXSR SRWLEG                                                        CLE134
     C                     ENDIF                                                              CLE134
     C                     GOTO TELXRE                                                        CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                     AR786878
     C           NEWCOB    IFEQ 'N'                                                         AR786878
     C           *IN12     IFEQ '1'                                                         AR786878
     C           *IN72     ANDEQ'0'                                                         AR786878
     C           ACTI      ANDEQ'P'                                                         AR786878
     C                     EXSR SETFLD                                                      AR786878
     C                     GOTO TELXRE                                                      AR786878
     C                     ENDIF                                                            AR786878
     C                     ENDIF                                                            AR786878
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
2077 C*
2078 C   12                SETON                     455618
2079 C*
      ** Update repi flag                                                 194459
     C                     MOVE *BLANKS   WREPI                           194459
     C           BGN4ST    IFEQ 'Y'                                       194459
     C           LCD       ANDEQRUND                       From LF/HISTS  194459
     C           *IN68     ANDEQ*OFF                       Not maturity   194459
      *                                                                   194459
      ** Only "RE" and "IN" must be processed.                            194459
     C           AMTP      IFEQ 'RE'                                      194459
     C           AMTP      OREQ 'IN'                                      194459
     C                     EXSR OUTTOF                                    194459
     C                     ENDIF                                          194459
      *                                                                   194459
     C                     ENDIF                                          194459
      *                                                                   194459
2080 C                     EXSR EXCPT
2081 C*
2082 C           NHIUPD    ADD  1         NHIUPD
2083 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2084 C*
2085 C                     Z-ADDVDAT      PHVDAT
2086 C*
2087 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
2088 C*
2089 C  N68                EXSR CREDIT
2090 C  N68 U7 U8          GOTO REPYEN                     DATABASE ERROR
2091 C*
2092 C** OUTPUT REC. TO S/PTSLD IF NECESSARY (ACTN4 PROCESSING ONLY)
2093 C*
2094 C  N12                GOTO INTSRE
2095 C*
2096 C           PTYP      COMP 66                       84
2097 C  N84      PTYP      COMP 67                       84
      *                                                                   CLE005
      ** Processing types 69 and 72 are new and introduced by CLE005      CLE005
      ** for call parts sold and risk parts sold, respectively            CLE005
      *                                                                   CLE005
     C           *IN84     IFEQ '0'                                       CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE '1'       *IN84                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C           CLE004    IFEQ 'Y'                                       149915
     C                     EXSR CHKIPP                                    149915
     C                     ENDIF                                          149915
2098 C*
2099 C                     EXSR EXCPT
2100 C   84      NPTSLD    ADD  1         NPTSLD
2101 C                     SETOF                     84
2102 C*
2103 C           TELXRE    TAG                             ** TELXRE TAG *
2104 C*
2105 C** PAY/RECEIVE TELEXES AND CONFIRMATIONS (ACTN4 PROCESSING ONLY)
2106 C*
2107 C   U3                GOTO INTSRE
2108 C*
2109 C           TLXY      COMP 'Y'                      82
     C/COPY WNCPYSRC,LE0400C006
2110 C           CNFY      COMP 'Y'                      83
2111 C*
2112 C                     SETON                     18
      *                                                                                       CLE031
      ** If indicator 82 is on and if CLE031 is on                                            CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETLLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
2113 C                     EXSR EXCPT
     C/COPY WNCPYSRC,LE0400C007
2114 C   82      NLETLX    ADD  1         NLETLX
2115 C   83      NCONFS    ADD  1         NCONFS
2116 C                     SETOF                     8283
2117 C*
2118 C           INTSRE    TAG                             ** INTSRE TAG *
2119 C*
2120 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
2121 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
2122 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
2123 C*
2124 C** OUTPUT REC. TO S/INTST IF NECESSARY
2125 C*
2126 C  N21                                                INT.HD.NOT READ
2127 COR 22                                                INT.HD.O/P
2128 CORN71                                                NOT DEMAND LOAN
2129 CORN63                GOTO CUTXRE                     NO INT.PAYM'TS
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     GOTO CUTXRE                                                        CLE028
     C                     ENDIF                                                              CLE028
2130 C*
2131 C                     SETON                     58
2132 C                     EXSR EXCPT
2133 C           NINTST    ADD  1         NINTST
2134 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO REPYEN                                                        236196
     C                     ENDIF                                                              236196
2135 C*
2136 C           CUTXRE    TAG                             ** CUTXRE TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
2137 C*
2138 C** OUTPUT REC.TO S/CUTX1 IF NECESSARY
2139 C*
2140 C   U3                GOTO REPYEN
2141 C*
2142 C           VDAT      COMP LTVD                 30
2143 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C093
2144 C*
2145 C  N60
2146 CORN22
2147 COR 30N12
2148 COR 30 12N31          GOTO REPYEN
2149 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C**                                                                  E43236
     C* ONLY OUTPUT TO CUTX1 IF TOTAL DUE IS POSITIVE                     E43236
     C**                                                                  E43236
1529 C*********************SETON*********************78                   E43236
1531 C********** PAMONT    ADD  IAMONT    SUMONT 150 78                   E43236              200707
1531 C           PAMONT    ADD  IAMONT    SUMONT 150 78  78                                   200707
1519 C  N78                GOTO REPYEN                                    E43236
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** do SR/SETCLX                                                                         CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
2151 C                     EXSR EXCPT
2152 C           NCUTX1    ADD  1         NCUTX1
     C/COPY WNCPYSRC,LE0400C034
2153 C*
2154 C           REPYEN    ENDSR                           ** REPYEN **
2155 C*
     C/COPY WNCPYSRC,LE0400C039
2156 C********************************************************************
2157 C********************************************************************
2158 C*
2159 C** SPRCHG SUBROUTINE - TO PROCESS SPREAD RATE CHANGES
2160 C*
2161 C** CALLED BY:  HIST,ACTN
2162 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTRAT,EXCPT,CREDIT
2163 C*
2164 C           SPRCHG    BEGSR                           ** SPRCHG **
     C           *IN62     IFEQ '1'                                       188115
     C                     Z-ADDRTSP      NEWSRT                          188115
     C                     ENDIF                                          188115
2165 C*
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTSCR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
2166 C   25N21             EXSR INTHED
2167 C*
2168 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
2169 C*
2170 C                     EXSR OUTBVH
2171 C*
2172 C                     EXSR OUTINH
2173 C*
2174 C** PERFORM INTEREST CALCS. IF NECESSARY
2175 C*
2176 C   23                EXSR INTCAL
2177 C*
2178 C** RELOAD SPREAD RATE AND RE-CALC.EFFECTIVE INTEREST RATE
2179 C*
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           IRCF      ANDEQ'Y'                                       CAC001
     C           BGN0ST    OREQ 'N'                                       CAC001
2180 C                     Z-ADDRTSP      SPREAD
     C                     EXSR SRNSRT                                                        CRE073
2181 C                     EXSR QNTRAT
     C                     ENDIF                                          CAC001
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C063
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C064
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDINTRAT    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
     C                     ENDIF                                          CLE003
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           FRCF      IFEQ 'Y'                                       CAC001
     C                     Z-ADDFSRP      FUNDRT                          CAC001
     C                     ENDIF                                          CAC001
     C                     EXSR QCFRAT                                    CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2182 C*
2183 C           OUTSCR    TAG                             ** OUTSCR TAG *
2184 C*
2185 C** OUTPUT RECS.TO S/HIUPD AND S/ACTN5
2186 C*
2187 C   06                SETON                     42
2188 C*
2189 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
2190 C*
2191 C   12                Z-ADD0         BRATEC
2192 C   12                Z-ADD0         BRATE
2193 C***12*****           Z-ADDRTSP      RATSPD                                              249033
     C           *IN12     IFEQ *ON                                                           249033
     C           IRCF      ANDEQ'Y'                                                           249033
     C           BGN0ST    ANDEQ'Y'                                                           255285
     C           *IN12     OREQ *ON                                                           255285
     C           BGN0ST    ANDEQ'N'                                                           255285
2193 C                     Z-ADDRTSP      RATSPD                                              249033
     C                     ENDIF                                                              249033
2194 C   12                MOVE ' '       SPINDI
2195 C   12                Z-ADD0         CALBAS  10
2196 C   12                MOVE ' '       STSTAC  1
     C           *IN12     IFEQ '1'                                       188115
     C           VDAT      ANDLTRUND                                      188115
     C                     MOVE 'Y'       BVSCHG                          188115
     C                     Z-ADDVDAT      BVSRVD                          188115
     C                     Z-ADDRATSPD    NEWSRT                          188115
     C                     ENDIF                                          188115
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN12     ANDEQ'1'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN12     ANDEQ'1'                                                           208221
     C                     Z-ADDFSRP      FUNDSP                          CAC001
     C                     MOVE FSGN      FUNDSG                          CAC001
     C                     MOVE FPRC      FUNDPC                          CAC001
     C                     MOVE IRCF      INTFLG                          CAC001
     C                     MOVE FRCF      COFFLG                          CAC001
     C                     ENDIF                                          CAC001
2197 C*
     C**
     C**    IF CHANGE IND ON RO ACTION RECORD IS BLANK USE VALUE
     C**    HELD ON CONTROL RECORD
     C**
     C   12      CHIN      COMP ' '                      30
     C   12N30             MOVE CHIN      CHGIND  1
     C   12 30             MOVE CHINA     CHGIND
2537 C*
2198 C** FOR ACTN4 PROCESSING, ONLY OUTPUT RECS. IF ACTION IND. IS 'Y'
2199 C*
2200 C   12 72             GOTO INTSSC
2201 C*
     C*****FOR*ACTN4*PROCESSING,*ONLY*OUTPUT*A*RECORD*TO*HISTORY*AND***
     C*****ACTN5*IF*SOME*ROLLOVER*DETAILS*HAVE*CHANGED.**THE*ACTION*IND
     C*****WAS*SET*TO*'Y'*ON*R/OVER*DATE*REGARDLESS*OF*CHANGED*DETAILS.
     C***12*85*************GOTO INTSRO                        E08604
2202 C   12                SETON                     4557
2203 C                     SETOF                     18    O/P AS I/P
2204 C*
2205 C                     EXSR EXCPT
2206 C*
2207 C           NHIUPD    ADD  1         NHIUPD
2208 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2209 C*
2210 C                     Z-ADDVDAT      PHVDAT
2211 C*
2212 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
2213 C*
2214 C  N68                EXSR CREDIT
2215 C  N68 U7 U8          GOTO SPRCEN                     DATABASE ERROR
2216 C*
2217 C           INTSSC    TAG                             ** INTSSC TAG *
2218 C*
2219 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
2220 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
2221 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
2222 C*
2223 C** OUTPUT REC. TO S/INTST IF NECESSARY
2224 C*
2225 C  N21                                                INT.HD.NOT READ
2226 COR 22                                                INT.HD.O/P
2227 CORN71                                                NOT DEMAND LOAN
2228 CORN63                GOTO CUTXSC                     NO INT.PAYM'TS
2229 C*
2230 C                     SETON                     59
2231 C                     EXSR EXCPT
2232 C           NINTST    ADD  1         NINTST
2233 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO SPRCEN                                                        236196
     C                     ENDIF                                                              236196
2234 C*
2235 C           CUTXSC    TAG                             ** CUTXSC TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE *IN78     DUMMYX  1                                           235743
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE DUMMYX    *IN78                                               235743
     C                     MOVE '1'       *IN79                                               235743
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
2236 C*
2237 C** OUTPUT REC.TO S/CUTX1 IF NECESSARY
2238 C*
2239 C   U3                GOTO SPRCEN
2240 C*
2241 C           VDAT      COMP LTVD                 30
2242 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C094
2243 C*
2244 C  N60
2245 CORN22
2246 COR 30N12
2247 COR 30 12N31          GOTO SPRCEN
2248 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C*                                                                                       181859
2249 C                     SETON                     79
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
2250 C                     EXSR EXCPT
2251 C           NCUTX1    ADD  1         NCUTX1
2252 C*
2253 C           SPRCEN    ENDSR                           ** SPRCEN **
2254 C*
2255 C********************************************************************
2256 C********************************************************************
2257 C*
2258 C** BRTCHG SUBROUTINE - TO PROCESS BASE RATE CHANGES
2259 C*
2260 C** CALLED BY:  HIST,ACTN
2261 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTRAT,EXCPT,CREDIT
2262 C*
2263 C           BRTCHG    BEGSR                           ** BRTCHG **
     C**                                                                  E19243
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTBRR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
     C**  FOR BACK VALUED LOANS STORE THE NEW BASE RATE                   E19243
     C**                                                                  E19243
     C   62                Z-ADDBRTE      NEWBRT                          E19243
2264 C*
2265 C** SPECIAL PROCESSING IF VAL. DATE OF REC. IS SAME AS START DATE
2266 C*
2267 C   25N21   VDAT      COMP VDATS                30
2268 C   25N21 30          EXSR INTHED
     C           VDAT      COMP VDATS                    80
2269 C*
2270 C** ACTN4 PROCESSING - IF BASE RATE TYPE ON ACTN4 REC. IS NOT
2271 C** SAME AS CURRENTLY MAINTAINED, BYPASS ALL PROCESSING
2272 C*
2273 C   12      BRTT      COMP BASECD                   30
2274 C   12 25N21BRTT      COMP BRTTS                    30
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           *IN30     ANDEQ'0'                                                           CLE036
     C           *IN12     IFEQ '1'                                                           CLE036
     C           BRTE      ANDEQBASERT                                                        CLE036
     C                     MOVE '1'       *IN30                                               CLE036
     C                     ELSE                                                               CLE036
     C                     MOVE '0'       *IN30                                               CLE036
     C                     ENDIF                                                              CLE036
     C           *IN12     IFEQ '1'                                                           CLE036
     C           *IN25     ANDEQ'1'                                                           CLE036
     C           *IN21     ANDEQ'0'                                                           CLE036
     C           BRTE      ANDEQBRTES                                                         CLE036
     C                     MOVE '1'       *IN30                                               CLE036
     C                     ELSE                                                               CLE036
     C                     MOVE '0'       *IN30                                               CLE036
     C                     ENDIF                                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
2275 C*
2276 C** SET ON INDICATOR TO ENSURE O/P OF INT. HEADER AND/OR CONTROL REC.
2277 C**                                                (PREVLN SUBR.)
2278 C*
2279 C   12N30             SETON                     15
2280 C   12N30             GOTO BRTCEN
2281 C*
2282 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
2283 C** IF PROCESSING REC. WITH VAL.DATE = START DATE,BYPASS THIS PROC'G
2284 C*
     C   80                Z-ADDBRTE      BRTES
     C           CLE003    IFEQ 'N'                                       117326
     C   80                GOTO OUTBRR
     C                     ELSE                                           117326
     C           *IN80     IFEQ *OFF                                      117326
2286 C                     EXSR OUTBVH
2287 C*
2288 C                     EXSR OUTINH
     C                     ENDIF                                          117326
     C                     ENDIF                                          117326
2289 C*
2290 C** PERFORM INTEREST CALCS. IF NECESSARY
2291 C*
2292 C   23                EXSR INTCAL
2293 C*
2294 C** RELOAD BASE RATE AND RE-CALC EFFECTIVE INTEREST RATE
2295 C*
2296 C                     Z-ADDBRTE      BASERT
     C                     EXSR SRNSRT                                                        CRE073
2297 C                     EXSR QNTRAT
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C065
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C/COPY WNCPYSRC,LE0400C066
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDINTRAT    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
     C                     ENDIF                                          CLE003
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     EXSR QCFRAT                                    CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2298 C*
2299 C           OUTBRR    TAG                             ** OUTBRR TAG *
2300 C*
2301 C** OUTPUT RECS.TO S/HIUPD AND S/ACTN5
2302 C*
2303 C   06                SETON                     42
2304 C*
2305 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
2306 C*
2307 C   12                Z-ADDBRTT      BRATEC     30
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           *IN12     ANDEQ'1'                                                           CLE036
     C           *IN30     ANDEQ'0'                                                           CLE036
     C           BRTE      ANDGT0                                                             CLE036
     C                     MOVE '1'       *IN30                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
2308 C   12 30             Z-ADDBRTE      BRATE
2309 C   12N30             Z-ADD0         BRATE
2310 C   12                Z-ADD0         RATSPD
2311 C   12                MOVE ' '       SPINDI
2312 C   12                Z-ADD0         CALBAS
2313 C   12                MOVE ' '       STSTAC
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN12     ANDEQ'1'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN12     ANDEQ'1'                                                           208221
     C                     Z-ADD0         FUNDSP                          CAC001
     C                     MOVE ' '       FUNDSG                          CAC001
     C                     MOVE FPRC      FUNDPC                          CAC001
     C                     MOVE ' '       INTFLG                          CAC001
     C                     MOVE ' '       COFFLG                          CAC001
     C                     ENDIF                                          CAC001
2314 C*
     C**  FOR BACK VALUED BASE RATE CHANGE, STORE THE VALUE DATE          E47238
     C**  AND THE NEW BASE RATE.                                          E47238
     C   12      VDAT      COMP RUND                   30                 E47238
     C   12 30             MOVE 'Y'       BVBCHG                          E47238
     C   12 30             Z-ADDVDAT      BVBRVD                          E47238
     C   12 30             Z-ADDBRATE     NEWBRT                          E47238
2315 C** IF VAL.DATE = START DATE,SET UP BASE RATE CODE AND BASE RATE
2316 C** FOR INITIALISATION DURING INTHED SUBR.
2317 C*
2318 C   12 25N21          Z-ADDBRTT      BRTTS      30
2319 C   12 25N21
2320 CAN 30                Z-ADDBRTE      BRTES
2321 C   12 25N21
2322 CANN30                Z-ADD0         BRTES
2323 C*
2324 C** FOR ACTN4 PROCESSING, ONLY OUTPUT RECS. IF ACTION IND. IS 'Y'
2325 C*
2326 C   12 72             GOTO INTSBR
2327 C*
2328 C   12                SETON                     4557
2329 C                     SETOF                     18    O/P AS I/P
2330 C*
2331 C                     EXSR EXCPT
2332 C*
2333 C           NHIUPD    ADD  1         NHIUPD
2334 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2335 C*
2336 C                     Z-ADDVDAT      PHVDAT
2337 C*
2338 C** BYPASS REST OF PROCESSING FOR REC. WITH VAL.DATE = START DATE
2339 C*
     C   80                GOTO CUTXBR
2341 C*
2342 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
2343 C*
2344 C  N68                EXSR CREDIT
2345 C  N68 U7 U8          GOTO BRTCEN                     DATABASE ERROR
2346 C*
2347 C           INTSBR    TAG                             ** INTSBR TAG *
2348 C*
2349 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
2350 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
2351 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
2352 C*
2353 C** OUTPUT REC. TO S/INTST IF NECESSARY
2354 C*
2355 C  N21                                                INT.HD.NOT READ
2356 COR 22                                                INT.HD.O/P
2357 CORN71                                                NOT DEMAND LOAN
2358 CORN63                GOTO CUTXBR                     NO INT.PAYM'TS
2359 C*
2360 C                     SETON                     59
2361 C                     EXSR EXCPT
2362 C           NINTST    ADD  1         NINTST
2363 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO BRTCEN                                                        236196
     C                     ENDIF                                                              236196
2364 C*
2365 C           CUTXBR    TAG                             ** CUTXBR TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE *IN78     DUMMYX                                              235743
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE DUMMYX    *IN78                                               235743
     C                     MOVE '1'       *IN79                                               235743
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
2366 C*
2367 C** OUTPUT REC.TO S/CUTX1 IF NECESSARY
2368 C*
2369 C   U3                GOTO BRTCEN
2370 C*
2371 C           VDAT      COMP LTVD                 30
2372 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C095
2373 C*
2374 C  N60
2375 CORN22
2376 COR 30N12
2377 COR 30 12N31          GOTO BRTCEN
2378 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C*                                                                                       181859
2379 C                     SETON                     79
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
2380 C                     EXSR EXCPT
2381 C           NCUTX1    ADD  1         NCUTX1
2382 C*
2383 C           BRTCEN    ENDSR                           ** BRTCEN **
2384 C*
2385 C********************************************************************
2386 C********************************************************************
2387 C*
2388 C** BRCCHG SUBROUTINE - TO PROCESS BASE RATE CODE CHANGES
2389 C*
2390 C** CALLED BY:  HIST,ACTN
2391 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTRAT,EXCPT,CREDIT
2392 C*
2393 C           BRCCHG    BEGSR                           ** BRCCHG **
2394 C*
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTBCR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
2395 C   25N21             EXSR INTHED
2396 C*
2397 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
2398 C*
2399 C                     EXSR OUTBVH
2400 C*
2401 C                     EXSR OUTINH
2402 C*
2403 C** PERFORM INTEREST CALCS. IF NECESSARY
2404 C*
2405 C   23                EXSR INTCAL
2406 C*
     C**  OVERRIDE THE BASE RATE IN HISTORY IF BASE RATE CHANGE TODAY     E47238
     C**  IS BACK-VALUED TO THE BASE RATE CODE CHANGE DATE.               E47238
     C  N12      BVBCHG    COMP 'Y'                      30               E47238
     C  N12 30   VDAT      COMP BVBRVD               30  30               E47238
     C  N12 30             Z-ADDNEWBRT    BRTE                            E47238
2407 C** RELOAD BASE RATE CODE AND BASE RATE AND RE-CALC.EFFECTIVE INT.RT.
2408 C*
2409 C                     Z-ADDBRTT      BASECD
2410 C                     Z-ADDBRTE      BASERT
     C                     EXSR SRNSRT                                                        CRE073
2411 C                     EXSR QNTRAT
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C067
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C068
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDINTRAT    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                         If action     172807
     C                     Z-ADD*ZERO     CPAM              zeroise CPAM  172807
     C                     Z-ADD*ZERO     INTR              zeroise INTR  172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                            End If.       172807
     C                     ENDIF                                          CLE003
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     EXSR QCFRAT                                    CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2412 C*
2413 C           OUTBCR    TAG                             ** OUTBCR TAG *
2414 C*
2415 C** OUTPUT RECS.TO S/HIUPD AND S/ACTN5
2416 C*
2417 C   06                SETON                     42
2418 C*
2419 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
2420 C*
2421 C   12                Z-ADDBRTT      BRATEC     30
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           *IN12     ANDEQ'1'                                                           CLE036
     C           *IN30     ANDEQ'0'                                                           CLE036
     C           BRTE      ANDGT0                                                             CLE036
     C                     MOVE '1'       *IN30                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
2422 C   12 30             Z-ADDBRTE      BRATE
2423 C   12N30             Z-ADD0         BRATE
2424 C   12                Z-ADD0         RATSPD
2425 C   12                MOVE ' '       SPINDI
2426 C   12                Z-ADD0         CALBAS
2427 C   12                MOVE ' '       STSTAC
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN12     ANDEQ'1'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN12     ANDEQ'1'                                                           208221
     C                     Z-ADD0         FUNDSP                          CAC001
     C                     MOVE ' '       FUNDSG                          CAC001
     C                     MOVE FPRC      FUNDPC                          CAC001
     C                     MOVE ' '       INTFLG                          CAC001
     C                     MOVE ' '       COFFLG                          CAC001
     C                     ENDIF                                          CAC001
2428 C*
     C**   FOR BACK VALUED BASE RATE CODE CHANGE, STORE THE VALUE DATE    E47238
     C**   AND THE NEW BASE RATE.                                         E47238
     C   12      VDAT      COMP RUND                   30                 E47238
     C   12 30             MOVE 'Y'       BVBCHG                          E47238
     C   12 30             Z-ADDVDAT      BVBRVD                          E47238
     C   12 30             Z-ADDBRATE     NEWBRT                          E47238
      *                                                                                       198585
     C           *IN12     IFEQ '1'                                                           198585
     C           *IN30     ANDEQ'1'                                                           198585
     C                     MOVE BRATEC    NEWBRC                                              198585
     C                     ENDIF                                                              198585
      *                                                                                       198585
2429 C** FOR ACTN4 PROCESSING, ONLY OUTPUT RECS. IF ACTION IND. IS 'Y'
2430 C*
2431 C   12 72             GOTO INTSBC
2432 C*
2433 C   12                SETON                     4557
2434 C                     SETOF                     18    O/P AS I/P
2435 C*
2436 C                     EXSR EXCPT
2437 C*
2438 C           NHIUPD    ADD  1         NHIUPD
2439 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2440 C*
2441 C                     Z-ADDVDAT      PHVDAT
2442 C*
2443 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
2444 C*
2445 C  N68                EXSR CREDIT
2446 C  N68 U7 U8          GOTO BRCCEN                     DATABASE ERROR
2447 C*
2448 C           INTSBC    TAG                             ** INTSBC TAG *
2449 C*
2450 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
2451 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
2452 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
2453 C*
2454 C** OUTPUT REC. TO S/INTST IF NECESSARY
2455 C*
2456 C  N21                                                INT.HD.NOT READ
2457 COR 22                                                INT.HD.O/P
2458 CORN71                                                NOT DEMAND LOAN
2459 CORN63                GOTO CUTXBC                     NO INT.PAYM'TS
2460 C*
2461 C                     SETON                     59
2462 C                     EXSR EXCPT
2463 C           NINTST    ADD  1         NINTST
2464 C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO BRCCEN                                                        236196
     C                     ENDIF                                                              236196
2465 C*
2466 C           CUTXBC    TAG                             ** CUTXBC TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE *IN78     DUMMYX                                              235743
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE DUMMYX    *IN78                                               235743
     C                     MOVE '1'       *IN79                                               235743
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
2467 C*
2468 C** OUTPUT REC.TO S/CUTX1 IF NECESSARY
2469 C*
2470 C   U3                GOTO BRCCEN
2471 C*
2472 C           VDAT      COMP LTVD                 30
2473 C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C096
2474 C*
2475 C  N60
2476 CORN22
2477 COR 30N12
2478 COR 30 12N31          GOTO BRCCEN
2479 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C*                                                                                       181859
2480 C                     SETON                     79
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
2481 C                     EXSR EXCPT
2482 C           NCUTX1    ADD  1         NCUTX1
2483 C*
2484 C           BRCCEN    ENDSR                           ** BRCCEN **
2485 C*
2486 C********************************************************************
2487 C********************************************************************
2488 C*
2489 C** ROLL SUBROUTINE - TO PROCESS ROLLOVERS
2490 C*
2491 C** CALLED BY:  HIST,ACTN
2492 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTRAT,EXCPT,CREDIT
2493 C*
2494 C           ROLL      BEGSR                           ** ROLL **
     C/COPY WNCPYSRC,LE0400C001
2495 C*
     C           *IN62     IFEQ '1'                                                           192997
     C                     Z-ADDRTSP      NEWSRT                                              192997
     C                     Z-ADDBRTE      NEWBRT                                              192997
     C                     ENDIF                                                              192997
      *                                                                                       192997
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO OUTROR                                                        236196
     C                     ENDIF                                                              236196
      *                                                                                       236196
2496 C   25N21             EXSR INTHED
     C/COPY WNCPYSRC,LE0400C010
2497 C*
2498 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
2499 C*
2500 C                     EXSR OUTBVH
2501 C*
2502 C                     EXSR OUTINH
      *                                                                                     MD028338
      ** When record read is from ACTN3DK, retrieve FX Rate Chg Ind on                      MD028338
      ** change of loan. Skip interest computation for rollover with                        MD028338
      ** FX Rate Chg Only = Y.                                                              MD028338
      *                                                                                     MD028338
     C           *IN12     IFEQ *ON                                                         MD028338
     C           LNRF      ANDNEPRLOAN                                                      MD028338
     C                     MOVE LNRF      PRLOAN  6                                         MD028338
     C                     MOVE 'B'       RCDT                                              MD028338
     C           WWLOAN    CHAINCLOAN               N26                                     MD028338
     C                     ENDIF                                                            MD028338
      *                                                                                     MD028338
     C                     MOVE 'N'       WFXCHG                                            MD028338
     C           *IN06     IFEQ *ON                                                         MD028338
     C           FRCO      ANDEQ'Y'                                                         MD028338
     C           *IN12     OREQ *ON                                                         MD028338
     C           WFRCOK    ANDEQ'Y'                                                         MD028338
     C                     MOVE 'Y'       WFXCHG                                            MD028338
     C                     MOVE 'Y'       WFXFLG                                            MD028338
     C                     MOVE *ON       *IN73                                             MD028338
     C                     ENDIF                                                            MD028338
2503 C*
2504 C** PERFORM INTEREST CALCS. IF NECESSARY
2505 C*
2506 C   23                EXSR INTCAL
     C                     MOVE *OFF      *IN73                                             MD028338
2507 C*
     C** OVERRIDE THE BASE RATE IN HISTORY IF BASE RATE CHANGE TODAY      E47238
     C** IS BACK-VALUED TO THE ROLLOVER DATE.                             E47238
     C           CLE003    IFEQ 'N'                                       131863
     C  N12      BVBCHG    COMP 'Y'                      30               E47238
     C  N12 30   VDAT      COMP BVBRVD               30  30               E47238
     C  N12 30             Z-ADDNEWBRT    BRTE                            E47238
     C                     MOVE 'N'       @RLOAD  1                       188115
     C           *IN12     IFEQ '0'                                       188115
     C           BVSCHG    ANDEQ'Y'                                       188115
     C           VDAT      ANDGEBVSRVD                                    188115
     C                     MOVE 'Y'       @RLOAD                          188115
     C                     Z-ADDNEWSRT    RTSP                            188115
     C                     ENDIF                                          188115
     C                     ENDIF                                          131863
2508 C** RELOAD BASE RATE CODE,BASE RATE,SPREAD,SPREAD INDICATOR AND CALC.
2509 C** BASIS, AND RE-CALC.EFFECTIVE INTEREST RATE IF NEW CALC.BASIS IS
2510 C** NOT ZERO.
     C** ALSO RE-CALC. EFFECTIVE INTEREST RATE FOR BACK-VALUED BASE       E47238
     C** RATE CHANGE EVEN NEW CALC. BASIS = 0.                            E47238
2511 C*
2512 C           CALC      COMP 0                        85
     C  N12 30 85          Z-ADDBRTE      BASERT                          E47238
     C           @RLOAD    IFEQ 'Y'                                       188115
     C           *IN85     ANDEQ'1'                                       188115
     C                     Z-ADDRTSP      SPREAD                          188115
     C                     ENDIF                                          188115
     C**N12*30*85          EXSR QNTRAT                             E47238 188115
     C           *IN12     IFEQ '0'                                       188115
     C           *IN30     ANDEQ'1'                                       188115
     C           *IN85     ANDEQ'1'                                       188115
     C           @RLOAD    OREQ 'Y'                                       188115
     C           *IN85     ANDEQ'1'                                       188115
     C                     EXSR SRNSRT                                                        CRE073
     C                     EXSR QNTRAT                                    188115
     C                     ENDIF                                          188115
      *                                                                                       205583
     C           SPRIND    IFEQ *BLANK                                                        205583
     C                     MOVE 'A'       SPRIND                                              205583
     C                     ENDIF                                                              205583
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                   CLE003
     C/COPY WNCPYSRC,LE0400C069
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C070
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
      *                                                                   CLE003
     C***********SPIN      IFNE ' '                                CLE003 128059
     C           RTSP      IFNE 0                                         128059
     C           BRTT      ORNE 0                                         114542
     C           BRTE      ORNE 0                                         114542
     C                     Z-ADDBRTT      BASECD                          CLE003
     C                     Z-ADDBRTE      BASERT                          CLE003
     C                     Z-ADDRTSP      SPREAD                          CLE003
     C                     MOVE SPIN      SPRIND                          CLE003
     C           SPRIND    IFEQ *BLANK                                    128059
     C                     MOVE 'A'       SPRIND                          128059
     C                     ENDIF                                          128059
     C                     EXSR SRNSRT                                                        CRE073
     C                     EXSR QNTRAT                                    114542
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C           CALC      IFNE 0                                         CLE003
     C                     Z-ADDCALC      ICALCB                          CLE003
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C                     Z-ADDINTRAT    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
      *                                                                   CLE003
      * If CLE003 is off, zeroise CPAM & INTR fields for this action.     172807
     C                     ELSE                            CLE003 is off. 172807
     C           *IN12     IFEQ *ON                        If action      172807
     C                     Z-ADD*ZERO     CPAM                            172807
     C                     Z-ADD*ZERO     INTR                            172807
     C                     Z-ADD*ZERO     FSCPAM                                              CAS005
     C                     ENDIF                                          172807
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
2513 C   85                GOTO OUTROR
2514 C*
2515 C                     Z-ADDBRTT      BASECD
2516 C                     Z-ADDBRTE      BASERT
2517 C                     Z-ADDRTSP      SPREAD
     C           SPIN      IFEQ *BLANK                                                        205583
     C                     MOVE 'A'       SPRIND                                              205583
     C                     ELSE                                                               205583
2518 C                     MOVE SPIN      SPRIND
     C                     ENDIF                                                              205583
2519 C                     Z-ADDCALC      ICALCB
     C                     EXSR SRNSRT                                                        CRE073
2520 C                     EXSR QNTRAT
2521 C*
2522 C           OUTROR    TAG                             ** OUTROR TAG *
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C********** FPRC      IFEQ *BLANKS                                                CAC001 204786
     C           FPRC      IFNE *BLANKS                                                       204786
     C           FSRP      ANDEQ*ZEROS                                                        204786
     C                     MOVE '1'       *IN26                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN26                           CAC001
     C                     Z-ADDFSRP      FUNDRT                          CAC001
     C                     MOVE FSGN      FUNDSN                          CAC001
     C                     MOVE FPRC      FUNPRF                          CAC001
     C                     ENDIF                                          CAC001
     C                     EXSR QCFRAT                                    CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2523 C*
2524 C** OUTPUT RECS.TO S/HIUPD AND S/ACTN5
2525 C*
2526 C   06                SETON                     42
2527 C*
2528 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
2529 C*
2530 C   12                Z-ADDBASECD    BRATEC     30
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           *IN12     ANDEQ'1'                                                           CLE036
     C           *IN30     ANDEQ'0'                                                           CLE036
     C           BASERT    ANDGT0                                                             CLE036
     C                     MOVE '1'       *IN30                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
2531 C   12 30             Z-ADDBASERT    BRATE
2532 C   12N30             Z-ADD0         BRATE
2533 C   12                Z-ADDSPREAD    RATSPD
2534 C   12                MOVE SPRIND    SPINDI
2535 C   12                Z-ADDICALCB    CALBAS
2536 C   12                MOVE ' '       STSTAC
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN12     ANDEQ'1'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN12     ANDEQ'1'                                                           208221
     C                     Z-ADDFUNDRT    FUNDSP                          CAC001
     C                     MOVE FUNDSN    FUNDSG                          CAC001
     C                     MOVE FUNPRF    FUNDPC                          CAC001
     C                     MOVE ' '       INTFLG                          CAC001
     C                     MOVE ' '       COFFLG                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   S01392
     C**   UPDATE PRINC. ON S/HISTS HDR                                   S01392
     C*                                                                   S01392
     C           *IN12     IFEQ '1'                                       S01392
     C           PTYP      IFEQ 63                                        S01392
     C           PTYP      OREQ 65                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C           PTYP      OREQ 67                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C***********OSPRIN    SUB  PRAM      OSPRIN                    S01392126030
     C***********          Z-ADDOSPRIN    PRINRO 130                S01392126030
     C           OSPRIN    IFEQ 0                                                             245082
     C                     Z-ADDPRAM      TPRAM                                               245082
     C                     END                                                                245082
     C                     Z-ADDPRAM      OSPRIN                          126030
     C                     Z-ADDPRAM      PRINRO 130                      126030
     C                     Z-ADDINTA      DISCRO 130                      S01392
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ELSE                                           S01392
     C                     Z-ADD0         PRINRO                          S01392
     C                     Z-ADD0         DISCRO                          S01392
     C                     END                                            S01392
     C                     ELSE                                           126030
     C           PTYP      IFEQ 63                                        126030
     C                     Z-ADDPRINRO    OSPRIN                          126030
     C                     END                                            126030
     C                     END                                            S01392
      *                                                                                       CLE031
      ** If CLE031 is on AND the principal amount is not zero                                 CLE031
      ** AND the currency principal amount is not zero then set                               CLE031
      ** OSPRIN and PRINRO to be the equal to the principal amount                            CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           *IN12     ANDEQ'1'                                                           225656
     C           PRAM      ANDNE*ZEROS                                                        CLE031
     C           WFPAM     ANDNE*ZEROS                                                        CLE031
     C                     Z-ADDPRAM      OSPRIN                                              CLE031
     C                     Z-ADDPRAM      PRINRO                                              CLE031
     C                     Z-ADDPRAM      CPAM                                                225656
     C                     ENDIF                                                              CLE031
     C           CLE031    IFEQ 'Y'                                                           225656
     C           *IN06     ANDEQ'1'                                                           225656
     C           PRINRO    ANDNE*ZEROS                                                        225656
     C           WFPAM     ANDNE*ZEROS                                                        225656
     C                     Z-ADDPRINRO    OSPRIN                                              225656
     C                     Z-ADDPRINRO    CPAM                                                225656
     C                     ENDIF                                                              225656
      *                                                                                       CLE031
     C**
     C**    IF CHANGE IND ON RO ACTION RECORD IS BLANK USE VALUE
     C**    HELD ON CONTROL RECORD
     C**
     C   12      CHIN      COMP ' '                      30
     C   12N30             MOVE CHIN      CHGIND  1
     C   12 30             MOVE CHINA     CHGIND
2537 C*
2538 C** FOR ACTN4 PROCESSING, ONLY OUTPUT RECS. IF ACTION IND. IS 'Y'
2539 C*
2540 C   12 72             GOTO INTSRO
2541 C*
     C*
     C*
2542 C   12                SETON                     4557
2543 C                     SETOF                     18    O/P AS I/P
2544 C*
2545 C                     EXSR EXCPT
2546 C*
2547 C           NHIUPD    ADD  1         NHIUPD
2548 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
     C/COPY WNCPYSRC,LE0400C021
2549 C*
2550 C                     Z-ADDVDAT      PHVDAT
2551 C*
2552 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
2553 C*
2554 C  N68                EXSR CREDIT
2555 C  N68 U7 U8          GOTO ROLLEN                     DATABASE ERROR
2556 C*
2557 C           INTSRO    TAG                             ** INTSRO TAG *
2558 C*
2559 C                     SETOF                     85
     C                     SETOF                     26                   CAC001
     C**                                                                  S01392
     C**   PAY/RECEIVE TELEXES                                            S01392
     C**                                                                  S01392
     C           *IN12     IFEQ '1'                                       S01392
     C           *INU3     ANDNE'1'                                       S01392
     C           TLXY      IFEQ 'Y'                                       S01392
     C                     SETON                         82               S01392
     C                     END                                            S01392
      *                                                                                       CLE031
      ** If feature CLE031 is on, the principal amount is not zero                            CLE031
      ** and facility currency principal amount on CLOANCL is not zero                        CLE031
      ** set indicator 82 on in order to get a telex produced                                 CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PRAM      ANDNE*ZEROS                                                        CLE031
     C           WFPAM     ANDNE*ZEROS                                                        CLE031
     C                     SETON                         82                                   CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     SETOF                         18                                   S01392
      *                                                                                       CLE031
      ** If indicator 82 is on and if CLE031 is on                                            CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETLLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE   1                                           CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     S01392
     C           *IN82     IFEQ '1'                                       S01392
     C           NLETLX    ADD  1         NLETLX                          S01392
     C                     END                                            S01392
     C                     SETOF                         82               S01392
     C                     END                                            S01392
2560 C*
2561 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
2562 C*
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
2563 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
2564 C*
2565 C** OUTPUT REC. TO S/INTST IF NECESSARY
2566 C*
2567 C  N21                                                INT.HD.NOT READ
2568 COR 22                                                INT.HD.O/P
2569 CORN71                                                NOT DEMAND LOAN
2570 CORN63                GOTO CUTXRO                     NO INT.PAYM'TS
2571 C*
2572 C                     SETON                     59
     C                     EXSR EXCPT
     C           NINTST    ADD  1         NINTST
     C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO ROLLEN                                                        236196
     C                     ENDIF                                                              236196
     C*
     C           CUTXRO    TAG                             ** CUTXRO TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE *IN78     DUMMYX                                              235743
     C                     SETON                     78                   CLE004
      *                                                                                       CLE031
      ** If indicator 78 is on, if CLE031 is on                                               CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE DUMMYX    *IN78                                               235743
     C                     MOVE '1'       *IN79                                               235743
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0400C011
     C*
     C** OUTPUT REC.TO S/CUTX1 IF NECESSARY
     C*
     C   U3                GOTO ROLLEN
     C*
     C           VDAT      COMP LTVD                 30
     C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C097
     C*
     C  N60
     CORN22
     COR 30N12
     COR 30 12N31          GOTO ROLLEN
     C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C*                                                                                       181859
     C                     SETON                     79
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     EXSR EXCPT
     C           NCUTX1    ADD  1         NCUTX1
     C*
     C           ROLLEN    ENDSR                           ** ROLLEN **
     C*
     C********************************************************************
     C/EJECT                                                              S01270
     C*****************************************************************   S01270
     C*                                                               *   S01270
     C*   Loan Sub-Type SubRoutine                                    *   S01270
     C*   ~    ~           ~    ~        ~  ~                         *   S01270
     C*   MCLSSR SUBROUTINE - TO PROCESS LOAN SUBTYPE CHANGE EVENTS   *   S01270
     C*                                                               *   S01270
     C*    CALLED BY   :  ACTN                                        *   S01270
     C*    CALLS       :  OUTBVH,OUTINH,EXCPT,CREDIT                  *   S01270
     C*    FLAGS USED  :  MCFLAG                                      *   S01270
     C*                                                               *   S01270
     C*****************************************************************   S01270
     C*                                                                   S01270
     C           MCLSSR    BEGSR                                          S01270
     C*                                                                   S01270
     C**   OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY         S01270
     C*                                                                   S01270
     C                     EXSR OUTBVH                                    S01270
     C*                                                                   S01270
     C                     EXSR OUTINH                                    S01270
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C                     MOVE '1'       *IN73                                               212318
     C   23                EXSR INTCAL                                    CLE003
     C                     MOVE '0'       *IN73                                               212318
     C                     MOVE LTYP      LONTYP                                              227657
     C                     MOVE SUTP      SUBTYP                                              227657
     C                     EXSR QNTRAT                                    CLE003
     C/COPY WNCPYSRC,LE0400C071
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C072
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C********** *IN23     IFEQ *ON                                                    114542 186070
     C********** W#AITC    ADD  INT       AITC      H                                  114244 186070
     C**********           ELSE                                                        114542 186070
     C           *IN23     IFEQ *ON                                                           208584
     C           W#AITC    ADD  INT       AITC      H                                         208584
     C                     ELSE                                                               208584
     C                     Z-ADDW#AITC    AITC                            114542
     C**********           ENDIF                                                       114542 186070
     C**********           Z-ADDINTRAT    INTR                                         CLE003 186070
     C**********           Z-ADDW#INTR    INTR                                         186070 208584
     C                     ENDIF                                                              208584
     C                     Z-ADDINTRAT    INTR                                                208584
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C                     ENDIF                                          CLE003
     C*                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           CLE003    IFEQ 'Y'                                       157669
     C                     EXSR QCFRAT                                    157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          157669
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   S01270
     C**   ONLY PROCEED WITH THE REST OF THE S/R IF ACTION IND = 'Y'      S01270
     C**   FOR ACTN4 PROCESSING, SETUP FIELDS FOR O/P TO HIUPDHP          S01270
     C**   OR TO HIUPDHQ ACCORDING TO AMEND TYPE                          S01270
     C*                                                                   S01270
     C           ACTI      IFEQ 'Y'                                       S01270
     C           *IN12     ANDEQ'1'                        ACTION RECD    046647
     C*                                                                   S01270
     C**   SO SETUP FIELDS FOR HIUPDHP ACCORDINGLY...                     S01270
     C*                                                                   S01270
     C                     Z-ADDPRAM      PAMONT                          S01270
     C                     Z-ADDINTA      IAMONT                          S01270
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDCOFA      CAMONT                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     Z-ADDWTXA      TAMONT                          S01270
     C                     Z-ADDFEAM      FAMONT                          S01270
     C                     Z-ADDFECD      FEECOD                          S01270
     C                     MOVE WOIN      WRTOFF                          S01270
     C                     Z-ADDEXVD      EXVDAT                          S01270
     C*                                                                   S01270
     C*****ADD*THE*PRINCIPAL*AMOUNT*TO*WORK*FIELD*AND*EXECUTE*THE***S01270100677
     C*****CREDIT*SUBROUTINE*TO*CHECK*IF*THAT*AMOUNT*IS*NEGATIVE,***S01270100677
     C**   EXECUTE THE CREDIT S/R TO CHECK O/S PRINCIPAL AMOUNT IS -VE    100677
     C**   IF IT IS THEN THE CREDIT SUBROUTINE WILL OUTPUT A LINE TO      S01270
     C**   THE EXCEPTION REPORT GIVING DETAILS OF THE PRINCIPAL AMOUNT    S01270
     C**   AND THE OUTSTANDING PRINCIPAL.                                 S01270
     C*                                                                   S01270
     C**   THIS IS DONE FOR ALL LOANS EXCEPT DISCOUNTED LOANS             S01270
     C**   REPRESENTED BY *IN67 BEING OFF                                 S01270
     C*                                                                   S01270
     C           *IN67     IFEQ '0'                                       S01270
     C*                                                                   S01270
     C***********          Z-ADDPRAM      OSPRIN                    S01270100677
     C                     EXSR CREDIT                                    S01270
     C*                                                                   S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C**   UPON RETURN FROM CREDIT SUBROUTINE CHECK THE DATABASE ERROR    S01270
     C**   INDICATORS, IF THEY ARE ON THEN NO UPDATES ARE DONE TO ANY     S01270
     C**   FILES AND THE REST OF THE PROCESSING IS OMMITTED.              S01270
     C*                                                                   S01270
     C           *INU7     IFEQ '0'                                       S01270
     C           *INU8     ANDEQ'0'                                       S01270
     C*                                                                   S01270
     C**   SO PROVIDING NO DATABASE ERROR HAS OCCURRED....                S01270
     C**   OUTPUT RECS. ONLY IF ACTION IND. IS 'Y'. OUTPUT                S01270
     C**   'LS' RECORD TO HIUPDHP(56), AND ACTN5DK(45).                   S01270
     C**   ( )=INDICATOR ON                                               S01270
     C*                                                                   S01270
     C                     MOVE '1'       *IN45                           S01270
     C                     MOVE '1'       *IN56                           S01270
     C*                                                                   046647
     C**  ADD 1 TO BOTH OF THE RECORD COUNTS, AND SET ON INDICATOR        046647
     C**  24 TO SHOW THAT AT LEAST ONE RECORD HAS BEEN WRITTEN TO         046647
     C**  ACTION 5 FILE...                                                046647
     C*                                                                   046647
     C                     ADD  1         NACTN5                          046647
     C                     SETON                     24                   046647
     C*                                                                   046647
     C**  END STATEMENT FOR ACTI  'IF' STATEMENT...                       046647
     C*                                                                   046647
     C                     END                                            046647
     C*  Last END moved to ensure that the record is output whether it    100594
     C*  is read from the action or the history file                      100594
     C                     END                                            100594
     C*                                                                   046647
     C           *IN05     IFEQ '1'                        HIST RECORD    046647
     C                     SETON                     42                   046647
     C                     END                                            046647
     C*                                                                   S01270
     C**  SET OFF INDICATOR 18 SO THE OUTPUT TO RECORDS SAME AS INPUT     S01270
     C*                                                                   S01270
     C                     SETOF                     18                   S01270
     C/COPY WNCPYSRC,LE0400C103
     C                     EXSR EXCPT                                     S01270
     C/COPY WNCPYSRC,LE0400C104
     C*                                                                   S01270
     C                     ADD  1         NHIUPD                          S01270
     C           *IN25     IFEQ '0'                                       134114
     C                     Z-ADDVDAT      PHVDAT                          S01270
     C                     END                                            134114
     C*                                                                   S01270
     C****END*STATEMENT*FOR*DBERROR**'IF'*STATEMENT...***           S01270100594
     C***********                                                   S01270100594
     C***********          END                                      S01270100594
     C*                                                                   S01270
     C           MCLSS9    ENDSR                                          S01270
     C*                                                                   S01270
     C********************************************************************S01270
     C/EJECT                                                              S01270
2598 C********************************************************************
2599 C*
2600 C** STACC SUBROUTINE - TO PROCESS STOP/START ACCRUALS RECORDS
2601 C*
2602 C** CALLED BY:  HIST,ACTN
2603 C** CALLS:      OUTBVH,OUTINH,INTCAL,EXCPT,CREDIT
2604 C*
2605 C           STACC     BEGSR                           ** STACC **
2606 C*
     C           INTST     IFNE '1'                                                           236196
      *                                                                                       236196
2607 C   25N21             EXSR INTHED
2608 C*
2609 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
2610 C*
2611 C                     EXSR OUTBVH
2612 C*
2613 C                     EXSR OUTINH
2614 C*
2615 C** PERFORM INTEREST CALCS. IF NECESSARY
2616 C*
      ** Test first if stop accrual is valued today.  If it is                                251009
      ** then compute for the interest upto SA value date.                                    251009
      *                                                                                       251009
     C           *IN06     IFEQ '1'                                                           251009
     C           STAI      ANDEQ'Y'                                                           251009
     C           STAIND    OREQ 'Y'                                                           251009
     C           STAIND    IFEQ 'Y'                                                           251009
     C                     TESTB'3'       LONI       23                                       251009
     C                     ENDIF                                                              251009
     C           *IN06     IFEQ '1'                                                           251009
     C           STAI      ANDEQ'Y'                                                           251009
     C                     MOVE '1'       *IN23                                               251009
     C                     ENDIF                                                              251009
     C**********           ELSE                                                      251009 AR679419
     C**********           Z-ADDVDAT      LVDAT                                      251009 AR679419
     C                     ENDIF                                                              251009
      *                                                                                       251009
2617 C   23                EXSR INTCAL
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C073
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C**********           Z-ADDW#CPAM    CPAM                                         CAS005 242139
     C                     Z-ADDW#FSCP    FSCPAM                                              242139
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C074
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C                     ENDIF                                                              236196
      *                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          157669
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                     AR679419
     C           *IN12     IFEQ *ON                                                         AR679419
     C           AMTP      ANDEQ'SA'                                                        AR679419
     C                     MOVE STAI      STAIND                                            AR679419
     C                     ENDIF                                                            AR679419
2618 C*
2619 C** OUTPUT RECS.TO S/HIUPD AND S/ACTN5
2620 C*
2621 C   06                SETON                     42
2622 C*
2623 C** FOR ACTN4 PROCESSING,SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
2624 C*
2625 C   12                Z-ADD0         BRATEC
2626 C   12                Z-ADD0         BRATE
2627 C   12                Z-ADD0         RATSPD
2628 C   12                MOVE ' '       SPINDI
2629 C   12                Z-ADD0         CALBAS
2630 C   12                MOVE STAI      STSTAC
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN12     ANDEQ'1'                                       CAC001
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN12     ANDEQ'1'                                                           208221
     C                     Z-ADD0         FUNDSP                          CAC001
     C                     MOVE ' '       FUNDSG                          CAC001
     C                     MOVE FPRC      FUNDPC                          CAC001
     C                     MOVE ' '       INTFLG                          CAC001
     C                     MOVE ' '       COFFLG                          CAC001
     C                     ENDIF                                          CAC001
2631 C*
2632 C** FOR ACTN4 PROCESSING, ONLY OUTPUT RECS. IF ACTION IND. IS 'Y'
2633 C*
2634 C   12 72             GOTO STACEN
2635 C*
2636 C   12                SETON                     4557
2637 C                     SETOF                     18    O/P AS I/P
2638 C*
2639 C                     EXSR EXCPT
2640 C*
2641 C           NHIUPD    ADD  1         NHIUPD
2642 C   12      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN12     IFEQ *ON                                                         MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2643 C*
2644 C                     Z-ADDVDAT      PHVDAT
2645 C*
2646 C** OUTPUT LINE TO REPORT IF CURRENT PRINCIPAL -VE.(IF NOT MATURING).
2647 C*
2648 C  N68                EXSR CREDIT
2649 C  N68 U7 U8          GOTO STACEN                     DATABASE ERROR
      *                                                                                       236196
     C           INTST     IFNE '1'                                                           236196
2650 C*
2651 C** DETERMINE IF STOP OR START ACCRUALS
2652 C*
2653 C           STAI      COMP 'Y'                  2323
2654 C   23                Z-ADDVDAT      LVDAT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN23     ANDEQ'1'                                       CAC001
     C                     Z-ADDVDAT      CVDAT                           CAC001
     C                     ENDIF                                          CAC001
2655 C*
2656 C   06                MOVE STAI      STAIND
2657 C   06      STAI      COMP 'Y'                      27
2658 C   06 29 28
2659 CAN 27                SETOF                     23
2660 C   06 29 28
2661 CANN27                SETON                     23
2662 C   06 29 28
2663 CANN27                Z-ADDVDAT      LVDAT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   06 29 28                                                         CAC001
     CANN27                Z-ADDVDAT      CVDAT                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       236196
     C                     ENDIF                                                              236196
     C*
     C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
     C*
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
     C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
     C*
     C** OUTPUT REC. TO S/INTST IF NECCESARY
     C*
     C  N21                                                INT.HD.NOT READ
     COR 22                                                INT.HD.O/P
2664 CORN71                                                NOT DEMAND LOAN
     CORN63                GOTO CUTXSA                     NO INT.PAYM7TS
     C*
     C                     SETON                     59
     C                     EXSR EXCPT
     C           NINTST    ADD  1         NINTST
     C           NOSTRC    ADD  1         NOSTRC
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO STACEN                                                        236196
     C                     ENDIF                                                              236196
     C*
     C           CUTXSA    TAG                             ** CUTXSA TAG *
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
      *                                                                   CLE004
      * Backvaluation gone beyond interest header                         CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Bill/Telex is required                                            CLE004
     C           *IN60     ANDEQ*ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
      * Output CUTX1HP with details from History record and new fields    CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C**********           SETON                     78                                CLE004 235743
     C                     MOVE '1'       *IN79                                               235743
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * If CUTX1HN not previously output                                  CLE004
      *                                                                   CLE004
     C           IN52      IFEQ '0'                                       CLE004
     C                     SETON                     52                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
      * Prevent output to CUTX1HN again                                   CLE004
     C                     MOVE '1'       IN52                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
     C*
     C**  OUTPUT REC. TO S/CUTX1 IF NECCESARY
     C*
     C   U3                GOTO STACEN
     C*
     C           VDAT      COMP LTVD                 30
     C   30 12   CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C098
     C  N60
     CORN22
     COR 30N12
     COR 30 12N31          GOTO STACEN
     C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C*                                                                                       181859
     C                     SETON                     79
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     EXSR EXCPT
     C           NCUTX1    ADD  1         NCUTX1
     C*
     C*
2665 C           STACEN    ENDSR                           ** STACEN **
2666 C*
2667 C********************************************************************
2668 C********************************************************************
2669 C*
2670 C** REVSL SUBROUTINE - TO PROCESS REVERSAL RECORDS
2671 C*
2672 C** CALLED BY:  ACTN
2673 C** CALLS:      EXCPT
2674 C*
2675 C           REVSL     BEGSR                           ** REVSL **
2676 C*
2677 C** IF CONTROL REC. DOES NOT SPECIFY A RVSL, THEN DATABASE ERROR
2678 C*
2679 C  N69                SETON                     U7U8LR
2680 C  N69                MOVELLNRF      DBKEY
2681 C  N69                Z-ADD3         DBASE
2682 C  N69                MOVE 'ACTN4'   DBFILE
2683 C  N69                GOTO REVSEN
2684 C*
2685 C** OUTPUT RECORD TO S/ACTN5
2686 C*
2687 C                     SETON                     45
2688 C                     SETOF                     18    O/P AS I/P
2689 C                     EXSR EXCPT
2690 C           NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2691 C*
2692 C           REVSEN    ENDSR                           ** REVSEN **
2693 C*
2694 C********************************************************************
2695 C********************************************************************
2696 C*
2697 C** DEALDT SUBROUTINE - TO PROCESS DEAL DATE RECORDS
2698 C*
2699 C** CALLED BY:  ACTN
2700 C** CALLS:      EXCPT
2701 C*
2702 C           DEALDT    BEGSR                           ** DEALDT **
2703 C*
2704 C** OUTPUT RECORD TO S/ACTN5
2705 C*
2706 C                     SETON                     45
2707 C                     SETOF                     18    O/P AS I/P
2708 C                     EXSR EXCPT
2709 C           NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2710 C*
2711 C                     ENDSR                           ** ENDSR **
2712 C*
2713 C********************************************************************
2714 C********************************************************************
2715 C*
2716 C** STRTDT SUBROUTINE - TO PROCESS ACTN4 FILE START DATE RECORDS
2717 C*
2718 C** CALLED BY:  ACTN
2719 C** CALLS:      EXCPT,INTHED
2720 C*
2721 C           STRTDT    BEGSR                           ** STRTDT **
      *                                                                                       CLE028
      ** Generate interest accrual for the first period on start date,                        CLE028
      ** for flat rate personal loans, only if actioned today or if                           CLE028
      ** Start record was read from history file and CLE003 is off                            CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN12     IFEQ *ON                                                           CLE028
     C           *IN72     ANDEQ*OFF                                                          CLE028
     C           *IN12     OREQ *OFF                                                          CLE028
     C           *IN02     ANDEQ*ON                                                           CLE028
     C           CLE003    ANDEQ*OFF                                                          CLE028
      *                                                                                       CLE028
     C                     MOVE 'A'       WEPAR                                               CLE028
     C                     MOVE LNRF      WALON                                               CLE028
     C           WKLON     CHAINCLOAN                26                                       CLE028
      *                                                                                       CLE028
     C           *IN26     IFEQ '1'                                                           CLE028
     C           *LOCK     IN   LDA                                                           CLE028
     C                     MOVEL'CLOAN'   DBFILE                                              CLE028
     C                     Z-ADD20        DBASE                                               CLE028
     C                     MOVELD#CLON    DBKEY                                               CLE028
     C                     OUT  LDA                                                           CLE028
     C                     EXSR *PSSR                                                         CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
     C**********           Z-ADDVDAT      W78VDT                                       CLE028 214981
     C                     Z-ADDWVDAT     W78VDT                                              214981
     C                     Z-ADDWMDAT     W78MDT                                              CLE028
     C                     Z-ADDFLTI      W78FLT                                              CLE028
     C                     MOVE RFRQ      W78RPF                                              CLE028
     C                     Z-ADDFRPD      W78FRD                                              CLE028
     C                     Z-ADDRDYN      W78RPM                                              CLE028
     C                     MOVE CCY       W78CCY                                              CLE028
     C                     MOVE *BLANKS   W78LCN                                              CLE028
     C**********           Z-ADDVDAT      W78BEG                                       CLE028 214981
     C**********           Z-ADDVDAT      W78END                                       CLE028 214981
     C                     Z-ADDVDATS     W78BEG                                              214981
     C                     Z-ADDVDATS     W78END                                              214981
     C                     MOVE 'A'       W78ROA                                              CLE028
      *                                                                                       CLE028
     C                     EXSR RULE78                                                        CLE028
     C           AUTO      IFEQ 'Y'                                                           CLE028
     C           AUTO      OREQ 'C'                                                           CLE134
     C           CLE134    ANDEQ'Y'                                                           CLE134
     C                     Z-ADDW78INT    ACCINT    H                                         CLE028
     C                     Z-ADDW78INT    AIIACD    H                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
      *                                                                   CLE003
     C                     Z-ADD0         IPRD                            115099
     C                     Z-ADD0         AITC                            115099
     C                     Z-ADD0         AIAP                            115099
     C                     MOVE LTYP      LONTYP                                              227657
     C                     MOVE SUTP      SUBTYP                                              227657
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD0         IPRN                                                CAS005
     C                     Z-ADD0         AITN                                                CAS005
     C                     Z-ADD0         AIAN                                                CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C075
     C           *IN67     IFEQ *OFF                                      CLE003
     C***********          Z-ADDPRAM      CPAM                      CLE003120391
     C                     Z-ADDPRAMS     CPAM                            120391
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C**********           Z-ADDPRAMN     CPAM                                         CAS005 242139
     C                     Z-ADDPRAMN     FSCPAM                                              242139
     C                     ENDIF                                                              CAS005
     C***********          Z-ADD0         IPRD                      CLE003115099
     C***********          Z-ADD0         AITC                      CLE003115099
     C***********          Z-ADDBRTT      BASECD                    CLE003120391
     C***********          Z-ADDBRTE      BASERT                    CLE003120391
     C***********          Z-ADDRTSP      SPREAD                    CLE003120391
     C***********          MOVE SPIN      SPRIND                    CLE003120391
     C***********          Z-ADDCALC      ICALCB                    CLE003120391
     C                     Z-ADDBRTTS     BASECD                          120391
     C                     Z-ADDBRTES     BASERT                          120391
     C                     Z-ADDRTSPS     SPREAD                          120391
     C                     MOVE SPINS     SPRIND                          120391
     C                     Z-ADDCALCS     ICALCB                          120391
     C                     EXSR QNTRAT                                    CLE003
     C                     Z-ADDINTRAT    INTR                            CLE003
     C***********          Z-ADD0         AIAP                      CLE003115099
     C                     ELSE                                           115099
     C                     Z-ADD0         CPAM                            115099
     C                     Z-ADD0         INTR                            115099
     C                     Z-ADD0         FSCPAM                                              CAS005
     C                     ENDIF                                          CLE003
      *                                                                   CLE003
     C                     ENDIF                                          CLE003
      *                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           CDE002    OREQ 'Y'                                                           208221
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADD0         COFD                            157669
     C                     Z-ADD0         ACDA                            157669
     C                     Z-ADD0         ACAP                            157669
     C           *IN67     IFEQ *OFF                                      157669
     C                     Z-ADDFSRPS     FUNDRT                          157669
     C                     MOVE FSGNS     FUNDSN                          157669
     C                     MOVE FPRCS     FUNPRF                          157669
     C                     EXSR QCFRAT                                    157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     ELSE                                           157669
     C                     Z-ADD0         COFR                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          157669
     C/COPY WNCPYSRC,LE0400C110
2722 C*
2723 C** SET ON INDS. TO SHOW REC. READ
2724 C*
2725 C                     SETON                     2570
2726 C*
2727 C** IF REC. IS TO BE ACTIONED, OUTPUT RESPECTIVE START RECS TO ACTN5
2728 C** AND HISTS
2729 C*
2730 C  N72                SETON                     4551
2731 C  N72                SETOF                     18    O/P AS I/P
2732 C  N72                EXSR EXCPT
2733 C  N72      NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           *IN72     IFEQ *OFF                                                        MD026266
     C           NACTN5    ANDEQ0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2734 C*
2735 C  N72      NHIUPD    ADD  1         NHIUPD
2736 C  N72                Z-ADDVDATS     PHVDAT
     C  N72                Z-ADDVDATS     STRDAT           SAVE START DATES01392
2737 C*
2738 C** SET UP INT.CALC FIELDS WHICH WOULD NORMALLY COME FROM HIST ST.REC
2739 C*
2740 C                     MOVE INTC      CAPNIN  1
2741 C                     MOVE REPT      REPTYP  10
2742 C                     MOVE WTIN      WHTTYP  1
2743 C*
2744 C** IF NO ACTION, SET ON INDS. TO SPECIFY HEADERS ALREADY O/P
2745 C*
2746 C   72                SETON                     2022
2747 C*
2748 C** SET ON IND AS IF BV HEAD HAS BEEN READ
2749 C*
2750 C                     SETON                     28
2751 C*
2752 C** IF BACK-VALUATIONS EXIST, SET IND. FOR 'SA' PROCESSING
2753 C*
2754 C   62                SETON                     29
2755 C*
2756 C** CALL INTEREST HEADER PROCESSING IF REC. NOT TO BE ACTIONED.
2757 C** IF BEING ACTIONED, THIS PROCESSING WILL BE DONE ON THE NEXT REC.
2758 C** READ IF ITS VAL.DATE IS > START DATE. (ONLY 'BR' RECS. COULD
2759 C** HAVE VAL.DATE = START DATE).
2760 C*
2761 C   72                EXSR INTHED
2762 C*
2763 C** PAY/RECEIVE TELEXES
2764 C*
2765 C   U3                GOTO STRTEN
2766 C*
2767 C           TLXY      COMP 'Y'                      82
2768 C*
2769 C                     SETOF                     18    O/P AS I/P
      *                                                                                       CLE031
      ** If indicator 82 is on, CLE031 is on                                                  CLE031
      ** set work type to 'start' and do SR/SETCCY and SR/SETLLX                              CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'S'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'S'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
2770 C                     EXSR EXCPT
2771 C   82      NLETLX    ADD  1         NLETLX
2772 C                     SETOF                     82
2773 C*
2774 C           STRTEN    ENDSR                           ** STRTEN **
2775 C*
2776 C********************************************************************
2777 C********************************************************************
2778 C*
2779 C** PASTDU SUBROUTINE - TO PROCESS PAST DUE REPAYMENTS
2780 C*
2781 C** CALLED BY:  ACTN
2782 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTDUE,WHTAX,EXCPT
2783 C*
2784 C           PASTDU    BEGSR                           ** PASTDU **
2785 C*
     C                     MOVE 'N'       WPDCL                                             AR790759
     C                     MOVELLTYP      WLLTYP  1                                         AR790759
     C           WLLTYP    IFEQ 'X'                                                         AR790759
     C           WLLTYP    OREQ 'Y'                                                         AR790759
     C           WLLTYP    OREQ 'Z'                                                         AR790759
     C                     MOVE 'Y'       WPDCL                                             AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
2786 C   25N21             EXSR INTHED
2787 C*
2788 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
2789 C*
2790 C                     EXSR OUTBVH
2791 C*
2792 C                     EXSR OUTINH
2793 C*
2794 C** PERFORM INTEREST CALCS.
2795 C*
2796 C   23                EXSR INTCAL
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C076
     C                     Z-ADDW#CPAM    CPAM                            CLE003
     C                     Z-ADDW#IPRD    IPRD                            CLE003
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#FSCP    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C077
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C                     ENDIF                                          CLE003
2874 C*
2871 C** CALC. INT. DUE
2872 C*
2873 C                     EXSR QNTDUE
     C/COPY WNCPYSRC,LE0400C035
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     EXSR QCFDUE                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2801 C*
2802 C** FOR REP. TYPE 3, CALC. PRINC. AND INT. AMTS.
2803 C*
2804 C           REPT      COMP 2                    393738
      *                                                                                     AR790759
     C           WPDCL     IFEQ 'N'                                                         AR790759
     C           *IN37     IFEQ '1'                                                         AR790759
     C           *IN38     OREQ '1'                                                         AR790759
     C           PRAM      IFGT WOPRIN                                                      AR790759
     C                     Z-ADDWOPRIN    PRAM                                              AR790759
      *                                                                                     AR790759
     C           *IN37     IFEQ '1'                                                         AR790759
     C           PRAM      ADD  INTA      TAMT                                              AR790759
     C                     ELSE                                                             AR790759
     C                     Z-ADDPRAM      TAMT                                              AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
     C                     ENDIF                                                            AR790759
     C                     ENDIF                                                            AR790759
     C                     ENDIF                                                            AR790759
2805 C*
2806 C   39      INTDUE    COMP TAMT                 17
2807 C   39N17             Z-ADDINTDUE    PDINT  130
2808 C   39N17   TAMT      SUB  INTDUE    PDPRIN 130
      *                                                                                     AR790759
     C           *IN39     IFEQ '1'                                                         AR790759
     C           *IN17     ANDEQ'0'                                                         AR790759
     C           WPDCL     ANDEQ'N'                                                         AR790759
     C           PDPRIN    ANDGTWOPRIN                                                      AR790759
     C                     Z-ADDWOPRIN    PDPRIN                                            AR790759
     C           PDPRIN    ADD  PDINT     TAMT                                              AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                     AR790759
2809 C   39 17             Z-ADDTAMT      PDINT
2810 C   39 17             Z-ADD0         PDPRIN
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN39     IFEQ *ON                                                           CAS005
     C           *IN17     ANDEQ*OFF                                                          CAS005
     C           TAMT      SUB  NTRDUE    NPDPRI 130                                          CAS005
     C                     ENDIF                                                              CAS005
     C           *IN39     IFEQ *ON                                                           CAS005
     C           *IN17     ANDEQ*ON                                                           CAS005
     C                     Z-ADD*ZEROS    NPDPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN39     IFEQ '1'                                                           CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     Z-ADDTAMT      PDPRIN                                              CLE028
     C                     ENDIF                                                              CLE028
     C           ADCF      IFEQ 'Y'                                                           CLE028
     C           WNPY      ANDNE*ZERO                                                         CLE028
     C           CHGA      DIV  WNPY      CHDU      H                                         CLE028
     C                     ADD  CHDU      WTCHDU                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0400CP20                                           S01408
      *                                                                                       CLE154
      ** If the feature is on and Repayment type is '2'                                       CLE154
      ** and INTA #0 (INTA from Action file,                                                  CLE154
      ** meaning it is a Interest Repayment Schedule)                                         CLE154
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTA      ANDNE*ZERO                                                         CLE154
     C                     Z-ADDINTDUE    PDINT                                               CLE154
     C                     END                                                                CLE154
      *                                                                   S01408
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN39     ANDEQ'1'                                       CAC001
     C           COFDUE    IFLE TAMT                                      CAC001
     C                     Z-ADDCOFDUE    PDCOF  130                      CAC001
     C                     ELSE                                           CAC001
     C                     Z-ADDTAMT      PDCOF                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN39     ANDEQ*ON                                                           CAS005
     C           NTRDUE    IFLE TAMT                                                          CAS005
     C                     Z-ADDNTRDUE    PDNTR  130                                          CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDTAMT      PDNTR                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2811 C*
2812 C** UPDATE INT. PAST DUE THIS RUN ACCORDING TO REPAY TYPE
2813 C*
2814 C   37      INPAST    ADD  INTDUE    INPAST
2815 C   39      INPAST    ADD  PDINT     INPAST
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTA      ANDNE*ZERO                                                         CLE154
     C           INPAST    ADD  PDINT     INPAST                                              CLE154
     C                     END                                                                CLE154
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   37      CFPAST    ADD  COFDUE    CFPAST                          CAC001
     C   39      CFPAST    ADD  PDCOF     CFPAST                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN37     IFEQ *ON                                                           CAS005
     C           NTRPST    ADD  NTRDUE    NTRPST                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN39     IFEQ *ON                                                           CAS005
     C           NTRPST    ADD  PDNTR     NTRPST                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2816 C*
2817 C** FOR REPAY TYPE 1, CALC.WHTAX IF INT. DUE > 0
2818 C*
2819 C  N37
2820 CORN16                Z-ADD0         OPWTXA
2821 C  N37
2822 CORN16                Z-ADD0         OPTAMT
2823 C   38                Z-ADD0         OPINTA
2824 C   39                Z-ADDPDINT     OPINTA
2825 C   37N16             Z-ADDINTDUE    OPINTA
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTA      ANDNE*ZERO                                                         CLE154
     C                     Z-ADDPDINT     OPINTA                                              CLE154
     C                     END                                                                CLE154
2826 C*
2827 C   37 16             Z-ADDINTDUE    WHTINT
2828 C   37 16             EXSR WHTAX
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C   37                Z-ADDCOFDUE    OPCOFA                          CAC001
     C   38                Z-ADD0         OPCOFA                          CAC001
     C   39                Z-ADDPDCOF     OPCOFA                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN37     IFEQ *ON                                                           CAS005
     C                     Z-ADDNTRDUE    OPINTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN38     IFEQ *ON                                                           CAS005
     C                     Z-ADD*ZEROS    OPINTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN38     ANDEQ'Y'                                                           CLE154
     C           INTA      ANDNE*ZERO                                                         CLE154
     C                     Z-ADDNTRDUE    OPINTN                                              CLE154
     C                     END                                                                CLE154
     C           *IN39     IFEQ *ON                                                           CAS005
     C                     Z-ADDPDNTR     OPINTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2829 C*
2830 C** SET UP FIELDS FOR OUTPUT
2831 C*
2832 C   37
2833 COR 38                Z-ADDPRAM      OPPRAM
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN37     IFEQ *ON                                                           CAS005
     C           *IN38     OREQ *ON                                                           CAS005
     C                     Z-ADDFSPRAM    NOPPRA                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   S01392
     C**  LESS REBATE FOR DISCOUNTED LOANS                                S01392
     C**  IF NOT EARLY PAYMENT, REBATE = 0                                S01392
     C*                                                                   S01392
     C           PTYP      IFEQ 63                                        S01392
     C           PTYP      OREQ 65                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C           PTYP      OREQ 67                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C                     SUB  REBT      OPPRAM                          S01392
     C                     END                                            S01392
2834 C   39                Z-ADDPDPRIN    OPPRAM
2835 C           OPTAMT    ADD  OPPRAM    OPTAMT
2836 C           OPTAMT    ADD  OPINTA    OPTAMT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN39     ANDEQ*ON                                                           CAS005
     C                     Z-ADDNPDPRI    NOPPRA                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
      ** If Repayment type 3 and Flat rate personal loan, and add on interest                 CLE028
      ** flag is 'Y', total amount should be equal to total principal amount.                 CLE028
      ** This is because interest amount was already added on principal.                      CLE028
      ** INTA field only contains interest amount to be amortised.                            CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN39     IFEQ '1'                                                           CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     Z-ADDOPPRAM    OPTAMT                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE0400CP13                                           S01408
2837 C                     MOVE ' '       OPINTC
      *                                                                                     AR790759
     C           *IN12     IFEQ '1'                                                         AR790759
     C           WPDCL     ANDEQ'N'                                                         AR790759
     C                     SUB  OPPRAM    WOPRIN                                            AR790759
     C                     ENDIF                                                            AR790759
2838 C*
2839 C** OUTPUT REC. TO S/ACTN5
2840 C*
2841 C                     SETON                     4518
2842 C*
2843 C                     EXSR EXCPT
2844 C*
2845 C           NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2846 C*
     C/COPY WNCPYSRC,LE0400C040
2847 C           PASTEN    ENDSR                           ** PASTEN **
2848 C*
2849 C********************************************************************
2850 C********************************************************************
2851 C*
2852 C** MATUR SUBROUTINE - TO PROCESS MATURITY RECORDS
2853 C*
2854 C** CALLED BY:  ACTN
2855 C** CALLS:      OUTBVH,OUTINH,INTCAL,QNTDUE,WHTAX,EXCPT
2856 C*
2857 C           MATUR     BEGSR                           ** MATUR **
      *                                                                                     AR317587
      ** Check first if there is a history record with value date                           AR317587
      ** later than the maturity date.                                                      AR317587
      *                                                                                     AR317587
     C           KHISR2    SETLLHISTR                                                       AR317587
     C           KHISR2    READEHISTR                    17                                 AR317587
     C           *IN17     DOWEQ'0'                                                         AR317587
      *                                                                                     AR317587
      ** Process the history record with value date later than the                          AR317587
      ** maturity first before the MA action.                                               AR317587
      *                                                                                     AR317587
     C           XVDAT     IFGT VDAT                                                        AR317587
     C                     EXSR HIST1                                                       AR317587
     C                     ENDIF                                                            AR317587
     C           KHISR2    READEHISTR                    17                                 AR317587
     C                     ENDDO                                                            AR317587
2858 C*
2859 C   25N21             EXSR INTHED
2860 C*
2861 C** OUTPUT B/V AND/OR INT. HEADERS TO S/HIUPD IF NECESSARY
2862 C*
2863 C                     EXSR OUTBVH
2864 C*
2865 C                     EXSR OUTINH
      *                                                                                    AR1009681
     C                     EXSR SRNSRT                                                     AR1009681
2866 C*
2867 C** PERFORM INTEREST CALCS. IF NECESSARY
2868 C*
2869 C   23                EXSR INTCAL
      *                                                                                     AR317587
      ** Check existing MR TO BE ACTIONED today                                             AR317587
      *                                                                                     AR317587
     C           KLOAN     KLIST                                                            AR317587
     C                     KFLD           LNRF                                              AR317587
     C                     KFLD           VDAT                                              AR317587
     C           KLOAN     SETLLLEACT3L2                                                    AR317587
     C                     READ LEACT3L2                 10                                 AR317587
     C           *IN10     DOWEQ'0'                                                         AR317587
     C           LNRFX     IFEQ LNRF                                                        AR317587
     C           VDATX     ANDGTVDAT                                                        AR317587
     C           XAVDX     ANDNE0                                                           AR317587
     C                     SUB  PRAMX     OSPRIN                                            AR317587
     C                     SUB  INTAX     INT       H                                       AR317587
     C                     ENDIF                                                            AR317587
     C                     READ LEACT3L2                 10                                 AR317587
     C                     ENDDO                                                            AR317587
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C/COPY WNCPYSRC,LE0400C078
     C***********          Z-ADDW#CPAM    CPAM                     CLE003 114542
     C***********          Z-ADDW#IPRD    IPRD                     CLE003 114542
     C***        W#AITC    ADD  INT       AITC                     CLE003 114244
     C           *IN23     IFEQ *ON                                       114542
     C           W#AITC    ADD  INT       AITC      H                     114244
     C                     ELSE                                           114542
     C                     Z-ADDW#AITC    AITC                            114542
     C                     ENDIF                                          114542
     C                     Z-ADDW#INTR    INTR                            CLE003
     C                     Z-ADDW#AIAP    AIAP                            CLE003
     C                     ENDIF                                          CLE003
2870 C*
2798 C** CALC. INT. DUE
2799 C*
     C                     SETOF                     66
     C*
     C**  SETON 66 FOR ALL MAT.EVENTS EXCEPT THOSE GOING PAST DUE TODAY
     C   68
     CORN68 72             SETON                     66
2800 C                     EXSR QNTDUE
     C/COPY WNCPYSRC,LE0400C036
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     EXSR QCFDUE                                    CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     SETOF                     66
     C   68                SETON                     16
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
2874 C*
2875 C** ADD INT. DUE TO INT.PAID THIS RUN
2876 C*
2877 C           INPAID    ADD  INTDUE    INPAID
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CFPAID    ADD  COFDUE    CFPAID                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           NTRPID    ADD  NTRDUE    NTRPID                                              CAS005
     C                     ENDIF                                                              CAS005
2878 C*
2879 C** CALC. WHTAX IF INT. DUE > 0
2880 C*
2881 C  N16                Z-ADD0         OPWTXA
2882 C  N16                Z-ADD0         OPTAMT
2883 C  N16                Z-ADDINTDUE    OPINTA
2884 C*
2885 C   16                Z-ADDINTDUE    WHTINT
2886 C   16                EXSR WHTAX
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDCOFDUE    OPCOFA                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDNTRDUE    OPINTN                                              CAS005
     C                     ENDIF                                                              CAS005
2887 C*
2888 C** SET UP FIELDS FOR OUTPUT
2889 C*
2890 C** IF INT. IS CAP'D, ADD INT. TO PRINC. AMT. ALSO
2891 C*
2892 C           CAPNIN    COMP 'Y'                      30
2893 C*
2894 C                     Z-ADDOSPRIN    OPPRAM
2895 C           OPTAMT    ADD  OPPRAM    OPTAMT
2896 C           OPTAMT    ADD  OPINTA    OPTAMT
2897 C                     MOVE ' '       OPINTC
2898 C   30      OPPRAM    ADD  OPINTA    OPPRAM
2899 C   30                MOVE 'Y'       OPINTC
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDNOSPRI    NOPPRA                                              CAS005
     C           *IN30     IFEQ *ON                                                           CAS005
     C           NOPPRA    ADD  OPINTN    NOPPRA                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
      *                                                                                       CLE028
     C           ADIF      IFEQ 'Y'                                                           CLE028
     C                     Z-ADDOPPRAM    OPTAMT                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           ADCF      IFEQ 'Y'                                                           CLE028
     C           CHGA      SUB  WTCHDU    CHDU                                                CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C/COPY WNCPYSRC,LE0400CP14                                           S01408
     C***********                                                   E48967E20818
     C***CHECK*IF*IT*IS*A*RISK*LOAN***********************          E48967E20818
     C***ZEROISE*TOTAL*FIELD*AND*ADD*OUTSTANDING*INTEREST*          E48967E20818
     C***********PTYP      COMP 70                       31         E48967E20818
     C***31******          Z-ADDOPINTA    OPTAMT                    E48967E20818
     C***********                                                   E48967E20818
2900 C*
2901 C** IF DISCOUNTED LOAN,ZEROISE INT. AND TAX
2902 C*
2903 C   67                Z-ADD0         OPINTA
2904 C   67                Z-ADD0         OPWTXA
2905 C   67                Z-ADDOPPRAM    OPTAMT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN67     ANDEQ'1'                                       CAC001
     C                     Z-ADD0         OPCOFA                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN67     ANDEQ*ON                                                           CAS005
     C                     Z-ADD*ZERO     OPINTN                                              CAS005
     C                     ENDIF                                                              CAS005
2906 C*
2907 C           OUTMAR    TAG                             ** OUTMAR TAG *
2908 C*
2909 C** OUTPUT RECS. TO S/HIUPD AND S/ACTN5
2910 C*
2911 C** SETUP FIELDS FOR O/P TO HIUPD,INTST OR CUTX1
2912 C*
2913 C                     Z-ADDOPPRAM    PAMONT
2914 C                     Z-ADDOPINTA    IAMONT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDNOPPRA    NPAMNT                                              CAS005
     C                     Z-ADDOPINTN    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           CLE003    IFEQ 'Y'                                       114542
     C           W#CPAM    SUB  PAMONT    CPAM                            114542
     C           W#IPRD    ADD  IAMONT    IPRD                            114542
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    SUB  NPAMNT    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C079
     C                     ENDIF                                          114542
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADDOPCOFA    CAMONT                          CAC001
     C           CLE003    IFEQ 'Y'                                       157669
     C           W#COFD    ADD  CAMONT    COFD                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDOPINTN    NAMONT                                              CAS005
     C           CLE003    IFEQ 'Y'                                                           CAS005
     C           W#IPRN    ADD  NAMONT    IPRN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
2915 C                     Z-ADDOPWTXA    TAMONT
2916 C                     Z-ADD0         FAMONT
2917 C                     Z-ADD0         FEECOD
2918 C                     MOVE ' '       WRTOFF
2919 C                     Z-ADD0         EXVDAT
     C/COPY WNCPYSRC,LE0400CP15                                           S01408
2920 C*
2921 C** ONLY O/P RECS.IF ACTION IND. IS 'Y'
2922 C*
2923 C   72                GOTO TELXMA
      *                                                                                     AR815697
     C           CLE134    IFEQ 'Y'                                                         AR815697
     C           *IN72     IFEQ '0'                                                         AR815697
     C           ACTI      ANDEQ'P'                                                         AR815697
     C                     EXSR SETFLD                                                      AR815697
     C                     GOTO TELXMA                                                      AR815697
     C                     ENDIF                                                            AR815697
     C                     ENDIF                                                            AR815697
2924 C*
2925 C                     SETON                     4518
2926 C* THIS SECTION HAS BEEN REMOVED BY FIX 042529                       E47145
2926 C*                                                                   E47145
2926 C*  FOR RISK LOAN WHICH HAS A MATURITY ACTION RECORD AND IF THE      E47145
2926 C*  OUTSTANDING AMOUNT = PRINCIPAL THEN SET ON LOAN INDICATOR TO     E47145
2926 C*  MATURE                                                           E47145
2926 C**                                                                  E47145
2926 C**N68******PTYP******COMP 70                       30    E47145     E47245
2926 C**N30****************GOTO NORK                           E47145     E47245
2926 C**N68******OPPRAM****COMP OPTAMT               3030      E47145     E47245
2926 C**N30N68*************MOVE 'Y'       AUTO                 E47145     E47245
2926 C**N30N68*************MOVE 'Y'       LNMA                 E47145     E47245
2926 C**N30N68*************SETON                     68        E47145     E47245
     C*********************SETOF                     61             E47245042529
2926 C**N68******PTYP******COMP 70                       61         E47245042529
2926 C**N68N61*************GOTO NORK                                E47245042529
2926 C**N68******OPPRAM****COMP OPTAMT                   61         E47245042529
2926 C**N68*61*************MOVE 'Y'       AUTO                      E47245042529
2926 C**N68*61*************MOVE 'Y'       LNMA                      E47245042529
2926 C**N68*61*************SETON                     68             E47245042529
2926 C***********NORK******TAG                       ** NORK TAG ** E47145042529
2926 C* END OF SECTION REMOVED BY FIX 042529                              042529
2926 C*
2927 C** ONLY OUTPUT REC.TO S/HIUPD IF MATURING TODAY
2928 C*
2929 C   68                SETON                     56
2930 C*
2931 C                     EXSR EXCPT
2932 C*
2933 C   68      NHIUPD    ADD  1         NHIUPD
2934 C           NACTN5    ADD  1         NACTN5     24
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
2935 C*
2936 C   68                Z-ADDVDAT      PHVDAT
     C/COPY WNCPYSRC,LE0400C037
2937 C*
2938 C** OUTPUT REC. TO S/PTSLD IF NECESSARY
2939 C*
2940 C           PTYP      COMP 66                       84
2941 C  N84      PTYP      COMP 67                       84
      *                                                                   CLE005
      ** Processing types 69 and 72 are new and introduced by CLE005      CLE005
      ** for call parts sold and risk parts sold, respectively            CLE005
      *                                                                   CLE005
     C           *IN84     IFEQ '0'                                       CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE '1'       *IN84                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C           CLE004    IFEQ 'Y'                                       149915
     C                     EXSR CHKIPP                                    149915
     C                     ENDIF                                          149915
2942 C*
2943 C** IF INT. IS CAP'D,PAMONT WILL CONTAIN INT.AMT. - NOT REQ'D FOR
2944 C** PTSLD REC.
2945 C*
2946 C   30      PAMONT    SUB  OPINTA    PAMONT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN30     ANDEQ*ON                                                           CAS005
     C           NPAMNT    SUB  OPINTN    NPAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
2947 C*
2948 C                     EXSR EXCPT
2949 C   84      NPTSLD    ADD  1         NPTSLD
2950 C                     SETOF                     84
2951 C*
2952 C** RESET PAMONT FOR INTST.,CUTX1.
2953 C*
2954 C   30      PAMONT    ADD  OPINTA    PAMONT
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN30     ANDEQ*ON                                                           CAS005
     C           NPAMNT    SUB  OPINTN    NPAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
2955 C*
2956 C           TELXMA    TAG                             ** TELXMA TAG *
2957 C*
2958 C** PAY/RECEIVE TELEXES
2959 C*
2960 C   U3                GOTO INTSMA
2961 C*
2962 C           TLXY      COMP 'Y'                      82
     C*                                                                   S01392
     C**  LESS REBATE FOR DISCOUNTED LOANS                                S01392
     C**  IF NOT EARLY PAYMENT , REBATE = 0                               S01392
     C*                                                                   S01392
     C           *IN82     IFEQ '1'                                       S01392
     C***********PTYP      ANDEQ63                                 S01392 122098
     C           PTYP      IFEQ 63                                        122098
     C           PTYP      OREQ 65                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C           PTYP      OREQ 67                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C                     SUB  REBT      OPTAMT                          S01392
     C                     ENDIF                                          122098
     C                     END                                            S01392
2963 C*
2964 C** IF INT. IS CAP'D, O/P 2ND. TELEX RECORD,AMEND TYPE 'IN'
2965 C*
2966 C*
2967 C                     SETON                     18
2968 C   82 30             SETON                     88
     C      88   OSBR      IFEQ *BLANK                                    S01117
     C                     MOVE BRCA      OSBR                            S01117
     C                     END                                            S01117
      *                                                                                       CLE031
      ** If indicator 82 is on and if feature CLE031 is on                                    CLE031
      ** Set work type to 'end' and do SR/SETCCY and SR/SETLLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
2969 C                     EXSR EXCPT
2970 C   82      NLETLX    ADD  1         NLETLX
2971 C   82 30   NLETLX    ADD  1         NLETLX
2972 C                     SETOF                     82
2973 C*
2974 C           INTSMA    TAG                             ** INTSMA TAG *
2975 C*
2976 C** SET UP INTEREST ACCRUED UP TO AND INCLUDING THIS MOVEMENT
2977 C*
      *                                                                   CLE003
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           AITC      ADD  AIAP      TINTTM                          CLE003
     C                     ELSE                                           CLE003
2978 C                     Z-ADDACCINT    TINTTM
     C                     ENDIF                                          CLE003
2979 C*
2980 C** OUTPUT REC. TO S/INTST IF NECESSARY
2981 C*
2982 C  N21                                                INT.HD.NOT READ
2983 COR 22                                                INT.HD.O/P
2984 CORN71                                                NOT DEMAND LOAN
2985 CORN63                GOTO CUTXMA                     NO INT.PAYM'TS
2986 C*
2987 C                     SETON                     58
2988 C                     EXSR EXCPT
2989 C           NINTST    ADD  1         NINTST
2990 C           NOSTRC    ADD  1         NOSTRC
2991 C*
2992 C           CUTXMA    TAG                             ** CUTXMA TAG *
2993 C*
2994 C** OUTPUT REC.TO S/CUTX1 IF NECESSARY
2995 C*
2996 C   U3                GOTO MATREN
2997 C*
2998 C           VDAT      COMP LTVD                 30
2999 C   30      CBLY      COMP 'Y'                      31
     C/COPY WNCPYSRC,LE0400C099
3000 C*
3001 C  N60
3002 CORN22
3003 COR 30N31             GOTO MATREN
3004 C*
     C*If record coming from history file or CBLY not 'Y',                                    181859
     C*set CTRQ to ' ' - no bill must be printed                                              181859
     C*                                                                                       181859
     C           *IN12     IFEQ '0'                                                           181859
     C           CBLY      ORNE 'Y'                                                           181859
     C                     MOVE ' '       CTRQ                                                181859
     C                     ELSE                                                               181859
     C                     MOVE 'Y'       CTRQ                                                181859
     C                     ENDIF                                                              181859
     C**                                                                  E43236
     C* ONLY OUTPUT TO CUTX1 IF TOTAL DUE IS POSITIVE                     E43236
     C**                                                                  E43236
1529 C*********************SETON*********************78                   E43236
1531 C********** PAMONT    ADD  IAMONT    SUMONT 150 78                   E43236              200707
1531 C           PAMONT    ADD  IAMONT    SUMONT 150 78  78                                   200707
1519 C  N78                GOTO MATREN                                    E43236
     C*                                                                   046647
     C**  LESS REBATE FOR DISCOUNTED LOANS                                046647
     C**  IF NOT EARLY PAYMENT , REBATE = 0                               046647
     C*                                                                   046647
     C           *IN82     IFEQ '1'                                       046647
     C***********PTYP      ANDEQ63                                 046647 122098
     C           PTYP      IFEQ 63                                        122098
     C           PTYP      OREQ 65                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C           PTYP      OREQ 67                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C                     SUB  REBT      PAMONT                          046647
     C                     ENDIF                                          122098
     C                     END                                            046647
      *                                                                                       210989
      ** Output to CUTX1HP with correct BVMV                                                  210989
      *                                                                                       210989
     C           VDAT      IFLT W#VDAT                                                        210989
     C                     MOVE 'Y'       BVMV                                                210989
     C                     ELSE                                                               210989
     C                     MOVE 'N'       BVMV                                                210989
     C                     ENDIF                                                              210989
      *                                                                                       210989
      *                                                                                       CLE031
      ** If indicator 78 is on and if feature CLE031 is on                                    CLE031
      ** Set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
3006 C                     EXSR EXCPT
3007 C           NCUTX1    ADD  1         NCUTX1
3008 C*
     C           IN52      IFEQ '0'                                                           235743
     C                     MOVE '1'       *IN52                                               235743
      *                                                                                       235743
     C                     EXSR EXCPT                                                         235743
      *                                                                                       235743
     C                     ADD  1         NCUTX1                                              235743
      *                                                                                       235743
      * Prevent output to CUTX1HN again                                                       235743
      *                                                                                       235743
     C                     MOVE '1'       IN52                                                235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
3009 C           MATREN    ENDSR                           ** MATREN **
3010 C*
3011 C********************************************************************
     C/COPY WNCPYSRC,LE0400C022
     C*                                                                   CLE004
     C** PRINTO SUBROUTINE - PROCESS NEW AMENDMENT TYPE 'PT' - TRANSFER   CLE004
     C*                      OF PRINCIPAL TO                              CLE004
     C*                                                                   CLE004
     C** CALLED BY:  HIST, ACTN                                           CLE004
     C** CALLS:      OUTBVH, OUTINH, INTHED, INTCAL, CREDIT               CLE004
     C*                                                                   CLE004
     C********************************************************************CLE004
     C           PRINTO    BEGSR                           ** PRINTO **   CLE004
      *                                                                                     AR790759
     C                     MOVE 'N'       WPDCL                                             AR790759
     C                     MOVELLTYP      WLLTYP  1                                         AR790759
     C           WLLTYP    IFEQ 'X'                                                         AR790759
     C           WLLTYP    OREQ 'Y'                                                         AR790759
     C           WLLTYP    OREQ 'Z'                                                         AR790759
     C                     MOVE 'Y'       WPDCL                                             AR790759
     C                     ENDIF                                                            AR790759
      *                                                                                       236196
     C           INTST     IFNE '1'                                                           236196
      *                                                                   CLE004
      ** If Loan not yet started, and start date is not within extract    CLE004
      ** period, no 'ST' record will have been read. The 'PI' record is   CLE004
      ** merely for confirmations. Therefore supress output of BV/INT     CLE004
      ** headers to S/HIUPD                                               CLE004
      *                                                                   CLE004
     C           *IN70     IFEQ *OFF                                      CLE004
     C                     SETON                     2022  Backvalue AmendCLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN25     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
     C                     EXSR INTHED                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If Action rec. is reversed and conf. req'd, O/P                  CLE004
      ** to confs as is, and do no further processing                     CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C           RECI      IFEQ 'R'                                       CLE004
     C                     MOVE *ON       *IN61                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN61     IFEQ *ON                                       CLE004
     C           CNFY      ANDNE'Y'                                       CLE004
     C                     MOVE *OFF      *IN61                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN61     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C           *INU3     IFEQ *OFF                                      CLE004
     C                     MOVE *ON       *IN83                           CLE004
     C                     MOVE *OFF      *IN18                           CLE004
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCONFS                          CLE004
     C                     MOVE *OFF      *IN83                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     GOTO PRTOE                      END SR         CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                           ***** *IN12 ***CLE004
      *                                                                   CLE004
      ** Output B/V and/or Int. Headers to S/HIUPD if necessary           CLE004
      *                                                                   CLE004
     C                     EXSR OUTBVH                                    CLE004
      *                                                                   CLE004
     C                     EXSR OUTINH                                    CLE004
      *                                                                   CLE004
      ** Perform Int Calcs. If necessary                                  CLE004
      *                                                                   CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C                     EXSR INTCAL                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Update new fields introduced by CLE003                           CLE004
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C/COPY WNCPYSRC,LE0400C080
     C           W#CPAM    ADD  PRAM      CPAM                            CLE004
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    ADD  FSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C081
     C           *IN23     IFEQ *ON                                       CLE004
     C           W#AITC    ADD  INT       AITC      H                     CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADDW#AITC    AITC                            CLE004
     C                     ENDIF                                          CLE004
     C                     Z-ADDW#INTR    INTR                            CLE004
     C                     Z-ADDW#IPRD    IPRD                            CLE004
     C                     Z-ADDW#AIAP    AIAP                            CLE004
     C*                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#COFD    COFD                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
      ** Add PRAM to Outstanding principal                                CLE004
      *                                                                   CLE004
     C                     ADD  PRAM      OSPRIN                          CLE004
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     ADD  FSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       236196
     C                     ENDIF                                                              236196
      *                                                                   CLE004
      ** Output Recs to S/HIUPDHP and S/ACTN5DK                           CLE004
      *                                                                   CLE004
     C           *IN05     IFEQ *ON                                       CLE004
     C                     SETON                     42    HISTS REC. READCLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** For ACTN4 processing,setup fields for O/P to HIUPDHP, INTSTHN    CLE004
      *  and CUTX1HN                                                      CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     Z-ADDPRAM      PAMONT                          CLE004
     C                     Z-ADD0         IAMONT                          CLE004
      *                                                                                     AR790759
     C           WPDCL     IFEQ 'N'                                                         AR790759
     C                     ADD  PRAM      WOPRIN                                            AR790759
     C                     ENDIF                                                            AR790759
      *                                                                   CLE004
     C           BGN0ST    IFEQ 'Y'                                       CLE004
     C                     Z-ADD0         CAMONT                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NPAMNT                                              CAS005
     C                     Z-ADD*ZEROS    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
     C                     Z-ADD0         TAMONT                          CLE004
     C                     Z-ADD0         FAMONT                          CLE004
     C                     Z-ADD0         FEECOD                          CLE004
     C                     MOVE ' '       WRTOFF                          CLE004
     C                     Z-ADD0         EXVDAT                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *  If Action ind. is equal to 'Y' output record to HIUPDHN,         CLE004
      *  ACTN5DK                                                          CLE004
      *                                                                   CLE004
     C           *IN72     IFEQ *OFF                                      CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
     C           *IN72     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
      *                                                                   CLE004
     C           *IN72     OREQ *ON                                       CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     SETON                     4556                 CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETOF                     18    O/P AS I/P     CLE004
      *                                                                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
      *  Update record counter for both NHIUPD and NACTN5 fields          CLE004
      *                                                                   CLE004
     C                     ADD  1         NHIUPD                          CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     ADD  1         NACTN5     24                   CLE004
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *  Move Value date of amendment type to the current interest        CLE004
      *  header value date.                                               CLE004
      *                                                                   CLE004
     C                     Z-ADDVDAT      PHVDAT                          CLE004
      *                                                                   CLE004
      ** Output line to report if current principal -VE.(If not maturing).CLE004
      *                                                                   CLE004
     C           *IN68     IFEQ *OFF                                      CLE004
     C                     EXSR CREDIT                                    CLE004
      *                                                                   CLE004
     C           *INU7     IFEQ *ON                                       CLE004
     C           *INU8     ANDEQ*ON                                       CLE004
     C                     GOTO PRTOE                      DATABASE ERROR CLE004
     C                     ENDIF                           END SR         CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *  If coming off from the Action record, update Parts Sold          CLE004
      *  file and Parts Sold trailer.                                     CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C           PTYP      IFEQ 66                                        CLE004
     C                     MOVE *ON       *IN84                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN84     IFEQ *OFF                                      CLE004
     C           PTYP      ANDEQ67                                        CLE004
     C                     MOVE *ON       *IN84                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE005
      ** Processing types 69 and 72 are new and introduced by CLE005      CLE005
      ** for call parts sold and risk parts sold, respectively            CLE005
      *                                                                   CLE005
     C           *IN84     IFEQ *OFF                                      CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE *ON       *IN84                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C           *IN84     IFEQ *ON                                       CLE004
     C                     ADD  1         NPTSLD                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETOF                         84               CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                           **** *IN72 *** CLE004
      *                                                                   CLE004
      ** Pay/Receive Telexes & Confirmations produced for ACTN4 Recs. onlyCLE004
      *                                                                   CLE004
     C           *INU3     IFEQ *OFF                                      CLE004
     C********** *IN12     OREQ *ON                                                    CLE004 204128
     C           *IN12     ANDEQ'1'                                                           204128
      *                                                                   CLE004
     C           TLXY      IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN82                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CNFY      IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN83                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETOF                     18    O/P AS I/P     CLE004
      *                                                                   CLE004
     C           *IN82     IFEQ *ON                                       CLE004
     C           *IN83     OREQ *ON                                       CLE004
     C           OSBR      IFEQ *BLANK                                    CLE004
     C                     MOVE BRCA      OSBR                            CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CLE031
      ** If indicator 82 is on and if feature CLE031 is on.                                   CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETLLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C           *IN82     IFEQ *ON                                       CLE004
     C                     ADD  1         NLETLX                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN83     IFEQ *ON                                       CLE004
     C                     ADD  1         NCONFS                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETOF                     8283                 CLE004
      *                                                                   CLE004
     C                     ENDIF                           *** *INU3 **** CLE004
      *                                                                   CLE004
      ** Set up Interest Accrued up to and including this movement        CLE004
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           AITC      ADD  AIAP      TINTTM                          CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADDACCINT    TINTTM                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     EXSR INTSDY                                                        236196
     C                     ENDIF                                                              236196
      *                                                                   CLE004
      ** Output Rec. to S/INTSTHN if necessary                            CLE004
      *                                                                   CLE004
     C           *IN21     IFEQ *ON                        INT.HD.READ    CLE004
     C           *IN22     OREQ *OFF                       NO.INT.HD.O/P  CLE004
     C           *IN71     OREQ *ON                        DEMAND LOAN    CLE004
     C           *IN63     OREQ *ON                        INT PAYM'TS    CLE004
      *                                                                   CLE004
     C                     SETON                     58                   CLE004
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NINTST                          CLE004
     C                     ADD  1         NOSTRC                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       236196
     C           INTST     IFEQ '1'                                                           236196
     C                     GOTO PRTOE                                                         236196
     C                     ENDIF                                                              236196
      *                                                                   CLE004
      ** Output Rec. to S/CUTX1 If necessary                              CLE004
      *                                                                   CLE004
     C           *INU3     IFEQ *OFF                                      CLE004
      *                                                                   CLE004
     C           VDAT      IFGT LTVD                                      CLE004
     C                     MOVE *ON       *IN30                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN30     IFEQ *ON                                       CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
     C           CBLY      IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN31                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0400C100
      *                                                                   CLE004
      * Only output to CUTX1HP If necessary                               CLE004
      *                                                                   CLE004
     C           *IN60     IFEQ *ON                                       CLE004
     C           *IN22     OREQ *ON                                       CLE004
      *                                                                   CLE004
     C           *IN30     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
      *                                                                   CLE004
     C           *IN30     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
     C           *IN31     ANDEQ*ON                                       CLE004
      **                                                                  CLE004
      * Only Output to CUTX1HP if Total due is Positive                   CLE004
      **                                                                  CLE004
     C********** PAMONT    ADD  IAMONT    SUMONT     78                   CLE004              200707
     C           PAMONT    ADD  IAMONT    SUMONT     78  78                                   200707
     C           *IN78     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If indicator 78 is on and if feature CLE031 is on                                    CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                           ***** *INU3 ***CLE004
      *                                                                   CLE004
     C           PRTOE     ENDSR                                          CLE004
     C********************************************************************CLE004
     C*                                                                   CLE004
     C** PRINFR SUBROUTINE - PROCESS NEW AMENDMENT TYPE 'PF' - TRANSFER   CLE004
     C*                      OF PRINCIPAL FROM                            CLE004
     C*                                                                   CLE004
     C** CALLED BY:  HIST, ACTN                                           CLE004
     C** CALLS:      OUTBVH, OUTINH, INTHED                               CLE004
     C*                                                                   CLE004
     C********************************************************************CLE004
     C           PRINFR    BEGSR                           ** PRINFR **   CLE004
      *                                                                                     AR790759
     C                     MOVE 'N'       WPDCL                                             AR790759
     C                     MOVELLTYP      WLLTYP  1                                         AR790759
     C           WLLTYP    IFEQ 'X'                                                         AR790759
     C           WLLTYP    OREQ 'Y'                                                         AR790759
     C           WLLTYP    OREQ 'Z'                                                         AR790759
     C                     MOVE 'Y'       WPDCL                                             AR790759
     C                     ENDIF                                                            AR790759
      *                                                                   CLE004
     C           *IN25     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
     C                     EXSR INTHED                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Output B/V and/or INT. Headers to S/HIUPD If necessary           CLE004
      *                                                                   CLE004
     C                     EXSR OUTBVH                                    CLE004
      *                                                                   CLE004
     C                     EXSR OUTINH                                    CLE004
      *                                                                   CLE004
      ** Perform Int. Calcs. If necessary                                 CLE004
      *                                                                   CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C                     EXSR INTCAL                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C/COPY WNCPYSRC,LE0400C082
     C           W#CPAM    SUB  PRAM      CPAM                            CLE004
     C********** W#IPRD    ADD  INTA      IPRD                                        CLE004 248851A
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#FSCP    SUB  FSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0400C083
     C           *IN23     IFEQ *ON                                       CLE004
     C           W#AITC    ADD  INT       AITC      H                     CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADDW#AITC    AITC                            CLE004
     C                     ENDIF                                          CLE004
     C                     Z-ADDW#INTR    INTR                            CLE004
     C                     Z-ADDW#AIAP    AIAP                            CLE004
     C*                                                                   157669
     C           BGN0ST    IFEQ 'Y'                                       157669
     C           W#COFD    ADD  COFA      COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDW#COFR    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C*                                                                   157669
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           W#IPRD    ADD  WCAMT     IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
      ** Subtract PF Amount from Outstanding Principal                    CLE004
      *                                                                   CLE004
     C                     SUB  PRAM      OSPRIN                          CLE004
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     SUB  FSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
      ** Set Up Fields for Output and Calculate Total Amount              CLE004
      *  If action record ind. is on                                      CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C                     Z-ADDPRAM      OPPRAM                          CLE004
     C           *IN17     IFEQ *OFF                                      CLE004
     C                     ADD  OPPRAM    OPTAMT                          CLE004
     C                     ADD  OPINTA    OPTAMT                          CLE004
     C                     ADD  FEAM      OPTAMT                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN17     IFEQ *ON                                       CLE004
     C                     Z-ADDTAMT      OPTAMT                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NOPPRA                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
     C                     MOVE ' '       OPINTC  1                       CLE004
      *                                                                   CLE004
     C                     SETOF                     17                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Output Recs. to S/HIUPD and S/ACTN5                              CLE004
      *                                                                   CLE004
     C           *IN05     IFEQ *ON                                       CLE004
     C                     SETON                     42    HISTS REC. READCLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** For ACTN4 Processing,setup fields for O/P to HIUPD,INTST or CUTX1CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     Z-ADDOPPRAM    PAMONT                          CLE004
     C                     Z-ADDOPINTA    IAMONT                          CLE004
      *                                                                                     AR790759
     C           WPDCL     IFEQ 'N'                                                         AR790759
     C                     SUB  OPPRAM    WOPRIN                                            AR790759
     C                     ENDIF                                                            AR790759
      *                                                                   CLE004
     C           BGN0ST    IFEQ 'Y'                                       CLE004
     C                     Z-ADDOPCOFA    CAMONT                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDNOPPRA    NPAMNT                                              CAS005
     C                     Z-ADDOPINTA    NAMONT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
     C                     Z-ADDOPWTXA    TAMONT                          CLE004
     C                     Z-ADDFEAM      FAMONT                          CLE004
     C                     Z-ADDFECD      FEECOD                          CLE004
     C                     MOVE LWOI      WRTOFF                          CLE004
     C                     Z-ADDXAVD      EXVDAT                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** FOR ACTN4 PROCESSING, ONLY O/P RECS. IF ACTION IND. IS 'Y'       CLE004
      *                                                                   CLE004
     C           *IN72     IFEQ *OFF                                      CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
     C           *IN72     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
      *                                                                   CLE004
     C           *IN72     OREQ *ON                                       CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     SETON                     455618               CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     ADD  1         NHIUPD                          CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     ADD  1         NACTN5     24                   CLE004
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Move Value date of amendment type to the current interest                           248851A
      ** header value date.                                                                  248851A
      *                                                                                      248851A
     C                     Z-ADDVDAT      PHVDAT                                             248851A
      *                                                                   CLE004
      ** Output Line to Report if Current Principal -VE.(If not Maturing) CLE004
      *                                                                   CLE004
     C           *IN68     IFEQ *OFF                                      CLE004
     C                     EXSR CREDIT                                    CLE004
     C           *INU7     IFEQ *ON                                       CLE004
     C           *INU8     ANDEQ*ON                                       CLE004
     C                     GOTO PRFRE                      DATABASE ERROR CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                           ***** *IN72 ***CLE004
      *                                                                   CLE004
      ** Output Rec. To S/PTSLD If necessary.(ACTN4 Processing only).     CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C           PTYP      IFEQ 66                                        CLE004
     C                     MOVE *ON       *IN84                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN84     IFEQ *OFF                                      CLE004
     C           PTYP      IFEQ 67                                        CLE004
     C                     MOVE *ON       *IN84                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE005
      ** Processing types 69 and 72 are new and introduced by CLE005      CLE005
      ** for call parts sold and risk parts sold, respectively            CLE005
      *                                                                   CLE005
     C           *IN84     IFEQ *OFF                                      CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE *ON       *IN84                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C           CLE004    IFEQ 'Y'                                       149915
     C                     EXSR CHKIPP                                    149915
     C                     ENDIF                                          149915
      *                                                                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C           *IN84     IFEQ *ON                                       CLE004
     C                     ADD  1         NPTSLD                          CLE004
     C                     ENDIF                                          CLE004
     C                     SETOF                     84                   CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       202628
      ** Pay/Receive Telexes & Confirmations produced for ACTN4 Recs. only                    202628
      *                                                                                       202628
     C           *INU3     IFEQ *OFF                                                          202628
     C********** *IN12     OREQ *ON                                                    202628 204128
     C           *IN12     ANDEQ'1'                                                           204128
      *                                                                                       202628
     C           TLXY      IFEQ 'Y'                                                           202628
     C                     MOVE *ON       *IN82                                               202628
     C                     ENDIF                                                              202628
      *                                                                                       202628
     C           CNFY      IFEQ 'Y'                                                           202628
     C                     MOVE *ON       *IN83                                               202628
     C                     ENDIF                                                              202628
      *                                                                                       202628
     C                     SETOF                     18    O/P AS I/P                         202628
      *                                                                                       202628
     C           *IN82     IFEQ *ON                                                           202628
     C           *IN83     OREQ *ON                                                           202628
     C           OSBR      IFEQ *BLANK                                                        202628
     C                     MOVE BRCA      OSBR                                                202628
     C                     ENDIF                                                              202628
     C                     ENDIF                                                              202628
      *                                                                                       202628
      ** If indicator 82 is on and if CLE031 is on                                            CLE031
      ** Set work type to 'start' and do SR/SETCCY and SR/SETLLX                              CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                                         202628
      *                                                                                       202628
     C           *IN82     IFEQ *ON                                                           202628
     C                     ADD  1         NLETLX                                              202628
     C                     ENDIF                                                              202628
      *                                                                                       202628
     C           *IN83     IFEQ *ON                                                           202628
     C                     ADD  1         NCONFS                                              202628
     C                     ENDIF                                                              202628
      *                                                                                       202628
     C                     SETOF                     8283                                     202628
      *                                                                                       202628
     C                     ENDIF                           *** *INU3 ****                     202628
      *                                                                   CLE004
      ** Output Rec. to S/CUTX1 If necessary                              CLE004
      *                                                                   CLE004
     C           *INU3     IFEQ *OFF                                      CLE004
      *                                                                   CLE004
     C           VDAT      IFEQ LTVD                                      CLE004
     C                     MOVE *ON       *IN30                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      * Only output to CUTX1HP If necessary                               CLE004
      *                                                                   CLE004
     C           *IN30     IFEQ *ON                                       CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
     C           CBLY      IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN31                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0400C101
      *                                                                   CLE004
     C           *IN60     IFEQ *ON                                       CLE004
     C           *IN22     OREQ *ON                                       CLE004
      *                                                                   CLE004
     C           *IN30     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
      *                                                                   CLE004
     C           *IN30     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
     C           *IN31     ANDEQ*ON                                       CLE004
      **                                                                  CLE004
      * Only Output to CUTX1HP if Total due is Positive                   CLE004
      **                                                                  CLE004
     C********** PAMONT    ADD  IAMONT    SUMONT     78                   CLE004              200707
     C           PAMONT    ADD  IAMONT    SUMONT     78  78                                   200707
     C           *IN78     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If indicator 78 is on and if CLE031 is on                                            CLE031
      ** Set work type to 'end' and do SR/SETCCY and SR/SETCLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN78     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETCLX                                                        CLE031
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
     C                     ADD  1         NCUTX1                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           PRFRE     ENDSR                                          CLE004
     C********************************************************************CLE004
     C*                                                                   CLE004
     C*  MROLL SUBROUTINE - PROCESS NEW AMENDMENT TYPE 'MR' - MULTI -     CLE004
     C*                      CURRENCY ROLLOVER                            CLE004
     C*                                                                   CLE004
     C*  CALLED BY:  HIST, ACTN                                           CLE004
     C***CALLS:******OUTBVH,*OUTINH,*INTHED,*INTCAL****************CLE004 147438
     C*  CALLS:      OUTBVH, OUTINH, INTHED, INTCAL, SRCONV               147438
     C*                                                                   CLE004
     C********************************************************************CLE004
     C           MROLL     BEGSR                           ** MROLL **    CLE004
      *                                                                   CLE004
      *  Determine whether this is the first MC for each loan             CLE004
      *                                                                   CLE004
     C           LNRF      IFNE W#LNRF                                    CLE004
     C                     MOVE LNRF      W#LNRF                          CLE004
     C                     Z-ADD1         W#NO    30                      CLE004
     C                     ELSE                                           CLE004
     C                     ADD  1         W#NO                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN25     IFEQ *ON                                       CLE004
     C           *IN21     ANDEQ*OFF                                      CLE004
     C                     EXSR INTHED                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Output B/V and/or INT. Headers to S/HIUPD If necessary           CLE004
      *                                                                   CLE004
     C                     EXSR OUTBVH                                    CLE004
      *                                                                   CLE004
     C                     EXSR OUTINH                                    CLE004
      *                                                                   CLE004
      ** Perform Int. Calcs. If necessary                                 CLE004
      *                                                                   CLE004
     C           *IN23     IFEQ *ON                                       CLE004
     C                     EXSR INTCAL                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Override the Base Rate in the History file if Base Rate change   CLE004
      ** today is Backvalued up to this Rollover date.                    CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *OFF                                      CLE004
     C           BVBCHG    IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN30                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN30     IFEQ *ON                                       CLE004
     C           VDAT      IFGT BVBRVD                                    CLE004
     C           VDAT      OREQ BVBRVD                                    CLE004
     C                     MOVE *ON       *IN30                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *OFF      *IN30                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN30     IFEQ *ON                                       CLE004
     C                     Z-ADDNEWBRT    BRTE                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      * Recalculate effective interest rate for back valued base          CLE004
      * rate change even if new calc. basis = 0.                          CLE004
      *                                                                   CLE004
     C           CALC      IFEQ 0                                         CLE004
     C                     MOVE *ON       *IN85                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *OFF                                      CLE004
     C           *IN30     ANDEQ*ON                                       CLE004
     C           *IN85     ANDEQ*ON                                       CLE004
     C                     Z-ADDBRTE      BASERT                          CLE004
     C                     EXSR QNTRAT                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0400C084
     C**********           Z-ADDW#CPAM    CPAM                            CLE004              208622
     C                     Z-ADDW#IPRD    IPRD                            CLE004
     C/COPY WNCPYSRC,LE0400C085
     C           *IN23     IFEQ *ON                                       CLE004
     C           W#AITC    ADD  INT       AITC      H                     CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADDW#AITC    AITC                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           SPIN      IFNE ' '                                       CLE004
     C           BRTT      ORNE 0                                         CLE004
     C           BRTE      ORNE 0                                         CLE004
     C                     Z-ADDBRTT      BASECD                          CLE004
     C                     Z-ADDBRTE      BASERT                          CLE004
     C                     Z-ADDRTSP      SPREAD                          CLE004
     C                     EXSR QNTRAT                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *  If this is the first record for a new loan and no base or        CLE004
      *  spread rate are entered then set up the record using these       CLE004
      *  values.                                                          CLE004
      *                                                                   CLE004
     C           W#NO      IFEQ 1                                         CLE004
     C           SPIN      IFEQ ' '                                       CLE004
     C           BRTT      ANDEQ0                                         CLE004
     C           BRTE      ANDEQ0                                         CLE004
     C                     Z-ADDBRTT      BASECD                          CLE004
     C                     Z-ADDBRTE      BASERT                          CLE004
     C                     EXSR QNTRAT                                    CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           CALC      IFNE 0                                         CLE004
     C                     Z-ADDCALC      ICALCB                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     Z-ADDINTRAT    INTR                            CLE004
     C                     Z-ADDW#AIAP    AIAP                            CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN85     IFEQ *OFF                                      CLE004
     C                     Z-ADDBRTT      BASECD                          CLE004
     C                     Z-ADDBRTE      BASERT                          CLE004
     C                     Z-ADDRTSP      SPREAD                          CLE004
     C                     MOVE SPIN      SPRIND                          CLE004
     C                     Z-ADDCALC      ICALCB                          CLE004
     C                     EXSR QNTRAT                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           BGN0ST    IFEQ 'Y'                                       CLE004
     C           CDE002    OREQ 'Y'                                                           208221
     C********** FPRC      IFEQ *BLANKS                                                CLE004 204786
     C           FPRC      IFNE *BLANKS                                                       204786
     C           FSRP      ANDEQ*ZEROS                                                        204786
     C                     MOVE '1'       *IN26                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN26                           CLE004
     C                     Z-ADDFSRP      FUNDRT                          CLE004
     C                     MOVE FSGN      FUNDSN                          CLE004
     C                     MOVE FPRC      FUNPRF                          CLE004
     C                     ENDIF                                          CLE004
     C                     EXSR QCFRAT                                    CLE004
     C           CLE003    IFEQ 'Y'                                       157669
     C                     Z-ADDW#COFD    COFD                            157669
     C           *IN23     IFEQ *ON                                       157669
     C           W#ACDA    ADD  COF       ACDA      H                     157669
     C                     ELSE                                           157669
     C                     Z-ADDW#ACDA    ACDA                            157669
     C                     ENDIF                                          157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADDW#ACAP    ACAP                            157669
     C                     ENDIF                                          157669
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDW#IPRN    IPRN                                                CAS005
     C                     Z-ADDW#AIAN    AIAN                                                CAS005
     C           *IN23     IFEQ *ON                                                           CAS005
     C           W#AITN    ADD  WCAMT     AITN                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW#AITN    AITN                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CEU020
      ** If CEU020 is installed, the value of ECIN should be 'Y'          CEU020
      ** Also, check the array for the correct outstanding principal      147438
      ** and then convert it to the Euro currency                         147438
      *                                                                   CEU020
     C           CEU020    IFEQ 'Y'                                       CEU020
     C***********          MOVE 'Y'       ECIN                     CEU020 165975
     C                     Z-ADD1         W       30                      147438
     C                     MOVE '0'       *IN81                           147438
     C           *IN81     DOUEQ'0'                                       147438
     C           LNRF      LOKUPALNF,W                   81               147438
     C           *IN81     IFEQ '1'                                       147438
     C           VDAT      ANDEQADTE,W                                    147438
     C                     Z-ADDAAMT,W    PFRAM                           147438
     C                     MOVE ACCY,W    PFRCY                           147438
     C                     MOVE RLCY      PTOCY                           147438
     C                     EXSR SRCONV                                    147438
     C                     Z-ADDPOUTA     MCPRAM 130                      147438
     C                     Z-ADDPOUTA     MCTAMT 130                      147438
     C                     Z-ADDPOUTA     PRAM                            147438
     C                     Z-ADDPOUTA     TAMT                            147438
     C                     LEAVE                                          147438
     C                     ENDIF                                          147438
     C                     ADD  1         W                               147438
     C                     ENDDO                                          147438
     C                     ENDIF                                          CEU020
      *                                                                   CLE004
      ** Output Recs.to S/HIUPDHN and S/ACTN5DK                           CLE004
      *                                                                   CLE004
     C           *IN06     IFEQ *ON                                       CLE004
     C                     SETON                     42                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** For ACTN4 Processing,Setup fields for O/P to HIUPD,INTST or CUTX1CLE004
     C***********          MOVE CCY       W#CCY   3                 CLE004127069
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     Z-ADDBASECD    BRATEC     30                   CLE004
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           *IN30     ANDEQ'0'                                                           CLE036
     C           BASERT    ANDGT0                                                             CLE036
     C                     MOVE '1'       *IN30                                               CLE036
     C                     ENDIF                                                              CLE036
     C***********          MOVE RLCY      CCY                       CLE004127069
      *                                                                   CLE004
     C                     Z-ADDSPREAD    RATSPD                          CLE004
     C                     MOVE SPRIND    SPINDI                          CLE004
      *                                                                   CLE004
     C           *IN30     IFEQ *ON                                       CLE004
     C                     Z-ADDBASERT    BRATE                           CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADD0         BRATE                           CLE004
     C                     Z-ADD0         BASERT                          CLE004
     C                     EXSR QNTRAT                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *  Only maintain INTR field if CLE003 is switched on.               172807
     C           CLE003    IFEQ 'Y'                                       172807
     C                     Z-ADDINTRAT    INTR                            CLE004
     C                     ENDIF                                          172807
      *                                                                   CLE004
      * If no new Calculation Basis entered default to previous.          CLE004
      *                                                                   CLE004
     C***********CALC      IFEQ 0                                  CLE004 144911
     C***********          Z-ADDCALCS     ICALCB                   CLE004 144911
     C***********          Z-ADDCALCS     CALBAS                   CLE004 144911
     C***********          ELSE                                    CLE004 144911
     C***********          Z-ADDCALC      ICALCB                   CLE004 144911
     C***********          Z-ADDCALC      CALBAS                   CLE004 144911
     C***********          Z-ADDCALC      CALCS                    CLE004 144911
     C***********          ENDIF                                   CLE004 144911
      *                                                                   144911
     C                     Z-ADDICALCB    CALBAS                          144911
      *                                                                   CLE004
     C                     Z-ADDPRAM      OSPRIN                          CLE004
     C                     Z-ADD0         INTA                            CLE004
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
     C                     ELSE                            History 'MC'   172807
      *  Must update OSPRIN with CPAM from history because the            172807
      *  previous value of OSPRIN was paid off in the old currency.       172807
     C                     Z-ADDCPAM      OSPRIN           New Ccy Princip172807
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSCPAM    NOSPRI                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           BGN0ST    IFEQ 'Y'                                       CLE004
     C           *IN12     ANDEQ'1'                                       CLE004
     C           CDE002    OREQ 'Y'                                                           208221
     C           *IN12     ANDEQ'1'                                                           208221
     C                     Z-ADDFUNDRT    FUNDSP                          CLE004
     C                     MOVE FUNDSN    FUNDSG                          CLE004
     C                     MOVE FUNPRF    FUNDPC                          CLE004
     C                     MOVE ' '       INTFLG                          CLE004
     C                     MOVE ' '       COFFLG                          CLE004
     C                     EXSR QCFRAT                                    157669
     C                     Z-ADDCOFRAT    COFR                            157669
     C                     Z-ADD0         COFA                            157669
     C                     ENDIF                                          CLE004
      ************                                                 CLE004 143510
      **Initialise all work fields for computed interest           CLE004 143510
      ***********                                                  CLE004 143510
     C***********          Z-ADD0         ACCINT                   CLE004 143510
     C***********          Z-ADD0         AIIACD                   CLE004 143510
      ** MC history does not have PRAM field, so do below only for        147438
      ** records coming from the action file                              147438
      *                                                                   CLE004
      *  CPAM is used to store the new principal amount for a multi-      172807
      *  currency rollover, even if CLE003 is switched off, because       172807
      *  there is no other principal amount field available in HISTSHQ.   172807
      *  However, for all other history records, fields CPAM, INTR, etc   172807
      *  should be zero if CLE003 is switched off.                        172807
      *                                                                   172807
      * Initialise all new fields in HIUPD to the fields computed above   CLE004
      *                                                                   CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ '1'                                       147438
     C                     Z-ADDPRAM      CPAM                            CLE004
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPRAM    FSCPAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                          147438
      *                                                                   CLE004
      * Only blank out these fields for first record.                     CLE004
      *                                                                   CLE004
     C***********W#NO      IFEQ 1                                  CLE004 169623
     C***********          Z-ADD0         AITC                     CLE004 169623
     C***********          Z-ADD0         IPRD                     CLE004 169623
     C***********          ENDIF                                   CLE004 169623
      *                                                                   CLE004
     C           W#NO      IFEQ 1                                         157669
     C                     Z-ADD0         ACDA                            157669
     C                     Z-ADD0         COFD                            157669
     C                     ENDIF                                          157669
      *                                                                   CLE004
      * Update Principal on History Header for JSM.                       CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C           PTYP      IFEQ 63                                        CLE004
     C           PTYP      OREQ 65                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C           PTYP      OREQ 67                                        122098
     C           CLE004    ANDEQ'Y'                                       138979
     C                     Z-ADDPRAM      PRINRO                          CLE004
     C                     Z-ADDINTA      DISCRO                          CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADD0         PRINRO                          CLE004
     C                     Z-ADD0         DISCRO                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CLE031
      ** If CLE031 is on AND the principal amount is not zero                                 CLE031
      ** AND the currency principal amount is not zero then set                               CLE031
      ** OSPRIN and PRINRO to be the equal to the principal amount                            CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PRAM      ANDNE*ZEROS                                                        CLE031
     C           WFPAM     ANDNE*ZEROS                                                        CLE031
     C                     Z-ADDPRAM      OSPRIN                                              CLE031
     C                     Z-ADDPRAM      PRINRO                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CLE004
      *                                                                   CLE004
      **    If change ind on RO Action Record is blank use value          CLE004
      **    held on Control Record                                        CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
      *                                                                   CLE004
     C           CHIN      IFEQ ' '                                       CLE004
     C                     MOVE *ON       *IN30                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN30     IFEQ *OFF                                      CLE004
     C                     MOVE CHIN      CHGIND                          CLE004
     C                     ELSE                                           CLE004
     C                     MOVE CHINA     CHGIND                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** For ACTN4 processing, only output recs. If action ind. is 'Y'    CLE004
      *                                                                   CLE004
     C           *IN72     IFEQ *OFF                                      CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
     C           *IN72     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
      *                                                                   CLE004
     C           *IN72     OREQ *ON                                       CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     SETON                     4557                 CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETOF                     18    O/P AS I/P     CLE004
      *                                                                   CLE004
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C                     MOVE '0'       *IN81                           147438
     C                     ADD  1         NHIUPD                          CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C                     ADD  1         NACTN5     24                   CLE004
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C***********          MOVE W#CCY     CCY                       CLE004127069
     C                     Z-ADDVDAT      PHVDAT                          CLE004
      *                                                                   CLE004
      * Output Line to report if current Principal -VE.(If not maturing)  CLE004
      *                                                                   CLE004
     C           *IN68     IFEQ *OFF                                      CLE004
     C                     EXSR CREDIT                                    CLE004
      *                                                                   CLE004
     C           *INU7     IFEQ *ON                                       CLE004
     C           *INU8     ANDEQ*ON                                       CLE004
     C                     GOTO MROLLE                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                           ***** *IN72 ***CLE004
      *                                                                   CLE004
     C                     SETOF                     8526                 CLE004
      *                                                                   193225
      ** For forward valued multi-currency rollover, reset                193225
      ** indicator 81 to '0' so that the multi-currency event amount      193225
      ** won't be obtained by subsequent events when writing to           193225
      ** ACTN5DK file.                                                    193225
      *                                                                   193225
     C                     MOVE '0'       *IN81                           193225
      *                                                                   134725
      ** Generate 'MC' record in PTSLDPT                                  134725
      *                                                                   134725
     C           *IN12     IFEQ *ON                                       134725
      *                                                                   134725
     C           PTYP      IFEQ 66                                        134725
     C           PTYP      OREQ 67                                        134725
     C           CLE005    OREQ 'Y'                                       134725
     C           PTYP      ANDEQ69                                        134725
     C           CLE005    OREQ 'Y'                                       134725
     C           PTYP      ANDEQ72                                        134725
     C                     Z-ADDPRAM      PAMONT                                              185526
     C                     MOVE '1'       *IN84                           134725
     C                     EXSR EXCPT                                     134725
     C                     ADD  1         NPTSLD                          134725
     C                     MOVE '0'       *IN84                           134725
     C                     ENDIF                                          134725
     C                     ENDIF                                          134725
      *                                                                   CLE004
      * Pay/Receive Telexes                                               CLE004
      *                                                                   CLE004
     C           *IN12     IFEQ *ON                                       CLE004
     C           *INU3     ANDEQ*OFF                                      CLE004
      *                                                                   CLE004
     C           TLXY      IFEQ 'Y'                                       CLE004
     C                     SETON                     82                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETOF                     18                   CLE004
      *                                                                                       CLE031
      ** If indicator 82 is on and if CLE031 is on                                            CLE031
      ** set work type to 'end' and do SR/SETCCY and SR/SETLLX                                CLE031
      ** only if CLE034 is disabled or Set. Allocation <> 'Y'.                                CLE034
      *                                                                                       CLE031
     C           *IN82     IFEQ *ON                                                           CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'N'                                                           CLE034
     C           WSTAL     ORNE 'Y'                                                           CLE034
     C                     MOVE 'E'       WTYPE                                               CLE031
     C                     EXSR SETCCY                                                        CLE031
     C                     EXSR SETOSB                                                        CLE033
     C                     EXSR SETLLX                                                        CLE031
     C                     ELSE                                                               CLE034
     C                     MOVE 'E'       WTYPE                                               CLE034
     C                     EXSR SETOSB                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR EXCPT                                     CLE004
      *                                                                   CLE004
     C           *IN82     IFEQ *ON                                       CLE004
     C                     ADD  1         NLETLX                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     SETOF                     82                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      * Set up Interest Accrued up to and including this movement         CLE004
      *                                                                   CLE004
     C           CLE003    IFEQ 'Y'                                       CLE004
     C           AITC      ADD  AIAP      TINTTM                          CLE004
     C                     ELSE                                           CLE004
     C                     Z-ADDACCINT    TINTTM                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *  Output to CUTX1HQ if necessary                                   CLE004
      *                                                                   CLE004
     C           *INU3     IFEQ *OFF                                      CLE004
      *                                                                   CLE004
     C           VDAT      IFGT LTVD                                      CLE004
     C                     MOVE *ON       *IN30                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           *IN30     IFEQ *ON                                       CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
     C           CBLY      IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN31                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C/COPY WNCPYSRC,LE0400C102
      *                                                                   CLE004
     C           *IN60     IFEQ *ON                                       CLE004
     C           *IN22     OREQ *ON                                       CLE004
      *                                                                   CLE004
     C           *IN30     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*ON                                       CLE004
      *                                                                   CLE004
     C           *IN30     OREQ *OFF                                      CLE004
     C           *IN12     ANDEQ*OFF                                      CLE004
     C           *IN31     ANDEQ*ON                                       CLE004
      *                                                                   CLE004
     C                     MOVE *ON       *IN79                           CLE004
      *                                                                   CLE004
     C           VDAT      IFLT W#VDAT                                    CLE004
     C           W#VDAT    OREQ *ZEROS                                                        235743
     C                     MOVE 'Y'       BVMV                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       BVMV                            CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     EXSR EXCPT                                     CLE004
     C                     MOVE *BLANKS   ECIN                            CEU020
      *                                                                   CLE004
     C                     ADD  1         NCUTX1                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           MROLLE    ENDSR                                          CLE004
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE134
      *****************************************************************                       CLE134
      *                                                               *                       CLE134
      *  SRWLEG - Subroutine to set fields to be written to LELEGDPD  *                       CLE134
      *                                                               *                       CLE134
      *  Called By: MANREP, INTPAY, REPAY                             *                       CLE134
      *                                                               *                       CLE134
      *  Calls:                                                       *                       CLE134
      *                                                               *                       CLE134
      *****************************************************************                       CLE134
      *                                                                                       CLE134
     C           SRWLEG    BEGSR                                                              CLE134
      *                                                                                       CLE134
      ** Default values not in I-Specs                                                        CLE134
      ** Must be the same as output in ACTN5DK                                                CLE134
      *                                                                                       CLE134
     C           2         SUBSTLOTA3:650 DFTP                                                CLE134
     C           2         SUBSTLOTA3:652 DFST                                                CLE134
     C           1         SUBSTLOTA3:657 NRLI                                                CLE134
     C           3         SUBSTLOTA3:667 ROBR                                                CLE134
     C           1         SUBSTLOTA3:676 PDGN                                                CLE134
     C           1         SUBSTLOTA3:677 GRIN                                                CLE134
     C           1         SUBSTLOTA3:677 ASTS                                                CLE134
     C           10        SUBSTLOTA3:690 IUSR                                                CLE134
     C           10        SUBSTLOTA3:700 AUSR                                                CLE134
     C           10        SUBSTLOTA3:710 XUSR                                                CLE134
     C           15        SUBSTLOTA3:720 PCRF                                                CLE134
     C           3         SUBSTLOTA3:735 PCOB                                                CLE134
     C           1         SUBSTLOTA3:738 MTPD                                                CLE134
     C           1         SUBSTLOTA3:739 PDDI                                                CLE134
     C           1         SUBSTLOTA3:740 PTDI                                                CLE134
     C                     MOVELPSCR      PSCY                                                CLE134
     C           1         SUBSTLOTA3:911 AUTH                                                CLE134
     C           3         SUBSTLOTA3:912 FRCY                                                CLE134
      *                                                                                       CLE134
      **  FPEN 13P0 943 ?? >> move in I-Specs                                                 CLE134
      **  BASR 11P7 950 ?? >> move in I-Specs                                                 CLE134
      *                                                                                       CLE134
     C           2         SUBSTLOTA3:956 SLTP                                                CLE134
     C           2         SUBSTLOTA3:958 SLST                                                CLE134
     C           4         SUBSTLOTA3:964 DFCL                                                CLE134
     C           4         SUBSTLOTA3:968 SLCL                                                CLE134
     C                     Z-ADDPRAMN     FSPRAM                                              CLE134
      *                                                                                       CLE134
     C           *IN18     IFEQ *ON                                                           CLE134
     C                     Z-ADDOPPRAM    PRAM                                                CLE134
     C                     Z-ADDOPINTA    INTA                                                CLE134
     C                     Z-ADDOPWTXA    WTXA                                                CLE134
     C                     Z-ADDOPTAMT    TAMT                                                CLE134
     C                     MOVELOPINTC    INTC                                                CLE134
     C                     Z-ADDOPCOFA    COFA                                                CLE134
     C                     Z-ADDOPINTN    CHDU                                                CLE134
     C                     Z-ADDNOPPRA    INTN                                                CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
     C           *IN81     IFEQ *ON                                                           CLE134
     C                     Z-ADDMCPRAM    PRAM                                                CLE134
     C                     Z-ADDMCTAMT    TAMT                                                CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
     C           *IN85     IFEQ *ON                                                           CLE134
     C                     Z-ADDBRATEC    BRTT                                                CLE134
     C                     Z-ADDRATSPD    RTSP                                                CLE134
     C                     MOVELSTSTAC    STAI                                                CLE134
     C                     Z-ADDBRATE     BRTE                                                CLE134
     C                     MOVELSPINDI    SPIN                                                CLE134
     C                     Z-ADDCALBAS    CALC                                                CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
     C                     MOVELCHGIND    ZZ001                                               CLE134
      *                                                                                       CLE134
     C           *IN26     IFEQ *ON                                                           CLE134
     C                     Z-ADDFUNDSP    FSRP                                                CLE134
     C                     MOVELFUNDSG    FSGN                                                CLE134
     C                     MOVELFUNDPC    FPRC                                                CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      ** Set Grace Days fields                                                                CLE134
      *                                                                                       CLE134
     C                     MOVEL'D'       SERECI                                              CLE134
     C                     MOVELLNRF      SELNRF                                              CLE134
     C                     Z-ADDVDAT      SEVDAT                                              CLE134
     C                     MOVELLTYP      SELTYP                                              CLE134
     C                     MOVELSUTP      SESUTP                                              CLE134
     C                     MOVELLTYP      SELTY1                                              CLE134
      *                                                                                       CLE134
     C                     Z-ADDPRAM      SEPRAM                                              CLE134
     C                     Z-ADDINTA      SEINTA                                              CLE134
     C                     Z-ADDTAMT      SETAMT                                              CLE134
      *                                                                                       CLE134
      ** Override the value when *IN18 = *ON                                                  CLE134
      *                                                                                       CLE134
     C           *IN18     IFEQ *ON                                                           CLE134
     C                     Z-ADDOPPRAM    SEPRAM                                              CLE134
     C                     Z-ADDOPINTA    SEINTA                                              CLE134
     C                     Z-ADDOPTAMT    SETAMT                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      ** Override the value when *IN81 = *ON                                                  CLE134
      *                                                                                       CLE134
     C           *IN81     IFEQ *ON                                                           CLE134
     C                     Z-ADDMCPRAM    SEPRAM                                              CLE134
     C                     Z-ADDMCTAMT    SETAMT                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
     C**********           MOVEL'L2'      SEFILE                                       CLE134 CLE164
     C                     MOVE RUND      ACDT                                                CLE134
     C                     Z-ADD*ZERO     SEAAMT                                              CLE134
     C                     MOVE *BLANKS   SEIPFL                                              CLE134
     C                     Z-ADDVDAT      ORED                                                CLE134
      *                                                                                       CLE134
      ** Retrieve sett account and priority                                                   CLE134
      *                                                                                       CLE134
     C                     CALL 'LE000458'                                                    CLE134
     C                     PARM *BLANKS   RETCOD  7                                           CLE134
     C                     PARM           IACKEY 14                                           CLE134
     C                     PARM           CCY                                                 CLE134
     C                     PARM           LNRF                                                CLE134
     C                     PARM *BLANKS   IFCNUM  6                                           CLE134
     C                     PARM *ZEROS    IFLOAN  60                                          CLE134
     C                     PARM *ZEROS    IFFACL  50                                          CLE134
     C                     PARM *ZEROS    IFSEQ   20                                          CLE134
     C                     PARM *ZEROS    IFCOD   20                                          CLE134
     C                     PARM           SCCY                                                CLE134
     C                     PARM           OSAC                                                CLE134
     C                     PARM           SETP                                                CLE134
     C                     PARM           OLNO                                                CLE134
     C                     PARM           OSBR                                                CLE134
      *                                                                                       CLE134
     C                     PARM *BLANKS   SEBRCA                                              CLE134
     C                     PARM *BLANKS   SECNUM                                              CLE134
     C                     PARM *BLANKS   SEACCY                                              CLE134
     C                     PARM *ZEROS    SEACOD                                              CLE134
     C                     PARM *ZEROS    SEACSQ                                              CLE134
     C**********           PARM *ZEROS    SEPCKO                                       CLE134 CLE164
     C                     PARM *BLANKS   OATYP   1                                        AR1078348
     C           RETCOD    IFEQ '*ERROR*'                                                     CLE134
     C           *LOCK     IN   LDA                                                           CLE134
     C                     MOVEL'LE000458'DBPGM                                               CLE134
     C                     Z-ADD25        DBASE                                               CLE134
     C                     OUT  LDA                                                           CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      ***Get*the*value*of*Module*Priority*(SEPCKM)*********************                CLE134 CLE164
      *  Get the value of Category Code                                                       CLE164
      *                                                                                       CLE134
     C           OATYP     IFNE 'N'                                                        AR1078348
      *                                                                                       CLE164
      ** Execute RTRPKY and RTDTE to retrieve fields required                                 CLE164
      ** in LELEGDPD                                                                          CLE164
      *                                                                                       CLE164
     C                     EXSR SRSEPC                                                        CLE134
     C                     EXSR RTRPKY                                                        CLE164
     C                     EXSR RTDTE                                                         CLE164
     C                     Z-ADDINTA      SEPAMT                                              CLE164
     C                     ADD  PRAM      SEPAMT                                              CLE164
     C                     MOVEL'LELEGDPD'SEFILE                                              CLE164
      *                                                                                       CLE134
     C                     ADD  1         SETRID                                              CLE164
     C                     WRITELELEGDD0                                                      CLE134
     C                     ENDIF                                                           AR1078348
      *                                                                                       CLE134
     C                     ENDSR                                                              CLE134
      *****************************************************************                       CLE134
      /EJECT                                                                                  CLE134
      *****************************************************************                       CLE134
      *                                                               *                       CLE134
      *  SRSEPC - Set value of SEPCKM                                 *                       CLE134
      *                                                               *                       CLE134
      *  Called By: SRWLEG                                            *                       CLE134
      *                                                               *                       CLE134
      *  Calls: None                                                  *                       CLE134
      *                                                               *                       CLE134
      *****************************************************************                       CLE134
     C           SRSEPC    BEGSR                                                              CLE134
      ********************************************************************             CLE134 CLE164
      ***Non*PDCL*Principal***********************************************             CLE134 CLE164
      ***Default*to*700,*Principal****************************************             CLE134 CLE164
      ********************************************************************             CLE134 CLE164
     C**********           Z-ADD700       SEPCKM                                       CLE134 CLE164
      *                                                                                       CLE134
      ** Non PDCL Interest                                                                    CLE134
      ***If*Interest*set*Priority*650*************************************             CLE134 CLE164
      *                                                                                       CLE134
     C           AMTP      IFEQ 'IN'                                                          CLE134
     C           INTA      ORNE *ZEROS                                                        CLE134
     C           PRAM      ANDEQ*ZEROS                                                        CLE134
     C**********           Z-ADD650       SEPCKM                                       CLE134 CLE164
     C**********           ENDIF                                                       CLE134 CLE164
     C                     MOVE 'OLINT'   SECATC                                              CLE164
      *                                                                                       CLE164
     C                     SELEC                                                              CLE164
     C           SELTY1    WHEQ 'Z'                                                           CLE164
     C                     MOVE 'ZINTR'   SECATC                                              CLE164
     C           SELTY1    WHEQ 'Y'                                                           CLE164
     C                     MOVE 'YINTR'   SECATC                                              CLE164
     C           SELTY1    WHEQ 'X'                                                           CLE164
     C                     MOVE 'XINTR'   SECATC                                              CLE164
     C                     ENDSL                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           AMTP      IFEQ 'RE'                                                          CLE164
      *                                                                                       CLE134
      ** Non PDCL Principal                                                                   CLE134
      ***If*Principal*set*Priority*700************************************             CLE134 CLE164
      *                                                                                       CLE134
     C                     MOVE 'OLINT'   SECATC                                              CLE164
     C********** INTA      IFNE 0                                                      CLE134 CLE164
     C********** PRAM      ANDNE0                                                      CLE134 CLE164
     C**********           Z-ADD700       SEPCKM                                       CLE134 CLE164
     C**********           ENDIF                                                       CLE134 CLE164
      *                                                                                       CLE134
      ** Fee: PDCL Interest                                                                   CLE134
      ***PDCL*with*type*'Z'*have*priority*200*****************************             CLE134 CLE164
      *                                                                                       CLE134
     C           SELTY1    IFEQ 'Z'                                                           CLE134
     C**********           MOVE 200       SEPCKM                                       CLE134 CLE164
     C                     MOVE 'ZINTR'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      ** Interest: PDCL Interest                                                              CLE134
      ***PDCL*with*type*'Y'*have*priority*250*****************************                    CLE134
      *                                                                                       CLE134
     C           SELTY1    IFEQ 'Y'                                                           CLE134
     C**********           MOVE 250       SEPCKM                                       CLE134 CLE164
     C                     MOVE 'YINTR'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      ** Interest: PDCL Principal                                                             CLE134
      ***PDCL*with*type*'X'*have*priority*290*****************************                    CLE134
      *                                                                                       CLE134
     C           SELTY1    IFEQ 'X'                                                           CLE134
     C**********           MOVE 290       SEPCKM                                       CLE134 CLE164
     C                     MOVE 'XINTR'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE164
     C                     ELSE                                                               CLE164
     C           AMTP      IFEQ 'MR'                                                          CLE164
      *                                                                                       CLE164
     C                     MOVE 'OLINM'   SECATC                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Z'                                                           CLE164
     C                     MOVE 'ZINTM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Y'                                                           CLE164
     C                     MOVE 'YINTM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'X'                                                           CLE164
     C                     MOVE 'XINTM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
      ** End for Processing for Interest                                                      CLE164
      *                                                                                       CLE164
      *                                                                                       CLE134
      ** Fee: PDCL Principal                                                                  CLE134
      ***PDCL*with*type*'Z'*have*priority*300*****************************             CLE134 CLE164
      *                                                                                       CLE134
     C           WCPAM     IFNE 0                                                             CLE134
      *                                                                                       CLE164
     C           AMTP      IFEQ 'RE'                                                          CLE164
      *                                                                                       CLE164
     C                     MOVE 'OLPRI'   SECATC                                              CLE164
     C           SELTY1    IFEQ 'Z'                                                           CLE134
     C**********           MOVE 300       SEPCKM                                       CLE134 CLE164
     C                     MOVE 'ZPRIN'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      ** Principal: PDCL Interest                                                             CLE134
      ***PDCL*with*type*'Y'*have*priority*350*****************************             CLE134 CLE164
      *                                                                                       CLE134
     C           SELTY1    IFEQ 'Y'                                                           CLE134
     C**********           MOVE 350       SEPCKM                                       CLE134 CLE164
     C                     MOVE 'YPRIN'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      ** Principal: PDCL Principal                                                            CLE134
      ***PDCL*with*type*'X'*have*priority*390*****************************             CLE134 CLE164
      *                                                                                       CLE134
     C           SELTY1    IFEQ 'X'                                                           CLE134
     C**********           MOVE 390       SEPCKM                                       CLE134 CLE164
     C                     MOVE 'XPRIN'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE164
     C                     ELSE                                                               CLE164
     C           AMTP      IFEQ 'MR'                                                          CLE164
      *                                                                                       CLE164
     C                     MOVE 'OLPRM'   SECATC                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Z'                                                           CLE164
     C                     MOVE 'ZPRIM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Y'                                                           CLE164
     C                     MOVE 'YPRIM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'X'                                                           CLE164
     C                     MOVE 'XPRIM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE134
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE134
     C**********           MOVELSEPCKM    SEPCKT                                       CLE134 CLE164
      *                                                                                       CLE134
     C                     ENDSR                                                              CLE134
      *****************************************************************                       CLE134
      /EJECT                                                                                  CLE028
      *****************************************************************                       CLE028
      *                                                               *                       CLE028
      *  SRCHRG - Subroutine to add charge amount to Principal amount *                       CLE028
      *                                                               *                       CLE028
      *  Called By: ACTN  - Processes records read from S/ACTN4       *                       CLE028
      *                                                               *                       CLE028
      *  Calls:     *PSSR - Program Error Processing                  *                       CLE028
      *                                                               *                       CLE028
      *****************************************************************                       CLE028
      *                                                                                       CLE028
     C           SRCHRG    BEGSR                                                              CLE028
     C                     ADD  CHDU      OSPRIN                                              CLE028
     C                     Z-ADDCHDU      OPPRAM                                              CLE028
     C                     Z-ADDCHDU      WCHDU  130                                          CLE028
     C                     Z-ADDOPPRAM    PAMONT                                              CLE028
     C                     Z-ADDOPINTA    IAMONT                                              CLE028
     C           W#CPAM    ADD  PAMONT    CPAM                                                CLE028
      *                                                                                       CLE028
     C           *IN72     IFEQ *OFF                                                          CLE028
     C                     MOVE *ON       *IN45                                               CLE028
     C                     MOVE *ON       *IN56                                               CLE028
     C                     MOVE *OFF      *IN18                                               CLE028
      *                                                                                       CLE028
     C                     EXSR EXCPT                                                         CLE028
     C           NHIUPD    ADD  1         NHIUPD                                              CLE028
     C           NACTN5    ADD  1         NACTN5     24                                       CLE028
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDSR                                                              CLE028
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE028
      *****************************************************************                       CLE028
      *                                                               *                       CLE028
      *  SRINAI - Subroutine to add interest to Principal amount      *                       CLE028
      *                                                               *                       CLE028
      *  Called By: ACTN  - Processes records read from S/ACTN4       *                       CLE028
      *                                                               *                       CLE028
      *  Calls:     *PSSR - Program Error Processing                  *                       CLE028
      *                                                               *                       CLE028
      *****************************************************************                       CLE028
      *                                                                                       CLE028
     C           SRINAI    BEGSR                                                              CLE028
     C           *IN12     IFEQ '1'                                                           CLE028
     C                     Z-ADDINTA      OSPRIN                                              CLE028
     C                     Z-ADDINTA      OPPRAM                                              CLE028
     C                     Z-ADDINTA      WINTA  130                                          CLE028
     C                     ELSE                                                               CLE028
     C                     Z-ADDPRAM      OSPRIN                                              CLE028
     C                     Z-ADDPRAM      OPPRAM                                              CLE028
     C                     Z-ADDPRAM      WINTA  130                                          CLE028
     C                     ENDIF                                                              CLE028
     C                     Z-ADDOPPRAM    PAMONT                                              CLE028
     C                     Z-ADDOPINTA    IAMONT                                              CLE028
     C           W#CPAM    ADD  PAMONT    CPAM                                                CLE028
      *                                                                                       CLE028
     C           *IN72     IFEQ *OFF                                                          CLE028
     C                     MOVE *ON       *IN45                                               CLE028
     C                     MOVE *ON       *IN56                                               CLE028
     C                     MOVE *OFF      *IN18                                               CLE028
      *                                                                                       CLE028
     C                     EXSR EXCPT                                                         CLE028
     C           NHIUPD    ADD  1         NHIUPD                                              CLE028
     C           NACTN5    ADD  1         NACTN5     24                                       CLE028
      *                                                                                     MD026266
      ** If after increase NACTN5 is zero, switch on *IN24 to                               MD026266
      ** allow output of 'CO' record to ACTN5DN.                                            MD026266
      *                                                                                     MD026266
     C           NACTN5    IFEQ 0                                                           MD026266
     C                     MOVE *ON       *IN24                                             MD026266
     C                     ENDIF                                                            MD026266
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDSR                                                              CLE028
      *****************************************************************                       CLE028
      /EJECT                                                              147438
      *****************************************************************   147438
      *                                                               *   147438
      *  SRCONV - Subroutine to convert amounts to Euro ccy equivalent*   147438
      *                                                               *   147438
      *  Called By: MROLL - Processes multi-currency rollovers        *   147438
      *                                                               *   147438
      *  Calls:     *PSSR - Program Error Processing                  *   147438
      *                                                               *   147438
      *****************************************************************   147438
      *                                                                   147438
     C           SRCONV    BEGSR                                          147438
      *                                                                   147438
     C                     CALL 'EU0200'                                  147438
     C                     PARM *BLANKS   PRTCD   7                       147438
     C                     PARM           PFRAM  183                      147438
     C                     PARM           PFRCY   3                       147438
     C                     PARM           PTOCY   3                       147438
     C                     PARM           POUTA  150                      147438
     C                     PARM           PINTA  183                      147438
     C                     PARM           PEXRT  159                      147438
     C                     PARM           PMDIN   1                       147438
      *                                                                   147438
      ** Handle Error                                                     147438
      *                                                                   147438
     C           PRTCD     IFNE *BLANKS                                   147438
     C           *LOCK     IN   LDA                                       147438
     C                     MOVEL'EU0200  'DBFILE           ************   147438
     C                     MOVEL'*CALL   'DBKEY            * DBERR 16 *   147438
     C                     Z-ADD16        DBASE            ************   147438
     C                     OUT  LDA                                       147438
     C                     EXSR *PSSR                                     147438
     C                     ENDIF                                          147438
      *                                                                   147438
     C                     ENDSR                                          147438
      /EJECT                                                                                MD046080
      *****************************************************************                     MD046080
      * ZCONVZ  -  Convert amount from one currency to another        *                     MD046080
      * Called by: SETFLD                                             *                     MD046080
      * Calls    : NONE                                               *                     MD046080
      *                                                               *                     MD046080
      *****************************************************************                     MD046080
      *                                                                                     MD046080
     C           ZCONVZ    BEGSR                                                            MD046080
      *                                                                                     MD046080
     C                     CALL 'ZCONVZ1'                                                   MD046080
     C                     PARM           ZAMTCI 150                                        MD046080
     C                     PARM           ZEXCH  138                                        MD046080
     C                     PARM           ZMD     1                                         MD046080
     C                     PARM           ZCCYI   3                                         MD046080
     C                     PARM           ZCCYO   3                                         MD046080
     C                     PARM           ZCDPI   10                                        MD046080
     C                     PARM           ZCDPO   10                                        MD046080
     C                     PARM           ZAMTCO 150                                        MD046080
      *                                                                                     MD046080
     C                     ENDSR                                                            MD046080
      /EJECT                                                              149915
      *****************************************************************   149915
      * CHKIPP  -  Check if internal parts purchased.                 *   149915
      * Called by: MANREP                                             *   149915
      * Calls    : NONE                                               *   149915
      *                                                               *   149915
      *****************************************************************   149915
      *                                                                   149915
     C           CHKIPP    BEGSR                                          149915
      *                                                                   149915
     C           PTYP      IFEQ 64                                        149915
     C           PTYP      OREQ 65                                        149915
     C           PTYP      OREQ 68                                        149915
     C           CLE005    ANDEQ'Y'                                       149915
     C           PTYP      OREQ 71                                        149915
     C           CLE005    ANDEQ'Y'                                       149915
      *                                                                   149915
     C                     MOVE '0'       *IN26                           149915
     C           LNRF      CHAINCLOAN                26                   149915
     C           *IN26     IFEQ '1'                                       149915
     C           *LOCK     IN   LDA                                       149915
     C                     MOVEL'CLOAN'   DBFILE           ************   149915
     C                     Z-ADD14        DBASE            * DBERR 14 *   149915
     C                     MOVELLNRF      DBKEY            ************   149915
     C                     OUT  LDA                                       149915
     C                     EXSR *PSSR                                     149915
     C                     ELSE                                           149915
     C           LPFI      IFEQ 'I'                                       149915
     C                     MOVE MLNR      RLON                            149915
     C                     MOVE '1'       *IN84                           149915
     C                     ENDIF                                          149915
     C                     ENDIF                                          149915
     C                     ENDIF                                          149915
      *                                                                   149915
     C                     ENDSR                                          149915
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      * SETCCY  -  Subroutine to sort out which currency is the       *                       CLE031
      *            settlement currency and what the exchange rate is  *                       CLE031
      * Called by: ROLL, MROLL, STRTDT, PRINC, INTPAY, MIADJ          *                       CLE031
      *            REPAY, MANREP, MATUR, SPRCHG, BRTCHG, BRCCHG       *                       CLE031
      *            PRINTO, PRINFR                                     *                       CLE031
      * Calls    : NONE                                               *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SETCCY    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE CCY       TSTCCY  3                                           CLE031
     C                     EXSR CURTAB                                                        CLE031
     C                     MOVE CCY       WECCY   3                                           CLE031
     C                     MOVE TSINCY    A6INCY  1                                           CLE031
     C                     MOVE *BLANKS   WKCCY   3                                           CLE031
      *                                                                                       CLE031
      ** If settlement method is 09 and postings are to use Transaction                       218782
      ** currency, do not set up W@SCCY.                                                      218782
      *                                                                                       218782
     C           CLE033    IFEQ 'Y'                                                           218782
     C           SETP      ANDEQ09                                                            218782
     C           SET09     ANDEQ'T'                                                           218782
     C                     ELSE                                                               218782
      *                                                                                       218782
     C           WTYPE     IFEQ 'S'                                                           CLE031
      *                                                                                       CLE031
     C           PTYP      IFNE 66                                                            CLE031
     C           PTYP      ANDNE67                                                            CLE031
     C           PTYP      ANDNE69                                                            CLE031
     C           PTYP      ANDNE72                                                            CLE031
     C                     MOVE PSCY      WKCCY                                               CLE031
     C                     Z-ADDPEXR      WKCYXR 138                                          CLE031
     C                     MOVE PEXI      WKCYIN  1                                           CLE031
     C                     MOVE 'P'       PAYREC  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE SCCY      WKCCY                                               CLE031
     C                     Z-ADDREXR      WKCYXR                                              CLE031
     C                     MOVE REXI      WKCYIN                                              CLE031
     C                     MOVE 'R'       PAYREC                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           WTYPE     IFEQ 'E'                                                           CLE031
      *                                                                                       CLE031
     C           PTYP      IFNE 66                                                            CLE031
     C           PTYP      ANDNE67                                                            CLE031
     C           PTYP      ANDNE69                                                            CLE031
     C           PTYP      ANDNE72                                                            CLE031
     C                     MOVE SCCY      WKCCY                                               CLE031
     C                     Z-ADDREXR      WKCYXR                                              CLE031
     C                     MOVE REXI      WKCYIN                                              CLE031
     C                     MOVE 'R'       PAYREC                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE PSCY      WKCCY                                               CLE031
     C                     Z-ADDPEXR      WKCYXR                                              CLE031
     C                     MOVE PEXI      WKCYIN                                              CLE031
     C                     MOVE 'P'       PAYREC                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE WKCCY     TSTCCY                                              CLE031
     C                     EXSR CURTAB                                                        CLE031
     C                     ENDIF                                                              218782
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE033
      * SETOSB  -  Subroutine to sort out which branch should be used *                       CLE033
      *            as the settlement branch                           *                       CLE033
      * Called by: ROLL, MROLL, STRTDT, PRINC, INTPAY, MIADJ          *                       CLE033
      *            REPAY, MANREP, MATUR, SPRCHG, BRTCHG, BRCCHG       *                       CLE033
      *            PRINTO, PRINFR                                     *                       CLE033
      * Calls    : NONE                                               *                       CLE033
      *                                                               *                       CLE033
      *****************************************************************                       CLE033
      *                                                                                       CLE033
     C           SETOSB    BEGSR                                                              CLE033
      *                                                                                       CLE033
      * If settlement method 09 has been used (enabled by CLE033), then                       CLE033
      * the transaction branch should be used as settlement branch                            CLE033
      *                                                                                       CLE033
     C***********PAYREC    IFEQ 'P'                                                    CLE033 CLE034
     C***********PSTM      ANDEQ9                                                      CLE033 CLE034
     C***********PAYREC    OREQ 'R'                                                    CLE033 CLE034
     C***********RSTM      ANDEQ9                                                      CLE033 CLE034
     C***********          MOVE BRCA      OSBR                                         CLE033 CLE034
     C***********          ENDIF                                                       CLE033 CLE034
      *                                                                                       CLE034
     C           WTYPE     IFEQ 'S'                                                           CLE034
     C           PTYP      IFNE 66                                                            CLE034
     C           PTYP      ANDNE67                                                            CLE034
     C           PTYP      ANDNE69                                                            CLE034
     C           PTYP      ANDNE72                                                            CLE034
     C           PSTM      IFEQ 9                                                             CLE034
     C                     MOVE BRCA      OSBR                                                CLE034
     C                     ENDIF                                                              CLE034
     C                     ELSE                                                               CLE034
     C           RSTM      IFEQ 9                                                             CLE034
     C                     MOVE BRCA      OSBR                                                CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WTYPE     IFEQ 'E'                                                           CLE034
      *                                                                                       CLE034
     C           PTYP      IFNE 66                                                            CLE034
     C           PTYP      ANDNE67                                                            CLE034
     C           PTYP      ANDNE69                                                            CLE034
     C           PTYP      ANDNE72                                                            CLE034
     C           RSTM      IFEQ 9                                                             CLE034
     C                     MOVE BRCA      OSBR                                                CLE034
     C                     ENDIF                                                              CLE034
     C                     ELSE                                                               CLE034
     C           PSTM      IFEQ 9                                                             CLE034
     C                     MOVE BRCA      OSBR                                                CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE033
     C                     ENDSR                                                              CLE033
      /EJECT                                                                                  CLE033
      *****************************************************************                       CLE031
      * SETCLX  -  Subroutine to set up settlement currency for       *                       CLE031
      *            file CUTX1HP                                       *                       CLE031
      * Called by:                                                    *                       CLE031
      * Calls    : NONE                                               *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SETCLX    BEGSR                                                              CLE031
      *                                                                                       CLE031
      ** If settlement method is 09 and postings are to use Transaction                       218782
      ** currency, do not set up W@SCCY.                                                      218782
      *                                                                                       218782
     C           CLE033    IFEQ 'Y'                                                           218782
     C           SETP      ANDEQ09                                                            218782
     C           SET09     ANDEQ'T'                                                           218782
     C                     MOVE *BLANKS   SCCY                                                218782
     C                     ELSE                                                               218782
      *                                                                                       218782
     C           CEU004    IFEQ 'Y'                                                           CLE031
     C           A6INCY    ANDEQ'Y'                                                           CLE031
     C           CEU004    OREQ 'Y'                                                           CLE031
     C           WKCCY     ANDEQBKEURO                                                        CLE031
     C           A6INCY    ANDEQ'Y'                                                           CLE031
     C                     MOVE WSCCY     SCCY                                                CLE031
     C                     ELSE                                                               CLE031
     C           WKCCY     IFEQ *BLANKS                                                       CLE031
     C                     MOVE *BLANKS   SCCY                                                CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE WKCCY     SCCY                                                CLE031
     C                     Z-ADDWKCYXR    SEXR   138                                          CLE031
     C**********           MOVE WKCYIN    SEXI    10                                 CLE031 MD051970
     C                     MOVE WKCYIN    SEXI    1                                         MD051970
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              218782
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *****************************************************************                       CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      * SETLLX  - Subroutine to set up settlement currency for the    *                       CLE031
      *           file LETX1PR                                        *                       CLE031
      *                                                               *                       CLE031
      * Called by: ROLL, MROLL, STRTDT, PRINC, INTPAY, REPAY, MANREP  *                       CLE031
      *            MATUR, PRINTO, PRINFR                              *                       CLE031
      * Calls    : NONE                                               *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SETLLX    BEGSR                                                              CLE031
      *                                                                                       CLE031
      ** If settlement method is 09 and postings are to use Transaction                       218782
      ** currency, do not set up W@SCCY.                                                      218782
      *                                                                                       218782
     C           CLE033    IFEQ 'Y'                                                           218782
     C           SETP      ANDEQ09                                                            218782
     C           SET09     ANDEQ'T'                                                           218782
     C                     MOVE *BLANKS   SCCY                                                218782
     C                     ELSE                                                               218782
      *                                                                                       218782
     C           CEU004    IFEQ *ON                                                           CLE031
     C           A6INCY    ANDEQ'Y'                                                           CLE031
     C           CEU004    OREQ *ON                                                           CLE031
     C           WKCCY     ANDEQBKEURO                                                        CLE031
     C           A6INCY    ANDEQ'Y'                                                           CLE031
     C                     MOVE WSCCY     SCCY                                                CLE031
     C                     ELSE                                                               CLE031
     C           WKCCY     IFEQ *BLANKS                                                       CLE031
     C                     MOVE *BLANKS   SCCY                                                CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** Determine if the currency should be setup as pay or receive                          CLE031
      *                                                                                       CLE031
     C           PAYREC    IFEQ 'R'                                                           CLE031
     C                     MOVE WKCCY     SCCY                                                CLE031
     C                     Z-ADDWKCYXR    SEXR                                                CLE031
     C                     MOVE WKCYIN    SEXI                                                CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE WKCCY     PSCY                                                CLE031
     C                     Z-ADDWKCYXR    PEXR                                                CLE031
     C                     MOVE WKCYIN    PEXI                                                CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              218782
      *                                                                                       CLE031
      ** Reset PAYREC indicator                                                               CLE031
     C                     MOVE *BLANKS   PAYREC                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *****************************************************************                       CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      * CURTAB  - Subroutine to look up the currency and retrieve     *                       CLE031
      *           the 'In' currency indicator                         *                       CLE031
      *                                                               *                       CLE031
      * Called by: SETCCY                                             *                       CLE031
      * Calls    : NONE                                               *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           CURTAB    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     Z-ADD1         A       10                                          CLE031
     C           TSTCCY    LOKUPACR,A                26                                       CLE031
     C           *IN26     IFEQ *ON                                                           CLE031
     C                     MOVE ACI,A     TSINCY  1                                           CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM '*BLANKS' @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM           TSTCCY                                              CLE031
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE031
      *                                                                                       CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'LE0400  'DBPGM                                               CLE031
     C                     MOVE 'SDCURRPD'DBFILE           ************                       CLE031
     C                     MOVE TSTCCY    DBKEY            * DBERR 21 *                       CLE031
     C                     Z-ADD21        DBASE            ************                       CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           A         ADD  1         A                                                   CLE031
     C                     MOVEATSTCCY    ACR,A                                               CLE031
     C                     MOVEAA6INCY    ACI,A                                               CLE031
     C                     MOVE A6INCY    TSINCY                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *****************************************************************                     MD046080
      /EJECT                                                                                MD046080
      *****************************************************************                     MD046080
      * SRCURR  - Subroutine to look up the currency and retrieve     *                     MD046080
      *           currency details                                    *                     MD046080
      *                                                               *                     MD046080
      * Called by: SETFLD                                             *                     MD046080
      * Calls    : NONE                                               *                     MD046080
      *                                                               *                     MD046080
      *****************************************************************                     MD046080
      *                                                                                     MD046080
     C           SRCURR    BEGSR                                                            MD046080
      *                                                                                     MD046080
     C                     CALL 'AOCURRR0'                                                  MD046080
     C                     PARM '*BLANKS' @RTCD                                             MD046080
     C                     PARM '*KEY   ' @OPTN                                             MD046080
     C                     PARM           WCCYA   3                                         MD046080
     C           SDCURR    PARM SDCURR    DSSDY                                             MD046080
      *                                                                                     MD046080
     C           @RTCD     IFNE *BLANKS                                                     MD046080
     C           *LOCK     IN   LDA                                                         MD046080
     C                     MOVEL'LE0400  'DBPGM                                             MD046080
     C                     MOVE 'SDCURRPD'DBFILE           ************                     MD046080
     C                     MOVE WCCYA     DBKEY            * DBERR 24 *                     MD046080
     C                     Z-ADD24        DBASE            ************                     MD046080
     C                     OUT  LDA                                                         MD046080
     C                     EXSR *PSSR                                                       MD046080
      *                                                                                     MD046080
     C                     ENDIF                                                            MD046080
      *                                                                                     MD046080
     C                     ENDSR                                                            MD046080
      *****************************************************************                       CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      /EJECT                                                                                  CAS009
      *****************************************************************                       CAS009
      *                                                               *                       CAS009
      *  SRLECF - Generates Tpday's cash flows.                       *                       CAS009
      *                                                               *                       CAS009
      *****************************************************************                       CAS009
     C           SRLECF    BEGSR                                                              CAS009
      *                                                                                       CAS009
     C                     CLEARLECFLSD0                                                      CAS009
     C                     MOVE ' '       SEPINT  1                                           231712
      *                                                                                       CAS009
     C**********           Z-ADDLNRF      LFLNRF                                       CAS009 CLE148
     C                     MOVELLNRF      LFLNRF                                              CLE148
     C                     Z-ADD0         LFFSEQ                                              CAS009
     C                     MOVE LTYP      LFLTYP                                              CAS009
     C                     MOVE SUTP      LFLNST                                              CAS009
     C                     MOVE CLAS      LFLNCL                                              CLE042
     C**********           Z-ADDVDAT      LFFLDT                                     CAS009 BUG13044
      *                                                                                       CAS009
     C           *IN51     IFEQ '1'                                                           CAS009
      *                                                                                       CAS009
     C                     MOVE *BLANK    LFDATE                                              CAS009
     C                     Z-ADDVDATS     ZDAYNO                                              CAS009
     C                     EXSR ZDATE2                                                        CAS009
     C                     MOVE ZADATE    LFDATE                                              CAS009
      *                                                                                       CAS009
     C                     Z-ADDPRAMS     LFCAMT                                              CAS009
     C                     Z-ADDVDATS     LFFLDT                                            BUG13044
      *                                                                                       CAS009
     C                     ELSE                                                               CAS009
      *                                                                                       CAS009
     C                     MOVE *BLANK    LFDATE                                              CAS009
     C                     Z-ADDVDAT      ZDAYNO                                              CAS009
     C                     EXSR ZDATE2                                                        CAS009
     C                     MOVE ZADATE    LFDATE                                              CAS009
      *                                                                                       CAS009
     C                     Z-ADDVDAT      LFFLDT                                            BUG13044
      *                                                                                     BUG13044
     C           WROLL     IFNE 'Y'                                                           232628
     C                     Z-ADDPAMONT    LFCAMT                                              CAS009
     C                     ELSE                                                               232628
     C                     Z-ADDCPAM      LFCAMT                                              232628
     C                     ENDIF                                                              232628
      *                                                                                       231712
     C                     MOVE 'Y'       SEPINT                                              231712
     C**********           ADD  IAMONT    LFCAMT                                       CAS009 231712
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     SELEC                                                              CAS009
      *                                                                                       CAS009
     C           AMTP      WHEQ 'ST'                                                          CAS009
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 67                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SSAM'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'SAMT'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C           AMTP      WHEQ 'PI'                                                          CAS009
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SPIN'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'PINC'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C           AMTP      WHEQ 'RE'                                                          CAS009
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SSRP'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'SRPY'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C           AMTP      WHEQ 'MR'                                                          CAS009
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 67                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SRPA'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'RPAY'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS016
      ** Update Cashflow record for the paid PD record                                        CAS016
      *                                                                                       CAS016
     C           CAS016    IFEQ 'Y'                                                           CAS016
     C           EXVD      ANDNE0                                                             CAS016
     C                     EXSR SRUPCF                                                        CAS016
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS009
     C           AMTP      WHEQ 'PF'                                                          CAS009
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 67                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SPTF'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'PTFA'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C*********  AMTP      WHEQ 'PF'                                                   CAS009 240807
     C           AMTP      WHEQ 'PT'                                                          240807
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 67                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SPTT'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'PTTA'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C           AMTP      WHEQ 'IN'                                                          CAS009
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SINT'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'INTP'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
     C**********           MOVE ' '       SEPINT                                       240746 262630
      *                                                                                       CAS009
     C           AMTP      WHEQ 'MA'                                                          CAS009
     C           PTYP      IFEQ 66                                                            CAS009
     C           PTYP      OREQ 67                                                            CAS009
     C           PTYP      OREQ 69                                                            CAS009
     C                     MOVE 'SMAM'    LFFTYP                                              CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'MAMT'    LFFTYP                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       232628
     C           AMTP      WHEQ 'RO'                                                          232628
     C           PTYP      IFEQ 66                                                            232628
     C           PTYP      OREQ 69                                                            232628
     C                     MOVE 'ROPR'    LFFTYP                                              232628
     C                     ELSE                                                               232628
     C                     MOVE 'ROPR'    LFFTYP                                              232628
     C                     ENDIF                                                              232628
      *                                                                                       CAS009
     C                     ENDSL                                                              CAS009
      *                                                                                       CAS009
     C           AMTP      IFEQ 'ST'                                                          CAS009
     C           AMTP      OREQ 'PI'                                                          CAS009
     C           AMTP      OREQ 'PT'                                                          CAS009
     C                     MOVE 'O'       LFIOIN                                              CAS009
     C                     ELSE                                                               CAS009
     C           AMTP      IFEQ 'RO'                                                          232628
     C                     MOVE 'S'       LFIOIN                                              232628
     C                     ELSE                                                               232628
     C                     MOVE 'I'       LFIOIN                                              CAS009
     C                     ENDIF                                                              232628
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C********** VDAT      SUB  BJRDNB    LFNDYP                                     CAS009 BUG13044
     C           LFFLDT    SUB  BJRDNB    LFNDYP                                            BUG13044
     C                     MOVE ICBS      LFICBS                                              CAS009
      *                                                                                       CAS009
      ** Calculation methods are:                                                             CAS009
      *                                                                                       CAS009
     C                     SELEC                                                              CAS009
      *                                                                                       CAS009
      ** 1 Actual/365, 4 365/365 (excluding 29/02)                                            CAS009
      *                                                                                       CAS009
     C           ICBS      WHEQ 1                                                             CAS009
     C           ICBS      OREQ 4                                                             CAS009
     C                     Z-ADD365       LFNDYY                                              CAS009
      *                                                                                       CAS009
      ** 2 Actual/360, 3 360/360 (sometimes called 30/360), 5 365/360 (excluding 29/02)       CAS009
      *                                                                                       CAS009
     C           ICBS      WHEQ 2                                                             CAS009
     C           ICBS      OREQ 3                                                             CAS009
     C           ICBS      OREQ 5                                                             CAS009
     C                     Z-ADD360       LFNDYY                                              CAS009
      *                                                                                       CAS009
      ** 6 Actual/366                                                                         CAS009
      *                                                                                       CAS009
     C           ICBS      WHEQ 6                                                             CAS009
     C                     Z-ADD366       LFNDYY                                              CAS009
      *                                                                                       CAS009
     C                     ENDSL                                                              CAS009
      *                                                                                       CAS009
     C**********           MOVE INTR      LFIRAT                                       CAS009 232319
     C                     Z-ADDINTR      LFIRAT                                              232319
     C                     MOVE CNUM      LFCNUM                                              CAS009
     C                     MOVE BRCA      LFBRCA                                              CAS009
     C                     MOVE CCY       LFCYCD                                              CAS009
     C                     MOVE BOKC      LFBKCD                                              CAS009
      *                                                                                       CAS009
     C                     Z-ADDCPAM      LFCPAM                                              CAS009
     C                     MOVE FSYLDC    LFYLDC                                              CAS009
     C                     MOVE FSFYLD    LFFYLD                                              CAS009
     C**********           MOVE RTSP      LFSPRR                                       CAS009 232319
     C                     Z-ADDRTSP      LFSPRR                                              232319
      *                                                                                       263903
      ** For CLE005, if payment taken date is 'P', find previous                              263903
      ** working day if holiday, if 'N', find next working day if                             263903
      ** holiday, if 'M', interest payment day would be next freq                             263903
      ** even if a holiday.                                                                   263903
      *                                                                                       263903
     C           CLE005    IFEQ 'Y'                                                           263903
     C           LFFLDT    ANDNEWVDAT                                                         263903
     C                     Z-ADD*ZERO     ZNRDYS                                              263903
     C                     Z-ADDLFFLDT    ZDAYNO                                              263903
     C                     MOVE LFCYCD    ZCCY                                                263903
     C                     SELEC                                                              263903
     C           PTDI      WHEQ 'P'                                                           263903
     C                     EXSR ZBKDT                                                         263903
     C           PTDI      WHEQ 'N'                                                           263903
     C           PTDI      OREQ *BLANK                                                        263903
     C                     EXSR ZFWDT                                                         263903
     C           PTDI      WHEQ 'M'                                                           263903
     C                     EXSR ZDATE2                                                        263903
     C           *IN98     IFEQ *OFF                                                          263903
     C                     MOVE ZDATE     MMYY    40P                                         263903
     C                     MOVELMMYY      MMNLCD  20P                                         263903
     C                     ELSE                                                               263903
     C                     MOVELZDATE     MMNLCD    P                                         263903
     C                     ENDIF                                                              263903
     C                     Z-ADDZDAYNO    @DAYNO  50                                          263903
     C                     EXSR ZFWDT                                                         263903
     C                     Z-ADDZDYNBR    ZDAYNO                                              263903
     C                     EXSR ZDATE2                                                        263903
     C           *IN98     IFEQ *OFF                                                          263903
     C                     MOVE ZDATE     MMYY      P                                         263903
     C                     MOVELMMYY      MMNWKD  20P                                         263903
     C                     ELSE                                                               263903
     C                     MOVELZDATE     MMNWKD    P                                         263903
     C                     ENDIF                                                              263903
     C           MMNLCD    IFNE MMNWKD                                                        263903
     C                     Z-ADD@DAYNO    ZDAYNO                                              263903
     C                     EXSR ZBKDT                                                         263903
     C                     ENDIF                                                              263903
     C                     ENDSL                                                              263903
     C                     Z-ADDZDYNBR    LFFLDT                                              263903
     C                     Z-ADDZDYNBR    ZDAYNO                                              263903
     C                     EXSR ZDATE2                                                        263903
     C                     MOVE ZADATE    LFDATE                                              263903
     C                     ENDIF                                                              263903
      *                                                                                       CAS009
     C           LFCAMT    IFNE 0                                                             232628
     C                     WRITELECFLSD0                                                      CAS009
     C                     ENDIF                                                              232628
      *                                                                                       231712
      ** Write separate cash flow record for Interest Amount                                  231712
      *                                                                                       231712
     C           SEPINT    IFEQ 'Y'                                                           231712
     C           IAMONT    ANDNE0                                                             231712
     C           WROLL     ANDNE'Y'                                                           232628
     C           CAPNIN    ANDNE'Y'                                                           262630
     C                     Z-ADDIAMONT    LFCAMT                                              231712
     C                     MOVE 'INTP'    LFFTYP                                              231712
     C           CAS016    IFEQ 'Y'                                                           CAS016
     C           EXVD      ANDNE0                                                             CAS016
     C                     Z-ADDEXVD      LFFLDT                                              CAS016
     C                     MOVE *BLANK    LFDATE                                              CAS016
     C                     Z-ADDEXVD      ZDAYNO                                              CAS016
     C                     EXSR ZDATE2                                                        CAS016
     C                     MOVE ZADATE    LFDATE                                              CAS016
     C                     ENDIF                                                              CAS016
     C                     WRITELECFLSD0                                                      231712
     C                     ENDIF                                                              231712
      *                                                                                       232628
     C           WROLL     IFEQ 'Y'                                                           232628
     C           AITC      ANDGTIPRD                                                          232628
     C           AITC      SUB  IPRD      LFCAMT                                              232628
     C                     MOVE 'ROIN'    LFFTYP                                              232628
     C                     WRITELECFLSD0                                                      232628
     C                     ENDIF                                                              232628
      *                                                                                       CAS009
     C                     ENDSR                                                              CAS009
      *****************************************************************                       CAS016
      *                                                               *                       CAS016
      *  SRUPCF - Update Today's cashflows for past due               *                       CAS016
      *                                                               *                       CAS016
      *****************************************************************                       CAS016
     C           SRUPCF    BEGSR                                                              CAS016
      *                                                                                       CAS016
     C                     Z-ADDEXVD      LFFLDT                                              CAS016
     C           KPDUE     KLIST                                                              CAS016
     C                     KFLD           LFLNRF                                              CAS016
     C                     KFLD           LFFLDT                                              CAS016
     C                     KFLD           WLSTYP  4                                           CAS016
     C                     KFLD           LFPSEQ                                              CAS016
      *                                                                                       CAS016
      ** Update/Delete principal past due being paid                                          CAS016
      *                                                                                       CAS016
     C           PAMONT    IFNE 0                                                             CAS016
     C                     MOVE 'PDPR'    WLSTYP                                              CAS016
     C           KPDUE     CHAINLECFLSD1             99                                       CAS016
     C           *IN99     IFEQ '0'                                                           CAS016
     C           LSCAMT    IFEQ PAMONT                                                        CAS016
     C                     DELETLECFLSD1                                                      CAS016
     C                     ELSE                                                               CAS016
     C                     SUB  PAMONT    LSCAMT                                              CAS016
     C                     UPDATLECFLSD1                                                      CAS016
     C                     ENDIF                                                              CAS016
     C                     ENDIF                                                              CAS016
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS016
      ** Update/Delete interest past due being paid                                           CAS016
      *                                                                                       CAS016
     C           IAMONT    IFNE 0                                                             CAS016
     C                     MOVE 'PDIN'    WLSTYP                                              CAS016
     C           KPDUE     CHAINLECFLSD1             99                                       CAS016
     C           *IN99     IFEQ '0'                                                           CAS016
     C           LSCAMT    IFEQ IAMONT                                                        CAS016
     C                     DELETLECFLSD1                                                      CAS016
     C                     ELSE                                                               CAS016
     C                     SUB  IAMONT    LSCAMT                                              CAS016
     C                     UPDATLECFLSD1                                                      CAS016
     C                     ENDIF                                                              CAS016
     C                     ENDIF                                                              CAS016
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS016
     C                     ENDSR                                                              CAS016
      *****************************************************************                       CRE073
      *                                                               *                       CRE073
      *  SRNSRT - Calculate new spread rate based on the Interest     *                       CRE073
      *            rate rounding rules                                *                       CRE073
      *                                                               *                       CRE073
      *****************************************************************                       CRE073
      *                                                                                       CRE073
     C           SRNSRT    BEGSR                                                              CRE073
     C           CRE073    IFEQ 'Y'                                                           CRE073
      *                                                                                       CRE073
     C           SWLN      IFNE LNRF                                                          CRE073
     C                     Z-ADD*ZEROS    WCNSP  117                                          CRE073
     C                     MOVEL*BLANKS   WCNSG   1                                           CRE073
     C                     MOVEL*BLANKS   WRDMT   7                                           CRE073
     C                     MOVEL*BLANKS   WRDFD   4                                           CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C           QKEY      KLIST                                                              CRE073
     C                     KFLD           LNRF                                                CRE073
     C                     KFLD           VDAT                                                CRE073
     C                     KFLD           LASN                                                CRE073
      *                                                                                       CRE073
     C           QKEY      CHAINCLOAMQL0             16                                       CRE073
     C           *IN16     IFNE '1'                                                           CRE073
     C           AMCNSP    IFNE 0                                                             CRE073
     C                     Z-ADDAMCNSP    WCNSP                                               CRE073
     C                     MOVELAMCNSG    WCNSG                                               CRE073
     C                     MOVELAMRDMT    WRDMT                                               CRE073
     C                     MOVELAMRDFD    WRDFD                                               CRE073
     C**********           Z-ADDLNRF      SWLN    60                                   CRE073 CLE148
     C                     MOVELLNRF      SWLN    6                                           CLE148
     C**********           Z-ADDAMCNSP    CNSPO                                      CRE073 AR824724
     C**********           MOVELAMCNSG    CNSGO                                      CRE073 AR824724
     C**********           MOVELAMRDMT    RDMTO                                      CRE073 AR824724
     C**********           MOVELAMRDFD    RDFDO                                      CRE073 AR824724
     C                     Z-ADDAMCNSP    CNSP                                              AR824724
     C                     MOVELAMCNSG    CNSG                                              AR824724
     C                     MOVELAMRDMT    RDMT                                              AR824724
     C                     MOVELAMRDFD    RDFD                                              AR824724
     C                     ENDIF                                                              CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C           WCNSP     IFEQ 0                                                             CRE073
     C                     Z-ADDCNSP      WCNSP                                               CRE073
     C                     MOVELCNSG      WCNSG                                               CRE073
     C                     MOVELRDMT      WRDMT                                               CRE073
     C                     MOVELRDFD      WRDFD                                               CRE073
     C**********           Z-ADDLNRF      SWLN                                         CRE073 CLE148
     C                     MOVELLNRF      SWLN                                                CLE148
     C                     ENDIF                                                              CRE073
      ** Override Interest rounding fields for Rollover                                     AR948094
     C           AMTP      IFEQ 'RO'                                                        AR948094
     C                     Z-ADDNNSP      WCNSP                                             AR948094
     C                     MOVELNNSG      WCNSG                                             AR948094
     C                     MOVELNDMT      WRDMT                                             AR948094
     C                     MOVELNDFD      WRDFD                                             AR948094
     C                     Z-ADDNNSP      CNSP                                              AR948094
     C                     MOVELNNSG      CNSG                                              AR948094
     C                     MOVELNDMT      RDMT                                              AR948094
     C                     MOVELNDFD      RDFD                                              AR948094
     C                     ENDIF                                                            AR948094
      *                                                                                       CRE073
     C           BASERT    IFNE 0                                                             CRE073
     C           SPREAD    ANDNE0                                                             CRE073
      *                                                                                       CRE073
     C                     MOVEL'ZACALCSP'PROG   10                                           CRE073
     C                     MOVE 'RT'      PROG                                                CRE073
     C                     CALL PROG                                                          CRE073
     C                     PARM *BLANKS   @RTCD                                               CRE073
     C                     PARM           BASERT                                              CRE073
     C                     PARM           WCNSP                                               CRE073
     C                     PARM           WCNSG                                               CRE073
     C                     PARM           WRDMT                                               CRE073
     C                     PARM           WRDFD                                               CRE073
     C                     PARM           NSRTX  117                                          CRE073
     C                     PARM *ZERO     FRATE  117                                        AR948094
      *                                                                                       CRE073
     C                     Z-ADDNSRTX     SPREAD                                              CRE073
     C                     MOVE WCNSG     SPRIND                                           AR947093A
     C           SPREAD    IFLT 0                                                          AR947093A
     C                     MULT -1        SPREAD                                           AR947093A
     C           SPRIND    IFEQ 'A'                                                        AR947093A
     C                     MOVE 'S'       SPRIND                                           AR947093A
     C                     ELSE                                                            AR947093A
     C                     MOVE 'A'       SPRIND                                           AR947093A
     C                     ENDIF                                                           AR947093A
     C                     ENDIF                                                           AR947093A
      *                                                                                    AR1009681
     C           FRATE     IFLE 0                                                          AR1009681
     C                     Z-ADD0         INTRAT                                           AR1009681
     C                     Z-ADDINTRAT    W#INTR                                           AR1009681
     C                     Z-ADDINTRAT    INTR                                             AR1009681
     C                     ENDIF                                                           AR1009681
      *                                                                                       CRE073
     C                     ENDIF                                                              CRE073
     C                     ENDIF                                                              CRE073
     C                     ENDSR                                                              CRE073
     C********************************************************************                    CAS009
3013 C*
3014 C** INIT SUBROUTINE - FIRST CYCLE CALCS
3015 C*
3016 C** CALLED BY:  MAIN PROCESSING
3017 C** CALLS:      ZSYSTM,EXCPT
3018 C*
3019 C           INIT      BEGSR                           ** INIT **
      *                                                                                       CLE134
     C           *ENTRY    PLIST                                                              CLE134
     C                     PARM           WPNAM  10                                           CLE134
3020 C*
3021 C                     MOVE ' '       BLANKS 29        SET UP FIELDS
3022 C                     MOVE BLANKS    DBKEY            FOR DATABASE
3023 C                     MOVE 'LE0400'  DBPGM            ERRORS
      **                                                                  S01117
      **   IN THE DATAAREA RUNDAT                                         S01117
      **                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
      *                                                                   S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
      *    SETON INDICATOR FOR MULTIBRANCHING = NO                        S01117
      *                                                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     65                   S01117
     C                     END                                            S01117
3024 C*
3025 C                     EXSR ZSYSTM                     ACCESS ICDR1
3026 C   99                SETON                     U7U8LR
0334 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0334 C   99                MOVE 'SDBANKPD'DBFILE                          S01194
0335 C***99*****           MOVELZTABKY    DBKEY                           S01194
3028 C   99                Z-ADD1         DBASE
3030 C   99                GOTO INITEN
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004  1        Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' @RTCD   7        -Return Code   CEU004
     C                     PARM '*VERIFY' @OPTN   7        -Option        CEU004
     C                     PARM 'CEU004'  @SARD   6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           @RTCD     IFEQ *BLANK                     If Found       CEU004
     C                     MOVE 'Y'       CEU004            Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           @RTCD     IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD14        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Inds     CEU004
     C                     GOTO INITEN                       Bypass       CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
      *                                                                   CEU004
      **  Access SAR details file to see if CDE002 is installed                               208221
      *                                                                                       208221
     C                     MOVE 'N'       CDE002  1                                           208221
     C                     CALL 'AOSARDR0'                                                    208221
     C                     PARM '       ' @RTCD                                               208221
     C                     PARM '*VERIFY' @OPTN                                               208221
     C                     PARM 'CDE002'  @SARD                                               208221
      *                                                                                       208221
     C           @RTCD     IFNE *BLANK                                                        208221
     C           @RTCD     ANDNE'*NRF   '                                                     208221
     C                     MOVEL'SCSARDPD'DBFILE                                              208221
     C                     MOVEL'CDE002'  DBKEY                                               208221
     C                     Z-ADD18        DBASE                                               208221
     C                     MOVE *ON       *INU7                                               208221
     C                     MOVE *ON       *INU8                                               208221
     C                     MOVE *ON       *INLR                                               208221
     C                     EXSR *PSSR                                                         208221
     C                     ELSE                                                               208221
      *                                                                                       208221
     C           @RTCD     IFEQ *BLANK                                                        208221
     C                     MOVE 'Y'       CDE002                                              208221
     C                     ENDIF                                                              208221
      *                                                                                       208221
     C                     ENDIF                                                              208221
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0400CCP3                                           S01408
     C*                                                                   S01408
3031 C*
3032 C**********           MOVE '1'       ZTABKY           ACCESS ICDR2   S01194
3033 C********** ZTABKY    CHAINTABLE                99                   S01194
3034 C**N99***** RECI      COMP 'D'                  9999                 S01194
3035 C***99*****           SETON                     U7U8LR               S01194
3036 C***99*****           MOVELZTABKY    DBKEY                           S01194
3037 C***99*****           Z-ADD2         DBASE                           S01194
3038 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
3039 C***99*****           GOTO INITEN                                    S01194
     C*                                                                   CAC001
     C**  Access Module Details File.                                     CAC001
     C*                                                                   CAC001
     C                     CALL 'AOMMODR0'PMMOD                           CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     MOVE 'SDMMODPD'DBFILE           ************   CAC001
     C                     MOVEL@OPTN     DBKEY            * DBERR 02 *   CAC001
     C                     Z-ADD2         DBASE            ************   CAC001
     C                     SETON                     U7U8LR               CAC001
     C                     GOTO INITEN                                    CAC001
     C                     ENDIF                                          CAC001
3040 C*
3041 C           RUND      SUB  BVLP      BVDAT   50       CALC B/V DATE
3042 C*
3043 C                     SETON                     40    OUTPUT HEADERS
3044 C                     EXSR EXCPT                      TO FILES AND
3045 C  NU3      NLETLX    ADD  1         NLETLX  50       HEADINGS TO
3046 C  NU3      NCONFS    ADD  1         NCONFS  50       PRINTER
3047 C           NINTST    ADD  1         NINTST  50       COUNT RECORDS
3048 C  NU3      NCUTX1    ADD  1         NCUTX1  50       OUTPUT
3049 C           NPTSLD    ADD  1         NPTSLD  50
3050 C*
3051 C**********           MOVEL'20'      ZTABKY           SET UP KEY FOR S01194
3052 C**********           MOVE ' 1'      ZTABKY           CURRENCY CHAIN S01194
3053 C*
3054 C                     MOVEL'INVALID 'DBKEY2 16
3055 C                     MOVE 'AMEND TY'DBKEY2
3056 C                     MOVEL'PE-LN. ' DBKEY3 13
3057 C*
     C                     Z-ADD0         Y       30                      147438
3058 C                     Z-ADD0         ZERO5   50       ZEROISE FIELDS
3059 C                     Z-ADD0         ZERO13 130
3060 C*
3061 C                     SETON                     50    1ST. CYCLE IND.
3062 C*
      *                                                                   CLE003
      **  Access SAR details file to see if CLE003 is installed           CLE003
      *                                                                   CLE003
     C                     CALL 'AOSARDR0'                                CLE003
     C                     PARM '       ' @RTCD   7                       CLE003
     C                     PARM '*VERIFY' @OPTN   7                       CLE003
     C                     PARM 'CLE003'  @SARD   6                       CLE003
      *                                                                   CLE003
     C           @RTCD     IFEQ *BLANK                                    CLE003
     C                     MOVE 'Y'       CLE003  1                       CLE003
     C                     ELSE                                           CLE003
     C                     MOVE 'N'       CLE003                          CLE003
     C                     ENDIF                                          CLE003
      *                                                                   CLE004
      **  Access SAR details file to see if CLE004 is installed           CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM '       ' @RTCD   7                       CLE004
     C                     PARM '*VERIFY' @OPTN   7                       CLE004
     C                     PARM 'CLE004'  @SARD   6                       CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANK                                    CLE004
     C           @RTCD     ANDNE'*NRF   '                                 CLE004
     C                     MOVEL'SCSARDPD'DBFILE            ************  CLE004
     C                     MOVEL'CLE004'  DBKEY             *DBERR 003 *  CLE004
     C                     Z-ADD3         DBASE             ************  CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANK                                    CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       CLE004                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     MOVE '0'       IN52                            CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *LIKE     DEFN VDAT      W#VDAT                          CLE004
     C           *LIKE     DEFN LNRF      W#LNRF                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *                                                                   CLE004
      ** Access SAR details file to see if CLE005 is installed            CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM '       ' @RTCD                           CLE005
     C                     PARM '*VERIFY' @OPTN                           CLE005
     C                     PARM 'CLE005'  @SARD                           CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANK                                    CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE007
      ** Access SAR details file to see if CLE007 is installed            CLE007
      *                                                                   CLE007
     C                     CALL 'AOSARDR0'                                CLE007
     C                     PARM '       ' @RTCD                           CLE007
     C                     PARM '*VERIFY' @OPTN                           CLE007
     C                     PARM 'CLE007'  @SARD                           CLE007
      *                                                                   CLE007
     C           @RTCD     IFEQ *BLANK                                    CLE007
     C                     MOVE 'Y'       CLE007  1                       CLE007
     C                     ELSE                                           CLE007
     C                     MOVE 'N'       CLE007                          CLE007
     C                     ENDIF                                          CLE007
      *                                                                   CEU020
      ** Check whether SAR CEU020 is installed or not.                    CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANK    @RTCD                           CEU020
     C                     PARM '*KEY   ' @OPTN                           CEU020
     C                     PARM 'CEU020'  @SARD   6                       CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
      *                                                                   CEU020
     C           @RTCD     IFEQ *BLANK                                    CEU020
     C                     MOVE 'Y'       CEU020  1                       CEU020
     C                     ELSE                                           CEU020
     C                     MOVE 'N'       CEU020                          CEU020
     C           @RTCD     IFNE '*NRF   '                                 CEU020
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU020
     C                     Z-ADD15        DBASE            * DBERR  15*   CEU020
     C                     MOVEL'CEU020'  DBKEY            ************   CEU020
     C                     SETON                     U7U8LR               CEU020
     C                     GOTO INITEN                                    CEU020
     C                     ENDIF                                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CLE014
      ** Check whether SAR CLE014 is installed or not.                    CLE014
      *                                                                   CLE014
     C                     CALL 'AOSARDR0'                                CLE014
     C                     PARM *BLANK    PRTCD   7                       CLE014
     C                     PARM '*VERIFY' POPTN   7                       CLE014
     C                     PARM 'CLE014'  PSARD   6                       CLE014
     C           SCSARD    PARM SCSARD    DSFDY                           CLE014
      *                                                                   CLE014
     C           PRTCD     IFEQ *BLANK                                    CLE014
     C                     MOVE 'Y'       CLE014  1                       CLE014
     C                     ELSE                                           CLE014
     C                     MOVE 'N'       CLE014                          CLE014
     C           PRTCD     IFNE '*NRF   '                                 CLE014
     C                     MOVEL'LE0400  'DBPGM     P                     CLE014
     C                     MOVEL'SCSARDPD'DBFILE    P                     CLE014
     C                     Z-ADD17        DBASE                           CLE014
     C                     MOVEL'CLE014'  DBKEY     P                     CLE014
     C                     MOVE *ON       *INU7                           CLE014
     C                     MOVE *ON       *INU8                           CLE014
     C                     MOVE *ON       *INLR                           CLE014
     C                     EXSR *PSSR                                     CLE014
     C                     ENDIF                                          CLE014
     C                     ENDIF                                          CLE014
      *                                                                                       CLE028
      ** Check whether SAR CLE028 is installed or not.                                        CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANK    PRTCD                                               CLE028
     C                     PARM '*VERIFY' POPTN                                               CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANK                                                        CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C           PRTCD     IFNE '*NRF   '                                                     CLE028
     C                     MOVEL'LE0400  'DBPGM     P                                         CLE028
     C                     MOVEL'SCSARDPD'DBFILE    P                                         CLE028
     C                     Z-ADD18        DBASE                                               CLE028
     C                     MOVEL'CLE028'  DBKEY     P                                         CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
      ** Key list for CLOAN                                                                   CLE028
      *                                                                                       CLE028
     C           WKLON     KLIST                                                              CLE028
     C**********           KFLD           WALON   60                                   CLE028 CLE148
     C                     KFLD           WALON   6                                           CLE148
     C                     KFLD           WEPAR   1                                           CLE028
      *                                                                                       CAS005
      ** Check whether SAR CAS005 is installed or not.                                        CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANK    PRTCD                                               CAS005
     C                     PARM '*VERIFY' POPTN                                               CAS005
     C                     PARM 'CAS005'  PSARD                                               CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFEQ *BLANK                                                        CAS005
     C                     MOVE 'Y'       CAS005  1                                           CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE 'N'       CAS005                                              CAS005
     C           PRTCD     IFNE '*NRF   '                                                     CAS005
     C                     MOVEL'LE0400  'DBPGM     P                                         CAS005
     C                     MOVEL'SCSARDPD'DBFILE    P                                         CAS005
     C                     Z-ADD21        DBASE                                               CAS005
     C                     MOVEL'CAS005'  DBKEY     P                                         CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     MOVE *ON       *INLR                                               CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE031
      ** Check whether SAR CLE031 is installed or not.                                        CLE031
      *                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANK    PRTCD   7                                           CLE031
     C                     PARM '*VERIFY' POPTN   7                                           CLE031
     C                     PARM 'CLE031'  PSARD   6                                           CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
      *                                                                                       CLE031
     C           PRTCD     IFEQ *BLANK                                                        CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
     C           PRTCD     IFNE '*NRF   '                                                     CLE031
     C                     MOVEL'LE0400  'DBPGM     P                                         CLE031
     C                     MOVEL'SCSARDPD'DBFILE    P                                         CLE031
     C                     Z-ADD18        DBASE                                               CLE031
     C                     MOVEL'CLE031'  DBKEY     P                                         CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INU8                                               CLE031
     C                     MOVE *ON       *INLR                                               CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE034
      ** Check if CLE034 is enabled.                                                          CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSARDR0'                                                    CLE034
     C                     PARM *BLANKS   PRTCD                                               CLE034
     C                     PARM '*VERIFY' POPTN                                               CLE034
     C                     PARM 'CLE034'  PSARD                                               CLE034
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE034
      *                                                                                       CLE034
     C                     MOVE 'N'       CLE034  1                                           CLE034
     C           PRTCD     IFEQ *BLANKS                                                       CLE034
     C                     MOVE 'Y'       CLE034                                              CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C           PRTCD     IFNE '*NRF'                                                        CLE034
     C                     MOVEL'LE0400'  DBPGM                                               CLE034
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE034
     C                     MOVEL'CLE034'  DBKEY                                               CLE034
     C                     Z-ADD19        DBASE                                               CLE034
     C                     MOVE *ON       *INU7                                               CLE034
     C                     MOVE *ON       *INU8                                               CLE034
     C                     MOVE *ON       *INLR                                               CLE034
     C                     EXSR *PSSR                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
     C*                                                                                       218782
     C**  Read switchable features file SCSARDPD using access object                          218782
     C**  to determine if switchable feature (CLE033) is switched ON                          218782
     C*                                                                                       218782
     C                     MOVE 'N'       CLE033  1                                           218782
     C*                                                                                       218782
     C                     CALL 'AOSARDR0'                                                    218782
     C                     PARM *BLANKS   @RTCD                                               218782
     C                     PARM '*VERIFY' @OPTN                                               218782
     C                     PARM 'CLE033'  @SARD                                               218782
     C           SCSARD    PARM SCSARD    DSFDY                                               218782
     C*                                                                                       218782
     C**  If feature is on, set up CLE033 variable                                            218782
     C*                                                                                       218782
     C           @RTCD     IFEQ *BLANKS                                                       218782
      *                                                                                       218782
     C                     MOVE 'Y'       CLE033                                              218782
      *                                                                                       218782
     C                     CALL 'AOSVALR0'                                                    218782
     C                     PARM *BLANKS   @RTCD                                               218782
     C                     PARM SVAL,1    P@OP01 20                                           218782
     C                     PARM *BLANKS   P@VL01200                                           218782
     C                     PARM *BLANKS   P@OP02 20                                           218782
     C                     PARM *BLANKS   P@VL02200                                           218782
     C                     PARM *BLANKS   P@OP03 20                                           218782
     C                     PARM *BLANKS   P@VL03200                                           218782
     C                     PARM *BLANKS   P@OP04 20                                           218782
     C                     PARM *BLANKS   P@VL04200                                           218782
     C                     PARM *BLANKS   P@OP05 20                                           218782
     C                     PARM *BLANKS   P@VL05200                                           218782
     C                     PARM *BLANKS   P@OP06 20                                           218782
     C                     PARM *BLANKS   P@VL06200                                           218782
     C                     PARM *BLANKS   P@OP07 20                                           218782
     C                     PARM *BLANKS   P@VL07200                                           218782
     C                     PARM *BLANKS   P@OP08 20                                           218782
     C                     PARM *BLANKS   P@VL08200                                           218782
     C                     PARM *BLANKS   P@OP09 20                                           218782
     C                     PARM *BLANKS   P@VL09200                                           218782
     C                     PARM *BLANKS   P@OP10 20                                           218782
     C                     PARM *BLANKS   P@VL10200                                           218782
     C********** SDSVAL    PARM SDSVAL    DSSDY                                        218782 222373
      *                                                                                       218782
     C           @RTCD     IFNE *BLANKS                                                       218782
     C                     MOVEL'LE0400  'DBPGM                                               218782
     C                     MOVEL'SDSVALPD'DBFILE                                              218782
     C                     MOVELSVAL,1    DBKEY                                               218782
     C                     Z-ADD22        DBASE                                               218782
     C                     MOVE *ON       *INU7                                               218782
     C                     MOVE *ON       *INU8                                               218782
     C                     MOVE *ON       *INLR                                               218782
     C                     GOTO INITEN                                                        218782
     C                     ENDIF                                                              218782
      *                                                                                       218782
      ** Save value of Settlement09Postings in a one character field                          218782
     C                     MOVELP@VL01    SET09   1                                           218782
     C                     ENDIF                                                              218782
      *                                                                                       CAS009
      ** Check if CAS009 is enabled.                                                          CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD                                               CAS009
     C                     PARM '*VERIFY' POPTN                                               CAS009
     C                     PARM 'CAS009'  PSARD                                               CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
     C                     MOVE 'N'       CAS009  1                                           CAS009
     C           PRTCD     IFEQ *BLANKS                                                       CAS009
     C                     MOVE 'Y'       CAS009                                              CAS009
     C                     ELSE                                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE '*NRF   '                                                     CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVELPSARD     DBKEY                                               CAS009
     C                     Z-ADD101       DBASE                                               CAS009
     C                     MOVE *ON       *INU7                                               CAS009
     C                     MOVE *ON       *INU8                                               CAS009
     C                     MOVE *ON       *INLR                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS016
      ** Check if CAS016 is enabled.                                                          CAS016
     C                     CALL 'AOSARDR0'                                                    CAS016
     C                     PARM *BLANKS   PRTCD                                               CAS016
     C                     PARM '*VERIFY' POPTN                                               CAS016
     C                     PARM 'CAS016'  PSARD                                               CAS016
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS016
      *                                                                                       CAS016
     C                     MOVE 'N'       CAS016  1                                           CAS016
     C           PRTCD     IFEQ *BLANKS                                                       CAS016
     C                     MOVE 'Y'       CAS016                                              CAS016
     C                     ELSE                                                               CAS016
      *                                                                                       CAS016
     C           PRTCD     IFNE '*NRF   '                                                     CAS016
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS016
     C                     MOVELPSARD     DBKEY                                               CAS016
     C                     Z-ADD101       DBASE                                               CAS016
     C                     MOVE *ON       *INU7                                               CAS016
     C                     MOVE *ON       *INU8                                               CAS016
     C                     MOVE *ON       *INLR                                               CAS016
     C                     EXSR *PSSR                                                         CAS016
     C                     ENDIF                                                              CAS016
      *                                                                                       CAS016
     C                     ENDIF                                                              CAS016
      *                                                                                       CLE036
      ** Access SAR details to check if CLE036 is installed                                   CLE036
      *                                                                                       CLE036
     C                     MOVE 'N'       CLE036  1                                           CLE036
     C                     CALL 'AOSARDR0'                                                    CLE036
     C                     PARM *BLANKS   @RTCD                                               CLE036
     C                     PARM '*VERIFY' @OPTN                                               CLE036
     C                     PARM 'CLE036'  @SARD                                               CLE036
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE036
      *                                                                                       CLE036
     C           @RTCD     IFEQ *BLANK                                                        CLE036
     C                     MOVE 'Y'       CLE036                                              CLE036
     C                     ELSE                                                               CLE036
     C           @RTCD     IFNE '*NRF   '                                                     CLE036
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE036
     C                     MOVEL'CLE036 ' DBKEY                                               CLE036
     C                     Z-ADD22        DBASE                                               CLE036
     C                     MOVE *ON       *INU7                                               CLE036
     C                     MOVE *ON       *INU8                                               CLE036
     C                     MOVE *ON       *INLR                                               CLE036
     C                     GOTO INITEN                                                        CLE036
     C                     ENDIF                                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CRE073
     C                     MOVE 'N'       CRE073  1                                           CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   @RTCD                                               CRE073
     C                     PARM '*VERIFY' @OPTN                                               CRE073
     C                     PARM 'CRE073'  @SARD                                               CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
      *                                                                                       CRE073
     C           @RTCD     IFEQ *BLANK                                                        CRE073
     C                     MOVE 'Y'       CRE073                                              CRE073
     C                     ELSE                                                               CRE073
     C           @RTCD     IFNE '*NRF   '                                                     CRE073
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE073
     C                     MOVEL'CRE073 ' DBKEY                                               CRE073
     C                     Z-ADD23        DBASE                                               CRE073
     C                     MOVE *ON       *INU7                                               CRE073
     C                     MOVE *ON       *INU8                                               CRE073
     C                     MOVE *ON       *INLR                                               CRE073
     C                     GOTO INITEN                                                        CRE073
     C                     ENDIF                                                              CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CLE134
      **  Access SAR details file to see if CLE134 is installed                               CLE134
      *                                                                                       CLE134
     C                     CALL 'AOSARDR0'                                                    CLE134
     C                     PARM '       ' @RTCD   7                                           CLE134
     C                     PARM '*VERIFY' @OPTN   7                                           CLE134
     C                     PARM 'CLE134'  @SARD   6                                           CLE134
      *                                                                                       CLE134
     C           @RTCD     IFEQ *BLANK                                                        CLE134
     C                     MOVE 'Y'       CLE134  1                                           CLE134
     C                     ELSE                                                               CLE134
     C                     MOVE 'N'       CLE134                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
      * Set NEWCOB flag                                                                       CLE134
     C                     MOVE 'N'       NEWCOB  1                                           CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C           WPNAM     ANDEQ'NEWCOB'                                                      CLE134
     C                     MOVE 'Y'       NEWCOB  1                                           CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE154
      ** Access SAR details to check if CLE154 is installed                                   CLE154
      *                                                                                       CLE154
     C                     MOVE 'N'       CLE154  1                                           CLE154
     C                     CALL 'AOSARDR0'                                                    CLE154
     C                     PARM *BLANKS   @RTCD                                               CLE154
     C                     PARM '*VERIFY' @OPTN                                               CLE154
     C                     PARM 'CLE154'  @SARD                                               CLE154
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE154
      *                                                                                       CLE154
     C           @RTCD     IFEQ *BLANK                                                        CLE154
     C                     MOVE 'Y'       CLE154                                              CLE154
     C                     ELSE                                                               CLE154
     C           @RTCD     IFNE '*NRF   '                                                     CLE154
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE154
     C                     MOVEL'CLE154 ' DBKEY                                               CLE154
     C                     Z-ADD23        DBASE                                               CLE154
     C                     MOVE *ON       *INU7                                               CLE154
     C                     MOVE *ON       *INU8                                               CLE154
     C                     MOVE *ON       *INLR                                               CLE154
     C                     GOTO INITEN                                                        CLE154
     C                     ENDIF                                                              CLE154
     C                     ENDIF                                                              CLE154
      *****************************************************************            MD035545 MD047993
      ***Access*general*ledger*details.********************************            MD035545 MD047993
      *****************************************************************            MD035545 MD047993
     C**********           CALL 'AOGELRR1'                                         MD035545 MD047993
     C**********           PARM '*DBERR ' @RTCD                                    MD035545 MD047993
     C**********           PARM '*FIRST ' @OPTN                                    MD035545 MD047993
     C********** SDGELR    PARM SDGELR    DSSDY                                    MD035545 MD047993
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01                                            MD035545
     C                     PARM           P@VL01                                            MD035545
     C                     PARM           P@OP02                                            MD035545
     C                     PARM           P@VL02                                            MD035545
     C                     PARM           P@OP03                                            MD035545
     C                     PARM           P@VL03                                            MD035545
     C                     PARM           P@OP04                                            MD035545
     C                     PARM           P@VL04                                            MD035545
     C                     PARM           P@OP05                                            MD035545
     C                     PARM           P@VL05                                            MD035545
     C                     PARM           P@OP06                                            MD035545
     C                     PARM           P@VL06                                            MD035545
     C                     PARM           P@OP07                                            MD035545
     C                     PARM           P@VL07                                            MD035545
     C                     PARM           P@OP08                                            MD035545
     C                     PARM           P@VL08                                            MD035545
     C                     PARM           P@OP09                                            MD035545
     C                     PARM           P@VL09                                            MD035545
     C                     PARM           P@OP10                                            MD035545
     C                     PARM           P@VL10                                            MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
      *                                                                   S01408
     C/COPY WNCPYSRC,LE0400CP21                                           S01408
      *                                                                   S01408
      *
     C                     Z-ADD0         SETRID                                              CLE164
      *                                                                                       CLE164
3063 C           INITEN    ENDSR                           ** INITEN **
3064 C*
3065 C********************************************************************
      *                                                               *                       236196
      * INTSDY - Compute for the number of interest days              *                       236196
      *                                                               *                       236196
      * Called by: MIADJ, PRINC, MANREP, INTPAY, REPAY, SPRCHG,       *                       236196
      *            BRTCHG, BRCCHG, ROLL, STACC, PRINTO                *                       236196
      *                                                               *                       236196
      * Calls: ZINTDY                                                 *                       236196
      *                                                               *                       236196
      *****************************************************************                       236196
     C           INTSDY    BEGSR                                                              236196
     C                     Z-ADDLVDAT     ZZBEG                                               236196
     C                     Z-ADDVDAT      ZZEND                                               236196
     C                     MOVE ICALCB    ZZCALC                                              236196
     C           STRDAT    IFEQ ZZBEG                                                         236196
     C           ADDI      ANDEQ'B'                                                           236196
     C                     ADD  1         ZZEND                                               236196
     C                     END                                                                236196
     C                     EXSR ZINTDY                                                        236196
     C                     Z-ADDZZINDY    NODYSI                                              236196
      *                                                                                     AR737209
      ** Do not update LVDAT if AMTP = 'MI', 'LS' and 'BH'.                                 AR737209
      *                                                                                     AR737209
     C           AMTP      IFNE 'MI'                                                        AR737209
     C           AMTP      ANDNE'LS'                                                        AR737209
     C           AMTP      IFNE 'BH'                                                        AR737209
     C           CLE003    ORNE 'Y'                                                         AR737209
     C                     Z-ADDVDAT      LVDAT                                               236196
     C                     ENDIF                                                            AR737209
     C                     ENDIF                                                            AR737209
     C                     ENDSR                                                              236196
      *****************************************************************                       236196
      *                                                               *                     AR786878
      * SETFLD - Populate LEREMRPD fields.                            *                     AR786878
      *                                                               *                     AR786878
      * Called by: MANREP, REPAY                                      *                     AR786878
      *                                                               *                     AR786878
      * Calls: None                                                   *                     AR786878
      *                                                               *                     AR786878
      *****************************************************************                     AR786878
     C           SETFLD    BEGSR                                                            AR786878
      ********************************************************************           AR786878 CLE164
      ***Retrieve*details*from*LEACCNPD*and*setup*LEREMRPD*fields.********           AR786878 CLE164
      ********************************************************************           AR786878 CLE164
     C                     MOVE *IN40     WIN40   1                                         AR786878
      *                                                                                     AR786878
     C           PTYP      IFEQ 61                                                          AR786878
     C           PTYP      OREQ 68                                                          AR786878
      *                                                                                     AR786878
     C                     SELEC                                                            AR786878
      *                                                                                     AR786878
     C           RSTM      WHEQ 05                                                          AR786878
     C           OSBR      IFEQ *BLANKS                                                     AR786878
     C                     MOVE BRCA      SEBRCA                                            AR786878
     C                     ELSE                                                             AR786878
     C                     MOVE OSBR      SEBRCA                                            AR786878
     C                     ENDIF                                                            AR786878
     C                     MOVE CCY       SEACCY                                            AR786878
     C                     MOVE RONS      DSRPOS                                            AR786878
     C                     MOVE DSACCN    SECNUM                                            AR786878
     C                     MOVE DSACAC    SEACOD                                            AR786878
     C                     MOVE DSACAS    SEACSQ                                            AR786878
      *                                                                                     AR786878
     C           RSTM      WHEQ 14                                                          AR786878
     C                     MOVELRONS      DSACCT 100                                        AR786878
     C           DSACCT    CHAINACNUM                40                                     AR786878
     C           *IN40     IFEQ '0'                                                         AR786878
     C                     MOVE ACCNUM    SECNUM                                            AR786878
     C                     MOVE ACACOD    SEACOD                                            AR786878
     C                     MOVE ACACSQ    SEACSQ                                            AR786878
     C                     MOVE ACBRCA    SEBRCA                                            AR786878
     C                     MOVE ACCCY     SEACCY                                            AR786878
     C                     ENDIF                                                            AR786878
     C                     ENDSL                                                            AR786878
      *                                                                                     AR786878
     C                     ENDIF                                                            AR786878
      *                                                                                     AR786878
     C           KACCNT    KLIST                                                            AR786878
     C                     KFLD           SEBRCA                                            AR786878
     C                     KFLD           SEACCY                                            AR786878
     C                     KFLD           SECNUM                                            AR786878
     C                     KFLD           SEACOD                                            AR786878
     C                     KFLD           SEACSQ                                            AR786878
     C                     KFLD           LNRF                                              AR786878
      *                                                                                     AR786878
     C********** KACCNT    CHAINLEACCNL4             40                              AR786878 CLE164
     C********** *IN40     IFEQ '0'                                                  AR786878 CLE164
     C**********           Z-ADDRPPCKO    SEPCKO                                     AR786878 CLE164
     C**********           ELSE                                                      AR786878 CLE164
     C**********           Z-ADD99999     SEPCKO                                     AR786878 CLE164
     C**********           ENDIF                                                     AR786878 CLE164
     C                     MOVE 'D'       SERECI                                            AR786878
     C                     MOVELLNRF      SELNRF                                            AR786878
     C                     Z-ADDVDAT      SEVDAT                                            AR786878
      *                                                                                     AR989420
     C                     EXSR SROLVD                                                      AR989420
     C           OLVDAT    IFNE *ZERO                                                       AR989420
     C                     MOVE OLVDAT    SEVDAT                                            AR989420
     C                     END                                                              AR989420
      *                                                                                     AR989420
     C                     MOVE LTYP      SELTYP                                            AR786878
     C                     MOVE SUTP      SESUTP                                            AR786878
     C                     MOVELLTYP      SELTY1                                            AR786878
     C                     Z-ADDPRAM      SEPRAM                                            AR786878
     C                     Z-ADDINTA      SEINTA                                            AR786878
     C                     Z-ADDTAMT      SETAMT                                            AR786878
     C                     Z-ADD0         SEAAMT                                            AR786878
     C                     MOVE *BLANKS   SEIPFL                                            AR786878
     C**********           MOVE 'LP'      SEFILE                                     AR786878 CLE164
      *                                                                                     AR786878
      ** For a single MR with both PRAM and INTA not equal to zero,                         AR786878
      ** generate two records for each in LEREMRPD.                                         AR786878
      *                                                                                     AR786878
     C                     Z-ADDPRAM      SAVPR  130                                        MD051946
     C           INTA      IFNE 0                                                           AR786878
     C           AMTP      OREQ 'MA'                                                        AR815697
     C           IAMONT    ANDNE0                                                           AR815697
     C                     Z-ADDINTA      SETAMT                                            AR786878
     C                     Z-ADD0         SEPRAM                                            AR786878
     C                     Z-ADD0         PRAM                                              MD051946
     C                     Z-ADDINTA      SEPAMT                                              CLE164
      *                                                                                     AR815697
     C           AMTP      IFEQ 'MA'                                                        AR815697
     C                     Z-ADDIAMONT    SEINTA                                            AR815697
     C                     Z-ADDIAMONT    SETAMT                                            AR815697
     C                     ENDIF                                                            AR815697
      *                                                                                     AR786878
      ** Set the value of SECATC for Repayment Schedules (Interest)                           CLE164
      *                                                                                       CLE164
     C           AMTP      IFEQ 'IN'                                                          CLE164
     C                     MOVE 'OLINT'   SECATC                                              CLE164
      *                                                                                       CLE164
     C                     SELEC                                                              CLE164
     C           SELTY1    WHEQ 'Z'                                                           CLE164
     C                     MOVE 'ZINTR'   SECATC                                              CLE164
     C           SELTY1    WHEQ 'Y'                                                           CLE164
     C                     MOVE 'YINTR'   SECATC                                              CLE164
     C           SELTY1    WHEQ 'X'                                                           CLE164
     C                     MOVE 'XINTR'   SECATC                                              CLE164
     C                     ENDSL                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           AMTP      IFEQ 'RE'                                                          CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Z'                                                         AR786878
     C**********           Z-ADD200       SEPCKM                                     AR786878 CLE164
     C**********           Z-ADD200       SEPCKT                                     AR786878 CLE164
     C                     MOVE 'ZINTR'   SECATC                                              CLE164
     C                     ENDIF                                                            AR786878
      *                                                                                     AR786878
     C           SELTY1    IFEQ 'Y'                                                         AR786878
     C**********           Z-ADD200       SEPCKM                                     AR786878 CLE164
     C**********           Z-ADD200       SEPCKT                                     AR786878 CLE164
     C                     MOVE 'YINTR'   SECATC                                              CLE164
     C                     ENDIF                                                            AR786878
      *                                                                                     AR786878
     C           SELTY1    IFEQ 'X'                                                         AR786878
     C**********           Z-ADD200       SEPCKM                                     AR786878 CLE164
     C**********           Z-ADD200       SEPCKT                                     AR786878 CLE164
     C                     MOVE 'XINTR'   SECATC                                              CLE164
     C                     ENDIF                                                            AR786878
      *                                                                                       CLE164
      ** Set the value of SECATC for                                                          CLE164
      ** Manual Repayments (Interest)                                                         CLE164
      *                                                                                       CLE164
     C                     ELSE                                                               CLE164
      *                                                                                       CLE164
     C           AMTP      IFEQ 'MR'                                                          CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Y'                                                           CLE164
     C                     MOVE 'YINTM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'X'                                                           CLE164
     C                     MOVE 'XINTM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Z'                                                           CLE164
     C                     MOVE 'ZINTM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                     AR786878
     C                     EXSR RTRPKY                                                        CLE164
     C                     EXSR RTDTE                                                         CLE164
     C                     EXSR SRCVTS                                                      MD046080
      *                                                                                       CLE164
     C                     MOVEL'LEREMRPD'SEFILE                                              CLE164
     C                     ADD  1         SETRID                                              CLE164
     C                     WRITELEREMRD0                                                    AR786878
     C                     Z-ADDSAVPR     PRAM                                              MD051946
     C                     ENDIF                                                            AR786878
      *                                                                                     AR786878
     C                     Z-ADDINTA      SAVIN  130                                        MD051946
     C           PRAM      IFNE 0                                                           AR786878
     C           AMTP      OREQ 'MA'                                                        AR815697
     C           PAMONT    ANDNE0                                                           AR815697
     C                     Z-ADDPRAM      SETAMT                                            AR786878
     C                     Z-ADDPRAM      SEPRAM                                            AR786878
     C                     Z-ADD0         SEINTA                                            AR786878
     C                     Z-ADD0         INTA                                              MD051946
     C                     Z-ADDPRAM      SEPAMT                                              CLE164
      *                                                                                     AR815697
     C           AMTP      IFEQ 'MA'                                                        AR815697
     C                     Z-ADDPAMONT    SETAMT                                            AR815697
     C                     Z-ADDPAMONT    SEPRAM                                            AR815697
     C                     ENDIF                                                            AR815697
      *                                                                                     AR786878
      ** Set value of SECATC for Repayment Schedules (Principal)                              CLE164
      *                                                                                       CLE164
     C           AMTP      IFEQ 'RE'                                                          CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Z'                                                         AR786878
     C**********           Z-ADD300       SEPCKM                                     AR786878 CLE164
     C**********           Z-ADD300       SEPCKT                                     AR786878 CLE164
     C                     MOVE 'ZPRIN'   SECATC                                              CLE164
     C                     ENDIF                                                            AR786878
      *                                                                                     AR786878
     C           SELTY1    IFEQ 'Y'                                                         AR786878
     C**********           Z-ADD350       SEPCKM                                     AR786878 CLE164
     C**********           Z-ADD350       SEPCKT                                     AR786878 CLE164
     C                     MOVE 'YPRIN'   SECATC                                              CLE164
     C                     ENDIF                                                            AR786878
      *                                                                                     AR786878
     C           SELTY1    IFEQ 'X'                                                         AR786878
     C**********           Z-ADD390       SEPCKM                                     AR786878 CLE164
     C**********           Z-ADD390       SEPCKT                                     AR786878 CLE164
     C                     MOVE 'XPRIN'   SECATC                                              CLE164
     C                     ENDIF                                                            AR786878
      *                                                                                       CLE164
      ** Set the value of SECATC for                                                          CLE164
      ** Manual Repayments (Principal)                                                        CLE164
      *                                                                                       CLE164
     C                     ELSE                                                               CLE164
      *                                                                                       CLE164
     C           AMTP      IFEQ 'MR'                                                          CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Y'                                                           CLE164
     C                     MOVE 'YPRIM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'X'                                                           CLE164
     C                     MOVE 'XPRIM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Z'                                                           CLE164
     C                     MOVE 'ZPRIM'   SECATC                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                     AR786878
     C                     EXSR RTRPKY                                                        CLE164
     C                     EXSR RTDTE                                                         CLE164
     C                     EXSR SRCVTS                                                      MD046080
      *                                                                                       CLE164
     C                     MOVEL'LEREMRPD'SEFILE                                              CLE164
     C                     ADD  1         SETRID                                              CLE164
     C                     WRITELEREMRD0                                                    AR786878
     C                     Z-ADDSAVIN     INTA                                              MD051946
     C                     ENDIF                                                            AR786878
      *                                                                                     AR786878
      ** Restore previous value of *IN40.                                                   AR786878
      *                                                                                     AR786878
     C                     MOVE WIN40     *IN40                                             AR786878
      *                                                                                     AR786878
     C                     ENDSR                                                            AR786878
      *****************************************************************                     MD046080
      *                                                               *                     MD046080
      *  SRCVTS - Convert Amount to settle currency                   *                     MD046080
      *                                                               *                     MD046080
      *  Called by: SRCONS                                            *                     MD046080
      *  Calls: ZCONVZ, SETCCY                                        *                     MD046080
      *                                                               *                     MD046080
      *****************************************************************                     MD046080
     C           SRCVTS    BEGSR                                                            MD046080
      *                                                                                     MD046080
     C           CLE031    IFEQ 'Y'                                                         MD046080
     C           CLE034    IFEQ 'N'                                                         MD046080
     C           WSTAL     ORNE 'Y'                                                         MD046080
      *                                                                                     MD046080
     C                     MOVE 'E'       WTYPE                                             MD046080
     C                     EXSR SETCCY                                                      MD046080
      ** Convert if Settlement currency different from loan currency                        MD046080
      ** and settlement currency not blanks                                                 MD046080
     C           WECCY     IFNE WKCCY                                                       MD046080
     C           WKCCY     ANDNE*BLANKS                                                     MD046080
     C                     MOVE WECCY     WCCYA                                             MD046080
     C                     EXSR SRCURR                                                      MD046080
     C                     MOVE CDP       ZCDPI                                             MD046080
     C                     MOVE WECCY     ZCCYI                                             MD046080
      * to Ccy                                                                              MD046080
     C                     MOVE WKCCY     WCCYA                                             MD046080
     C                     EXSR SRCURR                                                      MD046080
     C                     MOVE CDP       ZCDPO                                             MD046080
     C                     MOVE WKCCY     ZCCYO                                             MD046080
     C                     Z-ADDWKCYXR    ZEXCH                                             MD046080
     C                     MOVE WKCYIN    ZMD                                               MD046080
      ** Convert SEPRAM to settlement currency                                              MD046080
     C           SEPRAM    IFNE 0                                                           MD046080
     C                     Z-ADDSEPRAM    ZAMTCI                                            MD046080
     C                     EXSR ZCONVZ                                                      MD046080
     C                     Z-ADDZAMTCO    SEPRAM                                            MD046080
     C                     ENDIF                                                            MD046080
      ** Convert INTA Amount to settlement currency                                         MD046080
     C           SEINTA    IFNE 0                                                           MD046080
     C                     Z-ADDSEINTA    ZAMTCI                                            MD046080
     C                     EXSR ZCONVZ                                                      MD046080
     C                     Z-ADDZAMTCO    SEINTA                                            MD046080
     C                     ENDIF                                                            MD046080
     C                     Z-ADDSEPRAM    SETAMT                                            MD046080
     C                     ADD  SEINTA    SETAMT                                            MD046080
     C                     Z-ADDSETAMT    SEPAMT                                            MD046080
     C                     ENDIF                                                            MD046080
     C                     ENDIF                                                            MD046080
     C                     ENDIF                                                            MD046080
      *                                                                                     MD046080
     C                     ENDSR                                                            AR786878
      *****************************************************************                     AR786878
      *                                                               *                     AR989420
      *  SROLVD - Retrieve OL Value Date or Fee Start Date            *                     AR989420
      *                                                               *                     AR989420
      *  Called by: SrWrite                                           *                     AR989420
      *  Calls: None                                                  *                     AR989420
      *                                                               *                     AR989420
      *****************************************************************                     AR989420
     C           SROLVD    BEGSR                                                            AR989420
      *                                                                                     AR989420
      ** Clear fields                                                                       AR989420
      *                                                                                     AR989420
     C**********           MOVE *IN40     WIN40   1                                AR989420 MD020985
     C                     MOVE *IN40     OLD40   1                                AR989420 MD020985
     C                     MOVELWLTYP     WKLTYP  1                                         AR989420
     C                     CLEARYPORG                                                       AR989420
     C                     CLEAROLVDAT                                                      AR989420
     C                     CLEARYECNUM                                                      AR989420
     C                     CLEARYEFACL                                                      AR989420
     C                     CLEARYESEQ                                                       AR989420
      *                                                                                     AR989420
      ** Retrieve details of Original Loan                                                  AR989420
      *                                                                                     AR989420
     C           KPDLC     KLIST                                                            AR989420
     C                     KFLD           KYRECI  1                                         AR989420
     C                     KFLD           LNRF                                              AR989420
      *                                                                                     AR989420
      ** Retrieve Fee details                                                               AR989420
      *                                                                                     AR989420
     C           KFEES     KLIST                                                            AR989420
     C                     KFLD           YECNUM                                            AR989420
     C                     KFLD           YEFACL                                            AR989420
     C                     KFLD           YPORG                                             AR989420
     C                     KFLD           YESEQ                                             AR989420
      *                                                                                     AR989420
      ** Check Loans PDCLs                                                                  AR989420
      *                                                                                     AR989420
     C                     MOVE 'P'       KYRECI                                            AR989420
      *                                                                                     AR989420
      ** Check LOAN PDCLs File (LEPDUEPD)                                                   AR989420
      *                                                                                     AR989420
     C           WKLTYP    IFNE 'Z'                                                         AR989420
     C           KPDLC     CHAINLEPDUELZ             40                                     AR989420
      *                                                                                     AR989420
     C           YPORG     IFNE *BLANKS                                                     AR989420
     C           *IN40     ANDEQ*OFF                                                        AR989420
     C           YPORG     CHAINMCLONCL1             40                                     AR989420
     C                     ENDIF                                                            AR989420
     C                     ENDIF                                                            AR989420
      *                                                                                     AR989420
      ** Check Fees PDCLs file (LEPDUFPD)                                                   AR989420
      *                                                                                     AR989420
     C           WKLTYP    IFEQ 'Z'                                                         AR989420
     C           KPDLC     CHAINLEPDUFLZ             40                                     AR989420
     C           *IN40     IFEQ *OFF                                                        AR989420
     C           KFEES     CHAINLEFEEDLZ             40                                     AR989420
     C                     ENDIF                                                            AR989420
     C                     ENDIF                                                            AR989420
      *                                                                                     AR989420
     C**********           MOVE WIN40     *IN40                                    AR989420 MD020985
     C                     MOVE OLD40     *IN40                                    AR989420 MD020985
      *                                                                                     AR989420
     C                     ENDSR                                                            AR989420
      *                                                                                     AR989420
      *****************************************************************                     AR989420
      *                                                               *                     AR317587
      * HIST1  - Subroutine to process history records later than     *                     AR317587
      *          maturity.                                            *                     AR317587
      *                                                               *                     AR317587
      * Called by: ACTN                                               *                     AR317587
      * Calls: None                                                   *                     AR317587
      *****************************************************************                     AR317587
     C           HIST1     BEGSR                                                            AR317587
      *                                                                                     AR317587
     C           CLE003    IFEQ 'Y'                                                         AR317587
      *                                                                                     AR317587
     C                     Z-ADDXCPAM     W#CPAM                                            AR317587
     C                     Z-ADDXAITC     W#AITC                                            AR317587
     C                     Z-ADDXIPRD     W#IPRD                                            AR317587
     C                     Z-ADDXAIAP     W#AIAP                                            AR317587
     C                     Z-ADDXINTR     W#INTR                                            AR317587
     C                     Z-ADDXACDA     W#ACDA                                            AR317587
     C                     Z-ADDXCOFD     W#COFD                                            AR317587
     C                     Z-ADDXACAP     W#ACAP                                            AR317587
     C                     Z-ADDXCOFR     W#COFR                                            AR317587
      *                                                                                     AR317587
      ** Save the current AITC.                                                             AR317587
      *                                                                                     AR317587
     C                     Z-ADDXAITC     L#AITC                                            AR317587
      *                                                                                     AR317587
     C           *IN67     IFEQ *OFF                                                        AR317587
     C                     Z-ADDXCPAM     OSPRIN                                            AR317587
     C                     Z-ADDXINTR     INTRAT                                            AR317587
      *                                                                                     AR317587
     C           XAITC     ADD  XAIAP     ACCINT                                            AR317587
     C           XAITC     ADD  XAIAP     AIIACD                                            AR317587
      *                                                                                     AR317587
      ** If Analytical accounting is ON.                                                    AR317587
      *                                                                                     AR317587
     C           BGN0ST    IFEQ 'Y'                                                         AR317587
     C                     Z-ADDXCOFR     COFRAT                                            AR317587
     C           XACDA     ADD  XACAP     ACCCOF                                            AR317587
     C           XACDA     ADD  XACAP     ACIACD                                            AR317587
     C                     ENDIF                                                            AR317587
      *                                                                                     AR317587
      ** Use the expected value date as LVDAT for action history                            AR317587
      ** record with VDAT later than MDAT.                                                  AR317587
      *                                                                                     AR317587
     C           XVDAT     IFGT WMDAT                                                       AR317587
     C           XEXVD     ANDNE*ZEROS                                                      AR317587
     C           WMDAT     ANDNE*ZEROS                                                     AR1084876
     C                     Z-ADDWMDAT     LVDAT                                             AR317587
     C                     ELSE                                                             AR317587
     C                     Z-ADDXVDAT     LVDAT                                             AR317587
     C                     ENDIF                                                            AR317587
      *                                                                                     AR317587
      ** If Analytical accounting is ON                                                     AR317587
      *                                                                                     AR317587
     C           BGN0ST    IFEQ 'Y'                                                         AR317587
     C           XVDAT     IFGT WMDAT                                                       AR317587
     C           XEXVD     ANDNE*ZEROS                                                      AR317587
     C           WMDAT     ANDNE*ZEROS                                                     AR1084876
     C                     Z-ADDWMDAT     CVDAT                                             AR317587
     C                     ELSE                                                             AR317587
     C                     Z-ADDXVDAT     CVDAT                                             AR317587
     C                     ENDIF                                                            AR317587
     C                     ENDIF                                                            AR317587
     C                     ELSE                                                             AR317587
      *                                                                                     AR317587
      ** Subtract MR amount from outstanding principal                                      AR317587
      *                                                                                     AR317587
     C           OSPRIN    SUB  XPRAM     OSPRIN                                            AR317587
     C           OSPRIN    IFEQ 0                                                           AR317587
     C                     Z-ADDXPRAM     TPRAM  130                                        AR317587
     C                     ENDIF                                                            AR317587
     C                     ENDIF                                                            AR317587
     C                     ENDIF                                                            AR317587
      *                                                                                     AR317587
     C                     ENDSR                                                            AR317587
      *****************************************************************                     AR317587
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT
     C/COPY ZSRSRC,GLINTCZ1
      /EJECT
     C/COPY ZSRSRC,ZSAVEZ1
      /EJECT
     C/COPY ZSRSRC,ZRSTORZ1
     C/COPY ZSRSRC,ZBKDT                                                                      263903
     C/COPY ZSRSRC,ZFWDT                                                                      263903
      /EJECT
3341 C********************************************************************
3342 C**
3343 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
3344 C**
3345 C** CALLED BY:  INIT
3346 C**
3347 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
3348 C**
3349 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
     C**********           MOVEL'01      'ZTABKY 12                       S01194
     C**********           MOVE '  10'    ZTABKY                          S01194
     C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     COMP *BLANKS              9999                 S01194
     C*                                                                   S01194
     C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
3355 C**
3356 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
3357 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
3358 C**
3359 C                     ENDSR
3360 C**
3361 C**
3362 C********************************************************************
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
      *                                                                   S01117
      ** OPEN P1 SPOOL FILE                                               S01117
     C                     OPEN LE0400P1                                  S01117
     C                     SETON                     OF                   S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      **                                                                  S01117
      **  EXCEPT NO DETAIL MESSAGE TO P1                                  S01117
      **                                                                  S01117
     C           *INU7     IFNE '1'                                       S01117
     C                     EXCPTP1NODL                                    S01117
     C                     EXCPTP1END                                     S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************                    CLE164
     C*                                                                  *                    CLE164
     C* RTRPKY - Retrieve values for Repayment Priority  and             *                    CLE164
     C*          Category Code Default Repayment Priority                *                    CLE164
     C*                                                                  *                    CLE164
     C*                                                                  *                    CLE164
     C* CALLED FROM: SETFLD                                              *                    CLE164
     C*                                                                  *                    CLE164
     C* CALLS: NONE                                                      *                    CLE164
     C*                                                                  *                    CLE164
     C********************************************************************                    CLE164
     C           RTRPKY    BEGSR                                                              CLE164
      *                                                                                       CLE164
      ** Determine Extension file to use in LE000801                                          CLE164
      *                                                                                       CLE164
     C                     MOVE *BLANKS   XTFILE                                              CLE164
     C********** SELTY1    IFEQ 'Z'                                                  CLE164 MD037495
     C           SECATC    IFEQ 'LFEE'                                                      MD037495
     C           SECATC    OREQ 'LFEM'                                                      MD037495
     C           SECATC    OREQ 'FFEE'                                                      MD037495
     C           SECATC    OREQ 'FFEM'                                                      MD037495
     C           SECATC    OREQ 'Fee90'                                                     MD037495
     C           SECATC    OREQ 'Fee9M'                                                     MD037495
     C                     MOVEL'LEFEEZTD'XTFILE 10                                           CLE164
     C                     MOVE YBRCA     PBRCA                                             MD038509
     C                     MOVE YECNUM    PCNUM                                             MD038509
     C                     ELSE                                                               CLE164
      *                                                                                     MD037495
      ** Other Category Codes are for Loans, YINTR,YINTM,YPRIN,YPRIM                        MD037495
      ** XINTR,XINTM,XPRIN,XPRIM, ZINTR, ZINTM, ZPRIN, ZPRIM                                MD037495
      ** OLINT, OLINM, OLPRI, OLPRM                                                         MD037495
      *                                                                                     MD037495
     C                     MOVEL'CLOANZTD'XTFILE                                              CLE164
     C                     MOVE BRCA      PBRCA                                             MD038509
     C                     MOVE CNUM      PCNUM                                             MD038509
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
      **  Call PGM LE000801 to retrieve value for                                             CLE164
      **  Repayment Priority and Category Code Default                                        CLE164
      **  Repayment Priority                                                                  CLE164
      *                                                                                       CLE164
     C                     CALL 'LE000801'                                                    CLE164
     C                     PARM *BLANK    PRTCDR  7                                           CLE164
     C                     PARM SECATC    PCATC   5                                           CLE164
     C                     PARM XTFILE    PFILE  10                                           CLE164
     C                     PARM LNRF      PLNRF   6                                           CLE164
     C**********           PARM YBRCA     PBRCA   3                                  CLE164 MD038509
     C                     PARM           PBRCA   3                                         MD038509
     C**********           PARM YECNUM    PCNUM   6                                  CLE164 MD038509
     C                     PARM           PCNUM   6                                         MD038509
     C                     PARM YEFACL    PFCNR                                               CLE164
     C                     PARM YESEQ     PFSEQ                                               CLE164
     C                     PARM *ZEROS    PREPR                                               CLE164
     C                     PARM *ZEROS    PCAPR                                               CLE164
     C                     PARM *BLANK    PODFL   1                                           CLE164
      *                                                                                       CLE164
     C                     Z-ADDPREPR     SEREPR                                              CLE164
     C                     Z-ADDPCAPR     SECAPR                                              CLE164
     C                     MOVE PODFL     SEOVFL                                              CLE164
      *                                                                                       CLE164
     C                     ENDSR                                                              CLE164
      *                                                                                       CLE164
      ********************************************************************                    CLE164
     C*                                                                  *                    CLE164
     C* RTDTE - Retrieve values for Date fields of LEREMRPD              *                    CLE164
     C*                                                                  *                    CLE164
     C* CALLED FROM: SETFLD                                              *                    CLE164
     C*                                                                  *                    CLE164
     C* CALLS: NONE                                                      *                    CLE164
     C*                                                                  *                    CLE164
     C********************************************************************                    CLE164
     C           RTDTE     BEGSR                                                              CLE164
      *                                                                                       CLE164
     C                     MOVE *IN26     WIN26   1                                           CLE164
      *                                                                                       CLE164
     C           SELTY1    IFEQ 'Z'                                                           CLE164
      *                                                                                       CLE164
     C           KFEES     CHAINLEFEEDL1             26                                       CLE164
     C           *IN26     IFEQ '0'                                                           CLE164
     C                     MOVE FEPSTD    SESDAT                                              CLE164
     C                     MOVE FEPEND    SEMDAT                                              CLE164
     C                     ENDIF                                                              CLE164
     C                     ELSE                                                               CLE164
     C           KORLN     KLIST                                                              CLE164
     C                     KFLD           YPORG                                               CLE164
     C                     KFLD           RCDT                                                CLE164
     C                     MOVE 'A'       RCDT                                                CLE164
     C           KORLN     CHAINCLOAN                26                                       CLE164
     C           *IN26     IFEQ '0'                                                           CLE164
     C                     MOVE WVDAT     SESDAT                                              CLE164
     C                     MOVE WMDAT     SEMDAT                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     MOVE VDAT      SEVDPD                                              CLE164
     C                     MOVE BJRDNB    SEVDPY                                              CLE164
     C                     MOVE WIN26     *IN26                                               CLE164
      *                                                                                       CLE164
     C                     MOVE WFTYP     FTYPA   3                                           CLE164
     C                     MOVE WFSEQ     FSEQA   2                                           CLE164
      *                                                                                       CLE164
     C                     MOVEL*BLANKS   SETREF                                              CLE164
     C           LNRF      CAT  FTYPA     LNFT    9                                           CLE164
     C           LNFT      CAT  FSEQA     SETREF                                              CLE164
      *                                                                                       CLE164
     C                     MOVE *BLANKS   SEAKEY                                              CLE164
     C                     MOVE TMST      SETMST                                              CLE164
     C                     MOVELK1        SEAKEY                                              CLE164
     C           PRAM      IFEQ 0                                                             CLE164
     C           INTA      ANDNE0                                                             CLE164
     C                     MOVELK2        SEAKEY                                              CLE164
     C                     ENDIF                                                              CLE164
      *                                                                                       CLE164
     C                     ENDSR                                                              CLE164
      *                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
      /EJECT                                                                                  CLE028
     C/COPY ZSRSRC,ZFREQBZ2                                                                   CLE028
      /EJECT                                                                                  CLE028
     C/COPY ZSRSRC,RULE78Z1                                                                   CLE028
      /EJECT                                                                                  CLE028
     C/COPY ZSRSRC,ZDATE1Z2                                                                   CLE028
      /EJECT                                                                                  CLE028
     C/COPY ZSRSRC,ZACCH                                                                      CLE028
      /EJECT                                                                                  CLE028
     C/COPY ZSRSRC,ZCHKH                                                                      CLE028
     C/COPY WNCPYSRC,LE0400CP99                                           S01408
3363 O*
3364 O** PAY/RECEIVE TELEX EXTRACT FILE
3365 O*
3366 OLETLXHH E        40NU3
3367 O                                    1 'H'
3368 O*
3369 O** OUTPUT DETAIL REC
3370 O*
3371 OLETLXDK E        82NU3
3372 O                         LOTA1    256
3373 O                         LOTA2    320
     O***********              LOTA3    949                        S01518 CAC001
     O***********              LOTA3    969                        CAC001 CLE005
     O***********              LOTA3   1060                        CLE005 CEU004
     O***********              LOTA3   1066                        CEU004 CEU020
     O**********               LOTA3   1067                                            CEU020 CLE028
     O**********               LOTA3   1075                                            CLE028 CAS005
     O**********               LOTA3   1089                                            CAS005 CLE031
     O**********               LOTA3   1108                                            CLE031 CLE034
     O**********               LOTA3   1109                                            CLE034 CAP075
     O**********               LOTA3   1176                                            CAP075 CGL029
     O**********               LOTA3   1230                                            CGL029 CLE036
     O*************************LOTA3   1268                                            CLE036 CLE042
     O                         LOTA3   1291                                                   CLE042
3374 O                 18      OPPRAM    44P
3375 O                 18      OPINTA    51P
3376 O                 18      OPWTXA    58P
3377 O                 18      OPTAMT    72P
3378 O                 18      OPINTC   253
     O                         OSBR     263                               CLE033
     O                 18      OPCOFA   967P                              CAC001
3379 O*
3380 O** IF INT. IS CAP'D,O/P 2ND. RECORD FOR MATURITIES
3381 O*
3382 O        E        88NU3
3383 O                         LOTA1    256
3384 O                         LOTA2    320
     O***********              LOTA3    949                        S01518 CAC001
     O***********              LOTA3    969                        CAC001 128058
     O***********              LOTA3   1060                        128058 CEU004
     O***********              LOTA3   1066                        CEU004 CEU020
     O**********               LOTA3   1067                                            CEU020 CLE028
     O**********               LOTA3   1075                                            CLE028 CAS005
     O**********               LOTA3   1089                                            CAS005 CLE031
     O**********               LOTA3   1108                                            CLE031 CLE034
     O**********               LOTA3   1109                                            CLE034 CAP075
     O**********               LOTA3   1176                                            CAP075 CGL029
     O**********               LOTA3   1230                                            CGL029 CLE036
     O*************************LOTA3   1268                                            CLE036 CLE042
     O                         LOTA3   1291                                                   CLE042
3385 O                                   24 'IN'
3386 O                         OPINTA    44P
3387 O                         OPINTA    51P
3388 O                         ZERO13    58P
3389 O                         OPINTA    72P
3390 O                                  253 'Y'
     O                         OSBR     263                               CLE033
     O                         OPCOFA   967P                              CAC001
3391 O*
3392 OLETLXZX T        LR 50NU3
3393 O                                    1 'T'
3394 O                         NLETLX    19P
3395 O*
3396 O** CONFIRMATIONS EXTRACT FILE
3397 O*
3398 OCONFSHH E        40NU3
3399 O                                    1 'H'
3400 O*
3401 O** OUTPUT DETAIL REC.
3402 O*
3403 OCONFSDK E        83NU3
3404 O                         LOTA1    256
3405 O                         LOTA2    320
     O***********              LOTA3    949                        S01518 CAC001
     O***********              LOTA3    969                        CAC001 CLE005
     O***********              LOTA3   1060                        CLE005 CEU004
     O***********              LOTA3   1066                        CEU004 CEU020
     O**********               LOTA3   1067                               CEU020              CLE028
     O**********               LOTA3   1075                                            CLE028 CAS005
     O**********               LOTA3   1089                                            CAS005 CLE031
     O**********               LOTA3   1108                                            CLE031 CLE034
     O**********               LOTA3   1109                                            CLE034 CAP075
     O**********               LOTA3   1176                                            CAP075 CGL029
     O**********               LOTA3   1230                                            CGL029 CLE036
     O*************************LOTA3   1268                                            CLE036 CLE042
     O                         LOTA3   1291                                                   CLE042
     O/COPY WNCPYSRC,LE0400O001
3406 O                 18      OPPRAM    44P
3407 O                 18      OPINTA    51P
3408 O                 18      OPWTXA    58P
3409 O                 18      OPTAMT    72P
     O/COPY WNCPYSRC,LE0400O002
3410 O                 18      OPINTC   253
3411 O                         NACD     254
3412 O** EXTRACT DATE -- CONFS. ONLY
3413 O** N.B. TNLU NOT USED HERE
3414 O                         EXTD     320P
     O                 18      OPCOFA   967P                              CAC001
3415 O*
3416 OCONFSZX T        LR 50NU3
3417 O                                    1 'T'
3418 O                         NCONFS    19P
3419 O*
3420 O** INTEREST STATEMENTS EXTRACT FILE
3421 O*
3422 OINTSTHH E        40
3423 O                                    1 'H'
3424 O*
3425 O** OUTPUT OF INTEREST HEADER
3426 O*
3427 OINTSTHN E        49
3428 O                                    2 'DH'
3429 O***********              BRCD       5                               S01117
3429 O                         BRCA       5                               S01117
3430 O                         CNUM      11
3431 O                         LNRF      17
3432 O                         VDAT      22
3433 O                 25      VDATS     22
3434 O                                   27 '48000'
3435 O                         LTYP      36
3436 O                         SUTP      38
3437 O                         PTYP      40
3438 O                         CCY       43
3439 O                                   45 'IH'
3440 O                         OSPRIN    52P
3441 O                         BASERT    58P
3442 O                         SPREAD    64P
3443 O                         ICALCB    65
3444 O                         SPRIND    66
3445 O                         ACCIN     73P
3446 O                N25      STPG      76P
3447 O                 25      ZERO5     76P
3448 O                         NACD      77
3449 O                         CAPNIN    78
3450 O                N25      PPIS      85P
3451 O                 25      ZERO13    85P
3452 O                N25      IPIS      92P
3453 O                 25      ZERO13    92P
3454 O                N25      IPPS      99P
3455 O                 25      ZERO13    99P
     O                         CLAS     104                                                   CLE042
3456 O*
3457 O** OUTPUT DETAIL RECORD
3458 O*
3459 OINTSTHQ E        58
3460 O       OR        59
3461 O                                    1 'D'
3462 O                 58                 2 'D'
3463 O                 59                 2 'E'
3464 O***********              BRCD       5                               S01117
3464 O                         BRCA       5                               S01117
3465 O                         CNUM      11
3466 O                         LNRF      17
3467 O                         VDAT      22
3468 O                         PRSQ      24
3469 O                         LASN      27
3470 O                         FCUS      33
3471 O                         FTYP      36
3472 O                         FSEQ      38
3473 O                         PTYP      40
3474 O                         CCY       43
3475 O                         AMTP      45
3476 O                 58      PAMONT    52P
3477 O                 58      IAMONT    59P
3478 O                 58      TAMONT    66P
3479 O                 58      FAMONT    73P
3480 O                 58      FEECOD    75
3481 O                 58      WRTOFF    76
3482 O                 58      EXVDAT    79P
3483 O                 59      BRATEC    47
3484 O                 59      BRATE     53P
3485 O                 59      RATSPD    59P
3486 O                 59      SPINDI    60
3487 O                 59      CALBAS    61
3488 O                 59      STSTAC    62
3489 O*
3490 O                 58 05   LOTH     100
3491 O                 59 06   LOTH     100
3492 O*
3493 O                         NODYSI    82P
3494 O                         TINTTM    89P
3495 O*
3496 OINTSTZX T        LR 50
3497 O                                    1 'T'
3498 O                         NINTST     4P
3499 O*
3500 O** CUSTOMER BILL/TELEX EXTRACT FILE
3501 O*
3502 OCUTX1HH E        40NU3
3503 O                                    1 'H'
3504 O*
3505 O** OUTPUT OF INTEREST HEADER
3506 O*
3507 OCUTX1HN E        52NU3
3508 O                                    2 'DH'
3509 O***********              BRCD       5                               S01117
3509 O                         BRCA       5                               S01117
3510 O                         CNUM      11
3511 O                         LNRF      17
3512 O                         PHVDAT    22
3513 O                 25      VDATS     22
3514 O                                   27 '48000'
3515 O                         FCUS      33
3516 O                         FTYP      36
3517 O                         FSEQ      38
3518 O                         PTYP      40
3519 O                         CCY       43
3520 O                                   45 'IH'
3521 O                         OSPRIN    52P
3522 O                         BASERT    58P
3523 O                         SPREAD    64P
3524 O                         ICALCB    65
3525 O                         SPRIND    66
3526 O                         ACCIN     73P
3527 O                         ZERO5     76P
3528 O                         NACD      77
3529 O                         CAPNIN    78
3530 O                         TOTINP    85P
3531 O                         WTRT      91P
3532 O                         LTVD      94P
3533 O                         WHTTYP    95
3534 O                         BTIN     100
     O                         CPAM     107P                              CLE004
     O                         AITC     114P                              CLE004
     O                         INTR     120P                              CLE004
     O                         AIAP     127P                              CLE004
     O                         IPRD     134P                              CLE004
     O                         ADIF     135                                                   CLE028
3535 O*
3536 O** OUTPUT DETAIL RECORDS
3537 O*
3538 OCUTX1HP E        78NU3
3540 O                                    1 'D'
3541 O                                    2 'D'
3543 O***********              BRCD       5                               S01117
3543 O                         BRCA       5                               S01117
3544 O                         CNUM      11
3545 O                         LNRF      17
3546 O                         VDAT      22
3547 O                         PRSQ      24
3548 O                         LASN      27
3549 O                         FCUS      33
3550 O                         FTYP      36
3551 O                         FSEQ      38
3552 O                         PTYP      40
3553 O                         CCY       43
3554 O                         AMTP      45
3555 O                         PAMONT    52P
3556 O                         IAMONT    59P
3557 O                         TAMONT    66P
3558 O                         FAMONT    73P
3559 O                         FEECOD    75
3560 O                         WRTOFF    76
3561 O                         EXVDAT    79P
3562 O                         ACBI   B  90
3569 O*
3570 O                    05   LOTH     100
3572 O                         NODYSI    82P
3573 O                N23      ZERO5     82P
3574 O                         TINTTM    89P
3575 O                         REPTYP    98
3576 O                         CTRQ      99
3577 O                         BTIN     100
     O                         CPAM     107P                              CLE004
     O                         AITC     114P                              CLE004
     O                         INTR     120P                              CLE004
     O                         AIAP     127P                              CLE004
     O                         IPRD     134P                              CLE004
     O                         BVMV     135                               CLE004
     O                         SCCY     138                               CEU004
     O                         CHDU     145P                                                  CLE028
     O                         SEXR     152P                                                  CLE031
     O                         SEXI     153                                                   CLE031
      *                                                                                       CLE004
3538 OCUTX1HQ E        79NU3
3540 O                                    1 'D'
3542 O                                    2 'E'
3543 O***********              BRCD       5                               S01117
3543 O                         BRCA       5                               S01117
3544 O                         CNUM      11
3545 O                         LNRF      17
3546 O                         VDAT      22
3547 O                         PRSQ      24
3548 O                         LASN      27
3549 O                         FCUS      33
3550 O                         FTYP      36
3551 O                         FSEQ      38
3552 O                         PTYP      40
3553 O                         CCY       43
3554 O                         AMTP      45
3563 O                         BRATEC    47
3564 O                         BRATE     53P
3565 O                         RATSPD    59P
3566 O                         SPINDI    60
3567 O                         CALBAS    61
3568 O                         STSTAC    62
3569 O*
3571 O                    06   LOTH     100
     O                    06   RTSP      59P                              188115
3572 O                         NODYSI    82P
3573 O                N23      ZERO5     82P
3574 O                         TINTTM    89P
3577 O                         BTIN     100
     O                         CPAM     107P                              CLE004
     O                         AITC     114P                              CLE004
     O                         INTR     120P                              CLE004
     O                         AIAP     127P                              CLE004
     O                         IPRD     134P                              CLE004
     O                         BVMV     135                               CLE004
     O                         RLCY     138                               CLE004
3578 O*
3579 OCUTX1ZX T        LR 50NU3
3580 O                                    1 'T'
3581 O                         NCUTX1     4P
3582 O*
3583 O** PARTICIPATIONS SOLD MOVEMENTS FILE
3584 O*
3585 OPTSLDHH E        40
3586 O                                    1 'H'
3587 O*
3588 O** OUTPUT DETAIL REC.
3589 O*
3590 OPTSLDPT E        84
3591 O                                    1 'D'
3592 O                         RLON       7
3593 O                         AMTP       9
3594 O                         PAMONT    16P
3595 O                                   17 '3'
     O                         AUTO      18
     O                         BRCA      40                               S01117
3596 O*
3597 OPTSLDZX T        LR 50
3598 O                                    1 'T'
3599 O                         NPTSLD     4P
3600 O*
3601 O** NEW HISTORY FILE
3602 O*
3603 O** OUTPUT OF HISTORY RECORD AS INPUT
3604 O*
3605 OHIUPDHH E        41 01
3607 O                         LOTH     100
3609 O*
3605 OHIUPDHM E        42 02
     O       OR        42 74
3607 O***********              LOTH     100                               CAC001
     O***********              LOTHM    118                        CAC001 CLE003
     O***********              LOTHM    152                        CLE003 157669
     O**********               LOTHM    179                                            157669 CAS005
     O*************************LOTHM    214                                            CAS005 CLE042
     O**********               LOTHM    218                                            CLE042 CRE073
     O                         LOTHM    247                                                   CRE073
3608 O                 68                 1 'M'
     O***********      03 80   BRTE      58P                              104444
     O***********      04 80   BRTE      58P                              104444
     O***********      06      BRTE      53P                       E47238 104444
     O                 03 80   BRTE      60P                              104444
     O                 04 80   BRTE      60P                              104444
     O                 06      BRTE      60P                              104444
     O                 06      RTSP      66P                              188115
     O***********              CPAM     125P                       CLE003 147438
     O***********              AITC     132P                       CLE003 147438
     O***********              INTR     138P                       CLE003 147438
     O***********              AIAP     145P                       CLE003 147438
     O***********              IPRD     152P                       CLE003 147438
     O                N74      CPAM     125P                              147438
     O                N74      AITC     132P                              147438
     O                N74      INTR     138P                              147438
     O                N74      AIAP     145P                              147438
     O                N74      IPRD     152P                              147438
     O                N74      ACDA     159P                              157669
     O                N74      COFR     165P                              157669
     O                N74      ACAP     172P                              157669
     O                N74      COFD     179P                              157669
     O                N74      AITN     186P                                                  CAS005
     O                N74      AIAN     193P                                                  CAS005
     O                N74      IPRN     200P                                                  CAS005
     O                N74      FSCPAM   214P                                                  CAS005
     O**********       06      CNSPO    235P                                         CRE073 AR824724
     O**********       06      CNSGO    236                                          CRE073 AR824724
     O**********       06      RDMTO    243                                          CRE073 AR824724
     O**********       06      RDFDO    247                                          CRE073 AR824724
     O                 06      CNSP     235P                                                AR824724
     O                 06      CNSG     236                                                 AR824724
     O                 06      RDMT     243                                                 AR824724
     O                 06      RDFD     247                                                 AR824724
      *                                                                   147438
3605 OHIUPDHN E        42 03
3606 O       OR        42 04
     O       OR        42 75
3607 O***********              LOTH     100                               CAC001
     O**********               LOTHN    118                                            CAC001 CAS005
     O**********               LOTHN    132                                            CAS005 CRE073
     O                         LOTHN    161                                                   CRE073
3608 O                 68                 1 'M'
     O                 03 80   BRTE      58P
     O                 04 80   BRTE      58P
     O***********      06      BRTE      53P                       E47238 104444
     O                 06      BRTE      58P                              104444
     O                 06      RTSP      64P                              188115
     O**********       06      CNSPO    149P                                         CRE073 AR824724
     O**********       06      CNSGO    150                                          CRE073 AR824724
     O**********       06      RDMTO    157                                          CRE073 AR824724
     O**********       06      RDFDO    161                                          CRE073 AR824724
     O                 06      CNSP     149P                                                AR824724
     O                 06      CNSG     150                                                 AR824724
     O                 06      RDMT     157                                                 AR824724
     O                 06      RDFD     161                                                 AR824724
3605 OHIUPDHP E        42 05
     O       OR        42 76
3607 O***********              LOTH     100                               CAC001
     O***********              LOTHP    107                        CAC001 CLE003
     O***********              LOTHP    141                        CLE003 122667
     O***********              LOTHP    150                        122667 157669
     O***********              LOTHP    177                        157669 CPB002
     O**********               LOTHP    178                                            CPB002 CAS005
     O*************************LOTHP    220                                            CAS005 CLE042
     O**********               LOTHP    231                                         CLE042 AR1057551
     O                         LOTHP    232                                                AR1057551
3608 O                 68                 1 'M'
     O***********      03 80   BRTE      58P                              104444
     O***********      04 80   BRTE      58P                              104444
     O***********      06      BRTE      53P                       E47238 104444
     O***********              CPAM     114P                       CLE003 147438
     O***********              AITC     121P                       CLE003 147438
     O***********              INTR     127P                       CLE003 147438
     O***********              AIAP     134P                       CLE003 147438
     O***********              IPRD     141P                       CLE003 147438
     O                N76      CPAM     114P                              147438
     O                N76      AITC     121P                              147438
     O                N76      INTR     127P                              147438
     O                N76      AIAP     134P                              147438
     O                N76      IPRD     141P                              147438
     O                N76      ACDA     157P                              157669
     O                N76      COFR     163P                              157669
     O                N76      ACAP     170P                              157669
     O                N76      COFD     177P                              157669
     O                         CHDU     185P                                                  CLE028
     O                N76      AITN     192P                                                  CAS005
     O                N76      AIAN     199P                                                  CAS005
     O                N76      IPRN     206P                                                  CAS005
     O                N76      INTN     220P                                                  CAS005
     O                N76      FSCPAM   227P                                                  CAS005
      *                                                                   147438
3605 OHIUPDHQ E        42 06
     O       OR        42 77
3607 O***********              LOTH     100                               CAC001
     O***********              LOTHQ    113                        CAC001 CLE003
     O***********              LOTHQ    147                        CLE003 127069
     O***********              LOTHQ    151                        127069 157669
     O**********               LOTHQ    178                                            157669 CAS005
     O**********               LOTHQ    199                                            CAS005 262540
     O**********               LOTHQ    206                                            262540 CRE073
     O                         LOTHQ    235                                                   CRE073
3608 O                 68                 1 'M'
     O***********      03 80   BRTE      58P                              104444
     O***********      04 80   BRTE      58P                              104444
     O                 03 80   BRTE      53P                              104444
     O                 04 80   BRTE      53P                              104444
     O                 06      BRTE      53P                              E47238
     O                 06      RTSP      59P                              188115
     O***********              CPAM     120P                       CLE003 147438
     O***********              AITC     127P                       CLE003 147438
     O***********              INTR     133P                       CLE003 147438
     O***********              AIAP     140P                       CLE003 147438
     O***********              IPRD     147P                              147438
     O                N77      CPAM     120P                              147438
     O                N77      AITC     127P                              147438
     O                N77      INTR     133P                              147438
     O                N77      AIAP     140P                              147438
     O                N77      IPRD     147P                              147438
     O                N77      ACDA     158P                              157669
     O                N77      COFR     164P                              157669
     O                N77      ACAP     171P                              157669
     O                N77      COFD     178P                              157669
     O                N77      AITN     185P                                                  CAS005
     O                N77      AIAN     192P                                                  CAS005
     O                N77      IPRN     199P                                                  CAS005
     O                N77      FSCPAM   206P                                                  CAS005
     O**********       06      CNSPO    223P                                         CRE073 AR824724
     O**********       06      CNSGO    224                                          CRE073 AR824724
     O**********       06      RDMTO    231                                          CRE073 AR824724
     O**********       06      RDFDO    235                                          CRE073 AR824724
     O                 06      CNSP     223P                                                AR824724
     O                 06      CNSG     224                                                 AR824724
     O                 06      RDMT     231                                                 AR824724
     O                 06      RDFD     235                                                 AR824724
     O/COPY WNCPYSRC,LE0400O008
      *                                                                   147438
3610 O** OUTPUT OF START REC. WHEN CREATED
3611 O*
3612 OHIUPDHM E        51
3613 O                                    2 'DA'
3614 O                 68                 1 'M'
3615 O***********              BRCD       5                               S01117
3615 O                         BRCA       5                               S01117
3616 O                         CNUM      11
3617 O                         LNRF      17
3618 O                         VDATS     22
3619 O                                   27 '06000'
3620 O                         FCUS      33
3621 O                         FTYP      36
3622 O                         FSEQ      38
3623 O                         PTYP      40
3624 O                         CCY       43
3625 O                                   45 'ST'
3626 O                         PRAMS     52P
3627 O                         BRTTS     54
3628 O                         BRTES     60P
3629 O                         RTSPS     66P
3630 O                         SPINS     67
3631 O                         CALCS     68
3632 O                         WTIN      69
3633 O                         REPT      70
3634 O                         INTC      71
3635 O                         LTYP      73
3636 O                         SUTP      75
     O                         FCLB      85                               S01117
3637 O                         INTA      82P
3638 O                         RUND      99P
     O                         FSRPS    106P                              CAC001
     O                         FSGNS    107                               CAC001
     O                         COFA     114P                              CAC001
     O                         FPRCS    118                               CAC001
     O                         CPAM     125P                              CLE003
     O                         AITC     132P                              CLE003
     O                         INTR     138P                              CLE003
     O                         AIAP     145P                              CLE003
     O                         IPRD     152P                              CLE003
     O                         ACDA     159P                              157669
     O                         COFR     165P                              157669
     O                         ACAP     172P                              157669
     O                         COFD     179P                              157669
     O                         AITN     186P                                                  CAS005
     O                         AIAN     193P                                                  CAS005
     O                         IPRN     200P                                                  CAS005
     O                         PRAMN    207P                                                  CAS005
     O                         FSCPAM   214P                                                  CAS005
     O                         CLAS     218                                                   CLE042
     O                         OCDT     221P                                                  CRE073
     O                         EAIR     229P                                                  CRE073
     O**********               CNSPO    235P                                         CRE073 AR824724
     O**********               CNSGO    236                                          CRE073 AR824724
     O**********               RDMTO    243                                          CRE073 AR824724
     O**********               RDFDO    247                                          CRE073 AR824724
     O                         CNSP     235P                                                AR824724
     O                         CNSG     236                                                 AR824724
     O                         RDMT     243                                                 AR824724
     O                         RDFD     247                                                 AR824724
3639 O*
3640 O** OUTPUT OF BACK VALUE HEADER OR INT. HEADER WHEN CREATED
3641 O*
3642 OHIUPDHN E        47
3643 O       OR        48
3644 O                                    2 'DH'
3645 O                 68                 1 'M'
3646 O***********              BRCD       5                               S01117
3646 O                         BRCA       5                               S01117
3647 O                         CNUM      11
3648 O                         LNRF      17
3649 O                         PHVDAT    22
3650 O                 47                24 '45'
3651 O                 48                24 '48'
3652 O                                   27 '000'
3653 O                         FCUS      33
3654 O                         FTYP      36
3655 O                         FSEQ      38
3656 O                         PTYP      40
3657 O                         CCY       43
3658 O                 47                45 'BH'
3659 O                 48                45 'IH'
3660 O                 47      PRAMS     52P
3661 O                 48      OSPRIN    52P
3662 O                 47      BRTES     58P
3663 O                 48      BASERT    58P
3664 O                 47      RTSPS     64P
3665 O                 48      SPREAD    64P
3666 O                 47      CALCS     65
3667 O                 48      ICALCB    65
3668 O                 47      SPINS     66
3669 O                 48      SPRIND    66
3670 O                 47      ZERO13    73P
3671 O                 48      ACCIN     73P
3672 O                 47      ZERO5     76P
3673 O                 48      STPG      76P
3674 O                 47      BRTTS     78
3675 O                 48      BASECD    78
3676 O                 47      ZERO13    85P
3677 O                 48      PPIS      85P
3678 O                 47      ZERO13    92P
3679 O                 48      IPIS      92P
3680 O                 47      ZERO13    99P
3681 O                 48      IPTDPS    99P
     O                 47      FSRPS    106P                              CAC001
     O                 48      FUNDRT   106P                              CAC001
     O                 47      FSGNS    107                               CAC001
     O                 48      FUNDSN   107                               CAC001
     O                 47      ZERO13   114P                              CAC001
     O                 48      ACCCO    114P                              CAC001
     O                 47      FPRCS    118                               CAC001
     O                 48      FUNPRF   118                               CAC001
     O                         INTN     125P                                                  CAS005
3660 O                 47      PRAMN    132P                                                  CAS005
3661 O                 48      NOSPRI   132P                                                  CAS005
     O                         OCDT     135P                                                  CRE073
     O                         EAIR     143P                                                  CRE073
     O**********               CNSPO    149P                                         CRE073 AR824724
     O**********               CNSGO    150                                          CRE073 AR824724
     O**********               RDMTO    157                                          CRE073 AR824724
     O**********               RDFDO    161                                          CRE073 AR824724
     O                         CNSP     149P                                                AR824724
     O                         CNSG     150                                                 AR824724
     O                         RDMT     157                                                 AR824724
     O                         RDFD     161                                                 AR824724
3682 O*
3683 O** OUTPUT OF BACK VALUE HEADER OR INT.HEADER WHEN MOVED
3684 O*
3685 O        E        46
3686 O       OR        43
3687 O***********      46      LOTBV    100                               CAC001
3688 O***********      43      LOTIN    100                               CAC001
     O**********       46      LOTBV    118                                            CAC001 CAS005
     O**********       43      LOTIN    118                                            CAC001 CAS005
     O**********       46      LOTBV    132                                            CAS005 CRE073
     O**********       43      LOTIN    132                                            CAS005 CRE073
     O                 46      LOTBV    161                                                   CRE073
     O                 43      LOTIN    161                                                   CRE073
3689 O                 68                 1 'M'
3690 O                         PHVDAT    22
     O                 43      CCY       43                               CLE004
3691 O                         OSPRIN    52P
3692 O                         BASERT    58P
3693 O                         SPREAD    64P
3694 O                         ICALCB    65
3695 O                         SPRIND    66
3696 O                         ACCIN     73P
3697 O                 43      STPG      76P
3698 O                         BASECD    78
3699 O                 43      PPIS      85P
3700 O                 43      IPIS      92P
3701 O                 43      IPTDPS    99P
     O                         FUNDRT   106P                              CAC001
     O                         FUNDSN   107                               CAC001
     O                         ACCCO    114P                              CAC001
     O                         FUNPRF   118                               CAC001
     O                         INTN     125P                                                  CAS005
     O                         NOSPRI   132P                                                  CAS005
     O                         OCDT     135P                                                  CRE073
     O                         EAIR     143P                                                  CRE073
     O**********               CNSPO    149P                                         CRE073 AR824724
     O**********               CNSGO    150                                          CRE073 AR824724
     O**********               RDMTO    157                                          CRE073 AR824724
     O**********               RDFDO    161                                          CRE073 AR824724
     O                         CNSP     149P                                                AR824724
     O                         CNSG     150                                                 AR824724
     O                         RDMT     157                                                 AR824724
     O                         RDFD     161                                                 AR824724
3702 O*
3703 O** OUTPUT OF MOVEMENT REC.FROM ACTN4
3704 O*
3705 OHIUPDHP E        56
3707 O                                    1 'D'
3708 O                 68                 1 'M'
3709 O                                    2 'D'
3711 O***********              BRCD       5                               S01117
3711 O                         BRCA       5                               S01117
3712 O                         CNUM      11
3713 O                         LNRF      17
3714 O                         VDAT      22
3715 O                         PRSQ      24
3716 O                         LASN      27
3717 O                         FCUS      33
3718 O                         FTYP      36
3719 O                         FSEQ      38
3720 O                         PTYP      40
3721 O                         CCY       43
3722 O                         AMTP      45
3723 O                         PAMONT    52P
3724 O                         IAMONT    59P
3725 O                         TAMONT    66P
3726 O                         FAMONT    73P
3727 O                         FEECOD    75
3728 O                         WRTOFF    76
3729 O                         EXVDAT    79P
     O*                                                                   S01270
     O**   INCLUSION OF LOAN-TYPE/SUB-TYPE FIELDS                         S01270
     O*                                                                   S01270
3729 O**********               LTYP      81                                            S01270 227657
3729 O**********               SUTP      83                                            S01270 227657
     O                         LONTYP    81                                                   227657
     O                         SUBTYP    83                                                   227657
     O*                                                                   S01270
3736 O                         RUND      99P
3681 O                         CAMONT   107P                              CAC001
     O                         CPAM     114P                              CLE003
     O                         AITC     121P                              CLE003
     O                         INTR     127P                              CLE003
     O                         AIAP     134P                              CLE003
     O                         IPRD     141P                              CLE003
     O                         MNSG     142                               122667
     O                         GASS     143                               122667
     O                         GPRT     144                               122667
     O                         ROLN     150                               122667
     O                         ACDA     157P                              157669
     O                         COFR     163P                              157669
     O                         ACAP     170P                              157669
     O                         COFD     177P                              157669
     O**********               REPI     178                        CPB002 194459
     O                         WREPI    178                               194459
     O                         CHDU     185P                                                  CLE028
     O                         AITN     192P                                                  CAS005
     O                         AIAN     199P                                                  CAS005
     O                         IPRN     206P                                                  CAS005
     O                         NAMONT   213P                                                  CAS005
     O                         NPAMNT   220P                                                  CAS005
     O                         FSCPAM   227P                                                  CAS005
     O                         CLAS     231                                                   CLE042
     O                         REPTYP   232                                                AR1057551
     O/COPY WNCPYSRC,LE0400O010
3702 O*
3703 O** OUTPUT OF RATE REC.FROM ACTN4
3704 O*
3705 OHIUPDHQ E        57
3707 O                                    1 'D'
3708 O                 68                 1 'M'
3710 O                                    2 'E'
3711 O***********              BRCD       5                               S01117
3711 O                         BRCA       5                               S01117
3712 O                         CNUM      11
3713 O                         LNRF      17
3714 O                         VDAT      22
3715 O                         PRSQ      24
3716 O                         LASN      27
3717 O                         FCUS      33
3718 O                         FTYP      36
3719 O                         FSEQ      38
3720 O                         PTYP      40
3721 O                         CCY       43
3722 O                         AMTP      45
3730 O                         BRATEC    47
3731 O                         BRATE     53P
3732 O                         RATSPD    59P
3733 O                         SPINDI    60
3734 O                         CALBAS    61
3735 O                         STSTAC    62
     O                         PRINRO    69P                              S01392
     O                         DISCRO    76P                              S01392
3736 O**********               RUND      99P                                                AR835977
     O*********                ORED      99P                                      AR835977 AR1088476
     O                         RUND      99P                                               AR1088476
     O                         WFXFLG   100                                                 MD028338
     O                         FUNDSP   106P                              CAC001
     O                         FUNDSG   107                               CAC001
     O                         INTFLG   108                               CAC001
     O                         COFFLG   109                               CAC001
     O                         FUNDPC   113                               CAC001
     O                         CPAM     120P                              CLE003
     O                         AITC     127P                              CLE003
     O                         INTR     133P                              CLE003
     O                         AIAP     140P                              CLE003
     O                         IPRD     147P                              CLE003
     O                         MNSG     148                               127069
     O                         RLCY     151                               127069
     O                         ACDA     158P                              157669
     O                         COFR     164P                              157669
     O                         ACAP     171P                              157669
     O                         COFD     178P                              157669
     O                         AITN     185P                                                  CAS005
     O                         AIAN     192P                                                  CAS005
     O                         IPRN     199P                                                  CAS005
     O                         FSCPAM   206P                                                  CAS005
     O                         OCDT     209P                                                  CRE073
     O                         EAIR     217P                                                  CRE073
     O**********               CNSPO    223P                                         CRE073 AR824724
     O**********               CNSGO    224                                          CRE073 AR824724
     O**********               RDMTO    231                                          CRE073 AR824724
     O**********               RDFDO    235                                          CRE073 AR824724
     O                         CNSP     223P                                                AR824724
     O                         CNSG     224                                                 AR824724
     O                         RDMT     231                                                 AR824724
     O                         RDFD     235                                                 AR824724
3737 O*
3738 OHIUPDZX T        LR 50
3739 O                                    1 'T'
3740 O                         NHIUPD     4P
3741 O*
3742 O** ACTIONS TODAY FILE
3743 O*
3744 O** OUTPUT OF ACTION RECORD
3745 O*
3746 OACTN5DH E        41 10
3748 O                         LOTA1    256
3749 O                         LOTA2    320
     OACTN5DK E        45
     O                         LOTA1    256
     O                         LOTA2    320
     O***********              LOTA3    949                        S01518 CAC001
     O***********              LOTA3    969                        CAC001 CLE005
     O***********              LOTA3   1057                        CLE004 CLE005
     O***********              LOTA3   1060                        CLE005 134798
     O***********              LOTA3   1066                        134798 CEU020
     O**********               LOTA3   1067                               CEU020              CLE028
     O**********               LOTA3   1075                                            CLE028 CAS005
     O**********               LOTA3   1089                                            CAS005 CLE031
     O**********               LOTA3   1108                                            CLE031 CLE034
     O**********               LOTA3   1109                                            CLE034 CAP075
     O**********               LOTA3   1176                                            CAP075 CGL029
     O**********               LOTA3   1230                                            CGL029 CLE036
     O*************************LOTA3   1268                                            CLE036 CLE042
     O                         LOTA3   1291                                                   CLE042
     O                         LSWCC    258P                                                  235579
     O                         LSWSC    260P                                                  235579
     O                         LSMD     269P                                                  235579
     O                         REBT     276P                                                 244214A
     O                         RSTM     322                                                   246490
     O                         ROBN     383                                                  244214A
     O                         ROCN     389                                                  244214A
     O                         PSTM     391                                                  244214A
     O                         POBN     452                                                  244214A
     O                         POCN     458                                                  244214A
     O                         ROLN     983                                                  244214A
     O                         ROSN     986                                                  244214A
     O                         RORC     995                                                  244214A
     O                         PNAM    1007P                                                 244214A
     O                         ECIN    1067                               CEU020
     O                         CHDU    1075P                                                  CLE028
     O                         INTN    1082P                                                 244214A
     O                         PRAMN   1089P                                                 244214A
     O                         REXR    1096P                                                 244214A
     O                         PEXR    1107P                                                 244214A
     O                         FRAM    1241P                                                  246490
     O                         FINT    1248P                                                  246490
     O                         FTXA    1255P                                                  246490
     O                         FTOT    1262P                                                  246490
3750 O                 18      OPPRAM    44P
3751 O                 18      OPINTA    51P
3752 O                 18      OPWTXA    58P
3753 O                 18      OPTAMT    72P
3754 O                 18      OPINTC   253
3754 O*****************18N30   AUTO      83                     E47145    E47245
     O                 18 61   AUTO      83                               E47245
     O                 81      MCPRAM    44P                              147438
     O                 81      MCTAMT    72P                              147438
3755 O*
3756 O** ROLLOVER RECS. - IF NO INT. DETAILS ON REC. INPUT, OUTPUT
3757 O** CURRENT DETAILS
3758 O*
3759 O                 85      BRATEC    28
3760 O                 85      RATSPD    34P
3761 O                 85      STSTAC    84
3762 O                 85      BRATE    215P
3763 O                 85      SPINDI   216
3764 O                 85      CALBAS   217
     O                         CHGIND   256
     O                 26      FUNDSP   955P                              CAC001
     O                 26      FUNDSG   956                               CAC001
     O                 26      FUNDPC   960                               CAC001
     O                 18      OPCOFA   967P                              CAC001
     O                 18      OPINTN  1075P                                                  CAS005
     O                 18      NOPPRA  1082P                                                  CAS005
     O/COPY WNCPYSRC,LE0400O009
3765 O*
3766 O** OUTPUT CONTROL RECORD
3767 O*
3768 OACTN5DN E        44
3769 O                         LOTC1    256
3770 O***********              LOTC2    320                               CAC001
     O**********               LOTC2    344                                            CAC001 CAS005
     O*************************LOTC2    365                                            CAS005 CLE042
     O                         LOTC2    369                                                   CLE042
     O/COPY WNCPYSRC,LE0400O011
3771 O                         AIIAC    117P
3754 O                         LNMA      85                               E47145
     O                         ACIAC    327P                              CAC001
     O                         ANIAC    351P                                                  CAS005
3772 O*
3773 OACTN5ZX T        LR 50
3774 O                                    1 'T'
3775 O                         NACTN5    19P
     O*E0400P1D***03** 01 50                                        S01124S01117
3777 O*******OR        OF                                                 S01117
     OLE0400P1D   03   OF                                                 S01117
3778 O*****                              22 'REFERENCE LE0400'            S01117
3778 O                                   24 'REFERENCE LE0400P1'          S01117
3779 O                         TITL      89
3780 O                                  122 'DATE              PAGE'
3781 O                         RUNA     112
3782 O                         PAGE  Z  127
3783 O********D** 05   01 50                                              S01117
3784 O*******OR**      OF                                                 S01117
     O        D   05   OF                                                 S01117
3785 O                                   60 'HISTORY PROCESSING - CRE'
3786 O                                   79 'DIT LOANS EXCEPTION'
3787 O                                   86 'REPORT'
     O                   N65             96 'BRANCH'                      S01117
     O                   N65   BRCA     100                               S01117
     O                   N65            101 '-'                           S01117
     O                   N65   BRNM     131                               S01117
      *                                                                   S01117
3788 O********D** 06   01 50                                              S01117
3789 O*******OR**      OF                                                 S01117
     O        D   06   OF                                                 S01117
3790 O                                   60 '------------------------'
3791 O                                   79 '-------------------'
3792 O                                   86 '-------'
3793 O********D** 08   01 50                                              S01117
3794 O*******OR**      OF                                                 S01117
     O        D   08   OF                                                 S01117
3795 O***********                        24 'BR.  CUST   LOAN  CCY  V'    S01117
     O                                   24 'CUST   LOAN  CCY  V'         S01117
3796 O                                   48 'ALUE  SEQ  AMEND. ------'
3797 O                                   72 '------------------- AMEN'
3798 O                                   96 'DMENT DETAILS ----------'
3799 O                                  118 '---------------       '
3800 O                                  129 'OUTSTANDING'
3801 O********D**209   01 50                                              S01117
3802 O*******OR**      OF                                                 S01117
     O        D  209   OF                                                 S01117
3803 O***********                        24 'CODE  NO.   REF.       D'    S01117
     O                                   24 'NO.   REF.       D'          S01117
3804 O                                   39 'ATE   NO.  TYPE'
3805 O                                  128 'PRINCIPAL'
3806 O        EF 2     87
3807 O***********              BRCD       3                               S01117
3808 O                         CNUM      10
3809 O                         LNRF      17
3810 O                         CCY       21
3811 O                         ZADATE    29
3812 O                         LASN      33
3813 O                         AMTP      38
3814 O                 33                45 'PRIN:'
3815 O                 33 74   PAMONT    63 ' ,   ,   ,   , 0 -'
3816 O                 33 75   PAMONT    63 '   ,   ,   , 0 . -'
3817 O                 33 76   PAMONT    63 '  ,   ,   , 0 .  -'
3818 O                 33 77   PAMONT    63 ' ,   ,   , 0 .   -'
3819 O                 34                69 'INT:'
3820 O                 34 74   IAMONT    87 ' ,   ,   ,   , 0 -'
3821 O                 34 75   IAMONT    87 '   ,   ,   , 0 . -'
3822 O                 34 76   IAMONT    87 '  ,   ,   , 0 .  -'
3823 O                 34 77   IAMONT    87 ' ,   ,   , 0 .   -'
3824 O**********       35                94 'FEES:'                                           CLE028
3825 O**********       35 74   FAMONT   112 ' ,   ,   ,   , 0 -'                              CLE028
3826 O**********       35 75   FAMONT   112 '   ,   ,   , 0 . -'                              CLE028
3827 O**********       35 76   FAMONT   112 '  ,   ,   , 0 .  -'                              CLE028
3828 O**********       35 77   FAMONT   112 ' ,   ,   , 0 .   -'                              CLE028
     O                 35   N17          94 'FEES:'                                           CLE028
     O                 35 74N17FAMONT   112 ' ,   ,   ,   , 0 -'                              CLE028
     O                 35 75N17FAMONT   112 '   ,   ,   , 0 . -'                              CLE028
     O                 35 76N17FAMONT   112 '  ,   ,   , 0 .  -'                              CLE028
     O                 35 77N17FAMONT   112 ' ,   ,   , 0 .   -'                              CLE028
     O                 35    17          94 'CHRG:'                                           CLE028
     O                 35 74 17CHDU     112 ' ,   ,   ,   , 0 -'                              CLE028
     O                 35 75 17CHDU     112 '   ,   ,   , 0 . -'                              CLE028
     O                 35 76 17CHDU     112 '  ,   ,   , 0 .  -'                              CLE028
     O                 35 77 17CHDU     112 ' ,   ,   , 0 .   -'                              CLE028
3829 O                 36                48 'B.R.TYPE'
3830 O                 36      BRATEC    51
3831 O                 53                63 'BASE RATE'
3832 O                 53      BRATE     77 '  0 .       -'
3833 O                 54                86 'SPREAD'
3834 O                 54      RATSPD   100 '  0 .       -'
3835 O                 55               109 'SP.IND'
3836 O                 55      SPINDI   111
3837 O***********      86                54 'STOP ACCRUALS'               CAC001
3838 O***********      86 26             45 'START'                       CAC001
     O                 86                54 'ACCRUALS'                    CAC001
     O                 86      WACIND    45                               CAC001
3839 O                    74   OSPRIN   132 ' ,   ,   ,   , 0 -'
3840 O                    75   OSPRIN   132 '   ,   ,   , 0 . -'
3841 O                    76   OSPRIN   132 '  ,   ,   , 0 .  -'
3842 O                    77   OSPRIN   132 ' ,   ,   , 0 .   -'
3843 O*
3844 O********E** 05  N50 U7 U8                                           S01117
3845 O***********                        60 'HISTORY PROCESSING - CRE'    S01117
3846 O***********                        79 'DIT LOANS EXCEPTION'         S01117
3847 O***********                        86 'REPORT'                      S01117
3848 O********E** 06  N50 U7 U8                                           S01117
3849 O***********                        60 '------------------------'    S01117
3850 O***********                        79 '-------------------'         S01117
3851 O***********                        86 '-------'                     S01117
3852 O********E*32     U7 U8                                              S01117
3852 O        TF32     U7 U8                                              S01117
3853 O                                   42 '*** REFERENCE'
3854 O                         DBPGM     53                               S01117
3855 O                                   73 '-  DATABASE ERROR   '        S01117
3854 O***********              DBPGM     51                               S01117
3855 O***********                        71 '-  DATABASE ERROR AT'        S01117
3856 O***********              DBASE     74                               S01117
3857 O********E**2     U7 U8                                              S01117
3858 O***********                        37 'FILENAME'                    S01117
3859 O***********              DBFILE    43                               S01117
3860 O***********                        48 'KEY'                         S01117
3861 O***********              DBKEY     78                               S01117
3862 O*
3863 O********T*3*     LRNU7N89                                           S01117
     O        EF3              P1NODL                                     S01117
3864 O                                   73 '* NO DETAILS TO REPORT *'
3865 O********T*3*     LRNU7 89                                           S01117
3866 O*******OR***     LR U7                                              S01117
      *                                                                   S01117
     O        E 3              P1END                                      S01117
     O                      N65          66 '*** END OF REPORT FOR'       S01117
     O                      N65          74 ' BRANCH '                    S01117
     O                      N65BRCA      77                               S01117
     O                      N65          81 ' ***'                        S01117
     O                       65          68 '***   END OF REPORT'         S01117
     O                       65          74 '   ***'                      S01117
3867 O***********                        68 '***   END OF REPORT'         S01117
3868 O***********                        74 '   ***'                      S01117
3869 O*
3870 O** CONTROL TOTALS REPORT
3871 O*
3872 O********T**203   LR                                                 S01117
     OLE0400AUT  203   LR                                                 S01117
3873 O***********                        22 'REFERENCE LE0400'            S01117
3873 O                                   24 'REFERENCE LE0400AU'          S01117
3874 O                         TITL      89
3875 O                                  122 'DATE              PAGE'
3876 O                         RUNA     112
3877 O*****                    PAGE  Z  127                               S01117
3877 O                         PAGE1 Z  127                               S01117
3878 O        T  1     LR
3879 O                                   64 'HISTORY PROCESSING -'
3880 O                                   78 'FILE CONTROLS'
3881 O        T  3     LR
3882 O                                   65 '---------------------'
3883 O                                   78 '-------------'
3884 O        T 11     LR
3885 O                                   28 'S/HISTS - RUN CONTROLS'
3886 O        T  2     LR
3887 O                                   28 '----------------------'
3888 O        T  2     LR
3889 O                                   29 'TOTAL RECORDS ON FILE'
3890 O                         NOREH Z   59
3891 O        T  2     LR
3892 O                                   32 'TOTAL RECORDS ON FILE - '
3893 O                                   42 'CALCULATED'
3894 O                         NHISTSZ   59
3895 O                 80               111 '***   DIFFERENCE   ***'
3896 O        T  1     LR
3897 O                                   28 'S/ACTN4 - RUN CONTROLS'
3898 O        T  2     LR
3899 O                                   28 '----------------------'
3900 O        T  2     LR
3901 O                                   29 'TOTAL RECORDS ON FILE'
3902 O                         NOREA Z   59
3903 O        T  2     LR
3904 O                                   32 'TOTAL RECORDS ON FILE - '
3905 O                                   42 'CALCULATED'
3906 O                         NACTN4Z   59
3907 O                 81               111 '***   DIFFERENCE   ***'
3908 O        T  1     LR
3909 O                                   28 'S/HIUPD - RUN CONTROLS'
     O/COPY WNCPYSRC,LE0400O003
3910 O        T  2     LR
3911 O                                   28 '----------------------'
     O/COPY WNCPYSRC,LE0400O004
3912 O        T  2     LR
3913 O                                   29 'TOTAL RECORDS ON FILE'
3914 O                         NHIUPDZ   59
     O/COPY WNCPYSRC,LE0400O005
3915 O        T  1     LR
3916 O                                   28 'S/ACTN5 - RUN CONTROLS'
3917 O        T  2     LR
3918 O                                   28 '----------------------'
     O/COPY WNCPYSRC,LE0400O006
3919 O        T  2     LR
3920 O                                   29 'TOTAL RECORDS ON FILE'
3921 O                         NACTN5Z   59
     O/COPY WNCPYSRC,LE0400O007
3922 O        T  1     LRNU3
3923 O                                   28 'S/LETLX - RUN CONTROLS'
3924 O        T  2     LRNU3
3925 O                                   28 '----------------------'
3926 O        T  2     LRNU3
3927 O                                   29 'TOTAL RECORDS ON FILE'
3928 O                         NLETLXZ   59
3929 O        T  1     LRNU3
3930 O                                   28 'S/CONFS - RUN CONTROLS'
3931 O        T  2     LRNU3
3932 O                                   28 '----------------------'
3933 O        T  2     LRNU3
3934 O                                   29 'TOTAL RECORDS ON FILE'
3935 O                         NCONFSZ   59
3936 O        T  1     LR
3937 O                                   28 'S/INTST - RUN CONTROLS'
3938 O        T  2     LR
3939 O                                   28 '----------------------'
3940 O        T  2     LR
3941 O                                   29 'TOTAL RECORDS ON FILE'
3942 O                         NINTSTZ   59
3943 O        T  1     LRNU3
3944 O                                   28 'S/CUTX1 - RUN CONTROLS'
3945 O        T  2     LRNU3
3946 O                                   28 '----------------------'
3947 O        T  2     LRNU3
3948 O                                   29 'TOTAL RECORDS ON FILE'
3949 O                         NCUTX1Z   59
3950 O        T  1     LR
3951 O                                   28 'S/PTSLD - RUN CONTROLS'
3952 O        T  2     LR
3953 O                                   28 '----------------------'
3954 O        T  3     LR
3955 O                                   29 'TOTAL RECORDS ON FILE'
3956 O                         NPTSLDZ   59
     O        T  2     LRNU7N89                                           S01117
     O                                   72 '* NO DETAILS TO REPORT *'    S01117
3852 O        T  1     U7 U8                                              S01117
3853 O                                   42 '*** REFERENCE'               S01117
3854 O                         DBPGM     53                               S01117
3855 O                                   73 '-  DATABASE ERROR AT'        S01117
3856 O                         DBASE     77                               S01117
3857 O        T  2     U7 U8                                              S01117
3858 O                                   37 'FILENAME'                    S01117
3859 O                         DBFILE    46                               S01117
3860 O                                   50 'KEY'                         S01117
3861 O                         DBKEY     80                               S01117
3862 O*                                                                   S01117
3957 O********T*3      LR                                                 S01117
3958 O***********                        68 '***   END OF REPORT'         S01117
3959 O***********                        74 '   ***'                      S01117
3960 O*
3961 O*
     O/COPY WNCPYSRC,LE0400OOP1                                           S01408
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   SVAL  -  SYSTEM VALUES ARRAY                                                             218782
Settlement09Postings                                                                          218782
**                                                                        E43682
1111111                                                                   E43682
2222222                                                                   E43682
3333333                                                                   E43682
4444444                                                                   E43682
5555555                                                                   E43682
6666666                                                                   E43682
7777777                                                                   E43682
8888888                                                                   E43682
9999999                                                                   E43682
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                                                     CLE028
312831303130313130313031                                                                      CLE028
