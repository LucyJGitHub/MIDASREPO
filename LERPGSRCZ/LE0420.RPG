0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Print end of day confirmations')              *
0001 H***********                                                         S01117
0002 F*****************************************************************
     F*                                                               *
     F*  Midas - Customer Lending Module                              *
0004 F*                                                               *
0005 F*       LE0420 - PRINT END OF DAY CONFIRMATIONS                 *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE075BO           Date 06Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CLE042             Date 06Sep05               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE033             Date 02Apr03               *
      *                 CLE031             Date 04Feb03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 182229             Date 19Sep01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157056             Date 19Mar99               *
      *                 138866             Date 29Jul98               *
      *                 150931             Date 10May99               *
      *                 CEU004             Date 02Feb98               *
     F*                 CLE005             Date 22May97               *
     F*                 CLE004             Date 02Dec96               *
     F*                 S01408             Date 05Sep96               *
     F*                 CSW096             Date 03Sep96               *
     F*                 S01408             DATE 13JUN96               *
     F*                 093584             DATE 28FEB96               *
     F*                 CCG008             DATE 30OCT95               *
     F*                 086977             DATE 18OCT95                  *
     F*                 S01408             DATE 17AUG95                  *
     F*                 S01518             DATE 03OCT94                  *
     F*                 038382             DATE 13OCT92               *
     F*                 S01392             DATE 14SEP92               *
     F*                      E39524           DATE 03JUN92               *
0007 F*                      BH2600           DATE 25SEP91               *BH2600
0007 F*                      RT0086           DATE 15MAY91               *
     F*                      BHF241           DATE 10JUL90               *
     F*                      BHF145           DATE 13JUN90               *
     F*                      BHF038           DATE 10MAY90               *
     F*                      S01243           DATE 05MAR90               *
     F*                      LN0007           DATE 27APR90               *
     F*                      S01194           DATE 05JAN90               *
     F*                      E18654           DATE 12JUN89               *
     F*                      S01117           DATE 30/08/89              *
     F*                      S01167           DATE 26/08/88              *
     F*                      E13032           DATE 26/04/88              *
     F*                      S01135           DATE 03/12/87              *
     F*                      E47247           DATE 12/05/87              *
     F*                      S01118           DATE 09/07/86              *
     F*                      S01125           DATE 01/11/86              *
0011 F*                                                                  *
0010 F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE075BO - COB Restructure - LE COB Optimisation Phase 1     *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements.                               *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  182229 - Dont suppress swift if RE and their nostro blank    *
      *  157056 - Principal Transfer Confirmation should display      *
      *           customer no. and interest rate correctly. Data      *
      *           structure of CONFS changed for correct field        *
      *           positions.                                          *
      *  138866 - Include interest amount in the Principal Transfer   *
      *           confirmation.                                       *
     F*  150931 - Do not call EU0200 if Event and settlement currency *  *
     F*           are the same.                                       *  *
      *  CEU004 - EMU Lending Settlement Currency Conversion          *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
      *  CLE004 - Customer Lending Enhancements - Syndications.       *
     F*  S01408 - Core hook LE0420CCP3 added.                            *
     F*         - Core hook LE0420FFP2 added.                            *
     F*         - Core hook LE0420OOP3 added.                            *
     F*         - Core hook LE0420OOP4 added.                            *
     F*         - Core hook LE0420OOP5 added.                            *
     F*         - Core hook LE0420OOP6 added.                            *
     F*  CSW096 - SWIFT changes 1996                                  *
     F*  S01408 - Core hook LE0420FFP1 added.                            *
     F*           Core hook LE0420CCP2 added.                            *
     F*           Core hook LE0420OOP1 added.                            *
     F*           Core hook LE0420OOP2 added.                            *
     F*  093584 - Unable to change form length of spool file output   *
     F*           by changing printer file - remove Line specs.       *
     F*  CCG008 - User Defined Correspondence - Lending                  *
     F*     086977  - Remove the message "DO NOT SEND-AUTO TRANSMISSION" *
     F*               Apply GEMS fix 066428.                             *
     F*     S01408  - Core hook added LE0420CCP1                         *
     F*     S01518  - BLI Lending SWIFT Enhancements.                    *
     F*     038382  - DO NOT TRY TO WRITE 'END OF REPORT' IF NO RECORDS  *
     F*               ON FILE - P1 PRINTER FILE WILL NOT HAVE BEEN OPEN  *
     F*             - USE EDIT CODE 3 TO PRINT 0 INSTEAD OF BLANK WHERE  *
     F*               NUMBER OF RECORDS IS ZERO.                         *
     F*             - ALIGN 'END OF REPORT FOR BRANCH' TEXT              *
     F*     S01392  -  JAPANESE SUB MODULE ENHANCEMENTS                  *
     F*     E39524  -  SUPPRESS WRITE TO THE EXTRACT FILE FOR A MESSAGE  *
     F*                IF THE SETTLEMENT DETAILS HAVE BEEN LEFT BLANK
     F*     BH2600  -  POST COLLECTION SWIFT RATIONALISATION FIXES:      *BH2600
     F*                   o  REPORT OF 'FOR A/C OF' FIELD UNTIDY         *BH2600
     F*                   o  INSERT MG ROUTING                            BH2600
     F*                   o  CONDITION ISO GEN ON SDMGMEPD/PF FLAG       *BH2600
0011 F*     RT0086  -  REMOVE 'END OF REPORT' FROM AU REPORT.            *BH2600
     F*     BHF241  -  RECOMPILE OVER NEW LE0420P1                       *BHF241
     F*     BHF145  -  DATA STRUCTURE SDCUST NOT RECEIVED BACK FROM      *BHF145
     F*             -  AOCUSTR0 CALL                                     *BHF145
     F*     BHF038  -  DOING DATABASE ERROR HANDLING WHEN NO ERROR       *BHF038
     F*     S01243 - PRINCIPAL INCREASE                                  *
     F*     LN0007  -  USE OF ALTERNATIVE ADDRESS INCORRECTLY CODED
     F*     S01194  -  STANDING DATA CHANGES                             *S01194
     F*     E18654 - 'END OF REPORT' NOT PRINTED                         *E18654
     F*      S01117  -  MULTIBRANCHING
     F*      S01167  -  INCORPORATION OF BIC CODES + MT200'S             *S01167
0008 F*      E13032 - DATA STRUCTURE INDICATOR 'DS' IS IN THE            *E13032
0008 F*               WRONG POSITION, 14-15, FOR BENIFICIARY BANK        *E13032
0008 F*               DETAILS. IT SHOULD BE IN POSITIONS 19-20.          *E13032
     F*      S01135  -  MAKE SURE THAT TELEX NUMBER AND SWIFT ID ARE     *S01135
     F*               PUT IN CORRECTLY IN EXTRACT FILE DEPENDING ON      *S01135
     F*               WHETHER TELEX OR SWIFT CUSTOMER                    *S01135
0008 F*                                                                  *
0008 F*       E47247 - CHANGE CUSTOMER NAME AND ADDRESS LINES TO START   *E47247
     F*                ON LINE 38                                        *E47247
0008 F*       S01118 - MIDAS/S.W.I.F.T. DIRECT LINK                      *
0008 F*       S01125 - RELEASE 21 CHANGES                                *
0008 F*                                                                  *
0010 F********************************************************************
     F*
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
0010 F********************************************************************
     F*
0011 F***CONFS***IPE F     320 14AI     8 DISK                            S01518
     F**CONFS   IPE F     949 14AI     8 DISK                      S01518 CLE004
     F***CONFS***IPE F    1051 14AI     8 DISK                     CLE004 CEU004
     F***CONFS   IPE F    1066 14AI     8 DISK                     CEU004 157056
     F***CONFS***IPE F    1066 14AI     8 DISK                                         157056 CLE031
     F***CONFS***IPE F    1087 14AI     8 DISK                                         CLE031 CLE034
     F***CONFS***IPE F    1109 14AI     8 DISK                                         CLE034 CAP075
     F***CONFS** IPE F    1176 14AI     8 DISK                                         CAP075 CGL029
     F*CONFS***IPE*F****1230 14AI     8 DISK                                           CGL029 CLE042
     FCONFS   IPE F    1291 14AI     8 DISK                                                   CLE042
     F/COPY WNCPYSRC,LE0420FFP1                                           S01408
0012 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
0013 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
     FSDCURRL1IF  E           K        DISK                                                 CLE075BO
     FSDBRCHL1IF  E           K        DISK                                                 CLE075BO
     F*LEECTX**O***F      73            DISK                      A    U1 BH2600
     FLENXTAA O   F     320            DISK                           U4
     F***LENXTAB*O   F     320            DISK                        U4  S01518
     F*LENXTAB*O***F*****949            DISK                           U4              S01518 CLE042
     FLENXTAB O   F    1007            DISK                           U4                      CLE042
     FLENXTAC O   F     320            DISK                           U4
0014 F*MPRINTCFO   F     132     OF    LPRINTER                           S01125
0014 F*MPRINT  O   F     132            PRINTER                           S01125
0014 F*E0420P2O** F     132     OF    LPRINTER                      S01125S01117
0014 F*E0420P1O** F     132            PRINTER                      S01125S01117
     F*E0420P1O***F     132     OF    LPRINTER      KINFDS SPOOL1   S01117093584
     F/COPY WNCPYSRC,LE0420F001
     FLE0420P1O   F     132     OF     PRINTER      KINFDS SPOOL1     UC  093584
     F/COPY WNCPYSRC,LE0420F002
     FLE0420P2O   F     132     OV     PRINTER      KINFDS SPOOL2     UC  CLE004
0014 FLE0420AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F*
0015 F* ID F  C  H  L    FUNCTION OF INDICATORS
0016 F* 01            S/CONFS HEADER
0017 F* 03            S/CONFS DETAIL (REC TYPE D)
0018 F* 05            S/CONFS DETAIL (REC TYPE R)
0019 F* 07            S/CONFS TRAILER
0020 F* 09            S/CONFS CATCHALL
0021 F**11************S/TABLE INSTALLATION CONTROL RECORD ONE             S01194
0022 F**12************S/TABLE INSTALLATION CONTROL RECORD TWO             S01194
0023 F**13************S/TABLE INSTALLATION CONTROL RECORD FIVE            S01194
0024 F**14************S/TABLE CURRENCIES RECORD ONE                       S01194
0025 F**15************S/TABLE BRANCH CODES                                S01194
0026 F**16************S/TABLE NOSTROS                                     S01194
0027 F**17************S/TABLE COUNTERPARTY NOSTROS                        S01194
0028 F**
      *       12      Full cache indicator                                                  CLE075BO
0029 F*       13      Amendment Type = PT or PF                           CLE004
0030 F*       14      For Principal Transfer, customers are the same      CLE004
0030 F*       16      Amendment Type = PT                                 CLE004
0031 F*       17      Amendment Type = PF                                 CLE004
0029 F*       18      REPAYMENT TYPE 3
0030 F*       19      REPAYMENT TYPE 1
0031 F*       20      AMENDMENT TYPE = PI
0032 F*       21      AMENDMENT TYPE = RE
0033 F*
0034 F*       22      'OURS' BLANK
0035 F*       23      'THEIRS' BLANK
0036 F*       26      'FOR A/C' BLANK
0037 F*       24      03 OR 05 IS ON
0038 F*       25      VALUE DATE OUTSIDE EXTRACT PERIOD
     F*       27      WORK INDICATOR FOR BENIFICIARY BANK DETAILS
     F*       28      FIRST LINE OF SPECIAL INSTRUCTIONS IS BLANK
     F*       29      BENIFICIARY BANK DETAILS EXIST ON FIRST LINE OF SPI
0043 F*       30      PROCESSING TYPE = 66 FOR PI                         S01243
0039 F********31******CHAIN FAIL TABLE & CLINT                            S01194
0040 F*       32      PROCESSING TYPE = 61 OR 62
0041 F*       33      RE.TO PRINT
0042 F*       34      PROCESSING TYPE = 64
0043 F*       36      PROCESSING TYPE = 66
0044 F*       37      CONFIRMATION CONTROL INDICATOR BIT ON
     F*       38      COUNTERPARTY IS A SWIFT MEMBER
     F*       39      OUTPUT TO LENXTAB
0045 F**
0046 F*       40      CURRENCY DECIMAL PLACES = 0
0047 F*       41      CURRENCY DECIMAL PLACES = 1
0048 F*       42      CURRENCY DECIMAL PLACES = 2
0049 F*       43      CURRENCY DECIMAL PLACES = 3
0050 F*       44      INTEREST ON RE. NEGATIVE
0051 F*       45      TOTAL REPAYMENT NEGATIVE
0052 F*       46      WORK
     F********47******OUTPUT TO THE TELEX FILE                            BH2600
0043 F*       48      PROCESSING TYPE = 62 FOR PI                         S01243
0053 F**
      *       49      Cache Hit for Currency Codes                                          CLE075BO
0054 F*       50      SETTLEMENT TYPE = 00
0055 F*       51      SETTLEMENT TYPE = 01,07,08
0056 F*       52      SETTLEMENT TYPE = 02
0057 F*       53      SETTLEMENT TYPE = 03,06
0058 F*       54      SETTLEMENT TYPE = 04
0059 F*       55      SETTLEMENT TYPE = 05
      *       56      Cache Hit for Branch Codes                                            CLE075BO
0060 F*       57      SETTLEMENT TYPE = 12
0061 F*       58      SETTLEMENT TYPE = 14
0062 F*       59      SETTLEMENT TYPE = 01
0063 F**
     F*       61      PRTF LE0420P1 open
     F*       62      PRTF LE0420P2 open
     F*       65      MBIN = 'Y'                                          S01117
0064 F*       70      BRANCH NAMES TO BE PRINTED
0065 F*       71      DIFFERENCE IN FILE CONTROLS
0065 F*       72      AT LEAST ONE TELEX GENERATED
     F*       75      INPUT FILE HAS AT LEAST ONE RECORD           '      S01117
      *       76      Cache hit for Nostro array                                            CLE075BO
     F*       96      "DO NOT SEND" TEXT                                  BH2600
     F*          U4   CUSTOMER LENDING SWIFT EXISTS
0067 F*       U7 U8   DATA BASE ERROR - PROGRAM HALTS
     F/COPY WNCPYSRC,LE0420FFP2                                           S01408
0066 F**
      /COPY ZSRSRC,ZDATE2Z1                                               S01392
      ** Array containing Copyright statement                                                 CLE031
     E                    POWER   1   7  7 3                                                  CLE031
     E                    CPY@    1   1 80
      *                                                                                     CLE075BO
      ** Caches Arrays                                                                      CLE075BO
      *                                                                                     CLE075BO
     E                    #CCY      250  3                                                  CLE075BO
     E                    #BCH      900  3                                                  CLE075BO
     E                    #NOS      200 13 0             Nostro Array                       CLE075BO
     E                    #NSS      200 13 0             Nostro Sorted                      CLE075BO
     E                    #NSK      200  5               Nostro Cache Key                   CLE075BO
0071 L*MPRINTCF 42FL 42OL                                                 S01125
0071 L*E0420P2 42FL 42OL                                            S01125S01117
0071 L*E0420P1*42FL*42OL***                                         S01117093584
0072 I* CONFIRMATIONS FILE HEADER
0073 I*
0074 ICONFS   NS  01   1 CH
0075 I                                        1   1 RECI
0076 I* CONFIRMATIONS DETAIL
0077 I*
0078 ICONFS   NS  03   1 CD
0079 I       OR   05   1 CR
0080 I                                        1   1 RECI
0081 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0082 I                                        8  120VDAT
0083 I                                       13  150LASN
0084 I                                       16  160MRIN
0085 I                                       17  18 LTYP
0086 I                                       19  20 SUTP
0087 I                                       21  220PTYP
0088 I                                       23  24 AMTP
0089 I                                       25  260PRSQ
0090 I                                       27  28 BRTT
0091 I                                    P  29  340RTSP
0092 I                                       35  37 CCY
0093 I                                    P  38  440PRAM
0094 I                                    P  45  510INTA
0095 I                                    P  52  580WTXA
0096 I                                    P  59  650FEAM
0097 I                                    P  66  720TAMT
0098 I***********                            73  750BRCD                  S01117
0098 I                                       73  75 BRCA  L1              S01117
0099 I**********                             76  810CNUM                                      CSD027
0099 I                                       76  81 CNUM                                      CSD027
0100 I                                       82  820REPT
0101 I                                       83  83 AUTD
0102 I                                       84  84 STAI
0103 I                                       85  86 SETP
0104 I**********                             87  98 OSAC            22                        CGL029
     I                                       87  98 OSACQQ                                    CGL029
0105 I                                       99 108 TSEN            23
0106 I                                      109 118 FACO            26
0107 I                                      119 148 SPI1            28
0108 I                                      149 178 SPI2
0109 I                                      179 208 SPI3
0110 I* WHOLE OF SPECIAL & SETTLEMENT INSTRUCTIONS
0111 I                                      119 208 SPINST
0112 I                                       85 208 INSTR
0113 I                                      209 209 LAIN
0114 I                                    P 210 2150BRTE
0115 I                                      216 216 SPIN
0116 I                                      217 2170CALC
0117 I                                      218 218 WTIN
0118 I                                      219 219 LLAG
0119 I                                      220 220 LWDI
0120 I                                      221 2250XAVD
0121 I                                      226 2280XASQ
0122 I**********                            229 2340FCUS                                      CSD027
0122 I                                      229 234 FCUS                                      CSD027
0123 I                                      235 2370FTYP
0124 I                                      238 2390FSEQ
0125 I**********                            240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
0126 I                                      246 2470FECD
0127 I                                      248 248 PDNI
0128 I                                      249 249 ACTI
0129 I                                      250 250 CNFY
0130 I                                      251 251 TLXY
0131 I                                      252 252 CBLY
0132 I                                      253 253 INTC
0133 I                                      254 254 NACD
     I                                      261 263 OSBR                  S01117
0134 I                                    P 311 3130ORED
0135 I                                    P 314 3160LCD
0136 I                                      317 317 CHTP
0137 I** N.B. NEXT FIELD IS EXTRACT DATE -- NOT TNLU
0138 I                                    P 318 3200EXTD
     I*  Extended settlement details                                      S01518
     I                                      321 3220RSTM                  S01518
     I**********                            323 334 RONS                               S01518 CGL029
     I                                      323 334 RONSQQ                                    CGL029
     I                                      335 342 RIBN                  S01518
     I                                      343 377 RIBA                  S01518
     I**********                            378 3830ROBN                               S01518 CSD027
     I**********                            384 3890ROCN                               S01518 CSD027
     I                                      378 383 ROBN                                      CSD027
     I                                      384 389 ROCN                                      CSD027
     I                                      390 3910PSTM                  S01518
     I**********                            392 403 PONS                               S01518 CGL029
     I                                      392 403 PONSQQ                                    CGL029
     I                                      404 411 PIBN                  S01518
     I                                      412 446 PIBA                  S01518
     I**********                            447 4520POBN                               S01518 CSD027
     I**********                            453 4580POCN                               S01518 CSD027
     I                                      447 452 POBN                                      CSD027
     I                                      453 458 POCN                                      CSD027
     I                                      459 466 RCRN                  S01518
     I                                      467 501 RCRA                  S01518
     I                                      502 509 RVNO                  S01518
     I                                      510 517 AWBN                  S01518
     I                                      518 552 AWBA                  S01518
     I                                      553 560 BENN                  S01518
     I                                      561 595 BENA                  S01518
     I                                      596 630 DTP1                  S01518
     I                                      631 665 DTP2                  S01518
     I                                      666 700 DPT3                  S01518
     I                                      701 735 DPT4                  S01518
     I                                      736 738 DCHG                  S01518
     I                                      739 773 BTB1                  S01518
     I                                      774 808 BTB2                  S01518
     I                                      809 843 BTB3                  S01518
     I                                      844 878 BTB4                  S01518
     I                                      879 913 BTB5                  S01518
     I                                      914 948 BTB6                  S01518
     I                                      949 949 CVMR                  S01518
     I                                      970 971 DFTP                  CLE004
     I                                      972 973 DFST                  CLE004
     I                                      974 974 MNSG                  CLE004
     I                                      975 975 GASS                  CLE004
     I                                      976 976 GPRT                  CLE004
     I                                      977 977 NRLI                  CLE004
     I**********                            978 9830ROLN                               CLE004 CLE148
     I                                      978 983 ROLN                                      CLE148
     I                                      984 9860ROSN                  CLE004
     I***********                           987 9920RORC           CLE004 157056
     I***********                           993 993 PDGN           CLE004 157056
     I***********                           994 994 GRIN           CLE004 157056
     I***********                           995 997 RLCY           CLE004 157056
     I***********                           99810040PNAM           CLE004 157056
     I***********                          10051005 PAST           CLE004 157056
     I***********                          10061006 ASTS           CLE004 157056
     I***********                          10071016 IUSR           CLE004 157056
     I***********                          10171026 AUSR           CLE004 157056
     I***********                          10271036 XUSR           CLE004 157056
     I***********                          10371051 PCRF           CLE004 157056
     I                                      987 989 ROBR                  157056
     I**********                            990 9950RORC                               157056 CSD027
     I                                      990 995 RORC                                      CSD027
     I                                      996 996 PDGN                  157056
     I                                      997 997 GRIN                  157056
     I                                      9981000 RLCY                  157056
     I                                    P100110070PNAM                  157056
     I                                     10081008 PAST                  157056
     I                                     10091009 ASTS                  157056
     I                                     10101019 IUSR                  157056
     I                                     10201029 AUSR                  157056
     I                                     10301039 XUSR                  157056
     I                                     10401054 PCRF                  157056
     I                                     10551057 PCOB                  157056
     I                                     10581058 MTPD                  157056
     I                                     10591059 PDDI                  157056
     I                                     10601060 PTDI                  157056
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                  CEU020
     I                                     10681068 REPI                                      CAS005
     I                                    P106910750CHDU                                      CLE028
     I                                    P107610820INTN                                      CAS005
     I                                    P108310890PRAMN                                     CAS005
     I                                    P109010968REXR                  CLE031
     I                                     10971097 REXI                  CLE031
     I                                     10981100 PSCY                  CLE031
     I                                    P110111078PEXR                  CLE031
     I                                     11081108 PEXI                  CLE031
     I                                     11091109 STAL                                      CLE034
     I                                     11101129 FRNT                                      CAP075
     I                                     11301149 AFRT                                      CAP075
     I                                     11501150 REPA                                      CAP075
     I                                     11511176 TMST                                      CAP075
     I                                     11771194 OSAC            22                        CGL029
     I                                     11951212 RONS                                      CGL029
     I                                     12131230 PONS                                      CGL029
     I                                     12801283 CLAS                                      CLE042
     I*    LOT, FOR OUTPUT TO LENXTAB
     I                                        1 250 LOT1
     I                                      251 320 LOT2
     I                                      321 949 LOT3                  S01518
0139 I* CONFIRMATIONS TRAILER
0140 I*
0141 ICONFS   NS  07   1 CT
0142 I                                        1   1 RECI
0143 I                                    P  17  190NORE
0144 I                                    P  20  220FLSZ
0145 I                                    P  23  250NLRB
0146 I                                    P  26  280NINS
0147 I                                    P  29  310NDEL
0148 I                                    P  32  340NLRA
0149 I                                    P  35  420VLBF
0150 I                                    P  43  440VLBL
0151 I                                    P  45  520VRIF
0152 I                                    P  53  540VRIL
0153 I                                    P  55  620VRDF
0154 I                                    P  63  640VRDL
0155 I                                    P  65  720VRAF
0156 I                                    P  73  740VRAL
0157 I                                    P  75  820VRRF
0158 I                                    P  83  840VRRL
0159 I                                    P 314 3160LCD
0160 I                                      317 317 CHTP
0161 I                                    P 318 3200TNLU
0162 I* CONFIRMATIONS CATCHALL
0163 I*
0164 ICONFS   NS  09
0165 I                                        1   1 RECI
0166 I*
0167 I**************                                                      S01194
0168 I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0169 I**************                                                      S01194
0170 I*CLINT***NS****   1 CD   8 CA                                       S01194
0171 I**************                          1   1 RECI                  S01194
0172 I**************                          2   70CNUM                  S01194
0173 I**************                          8   8 RCDT                  S01194
0174 I**************                          9  28 CRNM                  S01194
0175 I**************                         29  38 CTWN                  S01194
0176 I**************                         39  48 CSNM                  S01194
0177 I**************                         49  56 CASK                  S01194
0178 I**************                         57  68 TELX                  S01194
0179 I**************                         69  80 CSID                  S01194
0180 I**************                         81  82 ACOC                  S01194
0181 I**************                         83  83 CBSI                  S01194
0182 I**************                         84  85 CCTZ                  S01194
0183 I**************                         86  87 CLOC                  S01194
0184 I**************                         88  930CPAR                  S01194
0186 I**************                         97  980LINS                  S01194
0187 I**************                         99 1010LIND                  S01194
0188 I**************                      P 102 1040DASU                  S01194
0189 I**************                      P 105 1070CDIC                  S01194
0190 I**************                      P 108 1100DADE                  S01194
0191 I**************                        111 111 CMIN                  S01194
0192 I**************                        112 112 CTYP                  S01194
0193 I**************                        113 124 TELF                  S01194
0194 I**************                        125 133 CHID                  S01194
0195 I**************                        134 136 CHAB                  S01194
0195 I**************                        161 161 SWTX            S01135S01194
     I**************                        195 195 GSFM            E11666S01194
     I**************                        245 245 TLXR                  S01194
0196 I**************                      P 250 2520LCD                   S01194
0197 I**************                        253 253 CHTP                  S01194
0198 I**************                      P 254 2560TNLU                  S01194
0199 I**************                                                      S01194
0200 I**************                                                      S01194
0201 I*****CLIENT*FILE - CUSTOMER NAME AND ADDRESS RECORD.                S01194
0202 I**************                                                      S01194
0203 I********NS****   1 CD   8NCA                                        S01194
0204 I**************                          1   1 RECI                  S01194
0205 I**************                          2   70CNUM                  S01194
0206 I**************                          8   8 RCDT                  S01194
0207 I**************                          9  43 CNA1                  S01194
0208 I**************                         44  78 CNA2                  S01194
0209 I**************                         79 113 CNA3                  S01194
0210 I**************                        114 148 CNA4                  S01194
0211 I**************                        240 249 CTWN                  S01194
0212 I**************                      P 250 2520LCD                   S01194
0213 I**************                        253 253 CHTP                  S01194
0214 I**************                      P 254 2560TNLU                  S01194
0215 I**************                                                      S01194
0216 I**************                                                      S01194
0217 I*****CLIENT*FILE - CATCHALL                                         S01194
0218 I**************                                                      S01194
0219 I********NS****                                                      S01194
0220 I**************                          1   1 RECI                  S01194
0221 I**TABLE*FILE**                                                      S01194
0222 I**************                                                      S01194
0223 I**************                                                      S01194
0224 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0225 I**************                                                      S01194
0226 I*TABLE***NS**11   2 C0   3 C1  12 C1                                S01194
0227 I*******AND****  13 C0                                               S01194
0228 I**************                          1   1 RECI                  S01194
0229 I**************                          2   30RECT                  S01194
0230 I**************                         12  130RCDE                  S01194
0231 I**************                         14  66 TITL                  S01194
0232 I**************                         67  67 DATF                  S01194
0233 I***********                            68  70 DFBR                  S01194
     I**************                         71  71 TLXM                  S01194
0234 I**************                         74  74 MODI1                 S01194
0235 I**************                         75  75 MODI2                 S01194
0236 I**************                         76  76 MODI3                 S01194
0237 I**************                      P  77  790RUND                  S01194
0238 I**************                         80  86 RUNA                  S01194
0239 I**************                         87  870SFLG                  S01194
0240 I**************                      P  90  920LCD                   S01194
0241 I**************                         93  93 CHTP                  S01194
0242 I**************                      P  94  960TNLU                  S01194
0243 I**************                                                      S01194
0244 I**************                                                      S01194
0245 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0246 I**************                                                      S01194
0247 I*TABLE***NS**12   1 CD   2 C0   3 C1                                S01194
0248 I*******AND****  12 C1  13 C1                                        S01194
0249 I**************                          1   1 RECI                  S01194
0250 I**************                          2   30RECT                  S01194
0251 I**************                         12  130RCDE                  S01194
0252 I**************                         14  16 BCCY                  S01194
0253 I**************                         17  19 BCYL                  S01194
0254 I**************                         20  22 HOCY                  S01194
0255 I**************                         23  280HEAD                  S01194
0256 I**************                      P  29  310APDA                  S01194
0257 I**************                         35  35 APFQ                  S01194
0258 I**************                      P  36  380LOGS                  S01194
0259 I**************                         39  40 CUZR                  S01194
0260 I**************                      P  41  430DNWD                  S01194
0261 I**************                         44  460BVLP                  S01194
0262 I**************                         47  49 LOCY                  S01194
0263 I**************                         50  510FDAY                  S01194
0264 I**************                         86  86 ISAV                  S01194
0265 I**************                      P  87  890LLOG                  S01194
0266 I**************                      P  90  920LCD                   S01194
0267 I**************                         93  93 CHTP                  S01194
0268 I**************                      P  94  960TNLU                  S01194
0269 I**************                                                      S01194
0270 I**************                                                      S01194
0271 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0272 I**************                                                      S01194
0273 I*TABLE***NS**13   1 CD   2 C0   3 C1                                S01194
0274 I*******AND****  12 C4  13 C0                                        S01194
0275 I**************                          1   1 RECI                  S01194
0276 I**************                          2   30RECT                  S01194
0277 I**************                         12  130RCDE                  S01194
0278 I**************                         18  210CSAC                  S01194
0279 I**************                         22  22 TLII                  S01194
0280 I**************                         23  23 MCRI                  S01194
0281 I**************                      P  24  250MCEP                  S01194
0282 I**************                         26  270MCLP                  S01194
0283 I**************                         28  28 FRDI                  S01194
0284 I**************                         29  29 BRCF                  S01194
0285 I**************                         30  350PSCN                  S01194
0286 I***********                            36  380DLBR                  S01194
0287 I**************                         39  420FRPA                  S01194
0288 I**************                         43  460FRPC                  S01194
0289 I**************                         47  49 USCY                  S01194
0290 I**************                         50  52 STCY                  S01194
0291 I**************                      P  53  553MBGE                  S01194
0292 I**************                         59  59 BRNC                  S01194
0293 I**************                      P  90  920LCD                   S01194
0294 I**************                         93  93 CHTP                  S01194
0295 I**************                      P  94  960TNLU                  S01194
0296 I**************                                                      S01194
0297 I**************                                                      S01194
0298 I*****TABLE*FILE - BRANCH CODES RECORD.                              S01194
0299 I**************                                                      S01194
0300 I*ABLE***NS* 15   1 CD   2 C1   3 C0                                 S01117
0301 I***********                             1   1 RECI                  S01117
0302 I***********                             2   30RECT                  S01117
0303 I***********                            11  130BRCD                  S01117
0304 I***********                            14  43 BRNM                  S01117
0305 I***********                            44  490BICN                  S01117
0306 I***********                            50  51 LOCC                  S01117
0307 I***********                            52  53 CMPY                  S01117
0308 I***********                         P  90  920LCD                   S01117
0309 I***********                            93  93 CHTP                  S01117
0310 I***********                         P  94  960TNLU                  S01117
0311 I**************                                                      S01194
0312 I**************                                                      S01194
0313 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0314 I**************                                                      S01194
0315 I*TABLE***NS**14   1 CD   2 C2   3 C0                                S01194
0316 I*******AND****  13 C1                                               S01194
0317 I**************                          1   1 RECI                  S01194
0318 I**************                          2   30RECT                  S01194
0319 I**************                         10  12 CCY                   S01194
0320 I**************                         13  130SREC                  S01194
0321 I**************                         14  27 CCNM                  S01194
0322 I**************                      P  28  348SPOT                  S01194
0323 I**************                         35  37 CCYS                  S01194
0324 I**************                         38  380CDP                   S01194
0325 I**************                         39  390TNOT                  S01194
0326 I**************                         40  40 DCCY                  S01194
0327 I**************                         41  44 SRC1                  S01194
0328 I**************                         45  48 SRC2                  S01194
0329 I**************                         49  520TACC                  S01194
0330 I**************                         53  560TEQV                  S01194
0331 I**************                         57  600SWQV                  S01194
0332 I**************                         61  640TAC4                  S01194
0333 I**************                         65  680TAC5                  S01194
0334 I**************                         69  69 HIND                  S01194
0335 I**************                      P  70  768PART                  S01194
0336 I**************                         77  780SSNO                  S01194
0337 I**************                      P  79  858ERLC                  S01194
0338 I**************                      P  90  920LCD                   S01194
0339 I**************                         93  93 CHTP                  S01194
0340 I**************                      P  94  960TNLU                  S01194
0341 I**************                                                      S01194
0342 I**************                                                      S01194
0343 I*****TABLE*FILE - NOSTROS RECORD.                                   S01194
0344 I**************                                                      S01194
0345 I*TABLE***NS**16   1 CD   2 C7   3 C0                                S01194
0346 I**************                          1   1 RECI                  S01194
0347 I**************                          2   30RECT                  S01194
0348 I**************                          9  11 CCY                   S01194
0349 I**************                         12  130NOSN                  S01194
0350 I**************                         16  29 ONAC                  S01194
0351 I**************                         30  350CNUM                  S01194
0352 I**************                         36  370ACSQ                  S01194
0353 I**************                         38  410ACOD                  S01194
0354 I**************                      P  90  920LCD                   S01194
0355 I**************                         93  93 CHTP                  S01194
0356 I**************                      P  94  960TNLU                  S01194
0357 I**************                                                      S01194
0358 I**************                                                      S01194
0359 I*****TABLE*FILE - COUNTERPARTY NOSTROS RECORD.                      S01194
0360 I**************                                                      S01194
0361 I*TABLE***NS**17   1 CD   2 C7   3 C1                                S01194
0362 I**************                          1   1 RECI                  S01194
0363 I**************                          2   30RECT                  S01194
0364 I**************                          6  13 CPSH                  S01194
0365 I**************                         14  48 CPNM                  S01194
0366 I**************                         49  68 CPTN                  S01194
0367 I**************                      P  90  920LCD                   S01194
0368 I**************                         93  93 CHTP                  S01194
0369 I**************                      P  94  960TNLU                  S01194
0370 I**************                                                      S01194
0371 I**************                                                      S01194
0372 I*****TABLE*FILE - CATCHALL                                          S01194
0373 I**************                                                      S01194
0374 I********NS****                                                      S01194
0375 I**************                          1   1 RECI                  S01194
0376 I**************                          2   30RECT                  S01194
     I/COPY WNCPYSRC,LE0420I002
0377 I*
     I**   FIELDS USED FOR BENIFICIARY BANK DETAILS
0374 I********DS                                                          E13032
0374 I            DS                                                      E13032
     I                                        1  30 SPI1
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  29 SPEC29
     I                                        6  30 SPEC30
     I/COPY WNCPYSRC,LE0420I001
0378 I*
0379 I* DATA BASE ERRORS
0380 I*
0381 ILDA        UDS                            256
0382 I***********                           134 138 DBFILE                S01117
0383 I***********                           139 167 DBKEY                 S01117
0384 I***********                           168 175 DBPGM                 S01117
0385 I***********                           176 177 DBASE                 S01117
0382 I                                      134 141 DBFILE                S01117
0383 I                                      142 170 DBKEY                 S01117
0384 I                                      171 180 DBPGM                 S01117
0385 I                                      181 1830DBASE                 S01117
     I*                                                                   CSW096
     IP@IN        DS                            256                       CSW096
     I                                        1   3 I@SNBR                CSW096
     I                                        4   9 I@DSCN                CSW096
     I                                       10  12 I@MTPY                CSW096
     I                                       13  140I@SETT                CSW096
     I                                       15  15 I@CONC                CSW096
     I                                       16  16 I@FTCS                CSW096
      ** Data structure for input parameter                               CSW096
      *                                                                   CSW096
     IP@OUT       DS                            256                       CSW096
     I                                        1   60O@CNSN                CSW096
     I                                        7  18 O@SWSN                CSW096
     I                                       19  38 O@NWSN                CSW096
     I                                       39  49 O@SWDS                CSW096
     I                                       46  46 W@96CN                CSW096
     I                                       47  49 W@BIC                 CSW096
     I                                       50  69 O@NWDS                CSW096
     I                                       70  75 O@NWRK                CSW096
     I                                       76  76 O@MGSG                CSW096
     I                                       77  80 O@MGST                CSW096
      ** Data structure for ouput parameter                               CSW096
      *                                                                   CSW096
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL1      DS                                                      S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     ISPOOL2      DS                                                      CLE004
     I                                       83  92 SFILE2                CLE004
     I                                    B 123 1240SFNUM2                CLE004
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01194
     ISDALTN    E DSSDALTNPD                                              S01194
      **  EXTERNAL DS FOR ALTERNATE NAME AND ADDRESSES                    S01194
     I              BCCNA1                          CNA1                  S01194
     I              BCCNA2                          CNA2                  S01194
     I              BCCNA3                          CNA3                  S01194
     I              BCCNA4                          CNA4                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I*                                                                   S01194
     I***SDBRCH*   E DSSDBRCHPD                                                      S01117 CLE075BO
     ISDBRCH    E DSSDBRCHPD                900                                             CLE075BO
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     I              QQDFAC                          DFACBK                                    CGL029
     I*                                                                   S01194
     ISDCNST    E DSSDCNSTPD                                              S01194
      **  EXTERNAL DS FOR COUNTERPARTY NOSTRO DETAILS                     S01194
     I              AWCPNM                          CPNM                  S01194
     I              AWCNTN                          CPTN                  S01194
     I*                                                                   S01194
     I***SDCURR*   E DSSDCURRPD                                                      S01194 CLE075BO
     ISDCURR    E DSSDCURRPD                250                                             CLE075BO
      **  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              A6NBDP                          CDP                   S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCSID                          CSID                  S01194
     I              BBCRTN                          CTWN                  S01194
     I              BBCMTI                          TLXR                  S01194
     I              BBGSFM                          GSFM                  S01194
     I              BBSTFG                          SWTX                  S01194
     I              BBTXA1                          TELX                  S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     I              QQACCD                          ACCDBK                                    CGL029
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
      **  EXTERNAL DS FOR MIDAS MODULES DETAILS                           S01194
     I              BGMTMI                          TLXM                  S01194
     I*                                                                   S01194
     I***SDNOST*   E DSSDNOSTPD                                                      S01194 CLE075BO
     ISDNOST    E DSSDNOSTPD                200                                             CLE075BO
      **  EXTERNAL DS FOR NOSTROS DETAILS                                 S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
      **  EXTERNAL DS FOR TRADING DETAILS                                 S01194
     I              BLBNOC                          BRNC                  S01194
     I              QQACCD                          ACCDB2                                    CGL029
     I*                                                                   S01194
     ISDMGME    E DSSDMGMEPD                                              BH2600
     I** EXTERNAL DS FOR MESSAGE DETAILS                                  BH2600
     I*                                                                   CLE004
     ISCSARD    E DSSCSARDPD                                              CLE004
     I*  SAR Details                                                      CLE004
     I              LCD                             LCDX                  CEU004
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     I/COPY WNCPYSRC,LE0420I003
     I/EJECT
     C                     MOVEACPY@      BIS@   80
0386 C*
0387 C*  BYPASS IF NOT FIRST CYCLE
     C*  (*IN01 IS ON IF CONFIRMATIONS HEADER RECORD READ)                038382
0388 C     N01             GOTO BY01
     C**                                                                  S01117
     C*     IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C/COPY WNCPYSRC,LE0420C010
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0294 C**                                                                  S01117
     C*    SETON INDICATOR FOR OUTPUT IF MBIN = 'Y'                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     65                   S01117
     C                     END                                            S01117
0389 C*
0390 C*  SETUP L.D.A. FOR DATA BASE ERRORS
0391 C                     MOVEL'LE0420  'DBPGM
0392 C                     MOVEL'     '   DBKEY
0393 C*
0394 C*  ACCESS INSTALLATION CONTROL 1.
0395 C                     EXSR ZSYSTM
0396 C******99******       SETON                     U7U8                 S01194
0397 C******99******       MOVEL'TABLE'   DBFILE                          S01194
0398 C******99******       MOVELZTABKY    DBKEY            ***************S01194
0399 C******99******       MOVEL'01'      DBASE            *  DBASE  01  *S01194
0400 C      99             GOTO END                        ***************
0401 C*
0402 C*  ACCESS INSTALLATION CONTROL 2.
0403 C**************       MOVE '1'       ZTABKY 12                       S01194
0404 C**************       EXSR TABCHN                                    S01194
     C**                                                                  S01194
     C** ACCESS GENERAL LEDGER DETAILS                                    S01194
     C**                                                                  S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
     C      31             MOVEL'SDGELRPD'DBFILE                          S01194
     C      31             MOVEL@OPTN     DBKEY                           S01194
0405 C      31             MOVEL'02'      DBASE            ***************
0406 C      31             SETON                     U7U8  *  DBASE  02  *
0407 C      31             GOTO END                        ***************
0408 C*
0409 C*  ACCESS INSTALLATION CONTROL 5.
0410 C**************       MOVE '40'      ZTABKY                          S01194
0411 C**************       EXSR TABCHN                                    S01194
     C**                                                                  S01194
     C** ACCESS TRADING DATA                                              S01194
     C**                                                                  S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
     C                     MOVEL'SDTRADPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
0412 C      31             MOVEL'03'      DBASE            ***************
0413 C      31             SETON                     U7U8  *  DBASE  03  *
0414 C      31             GOTO END                        ***************
     C**                                                                  S01194
     C** ACCESS MIDAS MODULE DETAILS                                      S01194
     C**                                                                  S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
     C      31             MOVEL'SDMMODPD'DBFILE                          S01194
     C      31             MOVEL@OPTN     DBKEY                           S01194
     C      31             MOVEL'14'      DBASE            ***************S01194
     C      31             SETON                     U7U8  *  DBASE  14  *S01194
     C      31             GOTO END                        ***************S01194
      *                                                                                     CLE075BO
      ** Access SD Message Management                                                       CLE075BO
      *                                                                                     CLE075BO
     C                     CALL 'AOMGMER0'                                                  CLE075BO
     C                     PARM '*MSG    '@RTCD                                             CLE075BO
     C                     PARM '*FIRST  '@OPTN                                             CLE075BO
     C           SDMGME    PARM SDMGME    DSFDY                                             CLE075BO
      *                                                                                     CLE075BO
     C           @RTCD     IFNE *BLANK                                                      CLE075BO
     C                     MOVEL'LE0420  'DBPGM                                             CLE075BO
     C                     MOVEL'SDMGMEPD'DBFILE                                            CLE075BO
     C                     MOVEL'12'      DBASE                                             CLE075BO
     C                     SETON                     U7U8LR                                 CLE075BO
     C                     EXSR *PSSR                                                       CLE075BO
     C                     END                                                              CLE075BO
0415 C*
     C*  COUNTER FOR NO. OF TELEXES
     C*
     C                     Z-ADD0         TOTLX   30
     C*
0416 C*  CHECK IF BRANCH NAMES TO BE PRINTED
0417 C           BRNC      COMP 'Y'                      70
     C*
     C*    INITIALISE COUNT FOR RECORDS OUTPUT TO LENXT
     C   U4                Z-ADD2         RECXTO  50
     C/COPY WNCPYSRC,LE0420CCP3                                           S01408
      *                                                                                     CLE075BO
      ** Full Cache SDCURRPD                                                                CLE075BO
      *                                                                                     CLE075BO
     C           *LOVAL    SETLLSDCURRL1                                                    CLE075BO
     C                     Z-ADD250       A       30                                        CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     READ SDCURRL1                 12                                 CLE075BO
     C                     MOVE A6CYCD    #CCY,A                                            CLE075BO
     C                     MOVE A6NBDP    CDP                                               CLE075BO
     C           *IN12     DOWEQ'0'                                                         CLE075BO
     C           A         ANDGT0                                                           CLE075BO
     C                     SUB  1         A                                                 CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     READ SDCURRL1                 12                                 CLE075BO
     C                     MOVE A6CYCD    #CCY,A                                            CLE075BO
     C                     MOVE A6NBDP    CDP                                               CLE075BO
     C                     ENDDO                                                            CLE075BO
     C           A         IFEQ 0                                                           CLE075BO
     C                     MOVEL'SDCURRPD'DBFILE                                            CLE075BO
     C                     MOVEL'OVRFLOW' DBKEY                                             CLE075BO
     C                     SETON                     U7U8LR                                 CLE075BO
     C                     EXSR *PSSR                                                       CLE075BO
     C                     ENDIF                                                            CLE075BO
     C                     Z-ADDA         CURARR  30                                        CLE075BO
      *                                                                                     CLE075BO
      ** Full Cache SDBRCHPD                                                                CLE075BO
      *                                                                                     CLE075BO
     C           *LOVAL    SETLLSDBRCHL1                                                    CLE075BO
     C                     Z-ADD900       B       30                                        CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     READ SDBRCHL1                 12                                 CLE075BO
     C                     MOVE A8BRCD    #BCH,B                                            CLE075BO
     C                     MOVE A8BRNM    BRNM                                              CLE075BO
     C                     MOVE QQDFAC    DFACBK                                            CLE075BO
     C           *IN12     DOWEQ'0'                                                         CLE075BO
     C           B         ANDGT0                                                           CLE075BO
     C                     SUB  1         B                                                 CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     READ SDBRCHL1                 12                                 CLE075BO
     C                     MOVE A8BRCD    #BCH,B                                            CLE075BO
     C                     MOVE A8BRNM    BRNM                                              CLE075BO
     C                     MOVE QQDFAC    DFACBK                                            CLE075BO
     C                     ENDDO                                                            CLE075BO
     C           B         IFEQ 0                                                           CLE075BO
     C                     MOVEL'SDBRCHPD'DBFILE                                            CLE075BO
     C                     MOVEL'OVRFLOW' DBKEY                                             CLE075BO
     C                     SETON                     U7U8LR                                 CLE075BO
     C                     EXSR *PSSR                                                       CLE075BO
     C                     ENDIF                                                            CLE075BO
     C                     Z-ADDB         BCHARR  30                                        CLE075BO
      *                                                                                     CLE075BO
      ** LRU element key and record arrival sequence                                        CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADD0         NOSKEY 130                                        CLE075BO
     C           *LIKE     DEFN NOSKEY    NOSSEQ                                            CLE075BO
      *                                                                                     CLE075BO
      ** Set start index to upper limit of LRU Caching arrays                               CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADD200       NOSIDX  40                                        CLE075BO
     C           *LIKE     DEFN NOSIDX    NOSPRV                                            CLE075BO
     C           *LIKE     DEFN NOSIDX    F                                                 CLE075BO
      *                                                                                     CLE075BO
      ** Initialize work fields of LRU array routines                                       CLE075BO
      *                                                                                     CLE075BO
     C                     MOVE *BLANK    NOSIC   1                                         CLE075BO
     C                     MOVE *BLANKS   KEYNOS  5                                         CLE075BO
     C                     Z-ADD200       NOSPRV                                            CLE075BO
     C                     Z-ADD200       F                                                 CLE075BO
     C*
0418 C******************************************
0419 C           BY01      TAG                             ** BY01 TAG **
     C**                                                                  S01117
     C*   IGNORE THE FOLLOWING  PROCESSING IF NOT A DETAIL RECORD         S01117
     C**                                                                  S01117
     C  N03N05             GOTO ENDMB                                     S01117
     C/COPY WNCPYSRC,LE0420C012
     C**                                                                  S01117
     C*   MULTIBRANCHING PROCESSING                                       S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     75                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C           *INL1     IFEQ '1'                                       S01117
     C                     CLOSELE0420P1                                  S01117
     C                     CLOSELE0420P2                                  CLE004
      *                                                                   CLE004
      ** Initialise open printer file flags                               CLE004
      *                                                                   CLE004
     C                     MOVE '0'       *IN61                           CLE004
     C                     MOVE '0'       *IN62                           CLE004
     C                     MOVE *BLANK    WOPN1   1                       CLE004
     C                     MOVE *BLANK    WOPN2   1                       CLE004
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A LEVEL BREAK,                             S01117
     C*       OPEN LE0420P1                                               S01117
     C**                                                                  S01117
     C                     SETON                       75  ALLOW OUTPUT   S01117
     C***********          OPEN LE0420P1                           S01117 CLE004
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C**  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C                     OPEN LE0420P2                                  CLE004
     C                     Z-ADDSFNUM2    ZSNUM   60                      CLE004
     C                     MOVELSFILE2    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN2                           CLE004
     C                     MOVE '1'       *IN62                           CLE004
     C                     ELSE                                           CLE004
     C                     OPEN LE0420P1                                  CLE004
     C                     Z-ADDSFNUM1    ZSNUM   60                      S01117
     C                     MOVELSFILE1    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN1                           CLE004
     C                     MOVE '1'       *IN61                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BRCA      SENTY                           S01117
     C***********          PARM           SFILE1                   S01117 CLE004
     C                     PARM           SFILE                           CLE004
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** RETRIEVE SETTLEMENT BRANCH NAME                                  S01117
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     MOVEL@DSNB     DBKEY            * DBERROR 13  *S01117
     C                     MOVEL'013'     DBASE            ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C                     ENDIF                                                            CLE075BO
     C   U7                GOTO END                                       S01117
     C**                                                                  S01117
     C                     ELSE                                           CLE004
      *                                                                   CLE004
      ** Check if printer file (P1 or P2) is already open, during         CLE004
      ** change of amendment types                                        CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           WOPN2     ANDEQ*BLANK                                    CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C           WOPN2     ANDEQ*BLANK                                    CLE004
     C           AMTP      OREQ 'PI'                                      CLE004
     C           WOPN1     ANDEQ*BLANK                                    CLE004
     C           AMTP      OREQ 'RE'                                      CLE004
     C           WOPN1     ANDEQ*BLANK                                    CLE004
      *                                                                   CLE004
     C                     MOVE '1'       *IN75                           CLE004
      *                                                                   CLE004
      **  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C                     OPEN LE0420P2                                  CLE004
     C                     Z-ADDSFNUM2    ZSNUM   60                      CLE004
     C                     MOVELSFILE2    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN2                           CLE004
     C                     MOVE '1'       *IN62                           CLE004
     C                     ELSE                                           CLE004
     C                     OPEN LE0420P1                                  CLE004
     C                     Z-ADDSFNUM1    ZSNUM   60                      CLE004
     C                     MOVELSFILE1    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN1                           CLE004
     C                     MOVE '1'       *IN61                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     OUT  LDA                                       CLE004
      *                                                                   CLE004
     C                     CALL 'ZSFILE'                                  CLE004
     C                     PARM           SEQ     5                       CLE004
     C                     PARM BRCA      SENTY                           CLE004
     C                     PARM           SFILE                           CLE004
     C                     PARM           ZSNUM                           CLE004
     C                     PARM           ZSERR   1                       CLE004
      *                                                                   CLE004
     C           *LOCK     IN   LDA                                       CLE004
     C           ZSERR     IFEQ 'Y'                                       CLE004
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     RETRN                                          CLE004
     C                     ENDIF                                          CLE004
     C**                                                                  CLE004
     C** RETRIEVE SETTLEMENT BRANCH NAME                                  CLE004
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                             CLE004 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       CLE004
     C                     PARM '*KEY   ' @OPTN   7                       CLE004
     C                     PARM BRCA      @DSNB   3                       CLE004
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CLE004 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     MOVEL'SDBRCHPD'DBFILE           ***************CLE004
     C                     MOVEL@DSNB     DBKEY            * DBERROR 21  *CLE004
     C                     Z-ADD21        DBASE            ***************CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     END                                            CLE004
     C                     ENDIF                                                            CLE075BO
     C   U7                GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0420P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C***********          OPEN LE0420P1                           S01117 CLE004
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C                     OPEN LE0420P2                                  CLE004
     C                     Z-ADDSFNUM2    ZSNUM   60                      CLE004
     C                     MOVELSFILE2    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN2                           CLE004
     C                     MOVE '1'       *IN62                           CLE004
     C                     ELSE                                           CLE004
     C                     OPEN LE0420P1                                  CLE004
     C                     Z-ADDSFNUM1    ZSNUM                           S01117
     C                     MOVELSFILE1    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN1                           CLE004
     C                     MOVE '1'       *IN61                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C***********          PARM           SFILE1                   S01117 CLE004
     C                     PARM           SFILE                           CLE004
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     ELSE                                           CLE004
      *                                                                   CLE004
      ** Check if printer file (P1 or P2) is already open, during         CLE004
      ** change of amendment types                                        CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           WOPN2     ANDEQ*BLANK                                    CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C           WOPN2     ANDEQ*BLANK                                    CLE004
     C           AMTP      OREQ 'PI'                                      CLE004
     C           WOPN1     ANDEQ*BLANK                                    CLE004
     C           AMTP      OREQ 'RE'                                      CLE004
     C           WOPN1     ANDEQ*BLANK                                    CLE004
      *                                                                   CLE004
      ** Ensure report spool file recorded by RCF                         CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C                     OPEN LE0420P2                                  CLE004
     C                     Z-ADDSFNUM2    ZSNUM   60                      CLE004
     C                     MOVELSFILE2    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN2                           CLE004
     C                     MOVE '1'       *IN62                           CLE004
     C                     ELSE                                           CLE004
     C                     OPEN LE0420P1                                  CLE004
     C                     Z-ADDSFNUM1    ZSNUM                           CLE004
     C                     MOVELSFILE1    SFILE  10                       CLE004
     C                     MOVE 'Y'       WOPN1                           CLE004
     C                     MOVE '1'       *IN61                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     OUT  LDA                                       CLE004
      *                                                                   CLE004
     C                     CALL 'ZSFILE'                                  CLE004
     C                     PARM           SEQ                             CLE004
     C                     PARM BRCA      SENTY   3                       CLE004
     C                     PARM           SFILE                           CLE004
     C                     PARM           ZSNUM                           CLE004
     C                     PARM           ZSERR   1                       CLE004
      *                                                                   CLE004
     C           *LOCK     IN   LDA                                       CLE004
     C           ZSERR     IFEQ 'Y'                                       CLE004
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     RETRN                                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If SAR On      CEU004
     C           SCCY      ANDNE*BLANKS                    And Stl Ccy    CEU004
     C           CLE031    ANDNE'Y'                                                           CLE031
     C                     MOVE SCCY      WKCCY   3         Set Ccy       CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C                     MOVE CCY       WKCCY             Set Ccy       CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C**                                                                  S01117
     C           ENDMB     TAG                                            S01117
     C*                                                                   S01117
     C*    SET UP BLANK FIELD FOR COUNTERPARTY SWIFT ID
     C   U4                MOVE '        'CSWID  12
     C   U4                MOVEL'    '    CSWID
0420 C                     EXSR SETOF
0421 C      03             SETON                     24
0422 C      05             SETON                     24
     C/COPY WNCPYSRC,LE0420C003
     C*                                                                   CCG008
     C** Process only detail records with CNFY='Y'                        CCG008
     C           *IN24     IFEQ *ON                                       CCG008
     C           CNFY      ANDNE'Y'                                       CCG008
     C                     MOVE *OFF      *IN24                           CCG008
     C                     ENDIF                                          CCG008
     C/COPY WNCPYSRC,LE0420C004
     C*                                                                   CCG008
0423 C     N24             GOTO FIN
0424 C*
     C***IF*THE*CUSTOMER*LENDING/TELEX*MODULE*BIT*INDICATOR*IS*ON,        S01194
     C***IF*THE*CUSTOMER*LENDING/TELEX*MODULE*BIT*INDICATOR*IS*PRESES01194BH2600
     C***TEST*IF*TELEXES*ARE*TO*BE*SENT*FOR*THIS*CUSTOMER*************    BH2600
     C*
     C***U1*********       TESTB'3'       TLXM           46               S01194
     C***U1******TLXM      COMP 'Y'                      46         S01194BH2600
     C***U1*46***          MOVELCNUM      CLKY                            BH2600
     C***U1*46******       MOVE 'A'       CLKY                            S01194
     C*
     C***ACCESS*CLINT*'A'*RECORD*TO*GENERATE*TELEX*FOR*THIS*CUSTOMER      S01194
     C** ACCESS SDCUSTPD RECORD TO GENERATE TELEX FOR THIS CUSTOMER       S01194
     C*
     C   U1 46             EXSR CLCHN
     C***U1*46N31***       TESTB'3'       TLXR           47               S01194
     C   U1 46N31TLXR      COMP 'Y'                      47               S01194
     C*
     C   47                ADD  1         TOTLX
     C*
     C** DATABASE ERROR ON CLINT
     C*
     C***U1*46*31***       MOVEL'CLINT'   DBFILE                          S01194
     C   U1 46 31          MOVEL'SDCUSTPD'DBFILE                          S01194
     C   U1 46 31          MOVELCLKY      DBKEY
     C   U1 46 31          MOVEL'13'      DBASE            ***************
     C   U1 46 31          SETON                     U7U8  *  DBASE  13  *
     C   U7                GOTO END                        ***************
     C*
0425 C*  CHECK AMENDMENT TYPE
0426 C           AMTP      COMP 'PI'                     20
0427 C        N20AMTP      COMP 'RE'                     21
      *                                                                   CLE004
      ** Print confirmation for Principal Transfers                       CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           AMTP      OREQ 'PF'                                      CLE004
     C                     MOVE '1'       *IN13                           CLE004
     C                     MOVE *BLANK    WEND    1                       CLE004
     C                     EXSR PRINTR                                    CLE004
      *                                                                   CLE004
     C           WEND      IFEQ *BLANK                                    CLE004
     C                     GOTO FIN                                       CLE004
     C                     ELSE                                           CLE004
     C                     GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0420CCP1                                           S01408
     C*                                                                   S01408
0428 C   20
0429 COR 21                GOTO BY01A
0430 C                     GOTO FIN
0431 C*
0432 C*  PROCESSING TYPE IF 'RE'
0433 C           BY01A     TAG                             ** BY01 TAG **
0434 C      20             GOTO BY03
0435 C           PTYP      COMP 62                     3232
0436 C         32          GOTO BY02
0437 C           PTYP      COMP 64                       34
0438 C         34          GOTO BY02
     C/COPY WNCPYSRC,LE0420C005
0439 C           PTYP      COMP 66                       36
0440 C         36          GOTO BY02
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C                     MOVE '1'       *IN34                           CLE005
     C                     GOTO BY02                                      CLE005
     C                     ENDIF                                          CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C                     MOVE '1'       *IN36                           CLE005
     C                     GOTO BY02                                      CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C/COPY WNCPYSRC,LE0420C006
0441 C                     GOTO FIN
0442 C           BY02      TAG                             ** BY02 TAG **
0443 C                     SETON                     33
     C/COPY WNCPYSRC,LE0420CCP2                                           S01408
0444 C*
0445 C** CHECK REPAY TYPE
0446 C*
0447 C           REPT      COMP 2                    1819
0448 C*
0449 C** CHECK VALUE DATE AGAINST EXTRACT DATE
0450 C*
0451 C           VDAT      COMP EXTD                 25
0452 C           BY03      TAG                             ** BY03 TAG **
0435 C* CHECK PROCESSING TYPE FOR PI                                      S01243
0435 C           PTYP      COMP 62                       48               S01243
0439 C           PTYP      COMP 66                       30               S01243
     C           PTYP      IFEQ 69                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE '1'       *IN30                           CLE005
     C                     ENDIF                                          CLE005
     C/COPY WNCPYSRC,LE0420C007
0453 C*  DETERMINE AMENDMENT/CANCELLATION NARRATIVE
0454 C   03                TESTB'7'       LAIN           37
0455 C   03 37             TESTB'2'       LAIN       37
0456 C*
     C*    CHECK IF COUNTERPARTY IS A SWIFT MEMBER
     C*      AND SET ON 39 IF OUTPUT TO LENXTAB
     C**************       MOVELCNUM      CLKY    7                       S01194
     C***U4*********       MOVE 'A'       CLKY                            S01194
     C                     MOVELCNUM      CLKY   10                       S01194
     C   U4                EXSR CLCHN
     C******   U4N31   CSID      COMP ' '                  3838           S01135
     C******  38                MOVE CSID      CSWID                      S01135
     C*                                                                   S01167
     C*****************************************************************   S01167
     C*****************************************************************I. S01167
     C*                                                                   S01167
     C** U4N31   SWTX      IFEQ 'T'                                       S01167
     C**                   SETON                     38                   S01167
     C**                   MOVELTELX      CSWID                           S01167
     C**                   ELSE                                           S01167
     C** U4N31   SWTX      IFEQ 'S'                                       S01167
     C**                   MOVELCSID      CSWID                           S01167
     C**                   SETON                     38                   S01167
     C**                   END                                            S01167
     C**                   END                                            S01167
     C*                                                                   S01167
     C*                                                                   BH2600
     C**  REMOVE OLD ROUTING                                              BH2600
     C*                                                                   BH2600
     C*IF*GENERATE*SWIFT*MSG*IND*=*Y*THEN*38*SET*ON***************  S01167BH2600
     C*                                                                   S01167
     C***U4N31***GSFM      IFEQ 'Y'                                 S01167BH2600
     C***********          SETON                     38             S01167BH2600
     C***********SWTX      IFEQ 'S'                                 S01167BH2600
     C***********          MOVELCSID      CSWID                     S01167BH2600
     C***********          ELSE                                     S01167BH2600
     C***********SWTX      IFEQ 'T'                                 S01167BH2600
     C***********          MOVELTELX      CSWID                     S01167BH2600
     C***********          END                                      S01167BH2600
     C***********          END                                      S01167BH2600
     C***********          END                                      S01167BH2600
      ***********                                                         BH2600
     C***********                                                   S01135BH2600
     C***********                                                   S01135BH2600
     C***CHECK*TO MAKE SURE THAT CORRECT SWIFT/TELEX NUMBER IS WRITTS01135BH2600
     C***TO*EXTRACT FILE                                            S01135BH2600
     C***********                                                   S01135BH2600
     C***U4N31***SWTX      IFEQ 'T'                                 S01135BH2600
     C***********          SETON                     38             S01135BH2600
     C***********          MOVELTELX      CSWID                     S01135BH2600
     C***********          ELSE                                     S01135BH2600
     C***U4N31***SWTX      IFEQ 'S'                                 S01135BH2600
     C***********          MOVELCSID      CSWID                     S01135BH2600
     C***********          SETON                     38             S01135BH2600
     C***********          END                                      S01135BH2600
     C***********          END                                      S01135BH2600
     C*                                                                   S01135
     C/COPY WNCPYSRC,LE0420C008
     C   38 20 03
     COR 38 21 03          SETON                     39
     C/COPY WNCPYSRC,LE0420C009
     C   21 25 18
     COR 21 25 19          SETOF                     39
     C*                                                                   S01167
     C**   IF SWIFT ADDRESS BIC CODE DO NOT OUTPUT TO LENXTAB             S01167
     C***                                                                 S01167
     C***********          MOVE CSID      CBIC    4                 S01167BH2600
     C***********GSFM      IFEQ 'Y'                                 S01167BH2600
     C***********CBIC      ANDEQ'BIC '                              S01167BH2600
     C***********SETP      ANDEQ'08'                                S01167BH2600
     C***********          SETOF                     39             S01167BH2600
     C***********          END                                      S01167BH2600
     C*
     C*                                                                   BH2600
     C** INSERT NEW MG ROUTING                                            BH2600
     C*                                                                   BH2600
     C                     MOVE CSID      @BIC    4                       BH2600
     C                     MOVELBRCA      @DSNB   3                       BH2600
     C                     MOVELCNUM      @CUST   6                       BH2600
     C***********          EXSR ROUT                               BH2600 CSW096
     C                     EXSR SRROUT                                    CSW096
     C*                                                                   BH2600
     C** LEEXT REC IS PRODUCED IF LENDING MESSAGE FLAG IS ON              BH2600
     C** - MESSAGE CAN BE REROUTED VIA MESSAGE MANAGEMENT -               BH2600
     C*                                                                   BH2600
     C           BGSWCL    IFEQ 'Y'                                       BH2600
     C                     SETON                     39                   BH2600
     C                     ELSE                                           BH2600
     C                     SETOF                     39                   BH2600
     C                     END                                            BH2600
     C*                                                                   BH2600
     C** IF NETWORK IS 'PAPER' AND NON-ISO CONFS ARE TO BE PRODUCED       BH2600
     C** - SET OFF 96 -                                                   BH2600
     C** TO SUPPRESS AUTO-TRANSMISSION TEXT ON PRINTOUT                   BH2600
     C*                                                                   BH2600
     C           BGSWCL    IFEQ 'Y'                                       BH2600
     C**********           CALL 'AOMGMER0'                                           BH2600 CLE075BO
     C**********           PARM '*MSG    '@RTCD                                      BH2600 CLE075BO
     C**********           PARM '*FIRST  '@OPTN                                      BH2600 CLE075BO
     C********** SDMGME    PARM SDMGME    DSFDY                                      BH2600 CLE075BO
     C*****************************************************************              BH2600 CLE075BO
     C********** @RTCD     IFNE *BLANK                                               BH2600 CLE075BO
     C**********           MOVEL'SDMGMEPD'DBFILE            * * * * * * *            BH2600 CLE075BO
     C**********           MOVEL'12'      DBASE             *DBERROR 12 *            BH2600 CLE075BO
     C**********           SETON                     U7U8LR * * * * * * *            BH2600 CLE075BO
     C**********           EXSR *PSSR                                                BH2600 CLE075BO
     C**********           END                                                       BH2600 CLE075BO
     C*                                                                   BH2600
     C           @NWRK     IFEQ 'PAPER'                                   BH2600
     C           ENFFCR    ANDEQ'Y'                                       BH2600
     C                     SETOF                     96                   BH2600
     C                     ELSE                                           BH2600
     C                     SETON                     96                   BH2600
     C                     END                                            BH2600
     C*                                                                   BH2600
     C                     ELSE                                           BH2600
     C                     SETOF                     96                   BH2600
     C                     END                                            BH2600
     C*                                                                   BH2600
0457 C*  OBTAIN CUSTOMER NAME/ADDRESS DETAILS
0459 C**************       MOVE NACD      CLKY                            S01194
0460 C**************       EXSR CLCHN                                     S01194
     C* CHECK ALTERNATE NAME & ADDRESS CODE NOT EQUAL TO 'B'              LN0007
     C* IFEQ 'B' BYPASS ALT NAME & ADDRESS VALIDATION                     LN0007
     C           NACD      IFNE 'B'                                       LN0007
     C*                                                                   LN0007
     C                     MOVELCNUM      CUST    6                       S01194
     C                     MOVELNACD      ADCD    1                       S01194
     C                     SETOF                     31                   S01194
     C                     CALL 'AOALTNR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           CUST                            S01194
     C                     PARM           ADCD                            S01194
     C           SDALTN    PARM SDALTN    DSFDY                           S01194
     C*                                                                   S01194
     C                     END                                            LN0007
     C** IF NO ALTERNATE N & A FOUND, USE SDCUSTPD N & A                  S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           NACD      OREQ 'B'                                       LN0007
     C                     MOVELCNUM      CLKY                            S01194
     C                     EXSR CLCHN                                     S01194
     C           *IN31     IFNE '1'                                       S01194
     C                     MOVE BBCNA1    CNA1                            S01194
     C                     MOVE BBCNA2    CNA2                            S01194
     C                     MOVE BBCNA3    CNA3                            S01194
     C                     MOVE BBCNA4    CNA4                            S01194
     C                     ELSE                                           S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVELCNUM      DBKEY                           S01194
     C                     MOVEL'04'      DBASE                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,LE0420C014
     C*                                                                   S01194
     C** IF ALTERNATE N & A FOUND, USE THAT TOWN                          S01194
     C                     ELSE                                           S01194
     C                     MOVELBCCRTN    CTWN                            S01194
     C                     END                                            S01194
0461 C***31*********       MOVE 'B'       CLKY                            S01194
0462 C***31*********       EXSR CLCHN                                     S01194
0463 C******31******       MOVEL'CLINT'   DBFILE                          S01194
0464 C******31******       MOVELCLKY      DBKEY                           S01194
0465 C******31******       MOVEL'04'      DBASE            ***************S01194
0466 C******31******       SETON                     U7U8  *  DBASE  04  *S01194
0467 C******31******       GOTO END                        ***************S01194
0468 C*  STORE NAME
0469 C                     MOVE CNA1      CST1   35
0470 C                     MOVE CNA2      CST2   35
0471 C                     MOVE CNA3      CST3   35
0472 C                     MOVE CNA4      CST4   35
     C                     MOVE CTWN      CTW1   10
     C                     MOVE CNUM      TELNUM  6
0473 C*
0474 C*  PICK UP BRANCH NAME IF REQUIRED
0475 C     N70             GOTO BY04
0476 C**************       MOVEL'10'      ZTABKY                          S01194
0477 C***********          MOVE BRCD      ZTABKY                          S01117
0478 C**************       EXSR TABCHN                                    S01194
     C**                                                                  S01194
     C**  ACCESS BRANCH CODES                                             S01194
     C**                                                                  S01194
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRCA      @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
     C         31          MOVEL'SDBRCHPD'DBFILE                          S01194
     C         31          MOVEL@DSNB     DBKEY                           S01194
0479 C         31          MOVEL'05'      DBASE            ***************
0480 C         31          SETON                     U7U8  *  DBASE  05  *
0481 C         31          GOTO END                        ***************
     C                     ENDIF                                                            CLE075BO
0482 C*
0483 C           BY04      TAG                             ** BY04 TAG **
0484 C*
0485 C*
0486 C***USE*CCY*CODE*TO*ACCESS*TABLE*FOR*CURRENCY DECIMAL PLACES         S01194
0486 C* USE CCY CODE TO ACCESS SDCURRPD FOR CURRENCY DECIMAL PLACES       S01194
0487 C**************       MOVEL'20'      ZTABKY                          S01194
0488 C**************       MOVELCCY       WK1     4                       S01194
0489 C**************       MOVE '1'       WK1                             S01194
0490 C**************       MOVE WK1       ZTABKY                          S01194
0491 C**************       EXSR TABCHN                                    S01194
     C                     Z-ADDCURARR    A                                                 CLE075BO
     C           WKCCY     LOKUP#CCY,A                   49                                 CLE075BO
     C           *IN49     IFEQ '1'                                                         CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C***********          PARM CCY       TKEY    3             S01194 A  CEU004
     C                     PARM WKCCY     TKEY    3        -Currency      CEU004
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
     C      31             MOVE 'SDCURRPD'DBFILE                          S01194
     C      31             MOVELCCY       DBKEY                           S01194
0492 C      31             MOVEL'06'      DBASE            ***************
0493 C      31             SETON                     U7U8  *  DBASE  06  *
0494 C      31             GOTO END                        ***************
     C                     ENDIF                                                            CLE075BO
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If SAR On      CEU004
     C           SCCY      ANDNE*BLANKS                    And Stl Ccy    CEU004
     C           SCCY      ANDNECCY                        Sett equal CCY 150931
     C           CLE031    ANDNE'Y'                                                           CLE031
     C                     MOVE PRAM      P@FRAM            Set From Amt  CEU004
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE WKAMT     WKPRAM 130        Set Prncpl AmtCEU004
      *                                                                   CEU004
     C                     MOVE INTA      P@FRAM            Set From Amt  CEU004
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE WKAMT     WKINTA 130        Set Intrst AmtCEU004
      *                                                                   CEU004
     C                     MOVE TAMT      P@FRAM            Set From Amt  CEU004
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE WKAMT     WKTAMT 130        Set Total Amt CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C                     MOVE PRAM      WKPRAM            Set Prncpl AmtCEU004
     C                     MOVE INTA      WKINTA            Set Intrst AmtCEU004
     C                     MOVE TAMT      WKTAMT            Set Total Amt CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C/COPY WNCPYSRC,LE0420C001
0495 C*
0496 C           CDP       COMP 1                      4041
0497 C           CDP       COMP 2                    43  42
      *                                                                                       CLE031
      ** Convert principal amount to settlement currency                                      CLE031
      ** if the transaction currency is different from                                        CLE031
      ** the settlement currency                                                              CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           SCCY      IFNE *BLANK                                                        CLE031
     C           SCCY      ANDNECCY                                                           CLE031
     C           PSCY      ORNE *BLANK                                                        CLE031
     C           PSCY      ANDNECCY                                                           CLE031
      *                                                                                       CLE031
      ** Initialise settlement printer fields                                                 CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANK    WPCCY   3                                           CLE031
     C                     MOVE *BLANK    WRCCY   3                                           CLE031
     C                     Z-ADD0         WPSAMT 130                                          CLE031
     C                     Z-ADD0         WRSAMT 130                                          CLE031
      *                                                                                       CLE031
      ** Check if loan is a parts sold                                                        CLE031
      *                                                                                       CLE031
     C                     MOVE 'N'       WPARTS  1                                           CLE031
     C           PTYP      IFEQ 66                                                            CLE031
     C           CLE005    OREQ 'Y'                                                           CLE031
     C           PTYP      ANDEQ69                                                            CLE031
     C                     MOVE 'Y'       WPARTS                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Access currency details file to get the in currency indicator                        CLE031
      ** and number of decimal places of the transaction currency                             CLE031
      ** receipt and payment currency                                                         CLE031
      *                                                                                       CLE031
     C                     MOVE CCY       WCURR   3                                           CLE031
     C                     EXSR SRCURR                                                        CLE031
      *                                                                                       CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDWNBDP     WTNBDP  20                                          CLE031
     C                     MOVE WINCY     WTINCY  1                                           CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           SCCY      IFNE *BLANK                                                        CLE031
     C                     MOVE SCCY      WCURR                                               CLE031
     C                     EXSR SRCURR                                                        CLE031
      *                                                                                       CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDWNBDP     WRNBDP  20                                          CLE031
     C                     MOVE WINCY     WRINCY  1                                           CLE031
     C           WRNBDP    COMP 1                      8081                                   CLE031
     C           WRNBDP    COMP 2                    83  82                                   CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PSCY      IFNE *BLANK                                                        CLE031
     C                     MOVE PSCY      WCURR                                               CLE031
     C                     EXSR SRCURR                                                        CLE031
      *                                                                                       CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDWNBDP     WPNBDP  20                                          CLE031
     C                     MOVE WINCY     WPINCY  1                                           CLE031
     C           WPNBDP    COMP 1                      8485                                   CLE031
     C           WPNBDP    COMP 2                    87  86                                   CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     SELEC                                                              CLE031
      *                                                                                       CLE031
      ** Principal Increase                                                                   CLE031
      *                                                                                       CLE031
     C           AMTP      WHEQ 'PI'                                                          CLE031
      *                                                                                       CLE031
     C                     Z-ADDPRAM      WPRAM  130                                          CLE031
      *                                                                                       CLE031
      ** If loan is not a parts sold, convert principal                                       CLE031
      ** amount to pay settlement currency                                                    CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'N'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WPINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'PE'      WCONV   2                                           CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'PS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE PSCY      WPSCY   3                                           CLE031
     C                     Z-ADDWSAMT     WPSAMT 130                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** If loan is a parts sold, convert principal                                           CLE031
      ** amount to receive settlement currency                                                CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WRINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'RE'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'RS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE SCCY      WRSCY   3                                           CLE031
     C                     Z-ADDWSAMT     WRSAMT 130                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Principal Repayment                                                                  CLE031
      *                                                                                       CLE031
     C           AMTP      WHEQ 'RE'                                                          CLE031
      *                                                                                       CLE031
     C                     Z-ADDTAMT      WPRAM                                               CLE031
      *                                                                                       CLE031
      ** If loan is not a parts sold, convert total                                           CLE031
      ** amount to receive settlement currency                                                CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'N'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WRINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'RE'      WCONV   2                                           CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'RS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE SCCY      WRSCY                                               CLE031
     C                     Z-ADDWSAMT     WRSAMT                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** If loan is a parts sold, convert total                                               CLE031
      ** amount to pay settlement currency                                                    CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WPINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'PE'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'PS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE PSCY      WPSCY                                               CLE031
     C                     Z-ADDWSAMT     WPSAMT                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSL                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
0498 C*
0499 C*  SET REQUIRED INDICATORS FOR SETTLEMENT INSTRUCTIONS
0500 C*  ALSO ACCESS REQUIRED CUSTOMER DETAILS
0501 C                     EXSR SETINS
0502 C   U7 U8             GOTO END
0503 C*
0504 C*  USE ZDATE2 TO CONVERT VALUE DAYNO TO DATE FORMAT
0505 C                     MOVE VDAT      ZDAYNO
0506 C                     EXSR ZDATE2
0507 C                     MOVE ZADATE    OVDAT   7
     C/COPY WNCPYSRC,LE0420C011
0508 C*
     C*  ARRANGE DATES INTO DDMMYY FORMAT FOR OUTPUT TO TELEX FILE
     C*
     C                     MOVE ZYEAR     ZWRK4
     C                     MOVELZMTH      ZWRK4
     C                     MOVE ZWRK4     TXDATE  60
     C                     MOVELZDAY      TXDATE
     C*
0509 C*  CHECK FOR NEGATIVES ON RE.
0510 C        N21          GOTO FIN
0511 C           INTA      COMP 0                      44
0512 C           TAMT      COMP 0                      45
0513 C           FIN       TAG                             ** FIN TAG **
0514 C*
0515 C*  MAINTAIN FILE CONTROLS
0516 C           RECTOT    ADD  1         RECTOT  60
     C   U4 39   RECXTO    ADD  1         RECXTO
0517 C*
0518 C           END       TAG                             ** END TAG **
0519 C      U7 U8          SETON                     LR
0520 C*
0521 CLR U7 U8             GOTO LREND
0522 C** CHECK CONTROLS
0523 CLR         RECTOT    COMP NORE                 7171
0524 CLR 71                SETON                     U8
0524 CLR         TOTLX     COMP 0                    72
0525 CLR         LREND     TAG                             ** LREND TAG **
     C**                                                                  S01117
     C*   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C*    ERROR OCCUR WHILE DURING ZSFILE PROCESSING, RETURN TO          S01117
     C*    CALLING PROGRAM                                                S01117
     C**                                                                  S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*     EXCUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                 S01117
     C**                                                                  S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0526 C********************************************************************
0527 C*                 SUBROUTINES                                      *
0528 C********************************************************************
0529 C**************                                                      S01194
0530 C****-*TABCHN*- ACCESS TABLE FILE FOR GIVEN RECORDS                  S01194
0531 C************** KEY - ZTABKY                                         S01194
0532 C************** ERROR - IND 31 SET                                   S01194
0533 C******CALLED*DURING FIRST CYCLE AND SUBSEQUENT CYCLE CALCS.         S01194
0534 C**************                                                      S01194
0535 C***********TABCHN    BEGSR                           ** TABCH BEGSR*S01194
0536 C**************       SETOF                     31                   S01194
0537 C**************                                                      S01194
0538 C***********ZTABKY    CHAINTABLE                31                   S01194
0539 C*****N31***RECI      COMP 'D'                  3131                 S01194
0540 C******31******       MOVEL'TABLE'   DBFILE                          S01194
0541 C******31******       MOVELZTABKY    DBKEY                           S01194
0542 C**************                                                      S01194
0543 C***AFTER*FIRST CYCLE BLANK OUT KEY AFTER CHAIN                      S01194
0544 C*****N01******       MOVE '        'ZTABKY                          S01194
0545 C*****N01******       MOVEL'    '    ZTABKY                          S01194
0546 C**************                                                      S01194
0547 C**************       ENDSR                           ** ENDSR **    S01194
0548 C**************                                                      S01194
0549 C********************************************************************
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SRCURR - Access Currency Details File                        *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCURR    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     Z-ADD0         WNBDP   20                                          CLE031
     C                     MOVE *BLANK    WINCY   1                                           CLE031
      *                                                                                       CLE031
     C                     Z-ADDCURARR    A                                                 CLE075BO
     C           WCURR     LOKUP#CCY,A                   49                                 CLE075BO
     C           *IN49     IFEQ '1'                                                         CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM '*KEY   ' POPTN                                               CLE031
     C                     PARM WCURR     PCURR   3                                           CLE031
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANK                                                        CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INU8                                               CLE031
     C                     MOVEL'SDCURRPD'DBFILE                                              CLE031
     C                     MOVELPCURR     DBKEY                                               CLE031
     C                     Z-ADD26        DBASE                                               CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                            CLE075BO
      *                                                                                       CLE031
     C                     Z-ADDCDP       WNBDP                                               CLE031
     C                     MOVE A6INCY    WINCY                                               CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *****************************************************************                       CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SRCONV - Convert to setttlement currency                     *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCONV    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     Z-ADD0         WSAMT  150                                          CLE031
     C                     Z-ADD0         ZAMTCO 150                                          CLE031
      *                                                                                       CLE031
     C                     SELEC                                                              CLE031
      *                                                                                       CLE031
     C           WCONV     WHEQ 'RS'                                                          CLE031
     C           WCONV     OREQ 'PS'                                                          CLE031
     C                     Z-ADDWPRAM     ZAMTCI 150                                          CLE031
     C                     MOVE CCY       ZCCYI   3                                           CLE031
     C                     Z-ADDWTNBDP    ZCDPI   10                                          CLE031
     C           WCONV     IFEQ 'PS'                                                          CLE031
     C                     Z-ADDPEXR      ZEXCH  138                                          CLE031
     C                     MOVE PEXI      ZMD     1                                           CLE031
     C                     MOVE PSCY      ZCCYO   3                                           CLE031
     C                     Z-ADDWPNBDP    ZCDPO   10                                          CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDREXR      ZEXCH                                               CLE031
     C                     MOVE REXI      ZMD                                                 CLE031
     C                     MOVE SCCY      ZCCYO                                               CLE031
     C                     Z-ADDWRNBDP    ZCDPO                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WSAMT                                               CLE031
      *                                                                                       CLE031
     C           WCONV     WHEQ 'RE'                                                          CLE031
     C           WCONV     OREQ 'PE'                                                          CLE031
     C                     Z-ADD0         P@FRAM                                              CLE031
     C                     MOVE WPRAM     P@FRAM                                              CLE031
     C                     MOVE CCY       P@FRCY                                              CLE031
     C           WCONV     IFEQ 'PE'                                                          CLE031
     C                     MOVE PSCY      P@TOCY                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE SCCY      P@TOCY                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     CALL 'EU0200'                                                      CLE031
     C                     PARM *BLANK    P@RTCD                                              CLE031
     C                     PARM           P@FRAM                                              CLE031
     C                     PARM           P@FRCY                                              CLE031
     C                     PARM           P@TOCY                                              CLE031
     C                     PARM           P@OUTA                                              CLE031
     C                     PARM           P@INTA                                              CLE031
     C                     PARM           P@EXRT                                              CLE031
     C                     PARM           P@MDIN                                              CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANK                                                        CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INU8                                               CLE031
     C                     MOVEL'EU0200  'DBFILE                                              CLE031
     C                     MOVELCCY       DBKEY                                               CLE031
     C                     Z-ADD27        DBASE                                               CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSL                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
0550 C********************************************************************
0551 C***
0552 C****  SUBROUTINE CLCHN
0553 C*     TO ACCESS CLINT FILE. AND DETECT & REPORT DATA BASE ERRORS
0554 C*     CALLED DURING SETTLEMENT INSTRUCTION FORMATTING BY SUBROUTINE
0555 C*     SETINS. ALSO CALLED DURING MAIN CYCLE PROCESSING
0556 C*
0557 C           CLCHN     BEGSR                           ** CLCHN.SR  **
0558 C                     SETOF                     31
0559 C***********CLKY      CHAINCLINT                31                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CLKY                            S01194
     C                     PARM *BLANKS   KEYSTS  7                       S01194
     C***********          PARM SDCUST    DSSDY                     S01194BHF145
     C           SDCUST    PARM SDCUST    DSSDY                           BHF145
0560 C*****N31***RECI      COMP 'D'                  3131                 S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
0561 C*
0562 C*
0563 C                     ENDSR                           ** ENDSR     **
0564 C********************************************************************
0565 C********************************************************************
0566 C**  SUBROUTINE - SETOF. THIS SUBROUTINE SETS OFF ALL RESULTING
0567 C*             INDICATORS AT START OF MAIN CYCLE PROCESSING
0568 C*
0569 C           SETOF     BEGSR                           ** SETOF.SR  **
0570 C                     SETOF                     202133
0571 C                     SETOF                     323436
0572 C                     SETOF                     375051
0573 C                     SETOF                     525354
0574 C                     SETOF                     555725
0575 C                     SETOF                     585944
0576 C                     SETOF                     4524
     C                     SETOF                     47
0577 C                     SETOF                     1819
     C   U4                SETOF                     3839
     C                     SETOF                     2729
     C                     SETOF                     1314                 CLE004
     C                     SETOF                     1617                 CLE004
0578 C*
0579 C                     ENDSR                           ** ENDSR     **
0580 C********************************************************************
0581 C********************************************************************
0582 C***
0583 C*  SETINS -  SUBROUTINE TO CHECK SETTLEMENT INSTRUCTION
0584 C*            FOR OUTPUT
0585 C** CALLED DURING MAIN PROCESSING
0586 C*
0587 C           SETINS    BEGSR                           ** SETINS-SR **
0588 C           SETP      COMP '  '                     50
0589 C      50             MOVE '00'      SETP
0590 C      50             GOTO SETEND
0591 C           SETP      COMP '00'                     50
0592 C         50          GOTO SETEND
0593 C           SETP      COMP '02'                     52
0594 C         52          GOTO SETEND
0595 C           SETP      COMP '03'                     53
0596 C         53          GOTO SETEND
0597 C           SETP      COMP '05'                     55
0598 C         55          GOTO SETEND
0599 C           SETP      COMP '06'                     53
0600 C         53          GOTO SETEND
0601 C           SETP      COMP '12'                     57
0602 C         57          GOTO SETEND
0603 C           SETP      COMP '14'                     58
0604 C         58          GOTO SETEND
0605 C           SETP      COMP '04'                     54
0606 C         54          GOTO SET04
      *                                                                   CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           SETP      ANDEQ'09'                                      CLE033
     C                     MOVE *ON       *IN49                           CLE033
     C                     ELSE                                           CLE033
0607 C                     SETON                         51
0608 C** 51 ON.THEREFORE SETTLEMENT = 01,07,08
     C                     ENDIF                                          CLE033
0609 C*
0610 C      50             GOTO SETEND
0611 C*
0612 C*  PICK UP OUR NOSTRO DETAILS
     C*                                                                   E39524
     C** IF THE SETTLEMENT DETAILS FIELD FOR OUR NOSTRO IS BLANK          E39524
     C** SUPPRESS THE WRITE TO LENXTAB. HENCE NO MESSAGE WILL BE          E39524
     C** PRODUCED.                                                        E39524
     C*                                                                   E39524
     C           *IN22     IFEQ '1'                                       E39524
     C           AMTP      ANDNE'RE'                                      182229
     C                     MOVE '0'       *IN39                           E39524
     C                     END                                            E39524
     C*                                                                   E39524
0613 C      22             GOTO THRS
0614 C                     MOVELOSAC      OUR     2
0615 C**************       MOVEL'70'      ZTABKY                          S01194
0616 C**************       MOVELCCY       WK2     5                       S01194
0617 C**************       MOVE OUR       WK2                             S01194
0618 C**************       MOVE WK2       ZTABKY                          S01194
0619 C**************       EXSR TABCHN                                    S01194
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C                     SELEC                                                              CLE031
     C           WPARTS    WHEQ 'N'                                                           CLE031
     C           AMTP      ANDEQ'PI'                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE PSCY      WKCCY2  3                                           CLE031
     C           WPARTS    WHEQ 'Y'                                                           CLE031
     C           AMTP      ANDEQ'PI'                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE SCCY      WKCCY2                                              CLE031
     C           WPARTS    WHEQ 'N'                                                           CLE031
     C           AMTP      ANDEQ'RE'                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE SCCY      WKCCY2                                              CLE031
     C           WPARTS    WHEQ 'Y'                                                           CLE031
     C           AMTP      ANDEQ'RE'                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE PSCY      WKCCY2                                              CLE031
     C                     OTHER                                                              CLE031
     C                     MOVE CCY       WKCCY2                                              CLE031
     C                     ENDSL                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE CCY       WKCCY2                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVELWKCCY2    KEYNOS                                            CLE075BO
     C                     MOVE OUR       KEYNOS                                            CLE075BO
     C                     ADD  1         NOSSEQ                                            CLE075BO
     C                     EXSR CHKNOS                                                      CLE075BO
      *                                                                                     CLE075BO
      ** Use details from array if KEYNOS is found, otherwise,                              CLE075BO
      ** retrieve details from program call                                                 CLE075BO
      *                                                                                     CLE075BO
     C           NOSIC     IFEQ 'Y'                                                         CLE075BO
      *                                                                                     CLE075BO
      ** Set occurence to index found from #NSK array                                       CLE075BO
      *                                                                                     CLE075BO
     C           F         OCUR SDNOST                                                      CLE075BO
      *                                                                                     CLE075BO
     C                     ELSE                                                             CLE075BO
      *                                                                                     CLE075BO
     C           NOSIDX    IFNE 0                                                           CLE075BO
     C                     Z-ADDNOSIDX    F                                                 CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     Z-ADD1         F                                                 CLE075BO
     C                     MOVEA#NOS      #NSS                                              CLE075BO
     C                     SORTA#NSS                                                        CLE075BO
     C                     Z-ADD#NSS,1    NOSKEY                                            CLE075BO
     C           NOSKEY    LOKUP#NOS,F                   76                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C           F         OCUR SDNOST                                                      CLE075BO
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @KEYA   6                       S01194
     C***********          PARM CCY       @KEYB   3                S01194 CEU004
     C**********           PARM WKCCY     @KEYB   3        -Currency                   CEU004 CLE031
     C                     PARM WKCCY2    @KEYB   3                                           CLE031
     C**********           PARM *BLANKS   @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01194
     C                     PARM OUR       @KEYE   2                       S01194
     C                     PARM *BLANKS   @BRCD   3                       S01194
     C                     PARM *BLANKS   @CSSN  10                       S01194
     C                     PARM *BLANKS   @PNOI   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C***********@RTCD     IFEQ *BLANKS                             S01194BHF038
     C           @RTCD     IFNE *BLANKS                                   BHF038
     C                     SETON                     31                   S01194
     C                     END                                            S01194
     C         31          MOVE 'SDNOSTPD'DBFILE                          S01194
     C         31          MOVELCCY       WK2     5                       S01194
     C         31          MOVE OUR       WK2                             S01194
     C         31          MOVELWK2       DBKEY                           S01194
0620 C         31          MOVEL'07'      DBASE            ***************
0621 C         31          SETON                     U7U8  *  DBASE  07  *
0622 C         31          GOTO SETEND                     ***************
0623 C***USE*CUSTOMER*NUMBER*FROM*NOSTRO*REC*TO*ACCESS*CLINT              S01194
0623 C*  USE CUSTOMER NUMBER FROM NOSTRO REC TO ACCESS SDCUSTPD           S01194
0624 C**************       MOVELCNUM      CLKY                            S01194
0625 C**************       MOVE 'B'       CLKY                            S01194
0624 C                     MOVELA7CUST    CLKY                            S01194
     C                     EXSR ADDNOS                                                      CLE075BO
     C                     ENDIF                                                            CLE075BO
0626 C                     EXSR CLCHN
0627 C      31             MOVELCLKY      DBKEY
0628 C******31******       MOVEL'CLINT'   DBFILE                          S01194
0628 C      31             MOVEL'SDCUSTPD'DBFILE                          S01194
0629 C         31          MOVE '08'      DBASE            ***************
0630 C         31          SETON                     U7U8  *  DBASE  08  *
0631 C         31          GOTO SETEND                     ***************
0632 C*  STORE NAME
0633 C**************       MOVELCNA1      CN2    35                       S01194
0633 C                     MOVELBBCNA1    CN2    35                       S01194
0634 C                     MOVELCTWN      CT2    20
0635 C           THRS      TAG                             ** THRS TAG **
     C*                                                                   E39524
     C** IF THE SETTLEMENT DETAILS FIELD FOR THEIR NOSTRO IS BLANK        E39524
     C** SUPPRESS THE WRITE TO LENXTAB. HENCE NO MESSAGE WILL BE          E39524
     C** PRODUCED                                                         E39524
     C*                                                                   E39524
     C           *IN23     IFEQ '1'                                       E39524
     C           AMTP      ANDNE'RE'                                      182229
     C                     MOVE '0'       *IN39                           E39524
     C                     END                                            E39524
     C*                                                                   E39524
0636 C      23             GOTO SBY1
0637 C*
0638 C*  DETERMINE IF 'THEIRS' IS A COUNTERPARTY NOSTRO OR CUST.NO.
0639 C                     MOVE TSEN      WRK4    4
0640 C           WRK4      COMP '    '               4646
     C*
     C*  IF LAST 4 CHARACTERS BLANK, CHECK IF FIRST 6 NUMERIC
     C**N46******          MOVELTSEN      WRK6    6                                           CSD027
     C**N46******          MOVE WRK6      NUM6    60                                          CSD027
     C**N46******          MOVE NUM6      WRK6X   6                                           CSD027
     C**N46******WRK6      COMP WRK6X                4646                                     CSD027
     C           *IN46     IFEQ *OFF                                                          CSD027
     C                     MOVELTSEN      WRK6    6                                           CSD027
     C                     CALL 'AOCUSTR0'                                                    CSD027
     C                     PARM '*MSG   ' @RTCD                                               CSD027
     C                     PARM '*KEY   ' @OPTN                                               CSD027
     C                     PARM           WRK6                                                CSD027
     C                     PARM *BLANKS   KEYSTS  7                                           CSD027
     C           SDCUST    PARM SDCUST    DSSDY                                               CSD027
     C           @RTCD     IFNE '*CNUM  '                                                     CSD027
     C                     SETON                     46                                       CSD027
     C                     END                                                                CSD027
     C                     END                                                                CSD027
     C*
     C*  IF LAST 4 CHARS NON-BLANK, OR FIRST 6 NOT NUMERIC, C-PTY NOSTRO
0641 C      46             GOTO CPNS1
0643 C                     MOVELWRK6      CLKY
0644 C**************       MOVE 'B'       CLKY                            S01194
0645 C                     EXSR CLCHN
0646 C********N31***       MOVELCNA1      CN3    35                       S01194
0646 C        N31          MOVELBBCNA1    CN3    35                       S01194
0647 C        N31          MOVELCTWN      CT3    20
0648 C        N31          GOTO SBY1
0654 C           CPNS1     TAG
0655 C           SETP      COMP '01'                     59
0656 C        N59          GOTO SBY1
0657 C                     MOVELTSEN      WRK8    8
0658 C**************       MOVEL'71'      ZTABKY                          S01194
0659 C**************       MOVE WRK8      ZTABKY                          S01194
0660 C**************       EXSR TABCHN                                    S01194
     C                     CALL 'AOCNSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM WRK8      ARCD    8                       S01194
     C           SDCNST    PARM SDCNST    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
0661 C        N31          MOVELCPNM      CN3    35
0662 C        N31          MOVELCPTN      CT3    20
0663 C******31******       MOVELZTABKY    DBKEY                           S01194
0664 C******31******       MOVEL'TABLE'   DBFILE                          S01194
0663 C      31             MOVELWRK8      DBKEY                           S01194
0664 C      31             MOVEL'SDCNSTPD'DBFILE                          S01194
0665 C      31             MOVEL'10'      DBASE            ** DBASE 10 ***
0666 C      31             SETON                     U7U8
0667 C      31             GOTO SETEND
0668 C*
0669 C*
0670 C           SBY1      TAG                             ** SBY1 TAG **
     C*
     C**   CHECK BENIFICIARY BANK DETAILS
     C*
     C**   IGNORE IF FIRST LINE OF SPECIAL INSTRUCTIONS IS BLANK
     C   28                GOTO BENEND
     C*
     C           SPEC5     COMP '/BEN/'              272729
     C   27                GOTO BENEND
     C*
     C**   CHECK FOR CHIPS NUMBER
     C           SPEC8     COMP '/CH'                    27
     C   27                MOVE SPEC14    WORK6   6
     C   27                MOVE *BLANKS   SPI1
     C   27                MOVE 'CHIPS'   SPEC5
     C   27                MOVE WORK6     SPEC12
     C   27                GOTO BENEND
     C*
     C**   CHECK FOR FED. WIRE NUMBER
     C           SPEC8     COMP '/FW'                    27
     C   27                MOVE SPEC17    WORK9   9
     C   27                MOVE *BLANKS   SPI1
     C   27                MOVE 'FED.WIRE'SPEC9
     C   27                MOVE WORK9     SPEC18
     C   27                GOTO BENEND
     C*
     C**   MUST NOW BE 'ACCOUNT'
     C                     MOVE SPEC30    WORK25 25
     C                     MOVE *BLANKS   SPI1
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK25    SPEC29
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
0671 C      26             GOTO SETEND
0672 C*
0673 C*  IF PAYMENT PICK UP FOR ACC. DETAILS
0674 C   32
0675 C*****
0676 COR 34                GOTO SETEND
0677 C                     MOVE FACO      WRK4
0678 C           WRK4      COMP '    '               4646
0679 C      46             GOTO CPNS2
0680 C                     MOVELFACO      WRK6
0681 C                     MOVELWRK6      CLKY
0682 C**************       MOVE 'B'       CLKY                            S01194
0683 C                     EXSR CLCHN
0684 C*****N31******       MOVELCNA1      CN4    35                       S01194
0684 C     N31             MOVELBBCNA1    CN4    35                       S01194
0685 C     N31             MOVELCTWN      CT4    20
0686 C     N31             GOTO SETEND
0687 C      31             MOVELCLKY      DBKEY
0688 C******31******       MOVEL'CLINT'   DBFILE                          S01194
0688 C      31             MOVEL'SDCUSTPD'DBFILE                          S01194
0689 C      31             MOVEL'11'      DBASE            ** DBASE 11 ***
0690 C      31             SETON                     U7U8
0691 C      31             GOTO SETEND
0692 C           CPNS2     TAG
0693 C           SETP      COMP '01'                     59
0694 C     N59             GOTO SETEND
0695 C                     MOVELFACO      WRK8
0696 C**************       MOVEL'71'      ZTABKY                          S01194
0697 C**************       MOVE WRK8      ZTABKY                          S01194
0698 C**************       EXSR TABCHN                                    S01194
     C                     CALL 'AOCNSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM WRK8      ARCD                            S01194
     C           SDCNST    PARM SDCNST    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     31                   S01194
     C                     END                                            S01194
0699 C        N31          MOVELCPNM      CN4    35
0700 C        N31          MOVELCPTN      CT4    20
0701 C******31******       MOVELZTABKY    DBKEY                           S01194
0702 C******31******       MOVEL'TABLE'   DBFILE                          S01194
     C      31             MOVELWRK8      DBKEY                           S01194
     C      31             MOVEL'SDCNSTPD'DBFILE                          S01194
0703 C      31             MOVEL'12'      DBASE            ** DBASE 12 ***
0704 C      31             SETON                     U7U8
0705 C                     GOTO SETEND
0706 C           SET04     TAG                             ** SET04 TAG **
0707 C                     MOVE OSAC      OUT04   60
0708 C*
0709 C           SETEND    TAG                             ** SETEND TAG *
0710 C*
0711 C*
0712 C                     ENDSR                           ** ENDSR     **
0713 C********************************************************************
0714 C********************************************************************
0715 C**
0716 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0717 C**
0718 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0719 C**************                                                      S01194
0720 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0721 C**************       MOVEL'01      'ZTABKY 12                       S01194
0722 C**************       MOVE '  10'    ZTABKY                          S01194
0723 C**************                                                      S01194
0724 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0725 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 01  *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDZSY                                    S01194
     C                     END                                            S01194
0726 C**
0727 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0728 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0728 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
      *                                                                   CLE004
      ** Check if CLE004 is switched on                                   CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*KEY   ' @OPTN                           CLE004
     C                     PARM 'CLE004'  PSARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
     C*                                                                   CLE004
     C** Error Processing                                                 CLE004
     C*                                                                   CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       CLE004                          CLE004
     C           @RTCD     IFNE '*NRF    '                                CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     SETON                     99                   CLE004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE004
     C                     MOVEL'CLE004'  DBKEY            * DBERR 20 *   CLE004
     C                     Z-ADD20        DBASE            ************   CLE004
     C                     EXSR *PSSR                                     CLE004
     C                     GOTO ENDZSY                                    CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE005
      ** Check if CLE005 is switched on                                   CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY   ' @OPTN                           CLE005
     C                     PARM 'CLE005'  PSARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C*                                                                   CLE005
     C** Error Processing                                                 CLE005
     C*                                                                   CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF    '                                CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     SETON                     99                   CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     MOVEL'CLE005'  DBKEY            * DBERR 22 *   CLE005
     C                     Z-ADD22        DBASE            ************   CLE005
     C                     EXSR *PSSR                                     CLE005
     C                     GOTO ENDZSY                                    CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE004
     C                     MOVE *BLANK    WOPN1                           CLE004
     C                     MOVE *BLANK    WOPN2                           CLE004
0729 C**
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004           Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANK                     If Found       CEU004
     C                     MOVE 'Y'       CEU004  1         Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD23        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     SETON                     99      Set Ind      CEU004
     C                     EXSR *PSSR                        Dump         CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
     C/COPY WNCPYSRC,LE0420C016
      *                                                                   CLE033
      ** Check if CLE033 is switched on                                   CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*KEY   ' @OPTN                           CLE033
     C                     PARM 'CLE033'  PSARD                           CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
     C*                                                                   CLE033
     C** Error Processing                                                 CLE033
     C*                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
     C           @RTCD     IFNE '*NRF    '                                CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     SETON                     99                   CLE033
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE033
     C                     MOVEL'CLE033'  DBKEY            * DBERR 24 *   CLE033
     C                     Z-ADD24        DBASE            ************   CLE033
     C                     EXSR *PSSR                                     CLE033
     C                     GOTO ENDZSY                                    CLE033
     C                     ENDIF                                          CLE033
     C                     ENDIF                                          CLE033
      *                                                                                       CLE031
      ** Check if CLE031 is switched on                                                       CLE031
      *                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   PRTCD   7                                           CLE031
     C                     PARM '*KEY   ' POPTN   7                                           CLE031
     C                     PARM 'CLE031'  PSARD                                               CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
      *                                                                                       CLE031
      ** Error Processing                                                                     CLE031
      *                                                                                       CLE031
     C           PRTCD     IFEQ *BLANKS                                                       CLE031
     C                     MOVE *ON       *IN49                                               CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE *OFF      *IN49                                               CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
     C           PRTCD     IFNE '*NRF    '                                                    CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INU8                                               CLE031
     C                     MOVE *ON       *INLR                                               CLE031
     C                     MOVE *ON       *IN99                                               CLE031
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE031
     C                     MOVEL'CLE031'  DBKEY                                               CLE031
     C                     Z-ADD25        DBASE                                               CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     GOTO ENDZSY                                                        CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CEU004
0730 C**************       ENDSR                                          S01194
     C           ENDZSY    ENDSR                                          S01194
0731 C**
0732 C**
      *****************************************************************   BH2600
      ****ROUT*-*determine*message*routing*************************BH2600 CSW096
      ****Called*by*-*main*process*********************************BH2600 CSW096
      ****Calls*-*NWAD*determine*default*network*addresses*********BH2600 CSW096
      ************PRAD*determine*priority*network*addresses********BH2600 CSW096
      *************************************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********ROUT      BEGSR                                   BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ***Access*branch*details*with*Branch*code*of*sender.*********BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          CALL 'AOBRCHR0'                         BH2600 CSW096
     C***********          PARM '*MSG   ' @RTCD                    BH2600 CSW096
     C***********          PARM '*KEY   ' @OPTN                    BH2600 CSW096
     C***********          PARM @DSNB     @BRCD   3                BH2600 CSW096
     C***********SDBRCH    PARM SDBRCH    DSSDY                    BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ***Branch*record*not*found*-*Error***************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********@RTCD     IFNE *BLANKS                            BH2600 CSW096
     C***********          MOVE '31'      DBASE              * * * BH2600 CSW096
     C***********          MOVEL@DSNB     DBKEY              * DBERBH2600 CSW096
     C***********          MOVEL'SDBRCHPD'DBFILE             * * * BH2600 CSW096
     C***********          EXSR *PSSR                              BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
      *****save*branch*internal*customer*number*&*SWIFT*TID*addressBH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          MOVELA8BICN    SECN    60               BH2600 CSW096
     C***********          MOVE A8BTID    SCSID  12                BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Access*SDCUSTPD*using*branch*internal*customer*number****BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          MOVE *BLANKS   @KEY1                    BH2600 CSW096
     C***********          MOVELSECN      @KEY1                    BH2600 CSW096
     C***********          CALL 'AOCUSTR0'                         BH2600 CSW096
     C***********          PARM '*MSG   ' @RTCD                    BH2600 CSW096
     C***********          PARM '*KEY   ' @OPTN                    BH2600 CSW096
     C***********          PARM           @KEY1  10                BH2600 CSW096
     C***********          PARM *BLANKS   @KYST   7                BH2600 CSW096
     C***********@CUST     PARM @CUST     DSSDY                    BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ***Customer*record*not*found*-*Error*************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********@RTCD     IFNE *BLANKS                            BH2600 CSW096
     C***********          MOVE '32'      DBASE              * * * BH2600 CSW096
     C***********          MOVEL@KEY1     DBKEY              * DBERBH2600 CSW096
     C***********          MOVEL'SDCUSTPD'DBFILE             * * * BH2600 CSW096
     C***********          EXSR *PSSR                              BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Save*sender's*addresses*&*parent*customer*number*********BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          MOVE TELX      @TELX  12                BH2600 CSW096
     C***********          MOVE BBSTAD    @STTX  12                BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Access*SDCUSTPD*using*destination*customer*number********BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          MOVE *BLANKS   @KEY1                    BH2600 CSW096
     C***********          MOVEL@CUST     @KEY1                    BH2600 CSW096
     C***********          CALL 'AOCUSTR0'                         BH2600 CSW096
     C***********          PARM '*MSG   ' @RTCD                    BH2600 CSW096
     C***********          PARM '*KEY   ' @OPTN                    BH2600 CSW096
     C***********          PARM           @KEY1  10                BH2600 CSW096
     C***********          PARM *BLANKS   @KYST   7                BH2600 CSW096
     C***********@CUST     PARM @CUST     DSSDY                    BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Determine*the*routing*to*the*destination*customer.*******BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********BBDNW3    IFNE *BLANKS                            BH2600 CSW096
     C***********          EXSR NWAD                               BH2600 CSW096
     C***********          ELSE                                    BH2600 CSW096
     C***********          EXSR PRAD                               BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          ENDSR                                   BH2600 CSW096
     C/EJECT                                                              BH2600
      *****************************************************************   CSW096
      *   SRROUT - determine message routing                          *   CSW096
      *   Called by - CONF                                            *   CSW096
      *   Calls -                                                     *   CSW096
      *****************************************************************   CSW096
      *                                                                   CSW096
     C           SRROUT    BEGSR                                          CSW096
      *                                                                   CSW096
     C                     MOVELBRCA      I@SNBR                          CSW096
     C                     MOVELCNUM      I@DSCN                          CSW096
     C                     MOVEL*BLANKS   I@MTPY                          CSW096
     C                     Z-ADD0         I@SETT                          CSW096
     C                     MOVEL'Y'       I@CONC                          CSW096
     C                     MOVEL*BLANK    I@FTCS                          CSW096
      *                                                                   CSW096
     C                     CALL 'MG9900'                                  CSW096
     C                     PARM *BLANKS   @RTCD                           CSW096
     C                     PARM           P@IN                            CSW096
     C                     PARM *BLANKS   P@OUT                           CSW096
     C                     PARM           P@ZZ  256                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFNE *BLANKS                                   CSW096
     C                     MOVEL'MG9900  'DBFILE           ***************CSW096
     C                     MOVEL'*CALL'   DBKEY            * DBERROR 92  *CSW096
     C                     MOVEL'092'     DBASE            ***************CSW096
     C                     SETON                     U7U8LR               CSW096
     C                     EXSR *PSSR                                     CSW096
     C                     ELSE                                           CSW096
     C                     Z-ADDO@CNSN    SECN    60                      CSW096
     C                     MOVELO@SWSN    SCSID  12                       CSW096
     C                     MOVELO@NWRK    @NWRK   6                       CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C                     ENDSR                                          CSW096
     C/EJECT                                                              CSW096
     C           XCAMT     BEGSR                                          CEU004
      *===================================================================CEU004
      * XCAMT: Convert Amount.                                            CEU004
      *                                                                   CEU004
      *                                                                   CEU004
      ** Convert Transaction Amount into Settlement Amount.               CEU004
      *                                                                   CEU004
      *                                                                   CEU004
     C                     MOVE *BLANKS   WKAMT  150       Clr Input      CEU004
      *                                                                   CEU004
     C                     CALL 'EU0200'                   Cvrt Amount    CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' P@RTCD  7        -Return Code   CEU004
     C                     PARM           P@FRAM 183       -FROM Ccy Amt  CEU004
     C                     PARM CCY       P@FRCY  3        -FROM Currency CEU004
     C                     PARM SCCY      P@TOCY  3        -TO Currency   CEU004
      *                                                    Output:        CEU004
     C           WKAMT     PARM           P@OUTA 150       -Outright Amt  CEU004
     C                     PARM           P@INTA 183       -Interim AmountCEU004
     C                     PARM           P@EXRT 159       -Exchange Rate CEU004
     C                     PARM           P@MDIN  1        -Mult/Div Ind. CEU004
      *                                                                   CEU004
     C           P@RTCD    IFNE *BLANK                     If Error       CEU004
     C                     MOVE 'EU0200  'DBFILE            Set File      CEU004
     C                     MOVELCCY       DBKEY     P       Set Key       CEU004
     C                     MOVEL'90'      DBASE             Set Ref       CEU004
     C                     SETON                     U7U8   Set Inds      CEU004
     C                     GOTO END                         Bypass to End CEU004
     C                     ENDIF                           End If         CEU004
      *===================================================================CEU004
     C                     ENDSR                                          CEU004
      *************************************************************BH2600 CSW096
      ****NWAD*-*determine*default*network*addresses***************BH2600 CSW096
      ****Called*by*-*ROUT*determine*message*routing***************BH2600 CSW096
      *************************************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********NWAD      BEGSR                                   BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Default*is*SWIFT*****************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********BBDNW3    IFEQ 'SWIFT'                            BH2600 CSW096
     C***********CSID      ANDNE*BLANKS                            BH2600 CSW096
     C***********@BIC      ANDNE'BIC'                              BH2600 CSW096
     C***********BGMSDL    ANDEQ'Y'                                BH2600 CSW096
     C***********SCSID     ANDNE*BLANKS                            086977 CSW096
     C***********          MOVELBBDNW3    @NWRK   6                BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Default*is*TELEX*****************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********BBDNW3    IFEQ 'TELEX'                            BH2600 CSW096
     C***********TELX      ANDNE*BLANKS                            BH2600 CSW096
     C***********TLXM      ANDEQ'Y'                                BH2600 CSW096
     C***********          MOVE BBDNW3    @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Default*is*STTX******************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********BBDNW3    IFEQ 'STTX'                             BH2600 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            BH2600 CSW096
     C***********BGMSDL    ANDEQ'Y'                                BH2600 CSW096
     C***********          MOVE BBDNW3    @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Default*is*PAPER*****************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********BBDNW3    IFEQ 'PAPER'                            BH2600 CSW096
     C***********          MOVE BBDNW3    @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Found*to*be*unroutable***********************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********@NWRK     IFEQ *BLANKS                            BH2600 CSW096
     C***********          MOVEL'UNROUT'  @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          ENDSR                                   BH2600 CSW096
     C*/EJECT****                                                  BH2600 CSW096
      *************************************************************BH2600 CSW096
      ****PRAD*-*determine*priority*network*addresses**************BH2600 CSW096
      ****Called*by**ROUT***determine*message*routing**************BH2600 CSW096
      ****Calls******TXROUT*priority*routing*to*STTX/Telex*********BH2600 CSW096
      ***************SWROUT*priority*routing*to*SWIFT**************BH2600 CSW096
      *************************************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********PRAD      BEGSR                                   BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****If*STTX/Telex*has*higher*priority*than*SWIFT*attempt*****BH2600 CSW096
      ****STTX/Telex*routing*first,*followed*by*SWIFT.*(nb.*'HigherBH2600 CSW096
      ****priority*is*numerically*lower*ie.*'1'*is*higher*than*'2')BH2600 CSW096
     C***********BLTXPY    IFLT BLSWPY                             BH2600 CSW096
     C***********          EXSR TXROUT                             BH2600 CSW096
     C***********          EXSR SWROUT                             BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****otherwise*attempt*SWIFT*routing*first********************BH2600 CSW096
     C***********          ELSE                                    BH2600 CSW096
     C***********          EXSR SWROUT                             BH2600 CSW096
     C***********          EXSR TXROUT                             BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****If*failed*to*route*to*electronic*network,*produce*paper**BH2600 CSW096
     C***********@NWRK     IFEQ *BLANKS                            BH2600 CSW096
     C***********          MOVEL'PAPER'   @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          ENDSR                                   BH2600 CSW096
     C*/EJECT****                                                  BH2600 CSW096
      *************************************************************BH2600 CSW096
      ****TXROUT*-*Attempt*priority*routing*to*STTX/Telex,*if*not**BH2600 CSW096
      *************already*routed**********************************BH2600 CSW096
      ****Called*by***PRAD*****************************************BH2600 CSW096
      ****Calls*******-********************************************BH2600 CSW096
      *************************************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********TXROUT    BEGSR                                   BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****If*not*already*routed,*attempt*STTX/Telex*routing********BH2600 CSW096
     C***********@NWRK     IFEQ *BLANKS                            BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****Note*that*STTX*and*Telex*are*mutually*exclusive*-*try*botBH2600 CSW096
     C***********BGMSDL    IFEQ 'Y'                                BH2600 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            BH2600 CSW096
     C***********@STTX     ANDNE*BLANKS                            BH2600 CSW096
     C***********          MOVEL'STTX'    @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********TLXM      IFEQ 'Y'                                BH2600 CSW096
     C***********TELX      ANDNE*BLANKS                            BH2600 CSW096
     C***********@TELX     ANDNE*BLANKS                            BH2600 CSW096
     C***********          MOVEL'TELEX'   @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          ENDSR                           TXROUT  BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C*/EJECT****                                                  BH2600 CSW096
      *************************************************************BH2600 CSW096
      ****SWROUT*-*Attempt*priority*routing*to*SWIFT*if*not*alreadyBH2600 CSW096
      *************routed******************************************BH2600 CSW096
      ****Called*by***PRAD*****************************************BH2600 CSW096
      ****Calls*******-********************************************BH2600 CSW096
      *************************************************************BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********SWROUT    BEGSR                                   BH2600 CSW096
      ***********                                                  BH2600 CSW096
      ****If*not*already*routed,*attempt*SWIFT*routing*************BH2600 CSW096
     C***********@NWRK     IFEQ *BLANKS                            BH2600 CSW096
     C***********BGMSDL    ANDEQ'Y'                                BH2600 CSW096
     C***********CSID      ANDNE*BLANKS                            BH2600 CSW096
     C***********SCSID     ANDNE*BLANKS                            BH2600 CSW096
     C***********@BIC      ANDNE'BIC'                              BH2600 CSW096
     C***********          MOVEL'SWIFT'   @NWRK                    BH2600 CSW096
     C***********          END                                     BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C***********          ENDSR                           SWROUT  BH2600 CSW096
      ***********                                                  BH2600 CSW096
     C/EJECT                                                              BH2600
     C/COPY WNCPYSRC,LE0420C013
      /COPY ZSRSRC,ZDATE2Z4                                               S01392
0733 C********************************************************************
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C/COPY WNCPYSRC,LE0420C002
     C********************************************************************S01117
     C/EJECT                                                              CLE004
      *****************************************************************   CLE004
      *                                                               *   CLE004
      * PRINTR - Print Confirmation for PT and PF (LE0420P2)          *   CLE004
      * CALLED FROM: Main                                             *   CLE004
      * CALLS:                                                        *   CLE004
      *                                                               *   CLE004
      *****************************************************************   CLE004
     C           PRINTR    BEGSR                                          CLE004
      *                                                                   CLE004
     C/COPY WNCPYSRC,LE0420C015
     C           AMTP      IFEQ 'PT'                                      CLE004
     C                     MOVE '1'       *IN16                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PF'                                      CLE004
     C                     MOVE '1'       *IN17                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   138866
      ** Calculate effective interest rate                                138866
      *                                                                   138866
     C                     Z-ADD0         W#RATE                          157056
     C                     SELEC                                          138866
     C           SPIN      WHEQ 'A'                                       138866
     C           BRTE      ADD  RTSP      W#RATE 110                      138866
     C           SPIN      WHEQ 'S'                                       138866
     C           BRTE      SUB  RTSP      W#RATE                          138866
     C           SPIN      WHEQ 'P'                                       138866
     C           RTSP      DIV  100       WRK132 132                      138866
     C           WRK132    MULT BRTE      W#RATE    H                     138866
     C                     ENDSL                                          138866
      *                                                                   CLE004
      ** Processing type if 'PF'                                          CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PF'                                      CLE004
     C           PTYP      COMP 62                     3232               CLE004
     C           PTYP      COMP 64                       34               CLE004
     C           PTYP      COMP 66                       36               CLE004
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C                     MOVE '1'       *IN34                           CLE005
     C                     ENDIF                                          CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C                     MOVE '1'       *IN36                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C  N32N34N36          GOTO EXPRT                                     CLE004
     C                     SETON                     33                   CLE004
      *                                                                   CLE004
      ** Check value date against extract date                            CLE004
      *                                                                   CLE004
     C           VDAT      COMP EXTD                 25                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C           PTYP      COMP 62                       48               CLE004
     C           PTYP      COMP 66                       30               CLE004
     C           PTYP      IFEQ 69                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE '1'       *IN30                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Determine amendment/cancellation narrative                       CLE004
      *                                                                   CLE004
     C   03                TESTB'7'       LAIN           37               CLE004
     C   03 37             TESTB'2'       LAIN       37                   CLE004
      *                                                                   CLE004
      ** Check if counterparty is a SWIFT member                          CLE004
      ** and set on 39 if output to LENXTAB                               CLE004
      *                                                                   CLE004
     C                     MOVELCNUM      CLKY   10                       CLE004
     C   U4                EXSR CLCHN                                     CLE004
      *                                                                   CLE004
     C   38 16 03                                                         CLE004
     COR 38 17 03          SETON                     39                   CLE004
     C   17 25             SETOF                     39                   CLE004
      *                                                                   CLE004
      ** Insert new MG Routing                                            CLE004
      *                                                                   CLE004
     C                     MOVE CSID      @BIC    4                       CLE004
     C                     MOVELBRCA      @DSNB   3                       CLE004
     C                     MOVELCNUM      @CUST   6                       CLE004
     C                     EXSR SRROUT                                    CLE004
      *                                                                   CLE004
      ** LEEXT rec is produced if lending message flag is ON              CLE004
      ** - Message can be rerouted via message management -               CLE004
      *                                                                   CLE004
     C           BGSWCL    IFEQ 'Y'                                       CLE004
     C                     SETON                     39                   CLE004
     C                     ELSE                                           CLE004
     C                     SETOF                     39                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If network is 'PAPER' and non-ISO confs are to be produced       CLE004
      ** - set OFF 96 -                                                   CLE004
      ** To supress auto-transmission text on printout                    CLE004
      *                                                                   CLE004
     C           BGSWCL    IFEQ 'Y'                                       CLE004
     C**********           CALL 'AOMGMER0'                                           CLE004 CLE075BO
     C**********           PARM '*MSG    '@RTCD                                      CLE004 CLE075BO
     C**********           PARM '*FIRST  '@OPTN                                      CLE004 CLE075BO
     C********** SDMGME    PARM SDMGME    DSFDY                                      CLE004 CLE075BO
      *****************************************************************              CLE004 CLE075BO
     C********** @RTCD     IFNE *BLANK                                               CLE004 CLE075BO
     C**********           MOVEL'SDMGMEPD'DBFILE            * * * * * * *            CLE004 CLE075BO
     C**********           MOVEL'15'      DBASE             *DBERROR 15 *            CLE004 CLE075BO
     C**********           SETON                     U7U8LR * * * * * * *            CLE004 CLE075BO
     C**********           EXSR *PSSR                                                CLE004 CLE075BO
     C**********           ENDIF                                                     CLE004 CLE075BO
      *                                                                   CLE004
     C           @NWRK     IFEQ 'PAPER'                                   CLE004
     C           ENFFCR    ANDEQ'Y'                                       CLE004
     C                     SETOF                     96                   CLE004
     C                     ELSE                                           CLE004
     C                     SETON                     96                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ELSE                                           CLE004
     C                     SETOF                     96                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Obtain customer name/address details                             CLE004
      ** Check alternate name & address code not equal to 'B'             CLE004
      ** IFEQ 'B' Bypass ALT NAME & ADDRESS Validation                    CLE004
      *                                                                   CLE004
     C           NACD      IFNE 'B'                                       CLE004
     C                     MOVELCNUM      CUST    6                       CLE004
     C                     MOVELNACD      ADCD    1                       CLE004
     C                     SETOF                     31                   CLE004
     C                     CALL 'AOALTNR0'                                CLE004
     C                     PARM '*MSG   ' @RTCD   7                       CLE004
     C                     PARM '*KEY   ' @OPTN   7                       CLE004
     C                     PARM           CUST                            CLE004
     C                     PARM           ADCD                            CLE004
     C           SDALTN    PARM SDALTN    DSFDY                           CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If no alternate N & A found, use SDCUSTPD N & A                  CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANKS                                   CLE004
     C           NACD      OREQ 'B'                                       CLE004
     C                     MOVELCNUM      CLKY                            CLE004
     C                     EXSR CLCHN                                     CLE004
     C           *IN31     IFNE '1'                                       CLE004
     C                     MOVE BBCNA1    CNA1                            CLE004
     C                     MOVE BBCNA2    CNA2                            CLE004
     C                     MOVE BBCNA3    CNA3                            CLE004
     C                     MOVE BBCNA4    CNA4                            CLE004
     C                     ELSE                                           CLE004
     C                     MOVEL'SDCUSTPD'DBFILE                          CLE004
     C                     MOVELCNUM      DBKEY                           CLE004
     C                     MOVEL'16'      DBASE                           CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     MOVE 'E'       WEND                            CLE004
     C                     GOTO EXPRT                                     CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If alternate N & A found, Use that town                          CLE004
      *                                                                   CLE004
     C                     ELSE                                           CLE004
     C                     MOVELBCCRTN    CTWN                            CLE004
     C                     ENDIF                                          CLE004
      ** Store name                                                       CLE004
     C                     MOVE CNA1      CST1   35                       CLE004
     C                     MOVE CNA2      CST2   35                       CLE004
     C                     MOVE CNA3      CST3   35                       CLE004
     C                     MOVE CNA4      CST4   35                       CLE004
     C                     MOVE CTWN      CTW1   10                       CLE004
     C                     MOVE CNUM      TELNUM  6                       CLE004
      *                                                                   CLE004
      ** Pick up brance name if required                                  CLE004
      *                                                                   CLE004
     C     N70             GOTO BT04                                      CLE004
      *                                                                   CLE004
      ** Access Branch codes                                              CLE004
      *                                                                   CLE004
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                             CLE004 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       CLE004
     C                     PARM '*KEY   ' @OPTN   7                       CLE004
     C                     PARM BRCA      @DSNB   3                       CLE004
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CLE004 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANKS                                   CLE004
     C                     SETON                     31                   CLE004
     C                     END                                            CLE004
     C         31          MOVEL'SDBRCHPD'DBFILE                          CLE004
     C         31          MOVEL@DSNB     DBKEY                           CLE004
     C         31          MOVEL'17'      DBASE            ***************CLE004
     C         31          SETON                     U7U8  *  DBASE  17  *CLE004
     C         31          MOVE 'E'       WEND             ***************CLE004
     C         31          GOTO EXPRT                                     CLE004
     C                     ENDIF                                                            CLE075BO
      *                                                                   CLE004
     C           BT04      TAG                             ** BT04 TAG ** CLE004
      *                                                                   CLE004
     C                     Z-ADDCURARR    A                                                 CLE075BO
     C           CCY       LOKUP#CCY,A                   49                                 CLE075BO
     C           *IN49     IFEQ '1'                                                         CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     CALL 'AOCURRR0'                                CLE004
     C                     PARM '*MSG   ' @RTCD   7                       CLE004
     C                     PARM '*KEY   ' @OPTN   7                       CLE004
     C                     PARM CCY       TKEY    3                    A  CLE004
     C           SDCURR    PARM SDCURR    DSSDY                        B  CLE004
     C           @RTCD     IFNE *BLANK                                    CLE004
     C                     SETON                     31                   CLE004
     C                     END                                            CLE004
     C      31             MOVE 'SDCURRPD'DBFILE                          CLE004
     C      31             MOVELCCY       DBKEY                           CLE004
     C      31             MOVEL'18'      DBASE            ***************CLE004
     C      31             SETON                     U7U8  *  DBASE  18  *CLE004
     C      31             MOVE 'E'       WEND             ***************CLE004
     C      31             GOTO EXPRT                                     CLE004
     C                     ENDIF                                                            CLE075BO
      *                                                                   CLE004
     C           CDP       COMP 1                      4041               CLE004
     C           CDP       COMP 2                    43  42               CLE004
      *                                                                   CLE004
      ** Set required indicators for settlement insturctions              CLE004
      ** also access required customer details                            CLE004
      *                                                                   CLE004
     C                     EXSR SETINS                                    CLE004
     C   U7 U8             MOVE 'E'       WEND                            CLE004
     C   U7 U8             GOTO EXPRT                                     CLE004
      *                                                                   CLE004
      ** Use ZDATE2 to convert value DAYNO to date format                 CLE004
      *                                                                   CLE004
     C                     MOVE VDAT      ZDAYNO                          CLE004
     C                     EXSR ZDATE2                                    CLE004
     C                     MOVE ZADATE    OVDAT   7                       CLE004
      *                                                                   CLE004
      ** Arrange dates into DDMMYY format for output to TELEX file        CLE004
      *                                                                   CLE004
     C                     MOVE ZYEAR     ZWRK4                           CLE004
     C                     MOVELZMTH      ZWRK4                           CLE004
     C                     MOVE ZWRK4     TXDATE  60                      CLE004
     C                     MOVELZDAY      TXDATE                          CLE004
      *                                                                   CLE004
      ** Check for negaitves on RE                                        CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PF'                                      CLE004
     C           INTA      COMP 0                      44                 CLE004
     C           TAMT      COMP 0                      45                 CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Check if customer is the same as the receiving/originating cust. CLE004
      *                                                                   CLE004
     C           RORC      IFEQ CNUM                                      CLE004
     C                     MOVE '1'       *IN14                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C           EXPRT     ENDSR                                          CLE004
      *****************************************************************                     CLE075BO
      *                                                               *                     CLE075BO
      *  CHKNOS - Check Nostro details in array                       *                     CLE075BO
      *                                                               *                     CLE075BO
      *****************************************************************                     CLE075BO
     C           CHKNOS    BEGSR                                                            CLE075BO
      *                                                                                     CLE075BO
      ** Reinitialize work fields                                                           CLE075BO
      *                                                                                     CLE075BO
     C                     MOVEL*BLANK    NOSIC                                             CLE075BO
     C                     MOVE *OFF      *IN76                                             CLE075BO
     C           KEYNOS    IFNE *BLANKS                                                     CLE075BO
      *                                                                                     CLE075BO
      ** Check previous base rate details if it's                                           CLE075BO
      ** same with current details                                                          CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADDNOSPRV    F                                                 CLE075BO
      *                                                                                     CLE075BO
      ** Defend against index being 0                                                       CLE075BO
      ** Set current index to starting index                                                CLE075BO
      *                                                                                     CLE075BO
     C           F         IFEQ 0                                                           CLE075BO
     C                     Z-ADDNOSIDX    F                                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
      ** If the KEYNOS being checked is the same then use the index                         CLE075BO
      ** of the current detail rather than doing a LOKUP                                    CLE075BO
      *                                                                                     CLE075BO
     C           KEYNOS    IFEQ #NSK,F                                                      CLE075BO
     C                     MOVE *ON       *IN76                                             CLE075BO
     C                     ELSE                                                             CLE075BO
      *                                                                                     CLE075BO
     C           NOSIDX    IFEQ 0                                                           CLE075BO
     C                     Z-ADD1         F                                                 CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     Z-ADDNOSIDX    F                                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C           KEYNOS    LOKUP#NSK,F                   76                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
      ** Save the last accessed detail to NOSPRV                                            CLE075BO
      ** Set the indicator to show the data was found                                       CLE075BO
      *                                                                                     CLE075BO
     C           *IN76     IFEQ *ON                                                         CLE075BO
     C                     MOVE NOSSEQ    #NOS,F                                            CLE075BO
     C                     Z-ADDF         NOSPRV                                            CLE075BO
     C                     MOVEL'Y'       NOSIC                                             CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C                     ENDIF                                                            CLE075BO
     C                     ENDSR                                                            CLE075BO
      *****************************************************************                     CLE075BO
      *                                                               *                     CLE075BO
      *  ADDNOS - Add Nostro details to array                         *                     CLE075BO
      *                                                               *                     CLE075BO
      *****************************************************************                     CLE075BO
     C           ADDNOS    BEGSR                                                            CLE075BO
      *                                                                                     CLE075BO
      ** If there is still room in the array then add the details                           CLE075BO
      *                                                                                     CLE075BO
     C           NOSIDX    IFNE 0                                                           CLE075BO
     C                     SUB  1         NOSIDX                                            CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C                     MOVELKEYNOS    #NSK,F                                            CLE075BO
     C                     ADD  NOSSEQ    #NOS,F                                            CLE075BO
      *                                                                                     CLE075BO
      ** Set last accessed detail to NOSPRV So that CHKNOS checks this                      CLE075BO
      ** latest detail first                                                                CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADDF         NOSPRV                                            CLE075BO
      *                                                                                     CLE075BO
     C                     ENDSR                                                            CLE075BO
      /EJECT                                                                                  CLE031
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
     C********************************************************************S01117
     C/EJECT
     O*LEECTX**DADD     20 47                                             BH2600
     O*******OR**      33 47                                              BH2600
     O***********                         1 'D'                           BH2600
     O***********              BRCD       4                               S01117
     O***********              BRCA       4                               S01117
     O***********              TELNUM    10                               BH2600
     O***********              PTYP      12                               BH2600
     O***********              TXDATE    18                               BH2600
     O***********              CCY       21                               BH2600
     O***********              LNRF      27                               BH2600
     O***********                        28 'F'                           BH2600
     O***********                        29 'C'                           BH2600
     O***********                        70 'I'                           BH2600
     O***********              BRCD      73                               S01117
     O***********              BRCA      73                               S01117
     O********DADD     20 47                                              BH2600
     O*******OR**      33 47                                              BH2600
     O***********                         2 'TO'                          BH2600
     O***********              CST1      38                               BH2600
     O***********              CTW1      49                               BH2600
     O***********              BRCD      73                               S01117
     O***********              BRCA      73                               S01117
     O********DADD     20 47                                              BH2600
     O*******OR**      33 47                                              BH2600
     O***********            20          24 'PRINCIPAL INCREASE CONFI'    BH2600
     O***********            20          31 'RMATION'                     BH2600
     O***********            21          27 'REPAYMENT CONFIRMATION'      BH2600
     O***********                        36 'REF'                         BH2600
     O***********              LNRF      43                               BH2600
     O***********                        48 'DATE'                        BH2600
     O***********              RUNA      56                               BH2600
     O***********         03 37          66 'AMENDMENT'                   BH2600
     O***********         05             69 'CANCELLATION'                BH2600
     O***********              BRCD      73                               S01117
     O***********              BRCA      73                         S01117BH2600
     O************                                                        BH2600
     O***NARRATIVE LINE 1                                                 BH2600
     O************                                                        BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     33 47                                              BH2600
     O************        20             23 'WE CONFIRM OUR INCREASES01243BH2600
     O************        20             42 'TO YOUR LOAN VALUE'    S01243BH2600
     O************        20   OVDAT     50                         S01243BH2600
     O************    N30 20             23 'WE CONFIRM OUR INCREASES01243BH2600
     O************    N30 20             42 'TO YOUR LOAN VALUE'    S01243BH2600
     O************    N30 20   OVDAT     50                         S01243BH2600
     O************     30 20             23 'WE CONFIRM OUR INC TO YS01243BH2600
     O************     30 20             46 'OUR PARTICIPATION VALUES01243BH2600
     O************     30 20   OVDAT     54                         S01243BH2600
     O************        20             58 'AT CALL'               S01243BH2600
     O************    N48 20N30          58 'AT CALL'               S01243BH2600
     O************        32             23 'WE CONFIRM REPAYMENT TO'     BH2600
     O************        32             40 'YOUR LOAN DUE ON'            BH2600
     O************        32   OVDAT     48                               BH2600
     O************        34             23 'WE CONFIRM REPAYMENT TO'     BH2600
     O************        34             44 'OUR PARTICIPATION IN'        BH2600
     O************        34             61 'YOUR LOAN DUE ON'            BH2600
     O************        34   OVDAT     69                               BH2600
     O************        36             23 'WE CONFIRM REPAYMENT TO'     BH2600
     O************        36             45 'YOUR PARTICIPATION IN'       BH2600
     O************        36             61 'OUR LOAN DUE ON'             BH2600
     O************        36   OVDAT     69                               BH2600
     O************             BRCD      73                         S01117BH2600
     O************             BRCA      73                         S01117BH2600
     O************                                                        BH2600
     O***DETAILS*OF CONFIRMATION                                          BH2600
     O************                                                        BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     33 47                                              BH2600
     O************           20          29 'CCY   AMOUNT OF INCREASE'    BH2600
     O************           21          25 'CCY        PRINCIPAL'        BH2600
     O************           21          45 'INTEREST'                    BH2600
     O************           21          66 'TOTAL REPAYMENT'             BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     33 47                                              BH2600
     O************             CCY        8                               BH2600
0873 O************           40PRAM      28 ' ,   ,   ,   , 0 '           BH2600
     O************           41PRAM      28 '   ,   ,   , 0 . '           BH2600
     O************           42PRAM      28 '  ,   ,   , 0 .  '           BH2600
     O************           43PRAM      28 ' ,   ,   , 0 .   '           BH2600
     O************     18 21 25          28 '   NOT CALCULATED'           BH2600
     O************     18 21 05          28 '   NOT CALCULATED'           BH2600
     O************        21 40INTA      47 ' ,   ,   ,   , 0 '           BH2600
     O************        21 41INTA      47 '   ,   ,   , 0 . '           BH2600
     O************        21 42INTA      47 '  ,   ,   , 0 .  '           BH2600
     O************        21 43INTA      47 ' ,   ,   , 0 .   '           BH2600
     O************        21 44          48 '-'                           BH2600
     O************     18 21 25          48 '   NOT CALCULATED'           BH2600
     O************     19 21 25          48 '   NOT CALCULATED'           BH2600
     O************     18 21 05          48 '   NOT CALCULATED'           BH2600
     O************     19 21 05          48 '   NOT CALCULATED'           BH2600
     O************        21 40TAMT      68 ' ,   ,   ,   , 0 '           BH2600
     O************        21 41TAMT      68 '   ,   ,   , 0 . '           BH2600
     O************        21 42TAMT      68 '  ,   ,   , 0 .  '           BH2600
     O************        21 43TAMT      68 ' ,   ,   , 0 .   '           BH2600
     O************        21 45          69 '-'                           BH2600
     O************     19 21 25          69 '   NOT CALCULATED'           BH2600
     O************     19 21 05          69 '   NOT CALCULATED'           BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O************                                                        BH2600
     O***OUTPUT*NOW SPLITS ACCORDING TO WHETHER PAYMENT OR RECEIPT        BH2600
     O***FOR*SETTLEMENT INSTRUCTIONS.                                     BH2600
     O************                                                        BH2600
     O********RECEIPTS  ***                                               BH2600
     O************                                                        BH2600
     O********DADD     32 47                                              BH2600
     O*******OR***     34 47                                              BH2600
     O************                       24 'PAYMENT AT VALUE DATE'       BH2600
     O*****                  51          40 'TO OUR A/C WITH'             S01117
     O************           51          40 'TO             '             S01117
     O************           58          27 'BY'                          BH2600
     O************           50          27 'TO'                          BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                               S01117
     O********DADD     32 47                                              BH2600
     O*******OR***     34 47                                              BH2600
     O************           50          29 'INSTRUCTIONS TO BE ADVIS'    BH2600
     O************           50          31 'ED'                          BH2600
     O************           51CN2       40                               BH2600
     O************        22 51          29 'INSTRUCTIONS TO BE ADVIS'    BH2600
     O************        22 51          31 'ED'                          BH2600
     O************           52          29 'WE AWAIT YOUR REMITTANCE'    BH2600
     O************           53          28 'AS PER OUR INSTRUCTIONS'     BH2600
     O************           54          28 'DEBIT TO ACCOUNT NUMBER'     BH2600
     O************           55          28 'AS PER OUR INSTRUCTIONS'     BH2600
     O************           57          28 'WE SHALL COLLECT REMITT'     BH2600
     O************           57          32 'ANCE'                        BH2600
     O************           58          28 'DEBIT TO ACCOUNT NUMBER'     BH2600
     O************           51CT2       61                               BH2600
     O************        22 51          61 '                    '        BH2600
     O************           54OUT04     36 '    -  '                     BH2600
     O************           58OSAC      41                               BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
      ************                                                        BH2600
     O********DADD     32 47                                              BH2600
     O*******OR***     34 47                                              BH2600
     O************           50          13 'PAYMENT BY'                  BH2600
     O************           51          13 'PAYMENT BY'                  BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     32 47                                              BH2600
     O*******OR***     34 47                                              BH2600
     O************           51CN3       40                               BH2600
     O************        23 51          26 'WE AWAIT YOUR ADVICE'        BH2600
     O************        23 51          40 '              '              BH2600
     O************           50          26 'WE AWAIT YOUR ADVICE'        BH2600
     O************           51CT3       61                               BH2600
     O************        23 51          61 '                    '        BH2600
     O************                       70 '*'                           BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                               S01117
     O************                                                        BH2600
     O********PAYMENTS  ***                                               BH2600
     O************                                                        BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           50          29 'INSTRUCTIONS TO BE ADVIS'    BH2600
     O************           50          31 'ED'                          BH2600
     O************           51CN2       40                               BH2600
     O************        22 51          29 'INSTRUCTIONS TO BE ADVIS'    BH2600
     O************        22 51          31 'ED'                          BH2600
     O************           52          28 'WE WILL SEND REMITTANCE'     BH2600
     O************           53          29 'AS PER YOUR INSTRUCTIONS'    BH2600
     O************           54          29 'CREDIT TO ACCOUNT NUMBER'    BH2600
     O************           55          29 'AS PER YOUR INSTRUCTIONS'    BH2600
     O************           57          29 'YOU SHALL COLLECT REMITT'    BH2600
     O************           57          33 'ANCE'                        BH2600
     O************           58          29 'CREDIT TO ACCOUNT NUMBER'    BH2600
     O************           51CT2       61                               BH2600
     O************        22 51          61 '                    '        BH2600
     O************           54OUT04     36 '    -  '                     BH2600
     O************           58OSAC      41                               BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           50          13 'PAYMENT TO'                  BH2600
     O************           51          13 'PAYMENT TO'                  BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           51CN3       40                               BH2600
     O************        23 51          26 'WE AWAIT YOUR ADVICE'        BH2600
     O************        23 51          40 '              '              BH2600
     O************           50          26 'WE AWAIT YOUR ADVICE'        BH2600
     O************           51CT3       61                               BH2600
     O************        23 51          61 '                    '        BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           51          13 'FOR A/C OF'                  BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           51CN4       40                               BH2600
     O************           51CT4       61                               BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           51          23 'SPECIAL INSTRUCTIONS'        BH2600
     O************           52          23 'SPECIAL INSTRUCTIONS'        BH2600
     O************           54          23 'SPECIAL INSTRUCTIONS'        BH2600
     O************           58          23 'SPECIAL INSTRUCTIONS'        BH2600
     O************           51SPI1      54                               BH2600
     O************           52SPI1      54                               BH2600
     O************           54SPI1      54                               BH2600
     O************           58SPI1      54                               BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           51SPI2      54                               BH2600
     O************           52SPI2      54                               BH2600
     O************           54SPI2      54                               BH2600
     O************           58SPI2      54                               BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     O********DADD     20 47                                              BH2600
     O*******OR***     36 47                                              BH2600
     O************           51SPI3      54                               BH2600
     O************           52SPI3      54                               BH2600
     O************           54SPI3      54                               BH2600
     O************           58SPI3      54                               BH2600
     O************                       70 '*'                           BH2600
     O***********              BRCD      73                               S01117
     O************             BRCA      73                         S01117BH2600
     OLENXTAA D        U4 01
     O                                    1 'H'
     OLENXTAB D        U4 39
     O                         LOT1     250
     O                         LOT2     320
     O                         LOT3     949                               S01518
     O                         CSWID    267
     O                         OSBR     270                               S01117
     O                         RONS     985                                                   CLE042
     O                         PONS    1003                                                   CLE042
     O                         CLAS    1007                                                   CLE042
     OLENXTAC T        LR U4
     O                                    1 'T'
     O                         RECXTO     6
     O*
0824 O*  CONFIRMATIONS PRINT
0825 O*  STANDARD OUTPUT
0826 O*
0827 O*
0828 O*BRANCH NAME IF REQUIRED
0829 O*MPRINTCFD  309      20                                             S01125
0829 O*E0420P2D**309      20                                        S01125S01117
     O/COPY WNCPYSRC,LE0420OOP3                                           S01408
0829 O***LE0420P1D  309      20                                           CLE004
0830 O***    OR  309      33                                              CLE004
0829 OLE0420P1D  309  N13 20                                              CLE004
0830 O       OR  309  N13 33                                              CLE004
0831 O                       70BRNM      61
     O/COPY WNCPYSRC,LE0420OOP4                                           S01408
0832 O*  HEADING LINE. CONFIRMATION NAME & TYPE
0833 O********D  1        20                                              CLE004
0834 O*******OR  1        33                                              CLE004
0833 O        D  1    N13 20                                              CLE004
0834 O       OR  1    N13 33                                              CLE004
0835 O                       20          44 'PRINCIPAL INCREASE CONFI'
0836 O                       20          51 'RMATION'
0837 O                       21          47 'REPAYMENT CONFIRMATION'
0838 O                    03 37          66 'AMENDMENT'
0839 O                    05             69 'CANCELLATION'
0840 O*  LOAN REFERENCE & RUN DATE
0841 O********D 11        20                                              CLE004
0842 O*******OR 11        33                                              CLE004
0841 O        D 11    N13 20                                              CLE004
0842 O       OR 11    N13 33                                              CLE004
0843 O                         LNRF      14
0844 O                         RUNA      32
     O/COPY WNCPYSRC,LE0420O002
0845 O*  NARRATIVE LINE 1
0846 O********D 12        20                                              CLE004
0847 O*******OR 12        33                                              CLE004
0846 O        D 12    N13 20                                              CLE004
0847 O       OR 12    N13 33                                              CLE004
0848 O************           20          26 'WE CONFIRM OUR INCREASE'     S01243
0849 O************           20          45 'TO YOUR LOAN VALUE'          S01243
0850 O************           20OVDAT     53                               S01243
0848 O                N30    20          26 'WE CONFIRM OUR INCREASE'     S01243
0849 O                N30    20          45 'TO YOUR LOAN VALUE'          S01243
0850 O                N30    20OVDAT     53                               S01243
     O/COPY WNCPYSRC,LE0420O003
0848 O                 30    20          26 'WE CONFIRM OUR INC TO Y'     S01243
0849 O                 30    20          49 'OUR PARTICIPATION VALUE'     S01243
0850 O                 30    20OVDAT     57                               S01243
     O/COPY WNCPYSRC,LE0420O004
0851 O************           20          61 'AT CALL'                     S01243
0851 O                N48N30 20          61 'AT CALL'                     S01243
0852 O                       32          26 'WE CONFIRM REPAYMENT TO'
0853 O                       32          43 'YOUR LOAN DUE ON'
0854 O                       32OVDAT     51
     O/COPY WNCPYSRC,LE0420O005
0855 O                       34          26 'WE CONFIRM REPAYMENT TO'
0856 O                       34          47 'OUR PARTICIPATION IN'
0857 O                       34          64 'YOUR LOAN DUE ON'
0858 O                       34OVDAT     72
     O/COPY WNCPYSRC,LE0420O006
0859 O                       36          26 'WE CONFIRM REPAYMENT TO'
0860 O                       36          48 'YOUR PARTICIPATION IN'
0861 O                       36          64 'OUR LOAN DUE ON'
0862 O                       36OVDAT     72
     O/COPY WNCPYSRC,LE0420O007
0863 O*  DETAILS OF CONFIRMATION
0864 O********D 11        20                                              CLE004
0865 O*******OR 11        33                                              CLE004
0864 O        D 11    N13 20                                              CLE004
0865 O       OR 11    N13 33                                              CLE004
0866 O                       20          29 'CCY   AMOUNT OF INCREASE'
0867 O                       21          25 'CCY        PRINCIPAL'
0868 O                       21          45 'INTEREST'
0869 O                       21          66 'TOTAL REPAYMENT'
     O/COPY WNCPYSRC,LE0420OOP1                                           S01408
0870 O********D 12        20                                              CLE004
0871 O*******OR 12        33                                              CLE004
0870 O        D 12    N13 20                                              CLE004
0871 O       OR 12    N13 33                                              CLE004
0872 O***********              CCY        8                               CEU004
     O                         WKCCY      8                               CEU004
     O/COPY WNCPYSRC,LE0420O029
     O                    40   WKPRAM    28 ' ,   ,   ,   ,*  '           CEU004
     O                    41   WKPRAM    28 '   ,   ,   , * . '           CEU004
     O                    42   WKPRAM    28 '  ,   ,   , * .  '           CEU004
     O                    43   WKPRAM    28 ' ,   ,   , * .   '           CEU004
0873 O***********         40   PRAM      28 ' ,   ,   ,   ,*  '           CEU004
0874 O***********         41   PRAM      28 '   ,   ,   , * . '           CEU004
0875 O***********         42   PRAM      28 '  ,   ,   , * .  '           CEU004
0876 O***********         43   PRAM      28 ' ,   ,   , * .   '           CEU004
0877 O***********      21 25 18          28 '***NOT CALCULATED'           S01392
0878 O***********      21 05 18          28 '***NOT CALCULATED'           S01392
0879 O***********         40 21INTA      47 ' ,   ,   ,   ,*  '           CEU004
0880 O***********         41 21INTA      47 '   ,   ,   , * . '           CEU004
0881 O***********         42 21INTA      47 '  ,   ,   , * .  '           CEU004
0882 O***********         43 21INTA      47 ' ,   ,   , * .   '           CEU004
     O                    40 21WKINTA    47 ' ,   ,   ,   ,*  '           CEU004
     O                    41 21WKINTA    47 '   ,   ,   , * . '           CEU004
     O                    42 21WKINTA    47 '  ,   ,   , * .  '           CEU004
     O                    43 21WKINTA    47 ' ,   ,   , * .   '           CEU004
     O/COPY WNCPYSRC,LE0420O030
0883 O                    44 21          48 '-'
     O/COPY WNCPYSRC,LE0420O031
0884 O***********      21 25 18          48 '***NOT CALCULATED '          S01392
0885 O***********      21 25 19          48 '***NOT CALCULATED '          S01392
0886 O***********      21 05 18          48 '***NOT CALCULATED '          S01392
0887 O***********      21 05 19          48 '***NOT CALCULATED '          S01392
0888 O***********         40 21TAMT      68 ' ,   ,   ,   ,*  '           CEU004
0889 O***********         41 21TAMT      68 '   ,   ,   , * . '           CEU004
0890 O***********         42 21TAMT      68 '  ,   ,   , * .  '           CEU004
0891 O***********         43 21TAMT      68 ' ,   ,   , * .   '           CEU004
     O                    40 21WKTAMT    68 ' ,   ,   ,   ,*  '           CEU004
     O                    41 21WKTAMT    68 '   ,   ,   , * . '           CEU004
     O                    42 21WKTAMT    68 '  ,   ,   , * .  '           CEU004
     O                    43 21WKTAMT    68 ' ,   ,   , * .   '           CEU004
     O/COPY WNCPYSRC,LE0420O032
0892 O                    45 21          69 '-'
     O/COPY WNCPYSRC,LE0420OOP2                                           S01408
0893 O***********      21 25 19          69 '***NOT CALCULATED '          S01392
0894 O***********      21 05 19          69 '***NOT CALCULATED '          S01392
0895 O*  OUTPUT NOW SPLITS ACCORDING TO WHETHER PAYMENT OR RECEIPT
0896 O*  FOR SETTLEMENT INSTRUCTIONS. FIRST *** RECEIPTS ***
0897 O********D 1      32                                                 CLE004
0898 O*******OR 1      34                                                 CLE004
0897 O        D 1      32N13                                              CLE004
0898 O       OR 1      34N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O009
0899 O                                   24 'PAYMENT AT VALUE DATE'
0900 O                       51          40 'TO OUR A/C WITH'
0901 O                       54          27 'BY'
0902 O                       58          27 'BY'
0903 O                       50          27 'TO'
0904 O********D 1      32                                                 CLE004
0905 O*******OR 1      34                                                 CLE004
0904 O        D 1      32N13                                              CLE004
0905 O       OR 1      34N13                                              CLE004
0906 O                       50          30 'INSTRUCTIONS TO BE ADVIS'
0907 O                       50          32 'ED'
0908 O                       51CN2    B  40
0909 O                    51 22          30 'INSTRUCTIONS TO BE ADVIS'
0910 O                    51 22          40 'ED        '
0911 O                       52          30 'WE AWAIT YOUR REMITTANCE'
0912 O                       53          29 'AS PER OUR INSTRUCTIONS'
0913 O                       54          29 'DEBIT TO ACCOUNT NUMBER'
0914 O                       55          29 'AS PER OUR INSTRUCTIONS'
0915 O                       57          29 'WE SHALL COLLECT REMITT'
0916 O                       57          33 'ANCE'
0917 O                       58          29 'DEBIT TO ACCOUNT NUMBER'
     O                       49          29 'THROUGH ACCOUNT'             CLE033
0918 O********D 11     32                                                 CLE004
0919 O*******OR 11     34                                                 CLE004
0918 O        D 11     32N13                                              CLE004
0919 O       OR 11     34N13                                              CLE004
0920 O                       51CT2    B  25
0921 O                    51 22          25 '                    '
0922 O                       54OUT04  B  12 '    -  '
     O                       54          13 '-'                           S01117
     O                       54OSBR   B  16                               S01117
0923 O**********             58OSAC      15                                                   CGL029
     O                       58OSAC      21                                                   CGL029
     O                       49OSBR   B   4                               CLE033
     O                       49           5 '-'                           CLE033
     O**********             49OSAC      17                                            CLE033 CGL029
     O                       49OSAC      23                                                   CGL029
     O        D 11     32N13 49                                                               CLE031
     O       OR 11     34N13 49                                                               CLE031
     O                                   24 'PAYMENT IN SETTLE CCY'                           CLE031
     O                                   37 'AMOUNTING TO'                                    CLE031
     O        D 1      32N13 49                                                               CLE031
     O       OR 1      34N13 49                                                               CLE031
     O                         WRSCY      8                                                   CLE031
     O                    80   WRSAMT    28 ' ,   ,   ,   ,*  '                               CLE031
     O                    81   WRSAMT    28 '   ,   ,   , * . '                               CLE031
     O                    82   WRSAMT    28 '  ,   ,   , * .  '                               CLE031
     O                    83   WRSAMT    28 ' ,   ,   , * .   '                               CLE031
0924 O********D 1      32                                                 CLE004
0925 O*******OR 1      34                                                 CLE004
0924 O        D 1      32N13                                              CLE004
0925 O       OR 1      34N13                                              CLE004
0926 O                       51          13 'PAYMENT BY'
     O                       49          13 'PAYMENT BY'                  CLE033
0927 O                       50          13 'PAYMENT BY'
0928 O********D 1      32                                                 CLE004
0929 O*******OR 1      34                                                 CLE004
0928 O        D 1      32N13                                              CLE004
0929 O       OR 1      34N13                                              CLE004
0930 O                       51CN3    B  40
0931 O                    51 23          26 'WE AWAIT YOUR ADVICE'
0932 O                    51 23          40 '              '
0933 O                       50          26 'WE AWAIT YOUR ADVICE'
     O                       49CN3    B  40                               CLE033
     O                    49 23          26 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          40 '              '              CLE033
0934 O********D 13        32                                              CLE004
0935 O*******OR 13     34                                                 CLE004
     O/COPY WNCPYSRC,LE0420O010
0934 O        D 13    N13 32                                              CLE004
0935 O       OR 13     34N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O011
0936 O                       51CT3    B  25
0937 O                    51 23          25 '                    '
     O                       49CT3    B  25                               CLE033
     O                    49 23          25 '                    '        CLE033
0938 O***SPACE*LINES*BEFORE*NAME/ADDRESS*PRINTED**************************
0939 O*
0940 O*
0941 O*
0942 O*
0943 O**** PAYMENTS ***
0944 O********D 1      20                                                 CLE004
0945 O*******OR 1      36                                                 CLE004
     O/COPY WNCPYSRC,LE0420O012
0944 O        D 1      20N13                                              CLE004
0945 O       OR 1      36N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O013
0946 O                                   65 'PAYMENT AT VALUE DATE'
0947 O                       51          68 'BY'
0948 O                       54          68 'BY'
0949 O                       58          68 'BY'
0950 O                       50          68 'BY'
0951 O********D 1      20                                                 CLE004
0952 O*******OR 1      36                                                 CLE004
0951 O        D 1      20N13                                              CLE004
0952 O       OR 1      36N13                                              CLE004
0953 O                       50          71 'INSTRUCTIONS TO BE ADVIS'
0954 O                       50          73 'ED'
0955 O                       51CN2    B  82
0956 O                    51 22          71 'INSTRUCTIONS TO BE ADVIS'
0957 O                    51 22          82 'ED         '
0958 O                       52          70 'WE WILL SEND REMITTANCE'
0959 O                       53          71 'AS PER YOUR INSTRUCTIONS'
0960 O                       54          71 'CREDIT TO ACCOUNT NO'
0961 O                       55          71 'AS PER YOUR INSTRUCTIONS'
0962 O                       57          71 'YOU SHALL COLLECT REMITT'
0963 O                       57          75 'ANCE'
0964 O                       58          71 'CREDIT TO ACCOUNT NUMBER'
     O                       49          71 'THROUGH ACCOUNT'             CLE033
0965 O********D 11     20                                                 CLE004
0966 O*******OR 11     36                                                 CLE004
0965 O        D 11     20N13                                              CLE004
0966 O       OR 11     36N13                                              CLE004
0967 O                       51CT2    B  67
0968 O                    51 22          67 '                    '
0969 O                       54OUT04  B  54 '    -  '
     O                       54          55 '-'                           S01117
     O                       54OSBR   B  58                               S01117
0970 O**********             58OSAC      54                                                   CGL029
     O                       58OSAC      60                                                   CGL029
     O                       49OSBR   B   4                               CLE033
     O                       49           5 '-'                           CLE033
     O**********             49OSAC      17                                            CLE033 CGL029
     O                       49OSAC      23                                                   CGL029
     O        D 11     20N13 49                                                               CLE031
     O       OR 11     36N13 49                                                               CLE031
     O                                   65 'PAYMENT IN SETTLE CCY'                           CLE031
     O                                   78 'AMOUNTING TO'                                    CLE031
     O        D 1      20N13 49                                                               CLE031
     O       OR 1      36N13 49                                                               CLE031
     O                         WPSCY     44                                                   CLE031
     O                    84   WPSAMT    64 ' ,   ,   ,   ,*  '                               CLE031
     O                    85   WPSAMT    64 '   ,   ,   , * . '                               CLE031
     O                    86   WPSAMT    64 '  ,   ,   , * .  '                               CLE031
     O                    87   WPSAMT    64 ' ,   ,   , * .   '                               CLE031
0971 O********D 1      20                                                 CLE004
0972 O*******OR 1      36                                                 CLE004
0971 O        D 1      20N13                                              CLE004
0972 O       OR 1      36N13                                              CLE004
0973 O                       50          54 'PAYMENT TO'
     O                       49          54 'PAYMENT TO'                  CLE033
0974 O                       51          54 'PAYMENT TO'
0975 O********D 1      20                                                 CLE004
0976 O*******OR 1      36                                                 CLE004
0975 O        D 1      20N13                                              CLE004
0976 O       OR 1      36N13                                              CLE004
0977 O                       51CN3    B  82
0978 O                    51 23          68 'WE AWAIT YOUR ADVICE'
0979 O                    51 23          82 '              '
     O                       49CN3    B  82                               CLE033
     O                    49 23          68 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          82 '              '              CLE033
0980 O                       50          68 'WE AWAIT YOUR ADVICE'
0981 O********D 11     20                                                 CLE004
0982 O*******OR 11     36                                                 CLE004
     O/COPY WNCPYSRC,LE0420O014
0981 O        D 11     20N13                                              CLE004
0982 O       OR 11     36N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O015
0983 O                       51CT3    B  67
0984 O                    51 23          25 '                    '
     O                       49CT3    B  67                               CLE033
     O                    49 23          25 '                    '        CLE033
0985 O********D 1      20                                                 CLE004
0986 O*******OR 1      36                                                 CLE004
0985 O        D 1      20N13                                              CLE004
0986 O       OR 1      36N13                                              CLE004
0987 O                       51          54 'FOR A/C OF'
     O                       49          54 'FOR A/C OF'                  CLE033
0988 O********D 1      20                                                 CLE004
0989 O*******OR 1      36                                                 CLE004
0988 O        D 1      20N13                                              CLE004
0989 O       OR 1      36N13                                              CLE004
0990 O                       51CN4    B  82
     O                       49CN4    B  82                               CLE033
0991 O********D 11     20                                                 CLE004
0992 O*******OR 11     36                                                 CLE004
     O/COPY WNCPYSRC,LE0420O016
0991 O        D 11     20N13                                              CLE004
0992 O       OR 11     36N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O017
0993 O                       51CT4    B  67
     O                       49CT4    B  67                               CLE033
0994 O********D 1      20                                                 CLE004
0995 O*******OR 1      36                                                 CLE004
0994 O        D 1      20N13                                              CLE004
0995 O       OR 1      36N13                                              CLE004
0996 O                       51          64 'SPECIAL INSTRUCTIONS'
     O                       49          64 'SPECIAL INSTRUCTIONS'        CLE033
0997 O                       52          64 'SPECIAL INSTRUCTIONS'
0998 O                       54          64 'SPECIAL INSTRUCTIONS'
0999 O                       58          64 'SPECIAL INSTRUCTIONS'
     O/COPY WNCPYSRC,LE0420O018
     O********D 1      20N29                                              CLE004
     O*******OR 1      36N29                                              CLE004
     O        D 1      20N29N13                                           CLE004
     O       OR 1      36N29N13                                           CLE004
1002 O                       51SPI1      77
     O                       49SPI1      77                               CLE033
1003 O                       52SPI1      77
1004 O                       54SPI1      77
1005 O                       58SPI1      77
     O/COPY WNCPYSRC,LE0420OOP5                                           S01408
1006 O********D 1      20                                                 CLE004
1007 O*******OR 1      36                                          E47247 CLE004
     O*******OR 1      33                                          E47247 CLE004
1006 O        D 1      20N13                                              CLE004
1007 O       OR 1      36N13                                              CLE004
     O       OR 1      33N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O019
1022 O                         CST1   B  42                               E47247
     O/COPY WNCPYSRC,LE0420O020
1008 O                       51SPI2      77
     O                       49SPI2      77                               CLE033
1009 O                       52SPI2      77
1010 O                       54SPI2      77
1011 O                       58SPI2      77
1012 O********D*11     20                                                 E41117
1013 O*******OR*11     36                                                 E41117
1012 O********D 1      20                                          E47247 CLE004
1013 O*******OR 1      36                                          E47247 CLE004
     O*******OR 1      33                                          E47247 CLE004
1012 O        D 1      20N13                                              CLE004
1013 O       OR 1      36N13                                              CLE004
     O       OR 1      33N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O021
1022 O                         CST2   B  42                               E47247
     O/COPY WNCPYSRC,LE0420O022
1014 O                       51SPI3      77
     O                       49SPI3      77                               CLE033
1015 O                       52SPI3      77
1016 O                       54SPI3      77
1017 O                       58SPI3      77
1018 O**  PRINT CUSTOMER NAME AND ADDRESS FOR ALL RECORDS
1019 O*
1020 O********D** 41   20                                                 E47247
1021 O*******OR** 41   33                                                 E47247
1020 O********D 1      20                                          E47247 CLE004
1021 O*******OR 1      33                                          E47247 CLE004
1020 O        D 1      20N13                                              CLE004
1021 O       OR 1      33N13                                              CLE004
1022 O*******                  CST1   B  42                               E47247
     O/COPY WNCPYSRC,LE0420O023
1022 O                         CST3   B  42                               E47247
     O/COPY WNCPYSRC,LE0420O024
1020 O********D 1      20                                          E47247 CLE004
1021 O*******OR 1      33                                          E47247 CLE004
1020 O        D 1      20N13                                              CLE004
1021 O       OR 1      33N13                                              CLE004
     O/COPY WNCPYSRC,LE0420O025
1022 O                         CST4   B  42                               E47247
     O/COPY WNCPYSRC,LE0420O026
     O                 29                60 'BENIFICIARY BANK'            E47247
     O/COPY WNCPYSRC,LE0420OOP6                                           S01408
1023 O********D 1      20                                          E47247 CLE004
1024 O*******OR 1      33                                          E47247 CLE004
1023 O        D 1      20N13                                              CLE004
1024 O       OR 1      33N13                                              CLE004
1025 O*******                  CST2   B  42                               E47247
     O                 29      SPI1      77
     O**********       U4 39             70 '** S.W.I.F.T. - DO NOT'      S01118
     O**********       U4 39             78 'SEND **'                     S01118
     O                 U1 47             80 '** TELEX GENERATED **'
1026 O********D 1      20                                          E47247 CLE004
1027 O*******OR 1      33                                          E47247 CLE004
1026 O        D 1      20N13                                              CLE004
1027 O       OR 1      33N13                                              CLE004
1028 O*******                  CST3   B  42                               E47247
1029 O******* D 1      20                                                 E47247
1030 O*******OR 1      33                                                 E47247
1029 O********D 2      20                                          E47247 CLE004
1030 O*******OR 2      33                                          E47247 CLE004
1029 O        D 2      20N13                                              CLE004
1030 O       OR 2      33N13                                              CLE004
1031 O*******                  CST4   B  42                               E47247
     O**********          U4 39          70 '   S.W.I.F.T. - DO NOT'      S01118
     O**********          U4 39          76 'SEND '                       S01118
     O**********          U4 39          70 '** AUTO TRANSMISSION -'      S01118
     O**********          U4 39          85 'DO NOT SEND **'              S01118
     O/COPY WNCPYSRC,LE0420O027
     O                    U4 96          70 '** AUTO TRANSMISSION -'      BH2600
     O                    U4 96          85 'DO NOT SEND **'              BH2600
     O/COPY WNCPYSRC,LE0420O028
     O**                                                                  038382
     O**  OUTPUT THIS LINE ONLY IF THERE ARE RECORDS ON FILE (*IN75 ON)   038382
     O        T 3 12   L1 65 75                                           S01117
     O       AND          61                                              CLE004
     O                                   64 '*** END OF REPORT'           038382
     O                                   75 'FOR BRANCH'                  038382
     O                         BRCA      79                               038382
     O                                   83 '***'                         038382
     O***********                        22 '*** END OF '          S01117 038382
     O***********                        32 'REPORT FOR'           S01117 038382
     O***********                        39 ' BRANCH'              S01117 038382
     O***********              BRCA      43                        S01117 038382
     O***********                        48 '***'                  S01117 038382
     O**
     O**  OUTPUT THIS LINE ONLY IF THERE ARE RECORDS ON FILE (*IN75 ON)   038382
     O********T 3 12   LRN65                                       S01117 038382
     O        T 3 12   LRN65 75                                           038382
     O       AND          61                                              CLE004
     O                                   76 '*** END OF REPORT ***'       S01117
     O/COPY WNCPYSRC,LE0420O001
1032 O*  CONTROL REPORT
1033 O*MPRINT  T   06   LR                                                S01125
1033 O*E0420P1T** 06   LR                                           S01125S01117
     OLE0420P2D  309   13 16                                              CLE004
     O       OR  309   13 17                                              CLE004
     O                       70BRNM      61                               CLE004
     O*  HEADING LINE. CONFIRMATION NAME & TYPE                           CLE004
     O        D  1     13 16                                              CLE004
     O       OR  1     13 17                                              CLE004
     O                                   44 'PRINCIPAL TRANSFER CONFI'    CLE004
     O                                   51 'RMATION'                     CLE004
     O                    03 37          66 'AMENDMENT'                   CLE004
     O                    05             69 'CANCELLATION'                CLE004
     O        D  1     13 16                                              CLE004
     O       OR  1     13 17                                              CLE004
     O                                   48 'DATE'                        CLE004
     O                         RUNA      58                               CLE004
     O        D  1     13 16                                              CLE004
     O       OR  1     13 17                                              CLE004
     O                                   48 'REF.'                        CLE004
     O                         LNRF      57                               CLE004
     O                                   58 '-'                           CLE004
     O                         CNUM      64                               CLE004
     O        D 11     13 16                                              CLE004
     O       OR 11     13 17                                              CLE004
     O                                   26 'WE CONFIRM TRANSFER OF '     CLE004
     O                    17             45 'PRINCIPAL FROM LOAN'         CLE004
     O                    16             43 'PRINCIPAL TO LOAN'           CLE004
     O                    17   LNRF      52                               CLE004
     O                    16   LNRF      50                               CLE004
     O                    17             76 'WITH THE FOLLOWING DETA'     CLE004
     O                    17             80 'ILS:'                        CLE004
     O                    16             74 'WITH THE FOLLOWING DETA'     CLE004
     O                    16             78 'ILS:'                        CLE004
     O        D 11     13 16                                              CLE004
     O       OR 11     13 17                                              CLE004
     O***********                         8 'CCY'                  CLE004 138866
     O***********                        23 'PRINCIPAL'            CLE004 138866
     O***********                        41 'DUE DATE'             CLE004 138866
     O***********                        58 'INTEREST RATE'        CLE004 138866
     O***********      17N14             80 'RECEIVING CUSTOMER'   CLE004 138866
     O***********      16N14             82 'ORIGINATING CUSTOMER' CLE004 138866
     O                                    5 'CCY'                         138866
     O                                   19 'PRINCIPAL'                   138866
     O                                   37 'INTEREST'                    138866
     O                                   51 'DUE DATE'                    138866
     O                                   66 'INTEREST RATE'               138866
     O                 17N14             86 'RECEIVING CUSTOMER'          138866
     O                 16N14             88 'ORIGINATING CUSTOMER'        138866
     O        D  3     13 16                                              CLE004
     O       OR  3     13 17                                              CLE004
     O***********              CCY        8                        CLE004 138866
     O***********         40   PRAM      29 ' ,   ,   ,   ,*  '    CLE004 138866
     O***********         41   PRAM      29 '   ,   ,   , * . '    CLE004 138866
     O***********         42   PRAM      29 '  ,   ,   , * .  '    CLE004 138866
     O***********         43   PRAM      29 ' ,   ,   , * .   '    CLE004 138866
     O***********              OVDAT     40                        CLE004 138866
     O***********              RTSP      57 '  * .       -'        CLE004 138866
     O***********      17N14   RORC      73                        CLE004 138866
     O***********      16N14   RORC      75                        CLE004 138866
     O                         CCY        5                               138866
     O/COPY WNCPYSRC,LE0420O033
     O                    40   PRAM      23 ' ,   ,   ,   ,*  '           138866
     O                    41   PRAM      23 '   ,   ,   , * . '           138866
     O                    42   PRAM      23 '  ,   ,   , * .  '           138866
     O                    43   PRAM      23 ' ,   ,   , * .   '           138866
     O/COPY WNCPYSRC,LE0420O034
     O                    40   INTA      42 ' ,   ,   ,   ,*  '           138866
     O                    41   INTA      42 '   ,   ,   , * . '           138866
     O                    42   INTA      42 '  ,   ,   , * .  '           138866
     O                    43   INTA      42 ' ,   ,   , * .   '           138866
     O/COPY WNCPYSRC,LE0420O035
     O                         OVDAT     51                               138866
     O                         W#RATE    67 '  * .       -'               138866
     O                 17N14   RORC      79                               138866
     O                 16N14   RORC      81                               138866
      *                                                                   CLE004
0896  *  FOR SETTLEMENT INSTRUCTIONS. FIRST *** RECEIPTS ***              CLE004
0897 O        D 1      32 13                                              CLE004
0898 O       OR 1      34 13                                              CLE004
0899 O                                   24 'PAYMENT AT VALUE DATE'       CLE004
0900 O                       51          40 'TO OUR A/C WITH'             CLE004
0901 O                       54          27 'BY'                          CLE004
0902 O                       58          27 'BY'                          CLE004
0903 O                       50          27 'TO'                          CLE004
0904 O        D 1      32 13                                              CLE004
0905 O       OR 1      34 13                                              CLE004
0906 O                       50          30 'INSTRUCTIONS TO BE ADVIS'    CLE004
0907 O                       50          32 'ED'                          CLE004
0908 O                       51CN2    B  40                               CLE004
0909 O                    51 22          30 'INSTRUCTIONS TO BE ADVIS'    CLE004
0910 O                    51 22          40 'ED        '                  CLE004
0911 O                       52          30 'WE AWAIT YOUR REMITTANCE'    CLE004
0912 O                       53          29 'AS PER OUR INSTRUCTIONS'     CLE004
0913 O                       54          29 'DEBIT TO ACCOUNT NUMBER'     CLE004
0914 O                       55          29 'AS PER OUR INSTRUCTIONS'     CLE004
0915 O                       57          29 'WE SHALL COLLECT REMITT'     CLE004
0916 O                       57          33 'ANCE'                        CLE004
0917 O                       58          29 'DEBIT TO ACCOUNT NUMBER'     CLE004
     O                       49          29 'THROUGH ACCOUNT'             CLE033
0918 O        D 11     32 13                                              CLE004
0919 O       OR 11     34 13                                              CLE004
0920 O                       51CT2    B  25                               CLE004
0921 O                    51 22          25 '                    '        CLE004
0922 O                       54OUT04  B  12 '    -  '                     CLE004
     O                       54          13 '-'                           CLE004
     O                       54OSBR   B  16                               CLE004
0923 O**********             58OSAC      15                                            CLE004 CGL029
     O                       58OSAC      21                                                   CGL029
     O                       49OSBR   B   4                               CLE033
     O                       49           5 '-'                           CLE033
     O**********             49OSAC      17                                            CLE033 CGL029
     O                       49OSAC      23                                                   CGL029
0924 O        D 1      32 13                                              CLE004
0925 O       OR 1      34 13                                              CLE004
0926 O                       51          13 'PAYMENT BY'                  CLE004
     O                       49          13 'PAYMENT BY'                  CLE033
0927 O                       50          13 'PAYMENT BY'                  CLE004
0928 O        D 1      32 13                                              CLE004
0929 O       OR 1      34 13                                              CLE004
0930 O                       51CN3    B  40                               CLE004
0931 O                    51 23          26 'WE AWAIT YOUR ADVICE'        CLE004
0932 O                    51 23          40 '              '              CLE004
0933 O                       50          26 'WE AWAIT YOUR ADVICE'        CLE004
     O                       49CN3    B  40                               CLE033
     O                    49 23          26 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          40 '              '              CLE033
0934 O        D 13     13 32                                              CLE004
0935 O       OR 13     34 13                                              CLE004
0936 O                       51CT3    B  25                               CLE004
0937 O                    51 23          25 '                    '        CLE004
     O                       49CT3    B  25                               CLE033
     O                    49 23          25 '                    '        CLE033
0939  *                                                                   CLE004
0943  **** PAYMENTS ****                                                  CLE004
0939  *                                                                   CLE004
0944 O        D 1      16 13                                              CLE004
0945 O       OR 1      36 13                                              CLE004
0946 O                                   65 'PAYMENT AT VALUE DATE'       CLE004
0947 O                       51          68 'BY'                          CLE004
0948 O                       54          68 'BY'                          CLE004
0949 O                       58          68 'BY'                          CLE004
0950 O                       50          68 'BY'                          CLE004
0951 O        D 1      16 13                                              CLE004
0952 O       OR 1      36 13                                              CLE004
0953 O                       50          71 'INSTRUCTIONS TO BE ADVIS'    CLE004
0954 O                       50          73 'ED'                          CLE004
0955 O                       51CN2    B  82                               CLE004
0956 O                    51 22          71 'INSTRUCTIONS TO BE ADVIS'    CLE004
0957 O                    51 22          82 'ED         '                 CLE004
0958 O                       52          70 'WE WILL SEND REMITTANCE'     CLE004
0959 O                       53          71 'AS PER YOUR INSTRUCTIONS'    CLE004
0960 O                       54          71 'CREDIT TO ACCOUNT NO'        CLE004
0961 O                       55          71 'AS PER YOUR INSTRUCTIONS'    CLE004
0962 O                       57          71 'YOU SHALL COLLECT REMITT'    CLE004
0963 O                       57          75 'ANCE'                        CLE004
0964 O                       58          71 'CREDIT TO ACCOUNT NUMBER'    CLE004
     O                       49          71 'THROUGH ACCOUNT'             CLE033
0965 O        D 11     16 13                                              CLE004
0966 O       OR 11     36 13                                              CLE004
0967 O                       51CT2    B  67                               CLE004
0968 O                    51 22          67 '                    '        CLE004
0969 O                       54OUT04  B  54 '    -  '                     CLE004
     O                       54          55 '-'                           CLE004
     O                       54OSBR   B  58                               CLE004
0970 O**********             58OSAC      54                                            CLE004 CGL029
     O                       58OSAC      60                                                   CGL029
     O                       49OSBR   B   4                               CLE033
     O                       49           5 '-'                           CLE033
     O**********             49OSAC      17                                            CLE033 CGL029
     O                       49OSAC      23                                                   CGL029
0971 O        D 1      16 13                                              CLE004
0972 O       OR 1      36 13                                              CLE004
0973 O                       50          54 'PAYMENT TO'                  CLE004
     O                       49          54 'PAYMENT TO'                  CLE033
0974 O                       51          54 'PAYMENT TO'                  CLE004
0975 O        D 1      16 13                                              CLE004
0976 O       OR 1      36 13                                              CLE004
0977 O                       51CN3    B  82                               CLE004
0978 O                    51 23          68 'WE AWAIT YOUR ADVICE'        CLE004
0979 O                    51 23          82 '              '              CLE004
     O                       49CN3    B  82                               CLE033
     O                    49 23          68 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          82 '              '              CLE033
0980 O                       50          68 'WE AWAIT YOUR ADVICE'        CLE004
0981 O        D 11     16 13                                              CLE004
0982 O       OR 11     36 13                                              CLE004
0983 O                       51CT3    B  67                               CLE004
0984 O                    51 23          25 '                    '        CLE004
     O                       49CT3    B  67                               CLE033
     O                    49 23          25 '                    '        CLE033
0985 O        D 1      16 13                                              CLE004
0986 O       OR 1      36 13                                              CLE004
0987 O                       51          54 'FOR A/C OF'                  CLE004
     O                       49          54 'FOR A/C OF'                  CLE033
0988 O        D 1      16 13                                              CLE004
0989 O       OR 1      36 13                                              CLE004
0990 O                       51CN4    B  82                               CLE004
     O                       49CN4    B  82                               CLE033
0991 O        D 11     16 13                                              CLE004
0992 O       OR 11     36 13                                              CLE004
0993 O                       51CT4    B  67                               CLE004
     O                       49CT4    B  67                               CLE033
0994 O        D 1      16 13                                              CLE004
0995 O       OR 1      36 13                                              CLE004
0996 O                       51          64 'SPECIAL INSTRUCTIONS'        CLE004
     O                       49          64 'SPECIAL INSTRUCTIONS'        CLE033
0997 O                       52          64 'SPECIAL INSTRUCTIONS'        CLE004
0998 O                       54          64 'SPECIAL INSTRUCTIONS'        CLE004
0999 O                       58          64 'SPECIAL INSTRUCTIONS'        CLE004
     O        D 1      16N29 13                                           CLE004
     O       OR 1      36N29 13                                           CLE004
1002 O                       51SPI1      77                               CLE004
     O                       49SPI1      77                               CLE033
1003 O                       52SPI1      77                               CLE004
1004 O                       54SPI1      77                               CLE004
1005 O                       58SPI1      77                               CLE004
1006 O        D 1      16 13                                              CLE004
1007 O       OR 1      36 13                                              CLE004
     O       OR 1      33 13                                              CLE004
1022 O                         CST1   B  42                               CLE004
1008 O                       51SPI2      77                               CLE004
     O                       49SPI2      77                               CLE033
1009 O                       52SPI2      77                               CLE004
1010 O                       54SPI2      77                               CLE004
1011 O                       58SPI2      77                               CLE004
1012 O        D 1      16 13                                              CLE004
1013 O       OR 1      36 13                                              CLE004
     O       OR 1      33 13                                              CLE004
1022 O                         CST2   B  42                               CLE004
1014 O                       51SPI3      77                               CLE004
     O                       49SPI3      77                               CLE033
1015 O                       52SPI3      77                               CLE004
1016 O                       54SPI3      77                               CLE004
1017 O                       58SPI3      77                               CLE004
1018 O**  PRINT CUSTOMER NAME AND ADDRESS FOR ALL RECORDS                 CLE004
1019 O*                                                                   CLE004
1020 O        D 1      16 13                                              CLE004
1021 O       OR 1      33 13                                              CLE004
1022 O                         CST3   B  42                               CLE004
1020 O        D 1      16 13                                              CLE004
1021 O       OR 1      33 13                                              CLE004
1022 O                         CST4   B  42                               CLE004
     O                 29                60 'BENIFICIARY BANK'            CLE004
1023 O        D 1      16 13                                              CLE004
1024 O       OR 1      33 13                                              CLE004
     O                 29      SPI1      77                               CLE004
     O                 U1 47             80 '** TELEX GENERATED **'       CLE004
1026 O        D 1      16 13                                              CLE004
1027 O       OR 1      33 13                                              CLE004
1029 O        D 2      16 13                                              CLE004
1030 O       OR 2      33 13                                              CLE004
     O                    U4 96          70 '** AUTO TRANSMISSION -'      CLE004
     O                    U4 96          85 'DO NOT SEND **'              CLE004
     O**                                                                  CLE004
     O**  OUTPUT THIS LINE ONLY IF THERE ARE RECORDS ON FILE (*IN75 ON)   CLE004
     O        T 3 12   L1 65 75                                           CLE004
     O       AND          62                                              CLE004
     O                                   64 '*** END OF REPORT'           CLE004
     O                                   75 'FOR BRANCH'                  CLE004
     O                         BRCA      79                               CLE004
     O                                   83 '***'                         CLE004
     O**  OUTPUT THIS LINE ONLY IF THERE ARE RECORDS ON FILE (*IN75 ON)   CLE004
     O        T 3 12   LRN65 75                                           CLE004
     O       AND          62                                              CLE004
     O                                   76 '*** END OF REPORT ***'       CLE004
      *                                                                   CLE004
1033 OLE0420AUT   06   LR                                                 S01117
1034 O***********                        22 'REFERENCE LE0420'            S01117
1034 O                                   24 'REFERENCE LE0420AU'          S01117
1040 O                         TITL      89
1035 O                                  104 'DATE'
1036 O                         RUNA     112
1037 O                                  122 'PAGE'
1038 O                         PAGE  Z  127
     O/COPY WNCPYSRC,LE0420O008
1041 O        T 2      LR
1042 O                                   55 '    PRINT END OF DAY'
1043 O                                   69 'CONFIRMATIONS'
1044 O                                   90 ' - FILE CONTROLS     '
1045 O        T 13     LR
1046 O                                   55 '    ----------------'
1047 O                                   69 '--------------'
1048 O                                   90 '----------------     '
1049 O*  REPORT ANY DATA BASE ERRORS
1050 O*
1051 O        T 3      LR U7 U8
1052 O                                   42 '*** REFERENCE'
1053 O***********              DBPGM     51                               S01117
1053 O                         DBPGM     55                               S01117
1054 O***********                        71 '-DATA BASE ERROR AT'         S01117
1055 O***********              DBASE     74                               S01117
1054 O                                   76 '-DATA BASE ERROR AT'         S01117
1055 O                         DBASE     81                               S01117
1056 O        T 1      LR U7 U8
1057 O                                   37 'FILE NAME'
1058 O***********              DBFILE    43                               S01117
1059 O***********                        48 'KEY'                         S01117
1060 O***********              DBKEY     78                               S01117
1058 O                         DBFILE    48                               S01117
1059 O                                   55 'KEY'                         S01117
1060 O                         DBKEY     88                               S01117
1061 O*
1062 O        T 1      LR
1063 O                                   26 'S/CONFS - RUN CONTROLS'
1064 O                                   58 'NUMBER'
1065 O        T 11     LR
1066 O                                   26 '----------------------'
1067 O                                   58 'OF RECORDS'
1068 O        T 11     LR
1069 O                                   28 'TOTAL RECORDS ON FILE'
1070 O***********           NU7NORE  Z   58                               038382
1070 O                      NU7NORE  3   58                               038382
1071 O        T 11     LR
1072 O                                   30 'TOTAL RECORDS ON FILE -'
1073 O                                   40 'CALCULATED'
1074 O***********              RECTOTZ   58                               038382
1074 O                         RECTOT3   58                               038382
1075 O                       71          82 '***  DIFFERENCE  ***'
1071 O        T 11     LR 72
1072 O                                   26 'TOTAL TELEX RECORDS'
1074 O***********              TOTLX Z   58                               038382
1074 O                         TOTLX 3   58                               038382
     O        T 1      LR U4
     O                                   11 'S/LENXT'
     O        T 11     LR U4
     O                                   11 '-------'
     O        T 11     LR U4
     O                                   28 'TOTAL RECORDS ON FILE'
     O***********              RECXTOZ   58                               038382
     O                         RECXTO3   58                               038382
     O*****   T 3      LR                                          E18654 RT0086
     O*****                              75 '*** END OF REPORT ***'E18654 RT0086
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM  -  MONTHS SHORTNAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  POWER - Array of powers for currency conversion
0000001
0000010
0000100
0001000
0010000
0100000
1000000
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
